{% extends "base.html" %}

{% block title %}{{ document.title }} - The Combine{% endblock %}

{% block page_title %}{{ document.title }}{% endblock %}

{% block header_actions %}
<div class="header-actions">
    <a href="/documents/{{ document.document_id }}/versions" class="btn btn-outline">
        Version History
    </a>
    <a href="/documents?scope_type={{ document.scope_type }}&scope_id={{ document.scope_id }}" class="btn btn-outline">
        Back to List
    </a>
</div>
{% endblock %}

{% block content %}
<div class="document-detail">
    <section class="card document-meta">
        <div class="meta-grid">
            <div class="meta-item">
                <span class="meta-label">Document ID</span>
                <span class="meta-value mono">{{ document.document_id }}</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Type</span>
                <span class="meta-value"><code>{{ document.document_type }}</code></span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Version</span>
                <span class="meta-value">
                    v{{ document.version }}
                    {% if document.is_latest %}
                    <span class="badge badge-info">Latest</span>
                    {% endif %}
                </span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Status</span>
                <span class="meta-value">
                    {% set status = document.status %}
                    {% include "components/status_badge.html" %}
                </span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Scope</span>
                <span class="meta-value">{{ document.scope_type }} / {{ document.scope_id }}</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Created</span>
                <span class="meta-value">{{ document.created_at or '-' }}</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Updated</span>
                <span class="meta-value">{{ document.updated_at or '-' }}</span>
            </div>
            {% if document.created_by %}
            <div class="meta-item">
                <span class="meta-label">Created By</span>
                <span class="meta-value">{{ document.created_by }}</span>
            </div>
            {% endif %}
            {% if document.created_by_step %}
            <div class="meta-item">
                <span class="meta-label">Step</span>
                <span class="meta-value"><code>{{ document.created_by_step }}</code></span>
            </div>
            {% endif %}
        </div>
    </section>
    
    {% if document.summary %}
    <section class="card document-summary">
        <h3 class="card-title">Summary</h3>
        <p>{{ document.summary }}</p>
    </section>
    {% endif %}
    
    <section class="card document-content">
        <h3 class="card-title">Content</h3>
        <pre class="json-content"><code>{{ document.content | tojson(indent=2) }}</code></pre>
    </section>
</div>

<style>
.document-detail .meta-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
}
.document-detail .meta-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}
.document-detail .meta-label {
    font-size: 0.75rem;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}
.document-detail .meta-value {
    font-size: 0.875rem;
}
.document-detail .json-content {
    background: var(--color-surface-raised);
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    font-size: 0.875rem;
    line-height: 1.5;
}
</style>
{% endblock %}
