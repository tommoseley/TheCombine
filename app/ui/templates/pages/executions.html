{% extends "base.html" %}

{% block title %}Executions - The Combine{% endblock %}

{% block page_title %}Executions{% endblock %}

{% block header_actions %}
<div class="filter-bar">
    <select name="workflow_filter" id="workflow-filter" 
            hx-get="/executions"
            hx-target="#execution-list"
            hx-include="[name='status_filter']"
            hx-push-url="true">
        <option value="">All Workflows</option>
        {% for wf in workflows %}
        <option value="{{ wf.workflow_id }}" {% if wf.workflow_id == filters.workflow_id %}selected{% endif %}>
            {{ wf.name }}
        </option>
        {% endfor %}
    </select>
    <select name="status_filter" id="status-filter"
            hx-get="/executions"
            hx-target="#execution-list"
            hx-include="[name='workflow_filter']"
            hx-push-url="true">
        <option value="">All Statuses</option>
        <option value="running" {% if filters.status == 'running' %}selected{% endif %}>Running</option>
        <option value="waiting_acceptance" {% if filters.status == 'waiting_acceptance' %}selected{% endif %}>Waiting Acceptance</option>
        <option value="waiting_clarification" {% if filters.status == 'waiting_clarification' %}selected{% endif %}>Waiting Clarification</option>
        <option value="completed" {% if filters.status == 'completed' %}selected{% endif %}>Completed</option>
        <option value="failed" {% if filters.status == 'failed' %}selected{% endif %}>Failed</option>
        <option value="cancelled" {% if filters.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
    </select>
</div>
{% endblock %}

{% block content %}
<div id="execution-list"
     hx-get="/partials/executions"
     hx-trigger="every 10s"
     hx-swap="innerHTML">
    {% include "partials/execution_list.html" %}
</div>
{% endblock %}
