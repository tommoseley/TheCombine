{% extends "base.html" %}

{% block title %}Executions - The Combine{% endblock %}

{% block page_title %}Executions{% endblock %}

{% block header_actions %}
<div class="flex items-center gap-3 flex-wrap">
    <select name="source" id="source-filter" 
            class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 focus:ring-2 focus:ring-accent dark:focus:ring-accent-dark focus:outline-none"
            hx-get="/admin/executions"
            hx-target="#execution-list"
            hx-include="[name='workflow_filter'],[name='status_filter'],[name='date_from'],[name='date_to']"
            hx-push-url="true">
        <option value="">All Sources</option>
        <option value="workflows" {% if filters.source == 'workflows' %}selected{% endif %}>Workflows Only</option>
        <option value="documents" {% if filters.source == 'documents' %}selected{% endif %}>Document Builds Only</option>
    </select>
    <select name="status_filter" id="status-filter"
            class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 focus:ring-2 focus:ring-accent dark:focus:ring-accent-dark focus:outline-none"
            hx-get="/admin/executions"
            hx-target="#execution-list"
            hx-include="[name='source'],[name='workflow_filter'],[name='date_from'],[name='date_to']"
            hx-push-url="true">
        <option value="">All Statuses</option>
        <option value="running" {% if filters.status == 'running' %}selected{% endif %}>Running</option>
        <option value="in_progress" {% if filters.status == 'in_progress' %}selected{% endif %}>In Progress</option>
        <option value="success" {% if filters.status == 'success' %}selected{% endif %}>Success</option>
        <option value="completed" {% if filters.status == 'completed' %}selected{% endif %}>Completed</option>
        <option value="failed" {% if filters.status == 'failed' %}selected{% endif %}>Failed</option>
        <option value="cancelled" {% if filters.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
    </select>
    <div class="flex items-center gap-2">
        <input type="date" name="date_from" id="date-from"
               value="{{ filters.date_from or '' }}"
               class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 focus:ring-2 focus:ring-accent dark:focus:ring-accent-dark focus:outline-none"
               hx-get="/admin/executions"
               hx-target="#execution-list"
               hx-include="[name='source'],[name='workflow_filter'],[name='status_filter'],[name='date_to']"
               hx-trigger="change"
               hx-push-url="true"
               placeholder="From">
        <span class="text-gray-400">to</span>
        <input type="date" name="date_to" id="date-to"
               value="{{ filters.date_to or '' }}"
               class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 focus:ring-2 focus:ring-accent dark:focus:ring-accent-dark focus:outline-none"
               hx-get="/admin/executions"
               hx-target="#execution-list"
               hx-include="[name='source'],[name='workflow_filter'],[name='status_filter'],[name='date_from']"
               hx-trigger="change"
               hx-push-url="true"
               placeholder="To">
    </div>
    {% if filters.date_from or filters.date_to or filters.source or filters.status %}
    <a href="/admin/executions" class="px-3 py-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">Clear filters</a>
    {% endif %}
</div>
{% endblock %}

{% block content %}
<div id="execution-list">
    {% include "partials/execution_list.html" %}
</div>
{% endblock %}