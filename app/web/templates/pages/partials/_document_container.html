<!-- pages/partials/_document_container.html -->
<!-- Contains document list sidebar + document content area -->
<!-- Loaded into #document-container when a project is selected -->

<div class="flex h-full w-full">
    
    <!-- Document List Sidebar -->
    <aside id="document-sidebar" class="w-64 bg-white border-r border-gray-200 flex flex-col flex-shrink-0 h-full">
        <!-- Project Header -->
        <div class="p-3 border-b border-gray-200">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0">
                    <i data-lucide="{{ project.icon | default('folder') }}" class="w-4 h-4 text-gray-600"></i>
                </div>
                <div class="min-w-0 flex-1">
                    <p class="text-sm font-medium text-gray-900 truncate">{{ project.name }}</p>
                    <p class="text-xs text-gray-500 truncate">{{ project.project_id }}</p>
                </div>
            </div>
        </div>
        
        <!-- Documents Header with Refresh -->
        <div class="px-3 py-2 border-b border-gray-100 flex items-center justify-between">
            <span class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Documents</span>
            <button 
                hx-get="/ui/projects/{{ project.id }}"
                hx-target="#document-container"
                hx-swap="innerHTML"
                class="p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors"
                title="Refresh">
                <i data-lucide="refresh-cw" class="w-3 h-3"></i>
            </button>
        </div>
        
        <!-- Document List -->
        <div class="flex-1 overflow-y-auto scrollbar-thin">
            <ul class="py-1">
                {% for doc_status in document_statuses %}
                <li>
                    <a 
                        href="/ui/projects/{{ project.id }}/documents/{{ doc_status.doc_type_id }}"
                        hx-get="/ui/projects/{{ project.id }}/documents/{{ doc_status.doc_type_id }}"
                        hx-target="#document-content"
                        hx-push-url="true"
                        class="flex items-center gap-2 px-3 py-2 transition-colors hover:bg-gray-50 {% if doc_status.doc_type_id == active_doc_type %}bg-indigo-50{% endif %} {% if doc_status.readiness == 'blocked' %}opacity-50{% endif %}"
                        style="{% if doc_status.doc_type_id == active_doc_type %}border-left: 3px solid rgb(99 102 241);{% else %}border-left: 3px solid transparent;{% endif %}">
                        
                        <!-- Document Icon -->
                        <i data-lucide="{{ doc_status.icon }}" class="w-4 h-4 {% if doc_status.doc_type_id == active_doc_type %}text-indigo-600{% else %}text-gray-400{% endif %} flex-shrink-0"></i>
                        
                        <!-- Document Info -->
                        <div class="flex-1 min-w-0">
                            <p class="text-sm {% if doc_status.doc_type_id == active_doc_type %}text-indigo-700 font-medium{% else %}text-gray-600{% endif %} truncate">
                                {{ doc_status.title }}
                            </p>
                            {% if doc_status.subtitle %}
                            <p class="text-xs text-gray-400 italic truncate">{{ doc_status.subtitle }}</p>
                            {% endif %}
                        </div>
                        
                        <!-- Status Indicator -->
                        <div class="flex-shrink-0">
                            {% if doc_status.readiness == 'ready' %}
                                <i data-lucide="check-circle" class="w-3.5 h-3.5 text-green-500"></i>
                            {% elif doc_status.readiness == 'stale' %}
                                <i data-lucide="alert-triangle" class="w-3.5 h-3.5 text-amber-500"></i>
                            {% elif doc_status.readiness == 'blocked' %}
                                <i data-lucide="x-circle" class="w-3.5 h-3.5 text-red-400"></i>
                            {% elif doc_status.readiness == 'waiting' %}
                                <i data-lucide="clock" class="w-3.5 h-3.5 text-gray-400"></i>
                            {% endif %}
                        </div>
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        
        <!-- Status Summary -->
        <div class="p-3 border-t border-gray-200 bg-gray-50">
            <div class="grid grid-cols-2 gap-2 text-xs">
                <div class="flex items-center gap-1.5 text-green-600">
                    <i data-lucide="check-circle" class="w-3.5 h-3.5"></i>
                    <span class="font-medium">{{ document_statuses | selectattr('readiness', 'equalto', 'ready') | list | length }}</span>
                    <span class="text-gray-400">Ready</span>
                </div>
                <div class="flex items-center gap-1.5 text-amber-500">
                    <i data-lucide="alert-triangle" class="w-3.5 h-3.5"></i>
                    <span class="font-medium">{{ document_statuses | selectattr('readiness', 'equalto', 'stale') | list | length }}</span>
                    <span class="text-gray-400">Stale</span>
                </div>
                <div class="flex items-center gap-1.5 text-gray-400">
                    <i data-lucide="clock" class="w-3.5 h-3.5"></i>
                    <span class="font-medium">{{ document_statuses | selectattr('readiness', 'equalto', 'waiting') | list | length }}</span>
                    <span class="text-gray-400">Waiting</span>
                </div>
                <div class="flex items-center gap-1.5 text-red-400">
                    <i data-lucide="x-circle" class="w-3.5 h-3.5"></i>
                    <span class="font-medium">{{ document_statuses | selectattr('readiness', 'equalto', 'blocked') | list | length }}</span>
                    <span class="text-gray-400">Blocked</span>
                </div>
            </div>
        </div>
    </aside>
    
    <!-- Document Content Area - reloads when a document is selected -->
    <div id="document-content" class="flex-1 overflow-y-auto bg-gray-50">
        {% block document_content %}
        <!-- Default: show project overview -->
        {% include "pages/partials/_project_overview.html" %}
        {% endblock %}
    </div>
    
</div>