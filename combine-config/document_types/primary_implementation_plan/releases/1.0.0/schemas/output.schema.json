{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "schema://primary_implementation_plan/1.0",
  "title": "Primary Implementation Plan",
  "description": "Preliminary implementation plan with epic candidates. Produced before technical architecture to inform architectural decisions. Epic candidates are not commitments.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "meta",
    "epic_candidates"
  ],
  "properties": {
    "meta": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "schema_version",
        "artifact_id",
        "created_at",
        "source"
      ],
      "properties": {
        "schema_version": {
          "type": "string",
          "const": "1.0"
        },
        "artifact_id": {
          "type": "string",
          "minLength": 1,
          "description": "Unique identifier for this artifact."
        },
        "correlation_id": {
          "type": "string",
          "minLength": 1,
          "description": "Correlation identifier linking to workflow run."
        },
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO-8601 timestamp of artifact creation."
        },
        "source": {
          "type": "string",
          "enum": [
            "human",
            "combine_generated",
            "mixed"
          ],
          "description": "Provenance of the artifact content."
        }
      }
    },
    "epic_set_summary": {
      "type": "object",
      "description": "High-level summary of the epic candidate set.",
      "additionalProperties": false,
      "properties": {
        "overall_intent": {
          "type": "string",
          "minLength": 10,
          "description": "Summary of what this set of epics aims to achieve."
        },
        "mvp_definition": {
          "type": "string",
          "description": "What constitutes MVP for this project."
        },
        "key_constraints": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Constraints that shape all epics."
        },
        "out_of_scope": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Explicit exclusions from all epics."
        }
      }
    },
    "epic_candidates": {
      "type": "array",
      "minItems": 1,
      "description": "Epic candidates for architectural review. Not yet commitments.",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "candidate_id",
          "name",
          "intent"
        ],
        "properties": {
          "candidate_id": {
            "type": "string",
            "pattern": "^EC-\\d{1,4}$",
            "description": "Stable identifier for this epic candidate (e.g., EC-1)."
          },
          "name": {
            "type": "string",
            "minLength": 3,
            "description": "Epic candidate name."
          },
          "intent": {
            "type": "string",
            "minLength": 10,
            "description": "What this epic aims to achieve."
          },
          "in_scope": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "What this epic covers."
          },
          "out_of_scope": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Explicit exclusions."
          },
          "mvp_phase": {
            "type": "string",
            "enum": [
              "mvp",
              "later",
              "undecided"
            ],
            "description": "Whether this is MVP or post-MVP."
          },
          "open_questions": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "question"
              ],
              "properties": {
                "question": {
                  "type": "string"
                },
                "why_it_matters": {
                  "type": "string"
                }
              }
            },
            "description": "Questions that need resolution."
          },
          "notes_for_architecture": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Notes for the architecture phase."
          },
          "dependencies": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Known or suspected dependencies on other epic candidates."
          },
          "assumptions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Assumptions made for this epic candidate."
          }
        }
      }
    },
    "risks_overview": {
      "type": "array",
      "description": "Cross-cutting risks affecting multiple epic candidates.",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "risk_id",
          "description"
        ],
        "properties": {
          "risk_id": {
            "type": "string",
            "pattern": "^RSK-\\d{1,4}$"
          },
          "description": {
            "type": "string"
          },
          "affected_epics": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "mitigation_direction": {
            "type": "string"
          }
        }
      }
    },
    "recommendations_for_architecture": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Recommendations for the Technical Architect to consider."
    }
  }
}