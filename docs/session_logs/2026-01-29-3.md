# Session Summary - 2026-01-29-3

## Scope
- Complete SPA architecture for main user experience
- ProjectTree + Floor integration
- New project flow with auto-expanding Concierge
- MiniMap for navigation orientation
- Architecture decision: React SPA replaces Jinja2 for main UX

## Decisions Made
- Main UX becomes React SPA served by FastAPI (Jinja2 only for admin)
- ProjectTree is launcher only - Floor is source of truth
- Concierge is not a separate page - it is the first node sidecar that auto-opens
- Auto-expand sidecar only on NEW projects (not when switching between existing)
- MiniMap positioned top-right (bottom gets dense with epics)
- Theme state lifted to App level for consistency across components
- No further modularization of prototype needed - Claude Code will set up proper build

## Implemented
- ProjectTree component (260px left sidebar, project list, new project button)
- App wrapper with theme and project state management
- Floor component (renamed from SubwayMap) accepts projectData prop
- PROJECTS mock data (3 projects: The Combine, Marketing Website, Mobile App)
- createNewProject() factory for new project with Concierge intake
- Auto-expand Concierge sidecar on new project creation
- MiniMap with state-based node colors (green/amber/slate)
- ReactFlowProvider key-based remount on project switch

## Updated or Created
- docs/prototypes/subway-map-v6/index.html (1147 lines, 67KB)
- docs/PROJECT_STATE.md (comprehensive handoff for Claude Code)

## Commits / PRs
- Pending: See commit message below

## Open Threads
- Claude Code: Build React SPA with Vite
- Claude Code: Wire to FastAPI backend (REST + SSE)
- Claude Code: Serve SPA from FastAPI, keep admin as Jinja2

## Known Risks / Drift Warnings
- None

---

## Commit Message

```
feat(subway-map): ProjectTree + Floor SPA architecture, MiniMap

Architecture:
- App wrapper manages theme and project selection
- ProjectTree left sidebar (260px) with project list
- Floor component (renamed from SubwayMap) shows production line
- ReactFlowProvider remounts on project switch (key prop)

New Project Flow:
- Click "+ New Project" in sidebar
- Enter name, creates project with Concierge node
- Floor loads, Concierge sidecar auto-opens for intake
- User answers questions, production continues

Navigation:
- MiniMap (top-right) shows position when zoomed
- Pannable/zoomable, click to navigate
- Node colors by state (green/amber/slate)

State Management:
- Theme lifted to App level
- Auto-expand only on NEW projects (not existing)
- Project data passed as prop to Floor

Mock Data:
- PROJECTS object with 3 sample projects
- createNewProject() factory function

Prototype complete - ready for Claude Code to:
1. Build React SPA with Vite
2. Extract components from prototype
3. Wire to FastAPI backend (REST + SSE)
4. Serve SPA from FastAPI (admin stays Jinja2)

1147 lines, 67KB
```