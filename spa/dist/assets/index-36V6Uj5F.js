(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Ca=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var IS={exports:{}},Nc={},MS={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ua=Symbol.for("react.element"),TR=Symbol.for("react.portal"),RR=Symbol.for("react.fragment"),AR=Symbol.for("react.strict_mode"),IR=Symbol.for("react.profiler"),MR=Symbol.for("react.provider"),PR=Symbol.for("react.context"),OR=Symbol.for("react.forward_ref"),DR=Symbol.for("react.suspense"),LR=Symbol.for("react.memo"),FR=Symbol.for("react.lazy"),Oy=Symbol.iterator;function zR(e){return e===null||typeof e!="object"?null:(e=Oy&&e[Oy]||e["@@iterator"],typeof e=="function"?e:null)}var PS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},OS=Object.assign,DS={};function Es(e,t,n){this.props=e,this.context=t,this.refs=DS,this.updater=n||PS}Es.prototype.isReactComponent={};Es.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Es.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function LS(){}LS.prototype=Es.prototype;function Hv(e,t,n){this.props=e,this.context=t,this.refs=DS,this.updater=n||PS}var Wv=Hv.prototype=new LS;Wv.constructor=Hv;OS(Wv,Es.prototype);Wv.isPureReactComponent=!0;var Dy=Array.isArray,FS=Object.prototype.hasOwnProperty,Uv={current:null},zS={key:!0,ref:!0,__self:!0,__source:!0};function qS(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)FS.call(t,r)&&!zS.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:ua,type:e,key:s,ref:o,props:i,_owner:Uv.current}}function qR(e,t){return{$$typeof:ua,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Vv(e){return typeof e=="object"&&e!==null&&e.$$typeof===ua}function $R(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Ly=/\/+/g;function Nu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$R(""+e.key):t.toString(36)}function hl(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ua:case TR:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Nu(o,0):r,Dy(i)?(n="",e!=null&&(n=e.replace(Ly,"$&/")+"/"),hl(i,t,n,"",function(d){return d})):i!=null&&(Vv(i)&&(i=qR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ly,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Dy(e))for(var l=0;l<e.length;l++){s=e[l];var c=r+Nu(s,l);o+=hl(s,t,n,c,i)}else if(c=zR(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=r+Nu(s,l++),o+=hl(s,t,n,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ea(e,t,n){if(e==null)return e;var r=[],i=0;return hl(e,r,"","",function(s){return t.call(n,s,i++)}),r}function BR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Lt={current:null},ml={transition:null},HR={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:ml,ReactCurrentOwner:Uv};function $S(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Ea,forEach:function(e,t,n){Ea(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ea(e,function(){t++}),t},toArray:function(e){return Ea(e,function(t){return t})||[]},only:function(e){if(!Vv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Es;Ce.Fragment=RR;Ce.Profiler=IR;Ce.PureComponent=Hv;Ce.StrictMode=AR;Ce.Suspense=DR;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HR;Ce.act=$S;Ce.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=OS({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Uv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)FS.call(t,c)&&!zS.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:ua,type:e.type,key:i,ref:s,props:r,_owner:o}};Ce.createContext=function(e){return e={$$typeof:PR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:MR,_context:e},e.Consumer=e};Ce.createElement=qS;Ce.createFactory=function(e){var t=qS.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:OR,render:e}};Ce.isValidElement=Vv;Ce.lazy=function(e){return{$$typeof:FR,_payload:{_status:-1,_result:e},_init:BR}};Ce.memo=function(e,t){return{$$typeof:LR,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=ml.transition;ml.transition={};try{e()}finally{ml.transition=t}};Ce.unstable_act=$S;Ce.useCallback=function(e,t){return Lt.current.useCallback(e,t)};Ce.useContext=function(e){return Lt.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Lt.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Lt.current.useEffect(e,t)};Ce.useId=function(){return Lt.current.useId()};Ce.useImperativeHandle=function(e,t,n){return Lt.current.useImperativeHandle(e,t,n)};Ce.useInsertionEffect=function(e,t){return Lt.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Lt.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Lt.current.useMemo(e,t)};Ce.useReducer=function(e,t,n){return Lt.current.useReducer(e,t,n)};Ce.useRef=function(e){return Lt.current.useRef(e)};Ce.useState=function(e){return Lt.current.useState(e)};Ce.useSyncExternalStore=function(e,t,n){return Lt.current.useSyncExternalStore(e,t,n)};Ce.useTransition=function(){return Lt.current.useTransition()};Ce.version="18.3.1";MS.exports=Ce;var m=MS.exports;const V=Bv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WR=m,UR=Symbol.for("react.element"),VR=Symbol.for("react.fragment"),GR=Object.prototype.hasOwnProperty,KR=WR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YR={key:!0,ref:!0,__self:!0,__source:!0};function BS(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)GR.call(t,r)&&!YR.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:UR,type:e,key:s,ref:o,props:i,_owner:KR.current}}Nc.Fragment=VR;Nc.jsx=BS;Nc.jsxs=BS;IS.exports=Nc;var a=IS.exports,bg={},HS={exports:{}},sn={},WS={exports:{}},US={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,A){var F=O.length;O.push(A);e:for(;0<F;){var I=F-1>>>1,q=O[I];if(0<i(q,A))O[I]=A,O[F]=q,F=I;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var A=O[0],F=O.pop();if(F!==A){O[0]=F;e:for(var I=0,q=O.length,W=q>>>1;I<W;){var U=2*(I+1)-1,Z=O[U],B=U+1,ne=O[B];if(0>i(Z,F))B<q&&0>i(ne,Z)?(O[I]=ne,O[B]=F,I=B):(O[I]=Z,O[U]=F,I=U);else if(B<q&&0>i(ne,F))O[I]=ne,O[B]=F,I=B;else break e}}return A}function i(O,A){var F=O.sortIndex-A.sortIndex;return F!==0?F:O.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,x=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var A=n(d);A!==null;){if(A.callback===null)r(d);else if(A.startTime<=O)r(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=n(d)}}function _(O){if(g=!1,b(O),!x)if(n(c)!==null)x=!0,P(j);else{var A=n(d);A!==null&&$(_,A.startTime-O)}}function j(O,A){x=!1,g&&(g=!1,v(E),E=-1),h=!0;var F=p;try{for(b(A),f=n(c);f!==null&&(!(f.expirationTime>A)||O&&!T());){var I=f.callback;if(typeof I=="function"){f.callback=null,p=f.priorityLevel;var q=I(f.expirationTime<=A);A=e.unstable_now(),typeof q=="function"?f.callback=q:f===n(c)&&r(c),b(A)}else r(c);f=n(c)}if(f!==null)var W=!0;else{var U=n(d);U!==null&&$(_,U.startTime-A),W=!1}return W}finally{f=null,p=F,h=!1}}var k=!1,N=null,E=-1,S=5,R=-1;function T(){return!(e.unstable_now()-R<S)}function M(){if(N!==null){var O=e.unstable_now();R=O;var A=!0;try{A=N(!0,O)}finally{A?z():(k=!1,N=null)}}else k=!1}var z;if(typeof y=="function")z=function(){y(M)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,L=C.port2;C.port1.onmessage=M,z=function(){L.postMessage(null)}}else z=function(){w(M,0)};function P(O){N=O,k||(k=!0,z())}function $(O,A){E=w(function(){O(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){x||h||(x=!0,P(j))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var A=3;break;default:A=p}var F=p;p=A;try{return O()}finally{p=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,A){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var F=p;p=O;try{return A()}finally{p=F}},e.unstable_scheduleCallback=function(O,A,F){var I=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?I+F:I):F=I,O){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=F+q,O={id:u++,callback:A,priorityLevel:O,startTime:F,expirationTime:q,sortIndex:-1},F>I?(O.sortIndex=F,t(d,O),n(c)===null&&O===n(d)&&(g?(v(E),E=-1):g=!0,$(_,F-I))):(O.sortIndex=q,t(c,O),x||h||(x=!0,P(j))),O},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(O){var A=p;return function(){var F=p;p=A;try{return O.apply(this,arguments)}finally{p=F}}}})(US);WS.exports=US;var XR=WS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QR=m,nn=XR;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VS=new Set,Io={};function Ci(e,t){ms(e,t),ms(e+"Capture",t)}function ms(e,t){for(Io[e]=t,e=0;e<t.length;e++)VS.add(t[e])}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wg=Object.prototype.hasOwnProperty,ZR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fy={},zy={};function JR(e){return wg.call(zy,e)?!0:wg.call(Fy,e)?!1:ZR.test(e)?zy[e]=!0:(Fy[e]=!0,!1)}function eA(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function tA(e,t,n,r){if(t===null||typeof t>"u"||eA(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ft(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){St[e]=new Ft(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];St[t]=new Ft(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){St[e]=new Ft(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){St[e]=new Ft(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){St[e]=new Ft(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){St[e]=new Ft(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){St[e]=new Ft(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){St[e]=new Ft(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){St[e]=new Ft(e,5,!1,e.toLowerCase(),null,!1,!1)});var Gv=/[\-:]([a-z])/g;function Kv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Gv,Kv);St[t]=new Ft(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Gv,Kv);St[t]=new Ft(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Gv,Kv);St[t]=new Ft(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){St[e]=new Ft(e,1,!1,e.toLowerCase(),null,!1,!1)});St.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){St[e]=new Ft(e,1,!1,e.toLowerCase(),null,!0,!0)});function Yv(e,t,n,r){var i=St.hasOwnProperty(t)?St[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(tA(t,n,i,r)&&(n=null),r||i===null?JR(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var vr=QR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ta=Symbol.for("react.element"),Hi=Symbol.for("react.portal"),Wi=Symbol.for("react.fragment"),Xv=Symbol.for("react.strict_mode"),_g=Symbol.for("react.profiler"),GS=Symbol.for("react.provider"),KS=Symbol.for("react.context"),Qv=Symbol.for("react.forward_ref"),jg=Symbol.for("react.suspense"),Sg=Symbol.for("react.suspense_list"),Zv=Symbol.for("react.memo"),jr=Symbol.for("react.lazy"),YS=Symbol.for("react.offscreen"),qy=Symbol.iterator;function $s(e){return e===null||typeof e!="object"?null:(e=qy&&e[qy]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Cu;function so(e){if(Cu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Cu=t&&t[1]||""}return`
`+Cu+e}var Eu=!1;function Tu(e,t){if(!e||Eu)return"";Eu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Eu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?so(e):""}function nA(e){switch(e.tag){case 5:return so(e.type);case 16:return so("Lazy");case 13:return so("Suspense");case 19:return so("SuspenseList");case 0:case 2:case 15:return e=Tu(e.type,!1),e;case 11:return e=Tu(e.type.render,!1),e;case 1:return e=Tu(e.type,!0),e;default:return""}}function kg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Wi:return"Fragment";case Hi:return"Portal";case _g:return"Profiler";case Xv:return"StrictMode";case jg:return"Suspense";case Sg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case KS:return(e.displayName||"Context")+".Consumer";case GS:return(e._context.displayName||"Context")+".Provider";case Qv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Zv:return t=e.displayName||null,t!==null?t:kg(e.type)||"Memo";case jr:t=e._payload,e=e._init;try{return kg(e(t))}catch{}}return null}function rA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kg(t);case 8:return t===Xv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function XS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function iA(e){var t=XS(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ra(e){e._valueTracker||(e._valueTracker=iA(e))}function QS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=XS(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Al(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ng(e,t){var n=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function $y(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Gr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ZS(e,t){t=t.checked,t!=null&&Yv(e,"checked",t,!1)}function Cg(e,t){ZS(e,t);var n=Gr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Eg(e,t.type,n):t.hasOwnProperty("defaultValue")&&Eg(e,t.type,Gr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function By(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Eg(e,t,n){(t!=="number"||Al(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var oo=Array.isArray;function ss(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Gr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Tg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Hy(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ee(92));if(oo(n)){if(1<n.length)throw Error(ee(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Gr(n)}}function JS(e,t){var n=Gr(t.value),r=Gr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Wy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ek(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ek(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Aa,tk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Aa=Aa||document.createElement("div"),Aa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Aa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var yo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sA=["Webkit","ms","Moz","O"];Object.keys(yo).forEach(function(e){sA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),yo[t]=yo[e]})});function nk(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||yo.hasOwnProperty(e)&&yo[e]?(""+t).trim():t+"px"}function rk(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=nk(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var oA=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ag(e,t){if(t){if(oA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function Ig(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mg=null;function Jv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pg=null,os=null,as=null;function Uy(e){if(e=pa(e)){if(typeof Pg!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=Ac(t),Pg(e.stateNode,e.type,t))}}function ik(e){os?as?as.push(e):as=[e]:os=e}function sk(){if(os){var e=os,t=as;if(as=os=null,Uy(e),t)for(e=0;e<t.length;e++)Uy(t[e])}}function ok(e,t){return e(t)}function ak(){}var Ru=!1;function lk(e,t,n){if(Ru)return e(t,n);Ru=!0;try{return ok(e,t,n)}finally{Ru=!1,(os!==null||as!==null)&&(ak(),sk())}}function Po(e,t){var n=e.stateNode;if(n===null)return null;var r=Ac(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ee(231,t,typeof n));return n}var Og=!1;if(cr)try{var Bs={};Object.defineProperty(Bs,"passive",{get:function(){Og=!0}}),window.addEventListener("test",Bs,Bs),window.removeEventListener("test",Bs,Bs)}catch{Og=!1}function aA(e,t,n,r,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(u){this.onError(u)}}var bo=!1,Il=null,Ml=!1,Dg=null,lA={onError:function(e){bo=!0,Il=e}};function cA(e,t,n,r,i,s,o,l,c){bo=!1,Il=null,aA.apply(lA,arguments)}function uA(e,t,n,r,i,s,o,l,c){if(cA.apply(this,arguments),bo){if(bo){var d=Il;bo=!1,Il=null}else throw Error(ee(198));Ml||(Ml=!0,Dg=d)}}function Ei(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function ck(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Vy(e){if(Ei(e)!==e)throw Error(ee(188))}function dA(e){var t=e.alternate;if(!t){if(t=Ei(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Vy(i),e;if(s===r)return Vy(i),t;s=s.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?e:t}function uk(e){return e=dA(e),e!==null?dk(e):null}function dk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=dk(e);if(t!==null)return t;e=e.sibling}return null}var fk=nn.unstable_scheduleCallback,Gy=nn.unstable_cancelCallback,fA=nn.unstable_shouldYield,pA=nn.unstable_requestPaint,rt=nn.unstable_now,hA=nn.unstable_getCurrentPriorityLevel,ex=nn.unstable_ImmediatePriority,pk=nn.unstable_UserBlockingPriority,Pl=nn.unstable_NormalPriority,mA=nn.unstable_LowPriority,hk=nn.unstable_IdlePriority,Cc=null,Bn=null;function gA(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Cc,e,void 0,(e.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:yA,vA=Math.log,xA=Math.LN2;function yA(e){return e>>>=0,e===0?32:31-(vA(e)/xA|0)|0}var Ia=64,Ma=4194304;function ao(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ol(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=ao(l):(s&=o,s!==0&&(r=ao(s)))}else o=n&~i,o!==0?r=ao(o):s!==0&&(r=ao(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Tn(t),i=1<<n,r|=e[n],t&=~i;return r}function bA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wA(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Tn(s),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=bA(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Lg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function mk(){var e=Ia;return Ia<<=1,!(Ia&4194240)&&(Ia=64),e}function Au(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function da(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tn(t),e[t]=n}function _A(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Tn(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function tx(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Tn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var $e=0;function gk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vk,nx,xk,yk,bk,Fg=!1,Pa=[],Or=null,Dr=null,Lr=null,Oo=new Map,Do=new Map,Er=[],jA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ky(e,t){switch(e){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":Lr=null;break;case"pointerover":case"pointerout":Oo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Do.delete(t.pointerId)}}function Hs(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=pa(t),t!==null&&nx(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function SA(e,t,n,r,i){switch(t){case"focusin":return Or=Hs(Or,e,t,n,r,i),!0;case"dragenter":return Dr=Hs(Dr,e,t,n,r,i),!0;case"mouseover":return Lr=Hs(Lr,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Oo.set(s,Hs(Oo.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Do.set(s,Hs(Do.get(s)||null,e,t,n,r,i)),!0}return!1}function wk(e){var t=ci(e.target);if(t!==null){var n=Ei(t);if(n!==null){if(t=n.tag,t===13){if(t=ck(n),t!==null){e.blockedOn=t,bk(e.priority,function(){xk(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=zg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Mg=r,n.target.dispatchEvent(r),Mg=null}else return t=pa(n),t!==null&&nx(t),e.blockedOn=n,!1;t.shift()}return!0}function Yy(e,t,n){gl(e)&&n.delete(t)}function kA(){Fg=!1,Or!==null&&gl(Or)&&(Or=null),Dr!==null&&gl(Dr)&&(Dr=null),Lr!==null&&gl(Lr)&&(Lr=null),Oo.forEach(Yy),Do.forEach(Yy)}function Ws(e,t){e.blockedOn===t&&(e.blockedOn=null,Fg||(Fg=!0,nn.unstable_scheduleCallback(nn.unstable_NormalPriority,kA)))}function Lo(e){function t(i){return Ws(i,e)}if(0<Pa.length){Ws(Pa[0],e);for(var n=1;n<Pa.length;n++){var r=Pa[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Or!==null&&Ws(Or,e),Dr!==null&&Ws(Dr,e),Lr!==null&&Ws(Lr,e),Oo.forEach(t),Do.forEach(t),n=0;n<Er.length;n++)r=Er[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Er.length&&(n=Er[0],n.blockedOn===null);)wk(n),n.blockedOn===null&&Er.shift()}var ls=vr.ReactCurrentBatchConfig,Dl=!0;function NA(e,t,n,r){var i=$e,s=ls.transition;ls.transition=null;try{$e=1,rx(e,t,n,r)}finally{$e=i,ls.transition=s}}function CA(e,t,n,r){var i=$e,s=ls.transition;ls.transition=null;try{$e=4,rx(e,t,n,r)}finally{$e=i,ls.transition=s}}function rx(e,t,n,r){if(Dl){var i=zg(e,t,n,r);if(i===null)$u(e,t,r,Ll,n),Ky(e,r);else if(SA(i,e,t,n,r))r.stopPropagation();else if(Ky(e,r),t&4&&-1<jA.indexOf(e)){for(;i!==null;){var s=pa(i);if(s!==null&&vk(s),s=zg(e,t,n,r),s===null&&$u(e,t,r,Ll,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else $u(e,t,r,null,n)}}var Ll=null;function zg(e,t,n,r){if(Ll=null,e=Jv(r),e=ci(e),e!==null)if(t=Ei(e),t===null)e=null;else if(n=t.tag,n===13){if(e=ck(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ll=e,null}function _k(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hA()){case ex:return 1;case pk:return 4;case Pl:case mA:return 16;case hk:return 536870912;default:return 16}default:return 16}}var Mr=null,ix=null,vl=null;function jk(){if(vl)return vl;var e,t=ix,n=t.length,r,i="value"in Mr?Mr.value:Mr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return vl=i.slice(e,1<r?1-r:void 0)}function xl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Oa(){return!0}function Xy(){return!1}function on(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Oa:Xy,this.isPropagationStopped=Xy,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Oa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Oa)},persist:function(){},isPersistent:Oa}),t}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sx=on(Ts),fa=et({},Ts,{view:0,detail:0}),EA=on(fa),Iu,Mu,Us,Ec=et({},fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ox,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Us&&(Us&&e.type==="mousemove"?(Iu=e.screenX-Us.screenX,Mu=e.screenY-Us.screenY):Mu=Iu=0,Us=e),Iu)},movementY:function(e){return"movementY"in e?e.movementY:Mu}}),Qy=on(Ec),TA=et({},Ec,{dataTransfer:0}),RA=on(TA),AA=et({},fa,{relatedTarget:0}),Pu=on(AA),IA=et({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),MA=on(IA),PA=et({},Ts,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),OA=on(PA),DA=et({},Ts,{data:0}),Zy=on(DA),LA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zA[e])?!!t[e]:!1}function ox(){return qA}var $A=et({},fa,{key:function(e){if(e.key){var t=LA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?FA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ox,charCode:function(e){return e.type==="keypress"?xl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),BA=on($A),HA=et({},Ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jy=on(HA),WA=et({},fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ox}),UA=on(WA),VA=et({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),GA=on(VA),KA=et({},Ec,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),YA=on(KA),XA=[9,13,27,32],ax=cr&&"CompositionEvent"in window,wo=null;cr&&"documentMode"in document&&(wo=document.documentMode);var QA=cr&&"TextEvent"in window&&!wo,Sk=cr&&(!ax||wo&&8<wo&&11>=wo),e0=" ",t0=!1;function kk(e,t){switch(e){case"keyup":return XA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ui=!1;function ZA(e,t){switch(e){case"compositionend":return Nk(t);case"keypress":return t.which!==32?null:(t0=!0,e0);case"textInput":return e=t.data,e===e0&&t0?null:e;default:return null}}function JA(e,t){if(Ui)return e==="compositionend"||!ax&&kk(e,t)?(e=jk(),vl=ix=Mr=null,Ui=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Sk&&t.locale!=="ko"?null:t.data;default:return null}}var e5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!e5[e.type]:t==="textarea"}function Ck(e,t,n,r){ik(r),t=Fl(t,"onChange"),0<t.length&&(n=new sx("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var _o=null,Fo=null;function t5(e){Fk(e,0)}function Tc(e){var t=Ki(e);if(QS(t))return e}function n5(e,t){if(e==="change")return t}var Ek=!1;if(cr){var Ou;if(cr){var Du="oninput"in document;if(!Du){var r0=document.createElement("div");r0.setAttribute("oninput","return;"),Du=typeof r0.oninput=="function"}Ou=Du}else Ou=!1;Ek=Ou&&(!document.documentMode||9<document.documentMode)}function i0(){_o&&(_o.detachEvent("onpropertychange",Tk),Fo=_o=null)}function Tk(e){if(e.propertyName==="value"&&Tc(Fo)){var t=[];Ck(t,Fo,e,Jv(e)),lk(t5,t)}}function r5(e,t,n){e==="focusin"?(i0(),_o=t,Fo=n,_o.attachEvent("onpropertychange",Tk)):e==="focusout"&&i0()}function i5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Tc(Fo)}function s5(e,t){if(e==="click")return Tc(t)}function o5(e,t){if(e==="input"||e==="change")return Tc(t)}function a5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var An=typeof Object.is=="function"?Object.is:a5;function zo(e,t){if(An(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!wg.call(t,i)||!An(e[i],t[i]))return!1}return!0}function s0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function o0(e,t){var n=s0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=s0(n)}}function Rk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ak(){for(var e=window,t=Al();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Al(e.document)}return t}function lx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function l5(e){var t=Ak(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Rk(n.ownerDocument.documentElement,n)){if(r!==null&&lx(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=o0(n,s);var o=o0(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var c5=cr&&"documentMode"in document&&11>=document.documentMode,Vi=null,qg=null,jo=null,$g=!1;function a0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$g||Vi==null||Vi!==Al(r)||(r=Vi,"selectionStart"in r&&lx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),jo&&zo(jo,r)||(jo=r,r=Fl(qg,"onSelect"),0<r.length&&(t=new sx("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Vi)))}function Da(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Gi={animationend:Da("Animation","AnimationEnd"),animationiteration:Da("Animation","AnimationIteration"),animationstart:Da("Animation","AnimationStart"),transitionend:Da("Transition","TransitionEnd")},Lu={},Ik={};cr&&(Ik=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function Rc(e){if(Lu[e])return Lu[e];if(!Gi[e])return e;var t=Gi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ik)return Lu[e]=t[n];return e}var Mk=Rc("animationend"),Pk=Rc("animationiteration"),Ok=Rc("animationstart"),Dk=Rc("transitionend"),Lk=new Map,l0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qr(e,t){Lk.set(e,t),Ci(t,[e])}for(var Fu=0;Fu<l0.length;Fu++){var zu=l0[Fu],u5=zu.toLowerCase(),d5=zu[0].toUpperCase()+zu.slice(1);Qr(u5,"on"+d5)}Qr(Mk,"onAnimationEnd");Qr(Pk,"onAnimationIteration");Qr(Ok,"onAnimationStart");Qr("dblclick","onDoubleClick");Qr("focusin","onFocus");Qr("focusout","onBlur");Qr(Dk,"onTransitionEnd");ms("onMouseEnter",["mouseout","mouseover"]);ms("onMouseLeave",["mouseout","mouseover"]);ms("onPointerEnter",["pointerout","pointerover"]);ms("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f5=new Set("cancel close invalid load scroll toggle".split(" ").concat(lo));function c0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,uA(r,t,void 0,e),e.currentTarget=null}function Fk(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;c0(i,l,d),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;c0(i,l,d),s=c}}}if(Ml)throw e=Dg,Ml=!1,Dg=null,e}function Ue(e,t){var n=t[Vg];n===void 0&&(n=t[Vg]=new Set);var r=e+"__bubble";n.has(r)||(zk(t,e,2,!1),n.add(r))}function qu(e,t,n){var r=0;t&&(r|=4),zk(n,e,r,t)}var La="_reactListening"+Math.random().toString(36).slice(2);function qo(e){if(!e[La]){e[La]=!0,VS.forEach(function(n){n!=="selectionchange"&&(f5.has(n)||qu(n,!1,e),qu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[La]||(t[La]=!0,qu("selectionchange",!1,t))}}function zk(e,t,n,r){switch(_k(t)){case 1:var i=NA;break;case 4:i=CA;break;default:i=rx}n=i.bind(null,t,n,e),i=void 0,!Og||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $u(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ci(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}lk(function(){var d=s,u=Jv(n),f=[];e:{var p=Lk.get(e);if(p!==void 0){var h=sx,x=e;switch(e){case"keypress":if(xl(n)===0)break e;case"keydown":case"keyup":h=BA;break;case"focusin":x="focus",h=Pu;break;case"focusout":x="blur",h=Pu;break;case"beforeblur":case"afterblur":h=Pu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Qy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=RA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=UA;break;case Mk:case Pk:case Ok:h=MA;break;case Dk:h=GA;break;case"scroll":h=EA;break;case"wheel":h=YA;break;case"copy":case"cut":case"paste":h=OA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Jy}var g=(t&4)!==0,w=!g&&e==="scroll",v=g?p!==null?p+"Capture":null:p;g=[];for(var y=d,b;y!==null;){b=y;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,v!==null&&(_=Po(y,v),_!=null&&g.push($o(y,_,b)))),w)break;y=y.return}0<g.length&&(p=new h(p,x,null,n,u),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&n!==Mg&&(x=n.relatedTarget||n.fromElement)&&(ci(x)||x[ur]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(x=n.relatedTarget||n.toElement,h=d,x=x?ci(x):null,x!==null&&(w=Ei(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(h=null,x=d),h!==x)){if(g=Qy,_="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=Jy,_="onPointerLeave",v="onPointerEnter",y="pointer"),w=h==null?p:Ki(h),b=x==null?p:Ki(x),p=new g(_,y+"leave",h,n,u),p.target=w,p.relatedTarget=b,_=null,ci(u)===d&&(g=new g(v,y+"enter",x,n,u),g.target=b,g.relatedTarget=w,_=g),w=_,h&&x)t:{for(g=h,v=x,y=0,b=g;b;b=Pi(b))y++;for(b=0,_=v;_;_=Pi(_))b++;for(;0<y-b;)g=Pi(g),y--;for(;0<b-y;)v=Pi(v),b--;for(;y--;){if(g===v||v!==null&&g===v.alternate)break t;g=Pi(g),v=Pi(v)}g=null}else g=null;h!==null&&u0(f,p,h,g,!1),x!==null&&w!==null&&u0(f,w,x,g,!0)}}e:{if(p=d?Ki(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var j=n5;else if(n0(p))if(Ek)j=o5;else{j=i5;var k=r5}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(j=s5);if(j&&(j=j(e,d))){Ck(f,j,n,u);break e}k&&k(e,p,d),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&Eg(p,"number",p.value)}switch(k=d?Ki(d):window,e){case"focusin":(n0(k)||k.contentEditable==="true")&&(Vi=k,qg=d,jo=null);break;case"focusout":jo=qg=Vi=null;break;case"mousedown":$g=!0;break;case"contextmenu":case"mouseup":case"dragend":$g=!1,a0(f,n,u);break;case"selectionchange":if(c5)break;case"keydown":case"keyup":a0(f,n,u)}var N;if(ax)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ui?kk(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Sk&&n.locale!=="ko"&&(Ui||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ui&&(N=jk()):(Mr=u,ix="value"in Mr?Mr.value:Mr.textContent,Ui=!0)),k=Fl(d,E),0<k.length&&(E=new Zy(E,e,null,n,u),f.push({event:E,listeners:k}),N?E.data=N:(N=Nk(n),N!==null&&(E.data=N)))),(N=QA?ZA(e,n):JA(e,n))&&(d=Fl(d,"onBeforeInput"),0<d.length&&(u=new Zy("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:d}),u.data=N))}Fk(f,t)})}function $o(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fl(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Po(e,n),s!=null&&r.unshift($o(e,s,i)),s=Po(e,t),s!=null&&r.push($o(e,s,i))),e=e.return}return r}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function u0(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,i?(c=Po(n,s),c!=null&&o.unshift($o(n,c,l))):i||(c=Po(n,s),c!=null&&o.push($o(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var p5=/\r\n?/g,h5=/\u0000|\uFFFD/g;function d0(e){return(typeof e=="string"?e:""+e).replace(p5,`
`).replace(h5,"")}function Fa(e,t,n){if(t=d0(t),d0(e)!==t&&n)throw Error(ee(425))}function zl(){}var Bg=null,Hg=null;function Wg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ug=typeof setTimeout=="function"?setTimeout:void 0,m5=typeof clearTimeout=="function"?clearTimeout:void 0,f0=typeof Promise=="function"?Promise:void 0,g5=typeof queueMicrotask=="function"?queueMicrotask:typeof f0<"u"?function(e){return f0.resolve(null).then(e).catch(v5)}:Ug;function v5(e){setTimeout(function(){throw e})}function Bu(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Lo(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Lo(t)}function Fr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function p0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Rs=Math.random().toString(36).slice(2),qn="__reactFiber$"+Rs,Bo="__reactProps$"+Rs,ur="__reactContainer$"+Rs,Vg="__reactEvents$"+Rs,x5="__reactListeners$"+Rs,y5="__reactHandles$"+Rs;function ci(e){var t=e[qn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ur]||n[qn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=p0(e);e!==null;){if(n=e[qn])return n;e=p0(e)}return t}e=n,n=e.parentNode}return null}function pa(e){return e=e[qn]||e[ur],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ki(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function Ac(e){return e[Bo]||null}var Gg=[],Yi=-1;function Zr(e){return{current:e}}function Ve(e){0>Yi||(e.current=Gg[Yi],Gg[Yi]=null,Yi--)}function We(e,t){Yi++,Gg[Yi]=e.current,e.current=t}var Kr={},At=Zr(Kr),Wt=Zr(!1),bi=Kr;function gs(e,t){var n=e.type.contextTypes;if(!n)return Kr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ut(e){return e=e.childContextTypes,e!=null}function ql(){Ve(Wt),Ve(At)}function h0(e,t,n){if(At.current!==Kr)throw Error(ee(168));We(At,t),We(Wt,n)}function qk(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ee(108,rA(e)||"Unknown",i));return et({},n,r)}function $l(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Kr,bi=At.current,We(At,e),We(Wt,Wt.current),!0}function m0(e,t,n){var r=e.stateNode;if(!r)throw Error(ee(169));n?(e=qk(e,t,bi),r.__reactInternalMemoizedMergedChildContext=e,Ve(Wt),Ve(At),We(At,e)):Ve(Wt),We(Wt,n)}var er=null,Ic=!1,Hu=!1;function $k(e){er===null?er=[e]:er.push(e)}function b5(e){Ic=!0,$k(e)}function Jr(){if(!Hu&&er!==null){Hu=!0;var e=0,t=$e;try{var n=er;for($e=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}er=null,Ic=!1}catch(i){throw er!==null&&(er=er.slice(e+1)),fk(ex,Jr),i}finally{$e=t,Hu=!1}}return null}var Xi=[],Qi=0,Bl=null,Hl=0,dn=[],fn=0,wi=null,nr=1,rr="";function oi(e,t){Xi[Qi++]=Hl,Xi[Qi++]=Bl,Bl=e,Hl=t}function Bk(e,t,n){dn[fn++]=nr,dn[fn++]=rr,dn[fn++]=wi,wi=e;var r=nr;e=rr;var i=32-Tn(r)-1;r&=~(1<<i),n+=1;var s=32-Tn(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,nr=1<<32-Tn(t)+i|n<<i|r,rr=s+e}else nr=1<<s|n<<i|r,rr=e}function cx(e){e.return!==null&&(oi(e,1),Bk(e,1,0))}function ux(e){for(;e===Bl;)Bl=Xi[--Qi],Xi[Qi]=null,Hl=Xi[--Qi],Xi[Qi]=null;for(;e===wi;)wi=dn[--fn],dn[fn]=null,rr=dn[--fn],dn[fn]=null,nr=dn[--fn],dn[fn]=null}var tn=null,en=null,Ke=!1,Cn=null;function Hk(e,t){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function g0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,tn=e,en=Fr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,tn=e,en=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=wi!==null?{id:nr,overflow:rr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,tn=e,en=null,!0):!1;default:return!1}}function Kg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yg(e){if(Ke){var t=en;if(t){var n=t;if(!g0(e,t)){if(Kg(e))throw Error(ee(418));t=Fr(n.nextSibling);var r=tn;t&&g0(e,t)?Hk(r,n):(e.flags=e.flags&-4097|2,Ke=!1,tn=e)}}else{if(Kg(e))throw Error(ee(418));e.flags=e.flags&-4097|2,Ke=!1,tn=e}}}function v0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;tn=e}function za(e){if(e!==tn)return!1;if(!Ke)return v0(e),Ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Wg(e.type,e.memoizedProps)),t&&(t=en)){if(Kg(e))throw Wk(),Error(ee(418));for(;t;)Hk(e,t),t=Fr(t.nextSibling)}if(v0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){en=Fr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}en=null}}else en=tn?Fr(e.stateNode.nextSibling):null;return!0}function Wk(){for(var e=en;e;)e=Fr(e.nextSibling)}function vs(){en=tn=null,Ke=!1}function dx(e){Cn===null?Cn=[e]:Cn.push(e)}var w5=vr.ReactCurrentBatchConfig;function Vs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,e))}return e}function qa(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function x0(e){var t=e._init;return t(e._payload)}function Uk(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function n(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=Br(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,_){return y===null||y.tag!==6?(y=Xu(b,v.mode,_),y.return=v,y):(y=i(y,b),y.return=v,y)}function c(v,y,b,_){var j=b.type;return j===Wi?u(v,y,b.props.children,_,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jr&&x0(j)===y.type)?(_=i(y,b.props),_.ref=Vs(v,y,b),_.return=v,_):(_=kl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vs(v,y,b),_.return=v,_)}function d(v,y,b,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Qu(b,v.mode,_),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function u(v,y,b,_,j){return y===null||y.tag!==7?(y=gi(b,v.mode,_,j),y.return=v,y):(y=i(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Xu(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ta:return b=kl(y.type,y.key,y.props,null,v.mode,b),b.ref=Vs(v,null,y),b.return=v,b;case Hi:return y=Qu(y,v.mode,b),y.return=v,y;case jr:var _=y._init;return f(v,_(y._payload),b)}if(oo(y)||$s(y))return y=gi(y,v.mode,b,null),y.return=v,y;qa(v,y)}return null}function p(v,y,b,_){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,y,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ta:return b.key===j?c(v,y,b,_):null;case Hi:return b.key===j?d(v,y,b,_):null;case jr:return j=b._init,p(v,y,j(b._payload),_)}if(oo(b)||$s(b))return j!==null?null:u(v,y,b,_,null);qa(v,b)}return null}function h(v,y,b,_,j){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(b)||null,l(y,v,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ta:return v=v.get(_.key===null?b:_.key)||null,c(y,v,_,j);case Hi:return v=v.get(_.key===null?b:_.key)||null,d(y,v,_,j);case jr:var k=_._init;return h(v,y,b,k(_._payload),j)}if(oo(_)||$s(_))return v=v.get(b)||null,u(y,v,_,j,null);qa(y,_)}return null}function x(v,y,b,_){for(var j=null,k=null,N=y,E=y=0,S=null;N!==null&&E<b.length;E++){N.index>E?(S=N,N=null):S=N.sibling;var R=p(v,N,b[E],_);if(R===null){N===null&&(N=S);break}e&&N&&R.alternate===null&&t(v,N),y=s(R,y,E),k===null?j=R:k.sibling=R,k=R,N=S}if(E===b.length)return n(v,N),Ke&&oi(v,E),j;if(N===null){for(;E<b.length;E++)N=f(v,b[E],_),N!==null&&(y=s(N,y,E),k===null?j=N:k.sibling=N,k=N);return Ke&&oi(v,E),j}for(N=r(v,N);E<b.length;E++)S=h(N,v,E,b[E],_),S!==null&&(e&&S.alternate!==null&&N.delete(S.key===null?E:S.key),y=s(S,y,E),k===null?j=S:k.sibling=S,k=S);return e&&N.forEach(function(T){return t(v,T)}),Ke&&oi(v,E),j}function g(v,y,b,_){var j=$s(b);if(typeof j!="function")throw Error(ee(150));if(b=j.call(b),b==null)throw Error(ee(151));for(var k=j=null,N=y,E=y=0,S=null,R=b.next();N!==null&&!R.done;E++,R=b.next()){N.index>E?(S=N,N=null):S=N.sibling;var T=p(v,N,R.value,_);if(T===null){N===null&&(N=S);break}e&&N&&T.alternate===null&&t(v,N),y=s(T,y,E),k===null?j=T:k.sibling=T,k=T,N=S}if(R.done)return n(v,N),Ke&&oi(v,E),j;if(N===null){for(;!R.done;E++,R=b.next())R=f(v,R.value,_),R!==null&&(y=s(R,y,E),k===null?j=R:k.sibling=R,k=R);return Ke&&oi(v,E),j}for(N=r(v,N);!R.done;E++,R=b.next())R=h(N,v,E,R.value,_),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?E:R.key),y=s(R,y,E),k===null?j=R:k.sibling=R,k=R);return e&&N.forEach(function(M){return t(v,M)}),Ke&&oi(v,E),j}function w(v,y,b,_){if(typeof b=="object"&&b!==null&&b.type===Wi&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ta:e:{for(var j=b.key,k=y;k!==null;){if(k.key===j){if(j=b.type,j===Wi){if(k.tag===7){n(v,k.sibling),y=i(k,b.props.children),y.return=v,v=y;break e}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jr&&x0(j)===k.type){n(v,k.sibling),y=i(k,b.props),y.ref=Vs(v,k,b),y.return=v,v=y;break e}n(v,k);break}else t(v,k);k=k.sibling}b.type===Wi?(y=gi(b.props.children,v.mode,_,b.key),y.return=v,v=y):(_=kl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vs(v,y,b),_.return=v,v=_)}return o(v);case Hi:e:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else t(v,y);y=y.sibling}y=Qu(b,v.mode,_),y.return=v,v=y}return o(v);case jr:return k=b._init,w(v,y,k(b._payload),_)}if(oo(b))return x(v,y,b,_);if($s(b))return g(v,y,b,_);qa(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(v,y.sibling),y=i(y,b),y.return=v,v=y):(n(v,y),y=Xu(b,v.mode,_),y.return=v,v=y),o(v)):n(v,y)}return w}var xs=Uk(!0),Vk=Uk(!1),Wl=Zr(null),Ul=null,Zi=null,fx=null;function px(){fx=Zi=Ul=null}function hx(e){var t=Wl.current;Ve(Wl),e._currentValue=t}function Xg(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function cs(e,t){Ul=e,fx=Zi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($t=!0),e.firstContext=null)}function vn(e){var t=e._currentValue;if(fx!==e)if(e={context:e,memoizedValue:t,next:null},Zi===null){if(Ul===null)throw Error(ee(308));Zi=e,Ul.dependencies={lanes:0,firstContext:e}}else Zi=Zi.next=e;return t}var ui=null;function mx(e){ui===null?ui=[e]:ui.push(e)}function Gk(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,mx(t)):(n.next=i.next,i.next=n),t.interleaved=n,dr(e,r)}function dr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Sr=!1;function gx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ar(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Pe&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,dr(e,n)}return i=r.interleaved,i===null?(t.next=t,mx(r)):(t.next=i.next,i.next=t),r.interleaved=t,dr(e,n)}function yl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,tx(e,n)}}function y0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vl(e,t,n,r){var i=e.updateQueue;Sr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,u=d=c=null,l=s;do{var p=l.lane,h=l.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,g=l;switch(p=t,h=n,g.tag){case 1:if(x=g.payload,typeof x=="function"){f=x.call(h,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,p=typeof x=="function"?x.call(h,f,p):x,p==null)break e;f=et({},f,p);break e;case 2:Sr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,o|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ji|=o,e.lanes=o,e.memoizedState=f}}function b0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var ha={},Hn=Zr(ha),Ho=Zr(ha),Wo=Zr(ha);function di(e){if(e===ha)throw Error(ee(174));return e}function vx(e,t){switch(We(Wo,t),We(Ho,e),We(Hn,ha),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Rg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Rg(t,e)}Ve(Hn),We(Hn,t)}function ys(){Ve(Hn),Ve(Ho),Ve(Wo)}function Yk(e){di(Wo.current);var t=di(Hn.current),n=Rg(t,e.type);t!==n&&(We(Ho,e),We(Hn,n))}function xx(e){Ho.current===e&&(Ve(Hn),Ve(Ho))}var Ze=Zr(0);function Gl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wu=[];function yx(){for(var e=0;e<Wu.length;e++)Wu[e]._workInProgressVersionPrimary=null;Wu.length=0}var bl=vr.ReactCurrentDispatcher,Uu=vr.ReactCurrentBatchConfig,_i=0,Je=null,ct=null,ht=null,Kl=!1,So=!1,Uo=0,_5=0;function Ct(){throw Error(ee(321))}function bx(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!An(e[n],t[n]))return!1;return!0}function wx(e,t,n,r,i,s){if(_i=s,Je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bl.current=e===null||e.memoizedState===null?N5:C5,e=n(r,i),So){s=0;do{if(So=!1,Uo=0,25<=s)throw Error(ee(301));s+=1,ht=ct=null,t.updateQueue=null,bl.current=E5,e=n(r,i)}while(So)}if(bl.current=Yl,t=ct!==null&&ct.next!==null,_i=0,ht=ct=Je=null,Kl=!1,t)throw Error(ee(300));return e}function _x(){var e=Uo!==0;return Uo=0,e}function zn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Je.memoizedState=ht=e:ht=ht.next=e,ht}function xn(){if(ct===null){var e=Je.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=ht===null?Je.memoizedState:ht.next;if(t!==null)ht=t,ct=e;else{if(e===null)throw Error(ee(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},ht===null?Je.memoizedState=ht=e:ht=ht.next=e}return ht}function Vo(e,t){return typeof t=="function"?t(e):t}function Vu(e){var t=xn(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=ct,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((_i&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=r):c=c.next=f,Je.lanes|=u,ji|=u}d=d.next}while(d!==null&&d!==s);c===null?o=r:c.next=l,An(r,t.memoizedState)||($t=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,Je.lanes|=s,ji|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Gu(e){var t=xn(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);An(s,t.memoizedState)||($t=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Xk(){}function Qk(e,t){var n=Je,r=xn(),i=t(),s=!An(r.memoizedState,i);if(s&&(r.memoizedState=i,$t=!0),r=r.queue,jx(eN.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,Go(9,Jk.bind(null,n,r,i,t),void 0,null),gt===null)throw Error(ee(349));_i&30||Zk(n,t,i)}return i}function Zk(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Jk(e,t,n,r){t.value=n,t.getSnapshot=r,tN(t)&&nN(e)}function eN(e,t,n){return n(function(){tN(t)&&nN(e)})}function tN(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!An(e,n)}catch{return!0}}function nN(e){var t=dr(e,1);t!==null&&Rn(t,e,1,-1)}function w0(e){var t=zn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vo,lastRenderedState:e},t.queue=e,e=e.dispatch=k5.bind(null,Je,e),[t.memoizedState,e]}function Go(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function rN(){return xn().memoizedState}function wl(e,t,n,r){var i=zn();Je.flags|=e,i.memoizedState=Go(1|t,n,void 0,r===void 0?null:r)}function Mc(e,t,n,r){var i=xn();r=r===void 0?null:r;var s=void 0;if(ct!==null){var o=ct.memoizedState;if(s=o.destroy,r!==null&&bx(r,o.deps)){i.memoizedState=Go(t,n,s,r);return}}Je.flags|=e,i.memoizedState=Go(1|t,n,s,r)}function _0(e,t){return wl(8390656,8,e,t)}function jx(e,t){return Mc(2048,8,e,t)}function iN(e,t){return Mc(4,2,e,t)}function sN(e,t){return Mc(4,4,e,t)}function oN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function aN(e,t,n){return n=n!=null?n.concat([e]):null,Mc(4,4,oN.bind(null,t,e),n)}function Sx(){}function lN(e,t){var n=xn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&bx(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function cN(e,t){var n=xn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&bx(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function uN(e,t,n){return _i&21?(An(n,t)||(n=mk(),Je.lanes|=n,ji|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$t=!0),e.memoizedState=n)}function j5(e,t){var n=$e;$e=n!==0&&4>n?n:4,e(!0);var r=Uu.transition;Uu.transition={};try{e(!1),t()}finally{$e=n,Uu.transition=r}}function dN(){return xn().memoizedState}function S5(e,t,n){var r=$r(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},fN(e))pN(t,n);else if(n=Gk(e,t,n,r),n!==null){var i=Dt();Rn(n,e,r,i),hN(n,t,r)}}function k5(e,t,n){var r=$r(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(fN(e))pN(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,An(l,o)){var c=t.interleaved;c===null?(i.next=i,mx(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=Gk(e,t,i,r),n!==null&&(i=Dt(),Rn(n,e,r,i),hN(n,t,r))}}function fN(e){var t=e.alternate;return e===Je||t!==null&&t===Je}function pN(e,t){So=Kl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hN(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,tx(e,n)}}var Yl={readContext:vn,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},N5={readContext:vn,useCallback:function(e,t){return zn().memoizedState=[e,t===void 0?null:t],e},useContext:vn,useEffect:_0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,wl(4194308,4,oN.bind(null,t,e),n)},useLayoutEffect:function(e,t){return wl(4194308,4,e,t)},useInsertionEffect:function(e,t){return wl(4,2,e,t)},useMemo:function(e,t){var n=zn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=zn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=S5.bind(null,Je,e),[r.memoizedState,e]},useRef:function(e){var t=zn();return e={current:e},t.memoizedState=e},useState:w0,useDebugValue:Sx,useDeferredValue:function(e){return zn().memoizedState=e},useTransition:function(){var e=w0(!1),t=e[0];return e=j5.bind(null,e[1]),zn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Je,i=zn();if(Ke){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=t(),gt===null)throw Error(ee(349));_i&30||Zk(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,_0(eN.bind(null,r,s,e),[e]),r.flags|=2048,Go(9,Jk.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=zn(),t=gt.identifierPrefix;if(Ke){var n=rr,r=nr;n=(r&~(1<<32-Tn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Uo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=_5++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},C5={readContext:vn,useCallback:lN,useContext:vn,useEffect:jx,useImperativeHandle:aN,useInsertionEffect:iN,useLayoutEffect:sN,useMemo:cN,useReducer:Vu,useRef:rN,useState:function(){return Vu(Vo)},useDebugValue:Sx,useDeferredValue:function(e){var t=xn();return uN(t,ct.memoizedState,e)},useTransition:function(){var e=Vu(Vo)[0],t=xn().memoizedState;return[e,t]},useMutableSource:Xk,useSyncExternalStore:Qk,useId:dN,unstable_isNewReconciler:!1},E5={readContext:vn,useCallback:lN,useContext:vn,useEffect:jx,useImperativeHandle:aN,useInsertionEffect:iN,useLayoutEffect:sN,useMemo:cN,useReducer:Gu,useRef:rN,useState:function(){return Gu(Vo)},useDebugValue:Sx,useDeferredValue:function(e){var t=xn();return ct===null?t.memoizedState=e:uN(t,ct.memoizedState,e)},useTransition:function(){var e=Gu(Vo)[0],t=xn().memoizedState;return[e,t]},useMutableSource:Xk,useSyncExternalStore:Qk,useId:dN,unstable_isNewReconciler:!1};function Sn(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Qg(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:et({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Pc={isMounted:function(e){return(e=e._reactInternals)?Ei(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Dt(),i=$r(e),s=ar(r,i);s.payload=t,n!=null&&(s.callback=n),t=zr(e,s,i),t!==null&&(Rn(t,e,i,r),yl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Dt(),i=$r(e),s=ar(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=zr(e,s,i),t!==null&&(Rn(t,e,i,r),yl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Dt(),r=$r(e),i=ar(n,r);i.tag=2,t!=null&&(i.callback=t),t=zr(e,i,r),t!==null&&(Rn(t,e,r,n),yl(t,e,r))}};function j0(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!zo(n,r)||!zo(i,s):!0}function mN(e,t,n){var r=!1,i=Kr,s=t.contextType;return typeof s=="object"&&s!==null?s=vn(s):(i=Ut(t)?bi:At.current,r=t.contextTypes,s=(r=r!=null)?gs(e,i):Kr),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Pc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function S0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Pc.enqueueReplaceState(t,t.state,null)}function Zg(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},gx(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=vn(s):(s=Ut(t)?bi:At.current,i.context=gs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Qg(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Pc.enqueueReplaceState(i,i.state,null),Vl(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function bs(e,t){try{var n="",r=t;do n+=nA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Ku(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Jg(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var T5=typeof WeakMap=="function"?WeakMap:Map;function gN(e,t,n){n=ar(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ql||(Ql=!0,cv=r),Jg(e,t)},n}function vN(e,t,n){n=ar(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Jg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Jg(e,t),typeof r!="function"&&(qr===null?qr=new Set([this]):qr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function k0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new T5;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=H5.bind(null,e,t,n),t.then(e,e))}function N0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function C0(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ar(-1,1),t.tag=2,zr(n,t,1))),n.lanes|=1),e)}var R5=vr.ReactCurrentOwner,$t=!1;function Pt(e,t,n,r){t.child=e===null?Vk(t,null,n,r):xs(t,e.child,n,r)}function E0(e,t,n,r,i){n=n.render;var s=t.ref;return cs(t,i),r=wx(e,t,n,r,s,i),n=_x(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fr(e,t,i)):(Ke&&n&&cx(t),t.flags|=1,Pt(e,t,r,i),t.child)}function T0(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!Ix(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,xN(e,t,s,r,i)):(e=kl(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:zo,n(o,r)&&e.ref===t.ref)return fr(e,t,i)}return t.flags|=1,e=Br(s,r),e.ref=t.ref,e.return=t,t.child=e}function xN(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(zo(s,r)&&e.ref===t.ref)if($t=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&($t=!0);else return t.lanes=e.lanes,fr(e,t,i)}return ev(e,t,n,r,i)}function yN(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(es,Zt),Zt|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,We(es,Zt),Zt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,We(es,Zt),Zt|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,We(es,Zt),Zt|=r;return Pt(e,t,i,n),t.child}function bN(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ev(e,t,n,r,i){var s=Ut(n)?bi:At.current;return s=gs(t,s),cs(t,i),n=wx(e,t,n,r,s,i),r=_x(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fr(e,t,i)):(Ke&&r&&cx(t),t.flags|=1,Pt(e,t,n,i),t.child)}function R0(e,t,n,r,i){if(Ut(n)){var s=!0;$l(t)}else s=!1;if(cs(t,i),t.stateNode===null)_l(e,t),mN(t,n,r),Zg(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=vn(d):(d=Ut(n)?bi:At.current,d=gs(t,d));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&S0(t,o,r,d),Sr=!1;var p=t.memoizedState;o.state=p,Vl(t,r,o,i),c=t.memoizedState,l!==r||p!==c||Wt.current||Sr?(typeof u=="function"&&(Qg(t,n,u,r),c=t.memoizedState),(l=Sr||j0(t,n,l,r,p,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Kk(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Sn(t.type,l),o.props=d,f=t.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=vn(c):(c=Ut(n)?bi:At.current,c=gs(t,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&S0(t,o,r,c),Sr=!1,p=t.memoizedState,o.state=p,Vl(t,r,o,i);var x=t.memoizedState;l!==f||p!==x||Wt.current||Sr?(typeof h=="function"&&(Qg(t,n,h,r),x=t.memoizedState),(d=Sr||j0(t,n,d,r,p,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return tv(e,t,n,r,s,i)}function tv(e,t,n,r,i,s){bN(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&m0(t,n,!1),fr(e,t,s);r=t.stateNode,R5.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=xs(t,e.child,null,s),t.child=xs(t,null,l,s)):Pt(e,t,l,s),t.memoizedState=r.state,i&&m0(t,n,!0),t.child}function wN(e){var t=e.stateNode;t.pendingContext?h0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&h0(e,t.context,!1),vx(e,t.containerInfo)}function A0(e,t,n,r,i){return vs(),dx(i),t.flags|=256,Pt(e,t,n,r),t.child}var nv={dehydrated:null,treeContext:null,retryLane:0};function rv(e){return{baseLanes:e,cachePool:null,transitions:null}}function _N(e,t,n){var r=t.pendingProps,i=Ze.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),We(Ze,i&1),e===null)return Yg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Lc(o,r,0,null),e=gi(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=rv(n),t.memoizedState=nv,e):kx(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return A5(e,t,o,r,l,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Br(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Br(l,s):(s=gi(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?rv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=nv,r}return s=e.child,e=s.sibling,r=Br(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function kx(e,t){return t=Lc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $a(e,t,n,r){return r!==null&&dx(r),xs(t,e.child,null,n),e=kx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function A5(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=Ku(Error(ee(422))),$a(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Lc({mode:"visible",children:r.children},i,0,null),s=gi(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&xs(t,e.child,null,o),t.child.memoizedState=rv(o),t.memoizedState=nv,s);if(!(t.mode&1))return $a(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(ee(419)),r=Ku(s,r,void 0),$a(e,t,o,r)}if(l=(o&e.childLanes)!==0,$t||l){if(r=gt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,dr(e,i),Rn(r,e,i,-1))}return Ax(),r=Ku(Error(ee(421))),$a(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=W5.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,en=Fr(i.nextSibling),tn=t,Ke=!0,Cn=null,e!==null&&(dn[fn++]=nr,dn[fn++]=rr,dn[fn++]=wi,nr=e.id,rr=e.overflow,wi=t),t=kx(t,r.children),t.flags|=4096,t)}function I0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Xg(e.return,t,n)}function Yu(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function jN(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Pt(e,t,r.children,n),r=Ze.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&I0(e,n,t);else if(e.tag===19)I0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(We(Ze,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Gl(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Yu(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Gl(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Yu(t,!0,n,null,s);break;case"together":Yu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function _l(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ji|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,n=Br(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Br(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function I5(e,t,n){switch(t.tag){case 3:wN(t),vs();break;case 5:Yk(t);break;case 1:Ut(t.type)&&$l(t);break;case 4:vx(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;We(Wl,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(We(Ze,Ze.current&1),t.flags|=128,null):n&t.child.childLanes?_N(e,t,n):(We(Ze,Ze.current&1),e=fr(e,t,n),e!==null?e.sibling:null);We(Ze,Ze.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return jN(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(Ze,Ze.current),r)break;return null;case 22:case 23:return t.lanes=0,yN(e,t,n)}return fr(e,t,n)}var SN,iv,kN,NN;SN=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};iv=function(){};kN=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,di(Hn.current);var s=null;switch(n){case"input":i=Ng(e,i),r=Ng(e,r),s=[];break;case"select":i=et({},i,{value:void 0}),r=et({},r,{value:void 0}),s=[];break;case"textarea":i=Tg(e,i),r=Tg(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=zl)}Ag(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Io.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Io.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ue("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};NN=function(e,t,n,r){n!==r&&(t.flags|=4)};function Gs(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Et(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function M5(e,t,n){var r=t.pendingProps;switch(ux(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(t),null;case 1:return Ut(t.type)&&ql(),Et(t),null;case 3:return r=t.stateNode,ys(),Ve(Wt),Ve(At),yx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(za(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cn!==null&&(fv(Cn),Cn=null))),iv(e,t),Et(t),null;case 5:xx(t);var i=di(Wo.current);if(n=t.type,e!==null&&t.stateNode!=null)kN(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ee(166));return Et(t),null}if(e=di(Hn.current),za(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[qn]=t,r[Bo]=s,e=(t.mode&1)!==0,n){case"dialog":Ue("cancel",r),Ue("close",r);break;case"iframe":case"object":case"embed":Ue("load",r);break;case"video":case"audio":for(i=0;i<lo.length;i++)Ue(lo[i],r);break;case"source":Ue("error",r);break;case"img":case"image":case"link":Ue("error",r),Ue("load",r);break;case"details":Ue("toggle",r);break;case"input":$y(r,s),Ue("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ue("invalid",r);break;case"textarea":Hy(r,s),Ue("invalid",r)}Ag(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Fa(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Fa(r.textContent,l,e),i=["children",""+l]):Io.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ue("scroll",r)}switch(n){case"input":Ra(r),By(r,s,!0);break;case"textarea":Ra(r),Wy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=zl)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ek(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[qn]=t,e[Bo]=r,SN(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ig(n,r),n){case"dialog":Ue("cancel",e),Ue("close",e),i=r;break;case"iframe":case"object":case"embed":Ue("load",e),i=r;break;case"video":case"audio":for(i=0;i<lo.length;i++)Ue(lo[i],e);i=r;break;case"source":Ue("error",e),i=r;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),i=r;break;case"details":Ue("toggle",e),i=r;break;case"input":$y(e,r),i=Ng(e,r),Ue("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=et({},r,{value:void 0}),Ue("invalid",e);break;case"textarea":Hy(e,r),i=Tg(e,r),Ue("invalid",e);break;default:i=r}Ag(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?rk(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&tk(e,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Mo(e,c):typeof c=="number"&&Mo(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Io.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ue("scroll",e):c!=null&&Yv(e,s,c,o))}switch(n){case"input":Ra(e),By(e,r,!1);break;case"textarea":Ra(e),Wy(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Gr(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?ss(e,!!r.multiple,s,!1):r.defaultValue!=null&&ss(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=zl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Et(t),null;case 6:if(e&&t.stateNode!=null)NN(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ee(166));if(n=di(Wo.current),di(Hn.current),za(t)){if(r=t.stateNode,n=t.memoizedProps,r[qn]=t,(s=r.nodeValue!==n)&&(e=tn,e!==null))switch(e.tag){case 3:Fa(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Fa(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qn]=t,t.stateNode=r}return Et(t),null;case 13:if(Ve(Ze),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ke&&en!==null&&t.mode&1&&!(t.flags&128))Wk(),vs(),t.flags|=98560,s=!1;else if(s=za(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(ee(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[qn]=t}else vs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Et(t),s=!1}else Cn!==null&&(fv(Cn),Cn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ze.current&1?ft===0&&(ft=3):Ax())),t.updateQueue!==null&&(t.flags|=4),Et(t),null);case 4:return ys(),iv(e,t),e===null&&qo(t.stateNode.containerInfo),Et(t),null;case 10:return hx(t.type._context),Et(t),null;case 17:return Ut(t.type)&&ql(),Et(t),null;case 19:if(Ve(Ze),s=t.memoizedState,s===null)return Et(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)Gs(s,!1);else{if(ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Gl(e),o!==null){for(t.flags|=128,Gs(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return We(Ze,Ze.current&1|2),t.child}e=e.sibling}s.tail!==null&&rt()>ws&&(t.flags|=128,r=!0,Gs(s,!1),t.lanes=4194304)}else{if(!r)if(e=Gl(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Gs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ke)return Et(t),null}else 2*rt()-s.renderingStartTime>ws&&n!==1073741824&&(t.flags|=128,r=!0,Gs(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=rt(),t.sibling=null,n=Ze.current,We(Ze,r?n&1|2:n&1),t):(Et(t),null);case 22:case 23:return Rx(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Zt&1073741824&&(Et(t),t.subtreeFlags&6&&(t.flags|=8192)):Et(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function P5(e,t){switch(ux(t),t.tag){case 1:return Ut(t.type)&&ql(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ys(),Ve(Wt),Ve(At),yx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return xx(t),null;case 13:if(Ve(Ze),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ve(Ze),null;case 4:return ys(),null;case 10:return hx(t.type._context),null;case 22:case 23:return Rx(),null;case 24:return null;default:return null}}var Ba=!1,Rt=!1,O5=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Ji(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tt(e,t,r)}else n.current=null}function sv(e,t,n){try{n()}catch(r){tt(e,t,r)}}var M0=!1;function D5(e,t){if(Bg=Dl,e=Ak(),lx(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(l=o+i),f!==s||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===n&&++d===i&&(l=o),p===s&&++u===r&&(c=o),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hg={focusedElem:e,selectionRange:n},Dl=!1,oe=t;oe!==null;)if(t=oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,oe=e;else for(;oe!==null;){t=oe;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,w=x.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Sn(t.type,g),w);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(_){tt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,oe=e;break}oe=t.return}return x=M0,M0=!1,x}function ko(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&sv(t,n,s)}i=i.next}while(i!==r)}}function Oc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ov(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function CN(e){var t=e.alternate;t!==null&&(e.alternate=null,CN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qn],delete t[Bo],delete t[Vg],delete t[x5],delete t[y5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function EN(e){return e.tag===5||e.tag===3||e.tag===4}function P0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||EN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function av(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=zl));else if(r!==4&&(e=e.child,e!==null))for(av(e,t,n),e=e.sibling;e!==null;)av(e,t,n),e=e.sibling}function lv(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(lv(e,t,n),e=e.sibling;e!==null;)lv(e,t,n),e=e.sibling}var wt=null,kn=!1;function br(e,t,n){for(n=n.child;n!==null;)TN(e,t,n),n=n.sibling}function TN(e,t,n){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Cc,n)}catch{}switch(n.tag){case 5:Rt||Ji(n,t);case 6:var r=wt,i=kn;wt=null,br(e,t,n),wt=r,kn=i,wt!==null&&(kn?(e=wt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):wt.removeChild(n.stateNode));break;case 18:wt!==null&&(kn?(e=wt,n=n.stateNode,e.nodeType===8?Bu(e.parentNode,n):e.nodeType===1&&Bu(e,n),Lo(e)):Bu(wt,n.stateNode));break;case 4:r=wt,i=kn,wt=n.stateNode.containerInfo,kn=!0,br(e,t,n),wt=r,kn=i;break;case 0:case 11:case 14:case 15:if(!Rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&sv(n,t,o),i=i.next}while(i!==r)}br(e,t,n);break;case 1:if(!Rt&&(Ji(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){tt(n,t,l)}br(e,t,n);break;case 21:br(e,t,n);break;case 22:n.mode&1?(Rt=(r=Rt)||n.memoizedState!==null,br(e,t,n),Rt=r):br(e,t,n);break;default:br(e,t,n)}}function O0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new O5),t.forEach(function(r){var i=U5.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function _n(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:wt=l.stateNode,kn=!1;break e;case 3:wt=l.stateNode.containerInfo,kn=!0;break e;case 4:wt=l.stateNode.containerInfo,kn=!0;break e}l=l.return}if(wt===null)throw Error(ee(160));TN(s,o,i),wt=null,kn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){tt(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)RN(t,e),t=t.sibling}function RN(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_n(t,e),Ln(e),r&4){try{ko(3,e,e.return),Oc(3,e)}catch(g){tt(e,e.return,g)}try{ko(5,e,e.return)}catch(g){tt(e,e.return,g)}}break;case 1:_n(t,e),Ln(e),r&512&&n!==null&&Ji(n,n.return);break;case 5:if(_n(t,e),Ln(e),r&512&&n!==null&&Ji(n,n.return),e.flags&32){var i=e.stateNode;try{Mo(i,"")}catch(g){tt(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&ZS(i,s),Ig(l,o);var d=Ig(l,s);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?rk(i,f):u==="dangerouslySetInnerHTML"?tk(i,f):u==="children"?Mo(i,f):Yv(i,u,f,d)}switch(l){case"input":Cg(i,s);break;case"textarea":JS(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?ss(i,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?ss(i,!!s.multiple,s.defaultValue,!0):ss(i,!!s.multiple,s.multiple?[]:"",!1))}i[Bo]=s}catch(g){tt(e,e.return,g)}}break;case 6:if(_n(t,e),Ln(e),r&4){if(e.stateNode===null)throw Error(ee(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){tt(e,e.return,g)}}break;case 3:if(_n(t,e),Ln(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Lo(t.containerInfo)}catch(g){tt(e,e.return,g)}break;case 4:_n(t,e),Ln(e);break;case 13:_n(t,e),Ln(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ex=rt())),r&4&&O0(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(Rt=(d=Rt)||u,_n(t,e),Rt=d):_n(t,e),Ln(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(oe=e,u=e.child;u!==null;){for(f=oe=u;oe!==null;){switch(p=oe,h=p.child,p.tag){case 0:case 11:case 14:case 15:ko(4,p,p.return);break;case 1:Ji(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){tt(r,n,g)}}break;case 5:Ji(p,p.return);break;case 22:if(p.memoizedState!==null){L0(f);continue}}h!==null?(h.return=p,oe=h):L0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=nk("display",o))}catch(g){tt(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){tt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:_n(t,e),Ln(e),r&4&&O0(e);break;case 21:break;default:_n(t,e),Ln(e)}}function Ln(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(EN(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Mo(i,""),r.flags&=-33);var s=P0(e);lv(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=P0(e);av(e,l,o);break;default:throw Error(ee(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function L5(e,t,n){oe=e,AN(e)}function AN(e,t,n){for(var r=(e.mode&1)!==0;oe!==null;){var i=oe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ba;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Rt;l=Ba;var d=Rt;if(Ba=o,(Rt=c)&&!d)for(oe=i;oe!==null;)o=oe,c=o.child,o.tag===22&&o.memoizedState!==null?F0(i):c!==null?(c.return=o,oe=c):F0(i);for(;s!==null;)oe=s,AN(s),s=s.sibling;oe=i,Ba=l,Rt=d}D0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,oe=s):D0(e)}}function D0(e){for(;oe!==null;){var t=oe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Rt||Oc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Rt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Sn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&b0(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}b0(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Lo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Rt||t.flags&512&&ov(t)}catch(p){tt(t,t.return,p)}}if(t===e){oe=null;break}if(n=t.sibling,n!==null){n.return=t.return,oe=n;break}oe=t.return}}function L0(e){for(;oe!==null;){var t=oe;if(t===e){oe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,oe=n;break}oe=t.return}}function F0(e){for(;oe!==null;){var t=oe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Oc(4,t)}catch(c){tt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){tt(t,i,c)}}var s=t.return;try{ov(t)}catch(c){tt(t,s,c)}break;case 5:var o=t.return;try{ov(t)}catch(c){tt(t,o,c)}}}catch(c){tt(t,t.return,c)}if(t===e){oe=null;break}var l=t.sibling;if(l!==null){l.return=t.return,oe=l;break}oe=t.return}}var F5=Math.ceil,Xl=vr.ReactCurrentDispatcher,Nx=vr.ReactCurrentOwner,gn=vr.ReactCurrentBatchConfig,Pe=0,gt=null,it=null,_t=0,Zt=0,es=Zr(0),ft=0,Ko=null,ji=0,Dc=0,Cx=0,No=null,qt=null,Ex=0,ws=1/0,Jn=null,Ql=!1,cv=null,qr=null,Ha=!1,Pr=null,Zl=0,Co=0,uv=null,jl=-1,Sl=0;function Dt(){return Pe&6?rt():jl!==-1?jl:jl=rt()}function $r(e){return e.mode&1?Pe&2&&_t!==0?_t&-_t:w5.transition!==null?(Sl===0&&(Sl=mk()),Sl):(e=$e,e!==0||(e=window.event,e=e===void 0?16:_k(e.type)),e):1}function Rn(e,t,n,r){if(50<Co)throw Co=0,uv=null,Error(ee(185));da(e,n,r),(!(Pe&2)||e!==gt)&&(e===gt&&(!(Pe&2)&&(Dc|=n),ft===4&&Tr(e,_t)),Vt(e,r),n===1&&Pe===0&&!(t.mode&1)&&(ws=rt()+500,Ic&&Jr()))}function Vt(e,t){var n=e.callbackNode;wA(e,t);var r=Ol(e,e===gt?_t:0);if(r===0)n!==null&&Gy(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Gy(n),t===1)e.tag===0?b5(z0.bind(null,e)):$k(z0.bind(null,e)),g5(function(){!(Pe&6)&&Jr()}),n=null;else{switch(gk(r)){case 1:n=ex;break;case 4:n=pk;break;case 16:n=Pl;break;case 536870912:n=hk;break;default:n=Pl}n=zN(n,IN.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function IN(e,t){if(jl=-1,Sl=0,Pe&6)throw Error(ee(327));var n=e.callbackNode;if(us()&&e.callbackNode!==n)return null;var r=Ol(e,e===gt?_t:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Jl(e,r);else{t=r;var i=Pe;Pe|=2;var s=PN();(gt!==e||_t!==t)&&(Jn=null,ws=rt()+500,mi(e,t));do try{$5();break}catch(l){MN(e,l)}while(!0);px(),Xl.current=s,Pe=i,it!==null?t=0:(gt=null,_t=0,t=ft)}if(t!==0){if(t===2&&(i=Lg(e),i!==0&&(r=i,t=dv(e,i))),t===1)throw n=Ko,mi(e,0),Tr(e,r),Vt(e,rt()),n;if(t===6)Tr(e,r);else{if(i=e.current.alternate,!(r&30)&&!z5(i)&&(t=Jl(e,r),t===2&&(s=Lg(e),s!==0&&(r=s,t=dv(e,s))),t===1))throw n=Ko,mi(e,0),Tr(e,r),Vt(e,rt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ee(345));case 2:ai(e,qt,Jn);break;case 3:if(Tr(e,r),(r&130023424)===r&&(t=Ex+500-rt(),10<t)){if(Ol(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Dt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ug(ai.bind(null,e,qt,Jn),t);break}ai(e,qt,Jn);break;case 4:if(Tr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Tn(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*F5(r/1960))-r,10<r){e.timeoutHandle=Ug(ai.bind(null,e,qt,Jn),r);break}ai(e,qt,Jn);break;case 5:ai(e,qt,Jn);break;default:throw Error(ee(329))}}}return Vt(e,rt()),e.callbackNode===n?IN.bind(null,e):null}function dv(e,t){var n=No;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=Jl(e,t),e!==2&&(t=qt,qt=n,t!==null&&fv(t)),e}function fv(e){qt===null?qt=e:qt.push.apply(qt,e)}function z5(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!An(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tr(e,t){for(t&=~Cx,t&=~Dc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Tn(t),r=1<<n;e[n]=-1,t&=~r}}function z0(e){if(Pe&6)throw Error(ee(327));us();var t=Ol(e,0);if(!(t&1))return Vt(e,rt()),null;var n=Jl(e,t);if(e.tag!==0&&n===2){var r=Lg(e);r!==0&&(t=r,n=dv(e,r))}if(n===1)throw n=Ko,mi(e,0),Tr(e,t),Vt(e,rt()),n;if(n===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ai(e,qt,Jn),Vt(e,rt()),null}function Tx(e,t){var n=Pe;Pe|=1;try{return e(t)}finally{Pe=n,Pe===0&&(ws=rt()+500,Ic&&Jr())}}function Si(e){Pr!==null&&Pr.tag===0&&!(Pe&6)&&us();var t=Pe;Pe|=1;var n=gn.transition,r=$e;try{if(gn.transition=null,$e=1,e)return e()}finally{$e=r,gn.transition=n,Pe=t,!(Pe&6)&&Jr()}}function Rx(){Zt=es.current,Ve(es)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,m5(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(ux(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ql();break;case 3:ys(),Ve(Wt),Ve(At),yx();break;case 5:xx(r);break;case 4:ys();break;case 13:Ve(Ze);break;case 19:Ve(Ze);break;case 10:hx(r.type._context);break;case 22:case 23:Rx()}n=n.return}if(gt=e,it=e=Br(e.current,null),_t=Zt=t,ft=0,Ko=null,Cx=Dc=ji=0,qt=No=null,ui!==null){for(t=0;t<ui.length;t++)if(n=ui[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ui=null}return e}function MN(e,t){do{var n=it;try{if(px(),bl.current=Yl,Kl){for(var r=Je.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Kl=!1}if(_i=0,ht=ct=Je=null,So=!1,Uo=0,Nx.current=null,n===null||n.return===null){ft=1,Ko=t,it=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=_t,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=N0(o);if(h!==null){h.flags&=-257,C0(h,o,l,s,t),h.mode&1&&k0(s,d,t),t=h,c=d;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){k0(s,d,t),Ax();break e}c=Error(ee(426))}}else if(Ke&&l.mode&1){var w=N0(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),C0(w,o,l,s,t),dx(bs(c,l));break e}}s=c=bs(c,l),ft!==4&&(ft=2),No===null?No=[s]:No.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=gN(s,c,t);y0(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qr===null||!qr.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=vN(s,l,t);y0(s,_);break e}}s=s.return}while(s!==null)}DN(n)}catch(j){t=j,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function PN(){var e=Xl.current;return Xl.current=Yl,e===null?Yl:e}function Ax(){(ft===0||ft===3||ft===2)&&(ft=4),gt===null||!(ji&268435455)&&!(Dc&268435455)||Tr(gt,_t)}function Jl(e,t){var n=Pe;Pe|=2;var r=PN();(gt!==e||_t!==t)&&(Jn=null,mi(e,t));do try{q5();break}catch(i){MN(e,i)}while(!0);if(px(),Pe=n,Xl.current=r,it!==null)throw Error(ee(261));return gt=null,_t=0,ft}function q5(){for(;it!==null;)ON(it)}function $5(){for(;it!==null&&!fA();)ON(it)}function ON(e){var t=FN(e.alternate,e,Zt);e.memoizedProps=e.pendingProps,t===null?DN(e):it=t,Nx.current=null}function DN(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=P5(n,t),n!==null){n.flags&=32767,it=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ft=6,it=null;return}}else if(n=M5(n,t,Zt),n!==null){it=n;return}if(t=t.sibling,t!==null){it=t;return}it=t=e}while(t!==null);ft===0&&(ft=5)}function ai(e,t,n){var r=$e,i=gn.transition;try{gn.transition=null,$e=1,B5(e,t,n,r)}finally{gn.transition=i,$e=r}return null}function B5(e,t,n,r){do us();while(Pr!==null);if(Pe&6)throw Error(ee(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(_A(e,s),e===gt&&(it=gt=null,_t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ha||(Ha=!0,zN(Pl,function(){return us(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=gn.transition,gn.transition=null;var o=$e;$e=1;var l=Pe;Pe|=4,Nx.current=null,D5(e,n),RN(n,e),l5(Hg),Dl=!!Bg,Hg=Bg=null,e.current=n,L5(n),pA(),Pe=l,$e=o,gn.transition=s}else e.current=n;if(Ha&&(Ha=!1,Pr=e,Zl=i),s=e.pendingLanes,s===0&&(qr=null),gA(n.stateNode),Vt(e,rt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ql)throw Ql=!1,e=cv,cv=null,e;return Zl&1&&e.tag!==0&&us(),s=e.pendingLanes,s&1?e===uv?Co++:(Co=0,uv=e):Co=0,Jr(),null}function us(){if(Pr!==null){var e=gk(Zl),t=gn.transition,n=$e;try{if(gn.transition=null,$e=16>e?16:e,Pr===null)var r=!1;else{if(e=Pr,Pr=null,Zl=0,Pe&6)throw Error(ee(331));var i=Pe;for(Pe|=4,oe=e.current;oe!==null;){var s=oe,o=s.child;if(oe.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(oe=d;oe!==null;){var u=oe;switch(u.tag){case 0:case 11:case 15:ko(8,u,s)}var f=u.child;if(f!==null)f.return=u,oe=f;else for(;oe!==null;){u=oe;var p=u.sibling,h=u.return;if(CN(u),u===d){oe=null;break}if(p!==null){p.return=h,oe=p;break}oe=h}}}var x=s.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}oe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,oe=o;else e:for(;oe!==null;){if(s=oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ko(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,oe=v;break e}oe=s.return}}var y=e.current;for(oe=y;oe!==null;){o=oe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,oe=b;else e:for(o=y;oe!==null;){if(l=oe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Oc(9,l)}}catch(j){tt(l,l.return,j)}if(l===o){oe=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,oe=_;break e}oe=l.return}}if(Pe=i,Jr(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Cc,e)}catch{}r=!0}return r}finally{$e=n,gn.transition=t}}return!1}function q0(e,t,n){t=bs(n,t),t=gN(e,t,1),e=zr(e,t,1),t=Dt(),e!==null&&(da(e,1,t),Vt(e,t))}function tt(e,t,n){if(e.tag===3)q0(e,e,n);else for(;t!==null;){if(t.tag===3){q0(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qr===null||!qr.has(r))){e=bs(n,e),e=vN(t,e,1),t=zr(t,e,1),e=Dt(),t!==null&&(da(t,1,e),Vt(t,e));break}}t=t.return}}function H5(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Dt(),e.pingedLanes|=e.suspendedLanes&n,gt===e&&(_t&n)===n&&(ft===4||ft===3&&(_t&130023424)===_t&&500>rt()-Ex?mi(e,0):Cx|=n),Vt(e,t)}function LN(e,t){t===0&&(e.mode&1?(t=Ma,Ma<<=1,!(Ma&130023424)&&(Ma=4194304)):t=1);var n=Dt();e=dr(e,t),e!==null&&(da(e,t,n),Vt(e,n))}function W5(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),LN(e,n)}function U5(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(t),LN(e,n)}var FN;FN=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wt.current)$t=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return $t=!1,I5(e,t,n);$t=!!(e.flags&131072)}else $t=!1,Ke&&t.flags&1048576&&Bk(t,Hl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;_l(e,t),e=t.pendingProps;var i=gs(t,At.current);cs(t,n),i=wx(null,t,r,e,i,n);var s=_x();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ut(r)?(s=!0,$l(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,gx(t),i.updater=Pc,t.stateNode=i,i._reactInternals=t,Zg(t,r,e,n),t=tv(null,t,r,!0,s,n)):(t.tag=0,Ke&&s&&cx(t),Pt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(_l(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=G5(r),e=Sn(r,e),i){case 0:t=ev(null,t,r,e,n);break e;case 1:t=R0(null,t,r,e,n);break e;case 11:t=E0(null,t,r,e,n);break e;case 14:t=T0(null,t,r,Sn(r.type,e),n);break e}throw Error(ee(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),ev(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),R0(e,t,r,i,n);case 3:e:{if(wN(t),e===null)throw Error(ee(387));r=t.pendingProps,s=t.memoizedState,i=s.element,Kk(e,t),Vl(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=bs(Error(ee(423)),t),t=A0(e,t,r,n,i);break e}else if(r!==i){i=bs(Error(ee(424)),t),t=A0(e,t,r,n,i);break e}else for(en=Fr(t.stateNode.containerInfo.firstChild),tn=t,Ke=!0,Cn=null,n=Vk(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vs(),r===i){t=fr(e,t,n);break e}Pt(e,t,r,n)}t=t.child}return t;case 5:return Yk(t),e===null&&Yg(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Wg(r,i)?o=null:s!==null&&Wg(r,s)&&(t.flags|=32),bN(e,t),Pt(e,t,o,n),t.child;case 6:return e===null&&Yg(t),null;case 13:return _N(e,t,n);case 4:return vx(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=xs(t,null,r,n):Pt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),E0(e,t,r,i,n);case 7:return Pt(e,t,t.pendingProps,n),t.child;case 8:return Pt(e,t,t.pendingProps.children,n),t.child;case 12:return Pt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,We(Wl,r._currentValue),r._currentValue=o,s!==null)if(An(s.value,o)){if(s.children===i.children&&!Wt.current){t=fr(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=ar(-1,n&-n),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Xg(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Xg(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Pt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,cs(t,n),i=vn(i),r=r(i),t.flags|=1,Pt(e,t,r,n),t.child;case 14:return r=t.type,i=Sn(r,t.pendingProps),i=Sn(r.type,i),T0(e,t,r,i,n);case 15:return xN(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),_l(e,t),t.tag=1,Ut(r)?(e=!0,$l(t)):e=!1,cs(t,n),mN(t,r,i),Zg(t,r,i,n),tv(null,t,r,!0,e,n);case 19:return jN(e,t,n);case 22:return yN(e,t,n)}throw Error(ee(156,t.tag))};function zN(e,t){return fk(e,t)}function V5(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(e,t,n,r){return new V5(e,t,n,r)}function Ix(e){return e=e.prototype,!(!e||!e.isReactComponent)}function G5(e){if(typeof e=="function")return Ix(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qv)return 11;if(e===Zv)return 14}return 2}function Br(e,t){var n=e.alternate;return n===null?(n=hn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function kl(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")Ix(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Wi:return gi(n.children,i,s,t);case Xv:o=8,i|=8;break;case _g:return e=hn(12,n,t,i|2),e.elementType=_g,e.lanes=s,e;case jg:return e=hn(13,n,t,i),e.elementType=jg,e.lanes=s,e;case Sg:return e=hn(19,n,t,i),e.elementType=Sg,e.lanes=s,e;case YS:return Lc(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case GS:o=10;break e;case KS:o=9;break e;case Qv:o=11;break e;case Zv:o=14;break e;case jr:o=16,r=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=hn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function gi(e,t,n,r){return e=hn(7,e,r,t),e.lanes=n,e}function Lc(e,t,n,r){return e=hn(22,e,r,t),e.elementType=YS,e.lanes=n,e.stateNode={isHidden:!1},e}function Xu(e,t,n){return e=hn(6,e,null,t),e.lanes=n,e}function Qu(e,t,n){return t=hn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function K5(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Au(0),this.expirationTimes=Au(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Au(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Mx(e,t,n,r,i,s,o,l,c){return e=new K5(e,t,n,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=hn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gx(s),e}function Y5(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function qN(e){if(!e)return Kr;e=e._reactInternals;e:{if(Ei(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ut(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var n=e.type;if(Ut(n))return qk(e,n,t)}return t}function $N(e,t,n,r,i,s,o,l,c){return e=Mx(n,r,!0,e,i,s,o,l,c),e.context=qN(null),n=e.current,r=Dt(),i=$r(n),s=ar(r,i),s.callback=t??null,zr(n,s,i),e.current.lanes=i,da(e,i,r),Vt(e,r),e}function Fc(e,t,n,r){var i=t.current,s=Dt(),o=$r(i);return n=qN(n),t.context===null?t.context=n:t.pendingContext=n,t=ar(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=zr(i,t,o),e!==null&&(Rn(e,i,o,s),yl(e,i,o)),o}function ec(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Px(e,t){$0(e,t),(e=e.alternate)&&$0(e,t)}function X5(){return null}var BN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ox(e){this._internalRoot=e}zc.prototype.render=Ox.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));Fc(e,t,null,null)};zc.prototype.unmount=Ox.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Si(function(){Fc(null,e,null,null)}),t[ur]=null}};function zc(e){this._internalRoot=e}zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=yk();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Er.length&&t!==0&&t<Er[n].priority;n++);Er.splice(n,0,e),n===0&&wk(e)}};function Dx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function B0(){}function Q5(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=ec(o);s.call(d)}}var o=$N(t,r,e,0,null,!1,!1,"",B0);return e._reactRootContainer=o,e[ur]=o.current,qo(e.nodeType===8?e.parentNode:e),Si(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=ec(c);l.call(d)}}var c=Mx(e,0,!1,null,null,!1,!1,"",B0);return e._reactRootContainer=c,e[ur]=c.current,qo(e.nodeType===8?e.parentNode:e),Si(function(){Fc(t,c,n,r)}),c}function $c(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=ec(o);l.call(c)}}Fc(t,o,e,i)}else o=Q5(n,t,e,i,r);return ec(o)}vk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ao(t.pendingLanes);n!==0&&(tx(t,n|1),Vt(t,rt()),!(Pe&6)&&(ws=rt()+500,Jr()))}break;case 13:Si(function(){var r=dr(e,1);if(r!==null){var i=Dt();Rn(r,e,1,i)}}),Px(e,1)}};nx=function(e){if(e.tag===13){var t=dr(e,134217728);if(t!==null){var n=Dt();Rn(t,e,134217728,n)}Px(e,134217728)}};xk=function(e){if(e.tag===13){var t=$r(e),n=dr(e,t);if(n!==null){var r=Dt();Rn(n,e,t,r)}Px(e,t)}};yk=function(){return $e};bk=function(e,t){var n=$e;try{return $e=e,t()}finally{$e=n}};Pg=function(e,t,n){switch(t){case"input":if(Cg(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ac(r);if(!i)throw Error(ee(90));QS(r),Cg(r,i)}}}break;case"textarea":JS(e,n);break;case"select":t=n.value,t!=null&&ss(e,!!n.multiple,t,!1)}};ok=Tx;ak=Si;var Z5={usingClientEntryPoint:!1,Events:[pa,Ki,Ac,ik,sk,Tx]},Ks={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},J5={bundleType:Ks.bundleType,version:Ks.version,rendererPackageName:Ks.rendererPackageName,rendererConfig:Ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=uk(e),e===null?null:e.stateNode},findFiberByHostInstance:Ks.findFiberByHostInstance||X5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wa.isDisabled&&Wa.supportsFiber)try{Cc=Wa.inject(J5),Bn=Wa}catch{}}sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z5;sn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dx(t))throw Error(ee(200));return Y5(e,t,null,n)};sn.createRoot=function(e,t){if(!Dx(e))throw Error(ee(299));var n=!1,r="",i=BN;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Mx(e,1,!1,null,null,n,!1,r,i),e[ur]=t.current,qo(e.nodeType===8?e.parentNode:e),new Ox(t)};sn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=uk(t),e=e===null?null:e.stateNode,e};sn.flushSync=function(e){return Si(e)};sn.hydrate=function(e,t,n){if(!qc(t))throw Error(ee(200));return $c(null,e,t,!0,n)};sn.hydrateRoot=function(e,t,n){if(!Dx(e))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=BN;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=$N(t,null,e,1,n??null,i,!1,s,o),e[ur]=t.current,qo(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new zc(t)};sn.render=function(e,t,n){if(!qc(t))throw Error(ee(200));return $c(null,e,t,!1,n)};sn.unmountComponentAtNode=function(e){if(!qc(e))throw Error(ee(40));return e._reactRootContainer?(Si(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[ur]=null})}),!0):!1};sn.unstable_batchedUpdates=Tx;sn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!qc(n))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return $c(e,t,n,!1,r)};sn.version="18.3.1-next-f1338f8080-20240426";function HN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HN)}catch(e){console.error(e)}}HN(),HS.exports=sn;var ts=HS.exports,H0=ts;bg.createRoot=H0.createRoot,bg.hydrateRoot=H0.hydrateRoot;function Kt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Kt(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var WN={exports:{}},UN={},VN={exports:{}},GN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _s=m;function eI(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tI=typeof Object.is=="function"?Object.is:eI,nI=_s.useState,rI=_s.useEffect,iI=_s.useLayoutEffect,sI=_s.useDebugValue;function oI(e,t){var n=t(),r=nI({inst:{value:n,getSnapshot:t}}),i=r[0].inst,s=r[1];return iI(function(){i.value=n,i.getSnapshot=t,Zu(i)&&s({inst:i})},[e,n,t]),rI(function(){return Zu(i)&&s({inst:i}),e(function(){Zu(i)&&s({inst:i})})},[e]),sI(n),n}function Zu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tI(e,n)}catch{return!0}}function aI(e,t){return t()}var lI=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?aI:oI;GN.useSyncExternalStore=_s.useSyncExternalStore!==void 0?_s.useSyncExternalStore:lI;VN.exports=GN;var cI=VN.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bc=m,uI=cI;function dI(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fI=typeof Object.is=="function"?Object.is:dI,pI=uI.useSyncExternalStore,hI=Bc.useRef,mI=Bc.useEffect,gI=Bc.useMemo,vI=Bc.useDebugValue;UN.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var s=hI(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=gI(function(){function c(h){if(!d){if(d=!0,u=h,h=r(h),i!==void 0&&o.hasValue){var x=o.value;if(i(x,h))return f=x}return f=h}if(x=f,fI(u,h))return x;var g=r(h);return i!==void 0&&i(x,g)?(u=h,x):(u=h,f=g)}var d=!1,u,f,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,i]);var l=pI(e,s[0],s[1]);return mI(function(){o.hasValue=!0,o.value=l},[l]),vI(l),l};WN.exports=UN;var xI=WN.exports;const yI=Bv(xI),bI={},W0=e=>{let t;const n=new Set,r=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(x=>x(t,h))}},i=()=>t,c={setState:r,getState:i,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(bI?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,i,c);return c},wI=e=>e?W0(e):W0,{useDebugValue:_I}=V,{useSyncExternalStoreWithSelector:jI}=yI,SI=e=>e;function KN(e,t=SI,n){const r=jI(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return _I(r),r}const U0=(e,t)=>{const n=wI(e),r=(i,s=t)=>KN(n,i,s);return Object.assign(r,n),r},kI=(e,t)=>e?U0(e,t):U0;function It(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var NI={value:()=>{}};function Hc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Nl(n)}function Nl(e){this._=e}function CI(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Nl.prototype=Hc.prototype={constructor:Nl,on:function(e,t){var n=this._,r=CI(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=EI(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=V0(n[i],e.name,t);else if(t==null)for(i in n)n[i]=V0(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Nl(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function EI(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function V0(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=NI,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var pv="http://www.w3.org/1999/xhtml";const G0={svg:"http://www.w3.org/2000/svg",xhtml:pv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Wc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),G0.hasOwnProperty(t)?{space:G0[t],local:e}:e}function TI(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===pv&&t.documentElement.namespaceURI===pv?t.createElement(e):t.createElementNS(n,e)}}function RI(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function YN(e){var t=Wc(e);return(t.local?RI:TI)(t)}function AI(){}function Lx(e){return e==null?AI:function(){return this.querySelector(e)}}function II(e){typeof e!="function"&&(e=Lx(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,l=r[i]=new Array(o),c,d,u=0;u<o;++u)(c=s[u])&&(d=e.call(c,c.__data__,u,s))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new rn(r,this._parents)}function MI(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function PI(){return[]}function XN(e){return e==null?PI:function(){return this.querySelectorAll(e)}}function OI(e){return function(){return MI(e.apply(this,arguments))}}function DI(e){typeof e=="function"?e=OI(e):e=XN(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&(r.push(e.call(c,c.__data__,d,o)),i.push(c));return new rn(r,i)}function QN(e){return function(){return this.matches(e)}}function ZN(e){return function(t){return t.matches(e)}}var LI=Array.prototype.find;function FI(e){return function(){return LI.call(this.children,e)}}function zI(){return this.firstElementChild}function qI(e){return this.select(e==null?zI:FI(typeof e=="function"?e:ZN(e)))}var $I=Array.prototype.filter;function BI(){return Array.from(this.children)}function HI(e){return function(){return $I.call(this.children,e)}}function WI(e){return this.selectAll(e==null?BI:HI(typeof e=="function"?e:ZN(e)))}function UI(e){typeof e!="function"&&(e=QN(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,l=r[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new rn(r,this._parents)}function JN(e){return new Array(e.length)}function VI(){return new rn(this._enter||this._groups.map(JN),this._parents)}function tc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}tc.prototype={constructor:tc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function GI(e){return function(){return e}}function KI(e,t,n,r,i,s){for(var o=0,l,c=t.length,d=s.length;o<d;++o)(l=t[o])?(l.__data__=s[o],r[o]=l):n[o]=new tc(e,s[o]);for(;o<c;++o)(l=t[o])&&(i[o]=l)}function YI(e,t,n,r,i,s,o){var l,c,d=new Map,u=t.length,f=s.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=o.call(c,c.__data__,l,t)+"",d.has(h)?i[l]=c:d.set(h,c));for(l=0;l<f;++l)h=o.call(e,s[l],l,s)+"",(c=d.get(h))?(r[l]=c,c.__data__=s[l],d.delete(h)):n[l]=new tc(e,s[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(i[l]=c)}function XI(e){return e.__data__}function QI(e,t){if(!arguments.length)return Array.from(this,XI);var n=t?YI:KI,r=this._parents,i=this._groups;typeof e!="function"&&(e=GI(e));for(var s=i.length,o=new Array(s),l=new Array(s),c=new Array(s),d=0;d<s;++d){var u=r[d],f=i[d],p=f.length,h=ZI(e.call(u,u&&u.__data__,d,r)),x=h.length,g=l[d]=new Array(x),w=o[d]=new Array(x),v=c[d]=new Array(p);n(u,f,g,w,v,h,t);for(var y=0,b=0,_,j;y<x;++y)if(_=g[y]){for(y>=b&&(b=y+1);!(j=w[b])&&++b<x;);_._next=j||null}}return o=new rn(o,r),o._enter=l,o._exit=c,o}function ZI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function JI(){return new rn(this._exit||this._groups.map(JN),this._parents)}function e3(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function t3(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),l=new Array(i),c=0;c<o;++c)for(var d=n[c],u=r[c],f=d.length,p=l[c]=new Array(f),h,x=0;x<f;++x)(h=d[x]||u[x])&&(p[x]=h);for(;c<i;++c)l[c]=n[c];return new rn(l,this._parents)}function n3(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function r3(e){e||(e=i3);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],l=o.length,c=i[s]=new Array(l),d,u=0;u<l;++u)(d=o[u])&&(c[u]=d);c.sort(t)}return new rn(i,this._parents).order()}function i3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function s3(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function o3(){return Array.from(this)}function a3(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function l3(){let e=0;for(const t of this)++e;return e}function c3(){return!this.node()}function u3(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,l;s<o;++s)(l=i[s])&&e.call(l,l.__data__,s,i);return this}function d3(e){return function(){this.removeAttribute(e)}}function f3(e){return function(){this.removeAttributeNS(e.space,e.local)}}function p3(e,t){return function(){this.setAttribute(e,t)}}function h3(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function m3(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function g3(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function v3(e,t){var n=Wc(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?f3:d3:typeof t=="function"?n.local?g3:m3:n.local?h3:p3)(n,t))}function eC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function x3(e){return function(){this.style.removeProperty(e)}}function y3(e,t,n){return function(){this.style.setProperty(e,t,n)}}function b3(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function w3(e,t,n){return arguments.length>1?this.each((t==null?x3:typeof t=="function"?b3:y3)(e,t,n??"")):js(this.node(),e)}function js(e,t){return e.style.getPropertyValue(t)||eC(e).getComputedStyle(e,null).getPropertyValue(t)}function _3(e){return function(){delete this[e]}}function j3(e,t){return function(){this[e]=t}}function S3(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function k3(e,t){return arguments.length>1?this.each((t==null?_3:typeof t=="function"?S3:j3)(e,t)):this.node()[e]}function tC(e){return e.trim().split(/^|\s+/)}function Fx(e){return e.classList||new nC(e)}function nC(e){this._node=e,this._names=tC(e.getAttribute("class")||"")}nC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function rC(e,t){for(var n=Fx(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function iC(e,t){for(var n=Fx(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function N3(e){return function(){rC(this,e)}}function C3(e){return function(){iC(this,e)}}function E3(e,t){return function(){(t.apply(this,arguments)?rC:iC)(this,e)}}function T3(e,t){var n=tC(e+"");if(arguments.length<2){for(var r=Fx(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?E3:t?N3:C3)(n,t))}function R3(){this.textContent=""}function A3(e){return function(){this.textContent=e}}function I3(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function M3(e){return arguments.length?this.each(e==null?R3:(typeof e=="function"?I3:A3)(e)):this.node().textContent}function P3(){this.innerHTML=""}function O3(e){return function(){this.innerHTML=e}}function D3(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function L3(e){return arguments.length?this.each(e==null?P3:(typeof e=="function"?D3:O3)(e)):this.node().innerHTML}function F3(){this.nextSibling&&this.parentNode.appendChild(this)}function z3(){return this.each(F3)}function q3(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $3(){return this.each(q3)}function B3(e){var t=typeof e=="function"?e:YN(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function H3(){return null}function W3(e,t){var n=typeof e=="function"?e:YN(e),r=t==null?H3:typeof t=="function"?t:Lx(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function U3(){var e=this.parentNode;e&&e.removeChild(this)}function V3(){return this.each(U3)}function G3(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function K3(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Y3(e){return this.select(e?K3:G3)}function X3(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Q3(e){return function(t){e.call(this,t,this.__data__)}}function Z3(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function J3(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function eM(e,t,n){return function(){var r=this.__on,i,s=Q3(t);if(r){for(var o=0,l=r.length;o<l;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function tM(e,t,n){var r=Z3(e+""),i,s=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(i=0,u=l[c];i<s;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(l=t?eM:J3,i=0;i<s;++i)this.each(l(r[i],t,n));return this}function sC(e,t,n){var r=eC(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function nM(e,t){return function(){return sC(this,e,t)}}function rM(e,t){return function(){return sC(this,e,t.apply(this,arguments))}}function iM(e,t){return this.each((typeof t=="function"?rM:nM)(e,t))}function*sM(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var oC=[null];function rn(e,t){this._groups=e,this._parents=t}function ma(){return new rn([[document.documentElement]],oC)}function oM(){return this}rn.prototype=ma.prototype={constructor:rn,select:II,selectAll:DI,selectChild:qI,selectChildren:WI,filter:UI,data:QI,enter:VI,exit:JI,join:e3,merge:t3,selection:oM,order:n3,sort:r3,call:s3,nodes:o3,node:a3,size:l3,empty:c3,each:u3,attr:v3,style:w3,property:k3,classed:T3,text:M3,html:L3,raise:z3,lower:$3,append:B3,insert:W3,remove:V3,clone:Y3,datum:X3,on:tM,dispatch:iM,[Symbol.iterator]:sM};function pn(e){return typeof e=="string"?new rn([[document.querySelector(e)]],[document.documentElement]):new rn([[e]],oC)}function aM(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Nn(e,t){if(e=aM(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const lM={passive:!1},Yo={capture:!0,passive:!1};function Ju(e){e.stopImmediatePropagation()}function ds(e){e.preventDefault(),e.stopImmediatePropagation()}function aC(e){var t=e.document.documentElement,n=pn(e).on("dragstart.drag",ds,Yo);"onselectstart"in t?n.on("selectstart.drag",ds,Yo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function lC(e,t){var n=e.document.documentElement,r=pn(e).on("dragstart.drag",null);t&&(r.on("click.drag",ds,Yo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ua=e=>()=>e;function hv(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:s,x:o,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}hv.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function cM(e){return!e.ctrlKey&&!e.button}function uM(){return this.parentNode}function dM(e,t){return t??{x:e.x,y:e.y}}function fM(){return navigator.maxTouchPoints||"ontouchstart"in this}function pM(){var e=cM,t=uM,n=dM,r=fM,i={},s=Hc("start","drag","end"),o=0,l,c,d,u,f=0;function p(_){_.on("mousedown.drag",h).filter(r).on("touchstart.drag",w).on("touchmove.drag",v,lM).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(_,j){if(!(u||!e.call(this,_,j))){var k=b(this,t.call(this,_,j),_,j,"mouse");k&&(pn(_.view).on("mousemove.drag",x,Yo).on("mouseup.drag",g,Yo),aC(_.view),Ju(_),d=!1,l=_.clientX,c=_.clientY,k("start",_))}}function x(_){if(ds(_),!d){var j=_.clientX-l,k=_.clientY-c;d=j*j+k*k>f}i.mouse("drag",_)}function g(_){pn(_.view).on("mousemove.drag mouseup.drag",null),lC(_.view,d),ds(_),i.mouse("end",_)}function w(_,j){if(e.call(this,_,j)){var k=_.changedTouches,N=t.call(this,_,j),E=k.length,S,R;for(S=0;S<E;++S)(R=b(this,N,_,j,k[S].identifier,k[S]))&&(Ju(_),R("start",_,k[S]))}}function v(_){var j=_.changedTouches,k=j.length,N,E;for(N=0;N<k;++N)(E=i[j[N].identifier])&&(ds(_),E("drag",_,j[N]))}function y(_){var j=_.changedTouches,k=j.length,N,E;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),N=0;N<k;++N)(E=i[j[N].identifier])&&(Ju(_),E("end",_,j[N]))}function b(_,j,k,N,E,S){var R=s.copy(),T=Nn(S||k,j),M,z,C;if((C=n.call(_,new hv("beforestart",{sourceEvent:k,target:p,identifier:E,active:o,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),N))!=null)return M=C.x-T[0]||0,z=C.y-T[1]||0,function L(P,$,O){var A=T,F;switch(P){case"start":i[E]=L,F=o++;break;case"end":delete i[E],--o;case"drag":T=Nn(O||$,j),F=o;break}R.call(P,_,new hv(P,{sourceEvent:$,subject:C,target:p,identifier:E,active:F,x:T[0]+M,y:T[1]+z,dx:T[0]-A[0],dy:T[1]-A[1],dispatch:R}),N)}}return p.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Ua(!!_),p):e},p.container=function(_){return arguments.length?(t=typeof _=="function"?_:Ua(_),p):t},p.subject=function(_){return arguments.length?(n=typeof _=="function"?_:Ua(_),p):n},p.touchable=function(_){return arguments.length?(r=typeof _=="function"?_:Ua(!!_),p):r},p.on=function(){var _=s.on.apply(s,arguments);return _===s?p:_},p.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,p):Math.sqrt(f)},p}function zx(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function cC(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ga(){}var Xo=.7,nc=1/Xo,fs="\\s*([+-]?\\d+)\\s*",Qo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hM=/^#([0-9a-f]{3,8})$/,mM=new RegExp(`^rgb\\(${fs},${fs},${fs}\\)$`),gM=new RegExp(`^rgb\\(${Wn},${Wn},${Wn}\\)$`),vM=new RegExp(`^rgba\\(${fs},${fs},${fs},${Qo}\\)$`),xM=new RegExp(`^rgba\\(${Wn},${Wn},${Wn},${Qo}\\)$`),yM=new RegExp(`^hsl\\(${Qo},${Wn},${Wn}\\)$`),bM=new RegExp(`^hsla\\(${Qo},${Wn},${Wn},${Qo}\\)$`),K0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};zx(ga,Zo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Y0,formatHex:Y0,formatHex8:wM,formatHsl:_M,formatRgb:X0,toString:X0});function Y0(){return this.rgb().formatHex()}function wM(){return this.rgb().formatHex8()}function _M(){return uC(this).formatHsl()}function X0(){return this.rgb().formatRgb()}function Zo(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=hM.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Q0(t):n===3?new Bt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Va(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Va(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mM.exec(e))?new Bt(t[1],t[2],t[3],1):(t=gM.exec(e))?new Bt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vM.exec(e))?Va(t[1],t[2],t[3],t[4]):(t=xM.exec(e))?Va(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=yM.exec(e))?eb(t[1],t[2]/100,t[3]/100,1):(t=bM.exec(e))?eb(t[1],t[2]/100,t[3]/100,t[4]):K0.hasOwnProperty(e)?Q0(K0[e]):e==="transparent"?new Bt(NaN,NaN,NaN,0):null}function Q0(e){return new Bt(e>>16&255,e>>8&255,e&255,1)}function Va(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bt(e,t,n,r)}function jM(e){return e instanceof ga||(e=Zo(e)),e?(e=e.rgb(),new Bt(e.r,e.g,e.b,e.opacity)):new Bt}function mv(e,t,n,r){return arguments.length===1?jM(e):new Bt(e,t,n,r??1)}function Bt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}zx(Bt,mv,cC(ga,{brighter(e){return e=e==null?nc:Math.pow(nc,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Xo:Math.pow(Xo,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bt(vi(this.r),vi(this.g),vi(this.b),rc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Z0,formatHex:Z0,formatHex8:SM,formatRgb:J0,toString:J0}));function Z0(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function SM(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi((isNaN(this.opacity)?1:this.opacity)*255)}`}function J0(){const e=rc(this.opacity);return`${e===1?"rgb(":"rgba("}${vi(this.r)}, ${vi(this.g)}, ${vi(this.b)}${e===1?")":`, ${e})`}`}function rc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fi(e){return e=vi(e),(e<16?"0":"")+e.toString(16)}function eb(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new En(e,t,n,r)}function uC(e){if(e instanceof En)return new En(e.h,e.s,e.l,e.opacity);if(e instanceof ga||(e=Zo(e)),!e)return new En;if(e instanceof En)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(n-r)/l+(n<r)*6:n===s?o=(r-t)/l+2:o=(t-n)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new En(o,l,c,e.opacity)}function kM(e,t,n,r){return arguments.length===1?uC(e):new En(e,t,n,r??1)}function En(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}zx(En,kM,cC(ga,{brighter(e){return e=e==null?nc:Math.pow(nc,e),new En(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Xo:Math.pow(Xo,e),new En(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Bt(ed(e>=240?e-240:e+120,i,r),ed(e,i,r),ed(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new En(tb(this.h),Ga(this.s),Ga(this.l),rc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=rc(this.opacity);return`${e===1?"hsl(":"hsla("}${tb(this.h)}, ${Ga(this.s)*100}%, ${Ga(this.l)*100}%${e===1?")":`, ${e})`}`}}));function tb(e){return e=(e||0)%360,e<0?e+360:e}function Ga(e){return Math.max(0,Math.min(1,e||0))}function ed(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const dC=e=>()=>e;function NM(e,t){return function(n){return e+n*t}}function CM(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function EM(e){return(e=+e)==1?fC:function(t,n){return n-t?CM(t,n,e):dC(isNaN(t)?n:t)}}function fC(e,t){var n=t-e;return n?NM(e,n):dC(isNaN(e)?t:e)}const nb=function e(t){var n=EM(t);function r(i,s){var o=n((i=mv(i)).r,(s=mv(s)).r),l=n(i.g,s.g),c=n(i.b,s.b),d=fC(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=c(u),i.opacity=d(u),i+""}}return r.gamma=e,r}(1);function kr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var gv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,td=new RegExp(gv.source,"g");function TM(e){return function(){return e}}function RM(e){return function(t){return e(t)+""}}function AM(e,t){var n=gv.lastIndex=td.lastIndex=0,r,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(r=gv.exec(e))&&(i=td.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(r=r[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:kr(r,i)})),n=td.lastIndex;return n<t.length&&(s=t.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?RM(c[0].x):TM(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var rb=180/Math.PI,vv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pC(e,t,n,r,i,s){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*rb,skewX:Math.atan(c)*rb,scaleX:o,scaleY:l}}var Ka;function IM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vv:pC(t.a,t.b,t.c,t.d,t.e,t.f)}function MM(e){return e==null||(Ka||(Ka=document.createElementNS("http://www.w3.org/2000/svg","g")),Ka.setAttribute("transform",e),!(e=Ka.transform.baseVal.consolidate()))?vv:(e=e.matrix,pC(e.a,e.b,e.c,e.d,e.e,e.f))}function hC(e,t,n,r){function i(d){return d.length?d.pop()+" ":""}function s(d,u,f,p,h,x){if(d!==f||u!==p){var g=h.push("translate(",null,t,null,n);x.push({i:g-4,x:kr(d,f)},{i:g-2,x:kr(u,p)})}else(f||p)&&h.push("translate("+f+t+p+n)}function o(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(i(f)+"rotate(",null,r)-2,x:kr(d,u)})):u&&f.push(i(f)+"rotate("+u+r)}function l(d,u,f,p){d!==u?p.push({i:f.push(i(f)+"skewX(",null,r)-2,x:kr(d,u)}):u&&f.push(i(f)+"skewX("+u+r)}function c(d,u,f,p,h,x){if(d!==f||u!==p){var g=h.push(i(h)+"scale(",null,",",null,")");x.push({i:g-4,x:kr(d,f)},{i:g-2,x:kr(u,p)})}else(f!==1||p!==1)&&h.push(i(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),s(d.translateX,d.translateY,u.translateX,u.translateY,f,p),o(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var x=-1,g=p.length,w;++x<g;)f[(w=p[x]).i]=w.x(h);return f.join("")}}}var PM=hC(IM,"px, ","px)","deg)"),OM=hC(MM,", ",")",")"),DM=1e-12;function ib(e){return((e=Math.exp(e))+1/e)/2}function LM(e){return((e=Math.exp(e))-1/e)/2}function FM(e){return((e=Math.exp(2*e))-1)/(e+1)}const zM=function e(t,n,r){function i(s,o){var l=s[0],c=s[1],d=s[2],u=o[0],f=o[1],p=o[2],h=u-l,x=f-c,g=h*h+x*x,w,v;if(g<DM)v=Math.log(p/d)/t,w=function(N){return[l+N*h,c+N*x,d*Math.exp(t*N*v)]};else{var y=Math.sqrt(g),b=(p*p-d*d+r*g)/(2*d*n*y),_=(p*p-d*d-r*g)/(2*p*n*y),j=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(_*_+1)-_);v=(k-j)/t,w=function(N){var E=N*v,S=ib(j),R=d/(n*y)*(S*FM(t*E+j)-LM(j));return[l+R*h,c+R*x,d*S/ib(t*E+j)]}}return w.duration=v*1e3*t/Math.SQRT2,w}return i.rho=function(s){var o=Math.max(.001,+s),l=o*o,c=l*l;return e(o,l,c)},i}(Math.SQRT2,2,4);var Ss=0,co=0,Ys=0,mC=1e3,ic,uo,sc=0,ki=0,Uc=0,Jo=typeof performance=="object"&&performance.now?performance:Date,gC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function qx(){return ki||(gC(qM),ki=Jo.now()+Uc)}function qM(){ki=0}function oc(){this._call=this._time=this._next=null}oc.prototype=vC.prototype={constructor:oc,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?qx():+n)+(t==null?0:+t),!this._next&&uo!==this&&(uo?uo._next=this:ic=this,uo=this),this._call=e,this._time=n,xv()},stop:function(){this._call&&(this._call=null,this._time=1/0,xv())}};function vC(e,t,n){var r=new oc;return r.restart(e,t,n),r}function $M(){qx(),++Ss;for(var e=ic,t;e;)(t=ki-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ss}function sb(){ki=(sc=Jo.now())+Uc,Ss=co=0;try{$M()}finally{Ss=0,HM(),ki=0}}function BM(){var e=Jo.now(),t=e-sc;t>mC&&(Uc-=t,sc=e)}function HM(){for(var e,t=ic,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ic=n);uo=e,xv(r)}function xv(e){if(!Ss){co&&(co=clearTimeout(co));var t=e-ki;t>24?(e<1/0&&(co=setTimeout(sb,e-Jo.now()-Uc)),Ys&&(Ys=clearInterval(Ys))):(Ys||(sc=Jo.now(),Ys=setInterval(BM,mC)),Ss=1,gC(sb))}}function ob(e,t,n){var r=new oc;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var WM=Hc("start","end","cancel","interrupt"),UM=[],xC=0,ab=1,yv=2,Cl=3,lb=4,bv=5,El=6;function Vc(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;VM(e,n,{name:t,index:r,group:i,on:WM,tween:UM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:xC})}function $x(e,t){var n=Mn(e,t);if(n.state>xC)throw new Error("too late; already scheduled");return n}function Kn(e,t){var n=Mn(e,t);if(n.state>Cl)throw new Error("too late; already running");return n}function Mn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function VM(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=vC(s,0,n.time);function s(d){n.state=ab,n.timer.restart(o,n.delay,n.time),n.delay<=d&&o(d-n.delay)}function o(d){var u,f,p,h;if(n.state!==ab)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Cl)return ob(o);h.state===lb?(h.state=El,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=El,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(ob(function(){n.state===Cl&&(n.state=lb,n.timer.restart(l,n.delay,n.time),l(d))}),n.state=yv,n.on.call("start",e,e.__data__,n.index,n.group),n.state===yv){for(n.state=Cl,i=new Array(p=n.tween.length),u=0,f=-1;u<p;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=h);i.length=f+1}}function l(d){for(var u=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(c),n.state=bv,1),f=-1,p=i.length;++f<p;)i[f].call(e,u);n.state===bv&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=El,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function Tl(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>yv&&r.state<bv,r.state=El,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function GM(e){return this.each(function(){Tl(this,e)})}function KM(e,t){var n,r;return function(){var i=Kn(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,l=r.length;o<l;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function YM(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Kn(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var l={name:t,value:n},c=0,d=i.length;c<d;++c)if(i[c].name===t){i[c]=l;break}c===d&&i.push(l)}s.tween=i}}function XM(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Mn(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?KM:YM)(n,e,t))}function Bx(e,t,n){var r=e._id;return e.each(function(){var i=Kn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Mn(i,r).value[t]}}function yC(e,t){var n;return(typeof t=="number"?kr:t instanceof Zo?nb:(n=Zo(t))?(t=n,nb):AM)(e,t)}function QM(e){return function(){this.removeAttribute(e)}}function ZM(e){return function(){this.removeAttributeNS(e.space,e.local)}}function JM(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function eP(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function tP(e,t,n){var r,i,s;return function(){var o,l=n(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,l)))}}function nP(e,t,n){var r,i,s;return function(){var o,l=n(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,l)))}}function rP(e,t){var n=Wc(e),r=n==="transform"?OM:yC;return this.attrTween(e,typeof t=="function"?(n.local?nP:tP)(n,r,Bx(this,"attr."+e,t)):t==null?(n.local?ZM:QM)(n):(n.local?eP:JM)(n,r,t))}function iP(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function sP(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function oP(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&sP(e,s)),n}return i._value=t,i}function aP(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&iP(e,s)),n}return i._value=t,i}function lP(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Wc(e);return this.tween(n,(r.local?oP:aP)(r,t))}function cP(e,t){return function(){$x(this,e).delay=+t.apply(this,arguments)}}function uP(e,t){return t=+t,function(){$x(this,e).delay=t}}function dP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?cP:uP)(t,e)):Mn(this.node(),t).delay}function fP(e,t){return function(){Kn(this,e).duration=+t.apply(this,arguments)}}function pP(e,t){return t=+t,function(){Kn(this,e).duration=t}}function hP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fP:pP)(t,e)):Mn(this.node(),t).duration}function mP(e,t){if(typeof t!="function")throw new Error;return function(){Kn(this,e).ease=t}}function gP(e){var t=this._id;return arguments.length?this.each(mP(t,e)):Mn(this.node(),t).ease}function vP(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Kn(this,e).ease=n}}function xP(e){if(typeof e!="function")throw new Error;return this.each(vP(this._id,e))}function yP(e){typeof e!="function"&&(e=QN(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,l=r[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new pr(r,this._parents,this._name,this._id)}function bP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),l=0;l<s;++l)for(var c=t[l],d=n[l],u=c.length,f=o[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<r;++l)o[l]=t[l];return new pr(o,this._parents,this._name,this._id)}function wP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function _P(e,t,n){var r,i,s=wP(t)?$x:Kn;return function(){var o=s(this,e),l=o.on;l!==r&&(i=(r=l).copy()).on(t,n),o.on=i}}function jP(e,t){var n=this._id;return arguments.length<2?Mn(this.node(),n).on.on(e):this.each(_P(n,e,t))}function SP(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function kP(){return this.on("end.remove",SP(this._id))}function NP(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Lx(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var l=r[o],c=l.length,d=s[o]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,Vc(d[p],t,n,p,d,Mn(u,n)));return new pr(s,this._parents,t,n)}function CP(e){var t=this._name,n=this._id;typeof e!="function"&&(e=XN(e));for(var r=this._groups,i=r.length,s=[],o=[],l=0;l<i;++l)for(var c=r[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,x=Mn(u,n),g=0,w=p.length;g<w;++g)(h=p[g])&&Vc(h,t,n,g,p,x);s.push(p),o.push(u)}return new pr(s,o,t,n)}var EP=ma.prototype.constructor;function TP(){return new EP(this._groups,this._parents)}function RP(e,t){var n,r,i;return function(){var s=js(this,e),o=(this.style.removeProperty(e),js(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function bC(e){return function(){this.style.removeProperty(e)}}function AP(e,t,n){var r,i=n+"",s;return function(){var o=js(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function IP(e,t,n){var r,i,s;return function(){var o=js(this,e),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),js(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,l))}}function MP(e,t){var n,r,i,s="style."+t,o="end."+s,l;return function(){var c=Kn(this,e),d=c.on,u=c.value[s]==null?l||(l=bC(t)):void 0;(d!==n||i!==u)&&(r=(n=d).copy()).on(o,i=u),c.on=r}}function PP(e,t,n){var r=(e+="")=="transform"?PM:yC;return t==null?this.styleTween(e,RP(e,r)).on("end.style."+e,bC(e)):typeof t=="function"?this.styleTween(e,IP(e,r,Bx(this,"style."+e,t))).each(MP(this._id,e)):this.styleTween(e,AP(e,r,t),n).on("end.style."+e,null)}function OP(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function DP(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&OP(e,o,n)),r}return s._value=t,s}function LP(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,DP(e,t,n??""))}function FP(e){return function(){this.textContent=e}}function zP(e){return function(){var t=e(this);this.textContent=t??""}}function qP(e){return this.tween("text",typeof e=="function"?zP(Bx(this,"text",e)):FP(e==null?"":e+""))}function $P(e){return function(t){this.textContent=e.call(this,t)}}function BP(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&$P(i)),t}return r._value=e,r}function HP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,BP(e))}function WP(){for(var e=this._name,t=this._id,n=wC(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,c,d=0;d<l;++d)if(c=o[d]){var u=Mn(c,t);Vc(c,e,n,d,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new pr(r,this._parents,e,n)}function UP(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var l={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var d=Kn(this,r),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),i===0&&s()})}var VP=0;function pr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function wC(){return++VP}var Xn=ma.prototype;pr.prototype={constructor:pr,select:NP,selectAll:CP,selectChild:Xn.selectChild,selectChildren:Xn.selectChildren,filter:yP,merge:bP,selection:TP,transition:WP,call:Xn.call,nodes:Xn.nodes,node:Xn.node,size:Xn.size,empty:Xn.empty,each:Xn.each,on:jP,attr:rP,attrTween:lP,style:PP,styleTween:LP,text:qP,textTween:HP,remove:kP,tween:XM,delay:dP,duration:hP,ease:gP,easeVarying:xP,end:UP,[Symbol.iterator]:Xn[Symbol.iterator]};function GP(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var KP={time:null,delay:0,duration:250,ease:GP};function YP(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function XP(e){var t,n;e instanceof pr?(t=e._id,e=e._name):(t=wC(),(n=KP).time=qx(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&Vc(c,e,t,d,o,n||YP(c,t));return new pr(r,this._parents,e,t)}ma.prototype.interrupt=GM;ma.prototype.transition=XP;const Ya=e=>()=>e;function QP(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function ir(e,t,n){this.k=e,this.x=t,this.y=n}ir.prototype={constructor:ir,scale:function(e){return e===1?this:new ir(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ir(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var lr=new ir(1,0,0);ir.prototype;function nd(e){e.stopImmediatePropagation()}function Xs(e){e.preventDefault(),e.stopImmediatePropagation()}function ZP(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function JP(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function cb(){return this.__zoom||lr}function eO(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function tO(){return navigator.maxTouchPoints||"ontouchstart"in this}function nO(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function _C(){var e=ZP,t=JP,n=nO,r=eO,i=tO,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=zM,d=Hc("start","zoom","end"),u,f,p,h=500,x=150,g=0,w=10;function v(C){C.property("__zoom",cb).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",R).filter(i).on("touchstart.zoom",T).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(C,L,P,$){var O=C.selection?C.selection():C;O.property("__zoom",cb),C!==O?j(C,L,P,$):O.interrupt().each(function(){k(this,arguments).event($).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},v.scaleBy=function(C,L,P,$){v.scaleTo(C,function(){var O=this.__zoom.k,A=typeof L=="function"?L.apply(this,arguments):L;return O*A},P,$)},v.scaleTo=function(C,L,P,$){v.transform(C,function(){var O=t.apply(this,arguments),A=this.__zoom,F=P==null?_(O):typeof P=="function"?P.apply(this,arguments):P,I=A.invert(F),q=typeof L=="function"?L.apply(this,arguments):L;return n(b(y(A,q),F,I),O,o)},P,$)},v.translateBy=function(C,L,P,$){v.transform(C,function(){return n(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof P=="function"?P.apply(this,arguments):P),t.apply(this,arguments),o)},null,$)},v.translateTo=function(C,L,P,$,O){v.transform(C,function(){var A=t.apply(this,arguments),F=this.__zoom,I=$==null?_(A):typeof $=="function"?$.apply(this,arguments):$;return n(lr.translate(I[0],I[1]).scale(F.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof P=="function"?-P.apply(this,arguments):-P),A,o)},$,O)};function y(C,L){return L=Math.max(s[0],Math.min(s[1],L)),L===C.k?C:new ir(L,C.x,C.y)}function b(C,L,P){var $=L[0]-P[0]*C.k,O=L[1]-P[1]*C.k;return $===C.x&&O===C.y?C:new ir(C.k,$,O)}function _(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function j(C,L,P,$){C.on("start.zoom",function(){k(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event($).end()}).tween("zoom",function(){var O=this,A=arguments,F=k(O,A).event($),I=t.apply(O,A),q=P==null?_(I):typeof P=="function"?P.apply(O,A):P,W=Math.max(I[1][0]-I[0][0],I[1][1]-I[0][1]),U=O.__zoom,Z=typeof L=="function"?L.apply(O,A):L,B=c(U.invert(q).concat(W/U.k),Z.invert(q).concat(W/Z.k));return function(ne){if(ne===1)ne=Z;else{var ie=B(ne),le=W/ie[2];ne=new ir(le,q[0]-ie[0]*le,q[1]-ie[1]*le)}F.zoom(null,ne)}})}function k(C,L,P){return!P&&C.__zooming||new N(C,L)}function N(C,L){this.that=C,this.args=L,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,L),this.taps=0}N.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,L){return this.mouse&&C!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var L=pn(this.that).datum();d.call(C,this.that,new QP(C,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:d}),L)}};function E(C,...L){if(!e.apply(this,arguments))return;var P=k(this,L).event(C),$=this.__zoom,O=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,r.apply(this,arguments)))),A=Nn(C);if(P.wheel)(P.mouse[0][0]!==A[0]||P.mouse[0][1]!==A[1])&&(P.mouse[1]=$.invert(P.mouse[0]=A)),clearTimeout(P.wheel);else{if($.k===O)return;P.mouse=[A,$.invert(A)],Tl(this),P.start()}Xs(C),P.wheel=setTimeout(F,x),P.zoom("mouse",n(b(y($,O),P.mouse[0],P.mouse[1]),P.extent,o));function F(){P.wheel=null,P.end()}}function S(C,...L){if(p||!e.apply(this,arguments))return;var P=C.currentTarget,$=k(this,L,!0).event(C),O=pn(C.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",W,!0),A=Nn(C,P),F=C.clientX,I=C.clientY;aC(C.view),nd(C),$.mouse=[A,this.__zoom.invert(A)],Tl(this),$.start();function q(U){if(Xs(U),!$.moved){var Z=U.clientX-F,B=U.clientY-I;$.moved=Z*Z+B*B>g}$.event(U).zoom("mouse",n(b($.that.__zoom,$.mouse[0]=Nn(U,P),$.mouse[1]),$.extent,o))}function W(U){O.on("mousemove.zoom mouseup.zoom",null),lC(U.view,$.moved),Xs(U),$.event(U).end()}}function R(C,...L){if(e.apply(this,arguments)){var P=this.__zoom,$=Nn(C.changedTouches?C.changedTouches[0]:C,this),O=P.invert($),A=P.k*(C.shiftKey?.5:2),F=n(b(y(P,A),$,O),t.apply(this,L),o);Xs(C),l>0?pn(this).transition().duration(l).call(j,F,$,C):pn(this).call(v.transform,F,$,C)}}function T(C,...L){if(e.apply(this,arguments)){var P=C.touches,$=P.length,O=k(this,L,C.changedTouches.length===$).event(C),A,F,I,q;for(nd(C),F=0;F<$;++F)I=P[F],q=Nn(I,this),q=[q,this.__zoom.invert(q),I.identifier],O.touch0?!O.touch1&&O.touch0[2]!==q[2]&&(O.touch1=q,O.taps=0):(O.touch0=q,A=!0,O.taps=1+!!u);u&&(u=clearTimeout(u)),A&&(O.taps<2&&(f=q[0],u=setTimeout(function(){u=null},h)),Tl(this),O.start())}}function M(C,...L){if(this.__zooming){var P=k(this,L).event(C),$=C.changedTouches,O=$.length,A,F,I,q;for(Xs(C),A=0;A<O;++A)F=$[A],I=Nn(F,this),P.touch0&&P.touch0[2]===F.identifier?P.touch0[0]=I:P.touch1&&P.touch1[2]===F.identifier&&(P.touch1[0]=I);if(F=P.that.__zoom,P.touch1){var W=P.touch0[0],U=P.touch0[1],Z=P.touch1[0],B=P.touch1[1],ne=(ne=Z[0]-W[0])*ne+(ne=Z[1]-W[1])*ne,ie=(ie=B[0]-U[0])*ie+(ie=B[1]-U[1])*ie;F=y(F,Math.sqrt(ne/ie)),I=[(W[0]+Z[0])/2,(W[1]+Z[1])/2],q=[(U[0]+B[0])/2,(U[1]+B[1])/2]}else if(P.touch0)I=P.touch0[0],q=P.touch0[1];else return;P.zoom("touch",n(b(F,I,q),P.extent,o))}}function z(C,...L){if(this.__zooming){var P=k(this,L).event(C),$=C.changedTouches,O=$.length,A,F;for(nd(C),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),A=0;A<O;++A)F=$[A],P.touch0&&P.touch0[2]===F.identifier?delete P.touch0:P.touch1&&P.touch1[2]===F.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(F=Nn(F,this),Math.hypot(f[0]-F[0],f[1]-F[1])<w)){var I=pn(this).on("dblclick.zoom");I&&I.apply(this,arguments)}}}return v.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:Ya(+C),v):r},v.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Ya(!!C),v):e},v.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:Ya(!!C),v):i},v.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Ya([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),v):t},v.scaleExtent=function(C){return arguments.length?(s[0]=+C[0],s[1]=+C[1],v):[s[0],s[1]]},v.translateExtent=function(C){return arguments.length?(o[0][0]=+C[0][0],o[1][0]=+C[1][0],o[0][1]=+C[0][1],o[1][1]=+C[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(C){return arguments.length?(n=C,v):n},v.duration=function(C){return arguments.length?(l=+C,v):l},v.interpolate=function(C){return arguments.length?(c=C,v):c},v.on=function(){var C=d.on.apply(d,arguments);return C===d?v:C},v.clickDistance=function(C){return arguments.length?(g=(C=+C)*C,v):Math.sqrt(g)},v.tapDistance=function(C){return arguments.length?(w=+C,v):w},v}const Gc=m.createContext(null),rO=Gc.Provider,hr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},jC=hr.error001();function Xe(e,t){const n=m.useContext(Gc);if(n===null)throw new Error(jC);return KN(n,e,t)}const vt=()=>{const e=m.useContext(Gc);if(e===null)throw new Error(jC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},iO=e=>e.userSelectionActive?"none":"all";function Hr({position:e,children:t,className:n,style:r,...i}){const s=Xe(iO),o=`${e}`.split("-");return V.createElement("div",{className:Kt(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},t)}function sO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:V.createElement(Hr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},V.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const oO=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),x=Kt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();h({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:V.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:x,visibility:p.width?"visible":"hidden",...u},i&&V.createElement("rect",{width:p.width+2*o[0],x:-o[0],y:-o[1],height:p.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),V.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:r},n),c)};var aO=m.memo(oO);const Hx=e=>({width:e.offsetWidth,height:e.offsetHeight}),ks=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Wx=(e={x:0,y:0},t)=>({x:ks(e.x,t[0][0],t[1][0]),y:ks(e.y,t[0][1],t[1][1])}),ub=(e,t,n)=>e<t?ks(Math.abs(e-t),1,50)/50:e>n?-ks(Math.abs(e-n),1,50)/50:0,SC=(e,t)=>{const n=ub(e.x,35,t.width-35)*20,r=ub(e.y,35,t.height-35)*20;return[n,r]},kC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},NC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ea=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),CC=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),db=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),lO=(e,t)=>CC(NC(ea(e),ea(t))),wv=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},cO=e=>mn(e.width)&&mn(e.height)&&mn(e.x)&&mn(e.y),mn=e=>!isNaN(e)&&isFinite(e),nt=Symbol.for("internals"),EC=["Enter"," ","Escape"],uO=(e,t)=>{},dO=e=>"nativeEvent"in e;function _v(e){var i,s;const t=dO(e)?e.nativeEvent:e,n=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const TC=e=>"clientX"in e,Wr=(e,t)=>{var s,o;const n=TC(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},ac=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},va=({id:e,path:t,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>V.createElement(V.Fragment,null,V.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&V.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&mn(n)&&mn(r)?V.createElement(aO,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);va.displayName="BaseEdge";function Qs(e,t,n){return n===void 0?n:r=>{const i=t().edges.find(s=>s.id===e);i&&n(r,{...i})}}function RC({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,o=Math.abs(r-t)/2,l=r<t?r+o:r-o;return[s,l,i,o]}function AC({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:l}){const c=e*.125+i*.375+o*.375+n*.125,d=t*.125+s*.375+l*.375+r*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Ni;(function(e){e.Strict="strict",e.Loose="loose"})(Ni||(Ni={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var ta;(function(e){e.Partial="partial",e.Full="full"})(ta||(ta={}));var Rr;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Rr||(Rr={}));var lc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(lc||(lc={}));var ae;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ae||(ae={}));function fb({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===ae.Left||e===ae.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function IC({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:i,targetPosition:s=ae.Top}){const[o,l]=fb({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,d]=fb({pos:s,x1:r,y1:i,x2:e,y2:t}),[u,f,p,h]=AC({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${o},${l} ${c},${d} ${r},${i}`,u,f,p,h]}const Ux=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=ae.Bottom,targetPosition:s=ae.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:g})=>{const[w,v,y]=IC({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return V.createElement(va,{path:w,labelX:v,labelY:y,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:g})});Ux.displayName="SimpleBezierEdge";const pb={[ae.Left]:{x:-1,y:0},[ae.Right]:{x:1,y:0},[ae.Top]:{x:0,y:-1},[ae.Bottom]:{x:0,y:1}},fO=({source:e,sourcePosition:t=ae.Bottom,target:n})=>t===ae.Left||t===ae.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},hb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function pO({source:e,sourcePosition:t=ae.Bottom,target:n,targetPosition:r=ae.Top,center:i,offset:s}){const o=pb[t],l=pb[r],c={x:e.x+o.x*s,y:e.y+o.y*s},d={x:n.x+l.x*s,y:n.y+l.y*s},u=fO({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],x,g;const w={x:0,y:0},v={x:0,y:0},[y,b,_,j]=RC({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[f]*l[f]===-1){x=i.x??y,g=i.y??b;const N=[{x,y:c.y},{x,y:d.y}],E=[{x:c.x,y:g},{x:d.x,y:g}];o[f]===p?h=f==="x"?N:E:h=f==="x"?E:N}else{const N=[{x:c.x,y:d.y}],E=[{x:d.x,y:c.y}];if(f==="x"?h=o.x===p?E:N:h=o.y===p?N:E,t===r){const z=Math.abs(e[f]-n[f]);if(z<=s){const C=Math.min(s-1,s-z);o[f]===p?w[f]=(c[f]>e[f]?-1:1)*C:v[f]=(d[f]>n[f]?-1:1)*C}}if(t!==r){const z=f==="x"?"y":"x",C=o[f]===l[z],L=c[z]>d[z],P=c[z]<d[z];(o[f]===1&&(!C&&L||C&&P)||o[f]!==1&&(!C&&P||C&&L))&&(h=f==="x"?N:E)}const S={x:c.x+w.x,y:c.y+w.y},R={x:d.x+v.x,y:d.y+v.y},T=Math.max(Math.abs(S.x-h[0].x),Math.abs(R.x-h[0].x)),M=Math.max(Math.abs(S.y-h[0].y),Math.abs(R.y-h[0].y));T>=M?(x=(S.x+R.x)/2,g=h[0].y):(x=h[0].x,g=(S.y+R.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...h,{x:d.x+v.x,y:d.y+v.y},n],x,g,_,j]}function hO(e,t,n,r){const i=Math.min(hb(e,t)/2,hb(t,n)/2,r),{x:s,y:o}=t;if(e.x===s&&s===n.x||e.y===o&&o===n.y)return`L${s} ${o}`;if(e.y===o){const d=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${s+i*d},${o}Q ${s},${o} ${s},${o+i*u}`}const l=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*l},${o}`}function jv({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:i,targetPosition:s=ae.Top,borderRadius:o=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,x]=pO({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:l,y:c},offset:d});return[u.reduce((w,v,y)=>{let b="";return y>0&&y<u.length-1?b=hO(u[y-1],v,u[y+1],o):b=`${y===0?"M":"L"}${v.x} ${v.y}`,w+=b,w},""),f,p,h,x]}const Kc=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=ae.Bottom,targetPosition:p=ae.Top,markerEnd:h,markerStart:x,pathOptions:g,interactionWidth:w})=>{const[v,y,b]=jv({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:p,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return V.createElement(va,{path:v,labelX:y,labelY:b,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:x,interactionWidth:w})});Kc.displayName="SmoothStepEdge";const Vx=m.memo(e=>{var t;return V.createElement(Kc,{...e,pathOptions:m.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Vx.displayName="StepEdge";function mO({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,s,o,l]=RC({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,s,o,l]}const Gx=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[x,g,w]=mO({sourceX:e,sourceY:t,targetX:n,targetY:r});return V.createElement(va,{path:x,labelX:g,labelY:w,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});Gx.displayName="StraightEdge";function Xa(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function mb({pos:e,x1:t,y1:n,x2:r,y2:i,c:s}){switch(e){case ae.Left:return[t-Xa(t-r,s),n];case ae.Right:return[t+Xa(r-t,s),n];case ae.Top:return[t,n-Xa(n-i,s)];case ae.Bottom:return[t,n+Xa(i-n,s)]}}function MC({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:i,targetPosition:s=ae.Top,curvature:o=.25}){const[l,c]=mb({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[d,u]=mb({pos:s,x1:r,y1:i,x2:e,y2:t,c:o}),[f,p,h,x]=AC({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${r},${i}`,f,p,h,x]}const cc=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=ae.Bottom,targetPosition:s=ae.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,pathOptions:g,interactionWidth:w})=>{const[v,y,b]=MC({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:g==null?void 0:g.curvature});return V.createElement(va,{path:v,labelX:y,labelY:b,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:w})});cc.displayName="BezierEdge";const Kx=m.createContext(null),gO=Kx.Provider;Kx.Consumer;const vO=()=>m.useContext(Kx),xO=e=>"id"in e&&"source"in e&&"target"in e,yO=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Sv=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,bO=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),wO=(e,t)=>{if(!e.source||!e.target)return t;let n;return xO(e)?n={...e}:n={...e,id:yO(e)},bO(n,t)?t:t.concat(n)},kv=({x:e,y:t},[n,r,i],s,[o,l])=>{const c={x:(e-n)/i,y:(t-r)/i};return s?{x:o*Math.round(c.x/o),y:l*Math.round(c.y/l)}:c},PC=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),xi=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},Yc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const{x:s,y:o}=xi(i,t).positionAbsolute;return NC(r,ea({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return CC(n)},OC=(e,t,[n,r,i]=[0,0,1],s=!1,o=!1,l=[0,0])=>{const c={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:x=!1}=u;if(o&&!h||x)return!1;const{positionAbsolute:g}=xi(u,l),w={x:g.x,y:g.y,width:f||0,height:p||0},v=wv(c,w),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=s&&v>0,_=(f||0)*(p||0);(y||b||v>=_||u.dragging)&&d.push(u)}),d},DC=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},LC=(e,t,n,r,i,s=.1)=>{const o=t/(e.width*(1+s)),l=n/(e.height*(1+s)),c=Math.min(o,l),d=ks(c,r,i),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=n/2-f*d;return{x:p,y:h,zoom:d}},li=(e,t=0)=>e.transition().duration(t);function gb(e,t,n,r){return(t[n]||[]).reduce((i,s)=>{var o,l;return`${e.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+s.y+s.height/2}),i},[])}function _O(e,t,n,r,i,s){const{x:o,y:l}=Wr(e),d=t.elementsFromPoint(o,l).find(x=>x.classList.contains("react-flow__handle"));if(d){const x=d.getAttribute("data-nodeid");if(x){const g=Yx(void 0,d),w=d.getAttribute("data-handleid"),v=s({nodeId:x,id:w,type:g});if(v){const y=i.find(b=>b.nodeId===x&&b.type===g&&b.id===w);return{handle:{id:w,type:g,nodeId:x,x:(y==null?void 0:y.x)||n.x,y:(y==null?void 0:y.y)||n.y},validHandleResult:v}}}}let u=[],f=1/0;if(i.forEach(x=>{const g=Math.sqrt((x.x-n.x)**2+(x.y-n.y)**2);if(g<=r){const w=s(x);g<=f&&(g<f?u=[{handle:x,validHandleResult:w}]:g===f&&u.push({handle:x,validHandleResult:w}),f=g)}}),!u.length)return{handle:null,validHandleResult:FC()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:x})=>x.isValid),h=u.some(({handle:x})=>x.type==="target");return u.find(({handle:x,validHandleResult:g})=>h?x.type==="target":p?g.isValid:!0)||u[0]}const jO={source:null,target:null,sourceHandle:null,targetHandle:null},FC=()=>({handleDomNode:null,isValid:!1,connection:jO,endHandle:null});function zC(e,t,n,r,i,s,o){const l=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...FC(),handleDomNode:c};if(c){const u=Yx(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),x=c.classList.contains("connectableend"),g={source:l?f:n,sourceHandle:l?p:r,target:l?n:f,targetHandle:l?r:p};d.connection=g,h&&x&&(t===Ni.Strict?l&&u==="source"||!l&&u==="target":f!==n||p!==r)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=s(g))}return d}function SO({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((i,s)=>{if(s[nt]){const{handleBounds:o}=s[nt];let l=[],c=[];o&&(l=gb(s,o,"source",`${t}-${n}-${r}`),c=gb(s,o,"target",`${t}-${n}-${r}`)),i.push(...l,...c)}return i},[])}function Yx(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function rd(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function kO(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function qC({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=kC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:x,onConnectStart:g,panBy:w,getNodes:v,cancelConnection:y}=s();let b=0,_;const{x:j,y:k}=Wr(e),N=u==null?void 0:u.elementFromPoint(j,k),E=Yx(c,N),S=p==null?void 0:p.getBoundingClientRect();if(!S||!E)return;let R,T=Wr(e,S),M=!1,z=null,C=!1,L=null;const P=SO({nodes:v(),nodeId:n,handleId:t,handleType:E}),$=()=>{if(!h)return;const[F,I]=SC(T,S);w({x:F,y:I}),b=requestAnimationFrame($)};o({connectionPosition:T,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:n,handleId:t,type:E},connectionEndHandle:null}),g==null||g(e,{nodeId:n,handleId:t,handleType:E});function O(F){const{transform:I}=s();T=Wr(F,S);const{handle:q,validHandleResult:W}=_O(F,u,kv(T,I,!1,[1,1]),x,P,U=>zC(U,f,n,t,i?"target":"source",l,u));if(_=q,M||($(),M=!0),L=W.handleDomNode,z=W.connection,C=W.isValid,o({connectionPosition:_&&C?PC({x:_.x,y:_.y},I):T,connectionStatus:kO(!!_,C),connectionEndHandle:W.endHandle}),!_&&!C&&!L)return rd(R);z.source!==z.target&&L&&(rd(R),R=L,L.classList.add("connecting","react-flow__handle-connecting"),L.classList.toggle("valid",C),L.classList.toggle("react-flow__handle-valid",C))}function A(F){var I,q;(_||L)&&z&&C&&(r==null||r(z)),(q=(I=s()).onConnectEnd)==null||q.call(I,F),c&&(d==null||d(F)),rd(R),y(),cancelAnimationFrame(b),M=!1,C=!1,z=null,L=null,u.removeEventListener("mousemove",O),u.removeEventListener("mouseup",A),u.removeEventListener("touchmove",O),u.removeEventListener("touchend",A)}u.addEventListener("mousemove",O),u.addEventListener("mouseup",A),u.addEventListener("touchmove",O),u.addEventListener("touchend",A)}const vb=()=>!0,NO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),CO=(e,t,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n}},$C=m.forwardRef(({type:e="source",position:t=ae.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var S,R;const x=o||null,g=e==="target",w=vt(),v=vO(),{connectOnClick:y,noPanClassName:b}=Xe(NO,It),{connecting:_,clickConnecting:j}=Xe(CO(v,x,e),It);v||(R=(S=w.getState()).onError)==null||R.call(S,"010",hr.error010());const k=T=>{const{defaultEdgeOptions:M,onConnect:z,hasDefaultEdges:C}=w.getState(),L={...M,...T};if(C){const{edges:P,setEdges:$}=w.getState();$(wO(L,P))}z==null||z(L),l==null||l(L)},N=T=>{if(!v)return;const M=TC(T);i&&(M&&T.button===0||!M)&&qC({event:T,handleId:x,nodeId:v,onConnect:k,isTarget:g,getState:w.getState,setState:w.setState,isValidConnection:n||w.getState().isValidConnection||vb}),M?u==null||u(T):f==null||f(T)},E=T=>{const{onClickConnectStart:M,onClickConnectEnd:z,connectionClickStartHandle:C,connectionMode:L,isValidConnection:P}=w.getState();if(!v||!C&&!i)return;if(!C){M==null||M(T,{nodeId:v,handleId:x,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:x}});return}const $=kC(T.target),O=n||P||vb,{connection:A,isValid:F}=zC({nodeId:v,id:x,type:e},L,C.nodeId,C.handleId||null,C.type,O,$);F&&k(A),z==null||z(T),w.setState({connectionClickStartHandle:null})};return V.createElement("div",{"data-handleid":x,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${x}-${e}`,className:Kt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!g,target:g,connectable:r,connectablestart:i,connectableend:s,connecting:j,connectionindicator:r&&(i&&!_||s&&_)}]),onMouseDown:N,onTouchStart:N,onClick:y?E:void 0,ref:h,...p},c)});$C.displayName="Handle";var Vn=m.memo($C);const BC=({data:e,isConnectable:t,targetPosition:n=ae.Top,sourcePosition:r=ae.Bottom})=>V.createElement(V.Fragment,null,V.createElement(Vn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,V.createElement(Vn,{type:"source",position:r,isConnectable:t}));BC.displayName="DefaultNode";var Nv=m.memo(BC);const HC=({data:e,isConnectable:t,sourcePosition:n=ae.Bottom})=>V.createElement(V.Fragment,null,e==null?void 0:e.label,V.createElement(Vn,{type:"source",position:n,isConnectable:t}));HC.displayName="InputNode";var WC=m.memo(HC);const UC=({data:e,isConnectable:t,targetPosition:n=ae.Top})=>V.createElement(V.Fragment,null,V.createElement(Vn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);UC.displayName="OutputNode";var VC=m.memo(UC);const Xx=()=>null;Xx.displayName="GroupNode";const EO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Qa=e=>e.id;function TO(e,t){return It(e.selectedNodes.map(Qa),t.selectedNodes.map(Qa))&&It(e.selectedEdges.map(Qa),t.selectedEdges.map(Qa))}const GC=m.memo(({onSelectionChange:e})=>{const t=vt(),{selectedNodes:n,selectedEdges:r}=Xe(EO,TO);return m.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[n,r,e]),null});GC.displayName="SelectionListener";const RO=e=>!!e.onSelectionChange;function AO({onSelectionChange:e}){const t=Xe(RO);return e||t?V.createElement(GC,{onSelectionChange:e}):null}const IO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oi(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ke(e,t,n){m.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const MO=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:x,minZoom:g,maxZoom:w,nodeExtent:v,onNodesChange:y,onEdgesChange:b,elementsSelectable:_,connectionMode:j,snapGrid:k,snapToGrid:N,translateExtent:E,connectOnClick:S,defaultEdgeOptions:R,fitView:T,fitViewOptions:M,onNodesDelete:z,onEdgesDelete:C,onNodeDrag:L,onNodeDragStart:P,onNodeDragStop:$,onSelectionDrag:O,onSelectionDragStart:A,onSelectionDragStop:F,noPanClassName:I,nodeOrigin:q,rfId:W,autoPanOnConnect:U,autoPanOnNodeDrag:Z,onError:B,connectionRadius:ne,isValidConnection:ie,nodeDragThreshold:le})=>{const{setNodes:J,setEdges:_e,setDefaultNodesAndEdges:G,setMinZoom:ve,setMaxZoom:fe,setTranslateExtent:se,setNodeExtent:ge,reset:Y}=Xe(IO,It),Q=vt();return m.useEffect(()=>{const pe=r==null?void 0:r.map(ye=>({...ye,...R}));return G(n,pe),()=>{Y()}},[]),ke("defaultEdgeOptions",R,Q.setState),ke("connectionMode",j,Q.setState),ke("onConnect",i,Q.setState),ke("onConnectStart",s,Q.setState),ke("onConnectEnd",o,Q.setState),ke("onClickConnectStart",l,Q.setState),ke("onClickConnectEnd",c,Q.setState),ke("nodesDraggable",d,Q.setState),ke("nodesConnectable",u,Q.setState),ke("nodesFocusable",f,Q.setState),ke("edgesFocusable",p,Q.setState),ke("edgesUpdatable",h,Q.setState),ke("elementsSelectable",_,Q.setState),ke("elevateNodesOnSelect",x,Q.setState),ke("snapToGrid",N,Q.setState),ke("snapGrid",k,Q.setState),ke("onNodesChange",y,Q.setState),ke("onEdgesChange",b,Q.setState),ke("connectOnClick",S,Q.setState),ke("fitViewOnInit",T,Q.setState),ke("fitViewOnInitOptions",M,Q.setState),ke("onNodesDelete",z,Q.setState),ke("onEdgesDelete",C,Q.setState),ke("onNodeDrag",L,Q.setState),ke("onNodeDragStart",P,Q.setState),ke("onNodeDragStop",$,Q.setState),ke("onSelectionDrag",O,Q.setState),ke("onSelectionDragStart",A,Q.setState),ke("onSelectionDragStop",F,Q.setState),ke("noPanClassName",I,Q.setState),ke("nodeOrigin",q,Q.setState),ke("rfId",W,Q.setState),ke("autoPanOnConnect",U,Q.setState),ke("autoPanOnNodeDrag",Z,Q.setState),ke("onError",B,Q.setState),ke("connectionRadius",ne,Q.setState),ke("isValidConnection",ie,Q.setState),ke("nodeDragThreshold",le,Q.setState),Oi(e,J),Oi(t,_e),Oi(g,ve),Oi(w,fe),Oi(E,se),Oi(v,ge),null},xb={display:"none"},PO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},KC="react-flow__node-desc",YC="react-flow__edge-desc",OO="react-flow__aria-live",DO=e=>e.ariaLiveMessage;function LO({rfId:e}){const t=Xe(DO);return V.createElement("div",{id:`${OO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:PO},t)}function FO({rfId:e,disableKeyboardA11y:t}){return V.createElement(V.Fragment,null,V.createElement("div",{id:`${KC}-${e}`,style:xb},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),V.createElement("div",{id:`${YC}-${e}`,style:xb},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&V.createElement(LO,{rfId:e}))}var na=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=m.useState(!1),i=m.useRef(!1),s=m.useRef(new Set([])),[o,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&_v(h))return!1;const g=bb(h.code,l);s.current.add(h[g]),yb(o,s.current,!1)&&(h.preventDefault(),r(!0))},f=h=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&_v(h))return!1;const g=bb(h.code,l);yb(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(h[g]),h.key==="Meta"&&s.current.clear(),i.current=!1},p=()=>{s.current.clear(),r(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,r]),n};function yb(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function bb(e,t){return t.includes(e)?"code":"key"}function XC(e,t,n,r){var l,c;const i=e.parentNode||e.parentId;if(!i)return n;const s=t.get(i),o=xi(s,r);return XC(s,t,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((l=s[nt])==null?void 0:l.z)??0)>(n.z??0)?((c=s[nt])==null?void 0:c.z)??0:n.z??0},r)}function QC(e,t,n){e.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:l,z:c}=XC(r,e,{...r.position,z:((s=r[nt])==null?void 0:s.z)??0},t);r.positionAbsolute={x:o,y:l},r[nt].z=c,n!=null&&n[r.id]&&(r[nt].isParent=!0)}})}function id(e,t,n,r){const i=new Map,s={},o=r?1e3:0;return e.forEach(l=>{var h;const c=(mn(l.zIndex)?l.zIndex:0)+(l.selected?o:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(s[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,nt,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[nt])==null?void 0:h.handleBounds,z:c}}),i.set(l.id,u)}),QC(i,n,s),i}function ZC(e,t={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const x=n().filter(w=>{var y;const v=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(y=t.nodes)!=null&&y.length?v&&t.nodes.some(b=>b.id===w.id):v}),g=x.every(w=>w.width&&w.height);if(x.length>0&&g){const w=Yc(x,f),{x:v,y,zoom:b}=LC(w,r,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),_=lr.translate(v,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(li(c,t.duration),_):l.transform(c,_),!0}}return!1}function zO(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[nt]:r[nt],selected:n.selected})}),new Map(t)}function qO(e,t){return t.map(n=>{const r=e.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function Za({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=n();e!=null&&e.length&&(c&&r({nodeInternals:zO(e,i)}),o==null||o(e)),t!=null&&t.length&&(d&&r({edges:qO(t,s)}),l==null||l(t))}const Di=()=>{},$O={zoomIn:Di,zoomOut:Di,zoomTo:Di,getZoom:()=>1,setViewport:Di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Di,fitBounds:Di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},BO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),HO=()=>{const e=vt(),{d3Zoom:t,d3Selection:n}=Xe(BO,It);return m.useMemo(()=>n&&t?{zoomIn:i=>t.scaleBy(li(n,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(li(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(li(n,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,l,c]=e.getState().transform,d=lr.translate(i.x??o,i.y??l).scale(i.zoom??c);t.transform(li(n,s==null?void 0:s.duration),d)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>ZC(e.getState,i),setCenter:(i,s,o)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:d,f=l/2-i*u,p=c/2-s*u,h=lr.translate(f,p).scale(u);t.transform(li(n,o==null?void 0:o.duration),h)},fitBounds:(i,s)=>{const{width:o,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=LC(i,o,l,c,d,(s==null?void 0:s.padding)??.1),h=lr.translate(u,f).scale(p);t.transform(li(n,s==null?void 0:s.duration),h)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),kv(i,s,o,l)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:l,domNode:c}=e.getState();if(!c)return i;const{x:d,y:u}=c.getBoundingClientRect(),f={x:i.x-d,y:i.y-u};return kv(f,s,o,l)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:l,y:c}=o.getBoundingClientRect(),d=PC(i,s);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:$O,[t,n])};function Xc(){const e=HO(),t=vt(),n=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),r=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),i=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(w=>({...w}))},[]),s=m.useCallback(g=>{const{edges:w=[]}=t.getState();return w.find(v=>v.id===g)},[]),o=m.useCallback(g=>{const{getNodes:w,setNodes:v,hasDefaultNodes:y,onNodesChange:b}=t.getState(),_=w(),j=typeof g=="function"?g(_):g;if(y)v(j);else if(b){const k=j.length===0?_.map(N=>({type:"remove",id:N.id})):j.map(N=>({item:N,type:"reset"}));b(k)}},[]),l=m.useCallback(g=>{const{edges:w=[],setEdges:v,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),_=typeof g=="function"?g(w):g;if(y)v(_);else if(b){const j=_.length===0?w.map(k=>({type:"remove",id:k.id})):_.map(k=>({item:k,type:"reset"}));b(j)}},[]),c=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{getNodes:v,setNodes:y,hasDefaultNodes:b,onNodesChange:_}=t.getState();if(b){const k=[...v(),...w];y(k)}else if(_){const j=w.map(k=>({item:k,type:"add"}));_(j)}},[]),d=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{edges:v=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:_}=t.getState();if(b)y([...v,...w]);else if(_){const j=w.map(k=>({item:k,type:"add"}));_(j)}},[]),u=m.useCallback(()=>{const{getNodes:g,edges:w=[],transform:v}=t.getState(),[y,b,_]=v;return{nodes:g().map(j=>({...j})),edges:w.map(j=>({...j})),viewport:{x:y,y:b,zoom:_}}},[]),f=m.useCallback(({nodes:g,edges:w})=>{const{nodeInternals:v,getNodes:y,edges:b,hasDefaultNodes:_,hasDefaultEdges:j,onNodesDelete:k,onEdgesDelete:N,onNodesChange:E,onEdgesChange:S}=t.getState(),R=(g||[]).map(L=>L.id),T=(w||[]).map(L=>L.id),M=y().reduce((L,P)=>{const $=P.parentNode||P.parentId,O=!R.includes(P.id)&&$&&L.find(F=>F.id===$);return(typeof P.deletable=="boolean"?P.deletable:!0)&&(R.includes(P.id)||O)&&L.push(P),L},[]),z=b.filter(L=>typeof L.deletable=="boolean"?L.deletable:!0),C=z.filter(L=>T.includes(L.id));if(M||C){const L=DC(M,z),P=[...C,...L],$=P.reduce((O,A)=>(O.includes(A.id)||O.push(A.id),O),[]);if((j||_)&&(j&&t.setState({edges:b.filter(O=>!$.includes(O.id))}),_&&(M.forEach(O=>{v.delete(O.id)}),t.setState({nodeInternals:new Map(v)}))),$.length>0&&(N==null||N(P),S&&S($.map(O=>({id:O,type:"remove"})))),M.length>0&&(k==null||k(M),E)){const O=M.map(A=>({id:A.id,type:"remove"}));E(O)}}},[]),p=m.useCallback(g=>{const w=cO(g),v=w?null:t.getState().nodeInternals.get(g.id);return!w&&!v?[null,null,w]:[w?g:db(v),v,w]},[]),h=m.useCallback((g,w=!0,v)=>{const[y,b,_]=p(g);return y?(v||t.getState().getNodes()).filter(j=>{if(!_&&(j.id===b.id||!j.positionAbsolute))return!1;const k=db(j),N=wv(k,y);return w&&N>0||N>=y.width*y.height}):[]},[]),x=m.useCallback((g,w,v=!0)=>{const[y]=p(g);if(!y)return!1;const b=wv(y,w);return v&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:x}),[e,n,r,i,s,o,l,c,d,u,f,h,x])}const WO={actInsideInputWithModifier:!1};var UO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=vt(),{deleteElements:r}=Xc(),i=na(e,WO),s=na(t);m.useEffect(()=>{if(i){const{edges:o,getNodes:l}=n.getState(),c=l().filter(u=>u.selected),d=o.filter(u=>u.selected);r({nodes:c,edges:d}),n.setState({nodesSelectionActive:!1})}},[i]),m.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function VO(e){const t=vt();m.useEffect(()=>{let n;const r=()=>{var s,o;if(!e.current)return;const i=Hx(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",hr.error004())),t.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Qx={position:"absolute",width:"100%",height:"100%",top:0,left:0},GO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Ja=e=>({x:e.x,y:e.y,zoom:e.k}),Li=(e,t)=>e.target.closest(`.${t}`),wb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),_b=e=>{const t=e.ctrlKey&&ac()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},KO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),YO=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=pi.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:x,maxZoom:g,zoomActivationKeyCode:w,preventScrolling:v=!0,children:y,noWheelClassName:b,noPanClassName:_})=>{const j=m.useRef(),k=vt(),N=m.useRef(!1),E=m.useRef(!1),S=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:M,d3ZoomHandler:z,userSelectionActive:C}=Xe(KO,It),L=na(w),P=m.useRef(0),$=m.useRef(!1),O=m.useRef();return VO(S),m.useEffect(()=>{if(S.current){const A=S.current.getBoundingClientRect(),F=_C().scaleExtent([x,g]).translateExtent(h),I=pn(S.current).call(F),q=lr.translate(p.x,p.y).scale(ks(p.zoom,x,g)),W=[[0,0],[A.width,A.height]],U=F.constrain()(q,W,h);F.transform(I,U),F.wheelDelta(_b),k.setState({d3Zoom:F,d3Selection:I,d3ZoomHandler:I.on("wheel.zoom"),transform:[U.x,U.y,U.k],domNode:S.current.closest(".react-flow")})}},[]),m.useEffect(()=>{M&&T&&(o&&!L&&!C?M.on("wheel.zoom",A=>{if(Li(A,b))return!1;A.preventDefault(),A.stopImmediatePropagation();const F=M.property("__zoom").k||1;if(A.ctrlKey&&s){const ie=Nn(A),le=_b(A),J=F*Math.pow(2,le);T.scaleTo(M,J,ie,A);return}const I=A.deltaMode===1?20:1;let q=c===pi.Vertical?0:A.deltaX*I,W=c===pi.Horizontal?0:A.deltaY*I;!ac()&&A.shiftKey&&c!==pi.Vertical&&(q=A.deltaY*I,W=0),T.translateBy(M,-(q/F)*l,-(W/F)*l,{internal:!0});const U=Ja(M.property("__zoom")),{onViewportChangeStart:Z,onViewportChange:B,onViewportChangeEnd:ne}=k.getState();clearTimeout(O.current),$.current||($.current=!0,t==null||t(A,U),Z==null||Z(U)),$.current&&(e==null||e(A,U),B==null||B(U),O.current=setTimeout(()=>{n==null||n(A,U),ne==null||ne(U),$.current=!1},150))},{passive:!1}):typeof z<"u"&&M.on("wheel.zoom",function(A,F){if(!v&&A.type==="wheel"&&!A.ctrlKey||Li(A,b))return null;A.preventDefault(),z.call(this,A,F)},{passive:!1}))},[C,o,c,M,T,z,L,s,v,b,t,e,n]),m.useEffect(()=>{T&&T.on("start",A=>{var q,W;if(!A.sourceEvent||A.sourceEvent.internal)return null;P.current=(q=A.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:F}=k.getState(),I=Ja(A.transform);N.current=!0,R.current=I,((W=A.sourceEvent)==null?void 0:W.type)==="mousedown"&&k.setState({paneDragging:!0}),F==null||F(I),t==null||t(A.sourceEvent,I)})},[T,t]),m.useEffect(()=>{T&&(C&&!N.current?T.on("zoom",null):C||T.on("zoom",A=>{var I;const{onViewportChange:F}=k.getState();if(k.setState({transform:[A.transform.x,A.transform.y,A.transform.k]}),E.current=!!(r&&wb(f,P.current??0)),(e||F)&&!((I=A.sourceEvent)!=null&&I.internal)){const q=Ja(A.transform);F==null||F(q),e==null||e(A.sourceEvent,q)}}))},[C,T,e,f,r]),m.useEffect(()=>{T&&T.on("end",A=>{if(!A.sourceEvent||A.sourceEvent.internal)return null;const{onViewportChangeEnd:F}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),r&&wb(f,P.current??0)&&!E.current&&r(A.sourceEvent),E.current=!1,(n||F)&&GO(R.current,A.transform)){const I=Ja(A.transform);R.current=I,clearTimeout(j.current),j.current=setTimeout(()=>{F==null||F(I),n==null||n(A.sourceEvent,I)},o?150:0)}})},[T,o,f,n,r]),m.useEffect(()=>{T&&T.filter(A=>{const F=L||i,I=s&&A.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&A.button===1&&A.type==="mousedown"&&(Li(A,"react-flow__node")||Li(A,"react-flow__edge")))return!0;if(!f&&!F&&!o&&!d&&!s||C||!d&&A.type==="dblclick"||Li(A,b)&&A.type==="wheel"||Li(A,_)&&(A.type!=="wheel"||o&&A.type==="wheel"&&!L)||!s&&A.ctrlKey&&A.type==="wheel"||!F&&!o&&!I&&A.type==="wheel"||!f&&(A.type==="mousedown"||A.type==="touchstart")||Array.isArray(f)&&!f.includes(A.button)&&A.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(A.button)||!A.button||A.button<=1;return(!A.ctrlKey||A.type==="wheel")&&q})},[C,T,i,s,o,d,f,u,L]),V.createElement("div",{className:"react-flow__renderer",ref:S,style:Qx},y)},XO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function QO(){const{userSelectionActive:e,userSelectionRect:t}=Xe(XO,It);return e&&t?V.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function jb(e,t){const n=t.parentNode||t.parentId,r=e.find(i=>i.id===n);if(r){const i=t.position.x+t.width-r.width,s=t.position.y+t.height-r.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);r.position.x=r.position.x-o,r.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);r.position.y=r.position.y-o,r.style.height+=o,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function JC(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,i)=>{const s=e.filter(l=>l.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const l of s)if(l)switch(l.type){case"select":{o.selected=l.selected;break}case"position":{typeof l.position<"u"&&(o.position=l.position),typeof l.positionAbsolute<"u"&&(o.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(o.dragging=l.dragging),o.expandParent&&jb(r,o);break}case"dimensions":{typeof l.dimensions<"u"&&(o.width=l.dimensions.width,o.height=l.dimensions.height),typeof l.updateStyle<"u"&&(o.style={...o.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(o.resizing=l.resizing),o.expandParent&&jb(r,o);break}case"remove":return r}return r.push(o),r},n)}function eE(e,t){return JC(e,t)}function ZO(e,t){return JC(e,t)}const Nr=(e,t)=>({id:e,type:"select",selected:t});function ns(e,t){return e.reduce((n,r)=>{const i=t.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(Nr(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(Nr(r.id,!1))),n},[])}const sd=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},JO=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),tE=m.memo(({isSelecting:e,selectionMode:t=ta.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=vt(),x=m.useRef(0),g=m.useRef(0),w=m.useRef(),{userSelectionActive:v,elementsSelectable:y,dragging:b}=Xe(JO,It),_=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,g.current=0},j=z=>{s==null||s(z),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},k=z=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){z.preventDefault();return}o==null||o(z)},N=l?z=>l(z):void 0,E=z=>{const{resetSelectedElements:C,domNode:L}=h.getState();if(w.current=L==null?void 0:L.getBoundingClientRect(),!y||!e||z.button!==0||z.target!==p.current||!w.current)return;const{x:P,y:$}=Wr(z,w.current);C(),h.setState({userSelectionRect:{width:0,height:0,startX:P,startY:$,x:P,y:$}}),r==null||r(z)},S=z=>{const{userSelectionRect:C,nodeInternals:L,edges:P,transform:$,onNodesChange:O,onEdgesChange:A,nodeOrigin:F,getNodes:I}=h.getState();if(!e||!w.current||!C)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Wr(z,w.current),W=C.startX??0,U=C.startY??0,Z={...C,x:q.x<W?q.x:W,y:q.y<U?q.y:U,width:Math.abs(q.x-W),height:Math.abs(q.y-U)},B=I(),ne=OC(L,Z,$,t===ta.Partial,!0,F),ie=DC(ne,P).map(J=>J.id),le=ne.map(J=>J.id);if(x.current!==le.length){x.current=le.length;const J=ns(B,le);J.length&&(O==null||O(J))}if(g.current!==ie.length){g.current=ie.length;const J=ns(P,ie);J.length&&(A==null||A(J))}h.setState({userSelectionRect:Z})},R=z=>{if(z.button!==0)return;const{userSelectionRect:C}=h.getState();!v&&C&&z.target===p.current&&(j==null||j(z)),h.setState({nodesSelectionActive:x.current>0}),_(),i==null||i(z)},T=z=>{v&&(h.setState({nodesSelectionActive:x.current>0}),i==null||i(z)),_()},M=y&&(e||v);return V.createElement("div",{className:Kt(["react-flow__pane",{dragging:b,selection:e}]),onClick:M?void 0:sd(j,p),onContextMenu:sd(k,p),onWheel:sd(N,p),onMouseEnter:M?void 0:c,onMouseDown:M?E:void 0,onMouseMove:M?S:d,onMouseUp:M?R:void 0,onMouseLeave:M?T:u,ref:p,style:Qx},f,V.createElement(QO,null))});tE.displayName="Pane";function nE(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:nE(r,t):!1}function Sb(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function eD(e,t,n,r){return Array.from(e.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!nE(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function tD(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function rE(e,t,n,r,i=[0,0],s){const o=tD(e,e.extent||r);let l=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=f&&mn(p)&&mn(h)&&mn(f.width)&&mn(f.height)?[[p+e.width*i[0],h+e.height*i[1]],[p+f.width-e.width+e.width*i[0],h+f.height-e.height+e.height*i[1]]]:l}else s==null||s("005",hr.error005()),l=o;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=n.get(c);d=xi(f,i).positionAbsolute}const u=l&&l!=="parent"?Wx(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function od({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?r.find(i=>i.id===e):r[0],r]}const kb=(e,t,n,r)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),l={x:o.width*r[0],y:o.height*r[1]};return s.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-o.left-l.x)/n,y:(d.top-o.top-l.y)/n,...Hx(c)}})};function Zs(e,t,n){return n===void 0?n:r=>{const i=t().nodeInternals.get(e);i&&n(r,{...i})}}function Cv({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",hr.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&o)&&(s({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):i([e])}function nD(){const e=vt();return m.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=e.getState(),o=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,c={x:(o-r[0])/r[2],y:(l-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function ad(e){return(t,n,r)=>e==null?void 0:e(t,r)}function iE({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const l=vt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),x=m.useRef({x:0,y:0}),g=m.useRef(null),w=m.useRef(!1),v=m.useRef(!1),y=m.useRef(!1),b=nD();return m.useEffect(()=>{if(e!=null&&e.current){const _=pn(e.current),j=({x:E,y:S})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:M,updateNodePositions:z,nodeExtent:C,snapGrid:L,snapToGrid:P,nodeOrigin:$,onError:O}=l.getState();f.current={x:E,y:S};let A=!1,F={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&C){const q=Yc(u.current,$);F=ea(q)}if(u.current=u.current.map(q=>{const W={x:E-q.distance.x,y:S-q.distance.y};P&&(W.x=L[0]*Math.round(W.x/L[0]),W.y=L[1]*Math.round(W.y/L[1]));const U=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];u.current.length>1&&C&&!q.extent&&(U[0][0]=q.positionAbsolute.x-F.x+C[0][0],U[1][0]=q.positionAbsolute.x+(q.width??0)-F.x2+C[1][0],U[0][1]=q.positionAbsolute.y-F.y+C[0][1],U[1][1]=q.positionAbsolute.y+(q.height??0)-F.y2+C[1][1]);const Z=rE(q,W,R,U,$,O);return A=A||q.position.x!==Z.position.x||q.position.y!==Z.position.y,q.position=Z.position,q.positionAbsolute=Z.positionAbsolute,q}),!A)return;z(u.current,!0,!0),d(!0);const I=i?T:ad(M);if(I&&g.current){const[q,W]=od({nodeId:i,dragItems:u.current,nodeInternals:R});I(g.current,q,W)}},k=()=>{if(!h.current)return;const[E,S]=SC(x.current,h.current);if(E!==0||S!==0){const{transform:R,panBy:T}=l.getState();f.current.x=(f.current.x??0)-E/R[2],f.current.y=(f.current.y??0)-S/R[2],T({x:E,y:S})&&j(f.current)}p.current=requestAnimationFrame(k)},N=E=>{var $;const{nodeInternals:S,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:M,onNodeDragStart:z,onSelectionDragStart:C}=l.getState();v.current=!0;const L=i?z:ad(C);(!o||!s)&&!R&&i&&(($=S.get(i))!=null&&$.selected||M()),i&&s&&o&&Cv({id:i,store:l,nodeRef:e});const P=b(E);if(f.current=P,u.current=eD(S,T,P,i),L&&u.current){const[O,A]=od({nodeId:i,dragItems:u.current,nodeInternals:S});L(E.sourceEvent,O,A)}};if(t)_.on(".drag",null);else{const E=pM().on("start",S=>{const{domNode:R,nodeDragThreshold:T}=l.getState();T===0&&N(S),y.current=!1;const M=b(S);f.current=M,h.current=(R==null?void 0:R.getBoundingClientRect())||null,x.current=Wr(S.sourceEvent,h.current)}).on("drag",S=>{var z,C;const R=b(S),{autoPanOnNodeDrag:T,nodeDragThreshold:M}=l.getState();if(S.sourceEvent.type==="touchmove"&&S.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!w.current&&v.current&&T&&(w.current=!0,k()),!v.current){const L=R.xSnapped-(((z=f==null?void 0:f.current)==null?void 0:z.x)??0),P=R.ySnapped-(((C=f==null?void 0:f.current)==null?void 0:C.y)??0);Math.sqrt(L*L+P*P)>M&&N(S)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&u.current&&v.current&&(g.current=S.sourceEvent,x.current=Wr(S.sourceEvent,h.current),j(R))}}).on("end",S=>{if(!(!v.current||y.current)&&(d(!1),w.current=!1,v.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:M,onSelectionDragStop:z}=l.getState(),C=i?M:ad(z);if(R(u.current,!1,!1),C){const[L,P]=od({nodeId:i,dragItems:u.current,nodeInternals:T});C(S.sourceEvent,L,P)}}}).filter(S=>{const R=S.target;return!S.button&&(!n||!Sb(R,`.${n}`,e))&&(!r||Sb(R,r,e))});return _.call(E),()=>{_.on(".drag",null)}}}},[e,t,n,r,s,l,i,o,b]),c}function sE(){const e=vt();return m.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=o().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,x=n.isShiftPressed?4:1,g=n.x*p*x,w=n.y*h*x,v=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+g,y:y.positionAbsolute.y+w};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:_,position:j}=rE(y,b,r,i,void 0,d);y.position=j,y.positionAbsolute=_}return y});s(v,!0,!1)},[])}const ps={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Js=e=>{const t=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:x,onDoubleClick:g,style:w,className:v,isDraggable:y,isSelectable:b,isConnectable:_,isFocusable:j,selectNodesOnDrag:k,sourcePosition:N,targetPosition:E,hidden:S,resizeObserver:R,dragHandle:T,zIndex:M,isParent:z,noDragClassName:C,noPanClassName:L,initialized:P,disableKeyboardA11y:$,ariaLabel:O,rfId:A,hasHandleBounds:F})=>{const I=vt(),q=m.useRef(null),W=m.useRef(null),U=m.useRef(N),Z=m.useRef(E),B=m.useRef(r),ne=b||y||u||f||p||h,ie=sE(),le=Zs(n,I.getState,f),J=Zs(n,I.getState,p),_e=Zs(n,I.getState,h),G=Zs(n,I.getState,x),ve=Zs(n,I.getState,g),fe=Y=>{const{nodeDragThreshold:Q}=I.getState();if(b&&(!k||!y||Q>0)&&Cv({id:n,store:I,nodeRef:q}),u){const pe=I.getState().nodeInternals.get(n);pe&&u(Y,{...pe})}},se=Y=>{if(!_v(Y)&&!$)if(EC.includes(Y.key)&&b){const Q=Y.key==="Escape";Cv({id:n,store:I,unselect:Q,nodeRef:q})}else y&&d&&Object.prototype.hasOwnProperty.call(ps,Y.key)&&(I.setState({ariaLiveMessage:`Moved selected node ${Y.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),ie({x:ps[Y.key].x,y:ps[Y.key].y,isShiftPressed:Y.shiftKey}))};m.useEffect(()=>()=>{W.current&&(R==null||R.unobserve(W.current),W.current=null)},[]),m.useEffect(()=>{if(q.current&&!S){const Y=q.current;(!P||!F||W.current!==Y)&&(W.current&&(R==null||R.unobserve(W.current)),R==null||R.observe(Y),W.current=Y)}},[S,P,F]),m.useEffect(()=>{const Y=B.current!==r,Q=U.current!==N,pe=Z.current!==E;q.current&&(Y||Q||pe)&&(Y&&(B.current=r),Q&&(U.current=N),pe&&(Z.current=E),I.getState().updateNodeDimensions([{id:n,nodeElement:q.current,forceUpdate:!0}]))},[n,r,N,E]);const ge=iE({nodeRef:q,disabled:S||!y,noDragClassName:C,handleSelector:T,nodeId:n,isSelectable:b,selectNodesOnDrag:k});return S?null:V.createElement("div",{className:Kt(["react-flow__node",`react-flow__node-${r}`,{[L]:y},v,{selected:d,selectable:b,parent:z,dragging:ge}]),ref:q,style:{zIndex:M,transform:`translate(${l}px,${c}px)`,pointerEvents:ne?"all":"none",visibility:P?"visible":"hidden",...w},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:le,onMouseMove:J,onMouseLeave:_e,onContextMenu:G,onClick:fe,onDoubleClick:ve,onKeyDown:j?se:void 0,tabIndex:j?0:void 0,role:j?"button":void 0,"aria-describedby":$?void 0:`${KC}-${A}`,"aria-label":O},V.createElement(gO,{value:n},V.createElement(e,{id:n,data:i,type:r,xPos:s,yPos:o,selected:d,isConnectable:_,sourcePosition:N,targetPosition:E,dragging:ge,dragHandle:T,zIndex:M})))};return t.displayName="NodeWrapper",m.memo(t)};const rD=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Yc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function iD({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=vt(),{width:i,height:s,x:o,y:l,transformString:c,userSelectionActive:d}=Xe(rD,It),u=sE(),f=m.useRef(null);if(m.useEffect(()=>{var x;n||(x=f.current)==null||x.focus({preventScroll:!0})},[n]),iE({nodeRef:f}),d||!i||!s)return null;const p=e?x=>{const g=r.getState().getNodes().filter(w=>w.selected);e(x,g)}:void 0,h=x=>{Object.prototype.hasOwnProperty.call(ps,x.key)&&u({x:ps[x.key].x,y:ps[x.key].y,isShiftPressed:x.shiftKey})};return V.createElement("div",{className:Kt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},V.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:i,height:s,top:l,left:o}}))}var sD=m.memo(iD);const oD=e=>e.nodesSelectionActive,oE=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:x,onSelectionEnd:g,multiSelectionKeyCode:w,panActivationKeyCode:v,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:R,defaultViewport:T,translateExtent:M,minZoom:z,maxZoom:C,preventScrolling:L,onSelectionContextMenu:P,noWheelClassName:$,noPanClassName:O,disableKeyboardA11y:A})=>{const F=Xe(oD),I=na(f),q=na(v),W=q||R,U=q||k,Z=I||p&&W!==!0;return UO({deleteKeyCode:l,multiSelectionKeyCode:w}),V.createElement(YO,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:U,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:!I&&W,defaultViewport:T,translateExtent:M,minZoom:z,maxZoom:C,zoomActivationKeyCode:y,preventScrolling:L,noWheelClassName:$,noPanClassName:O},V.createElement(tE,{onSelectionStart:x,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:W,isSelecting:!!Z,selectionMode:h},e,F&&V.createElement(sD,{onSelectionContextMenu:P,noPanClassName:O,disableKeyboardA11y:A})))};oE.displayName="FlowRenderer";var aD=m.memo(oE);function lD(e){return Xe(m.useCallback(n=>e?OC(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function cD(e){const t={input:Js(e.input||WC),default:Js(e.default||Nv),output:Js(e.output||VC),group:Js(e.group||Xx)},n={},r=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=Js(e[s]||Nv),i),n);return{...t,...r}}const uD=({x:e,y:t,width:n,height:r,origin:i})=>!n||!r?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]},dD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),aE=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Xe(dD,It),l=lD(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));s(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),V.createElement("div",{className:"react-flow__nodes",style:Qx},l.map(u=>{var j,k,N;let f=u.type||"default";e.nodeTypes[f]||(o==null||o("003",hr.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),x=!!(u.selectable||i&&typeof u.selectable>"u"),g=!!(u.connectable||n&&typeof u.connectable>"u"),w=!!(u.focusable||r&&typeof u.focusable>"u"),v=e.nodeExtent?Wx(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(v==null?void 0:v.x)??0,b=(v==null?void 0:v.y)??0,_=uD({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return V.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||ae.Bottom,targetPosition:u.targetPosition||ae.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:x,isConnectable:g,isFocusable:w,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((j=u[nt])==null?void 0:j.z)??0,isParent:!!((k=u[nt])!=null&&k.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((N=u[nt])!=null&&N.handleBounds)})}))};aE.displayName="NodeRenderer";var fD=m.memo(aE);const pD=(e,t,n)=>n===ae.Left?e-t:n===ae.Right?e+t:e,hD=(e,t,n)=>n===ae.Top?e-t:n===ae.Bottom?e+t:e,Nb="react-flow__edgeupdater",Cb=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:l})=>V.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Kt([Nb,`${Nb}-${l}`]),cx:pD(t,r,e),cy:hD(n,r,e),r,stroke:"transparent",fill:"transparent"}),mD=()=>!0;var Fi=e=>{const t=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:g,style:w,source:v,target:y,sourceX:b,sourceY:_,targetX:j,targetY:k,sourcePosition:N,targetPosition:E,elementsSelectable:S,hidden:R,sourceHandleId:T,targetHandleId:M,onContextMenu:z,onMouseEnter:C,onMouseMove:L,onMouseLeave:P,reconnectRadius:$,onReconnect:O,onReconnectStart:A,onReconnectEnd:F,markerEnd:I,markerStart:q,rfId:W,ariaLabel:U,isFocusable:Z,isReconnectable:B,pathOptions:ne,interactionWidth:ie,disableKeyboardA11y:le})=>{const J=m.useRef(null),[_e,G]=m.useState(!1),[ve,fe]=m.useState(!1),se=vt(),ge=m.useMemo(()=>`url('#${Sv(q,W)}')`,[q,W]),Y=m.useMemo(()=>`url('#${Sv(I,W)}')`,[I,W]);if(R)return null;const Q=Re=>{var yt;const{edges:X,addSelectedEdges:Oe,unselectNodesAndEdges:me,multiSelectionActive:kt}=se.getState(),xt=X.find(Xt=>Xt.id===n);xt&&(S&&(se.setState({nodesSelectionActive:!1}),xt.selected&&kt?(me({nodes:[],edges:[xt]}),(yt=J.current)==null||yt.blur()):Oe([n])),o&&o(Re,xt))},pe=Qs(n,se.getState,l),ye=Qs(n,se.getState,z),we=Qs(n,se.getState,C),xe=Qs(n,se.getState,L),te=Qs(n,se.getState,P),he=(Re,X)=>{if(Re.button!==0)return;const{edges:Oe,isValidConnection:me}=se.getState(),kt=X?y:v,xt=(X?M:T)||null,yt=X?"target":"source",Xt=me||mD,D=X,H=Oe.find(De=>De.id===n);fe(!0),A==null||A(Re,H,yt);const K=De=>{fe(!1),F==null||F(De,H,yt)};qC({event:Re,handleId:xt,nodeId:kt,onConnect:De=>O==null?void 0:O(H,De),isTarget:D,getState:se.getState,setState:se.setState,isValidConnection:Xt,edgeUpdaterType:yt,onReconnectEnd:K})},Ge=Re=>he(Re,!0),ze=Re=>he(Re,!1),Be=()=>G(!0),Te=()=>G(!1),He=!S&&!o,at=Re=>{var X;if(!le&&EC.includes(Re.key)&&S){const{unselectNodesAndEdges:Oe,addSelectedEdges:me,edges:kt}=se.getState();Re.key==="Escape"?((X=J.current)==null||X.blur(),Oe({edges:[kt.find(yt=>yt.id===n)]})):me([n])}};return V.createElement("g",{className:Kt(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:c,animated:d,inactive:He,updating:_e}]),onClick:Q,onDoubleClick:pe,onContextMenu:ye,onMouseEnter:we,onMouseMove:xe,onMouseLeave:te,onKeyDown:Z?at:void 0,tabIndex:Z?0:void 0,role:Z?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":U===null?void 0:U||`Edge from ${v} to ${y}`,"aria-describedby":Z?`${YC}-${W}`:void 0,ref:J},!ve&&V.createElement(e,{id:n,source:v,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:g,data:s,style:w,sourceX:b,sourceY:_,targetX:j,targetY:k,sourcePosition:N,targetPosition:E,sourceHandleId:T,targetHandleId:M,markerStart:ge,markerEnd:Y,pathOptions:ne,interactionWidth:ie}),B&&V.createElement(V.Fragment,null,(B==="source"||B===!0)&&V.createElement(Cb,{position:N,centerX:b,centerY:_,radius:$,onMouseDown:Ge,onMouseEnter:Be,onMouseOut:Te,type:"source"}),(B==="target"||B===!0)&&V.createElement(Cb,{position:E,centerX:j,centerY:k,radius:$,onMouseDown:ze,onMouseEnter:Be,onMouseOut:Te,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function gD(e){const t={default:Fi(e.default||cc),straight:Fi(e.bezier||Gx),step:Fi(e.step||Vx),smoothstep:Fi(e.step||Kc),simplebezier:Fi(e.simplebezier||Ux)},n={},r=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Fi(e[s]||cc),i),n);return{...t,...r}}function Eb(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,s=(n==null?void 0:n.width)||t.width,o=(n==null?void 0:n.height)||t.height;switch(e){case ae.Top:return{x:r+s/2,y:i};case ae.Right:return{x:r+s,y:i+o/2};case ae.Bottom:return{x:r+s/2,y:i+o};case ae.Left:return{x:r,y:i+o/2}}}function Tb(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const vD=(e,t,n,r,i,s)=>{const o=Eb(n,e,t),l=Eb(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y}};function xD({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+s)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=ea({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Rb(e){var r,i,s,o,l;const t=((r=e==null?void 0:e[nt])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const yD=[{level:0,isMaxLevel:!0,edges:[]}];function bD(e,t,n=!1){let r=-1;const i=e.reduce((o,l)=>{var u,f;const c=mn(l.zIndex);let d=c?l.zIndex:0;if(n){const p=t.get(l.target),h=t.get(l.source),x=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),g=Math.max(((u=h==null?void 0:h[nt])==null?void 0:u.z)||0,((f=p==null?void 0:p[nt])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(x?g:0)}return o[d]?o[d].push(l):o[d]=[l],r=d>r?d:r,o},{}),s=Object.entries(i).map(([o,l])=>{const c=+o;return{edges:l,level:c,isMaxLevel:c===r}});return s.length===0?yD:s}function wD(e,t,n){const r=Xe(m.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),l=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&xD({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:l.width,targetHeight:l.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return bD(r,t,n)}const _D=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),jD=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Ab={[lc.Arrow]:_D,[lc.ArrowClosed]:jD};function SD(e){const t=vt();return m.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Ab,e)?Ab[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",hr.error009(e)),null)},[e])}const kD=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const c=SD(t);return c?V.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0"},V.createElement(c,{color:n,strokeWidth:o})):null},ND=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const l=Sv(o,t);r.includes(l)||(i.push({id:l,color:o.color||e,...o}),r.push(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},lE=({defaultColor:e,rfId:t})=>{const n=Xe(m.useCallback(ND({defaultColor:e,rfId:t}),[e,t]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return V.createElement("defs",null,n.map(r=>V.createElement(kD,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};lE.displayName="MarkerDefinitions";var CD=m.memo(lE);const ED=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),cE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:g,children:w,disableKeyboardA11y:v})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:_,width:j,height:k,connectionMode:N,nodeInternals:E,onError:S}=Xe(ED,It),R=wD(t,E,n);return j?V.createElement(V.Fragment,null,R.map(({level:T,edges:M,isMaxLevel:z})=>V.createElement("svg",{key:T,style:{zIndex:T},width:j,height:k,className:"react-flow__edges react-flow__container"},z&&V.createElement(CD,{defaultColor:e,rfId:r}),V.createElement("g",null,M.map(C=>{const[L,P,$]=Rb(E.get(C.source)),[O,A,F]=Rb(E.get(C.target));if(!$||!F)return null;let I=C.type||"default";i[I]||(S==null||S("011",hr.error011(I)),I="default");const q=i[I]||i.default,W=N===Ni.Strict?A.target:(A.target??[]).concat(A.source??[]),U=Tb(P.source,C.sourceHandle),Z=Tb(W,C.targetHandle),B=(U==null?void 0:U.position)||ae.Bottom,ne=(Z==null?void 0:Z.position)||ae.Top,ie=!!(C.focusable||y&&typeof C.focusable>"u"),le=C.reconnectable||C.updatable,J=typeof p<"u"&&(le||b&&typeof le>"u");if(!U||!Z)return S==null||S("008",hr.error008(U,C)),null;const{sourceX:_e,sourceY:G,targetX:ve,targetY:fe}=vD(L,U,B,O,Z,ne);return V.createElement(q,{key:C.id,id:C.id,className:Kt([C.className,s]),type:I,data:C.data,selected:!!C.selected,animated:!!C.animated,hidden:!!C.hidden,label:C.label,labelStyle:C.labelStyle,labelShowBg:C.labelShowBg,labelBgStyle:C.labelBgStyle,labelBgPadding:C.labelBgPadding,labelBgBorderRadius:C.labelBgBorderRadius,style:C.style,source:C.source,target:C.target,sourceHandleId:C.sourceHandle,targetHandleId:C.targetHandle,markerEnd:C.markerEnd,markerStart:C.markerStart,sourceX:_e,sourceY:G,targetX:ve,targetY:fe,sourcePosition:B,targetPosition:ne,elementsSelectable:_,onContextMenu:o,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:g,rfId:r,ariaLabel:C.ariaLabel,isFocusable:ie,isReconnectable:J,pathOptions:"pathOptions"in C?C.pathOptions:void 0,interactionWidth:C.interactionWidth,disableKeyboardA11y:v})})))),w):null};cE.displayName="EdgeRenderer";var TD=m.memo(cE);const RD=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function AD({children:e}){const t=Xe(RD);return V.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function ID(e){const t=Xc(),n=m.useRef(!1);m.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const MD={[ae.Left]:ae.Right,[ae.Right]:ae.Left,[ae.Top]:ae.Bottom,[ae.Bottom]:ae.Top},uE=({nodeId:e,handleType:t,style:n,type:r=Rr.Bezier,CustomComponent:i,connectionStatus:s})=>{var k,N,E;const{fromNode:o,handleId:l,toX:c,toY:d,connectionMode:u}=Xe(m.useCallback(S=>({fromNode:S.nodeInternals.get(e),handleId:S.connectionHandleId,toX:(S.connectionPosition.x-S.transform[0])/S.transform[2],toY:(S.connectionPosition.y-S.transform[1])/S.transform[2],connectionMode:S.connectionMode}),[e]),It),f=(k=o==null?void 0:o[nt])==null?void 0:k.handleBounds;let p=f==null?void 0:f[t];if(u===Ni.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!o||!p)return null;const h=l?p.find(S=>S.id===l):p[0],x=h?h.x+h.width/2:(o.width??0)/2,g=h?h.y+h.height/2:o.height??0,w=(((N=o.positionAbsolute)==null?void 0:N.x)??0)+x,v=(((E=o.positionAbsolute)==null?void 0:E.y)??0)+g,y=h==null?void 0:h.position,b=y?MD[y]:null;if(!y||!b)return null;if(i)return V.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:h,fromX:w,fromY:v,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:s});let _="";const j={sourceX:w,sourceY:v,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return r===Rr.Bezier?[_]=MC(j):r===Rr.Step?[_]=jv({...j,borderRadius:0}):r===Rr.SmoothStep?[_]=jv(j):r===Rr.SimpleBezier?[_]=IC(j):_=`M${w},${v} ${c},${d}`,V.createElement("path",{d:_,fill:"none",className:"react-flow__connection-path",style:n})};uE.displayName="ConnectionLine";const PD=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function OD({containerStyle:e,style:t,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:l,height:c,connectionStatus:d}=Xe(PD,It);return!(i&&s&&l&&o)?null:V.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},V.createElement("g",{className:Kt(["react-flow__connection",d])},V.createElement(uE,{nodeId:i,handleType:s,style:t,type:n,CustomComponent:r,connectionStatus:d})))}function Ib(e,t){return m.useRef(null),vt(),m.useMemo(()=>t(e),[e])}const dE=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:x,onSelectionStart:g,onSelectionEnd:w,connectionLineType:v,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:_,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:E,panActivationKeyCode:S,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:M,elementsSelectable:z,selectNodesOnDrag:C,defaultViewport:L,translateExtent:P,minZoom:$,maxZoom:O,preventScrolling:A,defaultMarkerColor:F,zoomOnScroll:I,zoomOnPinch:q,panOnScroll:W,panOnScrollSpeed:U,panOnScrollMode:Z,zoomOnDoubleClick:B,panOnDrag:ne,onPaneClick:ie,onPaneMouseEnter:le,onPaneMouseMove:J,onPaneMouseLeave:_e,onPaneScroll:G,onPaneContextMenu:ve,onEdgeContextMenu:fe,onEdgeMouseEnter:se,onEdgeMouseMove:ge,onEdgeMouseLeave:Y,onReconnect:Q,onReconnectStart:pe,onReconnectEnd:ye,reconnectRadius:we,noDragClassName:xe,noWheelClassName:te,noPanClassName:he,elevateEdgesOnSelect:Ge,disableKeyboardA11y:ze,nodeOrigin:Be,nodeExtent:Te,rfId:He})=>{const at=Ib(e,cD),Re=Ib(t,gD);return ID(s),V.createElement(aD,{onPaneClick:ie,onPaneMouseEnter:le,onPaneMouseMove:J,onPaneMouseLeave:_e,onPaneContextMenu:ve,onPaneScroll:G,deleteKeyCode:T,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,onSelectionStart:g,onSelectionEnd:w,multiSelectionKeyCode:E,panActivationKeyCode:S,zoomActivationKeyCode:R,elementsSelectable:z,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:I,zoomOnPinch:q,zoomOnDoubleClick:B,panOnScroll:W,panOnScrollSpeed:U,panOnScrollMode:Z,panOnDrag:ne,defaultViewport:L,translateExtent:P,minZoom:$,maxZoom:O,onSelectionContextMenu:x,preventScrolling:A,noDragClassName:xe,noWheelClassName:te,noPanClassName:he,disableKeyboardA11y:ze},V.createElement(AD,null,V.createElement(TD,{edgeTypes:Re,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:M,onEdgeContextMenu:fe,onEdgeMouseEnter:se,onEdgeMouseMove:ge,onEdgeMouseLeave:Y,onReconnect:Q,onReconnectStart:pe,onReconnectEnd:ye,reconnectRadius:we,defaultMarkerColor:F,noPanClassName:he,elevateEdgesOnSelect:!!Ge,disableKeyboardA11y:ze,rfId:He},V.createElement(OD,{style:y,type:v,component:b,containerStyle:_})),V.createElement("div",{className:"react-flow__edgelabel-renderer"}),V.createElement(fD,{nodeTypes:at,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:C,onlyRenderVisibleElements:M,noPanClassName:he,noDragClassName:xe,disableKeyboardA11y:ze,nodeOrigin:Be,nodeExtent:Te,rfId:He})))};dE.displayName="GraphView";var DD=m.memo(dE);const Ev=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wr={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Ev,nodeExtent:Ev,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ni.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:uO,isValidConnection:void 0},LD=()=>kI((e,t)=>({...wr,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:id(n,r,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?id(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=n.reduce((g,w)=>{const v=i.get(w.id);if(v!=null&&v.hidden)i.set(v.id,{...v,[nt]:{...v[nt],handleBounds:void 0}});else if(v){const y=Hx(w.nodeElement);!!(y.width&&y.height&&(v.width!==y.width||v.height!==y.height||w.forceUpdate))&&(i.set(v.id,{...v,[nt]:{...v[nt],handleBounds:{source:kb(".source",w.nodeElement,p,d),target:kb(".target",w.nodeElement,p,d)}},...y}),g.push({id:v.id,type:"dimensions",dimensions:y}))}return g},[]);QC(i,d);const x=o||s&&!o&&ZC(t,{initial:!0,...l});e({nodeInternals:new Map(i),fitViewOnInitDone:x}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=n.map(l=>{const c={id:l.id,type:"position",dragging:i};return r&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:l,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(s){const d=eE(n,l()),u=id(d,i,o,c);e({nodeInternals:u})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,l=null;r?o=n.map(c=>Nr(c,!0)):(o=ns(s(),n),l=ns(i,[])),Za({changedNodes:o,changedEdges:l,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,l=null;r?o=n.map(c=>Nr(c,!0)):(o=ns(i,n),l=ns(s(),[])),Za({changedNodes:l,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=t(),o=n||s(),l=r||i,c=o.map(u=>(u.selected=!1,Nr(u.id,!1))),d=l.map(u=>Nr(u.id,!1));Za({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=t();r==null||r.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=t();r==null||r.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),s=r().filter(l=>l.selected).map(l=>Nr(l.id,!1)),o=n.filter(l=>l.selected).map(l=>Nr(l.id,!1));Za({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(i=>{i.positionAbsolute=Wx(i.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:l,translateExtent:c}=t();if(!o||!l||!n.x&&!n.y)return!1;const d=lr.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),u=[[0,0],[i,s]],f=o==null?void 0:o.constrain()(d,u,c);return o.transform(l,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wr.connectionNodeId,connectionHandleId:wr.connectionHandleId,connectionHandleType:wr.connectionHandleType,connectionStatus:wr.connectionStatus,connectionStartHandle:wr.connectionStartHandle,connectionEndHandle:wr.connectionEndHandle}),reset:()=>e({...wr})}),Object.is),Qc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=LD()),V.createElement(rO,{value:t.current},e)};Qc.displayName="ReactFlowProvider";const fE=({children:e})=>m.useContext(Gc)?V.createElement(V.Fragment,null,e):V.createElement(Qc,null,e);fE.displayName="ReactFlowWrapper";const FD={input:WC,default:Nv,output:VC,group:Xx},zD={default:cc,straight:Gx,step:Vx,smoothstep:Kc,simplebezier:Ux},qD=[0,0],$D=[15,15],BD={x:0,y:0,zoom:1},HD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Zx=m.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=FD,edgeTypes:o=zD,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:x,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:S,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:M,onSelectionDragStart:z,onSelectionDrag:C,onSelectionDragStop:L,onSelectionContextMenu:P,onSelectionStart:$,onSelectionEnd:O,connectionMode:A=Ni.Strict,connectionLineType:F=Rr.Bezier,connectionLineStyle:I,connectionLineComponent:q,connectionLineContainerStyle:W,deleteKeyCode:U="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:B=!1,selectionMode:ne=ta.Full,panActivationKeyCode:ie="Space",multiSelectionKeyCode:le=ac()?"Meta":"Control",zoomActivationKeyCode:J=ac()?"Meta":"Control",snapToGrid:_e=!1,snapGrid:G=$D,onlyRenderVisibleElements:ve=!1,selectNodesOnDrag:fe=!0,nodesDraggable:se,nodesConnectable:ge,nodesFocusable:Y,nodeOrigin:Q=qD,edgesFocusable:pe,edgesUpdatable:ye,elementsSelectable:we,defaultViewport:xe=BD,minZoom:te=.5,maxZoom:he=2,translateExtent:Ge=Ev,preventScrolling:ze=!0,nodeExtent:Be,defaultMarkerColor:Te="#b1b1b7",zoomOnScroll:He=!0,zoomOnPinch:at=!0,panOnScroll:Re=!1,panOnScrollSpeed:X=.5,panOnScrollMode:Oe=pi.Free,zoomOnDoubleClick:me=!0,panOnDrag:kt=!0,onPaneClick:xt,onPaneMouseEnter:yt,onPaneMouseMove:Xt,onPaneMouseLeave:D,onPaneScroll:H,onPaneContextMenu:K,children:re,onEdgeContextMenu:De,onEdgeDoubleClick:lt,onEdgeMouseEnter:an,onEdgeMouseMove:Nt,onEdgeMouseLeave:bt,onEdgeUpdate:ue,onEdgeUpdateStart:ce,onEdgeUpdateEnd:Ae,onReconnect:zt,onReconnectStart:ln,onReconnectEnd:wn,reconnectRadius:ti=10,edgeUpdaterRadius:ni=10,onNodesChange:Dn,onEdgesChange:ri,noDragClassName:qs="nodrag",noWheelClassName:dR="nowheel",noPanClassName:Iy="nopan",fitView:fR=!1,fitViewOptions:pR,connectOnClick:hR=!0,attributionPosition:mR,proOptions:gR,defaultEdgeOptions:vR,elevateNodesOnSelect:xR=!0,elevateEdgesOnSelect:yR=!1,disableKeyboardA11y:My=!1,autoPanOnConnect:bR=!0,autoPanOnNodeDrag:wR=!0,connectionRadius:_R=20,isValidConnection:jR,onError:SR,style:kR,id:Py,nodeDragThreshold:NR,...CR},ER)=>{const ku=Py||"1";return V.createElement("div",{...CR,style:{...kR,...HD},ref:ER,className:Kt(["react-flow",i]),"data-testid":"rf__wrapper",id:Py},V.createElement(fE,null,V.createElement(DD,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:k,nodeTypes:s,edgeTypes:o,connectionLineType:F,connectionLineStyle:I,connectionLineComponent:q,connectionLineContainerStyle:W,selectionKeyCode:Z,selectionOnDrag:B,selectionMode:ne,deleteKeyCode:U,multiSelectionKeyCode:le,panActivationKeyCode:ie,zoomActivationKeyCode:J,onlyRenderVisibleElements:ve,selectNodesOnDrag:fe,defaultViewport:xe,translateExtent:Ge,minZoom:te,maxZoom:he,preventScrolling:ze,zoomOnScroll:He,zoomOnPinch:at,zoomOnDoubleClick:me,panOnScroll:Re,panOnScrollSpeed:X,panOnScrollMode:Oe,panOnDrag:kt,onPaneClick:xt,onPaneMouseEnter:yt,onPaneMouseMove:Xt,onPaneMouseLeave:D,onPaneScroll:H,onPaneContextMenu:K,onSelectionContextMenu:P,onSelectionStart:$,onSelectionEnd:O,onEdgeContextMenu:De,onEdgeDoubleClick:lt,onEdgeMouseEnter:an,onEdgeMouseMove:Nt,onEdgeMouseLeave:bt,onReconnect:zt??ue,onReconnectStart:ln??ce,onReconnectEnd:wn??Ae,reconnectRadius:ti??ni,defaultMarkerColor:Te,noDragClassName:qs,noWheelClassName:dR,noPanClassName:Iy,elevateEdgesOnSelect:yR,rfId:ku,disableKeyboardA11y:My,nodeOrigin:Q,nodeExtent:Be}),V.createElement(MO,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:x,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,nodesDraggable:se,nodesConnectable:ge,nodesFocusable:Y,edgesFocusable:pe,edgesUpdatable:ye,elementsSelectable:we,elevateNodesOnSelect:xR,minZoom:te,maxZoom:he,nodeExtent:Be,onNodesChange:Dn,onEdgesChange:ri,snapToGrid:_e,snapGrid:G,connectionMode:A,translateExtent:Ge,connectOnClick:hR,defaultEdgeOptions:vR,fitView:fR,fitViewOptions:pR,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:S,onSelectionDrag:C,onSelectionDragStart:z,onSelectionDragStop:L,noPanClassName:Iy,nodeOrigin:Q,rfId:ku,autoPanOnConnect:bR,autoPanOnNodeDrag:wR,onError:SR,connectionRadius:_R,isValidConnection:jR,nodeDragThreshold:NR}),V.createElement(AO,{onSelectionChange:M}),re,V.createElement(sO,{proOptions:gR,position:mR}),V.createElement(FO,{rfId:ku,disableKeyboardA11y:My})))});Zx.displayName="ReactFlow";function pE(e){return t=>{const[n,r]=m.useState(t),i=m.useCallback(s=>r(o=>e(s,o)),[]);return[n,r,i]}}const hE=pE(eE),mE=pE(ZO),gE=({id:e,x:t,y:n,width:r,height:i,style:s,color:o,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:x,backgroundColor:g}=s||{},w=o||x||g;return V.createElement("rect",{className:Kt(["react-flow__minimap-node",{selected:h},d]),x:t,y:n,rx:u,ry:u,width:r,height:i,fill:w,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?v=>p(v,e):void 0})};gE.displayName="MiniMapNode";var WD=m.memo(gE);const UD=e=>e.nodeOrigin,VD=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),ld=e=>e instanceof Function?e:()=>e;function GD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:s=WD,onClick:o}){const l=Xe(VD,It),c=Xe(UD),d=ld(t),u=ld(e),f=ld(n),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return V.createElement(V.Fragment,null,l.map(h=>{const{x,y:g}=xi(h,c).positionAbsolute;return V.createElement(s,{key:h.id,x,y:g,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:r,strokeColor:u(h),strokeWidth:i,shapeRendering:p,onClick:o,id:h.id})}))}var KD=m.memo(GD);const YD=200,XD=150,QD=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?lO(Yc(t,e.nodeOrigin),n):n,rfId:e.rfId}},ZD="react-flow__minimap-desc";function vE({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:x=!1,zoomable:g=!1,ariaLabel:w="React Flow mini map",inversePan:v=!1,zoomStep:y=10,offsetScale:b=5}){const _=vt(),j=m.useRef(null),{boundingRect:k,viewBB:N,rfId:E}=Xe(QD,It),S=(e==null?void 0:e.width)??YD,R=(e==null?void 0:e.height)??XD,T=k.width/S,M=k.height/R,z=Math.max(T,M),C=z*S,L=z*R,P=b*z,$=k.x-(C-k.width)/2-P,O=k.y-(L-k.height)/2-P,A=C+P*2,F=L+P*2,I=`${ZD}-${E}`,q=m.useRef(0);q.current=z,m.useEffect(()=>{if(j.current){const Z=pn(j.current),B=le=>{const{transform:J,d3Selection:_e,d3Zoom:G}=_.getState();if(le.sourceEvent.type!=="wheel"||!_e||!G)return;const ve=-le.sourceEvent.deltaY*(le.sourceEvent.deltaMode===1?.05:le.sourceEvent.deltaMode?1:.002)*y,fe=J[2]*Math.pow(2,ve);G.scaleTo(_e,fe)},ne=le=>{const{transform:J,d3Selection:_e,d3Zoom:G,translateExtent:ve,width:fe,height:se}=_.getState();if(le.sourceEvent.type!=="mousemove"||!_e||!G)return;const ge=q.current*Math.max(1,J[2])*(v?-1:1),Y={x:J[0]-le.sourceEvent.movementX*ge,y:J[1]-le.sourceEvent.movementY*ge},Q=[[0,0],[fe,se]],pe=lr.translate(Y.x,Y.y).scale(J[2]),ye=G.constrain()(pe,Q,ve);G.transform(_e,ye)},ie=_C().on("zoom",x?ne:null).on("zoom.wheel",g?B:null);return Z.call(ie),()=>{Z.on("zoom",null)}}},[x,g,v,y]);const W=p?Z=>{const B=Nn(Z);p(Z,{x:B[0],y:B[1]})}:void 0,U=h?(Z,B)=>{const ne=_.getState().nodeInternals.get(B);h(Z,ne)}:void 0;return V.createElement(Hr,{position:f,style:e,className:Kt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},V.createElement("svg",{width:S,height:R,viewBox:`${$} ${O} ${A} ${F}`,role:"img","aria-labelledby":I,ref:j,onClick:W},w&&V.createElement("title",{id:I},w),V.createElement(KD,{onClick:U,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:l}),V.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-P},${O-P}h${A+P*2}v${F+P*2}h${-A-P*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}vE.displayName="MiniMap";var xE=m.memo(vE);const el={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},JD=180,e6=400,t6=260,n6=48;function r6(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function i6({projects:e,selectedId:t,onSelectProject:n,onNewProject:r,showArchived:i,onToggleShowArchived:s,userSection:o}){const[l,c]=m.useState(!1),[d,u]=m.useState(t6),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null);m.useEffect(()=>{x.current&&x.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((j,k)=>{const N=(j.name||"").localeCompare(k.name||"");return N!==0?N:(j.projectId||"").localeCompare(k.projectId||"")}),[e]),w=()=>{r()},v=m.useCallback(j=>{j.preventDefault(),p(!0)},[]),y=m.useCallback(j=>{if(!f)return;const k=Math.min(e6,Math.max(JD,j.clientX));u(k)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const _=l?n6:d;return a.jsxs("div",{ref:h,className:"h-full flex flex-col relative",style:{width:_,minWidth:_,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[a.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),a.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:i?"#f59e0b":"var(--text-muted)"},title:i?"Hide archived":"Show archived",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),a.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:a.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(j=>{const k=t===j.id;return a.jsxs("div",{ref:k?x:null,onClick:()=>n(j.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:k?"var(--state-active-bg)":"transparent",border:k?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:k?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:k?"#ffffff":el[j.status]||el.queued}}),a.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:k?"#ffffff":"var(--text-primary)"},children:j.name}),j.isArchived&&a.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:k?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[a.jsx("span",{className:"text-[10px] font-mono",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:j.projectId}),a.jsx("span",{className:"text-[10px]",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:r6(j.createdAt)})]})]},j.id)})}),l&&a.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(j=>a.jsx("div",{onClick:()=>n(j.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:j.name,children:a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:el[j.status]||el.queued,boxShadow:t===j.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},j.id))}),!l&&a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:w,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),a.jsx("span",{children:"New Project"})]})}),l&&a.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:w,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),o,!l&&a.jsx("div",{onMouseDown:v,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function s6({stations:e}){return e!=null&&e.length?a.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,n)=>{const r=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",i=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",s=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return a.jsxs(V.Fragment,{children:[n>0&&a.jsx("div",{className:"w-4 h-0.5",style:{background:i}}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:r}}),a.jsx("span",{className:"text-[7px] mt-0.5",style:{color:s,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const Mb={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},yE=(e,t)=>{var n;return((n=Mb[t])==null?void 0:n[e])||Mb.industrial.queued},jn={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},Eo={GAP:8,WIDTH:280},cd=["pgc","asm","draft","qa","done"],Ar=["industrial","light","blueprint"];function o6({questions:e,nodeWidth:t,onSubmit:n,onClose:r,onZoomComplete:i}){const[s,o]=m.useState({}),l=e.filter(c=>c.required).every(c=>s[c.id]);return m.useEffect(()=>{if(i){const c=setTimeout(()=>i(),150);return()=>clearTimeout(c)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+Eo.GAP,width:Eo.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:Eo.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),a.jsx("button",{onClick:r,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&a.jsx("span",{className:"text-amber-600",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:s[c.id]||"",onChange:d=>o(u=>({...u,[c.id]:d.target.value}))})]},c.id))}),a.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:a.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${l?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!l,onClick:()=>n(s),children:"Submit & Continue"})})]})}function a6({features:e,epicName:t,nodeWidth:n,onClose:r,onZoomComplete:i}){const s=e.length>6,o=s?240:320;return m.useEffect(()=>{if(i){const l=setTimeout(()=>i(),150);return()=>clearTimeout(l)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:n+Eo.GAP,width:o,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:Eo.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),a.jsx("button",{onClick:r,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${s?"":"grid grid-cols-2 gap-2"}`,children:e.map(l=>{const c=l.state==="complete"?"var(--state-stabilized-bg)":l.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return a.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${s?"mb-1":""}`,children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),a.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:l.name})]},l.id)})}),a.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const Jx="/api/v1";class l6 extends Error{constructor(t,n,r){super(t),this.name="ApiError",this.status=n,this.data=r}}function c6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function qe(e,t={}){const n=`${Jx}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},i=await fetch(n,r);if(!i.ok){const s=await i.json().catch(()=>({}));throw new l6(s.detail||`Request failed: ${i.status}`,i.status,s)}return i.status===204?null:i.json()}const Ye={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":c6()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const n=t.toString();return qe(`/projects${n?"?"+n:""}`)},getProject:e=>qe(`/projects/${e}`),getProjectTree:e=>qe(`/projects/${e}/tree`),createProject:e=>qe("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>qe(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>qe(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>qe(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>qe(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>qe(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const n=new URLSearchParams({project_id:e});return t&&n.set("document_type",t),qe(`/production/start?${n}`,{method:"POST"})},getProjectInterrupts:e=>qe(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>qe(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,n=null)=>qe("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:n})}),submitWorkflowInput:(e,t,n=null)=>qe(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:n})}),getExecutionStatus:e=>qe(`/document-workflows/executions/${e}`),getPgcAnswers:e=>qe(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>qe(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>qe(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>qe("/intake/start",{method:"POST"}),getIntakeState:e=>qe(`/intake/${e}`),submitIntakeMessage:(e,t)=>qe(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,n)=>qe(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:n})}),initializeIntake:e=>qe(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>qe(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,n)=>qe(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:n})}),updateWorkflowInstance:(e,t)=>qe(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>qe(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,n=0)=>qe(`/projects/${e}/workflow/history?limit=${t}&offset=${n}`),completeWorkflowInstance:e=>qe(`/projects/${e}/workflow/complete`,{method:"POST"})};function u6(e){const t=`${Jx}/production/events?project_id=${e}`;return new EventSource(t)}function d6(e){const t=`${Jx}/intake/${e}/events`;return new EventSource(t)}function f6(e){return`/auth/login/${e}`}function p6({block:e}){const{data:t}=e,n=t.content||t.value||"";return n?a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:n}),t.detail_ref&&a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Pb({block:e}){const{data:t}=e,n=t.items||[],r=t.style||"bullet";if(n.length===0)return null;const i=r==="numbered"?"decimal":"disc";return a.jsxs("div",{style:{marginBottom:12},children:[t.title&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),a.jsx("ul",{style:{margin:0,paddingLeft:r==="check"?0:20,listStyle:r==="check"?"none":i},children:n.map((s,o)=>a.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:r==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[r==="check"&&a.jsx("span",{style:{color:"#10b981"},children:""}),typeof s=="string"?s:(s==null?void 0:s.value)||(s==null?void 0:s.text)||(s==null?void 0:s.question)||(s==null?void 0:s.description)||JSON.stringify(s)]},o))})]})}function h6({block:e}){const{data:t}=e,n=t.value||"unknown",r=t.label,s={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[n.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[r&&a.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[r,":"]}),a.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:s.bg,color:s.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:n})]})}function bE({block:e}){const{data:t}=e,{id:n,text:r,blocking:i,why_it_matters:s,priority:o,tags:l,options:c}=t,d={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},u=d[o]||d.should;return a.jsx("div",{style:{padding:"12px 16px",background:i?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${i?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:n}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:r}),s&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:s}),a.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[i&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),o&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:u.bg,color:u.text,textTransform:"uppercase"},children:o}),l==null?void 0:l.map((f,p)=>a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},p))]}),c&&c.length>0&&a.jsxs("div",{style:{marginTop:8},children:[a.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,p)=>a.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:p>0?8:4},children:f},p))]})]})]})})}function m6({block:e}){const{data:t}=e,n=t.items||[],r=t.total_count||n.length,i=t.blocking_count||n.filter(s=>s.blocking).length;return n.length===0?a.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{style:{color:"#374151"},children:r})," questions"]}),i>0&&a.jsxs("span",{style:{color:"#dc2626"},children:[a.jsx("strong",{children:i})," blocking"]})]}),n.map((s,o)=>a.jsx(bE,{block:{type:"schema:OpenQuestionV1",data:s}},s.id||o))]})}function Ob({block:e}){const{data:t}=e,n=t.items||[],r=t.title;if(n.length===0)return null;const i={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:r}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((s,o)=>{const l=s.severity||s.likelihood||"medium",c=i[l]||i.medium;return a.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[s.id&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:s.id}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:s.description||s.reason||JSON.stringify(s)}),s.impact&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",s.impact]}),s.mitigation&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",s.mitigation]})]}),a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},s.id||o)})})]})}function g6({block:e}){const{data:t}=e,r=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([i])=>t[i]&&typeof t[i]=="string").map(([i,s])=>({title:s,content:t[i]}));return r.length===0?null:a.jsx("div",{style:{marginBottom:12},children:r.map((i,s)=>a.jsxs("div",{style:{marginBottom:s<r.length-1?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:i.title}),a.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:i.content})})]},s))})}function Db({block:e}){const{data:t}=e,{epic_id:n,title:r,name:i,intent:s,phase:o,mvp_phase:l,risk_level:c,stories:d,detail_ref:u}=t,f=o||l,p=r||i,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},x=h[c]||h.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},w=g[f]||g.mvp;return a.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[n&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:n}),a.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),s&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s}),d&&d.length>0&&a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[d.length," stories"]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:w.bg,color:w.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&a.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:x.bg,color:x.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),u&&a.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function v6({block:e}){const{data:t}=e,{story_id:n,title:r,intent:i,phase:s,risk_level:o,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[o]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[s]||u.mvp;return a.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[n&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:n}),a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:r})]}),i&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:i})]}),a.jsxs("div",{style:{display:"flex",gap:4},children:[s&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:s}),d&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:o})]})]})})}function x6({block:e}){const{type:t,data:n}=e;return a.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[a.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),a.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(n,null,2)})]})}function y6({block:e}){const{data:t}=e,n=t.items||[],[r,i]=m.useState({});if(n.length===0)return null;const s=o=>{i(l=>({...l,[o]:!l[o]}))};return a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((o,l)=>{const c=r[l],d=o.why_it_matters||o.impact_if_unresolved;return a.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[a.jsxs("button",{onClick:()=>d&&s(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:o.question||o.value||o.text||"Unknown"}),d&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:a.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&a.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[o.why_it_matters&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.why_it_matters})]}),o.impact_if_unresolved&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.impact_if_unresolved})]})]})]},l)})})}function b6({block:e}){const{data:t}=e,{description:n,user_statement:r}=t;return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:n}),r&&a.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',r,'"']})]})}function w6({block:e}){const{data:t}=e,{category:n,confidence:r,rationale:i}=t;return a.jsxs("div",{style:{marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:n}),r&&a.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",r]})]}),i&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i})]})}function _6({block:e}){const{data:t}=e,{explicit:n=[],inferred:r=[]}=t,i=n&&n.length>0,s=r&&r.length>0;return!i&&!s?null:a.jsxs("div",{style:{marginBottom:12},children:[i&&a.jsxs("div",{style:{marginBottom:s?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:o})]},l))})]}),s&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:o})]},l))})]})]})}function j6({block:e}){const{data:t}=e,{questions:n=[],missing_context:r=[],assumptions_made:i=[]}=t,s=n&&n.length>0,o=r&&r.length>0,l=i&&i.length>0;return!s&&!o&&!l?null:a.jsxs("div",{style:{marginBottom:12},children:[s&&a.jsxs("div",{style:{marginBottom:o||l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:c})]},d))})]}),o&&a.jsxs("div",{style:{marginBottom:l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:c})]},d))})]}),l&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:i.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#6b7280"},children:""}),a.jsx("span",{children:c})]},d))})]})]})}function S6({block:e}){const{data:t}=e,{status:n,rationale:r,next_action:i}=t,o={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[n]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("div",{style:{marginBottom:12},children:a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:o.bg,color:o.text},children:n})}),r&&a.jsx("p",{style:{margin:0,marginBottom:i?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:r}),i&&a.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:a.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",i]})})]})}const k6={"schema:ParagraphBlockV1":p6,"schema:StringListBlockV1":Pb,"schema:IndicatorBlockV1":h6,"schema:OpenQuestionV1":bE,"schema:OpenQuestionsBlockV1":m6,"schema:RisksBlockV1":Ob,"schema:DependenciesBlockV1":Ob,"schema:SummaryBlockV1":g6,"schema:EpicSummaryBlockV1":Db,"schema:StorySummaryBlockV1":v6,"schema:EpicStoriesCardBlockV1":Db,"schema:StoriesBlockV1":Pb,"schema:UnknownsBlockV1":y6,"schema:IntakeSummaryBlockV1":b6,"schema:IntakeProjectTypeBlockV1":w6,"schema:IntakeConstraintsBlockV1":_6,"schema:IntakeOpenGapsBlockV1":j6,"schema:IntakeOutcomeBlockV1":S6};function N6(e){return k6[e]||x6}function C6(e,t){const n=N6(e.type);return a.jsx(n,{block:e},e.key||t)}function wE({renderModel:e,variant:t="full",hideHeader:n=!1,onSectionClick:r,className:i=""}){var w;const[s,o]=m.useState(new Set(((w=e==null?void 0:e.sections)==null?void 0:w.map(v=>v.section_id))||[]));if(!e)return a.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return a.jsx(T6,{title:l,content:e.raw_content,reason:u.reason});const f=v=>{o(y=>{const b=new Set(y);return b.has(v)?b.delete(v):b.add(v),b})},p=t==="compact"||t==="sidecar",x=t==="sidecar"?d.filter(v=>v.viewer_tab==="overview"||!v.viewer_tab):d,g=(()=>{if(!l)return"Document";const v=l.indexOf(": ");return v>-1?l.slice(v+2):l})();return a.jsxs("div",{className:i,children:[t==="full"&&!n&&a.jsxs("div",{style:{marginBottom:24},children:[a.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&a.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:x.map(v=>a.jsx(E6,{section:v,isExpanded:s.has(v.section_id),onToggle:()=>f(v.section_id),onClick:()=>r==null?void 0:r(v),variant:t},v.section_id))}),x.length===0&&a.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function E6({section:e,isExpanded:t,onToggle:n,onClick:r,variant:i}){const{section_id:s,title:o,description:l,blocks:c=[],sidecar_max_items:d}=e,u=i==="compact"||i==="sidecar",f=i==="sidecar";if(c.length===0)return null;const p=f&&d&&c.length>d?c.slice(0,d):c,h=f&&d&&c.length>d;return a.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[a.jsxs("button",{onClick:n,style:{width:"100%",padding:u?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,fontSize:u?13:15,fontWeight:600,color:"#111827"},children:[o,h&&a.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",d," of ",c.length,")"]})]}),l&&!u&&a.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:l})]}),a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:a.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&a.jsxs("div",{style:{padding:u?12:18},children:[p.map((x,g)=>C6(x,g)),h&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-d," more in full view"]})]})]})}function T6({title:e,content:t,reason:n}){return a.jsxs("div",{children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",n||"unknown",")"]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function R6({renderModel:e,projectCode:t,documentName:n,isExpanded:r,onToggleExpand:i,onClose:s,onViewFull:o,nodeWidth:l=280}){const p=r?900:520,h=r?900:600,x=`${t||"DOC"} - ${n||"Document"}`,g=w=>{w.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:l+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const w=(e==null?void 0:e.title)||"DOCUMENT",v=w.indexOf(": ");return(v>-1?w.slice(v+2):w).toUpperCase()})()}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:i,title:r?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:r?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:s,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:r?600:400},children:a.jsx(wE,{renderModel:e,variant:"sidecar"})}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:o,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function A6({document:e,projectId:t,projectCode:n,nodeWidth:r,onClose:i,onZoomComplete:s,onViewFull:o}){const[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!0),[h,x]=m.useState(!1);return m.useEffect(()=>{if(s){const g=setTimeout(()=>s(),150);return()=>clearTimeout(g)}},[s]),m.useEffect(()=>{async function g(){var w;if(!t||!e.id){p(!1);return}try{p(!0);try{const y=await Ye.getDocumentRenderModel(t,e.id);if(y&&y.sections&&y.sections.length>0){c(y),u(null);return}if((w=y==null?void 0:y.metadata)!=null&&w.fallback&&y.raw_content){c(null),u(y.raw_content);return}}catch(y){console.log("RenderModel not available, falling back to raw document:",y.message)}const v=await Ye.getDocument(t,e.id);c(null),u((v==null?void 0:v.content)||null)}catch(v){console.error("Failed to fetch document for sidecar:",v)}finally{p(!1)}}g()},[t,e.id]),f?null:l?a.jsx(R6,{renderModel:l,projectCode:n,documentName:e.name,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id),nodeWidth:r}):a.jsx(I6,{document:e,projectCode:n,rawContent:d,nodeWidth:r,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id)})}function I6({document:e,projectCode:t,rawContent:n,nodeWidth:r,isExpanded:i,onToggleExpand:s,onClose:o,onViewFull:l}){var w;const p=i?900:520,h=i?900:600,x=`${t||"DOC"} - ${e.name||"Document"}`,g=v=>{v.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:r+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((w=e.name)==null?void 0:w.toUpperCase())||"DOCUMENT"}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:s,title:i?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:i?600:400},children:[a.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(n,null,2)})})]}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:l,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const M6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function P6({data:e}){var _,j,k;const n=(e.level||1)===1,r=e.isExpanded,i=e.expandType,s=((_=e.questions)==null?void 0:_.length)>0,o=((j=e.features)==null?void 0:j.length)>0,l=(k=e.stations)==null?void 0:k.some(N=>N.needs_input),c=e.state||"ready_for_production",d=["produced","stabilized","ready"].includes(c),u=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),p=u&&e.stations,h=u?"node-active":"",x=n?"DOCUMENT":"EPIC",g=n?"subway-node-header-doc":"subway-node-header-epic",w=d?"var(--state-produced-bg, var(--state-stabilized-bg))":u?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",v=d?"var(--state-produced-text, var(--state-stabilized-text))":u?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",y=u?"var(--state-in-production-bg, var(--state-active-bg))":d?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=M6[c]||c;return a.jsxs("div",{className:"relative",children:[a.jsx(Vn,{type:"target",position:ae.Top,className:"!opacity-0",style:{left:"15%"}}),a.jsxs("div",{className:`subway-node rounded-lg border ${h} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:y},children:[a.jsxs("div",{className:`${g} border-b px-3 py-1.5 flex items-center justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:n?"var(--header-text-doc)":"var(--header-text-epic)"},children:x}),a.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&a.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:n?24:18,height:n?24:18,backgroundColor:w}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:v},children:b}),n&&e.desc&&a.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),p&&a.jsx(s6,{stations:e.stations}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[n&&d&&a.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"document")},children:"View Document"}),l&&s&&!r&&a.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"questions")},children:"Answer Questions"}),!n&&o&&(r&&i==="features"?a.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):a.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"features")},children:[a.jsx("span",{className:"text-indigo-400",children:e.features.length}),a.jsx("span",{children:"features"}),a.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),r&&i==="questions"&&s&&a.jsx(o6,{questions:e.questions,nodeWidth:e.width,onSubmit:N=>{var E;return(E=e.onSubmitQuestions)==null?void 0:E.call(e,e.id,N)},onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),r&&i==="features"&&o&&a.jsx(a6,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),r&&i==="document"&&n&&d&&a.jsx(A6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)},onViewFull:N=>{var E;return(E=e.onViewFullDocument)==null?void 0:E.call(e,N)}}),a.jsx(Vn,{type:"source",position:ae.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function O6(){return a.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[a.jsx(Vn,{type:"target",position:ae.Top,style:{opacity:0}}),a.jsx(Vn,{type:"source",position:ae.Bottom,style:{opacity:0}})]})}function D6({projectId:e,projectCode:t,docTypeId:n,onClose:r}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null);return m.useEffect(()=>{async function p(){var h;try{d(!0),f(null);try{const g=await Ye.getDocumentRenderModel(e,n);if(g&&g.sections&&g.sections.length>0){s(g),l(null);return}if((h=g==null?void 0:g.metadata)!=null&&h.fallback&&g.raw_content){s(null),l(g.raw_content);return}}catch(g){console.log("RenderModel not available, falling back to raw document:",g.message)}const x=await Ye.getDocument(e,n);s(null),l((x==null?void 0:x.content)||null)}catch(x){f(x.message),console.error("Failed to fetch document:",x)}finally{d(!1)}}p()},[e,n]),m.useEffect(()=>{const p=h=>{h.key==="Escape"&&r()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[r]),c?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:a.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:p=>p.target===p.currentTarget&&r(),children:a.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[a.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsx("div",{children:t&&a.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),a.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-red-500",children:u})}),i&&a.jsx(wE,{renderModel:i,variant:"full"}),o&&!i&&a.jsx(L6,{content:o,docTypeId:n}),!i&&!o&&!u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function L6({content:e,docTypeId:t}){if(!e)return a.jsx("p",{className:"text-gray-500",children:"No content available"});const n=e.project_name||e.title||e.name,r=e.description||e.summary||e.preliminary_summary;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",a.jsx("strong",{children:t})," - displaying raw content"]}),(n||r)&&a.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[n&&a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n}),r&&a.jsx("p",{className:"text-gray-700 text-sm",children:r})]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const F6="/api/v1/admin";class z6 extends Error{constructor(t,n,r){super(t),this.name="AdminApiError",this.status=n,this.data=r,this.errorCode=r==null?void 0:r.error_code}}function q6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ne(e,t={}){var s;const n=`${F6}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const o=q6();o&&(r.headers["X-CSRF-Token"]=o)}const i=await fetch(n,r);if(!i.ok){const o=await i.json().catch(()=>({})),l=((s=o.detail)==null?void 0:s.message)||o.detail||`Request failed: ${i.status}`;throw new z6(l,i.status,o.detail||o)}return i.status===204?null:i.json()}const je={getCurrentWorkspace:async()=>{try{return await Ne("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ne("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ne(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ne(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,n)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:n})}),getPreview:(e,t,n="execution")=>Ne(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${n}`),getDiff:(e,t=null)=>{const n=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ne(`/workspaces/${e}/diff${n}`)},commit:(e,t)=>Ne(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ne(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ne("/workbench/document-types"),getDocumentType:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/document-types/${e}${n}`)},getDocumentTypeVersions:e=>Ne(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ne("/workbench/prompt-fragments"),getRoles:()=>Ne("/workbench/roles"),getTemplates:()=>Ne("/workbench/templates"),getSchemas:()=>Ne("/workbench/schemas"),getSchema:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/schemas/${e}${n}`)},getRole:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/roles/${e}${n}`)},getTemplate:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/templates/${e}${n}`)},getWorkflows:()=>Ne("/workbench/workflows"),getOrchestrationWorkflows:()=>Ne("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/workflows/${e}${n}`)},createOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ne(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ne(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ne(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ne(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ne("/workbench/active-releases"),invalidateCache:()=>Ne("/workbench/cache/invalidate",{method:"POST"}),getMechanicalOpTypes:()=>Ne("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Ne(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Ne("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Ne("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/mechanical-ops/${e}${n}`)}};function $6({projectId:e}){const[t,n]=m.useState(null),[r,i]=m.useState(!0),[s,o]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,x]=m.useState(!1),[g,w]=m.useState(null),[v,y]=m.useState(!1),[b,_]=m.useState(!1),j=m.useCallback(async()=>{if(e){i(!0),o(null);try{const M=await Ye.getWorkflowInstance(e);n(M)}catch(M){M.status===404?n(null):o(M.message)}finally{i(!1)}}},[e]);m.useEffect(()=>{j()},[j]);const k=async()=>{c(!0),p(!0);try{const M=await je.getOrchestrationWorkflows();u(M.workflows||[])}catch{u([])}finally{p(!1)}},N=async M=>{x(!0);try{const z=await Ye.createWorkflowInstance(e,M.workflow_id,M.active_version);n(z),c(!1)}catch(z){o(z.message)}finally{x(!1)}},E=async()=>{if(t&&(_(!b),!g)){y(!0);try{const M=await Ye.getWorkflowDrift(e);w(M)}catch(M){w({error:M.message})}finally{y(!1)}}};if(r)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(s&&!t)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:s});if(!t)return a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?a.jsx(B6,{workflows:d,loading:f,assigning:h,onSelect:N,onCancel:()=>c(!1)}):a.jsx("button",{onClick:k,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const S=t.effective_workflow||{},R=S.steps||[],T=t.base_workflow_ref||{};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:S.name||T.workflow_id||"Workflow"}),a.jsx(H6,{status:t.status})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",T.workflow_id," v",T.version,T.pow_class?` (${T.pow_class})`:""]})]}),a.jsx("button",{onClick:E,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:v?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&a.jsx(W6,{drift:g}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",R.length,")"]}),R.length===0?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):a.jsx("div",{className:"space-y-1",children:R.map((M,z)=>a.jsx(U6,{step:M,index:z},M.step_id||z))})]}),s&&a.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:s})]})}function B6({workflows:e,loading:t,assigning:n,onSelect:r,onCancel:i}){const s=e.filter(l=>(l.pow_class||"reference")==="reference"),o=e.filter(l=>l.pow_class==="template");return a.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs(a.Fragment,{children:[s.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),s.map(l=>a.jsxs("button",{onClick:()=>r(l),disabled:n,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:n?"default":"pointer",opacity:n?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),o.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),o.map(l=>a.jsxs("button",{onClick:()=>r(l),disabled:n,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:n?"default":"pointer",opacity:n?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),s.length===0&&o.length===0&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),a.jsx("button",{onClick:i,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function H6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},n=t[e]||t.active;return a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:n.bg,color:n.color},children:e})}function W6({drift:e}){return e.error?a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):a.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[a.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[a.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),a.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&a.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&a.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&a.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&a.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&a.jsx("div",{children:"~ Metadata changed"})]})]})}function U6({step:e,index:t}){return a.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&a.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&a.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function ey(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ud,Lb;function V6(){if(Lb)return ud;Lb=1;function e(){this.__data__=[],this.size=0}return ud=e,ud}var dd,Fb;function As(){if(Fb)return dd;Fb=1;function e(t,n){return t===n||t!==t&&n!==n}return dd=e,dd}var fd,zb;function Zc(){if(zb)return fd;zb=1;var e=As();function t(n,r){for(var i=n.length;i--;)if(e(n[i][0],r))return i;return-1}return fd=t,fd}var pd,qb;function G6(){if(qb)return pd;qb=1;var e=Zc(),t=Array.prototype,n=t.splice;function r(i){var s=this.__data__,o=e(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():n.call(s,o,1),--this.size,!0}return pd=r,pd}var hd,$b;function K6(){if($b)return hd;$b=1;var e=Zc();function t(n){var r=this.__data__,i=e(r,n);return i<0?void 0:r[i][1]}return hd=t,hd}var md,Bb;function Y6(){if(Bb)return md;Bb=1;var e=Zc();function t(n){return e(this.__data__,n)>-1}return md=t,md}var gd,Hb;function X6(){if(Hb)return gd;Hb=1;var e=Zc();function t(n,r){var i=this.__data__,s=e(i,n);return s<0?(++this.size,i.push([n,r])):i[s][1]=r,this}return gd=t,gd}var vd,Wb;function Jc(){if(Wb)return vd;Wb=1;var e=V6(),t=G6(),n=K6(),r=Y6(),i=X6();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,vd=s,vd}var xd,Ub;function Q6(){if(Ub)return xd;Ub=1;var e=Jc();function t(){this.__data__=new e,this.size=0}return xd=t,xd}var yd,Vb;function Z6(){if(Vb)return yd;Vb=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return yd=e,yd}var bd,Gb;function J6(){if(Gb)return bd;Gb=1;function e(t){return this.__data__.get(t)}return bd=e,bd}var wd,Kb;function eL(){if(Kb)return wd;Kb=1;function e(t){return this.__data__.has(t)}return wd=e,wd}var _d,Yb;function _E(){if(Yb)return _d;Yb=1;var e=typeof Ca=="object"&&Ca&&Ca.Object===Object&&Ca;return _d=e,_d}var jd,Xb;function Pn(){if(Xb)return jd;Xb=1;var e=_E(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return jd=n,jd}var Sd,Qb;function Is(){if(Qb)return Sd;Qb=1;var e=Pn(),t=e.Symbol;return Sd=t,Sd}var kd,Zb;function tL(){if(Zb)return kd;Zb=1;var e=Is(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,i=e?e.toStringTag:void 0;function s(o){var l=n.call(o,i),c=o[i];try{o[i]=void 0;var d=!0}catch{}var u=r.call(o);return d&&(l?o[i]=c:delete o[i]),u}return kd=s,kd}var Nd,Jb;function nL(){if(Jb)return Nd;Jb=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Nd=n,Nd}var Cd,e1;function Ti(){if(e1)return Cd;e1=1;var e=Is(),t=tL(),n=nL(),r="[object Null]",i="[object Undefined]",s=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?i:r:s&&s in Object(l)?t(l):n(l)}return Cd=o,Cd}var Ed,t1;function yn(){if(t1)return Ed;t1=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Ed=e,Ed}var Td,n1;function xa(){if(n1)return Td;n1=1;var e=Ti(),t=yn(),n="[object AsyncFunction]",r="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==r||c==i||c==n||c==s}return Td=o,Td}var Rd,r1;function rL(){if(r1)return Rd;r1=1;var e=Pn(),t=e["__core-js_shared__"];return Rd=t,Rd}var Ad,i1;function iL(){if(i1)return Ad;i1=1;var e=rL(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return Ad=n,Ad}var Id,s1;function jE(){if(s1)return Id;s1=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Id=n,Id}var Md,o1;function sL(){if(o1)return Md;o1=1;var e=xa(),t=iL(),n=yn(),r=jE(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!n(p)||t(p))return!1;var h=e(p)?u:s;return h.test(r(p))}return Md=f,Md}var Pd,a1;function oL(){if(a1)return Pd;a1=1;function e(t,n){return t==null?void 0:t[n]}return Pd=e,Pd}var Od,l1;function Ri(){if(l1)return Od;l1=1;var e=sL(),t=oL();function n(r,i){var s=t(r,i);return e(s)?s:void 0}return Od=n,Od}var Dd,c1;function ty(){if(c1)return Dd;c1=1;var e=Ri(),t=Pn(),n=e(t,"Map");return Dd=n,Dd}var Ld,u1;function eu(){if(u1)return Ld;u1=1;var e=Ri(),t=e(Object,"create");return Ld=t,Ld}var Fd,d1;function aL(){if(d1)return Fd;d1=1;var e=eu();function t(){this.__data__=e?e(null):{},this.size=0}return Fd=t,Fd}var zd,f1;function lL(){if(f1)return zd;f1=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return zd=e,zd}var qd,p1;function cL(){if(p1)return qd;p1=1;var e=eu(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function i(s){var o=this.__data__;if(e){var l=o[s];return l===t?void 0:l}return r.call(o,s)?o[s]:void 0}return qd=i,qd}var $d,h1;function uL(){if(h1)return $d;h1=1;var e=eu(),t=Object.prototype,n=t.hasOwnProperty;function r(i){var s=this.__data__;return e?s[i]!==void 0:n.call(s,i)}return $d=r,$d}var Bd,m1;function dL(){if(m1)return Bd;m1=1;var e=eu(),t="__lodash_hash_undefined__";function n(r,i){var s=this.__data__;return this.size+=this.has(r)?0:1,s[r]=e&&i===void 0?t:i,this}return Bd=n,Bd}var Hd,g1;function fL(){if(g1)return Hd;g1=1;var e=aL(),t=lL(),n=cL(),r=uL(),i=dL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,Hd=s,Hd}var Wd,v1;function pL(){if(v1)return Wd;v1=1;var e=fL(),t=Jc(),n=ty();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Wd=r,Wd}var Ud,x1;function hL(){if(x1)return Ud;x1=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Ud=e,Ud}var Vd,y1;function tu(){if(y1)return Vd;y1=1;var e=hL();function t(n,r){var i=n.__data__;return e(r)?i[typeof r=="string"?"string":"hash"]:i.map}return Vd=t,Vd}var Gd,b1;function mL(){if(b1)return Gd;b1=1;var e=tu();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return Gd=t,Gd}var Kd,w1;function gL(){if(w1)return Kd;w1=1;var e=tu();function t(n){return e(this,n).get(n)}return Kd=t,Kd}var Yd,_1;function vL(){if(_1)return Yd;_1=1;var e=tu();function t(n){return e(this,n).has(n)}return Yd=t,Yd}var Xd,j1;function xL(){if(j1)return Xd;j1=1;var e=tu();function t(n,r){var i=e(this,n),s=i.size;return i.set(n,r),this.size+=i.size==s?0:1,this}return Xd=t,Xd}var Qd,S1;function ny(){if(S1)return Qd;S1=1;var e=pL(),t=mL(),n=gL(),r=vL(),i=xL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,Qd=s,Qd}var Zd,k1;function yL(){if(k1)return Zd;k1=1;var e=Jc(),t=ty(),n=ny(),r=200;function i(s,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<r-1)return c.push([s,o]),this.size=++l.size,this;l=this.__data__=new n(c)}return l.set(s,o),this.size=l.size,this}return Zd=i,Zd}var Jd,N1;function nu(){if(N1)return Jd;N1=1;var e=Jc(),t=Q6(),n=Z6(),r=J6(),i=eL(),s=yL();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=n,o.prototype.get=r,o.prototype.has=i,o.prototype.set=s,Jd=o,Jd}var ef,C1;function ry(){if(C1)return ef;C1=1;function e(t,n){for(var r=-1,i=t==null?0:t.length;++r<i&&n(t[r],r,t)!==!1;);return t}return ef=e,ef}var tf,E1;function SE(){if(E1)return tf;E1=1;var e=Ri(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return tf=t,tf}var nf,T1;function ru(){if(T1)return nf;T1=1;var e=SE();function t(n,r,i){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:i,writable:!0}):n[r]=i}return nf=t,nf}var rf,R1;function iu(){if(R1)return rf;R1=1;var e=ru(),t=As(),n=Object.prototype,r=n.hasOwnProperty;function i(s,o,l){var c=s[o];(!(r.call(s,o)&&t(c,l))||l===void 0&&!(o in s))&&e(s,o,l)}return rf=i,rf}var sf,A1;function ya(){if(A1)return sf;A1=1;var e=iu(),t=ru();function n(r,i,s,o){var l=!s;s||(s={});for(var c=-1,d=i.length;++c<d;){var u=i[c],f=o?o(s[u],r[u],u,s,r):void 0;f===void 0&&(f=r[u]),l?t(s,u,f):e(s,u,f)}return s}return sf=n,sf}var of,I1;function bL(){if(I1)return of;I1=1;function e(t,n){for(var r=-1,i=Array(t);++r<t;)i[r]=n(r);return i}return of=e,of}var af,M1;function Yn(){if(M1)return af;M1=1;function e(t){return t!=null&&typeof t=="object"}return af=e,af}var lf,P1;function wL(){if(P1)return lf;P1=1;var e=Ti(),t=Yn(),n="[object Arguments]";function r(i){return t(i)&&e(i)==n}return lf=r,lf}var cf,O1;function ba(){if(O1)return cf;O1=1;var e=wL(),t=Yn(),n=Object.prototype,r=n.hasOwnProperty,i=n.propertyIsEnumerable,s=e(function(){return arguments}())?e:function(o){return t(o)&&r.call(o,"callee")&&!i.call(o,"callee")};return cf=s,cf}var uf,D1;function ot(){if(D1)return uf;D1=1;var e=Array.isArray;return uf=e,uf}var fo={exports:{}},df,L1;function _L(){if(L1)return df;L1=1;function e(){return!1}return df=e,df}fo.exports;var F1;function Ms(){return F1||(F1=1,function(e,t){var n=Pn(),r=_L(),i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===i,l=o?n.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||r;e.exports=d}(fo,fo.exports)),fo.exports}var ff,z1;function su(){if(z1)return ff;z1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,i){var s=typeof r;return i=i??e,!!i&&(s=="number"||s!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<i}return ff=n,ff}var pf,q1;function iy(){if(q1)return pf;q1=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return pf=t,pf}var hf,$1;function jL(){if($1)return hf;$1=1;var e=Ti(),t=iy(),n=Yn(),r="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",x="[object String]",g="[object WeakMap]",w="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",_="[object Int8Array]",j="[object Int16Array]",k="[object Int32Array]",N="[object Uint8Array]",E="[object Uint8ClampedArray]",S="[object Uint16Array]",R="[object Uint32Array]",T={};T[y]=T[b]=T[_]=T[j]=T[k]=T[N]=T[E]=T[S]=T[R]=!0,T[r]=T[i]=T[w]=T[s]=T[v]=T[o]=T[l]=T[c]=T[d]=T[u]=T[f]=T[p]=T[h]=T[x]=T[g]=!1;function M(z){return n(z)&&t(z.length)&&!!T[e(z)]}return hf=M,hf}var mf,B1;function ou(){if(B1)return mf;B1=1;function e(t){return function(n){return t(n)}}return mf=e,mf}var po={exports:{}};po.exports;var H1;function sy(){return H1||(H1=1,function(e,t){var n=_E(),r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,o=s&&n.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l}(po,po.exports)),po.exports}var gf,W1;function wa(){if(W1)return gf;W1=1;var e=jL(),t=ou(),n=sy(),r=n&&n.isTypedArray,i=r?t(r):e;return gf=i,gf}var vf,U1;function kE(){if(U1)return vf;U1=1;var e=bL(),t=ba(),n=ot(),r=Ms(),i=su(),s=wa(),o=Object.prototype,l=o.hasOwnProperty;function c(d,u){var f=n(d),p=!f&&t(d),h=!f&&!p&&r(d),x=!f&&!p&&!h&&s(d),g=f||p||h||x,w=g?e(d.length,String):[],v=w.length;for(var y in d)(u||l.call(d,y))&&!(g&&(y=="length"||h&&(y=="offset"||y=="parent")||x&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||i(y,v)))&&w.push(y);return w}return vf=c,vf}var xf,V1;function au(){if(V1)return xf;V1=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,i=typeof r=="function"&&r.prototype||e;return n===i}return xf=t,xf}var yf,G1;function NE(){if(G1)return yf;G1=1;function e(t,n){return function(r){return t(n(r))}}return yf=e,yf}var bf,K1;function SL(){if(K1)return bf;K1=1;var e=NE(),t=e(Object.keys,Object);return bf=t,bf}var wf,Y1;function oy(){if(Y1)return wf;Y1=1;var e=au(),t=SL(),n=Object.prototype,r=n.hasOwnProperty;function i(s){if(!e(s))return t(s);var o=[];for(var l in Object(s))r.call(s,l)&&l!="constructor"&&o.push(l);return o}return wf=i,wf}var _f,X1;function xr(){if(X1)return _f;X1=1;var e=xa(),t=iy();function n(r){return r!=null&&t(r.length)&&!e(r)}return _f=n,_f}var jf,Q1;function ei(){if(Q1)return jf;Q1=1;var e=kE(),t=oy(),n=xr();function r(i){return n(i)?e(i):t(i)}return jf=r,jf}var Sf,Z1;function kL(){if(Z1)return Sf;Z1=1;var e=ya(),t=ei();function n(r,i){return r&&e(i,t(i),r)}return Sf=n,Sf}var kf,J1;function NL(){if(J1)return kf;J1=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return kf=e,kf}var Nf,ew;function CL(){if(ew)return Nf;ew=1;var e=yn(),t=au(),n=NL(),r=Object.prototype,i=r.hasOwnProperty;function s(o){if(!e(o))return n(o);var l=t(o),c=[];for(var d in o)d=="constructor"&&(l||!i.call(o,d))||c.push(d);return c}return Nf=s,Nf}var Cf,tw;function Ai(){if(tw)return Cf;tw=1;var e=kE(),t=CL(),n=xr();function r(i){return n(i)?e(i,!0):t(i)}return Cf=r,Cf}var Ef,nw;function EL(){if(nw)return Ef;nw=1;var e=ya(),t=Ai();function n(r,i){return r&&e(i,t(i),r)}return Ef=n,Ef}var ho={exports:{}};ho.exports;var rw;function CE(){return rw||(rw=1,function(e,t){var n=Pn(),r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,o=s?n.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(ho,ho.exports)),ho.exports}var Tf,iw;function EE(){if(iw)return Tf;iw=1;function e(t,n){var r=-1,i=t.length;for(n||(n=Array(i));++r<i;)n[r]=t[r];return n}return Tf=e,Tf}var Rf,sw;function TE(){if(sw)return Rf;sw=1;function e(t,n){for(var r=-1,i=t==null?0:t.length,s=0,o=[];++r<i;){var l=t[r];n(l,r,t)&&(o[s++]=l)}return o}return Rf=e,Rf}var Af,ow;function RE(){if(ow)return Af;ow=1;function e(){return[]}return Af=e,Af}var If,aw;function ay(){if(aw)return If;aw=1;var e=TE(),t=RE(),n=Object.prototype,r=n.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),e(i(o),function(l){return r.call(o,l)}))}:t;return If=s,If}var Mf,lw;function TL(){if(lw)return Mf;lw=1;var e=ya(),t=ay();function n(r,i){return e(r,t(r),i)}return Mf=n,Mf}var Pf,cw;function ly(){if(cw)return Pf;cw=1;function e(t,n){for(var r=-1,i=n.length,s=t.length;++r<i;)t[s+r]=n[r];return t}return Pf=e,Pf}var Of,uw;function lu(){if(uw)return Of;uw=1;var e=NE(),t=e(Object.getPrototypeOf,Object);return Of=t,Of}var Df,dw;function AE(){if(dw)return Df;dw=1;var e=ly(),t=lu(),n=ay(),r=RE(),i=Object.getOwnPropertySymbols,s=i?function(o){for(var l=[];o;)e(l,n(o)),o=t(o);return l}:r;return Df=s,Df}var Lf,fw;function RL(){if(fw)return Lf;fw=1;var e=ya(),t=AE();function n(r,i){return e(r,t(r),i)}return Lf=n,Lf}var Ff,pw;function IE(){if(pw)return Ff;pw=1;var e=ly(),t=ot();function n(r,i,s){var o=i(r);return t(r)?o:e(o,s(r))}return Ff=n,Ff}var zf,hw;function ME(){if(hw)return zf;hw=1;var e=IE(),t=ay(),n=ei();function r(i){return e(i,n,t)}return zf=r,zf}var qf,mw;function AL(){if(mw)return qf;mw=1;var e=IE(),t=AE(),n=Ai();function r(i){return e(i,n,t)}return qf=r,qf}var $f,gw;function IL(){if(gw)return $f;gw=1;var e=Ri(),t=Pn(),n=e(t,"DataView");return $f=n,$f}var Bf,vw;function ML(){if(vw)return Bf;vw=1;var e=Ri(),t=Pn(),n=e(t,"Promise");return Bf=n,Bf}var Hf,xw;function PE(){if(xw)return Hf;xw=1;var e=Ri(),t=Pn(),n=e(t,"Set");return Hf=n,Hf}var Wf,yw;function PL(){if(yw)return Wf;yw=1;var e=Ri(),t=Pn(),n=e(t,"WeakMap");return Wf=n,Wf}var Uf,bw;function Ps(){if(bw)return Uf;bw=1;var e=IL(),t=ty(),n=ML(),r=PE(),i=PL(),s=Ti(),o=jE(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=o(e),x=o(t),g=o(n),w=o(r),v=o(i),y=s;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||n&&y(n.resolve())!=d||r&&y(new r)!=u||i&&y(new i)!=f)&&(y=function(b){var _=s(b),j=_==c?b.constructor:void 0,k=j?o(j):"";if(k)switch(k){case h:return p;case x:return l;case g:return d;case w:return u;case v:return f}return _}),Uf=y,Uf}var Vf,ww;function OL(){if(ww)return Vf;ww=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r){var i=r.length,s=new r.constructor(i);return i&&typeof r[0]=="string"&&t.call(r,"index")&&(s.index=r.index,s.input=r.input),s}return Vf=n,Vf}var Gf,_w;function OE(){if(_w)return Gf;_w=1;var e=Pn(),t=e.Uint8Array;return Gf=t,Gf}var Kf,jw;function cy(){if(jw)return Kf;jw=1;var e=OE();function t(n){var r=new n.constructor(n.byteLength);return new e(r).set(new e(n)),r}return Kf=t,Kf}var Yf,Sw;function DL(){if(Sw)return Yf;Sw=1;var e=cy();function t(n,r){var i=r?e(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.byteLength)}return Yf=t,Yf}var Xf,kw;function LL(){if(kw)return Xf;kw=1;var e=/\w*$/;function t(n){var r=new n.constructor(n.source,e.exec(n));return r.lastIndex=n.lastIndex,r}return Xf=t,Xf}var Qf,Nw;function FL(){if(Nw)return Qf;Nw=1;var e=Is(),t=e?e.prototype:void 0,n=t?t.valueOf:void 0;function r(i){return n?Object(n.call(i)):{}}return Qf=r,Qf}var Zf,Cw;function DE(){if(Cw)return Zf;Cw=1;var e=cy();function t(n,r){var i=r?e(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.length)}return Zf=t,Zf}var Jf,Ew;function zL(){if(Ew)return Jf;Ew=1;var e=cy(),t=DL(),n=LL(),r=FL(),i=DE(),s="[object Boolean]",o="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",x="[object DataView]",g="[object Float32Array]",w="[object Float64Array]",v="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",_="[object Uint8Array]",j="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]";function E(S,R,T){var M=S.constructor;switch(R){case h:return e(S);case s:case o:return new M(+S);case x:return t(S,T);case g:case w:case v:case y:case b:case _:case j:case k:case N:return i(S,T);case l:return new M;case c:case f:return new M(S);case d:return n(S);case u:return new M;case p:return r(S)}}return Jf=E,Jf}var ep,Tw;function LE(){if(Tw)return ep;Tw=1;var e=yn(),t=Object.create,n=function(){function r(){}return function(i){if(!e(i))return{};if(t)return t(i);r.prototype=i;var s=new r;return r.prototype=void 0,s}}();return ep=n,ep}var tp,Rw;function FE(){if(Rw)return tp;Rw=1;var e=LE(),t=lu(),n=au();function r(i){return typeof i.constructor=="function"&&!n(i)?e(t(i)):{}}return tp=r,tp}var np,Aw;function qL(){if(Aw)return np;Aw=1;var e=Ps(),t=Yn(),n="[object Map]";function r(i){return t(i)&&e(i)==n}return np=r,np}var rp,Iw;function $L(){if(Iw)return rp;Iw=1;var e=qL(),t=ou(),n=sy(),r=n&&n.isMap,i=r?t(r):e;return rp=i,rp}var ip,Mw;function BL(){if(Mw)return ip;Mw=1;var e=Ps(),t=Yn(),n="[object Set]";function r(i){return t(i)&&e(i)==n}return ip=r,ip}var sp,Pw;function HL(){if(Pw)return sp;Pw=1;var e=BL(),t=ou(),n=sy(),r=n&&n.isSet,i=r?t(r):e;return sp=i,sp}var op,Ow;function zE(){if(Ow)return op;Ow=1;var e=nu(),t=ry(),n=iu(),r=kL(),i=EL(),s=CE(),o=EE(),l=TL(),c=RL(),d=ME(),u=AL(),f=Ps(),p=OL(),h=zL(),x=FE(),g=ot(),w=Ms(),v=$L(),y=yn(),b=HL(),_=ei(),j=Ai(),k=1,N=2,E=4,S="[object Arguments]",R="[object Array]",T="[object Boolean]",M="[object Date]",z="[object Error]",C="[object Function]",L="[object GeneratorFunction]",P="[object Map]",$="[object Number]",O="[object Object]",A="[object RegExp]",F="[object Set]",I="[object String]",q="[object Symbol]",W="[object WeakMap]",U="[object ArrayBuffer]",Z="[object DataView]",B="[object Float32Array]",ne="[object Float64Array]",ie="[object Int8Array]",le="[object Int16Array]",J="[object Int32Array]",_e="[object Uint8Array]",G="[object Uint8ClampedArray]",ve="[object Uint16Array]",fe="[object Uint32Array]",se={};se[S]=se[R]=se[U]=se[Z]=se[T]=se[M]=se[B]=se[ne]=se[ie]=se[le]=se[J]=se[P]=se[$]=se[O]=se[A]=se[F]=se[I]=se[q]=se[_e]=se[G]=se[ve]=se[fe]=!0,se[z]=se[C]=se[W]=!1;function ge(Y,Q,pe,ye,we,xe){var te,he=Q&k,Ge=Q&N,ze=Q&E;if(pe&&(te=we?pe(Y,ye,we,xe):pe(Y)),te!==void 0)return te;if(!y(Y))return Y;var Be=g(Y);if(Be){if(te=p(Y),!he)return o(Y,te)}else{var Te=f(Y),He=Te==C||Te==L;if(w(Y))return s(Y,he);if(Te==O||Te==S||He&&!we){if(te=Ge||He?{}:x(Y),!he)return Ge?c(Y,i(te,Y)):l(Y,r(te,Y))}else{if(!se[Te])return we?Y:{};te=h(Y,Te,he)}}xe||(xe=new e);var at=xe.get(Y);if(at)return at;xe.set(Y,te),b(Y)?Y.forEach(function(Oe){te.add(ge(Oe,Q,pe,Oe,Y,xe))}):v(Y)&&Y.forEach(function(Oe,me){te.set(me,ge(Oe,Q,pe,me,Y,xe))});var Re=ze?Ge?u:d:Ge?j:_,X=Be?void 0:Re(Y);return t(X||Y,function(Oe,me){X&&(me=Oe,Oe=Y[me]),n(te,me,ge(Oe,Q,pe,me,Y,xe))}),te}return op=ge,op}var ap,Dw;function WL(){if(Dw)return ap;Dw=1;var e=zE(),t=4;function n(r){return e(r,t)}return ap=n,ap}var lp,Lw;function uy(){if(Lw)return lp;Lw=1;function e(t){return function(){return t}}return lp=e,lp}var cp,Fw;function UL(){if(Fw)return cp;Fw=1;function e(t){return function(n,r,i){for(var s=-1,o=Object(n),l=i(n),c=l.length;c--;){var d=l[t?c:++s];if(r(o[d],d,o)===!1)break}return n}}return cp=e,cp}var up,zw;function dy(){if(zw)return up;zw=1;var e=UL(),t=e();return up=t,up}var dp,qw;function fy(){if(qw)return dp;qw=1;var e=dy(),t=ei();function n(r,i){return r&&e(r,i,t)}return dp=n,dp}var fp,$w;function VL(){if($w)return fp;$w=1;var e=xr();function t(n,r){return function(i,s){if(i==null)return i;if(!e(i))return n(i,s);for(var o=i.length,l=r?o:-1,c=Object(i);(r?l--:++l<o)&&s(c[l],l,c)!==!1;);return i}}return fp=t,fp}var pp,Bw;function cu(){if(Bw)return pp;Bw=1;var e=fy(),t=VL(),n=t(e);return pp=n,pp}var hp,Hw;function Ii(){if(Hw)return hp;Hw=1;function e(t){return t}return hp=e,hp}var mp,Ww;function qE(){if(Ww)return mp;Ww=1;var e=Ii();function t(n){return typeof n=="function"?n:e}return mp=t,mp}var gp,Uw;function $E(){if(Uw)return gp;Uw=1;var e=ry(),t=cu(),n=qE(),r=ot();function i(s,o){var l=r(s)?e:t;return l(s,n(o))}return gp=i,gp}var vp,Vw;function BE(){return Vw||(Vw=1,vp=$E()),vp}var xp,Gw;function GL(){if(Gw)return xp;Gw=1;var e=cu();function t(n,r){var i=[];return e(n,function(s,o,l){r(s,o,l)&&i.push(s)}),i}return xp=t,xp}var yp,Kw;function KL(){if(Kw)return yp;Kw=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return yp=t,yp}var bp,Yw;function YL(){if(Yw)return bp;Yw=1;function e(t){return this.__data__.has(t)}return bp=e,bp}var wp,Xw;function HE(){if(Xw)return wp;Xw=1;var e=ny(),t=KL(),n=YL();function r(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new e;++s<o;)this.add(i[s])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,wp=r,wp}var _p,Qw;function XL(){if(Qw)return _p;Qw=1;function e(t,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(n(t[r],r,t))return!0;return!1}return _p=e,_p}var jp,Zw;function WE(){if(Zw)return jp;Zw=1;function e(t,n){return t.has(n)}return jp=e,jp}var Sp,Jw;function UE(){if(Jw)return Sp;Jw=1;var e=HE(),t=XL(),n=WE(),r=1,i=2;function s(o,l,c,d,u,f){var p=c&r,h=o.length,x=l.length;if(h!=x&&!(p&&x>h))return!1;var g=f.get(o),w=f.get(l);if(g&&w)return g==l&&w==o;var v=-1,y=!0,b=c&i?new e:void 0;for(f.set(o,l),f.set(l,o);++v<h;){var _=o[v],j=l[v];if(d)var k=p?d(j,_,v,l,o,f):d(_,j,v,o,l,f);if(k!==void 0){if(k)continue;y=!1;break}if(b){if(!t(l,function(N,E){if(!n(b,E)&&(_===N||u(_,N,c,d,f)))return b.push(E)})){y=!1;break}}else if(!(_===j||u(_,j,c,d,f))){y=!1;break}}return f.delete(o),f.delete(l),y}return Sp=s,Sp}var kp,e_;function QL(){if(e_)return kp;e_=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(i,s){r[++n]=[s,i]}),r}return kp=e,kp}var Np,t_;function py(){if(t_)return Np;t_=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(i){r[++n]=i}),r}return Np=e,Np}var Cp,n_;function ZL(){if(n_)return Cp;n_=1;var e=Is(),t=OE(),n=As(),r=UE(),i=QL(),s=py(),o=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",x="[object Set]",g="[object String]",w="[object Symbol]",v="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,_=b?b.valueOf:void 0;function j(k,N,E,S,R,T,M){switch(E){case y:if(k.byteLength!=N.byteLength||k.byteOffset!=N.byteOffset)return!1;k=k.buffer,N=N.buffer;case v:return!(k.byteLength!=N.byteLength||!T(new t(k),new t(N)));case c:case d:case p:return n(+k,+N);case u:return k.name==N.name&&k.message==N.message;case h:case g:return k==N+"";case f:var z=i;case x:var C=S&o;if(z||(z=s),k.size!=N.size&&!C)return!1;var L=M.get(k);if(L)return L==N;S|=l,M.set(k,N);var P=r(z(k),z(N),S,R,T,M);return M.delete(k),P;case w:if(_)return _.call(k)==_.call(N)}return!1}return Cp=j,Cp}var Ep,r_;function JL(){if(r_)return Ep;r_=1;var e=ME(),t=1,n=Object.prototype,r=n.hasOwnProperty;function i(s,o,l,c,d,u){var f=l&t,p=e(s),h=p.length,x=e(o),g=x.length;if(h!=g&&!f)return!1;for(var w=h;w--;){var v=p[w];if(!(f?v in o:r.call(o,v)))return!1}var y=u.get(s),b=u.get(o);if(y&&b)return y==o&&b==s;var _=!0;u.set(s,o),u.set(o,s);for(var j=f;++w<h;){v=p[w];var k=s[v],N=o[v];if(c)var E=f?c(N,k,v,o,s,u):c(k,N,v,s,o,u);if(!(E===void 0?k===N||d(k,N,l,c,u):E)){_=!1;break}j||(j=v=="constructor")}if(_&&!j){var S=s.constructor,R=o.constructor;S!=R&&"constructor"in s&&"constructor"in o&&!(typeof S=="function"&&S instanceof S&&typeof R=="function"&&R instanceof R)&&(_=!1)}return u.delete(s),u.delete(o),_}return Ep=i,Ep}var Tp,i_;function e8(){if(i_)return Tp;i_=1;var e=nu(),t=UE(),n=ZL(),r=JL(),i=Ps(),s=ot(),o=Ms(),l=wa(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function x(g,w,v,y,b,_){var j=s(g),k=s(w),N=j?u:i(g),E=k?u:i(w);N=N==d?f:N,E=E==d?f:E;var S=N==f,R=E==f,T=N==E;if(T&&o(g)){if(!o(w))return!1;j=!0,S=!1}if(T&&!S)return _||(_=new e),j||l(g)?t(g,w,v,y,b,_):n(g,w,N,v,y,b,_);if(!(v&c)){var M=S&&h.call(g,"__wrapped__"),z=R&&h.call(w,"__wrapped__");if(M||z){var C=M?g.value():g,L=z?w.value():w;return _||(_=new e),b(C,L,v,y,_)}}return T?(_||(_=new e),r(g,w,v,y,b,_)):!1}return Tp=x,Tp}var Rp,s_;function VE(){if(s_)return Rp;s_=1;var e=e8(),t=Yn();function n(r,i,s,o,l){return r===i?!0:r==null||i==null||!t(r)&&!t(i)?r!==r&&i!==i:e(r,i,s,o,n,l)}return Rp=n,Rp}var Ap,o_;function t8(){if(o_)return Ap;o_=1;var e=nu(),t=VE(),n=1,r=2;function i(s,o,l,c){var d=l.length,u=d,f=!c;if(s==null)return!u;for(s=Object(s);d--;){var p=l[d];if(f&&p[2]?p[1]!==s[p[0]]:!(p[0]in s))return!1}for(;++d<u;){p=l[d];var h=p[0],x=s[h],g=p[1];if(f&&p[2]){if(x===void 0&&!(h in s))return!1}else{var w=new e;if(c)var v=c(x,g,h,s,o,w);if(!(v===void 0?t(g,x,n|r,c,w):v))return!1}}return!0}return Ap=i,Ap}var Ip,a_;function GE(){if(a_)return Ip;a_=1;var e=yn();function t(n){return n===n&&!e(n)}return Ip=t,Ip}var Mp,l_;function n8(){if(l_)return Mp;l_=1;var e=GE(),t=ei();function n(r){for(var i=t(r),s=i.length;s--;){var o=i[s],l=r[o];i[s]=[o,l,e(l)]}return i}return Mp=n,Mp}var Pp,c_;function KE(){if(c_)return Pp;c_=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return Pp=e,Pp}var Op,u_;function r8(){if(u_)return Op;u_=1;var e=t8(),t=n8(),n=KE();function r(i){var s=t(i);return s.length==1&&s[0][2]?n(s[0][0],s[0][1]):function(o){return o===i||e(o,i,s)}}return Op=r,Op}var Dp,d_;function Os(){if(d_)return Dp;d_=1;var e=Ti(),t=Yn(),n="[object Symbol]";function r(i){return typeof i=="symbol"||t(i)&&e(i)==n}return Dp=r,Dp}var Lp,f_;function hy(){if(f_)return Lp;f_=1;var e=ot(),t=Os(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(s,o){if(e(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:r.test(s)||!n.test(s)||o!=null&&s in Object(o)}return Lp=i,Lp}var Fp,p_;function i8(){if(p_)return Fp;p_=1;var e=ny(),t="Expected a function";function n(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var d=r.apply(this,o);return s.cache=c.set(l,d)||c,d};return s.cache=new(n.Cache||e),s}return n.Cache=e,Fp=n,Fp}var zp,h_;function s8(){if(h_)return zp;h_=1;var e=i8(),t=500;function n(r){var i=e(r,function(o){return s.size===t&&s.clear(),o}),s=i.cache;return i}return zp=n,zp}var qp,m_;function o8(){if(m_)return qp;m_=1;var e=s8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(t,function(o,l,c,d){s.push(c?d.replace(n,"$1"):l||o)}),s});return qp=r,qp}var $p,g_;function uu(){if(g_)return $p;g_=1;function e(t,n){for(var r=-1,i=t==null?0:t.length,s=Array(i);++r<i;)s[r]=n(t[r],r,t);return s}return $p=e,$p}var Bp,v_;function a8(){if(v_)return Bp;v_=1;var e=Is(),t=uu(),n=ot(),r=Os(),i=e?e.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(n(l))return t(l,o)+"";if(r(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Bp=o,Bp}var Hp,x_;function YE(){if(x_)return Hp;x_=1;var e=a8();function t(n){return n==null?"":e(n)}return Hp=t,Hp}var Wp,y_;function du(){if(y_)return Wp;y_=1;var e=ot(),t=hy(),n=o8(),r=YE();function i(s,o){return e(s)?s:t(s,o)?[s]:n(r(s))}return Wp=i,Wp}var Up,b_;function _a(){if(b_)return Up;b_=1;var e=Os();function t(n){if(typeof n=="string"||e(n))return n;var r=n+"";return r=="0"&&1/n==-1/0?"-0":r}return Up=t,Up}var Vp,w_;function fu(){if(w_)return Vp;w_=1;var e=du(),t=_a();function n(r,i){i=e(i,r);for(var s=0,o=i.length;r!=null&&s<o;)r=r[t(i[s++])];return s&&s==o?r:void 0}return Vp=n,Vp}var Gp,__;function l8(){if(__)return Gp;__=1;var e=fu();function t(n,r,i){var s=n==null?void 0:e(n,r);return s===void 0?i:s}return Gp=t,Gp}var Kp,j_;function c8(){if(j_)return Kp;j_=1;function e(t,n){return t!=null&&n in Object(t)}return Kp=e,Kp}var Yp,S_;function XE(){if(S_)return Yp;S_=1;var e=du(),t=ba(),n=ot(),r=su(),i=iy(),s=_a();function o(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=s(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&i(f)&&r(h,f)&&(n(l)||t(l)))}return Yp=o,Yp}var Xp,k_;function QE(){if(k_)return Xp;k_=1;var e=c8(),t=XE();function n(r,i){return r!=null&&t(r,i,e)}return Xp=n,Xp}var Qp,N_;function u8(){if(N_)return Qp;N_=1;var e=VE(),t=l8(),n=QE(),r=hy(),i=GE(),s=KE(),o=_a(),l=1,c=2;function d(u,f){return r(u)&&i(f)?s(o(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?n(p,u):e(f,h,l|c)}}return Qp=d,Qp}var Zp,C_;function ZE(){if(C_)return Zp;C_=1;function e(t){return function(n){return n==null?void 0:n[t]}}return Zp=e,Zp}var Jp,E_;function d8(){if(E_)return Jp;E_=1;var e=fu();function t(n){return function(r){return e(r,n)}}return Jp=t,Jp}var eh,T_;function f8(){if(T_)return eh;T_=1;var e=ZE(),t=d8(),n=hy(),r=_a();function i(s){return n(s)?e(r(s)):t(s)}return eh=i,eh}var th,R_;function yr(){if(R_)return th;R_=1;var e=r8(),t=u8(),n=Ii(),r=ot(),i=f8();function s(o){return typeof o=="function"?o:o==null?n:typeof o=="object"?r(o)?t(o[0],o[1]):e(o):i(o)}return th=s,th}var nh,A_;function JE(){if(A_)return nh;A_=1;var e=TE(),t=GL(),n=yr(),r=ot();function i(s,o){var l=r(s)?e:t;return l(s,n(o,3))}return nh=i,nh}var rh,I_;function p8(){if(I_)return rh;I_=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r,i){return r!=null&&t.call(r,i)}return rh=n,rh}var ih,M_;function eT(){if(M_)return ih;M_=1;var e=p8(),t=XE();function n(r,i){return r!=null&&t(r,i,e)}return ih=n,ih}var sh,P_;function h8(){if(P_)return sh;P_=1;var e=oy(),t=Ps(),n=ba(),r=ot(),i=xr(),s=Ms(),o=au(),l=wa(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(i(h)&&(r(h)||typeof h=="string"||typeof h.splice=="function"||s(h)||l(h)||n(h)))return!h.length;var x=t(h);if(x==c||x==d)return!h.size;if(o(h))return!e(h).length;for(var g in h)if(f.call(h,g))return!1;return!0}return sh=p,sh}var oh,O_;function tT(){if(O_)return oh;O_=1;function e(t){return t===void 0}return oh=e,oh}var ah,D_;function nT(){if(D_)return ah;D_=1;var e=cu(),t=xr();function n(r,i){var s=-1,o=t(r)?Array(r.length):[];return e(r,function(l,c,d){o[++s]=i(l,c,d)}),o}return ah=n,ah}var lh,L_;function rT(){if(L_)return lh;L_=1;var e=uu(),t=yr(),n=nT(),r=ot();function i(s,o){var l=r(s)?e:n;return l(s,t(o,3))}return lh=i,lh}var ch,F_;function m8(){if(F_)return ch;F_=1;function e(t,n,r,i){var s=-1,o=t==null?0:t.length;for(i&&o&&(r=t[++s]);++s<o;)r=n(r,t[s],s,t);return r}return ch=e,ch}var uh,z_;function g8(){if(z_)return uh;z_=1;function e(t,n,r,i,s){return s(t,function(o,l,c){r=i?(i=!1,o):n(r,o,l,c)}),r}return uh=e,uh}var dh,q_;function iT(){if(q_)return dh;q_=1;var e=m8(),t=cu(),n=yr(),r=g8(),i=ot();function s(o,l,c){var d=i(o)?e:r,u=arguments.length<3;return d(o,n(l,4),c,u,t)}return dh=s,dh}var fh,$_;function v8(){if($_)return fh;$_=1;var e=Ti(),t=ot(),n=Yn(),r="[object String]";function i(s){return typeof s=="string"||!t(s)&&n(s)&&e(s)==r}return fh=i,fh}var ph,B_;function x8(){if(B_)return ph;B_=1;var e=ZE(),t=e("length");return ph=t,ph}var hh,H_;function y8(){if(H_)return hh;H_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,s="\\ufe0e\\ufe0f",o="\\u200d",l=RegExp("["+o+e+i+s+"]");function c(d){return l.test(d)}return hh=c,hh}var mh,W_;function b8(){if(W_)return mh;W_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,s="\\ufe0e\\ufe0f",o="["+e+"]",l="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",x=d+"?",g="["+s+"]?",w="(?:"+h+"(?:"+[u,f,p].join("|")+")"+g+x+")*",v=g+x+w,y="(?:"+[u+l+"?",l,f,p,o].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+v,"g");function _(j){for(var k=b.lastIndex=0;b.test(j);)++k;return k}return mh=_,mh}var gh,U_;function w8(){if(U_)return gh;U_=1;var e=x8(),t=y8(),n=b8();function r(i){return t(i)?n(i):e(i)}return gh=r,gh}var vh,V_;function _8(){if(V_)return vh;V_=1;var e=oy(),t=Ps(),n=xr(),r=v8(),i=w8(),s="[object Map]",o="[object Set]";function l(c){if(c==null)return 0;if(n(c))return r(c)?i(c):c.length;var d=t(c);return d==s||d==o?c.size:e(c).length}return vh=l,vh}var xh,G_;function j8(){if(G_)return xh;G_=1;var e=ry(),t=LE(),n=fy(),r=yr(),i=lu(),s=ot(),o=Ms(),l=xa(),c=yn(),d=wa();function u(f,p,h){var x=s(f),g=x||o(f)||d(f);if(p=r(p,4),h==null){var w=f&&f.constructor;g?h=x?new w:[]:c(f)?h=l(w)?t(i(f)):{}:h={}}return(g?e:n)(f,function(v,y,b){return p(h,v,y,b)}),h}return xh=u,xh}var yh,K_;function S8(){if(K_)return yh;K_=1;var e=Is(),t=ba(),n=ot(),r=e?e.isConcatSpreadable:void 0;function i(s){return n(s)||t(s)||!!(r&&s&&s[r])}return yh=i,yh}var bh,Y_;function my(){if(Y_)return bh;Y_=1;var e=ly(),t=S8();function n(r,i,s,o,l){var c=-1,d=r.length;for(s||(s=t),l||(l=[]);++c<d;){var u=r[c];i>0&&s(u)?i>1?n(u,i-1,s,o,l):e(l,u):o||(l[l.length]=u)}return l}return bh=n,bh}var wh,X_;function k8(){if(X_)return wh;X_=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return wh=e,wh}var _h,Q_;function sT(){if(Q_)return _h;Q_=1;var e=k8(),t=Math.max;function n(r,i,s){return i=t(i===void 0?r.length-1:i,0),function(){for(var o=arguments,l=-1,c=t(o.length-i,0),d=Array(c);++l<c;)d[l]=o[i+l];l=-1;for(var u=Array(i+1);++l<i;)u[l]=o[l];return u[i]=s(d),e(r,this,u)}}return _h=n,_h}var jh,Z_;function N8(){if(Z_)return jh;Z_=1;var e=uy(),t=SE(),n=Ii(),r=t?function(i,s){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(s),writable:!0})}:n;return jh=r,jh}var Sh,J_;function C8(){if(J_)return Sh;J_=1;var e=800,t=16,n=Date.now;function r(i){var s=0,o=0;return function(){var l=n(),c=t-(l-o);if(o=l,c>0){if(++s>=e)return arguments[0]}else s=0;return i.apply(void 0,arguments)}}return Sh=r,Sh}var kh,e2;function oT(){if(e2)return kh;e2=1;var e=N8(),t=C8(),n=t(e);return kh=n,kh}var Nh,t2;function pu(){if(t2)return Nh;t2=1;var e=Ii(),t=sT(),n=oT();function r(i,s){return n(t(i,s,e),i+"")}return Nh=r,Nh}var Ch,n2;function aT(){if(n2)return Ch;n2=1;function e(t,n,r,i){for(var s=t.length,o=r+(i?1:-1);i?o--:++o<s;)if(n(t[o],o,t))return o;return-1}return Ch=e,Ch}var Eh,r2;function E8(){if(r2)return Eh;r2=1;function e(t){return t!==t}return Eh=e,Eh}var Th,i2;function T8(){if(i2)return Th;i2=1;function e(t,n,r){for(var i=r-1,s=t.length;++i<s;)if(t[i]===n)return i;return-1}return Th=e,Th}var Rh,s2;function R8(){if(s2)return Rh;s2=1;var e=aT(),t=E8(),n=T8();function r(i,s,o){return s===s?n(i,s,o):e(i,t,o)}return Rh=r,Rh}var Ah,o2;function A8(){if(o2)return Ah;o2=1;var e=R8();function t(n,r){var i=n==null?0:n.length;return!!i&&e(n,r,0)>-1}return Ah=t,Ah}var Ih,a2;function I8(){if(a2)return Ih;a2=1;function e(t,n,r){for(var i=-1,s=t==null?0:t.length;++i<s;)if(r(n,t[i]))return!0;return!1}return Ih=e,Ih}var Mh,l2;function M8(){if(l2)return Mh;l2=1;function e(){}return Mh=e,Mh}var Ph,c2;function P8(){if(c2)return Ph;c2=1;var e=PE(),t=M8(),n=py(),r=1/0,i=e&&1/n(new e([,-0]))[1]==r?function(s){return new e(s)}:t;return Ph=i,Ph}var Oh,u2;function O8(){if(u2)return Oh;u2=1;var e=HE(),t=A8(),n=I8(),r=WE(),i=P8(),s=py(),o=200;function l(c,d,u){var f=-1,p=t,h=c.length,x=!0,g=[],w=g;if(u)x=!1,p=n;else if(h>=o){var v=d?null:i(c);if(v)return s(v);x=!1,p=r,w=new e}else w=d?[]:g;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,x&&b===b){for(var _=w.length;_--;)if(w[_]===b)continue e;d&&w.push(b),g.push(y)}else p(w,b,u)||(w!==g&&w.push(b),g.push(y))}return g}return Oh=l,Oh}var Dh,d2;function lT(){if(d2)return Dh;d2=1;var e=xr(),t=Yn();function n(r){return t(r)&&e(r)}return Dh=n,Dh}var Lh,f2;function D8(){if(f2)return Lh;f2=1;var e=my(),t=pu(),n=O8(),r=lT(),i=t(function(s){return n(e(s,1,r,!0))});return Lh=i,Lh}var Fh,p2;function L8(){if(p2)return Fh;p2=1;var e=uu();function t(n,r){return e(r,function(i){return n[i]})}return Fh=t,Fh}var zh,h2;function cT(){if(h2)return zh;h2=1;var e=L8(),t=ei();function n(r){return r==null?[]:e(r,t(r))}return zh=n,zh}var qh,m2;function bn(){if(m2)return qh;m2=1;var e;if(typeof ey=="function")try{e={clone:WL(),constant:uy(),each:BE(),filter:JE(),has:eT(),isArray:ot(),isEmpty:h8(),isFunction:xa(),isUndefined:tT(),keys:ei(),map:rT(),reduce:iT(),size:_8(),transform:j8(),union:D8(),values:cT()}}catch{}return e||(e=window._),qh=e,qh}var $h,g2;function gy(){if(g2)return $h;g2=1;var e=bn();$h=i;var t="\0",n="\0",r="";function i(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[n]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},i.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},i.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(x){p.length>1?h.setNode(x,f):h.setNode(x)}),this},i.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=n,this._children[u]={},this._children[n][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return e.has(this._nodes,u)},i.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=n;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==n)return f}},i.prototype.children=function(u){if(e.isUndefined(u)&&(u=n),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===n)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},i.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},i.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},i.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},i.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(g,w){u(w)&&f.setNode(w,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,p.edge(g))});var h={};function x(g){var w=p.parent(g);return w===void 0||f.hasNode(w)?(h[g]=w,w):w in h?h[w]:x(w)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,x(g))}),f},i.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(x,g){return h.length>1?p.setEdge(x,g,f):p.setEdge(x,g),g}),this},i.prototype.setEdge=function(){var u,f,p,h,x=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(u=g.v,f=g.w,p=g.name,arguments.length===2&&(h=arguments[1],x=!0)):(u=g,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],x=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var w=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,w))return x&&(this._edgeLabels[w]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[w]=x?h:this._defaultEdgeLabelFn(u,f,p);var v=c(this._isDirected,u,f,p);return u=v.v,f=v.w,Object.freeze(v),this._edgeObjs[w]=v,s(this._preds[f],u),s(this._sucs[u],f),this._in[f][w]=v,this._out[u][w]=v,this._edgeCount++,this},i.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},i.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),x=this._edgeObjs[h];return x&&(u=x.v,f=x.w,delete this._edgeLabels[h],delete this._edgeObjs[h],o(this._preds[f],u),o(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},i.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.v===f}):h}},i.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.w===f}):h}},i.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function s(u,f){u[f]?u[f]++:u[f]=1}function o(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var x=""+f,g=""+p;if(!u&&x>g){var w=x;x=g,g=w}return x+r+g+r+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var x=""+f,g=""+p;if(!u&&x>g){var w=x;x=g,g=w}var v={v:x,w:g};return h&&(v.name=h),v}function d(u,f){return l(u,f.v,f.w,f.name)}return $h}var Bh,v2;function F8(){return v2||(v2=1,Bh="2.1.8"),Bh}var Hh,x2;function z8(){return x2||(x2=1,Hh={Graph:gy(),version:F8()}),Hh}var Wh,y2;function q8(){if(y2)return Wh;y2=1;var e=bn(),t=gy();Wh={write:n,read:s};function n(o){var l={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:r(o),edges:i(o)};return e.isUndefined(o.graph())||(l.value=e.clone(o.graph())),l}function r(o){return e.map(o.nodes(),function(l){var c=o.node(l),d=o.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function i(o){return e.map(o.edges(),function(l){var c=o.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function s(o){var l=new t(o.options).setGraph(o.value);return e.each(o.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(o.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Wh}var Uh,b2;function $8(){if(b2)return Uh;b2=1;var e=bn();Uh=t;function t(n){var r={},i=[],s;function o(l){e.has(r,l)||(r[l]=!0,s.push(l),e.each(n.successors(l),o),e.each(n.predecessors(l),o))}return e.each(n.nodes(),function(l){s=[],o(l),s.length&&i.push(s)}),i}return Uh}var Vh,w2;function uT(){if(w2)return Vh;w2=1;var e=bn();Vh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(n){return n.key})},t.prototype.has=function(n){return e.has(this._keyIndices,n)},t.prototype.priority=function(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(n,r){var i=this._keyIndices;if(n=String(n),!e.has(i,n)){var s=this._arr,o=s.length;return i[n]=o,s.push({key:n,priority:r}),this._decrease(o),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key},t.prototype.decrease=function(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)},t.prototype._heapify=function(n){var r=this._arr,i=2*n,s=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,s<r.length&&(o=r[s].priority<r[o].priority?s:o),o!==n&&(this._swap(n,o),this._heapify(o)))},t.prototype._decrease=function(n){for(var r=this._arr,i=r[n].priority,s;n!==0&&(s=n>>1,!(r[s].priority<i));)this._swap(n,s),n=s},t.prototype._swap=function(n,r){var i=this._arr,s=this._keyIndices,o=i[n],l=i[r];i[n]=l,i[r]=o,s[l.key]=n,s[o.key]=r},Vh}var Gh,_2;function dT(){if(_2)return Gh;_2=1;var e=bn(),t=uT();Gh=r;var n=e.constant(1);function r(s,o,l,c){return i(s,String(o),l||n,c||function(d){return s.outEdges(d)})}function i(s,o,l,c){var d={},u=new t,f,p,h=function(x){var g=x.v!==f?x.v:x.w,w=d[g],v=l(x),y=p.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+x+" Weight: "+v);y<w.distance&&(w.distance=y,w.predecessor=f,u.decrease(g,y))};for(s.nodes().forEach(function(x){var g=x===o?0:Number.POSITIVE_INFINITY;d[x]={distance:g},u.add(x,g)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return Gh}var Kh,j2;function B8(){if(j2)return Kh;j2=1;var e=dT(),t=bn();Kh=n;function n(r,i,s){return t.transform(r.nodes(),function(o,l){o[l]=e(r,l,i,s)},{})}return Kh}var Yh,S2;function fT(){if(S2)return Yh;S2=1;var e=bn();Yh=t;function t(n){var r=0,i=[],s={},o=[];function l(c){var d=s[c]={onStack:!0,lowlink:r,index:r++};if(i.push(c),n.successors(c).forEach(function(p){e.has(s,p)?s[p].onStack&&(d.lowlink=Math.min(d.lowlink,s[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,s[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=i.pop(),s[f].onStack=!1,u.push(f);while(c!==f);o.push(u)}}return n.nodes().forEach(function(c){e.has(s,c)||l(c)}),o}return Yh}var Xh,k2;function H8(){if(k2)return Xh;k2=1;var e=bn(),t=fT();Xh=n;function n(r){return e.filter(t(r),function(i){return i.length>1||i.length===1&&r.hasEdge(i[0],i[0])})}return Xh}var Qh,N2;function W8(){if(N2)return Qh;N2=1;var e=bn();Qh=n;var t=e.constant(1);function n(i,s,o){return r(i,s||t,o||function(l){return i.outEdges(l)})}function r(i,s,o){var l={},c=i.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),o(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=s(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var x=p[d],g=u[h],w=p[h],v=x.distance+g.distance;v<w.distance&&(w.distance=v,w.predecessor=g.predecessor)})})}),l}return Qh}var Zh,C2;function pT(){if(C2)return Zh;C2=1;var e=bn();Zh=t,t.CycleException=n;function t(r){var i={},s={},o=[];function l(c){if(e.has(s,c))throw new n;e.has(i,c)||(s[c]=!0,i[c]=!0,e.each(r.predecessors(c),l),delete s[c],o.push(c))}if(e.each(r.sinks(),l),e.size(i)!==r.nodeCount())throw new n;return o}function n(){}return n.prototype=new Error,Zh}var Jh,E2;function U8(){if(E2)return Jh;E2=1;var e=pT();Jh=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return Jh}var em,T2;function hT(){if(T2)return em;T2=1;var e=bn();em=t;function t(r,i,s){e.isArray(i)||(i=[i]);var o=(r.isDirected()?r.successors:r.neighbors).bind(r),l=[],c={};return e.each(i,function(d){if(!r.hasNode(d))throw new Error("Graph does not have node: "+d);n(r,d,s==="post",c,o,l)}),l}function n(r,i,s,o,l,c){e.has(o,i)||(o[i]=!0,s||c.push(i),e.each(l(i),function(d){n(r,d,s,o,l,c)}),s&&c.push(i))}return em}var tm,R2;function V8(){if(R2)return tm;R2=1;var e=hT();tm=t;function t(n,r){return e(n,r,"post")}return tm}var nm,A2;function G8(){if(A2)return nm;A2=1;var e=hT();nm=t;function t(n,r){return e(n,r,"pre")}return nm}var rm,I2;function K8(){if(I2)return rm;I2=1;var e=bn(),t=gy(),n=uT();rm=r;function r(i,s){var o=new t,l={},c=new n,d;function u(p){var h=p.v===d?p.w:p.v,x=c.priority(h);if(x!==void 0){var g=s(p);g<x&&(l[h]=d,c.decrease(h,g))}}if(i.nodeCount()===0)return o;e.each(i.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),o.setNode(p)}),c.decrease(i.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))o.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+i);f=!0}i.nodeEdges(d).forEach(u)}return o}return rm}var im,M2;function Y8(){return M2||(M2=1,im={components:$8(),dijkstra:dT(),dijkstraAll:B8(),findCycles:H8(),floydWarshall:W8(),isAcyclic:U8(),postorder:V8(),preorder:G8(),prim:K8(),tarjan:fT(),topsort:pT()}),im}var sm,P2;function X8(){if(P2)return sm;P2=1;var e=z8();return sm={Graph:e.Graph,json:q8(),alg:Y8(),version:e.version},sm}var uc;if(typeof ey=="function")try{uc=X8()}catch{}uc||(uc=window.graphlib);var On=uc,om,O2;function Q8(){if(O2)return om;O2=1;var e=zE(),t=1,n=4;function r(i){return e(i,t|n)}return om=r,om}var am,D2;function hu(){if(D2)return am;D2=1;var e=As(),t=xr(),n=su(),r=yn();function i(s,o,l){if(!r(l))return!1;var c=typeof o;return(c=="number"?t(l)&&n(o,l.length):c=="string"&&o in l)?e(l[o],s):!1}return am=i,am}var lm,L2;function Z8(){if(L2)return lm;L2=1;var e=pu(),t=As(),n=hu(),r=Ai(),i=Object.prototype,s=i.hasOwnProperty,o=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&n(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=r(p),x=-1,g=h.length;++x<g;){var w=h[x],v=l[w];(v===void 0||t(v,i[w])&&!s.call(l,w))&&(l[w]=p[w])}return l});return lm=o,lm}var cm,F2;function J8(){if(F2)return cm;F2=1;var e=yr(),t=xr(),n=ei();function r(i){return function(s,o,l){var c=Object(s);if(!t(s)){var d=e(o,3);s=n(s),o=function(f){return d(c[f],f,c)}}var u=i(s,o,l);return u>-1?c[d?s[u]:u]:void 0}}return cm=r,cm}var um,z2;function eF(){if(z2)return um;z2=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return um=t,um}var dm,q2;function tF(){if(q2)return dm;q2=1;var e=eF(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return dm=n,dm}var fm,$2;function nF(){if($2)return fm;$2=1;var e=tF(),t=yn(),n=Os(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(n(d))return r;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=s.test(d);return f||o.test(d)?l(d.slice(2),f?2:8):i.test(d)?r:+d}return fm=c,fm}var pm,B2;function mT(){if(B2)return pm;B2=1;var e=nF(),t=1/0,n=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var s=i<0?-1:1;return s*n}return i===i?i:0}return pm=r,pm}var hm,H2;function rF(){if(H2)return hm;H2=1;var e=mT();function t(n){var r=e(n),i=r%1;return r===r?i?r-i:r:0}return hm=t,hm}var mm,W2;function iF(){if(W2)return mm;W2=1;var e=aT(),t=yr(),n=rF(),r=Math.max;function i(s,o,l){var c=s==null?0:s.length;if(!c)return-1;var d=l==null?0:n(l);return d<0&&(d=r(c+d,0)),e(s,t(o,3),d)}return mm=i,mm}var gm,U2;function sF(){if(U2)return gm;U2=1;var e=J8(),t=iF(),n=e(t);return gm=n,gm}var vm,V2;function gT(){if(V2)return vm;V2=1;var e=my();function t(n){var r=n==null?0:n.length;return r?e(n,1):[]}return vm=t,vm}var xm,G2;function oF(){if(G2)return xm;G2=1;var e=dy(),t=qE(),n=Ai();function r(i,s){return i==null?i:e(i,t(s),n)}return xm=r,xm}var ym,K2;function aF(){if(K2)return ym;K2=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return ym=e,ym}var bm,Y2;function lF(){if(Y2)return bm;Y2=1;var e=ru(),t=fy(),n=yr();function r(i,s){var o={};return s=n(s,3),t(i,function(l,c,d){e(o,c,s(l,c,d))}),o}return bm=r,bm}var wm,X2;function vy(){if(X2)return wm;X2=1;var e=Os();function t(n,r,i){for(var s=-1,o=n.length;++s<o;){var l=n[s],c=r(l);if(c!=null&&(d===void 0?c===c&&!e(c):i(c,d)))var d=c,u=l}return u}return wm=t,wm}var _m,Q2;function cF(){if(Q2)return _m;Q2=1;function e(t,n){return t>n}return _m=e,_m}var jm,Z2;function uF(){if(Z2)return jm;Z2=1;var e=vy(),t=cF(),n=Ii();function r(i){return i&&i.length?e(i,n,t):void 0}return jm=r,jm}var Sm,J2;function vT(){if(J2)return Sm;J2=1;var e=ru(),t=As();function n(r,i,s){(s!==void 0&&!t(r[i],s)||s===void 0&&!(i in r))&&e(r,i,s)}return Sm=n,Sm}var km,ej;function dF(){if(ej)return km;ej=1;var e=Ti(),t=lu(),n=Yn(),r="[object Object]",i=Function.prototype,s=Object.prototype,o=i.toString,l=s.hasOwnProperty,c=o.call(Object);function d(u){if(!n(u)||e(u)!=r)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&o.call(p)==c}return km=d,km}var Nm,tj;function xT(){if(tj)return Nm;tj=1;function e(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}return Nm=e,Nm}var Cm,nj;function fF(){if(nj)return Cm;nj=1;var e=ya(),t=Ai();function n(r){return e(r,t(r))}return Cm=n,Cm}var Em,rj;function pF(){if(rj)return Em;rj=1;var e=vT(),t=CE(),n=DE(),r=EE(),i=FE(),s=ba(),o=ot(),l=lT(),c=Ms(),d=xa(),u=yn(),f=dF(),p=wa(),h=xT(),x=fF();function g(w,v,y,b,_,j,k){var N=h(w,y),E=h(v,y),S=k.get(E);if(S){e(w,y,S);return}var R=j?j(N,E,y+"",w,v,k):void 0,T=R===void 0;if(T){var M=o(E),z=!M&&c(E),C=!M&&!z&&p(E);R=E,M||z||C?o(N)?R=N:l(N)?R=r(N):z?(T=!1,R=t(E,!0)):C?(T=!1,R=n(E,!0)):R=[]:f(E)||s(E)?(R=N,s(N)?R=x(N):(!u(N)||d(N))&&(R=i(E))):T=!1}T&&(k.set(E,R),_(R,E,b,j,k),k.delete(E)),e(w,y,R)}return Em=g,Em}var Tm,ij;function hF(){if(ij)return Tm;ij=1;var e=nu(),t=vT(),n=dy(),r=pF(),i=yn(),s=Ai(),o=xT();function l(c,d,u,f,p){c!==d&&n(d,function(h,x){if(p||(p=new e),i(h))r(c,d,x,u,l,f,p);else{var g=f?f(o(c,x),h,x+"",c,d,p):void 0;g===void 0&&(g=h),t(c,x,g)}},s)}return Tm=l,Tm}var Rm,sj;function mF(){if(sj)return Rm;sj=1;var e=pu(),t=hu();function n(r){return e(function(i,s){var o=-1,l=s.length,c=l>1?s[l-1]:void 0,d=l>2?s[2]:void 0;for(c=r.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(s[0],s[1],d)&&(c=l<3?void 0:c,l=1),i=Object(i);++o<l;){var u=s[o];u&&r(i,u,o,c)}return i})}return Rm=n,Rm}var Am,oj;function gF(){if(oj)return Am;oj=1;var e=hF(),t=mF(),n=t(function(r,i,s){e(r,i,s)});return Am=n,Am}var Im,aj;function yT(){if(aj)return Im;aj=1;function e(t,n){return t<n}return Im=e,Im}var Mm,lj;function vF(){if(lj)return Mm;lj=1;var e=vy(),t=yT(),n=Ii();function r(i){return i&&i.length?e(i,n,t):void 0}return Mm=r,Mm}var Pm,cj;function xF(){if(cj)return Pm;cj=1;var e=vy(),t=yr(),n=yT();function r(i,s){return i&&i.length?e(i,t(s,2),n):void 0}return Pm=r,Pm}var Om,uj;function yF(){if(uj)return Om;uj=1;var e=Pn(),t=function(){return e.Date.now()};return Om=t,Om}var Dm,dj;function bF(){if(dj)return Dm;dj=1;var e=iu(),t=du(),n=su(),r=yn(),i=_a();function s(o,l,c,d){if(!r(o))return o;l=t(l,o);for(var u=-1,f=l.length,p=f-1,h=o;h!=null&&++u<f;){var x=i(l[u]),g=c;if(x==="__proto__"||x==="constructor"||x==="prototype")return o;if(u!=p){var w=h[x];g=d?d(w,x,h):void 0,g===void 0&&(g=r(w)?w:n(l[u+1])?[]:{})}e(h,x,g),h=h[x]}return o}return Dm=s,Dm}var Lm,fj;function wF(){if(fj)return Lm;fj=1;var e=fu(),t=bF(),n=du();function r(i,s,o){for(var l=-1,c=s.length,d={};++l<c;){var u=s[l],f=e(i,u);o(f,u)&&t(d,n(u,i),f)}return d}return Lm=r,Lm}var Fm,pj;function _F(){if(pj)return Fm;pj=1;var e=wF(),t=QE();function n(r,i){return e(r,i,function(s,o){return t(r,o)})}return Fm=n,Fm}var zm,hj;function jF(){if(hj)return zm;hj=1;var e=gT(),t=sT(),n=oT();function r(i){return n(t(i,void 0,e),i+"")}return zm=r,zm}var qm,mj;function SF(){if(mj)return qm;mj=1;var e=_F(),t=jF(),n=t(function(r,i){return r==null?{}:e(r,i)});return qm=n,qm}var $m,gj;function kF(){if(gj)return $m;gj=1;var e=Math.ceil,t=Math.max;function n(r,i,s,o){for(var l=-1,c=t(e((i-r)/(s||1)),0),d=Array(c);c--;)d[o?c:++l]=r,r+=s;return d}return $m=n,$m}var Bm,vj;function NF(){if(vj)return Bm;vj=1;var e=kF(),t=hu(),n=mT();function r(i){return function(s,o,l){return l&&typeof l!="number"&&t(s,o,l)&&(o=l=void 0),s=n(s),o===void 0?(o=s,s=0):o=n(o),l=l===void 0?s<o?1:-1:n(l),e(s,o,l,i)}}return Bm=r,Bm}var Hm,xj;function CF(){if(xj)return Hm;xj=1;var e=NF(),t=e();return Hm=t,Hm}var Wm,yj;function EF(){if(yj)return Wm;yj=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return Wm=e,Wm}var Um,bj;function TF(){if(bj)return Um;bj=1;var e=Os();function t(n,r){if(n!==r){var i=n!==void 0,s=n===null,o=n===n,l=e(n),c=r!==void 0,d=r===null,u=r===r,f=e(r);if(!d&&!f&&!l&&n>r||l&&c&&u&&!d&&!f||s&&c&&u||!i&&u||!o)return 1;if(!s&&!l&&!f&&n<r||f&&i&&o&&!s&&!l||d&&i&&o||!c&&o||!u)return-1}return 0}return Um=t,Um}var Vm,wj;function RF(){if(wj)return Vm;wj=1;var e=TF();function t(n,r,i){for(var s=-1,o=n.criteria,l=r.criteria,c=o.length,d=i.length;++s<c;){var u=e(o[s],l[s]);if(u){if(s>=d)return u;var f=i[s];return u*(f=="desc"?-1:1)}}return n.index-r.index}return Vm=t,Vm}var Gm,_j;function AF(){if(_j)return Gm;_j=1;var e=uu(),t=fu(),n=yr(),r=nT(),i=EF(),s=ou(),o=RF(),l=Ii(),c=ot();function d(u,f,p){f.length?f=e(f,function(g){return c(g)?function(w){return t(w,g.length===1?g[0]:g)}:g}):f=[l];var h=-1;f=e(f,s(n));var x=r(u,function(g,w,v){var y=e(f,function(b){return b(g)});return{criteria:y,index:++h,value:g}});return i(x,function(g,w){return o(g,w,p)})}return Gm=d,Gm}var Km,jj;function IF(){if(jj)return Km;jj=1;var e=my(),t=AF(),n=pu(),r=hu(),i=n(function(s,o){if(s==null)return[];var l=o.length;return l>1&&r(s,o[0],o[1])?o=[]:l>2&&r(o[0],o[1],o[2])&&(o=[o[0]]),t(s,e(o,1),[])});return Km=i,Km}var Ym,Sj;function MF(){if(Sj)return Ym;Sj=1;var e=YE(),t=0;function n(r){var i=++t;return e(r)+i}return Ym=n,Ym}var Xm,kj;function PF(){if(kj)return Xm;kj=1;function e(t,n,r){for(var i=-1,s=t.length,o=n.length,l={};++i<s;){var c=i<o?n[i]:void 0;r(l,t[i],c)}return l}return Xm=e,Xm}var Qm,Nj;function OF(){if(Nj)return Qm;Nj=1;var e=iu(),t=PF();function n(r,i){return t(r||[],i||[],e)}return Qm=n,Qm}var dc;if(typeof ey=="function")try{dc={cloneDeep:Q8(),constant:uy(),defaults:Z8(),each:BE(),filter:JE(),find:sF(),flatten:gT(),forEach:$E(),forIn:oF(),has:eT(),isUndefined:tT(),last:aF(),map:rT(),mapValues:lF(),max:uF(),merge:gF(),min:vF(),minBy:xF(),now:yF(),pick:SF(),range:CF(),reduce:iT(),sortBy:IF(),uniqueId:MF(),values:cT(),zipObject:OF()}}catch{}dc||(dc=window._);var Qe=dc,DF=mu;function mu(){var e={};e._next=e._prev=e,this._sentinel=e}mu.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return bT(t),t};mu.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&bT(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};mu.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,LF)),n=n._prev;return"["+e.join(", ")+"]"};function bT(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function LF(e,t){if(e!=="_next"&&e!=="_prev")return t}var sr=Qe,FF=On.Graph,zF=DF,qF=BF,$F=sr.constant(1);function BF(e,t){if(e.nodeCount()<=1)return[];var n=WF(e,t||$F),r=HF(n.graph,n.buckets,n.zeroIdx);return sr.flatten(sr.map(r,function(i){return e.outEdges(i.v,i.w)}),!0)}function HF(e,t,n){for(var r=[],i=t[t.length-1],s=t[0],o;e.nodeCount();){for(;o=s.dequeue();)Zm(e,t,n,o);for(;o=i.dequeue();)Zm(e,t,n,o);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(o=t[l].dequeue(),o){r=r.concat(Zm(e,t,n,o,!0));break}}}return r}function Zm(e,t,n,r,i){var s=i?[]:void 0;return sr.forEach(e.inEdges(r.v),function(o){var l=e.edge(o),c=e.node(o.v);i&&s.push({v:o.v,w:o.w}),c.out-=l,Tv(t,n,c)}),sr.forEach(e.outEdges(r.v),function(o){var l=e.edge(o),c=o.w,d=e.node(c);d.in-=l,Tv(t,n,d)}),e.removeNode(r.v),s}function WF(e,t){var n=new FF,r=0,i=0;sr.forEach(e.nodes(),function(l){n.setNode(l,{v:l,in:0,out:0})}),sr.forEach(e.edges(),function(l){var c=n.edge(l.v,l.w)||0,d=t(l),u=c+d;n.setEdge(l.v,l.w,u),i=Math.max(i,n.node(l.v).out+=d),r=Math.max(r,n.node(l.w).in+=d)});var s=sr.range(i+r+3).map(function(){return new zF}),o=r+1;return sr.forEach(n.nodes(),function(l){Tv(s,o,n.node(l))}),{graph:n,buckets:s,zeroIdx:o}}function Tv(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var hi=Qe,UF=qF,VF={run:GF,undo:YF};function GF(e){var t=e.graph().acyclicer==="greedy"?UF(e,n(e)):KF(e);hi.forEach(t,function(r){var i=e.edge(r);e.removeEdge(r),i.forwardName=r.name,i.reversed=!0,e.setEdge(r.w,r.v,i,hi.uniqueId("rev"))});function n(r){return function(i){return r.edge(i).weight}}}function KF(e){var t=[],n={},r={};function i(s){hi.has(r,s)||(r[s]=!0,n[s]=!0,hi.forEach(e.outEdges(s),function(o){hi.has(n,o.w)?t.push(o):i(o.w)}),delete n[s])}return hi.forEach(e.nodes(),i),t}function YF(e){hi.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var Le=Qe,wT=On.Graph,Gt={addDummyNode:_T,simplify:XF,asNonCompoundGraph:QF,successorWeights:ZF,predecessorWeights:JF,intersectRect:ez,buildLayerMatrix:tz,normalizeRanks:nz,removeEmptyRanks:rz,addBorderNode:iz,maxRank:jT,partition:sz,time:oz,notime:az};function _T(e,t,n,r){var i;do i=Le.uniqueId(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function XF(e){var t=new wT().setGraph(e.graph());return Le.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),Le.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function QF(e){var t=new wT({multigraph:e.isMultigraph()}).setGraph(e.graph());return Le.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),Le.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function ZF(e){var t=Le.map(e.nodes(),function(n){var r={};return Le.forEach(e.outEdges(n),function(i){r[i.w]=(r[i.w]||0)+e.edge(i).weight}),r});return Le.zipObject(e.nodes(),t)}function JF(e){var t=Le.map(e.nodes(),function(n){var r={};return Le.forEach(e.inEdges(n),function(i){r[i.v]=(r[i.v]||0)+e.edge(i).weight}),r});return Le.zipObject(e.nodes(),t)}function ez(e,t){var n=e.x,r=e.y,i=t.x-n,s=t.y-r,o=e.width/2,l=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(s)*o>Math.abs(i)*l?(s<0&&(l=-l),c=l*i/s,d=l):(i<0&&(o=-o),c=o,d=o*s/i),{x:n+c,y:r+d}}function tz(e){var t=Le.map(Le.range(jT(e)+1),function(){return[]});return Le.forEach(e.nodes(),function(n){var r=e.node(n),i=r.rank;Le.isUndefined(i)||(t[i][r.order]=n)}),t}function nz(e){var t=Le.min(Le.map(e.nodes(),function(n){return e.node(n).rank}));Le.forEach(e.nodes(),function(n){var r=e.node(n);Le.has(r,"rank")&&(r.rank-=t)})}function rz(e){var t=Le.min(Le.map(e.nodes(),function(s){return e.node(s).rank})),n=[];Le.forEach(e.nodes(),function(s){var o=e.node(s).rank-t;n[o]||(n[o]=[]),n[o].push(s)});var r=0,i=e.graph().nodeRankFactor;Le.forEach(n,function(s,o){Le.isUndefined(s)&&o%i!==0?--r:r&&Le.forEach(s,function(l){e.node(l).rank+=r})})}function iz(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),_T(e,"border",i,t)}function jT(e){return Le.max(Le.map(e.nodes(),function(t){var n=e.node(t).rank;if(!Le.isUndefined(n))return n}))}function sz(e,t){var n={lhs:[],rhs:[]};return Le.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function oz(e,t){var n=Le.now();try{return t()}finally{console.log(e+" time: "+(Le.now()-n)+"ms")}}function az(e,t){return t()}var ST=Qe,lz=Gt,cz={run:uz,undo:fz};function uz(e){e.graph().dummyChains=[],ST.forEach(e.edges(),function(t){dz(e,t)})}function dz(e,t){var n=t.v,r=e.node(n).rank,i=t.w,s=e.node(i).rank,o=t.name,l=e.edge(t),c=l.labelRank;if(s!==r+1){e.removeEdge(t);var d,u,f;for(f=0,++r;r<s;++f,++r)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:r},d=lz.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(n,d,{weight:l.weight},o),f===0&&e.graph().dummyChains.push(d),n=d;e.setEdge(n,i,{weight:l.weight},o)}}function fz(e){ST.forEach(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}var tl=Qe,gu={longestPath:pz,slack:hz};function pz(e){var t={};function n(r){var i=e.node(r);if(tl.has(t,r))return i.rank;t[r]=!0;var s=tl.min(tl.map(e.outEdges(r),function(o){return n(o.w)-e.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}tl.forEach(e.sources(),n)}function hz(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var fc=Qe,mz=On.Graph,pc=gu.slack,kT=gz;function gz(e){var t=new mz({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var i,s;vz(t,e)<r;)i=xz(t,e),s=t.hasNode(i.v)?pc(e,i):-pc(e,i),yz(t,e,s);return t}function vz(e,t){function n(r){fc.forEach(t.nodeEdges(r),function(i){var s=i.v,o=r===s?i.w:s;!e.hasNode(o)&&!pc(t,i)&&(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})}return fc.forEach(e.nodes(),n),e.nodeCount()}function xz(e,t){return fc.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return pc(t,n)})}function yz(e,t,n){fc.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var mr=Qe,bz=kT,wz=gu.slack,_z=gu.longestPath,jz=On.alg.preorder,Sz=On.alg.postorder,kz=Gt.simplify,Nz=Mi;Mi.initLowLimValues=yy;Mi.initCutValues=xy;Mi.calcCutValue=NT;Mi.leaveEdge=ET;Mi.enterEdge=TT;Mi.exchangeEdges=RT;function Mi(e){e=kz(e),_z(e);var t=bz(e);yy(t),xy(t,e);for(var n,r;n=ET(t);)r=TT(t,e,n),RT(t,e,n,r)}function xy(e,t){var n=Sz(e,e.nodes());n=n.slice(0,n.length-1),mr.forEach(n,function(r){Cz(e,t,r)})}function Cz(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=NT(e,t,n)}function NT(e,t,n){var r=e.node(n),i=r.parent,s=!0,o=t.edge(n,i),l=0;return o||(s=!1,o=t.edge(i,n)),l=o.weight,mr.forEach(t.nodeEdges(n),function(c){var d=c.v===n,u=d?c.w:c.v;if(u!==i){var f=d===s,p=t.edge(c).weight;if(l+=f?p:-p,Tz(e,n,u)){var h=e.edge(n,u).cutvalue;l+=f?-h:h}}}),l}function yy(e,t){arguments.length<2&&(t=e.nodes()[0]),CT(e,{},1,t)}function CT(e,t,n,r,i){var s=n,o=e.node(r);return t[r]=!0,mr.forEach(e.neighbors(r),function(l){mr.has(t,l)||(n=CT(e,t,n,l,r))}),o.low=s,o.lim=n++,i?o.parent=i:delete o.parent,n}function ET(e){return mr.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function TT(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var s=e.node(r),o=e.node(i),l=s,c=!1;s.lim>o.lim&&(l=o,c=!0);var d=mr.filter(t.edges(),function(u){return c===Cj(e,e.node(u.v),l)&&c!==Cj(e,e.node(u.w),l)});return mr.minBy(d,function(u){return wz(t,u)})}function RT(e,t,n,r){var i=n.v,s=n.w;e.removeEdge(i,s),e.setEdge(r.v,r.w,{}),yy(e),xy(e,t),Ez(e,t)}function Ez(e,t){var n=mr.find(e.nodes(),function(i){return!t.node(i).parent}),r=jz(e,n);r=r.slice(1),mr.forEach(r,function(i){var s=e.node(i).parent,o=t.edge(i,s),l=!1;o||(o=t.edge(s,i),l=!0),t.node(i).rank=t.node(s).rank+(l?o.minlen:-o.minlen)})}function Tz(e,t,n){return e.hasEdge(t,n)}function Cj(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var Rz=gu,AT=Rz.longestPath,Az=kT,Iz=Nz,Mz=Pz;function Pz(e){switch(e.graph().ranker){case"network-simplex":Ej(e);break;case"tight-tree":Dz(e);break;case"longest-path":Oz(e);break;default:Ej(e)}}var Oz=AT;function Dz(e){AT(e),Az(e)}function Ej(e){Iz(e)}var Rv=Qe,Lz=Fz;function Fz(e){var t=qz(e);Rv.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,s=zz(e,t,i.v,i.w),o=s.path,l=s.lca,c=0,d=o[c],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(d=o[c])!==l&&e.node(d).maxRank<r.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(d=o[c+1]).minRank<=r.rank;)c++;d=o[c]}e.setParent(n,d),n=e.successors(n)[0]}})}function zz(e,t,n,r){var i=[],s=[],o=Math.min(t[n].low,t[r].low),l=Math.max(t[n].lim,t[r].lim),c,d;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||l>t[c].lim));for(d=c,c=r;(c=e.parent(c))!==d;)s.push(c);return{path:i.concat(s.reverse()),lca:d}}function qz(e){var t={},n=0;function r(i){var s=n;Rv.forEach(e.children(i),r),t[i]={low:s,lim:n++}}return Rv.forEach(e.children(),r),t}var or=Qe,Av=Gt,$z={run:Bz,cleanup:Uz};function Bz(e){var t=Av.addDummyNode(e,"root",{},"_root"),n=Hz(e),r=or.max(or.values(n))-1,i=2*r+1;e.graph().nestingRoot=t,or.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var s=Wz(e)+1;or.forEach(e.children(),function(o){IT(e,t,i,s,r,n,o)}),e.graph().nodeRankFactor=i}function IT(e,t,n,r,i,s,o){var l=e.children(o);if(!l.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:n});return}var c=Av.addBorderNode(e,"_bt"),d=Av.addBorderNode(e,"_bb"),u=e.node(o);e.setParent(c,o),u.borderTop=c,e.setParent(d,o),u.borderBottom=d,or.forEach(l,function(f){IT(e,t,n,r,i,s,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,x=p.borderBottom?p.borderBottom:f,g=p.borderTop?r:2*r,w=h!==x?1:i-s[o]+1;e.setEdge(c,h,{weight:g,minlen:w,nestingEdge:!0}),e.setEdge(x,d,{weight:g,minlen:w,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+s[o]})}function Hz(e){var t={};function n(r,i){var s=e.children(r);s&&s.length&&or.forEach(s,function(o){n(o,i+1)}),t[r]=i}return or.forEach(e.children(),function(r){n(r,1)}),t}function Wz(e){return or.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function Uz(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,or.forEach(e.edges(),function(n){var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}var Jm=Qe,Vz=Gt,Gz=Kz;function Kz(e){function t(n){var r=e.children(n),i=e.node(n);if(r.length&&Jm.forEach(r,t),Jm.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,o=i.maxRank+1;s<o;++s)Tj(e,"borderLeft","_bl",n,i,s),Tj(e,"borderRight","_br",n,i,s)}}Jm.forEach(e.children(),t)}function Tj(e,t,n,r,i,s){var o={width:0,height:0,rank:s,borderType:t},l=i[t][s-1],c=Vz.addDummyNode(e,"border",o,n);i[t][s]=c,e.setParent(c,r),l&&e.setEdge(l,c,{weight:1})}var $n=Qe,Yz={adjust:Xz,undo:Qz};function Xz(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&MT(e)}function Qz(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Zz(e),(t==="lr"||t==="rl")&&(Jz(e),MT(e))}function MT(e){$n.forEach(e.nodes(),function(t){Rj(e.node(t))}),$n.forEach(e.edges(),function(t){Rj(e.edge(t))})}function Rj(e){var t=e.width;e.width=e.height,e.height=t}function Zz(e){$n.forEach(e.nodes(),function(t){eg(e.node(t))}),$n.forEach(e.edges(),function(t){var n=e.edge(t);$n.forEach(n.points,eg),$n.has(n,"y")&&eg(n)})}function eg(e){e.y=-e.y}function Jz(e){$n.forEach(e.nodes(),function(t){tg(e.node(t))}),$n.forEach(e.edges(),function(t){var n=e.edge(t);$n.forEach(n.points,tg),$n.has(n,"x")&&tg(n)})}function tg(e){var t=e.x;e.x=e.y,e.y=t}var Qn=Qe,eq=tq;function tq(e){var t={},n=Qn.filter(e.nodes(),function(l){return!e.children(l).length}),r=Qn.max(Qn.map(n,function(l){return e.node(l).rank})),i=Qn.map(Qn.range(r+1),function(){return[]});function s(l){if(!Qn.has(t,l)){t[l]=!0;var c=e.node(l);i[c.rank].push(l),Qn.forEach(e.successors(l),s)}}var o=Qn.sortBy(n,function(l){return e.node(l).rank});return Qn.forEach(o,s),i}var _r=Qe,nq=rq;function rq(e,t){for(var n=0,r=1;r<t.length;++r)n+=iq(e,t[r-1],t[r]);return n}function iq(e,t,n){for(var r=_r.zipObject(n,_r.map(n,function(d,u){return u})),i=_r.flatten(_r.map(t,function(d){return _r.sortBy(_r.map(e.outEdges(d),function(u){return{pos:r[u.w],weight:e.edge(u).weight}}),"pos")}),!0),s=1;s<n.length;)s<<=1;var o=2*s-1;s-=1;var l=_r.map(new Array(o),function(){return 0}),c=0;return _r.forEach(i.forEach(function(d){var u=d.pos+s;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var Aj=Qe,sq=oq;function oq(e,t){return Aj.map(t,function(n){var r=e.inEdges(n);if(r.length){var i=Aj.reduce(r,function(s,o){var l=e.edge(o),c=e.node(o.v);return{sum:s.sum+l.weight*c.order,weight:s.weight+l.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:n}})}var Jt=Qe,aq=lq;function lq(e,t){var n={};Jt.forEach(e,function(i,s){var o=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};Jt.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),Jt.forEach(t.edges(),function(i){var s=n[i.v],o=n[i.w];!Jt.isUndefined(s)&&!Jt.isUndefined(o)&&(o.indegree++,s.out.push(n[i.w]))});var r=Jt.filter(n,function(i){return!i.indegree});return cq(r)}function cq(e){var t=[];function n(s){return function(o){o.merged||(Jt.isUndefined(o.barycenter)||Jt.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&uq(s,o)}}function r(s){return function(o){o.in.push(s),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),Jt.forEach(i.in.reverse(),n(i)),Jt.forEach(i.out,r(i))}return Jt.map(Jt.filter(t,function(s){return!s.merged}),function(s){return Jt.pick(s,["vs","i","barycenter","weight"])})}function uq(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var mo=Qe,dq=Gt,fq=pq;function pq(e,t){var n=dq.partition(e,function(u){return mo.has(u,"barycenter")}),r=n.lhs,i=mo.sortBy(n.rhs,function(u){return-u.i}),s=[],o=0,l=0,c=0;r.sort(hq(!!t)),c=Ij(s,i,c),mo.forEach(r,function(u){c+=u.vs.length,s.push(u.vs),o+=u.barycenter*u.weight,l+=u.weight,c=Ij(s,i,c)});var d={vs:mo.flatten(s,!0)};return l&&(d.barycenter=o/l,d.weight=l),d}function Ij(e,t,n){for(var r;t.length&&(r=mo.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function hq(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var Ir=Qe,mq=sq,gq=aq,vq=fq,xq=PT;function PT(e,t,n,r){var i=e.children(t),s=e.node(t),o=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,c={};o&&(i=Ir.filter(i,function(x){return x!==o&&x!==l}));var d=mq(e,i);Ir.forEach(d,function(x){if(e.children(x.v).length){var g=PT(e,x.v,n,r);c[x.v]=g,Ir.has(g,"barycenter")&&bq(x,g)}});var u=gq(d,n);yq(u,c);var f=vq(u,r);if(o&&(f.vs=Ir.flatten([o,f.vs,l],!0),e.predecessors(o).length)){var p=e.node(e.predecessors(o)[0]),h=e.node(e.predecessors(l)[0]);Ir.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function yq(e,t){Ir.forEach(e,function(n){n.vs=Ir.flatten(n.vs.map(function(r){return t[r]?t[r].vs:r}),!0)})}function bq(e,t){Ir.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var go=Qe,wq=On.Graph,_q=jq;function jq(e,t,n){var r=Sq(e),i=new wq({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(s){return e.node(s)});return go.forEach(e.nodes(),function(s){var o=e.node(s),l=e.parent(s);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(s),i.setParent(s,l||r),go.forEach(e[n](s),function(c){var d=c.v===s?c.w:c.v,u=i.edge(d,s),f=go.isUndefined(u)?0:u.weight;i.setEdge(d,s,{weight:e.edge(c).weight+f})}),go.has(o,"minRank")&&i.setNode(s,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function Sq(e){for(var t;e.hasNode(t=go.uniqueId("_root")););return t}var kq=Qe,Nq=Cq;function Cq(e,t,n){var r={},i;kq.forEach(n,function(s){for(var o=e.parent(s),l,c;o;){if(l=e.parent(o),l?(c=r[l],r[l]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=l}})}var Ur=Qe,Eq=eq,Tq=nq,Rq=xq,Aq=_q,Iq=Nq,Mq=On.Graph,Mj=Gt,Pq=Oq;function Oq(e){var t=Mj.maxRank(e),n=Pj(e,Ur.range(1,t+1),"inEdges"),r=Pj(e,Ur.range(t-1,-1,-1),"outEdges"),i=Eq(e);Oj(e,i);for(var s=Number.POSITIVE_INFINITY,o,l=0,c=0;c<4;++l,++c){Dq(l%2?n:r,l%4>=2),i=Mj.buildLayerMatrix(e);var d=Tq(e,i);d<s&&(c=0,o=Ur.cloneDeep(i),s=d)}Oj(e,o)}function Pj(e,t,n){return Ur.map(t,function(r){return Aq(e,r,n)})}function Dq(e,t){var n=new Mq;Ur.forEach(e,function(r){var i=r.graph().root,s=Rq(r,i,n,t);Ur.forEach(s.vs,function(o,l){r.node(o).order=l}),Iq(r,n,s.vs)})}function Oj(e,t){Ur.forEach(t,function(n){Ur.forEach(n,function(r,i){e.node(r).order=i})})}var be=Qe,Lq=On.Graph,Fq=Gt,zq={positionX:Xq};function qq(e,t){var n={};function r(i,s){var o=0,l=0,c=i.length,d=be.last(s);return be.forEach(s,function(u,f){var p=Bq(e,u),h=p?e.node(p).order:c;(p||u===d)&&(be.forEach(s.slice(l,f+1),function(x){be.forEach(e.predecessors(x),function(g){var w=e.node(g),v=w.order;(v<o||h<v)&&!(w.dummy&&e.node(x).dummy)&&OT(n,g,x)})}),l=f+1,o=h)}),s}return be.reduce(t,r),n}function $q(e,t){var n={};function r(s,o,l,c,d){var u;be.forEach(be.range(o,l),function(f){u=s[f],e.node(u).dummy&&be.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&OT(n,p,u)})})}function i(s,o){var l=-1,c,d=0;return be.forEach(o,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,r(o,d,f,l,c),d=f,l=c)}r(o,d,o.length,c,s.length)}),o}return be.reduce(t,i),n}function Bq(e,t){if(e.node(t).dummy)return be.find(e.predecessors(t),function(n){return e.node(n).dummy})}function OT(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function Hq(e,t,n){if(t>n){var r=t;t=n,n=r}return be.has(e[t],n)}function Wq(e,t,n,r){var i={},s={},o={};return be.forEach(t,function(l){be.forEach(l,function(c,d){i[c]=c,s[c]=c,o[c]=d})}),be.forEach(t,function(l){var c=-1;be.forEach(l,function(d){var u=r(d);if(u.length){u=be.sortBy(u,function(g){return o[g]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var x=u[p];s[d]===d&&c<o[x]&&!Hq(n,d,x)&&(s[x]=d,s[d]=i[d]=i[x],c=o[x])}}})}),{root:i,align:s}}function Uq(e,t,n,r,i){var s={},o=Vq(e,t,n,i),l=i?"borderLeft":"borderRight";function c(f,p){for(var h=o.nodes(),x=h.pop(),g={};x;)g[x]?f(x):(g[x]=!0,h.push(x),h=h.concat(p(x))),x=h.pop()}function d(f){s[f]=o.inEdges(f).reduce(function(p,h){return Math.max(p,s[h.v]+o.edge(h))},0)}function u(f){var p=o.outEdges(f).reduce(function(x,g){return Math.min(x,s[g.w]-o.edge(g))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(s[f]=Math.max(s[f],p))}return c(d,o.predecessors.bind(o)),c(u,o.successors.bind(o)),be.forEach(r,function(f){s[f]=s[n[f]]}),s}function Vq(e,t,n,r){var i=new Lq,s=e.graph(),o=Qq(s.nodesep,s.edgesep,r);return be.forEach(t,function(l){var c;be.forEach(l,function(d){var u=n[d];if(i.setNode(u),c){var f=n[c],p=i.edge(f,u);i.setEdge(f,u,Math.max(o(e,d,c),p||0))}c=d})}),i}function Gq(e,t){return be.minBy(be.values(t),function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return be.forIn(n,function(s,o){var l=Zq(e,o)/2;r=Math.max(s+l,r),i=Math.min(s-l,i)}),r-i})}function Kq(e,t){var n=be.values(t),r=be.min(n),i=be.max(n);be.forEach(["u","d"],function(s){be.forEach(["l","r"],function(o){var l=s+o,c=e[l],d;if(c!==t){var u=be.values(c);d=o==="l"?r-be.min(u):i-be.max(u),d&&(e[l]=be.mapValues(c,function(f){return f+d}))}})})}function Yq(e,t){return be.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=be.sortBy(be.map(e,r));return(i[1]+i[2])/2})}function Xq(e){var t=Fq.buildLayerMatrix(e),n=be.merge(qq(e,t),$q(e,t)),r={},i;be.forEach(["u","d"],function(o){i=o==="u"?t:be.values(t).reverse(),be.forEach(["l","r"],function(l){l==="r"&&(i=be.map(i,function(f){return be.values(f).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),d=Wq(e,i,n,c),u=Uq(e,i,d.root,d.align,l==="r");l==="r"&&(u=be.mapValues(u,function(f){return-f})),r[o+l]=u})});var s=Gq(e,r);return Kq(r,s),Yq(r,e.graph().align)}function Qq(e,t,n){return function(r,i,s){var o=r.node(i),l=r.node(s),c=0,d;if(c+=o.width/2,be.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":d=-o.width/2;break;case"r":d=o.width/2;break}if(d&&(c+=n?d:-d),d=0,c+=(o.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,be.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=n?d:-d),d=0,c}}function Zq(e,t){return e.node(t).width}var vo=Qe,DT=Gt,Jq=zq.positionX,e$=t$;function t$(e){e=DT.asNonCompoundGraph(e),n$(e),vo.forEach(Jq(e),function(t,n){e.node(n).x=t})}function n$(e){var t=DT.buildLayerMatrix(e),n=e.graph().ranksep,r=0;vo.forEach(t,function(i){var s=vo.max(vo.map(i,function(o){return e.node(o).height}));vo.forEach(i,function(o){e.node(o).y=r+s/2}),r+=s+n})}var Se=Qe,Dj=VF,Lj=cz,r$=Mz,i$=Gt.normalizeRanks,s$=Lz,o$=Gt.removeEmptyRanks,Fj=$z,a$=Gz,zj=Yz,l$=Pq,c$=e$,Yr=Gt,u$=On.Graph,d$=f$;function f$(e,t){var n=t&&t.debugTiming?Yr.time:Yr.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return j$(e)});n("  runLayout",function(){p$(r,n)}),n("  updateInputGraph",function(){h$(e,r)})})}function p$(e,t){t("    makeSpaceForEdgeLabels",function(){S$(e)}),t("    removeSelfEdges",function(){M$(e)}),t("    acyclic",function(){Dj.run(e)}),t("    nestingGraph.run",function(){Fj.run(e)}),t("    rank",function(){r$(Yr.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){k$(e)}),t("    removeEmptyRanks",function(){o$(e)}),t("    nestingGraph.cleanup",function(){Fj.cleanup(e)}),t("    normalizeRanks",function(){i$(e)}),t("    assignRankMinMax",function(){N$(e)}),t("    removeEdgeLabelProxies",function(){C$(e)}),t("    normalize.run",function(){Lj.run(e)}),t("    parentDummyChains",function(){s$(e)}),t("    addBorderSegments",function(){a$(e)}),t("    order",function(){l$(e)}),t("    insertSelfEdges",function(){P$(e)}),t("    adjustCoordinateSystem",function(){zj.adjust(e)}),t("    position",function(){c$(e)}),t("    positionSelfEdges",function(){O$(e)}),t("    removeBorderNodes",function(){I$(e)}),t("    normalize.undo",function(){Lj.undo(e)}),t("    fixupEdgeLabelCoords",function(){R$(e)}),t("    undoCoordinateSystem",function(){zj.undo(e)}),t("    translateGraph",function(){E$(e)}),t("    assignNodeIntersects",function(){T$(e)}),t("    reversePoints",function(){A$(e)}),t("    acyclic.undo",function(){Dj.undo(e)})}function h$(e,t){Se.forEach(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),Se.forEach(e.edges(),function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,Se.has(i,"x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var m$=["nodesep","edgesep","ranksep","marginx","marginy"],g$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},v$=["acyclicer","ranker","rankdir","align"],x$=["width","height"],y$={width:0,height:0},b$=["minlen","weight","width","height","labeloffset"],w$={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},_$=["labelpos"];function j$(e){var t=new u$({multigraph:!0,compound:!0}),n=rg(e.graph());return t.setGraph(Se.merge({},g$,ng(n,m$),Se.pick(n,v$))),Se.forEach(e.nodes(),function(r){var i=rg(e.node(r));t.setNode(r,Se.defaults(ng(i,x$),y$)),t.setParent(r,e.parent(r))}),Se.forEach(e.edges(),function(r){var i=rg(e.edge(r));t.setEdge(r,Se.merge({},w$,ng(i,b$),Se.pick(i,_$)))}),t}function S$(e){var t=e.graph();t.ranksep/=2,Se.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function k$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-r.rank)/2+r.rank,e:t};Yr.addDummyNode(e,"edge-proxy",s,"_ep")}})}function N$(e){var t=0;Se.forEach(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Se.max(t,r.maxRank))}),e.graph().maxRank=t}function C$(e){Se.forEach(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function E$(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,s=e.graph(),o=s.marginx||0,l=s.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),n=Math.max(n,u+p/2),r=Math.min(r,f-h/2),i=Math.max(i,f+h/2)}Se.forEach(e.nodes(),function(d){c(e.node(d))}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.has(u,"x")&&c(u)}),t-=o,r-=l,Se.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=r}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.forEach(u.points,function(f){f.x-=t,f.y-=r}),Se.has(u,"x")&&(u.x-=t),Se.has(u,"y")&&(u.y-=r)}),s.width=n-t+o,s.height=i-r+l}function T$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),s,o;n.points?(s=n.points[0],o=n.points[n.points.length-1]):(n.points=[],s=i,o=r),n.points.unshift(Yr.intersectRect(r,s)),n.points.push(Yr.intersectRect(i,o))})}function R$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t);if(Se.has(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function A$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function I$(e){Se.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),s=e.node(Se.last(n.borderLeft)),o=e.node(Se.last(n.borderRight));n.width=Math.abs(o.x-s.x),n.height=Math.abs(i.y-r.y),n.x=s.x+n.width/2,n.y=r.y+n.height/2}}),Se.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function M$(e){Se.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function P$(e){var t=Yr.buildLayerMatrix(e);Se.forEach(t,function(n){var r=0;Se.forEach(n,function(i,s){var o=e.node(i);o.order=s+r,Se.forEach(o.selfEdges,function(l){Yr.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:o.rank,order:s+ ++r,e:l.e,label:l.label},"_se")}),delete o.selfEdges})})}function O$(e){Se.forEach(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),i=r.x+r.width/2,s=r.y,o=n.x-i,l=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:s-l},{x:i+5*o/6,y:s-l},{x:i+o,y:s},{x:i+5*o/6,y:s+l},{x:i+2*o/3,y:s+l}],n.label.x=n.x,n.label.y=n.y}})}function ng(e,t){return Se.mapValues(Se.pick(e,t),Number)}function rg(e){var t={};return Se.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var nl=Qe,D$=Gt,L$=On.Graph,F$={debugOrdering:z$};function z$(e){var t=D$.buildLayerMatrix(e),n=new L$({compound:!0,multigraph:!0}).setGraph({});return nl.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),nl.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),nl.forEach(t,function(r,i){var s="layer"+i;n.setNode(s,{rank:"same"}),nl.reduce(r,function(o,l){return n.setEdge(o,l,{style:"invis"}),l})}),n}var q$="0.8.5",$$={graphlib:On,layout:d$,debug:F$,util:{time:Gt.time,notime:Gt.notime},version:q$};const hc=Bv($$),qj=(e,t)=>{const n=new hc.graphlib.Graph;return n.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),n.setDefaultEdgeLabel(()=>({})),e.forEach(r=>{n.setNode(r.id,{width:r.data.width??280,height:r.data.height??90})}),t.forEach(r=>{n.setEdge(r.source,r.target)}),hc.layout(n),{nodes:e.map(r=>{const i=n.node(r.id);return{...r,targetPosition:ae.Top,sourcePosition:ae.Bottom,position:{x:i.x-(r.data.width??280)/2,y:i.y-(r.data.height??90)/2}}}),edges:t}},$j=(e,t,n)=>{let r=[],i=[],s=null,o=null,l=[];const c=n.theme||"industrial";return e.forEach((d,u)=>{var x,g;if((d.level||1)!==1)return;const f=280;let p=95;d.state==="active"&&d.stations&&(p+=35);const h=t===d.id;if(r.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...n},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),s){const w=(x=e[u-1])==null?void 0:x.state;i.push({id:"e-"+s+"-"+d.id,source:s,target:d.id,type:"smoothstep",animated:w==="active",style:{stroke:yE(w,c),strokeWidth:3}})}((g=d.children)==null?void 0:g.length)>0&&(o=d.id,l=d.children),s=d.id}),{nodes:r,edges:i,epicBacklogId:o,epicChildren:l}},Bj=(e,t,n,r,i)=>{const{nodes:s,edges:o}=e;if(!t||!n.length)return{nodes:s,edges:o};const l=s.find(b=>b.id===t);if(!l)return{nodes:s,edges:o};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=i.theme||"industrial",p=yE(u,f),h=u==="active",x=jn.EPIC_HEIGHT+jn.EPIC_GAP_Y,g=Math.ceil(n.length/jn.EPICS_PER_ROW),w=c+280*.15,v=50,y={};n.forEach((b,_)=>{const j=Math.floor(_/jn.EPICS_PER_ROW);y[j]||(y[j]=[]),y[j].push({epic:b,idx:_})});for(let b=0;b<g;b++){const _=y[b]||[];if(_.length===0)continue;const j=d+jn.EPIC_OFFSET_Y+b*x,k=`junction-row-${b}`;s.push({id:k,type:"waypoint",position:{x:w,y:j-v},draggable:!1,connectable:!1,selectable:!1}),b===0?o.push({id:`e-spine-drop-${b}`,source:t,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):o.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),_.forEach(({epic:N,idx:E})=>{const S=E%jn.EPICS_PER_ROW,R=c+jn.EPIC_OFFSET_X+S*(jn.EPIC_WIDTH+jn.EPIC_GAP_X),T=j,M=r===N.id;s.push({id:N.id,type:"documentNode",data:{...N,width:jn.EPIC_WIDTH,height:jn.EPIC_HEIGHT,isExpanded:M,...i},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:ae.Top,sourcePosition:ae.Bottom,zIndex:M?1e3:0}),o.push({id:`e-branch-${N.id}`,source:k,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:s,edges:o}},B$={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},Hj={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function H$(e){const t={};for(const n of e.projects)t[n.id]={id:n.id,projectId:n.project_id,name:n.name,description:n.description||"",status:n.status==="active"?"active":n.is_archived?"complete":"queued",icon:n.icon,createdAt:n.created_at,isArchived:n.is_archived||!1};return t}function W$(e,t=[]){const n=[],r=[],i={};for(const s of e.tracks){const o=U$(s,t);if((s.scope||"project")==="project")r.push({...o,mayOwn:s.may_own||[],childDocType:s.child_doc_type});else{const c=s.document_type;i[c]||(i[c]=[]),i[c].push(o)}}for(const s of r)s.childDocType&&i[s.childDocType]&&(s.children=i[s.childDocType].map(o=>({...o,level:2}))),n.push(s);return n}function U$(e,t=[]){const n=B$[e.state]||"ready_for_production",r=e.state==="awaiting_operator",i=t.find(l=>l.document_type===e.document_type);let s=null;(n==="in_production"||r)&&(s=V$(e.stations,e.state,e.station));let o=null;return i&&i.questions&&(o=i.questions.map((l,c)=>({id:l.id||`q${c+1}`,text:l.question||l.text||l,required:l.required!==!1}))),{id:e.document_type,name:e.document_name||G$(e.document_type),desc:e.description||"",state:n,intent:"mandatory",level:1,stations:s,questions:o,interruptId:i==null?void 0:i.id,blockedBy:e.blocked_by||[]}}function V$(e,t,n){if(!e||e.length===0){const r=n||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return cd.map(i=>({id:i,label:Hj[i]||i.toUpperCase(),state:r===i?"active":cd.indexOf(i)<cd.indexOf(r)?"complete":"pending",needs_input:i==="pgc"&&t==="awaiting_operator"}))}return e.map(r=>({id:r.station,label:Hj[r.station]||r.station.toUpperCase(),state:r.state||"pending",needs_input:r.needs_input||!1}))}function G$(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function K$({includeArchived:e=!1}={}){const[t,n]=m.useState({}),[r,i]=m.useState(!0),[s,o]=m.useState(null),l=m.useCallback(async()=>{i(!0),o(null);try{const d=await Ye.getProjects({includeArchived:e}),u=H$(d);n(u)}catch(d){o(d.message),console.error("Failed to fetch projects:",d)}finally{i(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await Ye.createProject({name:d,description:""});return n(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw o(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:r,error:s,addProject:c,refresh:l}}function Y$(e){const[t,n]=m.useState([]),[r,i]=m.useState("idle"),[s,o]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null),g=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[_,j]=await Promise.all([Ye.getProductionStatus(e),Ye.getProjectInterrupts(e).catch(()=>[])]);o(j),i(_.line_state),n(W$(_,j))}catch(_){u(_.message),console.error("Failed to fetch production status:",_)}finally{c(!1)}},[e]),w=m.useCallback(()=>{if(!e)return;h.current&&h.current.close();const _=u6(e);h.current=_,_.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),_.addEventListener("station_transition",j=>{try{const k=JSON.parse(j.data);console.log("Station transition:",k),g()}catch(k){console.error("Failed to parse station_transition:",k)}}),_.addEventListener("line_stopped",j=>{try{const k=JSON.parse(j.data);console.log("Line stopped:",k),i("stopped"),g()}catch(k){console.error("Failed to parse line_stopped:",k)}}),_.addEventListener("production_complete",j=>{try{const k=JSON.parse(j.data);console.log("Production complete:",k),i("complete"),g()}catch(k){console.error("Failed to parse production_complete:",k)}}),_.addEventListener("interrupt_resolved",j=>{try{const k=JSON.parse(j.data);console.log("Interrupt resolved:",k),g()}catch(k){console.error("Failed to parse interrupt_resolved:",k)}}),_.addEventListener("track_started",j=>{try{const k=JSON.parse(j.data);console.log("Track started:",k),i("active"),g()}catch(k){console.error("Failed to parse track_started:",k)}}),_.onerror=j=>{console.error("SSE error:",j),p(!1),u("Connection lost"),_.close(),x.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),w()},3e3)}},[e,g]),v=m.useCallback(()=>{x.current&&clearTimeout(x.current),h.current&&(h.current.close(),h.current=null),p(!1)},[]),y=m.useCallback(async(_,j)=>{try{await Ye.resolveInterrupt(_,{answers:j}),await g()}catch(k){throw console.error("Failed to resolve interrupt:",k),k}},[g]),b=m.useCallback(async(_=null)=>{try{await Ye.startProduction(e,_),i("active"),await g()}catch(j){throw console.error("Failed to start production:",j),j}},[e,g]);return m.useEffect(()=>(g(),w(),()=>v()),[g,w,v]),{data:t,lineState:r,interrupts:s,loading:l,error:d,connected:f,refresh:g,resolveInterrupt:y,startProduction:b}}const Wj="combine-theme";function LT(e="industrial"){const[t,n]=m.useState(()=>{if(typeof window>"u")return e;const s=localStorage.getItem(Wj);return s&&Ar.includes(s)?s:e});m.useEffect(()=>{localStorage.setItem(Wj,t)},[t]);const r=m.useCallback(s=>{Ar.includes(s)&&n(s)},[]),i=m.useCallback(()=>{n(s=>{const o=Ar.indexOf(s);return Ar[(o+1)%Ar.length]})},[]);return{theme:t,setTheme:r,cycleTheme:i}}function X$(){const[e,t]=m.useState(null),[n,r]=m.useState("idle"),[i,s]=m.useState([]),[o,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[x,g]=m.useState([]),[w,v]=m.useState(!1),[y,b]=m.useState(null),[_,j]=m.useState(null),[k,N]=m.useState(null),[E,S]=m.useState(!1),[R,T]=m.useState(!1),M=m.useRef(null),z=m.useRef(!0);m.useEffect(()=>(z.current=!0,()=>{z.current=!1,M.current&&M.current.close()}),[]);const C=m.useCallback(I=>{z.current&&(r(I.phase),s(I.messages||[]),l(I.pending_prompt),d(I.pending_choices),f(I.interpretation||{}),h(I.confidence||0),g(I.missing_fields||[]),v(I.can_initialize||!1),b(I.gate_outcome),j(I.project))},[]),L=m.useCallback(async()=>{N(null),S(!0);try{const I=await Ye.startIntake();if(!z.current)return;t(I.execution_id),r(I.phase||"describe"),l(I.pending_prompt),s([]),f({}),j(null),b(null)}catch(I){if(!z.current)return;N(I.message||"Failed to start intake")}finally{z.current&&S(!1)}},[]),P=m.useCallback(async I=>{if(!e||!I.trim())return;N(null),T(!0);const q={role:"user",content:I};s(W=>[...W,q]);try{const W=await Ye.submitIntakeMessage(e,I);if(!z.current)return;C(W)}catch(W){if(!z.current)return;s(U=>U.filter(Z=>Z!==q)),N(W.message||"Failed to submit message")}finally{z.current&&T(!1)}},[e,C]),$=m.useCallback(async(I,q)=>{if(e){N(null),f(W=>({...W,[I]:{value:q,source:"user",locked:!0}}));try{const W=await Ye.updateIntakeField(e,I,q);if(!z.current)return;C(W)}catch(W){if(!z.current)return;N(W.message||"Failed to update field");const U=await Ye.getIntakeState(e);z.current&&C(U)}}},[e,C]),O=m.useCallback(async()=>{if(!(!e||!w)){N(null),S(!0);try{const I=await Ye.initializeIntake(e);if(!z.current)return;C(I),I.phase==="generating"&&A()}catch(I){if(!z.current)return;N(I.message||"Failed to initialize project"),S(!1)}}},[e,w,C]),A=m.useCallback(()=>{M.current&&M.current.close();const I=d6(e);M.current=I,I.addEventListener("started",q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake started:",W)}),I.addEventListener("progress",q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake progress:",W.current_node)}),I.addEventListener("complete",async q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake complete:",W),I.close(),M.current=null,r("complete"),b(W.gate_outcome),j(W.project),S(!1)}),I.addEventListener("error",q=>{if(z.current&&I.readyState!==EventSource.CLOSED){try{const W=JSON.parse(q.data);N(W.message||"Generation failed")}catch{N("Connection lost during generation")}I.close(),M.current=null,S(!1)}}),I.onerror=()=>{z.current&&I.readyState===EventSource.CLOSED&&(M.current=null,S(!1))}},[e]),F=m.useCallback(()=>{M.current&&(M.current.close(),M.current=null),t(null),r("idle"),s([]),l(null),d(null),f({}),h(0),g([]),v(!1),b(null),j(null),N(null),S(!1),T(!1)},[]);return{executionId:e,phase:n,messages:i,pendingPrompt:o,pendingChoices:c,interpretation:u,confidence:p,missingFields:x,canInitialize:w,gateOutcome:y,project:_,error:k,loading:E,submitting:R,startIntake:L,submitMessage:P,updateField:$,lockAndGenerate:O,reset:F}}const FT=m.createContext(null);function Q$({children:e}){const[t,n]=m.useState(null),[r,i]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{i(!0),o(null);try{const f=await Ye.getMe();f&&f.user?n(f.user):n(null)}catch(f){console.error("Auth check failed:",f),o(f.message),n(null)}finally{i(!1)}},[]),c=m.useCallback(f=>{window.location.href=f6(f)},[]),d=m.useCallback(async()=>{try{await Ye.logout(),n(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),n(null)}},[]),u={user:t,loading:r,error:s,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return a.jsx(FT.Provider,{value:u,children:e})}function Ds(){const e=m.useContext(FT);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function Z$(){const[e,t]=m.useState(null),[n,r]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useCallback(async()=>{s(!0),l(null);try{let u=await je.getCurrentWorkspace();u||(u=await je.createWorkspace()),t(u.workspace_id),r(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{s(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await je.closeWorkspace(e,u),t(null),r(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:n,loading:i,error:o,closeWorkspace:d,reinitialize:c}}function J$(e,t=1e4){var u,f;const[n,r]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){r(null),s(!1);return}try{const p=await je.getWorkspaceState(e);r(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{s(!1)}},[e]);return m.useEffect(()=>{e&&(s(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:n,loading:i,error:o,refresh:d,isDirty:(n==null?void 0:n.is_dirty)??!1,modifiedArtifacts:(n==null?void 0:n.modified_artifacts)??[],tier1Passed:((u=n==null?void 0:n.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=n==null?void 0:n.tier1)==null?void 0:f.results)??[],expiresAt:n!=null&&n.expires_at?new Date(n.expires_at):null}}function eB(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getDocumentTypes();t(l.document_types||[])}catch(l){s(l.message),console.error("Failed to fetch document types:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{documentTypes:e,loading:n,error:i,refresh:o}}function tB(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getRoles();t(l.roles||[])}catch(l){s(l.message),console.error("Failed to fetch roles:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{roles:e,loading:n,error:i,refresh:o}}function ja(e,t,{debounceMs:n=500,onSave:r}={}){const[i,s]=m.useState(""),[o,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(""),l(""),d(!1);return}d(!0),f(null);try{const E=await je.getArtifact(e,t);s(E.content),l(E.content)}catch(E){f(E.message),console.error("Failed to load artifact:",E)}finally{d(!1)}},[e,t]),b=m.useCallback(async E=>{if(!(!e||!t)){h(!0),f(null);try{const S=await je.writeArtifact(e,t,E);g(S),l(E),r&&r(S)}catch(S){f(S.message),console.error("Failed to save artifact:",S)}finally{h(!1)}}},[e,t,r]),_=m.useCallback(E=>{v.current=E,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},n)},[b,n]),j=m.useCallback(E=>{s(E),E!==o&&_(E)},[o,_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),v.current=null,s(o)},[o]),N=m.useCallback(()=>{w.current&&clearTimeout(w.current),i!==o&&b(i)},[i,o,b]);return m.useEffect(()=>(y(),()=>{w.current&&clearTimeout(w.current)}),[y]),{content:i,originalContent:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateContent:j,reset:k,saveNow:N,reload:y}}const nB={documentNode:P6,waypoint:O6},rB={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function iB({projectId:e,projectCode:t,projectName:n,isArchived:r,autoExpandNodeId:i,theme:s,onThemeChange:o,onProjectUpdate:l,onProjectArchive:c,onProjectUnarchive:d,onProjectDelete:u}){const{data:f,lineState:p,loading:h,error:x,connected:g,resolveInterrupt:w}=Y$(e),[v,y]=m.useState([]),[b,_]=m.useState(null),[j,k]=m.useState(null),[N,E]=m.useState(null),[S,R]=m.useState(!1),[T,M]=m.useState(""),[z,C]=m.useState(!1),[L,P]=m.useState(!1),[$,O]=m.useState(!1),A=Xc();m.useEffect(()=>{f.length>0&&y(f)},[f]),m.useEffect(()=>{i&&v.length>0&&setTimeout(()=>{_(i),k("questions")},300)},[i,v.length]),m.useEffect(()=>{_(null),k(null)},[e]);const F=m.useCallback(()=>{const Y=Ar.indexOf(s);o(Ar[(Y+1)%Ar.length])},[s,o]),I=m.useCallback(()=>{M(n||""),R(!0)},[n]),q=m.useCallback(async()=>{if(!T.trim()||T===n){R(!1);return}P(!0);try{await l(e,{name:T.trim()}),R(!1)}catch(Y){console.error("Failed to update name:",Y)}finally{P(!1)}},[T,n,e,l]),W=m.useCallback(()=>{R(!1),M("")},[]),U=m.useCallback(async()=>{P(!0);try{r?await d(e):await c(e)}catch(Y){console.error("Failed to toggle archive:",Y)}finally{P(!1)}},[e,r,c,d]),Z=m.useCallback(async()=>{P(!0);try{await u(e),C(!1)}catch(Y){console.error("Failed to delete:",Y)}finally{P(!1)}},[e,u]),B=m.useCallback(Y=>{const Q=A.getNode(Y);if(Q){const ye=window.innerWidth,we=-Q.position.x*.9+ye/2-400,xe=-Q.position.y*.9+120;A.setViewport({x:we,y:xe,zoom:.9},{duration:800})}},[A]),ne=m.useMemo(()=>({onExpand:(Y,Q)=>{_(Y),k(Q)},onCollapse:()=>{_(null),k(null),setTimeout(()=>A.fitView({padding:.2,duration:300}),50)},onViewFullDocument:Y=>{E(Y)},onSubmitQuestions:async(Y,Q)=>{console.log("Submitted:",Y,Q);const pe=v.find(ye=>ye.id===Y);if(pe!=null&&pe.interruptId)try{await w(pe.interruptId,Q)}catch(ye){console.error("Failed to submit answers:",ye)}_(null),k(null),y(ye=>{const we=xe=>xe.map(te=>te.id===Y&&te.stations?{...te,stations:te.stations.map(he=>he.id==="pgc"?{...he,state:"complete",needs_input:!1}:he.id==="asm"?{...he,state:"active"}:he)}:te.children?{...te,children:we(te.children)}:te);return we(ye)})}}),[A,v,w]),{layoutNodes:ie,layoutEdges:le}=m.useMemo(()=>{if(v.length===0)return{layoutNodes:[],layoutEdges:[]};const Y={...ne,expandType:j,theme:s,onZoomToNode:B,projectId:e,projectCode:t},{nodes:Q,edges:pe,epicBacklogId:ye,epicChildren:we}=$j(v,b,Y),xe=qj(Q,pe),{nodes:te,edges:he}=Bj(xe,ye,we,b,Y);return{layoutNodes:te.map(ze=>({...ze,data:{...ze.data,expandType:ze.id===b?j:null}})),layoutEdges:he}},[v,b,j,ne,s,B,e,t]),[J,_e,G]=hE(ie),[ve,fe,se]=mE(le);m.useEffect(()=>{if(v.length===0)return;const Y={...ne,expandType:j,theme:s,onZoomToNode:B,projectId:e,projectCode:t},{nodes:Q,edges:pe,epicBacklogId:ye,epicChildren:we}=$j(v,b,Y),xe=qj(Q,pe),{nodes:te,edges:he}=Bj(xe,ye,we,b,Y),Ge=te.map(ze=>({...ze,data:{...ze.data,expandType:ze.id===b?j:null}}));_e(Ge),fe(he)},[v,b,j,ne,_e,fe,s,B,e,t]);const ge=m.useCallback((Y,Q)=>{},[]);return h&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):x&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:a.jsx("p",{className:"text-red-500 mb-4",children:x})})}):a.jsxs("div",{className:"w-full h-full",children:[a.jsxs(Zx,{nodes:J,edges:ve,onNodesChange:G,onEdgesChange:se,onNodeClick:ge,nodeTypes:nB,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[a.jsx(Hr,{position:"top-left",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),a.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[p==="active"&&a.jsx("span",{className:"text-amber-500",children:" Active"}),p==="stopped"&&a.jsx("span",{className:"text-red-500",children:" Stopped"}),p==="complete"&&a.jsx("span",{className:"text-emerald-500",children:" Complete"}),p==="idle"&&a.jsx("span",{children:" Idle"}),!g&&a.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),a.jsx("button",{onClick:F,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:rB[s]})]})}),a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:a.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),S?a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("input",{type:"text",value:T,onChange:Y=>M(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&q(),Y.key==="Escape"&&W()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:L}),a.jsx("button",{onClick:q,disabled:L,className:"p-1 rounded hover:bg-white/10",title:"Save",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{onClick:W,disabled:L,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:a.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:n||"Untitled Project"})]}),!S&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:I,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{onClick:U,disabled:L,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:r?"#f59e0b":"var(--text-muted)"},title:r?"Unarchive project":"Archive project",children:a.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),r&&a.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),a.jsx("button",{onClick:()=>C(!0),disabled:L||!r,className:`p-1.5 rounded transition-colors ${r?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:r?1:.3,cursor:r?"pointer":"not-allowed"},title:r?"Delete project":"Archive project first to delete",children:a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[a.jsxs("button",{onClick:()=>O(!$),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[a.jsx("span",{children:"Workflow"}),a.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:$?"":""})]}),$&&a.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:a.jsx($6,{projectId:e})})]})]})}),a.jsx(xE,{position:"top-right",nodeColor:Y=>{var pe;const Q=(pe=Y.data)==null?void 0:pe.state;return["produced","stabilized","ready"].includes(Q)?"#10b981":["in_production","active"].includes(Q)?"#f59e0b":["requirements_not_met","blocked"].includes(Q)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hr,{position:"bottom-left",children:a.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[a.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),a.jsx(Hr,{position:"bottom-right",children:a.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),N&&a.jsx(D6,{projectId:e,projectCode:t,docTypeId:N,onClose:()=>E(null)}),z&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:a.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),a.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",a.jsx("strong",{children:n})," and all its documents. This action cannot be undone."]}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>C(!1),disabled:L,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{onClick:Z,disabled:L,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:L?"Deleting...":"Delete"})]})]})})]})}function rl({messages:e,pendingPrompt:t}){const n=m.useRef(null);return m.useEffect(()=>{var r;(r=n.current)==null||r.scrollIntoView({behavior:"smooth"})},[e,t]),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.map((r,i)=>a.jsx("div",{className:`flex ${r.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${r.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:r.content})},i)),t&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),a.jsx("div",{ref:n})]})}function sB({onSubmit:e,disabled:t,placeholder:n}){const[r,i]=m.useState(""),s=m.useRef(null);m.useEffect(()=>{var c;t||(c=s.current)==null||c.focus()},[t]);const o=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),r.trim()&&!t&&(e(r.trim()),i("")))},l=()=>{r.trim()&&!t&&(e(r.trim()),i(""))};return a.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("textarea",{ref:s,value:r,onChange:c=>i(c.target.value),onKeyDown:o,disabled:t,placeholder:n||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:l,disabled:t||!r.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!r.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),a.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const oB={project_name:"Project Name",problem_statement:"Problem Statement",project_type:"Project Type"},aB=["project_name","problem_statement","project_type"];function lB({interpretation:e,missingFields:t,canInitialize:n,onUpdateField:r,onInitialize:i,loading:s}){const[o,l]=m.useState(null),[c,d]=m.useState(""),u=(h,x)=>{l(h),d(x)},f=async()=>{o&&c.trim()&&(await r(o,c.trim()),l(null),d(""))},p=()=>{l(null),d("")};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Review & Lock"}),t.length>0&&a.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded bg-amber-500/20 text-amber-400",children:[t.length," missing"]})]}),aB.map(h=>{const x=e[h];if(!x)return null;const g=x.locked,w=t.includes(h),v=o===h;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"text-[10px] font-medium",style:{color:"var(--text-muted)"},children:[oB[h]||h,w&&a.jsx("span",{className:"text-amber-400 ml-1",children:"*"})]}),g&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"locked"})]}),v?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:c,onChange:y=>d(y.target.value),onKeyDown:y=>{y.key==="Enter"&&f(),y.key==="Escape"&&p()},autoFocus:!0,className:"flex-1 rounded px-2 py-1.5 text-xs",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:f,className:"px-2 py-1 rounded text-xs bg-emerald-500 text-white",children:"Save"}),a.jsx("button",{onClick:p,className:"px-2 py-1 rounded text-xs",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Cancel"})]}):a.jsx("div",{onClick:()=>!g&&u(h,x.value),className:`rounded px-2 py-1.5 text-xs ${g?"cursor-default":"cursor-pointer hover:bg-white/5"} ${w?"border border-amber-500/50":""}`,style:{background:"var(--bg-input)",color:x.value?"var(--text-primary)":"var(--text-muted)"},children:x.value||"Click to edit..."})]},h)}),a.jsx("button",{onClick:i,disabled:!n||s,className:`w-full py-2.5 rounded-lg text-sm font-medium transition-colors ${n&&!s?"bg-violet-500 text-white hover:bg-violet-400":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:s?"Initializing...":"Lock & Initialize Project"}),!n&&a.jsx("p",{className:"text-[10px] text-center",style:{color:"var(--text-muted)"},children:"Fill all required fields to continue"})]})}function cB(){return a.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[a.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-violet-500/20"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent animate-spin"}),a.jsx("div",{className:"absolute inset-3 rounded-full bg-violet-500/20 animate-pulse"})]}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"Generating Project"}),a.jsx("p",{className:"text-xs text-center max-w-[200px]",style:{color:"var(--text-muted)"},children:"Creating intake document and running quality checks..."}),a.jsxs("div",{className:"flex gap-1 mt-4",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"300ms"}})]})]})}const Uj={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function uB({type:e,className:t}){switch(e){case"check":return a.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 9v4M12 17h.01"}),a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function dB({gateOutcome:e,project:t,onViewProject:n,onClose:r}){const i=Uj[e]||Uj.blocked,s=e==="qualified";return a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:`w-16 h-16 rounded-full ${i.iconBg} flex items-center justify-center mx-auto mb-4`,children:a.jsx(uB,{type:i.icon,className:`w-8 h-8 ${i.iconColor}`})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:i.title}),a.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:i.description}),s&&t&&a.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[a.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),a.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[s&&t&&a.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),a.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function fB({onClose:e,onComplete:t}){const{phase:n,messages:r,pendingPrompt:i,interpretation:s,missingFields:o,canInitialize:l,gateOutcome:c,project:d,error:u,loading:f,submitting:p,startIntake:h,submitMessage:x,updateField:g,lockAndGenerate:w,reset:v}=X$();m.useEffect(()=>(h(),()=>v()),[]);const y=()=>{v(),e()},b=()=>{d&&t&&t(d),y()},_=()=>{const k=[{id:"describe",label:"Describe"},{id:"review",label:"Review"},{id:"generating",label:"Generate"},{id:"complete",label:"Done"}],N=k.findIndex(E=>E.id===n);return a.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:k.map((E,S)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 py-0.5 rounded ${S===N?"bg-violet-500/30 text-violet-300":S<N?"text-emerald-400":"text-slate-500"}`,children:E.label}),S<k.length-1&&a.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},E.id))})},j=()=>{if(f&&n==="idle")return a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});switch(n){case"describe":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:r,pendingPrompt:i}),a.jsx(sB,{onSubmit:x,disabled:p,placeholder:"Describe what you want to build..."})]});case"review":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:r}),a.jsx("div",{className:"border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx(lB,{interpretation:s,missingFields:o,canInitialize:l,onUpdateField:g,onInitialize:w,loading:f})})]});case"generating":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:r}),a.jsx(cB,{})]});case"complete":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:r}),a.jsx(dB,{gateOutcome:c,project:d,onViewProject:b,onClose:y})]});default:return null}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:a.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),_()]})]}),a.jsx("button",{onClick:y,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),u&&a.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:u}),j()]})})}function pB({onClose:e}){const{user:t,logout:n,isAdmin:r}=Ds(),[i,s]=m.useState(null),[o,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{i==="linked"&&p()},[i]);const p=async()=>{try{d(!0);const j=await fetch("/auth/accounts",{credentials:"include"});if(j.ok){const k=await j.json();l(k.identities||[])}}catch(j){console.error("Failed to load accounts:",j)}finally{d(!1)}},h=j=>{window.location.href=`/auth/accounts/link/${j}`},x=async j=>{var k;if(o.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${j} account?`))try{const N=(k=document.cookie.split("; ").find(S=>S.startsWith("csrf=")||S.startsWith("__Host-csrf=")))==null?void 0:k.split("=")[1],E=await fetch(`/auth/accounts/${j}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(E.ok)f({type:"success",text:"Account unlinked"}),await p();else{const S=await E.json();throw new Error(S.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},g=async()=>{await n(),e()},w=j=>{s(i===j?null:j),f(null)},v={google:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=j=>{const k={user:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),a.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return k[j]||k.user},_=j=>{switch(j){case"account":return a.jsxs("div",{className:"px-4 py-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return a.jsxs("div",{className:"px-4 py-3",children:[u&&a.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-2 mb-4",children:o.map(k=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[v[k.provider_id],a.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:k.provider_email})]}),a.jsx("button",{onClick:()=>x(k.provider_id),disabled:o.length<=1,className:`text-xs px-2 py-1 rounded ${o.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},k.provider_id))}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),a.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.google,"Google"]}),a.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.microsoft,"Microsoft"]})]})]})]});default:return a.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),a.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?a.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),a.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r&&a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),a.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),a.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),a.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),a.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(j=>a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("button",{onClick:()=>!j.future&&w(j.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${j.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:j.future,children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:b(j.icon)}),a.jsx("span",{className:"flex-1 text-sm text-left",children:j.label}),j.future?a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):a.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:i===j.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),i===j.id&&!j.future&&a.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:_(j.id)})]},j.id))]}),a.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Me={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function hB(){return a.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Me.bg,borderColor:Me.border},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Me.textPrimary},children:"THE COMBINE"}),a.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Me.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function mB(){return a.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Me.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),a.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Me.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),a.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Me.textMuted},onMouseOver:e=>e.currentTarget.style.color=Me.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Me.textMuted,children:["Learn how The Combine works",a.jsx("span",{"aria-hidden":"true",children:""})]})]})}function gB(){const e=[{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return a.jsx("section",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,n)=>a.jsxs("div",{className:"flex-1 text-center group",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Me.bgElevated,border:`1px solid ${Me.border}`,color:Me.textMuted},children:t.icon}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Me.textPrimary},children:t.title}),a.jsx("p",{className:"text-xs",style:{color:Me.textMuted},children:t.description}),n<e.length-1&&a.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Me.border}})]},n))})})}function vB(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return a.jsx("section",{className:"text-center",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,n)=>a.jsx("span",{className:"text-xs",style:{color:Me.textMuted},children:t},n))})})}function xB({onLogin:e}){return a.jsxs("section",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Me.textSecondary},children:"Ready?"}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Me.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Me.accentHover,onMouseOut:t=>t.currentTarget.style.background=Me.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Me.bg,border:`1px solid ${Me.border}`,color:Me.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Me.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Me.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function yB(){return a.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Me.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Me.textMuted,onMouseOut:e=>e.currentTarget.style.color=Me.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Me.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Me.textMuted,onMouseOut:e=>e.currentTarget.style.color=Me.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Me.border},children:" 2026 The Combine"})]})}function bB(){const{login:e}=Ds();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Me.bg},children:[a.jsx(hB,{}),a.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:a.jsxs("div",{className:"space-y-12",children:[a.jsx(mB,{}),a.jsx(gB,{}),a.jsx(vB,{}),a.jsx(xB,{onLogin:e})]})}),a.jsx(yB,{})]})}const Ee={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function wB(){return a.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Ee.bg,borderColor:Ee.border},children:[a.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Ee.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ee.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ee.textMuted,children:[a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),a.jsx("span",{className:"text-sm",children:"Back"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),a.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Ee.textPrimary},children:"THE COMBINE"})]}),a.jsx("div",{className:"w-16"})," "]})}function ii({title:e,children:t}){return a.jsxs("section",{className:"mb-16",children:[e&&a.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Ee.textPrimary},children:e}),t]})}function pt({children:e,className:t=""}){return a.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Ee.textSecondary},children:e})}function eo({children:e}){return a.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Ee.textPrimary,borderLeft:`2px solid ${Ee.border}`},children:e})}function il({items:e}){return a.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,n)=>a.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Ee.textSecondary},children:[a.jsx("span",{style:{color:Ee.textMuted},children:"-"}),t]},n))})}function sl({number:e,title:t,children:n}){return a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[a.jsxs("span",{className:"text-sm font-mono",style:{color:Ee.textMuted},children:[e,"."]}),a.jsx("h3",{className:"text-base font-medium",style:{color:Ee.textPrimary},children:t})]}),a.jsx("div",{className:"pl-7",children:a.jsx(pt,{children:n})})]})}function ol({title:e,children:t}){return a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Ee.textPrimary},children:e}),a.jsx(pt,{className:"mb-0",children:t})]})}function _B({onLogin:e}){return a.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Ee.bgElevated,border:`1px solid ${Ee.border}`},children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Ee.textPrimary},children:"When You're Ready"}),a.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),a.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),a.jsx(pt,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ee.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ee.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.bg,border:`1px solid ${Ee.border}`,color:Ee.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ee.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ee.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function jB(){return a.jsxs("footer",{className:"py-8 text-center",children:[a.jsx("p",{className:"text-sm mb-6",style:{color:Ee.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ee.border},children:" 2026 The Combine"})]})]})}function SB(){const{login:e}=Ds();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ee.bg},children:[a.jsx(wB,{}),a.jsx("main",{className:"flex-1 px-6 py-12",children:a.jsxs("article",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Ee.textPrimary},children:"Learn More"}),a.jsxs(ii,{title:"What The Combine Is",children:[a.jsx(pt,{children:"The Combine is an AI-assisted production system for knowledge work."}),a.jsx(pt,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),a.jsx(eo,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),a.jsx(eo,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),a.jsxs(ii,{title:"Why It Exists",children:[a.jsx(pt,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),a.jsx(pt,{children:"It breaks down when the work must be:"}),a.jsx(il,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),a.jsx(pt,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),a.jsxs(ii,{title:'Why "The Combine"',children:[a.jsx(pt,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),a.jsx(pt,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),a.jsx(pt,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),a.jsx(pt,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),a.jsx(pt,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),a.jsx(il,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),a.jsx(pt,{children:"This is not automation for speed. It is industrialization for reliability."}),a.jsx(eo,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),a.jsxs(ii,{title:"How It Works",children:[a.jsx(sl,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),a.jsx(sl,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),a.jsx(sl,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),a.jsx(sl,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),a.jsxs(ii,{title:"What Makes It Different",children:[a.jsx(ol,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),a.jsx(ol,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),a.jsx(ol,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),a.jsx(ol,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),a.jsxs(ii,{title:"What The Combine Is Not",children:[a.jsx(il,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),a.jsx(pt,{children:"If you want improvisation, there are better tools."}),a.jsx(eo,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),a.jsxs(ii,{title:"Who It's For",children:[a.jsx(pt,{children:"The Combine is designed for people responsible for outcomes, including:"}),a.jsx(il,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),a.jsx(eo,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),a.jsx(_B,{onLogin:e})]})}),a.jsx(jB,{})]})}function zT(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getTemplates();t(l.templates||[])}catch(l){s(l.message),console.error("Failed to fetch templates:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{templates:e,loading:n,error:i,refresh:o}}function kB(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){s(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{workflows:e,loading:n,error:i,refresh:o}}function qT(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getSchemas();t(l.schemas||[])}catch(l){s(l.message),console.error("Failed to fetch schemas:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{schemas:e,loading:n,error:i,refresh:o}}function $T(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){r(!0),s(null);try{const h=await je.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&s(h.message||"Failed to load prompt fragments")}finally{f&&r(!1)}}return p(),()=>{f=!1}},[]);const o=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:o.role.length,task:o.task.length,qa:o.qa.length,pgc:o.pgc.length,questions:o.questions.length,reflection:o.reflection.length}),[e,o]),c=m.useCallback(f=>!f||f==="all"?e:o[f]||[],[e,o]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{r(!0),s(null);try{const f=await je.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),s(f.message||"Failed to refresh")}finally{r(!1)}},[]);return{fragments:e,loading:n,error:i,fragmentsByKind:o,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const ig="doctype-browser-collapsed";function BT(e,t){const[n,r]=m.useState(()=>{try{const s=JSON.parse(localStorage.getItem(ig)||"{}");return e in s?s[e]:t}catch{return t}}),i=m.useCallback(s=>{const o=typeof s=="function"?s(n):s;r(o);try{const l=JSON.parse(localStorage.getItem(ig)||"{}");l[e]=o,localStorage.setItem(ig,JSON.stringify(l))}catch{}},[e,n]);return[n,i]}function Vj({title:e,defaultOpen:t=!0,children:n}){const[r,i]=BT(`group:${e}`,t);return a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>i(!r),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:r?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),r&&n]})}function Gj({title:e,action:t,defaultOpen:n=!0,dotColor:r,children:i}){const[s,o]=BT(`sub:${e}`,n);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:s?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),r&&a.jsx("span",{style:{color:r,fontSize:8},children:""}),a.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),s&&i]})}function Kj({selected:e,onClick:t,label:n,sublabel:r,badge:i}){return a.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:n}),i&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:i})]}),r&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function Yj({loading:e,empty:t,emptyMessage:n="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:n}):null}function NB({documentTypes:e=[],roles:t=[],templates:n=[],workflows:r=[],promptFragments:i=[],promptFragmentKindOptions:s=[],schemas:o=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:x=null,selectedRole:g=null,selectedTemplate:w=null,selectedWorkflow:v=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:_,onSelectRole:j,onSelectTemplate:k,onSelectWorkflow:N,onSelectFragment:E,onSelectStandaloneSchema:S,onCreateWorkflow:R,onCreateDocType:T,onCreateFragment:M,onCreateTemplate:z,onCreateSchema:C,onSelectTask:L,onSelectSchema:P,workspaceState:$=null}){var xe;const[O,A]=m.useState(null),[F,I]=m.useState(null),[q,W]=m.useState(""),[U,Z]=m.useState(!1),[B,ne]=m.useState(!1),[ie,le]=m.useState(""),[J,_e]=m.useState(!1),G=[...e].sort((te,he)=>(te.display_name||"").localeCompare(he.display_name||"")),ve=r.filter(te=>(te.pow_class||"reference")==="reference"),fe=te=>{const he=te.pow_class||"reference";return he==="reference"?"ref":he==="template"?"tpl":"inst"},se=e.filter(te=>te.active_version).length+r.filter(te=>te.active_version).length,ge=((xe=$==null?void 0:$.modified_artifacts)==null?void 0:xe.length)??0,Y=($==null?void 0:$.is_dirty)??!1,Q=()=>{A(null),I(null),W("")},pe=()=>{ne(!1),le("")},ye=async()=>{const te=ie.trim().toLowerCase().replace(/\s+/g,"_");if(!(!te||!/^[a-z][a-z0-9_]*$/.test(te))){_e(!0);try{await(T==null?void 0:T({doc_type_id:te})),pe()}catch{}finally{_e(!1)}}},we=async()=>{const te=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!te||!/^[a-z][a-z0-9_]*$/.test(te))){Z(!0);try{const he={workflow_id:te,pow_class:"template"};F&&(he.derived_from={workflow_id:F.workflow_id,version:F.active_version},he.source_version=F.active_version),await(R==null?void 0:R(he)),Q()}catch{}finally{Z(!1)}}};return a.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(Vj,{title:"Production Workflows",defaultOpen:!0,children:[a.jsxs(Gj,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&a.jsx("button",{onClick:()=>A(O?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[O==="choose"&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("button",{onClick:()=>A("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:ve.length===0,children:["From Reference",ve.length===0?" (none available)":""]}),a.jsx("button",{onClick:()=>A("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),a.jsx("button",{onClick:Q,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),O==="from_reference"&&!F&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),ve.map(te=>a.jsxs("button",{onClick:()=>I(te),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("div",{className:"font-medium",children:te.name||te.workflow_id.replace(/_/g," ").replace(/\b\w/g,he=>he.toUpperCase())}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",te.active_version]})]},te.workflow_id)),a.jsx("button",{onClick:()=>A("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(O==="blank"||O==="from_reference"&&F)&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[F&&a.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",F.name||F.workflow_id," v",F.active_version]}),a.jsx("input",{type:"text",value:q,onChange:te=>W(te.target.value),onKeyDown:te=>{te.key==="Enter"&&we(),te.key==="Escape"&&Q()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:U,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:we,disabled:U||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:U?"wait":"pointer",opacity:!q.trim()||U?.5:1},children:U?"Creating...":"Create"}),a.jsx("button",{onClick:Q,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(Yj,{loading:u,empty:!u&&r.length===0,emptyMessage:"No workflows"}),!u&&r.length>0&&a.jsx("div",{className:"py-1",children:r.map(te=>a.jsx(Kj,{selected:(v==null?void 0:v.workflow_id)===te.workflow_id,onClick:()=>N==null?void 0:N(te),label:te.name||te.workflow_id.replace(/_/g," ").replace(/\b\w/g,he=>he.toUpperCase()),sublabel:`v${te.active_version}`,badge:fe(te)},te.workflow_id))})]}),a.jsxs(Gj,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&a.jsx("button",{onClick:()=>ne(!B),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[B&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:ie,onChange:te=>le(te.target.value),onKeyDown:te=>{te.key==="Enter"&&ye(),te.key==="Escape"&&pe()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:J,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:ye,disabled:J||!ie.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:J?"wait":"pointer",opacity:!ie.trim()||J?.5:1},children:J?"Creating...":"Create"}),a.jsx("button",{onClick:pe,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(Yj,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&G.length>0&&a.jsx("div",{className:"py-1",children:G.map(te=>a.jsx(Kj,{selected:x==="docworkflow"&&(h==null?void 0:h.doc_type_id)===te.doc_type_id,onClick:()=>_==null?void 0:_(te),label:te.display_name,badge:`v${te.active_version}`},te.doc_type_id))})]})]}),a.jsxs(Vj,{title:"Governance",defaultOpen:!1,children:[a.jsx("div",{className:"px-4 py-3",children:a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),a.jsxs("div",{children:[se," active ",se===1?"release":"releases"]})]})}),$&&a.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),Y&&a.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[ge," dirty"]})]})]})]})})}function CB({kinds:e=[],selectedKind:t="all",onSelect:n}){return a.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:r,label:i,count:s})=>{const o=t===r;return a.jsxs("button",{onClick:()=>n==null?void 0:n(r),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:o?"var(--action-primary)":"var(--bg-panel)",color:o?"#000":"var(--text-secondary)",border:o?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[i,s!==void 0&&a.jsxs("span",{style:{marginLeft:4,opacity:o?.7:.6},children:["(",s,")"]})]},r)})})}function al({title:e,count:t,dotColor:n,defaultOpen:r=!1,action:i,children:s}){const[o,l]=m.useState(r);return a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[a.jsxs("button",{onClick:()=>l(!o),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),a.jsx("span",{style:{color:n,fontSize:10},children:""}),a.jsx("span",{className:"font-semibold",children:e})]}),a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),i&&a.jsx("div",{className:"pr-3",children:i})]}),o&&a.jsx("div",{style:{background:"var(--bg-panel)"},children:s})]})}function to({onClick:e,label:t,sublabel:n,badge:r}){return a.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:t}),r&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:r})]}),n&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function ll({loading:e,empty:t,emptyMessage:n="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:n}):null}function EB({isOpen:e,onClose:t,promptFragments:n=[],promptFragmentKindOptions:r=[],templates:i=[],schemas:s=[],documentTypes:o=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,onSelectFragment:h,onSelectTemplate:x,onSelectSchema:g,onSelectStandaloneSchema:w,onSelectMechanicalOp:v,onCreateFragment:y,onCreateTemplate:b,onCreateSchema:_}){const[j,k]=m.useState("all"),[N,E]=m.useState(!1),[S,R]=m.useState("role"),[T,M]=m.useState(""),[z,C]=m.useState(!1),[L,P]=m.useState(!1),[$,O]=m.useState(""),[A,F]=m.useState(!1),[I,q]=m.useState(!1),[W,U]=m.useState(""),[Z,B]=m.useState(!1),ne=j==="all"?n:n.filter(G=>G.kind===j);m.useEffect(()=>{e||(E(!1),P(!1),q(!1),M(""),O(""),U(""))},[e]);const ie=m.useCallback((G,ve)=>{G==null||G(ve)},[]),le=async()=>{const G=T.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){C(!0);try{await(y==null?void 0:y({role_id:G,kind:S})),E(!1),M("")}catch{}finally{C(!1)}}},J=async()=>{const G=$.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){F(!0);try{await(b==null?void 0:b({template_id:G})),P(!1),O("")}catch{}finally{F(!1)}}},_e=async()=>{const G=W.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){B(!0);try{await(_==null?void 0:_({schema_id:G})),q(!1),U("")}catch{}finally{B(!1)}}};return e?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),a.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),a.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(al,{title:"Prompt Fragments",count:n.length,dotColor:"#f59e0b",defaultOpen:!0,action:y&&a.jsx("button",{onClick:()=>E(!N),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[N&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),a.jsx("select",{value:S,onChange:G=>R(G.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:a.jsx("option",{value:"role",children:"Role"})})]}),a.jsx("input",{type:"text",value:T,onChange:G=>M(G.target.value),onKeyDown:G=>{G.key==="Enter"&&le(),G.key==="Escape"&&E(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:z,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:le,disabled:z||!T.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:z?"wait":"pointer",opacity:!T.trim()||z?.5:1},children:z?"Creating...":"Create"}),a.jsx("button",{onClick:()=>E(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),r.length>0&&a.jsx(CB,{kinds:r,selectedKind:j,onSelect:k}),a.jsx(ll,{loading:d,empty:!d&&ne.length===0,emptyMessage:j==="all"?"No prompt fragments":`No ${j} fragments`}),!d&&ne.length>0&&a.jsx("div",{className:"py-1",children:ne.map(G=>a.jsx(to,{onClick:()=>ie(h,G),label:G.name||G.fragment_id,sublabel:`${G.kind}  v${G.version}`,badge:G.kind},G.fragment_id))})]}),a.jsxs(al,{title:"Templates",count:i.length,dotColor:"var(--dot-green)",action:b&&a.jsx("button",{onClick:()=>P(!L),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[L&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:$,onChange:G=>O(G.target.value),onKeyDown:G=>{G.key==="Enter"&&J(),G.key==="Escape"&&P(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:A,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:J,disabled:A||!$.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:A?"wait":"pointer",opacity:!$.trim()||A?.5:1},children:A?"Creating...":"Create"}),a.jsx("button",{onClick:()=>P(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ll,{loading:u,empty:!u&&i.length===0,emptyMessage:"No templates"}),!u&&i.length>0&&a.jsx("div",{className:"py-1",children:i.map(G=>a.jsx(to,{onClick:()=>ie(x,G),label:G.name||G.template_id.replace(/_/g," ").replace(/\b\w/g,ve=>ve.toUpperCase()),sublabel:`v${G.active_version}`},G.template_id))})]}),a.jsxs(al,{title:"Schemas",count:s.length||o.length,dotColor:"var(--dot-blue)",action:_&&a.jsx("button",{onClick:()=>q(!I),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[I&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:W,onChange:G=>U(G.target.value),onKeyDown:G=>{G.key==="Enter"&&_e(),G.key==="Escape"&&q(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:Z,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:_e,disabled:Z||!W.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Z?"wait":"pointer",opacity:!W.trim()||Z?.5:1},children:Z?"Creating...":"Create"}),a.jsx("button",{onClick:()=>q(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ll,{loading:f,empty:!f&&s.length===0&&o.length===0,emptyMessage:"No schemas"}),!f&&s.length>0&&a.jsx("div",{className:"py-1",children:s.map(G=>a.jsx(to,{onClick:()=>ie(w,G),label:G.title||G.schema_id,sublabel:`v${G.active_version}`},`standalone-${G.schema_id}`))}),s.length===0&&o.length>0&&a.jsx("div",{className:"py-1",children:o.map(G=>a.jsx(to,{onClick:()=>ie(g,{doc_type_id:G.doc_type_id,display_name:G.display_name,active_version:G.active_version}),label:G.display_name,sublabel:`from ${G.doc_type_id}`},`schema-${G.doc_type_id}`))})]}),a.jsxs(al,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[a.jsx(ll,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&a.jsx("div",{className:"py-1",children:l.map(G=>{const ve=c.filter(fe=>fe.type===G.type_id);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsx("span",{style:{fontSize:10},children:""}),a.jsx("span",{children:G.name}),a.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",ve.length,")"]})]}),ve.length>0?ve.map(fe=>a.jsx(to,{onClick:()=>ie(v,fe),label:fe.name,sublabel:`v${fe.active_version}`,badge:fe.type},fe.op_id)):a.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},G.type_id)})}),!p&&l.length===0&&c.length===0&&a.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),a.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function tr({content:e,onChange:t,loading:n=!1,saving:r=!1,isDirty:i=!1,error:s=null,readOnly:o=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o&&a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!o&&i&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&!o&&a.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),n&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),r&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!r&&!n&&i&&a.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),s&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",s]})]})]}),a.jsx("div",{className:"flex-1 relative",children:n?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):a.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:o,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function TB({workspaceId:e,artifactId:t}){const[n,r]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){r(null),s(!1);return}(async()=>{s(!0),l(null);try{const d=await je.getPreview(e,t);r(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{s(!1)}})()},[e,t]),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(n==null?void 0:n.provenance)&&a.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[n.provenance.role&&a.jsxs("div",{children:["Role: ",n.provenance.role]}),n.provenance.schema&&a.jsxs("div",{children:["Schema: ",n.provenance.schema]}),n.provenance.package&&a.jsxs("div",{children:["Package: ",n.provenance.package]})]})]}),a.jsx("div",{className:"flex-1 relative overflow-auto",children:i?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):o?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[a.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:o})]})}):a.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(n==null?void 0:n.resolved_prompt)||"No preview available"})})]})}function RB({workspaceId:e,docType:t,roles:n=[],onSave:r}){const[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,_,j;t&&(s({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((_=t.ui)==null?void 0:_.category)||"",ui_display_order:((j=t.ui)==null?void 0:j.display_order)||0}),h(!1),f(null))},[t]);const x=m.useCallback((b,_)=>{s(j=>({...j,[b]:_})),h(!0)},[]),g=m.useCallback((b,_)=>{const j=_.split(",").map(k=>k.trim()).filter(k=>k);s(k=>({...k,[b]:j})),h(!0)},[]),w=m.useCallback(b=>{if(!b)return"";const _=n.find(j=>j.role_id===b);return _?`prompt:role:${b}:${_.active_version}`:""},[n]),v=m.useCallback(b=>{if(!b)return"";const _=b.split(":");return _.length>=3&&_[0]==="prompt"&&_[1]==="role"?_[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!i)){d(!0),f(null);try{const b=t.version||t.active_version,_=`doctype:${t.doc_type_id}:${b}:manifest`,j=AB(t.doc_type_id,b,i),k=await je.writeArtifact(e,_,j);h(!1),r==null||r(_,k)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,i,r]);return!t||!i?a.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"flex items-center gap-2",children:p&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),a.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsxs(no,{title:"Identity",children:[a.jsx(Qt,{label:"Display Name",children:a.jsx("input",{type:"text",value:i.display_name,onChange:b=>x("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Description",children:a.jsx("textarea",{value:i.description,onChange:b=>x("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"Classification",children:[a.jsx(Qt,{label:"Authority Level",children:a.jsxs("select",{value:i.authority_level,onChange:b=>x("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"descriptive",children:"Descriptive"}),a.jsx("option",{value:"prescriptive",children:"Prescriptive"}),a.jsx("option",{value:"constructive",children:"Constructive"}),a.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),a.jsx(Qt,{label:"Creation Mode",children:a.jsxs("select",{value:i.creation_mode,onChange:b=>x("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"llm_generated",children:"LLM Generated"}),a.jsx("option",{value:"constructed",children:"Constructed"}),a.jsx("option",{value:"extracted",children:"Extracted"})]})}),a.jsx(Qt,{label:"Scope",children:a.jsxs("select",{value:i.scope,onChange:b=>x("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"epic",children:"Epic"}),a.jsx("option",{value:"feature",children:"Feature"})]})})]}),a.jsx(no,{title:"Shared References",children:a.jsxs(Qt,{label:"Role Prompt",children:[a.jsxs("select",{value:v(i.role_prompt_ref),onChange:b=>x("role_prompt_ref",w(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"None"}),n.map(b=>a.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())},b.role_id))]}),i.role_prompt_ref&&a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:i.role_prompt_ref})]})}),a.jsxs(no,{title:"Dependencies",children:[a.jsx(Qt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Parent Doc Type",children:a.jsx("input",{type:"text",value:i.parent_doc_type,onChange:b=>x("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"UI Configuration",children:[a.jsx(Qt,{label:"Icon",children:a.jsx("input",{type:"text",value:i.ui_icon,onChange:b=>x("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Category",children:a.jsxs("select",{value:i.ui_category,onChange:b=>x("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"Select category..."}),a.jsx("option",{value:"intake",children:"Intake"}),a.jsx("option",{value:"architecture",children:"Architecture"}),a.jsx("option",{value:"planning",children:"Planning"}),a.jsx("option",{value:"execution",children:"Execution"})]})}),a.jsx(Qt,{label:"Display Order",children:a.jsx("input",{type:"number",value:i.ui_display_order,onChange:b=>x("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function no({title:e,children:t}){return a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),a.jsx("div",{className:"space-y-4",children:t})]})}function Qt({label:e,hint:t,children:n}){return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&a.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),n]})}function AB(e,t,n){return[`# ${n.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${n.display_name}"`,`version: "${t}"`,"description: >",`  ${n.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${n.authority_level}`,`creation_mode: ${n.creation_mode}`,n.production_mode?`production_mode: ${n.production_mode}`:"production_mode: null",`scope: ${n.scope}`,"","# Dependencies",`required_inputs: [${n.required_inputs.map(i=>`"${i}"`).join(", ")}]`,`optional_inputs: [${n.optional_inputs.map(i=>`"${i}"`).join(", ")}]`,`creates_children: [${n.creates_children.map(i=>`"${i}"`).join(", ")}]`,`parent_doc_type: ${n.parent_doc_type?`"${n.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${n.role_prompt_ref?`"${n.role_prompt_ref}"`:"null"}`,`template_ref: ${n.template_ref?`"${n.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${n.ui_icon||"file"}`,`  category: ${n.ui_category||"other"}`,`  display_order: ${n.ui_display_order||0}`,""].join(`
`)}function HT(e,t,{debounceMs:n=1e3,onSave:r}={}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(null),l(null),d(!1);return}d(!0),f(null);try{const N=await je.getArtifact(e,t),E=JSON.parse(N.content);s(E),l(E)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{d(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){h(!0),f(null);try{const E=JSON.stringify(N,null,2),S=await je.writeArtifact(e,t,E);g(S),l(N),r&&r(S)}catch(E){f(E.message),console.error("Failed to save workflow:",E)}finally{h(!1)}}},[e,t,r]),_=m.useCallback(N=>{v.current=N,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},n)},[b,n]),j=m.useCallback(N=>{s(N),_(N)},[_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),i&&b(i)},[i,b]);return m.useEffect(()=>(y(),()=>{w.current&&clearTimeout(w.current)}),[y]),{workflowJson:i,originalJson:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateWorkflow:j,saveNow:k,reload:y}}function IB({data:e,selected:t}){const{config:n,isEntry:r}=e,i=e.type==="end";return a.jsxs("div",{style:{background:n.bgColor,border:`2px solid ${t?n.color:n.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${n.color}60, 0 0 20px ${n.color}80, 0 0 40px ${n.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[a.jsx(Vn,{type:"target",position:ae.Top,style:{background:n.color,width:8,height:8,border:"none"}}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[a.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:n.color,letterSpacing:"0.05em"},children:n.label}),r&&a.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:n.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),a.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&a.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),a.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!i&&a.jsx(Vn,{type:"source",position:ae.Bottom,style:{background:n.color,width:8,height:8,border:"none"}})]})}const MB=m.memo(IB),mc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},PB={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},Xj=220,Qj=110;function Zj(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],n=e.nodes.map(i=>{const s=mc[i.type]||mc.task,l=i.type==="end"&&["blocked","abandoned"].includes(i.terminal_outcome)?PB:s;return{id:i.node_id,type:"workflowNode",position:i._position||{x:0,y:0},data:{...i,config:l,isEntry:t.includes(i.node_id)}}}),r=(e.edges||[]).map(i=>{const s=i.non_advancing||!i.to_node_id,o=i.conditions&&i.conditions.length>0;let l=i.label||i.outcome;if(o){const c=i.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id||i.from_node_id,type:"smoothstep",animated:s,label:l,data:{...i},style:{stroke:s?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:s?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:i.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:n,edges:r}}function Jj(e,t,n="TB"){const r=new hc.graphlib.Graph;return r.setDefaultEdgeLabel(()=>({})),r.setGraph({rankdir:n,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(i=>{r.setNode(i.id,{width:Xj,height:Qj})}),t.forEach(i=>{i.target!==i.source&&r.setEdge(i.source,i.target)}),hc.layout(r),e.map(i=>{const s=r.node(i.id);return s?{...i,position:{x:s.x-Xj/2,y:s.y-Qj/2}}:i})}function OB(e,t){const n=new Set(t.map(s=>s.id||s.node_id));let r=1,i=`${e}_${r}`;for(;n.has(i);)r++,i=`${e}_${r}`;return i}function DB(e,t,n){const r=new Set(n.map(o=>o.id||o.edge_id));let i=1,s=`${e}_to_${t}`;for(;r.has(s);)i++,s=`${e}_to_${t}_${i}`;return s}function LB(e,t={x:100,y:100}){const r={node_id:e+"_new",type:e,description:""};return e==="end"&&(r.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(r.task_ref="",r.includes={}),e==="qa"&&(r.requires_qa=!0,r.qa_mode="semantic"),r}const FB={workflowNode:MB},zB=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function qB({workflowJson:e,onWorkflowChange:t,selectedNodeId:n,selectedEdgeId:r,onNodeSelect:i,onEdgeSelect:s}){const o=Xc(),[l,c,d]=hE([]),[u,f,p]=mE([]),[h,x]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:S,edges:R}=Zj(e);(!S.some(M=>M.position.x!==0||M.position.y!==0)||!g.current)&&(S=Jj(S,R),g.current=!0),c(S),f(R)},[e,c,f]),m.useEffect(()=>{c(S=>S.map(R=>({...R,selected:R.id===n})))},[n,c]);const w=m.useCallback(S=>{if(!e)return;const T={edge_id:DB(S.source,S.target,e.edges||[]),from_node_id:S.source,to_node_id:S.target,outcome:"success",label:"",kind:"auto"},M={...e,edges:[...e.edges||[],T]};t(M)},[e,t]),v=m.useCallback((S,R)=>{if(!e)return;const T=e.nodes.map(M=>M.node_id===R.id?{...M,_position:R.position}:M);t({...e,nodes:T})},[e,t]),y=m.useCallback((S,R)=>{i==null||i(R.id)},[i]),b=m.useCallback((S,R)=>{s==null||s(R.id)},[s]),_=m.useCallback(()=>{i==null||i(null),s==null||s(null)},[i,s]),j=m.useCallback(S=>{if(S.key==="Delete"||S.key==="Backspace"){if(n&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==n),edges:e.edges.filter(T=>T.from_node_id!==n&&T.to_node_id!==n),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==n)};t(R),i==null||i(null)}else if(r&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==r)};t(R),s==null||s(null)}}},[n,r,e,t,i,s]),k=m.useCallback(S=>{if(!e)return;const R=OB(S,e.nodes||[]),T=LB(S);T.node_id=R;const M=o.getViewport(),z=(-M.x+window.innerWidth/2)/M.zoom,C=(-M.y+window.innerHeight/2)/M.zoom;T._position={x:z-110,y:C-50};const L={...e,nodes:[...e.nodes||[],T]};t(L),x(!1),i==null||i(R)},[e,t,o,i]),N=m.useCallback(()=>{if(!e)return;let{nodes:S,edges:R}=Zj(e);S=Jj(S,R);const T=e.nodes.map(M=>{const z=S.find(C=>C.id===M.node_id);return z?{...M,_position:z.position}:M});t({...e,nodes:T}),setTimeout(()=>{o.fitView({padding:.2,duration:300})},50)},[e,t,o]),E=m.useCallback(()=>{o.fitView({padding:.2,duration:300})},[o]);return a.jsx("div",{className:"flex-1 relative",onKeyDown:j,tabIndex:0,style:{outline:"none"},children:a.jsxs(Zx,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:w,onNodeDragStop:v,onNodeClick:y,onEdgeClick:b,onPaneClick:_,nodeTypes:FB,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[a.jsx(Hr,{position:"top-left",children:a.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>x(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&a.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:zB.map(S=>{const R=mc[S.value]||{};return a.jsxs("button",{onClick:()=>k(S.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),S.label]},S.value)})})]}),a.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),a.jsx("button",{onClick:E,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),a.jsx(xE,{position:"bottom-right",nodeColor:S=>{var T;const R=(T=S.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hr,{position:"bottom-left",children:a.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(mc).map(([S,R])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},S))})}),a.jsx(Hr,{position:"top-right",children:a.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const $B=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],eS=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],tS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],BB=["semantic","structural","hybrid"],HB=["stabilized","blocked","abandoned"],Fe={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Tt={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},WB={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function sg(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function og(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function zi(e){var i;if(!e)return"";const t=e.kind||"role",n=((i=e.fragment_id)==null?void 0:i.replace(`${t}:`,""))||e.id||"",r=e.version||e.active_version||"1.0.0";return`prompt:${t}:${n}:${r}`}function qi(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function cl(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function ul(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function ag({title:e,defaultOpen:t=!1,isOpen:n,onToggle:r,children:i,badge:s}){const[o,l]=m.useState(t),c=n!==void 0,d=c?n:o,u=()=>{c&&r?r():l(!o)};return a.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:a.jsx("path",{d:"M9 18l6-6-6-6"})}),a.jsx("span",{style:{...Tt,marginBottom:0},children:e})]}),s&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:s})]}),d&&a.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:i})]})}function nS(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function dl(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function UB({node:e,onChange:t,onDelete:n,templates:r=[],schemas:i=[],roleFragments:s=[],taskFragments:o=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var ye,we,xe,te,he,Ge,ze,Be,Te,He,at,Re,X,Oe,me,kt,xt,yt,Xt;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const x=(D,H)=>{const K={...u,[D]:H};f(K),t(K)},g=(D,H)=>{const K={...u.includes,[D]:H},re={...u,includes:K};f(re),t(re)},w=D=>{const H={...u.includes};delete H[D];const K={...u,includes:H};f(K),t(K)},v=()=>{const D={...u.includes,NEW_KEY:""},H={...u,includes:D};f(H),t(H)},y=D=>{const H={...u,internals:D};f(H),t(H)},b=(D,H)=>{const K=u.internals||k(),re={...K.question_generation,[D]:H};y({...K,question_generation:re})},_=(D,H)=>{const K=u.internals||k(),re={...K.question_generation.includes,[D]:H},De={...K.question_generation,includes:re};y({...K,question_generation:De})},j=(D,H)=>{const K=u.internals||k(),re={...K.clarification_merge,[D]:H};y({...K,clarification_merge:re})},k=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const N=u.type==="pgc",E=og(u.task_ref),S=u.includes||{},R=S.ROLE_PROMPT||"",T=S.TASK_PROMPT||"",M=S.OUTPUT_SCHEMA||"",z=S.PGC_CONTEXT||"",C=qi(R),L=qi(T),P=ul(M),$=qi(z),O=Object.entries(S).filter(([D])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(D)),A=u.internals||k(),F=og((ye=A.question_generation)==null?void 0:ye.template_ref),I=qi((xe=(we=A.question_generation)==null?void 0:we.includes)==null?void 0:xe.ROLE_PROMPT),q=qi((he=(te=A.question_generation)==null?void 0:te.includes)==null?void 0:he.TASK_PROMPT),W=qi((ze=(Ge=A.question_generation)==null?void 0:Ge.includes)==null?void 0:ze.PGC_CONTEXT),U=ul((Be=A.question_generation)==null?void 0:Be.output_schema_ref),Z=og((Te=A.clarification_merge)==null?void 0:Te.template_ref),B=ul((He=A.clarification_merge)==null?void 0:He.output_schema_ref),ne=D=>{const H=D.target.value;if(!H){x("task_ref","");return}const K=r.find(re=>re.template_id===H);K&&x("task_ref",sg(K))},ie=D=>{const H=D.target.value;if(!H){w("ROLE_PROMPT");return}const K=s.find(re=>re.fragment_id===`role:${H}`||re.id===H);K&&g("ROLE_PROMPT",zi(K))},le=D=>{const H=D.target.value;if(!H){w("TASK_PROMPT");return}const K=o.find(re=>re.fragment_id===`task:${H}`||re.id===H);K&&g("TASK_PROMPT",zi(K))},J=D=>{const H=D.target.value;if(!H){w("OUTPUT_SCHEMA");return}const K=i.find(re=>re.schema_id===H);K&&g("OUTPUT_SCHEMA",cl(K))},_e=D=>{const H=D.target.value;if(!H){w("PGC_CONTEXT");return}const K=l.find(re=>re.fragment_id===`pgc:${H}`||re.id===H);K&&g("PGC_CONTEXT",zi(K))},G=D=>{const H=D.target.value,K=tS.find(lt=>lt.value===H),re=(K==null?void 0:K.produces)||`pgc_clarifications.${H}`,De={...u,gate_kind:H,produces:re};f(De),t(De)},ve=D=>{const H=D.target.value;if(!H){b("template_ref","");return}const K=r.find(re=>re.template_id===H);K&&b("template_ref",sg(K))},fe=D=>{const H=D.target.value;if(!H){_("ROLE_PROMPT","");return}const K=s.find(re=>re.fragment_id===`role:${H}`||re.id===H);K&&_("ROLE_PROMPT",zi(K))},se=D=>{const H=D.target.value;if(!H){_("TASK_PROMPT","");return}const K=o.find(re=>re.fragment_id===`task:${H}`||re.id===H);K&&_("TASK_PROMPT",zi(K))},ge=D=>{const H=D.target.value;if(!H){_("PGC_CONTEXT","");return}const K=l.find(re=>re.fragment_id===`pgc:${H}`||re.id===H);K&&_("PGC_CONTEXT",zi(K))},Y=D=>{const H=D.target.value;if(!H){b("output_schema_ref","");return}const K=i.find(re=>re.schema_id===H);K&&b("output_schema_ref",cl(K))},Q=D=>{const H=D.target.value;if(!H){j("template_ref","");return}const K=r.find(re=>re.template_id===H);K&&j("template_ref",sg(K))},pe=D=>{const H=D.target.value;if(!H){j("output_schema_ref","");return}const K=i.find(re=>re.schema_id===H);K&&j("output_schema_ref",cl(K))};return a.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:N?"PGC Gate Properties":"Node Properties"}),a.jsx("button",{onClick:()=>n(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Node ID"}),a.jsx("input",{type:"text",value:u.node_id||"",onChange:D=>x("node_id",D.target.value),style:Fe})]}),a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Type"}),a.jsx("select",{value:u.type||"task",onChange:D=>x("type",D.target.value),style:Fe,children:$B.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))})]}),N&&a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Gate Kind"}),a.jsx("select",{value:u.gate_kind||"discovery",onChange:G,style:Fe,children:tS.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))})]}),a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Description"}),a.jsx("textarea",{value:u.description||"",onChange:D=>x("description",D.target.value),rows:2,style:{...Fe,resize:"vertical"}})]}),(N||["task","intake_gate"].includes(u.type))&&a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Produces"}),a.jsx("input",{type:"text",value:u.produces||"",onChange:D=>x("produces",D.target.value),placeholder:N?"pgc_clarifications.discovery":"document_type",style:Fe})]}),N&&a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{style:WB,children:"Gate Internals"}),a.jsx(ag,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:F||"",onChange:ve,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),r.map(D=>a.jsx("option",{value:D.template_id,children:D.name||D.template_id.replace(/_/g," ")},D.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:I||"",onChange:fe,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("role:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:q||"",onChange:se,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("task:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:W||"",onChange:ge,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("pgc:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:U||"",onChange:Y,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]})}),a.jsx("div",{className:"mt-2",children:a.jsx(ag,{title:"Entry: Operator Answers",badge:"UI",children:a.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Renders:"}),a.jsx("span",{className:"font-mono",children:((at=A.operator_entry)==null?void 0:at.renders)||"question_set"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Captures:"}),a.jsx("span",{className:"font-mono",children:((Re=A.operator_entry)==null?void 0:Re.captures)||"pgc_answers"})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),a.jsx("div",{className:"mt-2",children:a.jsx(ag,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((X=A.clarification_merge)==null?void 0:X.internal_type)||"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),a.jsxs("select",{value:((Oe=A.clarification_merge)==null?void 0:Oe.internal_type)||"LLM",onChange:D=>j("internal_type",D.target.value),style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"LLM",children:"LLM"}),a.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((me=A.clarification_merge)==null?void 0:me.internal_type)||"LLM")==="LLM"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:Z||"",onChange:Q,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),r.map(D=>a.jsx("option",{value:D.template_id,children:D.name||D.template_id.replace(/_/g," ")},D.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:B||"",onChange:pe,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]}),((kt=A.clarification_merge)==null?void 0:kt.internal_type)==="MECH"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),a.jsxs("select",{value:dl((xt=A.clarification_merge)==null?void 0:xt.op_ref)||"",onChange:D=>{const H=D.target.value;if(!H){j("op_ref","");return}const K=d.find(re=>re.op_id===H);K&&j("op_ref",nS(K))},style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(D=>D.type==="merger").map(D=>a.jsx("option",{value:D.op_id,children:D.name},D.op_id))]})]}),((yt=A.clarification_merge)==null?void 0:yt.op_ref)&&(()=>{const D=dl(A.clarification_merge.op_ref),H=d.find(K=>K.op_id===D);return H?a.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:B||"",onChange:pe,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Internal Type"}),a.jsx("select",{value:u.internal_type||"LLM",onChange:D=>x("internal_type",D.target.value),style:Fe,children:eS.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))}),a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Xt=eS.find(D=>D.value===(u.internal_type||"LLM")))==null?void 0:Xt.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Interaction Template"}),a.jsxs("select",{value:E||"",onChange:ne,style:Fe,children:[a.jsx("option",{value:"",children:"-- Select Template --"}),r.map(D=>a.jsx("option",{value:D.template_id,children:D.name||D.template_id.replace(/_/g," ")},D.template_id))]}),u.task_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Mechanical Operation"}),a.jsxs("select",{value:dl(u.op_ref)||"",onChange:D=>{const H=D.target.value;if(!H){x("op_ref","");return}const K=d.find(re=>re.op_id===H);K&&x("op_ref",nS(K))},style:Fe,children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(D=>{const H=d.filter(K=>K.type===D.type_id);return H.length===0?null:a.jsx("optgroup",{label:D.name,children:H.map(K=>a.jsx("option",{value:K.op_id,children:K.name},K.op_id))},D.type_id)})]}),u.op_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const D=dl(u.op_ref),H=d.find(re=>re.op_id===D),K=H?c.find(re=>re.type_id===H.type):null;return H?a.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(K==null?void 0:K.name)||H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Output Schema"}),a.jsxs("select",{value:ul(u.output_schema_ref)||"",onChange:D=>{const H=D.target.value;if(!H){x("output_schema_ref","");return}const K=i.find(re=>re.schema_id===H);K&&x("output_schema_ref",cl(K))},style:Fe,children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"#3b82f6",color:"#fff"},children:"UI"}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:"Operator Entry"})]}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"This node presents a form to the operator and captures their input."})]}),a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Renders"}),a.jsx("input",{type:"text",value:u.renders||"",onChange:D=>x("renders",D.target.value),placeholder:"e.g., question_set",style:Fe})]}),a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Captures"}),a.jsx("input",{type:"text",value:u.captures||"",onChange:D=>x("captures",D.target.value),placeholder:"e.g., user_answers",style:Fe})]})]}),u.type==="qa"&&a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"QA Mode"}),a.jsx("select",{value:u.qa_mode||"semantic",onChange:D=>x("qa_mode",D.target.value),style:Fe,children:BB.map(D=>a.jsx("option",{value:D,children:D},D))})]}),u.type==="end"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Terminal Outcome"}),a.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:D=>x("terminal_outcome",D.target.value),style:Fe,children:HB.map(D=>a.jsx("option",{value:D,children:D},D))})]}),a.jsxs("div",{children:[a.jsx("label",{style:Tt,children:"Gate Outcome"}),a.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:D=>x("gate_outcome",D.target.value),placeholder:"e.g., complete, failed",style:Fe})]})]}),a.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:D=>x("requires_qa",D.target.checked)}),"Requires QA"]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:D=>x("non_advancing",D.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("label",{style:Tt,children:"Includes"})}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:C||"",onChange:ie,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("role:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:L||"",onChange:le,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("task:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:P||"",onChange:J,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:$||"",onChange:_e,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("pgc:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),O.length>0&&a.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),a.jsx("div",{className:"space-y-2",children:O.map(([D,H])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:D,onChange:K=>{const re={...u.includes};delete re[D],re[K.target.value]=H;const De={...u,includes:re};f(De),t(De)},style:{...Fe,width:"35%",fontSize:10},placeholder:"KEY"}),a.jsx("input",{type:"text",value:H,onChange:K=>g(D,K.target.value),style:{...Fe,flex:1,fontSize:10},placeholder:"path/to/file"}),a.jsx("button",{onClick:()=>w(D),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},D))})]}),a.jsx("button",{onClick:v,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const VB=["auto","user_choice"],GB=["eq","ne","lt","lte","gt","gte"],Zn={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},si={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function KB({edge:e,nodeIds:t,onChange:n,onDelete:r}){const[i,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(u,f)=>{const p={...i,[u]:f};s(p),n(p)},l=()=>{const u=[...i.conditions||[],{type:"retry_count",operator:"lt",value:2}];o("conditions",u)},c=(u,f,p)=>{const h=[...i.conditions||[]];h[u]={...h[u],[f]:p},o("conditions",h)},d=u=>{const f=(i.conditions||[]).filter((p,h)=>h!==u);o("conditions",f)};return i?a.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),a.jsx("button",{onClick:()=>r(i.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Edge ID"}),a.jsx("input",{type:"text",value:i.edge_id||"",onChange:u=>o("edge_id",u.target.value),style:Zn})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"From Node"}),a.jsx("select",{value:i.from_node_id||"",onChange:u=>o("from_node_id",u.target.value),style:Zn,children:t.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"To Node"}),a.jsxs("select",{value:i.to_node_id||"",onChange:u=>o("to_node_id",u.target.value||null),style:Zn,children:[a.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>a.jsx("option",{value:u,children:u},u))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Outcome"}),a.jsx("input",{type:"text",value:i.outcome||"",onChange:u=>o("outcome",u.target.value),placeholder:"success, failed, etc.",style:Zn})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Label"}),a.jsx("input",{type:"text",value:i.label||"",onChange:u=>o("label",u.target.value),placeholder:"Human-readable label",style:Zn})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Kind"}),a.jsx("select",{value:i.kind||"auto",onChange:u=>o("kind",u.target.value),style:Zn,children:VB.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:i.non_advancing||!1,onChange:u=>o("non_advancing",u.target.checked)}),"Non-advancing"]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:si,children:"Conditions"}),a.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),a.jsx("div",{className:"space-y-2",children:(i.conditions||[]).map((u,f)=>a.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Zn,flex:1,fontSize:10}}),a.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Zn,width:"auto",fontSize:10},children:GB.map(p=>a.jsx("option",{value:p,children:p},p))}),a.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Zn,width:50,fontSize:10}}),a.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const YB={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function XB({workspaceId:e,artifactId:t,onArtifactSave:n,mechanicalOpTypes:r=[],mechanicalOps:i=[]}){var W,U,Z;const[s,o]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,x]=m.useState(null),{workflowJson:g,loading:w,error:v,saving:y,lastSaveResult:b,updateWorkflow:_}=HT(e,t,{onSave:B=>{n==null||n(t,B)}}),{templates:j}=zT(),{schemas:k}=qT(),{fragmentsByKind:N}=$T(),E=m.useMemo(()=>{var B;return!l||!g?null:((B=g.nodes)==null?void 0:B.find(ne=>ne.node_id===l))||null},[l,g]),S=m.useMemo(()=>{var B;return!d||!g?null:((B=g.edges)==null?void 0:B.find(ne=>ne.edge_id===d))||null},[d,g]),R=m.useMemo(()=>g!=null&&g.nodes?g.nodes.map(B=>B.node_id):[],[g]),T=m.useCallback(B=>{_(B)},[_]),M=m.useCallback(B=>{if(!g)return;const ne=g.nodes.map(J=>J.node_id===l?B:J);let ie=g.edges,le=g.entry_node_ids||[];B.node_id!==l&&(ie=g.edges.map(J=>({...J,from_node_id:J.from_node_id===l?B.node_id:J.from_node_id,to_node_id:J.to_node_id===l?B.node_id:J.to_node_id})),le=le.map(J=>J===l?B.node_id:J),c(B.node_id)),_({...g,nodes:ne,edges:ie,entry_node_ids:le})},[g,l,_]),z=m.useCallback(B=>{if(!g)return;const ne=g.edges.map(ie=>ie.edge_id===d?B:ie);B.edge_id!==d&&u(B.edge_id),_({...g,edges:ne})},[g,d,_]),C=m.useCallback(B=>{g&&(_({...g,nodes:g.nodes.filter(ne=>ne.node_id!==B),edges:g.edges.filter(ne=>ne.from_node_id!==B&&ne.to_node_id!==B),entry_node_ids:(g.entry_node_ids||[]).filter(ne=>ne!==B)}),c(null))},[g,_]),L=m.useCallback(B=>{g&&(_({...g,edges:g.edges.filter(ne=>ne.edge_id!==B)}),u(null))},[g,_]),P=m.useCallback(B=>{c(B),B&&u(null)},[]),$=m.useCallback(B=>{u(B),B&&c(null)},[]),O=m.useCallback(B=>{B==="json"&&g&&(p(JSON.stringify(g,null,2)),x(null)),o(B)},[g]),A=m.useCallback(B=>{const ne=B.target.value;p(ne);try{const ie=JSON.parse(ne);x(null),_(ie)}catch(ie){x(ie.message)}},[_]),F=((W=b==null?void 0:b.tier1_report)==null?void 0:W.results)||[],I=F.filter(B=>B.severity==="error").length,q=F.filter(B=>B.severity==="warning").length;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[y&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),v&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:v}),!y&&!v&&g&&a.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((U=g.nodes)==null?void 0:U.length)||0," nodes, ",((Z=g.edges)==null?void 0:Z.length)||0," edges"]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>a.jsx("button",{onClick:()=>O(B.id),style:{...YB,color:s===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:s===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),w?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s==="canvas"&&a.jsxs(a.Fragment,{children:[a.jsx(Qc,{children:a.jsx(qB,{workflowJson:g,onWorkflowChange:T,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:P,onEdgeSelect:$})}),E&&a.jsx(UB,{node:E,onChange:M,onDelete:C,templates:j,schemas:k,roleFragments:N.role||[],taskFragments:N.task||[],pgcFragments:N.pgc||[],mechanicalOpTypes:r,mechanicalOps:i}),S&&a.jsx(KB,{edge:S,nodeIds:R,onChange:z,onDelete:L})]}),s==="json"&&a.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[a.jsx("textarea",{value:f,onChange:A,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),s==="metadata"&&a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:g?a.jsx(QB,{workflow:g}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),F.length>0&&a.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[I>0&&a.jsxs("span",{style:{color:"#ef4444"},children:[I," error",I!==1?"s":""]}),q>0&&a.jsxs("span",{style:{color:"#f59e0b"},children:[q," warning",q!==1?"s":""]}),I===0&&q===0&&a.jsx("span",{style:{color:"#10b981"},children:"Valid"}),a.jsx("span",{style:{color:"var(--text-muted)"},children:F.map(B=>B.message).join(" | ")})]})]})}function QB({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},n={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},r=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],i=e.thread_ownership||{},s=Object.entries(i),o=e.entry_node_ids||[];return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),r.map(l=>a.jsxs("div",{children:[a.jsx("label",{style:n,children:l.label}),a.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),a.jsxs("div",{children:[a.jsx("label",{style:n,children:"Entry Node IDs"}),a.jsx("div",{style:t,children:o.length>0?o.join(", "):"-"})]}),s.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),s.map(([l,c])=>a.jsxs("div",{children:[a.jsx("label",{style:n,children:l}),a.jsx("div",{style:t,children:c})]},l))]})]})}function lg({label:e,items:t,selectedId:n,onSelect:r,isGroupActive:i}){const[s,o]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!s)return;const c=d=>{l.current&&!l.current.contains(d.target)&&o(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),t.length===0?null:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:i?"var(--text-primary)":"var(--text-muted)",background:i?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:i?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,a.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),s&&a.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>a.jsxs("button",{onClick:()=>{r(c.id),o(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:n===c.id?"var(--bg-selected)":"transparent",color:n===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&a.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function cg({label:e,isSelected:t,onClick:n}){return a.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function ZB({workspaceId:e,docType:t,loading:n=!1,roles:r=[],workflows:i=[],onArtifactSave:s,onCreateDcwWorkflow:o,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var He,at,Re;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,x]=m.useState("source"),[g,w]=m.useState(null),[v,y]=m.useState(!1),[b,_]=m.useState(null),[j,k]=m.useState(null),[N,E]=m.useState(!1),[S,R]=m.useState(null),[T,M]=m.useState(null),[z,C]=m.useState(!1),[L,P]=m.useState(null),[$,O]=m.useState(null),[A,F]=m.useState(!1),[I,q]=m.useState(null),W=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const X=t.role_prompt_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="role"?null:{roleId:X[2],version:X[3]}},[t==null?void 0:t.role_prompt_ref]),U=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const X=t.template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.template_ref]),Z=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const X=t.qa_template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const X=t.pgc_template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!W){w(null);return}y(!0),_(null),je.getRole(W.roleId,W.version).then(X=>{w(X.content)}).catch(X=>{console.error("Failed to load role:",X),_(X.message)}).finally(()=>{y(!1)})},[W]),m.useEffect(()=>{if(!U){k(null);return}E(!0),R(null),je.getTemplate(U.templateId,U.version).then(X=>{k(X.content)}).catch(X=>{console.error("Failed to load template:",X),R(X.message)}).finally(()=>{E(!1)})},[U]),m.useEffect(()=>{if(!Z){M(null);return}C(!0),P(null),je.getTemplate(Z.templateId,Z.version).then(X=>{M(X.content)}).catch(X=>{console.error("Failed to load QA template:",X),P(X.message)}).finally(()=>{C(!1)})},[Z]),m.useEffect(()=>{if(!B){O(null);return}F(!0),q(null),je.getTemplate(B.templateId,B.version).then(X=>{O(X.content)}).catch(X=>{console.error("Failed to load PGC template:",X),q(X.message)}).finally(()=>{F(!1)})},[B]);const ne=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const X=t.version||t.active_version;return`doctype:${t.doc_type_id}:${X}:${f}`},[t,f]),{content:ie,loading:le,error:J,saving:_e,isDirty:G,updateContent:ve,lastSaveResult:fe}=ja(e,ne,{onSave:X=>{s==null||s(ne,X)}}),se=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],ge=m.useMemo(()=>t?se.filter(X=>X.id==="package"?!0:X.id==="role_prompt"?!!t.role_prompt_ref:X.id==="template"?!!t.template_ref:X.id==="qa_template"?!!t.qa_template_ref:X.id==="pgc_template"?!!t.pgc_template_ref:X.id==="workflow"?!0:t.artifacts?t.artifacts[X.id]!=null:!1):[],[t]),Y=c==="task"||c==="schema";m.useEffect(()=>{Y||ge.length>0&&!ge.find(X=>X.id===f)&&p(ge[0].id)},[ge,f,Y]);const Q=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",pe=f==="package",ye=f==="schema",we=f==="workflow",xe=!Q&&!pe&&!ye&&!we,te=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:i.some(X=>X.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,i]),[he,Ge]=m.useState(!1),ze=async()=>{if(!(!(t!=null&&t.doc_type_id)||!o)){Ge(!0);try{await o(t.doc_type_id)}finally{Ge(!1)}}};if(!t&&!n)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),a.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(n)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),a.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const Be=c==="task"?"Interaction":c==="schema"?"Schema":null,Te=!Y&&(f==="task_prompt"||f==="schema");return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),a.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:Y?Be:a.jsxs(a.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),Y&&a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!Y&&a.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[ge.find(X=>X.id==="package")&&a.jsx(cg,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),x("source")}}),ge.find(X=>X.id==="workflow")&&a.jsx(cg,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),x("source")}}),(()=>{const X=["role_prompt","task_prompt","template"],Oe=ge.filter(me=>X.includes(me.id)).map(me=>({id:me.id,label:me.id==="role_prompt"?"Role":me.id==="task_prompt"?"Task":"Template",viewOnly:me.viewOnly}));return Oe.length===0?null:a.jsx(lg,{label:"Generation",items:Oe,selectedId:X.includes(f)?f:null,onSelect:me=>{p(me),x("source")},isGroupActive:X.includes(f)})})(),(()=>{const X=["qa_prompt","qa_template"],Oe=ge.filter(me=>X.includes(me.id)).map(me=>({id:me.id,label:me.id==="qa_prompt"?"Prompt":"Template",viewOnly:me.viewOnly}));return Oe.length===0?null:a.jsx(lg,{label:"QA",items:Oe,selectedId:X.includes(f)?f:null,onSelect:me=>{p(me),x("source")},isGroupActive:X.includes(f)})})(),(()=>{const X=["pgc_context","pgc_template"],Oe=ge.filter(me=>X.includes(me.id)).map(me=>({id:me.id,label:me.id==="pgc_context"?"Context":"Template",viewOnly:me.viewOnly}));return Oe.length===0?null:a.jsx(lg,{label:"PGC",items:Oe,selectedId:X.includes(f)?f:null,onSelect:me=>{p(me),x("source")},isGroupActive:X.includes(f)})})(),ge.find(X=>X.id==="schema")&&a.jsx(cg,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),x("source")}})]}),!Y&&xe&&!Te&&a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>x("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),a.jsx("button",{onClick:()=>x("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((He=t==null?void 0:t.artifacts)==null?void 0:He[f])&&a.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),Q&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&W&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[W.roleId.replace(/_/g," ")," v",W.version]}),f==="template"&&U&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[U.templateId.replace(/_/g," ")," v",U.version]}),f==="qa_template"&&Z&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[Z.templateId.replace(/_/g," ")," v",Z.version]}),f==="pgc_template"&&B&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Te&&a.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),ye&&((at=t==null?void 0:t.artifacts)==null?void 0:at.schema)&&a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:we?te?a.jsx(XB,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s,mechanicalOpTypes:d,mechanicalOps:u}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 max-w-md",children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),a.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),o&&a.jsx("button",{onClick:ze,disabled:he,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:he?"wait":"pointer",opacity:he?.7:1},children:he?"Creating...":"Create Workflow"})]})}):f==="package"?a.jsx(RB,{workspaceId:e,docType:t,roles:r,onSave:s}):f==="role_prompt"?a.jsx(tr,{content:g||"",onChange:()=>{},loading:v,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?a.jsx(tr,{content:j||"",onChange:()=>{},loading:N,saving:!1,isDirty:!1,error:S,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?a.jsx(tr,{content:T||"",onChange:()=>{},loading:z,saving:!1,isDirty:!1,error:L,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?a.jsx(tr,{content:$||"",onChange:()=>{},loading:A,saving:!1,isDirty:!1,error:I,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||ye?a.jsx(tr,{content:ie,onChange:Te?()=>{}:ve,loading:le,saving:Te?!1:_e,isDirty:Te?!1:G,error:J,readOnly:Te,placeholder:`Enter ${((Re=ge.find(X=>X.id===f))==null?void 0:Re.label)||"prompt"} content...`,isJson:ye}):a.jsx(TB,{workspaceId:e,artifactId:ne})}),xe&&(fe==null?void 0:fe.tier1)&&!fe.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function JB({workspaceId:e,role:t,onArtifactSave:n}){const r=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:i,loading:s,error:o,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=ja(e,r,{onSave:p=>{n==null||n(r,p)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),a.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),a.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:i,onChange:d,loading:s,saving:l,isDirty:c,error:o,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function WT(e){return typeof e>"u"||e===null}function e9(e){return typeof e=="object"&&e!==null}function t9(e){return Array.isArray(e)?e:WT(e)?[]:[e]}function n9(e,t){var n,r,i,s;if(t)for(s=Object.keys(t),n=0,r=s.length;n<r;n+=1)i=s[n],e[i]=t[i];return e}function r9(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function i9(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var s9=WT,o9=e9,a9=t9,l9=r9,c9=i9,u9=n9,dt={isNothing:s9,isObject:o9,toArray:a9,repeat:l9,isNegativeZero:c9,extend:u9};function UT(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function ra(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=UT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ra.prototype=Object.create(Error.prototype);ra.prototype.constructor=ra;ra.prototype.toString=function(t){return this.name+": "+UT(this,t)};var Ot=ra;function ug(e,t,n,r,i){var s="",o="",l=Math.floor(i/2)-1;return r-t>l&&(s=" ... ",t=r-l+s.length),n-r>l&&(o=" ...",n=r+l-o.length),{str:s+e.slice(t,n).replace(/\t/g,"")+o,pos:r-t+s.length}}function dg(e,t){return dt.repeat(" ",t-e.length)+e}function d9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],i=[],s,o=-1;s=n.exec(e.buffer);)i.push(s.index),r.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)d=ug(e.buffer,r[o-c],i[o-c],e.position-(r[o]-r[o-c]),f),l=dt.repeat(" ",t.indent)+dg((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=ug(e.buffer,r[o],i[o],e.position,f),l+=dt.repeat(" ",t.indent)+dg((e.line+1).toString(),u)+" | "+d.str+`
`,l+=dt.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)d=ug(e.buffer,r[o+c],i[o+c],e.position-(r[o]-r[o+c]),f),l+=dt.repeat(" ",t.indent)+dg((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var f9=d9,p9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],h9=["scalar","sequence","mapping"];function m9(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function g9(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(p9.indexOf(n)===-1)throw new Ot('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=m9(t.styleAliases||null),h9.indexOf(this.kind)===-1)throw new Ot('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var jt=g9;function rS(e,t){var n=[];return e[t].forEach(function(r){var i=n.length;n.forEach(function(s,o){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(i=o)}),n[i]=r}),n}function v9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function Iv(e){return this.extend(e)}Iv.prototype.extend=function(t){var n=[],r=[];if(t instanceof jt)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new Ot("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(s){if(!(s instanceof jt))throw new Ot("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new Ot("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Ot("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(s){if(!(s instanceof jt))throw new Ot("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Iv.prototype);return i.implicit=(this.implicit||[]).concat(n),i.explicit=(this.explicit||[]).concat(r),i.compiledImplicit=rS(i,"implicit"),i.compiledExplicit=rS(i,"explicit"),i.compiledTypeMap=v9(i.compiledImplicit,i.compiledExplicit),i};var VT=Iv,GT=new jt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),KT=new jt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),YT=new jt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),XT=new VT({explicit:[GT,KT,YT]});function x9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function y9(){return null}function b9(e){return e===null}var QT=new jt("tag:yaml.org,2002:null",{kind:"scalar",resolve:x9,construct:y9,predicate:b9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function w9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function _9(e){return e==="true"||e==="True"||e==="TRUE"}function j9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var ZT=new jt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:w9,construct:_9,predicate:j9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function S9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function k9(e){return 48<=e&&e<=55}function N9(e){return 48<=e&&e<=57}function C9(e){if(e===null)return!1;var t=e.length,n=0,r=!1,i;if(!t)return!1;if(i=e[n],(i==="-"||i==="+")&&(i=e[++n]),i==="0"){if(n+1===t)return!0;if(i=e[++n],i==="b"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!S9(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}if(i==="o"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!k9(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}}if(i==="_")return!1;for(;n<t;n++)if(i=e[n],i!=="_"){if(!N9(e.charCodeAt(n)))return!1;r=!0}return!(!r||i==="_")}function E9(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function T9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!dt.isNegativeZero(e)}var JT=new jt("tag:yaml.org,2002:int",{kind:"scalar",resolve:C9,construct:E9,predicate:T9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),R9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function A9(e){return!(e===null||!R9.test(e)||e[e.length-1]==="_")}function I9(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var M9=/^[-+]?[0-9]+e/;function P9(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(dt.isNegativeZero(e))return"-0.0";return n=e.toString(10),M9.test(n)?n.replace("e",".e"):n}function O9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||dt.isNegativeZero(e))}var e4=new jt("tag:yaml.org,2002:float",{kind:"scalar",resolve:A9,construct:I9,predicate:O9,represent:P9,defaultStyle:"lowercase"}),t4=XT.extend({implicit:[QT,ZT,JT,e4]}),n4=t4,r4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),i4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function D9(e){return e===null?!1:r4.exec(e)!==null||i4.exec(e)!==null}function L9(e){var t,n,r,i,s,o,l,c=0,d=null,u,f,p;if(t=r4.exec(e),t===null&&(t=i4.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(s=+t[4],o=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(n,r,i,s,o,l,c)),d&&p.setTime(p.getTime()-d),p}function F9(e){return e.toISOString()}var s4=new jt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:D9,construct:L9,instanceOf:Date,represent:F9});function z9(e){return e==="<<"||e===null}var o4=new jt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:z9}),by=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function q9(e){if(e===null)return!1;var t,n,r=0,i=e.length,s=by;for(n=0;n<i;n++)if(t=s.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function $9(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,s=by,o=0,l=[];for(t=0;t<i;t++)t%4===0&&t&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|s.indexOf(r.charAt(t));return n=i%4*6,n===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):n===18?(l.push(o>>10&255),l.push(o>>2&255)):n===12&&l.push(o>>4&255),new Uint8Array(l)}function B9(e){var t="",n=0,r,i,s=e.length,o=by;for(r=0;r<s;r++)r%3===0&&r&&(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]),n=(n<<8)+e[r];return i=s%3,i===0?(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]):i===2?(t+=o[n>>10&63],t+=o[n>>4&63],t+=o[n<<2&63],t+=o[64]):i===1&&(t+=o[n>>2&63],t+=o[n<<4&63],t+=o[64],t+=o[64]),t}function H9(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var a4=new jt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:q9,construct:$9,predicate:H9,represent:B9}),W9=Object.prototype.hasOwnProperty,U9=Object.prototype.toString;function V9(e){if(e===null)return!0;var t=[],n,r,i,s,o,l=e;for(n=0,r=l.length;n<r;n+=1){if(i=l[n],o=!1,U9.call(i)!=="[object Object]")return!1;for(s in i)if(W9.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function G9(e){return e!==null?e:[]}var l4=new jt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:V9,construct:G9}),K9=Object.prototype.toString;function Y9(e){if(e===null)return!0;var t,n,r,i,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1){if(r=o[t],K9.call(r)!=="[object Object]"||(i=Object.keys(r),i.length!==1))return!1;s[t]=[i[0],r[i[0]]]}return!0}function X9(e){if(e===null)return[];var t,n,r,i,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1)r=o[t],i=Object.keys(r),s[t]=[i[0],r[i[0]]];return s}var c4=new jt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Y9,construct:X9}),Q9=Object.prototype.hasOwnProperty;function Z9(e){if(e===null)return!0;var t,n=e;for(t in n)if(Q9.call(n,t)&&n[t]!==null)return!1;return!0}function J9(e){return e!==null?e:{}}var u4=new jt("tag:yaml.org,2002:set",{kind:"mapping",resolve:Z9,construct:J9}),wy=n4.extend({implicit:[s4,o4],explicit:[a4,l4,c4,u4]}),Xr=Object.prototype.hasOwnProperty,gc=1,d4=2,f4=3,vc=4,fg=1,eH=2,iS=3,tH=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,nH=/[\x85\u2028\u2029]/,rH=/[,\[\]\{\}]/,p4=/^(?:!|!!|![a-z\-]+!)$/i,h4=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function sS(e){return Object.prototype.toString.call(e)}function Un(e){return e===10||e===13}function yi(e){return e===9||e===32}function Ht(e){return e===9||e===32||e===10||e===13}function rs(e){return e===44||e===91||e===93||e===123||e===125}function iH(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function sH(e){return e===120?2:e===117?4:e===85?8:0}function oH(e){return 48<=e&&e<=57?e-48:-1}function oS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function aH(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function m4(e,t,n){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}var g4=new Array(256),v4=new Array(256);for(var $i=0;$i<256;$i++)g4[$i]=oS($i)?1:0,v4[$i]=oS($i);function lH(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||wy,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function x4(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=f9(n),new Ot(t,n)}function de(e,t){throw x4(e,t)}function xc(e,t){e.onWarning&&e.onWarning.call(null,x4(e,t))}var aS={YAML:function(t,n,r){var i,s,o;t.version!==null&&de(t,"duplication of %YAML directive"),r.length!==1&&de(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),i===null&&de(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&de(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&xc(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var i,s;r.length!==2&&de(t,"TAG directive accepts exactly two arguments"),i=r[0],s=r[1],p4.test(i)||de(t,"ill-formed tag handle (first argument) of the TAG directive"),Xr.call(t.tagMap,i)&&de(t,'there is a previously declared suffix for "'+i+'" tag handle'),h4.test(s)||de(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{de(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function Vr(e,t,n,r){var i,s,o,l;if(t<n){if(l=e.input.slice(t,n),r)for(i=0,s=l.length;i<s;i+=1)o=l.charCodeAt(i),o===9||32<=o&&o<=1114111||de(e,"expected valid JSON character");else tH.test(l)&&de(e,"the stream contains non-printable characters");e.result+=l}}function lS(e,t,n,r){var i,s,o,l;for(dt.isObject(n)||de(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(n),o=0,l=i.length;o<l;o+=1)s=i[o],Xr.call(t,s)||(m4(t,s,n[s]),r[s]=!0)}function is(e,t,n,r,i,s,o,l,c){var d,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),d=0,u=i.length;d<u;d+=1)Array.isArray(i[d])&&de(e,"nested arrays are not supported inside keys"),typeof i=="object"&&sS(i[d])==="[object Object]"&&(i[d]="[object Object]");if(typeof i=="object"&&sS(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(d=0,u=s.length;d<u;d+=1)lS(e,t,s[d],n);else lS(e,t,s,n);else!e.json&&!Xr.call(n,i)&&Xr.call(t,i)&&(e.line=o||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,de(e,"duplicated mapping key")),m4(t,i,s),delete n[i];return t}function _y(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):de(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function st(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);i!==0;){for(;yi(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Un(i))for(_y(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&xc(e,"deficient indentation"),r}function vu(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||Ht(n)))}function jy(e,t){t===1?e.result+=" ":t>1&&(e.result+=dt.repeat(`
`,t-1))}function cH(e,t,n){var r,i,s,o,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Ht(h)||rs(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(i=e.input.charCodeAt(e.position+1),Ht(i)||n&&rs(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,l=!1;h!==0;){if(h===58){if(i=e.input.charCodeAt(e.position+1),Ht(i)||n&&rs(i))break}else if(h===35){if(r=e.input.charCodeAt(e.position-1),Ht(r))break}else{if(e.position===e.lineStart&&vu(e)||n&&rs(h))break;if(Un(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,st(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Vr(e,s,o,!1),jy(e,e.line-c),s=o=e.position,l=!1),yi(h)||(o=e.position+1),h=e.input.charCodeAt(++e.position)}return Vr(e,s,o,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function uH(e,t){var n,r,i;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Vr(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,i=e.position;else return!0;else Un(n)?(Vr(e,r,i,!0),jy(e,st(e,!1,t)),r=i=e.position):e.position===e.lineStart&&vu(e)?de(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);de(e,"unexpected end of the stream within a single quoted scalar")}function dH(e,t){var n,r,i,s,o,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Vr(e,n,e.position,!0),e.position++,!0;if(l===92){if(Vr(e,n,e.position,!0),l=e.input.charCodeAt(++e.position),Un(l))st(e,!1,t);else if(l<256&&g4[l])e.result+=v4[l],e.position++;else if((o=sH(l))>0){for(i=o,s=0;i>0;i--)l=e.input.charCodeAt(++e.position),(o=iH(l))>=0?s=(s<<4)+o:de(e,"expected hexadecimal character");e.result+=aH(s),e.position++}else de(e,"unknown escape sequence");n=r=e.position}else Un(l)?(Vr(e,n,r,!0),jy(e,st(e,!1,t)),n=r=e.position):e.position===e.lineStart&&vu(e)?de(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}de(e,"unexpected end of the stream within a double quoted scalar")}function fH(e,t){var n=!0,r,i,s,o=e.tag,l,c=e.anchor,d,u,f,p,h,x=Object.create(null),g,w,v,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(st(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=o,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;n?y===44&&de(e,"expected the node content, but found ','"):de(e,"missed comma between flow collection entries"),w=g=v=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Ht(d)&&(f=p=!0,e.position++,st(e,!0,t))),r=e.line,i=e.lineStart,s=e.position,Ns(e,t,gc,!1,!0),w=e.tag,g=e.result,st(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===r)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),st(e,!0,t),Ns(e,t,gc,!1,!0),v=e.result),h?is(e,l,x,w,g,v,r,i,s):f?l.push(is(e,null,x,w,g,v,r,i,s)):l.push(g),st(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(n=!0,y=e.input.charCodeAt(++e.position)):n=!1}de(e,"unexpected end of the stream within a flow collection")}function pH(e,t){var n,r,i=fg,s=!1,o=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)r=!1;else if(f===62)r=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)fg===i?i=f===43?iS:eH:de(e,"repeat of a chomping mode identifier");else if((u=oH(f))>=0)u===0?de(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?de(e,"repeat of an indentation width identifier"):(l=t+u-1,o=!0);else break;if(yi(f)){do f=e.input.charCodeAt(++e.position);while(yi(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Un(f)&&f!==0)}for(;f!==0;){for(_y(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>l&&(l=e.lineIndent),Un(f)){c++;continue}if(e.lineIndent<l){i===iS?e.result+=dt.repeat(`
`,s?1+c:c):i===fg&&s&&(e.result+=`
`);break}for(r?yi(f)?(d=!0,e.result+=dt.repeat(`
`,s?1+c:c)):d?(d=!1,e.result+=dt.repeat(`
`,c+1)):c===0?s&&(e.result+=" "):e.result+=dt.repeat(`
`,c):e.result+=dt.repeat(`
`,s?1+c:c),s=!0,o=!0,c=0,n=e.position;!Un(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Vr(e,n,e.position,!1)}return!0}function cS(e,t){var n,r=e.tag,i=e.anchor,s=[],o,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,de(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!Ht(o))));){if(l=!0,e.position++,st(e,!0,-1)&&e.lineIndent<=t){s.push(null),c=e.input.charCodeAt(e.position);continue}if(n=e.line,Ns(e,t,f4,!1,!0),s.push(e.result),st(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&c!==0)de(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=r,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function hH(e,t,n){var r,i,s,o,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,x=null,g=null,w=!1,v=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!w&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,de(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,(y===63||y===58)&&Ht(r))y===63?(w&&(is(e,f,p,h,x,null,o,l,c),h=x=g=null),v=!0,w=!0,i=!0):w?(w=!1,i=!0):de(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=r;else{if(o=e.line,l=e.lineStart,c=e.position,!Ns(e,n,d4,!1,!0))break;if(e.line===s){for(y=e.input.charCodeAt(e.position);yi(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Ht(y)||de(e,"a whitespace character is expected after the key-value separator within a block mapping"),w&&(is(e,f,p,h,x,null,o,l,c),h=x=g=null),v=!0,w=!1,i=!1,h=e.tag,x=e.result;else if(v)de(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(v)de(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===s||e.lineIndent>t)&&(w&&(o=e.line,l=e.lineStart,c=e.position),Ns(e,t,vc,!0,i)&&(w?x=e.result:g=e.result),w||(is(e,f,p,h,x,g,o,l,c),h=x=g=null),st(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&y!==0)de(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return w&&is(e,f,p,h,x,null,o,l,c),v&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),v}function mH(e){var t,n=!1,r=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&de(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(n=!0,o=e.input.charCodeAt(++e.position)):o===33?(r=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,n){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):de(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Ht(o);)o===33&&(r?de(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),p4.test(i)||de(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),rH.test(s)&&de(e,"tag suffix cannot contain flow indicator characters")}s&&!h4.test(s)&&de(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{de(e,"tag name is malformed: "+s)}return n?e.tag=s:Xr.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:de(e,'undeclared tag handle "'+i+'"'),!0}function gH(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&de(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ht(n)&&!rs(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&de(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function vH(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ht(r)&&!rs(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&de(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Xr.call(e.anchorMap,n)||de(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],st(e,!0,-1),!0}function Ns(e,t,n,r,i){var s,o,l,c=1,d=!1,u=!1,f,p,h,x,g,w;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=l=vc===n||f4===n,r&&st(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;mH(e)||gH(e);)st(e,!0,-1)?(d=!0,l=s,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||i),(c===1||vc===n)&&(gc===n||d4===n?g=t:g=t+1,w=e.position-e.lineStart,c===1?l&&(cS(e,w)||hH(e,w,g))||fH(e,g)?u=!0:(o&&pH(e,g)||uH(e,g)||dH(e,g)?u=!0:vH(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&de(e,"alias node should not have any properties")):cH(e,g,gc===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&cS(e,w))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&de(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(x=e.implicitTypes[f],x.resolve(e.result)){e.result=x.construct(e.result),e.tag=x.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xr.call(e.typeMap[e.kind||"fallback"],e.tag))x=e.typeMap[e.kind||"fallback"][e.tag];else for(x=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){x=h[f];break}x||de(e,"unknown tag !<"+e.tag+">"),e.result!==null&&x.kind!==e.kind&&de(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+x.kind+'", not "'+e.kind+'"'),x.resolve(e.result,e.tag)?(e.result=x.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):de(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function xH(e){var t=e.position,n,r,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(st(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),n=e.position;o!==0&&!Ht(o);)o=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),i=[],r.length<1&&de(e,"directive name must not be less than one character in length");o!==0;){for(;yi(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Un(o));break}if(Un(o))break;for(n=e.position;o!==0&&!Ht(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(n,e.position))}o!==0&&_y(e),Xr.call(aS,r)?aS[r](e,r,i):xc(e,'unknown document directive "'+r+'"')}if(st(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,st(e,!0,-1)):s&&de(e,"directives end mark is expected"),Ns(e,e.lineIndent-1,vc,!1,!0),st(e,!0,-1),e.checkLineBreaks&&nH.test(e.input.slice(t,e.position))&&xc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&vu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,st(e,!0,-1));return}if(e.position<e.length-1)de(e,"end of the stream or a document separator is expected");else return}function y4(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new lH(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,de(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)xH(n);return n.documents}function yH(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=y4(e,n);if(typeof t!="function")return r;for(var i=0,s=r.length;i<s;i+=1)t(r[i])}function bH(e,t){var n=y4(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new Ot("expected a single document in the stream, but found more")}}var wH=yH,_H=bH,b4={loadAll:wH,load:_H},w4=Object.prototype.toString,_4=Object.prototype.hasOwnProperty,Sy=65279,jH=9,ia=10,SH=13,kH=32,NH=33,CH=34,Mv=35,EH=37,TH=38,RH=39,AH=42,j4=44,IH=45,yc=58,MH=61,PH=62,OH=63,DH=64,S4=91,k4=93,LH=96,N4=123,FH=124,C4=125,Mt={};Mt[0]="\\0";Mt[7]="\\a";Mt[8]="\\b";Mt[9]="\\t";Mt[10]="\\n";Mt[11]="\\v";Mt[12]="\\f";Mt[13]="\\r";Mt[27]="\\e";Mt[34]='\\"';Mt[92]="\\\\";Mt[133]="\\N";Mt[160]="\\_";Mt[8232]="\\L";Mt[8233]="\\P";var zH=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],qH=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function $H(e,t){var n,r,i,s,o,l,c;if(t===null)return{};for(n={},r=Object.keys(t),i=0,s=r.length;i<s;i+=1)o=r[i],l=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&_4.call(c.styleAliases,l)&&(l=c.styleAliases[l]),n[o]=l;return n}function BH(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new Ot("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+dt.repeat("0",r-t.length)+t}var HH=1,sa=2;function WH(e){this.schema=e.schema||wy,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=dt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=$H(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?sa:HH,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function uS(e,t){for(var n=dt.repeat(" ",t),r=0,i=-1,s="",o,l=e.length;r<l;)i=e.indexOf(`
`,r),i===-1?(o=e.slice(r),r=l):(o=e.slice(r,i+1),r=i+1),o.length&&o!==`
`&&(s+=n),s+=o;return s}function Pv(e,t){return`
`+dt.repeat(" ",e.indent*t)}function UH(e,t){var n,r,i;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(i=e.implicitTypes[n],i.resolve(t))return!0;return!1}function bc(e){return e===kH||e===jH}function oa(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Sy||65536<=e&&e<=1114111}function dS(e){return oa(e)&&e!==Sy&&e!==SH&&e!==ia}function fS(e,t,n){var r=dS(e),i=r&&!bc(e);return(n?r:r&&e!==j4&&e!==S4&&e!==k4&&e!==N4&&e!==C4)&&e!==Mv&&!(t===yc&&!i)||dS(t)&&!bc(t)&&e===Mv||t===yc&&i}function VH(e){return oa(e)&&e!==Sy&&!bc(e)&&e!==IH&&e!==OH&&e!==yc&&e!==j4&&e!==S4&&e!==k4&&e!==N4&&e!==C4&&e!==Mv&&e!==TH&&e!==AH&&e!==NH&&e!==FH&&e!==MH&&e!==PH&&e!==RH&&e!==CH&&e!==EH&&e!==DH&&e!==LH}function GH(e){return!bc(e)&&e!==yc}function xo(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function E4(e){var t=/^\n* /;return t.test(e)}var T4=1,Ov=2,R4=3,A4=4,Bi=5;function KH(e,t,n,r,i,s,o,l){var c,d=0,u=null,f=!1,p=!1,h=r!==-1,x=-1,g=VH(xo(e,0))&&GH(xo(e,e.length-1));if(t||o)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=xo(e,c),!oa(d))return Bi;g=g&&fS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=xo(e,c),d===ia)f=!0,h&&(p=p||c-x-1>r&&e[x+1]!==" ",x=c);else if(!oa(d))return Bi;g=g&&fS(d,u,l),u=d}p=p||h&&c-x-1>r&&e[x+1]!==" "}return!f&&!p?g&&!o&&!i(e)?T4:s===sa?Bi:Ov:n>9&&E4(e)?Bi:o?s===sa?Bi:Ov:p?A4:R4}function YH(e,t,n,r,i){e.dump=function(){if(t.length===0)return e.quotingType===sa?'""':"''";if(!e.noCompatMode&&(zH.indexOf(t)!==-1||qH.test(t)))return e.quotingType===sa?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,n),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),l=r||e.flowLevel>-1&&n>=e.flowLevel;function c(d){return UH(e,d)}switch(KH(t,l,e.indent,o,c,e.quotingType,e.forceQuotes&&!r,i)){case T4:return t;case Ov:return"'"+t.replace(/'/g,"''")+"'";case R4:return"|"+pS(t,e.indent)+hS(uS(t,s));case A4:return">"+pS(t,e.indent)+hS(uS(XH(t,o),s));case Bi:return'"'+QH(t)+'"';default:throw new Ot("impossible error: invalid scalar style")}}()}function pS(e,t){var n=E4(e)?String(t):"",r=e[e.length-1]===`
`,i=r&&(e[e.length-2]===`
`||e===`
`),s=i?"+":r?"":"-";return n+s+`
`}function hS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function XH(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,n.lastIndex=d,mS(e.slice(0,d),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=n.exec(e);){var l=o[1],c=o[2];s=c[0]===" ",r+=l+(!i&&!s&&c!==""?`
`:"")+mS(c,t),i=s}return r}function mS(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,i=0,s,o=0,l=0,c="";r=n.exec(e);)l=r.index,l-i>t&&(s=o>i?o:l,c+=`
`+e.slice(i,s),i=s+1),o=l;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function QH(e){for(var t="",n=0,r,i=0;i<e.length;n>=65536?i+=2:i++)n=xo(e,i),r=Mt[n],!r&&oa(n)?(t+=e[i],n>=65536&&(t+=e[i+1])):t+=r||BH(n);return t}function ZH(e,t,n){var r="",i=e.tag,s,o,l;for(s=0,o=n.length;s<o;s+=1)l=n[s],e.replacer&&(l=e.replacer.call(n,String(s),l)),(gr(e,t,l,!1,!1)||typeof l>"u"&&gr(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=i,e.dump="["+r+"]"}function gS(e,t,n,r){var i="",s=e.tag,o,l,c;for(o=0,l=n.length;o<l;o+=1)c=n[o],e.replacer&&(c=e.replacer.call(n,String(o),c)),(gr(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&gr(e,t+1,null,!0,!0,!1,!0))&&((!r||i!=="")&&(i+=Pv(e,t)),e.dump&&ia===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function JH(e,t,n){var r="",i=e.tag,s=Object.keys(n),o,l,c,d,u;for(o=0,l=s.length;o<l;o+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=s[o],d=n[c],e.replacer&&(d=e.replacer.call(n,c,d)),gr(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),gr(e,t,d,!1,!1)&&(u+=e.dump,r+=u));e.tag=i,e.dump="{"+r+"}"}function e7(e,t,n,r){var i="",s=e.tag,o=Object.keys(n),l,c,d,u,f,p;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new Ot("sortKeys must be a boolean or a function");for(l=0,c=o.length;l<c;l+=1)p="",(!r||i!=="")&&(p+=Pv(e,t)),d=o[l],u=n[d],e.replacer&&(u=e.replacer.call(n,d,u)),gr(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&ia===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Pv(e,t)),gr(e,t+1,u,!0,f)&&(e.dump&&ia===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,i+=p));e.tag=s,e.dump=i||"{}"}function vS(e,t,n){var r,i,s,o,l,c;for(i=n?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(l=i[s],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(n?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,w4.call(l.represent)==="[object Function]")r=l.represent(t,c);else if(_4.call(l.represent,c))r=l.represent[c](t,c);else throw new Ot("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=r}return!0}return!1}function gr(e,t,n,r,i,s,o){e.tag=null,e.dump=n,vS(e,n,!1)||vS(e,n,!0);var l=w4.call(e.dump),c=r,d;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(n),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(i=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")r&&Object.keys(e.dump).length!==0?(e7(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(JH(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?gS(e,t-1,e.dump,i):gS(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(ZH(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&YH(e,e.dump,t,s,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Ot("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function t7(e,t){var n=[],r=[],i,s;for(Dv(e,n,r),i=0,s=r.length;i<s;i+=1)t.duplicates.push(n[r[i]]);t.usedDuplicates=new Array(s)}function Dv(e,t,n){var r,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)n.indexOf(i)===-1&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Dv(e[i],t,n);else for(r=Object.keys(e),i=0,s=r.length;i<s;i+=1)Dv(e[r[i]],t,n)}function n7(e,t){t=t||{};var n=new WH(t);n.noRefs||t7(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),gr(n,0,r,!0,!0)?n.dump+`
`:""}var r7=n7,i7={dump:r7};function ky(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var s7=jt,o7=VT,a7=XT,l7=t4,c7=n4,u7=wy,d7=b4.load,f7=b4.loadAll,p7=i7.dump,h7=Ot,m7={binary:a4,float:e4,map:YT,null:QT,pairs:c4,set:u4,timestamp:s4,bool:ZT,int:JT,merge:o4,omap:l4,seq:KT,str:GT},g7=ky("safeLoad","load"),v7=ky("safeLoadAll","loadAll"),x7=ky("safeDump","dump"),I4={Type:s7,Schema:o7,FAILSAFE_SCHEMA:a7,JSON_SCHEMA:l7,CORE_SCHEMA:c7,DEFAULT_SCHEMA:u7,load:d7,loadAll:f7,dump:p7,YAMLException:h7,types:m7,safeLoad:g7,safeLoadAll:v7,safeDump:x7};const y7=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],pg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},hg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function b7({workspaceId:e,template:t,onArtifactSave:n}){const[r,i]=m.useState("metadata"),[s,o]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:x,error:g,saving:w,isDirty:v,updateContent:y,lastSaveResult:b}=ja(e,f,{onSave:S=>{n==null||n(f,S)}});m.useEffect(()=>{t&&(o({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const _=m.useCallback((S,R)=>{o(T=>({...T,[S]:R})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const S=I4.dump({name:s.name||null,purpose:s.purpose||null,use_case:s.use_case||null},{lineWidth:-1});await je.writeArtifact(e,p,S),c(!1),n==null||n(p,{success:!0})}catch(S){console.error("Failed to save metadata:",S),alert(`Failed to save metadata: ${S.message}`)}finally{u(!1)}}},[e,p,s,n]),k=m.useCallback(()=>{l&&j()},[l,j]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),a.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const N=s.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase()),E=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:N}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.active_version]}),a.jsx("span",{children:""}),a.jsx("span",{children:"Shared Template"}),s.purpose&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:s.purpose})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:E.map(S=>a.jsxs("button",{onClick:()=>i(S.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===S.id?"var(--text-primary)":"var(--text-muted)",background:r===S.id?"var(--bg-canvas)":"transparent",borderBottom:r===S.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[S.label,S.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),S.id==="template"&&v&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},S.id))}),r==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:hg,children:"Template Name"}),a.jsx("input",{type:"text",value:s.name,onChange:S=>_("name",S.target.value),onBlur:k,placeholder:"e.g., Document Generator",style:pg}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),a.jsxs("div",{children:[a.jsx("label",{style:hg,children:"Template Purpose"}),a.jsx("select",{value:s.purpose,onChange:S=>{_("purpose",S.target.value),setTimeout(()=>j(),0)},style:pg,children:y7.map(S=>a.jsx("option",{value:S.value,children:S.label},S.value))}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),a.jsxs("div",{children:[a.jsx("label",{style:hg,children:"Use Case"}),a.jsx("textarea",{value:s.use_case,onChange:S=>_("use_case",S.target.value),onBlur:k,placeholder:"Describe when and how this template should be used...",rows:4,style:{...pg,resize:"vertical"}}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),r==="template"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:h,onChange:y,loading:x,saving:w,isDirty:v,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ro={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function w7({workspaceId:e,schema:t,onArtifactSave:n}){var v;const[r,i]=m.useState("content"),s=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:o,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=ja(e,s,{onSave:y=>{n==null||n(s,y)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),a.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((v=t.schema_id)==null?void 0:v.replace(/_/g," "))||"Schema",x=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],w=!e;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",x]}),w&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(y=>a.jsxs("button",{onClick:()=>i(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===y.id?"var(--text-primary)":"var(--text-muted)",background:r===y.id?"var(--bg-canvas)":"transparent",borderBottom:r===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),r==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:o,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:w,isJson:!0})}),r==="info"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Schema ID"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Version"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Title (from JSON)"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),a.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"File Path"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",x,"/schema.json"]})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Artifact ID"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",x]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const _7={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},j7={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},mg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function S7({workspaceId:e,fragment:t,onArtifactSave:n}){var F;const[r,i]=m.useState("content"),[s,o]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,x]=((F=t==null?void 0:t.fragment_id)==null?void 0:F.split(":"))||[null,null],g=t?h==="role"?`fragment:role:${x}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,w=t&&h==="role"?`fragment:role:${x}:${t.version}:meta`:null,{content:v,loading:y,error:b,saving:_,isDirty:j,updateContent:k,lastSaveResult:N}=ja(e,g,{onSave:I=>{n==null||n(g,I)}});m.useEffect(()=>{t&&(o({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const E=m.useCallback((I,q)=>{o(W=>({...W,[I]:q})),c(!0)},[]),S=m.useCallback(async()=>{if(!(!e||!w)){u(!0);try{const I=I4.dump({name:s.name||null,intent:s.intent||null,tags:s.tags.length>0?s.tags:null},{lineWidth:-1});await je.writeArtifact(e,w,I),c(!1),n==null||n(w,{success:!0})}catch(I){console.error("Failed to save metadata:",I),alert(`Failed to save metadata: ${I.message}`)}finally{u(!1)}}},[e,w,s,n]),R=m.useCallback(()=>{l&&w&&S()},[l,w,S]),T=m.useCallback(()=>{const I=f.trim().toLowerCase();I&&!s.tags.includes(I)&&(E("tags",[...s.tags,I]),p(""))},[f,s.tags,E]),M=m.useCallback(I=>{E("tags",s.tags.filter(q=>q!==I))},[s.tags,E]),z=m.useCallback(I=>{I.key==="Enter"&&(I.preventDefault(),T())},[T]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),a.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const C=s.name||t.name||t.fragment_id,L=_7[h]||h,P=j7[h]||"var(--text-muted)",$=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],O=!e,A=w&&!O;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[C,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:P,color:"#fff"},children:L})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsxs("span",{children:["from ",t.source_doc_type]})]}),O&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:$.map(I=>a.jsxs("button",{onClick:()=>i(I.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===I.id?"var(--text-primary)":"var(--text-muted)",background:r===I.id?"var(--bg-canvas)":"transparent",borderBottom:r===I.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[I.label,I.id==="content"&&j&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),I.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},I.id))}),r==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:v,onChange:k,loading:y,saving:_,isDirty:j,error:b,placeholder:"Enter prompt content...",readOnly:O})}),r==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Kind"}),a.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:P}}),a.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:L})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Name"}),a.jsx("input",{type:"text",value:s.name,onChange:I=>E("name",I.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:mg,disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Intent"}),a.jsx("textarea",{value:s.intent,onChange:I=>E("intent",I.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...mg,resize:"vertical"},disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:s.tags.map(I=>a.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[I,A&&a.jsx("button",{onClick:()=>M(I),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},I))}),A&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),onKeyDown:z,placeholder:"Add tag...",style:{...mg,flex:1}}),a.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Source"}),a.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",a.jsx("strong",{children:t.source_doc_type})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!A&&!t.source_doc_type&&a.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(N==null?void 0:N.tier1)&&!N.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function k7(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>r=>{t.forEach(i=>i(r))},t)}const xu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ls(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ny(e){return"nodeType"in e}function Yt(e){var t,n;return e?Ls(e)?e:Ny(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Cy(e){const{Document:t}=Yt(e);return e instanceof t}function Sa(e){return Ls(e)?!1:e instanceof Yt(e).HTMLElement}function M4(e){return e instanceof Yt(e).SVGElement}function Fs(e){return e?Ls(e)?e.document:Ny(e)?Cy(e)?e:Sa(e)||M4(e)?e.ownerDocument:document:document:document}const Gn=xu?m.useLayoutEffect:m.useEffect;function Ey(e){const t=m.useRef(e);return Gn(()=>{t.current=e}),m.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}function N7(){const e=m.useRef(null),t=m.useCallback((r,i)=>{e.current=setInterval(r,i)},[]),n=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function aa(e,t){t===void 0&&(t=[e]);const n=m.useRef(e);return Gn(()=>{n.current!==e&&(n.current=e)},t),n}function ka(e,t){const n=m.useRef();return m.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function wc(e){const t=Ey(e),n=m.useRef(null),r=m.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,r]}function Lv(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let gg={};function Na(e,t){return m.useMemo(()=>{if(t)return t;const n=gg[e]==null?0:gg[e]+1;return gg[e]=n,e+"-"+n},[e,t])}function P4(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((s,o)=>{const l=Object.entries(o);for(const[c,d]of l){const u=s[c];u!=null&&(s[c]=u+e*d)}return s},{...t})}}const hs=P4(1),la=P4(-1);function C7(e){return"clientX"in e&&"clientY"in e}function Ty(e){if(!e)return!1;const{KeyboardEvent:t}=Yt(e.target);return t&&e instanceof t}function E7(e){if(!e)return!1;const{TouchEvent:t}=Yt(e.target);return t&&e instanceof t}function Fv(e){if(E7(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return C7(e)?{x:e.clientX,y:e.clientY}:null}const Cs=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Cs.Translate.toString(e),Cs.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),xS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function T7(e){return e.matches(xS)?e:e.querySelector(xS)}const R7={display:"none"};function A7(e){let{id:t,value:n}=e;return V.createElement("div",{id:t,style:R7},n)}function I7(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return V.createElement("div",{id:t,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function M7(){const[e,t]=m.useState("");return{announce:m.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const O4=m.createContext(null);function P7(e){const t=m.useContext(O4);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function O7(){const[e]=m.useState(()=>new Set),t=m.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[m.useCallback(r=>{let{type:i,event:s}=r;e.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[e]),t]}const D7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},L7={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function F7(e){let{announcements:t=L7,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=D7}=e;const{announce:s,announcement:o}=M7(),l=Na("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),P7(m.useMemo(()=>({onDragStart(f){let{active:p}=f;s(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&s(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;s(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;s(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;s(t.onDragCancel({active:p,over:h}))}}),[s,t])),!c)return null;const u=V.createElement(V.Fragment,null,V.createElement(A7,{id:r,value:i.draggable}),V.createElement(I7,{id:l,announcement:o}));return n?ts.createPortal(u,n):u}var ut;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ut||(ut={}));function _c(){}function jc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function D4(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const In=Object.freeze({x:0,y:0});function L4(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function F4(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function z7(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function yS(e){let{left:t,top:n,height:r,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+r},{x:t+i,y:n+r}]}function z4(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function bS(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const q4=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=bS(t,t.left,t.top),s=[];for(const o of r){const{id:l}=o,c=n.get(l);if(c){const d=L4(bS(c),i);s.push({id:l,data:{droppableContainer:o,value:d}})}}return s.sort(F4)},q7=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=yS(t),s=[];for(const o of r){const{id:l}=o,c=n.get(l);if(c){const d=yS(c),u=i.reduce((p,h,x)=>p+L4(d[x],h),0),f=Number((u/4).toFixed(4));s.push({id:l,data:{droppableContainer:o,value:f}})}}return s.sort(F4)};function $7(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),o=i-r,l=s-n;if(r<i&&n<s){const c=t.width*t.height,d=e.width*e.height,u=o*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const B7=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=[];for(const s of r){const{id:o}=s,l=n.get(o);if(l){const c=$7(l,t);c>0&&i.push({id:o,data:{droppableContainer:s,value:c}})}}return i.sort(z7)};function H7(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function $4(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:In}function W7(e){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...n})}}const U7=W7(1);function V7(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function G7(e,t,n){const r=V7(t);if(!r)return e;const{scaleX:i,scaleY:s,x:o,y:l}=r,c=e.left-o-(1-i)*parseFloat(n),d=e.top-l-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),u=i?e.width/i:e.width,f=s?e.height/s:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const K7={ignoreTransform:!1};function zs(e,t){t===void 0&&(t=K7);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Yt(e).getComputedStyle(e);d&&(n=G7(n,d,u))}const{top:r,left:i,width:s,height:o,bottom:l,right:c}=n;return{top:r,left:i,width:s,height:o,bottom:l,right:c}}function wS(e){return zs(e,{ignoreTransform:!0})}function Y7(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function X7(e,t){return t===void 0&&(t=Yt(e).getComputedStyle(e)),t.position==="fixed"}function Q7(e,t){t===void 0&&(t=Yt(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?n.test(s):!1})}function yu(e,t){const n=[];function r(i){if(t!=null&&n.length>=t||!i)return n;if(Cy(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Sa(i)||M4(i)||n.includes(i))return n;const s=Yt(e).getComputedStyle(i);return i!==e&&Q7(i,s)&&n.push(i),X7(i,s)?n:r(i.parentNode)}return e?r(e):n}function B4(e){const[t]=yu(e,1);return t??null}function vg(e){return!xu||!e?null:Ls(e)?e:Ny(e)?Cy(e)||e===Fs(e).scrollingElement?window:Sa(e)?e:null:null}function H4(e){return Ls(e)?e.scrollX:e.scrollLeft}function W4(e){return Ls(e)?e.scrollY:e.scrollTop}function zv(e){return{x:H4(e),y:W4(e)}}var mt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(mt||(mt={}));function U4(e){return!xu||!e?!1:e===document.scrollingElement}function V4(e){const t={x:0,y:0},n=U4(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,o=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:r,minScroll:t}}const Z7={x:.2,y:.2};function J7(e,t,n,r,i){let{top:s,left:o,right:l,bottom:c}=n;r===void 0&&(r=10),i===void 0&&(i=Z7);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=V4(e),h={x:0,y:0},x={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!d&&s<=t.top+g.height?(h.y=mt.Backward,x.y=r*Math.abs((t.top+g.height-s)/g.height)):!u&&c>=t.bottom-g.height&&(h.y=mt.Forward,x.y=r*Math.abs((t.bottom-g.height-c)/g.height)),!p&&l>=t.right-g.width?(h.x=mt.Forward,x.x=r*Math.abs((t.right-g.width-l)/g.width)):!f&&o<=t.left+g.width&&(h.x=mt.Backward,x.x=r*Math.abs((t.left+g.width-o)/g.width)),{direction:h,speed:x}}function eW(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:t,left:n,right:r,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:i,width:e.clientWidth,height:e.clientHeight}}function G4(e){return e.reduce((t,n)=>hs(t,zv(n)),In)}function tW(e){return e.reduce((t,n)=>t+H4(n),0)}function nW(e){return e.reduce((t,n)=>t+W4(n),0)}function rW(e,t){if(t===void 0&&(t=zs),!e)return;const{top:n,left:r,bottom:i,right:s}=t(e);B4(e)&&(i<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const iW=[["x",["left","right"],tW],["y",["top","bottom"],nW]];class Ry{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=yu(n),i=G4(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,o,l]of iW)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(r),u=i[s]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class To{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var i;(i=this.target)==null||i.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function sW(e){const{EventTarget:t}=Yt(e);return e instanceof t?e:Fs(e)}function xg(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var un;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(un||(un={}));function _S(e){e.preventDefault()}function oW(e){e.stopPropagation()}var Ie;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ie||(Ie={}));const K4={start:[Ie.Space,Ie.Enter],cancel:[Ie.Esc],end:[Ie.Space,Ie.Enter,Ie.Tab]},aW=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Ie.Right:return{...n,x:n.x+25};case Ie.Left:return{...n,x:n.x-25};case Ie.Down:return{...n,y:n.y+25};case Ie.Up:return{...n,y:n.y-25}}};class bu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new To(Fs(n)),this.windowListeners=new To(Yt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(un.Resize,this.handleCancel),this.windowListeners.add(un.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(un.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&rW(r),n(In)}handleKeyDown(t){if(Ty(t)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:s=K4,coordinateGetter:o=aW,scrollBehavior:l="smooth"}=i,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=r.current,u=d?{x:d.left,y:d.top}:In;this.referenceCoordinates||(this.referenceCoordinates=u);const f=o(t,{active:n,context:r.current,currentCoordinates:u});if(f){const p=la(f,u),h={x:0,y:0},{scrollableAncestors:x}=r.current;for(const g of x){const w=t.code,{isTop:v,isRight:y,isLeft:b,isBottom:_,maxScroll:j,minScroll:k}=V4(g),N=eW(g),E={x:Math.min(w===Ie.Right?N.right-N.width/2:N.right,Math.max(w===Ie.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(w===Ie.Down?N.bottom-N.height/2:N.bottom,Math.max(w===Ie.Down?N.top:N.top+N.height/2,f.y))},S=w===Ie.Right&&!y||w===Ie.Left&&!b,R=w===Ie.Down&&!_||w===Ie.Up&&!v;if(S&&E.x!==f.x){const T=g.scrollLeft+p.x,M=w===Ie.Right&&T<=j.x||w===Ie.Left&&T>=k.x;if(M&&!p.y){g.scrollTo({left:T,behavior:l});return}M?h.x=g.scrollLeft-T:h.x=w===Ie.Right?g.scrollLeft-j.x:g.scrollLeft-k.x,h.x&&g.scrollBy({left:-h.x,behavior:l});break}else if(R&&E.y!==f.y){const T=g.scrollTop+p.y,M=w===Ie.Down&&T<=j.y||w===Ie.Up&&T>=k.y;if(M&&!p.x){g.scrollTo({top:T,behavior:l});return}M?h.y=g.scrollTop-T:h.y=w===Ie.Down?g.scrollTop-j.y:g.scrollTop-k.y,h.y&&g.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,hs(la(f,this.referenceCoordinates),h))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}bu.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=K4,onActivation:i}=t,{active:s}=n;const{code:o}=e.nativeEvent;if(r.start.includes(o)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function jS(e){return!!(e&&"distance"in e)}function SS(e){return!!(e&&"delay"in e)}class Ay{constructor(t,n,r){var i;r===void 0&&(r=sW(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:o}=s;this.props=t,this.events=n,this.document=Fs(o),this.documentListeners=new To(this.document),this.listeners=new To(r),this.windowListeners=new To(Yt(o)),this.initialCoordinates=(i=Fv(s))!=null?i:In,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(un.Resize,this.handleCancel),this.windowListeners.add(un.DragStart,_S),this.windowListeners.add(un.VisibilityChange,this.handleCancel),this.windowListeners.add(un.ContextMenu,_S),this.documentListeners.add(un.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(SS(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(jS(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:i}=this.props;i(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(un.Click,oW,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(un.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const c=(n=Fv(t))!=null?n:In,d=la(i,c);if(!r&&l){if(jS(l)){if(l.tolerance!=null&&xg(d,l.tolerance))return this.handleCancel();if(xg(d,l.distance))return this.handleStart()}if(SS(l)&&xg(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Ie.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const lW={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class wu extends Ay{constructor(t){const{event:n}=t,r=Fs(n.target);super(t,lW,r)}}wu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const cW={move:{name:"mousemove"},end:{name:"mouseup"}};var qv;(function(e){e[e.RightClick=2]="RightClick"})(qv||(qv={}));class uW extends Ay{constructor(t){super(t,cW,Fs(t.event.target))}}uW.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===qv.RightClick?!1:(r==null||r({event:n}),!0)}}];const yg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class dW extends Ay{constructor(t){super(t,yg)}static setup(){return window.addEventListener(yg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(yg.move.name,t)};function t(){}}}dW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var Ro;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ro||(Ro={}));var Sc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Sc||(Sc={}));function fW(e){let{acceleration:t,activator:n=Ro.Pointer,canScroll:r,draggingRect:i,enabled:s,interval:o=5,order:l=Sc.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=hW({delta:f,disabled:!s}),[x,g]=N7(),w=m.useRef({x:0,y:0}),v=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(n){case Ro.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Ro.DraggableRect:return i}},[n,i,c]),b=m.useRef(null),_=m.useCallback(()=>{const k=b.current;if(!k)return;const N=w.current.x*v.current.x,E=w.current.y*v.current.y;k.scrollBy(N,E)},[]),j=m.useMemo(()=>l===Sc.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!s||!d.length||!y){g();return}for(const k of j){if((r==null?void 0:r(k))===!1)continue;const N=d.indexOf(k),E=u[N];if(!E)continue;const{direction:S,speed:R}=J7(k,E,y,t,p);for(const T of["x","y"])h[T][S[T]]||(R[T]=0,S[T]=0);if(R.x>0||R.y>0){g(),b.current=k,x(_,o),w.current=R,v.current=S;return}}w.current={x:0,y:0},v.current={x:0,y:0},g()},[t,_,r,g,s,o,JSON.stringify(y),JSON.stringify(h),x,d,j,u,JSON.stringify(p)])}const pW={x:{[mt.Backward]:!1,[mt.Forward]:!1},y:{[mt.Backward]:!1,[mt.Forward]:!1}};function hW(e){let{delta:t,disabled:n}=e;const r=Lv(t);return ka(i=>{if(n||!r||!i)return pW;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[mt.Backward]:i.x[mt.Backward]||s.x===-1,[mt.Forward]:i.x[mt.Forward]||s.x===1},y:{[mt.Backward]:i.y[mt.Backward]||s.y===-1,[mt.Forward]:i.y[mt.Forward]||s.y===1}}},[n,t,r])}function mW(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return ka(i=>{var s;return t==null?null:(s=r??i)!=null?s:null},[r,t])}function gW(e,t){return m.useMemo(()=>e.reduce((n,r)=>{const{sensor:i}=r,s=i.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,r)}));return[...n,...s]},[]),[e,t])}var ca;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(ca||(ca={}));var $v;(function(e){e.Optimized="optimized"})($v||($v={}));const kS=new Map;function vW(e,t){let{dragging:n,dependencies:r,config:i}=t;const[s,o]=m.useState(null),{frequency:l,measure:c,strategy:d}=i,u=m.useRef(e),f=w(),p=aa(f),h=m.useCallback(function(v){v===void 0&&(v=[]),!p.current&&o(y=>y===null?v:y.concat(v.filter(b=>!y.includes(b))))},[p]),x=m.useRef(null),g=ka(v=>{if(f&&!n)return kS;if(!v||v===kS||u.current!==e||s!=null){const y=new Map;for(let b of e){if(!b)continue;if(s&&s.length>0&&!s.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const _=b.node.current,j=_?new Ry(c(_),_):null;b.rect.current=j,j&&y.set(b.id,j)}return y}return v},[e,s,n,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[n,f]),m.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),m.useEffect(()=>{f||typeof l!="number"||x.current!==null||(x.current=setTimeout(()=>{h(),x.current=null},l))},[l,f,h,...r]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:s!=null};function w(){switch(d){case ca.Always:return!1;case ca.BeforeDragging:return n;default:return!n}}}function Y4(e,t){return ka(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function xW(e,t){return Y4(e,t)}function yW(e){let{callback:t,disabled:n}=e;const r=Ey(t),i=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function _u(e){let{callback:t,disabled:n}=e;const r=Ey(t),i=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function bW(e){return new Ry(zs(e),e)}function NS(e,t,n){t===void 0&&(t=bW);const[r,i]=m.useState(null);function s(){i(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??n)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const o=yW({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=_u({callback:s});return Gn(()=>{s(),e?(l==null||l.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[e]),r}function wW(e){const t=Y4(e);return $4(e,t)}const CS=[];function _W(e){const t=m.useRef(e),n=ka(r=>e?r&&r!==CS&&e&&t.current&&e.parentNode===t.current.parentNode?r:yu(e):CS,[e]);return m.useEffect(()=>{t.current=e},[e]),n}function jW(e){const[t,n]=m.useState(null),r=m.useRef(e),i=m.useCallback(s=>{const o=vg(s.target);o&&n(l=>l?(l.set(o,zv(o)),new Map(l)):null)},[]);return m.useEffect(()=>{const s=r.current;if(e!==s){o(s);const l=e.map(c=>{const d=vg(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,zv(d)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),r.current=e}return()=>{o(e),o(s)};function o(l){l.forEach(c=>{const d=vg(c);d==null||d.removeEventListener("scroll",i)})}},[i,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,o)=>hs(s,o),In):G4(e):In,[e,t])}function ES(e,t){t===void 0&&(t=[]);const n=m.useRef(null);return m.useEffect(()=>{n.current=null},t),m.useEffect(()=>{const r=e!==In;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?la(e,n.current):In}function SW(e){m.useEffect(()=>{if(!xu)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function kW(e,t){return m.useMemo(()=>e.reduce((n,r)=>{let{eventName:i,handler:s}=r;return n[i]=o=>{s(o,t)},n},{}),[e,t])}function X4(e){return m.useMemo(()=>e?Y7(e):null,[e])}const TS=[];function NW(e,t){t===void 0&&(t=zs);const[n]=e,r=X4(n?Yt(n):null),[i,s]=m.useState(TS);function o(){s(()=>e.length?e.map(c=>U4(c)?r:new Ry(t(c),c)):TS)}const l=_u({callback:o});return Gn(()=>{l==null||l.disconnect(),o(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),i}function CW(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Sa(t)?t:e}function EW(e){let{measure:t}=e;const[n,r]=m.useState(null),i=m.useCallback(d=>{for(const{target:u}of d)if(Sa(u)){r(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),s=_u({callback:i}),o=m.useCallback(d=>{const u=CW(d);s==null||s.disconnect(),u&&(s==null||s.observe(u)),r(u?t(u):null)},[t,s]),[l,c]=wc(o);return m.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const TW=[{sensor:wu,options:{}},{sensor:bu,options:{}}],RW={current:{}},Rl={draggable:{measure:wS},droppable:{measure:wS,strategy:ca.WhileDragging,frequency:$v.Optimized},dragOverlay:{measure:zs}};class Ao extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const AW={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ao,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:_c},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Rl,measureDroppableContainers:_c,windowRect:null,measuringScheduled:!1},IW={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:_c,draggableNodes:new Map,over:null,measureDroppableContainers:_c},ju=m.createContext(IW),Q4=m.createContext(AW);function MW(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ao}}}function PW(e,t){switch(t.type){case ut.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ut.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ut.DragEnd:case ut.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ut.RegisterDroppable:{const{element:n}=t,{id:r}=n,i=new Ao(e.droppable.containers);return i.set(r,n),{...e,droppable:{...e.droppable,containers:i}}}case ut.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const o=new Ao(e.droppable.containers);return o.set(n,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case ut.UnregisterDroppable:{const{id:n,key:r}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new Ao(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function OW(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:i}=m.useContext(ju),s=Lv(r),o=Lv(n==null?void 0:n.id);return m.useEffect(()=>{if(!t&&!r&&s&&o!=null){if(!Ty(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=T7(u);if(f){f.focus();break}}})}},[r,t,i,o,s]),null}function DW(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...r}),n):n}function LW(e){return m.useMemo(()=>({draggable:{...Rl.draggable,...e==null?void 0:e.draggable},droppable:{...Rl.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Rl.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function FW(e){let{activeNode:t,measure:n,initialRect:r,config:i=!0}=e;const s=m.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Gn(()=>{if(!o&&!l||!t){s.current=!1;return}if(s.current||!r)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=n(d),f=$4(u,r);if(o||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=B4(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,o,l,r,n])}const Z4=m.createContext({...In,scaleX:1,scaleY:1});var Cr;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Cr||(Cr={}));const J4=m.memo(function(t){var n,r,i,s;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:u=TW,collisionDetection:f=B7,measuring:p,modifiers:h,...x}=t;const g=m.useReducer(PW,void 0,MW),[w,v]=g,[y,b]=O7(),[_,j]=m.useState(Cr.Uninitialized),k=_===Cr.Initialized,{draggable:{active:N,nodes:E,translate:S},droppable:{containers:R}}=w,T=N!=null?E.get(N):null,M=m.useRef({initial:null,translated:null}),z=m.useMemo(()=>{var re;return N!=null?{id:N,data:(re=T==null?void 0:T.data)!=null?re:RW,rect:M}:null},[N,T]),C=m.useRef(null),[L,P]=m.useState(null),[$,O]=m.useState(null),A=aa(x,Object.values(x)),F=Na("DndDescribedBy",o),I=m.useMemo(()=>R.getEnabled(),[R]),q=LW(p),{droppableRects:W,measureDroppableContainers:U,measuringScheduled:Z}=vW(I,{dragging:k,dependencies:[S.x,S.y],config:q.droppable}),B=mW(E,N),ne=m.useMemo(()=>$?Fv($):null,[$]),ie=K(),le=xW(B,q.draggable.measure);FW({activeNode:N!=null?E.get(N):null,config:ie.layoutShiftCompensation,initialRect:le,measure:q.draggable.measure});const J=NS(B,q.draggable.measure,le),_e=NS(B?B.parentElement:null),G=m.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ve=R.getNodeFor((n=G.current.over)==null?void 0:n.id),fe=EW({measure:q.dragOverlay.measure}),se=(r=fe.nodeRef.current)!=null?r:B,ge=k?(i=fe.rect)!=null?i:J:null,Y=!!(fe.nodeRef.current&&fe.rect),Q=wW(Y?null:J),pe=X4(se?Yt(se):null),ye=_W(k?ve??B:null),we=NW(ye),xe=DW(h,{transform:{x:S.x-Q.x,y:S.y-Q.y,scaleX:1,scaleY:1},activatorEvent:$,active:z,activeNodeRect:J,containerNodeRect:_e,draggingNodeRect:ge,over:G.current.over,overlayNodeRect:fe.rect,scrollableAncestors:ye,scrollableAncestorRects:we,windowRect:pe}),te=ne?hs(ne,S):null,he=jW(ye),Ge=ES(he),ze=ES(he,[J]),Be=hs(xe,Ge),Te=ge?U7(ge,xe):null,He=z&&Te?f({active:z,collisionRect:Te,droppableRects:W,droppableContainers:I,pointerCoordinates:te}):null,at=z4(He,"id"),[Re,X]=m.useState(null),Oe=Y?xe:hs(xe,ze),me=H7(Oe,(s=Re==null?void 0:Re.rect)!=null?s:null,J),kt=m.useRef(null),xt=m.useCallback((re,De)=>{let{sensor:lt,options:an}=De;if(C.current==null)return;const Nt=E.get(C.current);if(!Nt)return;const bt=re.nativeEvent,ue=new lt({active:C.current,activeNode:Nt,event:bt,options:an,context:G,onAbort(Ae){if(!E.get(Ae))return;const{onDragAbort:ln}=A.current,wn={id:Ae};ln==null||ln(wn),y({type:"onDragAbort",event:wn})},onPending(Ae,zt,ln,wn){if(!E.get(Ae))return;const{onDragPending:ni}=A.current,Dn={id:Ae,constraint:zt,initialCoordinates:ln,offset:wn};ni==null||ni(Dn),y({type:"onDragPending",event:Dn})},onStart(Ae){const zt=C.current;if(zt==null)return;const ln=E.get(zt);if(!ln)return;const{onDragStart:wn}=A.current,ti={activatorEvent:bt,active:{id:zt,data:ln.data,rect:M}};ts.unstable_batchedUpdates(()=>{wn==null||wn(ti),j(Cr.Initializing),v({type:ut.DragStart,initialCoordinates:Ae,active:zt}),y({type:"onDragStart",event:ti}),P(kt.current),O(bt)})},onMove(Ae){v({type:ut.DragMove,coordinates:Ae})},onEnd:ce(ut.DragEnd),onCancel:ce(ut.DragCancel)});kt.current=ue;function ce(Ae){return async function(){const{active:ln,collisions:wn,over:ti,scrollAdjustedTranslate:ni}=G.current;let Dn=null;if(ln&&ni){const{cancelDrop:ri}=A.current;Dn={activatorEvent:bt,active:ln,collisions:wn,delta:ni,over:ti},Ae===ut.DragEnd&&typeof ri=="function"&&await Promise.resolve(ri(Dn))&&(Ae=ut.DragCancel)}C.current=null,ts.unstable_batchedUpdates(()=>{v({type:Ae}),j(Cr.Uninitialized),X(null),P(null),O(null),kt.current=null;const ri=Ae===ut.DragEnd?"onDragEnd":"onDragCancel";if(Dn){const qs=A.current[ri];qs==null||qs(Dn),y({type:ri,event:Dn})}})}}},[E]),yt=m.useCallback((re,De)=>(lt,an)=>{const Nt=lt.nativeEvent,bt=E.get(an);if(C.current!==null||!bt||Nt.dndKit||Nt.defaultPrevented)return;const ue={active:bt};re(lt,De.options,ue)===!0&&(Nt.dndKit={capturedBy:De.sensor},C.current=an,xt(lt,De))},[E,xt]),Xt=gW(u,yt);SW(u),Gn(()=>{J&&_===Cr.Initializing&&j(Cr.Initialized)},[J,_]),m.useEffect(()=>{const{onDragMove:re}=A.current,{active:De,activatorEvent:lt,collisions:an,over:Nt}=G.current;if(!De||!lt)return;const bt={active:De,activatorEvent:lt,collisions:an,delta:{x:Be.x,y:Be.y},over:Nt};ts.unstable_batchedUpdates(()=>{re==null||re(bt),y({type:"onDragMove",event:bt})})},[Be.x,Be.y]),m.useEffect(()=>{const{active:re,activatorEvent:De,collisions:lt,droppableContainers:an,scrollAdjustedTranslate:Nt}=G.current;if(!re||C.current==null||!De||!Nt)return;const{onDragOver:bt}=A.current,ue=an.get(at),ce=ue&&ue.rect.current?{id:ue.id,rect:ue.rect.current,data:ue.data,disabled:ue.disabled}:null,Ae={active:re,activatorEvent:De,collisions:lt,delta:{x:Nt.x,y:Nt.y},over:ce};ts.unstable_batchedUpdates(()=>{X(ce),bt==null||bt(Ae),y({type:"onDragOver",event:Ae})})},[at]),Gn(()=>{G.current={activatorEvent:$,active:z,activeNode:B,collisionRect:Te,collisions:He,droppableRects:W,draggableNodes:E,draggingNode:se,draggingNodeRect:ge,droppableContainers:R,over:Re,scrollableAncestors:ye,scrollAdjustedTranslate:Be},M.current={initial:ge,translated:Te}},[z,B,He,Te,E,se,ge,W,R,Re,ye,Be]),fW({...ie,delta:S,draggingRect:Te,pointerCoordinates:te,scrollableAncestors:ye,scrollableAncestorRects:we});const D=m.useMemo(()=>({active:z,activeNode:B,activeNodeRect:J,activatorEvent:$,collisions:He,containerNodeRect:_e,dragOverlay:fe,draggableNodes:E,droppableContainers:R,droppableRects:W,over:Re,measureDroppableContainers:U,scrollableAncestors:ye,scrollableAncestorRects:we,measuringConfiguration:q,measuringScheduled:Z,windowRect:pe}),[z,B,J,$,He,_e,fe,E,R,W,Re,U,ye,we,q,Z,pe]),H=m.useMemo(()=>({activatorEvent:$,activators:Xt,active:z,activeNodeRect:J,ariaDescribedById:{draggable:F},dispatch:v,draggableNodes:E,over:Re,measureDroppableContainers:U}),[$,Xt,z,J,v,F,E,Re,U]);return V.createElement(O4.Provider,{value:b},V.createElement(ju.Provider,{value:H},V.createElement(Q4.Provider,{value:D},V.createElement(Z4.Provider,{value:me},d)),V.createElement(OW,{disabled:(l==null?void 0:l.restoreFocus)===!1})),V.createElement(F7,{...l,hiddenTextDescribedById:F}));function K(){const re=(L==null?void 0:L.autoScrollEnabled)===!1,De=typeof c=="object"?c.enabled===!1:c===!1,lt=k&&!re&&!De;return typeof c=="object"?{...c,enabled:lt}:{enabled:lt}}}),zW=m.createContext(null),RS="button",qW="Draggable";function $W(e){let{id:t,data:n,disabled:r=!1,attributes:i}=e;const s=Na(qW),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(ju),{role:h=RS,roleDescription:x="draggable",tabIndex:g=0}=i??{},w=(c==null?void 0:c.id)===t,v=m.useContext(w?Z4:zW),[y,b]=wc(),[_,j]=wc(),k=kW(o,t),N=aa(n);Gn(()=>(f.set(t,{id:t,key:s,node:y,activatorNode:_,data:N}),()=>{const S=f.get(t);S&&S.key===s&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":r,"aria-pressed":w&&h===RS?!0:void 0,"aria-roledescription":x,"aria-describedby":u.draggable}),[r,h,g,w,x,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:E,isDragging:w,listeners:r?void 0:k,node:y,over:p,setNodeRef:b,setActivatorNodeRef:j,transform:v}}function BW(){return m.useContext(Q4)}const HW="Droppable",WW={timeout:25};function UW(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:i}=e;const s=Na(HW),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(ju),u=m.useRef({disabled:n}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:x,updateMeasurementsFor:g,timeout:w}={...WW,...i},v=aa(g??r),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(v.current)?v.current:[v.current]),h.current=null},w)},[w]),b=_u({callback:y,disabled:x||!o}),_=m.useCallback((E,S)=>{b&&(S&&(b.unobserve(S),f.current=!1),E&&b.observe(E))},[b]),[j,k]=wc(_),N=aa(t);return m.useEffect(()=>{!b||!j.current||(b.disconnect(),f.current=!1,b.observe(j.current))},[j,b]),m.useEffect(()=>(l({type:ut.RegisterDroppable,element:{id:r,key:s,disabled:n,node:j,rect:p,data:N}}),()=>l({type:ut.UnregisterDroppable,key:s,id:r})),[r]),m.useEffect(()=>{n!==u.current.disabled&&(l({type:ut.SetDroppableDisabled,id:r,key:s,disabled:n}),u.current.disabled=n)},[r,s,n,l]),{active:o,rect:p,isOver:(c==null?void 0:c.id)===r,node:j,over:c,setNodeRef:k}}function Su(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function VW(e,t){return e.reduce((n,r,i)=>{const s=t.get(r);return s&&(n[i]=s),n},Array(e.length))}function fl(e){return e!==null&&e>=0}function GW(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function KW(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const eR=e=>{let{rects:t,activeIndex:n,overIndex:r,index:i}=e;const s=Su(t,r,n),o=t[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},pl={scaleX:1,scaleY:1},tR=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:i,rects:s,overIndex:o}=e;const l=(t=s[n])!=null?t:r;if(!l)return null;if(i===n){const d=s[o];return d?{x:0,y:n<o?d.top+d.height-(l.top+l.height):d.top-l.top,...pl}:null}const c=YW(s,i,n);return i>n&&i<=o?{x:0,y:-l.height-c,...pl}:i<n&&i>=o?{x:0,y:l.height+c,...pl}:{x:0,y:0,...pl}};function YW(e,t,n){const r=e[t],i=e[t-1],s=e[t+1];return r?n<t?i?r.top-(i.top+i.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const nR="Sortable",rR=V.createContext({activeIndex:-1,containerId:nR,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:eR,disabled:{draggable:!1,droppable:!1}});function iR(e){let{children:t,id:n,items:r,strategy:i=eR,disabled:s=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=BW(),f=Na(nR,n),p=l.rect!==null,h=m.useMemo(()=>r.map(k=>typeof k=="object"&&"id"in k?k.id:k),[r]),x=o!=null,g=o?h.indexOf(o.id):-1,w=d?h.indexOf(d.id):-1,v=m.useRef(h),y=!GW(h,v.current),b=w!==-1&&g===-1||y,_=KW(s);Gn(()=>{y&&x&&u(h)},[y,h,x,u]),m.useEffect(()=>{v.current=h},[h]);const j=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:_,disableTransforms:b,items:h,overIndex:w,useDragOverlay:p,sortedRects:VW(h,c),strategy:i}),[g,f,_.draggable,_.droppable,b,h,w,c,p,i]);return V.createElement(rR.Provider,{value:j},t)}const XW=e=>{let{id:t,items:n,activeIndex:r,overIndex:i}=e;return Su(n,r,i).indexOf(t)},QW=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!r||l!==s&&i===o?!1:n?!0:o!==i&&t===c},ZW={duration:200,easing:"ease"},sR="transform",JW=Cs.Transition.toString({property:sR,duration:0,easing:"linear"}),eU={roleDescription:"sortable"};function tU(e){let{disabled:t,index:n,node:r,rect:i}=e;const[s,o]=m.useState(null),l=m.useRef(n);return Gn(()=>{if(!t&&n!==l.current&&r.current){const c=i.current;if(c){const d=zs(r.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&o(u)}}n!==l.current&&(l.current=n)},[t,n,r,i]),m.useEffect(()=>{s&&o(null)},[s]),s}function oR(e){let{animateLayoutChanges:t=QW,attributes:n,disabled:r,data:i,getNewIndex:s=XW,id:o,strategy:l,resizeObserverConfig:c,transition:d=ZW}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:x,sortedRects:g,overIndex:w,useDragOverlay:v,strategy:y}=m.useContext(rR),b=nU(r,h),_=u.indexOf(o),j=m.useMemo(()=>({sortable:{containerId:f,index:_,items:u},...i}),[f,i,_,u]),k=m.useMemo(()=>u.slice(u.indexOf(o)),[u,o]),{rect:N,node:E,isOver:S,setNodeRef:R}=UW({id:o,data:j,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:T,activatorEvent:M,activeNodeRect:z,attributes:C,setNodeRef:L,listeners:P,isDragging:$,over:O,setActivatorNodeRef:A,transform:F}=$W({id:o,data:j,attributes:{...eU,...n},disabled:b.draggable}),I=k7(R,L),q=!!T,W=q&&!x&&fl(p)&&fl(w),U=!v&&$,Z=U&&W?F:null,ne=W?Z??(l??y)({rects:g,activeNodeRect:z,activeIndex:p,overIndex:w,index:_}):null,ie=fl(p)&&fl(w)?s({id:o,items:u,activeIndex:p,overIndex:w}):_,le=T==null?void 0:T.id,J=m.useRef({activeId:le,items:u,newIndex:ie,containerId:f}),_e=u!==J.current.items,G=t({active:T,containerId:f,isDragging:$,isSorting:q,id:o,index:_,items:u,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:d,wasDragging:J.current.activeId!=null}),ve=tU({disabled:!G,index:_,node:E,rect:N});return m.useEffect(()=>{q&&J.current.newIndex!==ie&&(J.current.newIndex=ie),f!==J.current.containerId&&(J.current.containerId=f),u!==J.current.items&&(J.current.items=u)},[q,ie,f,u]),m.useEffect(()=>{if(le===J.current.activeId)return;if(le!=null&&J.current.activeId==null){J.current.activeId=le;return}const se=setTimeout(()=>{J.current.activeId=le},50);return()=>clearTimeout(se)},[le]),{active:T,activeIndex:p,attributes:C,data:j,rect:N,index:_,newIndex:ie,items:u,isOver:S,isSorting:q,isDragging:$,listeners:P,node:E,overIndex:w,over:O,setNodeRef:I,setActivatorNodeRef:A,setDroppableNodeRef:R,setDraggableNodeRef:L,transform:ve??ne,transition:fe()};function fe(){if(ve||_e&&J.current.newIndex===_)return JW;if(!(U&&!Ty(M)||!d)&&(q||G))return Cs.Transition.toString({...d,property:sR})}}function nU(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function kc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const rU=[Ie.Down,Ie.Right,Ie.Up,Ie.Left],aR=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:l}}=t;if(rU.includes(e.code)){if(e.preventDefault(),!n||!r)return;const c=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=i.get(f.id);if(p)switch(e.code){case Ie.Down:r.top<p.top&&c.push(f);break;case Ie.Up:r.top>p.top&&c.push(f);break;case Ie.Left:r.left>p.left&&c.push(f);break;case Ie.Right:r.left<p.left&&c.push(f);break}});const d=q7({collisionRect:r,droppableRects:i,droppableContainers:c});let u=z4(d,"id");if(u===(o==null?void 0:o.id)&&d.length>1&&(u=d[1].id),u!=null){const f=s.get(n.id),p=s.get(u),h=p?i.get(p.id):null,x=p==null?void 0:p.node.current;if(x&&h&&f&&p){const w=yu(x).some((k,N)=>l[N]!==k),v=lR(f,p),y=iU(f,p),b=w||!v?{x:0,y:0}:{x:y?r.width-h.width:0,y:y?r.height-h.height:0},_={x:h.left,y:h.top};return b.x&&b.y?_:la(_,b)}}}};function lR(e,t){return!kc(e)||!kc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function iU(e,t){return!kc(e)||!kc(t)||!lR(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const sU={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Fn={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},cn={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},cR={step_id:"new_step",produces:"",scope:"",inputs:[]},oU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function aU({workspaceId:e,workflow:t,documentTypes:n=[],onArtifactSave:r,onDelete:i,onNavigateToWorkflow:s}){const[o,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:x,error:g,saving:w,updateWorkflow:v}=HT(e,p,{onSave:S=>{r==null||r(p,S)}}),y=m.useCallback(S=>{S==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(S)},[h]),b=m.useCallback(S=>{const R=S.target.value;d(R);try{const T=JSON.parse(R);f(null),v(T)}catch(T){f(T.message)}},[v]),_=m.useCallback((S,R)=>{if(!h)return;const T=[...h.steps];T[S]=R,v({...h,steps:T})},[h,v]),j=m.useCallback(S=>{if(!h)return;const R=h.steps.filter((T,M)=>M!==S);v({...h,steps:R})},[h,v]),k=m.useCallback(S=>{var T,M;if(!h)return;const R=S==="iteration"?{...oU,step_id:`new_iteration_${(((T=h.steps)==null?void 0:T.length)||0)+1}`}:{...cR,step_id:`new_step_${(((M=h.steps)==null?void 0:M.length)||0)+1}`};v({...h,steps:[...h.steps||[],R]})},[h,v]),N=m.useCallback((S,R)=>{if(!h)return;const T=Su(h.steps,S,R);v({...h,steps:T})},[h,v]),E=m.useCallback(()=>{!i||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&i(t.workflow_id)},[i,t]);return t?a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[w&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),i&&a.jsx("button",{onClick:E,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(S=>a.jsx("button",{onClick:()=>y(S.id),style:{...sU,color:o===S.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===S.id?"2px solid var(--action-primary)":"2px solid transparent"},children:S.label},S.id))}),x?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&a.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[a.jsx(lU,{steps:(h==null?void 0:h.steps)||[],documentTypes:n,onStepChange:_,onStepDelete:j,onReorder:N}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>k("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),a.jsx("button",{onClick:()=>k("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&a.jsxs("div",{className:"h-full flex flex-col p-4",children:[a.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),o==="metadata"&&a.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?a.jsx(fU,{workflow:h,onUpdateWorkflow:v,onNavigateToWorkflow:s}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),a.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function lU({steps:e,documentTypes:t=[],onStepChange:n,onStepDelete:r,onReorder:i}){const s=D4(jc(wu,{activationConstraint:{distance:5}}),jc(bu,{coordinateGetter:aR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):a.jsx(J4,{sensors:s,collisionDetection:q4,onDragEnd:l,children:a.jsx(iR,{items:o,strategy:tR,children:e.map((c,d)=>a.jsx(cU,{step:c,index:d,documentTypes:t,onChange:n,onDelete:r},c.step_id))})})}function cU({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=oR({id:e.step_id}),f={transform:Cs.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(uR,{step:e,index:t,documentTypes:n,onChange:r,onDelete:i,dragHandleProps:{...s,...o}})})}function uR({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:i,dragHandleProps:s,depth:o=0}){var k,N,E;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(S,R)=>{const T={...l,[S]:R};c(T),r(t,T)},h=(S,R)=>{const T={...l.iterate_over,[S]:R},M={...l,iterate_over:T};c(M),r(t,M)},x=()=>{const S=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:S};c(R),r(t,R)},g=(S,R,T)=>{const M=[...l.inputs||[]];M[S]={...M[S],[R]:T};const z={...l,inputs:M};c(z),r(t,z)},w=S=>{const R=(l.inputs||[]).filter((M,z)=>z!==S),T={...l,inputs:R};c(T),r(t,T)},v=m.useCallback((S,R)=>{const T=[...l.steps||[]];T[S]=R;const M={...l,steps:T};c(M),r(t,M)},[l,t,r]),y=m.useCallback(S=>{const R=(l.steps||[]).filter((M,z)=>z!==S),T={...l,steps:R};c(T),r(t,T)},[l,t,r]),b=m.useCallback(()=>{var T;const S=[...l.steps||[],{...cR,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],R={...l,steps:S};c(R),r(t,R)},[l,t,r]),_=m.useCallback((S,R)=>{const T=Su(l.steps||[],S,R),M={...l,steps:T};c(M),r(t,M)},[l,t,r]),j={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return a.jsxs("div",{style:j,children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[s&&a.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[a.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),a.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),a.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),a.jsx("span",{style:{flex:1}}),a.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?a.jsx("path",{d:"M18 15l-6-6-6 6"}):a.jsx("path",{d:"M6 9l6 6 6-6"})})}),a.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Step ID"}),a.jsx("input",{type:"text",value:l.step_id||"",onChange:S=>p("step_id",S.target.value),style:Fn})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Doc Type"}),a.jsxs("select",{value:((k=l.iterate_over)==null?void 0:k.doc_type)||"",onChange:S=>h("doc_type",S.target.value),style:Fn,children:[a.jsx("option",{value:"",children:"-- Select --"}),n.map(S=>a.jsx("option",{value:S.doc_type_id,children:S.doc_type_id},S.doc_type_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Collection Field"}),a.jsx("input",{type:"text",value:((N=l.iterate_over)==null?void 0:N.collection_field)||"",onChange:S=>h("collection_field",S.target.value),style:Fn})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Entity Type"}),a.jsx("input",{type:"text",value:((E=l.iterate_over)==null?void 0:E.entity_type)||"",onChange:S=>h("entity_type",S.target.value),style:Fn})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:S=>p("scope",S.target.value),style:Fn})]}),a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{style:cn,children:"Nested Steps"}),a.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),a.jsx(uU,{steps:l.steps||[],documentTypes:n,onStepChange:v,onStepDelete:y,onReorder:_})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Produces"}),a.jsxs("select",{value:l.produces||"",onChange:S=>p("produces",S.target.value),style:Fn,children:[a.jsx("option",{value:"",children:"-- Select document type --"}),n.map(S=>a.jsx("option",{value:S.doc_type_id,children:S.doc_type_id},S.doc_type_id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:S=>p("scope",S.target.value),placeholder:"project",style:Fn})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Creates Entities"}),a.jsx("input",{type:"text",value:l.creates_entities||"",onChange:S=>p("creates_entities",S.target.value||void 0),placeholder:"e.g., epic",style:Fn})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:cn,children:"Inputs"}),a.jsx("button",{onClick:x,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):a.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((S,R)=>a.jsxs("div",{className:"flex gap-1 items-end",children:[a.jsxs("div",{style:{flex:1},children:[R===0&&a.jsx("label",{style:{...cn,fontSize:9},children:"Doc/Entity Type"}),a.jsxs("select",{value:S.doc_type||S.entity_type||"",onChange:T=>{const M=T.target.value;S.entity_type!==void 0?g(R,"entity_type",M):g(R,"doc_type",M)},style:{...Fn,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select --"}),n.map(T=>a.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),a.jsxs("div",{style:{width:"30%"},children:[R===0&&a.jsx("label",{style:{...cn,fontSize:9},children:"Scope"}),a.jsx("input",{type:"text",value:S.scope||"",onChange:T=>g(R,"scope",T.target.value),placeholder:"scope",style:{...Fn,fontSize:11}})]}),a.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[a.jsx("input",{type:"checkbox",checked:S.context||!1,onChange:T=>g(R,"context",T.target.checked||void 0)}),"ctx"]}),a.jsx("button",{onClick:()=>w(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function uU({steps:e,documentTypes:t=[],onStepChange:n,onStepDelete:r,onReorder:i}){const s=D4(jc(wu,{activationConstraint:{distance:5}}),jc(bu,{coordinateGetter:aR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):a.jsx(J4,{sensors:s,collisionDetection:q4,onDragEnd:l,children:a.jsx(iR,{items:o,strategy:tR,children:e.map((c,d)=>a.jsx(dU,{step:c,index:d,documentTypes:t,onChange:n,onDelete:r},c.step_id))})})}function dU({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=oR({id:e.step_id}),f={transform:Cs.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(uR,{step:e,index:t,documentTypes:n,onChange:r,onDelete:i,dragHandleProps:{...s,...o},depth:1})})}function fU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:n}){const[r,i]=m.useState(""),s={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},o={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,x=e.source_version,g=e.tags||[],w=()=>{const b=r.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),i(""))},v=b=>{t==null||t({...e,tags:g.filter(_=>_!==b)})},y=()=>{h!=null&&h.workflow_id&&n&&n(h.workflow_id)};return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"POW Class"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Derived From"}),a.jsx("div",{style:s,children:n?a.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):a.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),x&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Source Version"}),a.jsx("div",{style:s,children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Tags"}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>a.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&a.jsx("button",{onClick:()=>v(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:r,onChange:b=>i(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),w())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),a.jsx("button",{onClick:w,disabled:!r.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:r.trim()?"pointer":"default",opacity:r.trim()?1:.5},children:"Add"})]})]}),a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b.label}),a.jsx("div",{style:s,children:e[b.key]||"-"})]},b.key)),d.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:["parent: ",_.parent||"none"]})]},b))]}),f.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:[_.name,_.scope&&` (${_.scope})`,_.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function AS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const n=e.filter(i=>i.status==="fail"),r=e.filter(i=>i.status==="pass");return t?a.jsx("div",{className:"flex items-center gap-2",children:n.length>0?a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[n.length," error",n.length!==1?"s":""]}):a.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):a.jsxs("div",{className:"space-y-2",children:[n.map((i,s)=>a.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx("span",{className:"text-red-400",children:"FAIL"}),a.jsx("span",{className:"font-mono",children:i.rule_id})]}),i.message&&a.jsx("div",{className:"mt-1 opacity-80",children:i.message}),i.artifact_id&&a.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:i.artifact_id})]},s)),r.length>0&&n.length>0&&a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[r.length," rule",r.length!==1?"s":""," passed"]})]})}function pU(e,t){const n=(e||"").split(`
`),r=(t||"").split(`
`),i=[];let s=0,o=0;for(;s<n.length||o<r.length;)if(s>=n.length)i.push({type:"added",line:r[o],lineNum:o+1}),o++;else if(o>=r.length)i.push({type:"removed",line:n[s],lineNum:s+1}),s++;else if(n[s]===r[o])i.push({type:"same",line:n[s],oldLineNum:s+1,newLineNum:o+1}),s++,o++;else{let l=r.slice(o,o+5).indexOf(n[s]),c=n.slice(s,s+5).indexOf(r[o]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)i.push({type:"added",line:r[o+d],lineNum:o+d+1});o+=l}else if(c!==-1){for(let d=0;d<c;d++)i.push({type:"removed",line:n[s+d],lineNum:s+d+1});s+=c}else i.push({type:"removed",line:n[s],lineNum:s+1}),i.push({type:"added",line:r[o],lineNum:o+1}),s++,o++}return i}function hU({diff:e}){const[t,n]=m.useState(!0),r=pU(e.old_content,e.new_content),i={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return a.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>n(!t),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:i[e.status]||i.M,children:e.status}),a.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),a.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&a.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:a.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:r.map((s,o)=>a.jsxs("div",{className:"flex",style:{background:s.type==="added"?"rgba(34, 197, 94, 0.1)":s.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:s.type==="added"?"3px solid #22c55e":s.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[a.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:s.type==="same"?s.oldLineNum:s.lineNum||""}),a.jsx("span",{className:"select-none px-1",style:{color:s.type==="added"?"#22c55e":s.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:s.type==="added"?"+":s.type==="removed"?"-":" "}),a.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:s.line})]},o))})})]})}function mU({workspaceId:e,artifactId:t=null,onClose:n}){const[r,i]=m.useState([]),[s,o]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(o(!0),c(null),je.getDiff(e,t).then(u=>{i(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{o(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(n==null||n())};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(n==null?void 0:n()),onKeyDown:d,tabIndex:0,children:a.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),a.jsx("button",{onClick:n,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?a.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):r.length===0?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):r.map((u,f)=>a.jsx(hU,{diff:u},u.artifact_id||f))}),a.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function gU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[n,r,i,s]=t,o=r.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:n,name:r,version:i,kind:s,displayName:o,kindLabel:l,display:`${o} - ${l}`}}function vU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(n=>{const r=gU(n);t[r.scope]&&t[r.scope].items.push(r)}),Object.entries(t).filter(([n,r])=>r.items.length>0).map(([n,r])=>({scope:n,...r}))}function xU({workspaceId:e,onCommit:t,onCancel:n,loading:r=!1,modifiedArtifacts:i=[],modifiedFiles:s=[]}){const[o,l]=m.useState(""),[c,d]=m.useState(!1),u=vU(i),f=i.length,p=x=>{x.preventDefault(),o.trim()&&!r&&t(o.trim())},h=x=>{x.key==="Escape"&&!r&&n()};return a.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:x=>x.target===x.currentTarget&&!r&&n(),onKeyDown:h,children:[a.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&a.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),a.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(x=>a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:x.label}),a.jsx("div",{className:"space-y-1",children:x.items.map((g,w)=>a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),a.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),a.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),a.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},w))})]},x.scope))}),a.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),a.jsxs("form",{onSubmit:p,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),a.jsx("textarea",{value:o,onChange:x=>l(x.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:r}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:n,disabled:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!o.trim()||r,className:"px-4 py-2 rounded text-sm font-medium",style:{background:o.trim()&&!r?"var(--action-success)":"var(--border-panel)",color:o.trim()&&!r?"#000":"var(--text-muted)",cursor:o.trim()&&!r?"pointer":"not-allowed"},children:r?"Committing...":"Commit"})]})]})]}),c&&e&&a.jsx(mU,{workspaceId:e,onClose:()=>d(!1)})]})}function yU(e){const t=e.split(":");if(t.length!==4)return{display:e};const[n,r,i,s]=t,o=r.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:n,name:r,displayName:o,kind:s,kindLabel:l,version:i,display:`${o} - ${l}`}}function bU({workspaceId:e,state:t,loading:n,onCommit:r,onDiscard:i,onClose:s,onRefresh:o}){var S,R;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,x]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,w=(t==null?void 0:t.modified_artifacts)??[],v=((S=t==null?void 0:t.tier1)==null?void 0:S.passed)??!0,y=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",_=t!=null&&t.expires_at?new Date(t.expires_at):null,j=async T=>{u(!0),x(null);try{const M=await je.commit(e,T);c(!1),r==null||r(M),o==null||o()}catch(M){x(M.message)}finally{u(!1)}},k=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await je.discard(e),i==null||i(),o==null||o()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},N=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await je.closeWorkspace(e),s==null||s()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},E=T=>{if(!T)return null;const z=T-new Date;if(z<=0)return"Expired";const C=Math.floor(z/(1e3*60*60)),L=Math.floor(z%(1e3*60*60)/(1e3*60));return C>0?`${C}h ${L}m remaining`:`${L}m remaining`};return a.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:a.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),n?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),a.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),_&&a.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:E(_)})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),a.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),w.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",w.length,")"]}),a.jsx("div",{className:"space-y-1",children:w.map(T=>{const M=yU(T);return a.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[a.jsx("span",{style:{color:"var(--text-primary)"},children:M.displayName||T}),M.kindLabel&&a.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",M.kindLabel]})]},T)})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),a.jsx(AS,{results:y,compact:!0})]}),y.length>0&&!v&&a.jsx("div",{className:"mt-3",children:a.jsx(AS,{results:y})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[a.jsx("button",{onClick:()=>c(!0),disabled:!g||!v||n,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&v?"var(--action-success)":"var(--border-panel)",color:g&&v?"#000":"var(--text-muted)",cursor:g&&v&&!n?"pointer":"not-allowed",opacity:n?.5:1},children:"Commit Changes"}),!v&&g&&a.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&a.jsx("button",{onClick:k,disabled:f||n,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||n?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&a.jsx("button",{onClick:N,disabled:n,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:n?.5:1},children:"Close Workspace"})]}),l&&a.jsx(xU,{workspaceId:e,onCommit:j,onCancel:()=>{c(!1),x(null)},loading:d,modifiedArtifacts:w,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&a.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function wU(){const{isAdmin:e,loading:t}=Ds(),[n,r]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[x,g]=m.useState(null),[w,v]=m.useState(null),[y,b]=m.useState(null),[_,j]=m.useState(null),[k,N]=m.useState(!1),{workspaceId:E,loading:S,error:R,reinitialize:T}=Z$(),{state:M,loading:z,refresh:C}=J$(E),{documentTypes:L,loading:P,refresh:$}=eB(),{roles:O,loading:A,refresh:F}=tB(),{templates:I,loading:q,refresh:W}=zT(),{workflows:U,loading:Z,refresh:B}=kB(),{fragments:ne,loading:ie,kindOptions:le,refresh:J}=$T(),{schemas:_e,loading:G,refresh:ve}=qT(),[fe,se]=m.useState([]),[ge,Y]=m.useState([]),[Q,pe]=m.useState(!1),[ye,we]=m.useState(null);m.useEffect(()=>{(async()=>{pe(!0);try{const[ce,Ae]=await Promise.all([je.getMechanicalOpTypes(),je.getMechanicalOps()]);se(ce.types||[]),Y(Ae.operations||[])}catch(ce){console.error("Failed to load mechanical ops:",ce)}finally{pe(!1)}})()},[]);const xe=m.useCallback(async(ue,ce=null,Ae="docworkflow")=>{if(r(ue),d(null),f(null),h(null),s(null),g(null),v(null),we(null),b(ce),j(Ae),!!ue){l(!0);try{const zt=await je.getDocumentType(ue.doc_type_id);s(zt)}catch(zt){console.error("Failed to load doc type details:",zt),s(ue)}finally{l(!1)}}},[]),te=m.useCallback(ue=>{xe(ue,"task_prompt","task")},[xe]),he=m.useCallback(ue=>{xe(ue,"schema","schema")},[xe]),Ge=m.useCallback(ue=>{d(ue),r(null),s(null),f(null),h(null),g(null),v(null),we(null)},[]),ze=m.useCallback(ue=>{f(ue),r(null),s(null),d(null),h(null),g(null),v(null),we(null)},[]),Be=m.useCallback(ue=>{h(ue),r(null),s(null),d(null),f(null),g(null),v(null),we(null)},[]),Te=m.useCallback(ue=>{g(ue),r(null),s(null),d(null),f(null),h(null),v(null),we(null)},[]),He=m.useCallback(ue=>{v(ue),r(null),s(null),d(null),f(null),h(null),g(null),we(null)},[]),at=m.useCallback(ue=>{we(ue),r(null),s(null),d(null),f(null),h(null),g(null),v(null)},[]),Re=m.useCallback(ue=>{const ce=U.find(Ae=>Ae.workflow_id===ue);ce&&Be(ce)},[U,Be]),X=m.useCallback((ue,ce)=>{C()},[C]),Oe=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),me=m.useCallback(()=>{r(null),s(null),d(null),f(null),h(null),g(null),v(null),we(null)},[]),kt=m.useCallback(async ue=>{if(E)try{const ce=await je.createOrchestrationWorkflow(E,ue);await B(),C(),h({workflow_id:ce.workflow_id,active_version:ce.version,name:ue.name||ce.workflow_id.replace(/_/g," ").replace(/\b\w/g,Ae=>Ae.toUpperCase())}),r(null),s(null),d(null),f(null)}catch(ce){console.error("Failed to create workflow:",ce),alert(`Failed to create workflow: ${ce.message}`)}},[E,B,C]),xt=m.useCallback(async ue=>{if(E)try{await je.deleteOrchestrationWorkflow(E,ue),await B(),C(),h(null)}catch(ce){console.error("Failed to delete workflow:",ce),alert(`Failed to delete workflow: ${ce.message}`)}},[E,B,C]),yt=m.useCallback(async ue=>{if(E)try{const ce=await je.createDocumentType(E,ue);await $(),C(),xe({doc_type_id:ce.doc_type_id,display_name:ue.display_name||ce.doc_type_id.replace(/_/g," ").replace(/\b\w/g,Ae=>Ae.toUpperCase()),active_version:ce.version})}catch(ce){console.error("Failed to create document type:",ce),alert(`Failed to create document type: ${ce.message}`)}},[E,$,C,xe]);m.useCallback(async ue=>{if(E)try{await je.deleteDocumentType(E,ue),await $(),C(),r(null),s(null)}catch(ce){console.error("Failed to delete document type:",ce),alert(`Failed to delete document type: ${ce.message}`)}},[E,$,C]);const Xt=m.useCallback(async ue=>{if(E)try{await je.createDcwWorkflow(E,{doc_type_id:ue}),await B(),C()}catch(ce){console.error("Failed to create DCW workflow:",ce),alert(`Failed to create workflow: ${ce.message}`)}},[E,B,C]),D=m.useCallback(async ue=>{if(E)try{const ce=await je.createRolePrompt(E,ue);await J(),await F(),C(),Te({fragment_id:`role:${ce.role_id}`,kind:"role",version:ce.version,name:ue.name||ce.role_id.replace(/_/g," ").replace(/\b\w/g,Ae=>Ae.toUpperCase())})}catch(ce){console.error("Failed to create role prompt:",ce),alert(`Failed to create role prompt: ${ce.message}`)}},[E,J,F,C,Te]),H=m.useCallback(async ue=>{if(E)try{const ce=await je.createTemplate(E,ue);await W(),C(),ze({template_id:ce.template_id,active_version:ce.version,name:ue.name||ce.template_id.replace(/_/g," ").replace(/\b\w/g,Ae=>Ae.toUpperCase())})}catch(ce){console.error("Failed to create template:",ce),alert(`Failed to create template: ${ce.message}`)}},[E,W,C,ze]),K=m.useCallback(async ue=>{if(E)try{const ce=await je.createStandaloneSchema(E,ue);await ve(),C(),He({schema_id:ce.schema_id,active_version:ce.version,title:ue.title||ce.schema_id.replace(/_/g," ").replace(/\b\w/g,Ae=>Ae.toUpperCase())})}catch(ce){console.error("Failed to create schema:",ce),alert(`Failed to create schema: ${ce.message}`)}},[E,ve,C,He]),re=m.useCallback(()=>{T(),r(null),s(null),d(null),f(null),h(null),g(null),v(null),we(null)},[T]);if(t)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(S)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(R)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),a.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:R}),a.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const De=c&&!n&&!u&&!p&&!x&&!w,lt=u&&!n&&!c&&!p&&!x&&!w,an=p&&!n&&!c&&!u&&!x&&!w,Nt=x&&!n&&!c&&!u&&!p&&!w,bt=w&&!n&&!c&&!u&&!p&&!x;return a.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"}),a.jsxs("button",{onClick:()=>N(!k),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:k?"var(--action-primary)":"var(--bg-panel)",color:k?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[a.jsx("span",{style:{fontSize:14},children:""}),a.jsx("span",{children:"Building Blocks"})]})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(NB,{documentTypes:L,roles:O,templates:I,workflows:U,promptFragments:ne,promptFragmentKindOptions:le,schemas:_e,loading:P,rolesLoading:A,templatesLoading:q,workflowsLoading:Z,promptFragmentsLoading:ie,schemasLoading:G,selectedDocType:n,docTypeSource:_,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:x,selectedSchema:w,onSelectDocType:xe,onSelectRole:Ge,onSelectTemplate:ze,onSelectWorkflow:Be,onSelectFragment:Te,onSelectStandaloneSchema:He,onCreateWorkflow:kt,onCreateDocType:yt,onCreateFragment:D,onCreateTemplate:H,onCreateSchema:K,onSelectTask:te,onSelectSchema:he,workspaceState:M}),De?a.jsx(JB,{workspaceId:E,role:c,onArtifactSave:X}):lt?a.jsx(b7,{workspaceId:E,template:u,onArtifactSave:X}):Nt?a.jsx(S7,{workspaceId:E,fragment:x,onArtifactSave:X}):an?a.jsx(aU,{workspaceId:E,workflow:p,documentTypes:L,onArtifactSave:X,onDelete:xt,onNavigateToWorkflow:Re}):bt?a.jsx(w7,{workspaceId:E,schema:w,onArtifactSave:X}):a.jsx(ZB,{workspaceId:E,docType:i,loading:o,roles:O,workflows:U,onArtifactSave:X,onCreateDcwWorkflow:Xt,initialTab:y,docTypeSource:_,mechanicalOpTypes:fe,mechanicalOps:ge}),a.jsx(bU,{workspaceId:E,state:M,loading:z,onCommit:Oe,onDiscard:me,onClose:re,onRefresh:C})]}),a.jsx(EB,{isOpen:k,onClose:()=>N(!1),promptFragments:ne,promptFragmentKindOptions:le,templates:I,schemas:_e,documentTypes:L,promptFragmentsLoading:ie,templatesLoading:q,schemasLoading:G,onSelectFragment:Te,onSelectTemplate:ze,onSelectSchema:he,onSelectStandaloneSchema:He,onCreateFragment:D,onCreateTemplate:H,onCreateSchema:K,mechanicalOpTypes:fe,mechanicalOps:ge,mechanicalOpsLoading:Q,onSelectMechanicalOp:at})]})}function _U({user:e,onClick:t}){return a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function jU(){var T,M,z;const{user:e}=Ds(),[t,n]=m.useState(!1),{projects:r,loading:i,error:s,refresh:o}=K$({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,x]=m.useState(!1),{theme:g,setTheme:w}=LT(),v=Object.keys(r),y=l&&r[l]?l:v[0]||null;m.useEffect(()=>{if(y&&r[y]){const C=r[y];document.title=`${C.projectId} - The Combine`}else document.title="The Combine"},[y,r]);const b=C=>{c(C),u(null)},_=()=>{p(!0)},j=async C=>{await o(),C&&C.id&&(c(C.id),u("concierge_intake")),p(!1)},k=()=>{p(!1)},N=async(C,L)=>{try{await Ye.updateProject(C,L),await o()}catch(P){throw console.error("Failed to update project:",P),P}},E=async C=>{try{if(await Ye.archiveProject(C),!t){const L=Object.values(r).sort((O,A)=>{const F=(O.name||"").localeCompare(A.name||"");return F!==0?F:(O.projectId||"").localeCompare(A.projectId||"")}),P=L.findIndex(O=>O.id===C),$=L[P+1]||L[P-1]||null;c(($==null?void 0:$.id)||null)}await o()}catch(L){throw console.error("Failed to archive project:",L),L}},S=async C=>{try{await Ye.unarchiveProject(C),await o()}catch(L){throw console.error("Failed to unarchive project:",L),L}},R=async C=>{try{await Ye.deleteProject(C);const L=Object.values(r).sort((O,A)=>{const F=(O.name||"").localeCompare(A.name||"");return F!==0?F:(O.projectId||"").localeCompare(A.projectId||"")}),P=L.findIndex(O=>O.id===C),$=L[P+1]||L[P-1]||null;c(($==null?void 0:$.id)||null),await o()}catch(L){throw console.error("Failed to delete project:",L),L}};return i?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):s?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[a.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",s]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):a.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[a.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),a.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),a.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("path",{d:"M12 17h.01"})]})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(i6,{projects:r,selectedId:y,onSelectProject:b,onNewProject:_,showArchived:t,onToggleShowArchived:()=>n(C=>!C),userSection:a.jsx(_U,{user:e,onClick:()=>x(!0)})}),a.jsx("div",{className:"flex-1",children:y?a.jsx(Qc,{children:a.jsx(iB,{projectId:y,projectCode:(T=r[y])==null?void 0:T.projectId,projectName:(M=r[y])==null?void 0:M.name,isArchived:(z=r[y])==null?void 0:z.isArchived,autoExpandNodeId:d,theme:g,onThemeChange:w,onProjectUpdate:N,onProjectArchive:E,onProjectUnarchive:S,onProjectDelete:R})},y):a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center",children:a.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&a.jsx(fB,{onClose:k,onComplete:j}),h&&a.jsx(pB,{onClose:()=>x(!1)})]})]})}function SU(){const{isAuthenticated:e,loading:t}=Ds(),{theme:n}=LT(),[r,i]=m.useState(window.location.pathname);return m.useEffect(()=>{const s=()=>i(window.location.pathname);return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]),t?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${n}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?r==="/admin/workbench"?a.jsx("div",{className:`h-screen theme-${n}`,children:a.jsx(wU,{})}):a.jsx(jU,{}):r==="/learn"?a.jsx(SB,{}):a.jsx(bB,{})}function kU(){return a.jsx(Q$,{children:a.jsx(SU,{})})}bg.createRoot(document.getElementById("root")).render(a.jsx(V.StrictMode,{children:a.jsx(kU,{})}));
//# sourceMappingURL=index-36V6Uj5F.js.map
