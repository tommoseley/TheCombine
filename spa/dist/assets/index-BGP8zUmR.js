(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Na=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $v(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tj={exports:{}},wc={},Rj={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ca=Symbol.for("react.element"),NR=Symbol.for("react.portal"),CR=Symbol.for("react.fragment"),ER=Symbol.for("react.strict_mode"),TR=Symbol.for("react.profiler"),RR=Symbol.for("react.provider"),AR=Symbol.for("react.context"),IR=Symbol.for("react.forward_ref"),MR=Symbol.for("react.suspense"),PR=Symbol.for("react.memo"),OR=Symbol.for("react.lazy"),Py=Symbol.iterator;function DR(e){return e===null||typeof e!="object"?null:(e=Py&&e[Py]||e["@@iterator"],typeof e=="function"?e:null)}var Aj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ij=Object.assign,Mj={};function Es(e,t,r){this.props=e,this.context=t,this.refs=Mj,this.updater=r||Aj}Es.prototype.isReactComponent={};Es.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Es.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Pj(){}Pj.prototype=Es.prototype;function Bv(e,t,r){this.props=e,this.context=t,this.refs=Mj,this.updater=r||Aj}var Hv=Bv.prototype=new Pj;Hv.constructor=Bv;Ij(Hv,Es.prototype);Hv.isPureReactComponent=!0;var Oy=Array.isArray,Oj=Object.prototype.hasOwnProperty,Wv={current:null},Dj={key:!0,ref:!0,__self:!0,__source:!0};function Lj(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Oj.call(t,n)&&!Dj.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:ca,type:e,key:s,ref:o,props:i,_owner:Wv.current}}function LR(e,t){return{$$typeof:ca,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Uv(e){return typeof e=="object"&&e!==null&&e.$$typeof===ca}function FR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Dy=/\/+/g;function wu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?FR(""+e.key):t.toString(36)}function cl(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ca:case NR:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+wu(o,0):n,Oy(i)?(r="",e!=null&&(r=e.replace(Dy,"$&/")+"/"),cl(i,t,r,"",function(u){return u})):i!=null&&(Uv(i)&&(i=LR(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Dy,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",Oy(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+wu(s,l);o+=cl(s,t,r,c,i)}else if(c=DR(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+wu(s,l++),o+=cl(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ca(e,t,r){if(e==null)return e;var n=[],i=0;return cl(e,n,"","",function(s){return t.call(r,s,i++)}),n}function zR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var At={current:null},ul={transition:null},qR={ReactCurrentDispatcher:At,ReactCurrentBatchConfig:ul,ReactCurrentOwner:Wv};function Fj(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:Ca,forEach:function(e,t,r){Ca(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ca(e,function(){t++}),t},toArray:function(e){return Ca(e,function(t){return t})||[]},only:function(e){if(!Uv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};je.Component=Es;je.Fragment=CR;je.Profiler=TR;je.PureComponent=Bv;je.StrictMode=ER;je.Suspense=MR;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qR;je.act=Fj;je.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ij({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Wv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Oj.call(t,c)&&!Dj.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:ca,type:e.type,key:i,ref:s,props:n,_owner:o}};je.createContext=function(e){return e={$$typeof:AR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:RR,_context:e},e.Consumer=e};je.createElement=Lj;je.createFactory=function(e){var t=Lj.bind(null,e);return t.type=e,t};je.createRef=function(){return{current:null}};je.forwardRef=function(e){return{$$typeof:IR,render:e}};je.isValidElement=Uv;je.lazy=function(e){return{$$typeof:OR,_payload:{_status:-1,_result:e},_init:zR}};je.memo=function(e,t){return{$$typeof:PR,type:e,compare:t===void 0?null:t}};je.startTransition=function(e){var t=ul.transition;ul.transition={};try{e()}finally{ul.transition=t}};je.unstable_act=Fj;je.useCallback=function(e,t){return At.current.useCallback(e,t)};je.useContext=function(e){return At.current.useContext(e)};je.useDebugValue=function(){};je.useDeferredValue=function(e){return At.current.useDeferredValue(e)};je.useEffect=function(e,t){return At.current.useEffect(e,t)};je.useId=function(){return At.current.useId()};je.useImperativeHandle=function(e,t,r){return At.current.useImperativeHandle(e,t,r)};je.useInsertionEffect=function(e,t){return At.current.useInsertionEffect(e,t)};je.useLayoutEffect=function(e,t){return At.current.useLayoutEffect(e,t)};je.useMemo=function(e,t){return At.current.useMemo(e,t)};je.useReducer=function(e,t,r){return At.current.useReducer(e,t,r)};je.useRef=function(e){return At.current.useRef(e)};je.useState=function(e){return At.current.useState(e)};je.useSyncExternalStore=function(e,t,r){return At.current.useSyncExternalStore(e,t,r)};je.useTransition=function(){return At.current.useTransition()};je.version="18.3.1";Rj.exports=je;var m=Rj.exports;const G=$v(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $R=m,BR=Symbol.for("react.element"),HR=Symbol.for("react.fragment"),WR=Object.prototype.hasOwnProperty,UR=$R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VR={key:!0,ref:!0,__self:!0,__source:!0};function zj(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)WR.call(t,n)&&!VR.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:BR,type:e,key:s,ref:o,props:i,_owner:UR.current}}wc.Fragment=HR;wc.jsx=zj;wc.jsxs=zj;Tj.exports=wc;var a=Tj.exports,yg={},qj={exports:{}},Jt={},$j={exports:{}},Bj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,A){var F=D.length;D.push(A);e:for(;0<F;){var M=F-1>>>1,q=D[M];if(0<i(q,A))D[M]=A,D[F]=q,F=M;else break e}}function r(D){return D.length===0?null:D[0]}function n(D){if(D.length===0)return null;var A=D[0],F=D.pop();if(F!==A){D[0]=F;e:for(var M=0,q=D.length,W=q>>>1;M<W;){var B=2*(M+1)-1,K=D[B],Z=B+1,re=D[Z];if(0>i(K,F))Z<q&&0>i(re,K)?(D[M]=re,D[Z]=F,M=Z):(D[M]=K,D[B]=F,M=B);else if(Z<q&&0>i(re,F))D[M]=re,D[Z]=F,M=Z;else break e}}return A}function i(D,A){var F=D.sortIndex-A.sortIndex;return F!==0?F:D.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,y=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(D){for(var A=r(u);A!==null;){if(A.callback===null)n(u);else if(A.startTime<=D)n(u),A.sortIndex=A.expirationTime,t(c,A);else break;A=r(u)}}function _(D){if(g=!1,b(D),!y)if(r(c)!==null)y=!0,O(S);else{var A=r(u);A!==null&&$(_,A.startTime-D)}}function S(D,A){y=!1,g&&(g=!1,v(E),E=-1),p=!0;var F=h;try{for(b(A),f=r(c);f!==null&&(!(f.expirationTime>A)||D&&!T());){var M=f.callback;if(typeof M=="function"){f.callback=null,h=f.priorityLevel;var q=M(f.expirationTime<=A);A=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(A)}else n(c);f=r(c)}if(f!==null)var W=!0;else{var B=r(u);B!==null&&$(_,B.startTime-A),W=!1}return W}finally{f=null,h=F,p=!1}}var k=!1,N=null,E=-1,j=5,R=-1;function T(){return!(e.unstable_now()-R<j)}function P(){if(N!==null){var D=e.unstable_now();R=D;var A=!0;try{A=N(!0,D)}finally{A?z():(k=!1,N=null)}}else k=!1}var z;if(typeof x=="function")z=function(){x(P)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,L=C.port2;C.port1.onmessage=P,z=function(){L.postMessage(null)}}else z=function(){w(P,0)};function O(D){N=D,k||(k=!0,z())}function $(D,A){E=w(function(){D(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){y||p||(y=!0,O(S))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(D){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var F=h;h=A;try{return D()}finally{h=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,A){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=h;h=D;try{return A()}finally{h=F}},e.unstable_scheduleCallback=function(D,A,F){var M=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?M+F:M):F=M,D){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=F+q,D={id:d++,callback:A,priorityLevel:D,startTime:F,expirationTime:q,sortIndex:-1},F>M?(D.sortIndex=F,t(u,D),r(c)===null&&D===r(u)&&(g?(v(E),E=-1):g=!0,$(_,F-M))):(D.sortIndex=q,t(c,D),y||p||(y=!0,O(S))),D},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(D){var A=h;return function(){var F=h;h=A;try{return D.apply(this,arguments)}finally{h=F}}}})(Bj);$j.exports=Bj;var GR=$j.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KR=m,Qt=GR;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hj=new Set,Ao={};function Ci(e,t){ms(e,t),ms(e+"Capture",t)}function ms(e,t){for(Ao[e]=t,e=0;e<t.length;e++)Hj.add(t[e])}var ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bg=Object.prototype.hasOwnProperty,YR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ly={},Fy={};function XR(e){return bg.call(Fy,e)?!0:bg.call(Ly,e)?!1:YR.test(e)?Fy[e]=!0:(Ly[e]=!0,!1)}function QR(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ZR(e,t,r,n){if(t===null||typeof t>"u"||QR(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function It(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){xt[e]=new It(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];xt[t]=new It(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){xt[e]=new It(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){xt[e]=new It(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){xt[e]=new It(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){xt[e]=new It(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){xt[e]=new It(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){xt[e]=new It(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){xt[e]=new It(e,5,!1,e.toLowerCase(),null,!1,!1)});var Vv=/[\-:]([a-z])/g;function Gv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Vv,Gv);xt[t]=new It(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Vv,Gv);xt[t]=new It(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Vv,Gv);xt[t]=new It(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){xt[e]=new It(e,1,!1,e.toLowerCase(),null,!1,!1)});xt.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){xt[e]=new It(e,1,!1,e.toLowerCase(),null,!0,!0)});function Kv(e,t,r,n){var i=xt.hasOwnProperty(t)?xt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ZR(t,r,i,n)&&(r=null),n||i===null?XR(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var gn=KR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ea=Symbol.for("react.element"),Hi=Symbol.for("react.portal"),Wi=Symbol.for("react.fragment"),Yv=Symbol.for("react.strict_mode"),wg=Symbol.for("react.profiler"),Wj=Symbol.for("react.provider"),Uj=Symbol.for("react.context"),Xv=Symbol.for("react.forward_ref"),_g=Symbol.for("react.suspense"),Sg=Symbol.for("react.suspense_list"),Qv=Symbol.for("react.memo"),Sn=Symbol.for("react.lazy"),Vj=Symbol.for("react.offscreen"),zy=Symbol.iterator;function $s(e){return e===null||typeof e!="object"?null:(e=zy&&e[zy]||e["@@iterator"],typeof e=="function"?e:null)}var Ye=Object.assign,_u;function io(e){if(_u===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);_u=t&&t[1]||""}return`
`+_u+e}var Su=!1;function ju(e,t){if(!e||Su)return"";Su=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Su=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?io(e):""}function JR(e){switch(e.tag){case 5:return io(e.type);case 16:return io("Lazy");case 13:return io("Suspense");case 19:return io("SuspenseList");case 0:case 2:case 15:return e=ju(e.type,!1),e;case 11:return e=ju(e.type.render,!1),e;case 1:return e=ju(e.type,!0),e;default:return""}}function jg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Wi:return"Fragment";case Hi:return"Portal";case wg:return"Profiler";case Yv:return"StrictMode";case _g:return"Suspense";case Sg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Uj:return(e.displayName||"Context")+".Consumer";case Wj:return(e._context.displayName||"Context")+".Provider";case Xv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Qv:return t=e.displayName||null,t!==null?t:jg(e.type)||"Memo";case Sn:t=e._payload,e=e._init;try{return jg(e(t))}catch{}}return null}function eA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jg(t);case 8:return t===Yv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Gj(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function tA(e){var t=Gj(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ta(e){e._valueTracker||(e._valueTracker=tA(e))}function Kj(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Gj(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Nl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function kg(e,t){var r=t.checked;return Ye({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function qy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Gn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Yj(e,t){t=t.checked,t!=null&&Kv(e,"checked",t,!1)}function Ng(e,t){Yj(e,t);var r=Gn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Cg(e,t.type,r):t.hasOwnProperty("defaultValue")&&Cg(e,t.type,Gn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function $y(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Cg(e,t,r){(t!=="number"||Nl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var so=Array.isArray;function ss(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Gn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Eg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return Ye({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function By(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(J(92));if(so(r)){if(1<r.length)throw Error(J(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Gn(r)}}function Xj(e,t){var r=Gn(t.value),n=Gn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Hy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Qj(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Qj(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ra,Zj=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ra=Ra||document.createElement("div"),Ra.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ra.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Io(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var xo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rA=["Webkit","ms","Moz","O"];Object.keys(xo).forEach(function(e){rA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xo[t]=xo[e]})});function Jj(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||xo.hasOwnProperty(e)&&xo[e]?(""+t).trim():t+"px"}function ek(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Jj(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var nA=Ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rg(e,t){if(t){if(nA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function Ag(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ig=null;function Zv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mg=null,os=null,as=null;function Wy(e){if(e=fa(e)){if(typeof Mg!="function")throw Error(J(280));var t=e.stateNode;t&&(t=Nc(t),Mg(e.stateNode,e.type,t))}}function tk(e){os?as?as.push(e):as=[e]:os=e}function rk(){if(os){var e=os,t=as;if(as=os=null,Wy(e),t)for(e=0;e<t.length;e++)Wy(t[e])}}function nk(e,t){return e(t)}function ik(){}var ku=!1;function sk(e,t,r){if(ku)return e(t,r);ku=!0;try{return nk(e,t,r)}finally{ku=!1,(os!==null||as!==null)&&(ik(),rk())}}function Mo(e,t){var r=e.stateNode;if(r===null)return null;var n=Nc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(J(231,t,typeof r));return r}var Pg=!1;if(ln)try{var Bs={};Object.defineProperty(Bs,"passive",{get:function(){Pg=!0}}),window.addEventListener("test",Bs,Bs),window.removeEventListener("test",Bs,Bs)}catch{Pg=!1}function iA(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var yo=!1,Cl=null,El=!1,Og=null,sA={onError:function(e){yo=!0,Cl=e}};function oA(e,t,r,n,i,s,o,l,c){yo=!1,Cl=null,iA.apply(sA,arguments)}function aA(e,t,r,n,i,s,o,l,c){if(oA.apply(this,arguments),yo){if(yo){var u=Cl;yo=!1,Cl=null}else throw Error(J(198));El||(El=!0,Og=u)}}function Ei(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function ok(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Uy(e){if(Ei(e)!==e)throw Error(J(188))}function lA(e){var t=e.alternate;if(!t){if(t=Ei(e),t===null)throw Error(J(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Uy(i),e;if(s===n)return Uy(i),t;s=s.sibling}throw Error(J(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(J(189))}}if(r.alternate!==n)throw Error(J(190))}if(r.tag!==3)throw Error(J(188));return r.stateNode.current===r?e:t}function ak(e){return e=lA(e),e!==null?lk(e):null}function lk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=lk(e);if(t!==null)return t;e=e.sibling}return null}var ck=Qt.unstable_scheduleCallback,Vy=Qt.unstable_cancelCallback,cA=Qt.unstable_shouldYield,uA=Qt.unstable_requestPaint,et=Qt.unstable_now,dA=Qt.unstable_getCurrentPriorityLevel,Jv=Qt.unstable_ImmediatePriority,uk=Qt.unstable_UserBlockingPriority,Tl=Qt.unstable_NormalPriority,fA=Qt.unstable_LowPriority,dk=Qt.unstable_IdlePriority,_c=null,qr=null;function pA(e){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(_c,e,void 0,(e.current.flags&128)===128)}catch{}}var jr=Math.clz32?Math.clz32:gA,hA=Math.log,mA=Math.LN2;function gA(e){return e>>>=0,e===0?32:31-(hA(e)/mA|0)|0}var Aa=64,Ia=4194304;function oo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Rl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=oo(l):(s&=o,s!==0&&(n=oo(s)))}else o=r&~i,o!==0?n=oo(o):s!==0&&(n=oo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-jr(t),i=1<<r,n|=e[r],t&=~i;return n}function vA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xA(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-jr(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=vA(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Dg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fk(){var e=Aa;return Aa<<=1,!(Aa&4194240)&&(Aa=64),e}function Nu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ua(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jr(t),e[t]=r}function yA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-jr(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function ex(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-jr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Me=0;function pk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hk,tx,mk,gk,vk,Lg=!1,Ma=[],On=null,Dn=null,Ln=null,Po=new Map,Oo=new Map,En=[],bA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gy(e,t){switch(e){case"focusin":case"focusout":On=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":Po.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oo.delete(t.pointerId)}}function Hs(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=fa(t),t!==null&&tx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function wA(e,t,r,n,i){switch(t){case"focusin":return On=Hs(On,e,t,r,n,i),!0;case"dragenter":return Dn=Hs(Dn,e,t,r,n,i),!0;case"mouseover":return Ln=Hs(Ln,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Po.set(s,Hs(Po.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Oo.set(s,Hs(Oo.get(s)||null,e,t,r,n,i)),!0}return!1}function xk(e){var t=ci(e.target);if(t!==null){var r=Ei(t);if(r!==null){if(t=r.tag,t===13){if(t=ok(r),t!==null){e.blockedOn=t,vk(e.priority,function(){mk(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function dl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Fg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ig=n,r.target.dispatchEvent(n),Ig=null}else return t=fa(r),t!==null&&tx(t),e.blockedOn=r,!1;t.shift()}return!0}function Ky(e,t,r){dl(e)&&r.delete(t)}function _A(){Lg=!1,On!==null&&dl(On)&&(On=null),Dn!==null&&dl(Dn)&&(Dn=null),Ln!==null&&dl(Ln)&&(Ln=null),Po.forEach(Ky),Oo.forEach(Ky)}function Ws(e,t){e.blockedOn===t&&(e.blockedOn=null,Lg||(Lg=!0,Qt.unstable_scheduleCallback(Qt.unstable_NormalPriority,_A)))}function Do(e){function t(i){return Ws(i,e)}if(0<Ma.length){Ws(Ma[0],e);for(var r=1;r<Ma.length;r++){var n=Ma[r];n.blockedOn===e&&(n.blockedOn=null)}}for(On!==null&&Ws(On,e),Dn!==null&&Ws(Dn,e),Ln!==null&&Ws(Ln,e),Po.forEach(t),Oo.forEach(t),r=0;r<En.length;r++)n=En[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<En.length&&(r=En[0],r.blockedOn===null);)xk(r),r.blockedOn===null&&En.shift()}var ls=gn.ReactCurrentBatchConfig,Al=!0;function SA(e,t,r,n){var i=Me,s=ls.transition;ls.transition=null;try{Me=1,rx(e,t,r,n)}finally{Me=i,ls.transition=s}}function jA(e,t,r,n){var i=Me,s=ls.transition;ls.transition=null;try{Me=4,rx(e,t,r,n)}finally{Me=i,ls.transition=s}}function rx(e,t,r,n){if(Al){var i=Fg(e,t,r,n);if(i===null)Du(e,t,n,Il,r),Gy(e,n);else if(wA(i,e,t,r,n))n.stopPropagation();else if(Gy(e,n),t&4&&-1<bA.indexOf(e)){for(;i!==null;){var s=fa(i);if(s!==null&&hk(s),s=Fg(e,t,r,n),s===null&&Du(e,t,n,Il,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Du(e,t,n,null,r)}}var Il=null;function Fg(e,t,r,n){if(Il=null,e=Zv(n),e=ci(e),e!==null)if(t=Ei(e),t===null)e=null;else if(r=t.tag,r===13){if(e=ok(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Il=e,null}function yk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dA()){case Jv:return 1;case uk:return 4;case Tl:case fA:return 16;case dk:return 536870912;default:return 16}default:return 16}}var Mn=null,nx=null,fl=null;function bk(){if(fl)return fl;var e,t=nx,r=t.length,n,i="value"in Mn?Mn.value:Mn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return fl=i.slice(e,1<n?1-n:void 0)}function pl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Pa(){return!0}function Yy(){return!1}function er(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Pa:Yy,this.isPropagationStopped=Yy,this}return Ye(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Pa)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Pa)},persist:function(){},isPersistent:Pa}),t}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ix=er(Ts),da=Ye({},Ts,{view:0,detail:0}),kA=er(da),Cu,Eu,Us,Sc=Ye({},da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Us&&(Us&&e.type==="mousemove"?(Cu=e.screenX-Us.screenX,Eu=e.screenY-Us.screenY):Eu=Cu=0,Us=e),Cu)},movementY:function(e){return"movementY"in e?e.movementY:Eu}}),Xy=er(Sc),NA=Ye({},Sc,{dataTransfer:0}),CA=er(NA),EA=Ye({},da,{relatedTarget:0}),Tu=er(EA),TA=Ye({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),RA=er(TA),AA=Ye({},Ts,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),IA=er(AA),MA=Ye({},Ts,{data:0}),Qy=er(MA),PA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},OA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=DA[e])?!!t[e]:!1}function sx(){return LA}var FA=Ye({},da,{key:function(e){if(e.key){var t=PA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?OA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sx,charCode:function(e){return e.type==="keypress"?pl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zA=er(FA),qA=Ye({},Sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zy=er(qA),$A=Ye({},da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sx}),BA=er($A),HA=Ye({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),WA=er(HA),UA=Ye({},Sc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),VA=er(UA),GA=[9,13,27,32],ox=ln&&"CompositionEvent"in window,bo=null;ln&&"documentMode"in document&&(bo=document.documentMode);var KA=ln&&"TextEvent"in window&&!bo,wk=ln&&(!ox||bo&&8<bo&&11>=bo),Jy=" ",e0=!1;function _k(e,t){switch(e){case"keyup":return GA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ui=!1;function YA(e,t){switch(e){case"compositionend":return Sk(t);case"keypress":return t.which!==32?null:(e0=!0,Jy);case"textInput":return e=t.data,e===Jy&&e0?null:e;default:return null}}function XA(e,t){if(Ui)return e==="compositionend"||!ox&&_k(e,t)?(e=bk(),fl=nx=Mn=null,Ui=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wk&&t.locale!=="ko"?null:t.data;default:return null}}var QA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function t0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!QA[e.type]:t==="textarea"}function jk(e,t,r,n){tk(n),t=Ml(t,"onChange"),0<t.length&&(r=new ix("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var wo=null,Lo=null;function ZA(e){Ok(e,0)}function jc(e){var t=Ki(e);if(Kj(t))return e}function JA(e,t){if(e==="change")return t}var kk=!1;if(ln){var Ru;if(ln){var Au="oninput"in document;if(!Au){var r0=document.createElement("div");r0.setAttribute("oninput","return;"),Au=typeof r0.oninput=="function"}Ru=Au}else Ru=!1;kk=Ru&&(!document.documentMode||9<document.documentMode)}function n0(){wo&&(wo.detachEvent("onpropertychange",Nk),Lo=wo=null)}function Nk(e){if(e.propertyName==="value"&&jc(Lo)){var t=[];jk(t,Lo,e,Zv(e)),sk(ZA,t)}}function e5(e,t,r){e==="focusin"?(n0(),wo=t,Lo=r,wo.attachEvent("onpropertychange",Nk)):e==="focusout"&&n0()}function t5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return jc(Lo)}function r5(e,t){if(e==="click")return jc(t)}function n5(e,t){if(e==="input"||e==="change")return jc(t)}function i5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nr=typeof Object.is=="function"?Object.is:i5;function Fo(e,t){if(Nr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!bg.call(t,i)||!Nr(e[i],t[i]))return!1}return!0}function i0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function s0(e,t){var r=i0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=i0(r)}}function Ck(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ck(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ek(){for(var e=window,t=Nl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Nl(e.document)}return t}function ax(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function s5(e){var t=Ek(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ck(r.ownerDocument.documentElement,r)){if(n!==null&&ax(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=s0(r,s);var o=s0(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var o5=ln&&"documentMode"in document&&11>=document.documentMode,Vi=null,zg=null,_o=null,qg=!1;function o0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;qg||Vi==null||Vi!==Nl(n)||(n=Vi,"selectionStart"in n&&ax(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_o&&Fo(_o,n)||(_o=n,n=Ml(zg,"onSelect"),0<n.length&&(t=new ix("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Vi)))}function Oa(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Gi={animationend:Oa("Animation","AnimationEnd"),animationiteration:Oa("Animation","AnimationIteration"),animationstart:Oa("Animation","AnimationStart"),transitionend:Oa("Transition","TransitionEnd")},Iu={},Tk={};ln&&(Tk=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function kc(e){if(Iu[e])return Iu[e];if(!Gi[e])return e;var t=Gi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Tk)return Iu[e]=t[r];return e}var Rk=kc("animationend"),Ak=kc("animationiteration"),Ik=kc("animationstart"),Mk=kc("transitionend"),Pk=new Map,a0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qn(e,t){Pk.set(e,t),Ci(t,[e])}for(var Mu=0;Mu<a0.length;Mu++){var Pu=a0[Mu],a5=Pu.toLowerCase(),l5=Pu[0].toUpperCase()+Pu.slice(1);Qn(a5,"on"+l5)}Qn(Rk,"onAnimationEnd");Qn(Ak,"onAnimationIteration");Qn(Ik,"onAnimationStart");Qn("dblclick","onDoubleClick");Qn("focusin","onFocus");Qn("focusout","onBlur");Qn(Mk,"onTransitionEnd");ms("onMouseEnter",["mouseout","mouseover"]);ms("onMouseLeave",["mouseout","mouseover"]);ms("onPointerEnter",["pointerout","pointerover"]);ms("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),c5=new Set("cancel close invalid load scroll toggle".split(" ").concat(ao));function l0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,aA(n,t,void 0,e),e.currentTarget=null}function Ok(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;l0(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;l0(i,l,u),s=c}}}if(El)throw e=Og,El=!1,Og=null,e}function Fe(e,t){var r=t[Ug];r===void 0&&(r=t[Ug]=new Set);var n=e+"__bubble";r.has(n)||(Dk(t,e,2,!1),r.add(n))}function Ou(e,t,r){var n=0;t&&(n|=4),Dk(r,e,n,t)}var Da="_reactListening"+Math.random().toString(36).slice(2);function zo(e){if(!e[Da]){e[Da]=!0,Hj.forEach(function(r){r!=="selectionchange"&&(c5.has(r)||Ou(r,!1,e),Ou(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Da]||(t[Da]=!0,Ou("selectionchange",!1,t))}}function Dk(e,t,r,n){switch(yk(t)){case 1:var i=SA;break;case 4:i=jA;break;default:i=rx}r=i.bind(null,t,r,e),i=void 0,!Pg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Du(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ci(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}sk(function(){var u=s,d=Zv(r),f=[];e:{var h=Pk.get(e);if(h!==void 0){var p=ix,y=e;switch(e){case"keypress":if(pl(r)===0)break e;case"keydown":case"keyup":p=zA;break;case"focusin":y="focus",p=Tu;break;case"focusout":y="blur",p=Tu;break;case"beforeblur":case"afterblur":p=Tu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Xy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=CA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=BA;break;case Rk:case Ak:case Ik:p=RA;break;case Mk:p=WA;break;case"scroll":p=kA;break;case"wheel":p=VA;break;case"copy":case"cut":case"paste":p=IA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Zy}var g=(t&4)!==0,w=!g&&e==="scroll",v=g?h!==null?h+"Capture":null:h;g=[];for(var x=u,b;x!==null;){b=x;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,v!==null&&(_=Mo(x,v),_!=null&&g.push(qo(x,_,b)))),w)break;x=x.return}0<g.length&&(h=new p(h,y,null,r,d),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Ig&&(y=r.relatedTarget||r.fromElement)&&(ci(y)||y[cn]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(y=r.relatedTarget||r.toElement,p=u,y=y?ci(y):null,y!==null&&(w=Ei(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(g=Xy,_="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=Zy,_="onPointerLeave",v="onPointerEnter",x="pointer"),w=p==null?h:Ki(p),b=y==null?h:Ki(y),h=new g(_,x+"leave",p,r,d),h.target=w,h.relatedTarget=b,_=null,ci(d)===u&&(g=new g(v,x+"enter",y,r,d),g.target=b,g.relatedTarget=w,_=g),w=_,p&&y)t:{for(g=p,v=y,x=0,b=g;b;b=Pi(b))x++;for(b=0,_=v;_;_=Pi(_))b++;for(;0<x-b;)g=Pi(g),x--;for(;0<b-x;)v=Pi(v),b--;for(;x--;){if(g===v||v!==null&&g===v.alternate)break t;g=Pi(g),v=Pi(v)}g=null}else g=null;p!==null&&c0(f,h,p,g,!1),y!==null&&w!==null&&c0(f,w,y,g,!0)}}e:{if(h=u?Ki(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var S=JA;else if(t0(h))if(kk)S=n5;else{S=t5;var k=e5}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=r5);if(S&&(S=S(e,u))){jk(f,S,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Cg(h,"number",h.value)}switch(k=u?Ki(u):window,e){case"focusin":(t0(k)||k.contentEditable==="true")&&(Vi=k,zg=u,_o=null);break;case"focusout":_o=zg=Vi=null;break;case"mousedown":qg=!0;break;case"contextmenu":case"mouseup":case"dragend":qg=!1,o0(f,r,d);break;case"selectionchange":if(o5)break;case"keydown":case"keyup":o0(f,r,d)}var N;if(ox)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ui?_k(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(wk&&r.locale!=="ko"&&(Ui||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ui&&(N=bk()):(Mn=d,nx="value"in Mn?Mn.value:Mn.textContent,Ui=!0)),k=Ml(u,E),0<k.length&&(E=new Qy(E,e,null,r,d),f.push({event:E,listeners:k}),N?E.data=N:(N=Sk(r),N!==null&&(E.data=N)))),(N=KA?YA(e,r):XA(e,r))&&(u=Ml(u,"onBeforeInput"),0<u.length&&(d=new Qy("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=N))}Ok(f,t)})}function qo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ml(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Mo(e,r),s!=null&&n.unshift(qo(e,s,i)),s=Mo(e,t),s!=null&&n.push(qo(e,s,i))),e=e.return}return n}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function c0(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=Mo(r,s),c!=null&&o.unshift(qo(r,c,l))):i||(c=Mo(r,s),c!=null&&o.push(qo(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var u5=/\r\n?/g,d5=/\u0000|\uFFFD/g;function u0(e){return(typeof e=="string"?e:""+e).replace(u5,`
`).replace(d5,"")}function La(e,t,r){if(t=u0(t),u0(e)!==t&&r)throw Error(J(425))}function Pl(){}var $g=null,Bg=null;function Hg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wg=typeof setTimeout=="function"?setTimeout:void 0,f5=typeof clearTimeout=="function"?clearTimeout:void 0,d0=typeof Promise=="function"?Promise:void 0,p5=typeof queueMicrotask=="function"?queueMicrotask:typeof d0<"u"?function(e){return d0.resolve(null).then(e).catch(h5)}:Wg;function h5(e){setTimeout(function(){throw e})}function Lu(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Do(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Do(t)}function Fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function f0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Rs=Math.random().toString(36).slice(2),Fr="__reactFiber$"+Rs,$o="__reactProps$"+Rs,cn="__reactContainer$"+Rs,Ug="__reactEvents$"+Rs,m5="__reactListeners$"+Rs,g5="__reactHandles$"+Rs;function ci(e){var t=e[Fr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[cn]||r[Fr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=f0(e);e!==null;){if(r=e[Fr])return r;e=f0(e)}return t}e=r,r=e.parentNode}return null}function fa(e){return e=e[Fr]||e[cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ki(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function Nc(e){return e[$o]||null}var Vg=[],Yi=-1;function Zn(e){return{current:e}}function ze(e){0>Yi||(e.current=Vg[Yi],Vg[Yi]=null,Yi--)}function De(e,t){Yi++,Vg[Yi]=e.current,e.current=t}var Kn={},_t=Zn(Kn),qt=Zn(!1),bi=Kn;function gs(e,t){var r=e.type.contextTypes;if(!r)return Kn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function $t(e){return e=e.childContextTypes,e!=null}function Ol(){ze(qt),ze(_t)}function p0(e,t,r){if(_t.current!==Kn)throw Error(J(168));De(_t,t),De(qt,r)}function Lk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(J(108,eA(e)||"Unknown",i));return Ye({},r,n)}function Dl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Kn,bi=_t.current,De(_t,e),De(qt,qt.current),!0}function h0(e,t,r){var n=e.stateNode;if(!n)throw Error(J(169));r?(e=Lk(e,t,bi),n.__reactInternalMemoizedMergedChildContext=e,ze(qt),ze(_t),De(_t,e)):ze(qt),De(qt,r)}var Zr=null,Cc=!1,Fu=!1;function Fk(e){Zr===null?Zr=[e]:Zr.push(e)}function v5(e){Cc=!0,Fk(e)}function Jn(){if(!Fu&&Zr!==null){Fu=!0;var e=0,t=Me;try{var r=Zr;for(Me=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Zr=null,Cc=!1}catch(i){throw Zr!==null&&(Zr=Zr.slice(e+1)),ck(Jv,Jn),i}finally{Me=t,Fu=!1}}return null}var Xi=[],Qi=0,Ll=null,Fl=0,sr=[],or=0,wi=null,en=1,tn="";function oi(e,t){Xi[Qi++]=Fl,Xi[Qi++]=Ll,Ll=e,Fl=t}function zk(e,t,r){sr[or++]=en,sr[or++]=tn,sr[or++]=wi,wi=e;var n=en;e=tn;var i=32-jr(n)-1;n&=~(1<<i),r+=1;var s=32-jr(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,en=1<<32-jr(t)+i|r<<i|n,tn=s+e}else en=1<<s|r<<i|n,tn=e}function lx(e){e.return!==null&&(oi(e,1),zk(e,1,0))}function cx(e){for(;e===Ll;)Ll=Xi[--Qi],Xi[Qi]=null,Fl=Xi[--Qi],Xi[Qi]=null;for(;e===wi;)wi=sr[--or],sr[or]=null,tn=sr[--or],sr[or]=null,en=sr[--or],sr[or]=null}var Xt=null,Yt=null,qe=!1,_r=null;function qk(e,t){var r=lr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function m0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xt=e,Yt=Fn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xt=e,Yt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=wi!==null?{id:en,overflow:tn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=lr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Xt=e,Yt=null,!0):!1;default:return!1}}function Gg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kg(e){if(qe){var t=Yt;if(t){var r=t;if(!m0(e,t)){if(Gg(e))throw Error(J(418));t=Fn(r.nextSibling);var n=Xt;t&&m0(e,t)?qk(n,r):(e.flags=e.flags&-4097|2,qe=!1,Xt=e)}}else{if(Gg(e))throw Error(J(418));e.flags=e.flags&-4097|2,qe=!1,Xt=e}}}function g0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xt=e}function Fa(e){if(e!==Xt)return!1;if(!qe)return g0(e),qe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Hg(e.type,e.memoizedProps)),t&&(t=Yt)){if(Gg(e))throw $k(),Error(J(418));for(;t;)qk(e,t),t=Fn(t.nextSibling)}if(g0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Yt=Fn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Yt=null}}else Yt=Xt?Fn(e.stateNode.nextSibling):null;return!0}function $k(){for(var e=Yt;e;)e=Fn(e.nextSibling)}function vs(){Yt=Xt=null,qe=!1}function ux(e){_r===null?_r=[e]:_r.push(e)}var x5=gn.ReactCurrentBatchConfig;function Vs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(J(309));var n=r.stateNode}if(!n)throw Error(J(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(J(284));if(!r._owner)throw Error(J(290,e))}return e}function za(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function v0(e){var t=e._init;return t(e._payload)}function Bk(e){function t(v,x){if(e){var b=v.deletions;b===null?(v.deletions=[x],v.flags|=16):b.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=Bn(v,x),v.index=0,v.sibling=null,v}function s(v,x,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<x?(v.flags|=2,x):b):(v.flags|=2,x)):(v.flags|=1048576,x)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,x,b,_){return x===null||x.tag!==6?(x=Uu(b,v.mode,_),x.return=v,x):(x=i(x,b),x.return=v,x)}function c(v,x,b,_){var S=b.type;return S===Wi?d(v,x,b.props.children,_,b.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Sn&&v0(S)===x.type)?(_=i(x,b.props),_.ref=Vs(v,x,b),_.return=v,_):(_=bl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vs(v,x,b),_.return=v,_)}function u(v,x,b,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=Vu(b,v.mode,_),x.return=v,x):(x=i(x,b.children||[]),x.return=v,x)}function d(v,x,b,_,S){return x===null||x.tag!==7?(x=gi(b,v.mode,_,S),x.return=v,x):(x=i(x,b),x.return=v,x)}function f(v,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Uu(""+x,v.mode,b),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ea:return b=bl(x.type,x.key,x.props,null,v.mode,b),b.ref=Vs(v,null,x),b.return=v,b;case Hi:return x=Vu(x,v.mode,b),x.return=v,x;case Sn:var _=x._init;return f(v,_(x._payload),b)}if(so(x)||$s(x))return x=gi(x,v.mode,b,null),x.return=v,x;za(v,x)}return null}function h(v,x,b,_){var S=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:l(v,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ea:return b.key===S?c(v,x,b,_):null;case Hi:return b.key===S?u(v,x,b,_):null;case Sn:return S=b._init,h(v,x,S(b._payload),_)}if(so(b)||$s(b))return S!==null?null:d(v,x,b,_,null);za(v,b)}return null}function p(v,x,b,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(b)||null,l(x,v,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ea:return v=v.get(_.key===null?b:_.key)||null,c(x,v,_,S);case Hi:return v=v.get(_.key===null?b:_.key)||null,u(x,v,_,S);case Sn:var k=_._init;return p(v,x,b,k(_._payload),S)}if(so(_)||$s(_))return v=v.get(b)||null,d(x,v,_,S,null);za(x,_)}return null}function y(v,x,b,_){for(var S=null,k=null,N=x,E=x=0,j=null;N!==null&&E<b.length;E++){N.index>E?(j=N,N=null):j=N.sibling;var R=h(v,N,b[E],_);if(R===null){N===null&&(N=j);break}e&&N&&R.alternate===null&&t(v,N),x=s(R,x,E),k===null?S=R:k.sibling=R,k=R,N=j}if(E===b.length)return r(v,N),qe&&oi(v,E),S;if(N===null){for(;E<b.length;E++)N=f(v,b[E],_),N!==null&&(x=s(N,x,E),k===null?S=N:k.sibling=N,k=N);return qe&&oi(v,E),S}for(N=n(v,N);E<b.length;E++)j=p(N,v,E,b[E],_),j!==null&&(e&&j.alternate!==null&&N.delete(j.key===null?E:j.key),x=s(j,x,E),k===null?S=j:k.sibling=j,k=j);return e&&N.forEach(function(T){return t(v,T)}),qe&&oi(v,E),S}function g(v,x,b,_){var S=$s(b);if(typeof S!="function")throw Error(J(150));if(b=S.call(b),b==null)throw Error(J(151));for(var k=S=null,N=x,E=x=0,j=null,R=b.next();N!==null&&!R.done;E++,R=b.next()){N.index>E?(j=N,N=null):j=N.sibling;var T=h(v,N,R.value,_);if(T===null){N===null&&(N=j);break}e&&N&&T.alternate===null&&t(v,N),x=s(T,x,E),k===null?S=T:k.sibling=T,k=T,N=j}if(R.done)return r(v,N),qe&&oi(v,E),S;if(N===null){for(;!R.done;E++,R=b.next())R=f(v,R.value,_),R!==null&&(x=s(R,x,E),k===null?S=R:k.sibling=R,k=R);return qe&&oi(v,E),S}for(N=n(v,N);!R.done;E++,R=b.next())R=p(N,v,E,R.value,_),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?E:R.key),x=s(R,x,E),k===null?S=R:k.sibling=R,k=R);return e&&N.forEach(function(P){return t(v,P)}),qe&&oi(v,E),S}function w(v,x,b,_){if(typeof b=="object"&&b!==null&&b.type===Wi&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ea:e:{for(var S=b.key,k=x;k!==null;){if(k.key===S){if(S=b.type,S===Wi){if(k.tag===7){r(v,k.sibling),x=i(k,b.props.children),x.return=v,v=x;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Sn&&v0(S)===k.type){r(v,k.sibling),x=i(k,b.props),x.ref=Vs(v,k,b),x.return=v,v=x;break e}r(v,k);break}else t(v,k);k=k.sibling}b.type===Wi?(x=gi(b.props.children,v.mode,_,b.key),x.return=v,v=x):(_=bl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vs(v,x,b),_.return=v,v=_)}return o(v);case Hi:e:{for(k=b.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){r(v,x.sibling),x=i(x,b.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=Vu(b,v.mode,_),x.return=v,v=x}return o(v);case Sn:return k=b._init,w(v,x,k(b._payload),_)}if(so(b))return y(v,x,b,_);if($s(b))return g(v,x,b,_);za(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,b),x.return=v,v=x):(r(v,x),x=Uu(b,v.mode,_),x.return=v,v=x),o(v)):r(v,x)}return w}var xs=Bk(!0),Hk=Bk(!1),zl=Zn(null),ql=null,Zi=null,dx=null;function fx(){dx=Zi=ql=null}function px(e){var t=zl.current;ze(zl),e._currentValue=t}function Yg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cs(e,t){ql=e,dx=Zi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Lt=!0),e.firstContext=null)}function dr(e){var t=e._currentValue;if(dx!==e)if(e={context:e,memoizedValue:t,next:null},Zi===null){if(ql===null)throw Error(J(308));Zi=e,ql.dependencies={lanes:0,firstContext:e}}else Zi=Zi.next=e;return t}var ui=null;function hx(e){ui===null?ui=[e]:ui.push(e)}function Wk(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,hx(t)):(r.next=i.next,i.next=r),t.interleaved=r,un(e,n)}function un(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var jn=!1;function mx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function on(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Te&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,un(e,r)}return i=n.interleaved,i===null?(t.next=t,hx(n)):(t.next=i.next,i.next=t),n.interleaved=t,un(e,r)}function hl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ex(e,r)}}function x0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function $l(e,t,r,n){var i=e.updateQueue;jn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,d=u=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,g=l;switch(h=t,p=r,g.tag){case 1:if(y=g.payload,typeof y=="function"){f=y.call(p,f,h);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,h=typeof y=="function"?y.call(p,f,h):y,h==null)break e;f=Ye({},f,h);break e;case 2:jn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Si|=o,e.lanes=o,e.memoizedState=f}}function y0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(J(191,i));i.call(n)}}}var pa={},$r=Zn(pa),Bo=Zn(pa),Ho=Zn(pa);function di(e){if(e===pa)throw Error(J(174));return e}function gx(e,t){switch(De(Ho,t),De(Bo,e),De($r,pa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Tg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Tg(t,e)}ze($r),De($r,t)}function ys(){ze($r),ze(Bo),ze(Ho)}function Vk(e){di(Ho.current);var t=di($r.current),r=Tg(t,e.type);t!==r&&(De(Bo,e),De($r,r))}function vx(e){Bo.current===e&&(ze($r),ze(Bo))}var Ge=Zn(0);function Bl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zu=[];function xx(){for(var e=0;e<zu.length;e++)zu[e]._workInProgressVersionPrimary=null;zu.length=0}var ml=gn.ReactCurrentDispatcher,qu=gn.ReactCurrentBatchConfig,_i=0,Ke=null,ot=null,dt=null,Hl=!1,So=!1,Wo=0,y5=0;function yt(){throw Error(J(321))}function yx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Nr(e[r],t[r]))return!1;return!0}function bx(e,t,r,n,i,s){if(_i=s,Ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ml.current=e===null||e.memoizedState===null?S5:j5,e=r(n,i),So){s=0;do{if(So=!1,Wo=0,25<=s)throw Error(J(301));s+=1,dt=ot=null,t.updateQueue=null,ml.current=k5,e=r(n,i)}while(So)}if(ml.current=Wl,t=ot!==null&&ot.next!==null,_i=0,dt=ot=Ke=null,Hl=!1,t)throw Error(J(300));return e}function wx(){var e=Wo!==0;return Wo=0,e}function Lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?Ke.memoizedState=dt=e:dt=dt.next=e,dt}function fr(){if(ot===null){var e=Ke.alternate;e=e!==null?e.memoizedState:null}else e=ot.next;var t=dt===null?Ke.memoizedState:dt.next;if(t!==null)dt=t,ot=e;else{if(e===null)throw Error(J(310));ot=e,e={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},dt===null?Ke.memoizedState=dt=e:dt=dt.next=e}return dt}function Uo(e,t){return typeof t=="function"?t(e):t}function $u(e){var t=fr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=ot,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((_i&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ke.lanes|=d,Si|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,Nr(n,t.memoizedState)||(Lt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ke.lanes|=s,Si|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Bu(e){var t=fr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Nr(s,t.memoizedState)||(Lt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Gk(){}function Kk(e,t){var r=Ke,n=fr(),i=t(),s=!Nr(n.memoizedState,i);if(s&&(n.memoizedState=i,Lt=!0),n=n.queue,_x(Qk.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||dt!==null&&dt.memoizedState.tag&1){if(r.flags|=2048,Vo(9,Xk.bind(null,r,n,i,t),void 0,null),pt===null)throw Error(J(349));_i&30||Yk(r,t,i)}return i}function Yk(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Xk(e,t,r,n){t.value=r,t.getSnapshot=n,Zk(t)&&Jk(e)}function Qk(e,t,r){return r(function(){Zk(t)&&Jk(e)})}function Zk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Nr(e,r)}catch{return!0}}function Jk(e){var t=un(e,1);t!==null&&kr(t,e,1,-1)}function b0(e){var t=Lr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uo,lastRenderedState:e},t.queue=e,e=e.dispatch=_5.bind(null,Ke,e),[t.memoizedState,e]}function Vo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function eN(){return fr().memoizedState}function gl(e,t,r,n){var i=Lr();Ke.flags|=e,i.memoizedState=Vo(1|t,r,void 0,n===void 0?null:n)}function Ec(e,t,r,n){var i=fr();n=n===void 0?null:n;var s=void 0;if(ot!==null){var o=ot.memoizedState;if(s=o.destroy,n!==null&&yx(n,o.deps)){i.memoizedState=Vo(t,r,s,n);return}}Ke.flags|=e,i.memoizedState=Vo(1|t,r,s,n)}function w0(e,t){return gl(8390656,8,e,t)}function _x(e,t){return Ec(2048,8,e,t)}function tN(e,t){return Ec(4,2,e,t)}function rN(e,t){return Ec(4,4,e,t)}function nN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function iN(e,t,r){return r=r!=null?r.concat([e]):null,Ec(4,4,nN.bind(null,t,e),r)}function Sx(){}function sN(e,t){var r=fr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&yx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function oN(e,t){var r=fr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&yx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function aN(e,t,r){return _i&21?(Nr(r,t)||(r=fk(),Ke.lanes|=r,Si|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Lt=!0),e.memoizedState=r)}function b5(e,t){var r=Me;Me=r!==0&&4>r?r:4,e(!0);var n=qu.transition;qu.transition={};try{e(!1),t()}finally{Me=r,qu.transition=n}}function lN(){return fr().memoizedState}function w5(e,t,r){var n=$n(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},cN(e))uN(t,r);else if(r=Wk(e,t,r,n),r!==null){var i=Rt();kr(r,e,n,i),dN(r,t,n)}}function _5(e,t,r){var n=$n(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(cN(e))uN(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,Nr(l,o)){var c=t.interleaved;c===null?(i.next=i,hx(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=Wk(e,t,i,n),r!==null&&(i=Rt(),kr(r,e,n,i),dN(r,t,n))}}function cN(e){var t=e.alternate;return e===Ke||t!==null&&t===Ke}function uN(e,t){So=Hl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function dN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ex(e,r)}}var Wl={readContext:dr,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},S5={readContext:dr,useCallback:function(e,t){return Lr().memoizedState=[e,t===void 0?null:t],e},useContext:dr,useEffect:w0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,gl(4194308,4,nN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return gl(4194308,4,e,t)},useInsertionEffect:function(e,t){return gl(4,2,e,t)},useMemo:function(e,t){var r=Lr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Lr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=w5.bind(null,Ke,e),[n.memoizedState,e]},useRef:function(e){var t=Lr();return e={current:e},t.memoizedState=e},useState:b0,useDebugValue:Sx,useDeferredValue:function(e){return Lr().memoizedState=e},useTransition:function(){var e=b0(!1),t=e[0];return e=b5.bind(null,e[1]),Lr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ke,i=Lr();if(qe){if(r===void 0)throw Error(J(407));r=r()}else{if(r=t(),pt===null)throw Error(J(349));_i&30||Yk(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,w0(Qk.bind(null,n,s,e),[e]),n.flags|=2048,Vo(9,Xk.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Lr(),t=pt.identifierPrefix;if(qe){var r=tn,n=en;r=(n&~(1<<32-jr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Wo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=y5++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},j5={readContext:dr,useCallback:sN,useContext:dr,useEffect:_x,useImperativeHandle:iN,useInsertionEffect:tN,useLayoutEffect:rN,useMemo:oN,useReducer:$u,useRef:eN,useState:function(){return $u(Uo)},useDebugValue:Sx,useDeferredValue:function(e){var t=fr();return aN(t,ot.memoizedState,e)},useTransition:function(){var e=$u(Uo)[0],t=fr().memoizedState;return[e,t]},useMutableSource:Gk,useSyncExternalStore:Kk,useId:lN,unstable_isNewReconciler:!1},k5={readContext:dr,useCallback:sN,useContext:dr,useEffect:_x,useImperativeHandle:iN,useInsertionEffect:tN,useLayoutEffect:rN,useMemo:oN,useReducer:Bu,useRef:eN,useState:function(){return Bu(Uo)},useDebugValue:Sx,useDeferredValue:function(e){var t=fr();return ot===null?t.memoizedState=e:aN(t,ot.memoizedState,e)},useTransition:function(){var e=Bu(Uo)[0],t=fr().memoizedState;return[e,t]},useMutableSource:Gk,useSyncExternalStore:Kk,useId:lN,unstable_isNewReconciler:!1};function yr(e,t){if(e&&e.defaultProps){t=Ye({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Xg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ye({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Tc={isMounted:function(e){return(e=e._reactInternals)?Ei(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Rt(),i=$n(e),s=on(n,i);s.payload=t,r!=null&&(s.callback=r),t=zn(e,s,i),t!==null&&(kr(t,e,i,n),hl(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Rt(),i=$n(e),s=on(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=zn(e,s,i),t!==null&&(kr(t,e,i,n),hl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Rt(),n=$n(e),i=on(r,n);i.tag=2,t!=null&&(i.callback=t),t=zn(e,i,n),t!==null&&(kr(t,e,n,r),hl(t,e,n))}};function _0(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Fo(r,n)||!Fo(i,s):!0}function fN(e,t,r){var n=!1,i=Kn,s=t.contextType;return typeof s=="object"&&s!==null?s=dr(s):(i=$t(t)?bi:_t.current,n=t.contextTypes,s=(n=n!=null)?gs(e,i):Kn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Tc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function S0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Tc.enqueueReplaceState(t,t.state,null)}function Qg(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},mx(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=dr(s):(s=$t(t)?bi:_t.current,i.context=gs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Xg(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Tc.enqueueReplaceState(i,i.state,null),$l(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function bs(e,t){try{var r="",n=t;do r+=JR(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Hu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Zg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var N5=typeof WeakMap=="function"?WeakMap:Map;function pN(e,t,r){r=on(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Vl||(Vl=!0,lv=n),Zg(e,t)},r}function hN(e,t,r){r=on(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Zg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Zg(e,t),typeof n!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function j0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new N5;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=q5.bind(null,e,t,r),t.then(e,e))}function k0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function N0(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=on(-1,1),t.tag=2,zn(r,t,1))),r.lanes|=1),e)}var C5=gn.ReactCurrentOwner,Lt=!1;function Et(e,t,r,n){t.child=e===null?Hk(t,null,r,n):xs(t,e.child,r,n)}function C0(e,t,r,n,i){r=r.render;var s=t.ref;return cs(t,i),n=bx(e,t,r,n,s,i),r=wx(),e!==null&&!Lt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,dn(e,t,i)):(qe&&r&&lx(t),t.flags|=1,Et(e,t,n,i),t.child)}function E0(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Ax(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,mN(e,t,s,n,i)):(e=bl(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Fo,r(o,n)&&e.ref===t.ref)return dn(e,t,i)}return t.flags|=1,e=Bn(s,n),e.ref=t.ref,e.return=t,t.child=e}function mN(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Fo(s,n)&&e.ref===t.ref)if(Lt=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Lt=!0);else return t.lanes=e.lanes,dn(e,t,i)}return Jg(e,t,r,n,i)}function gN(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(es,Gt),Gt|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,De(es,Gt),Gt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,De(es,Gt),Gt|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,De(es,Gt),Gt|=n;return Et(e,t,i,r),t.child}function vN(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Jg(e,t,r,n,i){var s=$t(r)?bi:_t.current;return s=gs(t,s),cs(t,i),r=bx(e,t,r,n,s,i),n=wx(),e!==null&&!Lt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,dn(e,t,i)):(qe&&n&&lx(t),t.flags|=1,Et(e,t,r,i),t.child)}function T0(e,t,r,n,i){if($t(r)){var s=!0;Dl(t)}else s=!1;if(cs(t,i),t.stateNode===null)vl(e,t),fN(t,r,n),Qg(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=dr(u):(u=$t(r)?bi:_t.current,u=gs(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&S0(t,o,n,u),jn=!1;var h=t.memoizedState;o.state=h,$l(t,n,o,i),c=t.memoizedState,l!==n||h!==c||qt.current||jn?(typeof d=="function"&&(Xg(t,r,d,n),c=t.memoizedState),(l=jn||_0(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Uk(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:yr(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=dr(c):(c=$t(r)?bi:_t.current,c=gs(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&S0(t,o,n,c),jn=!1,h=t.memoizedState,o.state=h,$l(t,n,o,i);var y=t.memoizedState;l!==f||h!==y||qt.current||jn?(typeof p=="function"&&(Xg(t,r,p,n),y=t.memoizedState),(u=jn||_0(t,r,u,n,h,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return ev(e,t,r,n,s,i)}function ev(e,t,r,n,i,s){vN(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&h0(t,r,!1),dn(e,t,s);n=t.stateNode,C5.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=xs(t,e.child,null,s),t.child=xs(t,null,l,s)):Et(e,t,l,s),t.memoizedState=n.state,i&&h0(t,r,!0),t.child}function xN(e){var t=e.stateNode;t.pendingContext?p0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&p0(e,t.context,!1),gx(e,t.containerInfo)}function R0(e,t,r,n,i){return vs(),ux(i),t.flags|=256,Et(e,t,r,n),t.child}var tv={dehydrated:null,treeContext:null,retryLane:0};function rv(e){return{baseLanes:e,cachePool:null,transitions:null}}function yN(e,t,r){var n=t.pendingProps,i=Ge.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),De(Ge,i&1),e===null)return Kg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Ic(o,n,0,null),e=gi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=rv(r),t.memoizedState=tv,e):jx(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return E5(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bn(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Bn(l,s):(s=gi(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?rv(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=tv,n}return s=e.child,e=s.sibling,n=Bn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function jx(e,t){return t=Ic({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function qa(e,t,r,n){return n!==null&&ux(n),xs(t,e.child,null,r),e=jx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function E5(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Hu(Error(J(422))),qa(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Ic({mode:"visible",children:n.children},i,0,null),s=gi(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&xs(t,e.child,null,o),t.child.memoizedState=rv(o),t.memoizedState=tv,s);if(!(t.mode&1))return qa(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(J(419)),n=Hu(s,n,void 0),qa(e,t,o,n)}if(l=(o&e.childLanes)!==0,Lt||l){if(n=pt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,un(e,i),kr(n,e,i,-1))}return Rx(),n=Hu(Error(J(421))),qa(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=$5.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Yt=Fn(i.nextSibling),Xt=t,qe=!0,_r=null,e!==null&&(sr[or++]=en,sr[or++]=tn,sr[or++]=wi,en=e.id,tn=e.overflow,wi=t),t=jx(t,n.children),t.flags|=4096,t)}function A0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Yg(e.return,t,r)}function Wu(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function bN(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Et(e,t,n.children,r),n=Ge.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&A0(e,r,t);else if(e.tag===19)A0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(De(Ge,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Bl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Wu(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Bl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Wu(t,!0,r,null,s);break;case"together":Wu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function dn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Si|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,r=Bn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function T5(e,t,r){switch(t.tag){case 3:xN(t),vs();break;case 5:Vk(t);break;case 1:$t(t.type)&&Dl(t);break;case 4:gx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;De(zl,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(De(Ge,Ge.current&1),t.flags|=128,null):r&t.child.childLanes?yN(e,t,r):(De(Ge,Ge.current&1),e=dn(e,t,r),e!==null?e.sibling:null);De(Ge,Ge.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return bN(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),De(Ge,Ge.current),n)break;return null;case 22:case 23:return t.lanes=0,gN(e,t,r)}return dn(e,t,r)}var wN,nv,_N,SN;wN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nv=function(){};_N=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,di($r.current);var s=null;switch(r){case"input":i=kg(e,i),n=kg(e,n),s=[];break;case"select":i=Ye({},i,{value:void 0}),n=Ye({},n,{value:void 0}),s=[];break;case"textarea":i=Eg(e,i),n=Eg(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Pl)}Rg(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ao.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ao.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Fe("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};SN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Gs(e,t){if(!qe)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function bt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function R5(e,t,r){var n=t.pendingProps;switch(cx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(t),null;case 1:return $t(t.type)&&Ol(),bt(t),null;case 3:return n=t.stateNode,ys(),ze(qt),ze(_t),xx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Fa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_r!==null&&(dv(_r),_r=null))),nv(e,t),bt(t),null;case 5:vx(t);var i=di(Ho.current);if(r=t.type,e!==null&&t.stateNode!=null)_N(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(J(166));return bt(t),null}if(e=di($r.current),Fa(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Fr]=t,n[$o]=s,e=(t.mode&1)!==0,r){case"dialog":Fe("cancel",n),Fe("close",n);break;case"iframe":case"object":case"embed":Fe("load",n);break;case"video":case"audio":for(i=0;i<ao.length;i++)Fe(ao[i],n);break;case"source":Fe("error",n);break;case"img":case"image":case"link":Fe("error",n),Fe("load",n);break;case"details":Fe("toggle",n);break;case"input":qy(n,s),Fe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Fe("invalid",n);break;case"textarea":By(n,s),Fe("invalid",n)}Rg(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&La(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&La(n.textContent,l,e),i=["children",""+l]):Ao.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Fe("scroll",n)}switch(r){case"input":Ta(n),$y(n,s,!0);break;case"textarea":Ta(n),Hy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Pl)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Qj(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Fr]=t,e[$o]=n,wN(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ag(r,n),r){case"dialog":Fe("cancel",e),Fe("close",e),i=n;break;case"iframe":case"object":case"embed":Fe("load",e),i=n;break;case"video":case"audio":for(i=0;i<ao.length;i++)Fe(ao[i],e);i=n;break;case"source":Fe("error",e),i=n;break;case"img":case"image":case"link":Fe("error",e),Fe("load",e),i=n;break;case"details":Fe("toggle",e),i=n;break;case"input":qy(e,n),i=kg(e,n),Fe("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ye({},n,{value:void 0}),Fe("invalid",e);break;case"textarea":By(e,n),i=Eg(e,n),Fe("invalid",e);break;default:i=n}Rg(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?ek(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Zj(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Io(e,c):typeof c=="number"&&Io(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ao.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Fe("scroll",e):c!=null&&Kv(e,s,c,o))}switch(r){case"input":Ta(e),$y(e,n,!1);break;case"textarea":Ta(e),Hy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Gn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?ss(e,!!n.multiple,s,!1):n.defaultValue!=null&&ss(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Pl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return bt(t),null;case 6:if(e&&t.stateNode!=null)SN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(J(166));if(r=di(Ho.current),di($r.current),Fa(t)){if(n=t.stateNode,r=t.memoizedProps,n[Fr]=t,(s=n.nodeValue!==r)&&(e=Xt,e!==null))switch(e.tag){case 3:La(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&La(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Fr]=t,t.stateNode=n}return bt(t),null;case 13:if(ze(Ge),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qe&&Yt!==null&&t.mode&1&&!(t.flags&128))$k(),vs(),t.flags|=98560,s=!1;else if(s=Fa(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(J(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(J(317));s[Fr]=t}else vs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;bt(t),s=!1}else _r!==null&&(dv(_r),_r=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ge.current&1?ct===0&&(ct=3):Rx())),t.updateQueue!==null&&(t.flags|=4),bt(t),null);case 4:return ys(),nv(e,t),e===null&&zo(t.stateNode.containerInfo),bt(t),null;case 10:return px(t.type._context),bt(t),null;case 17:return $t(t.type)&&Ol(),bt(t),null;case 19:if(ze(Ge),s=t.memoizedState,s===null)return bt(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Gs(s,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Bl(e),o!==null){for(t.flags|=128,Gs(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return De(Ge,Ge.current&1|2),t.child}e=e.sibling}s.tail!==null&&et()>ws&&(t.flags|=128,n=!0,Gs(s,!1),t.lanes=4194304)}else{if(!n)if(e=Bl(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Gs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!qe)return bt(t),null}else 2*et()-s.renderingStartTime>ws&&r!==1073741824&&(t.flags|=128,n=!0,Gs(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=et(),t.sibling=null,r=Ge.current,De(Ge,n?r&1|2:r&1),t):(bt(t),null);case 22:case 23:return Tx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Gt&1073741824&&(bt(t),t.subtreeFlags&6&&(t.flags|=8192)):bt(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function A5(e,t){switch(cx(t),t.tag){case 1:return $t(t.type)&&Ol(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ys(),ze(qt),ze(_t),xx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return vx(t),null;case 13:if(ze(Ge),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ze(Ge),null;case 4:return ys(),null;case 10:return px(t.type._context),null;case 22:case 23:return Tx(),null;case 24:return null;default:return null}}var $a=!1,wt=!1,I5=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Ji(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Qe(e,t,n)}else r.current=null}function iv(e,t,r){try{r()}catch(n){Qe(e,t,n)}}var I0=!1;function M5(e,t){if($g=Al,e=Ek(),ax(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===i&&(l=o),h===s&&++d===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Bg={focusedElem:e,selectionRange:r},Al=!1,ie=t;ie!==null;)if(t=ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ie=e;else for(;ie!==null;){t=ie;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,w=y.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:yr(t.type,g),w);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(_){Qe(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,ie=e;break}ie=t.return}return y=I0,I0=!1,y}function jo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&iv(t,r,s)}i=i.next}while(i!==n)}}function Rc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function sv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function jN(e){var t=e.alternate;t!==null&&(e.alternate=null,jN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fr],delete t[$o],delete t[Ug],delete t[m5],delete t[g5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kN(e){return e.tag===5||e.tag===3||e.tag===4}function M0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ov(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Pl));else if(n!==4&&(e=e.child,e!==null))for(ov(e,t,r),e=e.sibling;e!==null;)ov(e,t,r),e=e.sibling}function av(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(av(e,t,r),e=e.sibling;e!==null;)av(e,t,r),e=e.sibling}var mt=null,br=!1;function bn(e,t,r){for(r=r.child;r!==null;)NN(e,t,r),r=r.sibling}function NN(e,t,r){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(_c,r)}catch{}switch(r.tag){case 5:wt||Ji(r,t);case 6:var n=mt,i=br;mt=null,bn(e,t,r),mt=n,br=i,mt!==null&&(br?(e=mt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):mt.removeChild(r.stateNode));break;case 18:mt!==null&&(br?(e=mt,r=r.stateNode,e.nodeType===8?Lu(e.parentNode,r):e.nodeType===1&&Lu(e,r),Do(e)):Lu(mt,r.stateNode));break;case 4:n=mt,i=br,mt=r.stateNode.containerInfo,br=!0,bn(e,t,r),mt=n,br=i;break;case 0:case 11:case 14:case 15:if(!wt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&iv(r,t,o),i=i.next}while(i!==n)}bn(e,t,r);break;case 1:if(!wt&&(Ji(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Qe(r,t,l)}bn(e,t,r);break;case 21:bn(e,t,r);break;case 22:r.mode&1?(wt=(n=wt)||r.memoizedState!==null,bn(e,t,r),wt=n):bn(e,t,r);break;default:bn(e,t,r)}}function P0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new I5),t.forEach(function(n){var i=B5.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function gr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:mt=l.stateNode,br=!1;break e;case 3:mt=l.stateNode.containerInfo,br=!0;break e;case 4:mt=l.stateNode.containerInfo,br=!0;break e}l=l.return}if(mt===null)throw Error(J(160));NN(s,o,i),mt=null,br=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Qe(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)CN(t,e),t=t.sibling}function CN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gr(t,e),Or(e),n&4){try{jo(3,e,e.return),Rc(3,e)}catch(g){Qe(e,e.return,g)}try{jo(5,e,e.return)}catch(g){Qe(e,e.return,g)}}break;case 1:gr(t,e),Or(e),n&512&&r!==null&&Ji(r,r.return);break;case 5:if(gr(t,e),Or(e),n&512&&r!==null&&Ji(r,r.return),e.flags&32){var i=e.stateNode;try{Io(i,"")}catch(g){Qe(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Yj(i,s),Ag(l,o);var u=Ag(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?ek(i,f):d==="dangerouslySetInnerHTML"?Zj(i,f):d==="children"?Io(i,f):Kv(i,d,f,u)}switch(l){case"input":Ng(i,s);break;case"textarea":Xj(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?ss(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?ss(i,!!s.multiple,s.defaultValue,!0):ss(i,!!s.multiple,s.multiple?[]:"",!1))}i[$o]=s}catch(g){Qe(e,e.return,g)}}break;case 6:if(gr(t,e),Or(e),n&4){if(e.stateNode===null)throw Error(J(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Qe(e,e.return,g)}}break;case 3:if(gr(t,e),Or(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Do(t.containerInfo)}catch(g){Qe(e,e.return,g)}break;case 4:gr(t,e),Or(e);break;case 13:gr(t,e),Or(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Cx=et())),n&4&&P0(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(wt=(u=wt)||d,gr(t,e),wt=u):gr(t,e),Or(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ie=e,d=e.child;d!==null;){for(f=ie=d;ie!==null;){switch(h=ie,p=h.child,h.tag){case 0:case 11:case 14:case 15:jo(4,h,h.return);break;case 1:Ji(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(g){Qe(n,r,g)}}break;case 5:Ji(h,h.return);break;case 22:if(h.memoizedState!==null){D0(f);continue}}p!==null?(p.return=h,ie=p):D0(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Jj("display",o))}catch(g){Qe(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Qe(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gr(t,e),Or(e),n&4&&P0(e);break;case 21:break;default:gr(t,e),Or(e)}}function Or(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(kN(r)){var n=r;break e}r=r.return}throw Error(J(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Io(i,""),n.flags&=-33);var s=M0(e);av(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=M0(e);ov(e,l,o);break;default:throw Error(J(161))}}catch(c){Qe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function P5(e,t,r){ie=e,EN(e)}function EN(e,t,r){for(var n=(e.mode&1)!==0;ie!==null;){var i=ie,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||$a;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||wt;l=$a;var u=wt;if($a=o,(wt=c)&&!u)for(ie=i;ie!==null;)o=ie,c=o.child,o.tag===22&&o.memoizedState!==null?L0(i):c!==null?(c.return=o,ie=c):L0(i);for(;s!==null;)ie=s,EN(s),s=s.sibling;ie=i,$a=l,wt=u}O0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ie=s):O0(e)}}function O0(e){for(;ie!==null;){var t=ie;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wt||Rc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!wt)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:yr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&y0(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}y0(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Do(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}wt||t.flags&512&&sv(t)}catch(h){Qe(t,t.return,h)}}if(t===e){ie=null;break}if(r=t.sibling,r!==null){r.return=t.return,ie=r;break}ie=t.return}}function D0(e){for(;ie!==null;){var t=ie;if(t===e){ie=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ie=r;break}ie=t.return}}function L0(e){for(;ie!==null;){var t=ie;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Rc(4,t)}catch(c){Qe(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Qe(t,i,c)}}var s=t.return;try{sv(t)}catch(c){Qe(t,s,c)}break;case 5:var o=t.return;try{sv(t)}catch(c){Qe(t,o,c)}}}catch(c){Qe(t,t.return,c)}if(t===e){ie=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ie=l;break}ie=t.return}}var O5=Math.ceil,Ul=gn.ReactCurrentDispatcher,kx=gn.ReactCurrentOwner,ur=gn.ReactCurrentBatchConfig,Te=0,pt=null,tt=null,gt=0,Gt=0,es=Zn(0),ct=0,Go=null,Si=0,Ac=0,Nx=0,ko=null,Dt=null,Cx=0,ws=1/0,Qr=null,Vl=!1,lv=null,qn=null,Ba=!1,Pn=null,Gl=0,No=0,cv=null,xl=-1,yl=0;function Rt(){return Te&6?et():xl!==-1?xl:xl=et()}function $n(e){return e.mode&1?Te&2&&gt!==0?gt&-gt:x5.transition!==null?(yl===0&&(yl=fk()),yl):(e=Me,e!==0||(e=window.event,e=e===void 0?16:yk(e.type)),e):1}function kr(e,t,r,n){if(50<No)throw No=0,cv=null,Error(J(185));ua(e,r,n),(!(Te&2)||e!==pt)&&(e===pt&&(!(Te&2)&&(Ac|=r),ct===4&&Tn(e,gt)),Bt(e,n),r===1&&Te===0&&!(t.mode&1)&&(ws=et()+500,Cc&&Jn()))}function Bt(e,t){var r=e.callbackNode;xA(e,t);var n=Rl(e,e===pt?gt:0);if(n===0)r!==null&&Vy(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Vy(r),t===1)e.tag===0?v5(F0.bind(null,e)):Fk(F0.bind(null,e)),p5(function(){!(Te&6)&&Jn()}),r=null;else{switch(pk(n)){case 1:r=Jv;break;case 4:r=uk;break;case 16:r=Tl;break;case 536870912:r=dk;break;default:r=Tl}r=DN(r,TN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function TN(e,t){if(xl=-1,yl=0,Te&6)throw Error(J(327));var r=e.callbackNode;if(us()&&e.callbackNode!==r)return null;var n=Rl(e,e===pt?gt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Kl(e,n);else{t=n;var i=Te;Te|=2;var s=AN();(pt!==e||gt!==t)&&(Qr=null,ws=et()+500,mi(e,t));do try{F5();break}catch(l){RN(e,l)}while(!0);fx(),Ul.current=s,Te=i,tt!==null?t=0:(pt=null,gt=0,t=ct)}if(t!==0){if(t===2&&(i=Dg(e),i!==0&&(n=i,t=uv(e,i))),t===1)throw r=Go,mi(e,0),Tn(e,n),Bt(e,et()),r;if(t===6)Tn(e,n);else{if(i=e.current.alternate,!(n&30)&&!D5(i)&&(t=Kl(e,n),t===2&&(s=Dg(e),s!==0&&(n=s,t=uv(e,s))),t===1))throw r=Go,mi(e,0),Tn(e,n),Bt(e,et()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(J(345));case 2:ai(e,Dt,Qr);break;case 3:if(Tn(e,n),(n&130023424)===n&&(t=Cx+500-et(),10<t)){if(Rl(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Rt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Wg(ai.bind(null,e,Dt,Qr),t);break}ai(e,Dt,Qr);break;case 4:if(Tn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-jr(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=et()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*O5(n/1960))-n,10<n){e.timeoutHandle=Wg(ai.bind(null,e,Dt,Qr),n);break}ai(e,Dt,Qr);break;case 5:ai(e,Dt,Qr);break;default:throw Error(J(329))}}}return Bt(e,et()),e.callbackNode===r?TN.bind(null,e):null}function uv(e,t){var r=ko;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=Kl(e,t),e!==2&&(t=Dt,Dt=r,t!==null&&dv(t)),e}function dv(e){Dt===null?Dt=e:Dt.push.apply(Dt,e)}function D5(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Nr(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tn(e,t){for(t&=~Nx,t&=~Ac,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-jr(t),n=1<<r;e[r]=-1,t&=~n}}function F0(e){if(Te&6)throw Error(J(327));us();var t=Rl(e,0);if(!(t&1))return Bt(e,et()),null;var r=Kl(e,t);if(e.tag!==0&&r===2){var n=Dg(e);n!==0&&(t=n,r=uv(e,n))}if(r===1)throw r=Go,mi(e,0),Tn(e,t),Bt(e,et()),r;if(r===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ai(e,Dt,Qr),Bt(e,et()),null}function Ex(e,t){var r=Te;Te|=1;try{return e(t)}finally{Te=r,Te===0&&(ws=et()+500,Cc&&Jn())}}function ji(e){Pn!==null&&Pn.tag===0&&!(Te&6)&&us();var t=Te;Te|=1;var r=ur.transition,n=Me;try{if(ur.transition=null,Me=1,e)return e()}finally{Me=n,ur.transition=r,Te=t,!(Te&6)&&Jn()}}function Tx(){Gt=es.current,ze(es)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,f5(r)),tt!==null)for(r=tt.return;r!==null;){var n=r;switch(cx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ol();break;case 3:ys(),ze(qt),ze(_t),xx();break;case 5:vx(n);break;case 4:ys();break;case 13:ze(Ge);break;case 19:ze(Ge);break;case 10:px(n.type._context);break;case 22:case 23:Tx()}r=r.return}if(pt=e,tt=e=Bn(e.current,null),gt=Gt=t,ct=0,Go=null,Nx=Ac=Si=0,Dt=ko=null,ui!==null){for(t=0;t<ui.length;t++)if(r=ui[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}ui=null}return e}function RN(e,t){do{var r=tt;try{if(fx(),ml.current=Wl,Hl){for(var n=Ke.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Hl=!1}if(_i=0,dt=ot=Ke=null,So=!1,Wo=0,kx.current=null,r===null||r.return===null){ct=1,Go=t,tt=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=gt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=k0(o);if(p!==null){p.flags&=-257,N0(p,o,l,s,t),p.mode&1&&j0(s,u,t),t=p,c=u;var y=t.updateQueue;if(y===null){var g=new Set;g.add(c),t.updateQueue=g}else y.add(c);break e}else{if(!(t&1)){j0(s,u,t),Rx();break e}c=Error(J(426))}}else if(qe&&l.mode&1){var w=k0(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),N0(w,o,l,s,t),ux(bs(c,l));break e}}s=c=bs(c,l),ct!==4&&(ct=2),ko===null?ko=[s]:ko.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=pN(s,c,t);x0(s,v);break e;case 1:l=c;var x=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qn===null||!qn.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=hN(s,l,t);x0(s,_);break e}}s=s.return}while(s!==null)}MN(r)}catch(S){t=S,tt===r&&r!==null&&(tt=r=r.return);continue}break}while(!0)}function AN(){var e=Ul.current;return Ul.current=Wl,e===null?Wl:e}function Rx(){(ct===0||ct===3||ct===2)&&(ct=4),pt===null||!(Si&268435455)&&!(Ac&268435455)||Tn(pt,gt)}function Kl(e,t){var r=Te;Te|=2;var n=AN();(pt!==e||gt!==t)&&(Qr=null,mi(e,t));do try{L5();break}catch(i){RN(e,i)}while(!0);if(fx(),Te=r,Ul.current=n,tt!==null)throw Error(J(261));return pt=null,gt=0,ct}function L5(){for(;tt!==null;)IN(tt)}function F5(){for(;tt!==null&&!cA();)IN(tt)}function IN(e){var t=ON(e.alternate,e,Gt);e.memoizedProps=e.pendingProps,t===null?MN(e):tt=t,kx.current=null}function MN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=A5(r,t),r!==null){r.flags&=32767,tt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,tt=null;return}}else if(r=R5(r,t,Gt),r!==null){tt=r;return}if(t=t.sibling,t!==null){tt=t;return}tt=t=e}while(t!==null);ct===0&&(ct=5)}function ai(e,t,r){var n=Me,i=ur.transition;try{ur.transition=null,Me=1,z5(e,t,r,n)}finally{ur.transition=i,Me=n}return null}function z5(e,t,r,n){do us();while(Pn!==null);if(Te&6)throw Error(J(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(yA(e,s),e===pt&&(tt=pt=null,gt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ba||(Ba=!0,DN(Tl,function(){return us(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ur.transition,ur.transition=null;var o=Me;Me=1;var l=Te;Te|=4,kx.current=null,M5(e,r),CN(r,e),s5(Bg),Al=!!$g,Bg=$g=null,e.current=r,P5(r),uA(),Te=l,Me=o,ur.transition=s}else e.current=r;if(Ba&&(Ba=!1,Pn=e,Gl=i),s=e.pendingLanes,s===0&&(qn=null),pA(r.stateNode),Bt(e,et()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Vl)throw Vl=!1,e=lv,lv=null,e;return Gl&1&&e.tag!==0&&us(),s=e.pendingLanes,s&1?e===cv?No++:(No=0,cv=e):No=0,Jn(),null}function us(){if(Pn!==null){var e=pk(Gl),t=ur.transition,r=Me;try{if(ur.transition=null,Me=16>e?16:e,Pn===null)var n=!1;else{if(e=Pn,Pn=null,Gl=0,Te&6)throw Error(J(331));var i=Te;for(Te|=4,ie=e.current;ie!==null;){var s=ie,o=s.child;if(ie.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ie=u;ie!==null;){var d=ie;switch(d.tag){case 0:case 11:case 15:jo(8,d,s)}var f=d.child;if(f!==null)f.return=d,ie=f;else for(;ie!==null;){d=ie;var h=d.sibling,p=d.return;if(jN(d),d===u){ie=null;break}if(h!==null){h.return=p,ie=h;break}ie=p}}}var y=s.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}ie=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ie=o;else e:for(;ie!==null;){if(s=ie,s.flags&2048)switch(s.tag){case 0:case 11:case 15:jo(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ie=v;break e}ie=s.return}}var x=e.current;for(ie=x;ie!==null;){o=ie;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ie=b;else e:for(o=x;ie!==null;){if(l=ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Rc(9,l)}}catch(S){Qe(l,l.return,S)}if(l===o){ie=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,ie=_;break e}ie=l.return}}if(Te=i,Jn(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(_c,e)}catch{}n=!0}return n}finally{Me=r,ur.transition=t}}return!1}function z0(e,t,r){t=bs(r,t),t=pN(e,t,1),e=zn(e,t,1),t=Rt(),e!==null&&(ua(e,1,t),Bt(e,t))}function Qe(e,t,r){if(e.tag===3)z0(e,e,r);else for(;t!==null;){if(t.tag===3){z0(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qn===null||!qn.has(n))){e=bs(r,e),e=hN(t,e,1),t=zn(t,e,1),e=Rt(),t!==null&&(ua(t,1,e),Bt(t,e));break}}t=t.return}}function q5(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Rt(),e.pingedLanes|=e.suspendedLanes&r,pt===e&&(gt&r)===r&&(ct===4||ct===3&&(gt&130023424)===gt&&500>et()-Cx?mi(e,0):Nx|=r),Bt(e,t)}function PN(e,t){t===0&&(e.mode&1?(t=Ia,Ia<<=1,!(Ia&130023424)&&(Ia=4194304)):t=1);var r=Rt();e=un(e,t),e!==null&&(ua(e,t,r),Bt(e,r))}function $5(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),PN(e,r)}function B5(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(J(314))}n!==null&&n.delete(t),PN(e,r)}var ON;ON=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||qt.current)Lt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Lt=!1,T5(e,t,r);Lt=!!(e.flags&131072)}else Lt=!1,qe&&t.flags&1048576&&zk(t,Fl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;vl(e,t),e=t.pendingProps;var i=gs(t,_t.current);cs(t,r),i=bx(null,t,n,e,i,r);var s=wx();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$t(n)?(s=!0,Dl(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,mx(t),i.updater=Tc,t.stateNode=i,i._reactInternals=t,Qg(t,n,e,r),t=ev(null,t,n,!0,s,r)):(t.tag=0,qe&&s&&lx(t),Et(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(vl(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=W5(n),e=yr(n,e),i){case 0:t=Jg(null,t,n,e,r);break e;case 1:t=T0(null,t,n,e,r);break e;case 11:t=C0(null,t,n,e,r);break e;case 14:t=E0(null,t,n,yr(n.type,e),r);break e}throw Error(J(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),Jg(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),T0(e,t,n,i,r);case 3:e:{if(xN(t),e===null)throw Error(J(387));n=t.pendingProps,s=t.memoizedState,i=s.element,Uk(e,t),$l(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=bs(Error(J(423)),t),t=R0(e,t,n,r,i);break e}else if(n!==i){i=bs(Error(J(424)),t),t=R0(e,t,n,r,i);break e}else for(Yt=Fn(t.stateNode.containerInfo.firstChild),Xt=t,qe=!0,_r=null,r=Hk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vs(),n===i){t=dn(e,t,r);break e}Et(e,t,n,r)}t=t.child}return t;case 5:return Vk(t),e===null&&Kg(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Hg(n,i)?o=null:s!==null&&Hg(n,s)&&(t.flags|=32),vN(e,t),Et(e,t,o,r),t.child;case 6:return e===null&&Kg(t),null;case 13:return yN(e,t,r);case 4:return gx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=xs(t,null,n,r):Et(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),C0(e,t,n,i,r);case 7:return Et(e,t,t.pendingProps,r),t.child;case 8:return Et(e,t,t.pendingProps.children,r),t.child;case 12:return Et(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,De(zl,n._currentValue),n._currentValue=o,s!==null)if(Nr(s.value,o)){if(s.children===i.children&&!qt.current){t=dn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=on(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Yg(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(J(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Yg(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Et(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,cs(t,r),i=dr(i),n=n(i),t.flags|=1,Et(e,t,n,r),t.child;case 14:return n=t.type,i=yr(n,t.pendingProps),i=yr(n.type,i),E0(e,t,n,i,r);case 15:return mN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yr(n,i),vl(e,t),t.tag=1,$t(n)?(e=!0,Dl(t)):e=!1,cs(t,r),fN(t,n,i),Qg(t,n,i,r),ev(null,t,n,!0,e,r);case 19:return bN(e,t,r);case 22:return gN(e,t,r)}throw Error(J(156,t.tag))};function DN(e,t){return ck(e,t)}function H5(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(e,t,r,n){return new H5(e,t,r,n)}function Ax(e){return e=e.prototype,!(!e||!e.isReactComponent)}function W5(e){if(typeof e=="function")return Ax(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xv)return 11;if(e===Qv)return 14}return 2}function Bn(e,t){var r=e.alternate;return r===null?(r=lr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function bl(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")Ax(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Wi:return gi(r.children,i,s,t);case Yv:o=8,i|=8;break;case wg:return e=lr(12,r,t,i|2),e.elementType=wg,e.lanes=s,e;case _g:return e=lr(13,r,t,i),e.elementType=_g,e.lanes=s,e;case Sg:return e=lr(19,r,t,i),e.elementType=Sg,e.lanes=s,e;case Vj:return Ic(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Wj:o=10;break e;case Uj:o=9;break e;case Xv:o=11;break e;case Qv:o=14;break e;case Sn:o=16,n=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=lr(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function gi(e,t,r,n){return e=lr(7,e,n,t),e.lanes=r,e}function Ic(e,t,r,n){return e=lr(22,e,n,t),e.elementType=Vj,e.lanes=r,e.stateNode={isHidden:!1},e}function Uu(e,t,r){return e=lr(6,e,null,t),e.lanes=r,e}function Vu(e,t,r){return t=lr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function U5(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nu(0),this.expirationTimes=Nu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ix(e,t,r,n,i,s,o,l,c){return e=new U5(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=lr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},mx(s),e}function V5(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function LN(e){if(!e)return Kn;e=e._reactInternals;e:{if(Ei(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($t(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var r=e.type;if($t(r))return Lk(e,r,t)}return t}function FN(e,t,r,n,i,s,o,l,c){return e=Ix(r,n,!0,e,i,s,o,l,c),e.context=LN(null),r=e.current,n=Rt(),i=$n(r),s=on(n,i),s.callback=t??null,zn(r,s,i),e.current.lanes=i,ua(e,i,n),Bt(e,n),e}function Mc(e,t,r,n){var i=t.current,s=Rt(),o=$n(i);return r=LN(r),t.context===null?t.context=r:t.pendingContext=r,t=on(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=zn(i,t,o),e!==null&&(kr(e,i,o,s),hl(e,i,o)),o}function Yl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function q0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Mx(e,t){q0(e,t),(e=e.alternate)&&q0(e,t)}function G5(){return null}var zN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Px(e){this._internalRoot=e}Pc.prototype.render=Px.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));Mc(e,t,null,null)};Pc.prototype.unmount=Px.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ji(function(){Mc(null,e,null,null)}),t[cn]=null}};function Pc(e){this._internalRoot=e}Pc.prototype.unstable_scheduleHydration=function(e){if(e){var t=gk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<En.length&&t!==0&&t<En[r].priority;r++);En.splice(r,0,e),r===0&&xk(e)}};function Ox(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Oc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function $0(){}function K5(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Yl(o);s.call(u)}}var o=FN(t,n,e,0,null,!1,!1,"",$0);return e._reactRootContainer=o,e[cn]=o.current,zo(e.nodeType===8?e.parentNode:e),ji(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=Yl(c);l.call(u)}}var c=Ix(e,0,!1,null,null,!1,!1,"",$0);return e._reactRootContainer=c,e[cn]=c.current,zo(e.nodeType===8?e.parentNode:e),ji(function(){Mc(t,c,r,n)}),c}function Dc(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Yl(o);l.call(c)}}Mc(t,o,e,i)}else o=K5(r,t,e,i,n);return Yl(o)}hk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=oo(t.pendingLanes);r!==0&&(ex(t,r|1),Bt(t,et()),!(Te&6)&&(ws=et()+500,Jn()))}break;case 13:ji(function(){var n=un(e,1);if(n!==null){var i=Rt();kr(n,e,1,i)}}),Mx(e,1)}};tx=function(e){if(e.tag===13){var t=un(e,134217728);if(t!==null){var r=Rt();kr(t,e,134217728,r)}Mx(e,134217728)}};mk=function(e){if(e.tag===13){var t=$n(e),r=un(e,t);if(r!==null){var n=Rt();kr(r,e,t,n)}Mx(e,t)}};gk=function(){return Me};vk=function(e,t){var r=Me;try{return Me=e,t()}finally{Me=r}};Mg=function(e,t,r){switch(t){case"input":if(Ng(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Nc(n);if(!i)throw Error(J(90));Kj(n),Ng(n,i)}}}break;case"textarea":Xj(e,r);break;case"select":t=r.value,t!=null&&ss(e,!!r.multiple,t,!1)}};nk=Ex;ik=ji;var Y5={usingClientEntryPoint:!1,Events:[fa,Ki,Nc,tk,rk,Ex]},Ks={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},X5={bundleType:Ks.bundleType,version:Ks.version,rendererPackageName:Ks.rendererPackageName,rendererConfig:Ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ak(e),e===null?null:e.stateNode},findFiberByHostInstance:Ks.findFiberByHostInstance||G5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ha=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ha.isDisabled&&Ha.supportsFiber)try{_c=Ha.inject(X5),qr=Ha}catch{}}Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y5;Jt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ox(t))throw Error(J(200));return V5(e,t,null,r)};Jt.createRoot=function(e,t){if(!Ox(e))throw Error(J(299));var r=!1,n="",i=zN;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Ix(e,1,!1,null,null,r,!1,n,i),e[cn]=t.current,zo(e.nodeType===8?e.parentNode:e),new Px(t)};Jt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=ak(t),e=e===null?null:e.stateNode,e};Jt.flushSync=function(e){return ji(e)};Jt.hydrate=function(e,t,r){if(!Oc(t))throw Error(J(200));return Dc(null,e,t,!0,r)};Jt.hydrateRoot=function(e,t,r){if(!Ox(e))throw Error(J(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=zN;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=FN(t,null,e,1,r??null,i,!1,s,o),e[cn]=t.current,zo(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Pc(t)};Jt.render=function(e,t,r){if(!Oc(t))throw Error(J(200));return Dc(null,e,t,!1,r)};Jt.unmountComponentAtNode=function(e){if(!Oc(e))throw Error(J(40));return e._reactRootContainer?(ji(function(){Dc(null,null,e,!1,function(){e._reactRootContainer=null,e[cn]=null})}),!0):!1};Jt.unstable_batchedUpdates=Ex;Jt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Oc(r))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return Dc(e,t,r,!1,n)};Jt.version="18.3.1-next-f1338f8080-20240426";function qN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qN)}catch(e){console.error(e)}}qN(),qj.exports=Jt;var ts=qj.exports,B0=ts;yg.createRoot=B0.createRoot,yg.hydrateRoot=B0.hydrateRoot;function Wt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Wt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var $N={exports:{}},BN={},HN={exports:{}},WN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _s=m;function Q5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Z5=typeof Object.is=="function"?Object.is:Q5,J5=_s.useState,e3=_s.useEffect,t3=_s.useLayoutEffect,r3=_s.useDebugValue;function n3(e,t){var r=t(),n=J5({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return t3(function(){i.value=r,i.getSnapshot=t,Gu(i)&&s({inst:i})},[e,r,t]),e3(function(){return Gu(i)&&s({inst:i}),e(function(){Gu(i)&&s({inst:i})})},[e]),r3(r),r}function Gu(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Z5(e,r)}catch{return!0}}function i3(e,t){return t()}var s3=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?i3:n3;WN.useSyncExternalStore=_s.useSyncExternalStore!==void 0?_s.useSyncExternalStore:s3;HN.exports=WN;var o3=HN.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lc=m,a3=o3;function l3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var c3=typeof Object.is=="function"?Object.is:l3,u3=a3.useSyncExternalStore,d3=Lc.useRef,f3=Lc.useEffect,p3=Lc.useMemo,h3=Lc.useDebugValue;BN.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=d3(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=p3(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var y=o.value;if(i(y,p))return f=y}return f=p}if(y=f,c3(d,p))return y;var g=n(p);return i!==void 0&&i(y,g)?(d=p,y):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=u3(e,s[0],s[1]);return f3(function(){o.hasValue=!0,o.value=l},[l]),h3(l),l};$N.exports=BN;var m3=$N.exports;const g3=$v(m3),v3={},H0=e=>{let t;const r=new Set,n=(d,f)=>{const h=typeof d=="function"?d(t):d;if(!Object.is(h,t)){const p=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(y=>y(t,p))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(v3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,i,c);return c},x3=e=>e?H0(e):H0,{useDebugValue:y3}=G,{useSyncExternalStoreWithSelector:b3}=g3,w3=e=>e;function UN(e,t=w3,r){const n=b3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return y3(n),n}const W0=(e,t)=>{const r=x3(e),n=(i,s=t)=>UN(r,i,s);return Object.assign(n,r),n},_3=(e,t)=>e?W0(e,t):W0;function St(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var S3={value:()=>{}};function Fc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new wl(r)}function wl(e){this._=e}function j3(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}wl.prototype=Fc.prototype={constructor:wl,on:function(e,t){var r=this._,n=j3(e+"",r),i,s=-1,o=n.length;if(arguments.length<2){for(;++s<o;)if((i=(e=n[s]).type)&&(i=k3(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=n[s]).type)r[i]=U0(r[i],e.name,t);else if(t==null)for(i in r)r[i]=U0(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new wl(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,s;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],n=0,i=s.length;n<i;++n)s[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,s=n.length;i<s;++i)n[i].value.apply(t,r)}};function k3(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function U0(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=S3,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var fv="http://www.w3.org/1999/xhtml";const V0={svg:"http://www.w3.org/2000/svg",xhtml:fv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),V0.hasOwnProperty(t)?{space:V0[t],local:e}:e}function N3(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===fv&&t.documentElement.namespaceURI===fv?t.createElement(e):t.createElementNS(r,e)}}function C3(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function VN(e){var t=zc(e);return(t.local?C3:N3)(t)}function E3(){}function Dx(e){return e==null?E3:function(){return this.querySelector(e)}}function T3(e){typeof e!="function"&&(e=Dx(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=new Array(o),c,u,d=0;d<o;++d)(c=s[d])&&(u=e.call(c,c.__data__,d,s))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u);return new Zt(n,this._parents)}function R3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function A3(){return[]}function GN(e){return e==null?A3:function(){return this.querySelectorAll(e)}}function I3(e){return function(){return R3(e.apply(this,arguments))}}function M3(e){typeof e=="function"?e=I3(e):e=GN(e);for(var t=this._groups,r=t.length,n=[],i=[],s=0;s<r;++s)for(var o=t[s],l=o.length,c,u=0;u<l;++u)(c=o[u])&&(n.push(e.call(c,c.__data__,u,o)),i.push(c));return new Zt(n,i)}function KN(e){return function(){return this.matches(e)}}function YN(e){return function(t){return t.matches(e)}}var P3=Array.prototype.find;function O3(e){return function(){return P3.call(this.children,e)}}function D3(){return this.firstElementChild}function L3(e){return this.select(e==null?D3:O3(typeof e=="function"?e:YN(e)))}var F3=Array.prototype.filter;function z3(){return Array.from(this.children)}function q3(e){return function(){return F3.call(this.children,e)}}function $3(e){return this.selectAll(e==null?z3:q3(typeof e=="function"?e:YN(e)))}function B3(e){typeof e!="function"&&(e=KN(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&l.push(c);return new Zt(n,this._parents)}function XN(e){return new Array(e.length)}function H3(){return new Zt(this._enter||this._groups.map(XN),this._parents)}function Xl(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Xl.prototype={constructor:Xl,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function W3(e){return function(){return e}}function U3(e,t,r,n,i,s){for(var o=0,l,c=t.length,u=s.length;o<u;++o)(l=t[o])?(l.__data__=s[o],n[o]=l):r[o]=new Xl(e,s[o]);for(;o<c;++o)(l=t[o])&&(i[o]=l)}function V3(e,t,r,n,i,s,o){var l,c,u=new Map,d=t.length,f=s.length,h=new Array(d),p;for(l=0;l<d;++l)(c=t[l])&&(h[l]=p=o.call(c,c.__data__,l,t)+"",u.has(p)?i[l]=c:u.set(p,c));for(l=0;l<f;++l)p=o.call(e,s[l],l,s)+"",(c=u.get(p))?(n[l]=c,c.__data__=s[l],u.delete(p)):r[l]=new Xl(e,s[l]);for(l=0;l<d;++l)(c=t[l])&&u.get(h[l])===c&&(i[l]=c)}function G3(e){return e.__data__}function K3(e,t){if(!arguments.length)return Array.from(this,G3);var r=t?V3:U3,n=this._parents,i=this._groups;typeof e!="function"&&(e=W3(e));for(var s=i.length,o=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var d=n[u],f=i[u],h=f.length,p=Y3(e.call(d,d&&d.__data__,u,n)),y=p.length,g=l[u]=new Array(y),w=o[u]=new Array(y),v=c[u]=new Array(h);r(d,f,g,w,v,p,t);for(var x=0,b=0,_,S;x<y;++x)if(_=g[x]){for(x>=b&&(b=x+1);!(S=w[b])&&++b<y;);_._next=S||null}}return o=new Zt(o,n),o._enter=l,o._exit=c,o}function Y3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function X3(){return new Zt(this._exit||this._groups.map(XN),this._parents)}function Q3(e,t,r){var n=this.enter(),i=this,s=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?s.remove():r(s),n&&i?n.merge(i).order():i}function Z3(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,s=n.length,o=Math.min(i,s),l=new Array(i),c=0;c<o;++c)for(var u=r[c],d=n[c],f=u.length,h=l[c]=new Array(f),p,y=0;y<f;++y)(p=u[y]||d[y])&&(h[y]=p);for(;c<i;++c)l[c]=r[c];return new Zt(l,this._parents)}function J3(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,s=n[i],o;--i>=0;)(o=n[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function eI(e){e||(e=tI);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var r=this._groups,n=r.length,i=new Array(n),s=0;s<n;++s){for(var o=r[s],l=o.length,c=i[s]=new Array(l),u,d=0;d<l;++d)(u=o[d])&&(c[d]=u);c.sort(t)}return new Zt(i,this._parents).order()}function tI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function rI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function nI(){return Array.from(this)}function iI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null}function sI(){let e=0;for(const t of this)++e;return e}function oI(){return!this.node()}function aI(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],s=0,o=i.length,l;s<o;++s)(l=i[s])&&e.call(l,l.__data__,s,i);return this}function lI(e){return function(){this.removeAttribute(e)}}function cI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function uI(e,t){return function(){this.setAttribute(e,t)}}function dI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function fI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function pI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function hI(e,t){var r=zc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?cI:lI:typeof t=="function"?r.local?pI:fI:r.local?dI:uI)(r,t))}function QN(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function mI(e){return function(){this.style.removeProperty(e)}}function gI(e,t,r){return function(){this.style.setProperty(e,t,r)}}function vI(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function xI(e,t,r){return arguments.length>1?this.each((t==null?mI:typeof t=="function"?vI:gI)(e,t,r??"")):Ss(this.node(),e)}function Ss(e,t){return e.style.getPropertyValue(t)||QN(e).getComputedStyle(e,null).getPropertyValue(t)}function yI(e){return function(){delete this[e]}}function bI(e,t){return function(){this[e]=t}}function wI(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function _I(e,t){return arguments.length>1?this.each((t==null?yI:typeof t=="function"?wI:bI)(e,t)):this.node()[e]}function ZN(e){return e.trim().split(/^|\s+/)}function Lx(e){return e.classList||new JN(e)}function JN(e){this._node=e,this._names=ZN(e.getAttribute("class")||"")}JN.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function eC(e,t){for(var r=Lx(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function tC(e,t){for(var r=Lx(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function SI(e){return function(){eC(this,e)}}function jI(e){return function(){tC(this,e)}}function kI(e,t){return function(){(t.apply(this,arguments)?eC:tC)(this,e)}}function NI(e,t){var r=ZN(e+"");if(arguments.length<2){for(var n=Lx(this.node()),i=-1,s=r.length;++i<s;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?kI:t?SI:jI)(r,t))}function CI(){this.textContent=""}function EI(e){return function(){this.textContent=e}}function TI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function RI(e){return arguments.length?this.each(e==null?CI:(typeof e=="function"?TI:EI)(e)):this.node().textContent}function AI(){this.innerHTML=""}function II(e){return function(){this.innerHTML=e}}function MI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function PI(e){return arguments.length?this.each(e==null?AI:(typeof e=="function"?MI:II)(e)):this.node().innerHTML}function OI(){this.nextSibling&&this.parentNode.appendChild(this)}function DI(){return this.each(OI)}function LI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function FI(){return this.each(LI)}function zI(e){var t=typeof e=="function"?e:VN(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function qI(){return null}function $I(e,t){var r=typeof e=="function"?e:VN(e),n=t==null?qI:typeof t=="function"?t:Dx(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function BI(){var e=this.parentNode;e&&e.removeChild(this)}function HI(){return this.each(BI)}function WI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function UI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function VI(e){return this.select(e?UI:WI)}function GI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function KI(e){return function(t){e.call(this,t,this.__data__)}}function YI(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function XI(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,s;r<i;++r)s=t[r],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++n]=s;++n?t.length=n:delete this.__on}}}function QI(e,t,r){return function(){var n=this.__on,i,s=KI(t);if(n){for(var o=0,l=n.length;o<l;++o)if((i=n[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=r),i.value=t;return}}this.addEventListener(e.type,s,r),i={type:e.type,name:e.name,value:t,listener:s,options:r},n?n.push(i):this.__on=[i]}}function ZI(e,t,r){var n=YI(e+""),i,s=n.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,d;c<u;++c)for(i=0,d=l[c];i<s;++i)if((o=n[i]).type===d.type&&o.name===d.name)return d.value}return}for(l=t?QI:XI,i=0;i<s;++i)this.each(l(n[i],t,r));return this}function rC(e,t,r){var n=QN(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function JI(e,t){return function(){return rC(this,e,t)}}function eM(e,t){return function(){return rC(this,e,t.apply(this,arguments))}}function tM(e,t){return this.each((typeof t=="function"?eM:JI)(e,t))}function*rM(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length,o;i<s;++i)(o=n[i])&&(yield o)}var nC=[null];function Zt(e,t){this._groups=e,this._parents=t}function ha(){return new Zt([[document.documentElement]],nC)}function nM(){return this}Zt.prototype=ha.prototype={constructor:Zt,select:T3,selectAll:M3,selectChild:L3,selectChildren:$3,filter:B3,data:K3,enter:H3,exit:X3,join:Q3,merge:Z3,selection:nM,order:J3,sort:eI,call:rI,nodes:nI,node:iI,size:sI,empty:oI,each:aI,attr:hI,style:xI,property:_I,classed:NI,text:RI,html:PI,raise:DI,lower:FI,append:zI,insert:$I,remove:HI,clone:VI,datum:GI,on:ZI,dispatch:tM,[Symbol.iterator]:rM};function ar(e){return typeof e=="string"?new Zt([[document.querySelector(e)]],[document.documentElement]):new Zt([[e]],nC)}function iM(e){let t;for(;t=e.sourceEvent;)e=t;return e}function wr(e,t){if(e=iM(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const sM={passive:!1},Ko={capture:!0,passive:!1};function Ku(e){e.stopImmediatePropagation()}function ds(e){e.preventDefault(),e.stopImmediatePropagation()}function iC(e){var t=e.document.documentElement,r=ar(e).on("dragstart.drag",ds,Ko);"onselectstart"in t?r.on("selectstart.drag",ds,Ko):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function sC(e,t){var r=e.document.documentElement,n=ar(e).on("dragstart.drag",null);t&&(n.on("click.drag",ds,Ko),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Wa=e=>()=>e;function pv(e,{sourceEvent:t,subject:r,target:n,identifier:i,active:s,x:o,y:l,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}pv.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function oM(e){return!e.ctrlKey&&!e.button}function aM(){return this.parentNode}function lM(e,t){return t??{x:e.x,y:e.y}}function cM(){return navigator.maxTouchPoints||"ontouchstart"in this}function uM(){var e=oM,t=aM,r=lM,n=cM,i={},s=Fc("start","drag","end"),o=0,l,c,u,d,f=0;function h(_){_.on("mousedown.drag",p).filter(n).on("touchstart.drag",w).on("touchmove.drag",v,sM).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(_,S){if(!(d||!e.call(this,_,S))){var k=b(this,t.call(this,_,S),_,S,"mouse");k&&(ar(_.view).on("mousemove.drag",y,Ko).on("mouseup.drag",g,Ko),iC(_.view),Ku(_),u=!1,l=_.clientX,c=_.clientY,k("start",_))}}function y(_){if(ds(_),!u){var S=_.clientX-l,k=_.clientY-c;u=S*S+k*k>f}i.mouse("drag",_)}function g(_){ar(_.view).on("mousemove.drag mouseup.drag",null),sC(_.view,u),ds(_),i.mouse("end",_)}function w(_,S){if(e.call(this,_,S)){var k=_.changedTouches,N=t.call(this,_,S),E=k.length,j,R;for(j=0;j<E;++j)(R=b(this,N,_,S,k[j].identifier,k[j]))&&(Ku(_),R("start",_,k[j]))}}function v(_){var S=_.changedTouches,k=S.length,N,E;for(N=0;N<k;++N)(E=i[S[N].identifier])&&(ds(_),E("drag",_,S[N]))}function x(_){var S=_.changedTouches,k=S.length,N,E;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),N=0;N<k;++N)(E=i[S[N].identifier])&&(Ku(_),E("end",_,S[N]))}function b(_,S,k,N,E,j){var R=s.copy(),T=wr(j||k,S),P,z,C;if((C=r.call(_,new pv("beforestart",{sourceEvent:k,target:h,identifier:E,active:o,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),N))!=null)return P=C.x-T[0]||0,z=C.y-T[1]||0,function L(O,$,D){var A=T,F;switch(O){case"start":i[E]=L,F=o++;break;case"end":delete i[E],--o;case"drag":T=wr(D||$,S),F=o;break}R.call(O,_,new pv(O,{sourceEvent:$,subject:C,target:h,identifier:E,active:F,x:T[0]+P,y:T[1]+z,dx:T[0]-A[0],dy:T[1]-A[1],dispatch:R}),N)}}return h.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Wa(!!_),h):e},h.container=function(_){return arguments.length?(t=typeof _=="function"?_:Wa(_),h):t},h.subject=function(_){return arguments.length?(r=typeof _=="function"?_:Wa(_),h):r},h.touchable=function(_){return arguments.length?(n=typeof _=="function"?_:Wa(!!_),h):n},h.on=function(){var _=s.on.apply(s,arguments);return _===s?h:_},h.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,h):Math.sqrt(f)},h}function Fx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function oC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ma(){}var Yo=.7,Ql=1/Yo,fs="\\s*([+-]?\\d+)\\s*",Xo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Br="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dM=/^#([0-9a-f]{3,8})$/,fM=new RegExp(`^rgb\\(${fs},${fs},${fs}\\)$`),pM=new RegExp(`^rgb\\(${Br},${Br},${Br}\\)$`),hM=new RegExp(`^rgba\\(${fs},${fs},${fs},${Xo}\\)$`),mM=new RegExp(`^rgba\\(${Br},${Br},${Br},${Xo}\\)$`),gM=new RegExp(`^hsl\\(${Xo},${Br},${Br}\\)$`),vM=new RegExp(`^hsla\\(${Xo},${Br},${Br},${Xo}\\)$`),G0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Fx(ma,Qo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:K0,formatHex:K0,formatHex8:xM,formatHsl:yM,formatRgb:Y0,toString:Y0});function K0(){return this.rgb().formatHex()}function xM(){return this.rgb().formatHex8()}function yM(){return aC(this).formatHsl()}function Y0(){return this.rgb().formatRgb()}function Qo(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=dM.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?X0(t):r===3?new Ft(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ua(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ua(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=fM.exec(e))?new Ft(t[1],t[2],t[3],1):(t=pM.exec(e))?new Ft(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=hM.exec(e))?Ua(t[1],t[2],t[3],t[4]):(t=mM.exec(e))?Ua(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gM.exec(e))?J0(t[1],t[2]/100,t[3]/100,1):(t=vM.exec(e))?J0(t[1],t[2]/100,t[3]/100,t[4]):G0.hasOwnProperty(e)?X0(G0[e]):e==="transparent"?new Ft(NaN,NaN,NaN,0):null}function X0(e){return new Ft(e>>16&255,e>>8&255,e&255,1)}function Ua(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ft(e,t,r,n)}function bM(e){return e instanceof ma||(e=Qo(e)),e?(e=e.rgb(),new Ft(e.r,e.g,e.b,e.opacity)):new Ft}function hv(e,t,r,n){return arguments.length===1?bM(e):new Ft(e,t,r,n??1)}function Ft(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Fx(Ft,hv,oC(ma,{brighter(e){return e=e==null?Ql:Math.pow(Ql,e),new Ft(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Yo:Math.pow(Yo,e),new Ft(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ft(vi(this.r),vi(this.g),vi(this.b),Zl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Q0,formatHex:Q0,formatHex8:wM,formatRgb:Z0,toString:Z0}));function Q0(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function wM(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Z0(){const e=Zl(this.opacity);return`${e===1?"rgb(":"rgba("}${vi(this.r)}, ${vi(this.g)}, ${vi(this.b)}${e===1?")":`, ${e})`}`}function Zl(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fi(e){return e=vi(e),(e<16?"0":"")+e.toString(16)}function J0(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Sr(e,t,r,n)}function aC(e){if(e instanceof Sr)return new Sr(e.h,e.s,e.l,e.opacity);if(e instanceof ma||(e=Qo(e)),!e)return new Sr;if(e instanceof Sr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new Sr(o,l,c,e.opacity)}function _M(e,t,r,n){return arguments.length===1?aC(e):new Sr(e,t,r,n??1)}function Sr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Fx(Sr,_M,oC(ma,{brighter(e){return e=e==null?Ql:Math.pow(Ql,e),new Sr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yo:Math.pow(Yo,e),new Sr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Ft(Yu(e>=240?e-240:e+120,i,n),Yu(e,i,n),Yu(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Sr(eb(this.h),Va(this.s),Va(this.l),Zl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Zl(this.opacity);return`${e===1?"hsl(":"hsla("}${eb(this.h)}, ${Va(this.s)*100}%, ${Va(this.l)*100}%${e===1?")":`, ${e})`}`}}));function eb(e){return e=(e||0)%360,e<0?e+360:e}function Va(e){return Math.max(0,Math.min(1,e||0))}function Yu(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const lC=e=>()=>e;function SM(e,t){return function(r){return e+r*t}}function jM(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function kM(e){return(e=+e)==1?cC:function(t,r){return r-t?jM(t,r,e):lC(isNaN(t)?r:t)}}function cC(e,t){var r=t-e;return r?SM(e,r):lC(isNaN(e)?t:e)}const tb=function e(t){var r=kM(t);function n(i,s){var o=r((i=hv(i)).r,(s=hv(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),u=cC(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=l(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function kn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var mv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xu=new RegExp(mv.source,"g");function NM(e){return function(){return e}}function CM(e){return function(t){return e(t)+""}}function EM(e,t){var r=mv.lastIndex=Xu.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=mv.exec(e))&&(i=Xu.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:kn(n,i)})),r=Xu.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?CM(c[0].x):NM(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}var rb=180/Math.PI,gv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function uC(e,t,r,n,i,s){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*rb,skewX:Math.atan(c)*rb,scaleX:o,scaleY:l}}var Ga;function TM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?gv:uC(t.a,t.b,t.c,t.d,t.e,t.f)}function RM(e){return e==null||(Ga||(Ga=document.createElementNS("http://www.w3.org/2000/svg","g")),Ga.setAttribute("transform",e),!(e=Ga.transform.baseVal.consolidate()))?gv:(e=e.matrix,uC(e.a,e.b,e.c,e.d,e.e,e.f))}function dC(e,t,r,n){function i(u){return u.length?u.pop()+" ":""}function s(u,d,f,h,p,y){if(u!==f||d!==h){var g=p.push("translate(",null,t,null,r);y.push({i:g-4,x:kn(u,f)},{i:g-2,x:kn(d,h)})}else(f||h)&&p.push("translate("+f+t+h+r)}function o(u,d,f,h){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,n)-2,x:kn(u,d)})):d&&f.push(i(f)+"rotate("+d+n)}function l(u,d,f,h){u!==d?h.push({i:f.push(i(f)+"skewX(",null,n)-2,x:kn(u,d)}):d&&f.push(i(f)+"skewX("+d+n)}function c(u,d,f,h,p,y){if(u!==f||d!==h){var g=p.push(i(p)+"scale(",null,",",null,")");y.push({i:g-4,x:kn(u,f)},{i:g-2,x:kn(d,h)})}else(f!==1||h!==1)&&p.push(i(p)+"scale("+f+","+h+")")}return function(u,d){var f=[],h=[];return u=e(u),d=e(d),s(u.translateX,u.translateY,d.translateX,d.translateY,f,h),o(u.rotate,d.rotate,f,h),l(u.skewX,d.skewX,f,h),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,h),u=d=null,function(p){for(var y=-1,g=h.length,w;++y<g;)f[(w=h[y]).i]=w.x(p);return f.join("")}}}var AM=dC(TM,"px, ","px)","deg)"),IM=dC(RM,", ",")",")"),MM=1e-12;function nb(e){return((e=Math.exp(e))+1/e)/2}function PM(e){return((e=Math.exp(e))-1/e)/2}function OM(e){return((e=Math.exp(2*e))-1)/(e+1)}const DM=function e(t,r,n){function i(s,o){var l=s[0],c=s[1],u=s[2],d=o[0],f=o[1],h=o[2],p=d-l,y=f-c,g=p*p+y*y,w,v;if(g<MM)v=Math.log(h/u)/t,w=function(N){return[l+N*p,c+N*y,u*Math.exp(t*N*v)]};else{var x=Math.sqrt(g),b=(h*h-u*u+n*g)/(2*u*r*x),_=(h*h-u*u-n*g)/(2*h*r*x),S=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(_*_+1)-_);v=(k-S)/t,w=function(N){var E=N*v,j=nb(S),R=u/(r*x)*(j*OM(t*E+S)-PM(S));return[l+R*p,c+R*y,u*j/nb(t*E+S)]}}return w.duration=v*1e3*t/Math.SQRT2,w}return i.rho=function(s){var o=Math.max(.001,+s),l=o*o,c=l*l;return e(o,l,c)},i}(Math.SQRT2,2,4);var js=0,lo=0,Ys=0,fC=1e3,Jl,co,ec=0,ki=0,qc=0,Zo=typeof performance=="object"&&performance.now?performance:Date,pC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function zx(){return ki||(pC(LM),ki=Zo.now()+qc)}function LM(){ki=0}function tc(){this._call=this._time=this._next=null}tc.prototype=hC.prototype={constructor:tc,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?zx():+r)+(t==null?0:+t),!this._next&&co!==this&&(co?co._next=this:Jl=this,co=this),this._call=e,this._time=r,vv()},stop:function(){this._call&&(this._call=null,this._time=1/0,vv())}};function hC(e,t,r){var n=new tc;return n.restart(e,t,r),n}function FM(){zx(),++js;for(var e=Jl,t;e;)(t=ki-e._time)>=0&&e._call.call(void 0,t),e=e._next;--js}function ib(){ki=(ec=Zo.now())+qc,js=lo=0;try{FM()}finally{js=0,qM(),ki=0}}function zM(){var e=Zo.now(),t=e-ec;t>fC&&(qc-=t,ec=e)}function qM(){for(var e,t=Jl,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Jl=r);co=e,vv(n)}function vv(e){if(!js){lo&&(lo=clearTimeout(lo));var t=e-ki;t>24?(e<1/0&&(lo=setTimeout(ib,e-Zo.now()-qc)),Ys&&(Ys=clearInterval(Ys))):(Ys||(ec=Zo.now(),Ys=setInterval(zM,fC)),js=1,pC(ib))}}function sb(e,t,r){var n=new tc;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var $M=Fc("start","end","cancel","interrupt"),BM=[],mC=0,ob=1,xv=2,_l=3,ab=4,yv=5,Sl=6;function $c(e,t,r,n,i,s){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;HM(e,r,{name:t,index:n,group:i,on:$M,tween:BM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:mC})}function qx(e,t){var r=Er(e,t);if(r.state>mC)throw new Error("too late; already scheduled");return r}function Vr(e,t){var r=Er(e,t);if(r.state>_l)throw new Error("too late; already running");return r}function Er(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function HM(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=hC(s,0,r.time);function s(u){r.state=ob,r.timer.restart(o,r.delay,r.time),r.delay<=u&&o(u-r.delay)}function o(u){var d,f,h,p;if(r.state!==ob)return c();for(d in n)if(p=n[d],p.name===r.name){if(p.state===_l)return sb(o);p.state===ab?(p.state=Sl,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete n[d]):+d<t&&(p.state=Sl,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete n[d])}if(sb(function(){r.state===_l&&(r.state=ab,r.timer.restart(l,r.delay,r.time),l(u))}),r.state=xv,r.on.call("start",e,e.__data__,r.index,r.group),r.state===xv){for(r.state=_l,i=new Array(h=r.tween.length),d=0,f=-1;d<h;++d)(p=r.tween[d].value.call(e,e.__data__,r.index,r.group))&&(i[++f]=p);i.length=f+1}}function l(u){for(var d=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=yv,1),f=-1,h=i.length;++f<h;)i[f].call(e,d);r.state===yv&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Sl,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function jl(e,t){var r=e.__transition,n,i,s=!0,o;if(r){t=t==null?null:t+"";for(o in r){if((n=r[o]).name!==t){s=!1;continue}i=n.state>xv&&n.state<yv,n.state=Sl,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[o]}s&&delete e.__transition}}function WM(e){return this.each(function(){jl(this,e)})}function UM(e,t){var r,n;return function(){var i=Vr(this,e),s=i.tween;if(s!==r){n=r=s;for(var o=0,l=n.length;o<l;++o)if(n[o].name===t){n=n.slice(),n.splice(o,1);break}}i.tween=n}}function VM(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var s=Vr(this,e),o=s.tween;if(o!==n){i=(n=o).slice();for(var l={name:t,value:r},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=l;break}c===u&&i.push(l)}s.tween=i}}function GM(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Er(this.node(),r).tween,i=0,s=n.length,o;i<s;++i)if((o=n[i]).name===e)return o.value;return null}return this.each((t==null?UM:VM)(r,e,t))}function $x(e,t,r){var n=e._id;return e.each(function(){var i=Vr(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return Er(i,n).value[t]}}function gC(e,t){var r;return(typeof t=="number"?kn:t instanceof Qo?tb:(r=Qo(t))?(t=r,tb):EM)(e,t)}function KM(e){return function(){this.removeAttribute(e)}}function YM(e){return function(){this.removeAttributeNS(e.space,e.local)}}function XM(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===n?s:s=t(n=o,r)}}function QM(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===n?s:s=t(n=o,r)}}function ZM(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function JM(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function eP(e,t){var r=zc(e),n=r==="transform"?IM:gC;return this.attrTween(e,typeof t=="function"?(r.local?JM:ZM)(r,n,$x(this,"attr."+e,t)):t==null?(r.local?YM:KM)(r):(r.local?QM:XM)(r,n,t))}function tP(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function rP(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function nP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&rP(e,s)),r}return i._value=t,i}function iP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&tP(e,s)),r}return i._value=t,i}function sP(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=zc(e);return this.tween(r,(n.local?nP:iP)(n,t))}function oP(e,t){return function(){qx(this,e).delay=+t.apply(this,arguments)}}function aP(e,t){return t=+t,function(){qx(this,e).delay=t}}function lP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?oP:aP)(t,e)):Er(this.node(),t).delay}function cP(e,t){return function(){Vr(this,e).duration=+t.apply(this,arguments)}}function uP(e,t){return t=+t,function(){Vr(this,e).duration=t}}function dP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?cP:uP)(t,e)):Er(this.node(),t).duration}function fP(e,t){if(typeof t!="function")throw new Error;return function(){Vr(this,e).ease=t}}function pP(e){var t=this._id;return arguments.length?this.each(fP(t,e)):Er(this.node(),t).ease}function hP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Vr(this,e).ease=r}}function mP(e){if(typeof e!="function")throw new Error;return this.each(hP(this._id,e))}function gP(e){typeof e!="function"&&(e=KN(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&l.push(c);return new fn(n,this._parents,this._name,this._id)}function vP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,s=Math.min(n,i),o=new Array(n),l=0;l<s;++l)for(var c=t[l],u=r[l],d=c.length,f=o[l]=new Array(d),h,p=0;p<d;++p)(h=c[p]||u[p])&&(f[p]=h);for(;l<n;++l)o[l]=t[l];return new fn(o,this._parents,this._name,this._id)}function xP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function yP(e,t,r){var n,i,s=xP(t)?qx:Vr;return function(){var o=s(this,e),l=o.on;l!==n&&(i=(n=l).copy()).on(t,r),o.on=i}}function bP(e,t){var r=this._id;return arguments.length<2?Er(this.node(),r).on.on(e):this.each(yP(r,e,t))}function wP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function _P(){return this.on("end.remove",wP(this._id))}function SP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Dx(e));for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o)for(var l=n[o],c=l.length,u=s[o]=new Array(c),d,f,h=0;h<c;++h)(d=l[h])&&(f=e.call(d,d.__data__,h,l))&&("__data__"in d&&(f.__data__=d.__data__),u[h]=f,$c(u[h],t,r,h,u,Er(d,r)));return new fn(s,this._parents,t,r)}function jP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=GN(e));for(var n=this._groups,i=n.length,s=[],o=[],l=0;l<i;++l)for(var c=n[l],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var h=e.call(d,d.__data__,f,c),p,y=Er(d,r),g=0,w=h.length;g<w;++g)(p=h[g])&&$c(p,t,r,g,h,y);s.push(h),o.push(d)}return new fn(s,o,t,r)}var kP=ha.prototype.constructor;function NP(){return new kP(this._groups,this._parents)}function CP(e,t){var r,n,i;return function(){var s=Ss(this,e),o=(this.style.removeProperty(e),Ss(this,e));return s===o?null:s===r&&o===n?i:i=t(r=s,n=o)}}function vC(e){return function(){this.style.removeProperty(e)}}function EP(e,t,r){var n,i=r+"",s;return function(){var o=Ss(this,e);return o===i?null:o===n?s:s=t(n=o,r)}}function TP(e,t,r){var n,i,s;return function(){var o=Ss(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Ss(this,e))),o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l))}}function RP(e,t){var r,n,i,s="style."+t,o="end."+s,l;return function(){var c=Vr(this,e),u=c.on,d=c.value[s]==null?l||(l=vC(t)):void 0;(u!==r||i!==d)&&(n=(r=u).copy()).on(o,i=d),c.on=n}}function AP(e,t,r){var n=(e+="")=="transform"?AM:gC;return t==null?this.styleTween(e,CP(e,n)).on("end.style."+e,vC(e)):typeof t=="function"?this.styleTween(e,TP(e,n,$x(this,"style."+e,t))).each(RP(this._id,e)):this.styleTween(e,EP(e,n,t),r).on("end.style."+e,null)}function IP(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function MP(e,t,r){var n,i;function s(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&IP(e,o,r)),n}return s._value=t,s}function PP(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,MP(e,t,r??""))}function OP(e){return function(){this.textContent=e}}function DP(e){return function(){var t=e(this);this.textContent=t??""}}function LP(e){return this.tween("text",typeof e=="function"?DP($x(this,"text",e)):OP(e==null?"":e+""))}function FP(e){return function(t){this.textContent=e.call(this,t)}}function zP(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&FP(i)),t}return n._value=e,n}function qP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,zP(e))}function $P(){for(var e=this._name,t=this._id,r=xC(),n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,u=0;u<l;++u)if(c=o[u]){var d=Er(c,t);$c(c,e,r,u,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new fn(n,this._parents,e,r)}function BP(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(s,o){var l={value:o},c={value:function(){--i===0&&s()}};r.each(function(){var u=Vr(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),u.on=t}),i===0&&s()})}var HP=0;function fn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function xC(){return++HP}var Kr=ha.prototype;fn.prototype={constructor:fn,select:SP,selectAll:jP,selectChild:Kr.selectChild,selectChildren:Kr.selectChildren,filter:gP,merge:vP,selection:NP,transition:$P,call:Kr.call,nodes:Kr.nodes,node:Kr.node,size:Kr.size,empty:Kr.empty,each:Kr.each,on:bP,attr:eP,attrTween:sP,style:AP,styleTween:PP,text:LP,textTween:qP,remove:_P,tween:GM,delay:lP,duration:dP,ease:pP,easeVarying:mP,end:BP,[Symbol.iterator]:Kr[Symbol.iterator]};function WP(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var UP={time:null,delay:0,duration:250,ease:WP};function VP(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function GP(e){var t,r;e instanceof fn?(t=e._id,e=e._name):(t=xC(),(r=UP).time=zx(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,u=0;u<l;++u)(c=o[u])&&$c(c,e,t,u,o,r||VP(c,t));return new fn(n,this._parents,e,t)}ha.prototype.interrupt=WM;ha.prototype.transition=GP;const Ka=e=>()=>e;function KP(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function rn(e,t,r){this.k=e,this.x=t,this.y=r}rn.prototype={constructor:rn,scale:function(e){return e===1?this:new rn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new rn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var an=new rn(1,0,0);rn.prototype;function Qu(e){e.stopImmediatePropagation()}function Xs(e){e.preventDefault(),e.stopImmediatePropagation()}function YP(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function XP(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function lb(){return this.__zoom||an}function QP(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ZP(){return navigator.maxTouchPoints||"ontouchstart"in this}function JP(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],s=e.invertY(t[0][1])-r[0][1],o=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function yC(){var e=YP,t=XP,r=JP,n=QP,i=ZP,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=DM,u=Fc("start","zoom","end"),d,f,h,p=500,y=150,g=0,w=10;function v(C){C.property("__zoom",lb).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",R).filter(i).on("touchstart.zoom",T).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(C,L,O,$){var D=C.selection?C.selection():C;D.property("__zoom",lb),C!==D?S(C,L,O,$):D.interrupt().each(function(){k(this,arguments).event($).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},v.scaleBy=function(C,L,O,$){v.scaleTo(C,function(){var D=this.__zoom.k,A=typeof L=="function"?L.apply(this,arguments):L;return D*A},O,$)},v.scaleTo=function(C,L,O,$){v.transform(C,function(){var D=t.apply(this,arguments),A=this.__zoom,F=O==null?_(D):typeof O=="function"?O.apply(this,arguments):O,M=A.invert(F),q=typeof L=="function"?L.apply(this,arguments):L;return r(b(x(A,q),F,M),D,o)},O,$)},v.translateBy=function(C,L,O,$){v.transform(C,function(){return r(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof O=="function"?O.apply(this,arguments):O),t.apply(this,arguments),o)},null,$)},v.translateTo=function(C,L,O,$,D){v.transform(C,function(){var A=t.apply(this,arguments),F=this.__zoom,M=$==null?_(A):typeof $=="function"?$.apply(this,arguments):$;return r(an.translate(M[0],M[1]).scale(F.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof O=="function"?-O.apply(this,arguments):-O),A,o)},$,D)};function x(C,L){return L=Math.max(s[0],Math.min(s[1],L)),L===C.k?C:new rn(L,C.x,C.y)}function b(C,L,O){var $=L[0]-O[0]*C.k,D=L[1]-O[1]*C.k;return $===C.x&&D===C.y?C:new rn(C.k,$,D)}function _(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function S(C,L,O,$){C.on("start.zoom",function(){k(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event($).end()}).tween("zoom",function(){var D=this,A=arguments,F=k(D,A).event($),M=t.apply(D,A),q=O==null?_(M):typeof O=="function"?O.apply(D,A):O,W=Math.max(M[1][0]-M[0][0],M[1][1]-M[0][1]),B=D.__zoom,K=typeof L=="function"?L.apply(D,A):L,Z=c(B.invert(q).concat(W/B.k),K.invert(q).concat(W/K.k));return function(re){if(re===1)re=K;else{var ne=Z(re),V=W/ne[2];re=new rn(V,q[0]-ne[0]*V,q[1]-ne[1]*V)}F.zoom(null,re)}})}function k(C,L,O){return!O&&C.__zooming||new N(C,L)}function N(C,L){this.that=C,this.args=L,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,L),this.taps=0}N.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,L){return this.mouse&&C!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var L=ar(this.that).datum();u.call(C,this.that,new KP(C,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:u}),L)}};function E(C,...L){if(!e.apply(this,arguments))return;var O=k(this,L).event(C),$=this.__zoom,D=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,n.apply(this,arguments)))),A=wr(C);if(O.wheel)(O.mouse[0][0]!==A[0]||O.mouse[0][1]!==A[1])&&(O.mouse[1]=$.invert(O.mouse[0]=A)),clearTimeout(O.wheel);else{if($.k===D)return;O.mouse=[A,$.invert(A)],jl(this),O.start()}Xs(C),O.wheel=setTimeout(F,y),O.zoom("mouse",r(b(x($,D),O.mouse[0],O.mouse[1]),O.extent,o));function F(){O.wheel=null,O.end()}}function j(C,...L){if(h||!e.apply(this,arguments))return;var O=C.currentTarget,$=k(this,L,!0).event(C),D=ar(C.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",W,!0),A=wr(C,O),F=C.clientX,M=C.clientY;iC(C.view),Qu(C),$.mouse=[A,this.__zoom.invert(A)],jl(this),$.start();function q(B){if(Xs(B),!$.moved){var K=B.clientX-F,Z=B.clientY-M;$.moved=K*K+Z*Z>g}$.event(B).zoom("mouse",r(b($.that.__zoom,$.mouse[0]=wr(B,O),$.mouse[1]),$.extent,o))}function W(B){D.on("mousemove.zoom mouseup.zoom",null),sC(B.view,$.moved),Xs(B),$.event(B).end()}}function R(C,...L){if(e.apply(this,arguments)){var O=this.__zoom,$=wr(C.changedTouches?C.changedTouches[0]:C,this),D=O.invert($),A=O.k*(C.shiftKey?.5:2),F=r(b(x(O,A),$,D),t.apply(this,L),o);Xs(C),l>0?ar(this).transition().duration(l).call(S,F,$,C):ar(this).call(v.transform,F,$,C)}}function T(C,...L){if(e.apply(this,arguments)){var O=C.touches,$=O.length,D=k(this,L,C.changedTouches.length===$).event(C),A,F,M,q;for(Qu(C),F=0;F<$;++F)M=O[F],q=wr(M,this),q=[q,this.__zoom.invert(q),M.identifier],D.touch0?!D.touch1&&D.touch0[2]!==q[2]&&(D.touch1=q,D.taps=0):(D.touch0=q,A=!0,D.taps=1+!!d);d&&(d=clearTimeout(d)),A&&(D.taps<2&&(f=q[0],d=setTimeout(function(){d=null},p)),jl(this),D.start())}}function P(C,...L){if(this.__zooming){var O=k(this,L).event(C),$=C.changedTouches,D=$.length,A,F,M,q;for(Xs(C),A=0;A<D;++A)F=$[A],M=wr(F,this),O.touch0&&O.touch0[2]===F.identifier?O.touch0[0]=M:O.touch1&&O.touch1[2]===F.identifier&&(O.touch1[0]=M);if(F=O.that.__zoom,O.touch1){var W=O.touch0[0],B=O.touch0[1],K=O.touch1[0],Z=O.touch1[1],re=(re=K[0]-W[0])*re+(re=K[1]-W[1])*re,ne=(ne=Z[0]-B[0])*ne+(ne=Z[1]-B[1])*ne;F=x(F,Math.sqrt(re/ne)),M=[(W[0]+K[0])/2,(W[1]+K[1])/2],q=[(B[0]+Z[0])/2,(B[1]+Z[1])/2]}else if(O.touch0)M=O.touch0[0],q=O.touch0[1];else return;O.zoom("touch",r(b(F,M,q),O.extent,o))}}function z(C,...L){if(this.__zooming){var O=k(this,L).event(C),$=C.changedTouches,D=$.length,A,F;for(Qu(C),h&&clearTimeout(h),h=setTimeout(function(){h=null},p),A=0;A<D;++A)F=$[A],O.touch0&&O.touch0[2]===F.identifier?delete O.touch0:O.touch1&&O.touch1[2]===F.identifier&&delete O.touch1;if(O.touch1&&!O.touch0&&(O.touch0=O.touch1,delete O.touch1),O.touch0)O.touch0[1]=this.__zoom.invert(O.touch0[0]);else if(O.end(),O.taps===2&&(F=wr(F,this),Math.hypot(f[0]-F[0],f[1]-F[1])<w)){var M=ar(this).on("dblclick.zoom");M&&M.apply(this,arguments)}}}return v.wheelDelta=function(C){return arguments.length?(n=typeof C=="function"?C:Ka(+C),v):n},v.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Ka(!!C),v):e},v.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:Ka(!!C),v):i},v.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Ka([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),v):t},v.scaleExtent=function(C){return arguments.length?(s[0]=+C[0],s[1]=+C[1],v):[s[0],s[1]]},v.translateExtent=function(C){return arguments.length?(o[0][0]=+C[0][0],o[1][0]=+C[1][0],o[0][1]=+C[0][1],o[1][1]=+C[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(C){return arguments.length?(r=C,v):r},v.duration=function(C){return arguments.length?(l=+C,v):l},v.interpolate=function(C){return arguments.length?(c=C,v):c},v.on=function(){var C=u.on.apply(u,arguments);return C===u?v:C},v.clickDistance=function(C){return arguments.length?(g=(C=+C)*C,v):Math.sqrt(g)},v.tapDistance=function(C){return arguments.length?(w=+C,v):w},v}const Bc=m.createContext(null),eO=Bc.Provider,pn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},bC=pn.error001();function Be(e,t){const r=m.useContext(Bc);if(r===null)throw new Error(bC);return UN(r,e,t)}const ht=()=>{const e=m.useContext(Bc);if(e===null)throw new Error(bC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},tO=e=>e.userSelectionActive?"none":"all";function Hn({position:e,children:t,className:r,style:n,...i}){const s=Be(tO),o=`${e}`.split("-");return G.createElement("div",{className:Wt(["react-flow__panel",r,...o]),style:{...n,pointerEvents:s},...i},t)}function rO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:G.createElement(Hn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},G.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const nO=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:c,className:u,...d})=>{const f=m.useRef(null),[h,p]=m.useState({x:0,y:0,width:0,height:0}),y=Wt(["react-flow__edge-textwrapper",u]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();p({x:g.x,y:g.y,width:g.width,height:g.height})}},[r]),typeof r>"u"||!r?null:G.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:y,visibility:h.width?"visible":"hidden",...d},i&&G.createElement("rect",{width:h.width+2*o[0],x:-o[0],y:-o[1],height:h.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),G.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:f,style:n},r),c)};var iO=m.memo(nO);const Bx=e=>({width:e.offsetWidth,height:e.offsetHeight}),ks=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Hx=(e={x:0,y:0},t)=>({x:ks(e.x,t[0][0],t[1][0]),y:ks(e.y,t[0][1],t[1][1])}),cb=(e,t,r)=>e<t?ks(Math.abs(e-t),1,50)/50:e>r?-ks(Math.abs(e-r),1,50)/50:0,wC=(e,t)=>{const r=cb(e.x,35,t.width-35)*20,n=cb(e.y,35,t.height-35)*20;return[r,n]},_C=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},SC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Jo=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),jC=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),ub=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),sO=(e,t)=>jC(SC(Jo(e),Jo(t))),bv=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},oO=e=>cr(e.width)&&cr(e.height)&&cr(e.x)&&cr(e.y),cr=e=>!isNaN(e)&&isFinite(e),Ze=Symbol.for("internals"),kC=["Enter"," ","Escape"],aO=(e,t)=>{},lO=e=>"nativeEvent"in e;function wv(e){var i,s;const t=lO(e)?e.nativeEvent:e,r=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const NC=e=>"clientX"in e,Wn=(e,t)=>{var s,o;const r=NC(e),n=r?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=r?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},rc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},ga=({id:e,path:t,labelX:r,labelY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p=20})=>G.createElement(G.Fragment,null,G.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:h}),p&&G.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),i&&cr(r)&&cr(n)?G.createElement(iO,{x:r,y:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u}):null);ga.displayName="BaseEdge";function Qs(e,t,r){return r===void 0?r:n=>{const i=t().edges.find(s=>s.id===e);i&&r(n,{...i})}}function CC({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,s=r<e?r+i:r-i,o=Math.abs(n-t)/2,l=n<t?n+o:n-o;return[s,l,i,o]}function EC({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:l}){const c=e*.125+i*.375+o*.375+r*.125,u=t*.125+s*.375+l*.375+n*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}var Ni;(function(e){e.Strict="strict",e.Loose="loose"})(Ni||(Ni={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var ea;(function(e){e.Partial="partial",e.Full="full"})(ea||(ea={}));var Rn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Rn||(Rn={}));var nc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(nc||(nc={}));var oe;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(oe||(oe={}));function db({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===oe.Left||e===oe.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function TC({sourceX:e,sourceY:t,sourcePosition:r=oe.Bottom,targetX:n,targetY:i,targetPosition:s=oe.Top}){const[o,l]=db({pos:r,x1:e,y1:t,x2:n,y2:i}),[c,u]=db({pos:s,x1:n,y1:i,x2:e,y2:t}),[d,f,h,p]=EC({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${o},${l} ${c},${u} ${n},${i}`,d,f,h,p]}const Wx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=oe.Bottom,targetPosition:s=oe.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:g})=>{const[w,v,x]=TC({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s});return G.createElement(ga,{path:w,labelX:v,labelY:x,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:g})});Wx.displayName="SimpleBezierEdge";const fb={[oe.Left]:{x:-1,y:0},[oe.Right]:{x:1,y:0},[oe.Top]:{x:0,y:-1},[oe.Bottom]:{x:0,y:1}},cO=({source:e,sourcePosition:t=oe.Bottom,target:r})=>t===oe.Left||t===oe.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},pb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function uO({source:e,sourcePosition:t=oe.Bottom,target:r,targetPosition:n=oe.Top,center:i,offset:s}){const o=fb[t],l=fb[n],c={x:e.x+o.x*s,y:e.y+o.y*s},u={x:r.x+l.x*s,y:r.y+l.y*s},d=cO({source:c,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",h=d[f];let p=[],y,g;const w={x:0,y:0},v={x:0,y:0},[x,b,_,S]=CC({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(o[f]*l[f]===-1){y=i.x??x,g=i.y??b;const N=[{x:y,y:c.y},{x:y,y:u.y}],E=[{x:c.x,y:g},{x:u.x,y:g}];o[f]===h?p=f==="x"?N:E:p=f==="x"?E:N}else{const N=[{x:c.x,y:u.y}],E=[{x:u.x,y:c.y}];if(f==="x"?p=o.x===h?E:N:p=o.y===h?N:E,t===n){const z=Math.abs(e[f]-r[f]);if(z<=s){const C=Math.min(s-1,s-z);o[f]===h?w[f]=(c[f]>e[f]?-1:1)*C:v[f]=(u[f]>r[f]?-1:1)*C}}if(t!==n){const z=f==="x"?"y":"x",C=o[f]===l[z],L=c[z]>u[z],O=c[z]<u[z];(o[f]===1&&(!C&&L||C&&O)||o[f]!==1&&(!C&&O||C&&L))&&(p=f==="x"?N:E)}const j={x:c.x+w.x,y:c.y+w.y},R={x:u.x+v.x,y:u.y+v.y},T=Math.max(Math.abs(j.x-p[0].x),Math.abs(R.x-p[0].x)),P=Math.max(Math.abs(j.y-p[0].y),Math.abs(R.y-p[0].y));T>=P?(y=(j.x+R.x)/2,g=p[0].y):(y=p[0].x,g=(j.y+R.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...p,{x:u.x+v.x,y:u.y+v.y},r],y,g,_,S]}function dO(e,t,r,n){const i=Math.min(pb(e,t)/2,pb(t,r)/2,n),{x:s,y:o}=t;if(e.x===s&&s===r.x||e.y===o&&o===r.y)return`L${s} ${o}`;if(e.y===o){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${s+i*u},${o}Q ${s},${o} ${s},${o+i*d}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*l},${o}`}function _v({sourceX:e,sourceY:t,sourcePosition:r=oe.Bottom,targetX:n,targetY:i,targetPosition:s=oe.Top,borderRadius:o=5,centerX:l,centerY:c,offset:u=20}){const[d,f,h,p,y]=uO({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:s,center:{x:l,y:c},offset:u});return[d.reduce((w,v,x)=>{let b="";return x>0&&x<d.length-1?b=dO(d[x-1],v,d[x+1],o):b=`${x===0?"M":"L"}${v.x} ${v.y}`,w+=b,w},""),f,h,p,y]}const Hc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,sourcePosition:f=oe.Bottom,targetPosition:h=oe.Top,markerEnd:p,markerStart:y,pathOptions:g,interactionWidth:w})=>{const[v,x,b]=_v({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:h,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return G.createElement(ga,{path:v,labelX:x,labelY:b,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:p,markerStart:y,interactionWidth:w})});Hc.displayName="SmoothStepEdge";const Ux=m.memo(e=>{var t;return G.createElement(Hc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Ux.displayName="StepEdge";function fO({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,s,o,l]=CC({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,s,o,l]}const Vx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p})=>{const[y,g,w]=fO({sourceX:e,sourceY:t,targetX:r,targetY:n});return G.createElement(ga,{path:y,labelX:g,labelY:w,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p})});Vx.displayName="StraightEdge";function Ya(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function hb({pos:e,x1:t,y1:r,x2:n,y2:i,c:s}){switch(e){case oe.Left:return[t-Ya(t-n,s),r];case oe.Right:return[t+Ya(n-t,s),r];case oe.Top:return[t,r-Ya(r-i,s)];case oe.Bottom:return[t,r+Ya(i-r,s)]}}function RC({sourceX:e,sourceY:t,sourcePosition:r=oe.Bottom,targetX:n,targetY:i,targetPosition:s=oe.Top,curvature:o=.25}){const[l,c]=hb({pos:r,x1:e,y1:t,x2:n,y2:i,c:o}),[u,d]=hb({pos:s,x1:n,y1:i,x2:e,y2:t,c:o}),[f,h,p,y]=EC({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${l},${c} ${u},${d} ${n},${i}`,f,h,p,y]}const ic=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=oe.Bottom,targetPosition:s=oe.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,pathOptions:g,interactionWidth:w})=>{const[v,x,b]=RC({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s,curvature:g==null?void 0:g.curvature});return G.createElement(ga,{path:v,labelX:x,labelY:b,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:w})});ic.displayName="BezierEdge";const Gx=m.createContext(null),pO=Gx.Provider;Gx.Consumer;const hO=()=>m.useContext(Gx),mO=e=>"id"in e&&"source"in e&&"target"in e,gO=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Sv=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,vO=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),xO=(e,t)=>{if(!e.source||!e.target)return t;let r;return mO(e)?r={...e}:r={...e,id:gO(e)},vO(r,t)?t:t.concat(r)},jv=({x:e,y:t},[r,n,i],s,[o,l])=>{const c={x:(e-r)/i,y:(t-n)/i};return s?{x:o*Math.round(c.x/o),y:l*Math.round(c.y/l)}:c},AC=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n}),xi=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],i={x:e.position.x-r,y:e.position.y-n};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:i}},Wc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const{x:s,y:o}=xi(i,t).positionAbsolute;return SC(n,Jo({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return jC(r)},IC=(e,t,[r,n,i]=[0,0,1],s=!1,o=!1,l=[0,0])=>{const c={x:(t.x-r)/i,y:(t.y-n)/i,width:t.width/i,height:t.height/i},u=[];return e.forEach(d=>{const{width:f,height:h,selectable:p=!0,hidden:y=!1}=d;if(o&&!p||y)return!1;const{positionAbsolute:g}=xi(d,l),w={x:g.x,y:g.y,width:f||0,height:h||0},v=bv(c,w),x=typeof f>"u"||typeof h>"u"||f===null||h===null,b=s&&v>0,_=(f||0)*(h||0);(x||b||v>=_||d.dragging)&&u.push(d)}),u},MC=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},PC=(e,t,r,n,i,s=.1)=>{const o=t/(e.width*(1+s)),l=r/(e.height*(1+s)),c=Math.min(o,l),u=ks(c,n,i),d=e.x+e.width/2,f=e.y+e.height/2,h=t/2-d*u,p=r/2-f*u;return{x:h,y:p,zoom:u}},li=(e,t=0)=>e.transition().duration(t);function mb(e,t,r,n){return(t[r]||[]).reduce((i,s)=>{var o,l;return`${e.id}-${s.id}-${r}`!==n&&i.push({id:s.id||null,type:r,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+s.y+s.height/2}),i},[])}function yO(e,t,r,n,i,s){const{x:o,y:l}=Wn(e),u=t.elementsFromPoint(o,l).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const g=Kx(void 0,u),w=u.getAttribute("data-handleid"),v=s({nodeId:y,id:w,type:g});if(v){const x=i.find(b=>b.nodeId===y&&b.type===g&&b.id===w);return{handle:{id:w,type:g,nodeId:y,x:(x==null?void 0:x.x)||r.x,y:(x==null?void 0:x.y)||r.y},validHandleResult:v}}}}let d=[],f=1/0;if(i.forEach(y=>{const g=Math.sqrt((y.x-r.x)**2+(y.y-r.y)**2);if(g<=n){const w=s(y);g<=f&&(g<f?d=[{handle:y,validHandleResult:w}]:g===f&&d.push({handle:y,validHandleResult:w}),f=g)}}),!d.length)return{handle:null,validHandleResult:OC()};if(d.length===1)return d[0];const h=d.some(({validHandleResult:y})=>y.isValid),p=d.some(({handle:y})=>y.type==="target");return d.find(({handle:y,validHandleResult:g})=>p?y.type==="target":h?g.isValid:!0)||d[0]}const bO={source:null,target:null,sourceHandle:null,targetHandle:null},OC=()=>({handleDomNode:null,isValid:!1,connection:bO,endHandle:null});function DC(e,t,r,n,i,s,o){const l=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...OC(),handleDomNode:c};if(c){const d=Kx(void 0,c),f=c.getAttribute("data-nodeid"),h=c.getAttribute("data-handleid"),p=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),g={source:l?f:r,sourceHandle:l?h:n,target:l?r:f,targetHandle:l?n:h};u.connection=g,p&&y&&(t===Ni.Strict?l&&d==="source"||!l&&d==="target":f!==r||h!==n)&&(u.endHandle={nodeId:f,handleId:h,type:d},u.isValid=s(g))}return u}function wO({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((i,s)=>{if(s[Ze]){const{handleBounds:o}=s[Ze];let l=[],c=[];o&&(l=mb(s,o,"source",`${t}-${r}-${n}`),c=mb(s,o,"target",`${t}-${r}-${n}`)),i.push(...l,...c)}return i},[])}function Kx(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Zu(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function _O(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function LC({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:i,getState:s,setState:o,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:u}){const d=_C(e.target),{connectionMode:f,domNode:h,autoPanOnConnect:p,connectionRadius:y,onConnectStart:g,panBy:w,getNodes:v,cancelConnection:x}=s();let b=0,_;const{x:S,y:k}=Wn(e),N=d==null?void 0:d.elementFromPoint(S,k),E=Kx(c,N),j=h==null?void 0:h.getBoundingClientRect();if(!j||!E)return;let R,T=Wn(e,j),P=!1,z=null,C=!1,L=null;const O=wO({nodes:v(),nodeId:r,handleId:t,handleType:E}),$=()=>{if(!p)return;const[F,M]=wC(T,j);w({x:F,y:M}),b=requestAnimationFrame($)};o({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:r,handleId:t,type:E},connectionEndHandle:null}),g==null||g(e,{nodeId:r,handleId:t,handleType:E});function D(F){const{transform:M}=s();T=Wn(F,j);const{handle:q,validHandleResult:W}=yO(F,d,jv(T,M,!1,[1,1]),y,O,B=>DC(B,f,r,t,i?"target":"source",l,d));if(_=q,P||($(),P=!0),L=W.handleDomNode,z=W.connection,C=W.isValid,o({connectionPosition:_&&C?AC({x:_.x,y:_.y},M):T,connectionStatus:_O(!!_,C),connectionEndHandle:W.endHandle}),!_&&!C&&!L)return Zu(R);z.source!==z.target&&L&&(Zu(R),R=L,L.classList.add("connecting","react-flow__handle-connecting"),L.classList.toggle("valid",C),L.classList.toggle("react-flow__handle-valid",C))}function A(F){var M,q;(_||L)&&z&&C&&(n==null||n(z)),(q=(M=s()).onConnectEnd)==null||q.call(M,F),c&&(u==null||u(F)),Zu(R),x(),cancelAnimationFrame(b),P=!1,C=!1,z=null,L=null,d.removeEventListener("mousemove",D),d.removeEventListener("mouseup",A),d.removeEventListener("touchmove",D),d.removeEventListener("touchend",A)}d.addEventListener("mousemove",D),d.addEventListener("mouseup",A),d.addEventListener("touchmove",D),d.addEventListener("touchend",A)}const gb=()=>!0,SO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),jO=(e,t,r)=>n=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=n;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r}},FC=m.forwardRef(({type:e="source",position:t=oe.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:l,children:c,className:u,onMouseDown:d,onTouchStart:f,...h},p)=>{var j,R;const y=o||null,g=e==="target",w=ht(),v=hO(),{connectOnClick:x,noPanClassName:b}=Be(SO,St),{connecting:_,clickConnecting:S}=Be(jO(v,y,e),St);v||(R=(j=w.getState()).onError)==null||R.call(j,"010",pn.error010());const k=T=>{const{defaultEdgeOptions:P,onConnect:z,hasDefaultEdges:C}=w.getState(),L={...P,...T};if(C){const{edges:O,setEdges:$}=w.getState();$(xO(L,O))}z==null||z(L),l==null||l(L)},N=T=>{if(!v)return;const P=NC(T);i&&(P&&T.button===0||!P)&&LC({event:T,handleId:y,nodeId:v,onConnect:k,isTarget:g,getState:w.getState,setState:w.setState,isValidConnection:r||w.getState().isValidConnection||gb}),P?d==null||d(T):f==null||f(T)},E=T=>{const{onClickConnectStart:P,onClickConnectEnd:z,connectionClickStartHandle:C,connectionMode:L,isValidConnection:O}=w.getState();if(!v||!C&&!i)return;if(!C){P==null||P(T,{nodeId:v,handleId:y,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:y}});return}const $=_C(T.target),D=r||O||gb,{connection:A,isValid:F}=DC({nodeId:v,id:y,type:e},L,C.nodeId,C.handleId||null,C.type,D,$);F&&k(A),z==null||z(T),w.setState({connectionClickStartHandle:null})};return G.createElement("div",{"data-handleid":y,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${y}-${e}`,className:Wt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,u,{source:!g,target:g,connectable:n,connectablestart:i,connectableend:s,connecting:S,connectionindicator:n&&(i&&!_||s&&_)}]),onMouseDown:N,onTouchStart:N,onClick:x?E:void 0,ref:p,...h},c)});FC.displayName="Handle";var Wr=m.memo(FC);const zC=({data:e,isConnectable:t,targetPosition:r=oe.Top,sourcePosition:n=oe.Bottom})=>G.createElement(G.Fragment,null,G.createElement(Wr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,G.createElement(Wr,{type:"source",position:n,isConnectable:t}));zC.displayName="DefaultNode";var kv=m.memo(zC);const qC=({data:e,isConnectable:t,sourcePosition:r=oe.Bottom})=>G.createElement(G.Fragment,null,e==null?void 0:e.label,G.createElement(Wr,{type:"source",position:r,isConnectable:t}));qC.displayName="InputNode";var $C=m.memo(qC);const BC=({data:e,isConnectable:t,targetPosition:r=oe.Top})=>G.createElement(G.Fragment,null,G.createElement(Wr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);BC.displayName="OutputNode";var HC=m.memo(BC);const Yx=()=>null;Yx.displayName="GroupNode";const kO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Xa=e=>e.id;function NO(e,t){return St(e.selectedNodes.map(Xa),t.selectedNodes.map(Xa))&&St(e.selectedEdges.map(Xa),t.selectedEdges.map(Xa))}const WC=m.memo(({onSelectionChange:e})=>{const t=ht(),{selectedNodes:r,selectedEdges:n}=Be(kO,NO);return m.useEffect(()=>{const i={nodes:r,edges:n};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[r,n,e]),null});WC.displayName="SelectionListener";const CO=e=>!!e.onSelectionChange;function EO({onSelectionChange:e}){const t=Be(CO);return e||t?G.createElement(WC,{onSelectionChange:e}):null}const TO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oi(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ye(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const RO=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:d,nodesFocusable:f,edgesFocusable:h,edgesUpdatable:p,elevateNodesOnSelect:y,minZoom:g,maxZoom:w,nodeExtent:v,onNodesChange:x,onEdgesChange:b,elementsSelectable:_,connectionMode:S,snapGrid:k,snapToGrid:N,translateExtent:E,connectOnClick:j,defaultEdgeOptions:R,fitView:T,fitViewOptions:P,onNodesDelete:z,onEdgesDelete:C,onNodeDrag:L,onNodeDragStart:O,onNodeDragStop:$,onSelectionDrag:D,onSelectionDragStart:A,onSelectionDragStop:F,noPanClassName:M,nodeOrigin:q,rfId:W,autoPanOnConnect:B,autoPanOnNodeDrag:K,onError:Z,connectionRadius:re,isValidConnection:ne,nodeDragThreshold:V})=>{const{setNodes:ee,setEdges:ve,setDefaultNodesAndEdges:fe,setMinZoom:be,setMaxZoom:ce,setTranslateExtent:te,setNodeExtent:we,reset:Y}=Be(TO,St),X=ht();return m.useEffect(()=>{const ue=n==null?void 0:n.map(he=>({...he,...R}));return fe(r,ue),()=>{Y()}},[]),ye("defaultEdgeOptions",R,X.setState),ye("connectionMode",S,X.setState),ye("onConnect",i,X.setState),ye("onConnectStart",s,X.setState),ye("onConnectEnd",o,X.setState),ye("onClickConnectStart",l,X.setState),ye("onClickConnectEnd",c,X.setState),ye("nodesDraggable",u,X.setState),ye("nodesConnectable",d,X.setState),ye("nodesFocusable",f,X.setState),ye("edgesFocusable",h,X.setState),ye("edgesUpdatable",p,X.setState),ye("elementsSelectable",_,X.setState),ye("elevateNodesOnSelect",y,X.setState),ye("snapToGrid",N,X.setState),ye("snapGrid",k,X.setState),ye("onNodesChange",x,X.setState),ye("onEdgesChange",b,X.setState),ye("connectOnClick",j,X.setState),ye("fitViewOnInit",T,X.setState),ye("fitViewOnInitOptions",P,X.setState),ye("onNodesDelete",z,X.setState),ye("onEdgesDelete",C,X.setState),ye("onNodeDrag",L,X.setState),ye("onNodeDragStart",O,X.setState),ye("onNodeDragStop",$,X.setState),ye("onSelectionDrag",D,X.setState),ye("onSelectionDragStart",A,X.setState),ye("onSelectionDragStop",F,X.setState),ye("noPanClassName",M,X.setState),ye("nodeOrigin",q,X.setState),ye("rfId",W,X.setState),ye("autoPanOnConnect",B,X.setState),ye("autoPanOnNodeDrag",K,X.setState),ye("onError",Z,X.setState),ye("connectionRadius",re,X.setState),ye("isValidConnection",ne,X.setState),ye("nodeDragThreshold",V,X.setState),Oi(e,ee),Oi(t,ve),Oi(g,be),Oi(w,ce),Oi(E,te),Oi(v,we),null},vb={display:"none"},AO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},UC="react-flow__node-desc",VC="react-flow__edge-desc",IO="react-flow__aria-live",MO=e=>e.ariaLiveMessage;function PO({rfId:e}){const t=Be(MO);return G.createElement("div",{id:`${IO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:AO},t)}function OO({rfId:e,disableKeyboardA11y:t}){return G.createElement(G.Fragment,null,G.createElement("div",{id:`${UC}-${e}`,style:vb},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),G.createElement("div",{id:`${VC}-${e}`,style:vb},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&G.createElement(PO,{rfId:e}))}var ta=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),i=m.useRef(!1),s=m.useRef(new Set([])),[o,l]=m.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),d=u.reduce((f,h)=>f.concat(...h),[]);return[u,d]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const d=p=>{if(i.current=p.ctrlKey||p.metaKey||p.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&wv(p))return!1;const g=yb(p.code,l);s.current.add(p[g]),xb(o,s.current,!1)&&(p.preventDefault(),n(!0))},f=p=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&wv(p))return!1;const g=yb(p.code,l);xb(o,s.current,!0)?(n(!1),s.current.clear()):s.current.delete(p[g]),p.key==="Meta"&&s.current.clear(),i.current=!1},h=()=>{s.current.clear(),n(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",h),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",h)}}},[e,n]),r};function xb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function yb(e,t){return t.includes(e)?"code":"key"}function GC(e,t,r,n){var l,c;const i=e.parentNode||e.parentId;if(!i)return r;const s=t.get(i),o=xi(s,n);return GC(s,t,{x:(r.x??0)+o.x,y:(r.y??0)+o.y,z:(((l=s[Ze])==null?void 0:l.z)??0)>(r.z??0)?((c=s[Ze])==null?void 0:c.z)??0:r.z??0},n)}function KC(e,t,r){e.forEach(n=>{var s;const i=n.parentNode||n.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||r!=null&&r[n.id]){const{x:o,y:l,z:c}=GC(n,e,{...n.position,z:((s=n[Ze])==null?void 0:s.z)??0},t);n.positionAbsolute={x:o,y:l},n[Ze].z=c,r!=null&&r[n.id]&&(n[Ze].isParent=!0)}})}function Ju(e,t,r,n){const i=new Map,s={},o=n?1e3:0;return e.forEach(l=>{var p;const c=(cr(l.zIndex)?l.zIndex:0)+(l.selected?o:0),u=t.get(l.id),d={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(s[f]=!0);const h=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==l.type;Object.defineProperty(d,Ze,{enumerable:!1,value:{handleBounds:h||(p=u==null?void 0:u[Ze])==null?void 0:p.handleBounds,z:c}}),i.set(l.id,d)}),KC(i,r,s),i}function YC(e,t={}){const{getNodes:r,width:n,height:i,minZoom:s,maxZoom:o,d3Zoom:l,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:d,nodeOrigin:f}=e(),h=t.initial&&!u&&d;if(l&&c&&(h||!t.initial)){const y=r().filter(w=>{var x;const v=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(x=t.nodes)!=null&&x.length?v&&t.nodes.some(b=>b.id===w.id):v}),g=y.every(w=>w.width&&w.height);if(y.length>0&&g){const w=Wc(y,f),{x:v,y:x,zoom:b}=PC(w,n,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),_=an.translate(v,x).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(li(c,t.duration),_):l.transform(c,_),!0}}return!1}function DO(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[Ze]:n[Ze],selected:r.selected})}),new Map(t)}function LO(e,t){return t.map(r=>{const n=e.find(i=>i.id===r.id);return n&&(r.selected=n.selected),r})}function Qa({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:u}=r();e!=null&&e.length&&(c&&n({nodeInternals:DO(e,i)}),o==null||o(e)),t!=null&&t.length&&(u&&n({edges:LO(t,s)}),l==null||l(t))}const Di=()=>{},FO={zoomIn:Di,zoomOut:Di,zoomTo:Di,getZoom:()=>1,setViewport:Di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Di,fitBounds:Di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},zO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),qO=()=>{const e=ht(),{d3Zoom:t,d3Selection:r}=Be(zO,St);return m.useMemo(()=>r&&t?{zoomIn:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(li(r,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,l,c]=e.getState().transform,u=an.translate(i.x??o,i.y??l).scale(i.zoom??c);t.transform(li(r,s==null?void 0:s.duration),u)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>YC(e.getState,i),setCenter:(i,s,o)=>{const{width:l,height:c,maxZoom:u}=e.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:u,f=l/2-i*d,h=c/2-s*d,p=an.translate(f,h).scale(d);t.transform(li(r,o==null?void 0:o.duration),p)},fitBounds:(i,s)=>{const{width:o,height:l,minZoom:c,maxZoom:u}=e.getState(),{x:d,y:f,zoom:h}=PC(i,o,l,c,u,(s==null?void 0:s.padding)??.1),p=an.translate(d,f).scale(h);t.transform(li(r,s==null?void 0:s.duration),p)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),jv(i,s,o,l)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:l,domNode:c}=e.getState();if(!c)return i;const{x:u,y:d}=c.getBoundingClientRect(),f={x:i.x-u,y:i.y-d};return jv(f,s,o,l)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:l,y:c}=o.getBoundingClientRect(),u=AC(i,s);return{x:u.x+l,y:u.y+c}},viewportInitialized:!0}:FO,[t,r])};function Uc(){const e=qO(),t=ht(),r=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),n=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),i=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(w=>({...w}))},[]),s=m.useCallback(g=>{const{edges:w=[]}=t.getState();return w.find(v=>v.id===g)},[]),o=m.useCallback(g=>{const{getNodes:w,setNodes:v,hasDefaultNodes:x,onNodesChange:b}=t.getState(),_=w(),S=typeof g=="function"?g(_):g;if(x)v(S);else if(b){const k=S.length===0?_.map(N=>({type:"remove",id:N.id})):S.map(N=>({item:N,type:"reset"}));b(k)}},[]),l=m.useCallback(g=>{const{edges:w=[],setEdges:v,hasDefaultEdges:x,onEdgesChange:b}=t.getState(),_=typeof g=="function"?g(w):g;if(x)v(_);else if(b){const S=_.length===0?w.map(k=>({type:"remove",id:k.id})):_.map(k=>({item:k,type:"reset"}));b(S)}},[]),c=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{getNodes:v,setNodes:x,hasDefaultNodes:b,onNodesChange:_}=t.getState();if(b){const k=[...v(),...w];x(k)}else if(_){const S=w.map(k=>({item:k,type:"add"}));_(S)}},[]),u=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{edges:v=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:_}=t.getState();if(b)x([...v,...w]);else if(_){const S=w.map(k=>({item:k,type:"add"}));_(S)}},[]),d=m.useCallback(()=>{const{getNodes:g,edges:w=[],transform:v}=t.getState(),[x,b,_]=v;return{nodes:g().map(S=>({...S})),edges:w.map(S=>({...S})),viewport:{x,y:b,zoom:_}}},[]),f=m.useCallback(({nodes:g,edges:w})=>{const{nodeInternals:v,getNodes:x,edges:b,hasDefaultNodes:_,hasDefaultEdges:S,onNodesDelete:k,onEdgesDelete:N,onNodesChange:E,onEdgesChange:j}=t.getState(),R=(g||[]).map(L=>L.id),T=(w||[]).map(L=>L.id),P=x().reduce((L,O)=>{const $=O.parentNode||O.parentId,D=!R.includes(O.id)&&$&&L.find(F=>F.id===$);return(typeof O.deletable=="boolean"?O.deletable:!0)&&(R.includes(O.id)||D)&&L.push(O),L},[]),z=b.filter(L=>typeof L.deletable=="boolean"?L.deletable:!0),C=z.filter(L=>T.includes(L.id));if(P||C){const L=MC(P,z),O=[...C,...L],$=O.reduce((D,A)=>(D.includes(A.id)||D.push(A.id),D),[]);if((S||_)&&(S&&t.setState({edges:b.filter(D=>!$.includes(D.id))}),_&&(P.forEach(D=>{v.delete(D.id)}),t.setState({nodeInternals:new Map(v)}))),$.length>0&&(N==null||N(O),j&&j($.map(D=>({id:D,type:"remove"})))),P.length>0&&(k==null||k(P),E)){const D=P.map(A=>({id:A.id,type:"remove"}));E(D)}}},[]),h=m.useCallback(g=>{const w=oO(g),v=w?null:t.getState().nodeInternals.get(g.id);return!w&&!v?[null,null,w]:[w?g:ub(v),v,w]},[]),p=m.useCallback((g,w=!0,v)=>{const[x,b,_]=h(g);return x?(v||t.getState().getNodes()).filter(S=>{if(!_&&(S.id===b.id||!S.positionAbsolute))return!1;const k=ub(S),N=bv(k,x);return w&&N>0||N>=x.width*x.height}):[]},[]),y=m.useCallback((g,w,v=!0)=>{const[x]=h(g);if(!x)return!1;const b=bv(x,w);return v&&b>0||b>=x.width*x.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:i,getEdge:s,setNodes:o,setEdges:l,addNodes:c,addEdges:u,toObject:d,deleteElements:f,getIntersectingNodes:p,isNodeIntersecting:y}),[e,r,n,i,s,o,l,c,u,d,f,p,y])}const $O={actInsideInputWithModifier:!1};var BO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=ht(),{deleteElements:n}=Uc(),i=ta(e,$O),s=ta(t);m.useEffect(()=>{if(i){const{edges:o,getNodes:l}=r.getState(),c=l().filter(d=>d.selected),u=o.filter(d=>d.selected);n({nodes:c,edges:u}),r.setState({nodesSelectionActive:!1})}},[i]),m.useEffect(()=>{r.setState({multiSelectionActive:s})},[s])};function HO(e){const t=ht();m.useEffect(()=>{let r;const n=()=>{var s,o;if(!e.current)return;const i=Bx(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",pn.error004())),t.setState({width:i.width||500,height:i.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const Xx={position:"absolute",width:"100%",height:"100%",top:0,left:0},WO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Za=e=>({x:e.x,y:e.y,zoom:e.k}),Li=(e,t)=>e.target.closest(`.${t}`),bb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),wb=e=>{const t=e.ctrlKey&&rc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},UO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),VO=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=pi.Free,zoomOnDoubleClick:u=!0,elementsSelectable:d,panOnDrag:f=!0,defaultViewport:h,translateExtent:p,minZoom:y,maxZoom:g,zoomActivationKeyCode:w,preventScrolling:v=!0,children:x,noWheelClassName:b,noPanClassName:_})=>{const S=m.useRef(),k=ht(),N=m.useRef(!1),E=m.useRef(!1),j=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:P,d3ZoomHandler:z,userSelectionActive:C}=Be(UO,St),L=ta(w),O=m.useRef(0),$=m.useRef(!1),D=m.useRef();return HO(j),m.useEffect(()=>{if(j.current){const A=j.current.getBoundingClientRect(),F=yC().scaleExtent([y,g]).translateExtent(p),M=ar(j.current).call(F),q=an.translate(h.x,h.y).scale(ks(h.zoom,y,g)),W=[[0,0],[A.width,A.height]],B=F.constrain()(q,W,p);F.transform(M,B),F.wheelDelta(wb),k.setState({d3Zoom:F,d3Selection:M,d3ZoomHandler:M.on("wheel.zoom"),transform:[B.x,B.y,B.k],domNode:j.current.closest(".react-flow")})}},[]),m.useEffect(()=>{P&&T&&(o&&!L&&!C?P.on("wheel.zoom",A=>{if(Li(A,b))return!1;A.preventDefault(),A.stopImmediatePropagation();const F=P.property("__zoom").k||1;if(A.ctrlKey&&s){const ne=wr(A),V=wb(A),ee=F*Math.pow(2,V);T.scaleTo(P,ee,ne,A);return}const M=A.deltaMode===1?20:1;let q=c===pi.Vertical?0:A.deltaX*M,W=c===pi.Horizontal?0:A.deltaY*M;!rc()&&A.shiftKey&&c!==pi.Vertical&&(q=A.deltaY*M,W=0),T.translateBy(P,-(q/F)*l,-(W/F)*l,{internal:!0});const B=Za(P.property("__zoom")),{onViewportChangeStart:K,onViewportChange:Z,onViewportChangeEnd:re}=k.getState();clearTimeout(D.current),$.current||($.current=!0,t==null||t(A,B),K==null||K(B)),$.current&&(e==null||e(A,B),Z==null||Z(B),D.current=setTimeout(()=>{r==null||r(A,B),re==null||re(B),$.current=!1},150))},{passive:!1}):typeof z<"u"&&P.on("wheel.zoom",function(A,F){if(!v&&A.type==="wheel"&&!A.ctrlKey||Li(A,b))return null;A.preventDefault(),z.call(this,A,F)},{passive:!1}))},[C,o,c,P,T,z,L,s,v,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",A=>{var q,W;if(!A.sourceEvent||A.sourceEvent.internal)return null;O.current=(q=A.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:F}=k.getState(),M=Za(A.transform);N.current=!0,R.current=M,((W=A.sourceEvent)==null?void 0:W.type)==="mousedown"&&k.setState({paneDragging:!0}),F==null||F(M),t==null||t(A.sourceEvent,M)})},[T,t]),m.useEffect(()=>{T&&(C&&!N.current?T.on("zoom",null):C||T.on("zoom",A=>{var M;const{onViewportChange:F}=k.getState();if(k.setState({transform:[A.transform.x,A.transform.y,A.transform.k]}),E.current=!!(n&&bb(f,O.current??0)),(e||F)&&!((M=A.sourceEvent)!=null&&M.internal)){const q=Za(A.transform);F==null||F(q),e==null||e(A.sourceEvent,q)}}))},[C,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",A=>{if(!A.sourceEvent||A.sourceEvent.internal)return null;const{onViewportChangeEnd:F}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),n&&bb(f,O.current??0)&&!E.current&&n(A.sourceEvent),E.current=!1,(r||F)&&WO(R.current,A.transform)){const M=Za(A.transform);R.current=M,clearTimeout(S.current),S.current=setTimeout(()=>{F==null||F(M),r==null||r(A.sourceEvent,M)},o?150:0)}})},[T,o,f,r,n]),m.useEffect(()=>{T&&T.filter(A=>{const F=L||i,M=s&&A.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&A.button===1&&A.type==="mousedown"&&(Li(A,"react-flow__node")||Li(A,"react-flow__edge")))return!0;if(!f&&!F&&!o&&!u&&!s||C||!u&&A.type==="dblclick"||Li(A,b)&&A.type==="wheel"||Li(A,_)&&(A.type!=="wheel"||o&&A.type==="wheel"&&!L)||!s&&A.ctrlKey&&A.type==="wheel"||!F&&!o&&!M&&A.type==="wheel"||!f&&(A.type==="mousedown"||A.type==="touchstart")||Array.isArray(f)&&!f.includes(A.button)&&A.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(A.button)||!A.button||A.button<=1;return(!A.ctrlKey||A.type==="wheel")&&q})},[C,T,i,s,o,u,f,d,L]),G.createElement("div",{className:"react-flow__renderer",ref:j,style:Xx},x)},GO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function KO(){const{userSelectionActive:e,userSelectionRect:t}=Be(GO,St);return e&&t?G.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function _b(e,t){const r=t.parentNode||t.parentId,n=e.find(i=>i.id===r);if(n){const i=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,i>0&&(n.style.width+=i),s>0&&(n.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);n.position.x=n.position.x-o,n.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);n.position.y=n.position.y-o,n.style.height+=o,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function XC(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,i)=>{const s=e.filter(l=>l.id===i.id);if(s.length===0)return n.push(i),n;const o={...i};for(const l of s)if(l)switch(l.type){case"select":{o.selected=l.selected;break}case"position":{typeof l.position<"u"&&(o.position=l.position),typeof l.positionAbsolute<"u"&&(o.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(o.dragging=l.dragging),o.expandParent&&_b(n,o);break}case"dimensions":{typeof l.dimensions<"u"&&(o.width=l.dimensions.width,o.height=l.dimensions.height),typeof l.updateStyle<"u"&&(o.style={...o.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(o.resizing=l.resizing),o.expandParent&&_b(n,o);break}case"remove":return n}return n.push(o),n},r)}function QC(e,t){return XC(e,t)}function YO(e,t){return XC(e,t)}const Nn=(e,t)=>({id:e,type:"select",selected:t});function rs(e,t){return e.reduce((r,n)=>{const i=t.includes(n.id);return!n.selected&&i?(n.selected=!0,r.push(Nn(n.id,!0))):n.selected&&!i&&(n.selected=!1,r.push(Nn(n.id,!1))),r},[])}const ed=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},XO=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),ZC=m.memo(({isSelecting:e,selectionMode:t=ea.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:d,children:f})=>{const h=m.useRef(null),p=ht(),y=m.useRef(0),g=m.useRef(0),w=m.useRef(),{userSelectionActive:v,elementsSelectable:x,dragging:b}=Be(XO,St),_=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,g.current=0},S=z=>{s==null||s(z),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},k=z=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){z.preventDefault();return}o==null||o(z)},N=l?z=>l(z):void 0,E=z=>{const{resetSelectedElements:C,domNode:L}=p.getState();if(w.current=L==null?void 0:L.getBoundingClientRect(),!x||!e||z.button!==0||z.target!==h.current||!w.current)return;const{x:O,y:$}=Wn(z,w.current);C(),p.setState({userSelectionRect:{width:0,height:0,startX:O,startY:$,x:O,y:$}}),n==null||n(z)},j=z=>{const{userSelectionRect:C,nodeInternals:L,edges:O,transform:$,onNodesChange:D,onEdgesChange:A,nodeOrigin:F,getNodes:M}=p.getState();if(!e||!w.current||!C)return;p.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Wn(z,w.current),W=C.startX??0,B=C.startY??0,K={...C,x:q.x<W?q.x:W,y:q.y<B?q.y:B,width:Math.abs(q.x-W),height:Math.abs(q.y-B)},Z=M(),re=IC(L,K,$,t===ea.Partial,!0,F),ne=MC(re,O).map(ee=>ee.id),V=re.map(ee=>ee.id);if(y.current!==V.length){y.current=V.length;const ee=rs(Z,V);ee.length&&(D==null||D(ee))}if(g.current!==ne.length){g.current=ne.length;const ee=rs(O,ne);ee.length&&(A==null||A(ee))}p.setState({userSelectionRect:K})},R=z=>{if(z.button!==0)return;const{userSelectionRect:C}=p.getState();!v&&C&&z.target===h.current&&(S==null||S(z)),p.setState({nodesSelectionActive:y.current>0}),_(),i==null||i(z)},T=z=>{v&&(p.setState({nodesSelectionActive:y.current>0}),i==null||i(z)),_()},P=x&&(e||v);return G.createElement("div",{className:Wt(["react-flow__pane",{dragging:b,selection:e}]),onClick:P?void 0:ed(S,h),onContextMenu:ed(k,h),onWheel:ed(N,h),onMouseEnter:P?void 0:c,onMouseDown:P?E:void 0,onMouseMove:P?j:u,onMouseUp:P?R:void 0,onMouseLeave:P?T:d,ref:h,style:Xx},f,G.createElement(KO,null))});ZC.displayName="Pane";function JC(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:JC(n,t):!1}function Sb(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function QO(e,t,r,n){return Array.from(e.values()).filter(i=>(i.selected||i.id===n)&&(!i.parentNode||i.parentId||!JC(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:r.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function ZO(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function eE(e,t,r,n,i=[0,0],s){const o=ZO(e,e.extent||n);let l=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:h,y:p}=xi(f,i).positionAbsolute;l=f&&cr(h)&&cr(p)&&cr(f.width)&&cr(f.height)?[[h+e.width*i[0],p+e.height*i[1]],[h+f.width-e.width+e.width*i[0],p+f.height-e.height+e.height*i[1]]]:l}else s==null||s("005",pn.error005()),l=o;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:h,y:p}=xi(f,i).positionAbsolute;l=[[e.extent[0][0]+h,e.extent[0][1]+p],[e.extent[1][0]+h,e.extent[1][1]+p]]}let u={x:0,y:0};if(c){const f=r.get(c);u=xi(f,i).positionAbsolute}const d=l&&l!=="parent"?Hx(t,l):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function td({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(i=>({...r.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?n.find(i=>i.id===e):n[0],n]}const jb=(e,t,r,n)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),l={x:o.width*n[0],y:o.height*n[1]};return s.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-o.left-l.x)/r,y:(u.top-o.top-l.y)/r,...Bx(c)}})};function Zs(e,t,r){return r===void 0?r:n=>{const i=t().nodeInternals.get(e);i&&r(n,{...i})}}function Nv({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:l,onError:c}=t.getState(),u=l.get(e);if(!u){c==null||c("012",pn.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&o)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=n==null?void 0:n.current)==null?void 0:d.blur()})):i([e])}function JO(){const e=ht();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:i,snapToGrid:s}=e.getState(),o=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(o-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function rd(e){return(t,r,n)=>e==null?void 0:e(t,n)}function tE({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const l=ht(),[c,u]=m.useState(!1),d=m.useRef([]),f=m.useRef({x:null,y:null}),h=m.useRef(0),p=m.useRef(null),y=m.useRef({x:0,y:0}),g=m.useRef(null),w=m.useRef(!1),v=m.useRef(!1),x=m.useRef(!1),b=JO();return m.useEffect(()=>{if(e!=null&&e.current){const _=ar(e.current),S=({x:E,y:j})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:P,updateNodePositions:z,nodeExtent:C,snapGrid:L,snapToGrid:O,nodeOrigin:$,onError:D}=l.getState();f.current={x:E,y:j};let A=!1,F={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&C){const q=Wc(d.current,$);F=Jo(q)}if(d.current=d.current.map(q=>{const W={x:E-q.distance.x,y:j-q.distance.y};O&&(W.x=L[0]*Math.round(W.x/L[0]),W.y=L[1]*Math.round(W.y/L[1]));const B=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];d.current.length>1&&C&&!q.extent&&(B[0][0]=q.positionAbsolute.x-F.x+C[0][0],B[1][0]=q.positionAbsolute.x+(q.width??0)-F.x2+C[1][0],B[0][1]=q.positionAbsolute.y-F.y+C[0][1],B[1][1]=q.positionAbsolute.y+(q.height??0)-F.y2+C[1][1]);const K=eE(q,W,R,B,$,D);return A=A||q.position.x!==K.position.x||q.position.y!==K.position.y,q.position=K.position,q.positionAbsolute=K.positionAbsolute,q}),!A)return;z(d.current,!0,!0),u(!0);const M=i?T:rd(P);if(M&&g.current){const[q,W]=td({nodeId:i,dragItems:d.current,nodeInternals:R});M(g.current,q,W)}},k=()=>{if(!p.current)return;const[E,j]=wC(y.current,p.current);if(E!==0||j!==0){const{transform:R,panBy:T}=l.getState();f.current.x=(f.current.x??0)-E/R[2],f.current.y=(f.current.y??0)-j/R[2],T({x:E,y:j})&&S(f.current)}h.current=requestAnimationFrame(k)},N=E=>{var $;const{nodeInternals:j,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:P,onNodeDragStart:z,onSelectionDragStart:C}=l.getState();v.current=!0;const L=i?z:rd(C);(!o||!s)&&!R&&i&&(($=j.get(i))!=null&&$.selected||P()),i&&s&&o&&Nv({id:i,store:l,nodeRef:e});const O=b(E);if(f.current=O,d.current=QO(j,T,O,i),L&&d.current){const[D,A]=td({nodeId:i,dragItems:d.current,nodeInternals:j});L(E.sourceEvent,D,A)}};if(t)_.on(".drag",null);else{const E=uM().on("start",j=>{const{domNode:R,nodeDragThreshold:T}=l.getState();T===0&&N(j),x.current=!1;const P=b(j);f.current=P,p.current=(R==null?void 0:R.getBoundingClientRect())||null,y.current=Wn(j.sourceEvent,p.current)}).on("drag",j=>{var z,C;const R=b(j),{autoPanOnNodeDrag:T,nodeDragThreshold:P}=l.getState();if(j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!w.current&&v.current&&T&&(w.current=!0,k()),!v.current){const L=R.xSnapped-(((z=f==null?void 0:f.current)==null?void 0:z.x)??0),O=R.ySnapped-(((C=f==null?void 0:f.current)==null?void 0:C.y)??0);Math.sqrt(L*L+O*O)>P&&N(j)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&d.current&&v.current&&(g.current=j.sourceEvent,y.current=Wn(j.sourceEvent,p.current),S(R))}}).on("end",j=>{if(!(!v.current||x.current)&&(u(!1),w.current=!1,v.current=!1,cancelAnimationFrame(h.current),d.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:P,onSelectionDragStop:z}=l.getState(),C=i?P:rd(z);if(R(d.current,!1,!1),C){const[L,O]=td({nodeId:i,dragItems:d.current,nodeInternals:T});C(j.sourceEvent,L,O)}}}).filter(j=>{const R=j.target;return!j.button&&(!r||!Sb(R,`.${r}`,e))&&(!n||Sb(R,n,e))});return _.call(E),()=>{_.on(".drag",null)}}}},[e,t,r,n,s,l,i,o,b]),c}function rE(){const e=ht();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:l,snapGrid:c,onError:u,nodesDraggable:d}=e.getState(),f=o().filter(x=>x.selected&&(x.draggable||d&&typeof x.draggable>"u")),h=l?c[0]:5,p=l?c[1]:5,y=r.isShiftPressed?4:1,g=r.x*h*y,w=r.y*p*y,v=f.map(x=>{if(x.positionAbsolute){const b={x:x.positionAbsolute.x+g,y:x.positionAbsolute.y+w};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:_,position:S}=eE(x,b,n,i,void 0,u);x.position=S,x.positionAbsolute=_}return x});s(v,!0,!1)},[])}const ps={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Js=e=>{const t=({id:r,type:n,data:i,xPos:s,yPos:o,xPosOrigin:l,yPosOrigin:c,selected:u,onClick:d,onMouseEnter:f,onMouseMove:h,onMouseLeave:p,onContextMenu:y,onDoubleClick:g,style:w,className:v,isDraggable:x,isSelectable:b,isConnectable:_,isFocusable:S,selectNodesOnDrag:k,sourcePosition:N,targetPosition:E,hidden:j,resizeObserver:R,dragHandle:T,zIndex:P,isParent:z,noDragClassName:C,noPanClassName:L,initialized:O,disableKeyboardA11y:$,ariaLabel:D,rfId:A,hasHandleBounds:F})=>{const M=ht(),q=m.useRef(null),W=m.useRef(null),B=m.useRef(N),K=m.useRef(E),Z=m.useRef(n),re=b||x||d||f||h||p,ne=rE(),V=Zs(r,M.getState,f),ee=Zs(r,M.getState,h),ve=Zs(r,M.getState,p),fe=Zs(r,M.getState,y),be=Zs(r,M.getState,g),ce=Y=>{const{nodeDragThreshold:X}=M.getState();if(b&&(!k||!x||X>0)&&Nv({id:r,store:M,nodeRef:q}),d){const ue=M.getState().nodeInternals.get(r);ue&&d(Y,{...ue})}},te=Y=>{if(!wv(Y)&&!$)if(kC.includes(Y.key)&&b){const X=Y.key==="Escape";Nv({id:r,store:M,unselect:X,nodeRef:q})}else x&&u&&Object.prototype.hasOwnProperty.call(ps,Y.key)&&(M.setState({ariaLiveMessage:`Moved selected node ${Y.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),ne({x:ps[Y.key].x,y:ps[Y.key].y,isShiftPressed:Y.shiftKey}))};m.useEffect(()=>()=>{W.current&&(R==null||R.unobserve(W.current),W.current=null)},[]),m.useEffect(()=>{if(q.current&&!j){const Y=q.current;(!O||!F||W.current!==Y)&&(W.current&&(R==null||R.unobserve(W.current)),R==null||R.observe(Y),W.current=Y)}},[j,O,F]),m.useEffect(()=>{const Y=Z.current!==n,X=B.current!==N,ue=K.current!==E;q.current&&(Y||X||ue)&&(Y&&(Z.current=n),X&&(B.current=N),ue&&(K.current=E),M.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,n,N,E]);const we=tE({nodeRef:q,disabled:j||!x,noDragClassName:C,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:k});return j?null:G.createElement("div",{className:Wt(["react-flow__node",`react-flow__node-${n}`,{[L]:x},v,{selected:u,selectable:b,parent:z,dragging:we}]),ref:q,style:{zIndex:P,transform:`translate(${l}px,${c}px)`,pointerEvents:re?"all":"none",visibility:O?"visible":"hidden",...w},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:V,onMouseMove:ee,onMouseLeave:ve,onContextMenu:fe,onClick:ce,onDoubleClick:be,onKeyDown:S?te:void 0,tabIndex:S?0:void 0,role:S?"button":void 0,"aria-describedby":$?void 0:`${UC}-${A}`,"aria-label":D},G.createElement(pO,{value:r},G.createElement(e,{id:r,data:i,type:n,xPos:s,yPos:o,selected:u,isConnectable:_,sourcePosition:N,targetPosition:E,dragging:we,dragHandle:T,zIndex:P})))};return t.displayName="NodeWrapper",m.memo(t)};const eD=e=>{const t=e.getNodes().filter(r=>r.selected);return{...Wc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function tD({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=ht(),{width:i,height:s,x:o,y:l,transformString:c,userSelectionActive:u}=Be(eD,St),d=rE(),f=m.useRef(null);if(m.useEffect(()=>{var y;r||(y=f.current)==null||y.focus({preventScroll:!0})},[r]),tE({nodeRef:f}),u||!i||!s)return null;const h=e?y=>{const g=n.getState().getNodes().filter(w=>w.selected);e(y,g)}:void 0,p=y=>{Object.prototype.hasOwnProperty.call(ps,y.key)&&d({x:ps[y.key].x,y:ps[y.key].y,isShiftPressed:y.shiftKey})};return G.createElement("div",{className:Wt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},G.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:r?void 0:-1,onKeyDown:r?void 0:p,style:{width:i,height:s,top:l,left:o}}))}var rD=m.memo(tD);const nD=e=>e.nodesSelectionActive,nE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:l,onMove:c,onMoveStart:u,onMoveEnd:d,selectionKeyCode:f,selectionOnDrag:h,selectionMode:p,onSelectionStart:y,onSelectionEnd:g,multiSelectionKeyCode:w,panActivationKeyCode:v,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:S,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:j,panOnDrag:R,defaultViewport:T,translateExtent:P,minZoom:z,maxZoom:C,preventScrolling:L,onSelectionContextMenu:O,noWheelClassName:$,noPanClassName:D,disableKeyboardA11y:A})=>{const F=Be(nD),M=ta(f),q=ta(v),W=q||R,B=q||k,K=M||h&&W!==!0;return BO({deleteKeyCode:l,multiSelectionKeyCode:w}),G.createElement(VO,{onMove:c,onMoveStart:u,onMoveEnd:d,onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:S,panOnScroll:B,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:j,panOnDrag:!M&&W,defaultViewport:T,translateExtent:P,minZoom:z,maxZoom:C,zoomActivationKeyCode:x,preventScrolling:L,noWheelClassName:$,noPanClassName:D},G.createElement(ZC,{onSelectionStart:y,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:W,isSelecting:!!K,selectionMode:p},e,F&&G.createElement(rD,{onSelectionContextMenu:O,noPanClassName:D,disableKeyboardA11y:A})))};nE.displayName="FlowRenderer";var iD=m.memo(nE);function sD(e){return Be(m.useCallback(r=>e?IC(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function oD(e){const t={input:Js(e.input||$C),default:Js(e.default||kv),output:Js(e.output||HC),group:Js(e.group||Yx)},r={},n=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=Js(e[s]||kv),i),r);return{...t,...n}}const aD=({x:e,y:t,width:r,height:n,origin:i})=>!r||!n?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-r*i[0],y:t-n*i[1]},lD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),iE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Be(lD,St),l=sD(e.onlyRenderVisibleElements),c=m.useRef(),u=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(f=>{const h=f.map(p=>({id:p.target.getAttribute("data-id"),nodeElement:p.target,forceUpdate:!0}));s(h)});return c.current=d,d},[]);return m.useEffect(()=>()=>{var d;(d=c==null?void 0:c.current)==null||d.disconnect()},[]),G.createElement("div",{className:"react-flow__nodes",style:Xx},l.map(d=>{var S,k,N;let f=d.type||"default";e.nodeTypes[f]||(o==null||o("003",pn.error003(f)),f="default");const h=e.nodeTypes[f]||e.nodeTypes.default,p=!!(d.draggable||t&&typeof d.draggable>"u"),y=!!(d.selectable||i&&typeof d.selectable>"u"),g=!!(d.connectable||r&&typeof d.connectable>"u"),w=!!(d.focusable||n&&typeof d.focusable>"u"),v=e.nodeExtent?Hx(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,x=(v==null?void 0:v.x)??0,b=(v==null?void 0:v.y)??0,_=aD({x,y:b,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return G.createElement(h,{key:d.id,id:d.id,className:d.className,style:d.style,type:f,data:d.data,sourcePosition:d.sourcePosition||oe.Bottom,targetPosition:d.targetPosition||oe.Top,hidden:d.hidden,xPos:x,yPos:b,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:p,isSelectable:y,isConnectable:g,isFocusable:w,resizeObserver:u,dragHandle:d.dragHandle,zIndex:((S=d[Ze])==null?void 0:S.z)??0,isParent:!!((k=d[Ze])!=null&&k.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((N=d[Ze])!=null&&N.handleBounds)})}))};iE.displayName="NodeRenderer";var cD=m.memo(iE);const uD=(e,t,r)=>r===oe.Left?e-t:r===oe.Right?e+t:e,dD=(e,t,r)=>r===oe.Top?e-t:r===oe.Bottom?e+t:e,kb="react-flow__edgeupdater",Nb=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:l})=>G.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Wt([kb,`${kb}-${l}`]),cx:uD(t,n,e),cy:dD(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),fD=()=>!0;var Fi=e=>{const t=({id:r,className:n,type:i,data:s,onClick:o,onEdgeDoubleClick:l,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:g,style:w,source:v,target:x,sourceX:b,sourceY:_,targetX:S,targetY:k,sourcePosition:N,targetPosition:E,elementsSelectable:j,hidden:R,sourceHandleId:T,targetHandleId:P,onContextMenu:z,onMouseEnter:C,onMouseMove:L,onMouseLeave:O,reconnectRadius:$,onReconnect:D,onReconnectStart:A,onReconnectEnd:F,markerEnd:M,markerStart:q,rfId:W,ariaLabel:B,isFocusable:K,isReconnectable:Z,pathOptions:re,interactionWidth:ne,disableKeyboardA11y:V})=>{const ee=m.useRef(null),[ve,fe]=m.useState(!1),[be,ce]=m.useState(!1),te=ht(),we=m.useMemo(()=>`url('#${Sv(q,W)}')`,[q,W]),Y=m.useMemo(()=>`url('#${Sv(M,W)}')`,[M,W]);if(R)return null;const X=H=>{var Pt;const{edges:U,addSelectedEdges:se,unselectNodesAndEdges:Oe,multiSelectionActive:kt}=te.getState(),Mt=U.find(Ar=>Ar.id===r);Mt&&(j&&(te.setState({nodesSelectionActive:!1}),Mt.selected&&kt?(Oe({nodes:[],edges:[Mt]}),(Pt=ee.current)==null||Pt.blur()):se([r])),o&&o(H,Mt))},ue=Qs(r,te.getState,l),he=Qs(r,te.getState,z),_e=Qs(r,te.getState,C),ge=Qs(r,te.getState,L),Q=Qs(r,te.getState,O),pe=(H,U)=>{if(H.button!==0)return;const{edges:se,isValidConnection:Oe}=te.getState(),kt=U?x:v,Mt=(U?P:T)||null,Pt=U?"target":"source",Ar=Oe||fD,de=U,ae=se.find(Je=>Je.id===r);ce(!0),A==null||A(H,ae,Pt);const it=Je=>{ce(!1),F==null||F(Je,ae,Pt)};LC({event:H,handleId:Mt,nodeId:kt,onConnect:Je=>D==null?void 0:D(ae,Je),isTarget:de,getState:te.getState,setState:te.setState,isValidConnection:Ar,edgeUpdaterType:Pt,onReconnectEnd:it})},We=H=>pe(H,!0),Re=H=>pe(H,!1),Le=()=>fe(!0),Pe=()=>fe(!1),Ue=!j&&!o,I=H=>{var U;if(!V&&kC.includes(H.key)&&j){const{unselectNodesAndEdges:se,addSelectedEdges:Oe,edges:kt}=te.getState();H.key==="Escape"?((U=ee.current)==null||U.blur(),se({edges:[kt.find(Pt=>Pt.id===r)]})):Oe([r])}};return G.createElement("g",{className:Wt(["react-flow__edge",`react-flow__edge-${i}`,n,{selected:c,animated:u,inactive:Ue,updating:ve}]),onClick:X,onDoubleClick:ue,onContextMenu:he,onMouseEnter:_e,onMouseMove:ge,onMouseLeave:Q,onKeyDown:K?I:void 0,tabIndex:K?0:void 0,role:K?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":B===null?void 0:B||`Edge from ${v} to ${x}`,"aria-describedby":K?`${VC}-${W}`:void 0,ref:ee},!be&&G.createElement(e,{id:r,source:v,target:x,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:g,data:s,style:w,sourceX:b,sourceY:_,targetX:S,targetY:k,sourcePosition:N,targetPosition:E,sourceHandleId:T,targetHandleId:P,markerStart:we,markerEnd:Y,pathOptions:re,interactionWidth:ne}),Z&&G.createElement(G.Fragment,null,(Z==="source"||Z===!0)&&G.createElement(Nb,{position:N,centerX:b,centerY:_,radius:$,onMouseDown:We,onMouseEnter:Le,onMouseOut:Pe,type:"source"}),(Z==="target"||Z===!0)&&G.createElement(Nb,{position:E,centerX:S,centerY:k,radius:$,onMouseDown:Re,onMouseEnter:Le,onMouseOut:Pe,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function pD(e){const t={default:Fi(e.default||ic),straight:Fi(e.bezier||Vx),step:Fi(e.step||Ux),smoothstep:Fi(e.step||Hc),simplebezier:Fi(e.simplebezier||Wx)},r={},n=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Fi(e[s]||ic),i),r);return{...t,...n}}function Cb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,i=((r==null?void 0:r.y)||0)+t.y,s=(r==null?void 0:r.width)||t.width,o=(r==null?void 0:r.height)||t.height;switch(e){case oe.Top:return{x:n+s/2,y:i};case oe.Right:return{x:n+s,y:i+o/2};case oe.Bottom:return{x:n+s/2,y:i+o};case oe.Left:return{x:n,y:i+o/2}}}function Eb(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const hD=(e,t,r,n,i,s)=>{const o=Cb(r,e,t),l=Cb(s,n,i);return{sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y}};function mD({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:i,targetHeight:s,width:o,height:l,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+i),y2:Math.max(e.y+n,t.y+s)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=Jo({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:l/c[2]}),f=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),h=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(f*h)>0}function Tb(e){var n,i,s,o,l;const t=((n=e==null?void 0:e[Ze])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const gD=[{level:0,isMaxLevel:!0,edges:[]}];function vD(e,t,r=!1){let n=-1;const i=e.reduce((o,l)=>{var d,f;const c=cr(l.zIndex);let u=c?l.zIndex:0;if(r){const h=t.get(l.target),p=t.get(l.source),y=l.selected||(h==null?void 0:h.selected)||(p==null?void 0:p.selected),g=Math.max(((d=p==null?void 0:p[Ze])==null?void 0:d.z)||0,((f=h==null?void 0:h[Ze])==null?void 0:f.z)||0,1e3);u=(c?l.zIndex:0)+(y?g:0)}return o[u]?o[u].push(l):o[u]=[l],n=u>n?u:n,o},{}),s=Object.entries(i).map(([o,l])=>{const c=+o;return{edges:l,level:c,isMaxLevel:c===n}});return s.length===0?gD:s}function xD(e,t,r){const n=Be(m.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),l=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&mD({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:l.width,targetHeight:l.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return vD(n,t,r)}const yD=({color:e="none",strokeWidth:t=1})=>G.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),bD=({color:e="none",strokeWidth:t=1})=>G.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Rb={[nc.Arrow]:yD,[nc.ArrowClosed]:bD};function wD(e){const t=ht();return m.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Rb,e)?Rb[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",pn.error009(e)),null)},[e])}const _D=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const c=wD(t);return c?G.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0"},G.createElement(c,{color:r,strokeWidth:o})):null},SD=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const l=Sv(o,t);n.includes(l)||(i.push({id:l,color:o.color||e,...o}),n.push(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},sE=({defaultColor:e,rfId:t})=>{const r=Be(m.useCallback(SD({defaultColor:e,rfId:t}),[e,t]),(n,i)=>!(n.length!==i.length||n.some((s,o)=>s.id!==i[o].id)));return G.createElement("defs",null,r.map(n=>G.createElement(_D,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};sE.displayName="MarkerDefinitions";var jD=m.memo(sE);const kD=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),oE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:g,children:w,disableKeyboardA11y:v})=>{const{edgesFocusable:x,edgesUpdatable:b,elementsSelectable:_,width:S,height:k,connectionMode:N,nodeInternals:E,onError:j}=Be(kD,St),R=xD(t,E,r);return S?G.createElement(G.Fragment,null,R.map(({level:T,edges:P,isMaxLevel:z})=>G.createElement("svg",{key:T,style:{zIndex:T},width:S,height:k,className:"react-flow__edges react-flow__container"},z&&G.createElement(jD,{defaultColor:e,rfId:n}),G.createElement("g",null,P.map(C=>{const[L,O,$]=Tb(E.get(C.source)),[D,A,F]=Tb(E.get(C.target));if(!$||!F)return null;let M=C.type||"default";i[M]||(j==null||j("011",pn.error011(M)),M="default");const q=i[M]||i.default,W=N===Ni.Strict?A.target:(A.target??[]).concat(A.source??[]),B=Eb(O.source,C.sourceHandle),K=Eb(W,C.targetHandle),Z=(B==null?void 0:B.position)||oe.Bottom,re=(K==null?void 0:K.position)||oe.Top,ne=!!(C.focusable||x&&typeof C.focusable>"u"),V=C.reconnectable||C.updatable,ee=typeof h<"u"&&(V||b&&typeof V>"u");if(!B||!K)return j==null||j("008",pn.error008(B,C)),null;const{sourceX:ve,sourceY:fe,targetX:be,targetY:ce}=hD(L,B,Z,D,K,re);return G.createElement(q,{key:C.id,id:C.id,className:Wt([C.className,s]),type:M,data:C.data,selected:!!C.selected,animated:!!C.animated,hidden:!!C.hidden,label:C.label,labelStyle:C.labelStyle,labelShowBg:C.labelShowBg,labelBgStyle:C.labelBgStyle,labelBgPadding:C.labelBgPadding,labelBgBorderRadius:C.labelBgBorderRadius,style:C.style,source:C.source,target:C.target,sourceHandleId:C.sourceHandle,targetHandleId:C.targetHandle,markerEnd:C.markerEnd,markerStart:C.markerStart,sourceX:ve,sourceY:fe,targetX:be,targetY:ce,sourcePosition:Z,targetPosition:re,elementsSelectable:_,onContextMenu:o,onMouseEnter:l,onMouseMove:c,onMouseLeave:u,onClick:d,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:g,rfId:n,ariaLabel:C.ariaLabel,isFocusable:ne,isReconnectable:ee,pathOptions:"pathOptions"in C?C.pathOptions:void 0,interactionWidth:C.interactionWidth,disableKeyboardA11y:v})})))),w):null};oE.displayName="EdgeRenderer";var ND=m.memo(oE);const CD=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ED({children:e}){const t=Be(CD);return G.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function TD(e){const t=Uc(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const RD={[oe.Left]:oe.Right,[oe.Right]:oe.Left,[oe.Top]:oe.Bottom,[oe.Bottom]:oe.Top},aE=({nodeId:e,handleType:t,style:r,type:n=Rn.Bezier,CustomComponent:i,connectionStatus:s})=>{var k,N,E;const{fromNode:o,handleId:l,toX:c,toY:u,connectionMode:d}=Be(m.useCallback(j=>({fromNode:j.nodeInternals.get(e),handleId:j.connectionHandleId,toX:(j.connectionPosition.x-j.transform[0])/j.transform[2],toY:(j.connectionPosition.y-j.transform[1])/j.transform[2],connectionMode:j.connectionMode}),[e]),St),f=(k=o==null?void 0:o[Ze])==null?void 0:k.handleBounds;let h=f==null?void 0:f[t];if(d===Ni.Loose&&(h=h||(f==null?void 0:f[t==="source"?"target":"source"])),!o||!h)return null;const p=l?h.find(j=>j.id===l):h[0],y=p?p.x+p.width/2:(o.width??0)/2,g=p?p.y+p.height/2:o.height??0,w=(((N=o.positionAbsolute)==null?void 0:N.x)??0)+y,v=(((E=o.positionAbsolute)==null?void 0:E.y)??0)+g,x=p==null?void 0:p.position,b=x?RD[x]:null;if(!x||!b)return null;if(i)return G.createElement(i,{connectionLineType:n,connectionLineStyle:r,fromNode:o,fromHandle:p,fromX:w,fromY:v,toX:c,toY:u,fromPosition:x,toPosition:b,connectionStatus:s});let _="";const S={sourceX:w,sourceY:v,sourcePosition:x,targetX:c,targetY:u,targetPosition:b};return n===Rn.Bezier?[_]=RC(S):n===Rn.Step?[_]=_v({...S,borderRadius:0}):n===Rn.SmoothStep?[_]=_v(S):n===Rn.SimpleBezier?[_]=TC(S):_=`M${w},${v} ${c},${u}`,G.createElement("path",{d:_,fill:"none",className:"react-flow__connection-path",style:r})};aE.displayName="ConnectionLine";const AD=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function ID({containerStyle:e,style:t,type:r,component:n}){const{nodeId:i,handleType:s,nodesConnectable:o,width:l,height:c,connectionStatus:u}=Be(AD,St);return!(i&&s&&l&&o)?null:G.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},G.createElement("g",{className:Wt(["react-flow__connection",u])},G.createElement(aE,{nodeId:i,handleType:s,style:t,type:r,CustomComponent:n,connectionStatus:u})))}function Ab(e,t){return m.useRef(null),ht(),m.useMemo(()=>t(e),[e])}const lE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,onSelectionContextMenu:y,onSelectionStart:g,onSelectionEnd:w,connectionLineType:v,connectionLineStyle:x,connectionLineComponent:b,connectionLineContainerStyle:_,selectionKeyCode:S,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:P,elementsSelectable:z,selectNodesOnDrag:C,defaultViewport:L,translateExtent:O,minZoom:$,maxZoom:D,preventScrolling:A,defaultMarkerColor:F,zoomOnScroll:M,zoomOnPinch:q,panOnScroll:W,panOnScrollSpeed:B,panOnScrollMode:K,zoomOnDoubleClick:Z,panOnDrag:re,onPaneClick:ne,onPaneMouseEnter:V,onPaneMouseMove:ee,onPaneMouseLeave:ve,onPaneScroll:fe,onPaneContextMenu:be,onEdgeContextMenu:ce,onEdgeMouseEnter:te,onEdgeMouseMove:we,onEdgeMouseLeave:Y,onReconnect:X,onReconnectStart:ue,onReconnectEnd:he,reconnectRadius:_e,noDragClassName:ge,noWheelClassName:Q,noPanClassName:pe,elevateEdgesOnSelect:We,disableKeyboardA11y:Re,nodeOrigin:Le,nodeExtent:Pe,rfId:Ue})=>{const I=Ab(e,oD),H=Ab(t,pD);return TD(s),G.createElement(iD,{onPaneClick:ne,onPaneMouseEnter:V,onPaneMouseMove:ee,onPaneMouseLeave:ve,onPaneContextMenu:be,onPaneScroll:fe,deleteKeyCode:T,selectionKeyCode:S,selectionOnDrag:k,selectionMode:N,onSelectionStart:g,onSelectionEnd:w,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:R,elementsSelectable:z,onMove:r,onMoveStart:n,onMoveEnd:i,zoomOnScroll:M,zoomOnPinch:q,zoomOnDoubleClick:Z,panOnScroll:W,panOnScrollSpeed:B,panOnScrollMode:K,panOnDrag:re,defaultViewport:L,translateExtent:O,minZoom:$,maxZoom:D,onSelectionContextMenu:y,preventScrolling:A,noDragClassName:ge,noWheelClassName:Q,noPanClassName:pe,disableKeyboardA11y:Re},G.createElement(ED,null,G.createElement(ND,{edgeTypes:H,onEdgeClick:l,onEdgeDoubleClick:u,onlyRenderVisibleElements:P,onEdgeContextMenu:ce,onEdgeMouseEnter:te,onEdgeMouseMove:we,onEdgeMouseLeave:Y,onReconnect:X,onReconnectStart:ue,onReconnectEnd:he,reconnectRadius:_e,defaultMarkerColor:F,noPanClassName:pe,elevateEdgesOnSelect:!!We,disableKeyboardA11y:Re,rfId:Ue},G.createElement(ID,{style:x,type:v,component:b,containerStyle:_})),G.createElement("div",{className:"react-flow__edgelabel-renderer"}),G.createElement(cD,{nodeTypes:I,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,selectNodesOnDrag:C,onlyRenderVisibleElements:P,noPanClassName:pe,noDragClassName:ge,disableKeyboardA11y:Re,nodeOrigin:Le,nodeExtent:Pe,rfId:Ue})))};lE.displayName="GraphView";var MD=m.memo(lE);const Cv=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Cv,nodeExtent:Cv,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ni.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:aO,isValidConnection:void 0},PD=()=>_3((e,t)=>({...wn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:Ju(r,n,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(i=>({...n,...i}))})},setDefaultNodesAndEdges:(r,n)=>{const i=typeof r<"u",s=typeof n<"u",o=i?Ju(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?n:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:l,domNode:c,nodeOrigin:u}=t(),d=c==null?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const f=window.getComputedStyle(d),{m22:h}=new window.DOMMatrixReadOnly(f.transform),p=r.reduce((g,w)=>{const v=i.get(w.id);if(v!=null&&v.hidden)i.set(v.id,{...v,[Ze]:{...v[Ze],handleBounds:void 0}});else if(v){const x=Bx(w.nodeElement);!!(x.width&&x.height&&(v.width!==x.width||v.height!==x.height||w.forceUpdate))&&(i.set(v.id,{...v,[Ze]:{...v[Ze],handleBounds:{source:jb(".source",w.nodeElement,h,u),target:jb(".target",w.nodeElement,h,u)}},...x}),g.push({id:v.id,type:"dimensions",dimensions:x}))}return g},[]);KC(i,u);const y=o||s&&!o&&YC(t,{initial:!0,...l});e({nodeInternals:new Map(i),fitViewOnInitDone:y}),(p==null?void 0:p.length)>0&&(n==null||n(p))},updateNodePositions:(r,n=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=r.map(l=>{const c={id:l.id,type:"position",dragging:i};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});s(o)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(s){const u=QC(r,l()),d=Ju(u,i,o,c);e({nodeInternals:d})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Nn(c,!0)):(o=rs(s(),r),l=rs(i,[])),Qa({changedNodes:o,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Nn(c,!0)):(o=rs(i,r),l=rs(s(),[])),Qa({changedNodes:l,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:i,getNodes:s}=t(),o=r||s(),l=n||i,c=o.map(d=>(d.selected=!1,Nn(d.id,!1))),u=l.map(d=>Nn(d.id,!1));Qa({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:i}=t();n==null||n.scaleExtent([r,i]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:i}=t();n==null||n.scaleExtent([i,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),s=n().filter(l=>l.selected).map(l=>Nn(l.id,!1)),o=r.filter(l=>l.selected).map(l=>Nn(l.id,!1));Qa({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(i=>{i.positionAbsolute=Hx(i.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:i,height:s,d3Zoom:o,d3Selection:l,translateExtent:c}=t();if(!o||!l||!r.x&&!r.y)return!1;const u=an.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),d=[[0,0],[i,s]],f=o==null?void 0:o.constrain()(u,d,c);return o.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wn.connectionNodeId,connectionHandleId:wn.connectionHandleId,connectionHandleType:wn.connectionHandleType,connectionStatus:wn.connectionStatus,connectionStartHandle:wn.connectionStartHandle,connectionEndHandle:wn.connectionEndHandle}),reset:()=>e({...wn})}),Object.is),Vc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=PD()),G.createElement(eO,{value:t.current},e)};Vc.displayName="ReactFlowProvider";const cE=({children:e})=>m.useContext(Bc)?G.createElement(G.Fragment,null,e):G.createElement(Vc,null,e);cE.displayName="ReactFlowWrapper";const OD={input:$C,default:kv,output:HC,group:Yx},DD={default:ic,straight:Vx,step:Ux,smoothstep:Hc,simplebezier:Wx},LD=[0,0],FD=[15,15],zD={x:0,y:0,zoom:1},qD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Qx=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:s=OD,edgeTypes:o=DD,onNodeClick:l,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:h,onConnect:p,onConnectStart:y,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:S,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:j,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:P,onSelectionDragStart:z,onSelectionDrag:C,onSelectionDragStop:L,onSelectionContextMenu:O,onSelectionStart:$,onSelectionEnd:D,connectionMode:A=Ni.Strict,connectionLineType:F=Rn.Bezier,connectionLineStyle:M,connectionLineComponent:q,connectionLineContainerStyle:W,deleteKeyCode:B="Backspace",selectionKeyCode:K="Shift",selectionOnDrag:Z=!1,selectionMode:re=ea.Full,panActivationKeyCode:ne="Space",multiSelectionKeyCode:V=rc()?"Meta":"Control",zoomActivationKeyCode:ee=rc()?"Meta":"Control",snapToGrid:ve=!1,snapGrid:fe=FD,onlyRenderVisibleElements:be=!1,selectNodesOnDrag:ce=!0,nodesDraggable:te,nodesConnectable:we,nodesFocusable:Y,nodeOrigin:X=LD,edgesFocusable:ue,edgesUpdatable:he,elementsSelectable:_e,defaultViewport:ge=zD,minZoom:Q=.5,maxZoom:pe=2,translateExtent:We=Cv,preventScrolling:Re=!0,nodeExtent:Le,defaultMarkerColor:Pe="#b1b1b7",zoomOnScroll:Ue=!0,zoomOnPinch:I=!0,panOnScroll:H=!1,panOnScrollSpeed:U=.5,panOnScrollMode:se=pi.Free,zoomOnDoubleClick:Oe=!0,panOnDrag:kt=!0,onPaneClick:Mt,onPaneMouseEnter:Pt,onPaneMouseMove:Ar,onPaneMouseLeave:de,onPaneScroll:ae,onPaneContextMenu:it,children:Ve,onEdgeContextMenu:Je,onEdgeDoubleClick:Nt,onEdgeMouseEnter:Ir,onEdgeMouseMove:Ot,onEdgeMouseLeave:Ct,onEdgeUpdate:tr,onEdgeUpdateStart:yn,onEdgeUpdateEnd:st,onReconnect:Mr,onReconnectStart:rr,onReconnectEnd:mr,reconnectRadius:ti=10,edgeUpdaterRadius:ri=10,onNodesChange:Pr,onEdgesChange:ni,noDragClassName:qs="nodrag",noWheelClassName:lR="nowheel",noPanClassName:Ay="nopan",fitView:cR=!1,fitViewOptions:uR,connectOnClick:dR=!0,attributionPosition:fR,proOptions:pR,defaultEdgeOptions:hR,elevateNodesOnSelect:mR=!0,elevateEdgesOnSelect:gR=!1,disableKeyboardA11y:Iy=!1,autoPanOnConnect:vR=!0,autoPanOnNodeDrag:xR=!0,connectionRadius:yR=20,isValidConnection:bR,onError:wR,style:_R,id:My,nodeDragThreshold:SR,...jR},kR)=>{const bu=My||"1";return G.createElement("div",{...jR,style:{..._R,...qD},ref:kR,className:Wt(["react-flow",i]),"data-testid":"rf__wrapper",id:My},G.createElement(cE,null,G.createElement(MD,{onInit:u,onMove:d,onMoveStart:f,onMoveEnd:h,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:S,onNodeDoubleClick:k,nodeTypes:s,edgeTypes:o,connectionLineType:F,connectionLineStyle:M,connectionLineComponent:q,connectionLineContainerStyle:W,selectionKeyCode:K,selectionOnDrag:Z,selectionMode:re,deleteKeyCode:B,multiSelectionKeyCode:V,panActivationKeyCode:ne,zoomActivationKeyCode:ee,onlyRenderVisibleElements:be,selectNodesOnDrag:ce,defaultViewport:ge,translateExtent:We,minZoom:Q,maxZoom:pe,preventScrolling:Re,zoomOnScroll:Ue,zoomOnPinch:I,zoomOnDoubleClick:Oe,panOnScroll:H,panOnScrollSpeed:U,panOnScrollMode:se,panOnDrag:kt,onPaneClick:Mt,onPaneMouseEnter:Pt,onPaneMouseMove:Ar,onPaneMouseLeave:de,onPaneScroll:ae,onPaneContextMenu:it,onSelectionContextMenu:O,onSelectionStart:$,onSelectionEnd:D,onEdgeContextMenu:Je,onEdgeDoubleClick:Nt,onEdgeMouseEnter:Ir,onEdgeMouseMove:Ot,onEdgeMouseLeave:Ct,onReconnect:Mr??tr,onReconnectStart:rr??yn,onReconnectEnd:mr??st,reconnectRadius:ti??ri,defaultMarkerColor:Pe,noDragClassName:qs,noWheelClassName:lR,noPanClassName:Ay,elevateEdgesOnSelect:gR,rfId:bu,disableKeyboardA11y:Iy,nodeOrigin:X,nodeExtent:Le}),G.createElement(RO,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:p,onConnectStart:y,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,nodesDraggable:te,nodesConnectable:we,nodesFocusable:Y,edgesFocusable:ue,edgesUpdatable:he,elementsSelectable:_e,elevateNodesOnSelect:mR,minZoom:Q,maxZoom:pe,nodeExtent:Le,onNodesChange:Pr,onEdgesChange:ni,snapToGrid:ve,snapGrid:fe,connectionMode:A,translateExtent:We,connectOnClick:dR,defaultEdgeOptions:hR,fitView:cR,fitViewOptions:uR,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:j,onSelectionDrag:C,onSelectionDragStart:z,onSelectionDragStop:L,noPanClassName:Ay,nodeOrigin:X,rfId:bu,autoPanOnConnect:vR,autoPanOnNodeDrag:xR,onError:wR,connectionRadius:yR,isValidConnection:bR,nodeDragThreshold:SR}),G.createElement(EO,{onSelectionChange:P}),Ve,G.createElement(rO,{proOptions:pR,position:fR}),G.createElement(OO,{rfId:bu,disableKeyboardA11y:Iy})))});Qx.displayName="ReactFlow";function uE(e){return t=>{const[r,n]=m.useState(t),i=m.useCallback(s=>n(o=>e(s,o)),[]);return[r,n,i]}}const dE=uE(QC),fE=uE(YO),pE=({id:e,x:t,y:r,width:n,height:i,style:s,color:o,strokeColor:l,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,onClick:h,selected:p})=>{const{background:y,backgroundColor:g}=s||{},w=o||y||g;return G.createElement("rect",{className:Wt(["react-flow__minimap-node",{selected:p},u]),x:t,y:r,rx:d,ry:d,width:n,height:i,fill:w,stroke:l,strokeWidth:c,shapeRendering:f,onClick:h?v=>h(v,e):void 0})};pE.displayName="MiniMapNode";var $D=m.memo(pE);const BD=e=>e.nodeOrigin,HD=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),nd=e=>e instanceof Function?e:()=>e;function WD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i=2,nodeComponent:s=$D,onClick:o}){const l=Be(HD,St),c=Be(BD),u=nd(t),d=nd(e),f=nd(r),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return G.createElement(G.Fragment,null,l.map(p=>{const{x:y,y:g}=xi(p,c).positionAbsolute;return G.createElement(s,{key:p.id,x:y,y:g,width:p.width,height:p.height,style:p.style,selected:p.selected,className:f(p),color:u(p),borderRadius:n,strokeColor:d(p),strokeWidth:i,shapeRendering:h,onClick:o,id:p.id})}))}var UD=m.memo(WD);const VD=200,GD=150,KD=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?sO(Wc(t,e.nodeOrigin),r):r,rfId:e.rfId}},YD="react-flow__minimap-desc";function hE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:d=1,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:y=!1,zoomable:g=!1,ariaLabel:w="React Flow mini map",inversePan:v=!1,zoomStep:x=10,offsetScale:b=5}){const _=ht(),S=m.useRef(null),{boundingRect:k,viewBB:N,rfId:E}=Be(KD,St),j=(e==null?void 0:e.width)??VD,R=(e==null?void 0:e.height)??GD,T=k.width/j,P=k.height/R,z=Math.max(T,P),C=z*j,L=z*R,O=b*z,$=k.x-(C-k.width)/2-O,D=k.y-(L-k.height)/2-O,A=C+O*2,F=L+O*2,M=`${YD}-${E}`,q=m.useRef(0);q.current=z,m.useEffect(()=>{if(S.current){const K=ar(S.current),Z=V=>{const{transform:ee,d3Selection:ve,d3Zoom:fe}=_.getState();if(V.sourceEvent.type!=="wheel"||!ve||!fe)return;const be=-V.sourceEvent.deltaY*(V.sourceEvent.deltaMode===1?.05:V.sourceEvent.deltaMode?1:.002)*x,ce=ee[2]*Math.pow(2,be);fe.scaleTo(ve,ce)},re=V=>{const{transform:ee,d3Selection:ve,d3Zoom:fe,translateExtent:be,width:ce,height:te}=_.getState();if(V.sourceEvent.type!=="mousemove"||!ve||!fe)return;const we=q.current*Math.max(1,ee[2])*(v?-1:1),Y={x:ee[0]-V.sourceEvent.movementX*we,y:ee[1]-V.sourceEvent.movementY*we},X=[[0,0],[ce,te]],ue=an.translate(Y.x,Y.y).scale(ee[2]),he=fe.constrain()(ue,X,be);fe.transform(ve,he)},ne=yC().on("zoom",y?re:null).on("zoom.wheel",g?Z:null);return K.call(ne),()=>{K.on("zoom",null)}}},[y,g,v,x]);const W=h?K=>{const Z=wr(K);h(K,{x:Z[0],y:Z[1]})}:void 0,B=p?(K,Z)=>{const re=_.getState().nodeInternals.get(Z);p(K,re)}:void 0;return G.createElement(Hn,{position:f,style:e,className:Wt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},G.createElement("svg",{width:j,height:R,viewBox:`${$} ${D} ${A} ${F}`,role:"img","aria-labelledby":M,ref:S,onClick:W},w&&G.createElement("title",{id:M},w),G.createElement(UD,{onClick:B,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:l}),G.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-O},${D-O}h${A+O*2}v${F+O*2}h${-A-O*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:d,pointerEvents:"none"})))}hE.displayName="MiniMap";var mE=m.memo(hE);const Ja={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},XD=180,QD=400,ZD=260,JD=48;function e6(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function t6({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:i,onToggleShowArchived:s,userSection:o}){const[l,c]=m.useState(!1),[u,d]=m.useState(ZD),[f,h]=m.useState(!1),p=m.useRef(null),y=m.useRef(null);m.useEffect(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((S,k)=>{const N=(S.name||"").localeCompare(k.name||"");return N!==0?N:(S.projectId||"").localeCompare(k.projectId||"")}),[e]),w=()=>{n()},v=m.useCallback(S=>{S.preventDefault(),h(!0)},[]),x=m.useCallback(S=>{if(!f)return;const k=Math.min(QD,Math.max(XD,S.clientX));d(k)},[f]),b=m.useCallback(()=>{h(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",x),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,x,b]);const _=l?JD:u;return a.jsxs("div",{ref:p,className:"h-full flex flex-col relative",style:{width:_,minWidth:_,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[a.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),a.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:i?"#f59e0b":"var(--text-muted)"},title:i?"Hide archived":"Show archived",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),a.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:a.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(S=>{const k=t===S.id;return a.jsxs("div",{ref:k?y:null,onClick:()=>r(S.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:k?"var(--state-active-bg)":"transparent",border:k?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:k?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:k?"#ffffff":Ja[S.status]||Ja.queued}}),a.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:k?"#ffffff":"var(--text-primary)"},children:S.name}),S.isArchived&&a.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:k?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[a.jsx("span",{className:"text-[10px] font-mono",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:S.projectId}),a.jsx("span",{className:"text-[10px]",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:e6(S.createdAt)})]})]},S.id)})}),l&&a.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(S=>a.jsx("div",{onClick:()=>r(S.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:S.name,children:a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:Ja[S.status]||Ja.queued,boxShadow:t===S.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},S.id))}),!l&&a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:w,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),a.jsx("span",{children:"New Project"})]})}),l&&a.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:w,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),o,!l&&a.jsx("div",{onMouseDown:v,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function r6({stations:e}){return e!=null&&e.length?a.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,r)=>{const n=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",i=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",s=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return a.jsxs(G.Fragment,{children:[r>0&&a.jsx("div",{className:"w-4 h-0.5",style:{background:i}}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:n}}),a.jsx("span",{className:"text-[7px] mt-0.5",style:{color:s,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const Ib={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},gE=(e,t)=>{var r;return((r=Ib[t])==null?void 0:r[e])||Ib.industrial.queued},vr={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},Co={GAP:8,WIDTH:280},id=["pgc","asm","draft","qa","done"],An=["industrial","light","blueprint"];function n6({questions:e,nodeWidth:t,onSubmit:r,onClose:n,onZoomComplete:i}){const[s,o]=m.useState({}),l=e.filter(c=>c.required).every(c=>s[c.id]);return m.useEffect(()=>{if(i){const c=setTimeout(()=>i(),150);return()=>clearTimeout(c)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+Co.GAP,width:Co.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:Co.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&a.jsx("span",{className:"text-amber-600",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:s[c.id]||"",onChange:u=>o(d=>({...d,[c.id]:u.target.value}))})]},c.id))}),a.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:a.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${l?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!l,onClick:()=>r(s),children:"Submit & Continue"})})]})}function i6({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:i}){const s=e.length>6,o=s?240:320;return m.useEffect(()=>{if(i){const l=setTimeout(()=>i(),150);return()=>clearTimeout(l)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:r+Co.GAP,width:o,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:Co.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${s?"":"grid grid-cols-2 gap-2"}`,children:e.map(l=>{const c=l.state==="complete"?"var(--state-stabilized-bg)":l.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return a.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${s?"mb-1":""}`,children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),a.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:l.name})]},l.id)})}),a.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const Zx="/api/v1";class s6 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function o6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ie(e,t={}){const r=`${Zx}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},i=await fetch(r,n);if(!i.ok){const s=await i.json().catch(()=>({}));throw new s6(s.detail||`Request failed: ${i.status}`,i.status,s)}return i.status===204?null:i.json()}const $e={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":o6()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return Ie(`/projects${r?"?"+r:""}`)},getProject:e=>Ie(`/projects/${e}`),getProjectTree:e=>Ie(`/projects/${e}/tree`),createProject:e=>Ie("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>Ie(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>Ie(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>Ie(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>Ie(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>Ie(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),Ie(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>Ie(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>Ie(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>Ie("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>Ie(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>Ie(`/document-workflows/executions/${e}`),getPgcAnswers:e=>Ie(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>Ie(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>Ie(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>Ie("/intake/start",{method:"POST"}),getIntakeState:e=>Ie(`/intake/${e}`),submitIntakeMessage:(e,t)=>Ie(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>Ie(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>Ie(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>Ie(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>Ie(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>Ie(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>Ie(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>Ie(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>Ie(`/projects/${e}/workflow/complete`,{method:"POST"})};function a6(e){const t=`${Zx}/production/events?project_id=${e}`;return new EventSource(t)}function l6(e){const t=`${Zx}/intake/${e}/events`;return new EventSource(t)}function c6(e){return`/auth/login/${e}`}function u6({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Mb({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const i=n==="numbered"?"decimal":"disc";return a.jsxs("div",{style:{marginBottom:12},children:[t.title&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),a.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":i},children:r.map((s,o)=>a.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&a.jsx("span",{style:{color:"#10b981"},children:""}),typeof s=="string"?s:(s==null?void 0:s.value)||(s==null?void 0:s.text)||(s==null?void 0:s.question)||(s==null?void 0:s.description)||JSON.stringify(s)]},o))})]})}function d6({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,s={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&a.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),a.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:s.bg,color:s.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function vE({block:e}){const{data:t}=e,{id:r,text:n,blocking:i,why_it_matters:s,priority:o,tags:l,options:c}=t,u={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},d=u[o]||u.should;return a.jsx("div",{style:{padding:"12px 16px",background:i?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${i?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),s&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:s}),a.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[i&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),o&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:d.bg,color:d.text,textTransform:"uppercase"},children:o}),l==null?void 0:l.map((f,h)=>a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},h))]}),c&&c.length>0&&a.jsxs("div",{style:{marginTop:8},children:[a.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,h)=>a.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:h>0?8:4},children:f},h))]})]})]})})}function f6({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,i=t.blocking_count||r.filter(s=>s.blocking).length;return r.length===0?a.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),i>0&&a.jsxs("span",{style:{color:"#dc2626"},children:[a.jsx("strong",{children:i})," blocking"]})]}),r.map((s,o)=>a.jsx(vE,{block:{type:"schema:OpenQuestionV1",data:s}},s.id||o))]})}function Pb({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const i={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((s,o)=>{const l=s.severity||s.likelihood||"medium",c=i[l]||i.medium;return a.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[s.id&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:s.id}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:s.description||s.reason||JSON.stringify(s)}),s.impact&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",s.impact]}),s.mitigation&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",s.mitigation]})]}),a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},s.id||o)})})]})}function p6({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([i])=>t[i]&&typeof t[i]=="string").map(([i,s])=>({title:s,content:t[i]}));return n.length===0?null:a.jsx("div",{style:{marginBottom:12},children:n.map((i,s)=>a.jsxs("div",{style:{marginBottom:s<n.length-1?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:i.title}),a.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:i.content})})]},s))})}function Ob({block:e}){const{data:t}=e,{epic_id:r,title:n,name:i,intent:s,phase:o,mvp_phase:l,risk_level:c,stories:u,detail_ref:d}=t,f=o||l,h=n||i,p={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},y=p[c]||p.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},w=g[f]||g.mvp;return a.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),a.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:h})]}),s&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s}),u&&u.length>0&&a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[u.length," stories"]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:w.bg,color:w.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&a.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:y.bg,color:y.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),d&&a.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function h6({block:e}){const{data:t}=e,{story_id:r,title:n,intent:i,phase:s,risk_level:o,detail_ref:l}=t,u={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[o]||null,d={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=d[s]||d.mvp;return a.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),i&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:i})]}),a.jsxs("div",{style:{display:"flex",gap:4},children:[s&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:s}),u&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:u.bg,color:u.text,textTransform:"uppercase",fontWeight:500},children:o})]})]})})}function m6({block:e}){const{type:t,data:r}=e;return a.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[a.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),a.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function g6({block:e}){const{data:t}=e,r=t.items||[],[n,i]=m.useState({});if(r.length===0)return null;const s=o=>{i(l=>({...l,[o]:!l[o]}))};return a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,l)=>{const c=n[l],u=o.why_it_matters||o.impact_if_unresolved;return a.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[a.jsxs("button",{onClick:()=>u&&s(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:u?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:o.question||o.value||o.text||"Unknown"}),u&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:a.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&u&&a.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[o.why_it_matters&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.why_it_matters})]}),o.impact_if_unresolved&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.impact_if_unresolved})]})]})]},l)})})}function v6({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&a.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function x6({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:i}=t;return a.jsxs("div",{style:{marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&a.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),i&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i})]})}function y6({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,i=r&&r.length>0,s=n&&n.length>0;return!i&&!s?null:a.jsxs("div",{style:{marginBottom:12},children:[i&&a.jsxs("div",{style:{marginBottom:s?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:o})]},l))})]}),s&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:o})]},l))})]})]})}function b6({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:i=[]}=t,s=r&&r.length>0,o=n&&n.length>0,l=i&&i.length>0;return!s&&!o&&!l?null:a.jsxs("div",{style:{marginBottom:12},children:[s&&a.jsxs("div",{style:{marginBottom:o||l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,u)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:c})]},u))})]}),o&&a.jsxs("div",{style:{marginBottom:l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,u)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:c})]},u))})]}),l&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:i.map((c,u)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#6b7280"},children:""}),a.jsx("span",{children:c})]},u))})]})]})}function w6({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:i}=t,o={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{marginBottom:12},children:a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:o.bg,color:o.text},children:r})}),n&&a.jsx("p",{style:{margin:0,marginBottom:i?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),i&&a.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:a.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",i]})})]})}const _6={"schema:ParagraphBlockV1":u6,"schema:StringListBlockV1":Mb,"schema:IndicatorBlockV1":d6,"schema:OpenQuestionV1":vE,"schema:OpenQuestionsBlockV1":f6,"schema:RisksBlockV1":Pb,"schema:DependenciesBlockV1":Pb,"schema:SummaryBlockV1":p6,"schema:EpicSummaryBlockV1":Ob,"schema:StorySummaryBlockV1":h6,"schema:EpicStoriesCardBlockV1":Ob,"schema:StoriesBlockV1":Mb,"schema:UnknownsBlockV1":g6,"schema:IntakeSummaryBlockV1":v6,"schema:IntakeProjectTypeBlockV1":x6,"schema:IntakeConstraintsBlockV1":y6,"schema:IntakeOpenGapsBlockV1":b6,"schema:IntakeOutcomeBlockV1":w6};function S6(e){return _6[e]||m6}function j6(e,t){const r=S6(e.type);return a.jsx(r,{block:e},e.key||t)}function xE({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:i=""}){var w;const[s,o]=m.useState(new Set(((w=e==null?void 0:e.sections)==null?void 0:w.map(v=>v.section_id))||[]));if(!e)return a.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:u=[],metadata:d}=e;if(d!=null&&d.fallback&&e.raw_content)return a.jsx(N6,{title:l,content:e.raw_content,reason:d.reason});const f=v=>{o(x=>{const b=new Set(x);return b.has(v)?b.delete(v):b.add(v),b})},h=t==="compact"||t==="sidecar",y=t==="sidecar"?u.filter(v=>v.viewer_tab==="overview"||!v.viewer_tab):u,g=(()=>{if(!l)return"Document";const v=l.indexOf(": ");return v>-1?l.slice(v+2):l})();return a.jsxs("div",{className:i,children:[t==="full"&&!r&&a.jsxs("div",{style:{marginBottom:24},children:[a.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&a.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:h?12:20},children:y.map(v=>a.jsx(k6,{section:v,isExpanded:s.has(v.section_id),onToggle:()=>f(v.section_id),onClick:()=>n==null?void 0:n(v),variant:t},v.section_id))}),y.length===0&&a.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function k6({section:e,isExpanded:t,onToggle:r,onClick:n,variant:i}){const{section_id:s,title:o,description:l,blocks:c=[],sidecar_max_items:u}=e,d=i==="compact"||i==="sidecar",f=i==="sidecar";if(c.length===0)return null;const h=f&&u&&c.length>u?c.slice(0,u):c,p=f&&u&&c.length>u;return a.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[a.jsxs("button",{onClick:r,style:{width:"100%",padding:d?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,fontSize:d?13:15,fontWeight:600,color:"#111827"},children:[o,p&&a.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",u," of ",c.length,")"]})]}),l&&!d&&a.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:l})]}),a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:a.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&a.jsxs("div",{style:{padding:d?12:18},children:[h.map((y,g)=>j6(y,g)),p&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-u," more in full view"]})]})]})}function N6({title:e,content:t,reason:r}){return a.jsxs("div",{children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function C6({renderModel:e,projectCode:t,documentName:r,isExpanded:n,onToggleExpand:i,onClose:s,onViewFull:o,nodeWidth:l=280}){const h=n?900:520,p=n?900:600,y=`${t||"DOC"} - ${r||"Document"}`,g=w=>{w.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:l+30,width:h,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:p,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const w=(e==null?void 0:e.title)||"DOCUMENT",v=w.indexOf(": ");return(v>-1?w.slice(v+2):w).toUpperCase()})()}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:i,title:n?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:n?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:s,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:n?600:400},children:a.jsx(xE,{renderModel:e,variant:"sidecar"})}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:o,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function E6({document:e,projectId:t,projectCode:r,nodeWidth:n,onClose:i,onZoomComplete:s,onViewFull:o}){const[l,c]=m.useState(null),[u,d]=m.useState(null),[f,h]=m.useState(!0),[p,y]=m.useState(!1);return m.useEffect(()=>{if(s){const g=setTimeout(()=>s(),150);return()=>clearTimeout(g)}},[s]),m.useEffect(()=>{async function g(){var w;if(!t||!e.id){h(!1);return}try{h(!0);try{const x=await $e.getDocumentRenderModel(t,e.id);if(x&&x.sections&&x.sections.length>0){c(x),d(null);return}if((w=x==null?void 0:x.metadata)!=null&&w.fallback&&x.raw_content){c(null),d(x.raw_content);return}}catch(x){console.log("RenderModel not available, falling back to raw document:",x.message)}const v=await $e.getDocument(t,e.id);c(null),d((v==null?void 0:v.content)||null)}catch(v){console.error("Failed to fetch document for sidecar:",v)}finally{h(!1)}}g()},[t,e.id]),f?null:l?a.jsx(C6,{renderModel:l,projectCode:r,documentName:e.name,isExpanded:p,onToggleExpand:()=>y(!p),onClose:i,onViewFull:()=>o==null?void 0:o(e.id),nodeWidth:n}):a.jsx(T6,{document:e,projectCode:r,rawContent:u,nodeWidth:n,isExpanded:p,onToggleExpand:()=>y(!p),onClose:i,onViewFull:()=>o==null?void 0:o(e.id)})}function T6({document:e,projectCode:t,rawContent:r,nodeWidth:n,isExpanded:i,onToggleExpand:s,onClose:o,onViewFull:l}){var w;const h=i?900:520,p=i?900:600,y=`${t||"DOC"} - ${e.name||"Document"}`,g=v=>{v.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:n+30,width:h,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:p,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((w=e.name)==null?void 0:w.toUpperCase())||"DOCUMENT"}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:s,title:i?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:i?600:400},children:[a.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:l,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const R6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function A6({data:e}){var _,S,k;const r=(e.level||1)===1,n=e.isExpanded,i=e.expandType,s=((_=e.questions)==null?void 0:_.length)>0,o=((S=e.features)==null?void 0:S.length)>0,l=(k=e.stations)==null?void 0:k.some(N=>N.needs_input),c=e.state||"ready_for_production",u=["produced","stabilized","ready"].includes(c),d=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),h=d&&e.stations,p=d?"node-active":"",y=r?"DOCUMENT":"EPIC",g=r?"subway-node-header-doc":"subway-node-header-epic",w=u?"var(--state-produced-bg, var(--state-stabilized-bg))":d?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",v=u?"var(--state-produced-text, var(--state-stabilized-text))":d?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",x=d?"var(--state-in-production-bg, var(--state-active-bg))":u?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=R6[c]||c;return a.jsxs("div",{className:"relative",children:[a.jsx(Wr,{type:"target",position:oe.Top,className:"!opacity-0",style:{left:"15%"}}),a.jsxs("div",{className:`subway-node rounded-lg border ${p} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:x},children:[a.jsxs("div",{className:`${g} border-b px-3 py-1.5 flex items-center justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:y}),a.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&a.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:w}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:v},children:b}),r&&e.desc&&a.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),h&&a.jsx(r6,{stations:e.stations}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&u&&a.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"document")},children:"View Document"}),l&&s&&!n&&a.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&o&&(n&&i==="features"?a.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):a.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"features")},children:[a.jsx("span",{className:"text-indigo-400",children:e.features.length}),a.jsx("span",{children:"features"}),a.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),n&&i==="questions"&&s&&a.jsx(n6,{questions:e.questions,nodeWidth:e.width,onSubmit:N=>{var E;return(E=e.onSubmitQuestions)==null?void 0:E.call(e,e.id,N)},onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&i==="features"&&o&&a.jsx(i6,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&i==="document"&&r&&u&&a.jsx(E6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)},onViewFull:N=>{var E;return(E=e.onViewFullDocument)==null?void 0:E.call(e,N)}}),a.jsx(Wr,{type:"source",position:oe.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function I6(){return a.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[a.jsx(Wr,{type:"target",position:oe.Top,style:{opacity:0}}),a.jsx(Wr,{type:"source",position:oe.Bottom,style:{opacity:0}})]})}function M6({projectId:e,projectCode:t,docTypeId:r,onClose:n}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null);return m.useEffect(()=>{async function h(){var p;try{u(!0),f(null);try{const g=await $e.getDocumentRenderModel(e,r);if(g&&g.sections&&g.sections.length>0){s(g),l(null);return}if((p=g==null?void 0:g.metadata)!=null&&p.fallback&&g.raw_content){s(null),l(g.raw_content);return}}catch(g){console.log("RenderModel not available, falling back to raw document:",g.message)}const y=await $e.getDocument(e,r);s(null),l((y==null?void 0:y.content)||null)}catch(y){f(y.message),console.error("Failed to fetch document:",y)}finally{u(!1)}}h()},[e,r]),m.useEffect(()=>{const h=p=>{p.key==="Escape"&&n()};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[n]),c?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:a.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:h=>h.target===h.currentTarget&&n(),children:a.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[a.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsx("div",{children:t&&a.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),a.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[d&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-red-500",children:d})}),i&&a.jsx(xE,{renderModel:i,variant:"full"}),o&&!i&&a.jsx(P6,{content:o,docTypeId:r}),!i&&!o&&!d&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function P6({content:e,docTypeId:t}){if(!e)return a.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n=e.description||e.summary||e.preliminary_summary;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",a.jsx("strong",{children:t})," - displaying raw content"]}),(r||n)&&a.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[r&&a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),n&&a.jsx("p",{className:"text-gray-700 text-sm",children:n})]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const O6="/api/v1/admin";class D6 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function L6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ce(e,t={}){var s;const r=`${O6}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const o=L6();o&&(n.headers["X-CSRF-Token"]=o)}const i=await fetch(r,n);if(!i.ok){const o=await i.json().catch(()=>({})),l=((s=o.detail)==null?void 0:s.message)||o.detail||`Request failed: ${i.status}`;throw new D6(l,i.status,o.detail||o)}return i.status===204?null:i.json()}const Se={getCurrentWorkspace:async()=>{try{return await Ce("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ce("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ce(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ce(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ce(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>Ce(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ce(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ce(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ce(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ce(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ce("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ce(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ce(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ce("/workbench/prompt-fragments"),getRoles:()=>Ce("/workbench/roles"),getTemplates:()=>Ce("/workbench/templates"),getSchemas:()=>Ce("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ce(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ce(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ce(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ce("/workbench/workflows"),getOrchestrationWorkflows:()=>Ce("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ce(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ce(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ce(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ce(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ce(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ce(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ce(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ce(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ce(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ce("/workbench/active-releases"),invalidateCache:()=>Ce("/workbench/cache/invalidate",{method:"POST"})};function F6({projectId:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null),[l,c]=m.useState(!1),[u,d]=m.useState([]),[f,h]=m.useState(!1),[p,y]=m.useState(!1),[g,w]=m.useState(null),[v,x]=m.useState(!1),[b,_]=m.useState(!1),S=m.useCallback(async()=>{if(e){i(!0),o(null);try{const P=await $e.getWorkflowInstance(e);r(P)}catch(P){P.status===404?r(null):o(P.message)}finally{i(!1)}}},[e]);m.useEffect(()=>{S()},[S]);const k=async()=>{c(!0),h(!0);try{const P=await Se.getOrchestrationWorkflows();d(P.workflows||[])}catch{d([])}finally{h(!1)}},N=async P=>{y(!0);try{const z=await $e.createWorkflowInstance(e,P.workflow_id,P.active_version);r(z),c(!1)}catch(z){o(z.message)}finally{y(!1)}},E=async()=>{if(t&&(_(!b),!g)){x(!0);try{const P=await $e.getWorkflowDrift(e);w(P)}catch(P){w({error:P.message})}finally{x(!1)}}};if(n)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(s&&!t)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:s});if(!t)return a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?a.jsx(z6,{workflows:u,loading:f,assigning:p,onSelect:N,onCancel:()=>c(!1)}):a.jsx("button",{onClick:k,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const j=t.effective_workflow||{},R=j.steps||[],T=t.base_workflow_ref||{};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:j.name||T.workflow_id||"Workflow"}),a.jsx(q6,{status:t.status})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",T.workflow_id," v",T.version,T.pow_class?` (${T.pow_class})`:""]})]}),a.jsx("button",{onClick:E,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:v?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&a.jsx($6,{drift:g}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",R.length,")"]}),R.length===0?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):a.jsx("div",{className:"space-y-1",children:R.map((P,z)=>a.jsx(B6,{step:P,index:z},P.step_id||z))})]}),s&&a.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:s})]})}function z6({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:i}){const s=e.filter(l=>(l.pow_class||"reference")==="reference"),o=e.filter(l=>l.pow_class==="template");return a.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs(a.Fragment,{children:[s.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),s.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),o.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),o.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),s.length===0&&o.length===0&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),a.jsx("button",{onClick:i,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function q6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function $6({drift:e}){return e.error?a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):a.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[a.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[a.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),a.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&a.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&a.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&a.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&a.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&a.jsx("div",{children:"~ Metadata changed"})]})]})}function B6({step:e,index:t}){return a.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&a.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&a.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function Jx(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sd,Db;function H6(){if(Db)return sd;Db=1;function e(){this.__data__=[],this.size=0}return sd=e,sd}var od,Lb;function As(){if(Lb)return od;Lb=1;function e(t,r){return t===r||t!==t&&r!==r}return od=e,od}var ad,Fb;function Gc(){if(Fb)return ad;Fb=1;var e=As();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return ad=t,ad}var ld,zb;function W6(){if(zb)return ld;zb=1;var e=Gc(),t=Array.prototype,r=t.splice;function n(i){var s=this.__data__,o=e(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return ld=n,ld}var cd,qb;function U6(){if(qb)return cd;qb=1;var e=Gc();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return cd=t,cd}var ud,$b;function V6(){if($b)return ud;$b=1;var e=Gc();function t(r){return e(this.__data__,r)>-1}return ud=t,ud}var dd,Bb;function G6(){if(Bb)return dd;Bb=1;var e=Gc();function t(r,n){var i=this.__data__,s=e(i,r);return s<0?(++this.size,i.push([r,n])):i[s][1]=n,this}return dd=t,dd}var fd,Hb;function Kc(){if(Hb)return fd;Hb=1;var e=H6(),t=W6(),r=U6(),n=V6(),i=G6();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,fd=s,fd}var pd,Wb;function K6(){if(Wb)return pd;Wb=1;var e=Kc();function t(){this.__data__=new e,this.size=0}return pd=t,pd}var hd,Ub;function Y6(){if(Ub)return hd;Ub=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return hd=e,hd}var md,Vb;function X6(){if(Vb)return md;Vb=1;function e(t){return this.__data__.get(t)}return md=e,md}var gd,Gb;function Q6(){if(Gb)return gd;Gb=1;function e(t){return this.__data__.has(t)}return gd=e,gd}var vd,Kb;function yE(){if(Kb)return vd;Kb=1;var e=typeof Na=="object"&&Na&&Na.Object===Object&&Na;return vd=e,vd}var xd,Yb;function Tr(){if(Yb)return xd;Yb=1;var e=yE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return xd=r,xd}var yd,Xb;function Is(){if(Xb)return yd;Xb=1;var e=Tr(),t=e.Symbol;return yd=t,yd}var bd,Qb;function Z6(){if(Qb)return bd;Qb=1;var e=Is(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function s(o){var l=r.call(o,i),c=o[i];try{o[i]=void 0;var u=!0}catch{}var d=n.call(o);return u&&(l?o[i]=c:delete o[i]),d}return bd=s,bd}var wd,Zb;function J6(){if(Zb)return wd;Zb=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return wd=r,wd}var _d,Jb;function Ti(){if(Jb)return _d;Jb=1;var e=Is(),t=Z6(),r=J6(),n="[object Null]",i="[object Undefined]",s=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?t(l):r(l)}return _d=o,_d}var Sd,e1;function pr(){if(e1)return Sd;e1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Sd=e,Sd}var jd,t1;function va(){if(t1)return jd;t1=1;var e=Ti(),t=pr(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==n||c==i||c==r||c==s}return jd=o,jd}var kd,r1;function eL(){if(r1)return kd;r1=1;var e=Tr(),t=e["__core-js_shared__"];return kd=t,kd}var Nd,n1;function tL(){if(n1)return Nd;n1=1;var e=eL(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Nd=r,Nd}var Cd,i1;function bE(){if(i1)return Cd;i1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Cd=r,Cd}var Ed,s1;function rL(){if(s1)return Ed;s1=1;var e=va(),t=tL(),r=pr(),n=bE(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,u=l.hasOwnProperty,d=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(h){if(!r(h)||t(h))return!1;var p=e(h)?d:s;return p.test(n(h))}return Ed=f,Ed}var Td,o1;function nL(){if(o1)return Td;o1=1;function e(t,r){return t==null?void 0:t[r]}return Td=e,Td}var Rd,a1;function Ri(){if(a1)return Rd;a1=1;var e=rL(),t=nL();function r(n,i){var s=t(n,i);return e(s)?s:void 0}return Rd=r,Rd}var Ad,l1;function ey(){if(l1)return Ad;l1=1;var e=Ri(),t=Tr(),r=e(t,"Map");return Ad=r,Ad}var Id,c1;function Yc(){if(c1)return Id;c1=1;var e=Ri(),t=e(Object,"create");return Id=t,Id}var Md,u1;function iL(){if(u1)return Md;u1=1;var e=Yc();function t(){this.__data__=e?e(null):{},this.size=0}return Md=t,Md}var Pd,d1;function sL(){if(d1)return Pd;d1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Pd=e,Pd}var Od,f1;function oL(){if(f1)return Od;f1=1;var e=Yc(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(s){var o=this.__data__;if(e){var l=o[s];return l===t?void 0:l}return n.call(o,s)?o[s]:void 0}return Od=i,Od}var Dd,p1;function aL(){if(p1)return Dd;p1=1;var e=Yc(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var s=this.__data__;return e?s[i]!==void 0:r.call(s,i)}return Dd=n,Dd}var Ld,h1;function lL(){if(h1)return Ld;h1=1;var e=Yc(),t="__lodash_hash_undefined__";function r(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=e&&i===void 0?t:i,this}return Ld=r,Ld}var Fd,m1;function cL(){if(m1)return Fd;m1=1;var e=iL(),t=sL(),r=oL(),n=aL(),i=lL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,Fd=s,Fd}var zd,g1;function uL(){if(g1)return zd;g1=1;var e=cL(),t=Kc(),r=ey();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return zd=n,zd}var qd,v1;function dL(){if(v1)return qd;v1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return qd=e,qd}var $d,x1;function Xc(){if(x1)return $d;x1=1;var e=dL();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return $d=t,$d}var Bd,y1;function fL(){if(y1)return Bd;y1=1;var e=Xc();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Bd=t,Bd}var Hd,b1;function pL(){if(b1)return Hd;b1=1;var e=Xc();function t(r){return e(this,r).get(r)}return Hd=t,Hd}var Wd,w1;function hL(){if(w1)return Wd;w1=1;var e=Xc();function t(r){return e(this,r).has(r)}return Wd=t,Wd}var Ud,_1;function mL(){if(_1)return Ud;_1=1;var e=Xc();function t(r,n){var i=e(this,r),s=i.size;return i.set(r,n),this.size+=i.size==s?0:1,this}return Ud=t,Ud}var Vd,S1;function ty(){if(S1)return Vd;S1=1;var e=uL(),t=fL(),r=pL(),n=hL(),i=mL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,Vd=s,Vd}var Gd,j1;function gL(){if(j1)return Gd;j1=1;var e=Kc(),t=ey(),r=ty(),n=200;function i(s,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([s,o]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(s,o),this.size=l.size,this}return Gd=i,Gd}var Kd,k1;function Qc(){if(k1)return Kd;k1=1;var e=Kc(),t=K6(),r=Y6(),n=X6(),i=Q6(),s=gL();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=i,o.prototype.set=s,Kd=o,Kd}var Yd,N1;function ry(){if(N1)return Yd;N1=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return Yd=e,Yd}var Xd,C1;function wE(){if(C1)return Xd;C1=1;var e=Ri(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return Xd=t,Xd}var Qd,E1;function Zc(){if(E1)return Qd;E1=1;var e=wE();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return Qd=t,Qd}var Zd,T1;function Jc(){if(T1)return Zd;T1=1;var e=Zc(),t=As(),r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l){var c=s[o];(!(n.call(s,o)&&t(c,l))||l===void 0&&!(o in s))&&e(s,o,l)}return Zd=i,Zd}var Jd,R1;function xa(){if(R1)return Jd;R1=1;var e=Jc(),t=Zc();function r(n,i,s,o){var l=!s;s||(s={});for(var c=-1,u=i.length;++c<u;){var d=i[c],f=o?o(s[d],n[d],d,s,n):void 0;f===void 0&&(f=n[d]),l?t(s,d,f):e(s,d,f)}return s}return Jd=r,Jd}var ef,A1;function vL(){if(A1)return ef;A1=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return ef=e,ef}var tf,I1;function Gr(){if(I1)return tf;I1=1;function e(t){return t!=null&&typeof t=="object"}return tf=e,tf}var rf,M1;function xL(){if(M1)return rf;M1=1;var e=Ti(),t=Gr(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return rf=n,rf}var nf,P1;function ya(){if(P1)return nf;P1=1;var e=xL(),t=Gr(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,s=e(function(){return arguments}())?e:function(o){return t(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return nf=s,nf}var sf,O1;function nt(){if(O1)return sf;O1=1;var e=Array.isArray;return sf=e,sf}var uo={exports:{}},of,D1;function yL(){if(D1)return of;D1=1;function e(){return!1}return of=e,of}uo.exports;var L1;function Ms(){return L1||(L1=1,function(e,t){var r=Tr(),n=yL(),i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===i,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u}(uo,uo.exports)),uo.exports}var af,F1;function eu(){if(F1)return af;F1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var s=typeof n;return i=i??e,!!i&&(s=="number"||s!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return af=r,af}var lf,z1;function ny(){if(z1)return lf;z1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return lf=t,lf}var cf,q1;function bL(){if(q1)return cf;q1=1;var e=Ti(),t=ny(),r=Gr(),n="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",f="[object Object]",h="[object RegExp]",p="[object Set]",y="[object String]",g="[object WeakMap]",w="[object ArrayBuffer]",v="[object DataView]",x="[object Float32Array]",b="[object Float64Array]",_="[object Int8Array]",S="[object Int16Array]",k="[object Int32Array]",N="[object Uint8Array]",E="[object Uint8ClampedArray]",j="[object Uint16Array]",R="[object Uint32Array]",T={};T[x]=T[b]=T[_]=T[S]=T[k]=T[N]=T[E]=T[j]=T[R]=!0,T[n]=T[i]=T[w]=T[s]=T[v]=T[o]=T[l]=T[c]=T[u]=T[d]=T[f]=T[h]=T[p]=T[y]=T[g]=!1;function P(z){return r(z)&&t(z.length)&&!!T[e(z)]}return cf=P,cf}var uf,$1;function tu(){if($1)return uf;$1=1;function e(t){return function(r){return t(r)}}return uf=e,uf}var fo={exports:{}};fo.exports;var B1;function iy(){return B1||(B1=1,function(e,t){var r=yE(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l}(fo,fo.exports)),fo.exports}var df,H1;function ba(){if(H1)return df;H1=1;var e=bL(),t=tu(),r=iy(),n=r&&r.isTypedArray,i=n?t(n):e;return df=i,df}var ff,W1;function _E(){if(W1)return ff;W1=1;var e=vL(),t=ya(),r=nt(),n=Ms(),i=eu(),s=ba(),o=Object.prototype,l=o.hasOwnProperty;function c(u,d){var f=r(u),h=!f&&t(u),p=!f&&!h&&n(u),y=!f&&!h&&!p&&s(u),g=f||h||p||y,w=g?e(u.length,String):[],v=w.length;for(var x in u)(d||l.call(u,x))&&!(g&&(x=="length"||p&&(x=="offset"||x=="parent")||y&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||i(x,v)))&&w.push(x);return w}return ff=c,ff}var pf,U1;function ru(){if(U1)return pf;U1=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return pf=t,pf}var hf,V1;function SE(){if(V1)return hf;V1=1;function e(t,r){return function(n){return t(r(n))}}return hf=e,hf}var mf,G1;function wL(){if(G1)return mf;G1=1;var e=SE(),t=e(Object.keys,Object);return mf=t,mf}var gf,K1;function sy(){if(K1)return gf;K1=1;var e=ru(),t=wL(),r=Object.prototype,n=r.hasOwnProperty;function i(s){if(!e(s))return t(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return gf=i,gf}var vf,Y1;function vn(){if(Y1)return vf;Y1=1;var e=va(),t=ny();function r(n){return n!=null&&t(n.length)&&!e(n)}return vf=r,vf}var xf,X1;function ei(){if(X1)return xf;X1=1;var e=_E(),t=sy(),r=vn();function n(i){return r(i)?e(i):t(i)}return xf=n,xf}var yf,Q1;function _L(){if(Q1)return yf;Q1=1;var e=xa(),t=ei();function r(n,i){return n&&e(i,t(i),n)}return yf=r,yf}var bf,Z1;function SL(){if(Z1)return bf;Z1=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return bf=e,bf}var wf,J1;function jL(){if(J1)return wf;J1=1;var e=pr(),t=ru(),r=SL(),n=Object.prototype,i=n.hasOwnProperty;function s(o){if(!e(o))return r(o);var l=t(o),c=[];for(var u in o)u=="constructor"&&(l||!i.call(o,u))||c.push(u);return c}return wf=s,wf}var _f,ew;function Ai(){if(ew)return _f;ew=1;var e=_E(),t=jL(),r=vn();function n(i){return r(i)?e(i,!0):t(i)}return _f=n,_f}var Sf,tw;function kL(){if(tw)return Sf;tw=1;var e=xa(),t=Ai();function r(n,i){return n&&e(i,t(i),n)}return Sf=r,Sf}var po={exports:{}};po.exports;var rw;function jE(){return rw||(rw=1,function(e,t){var r=Tr(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s?r.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var f=u.length,h=l?l(f):new u.constructor(f);return u.copy(h),h}e.exports=c}(po,po.exports)),po.exports}var jf,nw;function kE(){if(nw)return jf;nw=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return jf=e,jf}var kf,iw;function NE(){if(iw)return kf;iw=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=0,o=[];++n<i;){var l=t[n];r(l,n,t)&&(o[s++]=l)}return o}return kf=e,kf}var Nf,sw;function CE(){if(sw)return Nf;sw=1;function e(){return[]}return Nf=e,Nf}var Cf,ow;function oy(){if(ow)return Cf;ow=1;var e=NE(),t=CE(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),e(i(o),function(l){return n.call(o,l)}))}:t;return Cf=s,Cf}var Ef,aw;function NL(){if(aw)return Ef;aw=1;var e=xa(),t=oy();function r(n,i){return e(n,t(n),i)}return Ef=r,Ef}var Tf,lw;function ay(){if(lw)return Tf;lw=1;function e(t,r){for(var n=-1,i=r.length,s=t.length;++n<i;)t[s+n]=r[n];return t}return Tf=e,Tf}var Rf,cw;function nu(){if(cw)return Rf;cw=1;var e=SE(),t=e(Object.getPrototypeOf,Object);return Rf=t,Rf}var Af,uw;function EE(){if(uw)return Af;uw=1;var e=ay(),t=nu(),r=oy(),n=CE(),i=Object.getOwnPropertySymbols,s=i?function(o){for(var l=[];o;)e(l,r(o)),o=t(o);return l}:n;return Af=s,Af}var If,dw;function CL(){if(dw)return If;dw=1;var e=xa(),t=EE();function r(n,i){return e(n,t(n),i)}return If=r,If}var Mf,fw;function TE(){if(fw)return Mf;fw=1;var e=ay(),t=nt();function r(n,i,s){var o=i(n);return t(n)?o:e(o,s(n))}return Mf=r,Mf}var Pf,pw;function RE(){if(pw)return Pf;pw=1;var e=TE(),t=oy(),r=ei();function n(i){return e(i,r,t)}return Pf=n,Pf}var Of,hw;function EL(){if(hw)return Of;hw=1;var e=TE(),t=EE(),r=Ai();function n(i){return e(i,r,t)}return Of=n,Of}var Df,mw;function TL(){if(mw)return Df;mw=1;var e=Ri(),t=Tr(),r=e(t,"DataView");return Df=r,Df}var Lf,gw;function RL(){if(gw)return Lf;gw=1;var e=Ri(),t=Tr(),r=e(t,"Promise");return Lf=r,Lf}var Ff,vw;function AE(){if(vw)return Ff;vw=1;var e=Ri(),t=Tr(),r=e(t,"Set");return Ff=r,Ff}var zf,xw;function AL(){if(xw)return zf;xw=1;var e=Ri(),t=Tr(),r=e(t,"WeakMap");return zf=r,zf}var qf,yw;function Ps(){if(yw)return qf;yw=1;var e=TL(),t=ey(),r=RL(),n=AE(),i=AL(),s=Ti(),o=bE(),l="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",f="[object WeakMap]",h="[object DataView]",p=o(e),y=o(t),g=o(r),w=o(n),v=o(i),x=s;return(e&&x(new e(new ArrayBuffer(1)))!=h||t&&x(new t)!=l||r&&x(r.resolve())!=u||n&&x(new n)!=d||i&&x(new i)!=f)&&(x=function(b){var _=s(b),S=_==c?b.constructor:void 0,k=S?o(S):"";if(k)switch(k){case p:return h;case y:return l;case g:return u;case w:return d;case v:return f}return _}),qf=x,qf}var $f,bw;function IL(){if(bw)return $f;bw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,s=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(s.index=n.index,s.input=n.input),s}return $f=r,$f}var Bf,ww;function IE(){if(ww)return Bf;ww=1;var e=Tr(),t=e.Uint8Array;return Bf=t,Bf}var Hf,_w;function ly(){if(_w)return Hf;_w=1;var e=IE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return Hf=t,Hf}var Wf,Sw;function ML(){if(Sw)return Wf;Sw=1;var e=ly();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return Wf=t,Wf}var Uf,jw;function PL(){if(jw)return Uf;jw=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return Uf=t,Uf}var Vf,kw;function OL(){if(kw)return Vf;kw=1;var e=Is(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return Vf=n,Vf}var Gf,Nw;function ME(){if(Nw)return Gf;Nw=1;var e=ly();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return Gf=t,Gf}var Kf,Cw;function DL(){if(Cw)return Kf;Cw=1;var e=ly(),t=ML(),r=PL(),n=OL(),i=ME(),s="[object Boolean]",o="[object Date]",l="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",f="[object String]",h="[object Symbol]",p="[object ArrayBuffer]",y="[object DataView]",g="[object Float32Array]",w="[object Float64Array]",v="[object Int8Array]",x="[object Int16Array]",b="[object Int32Array]",_="[object Uint8Array]",S="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]";function E(j,R,T){var P=j.constructor;switch(R){case p:return e(j);case s:case o:return new P(+j);case y:return t(j,T);case g:case w:case v:case x:case b:case _:case S:case k:case N:return i(j,T);case l:return new P;case c:case f:return new P(j);case u:return r(j);case d:return new P;case h:return n(j)}}return Kf=E,Kf}var Yf,Ew;function PE(){if(Ew)return Yf;Ew=1;var e=pr(),t=Object.create,r=function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var s=new n;return n.prototype=void 0,s}}();return Yf=r,Yf}var Xf,Tw;function OE(){if(Tw)return Xf;Tw=1;var e=PE(),t=nu(),r=ru();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return Xf=n,Xf}var Qf,Rw;function LL(){if(Rw)return Qf;Rw=1;var e=Ps(),t=Gr(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return Qf=n,Qf}var Zf,Aw;function FL(){if(Aw)return Zf;Aw=1;var e=LL(),t=tu(),r=iy(),n=r&&r.isMap,i=n?t(n):e;return Zf=i,Zf}var Jf,Iw;function zL(){if(Iw)return Jf;Iw=1;var e=Ps(),t=Gr(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return Jf=n,Jf}var ep,Mw;function qL(){if(Mw)return ep;Mw=1;var e=zL(),t=tu(),r=iy(),n=r&&r.isSet,i=n?t(n):e;return ep=i,ep}var tp,Pw;function DE(){if(Pw)return tp;Pw=1;var e=Qc(),t=ry(),r=Jc(),n=_L(),i=kL(),s=jE(),o=kE(),l=NL(),c=CL(),u=RE(),d=EL(),f=Ps(),h=IL(),p=DL(),y=OE(),g=nt(),w=Ms(),v=FL(),x=pr(),b=qL(),_=ei(),S=Ai(),k=1,N=2,E=4,j="[object Arguments]",R="[object Array]",T="[object Boolean]",P="[object Date]",z="[object Error]",C="[object Function]",L="[object GeneratorFunction]",O="[object Map]",$="[object Number]",D="[object Object]",A="[object RegExp]",F="[object Set]",M="[object String]",q="[object Symbol]",W="[object WeakMap]",B="[object ArrayBuffer]",K="[object DataView]",Z="[object Float32Array]",re="[object Float64Array]",ne="[object Int8Array]",V="[object Int16Array]",ee="[object Int32Array]",ve="[object Uint8Array]",fe="[object Uint8ClampedArray]",be="[object Uint16Array]",ce="[object Uint32Array]",te={};te[j]=te[R]=te[B]=te[K]=te[T]=te[P]=te[Z]=te[re]=te[ne]=te[V]=te[ee]=te[O]=te[$]=te[D]=te[A]=te[F]=te[M]=te[q]=te[ve]=te[fe]=te[be]=te[ce]=!0,te[z]=te[C]=te[W]=!1;function we(Y,X,ue,he,_e,ge){var Q,pe=X&k,We=X&N,Re=X&E;if(ue&&(Q=_e?ue(Y,he,_e,ge):ue(Y)),Q!==void 0)return Q;if(!x(Y))return Y;var Le=g(Y);if(Le){if(Q=h(Y),!pe)return o(Y,Q)}else{var Pe=f(Y),Ue=Pe==C||Pe==L;if(w(Y))return s(Y,pe);if(Pe==D||Pe==j||Ue&&!_e){if(Q=We||Ue?{}:y(Y),!pe)return We?c(Y,i(Q,Y)):l(Y,n(Q,Y))}else{if(!te[Pe])return _e?Y:{};Q=p(Y,Pe,pe)}}ge||(ge=new e);var I=ge.get(Y);if(I)return I;ge.set(Y,Q),b(Y)?Y.forEach(function(se){Q.add(we(se,X,ue,se,Y,ge))}):v(Y)&&Y.forEach(function(se,Oe){Q.set(Oe,we(se,X,ue,Oe,Y,ge))});var H=Re?We?d:u:We?S:_,U=Le?void 0:H(Y);return t(U||Y,function(se,Oe){U&&(Oe=se,se=Y[Oe]),r(Q,Oe,we(se,X,ue,Oe,Y,ge))}),Q}return tp=we,tp}var rp,Ow;function $L(){if(Ow)return rp;Ow=1;var e=DE(),t=4;function r(n){return e(n,t)}return rp=r,rp}var np,Dw;function cy(){if(Dw)return np;Dw=1;function e(t){return function(){return t}}return np=e,np}var ip,Lw;function BL(){if(Lw)return ip;Lw=1;function e(t){return function(r,n,i){for(var s=-1,o=Object(r),l=i(r),c=l.length;c--;){var u=l[t?c:++s];if(n(o[u],u,o)===!1)break}return r}}return ip=e,ip}var sp,Fw;function uy(){if(Fw)return sp;Fw=1;var e=BL(),t=e();return sp=t,sp}var op,zw;function dy(){if(zw)return op;zw=1;var e=uy(),t=ei();function r(n,i){return n&&e(n,i,t)}return op=r,op}var ap,qw;function HL(){if(qw)return ap;qw=1;var e=vn();function t(r,n){return function(i,s){if(i==null)return i;if(!e(i))return r(i,s);for(var o=i.length,l=n?o:-1,c=Object(i);(n?l--:++l<o)&&s(c[l],l,c)!==!1;);return i}}return ap=t,ap}var lp,$w;function iu(){if($w)return lp;$w=1;var e=dy(),t=HL(),r=t(e);return lp=r,lp}var cp,Bw;function Ii(){if(Bw)return cp;Bw=1;function e(t){return t}return cp=e,cp}var up,Hw;function LE(){if(Hw)return up;Hw=1;var e=Ii();function t(r){return typeof r=="function"?r:e}return up=t,up}var dp,Ww;function FE(){if(Ww)return dp;Ww=1;var e=ry(),t=iu(),r=LE(),n=nt();function i(s,o){var l=n(s)?e:t;return l(s,r(o))}return dp=i,dp}var fp,Uw;function zE(){return Uw||(Uw=1,fp=FE()),fp}var pp,Vw;function WL(){if(Vw)return pp;Vw=1;var e=iu();function t(r,n){var i=[];return e(r,function(s,o,l){n(s,o,l)&&i.push(s)}),i}return pp=t,pp}var hp,Gw;function UL(){if(Gw)return hp;Gw=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return hp=t,hp}var mp,Kw;function VL(){if(Kw)return mp;Kw=1;function e(t){return this.__data__.has(t)}return mp=e,mp}var gp,Yw;function qE(){if(Yw)return gp;Yw=1;var e=ty(),t=UL(),r=VL();function n(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new e;++s<o;)this.add(i[s])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,gp=n,gp}var vp,Xw;function GL(){if(Xw)return vp;Xw=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return vp=e,vp}var xp,Qw;function $E(){if(Qw)return xp;Qw=1;function e(t,r){return t.has(r)}return xp=e,xp}var yp,Zw;function BE(){if(Zw)return yp;Zw=1;var e=qE(),t=GL(),r=$E(),n=1,i=2;function s(o,l,c,u,d,f){var h=c&n,p=o.length,y=l.length;if(p!=y&&!(h&&y>p))return!1;var g=f.get(o),w=f.get(l);if(g&&w)return g==l&&w==o;var v=-1,x=!0,b=c&i?new e:void 0;for(f.set(o,l),f.set(l,o);++v<p;){var _=o[v],S=l[v];if(u)var k=h?u(S,_,v,l,o,f):u(_,S,v,o,l,f);if(k!==void 0){if(k)continue;x=!1;break}if(b){if(!t(l,function(N,E){if(!r(b,E)&&(_===N||d(_,N,c,u,f)))return b.push(E)})){x=!1;break}}else if(!(_===S||d(_,S,c,u,f))){x=!1;break}}return f.delete(o),f.delete(l),x}return yp=s,yp}var bp,Jw;function KL(){if(Jw)return bp;Jw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,s){n[++r]=[s,i]}),n}return bp=e,bp}var wp,e_;function fy(){if(e_)return wp;e_=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return wp=e,wp}var _p,t_;function YL(){if(t_)return _p;t_=1;var e=Is(),t=IE(),r=As(),n=BE(),i=KL(),s=fy(),o=1,l=2,c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Map]",h="[object Number]",p="[object RegExp]",y="[object Set]",g="[object String]",w="[object Symbol]",v="[object ArrayBuffer]",x="[object DataView]",b=e?e.prototype:void 0,_=b?b.valueOf:void 0;function S(k,N,E,j,R,T,P){switch(E){case x:if(k.byteLength!=N.byteLength||k.byteOffset!=N.byteOffset)return!1;k=k.buffer,N=N.buffer;case v:return!(k.byteLength!=N.byteLength||!T(new t(k),new t(N)));case c:case u:case h:return r(+k,+N);case d:return k.name==N.name&&k.message==N.message;case p:case g:return k==N+"";case f:var z=i;case y:var C=j&o;if(z||(z=s),k.size!=N.size&&!C)return!1;var L=P.get(k);if(L)return L==N;j|=l,P.set(k,N);var O=n(z(k),z(N),j,R,T,P);return P.delete(k),O;case w:if(_)return _.call(k)==_.call(N)}return!1}return _p=S,_p}var Sp,r_;function XL(){if(r_)return Sp;r_=1;var e=RE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l,c,u,d){var f=l&t,h=e(s),p=h.length,y=e(o),g=y.length;if(p!=g&&!f)return!1;for(var w=p;w--;){var v=h[w];if(!(f?v in o:n.call(o,v)))return!1}var x=d.get(s),b=d.get(o);if(x&&b)return x==o&&b==s;var _=!0;d.set(s,o),d.set(o,s);for(var S=f;++w<p;){v=h[w];var k=s[v],N=o[v];if(c)var E=f?c(N,k,v,o,s,d):c(k,N,v,s,o,d);if(!(E===void 0?k===N||u(k,N,l,c,d):E)){_=!1;break}S||(S=v=="constructor")}if(_&&!S){var j=s.constructor,R=o.constructor;j!=R&&"constructor"in s&&"constructor"in o&&!(typeof j=="function"&&j instanceof j&&typeof R=="function"&&R instanceof R)&&(_=!1)}return d.delete(s),d.delete(o),_}return Sp=i,Sp}var jp,n_;function QL(){if(n_)return jp;n_=1;var e=Qc(),t=BE(),r=YL(),n=XL(),i=Ps(),s=nt(),o=Ms(),l=ba(),c=1,u="[object Arguments]",d="[object Array]",f="[object Object]",h=Object.prototype,p=h.hasOwnProperty;function y(g,w,v,x,b,_){var S=s(g),k=s(w),N=S?d:i(g),E=k?d:i(w);N=N==u?f:N,E=E==u?f:E;var j=N==f,R=E==f,T=N==E;if(T&&o(g)){if(!o(w))return!1;S=!0,j=!1}if(T&&!j)return _||(_=new e),S||l(g)?t(g,w,v,x,b,_):r(g,w,N,v,x,b,_);if(!(v&c)){var P=j&&p.call(g,"__wrapped__"),z=R&&p.call(w,"__wrapped__");if(P||z){var C=P?g.value():g,L=z?w.value():w;return _||(_=new e),b(C,L,v,x,_)}}return T?(_||(_=new e),n(g,w,v,x,b,_)):!1}return jp=y,jp}var kp,i_;function HE(){if(i_)return kp;i_=1;var e=QL(),t=Gr();function r(n,i,s,o,l){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,s,o,r,l)}return kp=r,kp}var Np,s_;function ZL(){if(s_)return Np;s_=1;var e=Qc(),t=HE(),r=1,n=2;function i(s,o,l,c){var u=l.length,d=u,f=!c;if(s==null)return!d;for(s=Object(s);u--;){var h=l[u];if(f&&h[2]?h[1]!==s[h[0]]:!(h[0]in s))return!1}for(;++u<d;){h=l[u];var p=h[0],y=s[p],g=h[1];if(f&&h[2]){if(y===void 0&&!(p in s))return!1}else{var w=new e;if(c)var v=c(y,g,p,s,o,w);if(!(v===void 0?t(g,y,r|n,c,w):v))return!1}}return!0}return Np=i,Np}var Cp,o_;function WE(){if(o_)return Cp;o_=1;var e=pr();function t(r){return r===r&&!e(r)}return Cp=t,Cp}var Ep,a_;function JL(){if(a_)return Ep;a_=1;var e=WE(),t=ei();function r(n){for(var i=t(n),s=i.length;s--;){var o=i[s],l=n[o];i[s]=[o,l,e(l)]}return i}return Ep=r,Ep}var Tp,l_;function UE(){if(l_)return Tp;l_=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Tp=e,Tp}var Rp,c_;function e8(){if(c_)return Rp;c_=1;var e=ZL(),t=JL(),r=UE();function n(i){var s=t(i);return s.length==1&&s[0][2]?r(s[0][0],s[0][1]):function(o){return o===i||e(o,i,s)}}return Rp=n,Rp}var Ap,u_;function Os(){if(u_)return Ap;u_=1;var e=Ti(),t=Gr(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Ap=n,Ap}var Ip,d_;function py(){if(d_)return Ip;d_=1;var e=nt(),t=Os(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){if(e(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return Ip=i,Ip}var Mp,f_;function t8(){if(f_)return Mp;f_=1;var e=ty(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var u=n.apply(this,o);return s.cache=c.set(l,u)||c,u};return s.cache=new(r.Cache||e),s}return r.Cache=e,Mp=r,Mp}var Pp,p_;function r8(){if(p_)return Pp;p_=1;var e=t8(),t=500;function r(n){var i=e(n,function(o){return s.size===t&&s.clear(),o}),s=i.cache;return i}return Pp=r,Pp}var Op,h_;function n8(){if(h_)return Op;h_=1;var e=r8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(t,function(o,l,c,u){s.push(c?u.replace(r,"$1"):l||o)}),s});return Op=n,Op}var Dp,m_;function su(){if(m_)return Dp;m_=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=Array(i);++n<i;)s[n]=r(t[n],n,t);return s}return Dp=e,Dp}var Lp,g_;function i8(){if(g_)return Lp;g_=1;var e=Is(),t=su(),r=nt(),n=Os(),i=e?e.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return t(l,o)+"";if(n(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Lp=o,Lp}var Fp,v_;function VE(){if(v_)return Fp;v_=1;var e=i8();function t(r){return r==null?"":e(r)}return Fp=t,Fp}var zp,x_;function ou(){if(x_)return zp;x_=1;var e=nt(),t=py(),r=n8(),n=VE();function i(s,o){return e(s)?s:t(s,o)?[s]:r(n(s))}return zp=i,zp}var qp,y_;function wa(){if(y_)return qp;y_=1;var e=Os();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return qp=t,qp}var $p,b_;function au(){if(b_)return $p;b_=1;var e=ou(),t=wa();function r(n,i){i=e(i,n);for(var s=0,o=i.length;n!=null&&s<o;)n=n[t(i[s++])];return s&&s==o?n:void 0}return $p=r,$p}var Bp,w_;function s8(){if(w_)return Bp;w_=1;var e=au();function t(r,n,i){var s=r==null?void 0:e(r,n);return s===void 0?i:s}return Bp=t,Bp}var Hp,__;function o8(){if(__)return Hp;__=1;function e(t,r){return t!=null&&r in Object(t)}return Hp=e,Hp}var Wp,S_;function GE(){if(S_)return Wp;S_=1;var e=ou(),t=ya(),r=nt(),n=eu(),i=ny(),s=wa();function o(l,c,u){c=e(c,l);for(var d=-1,f=c.length,h=!1;++d<f;){var p=s(c[d]);if(!(h=l!=null&&u(l,p)))break;l=l[p]}return h||++d!=f?h:(f=l==null?0:l.length,!!f&&i(f)&&n(p,f)&&(r(l)||t(l)))}return Wp=o,Wp}var Up,j_;function KE(){if(j_)return Up;j_=1;var e=o8(),t=GE();function r(n,i){return n!=null&&t(n,i,e)}return Up=r,Up}var Vp,k_;function a8(){if(k_)return Vp;k_=1;var e=HE(),t=s8(),r=KE(),n=py(),i=WE(),s=UE(),o=wa(),l=1,c=2;function u(d,f){return n(d)&&i(f)?s(o(d),f):function(h){var p=t(h,d);return p===void 0&&p===f?r(h,d):e(f,p,l|c)}}return Vp=u,Vp}var Gp,N_;function YE(){if(N_)return Gp;N_=1;function e(t){return function(r){return r==null?void 0:r[t]}}return Gp=e,Gp}var Kp,C_;function l8(){if(C_)return Kp;C_=1;var e=au();function t(r){return function(n){return e(n,r)}}return Kp=t,Kp}var Yp,E_;function c8(){if(E_)return Yp;E_=1;var e=YE(),t=l8(),r=py(),n=wa();function i(s){return r(s)?e(n(s)):t(s)}return Yp=i,Yp}var Xp,T_;function xn(){if(T_)return Xp;T_=1;var e=e8(),t=a8(),r=Ii(),n=nt(),i=c8();function s(o){return typeof o=="function"?o:o==null?r:typeof o=="object"?n(o)?t(o[0],o[1]):e(o):i(o)}return Xp=s,Xp}var Qp,R_;function XE(){if(R_)return Qp;R_=1;var e=NE(),t=WL(),r=xn(),n=nt();function i(s,o){var l=n(s)?e:t;return l(s,r(o,3))}return Qp=i,Qp}var Zp,A_;function u8(){if(A_)return Zp;A_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return Zp=r,Zp}var Jp,I_;function QE(){if(I_)return Jp;I_=1;var e=u8(),t=GE();function r(n,i){return n!=null&&t(n,i,e)}return Jp=r,Jp}var eh,M_;function d8(){if(M_)return eh;M_=1;var e=sy(),t=Ps(),r=ya(),n=nt(),i=vn(),s=Ms(),o=ru(),l=ba(),c="[object Map]",u="[object Set]",d=Object.prototype,f=d.hasOwnProperty;function h(p){if(p==null)return!0;if(i(p)&&(n(p)||typeof p=="string"||typeof p.splice=="function"||s(p)||l(p)||r(p)))return!p.length;var y=t(p);if(y==c||y==u)return!p.size;if(o(p))return!e(p).length;for(var g in p)if(f.call(p,g))return!1;return!0}return eh=h,eh}var th,P_;function ZE(){if(P_)return th;P_=1;function e(t){return t===void 0}return th=e,th}var rh,O_;function JE(){if(O_)return rh;O_=1;var e=iu(),t=vn();function r(n,i){var s=-1,o=t(n)?Array(n.length):[];return e(n,function(l,c,u){o[++s]=i(l,c,u)}),o}return rh=r,rh}var nh,D_;function eT(){if(D_)return nh;D_=1;var e=su(),t=xn(),r=JE(),n=nt();function i(s,o){var l=n(s)?e:r;return l(s,t(o,3))}return nh=i,nh}var ih,L_;function f8(){if(L_)return ih;L_=1;function e(t,r,n,i){var s=-1,o=t==null?0:t.length;for(i&&o&&(n=t[++s]);++s<o;)n=r(n,t[s],s,t);return n}return ih=e,ih}var sh,F_;function p8(){if(F_)return sh;F_=1;function e(t,r,n,i,s){return s(t,function(o,l,c){n=i?(i=!1,o):r(n,o,l,c)}),n}return sh=e,sh}var oh,z_;function tT(){if(z_)return oh;z_=1;var e=f8(),t=iu(),r=xn(),n=p8(),i=nt();function s(o,l,c){var u=i(o)?e:n,d=arguments.length<3;return u(o,r(l,4),c,d,t)}return oh=s,oh}var ah,q_;function h8(){if(q_)return ah;q_=1;var e=Ti(),t=nt(),r=Gr(),n="[object String]";function i(s){return typeof s=="string"||!t(s)&&r(s)&&e(s)==n}return ah=i,ah}var lh,$_;function m8(){if($_)return lh;$_=1;var e=YE(),t=e("length");return lh=t,lh}var ch,B_;function g8(){if(B_)return ch;B_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="\\u200d",l=RegExp("["+o+e+i+s+"]");function c(u){return l.test(u)}return ch=c,ch}var uh,H_;function v8(){if(H_)return uh;H_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="["+e+"]",l="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+l+"|"+c+")",d="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",y=u+"?",g="["+s+"]?",w="(?:"+p+"(?:"+[d,f,h].join("|")+")"+g+y+")*",v=g+y+w,x="(?:"+[d+l+"?",l,f,h,o].join("|")+")",b=RegExp(c+"(?="+c+")|"+x+v,"g");function _(S){for(var k=b.lastIndex=0;b.test(S);)++k;return k}return uh=_,uh}var dh,W_;function x8(){if(W_)return dh;W_=1;var e=m8(),t=g8(),r=v8();function n(i){return t(i)?r(i):e(i)}return dh=n,dh}var fh,U_;function y8(){if(U_)return fh;U_=1;var e=sy(),t=Ps(),r=vn(),n=h8(),i=x8(),s="[object Map]",o="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?i(c):c.length;var u=t(c);return u==s||u==o?c.size:e(c).length}return fh=l,fh}var ph,V_;function b8(){if(V_)return ph;V_=1;var e=ry(),t=PE(),r=dy(),n=xn(),i=nu(),s=nt(),o=Ms(),l=va(),c=pr(),u=ba();function d(f,h,p){var y=s(f),g=y||o(f)||u(f);if(h=n(h,4),p==null){var w=f&&f.constructor;g?p=y?new w:[]:c(f)?p=l(w)?t(i(f)):{}:p={}}return(g?e:r)(f,function(v,x,b){return h(p,v,x,b)}),p}return ph=d,ph}var hh,G_;function w8(){if(G_)return hh;G_=1;var e=Is(),t=ya(),r=nt(),n=e?e.isConcatSpreadable:void 0;function i(s){return r(s)||t(s)||!!(n&&s&&s[n])}return hh=i,hh}var mh,K_;function hy(){if(K_)return mh;K_=1;var e=ay(),t=w8();function r(n,i,s,o,l){var c=-1,u=n.length;for(s||(s=t),l||(l=[]);++c<u;){var d=n[c];i>0&&s(d)?i>1?r(d,i-1,s,o,l):e(l,d):o||(l[l.length]=d)}return l}return mh=r,mh}var gh,Y_;function _8(){if(Y_)return gh;Y_=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return gh=e,gh}var vh,X_;function rT(){if(X_)return vh;X_=1;var e=_8(),t=Math.max;function r(n,i,s){return i=t(i===void 0?n.length-1:i,0),function(){for(var o=arguments,l=-1,c=t(o.length-i,0),u=Array(c);++l<c;)u[l]=o[i+l];l=-1;for(var d=Array(i+1);++l<i;)d[l]=o[l];return d[i]=s(u),e(n,this,d)}}return vh=r,vh}var xh,Q_;function S8(){if(Q_)return xh;Q_=1;var e=cy(),t=wE(),r=Ii(),n=t?function(i,s){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(s),writable:!0})}:r;return xh=n,xh}var yh,Z_;function j8(){if(Z_)return yh;Z_=1;var e=800,t=16,r=Date.now;function n(i){var s=0,o=0;return function(){var l=r(),c=t-(l-o);if(o=l,c>0){if(++s>=e)return arguments[0]}else s=0;return i.apply(void 0,arguments)}}return yh=n,yh}var bh,J_;function nT(){if(J_)return bh;J_=1;var e=S8(),t=j8(),r=t(e);return bh=r,bh}var wh,e2;function lu(){if(e2)return wh;e2=1;var e=Ii(),t=rT(),r=nT();function n(i,s){return r(t(i,s,e),i+"")}return wh=n,wh}var _h,t2;function iT(){if(t2)return _h;t2=1;function e(t,r,n,i){for(var s=t.length,o=n+(i?1:-1);i?o--:++o<s;)if(r(t[o],o,t))return o;return-1}return _h=e,_h}var Sh,r2;function k8(){if(r2)return Sh;r2=1;function e(t){return t!==t}return Sh=e,Sh}var jh,n2;function N8(){if(n2)return jh;n2=1;function e(t,r,n){for(var i=n-1,s=t.length;++i<s;)if(t[i]===r)return i;return-1}return jh=e,jh}var kh,i2;function C8(){if(i2)return kh;i2=1;var e=iT(),t=k8(),r=N8();function n(i,s,o){return s===s?r(i,s,o):e(i,t,o)}return kh=n,kh}var Nh,s2;function E8(){if(s2)return Nh;s2=1;var e=C8();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return Nh=t,Nh}var Ch,o2;function T8(){if(o2)return Ch;o2=1;function e(t,r,n){for(var i=-1,s=t==null?0:t.length;++i<s;)if(n(r,t[i]))return!0;return!1}return Ch=e,Ch}var Eh,a2;function R8(){if(a2)return Eh;a2=1;function e(){}return Eh=e,Eh}var Th,l2;function A8(){if(l2)return Th;l2=1;var e=AE(),t=R8(),r=fy(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(s){return new e(s)}:t;return Th=i,Th}var Rh,c2;function I8(){if(c2)return Rh;c2=1;var e=qE(),t=E8(),r=T8(),n=$E(),i=A8(),s=fy(),o=200;function l(c,u,d){var f=-1,h=t,p=c.length,y=!0,g=[],w=g;if(d)y=!1,h=r;else if(p>=o){var v=u?null:i(c);if(v)return s(v);y=!1,h=n,w=new e}else w=u?[]:g;e:for(;++f<p;){var x=c[f],b=u?u(x):x;if(x=d||x!==0?x:0,y&&b===b){for(var _=w.length;_--;)if(w[_]===b)continue e;u&&w.push(b),g.push(x)}else h(w,b,d)||(w!==g&&w.push(b),g.push(x))}return g}return Rh=l,Rh}var Ah,u2;function sT(){if(u2)return Ah;u2=1;var e=vn(),t=Gr();function r(n){return t(n)&&e(n)}return Ah=r,Ah}var Ih,d2;function M8(){if(d2)return Ih;d2=1;var e=hy(),t=lu(),r=I8(),n=sT(),i=t(function(s){return r(e(s,1,n,!0))});return Ih=i,Ih}var Mh,f2;function P8(){if(f2)return Mh;f2=1;var e=su();function t(r,n){return e(n,function(i){return r[i]})}return Mh=t,Mh}var Ph,p2;function oT(){if(p2)return Ph;p2=1;var e=P8(),t=ei();function r(n){return n==null?[]:e(n,t(n))}return Ph=r,Ph}var Oh,h2;function hr(){if(h2)return Oh;h2=1;var e;if(typeof Jx=="function")try{e={clone:$L(),constant:cy(),each:zE(),filter:XE(),has:QE(),isArray:nt(),isEmpty:d8(),isFunction:va(),isUndefined:ZE(),keys:ei(),map:eT(),reduce:tT(),size:y8(),transform:b8(),union:M8(),values:oT()}}catch{}return e||(e=window._),Oh=e,Oh}var Dh,m2;function my(){if(m2)return Dh;m2=1;var e=hr();Dh=i;var t="\0",r="\0",n="";function i(d){this._isDirected=e.has(d,"directed")?d.directed:!0,this._isMultigraph=e.has(d,"multigraph")?d.multigraph:!1,this._isCompound=e.has(d,"compound")?d.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(d){return this._label=d,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultNodeLabelFn=d,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._in[f])})},i.prototype.sinks=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._out[f])})},i.prototype.setNodes=function(d,f){var h=arguments,p=this;return e.each(d,function(y){h.length>1?p.setNode(y,f):p.setNode(y)}),this},i.prototype.setNode=function(d,f){return e.has(this._nodes,d)?(arguments.length>1&&(this._nodes[d]=f),this):(this._nodes[d]=arguments.length>1?f:this._defaultNodeLabelFn(d),this._isCompound&&(this._parent[d]=r,this._children[d]={},this._children[r][d]=!0),this._in[d]={},this._preds[d]={},this._out[d]={},this._sucs[d]={},++this._nodeCount,this)},i.prototype.node=function(d){return this._nodes[d]},i.prototype.hasNode=function(d){return e.has(this._nodes,d)},i.prototype.removeNode=function(d){var f=this;if(e.has(this._nodes,d)){var h=function(p){f.removeEdge(f._edgeObjs[p])};delete this._nodes[d],this._isCompound&&(this._removeFromParentsChildList(d),delete this._parent[d],e.each(this.children(d),function(p){f.setParent(p)}),delete this._children[d]),e.each(e.keys(this._in[d]),h),delete this._in[d],delete this._preds[d],e.each(e.keys(this._out[d]),h),delete this._out[d],delete this._sucs[d],--this._nodeCount}return this},i.prototype.setParent=function(d,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var h=f;!e.isUndefined(h);h=this.parent(h))if(h===d)throw new Error("Setting "+f+" as parent of "+d+" would create a cycle");this.setNode(f)}return this.setNode(d),this._removeFromParentsChildList(d),this._parent[d]=f,this._children[f][d]=!0,this},i.prototype._removeFromParentsChildList=function(d){delete this._children[this._parent[d]][d]},i.prototype.parent=function(d){if(this._isCompound){var f=this._parent[d];if(f!==r)return f}},i.prototype.children=function(d){if(e.isUndefined(d)&&(d=r),this._isCompound){var f=this._children[d];if(f)return e.keys(f)}else{if(d===r)return this.nodes();if(this.hasNode(d))return[]}},i.prototype.predecessors=function(d){var f=this._preds[d];if(f)return e.keys(f)},i.prototype.successors=function(d){var f=this._sucs[d];if(f)return e.keys(f)},i.prototype.neighbors=function(d){var f=this.predecessors(d);if(f)return e.union(f,this.successors(d))},i.prototype.isLeaf=function(d){var f;return this.isDirected()?f=this.successors(d):f=this.neighbors(d),f.length===0},i.prototype.filterNodes=function(d){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var h=this;e.each(this._nodes,function(g,w){d(w)&&f.setNode(w,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,h.edge(g))});var p={};function y(g){var w=h.parent(g);return w===void 0||f.hasNode(w)?(p[g]=w,w):w in p?p[w]:y(w)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,y(g))}),f},i.prototype.setDefaultEdgeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultEdgeLabelFn=d,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(d,f){var h=this,p=arguments;return e.reduce(d,function(y,g){return p.length>1?h.setEdge(y,g,f):h.setEdge(y,g),g}),this},i.prototype.setEdge=function(){var d,f,h,p,y=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(d=g.v,f=g.w,h=g.name,arguments.length===2&&(p=arguments[1],y=!0)):(d=g,f=arguments[1],h=arguments[3],arguments.length>2&&(p=arguments[2],y=!0)),d=""+d,f=""+f,e.isUndefined(h)||(h=""+h);var w=l(this._isDirected,d,f,h);if(e.has(this._edgeLabels,w))return y&&(this._edgeLabels[w]=p),this;if(!e.isUndefined(h)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(f),this._edgeLabels[w]=y?p:this._defaultEdgeLabelFn(d,f,h);var v=c(this._isDirected,d,f,h);return d=v.v,f=v.w,Object.freeze(v),this._edgeObjs[w]=v,s(this._preds[f],d),s(this._sucs[d],f),this._in[f][w]=v,this._out[d][w]=v,this._edgeCount++,this},i.prototype.edge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):l(this._isDirected,d,f,h);return this._edgeLabels[p]},i.prototype.hasEdge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):l(this._isDirected,d,f,h);return e.has(this._edgeLabels,p)},i.prototype.removeEdge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):l(this._isDirected,d,f,h),y=this._edgeObjs[p];return y&&(d=y.v,f=y.w,delete this._edgeLabels[p],delete this._edgeObjs[p],o(this._preds[f],d),o(this._sucs[d],f),delete this._in[f][p],delete this._out[d][p],this._edgeCount--),this},i.prototype.inEdges=function(d,f){var h=this._in[d];if(h){var p=e.values(h);return f?e.filter(p,function(y){return y.v===f}):p}},i.prototype.outEdges=function(d,f){var h=this._out[d];if(h){var p=e.values(h);return f?e.filter(p,function(y){return y.w===f}):p}},i.prototype.nodeEdges=function(d,f){var h=this.inEdges(d,f);if(h)return h.concat(this.outEdges(d,f))};function s(d,f){d[f]?d[f]++:d[f]=1}function o(d,f){--d[f]||delete d[f]}function l(d,f,h,p){var y=""+f,g=""+h;if(!d&&y>g){var w=y;y=g,g=w}return y+n+g+n+(e.isUndefined(p)?t:p)}function c(d,f,h,p){var y=""+f,g=""+h;if(!d&&y>g){var w=y;y=g,g=w}var v={v:y,w:g};return p&&(v.name=p),v}function u(d,f){return l(d,f.v,f.w,f.name)}return Dh}var Lh,g2;function O8(){return g2||(g2=1,Lh="2.1.8"),Lh}var Fh,v2;function D8(){return v2||(v2=1,Fh={Graph:my(),version:O8()}),Fh}var zh,x2;function L8(){if(x2)return zh;x2=1;var e=hr(),t=my();zh={write:r,read:s};function r(o){var l={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:n(o),edges:i(o)};return e.isUndefined(o.graph())||(l.value=e.clone(o.graph())),l}function n(o){return e.map(o.nodes(),function(l){var c=o.node(l),u=o.parent(l),d={v:l};return e.isUndefined(c)||(d.value=c),e.isUndefined(u)||(d.parent=u),d})}function i(o){return e.map(o.edges(),function(l){var c=o.edge(l),u={v:l.v,w:l.w};return e.isUndefined(l.name)||(u.name=l.name),e.isUndefined(c)||(u.value=c),u})}function s(o){var l=new t(o.options).setGraph(o.value);return e.each(o.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(o.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return zh}var qh,y2;function F8(){if(y2)return qh;y2=1;var e=hr();qh=t;function t(r){var n={},i=[],s;function o(l){e.has(n,l)||(n[l]=!0,s.push(l),e.each(r.successors(l),o),e.each(r.predecessors(l),o))}return e.each(r.nodes(),function(l){s=[],o(l),s.length&&i.push(s)}),i}return qh}var $h,b2;function aT(){if(b2)return $h;b2=1;var e=hr();$h=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var s=this._arr,o=s.length;return i[r]=o,s.push({key:r,priority:n}),this._decrease(o),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,s=i+1,o=r;i<n.length&&(o=n[i].priority<n[o].priority?i:o,s<n.length&&(o=n[s].priority<n[o].priority?s:o),o!==r&&(this._swap(r,o),this._heapify(o)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,s;r!==0&&(s=r>>1,!(n[s].priority<i));)this._swap(r,s),r=s},t.prototype._swap=function(r,n){var i=this._arr,s=this._keyIndices,o=i[r],l=i[n];i[r]=l,i[n]=o,s[l.key]=r,s[o.key]=n},$h}var Bh,w2;function lT(){if(w2)return Bh;w2=1;var e=hr(),t=aT();Bh=n;var r=e.constant(1);function n(s,o,l,c){return i(s,String(o),l||r,c||function(u){return s.outEdges(u)})}function i(s,o,l,c){var u={},d=new t,f,h,p=function(y){var g=y.v!==f?y.v:y.w,w=u[g],v=l(y),x=h.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+y+" Weight: "+v);x<w.distance&&(w.distance=x,w.predecessor=f,d.decrease(g,x))};for(s.nodes().forEach(function(y){var g=y===o?0:Number.POSITIVE_INFINITY;u[y]={distance:g},d.add(y,g)});d.size()>0&&(f=d.removeMin(),h=u[f],h.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(p);return u}return Bh}var Hh,_2;function z8(){if(_2)return Hh;_2=1;var e=lT(),t=hr();Hh=r;function r(n,i,s){return t.transform(n.nodes(),function(o,l){o[l]=e(n,l,i,s)},{})}return Hh}var Wh,S2;function cT(){if(S2)return Wh;S2=1;var e=hr();Wh=t;function t(r){var n=0,i=[],s={},o=[];function l(c){var u=s[c]={onStack:!0,lowlink:n,index:n++};if(i.push(c),r.successors(c).forEach(function(h){e.has(s,h)?s[h].onStack&&(u.lowlink=Math.min(u.lowlink,s[h].index)):(l(h),u.lowlink=Math.min(u.lowlink,s[h].lowlink))}),u.lowlink===u.index){var d=[],f;do f=i.pop(),s[f].onStack=!1,d.push(f);while(c!==f);o.push(d)}}return r.nodes().forEach(function(c){e.has(s,c)||l(c)}),o}return Wh}var Uh,j2;function q8(){if(j2)return Uh;j2=1;var e=hr(),t=cT();Uh=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Uh}var Vh,k2;function $8(){if(k2)return Vh;k2=1;var e=hr();Vh=r;var t=e.constant(1);function r(i,s,o){return n(i,s||t,o||function(l){return i.outEdges(l)})}function n(i,s,o){var l={},c=i.nodes();return c.forEach(function(u){l[u]={},l[u][u]={distance:0},c.forEach(function(d){u!==d&&(l[u][d]={distance:Number.POSITIVE_INFINITY})}),o(u).forEach(function(d){var f=d.v===u?d.w:d.v,h=s(d);l[u][f]={distance:h,predecessor:u}})}),c.forEach(function(u){var d=l[u];c.forEach(function(f){var h=l[f];c.forEach(function(p){var y=h[u],g=d[p],w=h[p],v=y.distance+g.distance;v<w.distance&&(w.distance=v,w.predecessor=g.predecessor)})})}),l}return Vh}var Gh,N2;function uT(){if(N2)return Gh;N2=1;var e=hr();Gh=t,t.CycleException=r;function t(n){var i={},s={},o=[];function l(c){if(e.has(s,c))throw new r;e.has(i,c)||(s[c]=!0,i[c]=!0,e.each(n.predecessors(c),l),delete s[c],o.push(c))}if(e.each(n.sinks(),l),e.size(i)!==n.nodeCount())throw new r;return o}function r(){}return r.prototype=new Error,Gh}var Kh,C2;function B8(){if(C2)return Kh;C2=1;var e=uT();Kh=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return Kh}var Yh,E2;function dT(){if(E2)return Yh;E2=1;var e=hr();Yh=t;function t(n,i,s){e.isArray(i)||(i=[i]);var o=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(i,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);r(n,u,s==="post",c,o,l)}),l}function r(n,i,s,o,l,c){e.has(o,i)||(o[i]=!0,s||c.push(i),e.each(l(i),function(u){r(n,u,s,o,l,c)}),s&&c.push(i))}return Yh}var Xh,T2;function H8(){if(T2)return Xh;T2=1;var e=dT();Xh=t;function t(r,n){return e(r,n,"post")}return Xh}var Qh,R2;function W8(){if(R2)return Qh;R2=1;var e=dT();Qh=t;function t(r,n){return e(r,n,"pre")}return Qh}var Zh,A2;function U8(){if(A2)return Zh;A2=1;var e=hr(),t=my(),r=aT();Zh=n;function n(i,s){var o=new t,l={},c=new r,u;function d(h){var p=h.v===u?h.w:h.v,y=c.priority(p);if(y!==void 0){var g=s(h);g<y&&(l[p]=u,c.decrease(p,g))}}if(i.nodeCount()===0)return o;e.each(i.nodes(),function(h){c.add(h,Number.POSITIVE_INFINITY),o.setNode(h)}),c.decrease(i.nodes()[0],0);for(var f=!1;c.size()>0;){if(u=c.removeMin(),e.has(l,u))o.setEdge(u,l[u]);else{if(f)throw new Error("Input graph is not connected: "+i);f=!0}i.nodeEdges(u).forEach(d)}return o}return Zh}var Jh,I2;function V8(){return I2||(I2=1,Jh={components:F8(),dijkstra:lT(),dijkstraAll:z8(),findCycles:q8(),floydWarshall:$8(),isAcyclic:B8(),postorder:H8(),preorder:W8(),prim:U8(),tarjan:cT(),topsort:uT()}),Jh}var em,M2;function G8(){if(M2)return em;M2=1;var e=D8();return em={Graph:e.Graph,json:L8(),alg:V8(),version:e.version},em}var sc;if(typeof Jx=="function")try{sc=G8()}catch{}sc||(sc=window.graphlib);var Rr=sc,tm,P2;function K8(){if(P2)return tm;P2=1;var e=DE(),t=1,r=4;function n(i){return e(i,t|r)}return tm=n,tm}var rm,O2;function cu(){if(O2)return rm;O2=1;var e=As(),t=vn(),r=eu(),n=pr();function i(s,o,l){if(!n(l))return!1;var c=typeof o;return(c=="number"?t(l)&&r(o,l.length):c=="string"&&o in l)?e(l[o],s):!1}return rm=i,rm}var nm,D2;function Y8(){if(D2)return nm;D2=1;var e=lu(),t=As(),r=cu(),n=Ai(),i=Object.prototype,s=i.hasOwnProperty,o=e(function(l,c){l=Object(l);var u=-1,d=c.length,f=d>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(d=1);++u<d;)for(var h=c[u],p=n(h),y=-1,g=p.length;++y<g;){var w=p[y],v=l[w];(v===void 0||t(v,i[w])&&!s.call(l,w))&&(l[w]=h[w])}return l});return nm=o,nm}var im,L2;function X8(){if(L2)return im;L2=1;var e=xn(),t=vn(),r=ei();function n(i){return function(s,o,l){var c=Object(s);if(!t(s)){var u=e(o,3);s=r(s),o=function(f){return u(c[f],f,c)}}var d=i(s,o,l);return d>-1?c[u?s[d]:d]:void 0}}return im=n,im}var sm,F2;function Q8(){if(F2)return sm;F2=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return sm=t,sm}var om,z2;function Z8(){if(z2)return om;z2=1;var e=Q8(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return om=r,om}var am,q2;function J8(){if(q2)return am;q2=1;var e=Z8(),t=pr(),r=Os(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var f=s.test(u);return f||o.test(u)?l(u.slice(2),f?2:8):i.test(u)?n:+u}return am=c,am}var lm,$2;function fT(){if($2)return lm;$2=1;var e=J8(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var s=i<0?-1:1;return s*r}return i===i?i:0}return lm=n,lm}var cm,B2;function eF(){if(B2)return cm;B2=1;var e=fT();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return cm=t,cm}var um,H2;function tF(){if(H2)return um;H2=1;var e=iT(),t=xn(),r=eF(),n=Math.max;function i(s,o,l){var c=s==null?0:s.length;if(!c)return-1;var u=l==null?0:r(l);return u<0&&(u=n(c+u,0)),e(s,t(o,3),u)}return um=i,um}var dm,W2;function rF(){if(W2)return dm;W2=1;var e=X8(),t=tF(),r=e(t);return dm=r,dm}var fm,U2;function pT(){if(U2)return fm;U2=1;var e=hy();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return fm=t,fm}var pm,V2;function nF(){if(V2)return pm;V2=1;var e=uy(),t=LE(),r=Ai();function n(i,s){return i==null?i:e(i,t(s),r)}return pm=n,pm}var hm,G2;function iF(){if(G2)return hm;G2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return hm=e,hm}var mm,K2;function sF(){if(K2)return mm;K2=1;var e=Zc(),t=dy(),r=xn();function n(i,s){var o={};return s=r(s,3),t(i,function(l,c,u){e(o,c,s(l,c,u))}),o}return mm=n,mm}var gm,Y2;function gy(){if(Y2)return gm;Y2=1;var e=Os();function t(r,n,i){for(var s=-1,o=r.length;++s<o;){var l=r[s],c=n(l);if(c!=null&&(u===void 0?c===c&&!e(c):i(c,u)))var u=c,d=l}return d}return gm=t,gm}var vm,X2;function oF(){if(X2)return vm;X2=1;function e(t,r){return t>r}return vm=e,vm}var xm,Q2;function aF(){if(Q2)return xm;Q2=1;var e=gy(),t=oF(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return xm=n,xm}var ym,Z2;function hT(){if(Z2)return ym;Z2=1;var e=Zc(),t=As();function r(n,i,s){(s!==void 0&&!t(n[i],s)||s===void 0&&!(i in n))&&e(n,i,s)}return ym=r,ym}var bm,J2;function lF(){if(J2)return bm;J2=1;var e=Ti(),t=nu(),r=Gr(),n="[object Object]",i=Function.prototype,s=Object.prototype,o=i.toString,l=s.hasOwnProperty,c=o.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var f=t(d);if(f===null)return!0;var h=l.call(f,"constructor")&&f.constructor;return typeof h=="function"&&h instanceof h&&o.call(h)==c}return bm=u,bm}var wm,eS;function mT(){if(eS)return wm;eS=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return wm=e,wm}var _m,tS;function cF(){if(tS)return _m;tS=1;var e=xa(),t=Ai();function r(n){return e(n,t(n))}return _m=r,_m}var Sm,rS;function uF(){if(rS)return Sm;rS=1;var e=hT(),t=jE(),r=ME(),n=kE(),i=OE(),s=ya(),o=nt(),l=sT(),c=Ms(),u=va(),d=pr(),f=lF(),h=ba(),p=mT(),y=cF();function g(w,v,x,b,_,S,k){var N=p(w,x),E=p(v,x),j=k.get(E);if(j){e(w,x,j);return}var R=S?S(N,E,x+"",w,v,k):void 0,T=R===void 0;if(T){var P=o(E),z=!P&&c(E),C=!P&&!z&&h(E);R=E,P||z||C?o(N)?R=N:l(N)?R=n(N):z?(T=!1,R=t(E,!0)):C?(T=!1,R=r(E,!0)):R=[]:f(E)||s(E)?(R=N,s(N)?R=y(N):(!d(N)||u(N))&&(R=i(E))):T=!1}T&&(k.set(E,R),_(R,E,b,S,k),k.delete(E)),e(w,x,R)}return Sm=g,Sm}var jm,nS;function dF(){if(nS)return jm;nS=1;var e=Qc(),t=hT(),r=uy(),n=uF(),i=pr(),s=Ai(),o=mT();function l(c,u,d,f,h){c!==u&&r(u,function(p,y){if(h||(h=new e),i(p))n(c,u,y,d,l,f,h);else{var g=f?f(o(c,y),p,y+"",c,u,h):void 0;g===void 0&&(g=p),t(c,y,g)}},s)}return jm=l,jm}var km,iS;function fF(){if(iS)return km;iS=1;var e=lu(),t=cu();function r(n){return e(function(i,s){var o=-1,l=s.length,c=l>1?s[l-1]:void 0,u=l>2?s[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,u&&t(s[0],s[1],u)&&(c=l<3?void 0:c,l=1),i=Object(i);++o<l;){var d=s[o];d&&n(i,d,o,c)}return i})}return km=r,km}var Nm,sS;function pF(){if(sS)return Nm;sS=1;var e=dF(),t=fF(),r=t(function(n,i,s){e(n,i,s)});return Nm=r,Nm}var Cm,oS;function gT(){if(oS)return Cm;oS=1;function e(t,r){return t<r}return Cm=e,Cm}var Em,aS;function hF(){if(aS)return Em;aS=1;var e=gy(),t=gT(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return Em=n,Em}var Tm,lS;function mF(){if(lS)return Tm;lS=1;var e=gy(),t=xn(),r=gT();function n(i,s){return i&&i.length?e(i,t(s,2),r):void 0}return Tm=n,Tm}var Rm,cS;function gF(){if(cS)return Rm;cS=1;var e=Tr(),t=function(){return e.Date.now()};return Rm=t,Rm}var Am,uS;function vF(){if(uS)return Am;uS=1;var e=Jc(),t=ou(),r=eu(),n=pr(),i=wa();function s(o,l,c,u){if(!n(o))return o;l=t(l,o);for(var d=-1,f=l.length,h=f-1,p=o;p!=null&&++d<f;){var y=i(l[d]),g=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return o;if(d!=h){var w=p[y];g=u?u(w,y,p):void 0,g===void 0&&(g=n(w)?w:r(l[d+1])?[]:{})}e(p,y,g),p=p[y]}return o}return Am=s,Am}var Im,dS;function xF(){if(dS)return Im;dS=1;var e=au(),t=vF(),r=ou();function n(i,s,o){for(var l=-1,c=s.length,u={};++l<c;){var d=s[l],f=e(i,d);o(f,d)&&t(u,r(d,i),f)}return u}return Im=n,Im}var Mm,fS;function yF(){if(fS)return Mm;fS=1;var e=xF(),t=KE();function r(n,i){return e(n,i,function(s,o){return t(n,o)})}return Mm=r,Mm}var Pm,pS;function bF(){if(pS)return Pm;pS=1;var e=pT(),t=rT(),r=nT();function n(i){return r(t(i,void 0,e),i+"")}return Pm=n,Pm}var Om,hS;function wF(){if(hS)return Om;hS=1;var e=yF(),t=bF(),r=t(function(n,i){return n==null?{}:e(n,i)});return Om=r,Om}var Dm,mS;function _F(){if(mS)return Dm;mS=1;var e=Math.ceil,t=Math.max;function r(n,i,s,o){for(var l=-1,c=t(e((i-n)/(s||1)),0),u=Array(c);c--;)u[o?c:++l]=n,n+=s;return u}return Dm=r,Dm}var Lm,gS;function SF(){if(gS)return Lm;gS=1;var e=_F(),t=cu(),r=fT();function n(i){return function(s,o,l){return l&&typeof l!="number"&&t(s,o,l)&&(o=l=void 0),s=r(s),o===void 0?(o=s,s=0):o=r(o),l=l===void 0?s<o?1:-1:r(l),e(s,o,l,i)}}return Lm=n,Lm}var Fm,vS;function jF(){if(vS)return Fm;vS=1;var e=SF(),t=e();return Fm=t,Fm}var zm,xS;function kF(){if(xS)return zm;xS=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return zm=e,zm}var qm,yS;function NF(){if(yS)return qm;yS=1;var e=Os();function t(r,n){if(r!==n){var i=r!==void 0,s=r===null,o=r===r,l=e(r),c=n!==void 0,u=n===null,d=n===n,f=e(n);if(!u&&!f&&!l&&r>n||l&&c&&d&&!u&&!f||s&&c&&d||!i&&d||!o)return 1;if(!s&&!l&&!f&&r<n||f&&i&&o&&!s&&!l||u&&i&&o||!c&&o||!d)return-1}return 0}return qm=t,qm}var $m,bS;function CF(){if(bS)return $m;bS=1;var e=NF();function t(r,n,i){for(var s=-1,o=r.criteria,l=n.criteria,c=o.length,u=i.length;++s<c;){var d=e(o[s],l[s]);if(d){if(s>=u)return d;var f=i[s];return d*(f=="desc"?-1:1)}}return r.index-n.index}return $m=t,$m}var Bm,wS;function EF(){if(wS)return Bm;wS=1;var e=su(),t=au(),r=xn(),n=JE(),i=kF(),s=tu(),o=CF(),l=Ii(),c=nt();function u(d,f,h){f.length?f=e(f,function(g){return c(g)?function(w){return t(w,g.length===1?g[0]:g)}:g}):f=[l];var p=-1;f=e(f,s(r));var y=n(d,function(g,w,v){var x=e(f,function(b){return b(g)});return{criteria:x,index:++p,value:g}});return i(y,function(g,w){return o(g,w,h)})}return Bm=u,Bm}var Hm,_S;function TF(){if(_S)return Hm;_S=1;var e=hy(),t=EF(),r=lu(),n=cu(),i=r(function(s,o){if(s==null)return[];var l=o.length;return l>1&&n(s,o[0],o[1])?o=[]:l>2&&n(o[0],o[1],o[2])&&(o=[o[0]]),t(s,e(o,1),[])});return Hm=i,Hm}var Wm,SS;function RF(){if(SS)return Wm;SS=1;var e=VE(),t=0;function r(n){var i=++t;return e(n)+i}return Wm=r,Wm}var Um,jS;function AF(){if(jS)return Um;jS=1;function e(t,r,n){for(var i=-1,s=t.length,o=r.length,l={};++i<s;){var c=i<o?r[i]:void 0;n(l,t[i],c)}return l}return Um=e,Um}var Vm,kS;function IF(){if(kS)return Vm;kS=1;var e=Jc(),t=AF();function r(n,i){return t(n||[],i||[],e)}return Vm=r,Vm}var oc;if(typeof Jx=="function")try{oc={cloneDeep:K8(),constant:cy(),defaults:Y8(),each:zE(),filter:XE(),find:rF(),flatten:pT(),forEach:FE(),forIn:nF(),has:QE(),isUndefined:ZE(),last:iF(),map:eT(),mapValues:sF(),max:aF(),merge:pF(),min:hF(),minBy:mF(),now:gF(),pick:wF(),range:jF(),reduce:tT(),sortBy:TF(),uniqueId:RF(),values:oT(),zipObject:IF()}}catch{}oc||(oc=window._);var He=oc,MF=uu;function uu(){var e={};e._next=e._prev=e,this._sentinel=e}uu.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return vT(t),t};uu.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&vT(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};uu.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,PF)),r=r._prev;return"["+e.join(", ")+"]"};function vT(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function PF(e,t){if(e!=="_next"&&e!=="_prev")return t}var nn=He,OF=Rr.Graph,DF=MF,LF=zF,FF=nn.constant(1);function zF(e,t){if(e.nodeCount()<=1)return[];var r=$F(e,t||FF),n=qF(r.graph,r.buckets,r.zeroIdx);return nn.flatten(nn.map(n,function(i){return e.outEdges(i.v,i.w)}),!0)}function qF(e,t,r){for(var n=[],i=t[t.length-1],s=t[0],o;e.nodeCount();){for(;o=s.dequeue();)Gm(e,t,r,o);for(;o=i.dequeue();)Gm(e,t,r,o);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(o=t[l].dequeue(),o){n=n.concat(Gm(e,t,r,o,!0));break}}}return n}function Gm(e,t,r,n,i){var s=i?[]:void 0;return nn.forEach(e.inEdges(n.v),function(o){var l=e.edge(o),c=e.node(o.v);i&&s.push({v:o.v,w:o.w}),c.out-=l,Ev(t,r,c)}),nn.forEach(e.outEdges(n.v),function(o){var l=e.edge(o),c=o.w,u=e.node(c);u.in-=l,Ev(t,r,u)}),e.removeNode(n.v),s}function $F(e,t){var r=new OF,n=0,i=0;nn.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),nn.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,u=t(l),d=c+u;r.setEdge(l.v,l.w,d),i=Math.max(i,r.node(l.v).out+=u),n=Math.max(n,r.node(l.w).in+=u)});var s=nn.range(i+n+3).map(function(){return new DF}),o=n+1;return nn.forEach(r.nodes(),function(l){Ev(s,o,r.node(l))}),{graph:r,buckets:s,zeroIdx:o}}function Ev(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var hi=He,BF=LF,HF={run:WF,undo:VF};function WF(e){var t=e.graph().acyclicer==="greedy"?BF(e,r(e)):UF(e);hi.forEach(t,function(n){var i=e.edge(n);e.removeEdge(n),i.forwardName=n.name,i.reversed=!0,e.setEdge(n.w,n.v,i,hi.uniqueId("rev"))});function r(n){return function(i){return n.edge(i).weight}}}function UF(e){var t=[],r={},n={};function i(s){hi.has(n,s)||(n[s]=!0,r[s]=!0,hi.forEach(e.outEdges(s),function(o){hi.has(r,o.w)?t.push(o):i(o.w)}),delete r[s])}return hi.forEach(e.nodes(),i),t}function VF(e){hi.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var Ae=He,xT=Rr.Graph,Ht={addDummyNode:yT,simplify:GF,asNonCompoundGraph:KF,successorWeights:YF,predecessorWeights:XF,intersectRect:QF,buildLayerMatrix:ZF,normalizeRanks:JF,removeEmptyRanks:ez,addBorderNode:tz,maxRank:bT,partition:rz,time:nz,notime:iz};function yT(e,t,r,n){var i;do i=Ae.uniqueId(n);while(e.hasNode(i));return r.dummy=t,e.setNode(i,r),i}function GF(e){var t=new xT().setGraph(e.graph());return Ae.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),Ae.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},i=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),t}function KF(e){var t=new xT({multigraph:e.isMultigraph()}).setGraph(e.graph());return Ae.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),Ae.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function YF(e){var t=Ae.map(e.nodes(),function(r){var n={};return Ae.forEach(e.outEdges(r),function(i){n[i.w]=(n[i.w]||0)+e.edge(i).weight}),n});return Ae.zipObject(e.nodes(),t)}function XF(e){var t=Ae.map(e.nodes(),function(r){var n={};return Ae.forEach(e.inEdges(r),function(i){n[i.v]=(n[i.v]||0)+e.edge(i).weight}),n});return Ae.zipObject(e.nodes(),t)}function QF(e,t){var r=e.x,n=e.y,i=t.x-r,s=t.y-n,o=e.width/2,l=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var c,u;return Math.abs(s)*o>Math.abs(i)*l?(s<0&&(l=-l),c=l*i/s,u=l):(i<0&&(o=-o),c=o,u=o*s/i),{x:r+c,y:n+u}}function ZF(e){var t=Ae.map(Ae.range(bT(e)+1),function(){return[]});return Ae.forEach(e.nodes(),function(r){var n=e.node(r),i=n.rank;Ae.isUndefined(i)||(t[i][n.order]=r)}),t}function JF(e){var t=Ae.min(Ae.map(e.nodes(),function(r){return e.node(r).rank}));Ae.forEach(e.nodes(),function(r){var n=e.node(r);Ae.has(n,"rank")&&(n.rank-=t)})}function ez(e){var t=Ae.min(Ae.map(e.nodes(),function(s){return e.node(s).rank})),r=[];Ae.forEach(e.nodes(),function(s){var o=e.node(s).rank-t;r[o]||(r[o]=[]),r[o].push(s)});var n=0,i=e.graph().nodeRankFactor;Ae.forEach(r,function(s,o){Ae.isUndefined(s)&&o%i!==0?--n:n&&Ae.forEach(s,function(l){e.node(l).rank+=n})})}function tz(e,t,r,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=r,i.order=n),yT(e,"border",i,t)}function bT(e){return Ae.max(Ae.map(e.nodes(),function(t){var r=e.node(t).rank;if(!Ae.isUndefined(r))return r}))}function rz(e,t){var r={lhs:[],rhs:[]};return Ae.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function nz(e,t){var r=Ae.now();try{return t()}finally{console.log(e+" time: "+(Ae.now()-r)+"ms")}}function iz(e,t){return t()}var wT=He,sz=Ht,oz={run:az,undo:cz};function az(e){e.graph().dummyChains=[],wT.forEach(e.edges(),function(t){lz(e,t)})}function lz(e,t){var r=t.v,n=e.node(r).rank,i=t.w,s=e.node(i).rank,o=t.name,l=e.edge(t),c=l.labelRank;if(s!==n+1){e.removeEdge(t);var u,d,f;for(f=0,++n;n<s;++f,++n)l.points=[],d={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},u=sz.addDummyNode(e,"edge",d,"_d"),n===c&&(d.width=l.width,d.height=l.height,d.dummy="edge-label",d.labelpos=l.labelpos),e.setEdge(r,u,{weight:l.weight},o),f===0&&e.graph().dummyChains.push(u),r=u;e.setEdge(r,i,{weight:l.weight},o)}}function cz(e){wT.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,i;for(e.setEdge(r.edgeObj,n);r.dummy;)i=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=i,r=e.node(t)})}var el=He,du={longestPath:uz,slack:dz};function uz(e){var t={};function r(n){var i=e.node(n);if(el.has(t,n))return i.rank;t[n]=!0;var s=el.min(el.map(e.outEdges(n),function(o){return r(o.w)-e.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}el.forEach(e.sources(),r)}function dz(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var ac=He,fz=Rr.Graph,lc=du.slack,_T=pz;function pz(e){var t=new fz({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var i,s;hz(t,e)<n;)i=mz(t,e),s=t.hasNode(i.v)?lc(e,i):-lc(e,i),gz(t,e,s);return t}function hz(e,t){function r(n){ac.forEach(t.nodeEdges(n),function(i){var s=i.v,o=n===s?i.w:s;!e.hasNode(o)&&!lc(t,i)&&(e.setNode(o,{}),e.setEdge(n,o,{}),r(o))})}return ac.forEach(e.nodes(),r),e.nodeCount()}function mz(e,t){return ac.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return lc(t,r)})}function gz(e,t,r){ac.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var hn=He,vz=_T,xz=du.slack,yz=du.longestPath,bz=Rr.alg.preorder,wz=Rr.alg.postorder,_z=Ht.simplify,Sz=Mi;Mi.initLowLimValues=xy;Mi.initCutValues=vy;Mi.calcCutValue=ST;Mi.leaveEdge=kT;Mi.enterEdge=NT;Mi.exchangeEdges=CT;function Mi(e){e=_z(e),yz(e);var t=vz(e);xy(t),vy(t,e);for(var r,n;r=kT(t);)n=NT(t,e,r),CT(t,e,r,n)}function vy(e,t){var r=wz(e,e.nodes());r=r.slice(0,r.length-1),hn.forEach(r,function(n){jz(e,t,n)})}function jz(e,t,r){var n=e.node(r),i=n.parent;e.edge(r,i).cutvalue=ST(e,t,r)}function ST(e,t,r){var n=e.node(r),i=n.parent,s=!0,o=t.edge(r,i),l=0;return o||(s=!1,o=t.edge(i,r)),l=o.weight,hn.forEach(t.nodeEdges(r),function(c){var u=c.v===r,d=u?c.w:c.v;if(d!==i){var f=u===s,h=t.edge(c).weight;if(l+=f?h:-h,Nz(e,r,d)){var p=e.edge(r,d).cutvalue;l+=f?-p:p}}}),l}function xy(e,t){arguments.length<2&&(t=e.nodes()[0]),jT(e,{},1,t)}function jT(e,t,r,n,i){var s=r,o=e.node(n);return t[n]=!0,hn.forEach(e.neighbors(n),function(l){hn.has(t,l)||(r=jT(e,t,r,l,n))}),o.low=s,o.lim=r++,i?o.parent=i:delete o.parent,r}function kT(e){return hn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function NT(e,t,r){var n=r.v,i=r.w;t.hasEdge(n,i)||(n=r.w,i=r.v);var s=e.node(n),o=e.node(i),l=s,c=!1;s.lim>o.lim&&(l=o,c=!0);var u=hn.filter(t.edges(),function(d){return c===NS(e,e.node(d.v),l)&&c!==NS(e,e.node(d.w),l)});return hn.minBy(u,function(d){return xz(t,d)})}function CT(e,t,r,n){var i=r.v,s=r.w;e.removeEdge(i,s),e.setEdge(n.v,n.w,{}),xy(e),vy(e,t),kz(e,t)}function kz(e,t){var r=hn.find(e.nodes(),function(i){return!t.node(i).parent}),n=bz(e,r);n=n.slice(1),hn.forEach(n,function(i){var s=e.node(i).parent,o=t.edge(i,s),l=!1;o||(o=t.edge(s,i),l=!0),t.node(i).rank=t.node(s).rank+(l?o.minlen:-o.minlen)})}function Nz(e,t,r){return e.hasEdge(t,r)}function NS(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var Cz=du,ET=Cz.longestPath,Ez=_T,Tz=Sz,Rz=Az;function Az(e){switch(e.graph().ranker){case"network-simplex":CS(e);break;case"tight-tree":Mz(e);break;case"longest-path":Iz(e);break;default:CS(e)}}var Iz=ET;function Mz(e){ET(e),Ez(e)}function CS(e){Tz(e)}var Tv=He,Pz=Oz;function Oz(e){var t=Lz(e);Tv.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),i=n.edgeObj,s=Dz(e,t,i.v,i.w),o=s.path,l=s.lca,c=0,u=o[c],d=!0;r!==i.w;){if(n=e.node(r),d){for(;(u=o[c])!==l&&e.node(u).maxRank<n.rank;)c++;u===l&&(d=!1)}if(!d){for(;c<o.length-1&&e.node(u=o[c+1]).minRank<=n.rank;)c++;u=o[c]}e.setParent(r,u),r=e.successors(r)[0]}})}function Dz(e,t,r,n){var i=[],s=[],o=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,u;c=r;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||l>t[c].lim));for(u=c,c=n;(c=e.parent(c))!==u;)s.push(c);return{path:i.concat(s.reverse()),lca:u}}function Lz(e){var t={},r=0;function n(i){var s=r;Tv.forEach(e.children(i),n),t[i]={low:s,lim:r++}}return Tv.forEach(e.children(),n),t}var sn=He,Rv=Ht,Fz={run:zz,cleanup:Bz};function zz(e){var t=Rv.addDummyNode(e,"root",{},"_root"),r=qz(e),n=sn.max(sn.values(r))-1,i=2*n+1;e.graph().nestingRoot=t,sn.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var s=$z(e)+1;sn.forEach(e.children(),function(o){TT(e,t,i,s,n,r,o)}),e.graph().nodeRankFactor=i}function TT(e,t,r,n,i,s,o){var l=e.children(o);if(!l.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:r});return}var c=Rv.addBorderNode(e,"_bt"),u=Rv.addBorderNode(e,"_bb"),d=e.node(o);e.setParent(c,o),d.borderTop=c,e.setParent(u,o),d.borderBottom=u,sn.forEach(l,function(f){TT(e,t,r,n,i,s,f);var h=e.node(f),p=h.borderTop?h.borderTop:f,y=h.borderBottom?h.borderBottom:f,g=h.borderTop?n:2*n,w=p!==y?1:i-s[o]+1;e.setEdge(c,p,{weight:g,minlen:w,nestingEdge:!0}),e.setEdge(y,u,{weight:g,minlen:w,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+s[o]})}function qz(e){var t={};function r(n,i){var s=e.children(n);s&&s.length&&sn.forEach(s,function(o){r(o,i+1)}),t[n]=i}return sn.forEach(e.children(),function(n){r(n,1)}),t}function $z(e){return sn.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function Bz(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,sn.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var Km=He,Hz=Ht,Wz=Uz;function Uz(e){function t(r){var n=e.children(r),i=e.node(r);if(n.length&&Km.forEach(n,t),Km.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,o=i.maxRank+1;s<o;++s)ES(e,"borderLeft","_bl",r,i,s),ES(e,"borderRight","_br",r,i,s)}}Km.forEach(e.children(),t)}function ES(e,t,r,n,i,s){var o={width:0,height:0,rank:s,borderType:t},l=i[t][s-1],c=Hz.addDummyNode(e,"border",o,r);i[t][s]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var zr=He,Vz={adjust:Gz,undo:Kz};function Gz(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&RT(e)}function Kz(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Yz(e),(t==="lr"||t==="rl")&&(Xz(e),RT(e))}function RT(e){zr.forEach(e.nodes(),function(t){TS(e.node(t))}),zr.forEach(e.edges(),function(t){TS(e.edge(t))})}function TS(e){var t=e.width;e.width=e.height,e.height=t}function Yz(e){zr.forEach(e.nodes(),function(t){Ym(e.node(t))}),zr.forEach(e.edges(),function(t){var r=e.edge(t);zr.forEach(r.points,Ym),zr.has(r,"y")&&Ym(r)})}function Ym(e){e.y=-e.y}function Xz(e){zr.forEach(e.nodes(),function(t){Xm(e.node(t))}),zr.forEach(e.edges(),function(t){var r=e.edge(t);zr.forEach(r.points,Xm),zr.has(r,"x")&&Xm(r)})}function Xm(e){var t=e.x;e.x=e.y,e.y=t}var Yr=He,Qz=Zz;function Zz(e){var t={},r=Yr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Yr.max(Yr.map(r,function(l){return e.node(l).rank})),i=Yr.map(Yr.range(n+1),function(){return[]});function s(l){if(!Yr.has(t,l)){t[l]=!0;var c=e.node(l);i[c.rank].push(l),Yr.forEach(e.successors(l),s)}}var o=Yr.sortBy(r,function(l){return e.node(l).rank});return Yr.forEach(o,s),i}var _n=He,Jz=eq;function eq(e,t){for(var r=0,n=1;n<t.length;++n)r+=tq(e,t[n-1],t[n]);return r}function tq(e,t,r){for(var n=_n.zipObject(r,_n.map(r,function(u,d){return d})),i=_n.flatten(_n.map(t,function(u){return _n.sortBy(_n.map(e.outEdges(u),function(d){return{pos:n[d.w],weight:e.edge(d).weight}}),"pos")}),!0),s=1;s<r.length;)s<<=1;var o=2*s-1;s-=1;var l=_n.map(new Array(o),function(){return 0}),c=0;return _n.forEach(i.forEach(function(u){var d=u.pos+s;l[d]+=u.weight;for(var f=0;d>0;)d%2&&(f+=l[d+1]),d=d-1>>1,l[d]+=u.weight;c+=u.weight*f})),c}var RS=He,rq=nq;function nq(e,t){return RS.map(t,function(r){var n=e.inEdges(r);if(n.length){var i=RS.reduce(n,function(s,o){var l=e.edge(o),c=e.node(o.v);return{sum:s.sum+l.weight*c.order,weight:s.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:r}})}var Kt=He,iq=sq;function sq(e,t){var r={};Kt.forEach(e,function(i,s){var o=r[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};Kt.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),Kt.forEach(t.edges(),function(i){var s=r[i.v],o=r[i.w];!Kt.isUndefined(s)&&!Kt.isUndefined(o)&&(o.indegree++,s.out.push(r[i.w]))});var n=Kt.filter(r,function(i){return!i.indegree});return oq(n)}function oq(e){var t=[];function r(s){return function(o){o.merged||(Kt.isUndefined(o.barycenter)||Kt.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&aq(s,o)}}function n(s){return function(o){o.in.push(s),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),Kt.forEach(i.in.reverse(),r(i)),Kt.forEach(i.out,n(i))}return Kt.map(Kt.filter(t,function(s){return!s.merged}),function(s){return Kt.pick(s,["vs","i","barycenter","weight"])})}function aq(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var ho=He,lq=Ht,cq=uq;function uq(e,t){var r=lq.partition(e,function(d){return ho.has(d,"barycenter")}),n=r.lhs,i=ho.sortBy(r.rhs,function(d){return-d.i}),s=[],o=0,l=0,c=0;n.sort(dq(!!t)),c=AS(s,i,c),ho.forEach(n,function(d){c+=d.vs.length,s.push(d.vs),o+=d.barycenter*d.weight,l+=d.weight,c=AS(s,i,c)});var u={vs:ho.flatten(s,!0)};return l&&(u.barycenter=o/l,u.weight=l),u}function AS(e,t,r){for(var n;t.length&&(n=ho.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function dq(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var In=He,fq=rq,pq=iq,hq=cq,mq=AT;function AT(e,t,r,n){var i=e.children(t),s=e.node(t),o=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,c={};o&&(i=In.filter(i,function(y){return y!==o&&y!==l}));var u=fq(e,i);In.forEach(u,function(y){if(e.children(y.v).length){var g=AT(e,y.v,r,n);c[y.v]=g,In.has(g,"barycenter")&&vq(y,g)}});var d=pq(u,r);gq(d,c);var f=hq(d,n);if(o&&(f.vs=In.flatten([o,f.vs,l],!0),e.predecessors(o).length)){var h=e.node(e.predecessors(o)[0]),p=e.node(e.predecessors(l)[0]);In.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+h.order+p.order)/(f.weight+2),f.weight+=2}return f}function gq(e,t){In.forEach(e,function(r){r.vs=In.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function vq(e,t){In.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var mo=He,xq=Rr.Graph,yq=bq;function bq(e,t,r){var n=wq(e),i=new xq({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(s){return e.node(s)});return mo.forEach(e.nodes(),function(s){var o=e.node(s),l=e.parent(s);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(s),i.setParent(s,l||n),mo.forEach(e[r](s),function(c){var u=c.v===s?c.w:c.v,d=i.edge(u,s),f=mo.isUndefined(d)?0:d.weight;i.setEdge(u,s,{weight:e.edge(c).weight+f})}),mo.has(o,"minRank")&&i.setNode(s,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function wq(e){for(var t;e.hasNode(t=mo.uniqueId("_root")););return t}var _q=He,Sq=jq;function jq(e,t,r){var n={},i;_q.forEach(r,function(s){for(var o=e.parent(s),l,c;o;){if(l=e.parent(o),l?(c=n[l],n[l]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=l}})}var Un=He,kq=Qz,Nq=Jz,Cq=mq,Eq=yq,Tq=Sq,Rq=Rr.Graph,IS=Ht,Aq=Iq;function Iq(e){var t=IS.maxRank(e),r=MS(e,Un.range(1,t+1),"inEdges"),n=MS(e,Un.range(t-1,-1,-1),"outEdges"),i=kq(e);PS(e,i);for(var s=Number.POSITIVE_INFINITY,o,l=0,c=0;c<4;++l,++c){Mq(l%2?r:n,l%4>=2),i=IS.buildLayerMatrix(e);var u=Nq(e,i);u<s&&(c=0,o=Un.cloneDeep(i),s=u)}PS(e,o)}function MS(e,t,r){return Un.map(t,function(n){return Eq(e,n,r)})}function Mq(e,t){var r=new Rq;Un.forEach(e,function(n){var i=n.graph().root,s=Cq(n,i,r,t);Un.forEach(s.vs,function(o,l){n.node(o).order=l}),Tq(n,r,s.vs)})}function PS(e,t){Un.forEach(t,function(r){Un.forEach(r,function(n,i){e.node(n).order=i})})}var me=He,Pq=Rr.Graph,Oq=Ht,Dq={positionX:Gq};function Lq(e,t){var r={};function n(i,s){var o=0,l=0,c=i.length,u=me.last(s);return me.forEach(s,function(d,f){var h=zq(e,d),p=h?e.node(h).order:c;(h||d===u)&&(me.forEach(s.slice(l,f+1),function(y){me.forEach(e.predecessors(y),function(g){var w=e.node(g),v=w.order;(v<o||p<v)&&!(w.dummy&&e.node(y).dummy)&&IT(r,g,y)})}),l=f+1,o=p)}),s}return me.reduce(t,n),r}function Fq(e,t){var r={};function n(s,o,l,c,u){var d;me.forEach(me.range(o,l),function(f){d=s[f],e.node(d).dummy&&me.forEach(e.predecessors(d),function(h){var p=e.node(h);p.dummy&&(p.order<c||p.order>u)&&IT(r,h,d)})})}function i(s,o){var l=-1,c,u=0;return me.forEach(o,function(d,f){if(e.node(d).dummy==="border"){var h=e.predecessors(d);h.length&&(c=e.node(h[0]).order,n(o,u,f,l,c),u=f,l=c)}n(o,u,o.length,c,s.length)}),o}return me.reduce(t,i),r}function zq(e,t){if(e.node(t).dummy)return me.find(e.predecessors(t),function(r){return e.node(r).dummy})}function IT(e,t,r){if(t>r){var n=t;t=r,r=n}var i=e[t];i||(e[t]=i={}),i[r]=!0}function qq(e,t,r){if(t>r){var n=t;t=r,r=n}return me.has(e[t],r)}function $q(e,t,r,n){var i={},s={},o={};return me.forEach(t,function(l){me.forEach(l,function(c,u){i[c]=c,s[c]=c,o[c]=u})}),me.forEach(t,function(l){var c=-1;me.forEach(l,function(u){var d=n(u);if(d.length){d=me.sortBy(d,function(g){return o[g]});for(var f=(d.length-1)/2,h=Math.floor(f),p=Math.ceil(f);h<=p;++h){var y=d[h];s[u]===u&&c<o[y]&&!qq(r,u,y)&&(s[y]=u,s[u]=i[u]=i[y],c=o[y])}}})}),{root:i,align:s}}function Bq(e,t,r,n,i){var s={},o=Hq(e,t,r,i),l=i?"borderLeft":"borderRight";function c(f,h){for(var p=o.nodes(),y=p.pop(),g={};y;)g[y]?f(y):(g[y]=!0,p.push(y),p=p.concat(h(y))),y=p.pop()}function u(f){s[f]=o.inEdges(f).reduce(function(h,p){return Math.max(h,s[p.v]+o.edge(p))},0)}function d(f){var h=o.outEdges(f).reduce(function(y,g){return Math.min(y,s[g.w]-o.edge(g))},Number.POSITIVE_INFINITY),p=e.node(f);h!==Number.POSITIVE_INFINITY&&p.borderType!==l&&(s[f]=Math.max(s[f],h))}return c(u,o.predecessors.bind(o)),c(d,o.successors.bind(o)),me.forEach(n,function(f){s[f]=s[r[f]]}),s}function Hq(e,t,r,n){var i=new Pq,s=e.graph(),o=Kq(s.nodesep,s.edgesep,n);return me.forEach(t,function(l){var c;me.forEach(l,function(u){var d=r[u];if(i.setNode(d),c){var f=r[c],h=i.edge(f,d);i.setEdge(f,d,Math.max(o(e,u,c),h||0))}c=u})}),i}function Wq(e,t){return me.minBy(me.values(t),function(r){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return me.forIn(r,function(s,o){var l=Yq(e,o)/2;n=Math.max(s+l,n),i=Math.min(s-l,i)}),n-i})}function Uq(e,t){var r=me.values(t),n=me.min(r),i=me.max(r);me.forEach(["u","d"],function(s){me.forEach(["l","r"],function(o){var l=s+o,c=e[l],u;if(c!==t){var d=me.values(c);u=o==="l"?n-me.min(d):i-me.max(d),u&&(e[l]=me.mapValues(c,function(f){return f+u}))}})})}function Vq(e,t){return me.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var i=me.sortBy(me.map(e,n));return(i[1]+i[2])/2})}function Gq(e){var t=Oq.buildLayerMatrix(e),r=me.merge(Lq(e,t),Fq(e,t)),n={},i;me.forEach(["u","d"],function(o){i=o==="u"?t:me.values(t).reverse(),me.forEach(["l","r"],function(l){l==="r"&&(i=me.map(i,function(f){return me.values(f).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),u=$q(e,i,r,c),d=Bq(e,i,u.root,u.align,l==="r");l==="r"&&(d=me.mapValues(d,function(f){return-f})),n[o+l]=d})});var s=Wq(e,n);return Uq(n,s),Vq(n,e.graph().align)}function Kq(e,t,r){return function(n,i,s){var o=n.node(i),l=n.node(s),c=0,u;if(c+=o.width/2,me.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":u=-o.width/2;break;case"r":u=o.width/2;break}if(u&&(c+=r?u:-u),u=0,c+=(o.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,me.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":u=l.width/2;break;case"r":u=-l.width/2;break}return u&&(c+=r?u:-u),u=0,c}}function Yq(e,t){return e.node(t).width}var go=He,MT=Ht,Xq=Dq.positionX,Qq=Zq;function Zq(e){e=MT.asNonCompoundGraph(e),Jq(e),go.forEach(Xq(e),function(t,r){e.node(r).x=t})}function Jq(e){var t=MT.buildLayerMatrix(e),r=e.graph().ranksep,n=0;go.forEach(t,function(i){var s=go.max(go.map(i,function(o){return e.node(o).height}));go.forEach(i,function(o){e.node(o).y=n+s/2}),n+=s+r})}var xe=He,OS=HF,DS=oz,e$=Rz,t$=Ht.normalizeRanks,r$=Pz,n$=Ht.removeEmptyRanks,LS=Fz,i$=Wz,FS=Vz,s$=Aq,o$=Qq,Yn=Ht,a$=Rr.Graph,l$=c$;function c$(e,t){var r=t&&t.debugTiming?Yn.time:Yn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return b$(e)});r("  runLayout",function(){u$(n,r)}),r("  updateInputGraph",function(){d$(e,n)})})}function u$(e,t){t("    makeSpaceForEdgeLabels",function(){w$(e)}),t("    removeSelfEdges",function(){R$(e)}),t("    acyclic",function(){OS.run(e)}),t("    nestingGraph.run",function(){LS.run(e)}),t("    rank",function(){e$(Yn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){_$(e)}),t("    removeEmptyRanks",function(){n$(e)}),t("    nestingGraph.cleanup",function(){LS.cleanup(e)}),t("    normalizeRanks",function(){t$(e)}),t("    assignRankMinMax",function(){S$(e)}),t("    removeEdgeLabelProxies",function(){j$(e)}),t("    normalize.run",function(){DS.run(e)}),t("    parentDummyChains",function(){r$(e)}),t("    addBorderSegments",function(){i$(e)}),t("    order",function(){s$(e)}),t("    insertSelfEdges",function(){A$(e)}),t("    adjustCoordinateSystem",function(){FS.adjust(e)}),t("    position",function(){o$(e)}),t("    positionSelfEdges",function(){I$(e)}),t("    removeBorderNodes",function(){T$(e)}),t("    normalize.undo",function(){DS.undo(e)}),t("    fixupEdgeLabelCoords",function(){C$(e)}),t("    undoCoordinateSystem",function(){FS.undo(e)}),t("    translateGraph",function(){k$(e)}),t("    assignNodeIntersects",function(){N$(e)}),t("    reversePoints",function(){E$(e)}),t("    acyclic.undo",function(){OS.undo(e)})}function d$(e,t){xe.forEach(e.nodes(),function(r){var n=e.node(r),i=t.node(r);n&&(n.x=i.x,n.y=i.y,t.children(r).length&&(n.width=i.width,n.height=i.height))}),xe.forEach(e.edges(),function(r){var n=e.edge(r),i=t.edge(r);n.points=i.points,xe.has(i,"x")&&(n.x=i.x,n.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var f$=["nodesep","edgesep","ranksep","marginx","marginy"],p$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},h$=["acyclicer","ranker","rankdir","align"],m$=["width","height"],g$={width:0,height:0},v$=["minlen","weight","width","height","labeloffset"],x$={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},y$=["labelpos"];function b$(e){var t=new a$({multigraph:!0,compound:!0}),r=Zm(e.graph());return t.setGraph(xe.merge({},p$,Qm(r,f$),xe.pick(r,h$))),xe.forEach(e.nodes(),function(n){var i=Zm(e.node(n));t.setNode(n,xe.defaults(Qm(i,m$),g$)),t.setParent(n,e.parent(n))}),xe.forEach(e.edges(),function(n){var i=Zm(e.edge(n));t.setEdge(n,xe.merge({},x$,Qm(i,v$),xe.pick(i,y$)))}),t}function w$(e){var t=e.graph();t.ranksep/=2,xe.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function _$(e){xe.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-n.rank)/2+n.rank,e:t};Yn.addDummyNode(e,"edge-proxy",s,"_ep")}})}function S$(e){var t=0;xe.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=xe.max(t,n.maxRank))}),e.graph().maxRank=t}function j$(e){xe.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function k$(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,i=0,s=e.graph(),o=s.marginx||0,l=s.marginy||0;function c(u){var d=u.x,f=u.y,h=u.width,p=u.height;t=Math.min(t,d-h/2),r=Math.max(r,d+h/2),n=Math.min(n,f-p/2),i=Math.max(i,f+p/2)}xe.forEach(e.nodes(),function(u){c(e.node(u))}),xe.forEach(e.edges(),function(u){var d=e.edge(u);xe.has(d,"x")&&c(d)}),t-=o,n-=l,xe.forEach(e.nodes(),function(u){var d=e.node(u);d.x-=t,d.y-=n}),xe.forEach(e.edges(),function(u){var d=e.edge(u);xe.forEach(d.points,function(f){f.x-=t,f.y-=n}),xe.has(d,"x")&&(d.x-=t),xe.has(d,"y")&&(d.y-=n)}),s.width=r-t+o,s.height=i-n+l}function N$(e){xe.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),i=e.node(t.w),s,o;r.points?(s=r.points[0],o=r.points[r.points.length-1]):(r.points=[],s=i,o=n),r.points.unshift(Yn.intersectRect(n,s)),r.points.push(Yn.intersectRect(i,o))})}function C$(e){xe.forEach(e.edges(),function(t){var r=e.edge(t);if(xe.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function E$(e){xe.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function T$(e){xe.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),i=e.node(r.borderBottom),s=e.node(xe.last(r.borderLeft)),o=e.node(xe.last(r.borderRight));r.width=Math.abs(o.x-s.x),r.height=Math.abs(i.y-n.y),r.x=s.x+r.width/2,r.y=n.y+r.height/2}}),xe.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function R$(e){xe.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function A$(e){var t=Yn.buildLayerMatrix(e);xe.forEach(t,function(r){var n=0;xe.forEach(r,function(i,s){var o=e.node(i);o.order=s+n,xe.forEach(o.selfEdges,function(l){Yn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:o.rank,order:s+ ++n,e:l.e,label:l.label},"_se")}),delete o.selfEdges})})}function I$(e){xe.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),i=n.x+n.width/2,s=n.y,o=r.x-i,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:i+2*o/3,y:s-l},{x:i+5*o/6,y:s-l},{x:i+o,y:s},{x:i+5*o/6,y:s+l},{x:i+2*o/3,y:s+l}],r.label.x=r.x,r.label.y=r.y}})}function Qm(e,t){return xe.mapValues(xe.pick(e,t),Number)}function Zm(e){var t={};return xe.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var tl=He,M$=Ht,P$=Rr.Graph,O$={debugOrdering:D$};function D$(e){var t=M$.buildLayerMatrix(e),r=new P$({compound:!0,multigraph:!0}).setGraph({});return tl.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),tl.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),tl.forEach(t,function(n,i){var s="layer"+i;r.setNode(s,{rank:"same"}),tl.reduce(n,function(o,l){return r.setEdge(o,l,{style:"invis"}),l})}),r}var L$="0.8.5",F$={graphlib:Rr,layout:l$,debug:O$,util:{time:Ht.time,notime:Ht.notime},version:L$};const cc=$v(F$),zS=(e,t)=>{const r=new cc.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),cc.layout(r),{nodes:e.map(n=>{const i=r.node(n.id);return{...n,targetPosition:oe.Top,sourcePosition:oe.Bottom,position:{x:i.x-(n.data.width??280)/2,y:i.y-(n.data.height??90)/2}}}),edges:t}},qS=(e,t,r)=>{let n=[],i=[],s=null,o=null,l=[];const c=r.theme||"industrial";return e.forEach((u,d)=>{var y,g;if((u.level||1)!==1)return;const f=280;let h=95;u.state==="active"&&u.stations&&(h+=35);const p=t===u.id;if(n.push({id:u.id,type:"documentNode",data:{...u,width:f,height:h,isExpanded:p,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:p?1e3:0}),s){const w=(y=e[d-1])==null?void 0:y.state;i.push({id:"e-"+s+"-"+u.id,source:s,target:u.id,type:"smoothstep",animated:w==="active",style:{stroke:gE(w,c),strokeWidth:3}})}((g=u.children)==null?void 0:g.length)>0&&(o=u.id,l=u.children),s=u.id}),{nodes:n,edges:i,epicBacklogId:o,epicChildren:l}},$S=(e,t,r,n,i)=>{const{nodes:s,edges:o}=e;if(!t||!r.length)return{nodes:s,edges:o};const l=s.find(b=>b.id===t);if(!l)return{nodes:s,edges:o};const c=l.position.x,u=l.position.y+(l.data.height||95),d=l.data.state,f=i.theme||"industrial",h=gE(d,f),p=d==="active",y=vr.EPIC_HEIGHT+vr.EPIC_GAP_Y,g=Math.ceil(r.length/vr.EPICS_PER_ROW),w=c+280*.15,v=50,x={};r.forEach((b,_)=>{const S=Math.floor(_/vr.EPICS_PER_ROW);x[S]||(x[S]=[]),x[S].push({epic:b,idx:_})});for(let b=0;b<g;b++){const _=x[b]||[];if(_.length===0)continue;const S=u+vr.EPIC_OFFSET_Y+b*y,k=`junction-row-${b}`;s.push({id:k,type:"waypoint",position:{x:w,y:S-v},draggable:!1,connectable:!1,selectable:!1}),b===0?o.push({id:`e-spine-drop-${b}`,source:t,target:k,type:"straight",animated:p,style:{stroke:h,strokeWidth:2}}):o.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:k,type:"straight",animated:p,style:{stroke:h,strokeWidth:2}}),_.forEach(({epic:N,idx:E})=>{const j=E%vr.EPICS_PER_ROW,R=c+vr.EPIC_OFFSET_X+j*(vr.EPIC_WIDTH+vr.EPIC_GAP_X),T=S,P=n===N.id;s.push({id:N.id,type:"documentNode",data:{...N,width:vr.EPIC_WIDTH,height:vr.EPIC_HEIGHT,isExpanded:P,...i},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:oe.Top,sourcePosition:oe.Bottom,zIndex:P?1e3:0}),o.push({id:`e-branch-${N.id}`,source:k,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:p,style:{stroke:h,strokeWidth:2}})})}return{nodes:s,edges:o}},z$={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},BS={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function q$(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function $$(e,t=[]){const r=[],n=[],i={};for(const s of e.tracks){const o=B$(s,t);if((s.scope||"project")==="project")n.push({...o,mayOwn:s.may_own||[],childDocType:s.child_doc_type});else{const c=s.document_type;i[c]||(i[c]=[]),i[c].push(o)}}for(const s of n)s.childDocType&&i[s.childDocType]&&(s.children=i[s.childDocType].map(o=>({...o,level:2}))),r.push(s);return r}function B$(e,t=[]){const r=z$[e.state]||"ready_for_production",n=e.state==="awaiting_operator",i=t.find(l=>l.document_type===e.document_type);let s=null;(r==="in_production"||n)&&(s=H$(e.stations,e.state,e.station));let o=null;return i&&i.questions&&(o=i.questions.map((l,c)=>({id:l.id||`q${c+1}`,text:l.question||l.text||l,required:l.required!==!1}))),{id:e.document_type,name:e.document_name||W$(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:s,questions:o,interruptId:i==null?void 0:i.id,blockedBy:e.blocked_by||[]}}function H$(e,t,r){if(!e||e.length===0){const n=r||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return id.map(i=>({id:i,label:BS[i]||i.toUpperCase(),state:n===i?"active":id.indexOf(i)<id.indexOf(n)?"complete":"pending",needs_input:i==="pgc"&&t==="awaiting_operator"}))}return e.map(n=>({id:n.station,label:BS[n.station]||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function W$(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function U$({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,i]=m.useState(!0),[s,o]=m.useState(null),l=m.useCallback(async()=>{i(!0),o(null);try{const u=await $e.getProjects({includeArchived:e}),d=q$(u);r(d)}catch(u){o(u.message),console.error("Failed to fetch projects:",u)}finally{i(!1)}},[e]),c=m.useCallback(async u=>{try{const d=await $e.createProject({name:u,description:""});return r(f=>({...f,[d.id]:{id:d.id,projectId:d.project_id,name:d.name,description:d.description||"",status:"active",icon:d.icon,createdAt:d.created_at}})),d}catch(d){throw o(d.message),console.error("Failed to create project:",d),d}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:s,addProject:c,refresh:l}}function V$(e){const[t,r]=m.useState([]),[n,i]=m.useState("idle"),[s,o]=m.useState([]),[l,c]=m.useState(!0),[u,d]=m.useState(null),[f,h]=m.useState(!1),p=m.useRef(null),y=m.useRef(null),g=m.useCallback(async()=>{if(e)try{c(!0),d(null);const[_,S]=await Promise.all([$e.getProductionStatus(e),$e.getProjectInterrupts(e).catch(()=>[])]);o(S),i(_.line_state),r($$(_,S))}catch(_){d(_.message),console.error("Failed to fetch production status:",_)}finally{c(!1)}},[e]),w=m.useCallback(()=>{if(!e)return;p.current&&p.current.close();const _=a6(e);p.current=_,_.addEventListener("connected",()=>{h(!0),d(null),console.log(`SSE connected for project ${e}`)}),_.addEventListener("station_transition",S=>{try{const k=JSON.parse(S.data);console.log("Station transition:",k),g()}catch(k){console.error("Failed to parse station_transition:",k)}}),_.addEventListener("line_stopped",S=>{try{const k=JSON.parse(S.data);console.log("Line stopped:",k),i("stopped"),g()}catch(k){console.error("Failed to parse line_stopped:",k)}}),_.addEventListener("production_complete",S=>{try{const k=JSON.parse(S.data);console.log("Production complete:",k),i("complete"),g()}catch(k){console.error("Failed to parse production_complete:",k)}}),_.addEventListener("interrupt_resolved",S=>{try{const k=JSON.parse(S.data);console.log("Interrupt resolved:",k),g()}catch(k){console.error("Failed to parse interrupt_resolved:",k)}}),_.addEventListener("track_started",S=>{try{const k=JSON.parse(S.data);console.log("Track started:",k),i("active"),g()}catch(k){console.error("Failed to parse track_started:",k)}}),_.onerror=S=>{console.error("SSE error:",S),h(!1),d("Connection lost"),_.close(),y.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),w()},3e3)}},[e,g]),v=m.useCallback(()=>{y.current&&clearTimeout(y.current),p.current&&(p.current.close(),p.current=null),h(!1)},[]),x=m.useCallback(async(_,S)=>{try{await $e.resolveInterrupt(_,{answers:S}),await g()}catch(k){throw console.error("Failed to resolve interrupt:",k),k}},[g]),b=m.useCallback(async(_=null)=>{try{await $e.startProduction(e,_),i("active"),await g()}catch(S){throw console.error("Failed to start production:",S),S}},[e,g]);return m.useEffect(()=>(g(),w(),()=>v()),[g,w,v]),{data:t,lineState:n,interrupts:s,loading:l,error:u,connected:f,refresh:g,resolveInterrupt:x,startProduction:b}}const HS="combine-theme";function PT(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const s=localStorage.getItem(HS);return s&&An.includes(s)?s:e});m.useEffect(()=>{localStorage.setItem(HS,t)},[t]);const n=m.useCallback(s=>{An.includes(s)&&r(s)},[]),i=m.useCallback(()=>{r(s=>{const o=An.indexOf(s);return An[(o+1)%An.length]})},[]);return{theme:t,setTheme:n,cycleTheme:i}}function G$(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[i,s]=m.useState([]),[o,l]=m.useState(null),[c,u]=m.useState(null),[d,f]=m.useState({}),[h,p]=m.useState(0),[y,g]=m.useState([]),[w,v]=m.useState(!1),[x,b]=m.useState(null),[_,S]=m.useState(null),[k,N]=m.useState(null),[E,j]=m.useState(!1),[R,T]=m.useState(!1),P=m.useRef(null),z=m.useRef(!0);m.useEffect(()=>(z.current=!0,()=>{z.current=!1,P.current&&P.current.close()}),[]);const C=m.useCallback(M=>{z.current&&(n(M.phase),s(M.messages||[]),l(M.pending_prompt),u(M.pending_choices),f(M.interpretation||{}),p(M.confidence||0),g(M.missing_fields||[]),v(M.can_initialize||!1),b(M.gate_outcome),S(M.project))},[]),L=m.useCallback(async()=>{N(null),j(!0);try{const M=await $e.startIntake();if(!z.current)return;t(M.execution_id),n(M.phase||"describe"),l(M.pending_prompt),s([]),f({}),S(null),b(null)}catch(M){if(!z.current)return;N(M.message||"Failed to start intake")}finally{z.current&&j(!1)}},[]),O=m.useCallback(async M=>{if(!e||!M.trim())return;N(null),T(!0);const q={role:"user",content:M};s(W=>[...W,q]);try{const W=await $e.submitIntakeMessage(e,M);if(!z.current)return;C(W)}catch(W){if(!z.current)return;s(B=>B.filter(K=>K!==q)),N(W.message||"Failed to submit message")}finally{z.current&&T(!1)}},[e,C]),$=m.useCallback(async(M,q)=>{if(e){N(null),f(W=>({...W,[M]:{value:q,source:"user",locked:!0}}));try{const W=await $e.updateIntakeField(e,M,q);if(!z.current)return;C(W)}catch(W){if(!z.current)return;N(W.message||"Failed to update field");const B=await $e.getIntakeState(e);z.current&&C(B)}}},[e,C]),D=m.useCallback(async()=>{if(!(!e||!w)){N(null),j(!0);try{const M=await $e.initializeIntake(e);if(!z.current)return;C(M),M.phase==="generating"&&A()}catch(M){if(!z.current)return;N(M.message||"Failed to initialize project"),j(!1)}}},[e,w,C]),A=m.useCallback(()=>{P.current&&P.current.close();const M=l6(e);P.current=M,M.addEventListener("started",q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake started:",W)}),M.addEventListener("progress",q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake progress:",W.current_node)}),M.addEventListener("complete",async q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake complete:",W),M.close(),P.current=null,n("complete"),b(W.gate_outcome),S(W.project),j(!1)}),M.addEventListener("error",q=>{if(z.current&&M.readyState!==EventSource.CLOSED){try{const W=JSON.parse(q.data);N(W.message||"Generation failed")}catch{N("Connection lost during generation")}M.close(),P.current=null,j(!1)}}),M.onerror=()=>{z.current&&M.readyState===EventSource.CLOSED&&(P.current=null,j(!1))}},[e]),F=m.useCallback(()=>{P.current&&(P.current.close(),P.current=null),t(null),n("idle"),s([]),l(null),u(null),f({}),p(0),g([]),v(!1),b(null),S(null),N(null),j(!1),T(!1)},[]);return{executionId:e,phase:r,messages:i,pendingPrompt:o,pendingChoices:c,interpretation:d,confidence:h,missingFields:y,canInitialize:w,gateOutcome:x,project:_,error:k,loading:E,submitting:R,startIntake:L,submitMessage:O,updateField:$,lockAndGenerate:D,reset:F}}const OT=m.createContext(null);function K$({children:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{i(!0),o(null);try{const f=await $e.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),o(f.message),r(null)}finally{i(!1)}},[]),c=m.useCallback(f=>{window.location.href=c6(f)},[]),u=m.useCallback(async()=>{try{await $e.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),d={user:t,loading:n,error:s,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:u,checkAuth:l};return a.jsx(OT.Provider,{value:d,children:e})}function Ds(){const e=m.useContext(OT);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function Y$(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useCallback(async()=>{s(!0),l(null);try{let d=await Se.getCurrentWorkspace();d||(d=await Se.createWorkspace()),t(d.workspace_id),n(d.branch)}catch(d){l(d.message),console.error("Failed to initialize workspace:",d)}finally{s(!1)}},[]),u=m.useCallback(async(d=!1)=>{if(e)try{await Se.closeWorkspace(e,d),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:i,error:o,closeWorkspace:u,reinitialize:c}}function X$(e,t=1e4){var d,f;const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useRef(null),u=m.useCallback(async()=>{if(!e){n(null),s(!1);return}try{const h=await Se.getWorkspaceState(e);n(h),l(null)}catch(h){l(h.message),console.error("Failed to fetch workspace state:",h)}finally{s(!1)}},[e]);return m.useEffect(()=>{e&&(s(!0),u())},[e,u]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(u,t),()=>{c.current&&clearInterval(c.current)}},[e,t,u]),{state:r,loading:i,error:o,refresh:u,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((d=r==null?void 0:r.tier1)==null?void 0:d.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function Q$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await Se.getDocumentTypes();t(l.document_types||[])}catch(l){s(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{documentTypes:e,loading:r,error:i,refresh:o}}function Z$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await Se.getRoles();t(l.roles||[])}catch(l){s(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{roles:e,loading:r,error:i,refresh:o}}function _a(e,t,{debounceMs:r=500,onSave:n}={}){const[i,s]=m.useState(""),[o,l]=m.useState(""),[c,u]=m.useState(!0),[d,f]=m.useState(null),[h,p]=m.useState(!1),[y,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){s(""),l(""),u(!1);return}u(!0),f(null);try{const E=await Se.getArtifact(e,t);s(E.content),l(E.content)}catch(E){f(E.message),console.error("Failed to load artifact:",E)}finally{u(!1)}},[e,t]),b=m.useCallback(async E=>{if(!(!e||!t)){p(!0),f(null);try{const j=await Se.writeArtifact(e,t,E);g(j),l(E),n&&n(j)}catch(j){f(j.message),console.error("Failed to save artifact:",j)}finally{p(!1)}}},[e,t,n]),_=m.useCallback(E=>{v.current=E,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),S=m.useCallback(E=>{s(E),E!==o&&_(E)},[o,_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),v.current=null,s(o)},[o]),N=m.useCallback(()=>{w.current&&clearTimeout(w.current),i!==o&&b(i)},[i,o,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{content:i,originalContent:o,loading:c,error:d,saving:h,lastSaveResult:y,isDirty:i!==o,updateContent:S,reset:k,saveNow:N,reload:x}}const J$={documentNode:A6,waypoint:I6},eB={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function tB({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:i,theme:s,onThemeChange:o,onProjectUpdate:l,onProjectArchive:c,onProjectUnarchive:u,onProjectDelete:d}){const{data:f,lineState:h,loading:p,error:y,connected:g,resolveInterrupt:w}=V$(e),[v,x]=m.useState([]),[b,_]=m.useState(null),[S,k]=m.useState(null),[N,E]=m.useState(null),[j,R]=m.useState(!1),[T,P]=m.useState(""),[z,C]=m.useState(!1),[L,O]=m.useState(!1),[$,D]=m.useState(!1),A=Uc();m.useEffect(()=>{f.length>0&&x(f)},[f]),m.useEffect(()=>{i&&v.length>0&&setTimeout(()=>{_(i),k("questions")},300)},[i,v.length]),m.useEffect(()=>{_(null),k(null)},[e]);const F=m.useCallback(()=>{const Y=An.indexOf(s);o(An[(Y+1)%An.length])},[s,o]),M=m.useCallback(()=>{P(r||""),R(!0)},[r]),q=m.useCallback(async()=>{if(!T.trim()||T===r){R(!1);return}O(!0);try{await l(e,{name:T.trim()}),R(!1)}catch(Y){console.error("Failed to update name:",Y)}finally{O(!1)}},[T,r,e,l]),W=m.useCallback(()=>{R(!1),P("")},[]),B=m.useCallback(async()=>{O(!0);try{n?await u(e):await c(e)}catch(Y){console.error("Failed to toggle archive:",Y)}finally{O(!1)}},[e,n,c,u]),K=m.useCallback(async()=>{O(!0);try{await d(e),C(!1)}catch(Y){console.error("Failed to delete:",Y)}finally{O(!1)}},[e,d]),Z=m.useCallback(Y=>{const X=A.getNode(Y);if(X){const he=window.innerWidth,_e=-X.position.x*.9+he/2-400,ge=-X.position.y*.9+120;A.setViewport({x:_e,y:ge,zoom:.9},{duration:800})}},[A]),re=m.useMemo(()=>({onExpand:(Y,X)=>{_(Y),k(X)},onCollapse:()=>{_(null),k(null),setTimeout(()=>A.fitView({padding:.2,duration:300}),50)},onViewFullDocument:Y=>{E(Y)},onSubmitQuestions:async(Y,X)=>{console.log("Submitted:",Y,X);const ue=v.find(he=>he.id===Y);if(ue!=null&&ue.interruptId)try{await w(ue.interruptId,X)}catch(he){console.error("Failed to submit answers:",he)}_(null),k(null),x(he=>{const _e=ge=>ge.map(Q=>Q.id===Y&&Q.stations?{...Q,stations:Q.stations.map(pe=>pe.id==="pgc"?{...pe,state:"complete",needs_input:!1}:pe.id==="asm"?{...pe,state:"active"}:pe)}:Q.children?{...Q,children:_e(Q.children)}:Q);return _e(he)})}}),[A,v,w]),{layoutNodes:ne,layoutEdges:V}=m.useMemo(()=>{if(v.length===0)return{layoutNodes:[],layoutEdges:[]};const Y={...re,expandType:S,theme:s,onZoomToNode:Z,projectId:e,projectCode:t},{nodes:X,edges:ue,epicBacklogId:he,epicChildren:_e}=qS(v,b,Y),ge=zS(X,ue),{nodes:Q,edges:pe}=$S(ge,he,_e,b,Y);return{layoutNodes:Q.map(Re=>({...Re,data:{...Re.data,expandType:Re.id===b?S:null}})),layoutEdges:pe}},[v,b,S,re,s,Z,e,t]),[ee,ve,fe]=dE(ne),[be,ce,te]=fE(V);m.useEffect(()=>{if(v.length===0)return;const Y={...re,expandType:S,theme:s,onZoomToNode:Z,projectId:e,projectCode:t},{nodes:X,edges:ue,epicBacklogId:he,epicChildren:_e}=qS(v,b,Y),ge=zS(X,ue),{nodes:Q,edges:pe}=$S(ge,he,_e,b,Y),We=Q.map(Re=>({...Re,data:{...Re.data,expandType:Re.id===b?S:null}}));ve(We),ce(pe)},[v,b,S,re,ve,ce,s,Z,e,t]);const we=m.useCallback((Y,X)=>{},[]);return p&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):y&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:a.jsx("p",{className:"text-red-500 mb-4",children:y})})}):a.jsxs("div",{className:"w-full h-full",children:[a.jsxs(Qx,{nodes:ee,edges:be,onNodesChange:fe,onEdgesChange:te,onNodeClick:we,nodeTypes:J$,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[a.jsx(Hn,{position:"top-left",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),a.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[h==="active"&&a.jsx("span",{className:"text-amber-500",children:" Active"}),h==="stopped"&&a.jsx("span",{className:"text-red-500",children:" Stopped"}),h==="complete"&&a.jsx("span",{className:"text-emerald-500",children:" Complete"}),h==="idle"&&a.jsx("span",{children:" Idle"}),!g&&a.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),a.jsx("button",{onClick:F,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:eB[s]})]})}),a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:a.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),j?a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("input",{type:"text",value:T,onChange:Y=>P(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&q(),Y.key==="Escape"&&W()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:L}),a.jsx("button",{onClick:q,disabled:L,className:"p-1 rounded hover:bg-white/10",title:"Save",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{onClick:W,disabled:L,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:a.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!j&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:M,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{onClick:B,disabled:L,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:a.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&a.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),a.jsx("button",{onClick:()=>C(!0),disabled:L||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[a.jsxs("button",{onClick:()=>D(!$),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[a.jsx("span",{children:"Workflow"}),a.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:$?"":""})]}),$&&a.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:a.jsx(F6,{projectId:e})})]})]})}),a.jsx(mE,{position:"top-right",nodeColor:Y=>{var ue;const X=(ue=Y.data)==null?void 0:ue.state;return["produced","stabilized","ready"].includes(X)?"#10b981":["in_production","active"].includes(X)?"#f59e0b":["requirements_not_met","blocked"].includes(X)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hn,{position:"bottom-left",children:a.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[a.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),a.jsx(Hn,{position:"bottom-right",children:a.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),N&&a.jsx(M6,{projectId:e,projectCode:t,docTypeId:N,onClose:()=>E(null)}),z&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:a.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),a.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",a.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>C(!1),disabled:L,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{onClick:K,disabled:L,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:L?"Deleting...":"Delete"})]})]})})]})}function rl({messages:e,pendingPrompt:t}){const r=m.useRef(null);return m.useEffect(()=>{var n;(n=r.current)==null||n.scrollIntoView({behavior:"smooth"})},[e,t]),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.map((n,i)=>a.jsx("div",{className:`flex ${n.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${n.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:n.content})},i)),t&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),a.jsx("div",{ref:r})]})}function rB({onSubmit:e,disabled:t,placeholder:r}){const[n,i]=m.useState(""),s=m.useRef(null);m.useEffect(()=>{var c;t||(c=s.current)==null||c.focus()},[t]);const o=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),i("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),i(""))};return a.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("textarea",{ref:s,value:n,onChange:c=>i(c.target.value),onKeyDown:o,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),a.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const nB={project_name:"Project Name",problem_statement:"Problem Statement",project_type:"Project Type"},iB=["project_name","problem_statement","project_type"];function sB({interpretation:e,missingFields:t,canInitialize:r,onUpdateField:n,onInitialize:i,loading:s}){const[o,l]=m.useState(null),[c,u]=m.useState(""),d=(p,y)=>{l(p),u(y)},f=async()=>{o&&c.trim()&&(await n(o,c.trim()),l(null),u(""))},h=()=>{l(null),u("")};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Review & Lock"}),t.length>0&&a.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded bg-amber-500/20 text-amber-400",children:[t.length," missing"]})]}),iB.map(p=>{const y=e[p];if(!y)return null;const g=y.locked,w=t.includes(p),v=o===p;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"text-[10px] font-medium",style:{color:"var(--text-muted)"},children:[nB[p]||p,w&&a.jsx("span",{className:"text-amber-400 ml-1",children:"*"})]}),g&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"locked"})]}),v?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:c,onChange:x=>u(x.target.value),onKeyDown:x=>{x.key==="Enter"&&f(),x.key==="Escape"&&h()},autoFocus:!0,className:"flex-1 rounded px-2 py-1.5 text-xs",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:f,className:"px-2 py-1 rounded text-xs bg-emerald-500 text-white",children:"Save"}),a.jsx("button",{onClick:h,className:"px-2 py-1 rounded text-xs",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Cancel"})]}):a.jsx("div",{onClick:()=>!g&&d(p,y.value),className:`rounded px-2 py-1.5 text-xs ${g?"cursor-default":"cursor-pointer hover:bg-white/5"} ${w?"border border-amber-500/50":""}`,style:{background:"var(--bg-input)",color:y.value?"var(--text-primary)":"var(--text-muted)"},children:y.value||"Click to edit..."})]},p)}),a.jsx("button",{onClick:i,disabled:!r||s,className:`w-full py-2.5 rounded-lg text-sm font-medium transition-colors ${r&&!s?"bg-violet-500 text-white hover:bg-violet-400":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:s?"Initializing...":"Lock & Initialize Project"}),!r&&a.jsx("p",{className:"text-[10px] text-center",style:{color:"var(--text-muted)"},children:"Fill all required fields to continue"})]})}function oB(){return a.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[a.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-violet-500/20"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent animate-spin"}),a.jsx("div",{className:"absolute inset-3 rounded-full bg-violet-500/20 animate-pulse"})]}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"Generating Project"}),a.jsx("p",{className:"text-xs text-center max-w-[200px]",style:{color:"var(--text-muted)"},children:"Creating intake document and running quality checks..."}),a.jsxs("div",{className:"flex gap-1 mt-4",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"300ms"}})]})]})}const WS={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function aB({type:e,className:t}){switch(e){case"check":return a.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 9v4M12 17h.01"}),a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function lB({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const i=WS[e]||WS.blocked,s=e==="qualified";return a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:`w-16 h-16 rounded-full ${i.iconBg} flex items-center justify-center mx-auto mb-4`,children:a.jsx(aB,{type:i.icon,className:`w-8 h-8 ${i.iconColor}`})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:i.title}),a.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:i.description}),s&&t&&a.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[a.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),a.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[s&&t&&a.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),a.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function cB({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:i,interpretation:s,missingFields:o,canInitialize:l,gateOutcome:c,project:u,error:d,loading:f,submitting:h,startIntake:p,submitMessage:y,updateField:g,lockAndGenerate:w,reset:v}=G$();m.useEffect(()=>(p(),()=>v()),[]);const x=()=>{v(),e()},b=()=>{u&&t&&t(u),x()},_=()=>{const k=[{id:"describe",label:"Describe"},{id:"review",label:"Review"},{id:"generating",label:"Generate"},{id:"complete",label:"Done"}],N=k.findIndex(E=>E.id===r);return a.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:k.map((E,j)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 py-0.5 rounded ${j===N?"bg-violet-500/30 text-violet-300":j<N?"text-emerald-400":"text-slate-500"}`,children:E.label}),j<k.length-1&&a.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},E.id))})},S=()=>{if(f&&r==="idle")return a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});switch(r){case"describe":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:n,pendingPrompt:i}),a.jsx(rB,{onSubmit:y,disabled:h,placeholder:"Describe what you want to build..."})]});case"review":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:n}),a.jsx("div",{className:"border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx(sB,{interpretation:s,missingFields:o,canInitialize:l,onUpdateField:g,onInitialize:w,loading:f})})]});case"generating":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:n}),a.jsx(oB,{})]});case"complete":return a.jsxs(a.Fragment,{children:[a.jsx(rl,{messages:n}),a.jsx(lB,{gateOutcome:c,project:u,onViewProject:b,onClose:x})]});default:return null}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:a.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),_()]})]}),a.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),d&&a.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:d}),S()]})})}function uB({onClose:e}){const{user:t,logout:r,isAdmin:n}=Ds(),[i,s]=m.useState(null),[o,l]=m.useState([]),[c,u]=m.useState(!1),[d,f]=m.useState(null);m.useEffect(()=>{i==="linked"&&h()},[i]);const h=async()=>{try{u(!0);const S=await fetch("/auth/accounts",{credentials:"include"});if(S.ok){const k=await S.json();l(k.identities||[])}}catch(S){console.error("Failed to load accounts:",S)}finally{u(!1)}},p=S=>{window.location.href=`/auth/accounts/link/${S}`},y=async S=>{var k;if(o.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${S} account?`))try{const N=(k=document.cookie.split("; ").find(j=>j.startsWith("csrf=")||j.startsWith("__Host-csrf=")))==null?void 0:k.split("=")[1],E=await fetch(`/auth/accounts/${S}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(E.ok)f({type:"success",text:"Account unlinked"}),await h();else{const j=await E.json();throw new Error(j.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},g=async()=>{await r(),e()},w=S=>{s(i===S?null:S),f(null)},v={google:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},x=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=S=>{const k={user:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),a.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return k[S]||k.user},_=S=>{switch(S){case"account":return a.jsxs("div",{className:"px-4 py-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return a.jsxs("div",{className:"px-4 py-3",children:[d&&a.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${d.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:d.text}),c?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-2 mb-4",children:o.map(k=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[v[k.provider_id],a.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:k.provider_email})]}),a.jsx("button",{onClick:()=>y(k.provider_id),disabled:o.length<=1,className:`text-xs px-2 py-1 rounded ${o.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},k.provider_id))}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),a.jsxs("button",{onClick:()=>p("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.google,"Google"]}),a.jsxs("button",{onClick:()=>p("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.microsoft,"Microsoft"]})]})]})]});default:return a.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),a.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?a.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),a.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),a.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),a.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),a.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),a.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),x.map(S=>a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("button",{onClick:()=>!S.future&&w(S.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${S.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:S.future,children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:b(S.icon)}),a.jsx("span",{className:"flex-1 text-sm text-left",children:S.label}),S.future?a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):a.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:i===S.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),i===S.id&&!S.future&&a.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:_(S.id)})]},S.id))]}),a.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Ee={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function dB(){return a.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Ee.bg,borderColor:Ee.border},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Ee.textPrimary},children:"THE COMBINE"}),a.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Ee.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function fB(){return a.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Ee.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),a.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Ee.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),a.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Ee.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ee.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ee.textMuted,children:["Learn how The Combine works",a.jsx("span",{"aria-hidden":"true",children:""})]})]})}function pB(){const e=[{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return a.jsx("section",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>a.jsxs("div",{className:"flex-1 text-center group",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Ee.bgElevated,border:`1px solid ${Ee.border}`,color:Ee.textMuted},children:t.icon}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Ee.textPrimary},children:t.title}),a.jsx("p",{className:"text-xs",style:{color:Ee.textMuted},children:t.description}),r<e.length-1&&a.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Ee.border}})]},r))})})}function hB(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return a.jsx("section",{className:"text-center",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>a.jsx("span",{className:"text-xs",style:{color:Ee.textMuted},children:t},r))})})}function mB({onLogin:e}){return a.jsxs("section",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Ee.textSecondary},children:"Ready?"}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ee.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ee.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.bg,border:`1px solid ${Ee.border}`,color:Ee.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ee.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ee.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function gB(){return a.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ee.border},children:" 2026 The Combine"})]})}function vB(){const{login:e}=Ds();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ee.bg},children:[a.jsx(dB,{}),a.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:a.jsxs("div",{className:"space-y-12",children:[a.jsx(fB,{}),a.jsx(pB,{}),a.jsx(hB,{}),a.jsx(mB,{onLogin:e})]})}),a.jsx(gB,{})]})}const ke={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function xB(){return a.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:ke.bg,borderColor:ke.border},children:[a.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:ke.textMuted},onMouseOver:e=>e.currentTarget.style.color=ke.textSecondary,onMouseOut:e=>e.currentTarget.style.color=ke.textMuted,children:[a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),a.jsx("span",{className:"text-sm",children:"Back"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),a.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:ke.textPrimary},children:"THE COMBINE"})]}),a.jsx("div",{className:"w-16"})," "]})}function ii({title:e,children:t}){return a.jsxs("section",{className:"mb-16",children:[e&&a.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:ke.textPrimary},children:e}),t]})}function ut({children:e,className:t=""}){return a.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:ke.textSecondary},children:e})}function eo({children:e}){return a.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:ke.textPrimary,borderLeft:`2px solid ${ke.border}`},children:e})}function nl({items:e}){return a.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>a.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:ke.textSecondary},children:[a.jsx("span",{style:{color:ke.textMuted},children:"-"}),t]},r))})}function il({number:e,title:t,children:r}){return a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[a.jsxs("span",{className:"text-sm font-mono",style:{color:ke.textMuted},children:[e,"."]}),a.jsx("h3",{className:"text-base font-medium",style:{color:ke.textPrimary},children:t})]}),a.jsx("div",{className:"pl-7",children:a.jsx(ut,{children:r})})]})}function sl({title:e,children:t}){return a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-base font-medium mb-2",style:{color:ke.textPrimary},children:e}),a.jsx(ut,{className:"mb-0",children:t})]})}function yB({onLogin:e}){return a.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:ke.bgElevated,border:`1px solid ${ke.border}`},children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:ke.textPrimary},children:"When You're Ready"}),a.jsx(ut,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),a.jsx(ut,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),a.jsx(ut,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:ke.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=ke.accentHover,onMouseOut:t=>t.currentTarget.style.background=ke.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:ke.bg,border:`1px solid ${ke.border}`,color:ke.textPrimary},onMouseOver:t=>t.currentTarget.style.background=ke.bgElevated,onMouseOut:t=>t.currentTarget.style.background=ke.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function bB(){return a.jsxs("footer",{className:"py-8 text-center",children:[a.jsx("p",{className:"text-sm mb-6",style:{color:ke.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:ke.textSubtle},onMouseOver:e=>e.currentTarget.style.color=ke.textMuted,onMouseOut:e=>e.currentTarget.style.color=ke.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:ke.textSubtle},onMouseOver:e=>e.currentTarget.style.color=ke.textMuted,onMouseOut:e=>e.currentTarget.style.color=ke.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:ke.border},children:" 2026 The Combine"})]})]})}function wB(){const{login:e}=Ds();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:ke.bg},children:[a.jsx(xB,{}),a.jsx("main",{className:"flex-1 px-6 py-12",children:a.jsxs("article",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:ke.textPrimary},children:"Learn More"}),a.jsxs(ii,{title:"What The Combine Is",children:[a.jsx(ut,{children:"The Combine is an AI-assisted production system for knowledge work."}),a.jsx(ut,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),a.jsx(eo,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),a.jsx(eo,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),a.jsxs(ii,{title:"Why It Exists",children:[a.jsx(ut,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),a.jsx(ut,{children:"It breaks down when the work must be:"}),a.jsx(nl,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),a.jsx(ut,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),a.jsxs(ii,{title:'Why "The Combine"',children:[a.jsx(ut,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),a.jsx(ut,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),a.jsx(ut,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),a.jsx(ut,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),a.jsx(ut,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),a.jsx(nl,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),a.jsx(ut,{children:"This is not automation for speed. It is industrialization for reliability."}),a.jsx(eo,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),a.jsxs(ii,{title:"How It Works",children:[a.jsx(il,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),a.jsx(il,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),a.jsx(il,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),a.jsx(il,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),a.jsxs(ii,{title:"What Makes It Different",children:[a.jsx(sl,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),a.jsx(sl,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),a.jsx(sl,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),a.jsx(sl,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),a.jsxs(ii,{title:"What The Combine Is Not",children:[a.jsx(nl,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),a.jsx(ut,{children:"If you want improvisation, there are better tools."}),a.jsx(eo,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),a.jsxs(ii,{title:"Who It's For",children:[a.jsx(ut,{children:"The Combine is designed for people responsible for outcomes, including:"}),a.jsx(nl,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),a.jsx(eo,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),a.jsx(yB,{onLogin:e})]})}),a.jsx(bB,{})]})}function DT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await Se.getTemplates();t(l.templates||[])}catch(l){s(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{templates:e,loading:r,error:i,refresh:o}}function _B(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await Se.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){s(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{workflows:e,loading:r,error:i,refresh:o}}function LT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await Se.getSchemas();t(l.schemas||[])}catch(l){s(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{schemas:e,loading:r,error:i,refresh:o}}function FT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null);m.useEffect(()=>{let f=!0;async function h(){n(!0),s(null);try{const p=await Se.getPromptFragments();f&&t(p.fragments||[])}catch(p){console.error("Failed to fetch prompt fragments:",p),f&&s(p.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return h(),()=>{f=!1}},[]);const o=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const h of e){const p=h.kind;f[p]&&f[p].push(h)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:o.role.length,task:o.task.length,qa:o.qa.length,pgc:o.pgc.length,questions:o.questions.length,reflection:o.reflection.length}),[e,o]),c=m.useCallback(f=>!f||f==="all"?e:o[f]||[],[e,o]),u=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),d=m.useCallback(async()=>{n(!0),s(null);try{const f=await Se.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),s(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:i,fragmentsByKind:o,kindCounts:l,kindOptions:u,filterByKind:c,refresh:d}}const Jm="doctype-browser-collapsed";function zT(e,t){const[r,n]=m.useState(()=>{try{const s=JSON.parse(localStorage.getItem(Jm)||"{}");return e in s?s[e]:t}catch{return t}}),i=m.useCallback(s=>{const o=typeof s=="function"?s(r):s;n(o);try{const l=JSON.parse(localStorage.getItem(Jm)||"{}");l[e]=o,localStorage.setItem(Jm,JSON.stringify(l))}catch{}},[e,r]);return[r,i]}function US({title:e,defaultOpen:t=!0,children:r}){const[n,i]=zT(`group:${e}`,t);return a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function VS({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:i}){const[s,o]=zT(`sub:${e}`,r);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:s?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&a.jsx("span",{style:{color:n,fontSize:8},children:""}),a.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),s&&i]})}function GS({selected:e,onClick:t,label:r,sublabel:n,badge:i}){return a.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:r}),i&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:i})]}),n&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function KS({loading:e,empty:t,emptyMessage:r="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function SB({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:i=[],promptFragmentKindOptions:s=[],schemas:o=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:u=!1,workflowsLoading:d=!1,promptFragmentsLoading:f=!1,schemasLoading:h=!1,selectedDocType:p=null,docTypeSource:y=null,selectedRole:g=null,selectedTemplate:w=null,selectedWorkflow:v=null,selectedFragment:x=null,selectedSchema:b=null,onSelectDocType:_,onSelectRole:S,onSelectTemplate:k,onSelectWorkflow:N,onSelectFragment:E,onSelectStandaloneSchema:j,onCreateWorkflow:R,onCreateDocType:T,onCreateFragment:P,onCreateTemplate:z,onCreateSchema:C,onSelectTask:L,onSelectSchema:O,workspaceState:$=null}){var ge;const[D,A]=m.useState(null),[F,M]=m.useState(null),[q,W]=m.useState(""),[B,K]=m.useState(!1),[Z,re]=m.useState(!1),[ne,V]=m.useState(""),[ee,ve]=m.useState(!1),fe=[...e].sort((Q,pe)=>(Q.display_name||"").localeCompare(pe.display_name||"")),be=n.filter(Q=>(Q.pow_class||"reference")==="reference"),ce=Q=>{const pe=Q.pow_class||"reference";return pe==="reference"?"ref":pe==="template"?"tpl":"inst"},te=e.filter(Q=>Q.active_version).length+n.filter(Q=>Q.active_version).length,we=((ge=$==null?void 0:$.modified_artifacts)==null?void 0:ge.length)??0,Y=($==null?void 0:$.is_dirty)??!1,X=()=>{A(null),M(null),W("")},ue=()=>{re(!1),V("")},he=async()=>{const Q=ne.trim().toLowerCase().replace(/\s+/g,"_");if(!(!Q||!/^[a-z][a-z0-9_]*$/.test(Q))){ve(!0);try{await(T==null?void 0:T({doc_type_id:Q})),ue()}catch{}finally{ve(!1)}}},_e=async()=>{const Q=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!Q||!/^[a-z][a-z0-9_]*$/.test(Q))){K(!0);try{const pe={workflow_id:Q,pow_class:"template"};F&&(pe.derived_from={workflow_id:F.workflow_id,version:F.active_version},pe.source_version=F.active_version),await(R==null?void 0:R(pe)),X()}catch{}finally{K(!1)}}};return a.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(US,{title:"Production Workflows",defaultOpen:!0,children:[a.jsxs(VS,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&a.jsx("button",{onClick:()=>A(D?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[D==="choose"&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("button",{onClick:()=>A("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:be.length===0,children:["From Reference",be.length===0?" (none available)":""]}),a.jsx("button",{onClick:()=>A("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),a.jsx("button",{onClick:X,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),D==="from_reference"&&!F&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),be.map(Q=>a.jsxs("button",{onClick:()=>M(Q),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("div",{className:"font-medium",children:Q.name||Q.workflow_id.replace(/_/g," ").replace(/\b\w/g,pe=>pe.toUpperCase())}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",Q.active_version]})]},Q.workflow_id)),a.jsx("button",{onClick:()=>A("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(D==="blank"||D==="from_reference"&&F)&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[F&&a.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",F.name||F.workflow_id," v",F.active_version]}),a.jsx("input",{type:"text",value:q,onChange:Q=>W(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&_e(),Q.key==="Escape"&&X()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:B,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:_e,disabled:B||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:B?"wait":"pointer",opacity:!q.trim()||B?.5:1},children:B?"Creating...":"Create"}),a.jsx("button",{onClick:X,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(KS,{loading:d,empty:!d&&n.length===0,emptyMessage:"No workflows"}),!d&&n.length>0&&a.jsx("div",{className:"py-1",children:n.map(Q=>a.jsx(GS,{selected:(v==null?void 0:v.workflow_id)===Q.workflow_id,onClick:()=>N==null?void 0:N(Q),label:Q.name||Q.workflow_id.replace(/_/g," ").replace(/\b\w/g,pe=>pe.toUpperCase()),sublabel:`v${Q.active_version}`,badge:ce(Q)},Q.workflow_id))})]}),a.jsxs(VS,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&a.jsx("button",{onClick:()=>re(!Z),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[Z&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:ne,onChange:Q=>V(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&he(),Q.key==="Escape"&&ue()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:ee,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:he,disabled:ee||!ne.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:ee?"wait":"pointer",opacity:!ne.trim()||ee?.5:1},children:ee?"Creating...":"Create"}),a.jsx("button",{onClick:ue,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(KS,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&fe.length>0&&a.jsx("div",{className:"py-1",children:fe.map(Q=>a.jsx(GS,{selected:y==="docworkflow"&&(p==null?void 0:p.doc_type_id)===Q.doc_type_id,onClick:()=>_==null?void 0:_(Q),label:Q.display_name,badge:`v${Q.active_version}`},Q.doc_type_id))})]})]}),a.jsxs(US,{title:"Governance",defaultOpen:!1,children:[a.jsx("div",{className:"px-4 py-3",children:a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),a.jsxs("div",{children:[te," active ",te===1?"release":"releases"]})]})}),$&&a.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),Y&&a.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[we," dirty"]})]})]})]})})}function jB({kinds:e=[],selectedKind:t="all",onSelect:r}){return a.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:i,count:s})=>{const o=t===n;return a.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:o?"var(--action-primary)":"var(--bg-panel)",color:o?"#000":"var(--text-secondary)",border:o?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[i,s!==void 0&&a.jsxs("span",{style:{marginLeft:4,opacity:o?.7:.6},children:["(",s,")"]})]},n)})})}function eg({title:e,count:t,dotColor:r,defaultOpen:n=!1,action:i,children:s}){const[o,l]=m.useState(n);return a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[a.jsxs("button",{onClick:()=>l(!o),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),a.jsx("span",{style:{color:r,fontSize:10},children:""}),a.jsx("span",{className:"font-semibold",children:e})]}),a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),i&&a.jsx("div",{className:"pr-3",children:i})]}),o&&a.jsx("div",{style:{background:"var(--bg-panel)"},children:s})]})}function ol({onClick:e,label:t,sublabel:r,badge:n}){return a.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:t}),n&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:n})]}),r&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function tg({loading:e,empty:t,emptyMessage:r="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function kB({isOpen:e,onClose:t,promptFragments:r=[],promptFragmentKindOptions:n=[],templates:i=[],schemas:s=[],documentTypes:o=[],promptFragmentsLoading:l=!1,templatesLoading:c=!1,schemasLoading:u=!1,onSelectFragment:d,onSelectTemplate:f,onSelectSchema:h,onSelectStandaloneSchema:p,onCreateFragment:y,onCreateTemplate:g,onCreateSchema:w}){const v=m.useRef(null),[x,b]=m.useState("all"),[_,S]=m.useState(!1),[k,N]=m.useState("role"),[E,j]=m.useState(""),[R,T]=m.useState(!1),[P,z]=m.useState(!1),[C,L]=m.useState(""),[O,$]=m.useState(!1),[D,A]=m.useState(!1),[F,M]=m.useState(""),[q,W]=m.useState(!1),B=x==="all"?r:r.filter(V=>V.kind===x);m.useEffect(()=>{if(!e)return;const V=ve=>{v.current&&!v.current.contains(ve.target)&&(t==null||t())},ee=setTimeout(()=>{document.addEventListener("mousedown",V)},100);return()=>{clearTimeout(ee),document.removeEventListener("mousedown",V)}},[e,t]),m.useEffect(()=>{e||(S(!1),z(!1),A(!1),j(""),L(""),M(""))},[e]);const K=m.useCallback((V,ee)=>{V==null||V(ee),t==null||t()},[t]),Z=async()=>{const V=E.trim().toLowerCase().replace(/\s+/g,"_");if(!(!V||!/^[a-z][a-z0-9_]*$/.test(V))){T(!0);try{await(y==null?void 0:y({role_id:V,kind:k})),S(!1),j(""),t==null||t()}catch{}finally{T(!1)}}},re=async()=>{const V=C.trim().toLowerCase().replace(/\s+/g,"_");if(!(!V||!/^[a-z][a-z0-9_]*$/.test(V))){$(!0);try{await(g==null?void 0:g({template_id:V})),z(!1),L(""),t==null||t()}catch{}finally{$(!1)}}},ne=async()=>{const V=F.trim().toLowerCase().replace(/\s+/g,"_");if(!(!V||!/^[a-z][a-z0-9_]*$/.test(V))){W(!0);try{await(w==null?void 0:w({schema_id:V})),A(!1),M(""),t==null||t()}catch{}finally{W(!1)}}};return e?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.3)",zIndex:40}}),a.jsxs("div",{ref:v,className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),a.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(eg,{title:"Prompt Fragments",count:r.length,dotColor:"#f59e0b",defaultOpen:!0,action:y&&a.jsx("button",{onClick:()=>S(!_),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[_&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),a.jsx("select",{value:k,onChange:V=>N(V.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:a.jsx("option",{value:"role",children:"Role"})})]}),a.jsx("input",{type:"text",value:E,onChange:V=>j(V.target.value),onKeyDown:V=>{V.key==="Enter"&&Z(),V.key==="Escape"&&S(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:R,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:Z,disabled:R||!E.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:R?"wait":"pointer",opacity:!E.trim()||R?.5:1},children:R?"Creating...":"Create"}),a.jsx("button",{onClick:()=>S(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.length>0&&a.jsx(jB,{kinds:n,selectedKind:x,onSelect:b}),a.jsx(tg,{loading:l,empty:!l&&B.length===0,emptyMessage:x==="all"?"No prompt fragments":`No ${x} fragments`}),!l&&B.length>0&&a.jsx("div",{className:"py-1",children:B.map(V=>a.jsx(ol,{onClick:()=>K(d,V),label:V.name||V.fragment_id,sublabel:`${V.kind}  v${V.version}`,badge:V.kind},V.fragment_id))})]}),a.jsxs(eg,{title:"Templates",count:i.length,dotColor:"var(--dot-green)",action:g&&a.jsx("button",{onClick:()=>z(!P),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[P&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:C,onChange:V=>L(V.target.value),onKeyDown:V=>{V.key==="Enter"&&re(),V.key==="Escape"&&z(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:O,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:re,disabled:O||!C.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:O?"wait":"pointer",opacity:!C.trim()||O?.5:1},children:O?"Creating...":"Create"}),a.jsx("button",{onClick:()=>z(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(tg,{loading:c,empty:!c&&i.length===0,emptyMessage:"No templates"}),!c&&i.length>0&&a.jsx("div",{className:"py-1",children:i.map(V=>a.jsx(ol,{onClick:()=>K(f,V),label:V.name||V.template_id.replace(/_/g," ").replace(/\b\w/g,ee=>ee.toUpperCase()),sublabel:`v${V.active_version}`},V.template_id))})]}),a.jsxs(eg,{title:"Schemas",count:s.length||o.length,dotColor:"var(--dot-blue)",action:w&&a.jsx("button",{onClick:()=>A(!D),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[D&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:F,onChange:V=>M(V.target.value),onKeyDown:V=>{V.key==="Enter"&&ne(),V.key==="Escape"&&A(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:q,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:ne,disabled:q||!F.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:q?"wait":"pointer",opacity:!F.trim()||q?.5:1},children:q?"Creating...":"Create"}),a.jsx("button",{onClick:()=>A(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(tg,{loading:u,empty:!u&&s.length===0&&o.length===0,emptyMessage:"No schemas"}),!u&&s.length>0&&a.jsx("div",{className:"py-1",children:s.map(V=>a.jsx(ol,{onClick:()=>K(p,V),label:V.title||V.schema_id,sublabel:`v${V.active_version}`},`standalone-${V.schema_id}`))}),s.length===0&&o.length>0&&a.jsx("div",{className:"py-1",children:o.map(V=>a.jsx(ol,{onClick:()=>K(h,{doc_type_id:V.doc_type_id,display_name:V.display_name,active_version:V.active_version}),label:V.display_name,sublabel:`from ${V.doc_type_id}`},`schema-${V.doc_type_id}`))})]})]})]}),a.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function Jr({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:i=!1,error:s=null,readOnly:o=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const u=m.useCallback(()=>{if(!(!e||!c))try{const d=JSON.parse(e),f=JSON.stringify(d,null,2);t==null||t(f)}catch(d){console.warn("Invalid JSON, cannot format:",d.message)}},[e,c,t]);return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o&&a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!o&&i&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&!o&&a.jsx("button",{onClick:u,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&i&&a.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),s&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",s]})]})]}),a.jsx("div",{className:"flex-1 relative",children:r?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):a.jsx("textarea",{value:e,onChange:d=>t==null?void 0:t(d.target.value),placeholder:l,readOnly:o,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function NB({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),s(!1);return}(async()=>{s(!0),l(null);try{const u=await Se.getPreview(e,t);n(u)}catch(u){l(u.message),console.error("Failed to load preview:",u)}finally{s(!1)}})()},[e,t]),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&a.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&a.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&a.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&a.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),a.jsx("div",{className:"flex-1 relative overflow-auto",children:i?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):o?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[a.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:o})]})}):a.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function CB({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,u]=m.useState(!1),[d,f]=m.useState(null),[h,p]=m.useState(!1);m.useEffect(()=>{var b,_,S;t&&(s({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((_=t.ui)==null?void 0:_.category)||"",ui_display_order:((S=t.ui)==null?void 0:S.display_order)||0}),p(!1),f(null))},[t]);const y=m.useCallback((b,_)=>{s(S=>({...S,[b]:_})),p(!0)},[]),g=m.useCallback((b,_)=>{const S=_.split(",").map(k=>k.trim()).filter(k=>k);s(k=>({...k,[b]:S})),p(!0)},[]),w=m.useCallback(b=>{if(!b)return"";const _=r.find(S=>S.role_id===b);return _?`prompt:role:${b}:${_.active_version}`:""},[r]),v=m.useCallback(b=>{if(!b)return"";const _=b.split(":");return _.length>=3&&_[0]==="prompt"&&_[1]==="role"?_[2]:""},[]),x=m.useCallback(async()=>{if(!(!e||!t||!i)){u(!0),f(null);try{const b=t.version||t.active_version,_=`doctype:${t.doc_type_id}:${b}:manifest`,S=EB(t.doc_type_id,b,i),k=await Se.writeArtifact(e,_,S);p(!1),n==null||n(_,k)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{u(!1)}}},[e,t,i,n]);return!t||!i?a.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"flex items-center gap-2",children:h&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),d&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",d]}),a.jsx("button",{onClick:x,disabled:!h||c,className:"px-3 py-1 rounded text-xs",style:{background:h?"var(--action-primary)":"var(--bg-panel)",color:h?"#000":"var(--text-muted)",opacity:h&&!c?1:.5},children:"Save Package"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsxs(to,{title:"Identity",children:[a.jsx(Vt,{label:"Display Name",children:a.jsx("input",{type:"text",value:i.display_name,onChange:b=>y("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Vt,{label:"Description",children:a.jsx("textarea",{value:i.description,onChange:b=>y("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(to,{title:"Classification",children:[a.jsx(Vt,{label:"Authority Level",children:a.jsxs("select",{value:i.authority_level,onChange:b=>y("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"descriptive",children:"Descriptive"}),a.jsx("option",{value:"prescriptive",children:"Prescriptive"}),a.jsx("option",{value:"constructive",children:"Constructive"}),a.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),a.jsx(Vt,{label:"Creation Mode",children:a.jsxs("select",{value:i.creation_mode,onChange:b=>y("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"llm_generated",children:"LLM Generated"}),a.jsx("option",{value:"constructed",children:"Constructed"}),a.jsx("option",{value:"extracted",children:"Extracted"})]})}),a.jsx(Vt,{label:"Scope",children:a.jsxs("select",{value:i.scope,onChange:b=>y("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"epic",children:"Epic"}),a.jsx("option",{value:"feature",children:"Feature"})]})})]}),a.jsx(to,{title:"Shared References",children:a.jsxs(Vt,{label:"Role Prompt",children:[a.jsxs("select",{value:v(i.role_prompt_ref),onChange:b=>y("role_prompt_ref",w(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"None"}),r.map(b=>a.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())},b.role_id))]}),i.role_prompt_ref&&a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:i.role_prompt_ref})]})}),a.jsxs(to,{title:"Dependencies",children:[a.jsx(Vt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Vt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Vt,{label:"Parent Doc Type",children:a.jsx("input",{type:"text",value:i.parent_doc_type,onChange:b=>y("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Vt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(to,{title:"UI Configuration",children:[a.jsx(Vt,{label:"Icon",children:a.jsx("input",{type:"text",value:i.ui_icon,onChange:b=>y("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Vt,{label:"Category",children:a.jsxs("select",{value:i.ui_category,onChange:b=>y("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"Select category..."}),a.jsx("option",{value:"intake",children:"Intake"}),a.jsx("option",{value:"architecture",children:"Architecture"}),a.jsx("option",{value:"planning",children:"Planning"}),a.jsx("option",{value:"execution",children:"Execution"})]})}),a.jsx(Vt,{label:"Display Order",children:a.jsx("input",{type:"number",value:i.ui_display_order,onChange:b=>y("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function to({title:e,children:t}){return a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),a.jsx("div",{className:"space-y-4",children:t})]})}function Vt({label:e,hint:t,children:r}){return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&a.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function EB(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(i=>`"${i}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(i=>`"${i}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(i=>`"${i}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function qT(e,t,{debounceMs:r=1e3,onSave:n}={}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null),[h,p]=m.useState(!1),[y,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){s(null),l(null),u(!1);return}u(!0),f(null);try{const N=await Se.getArtifact(e,t),E=JSON.parse(N.content);s(E),l(E)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{u(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){p(!0),f(null);try{const E=JSON.stringify(N,null,2),j=await Se.writeArtifact(e,t,E);g(j),l(N),n&&n(j)}catch(E){f(E.message),console.error("Failed to save workflow:",E)}finally{p(!1)}}},[e,t,n]),_=m.useCallback(N=>{v.current=N,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),S=m.useCallback(N=>{s(N),_(N)},[_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),i&&b(i)},[i,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{workflowJson:i,originalJson:o,loading:c,error:d,saving:h,lastSaveResult:y,isDirty:i!==o,updateWorkflow:S,saveNow:k,reload:x}}function TB({data:e,selected:t}){const{config:r,isEntry:n}=e,i=e.type==="end";return a.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[a.jsx(Wr,{type:"target",position:oe.Top,style:{background:r.color,width:8,height:8,border:"none"}}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[a.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&a.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),a.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&a.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),a.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!i&&a.jsx(Wr,{type:"source",position:oe.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const RB=m.memo(TB),uc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},AB={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},YS=220,XS=110;function QS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(i=>{const s=uc[i.type]||uc.task,l=i.type==="end"&&["blocked","abandoned"].includes(i.terminal_outcome)?AB:s;return{id:i.node_id,type:"workflowNode",position:i._position||{x:0,y:0},data:{...i,config:l,isEntry:t.includes(i.node_id)}}}),n=(e.edges||[]).map(i=>{const s=i.non_advancing||!i.to_node_id,o=i.conditions&&i.conditions.length>0;let l=i.label||i.outcome;if(o){const c=i.conditions[0],u={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${u} ${c.value})`}return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id||i.from_node_id,type:"smoothstep",animated:s,label:l,data:{...i},style:{stroke:s?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:s?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:i.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function ZS(e,t,r="TB"){const n=new cc.graphlib.Graph;return n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(i=>{n.setNode(i.id,{width:YS,height:XS})}),t.forEach(i=>{i.target!==i.source&&n.setEdge(i.source,i.target)}),cc.layout(n),e.map(i=>{const s=n.node(i.id);return s?{...i,position:{x:s.x-YS/2,y:s.y-XS/2}}:i})}function IB(e,t){const r=new Set(t.map(s=>s.id||s.node_id));let n=1,i=`${e}_${n}`;for(;r.has(i);)n++,i=`${e}_${n}`;return i}function MB(e,t,r){const n=new Set(r.map(o=>o.id||o.edge_id));let i=1,s=`${e}_to_${t}`;for(;n.has(s);)i++,s=`${e}_to_${t}_${i}`;return s}function PB(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const OB={workflowNode:RB},DB=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function LB({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:i,onEdgeSelect:s}){const o=Uc(),[l,c,u]=dE([]),[d,f,h]=fE([]),[p,y]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:j,edges:R}=QS(e);(!j.some(P=>P.position.x!==0||P.position.y!==0)||!g.current)&&(j=ZS(j,R),g.current=!0),c(j),f(R)},[e,c,f]),m.useEffect(()=>{c(j=>j.map(R=>({...R,selected:R.id===r})))},[r,c]);const w=m.useCallback(j=>{if(!e)return;const T={edge_id:MB(j.source,j.target,e.edges||[]),from_node_id:j.source,to_node_id:j.target,outcome:"success",label:"",kind:"auto"},P={...e,edges:[...e.edges||[],T]};t(P)},[e,t]),v=m.useCallback((j,R)=>{if(!e)return;const T=e.nodes.map(P=>P.node_id===R.id?{...P,_position:R.position}:P);t({...e,nodes:T})},[e,t]),x=m.useCallback((j,R)=>{i==null||i(R.id)},[i]),b=m.useCallback((j,R)=>{s==null||s(R.id)},[s]),_=m.useCallback(()=>{i==null||i(null),s==null||s(null)},[i,s]),S=m.useCallback(j=>{if(j.key==="Delete"||j.key==="Backspace"){if(r&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(R),i==null||i(null)}else if(n&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(R),s==null||s(null)}}},[r,n,e,t,i,s]),k=m.useCallback(j=>{if(!e)return;const R=IB(j,e.nodes||[]),T=PB(j);T.node_id=R;const P=o.getViewport(),z=(-P.x+window.innerWidth/2)/P.zoom,C=(-P.y+window.innerHeight/2)/P.zoom;T._position={x:z-110,y:C-50};const L={...e,nodes:[...e.nodes||[],T]};t(L),y(!1),i==null||i(R)},[e,t,o,i]),N=m.useCallback(()=>{if(!e)return;let{nodes:j,edges:R}=QS(e);j=ZS(j,R);const T=e.nodes.map(P=>{const z=j.find(C=>C.id===P.node_id);return z?{...P,_position:z.position}:P});t({...e,nodes:T}),setTimeout(()=>{o.fitView({padding:.2,duration:300})},50)},[e,t,o]),E=m.useCallback(()=>{o.fitView({padding:.2,duration:300})},[o]);return a.jsx("div",{className:"flex-1 relative",onKeyDown:S,tabIndex:0,style:{outline:"none"},children:a.jsxs(Qx,{nodes:l,edges:d,onNodesChange:u,onEdgesChange:h,onConnect:w,onNodeDragStop:v,onNodeClick:x,onEdgeClick:b,onPaneClick:_,nodeTypes:OB,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[a.jsx(Hn,{position:"top-left",children:a.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>y(!p),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),p&&a.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:DB.map(j=>{const R=uc[j.value]||{};return a.jsxs("button",{onClick:()=>k(j.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),j.label]},j.value)})})]}),a.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),a.jsx("button",{onClick:E,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),a.jsx(mE,{position:"bottom-right",nodeColor:j=>{var T;const R=(T=j.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hn,{position:"bottom-left",children:a.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(uc).map(([j,R])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},j))})}),a.jsx(Hn,{position:"top-right",children:a.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const FB=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],JS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],zB=["semantic","structural","hybrid"],qB=["stabilized","blocked","abandoned"],Xe={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},xr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},$B={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function rg(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function ng(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function zi(e){var i;if(!e)return"";const t=e.kind||"role",r=((i=e.fragment_id)==null?void 0:i.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function qi(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function ig(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function sg(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function og({title:e,defaultOpen:t=!1,isOpen:r,onToggle:n,children:i,badge:s}){const[o,l]=m.useState(t),c=r!==void 0,u=c?r:o,d=()=>{c&&n?n():l(!o)};return a.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("button",{onClick:d,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:u?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:a.jsx("path",{d:"M9 18l6-6-6-6"})}),a.jsx("span",{style:{...xr,marginBottom:0},children:e})]}),s&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:s})]}),u&&a.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:i})]})}function BB({node:e,onChange:t,onDelete:r,templates:n=[],schemas:i=[],roleFragments:s=[],taskFragments:o=[],pgcFragments:l=[]}){var X,ue,he,_e,ge,Q,pe,We,Re,Le,Pe,Ue;const[c,u]=m.useState(e),[d,f]=m.useState("A");m.useEffect(()=>{u(e),f("A")},[e]);const h=(I,H)=>{const U={...c,[I]:H};u(U),t(U)},p=(I,H)=>{const U={...c.includes,[I]:H},se={...c,includes:U};u(se),t(se)},y=I=>{const H={...c.includes};delete H[I];const U={...c,includes:H};u(U),t(U)},g=()=>{const I={...c.includes,NEW_KEY:""},H={...c,includes:I};u(H),t(H)},w=I=>{const H={...c,internals:I};u(H),t(H)},v=(I,H)=>{const U=c.internals||_(),se={...U.question_generation,[I]:H};w({...U,question_generation:se})},x=(I,H)=>{const U=c.internals||_(),se={...U.question_generation.includes,[I]:H},Oe={...U.question_generation,includes:se};w({...U,question_generation:Oe})},b=(I,H)=>{const U=c.internals||_(),se={...U.clarification_merge,[I]:H};w({...U,clarification_merge:se})},_=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!c)return null;const S=c.type==="pgc",k=ng(c.task_ref),N=c.includes||{},E=N.ROLE_PROMPT||"",j=N.TASK_PROMPT||"",R=N.OUTPUT_SCHEMA||"",T=N.PGC_CONTEXT||"",P=qi(E),z=qi(j),C=sg(R),L=qi(T),O=Object.entries(N).filter(([I])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(I)),$=c.internals||_(),D=ng((X=$.question_generation)==null?void 0:X.template_ref),A=qi((he=(ue=$.question_generation)==null?void 0:ue.includes)==null?void 0:he.ROLE_PROMPT),F=qi((ge=(_e=$.question_generation)==null?void 0:_e.includes)==null?void 0:ge.TASK_PROMPT),M=qi((pe=(Q=$.question_generation)==null?void 0:Q.includes)==null?void 0:pe.PGC_CONTEXT),q=sg((We=$.question_generation)==null?void 0:We.output_schema_ref),W=ng((Re=$.clarification_merge)==null?void 0:Re.template_ref),B=sg((Le=$.clarification_merge)==null?void 0:Le.output_schema_ref),K=I=>{const H=I.target.value;if(!H){h("task_ref","");return}const U=n.find(se=>se.template_id===H);U&&h("task_ref",rg(U))},Z=I=>{const H=I.target.value;if(!H){y("ROLE_PROMPT");return}const U=s.find(se=>se.fragment_id===`role:${H}`||se.id===H);U&&p("ROLE_PROMPT",zi(U))},re=I=>{const H=I.target.value;if(!H){y("TASK_PROMPT");return}const U=o.find(se=>se.fragment_id===`task:${H}`||se.id===H);U&&p("TASK_PROMPT",zi(U))},ne=I=>{const H=I.target.value;if(!H){y("OUTPUT_SCHEMA");return}const U=i.find(se=>se.schema_id===H);U&&p("OUTPUT_SCHEMA",ig(U))},V=I=>{const H=I.target.value;if(!H){y("PGC_CONTEXT");return}const U=l.find(se=>se.fragment_id===`pgc:${H}`||se.id===H);U&&p("PGC_CONTEXT",zi(U))},ee=I=>{const H=I.target.value,U=JS.find(kt=>kt.value===H),se=(U==null?void 0:U.produces)||`pgc_clarifications.${H}`,Oe={...c,gate_kind:H,produces:se};u(Oe),t(Oe)},ve=I=>{const H=I.target.value;if(!H){v("template_ref","");return}const U=n.find(se=>se.template_id===H);U&&v("template_ref",rg(U))},fe=I=>{const H=I.target.value;if(!H){x("ROLE_PROMPT","");return}const U=s.find(se=>se.fragment_id===`role:${H}`||se.id===H);U&&x("ROLE_PROMPT",zi(U))},be=I=>{const H=I.target.value;if(!H){x("TASK_PROMPT","");return}const U=o.find(se=>se.fragment_id===`task:${H}`||se.id===H);U&&x("TASK_PROMPT",zi(U))},ce=I=>{const H=I.target.value;if(!H){x("PGC_CONTEXT","");return}const U=l.find(se=>se.fragment_id===`pgc:${H}`||se.id===H);U&&x("PGC_CONTEXT",zi(U))},te=I=>{const H=I.target.value;if(!H){v("output_schema_ref","");return}const U=i.find(se=>se.schema_id===H);U&&v("output_schema_ref",ig(U))},we=I=>{const H=I.target.value;if(!H){b("template_ref","");return}const U=n.find(se=>se.template_id===H);U&&b("template_ref",rg(U))},Y=I=>{const H=I.target.value;if(!H){b("output_schema_ref","");return}const U=i.find(se=>se.schema_id===H);U&&b("output_schema_ref",ig(U))};return a.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:S?"PGC Gate Properties":"Node Properties"}),a.jsx("button",{onClick:()=>r(c.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Node ID"}),a.jsx("input",{type:"text",value:c.node_id||"",onChange:I=>h("node_id",I.target.value),style:Xe})]}),a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Type"}),a.jsx("select",{value:c.type||"task",onChange:I=>h("type",I.target.value),style:Xe,children:FB.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})]}),S&&a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Gate Kind"}),a.jsx("select",{value:c.gate_kind||"discovery",onChange:ee,style:Xe,children:JS.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})]}),a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Description"}),a.jsx("textarea",{value:c.description||"",onChange:I=>h("description",I.target.value),rows:2,style:{...Xe,resize:"vertical"}})]}),(S||["task","intake_gate"].includes(c.type))&&a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Produces"}),a.jsx("input",{type:"text",value:c.produces||"",onChange:I=>h("produces",I.target.value),placeholder:S?"pgc_clarifications.discovery":"document_type",style:Xe})]}),S&&a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{style:$B,children:"Gate Internals"}),a.jsx(og,{title:"Pass A: Question Generation",isOpen:d==="A",onToggle:()=>f(d==="A"?null:"A"),badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:D||"",onChange:ve,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(I=>a.jsx("option",{value:I.template_id,children:I.name||I.template_id.replace(/_/g," ")},I.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:A||"",onChange:fe,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(I=>{var U;const H=((U=I.fragment_id)==null?void 0:U.replace("role:",""))||I.id;return a.jsx("option",{value:H,children:I.name||(H==null?void 0:H.replace(/_/g," "))},I.fragment_id||I.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:F||"",onChange:be,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(I=>{var U;const H=((U=I.fragment_id)==null?void 0:U.replace("task:",""))||I.id;return a.jsx("option",{value:H,children:I.name||(H==null?void 0:H.replace(/_/g," "))},I.fragment_id||I.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:M||"",onChange:ce,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(I=>{var U;const H=((U=I.fragment_id)==null?void 0:U.replace("pgc:",""))||I.id;return a.jsx("option",{value:H,children:I.name||(H==null?void 0:H.replace(/_/g," "))},I.fragment_id||I.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:q||"",onChange:te,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(I=>a.jsx("option",{value:I.schema_id,children:I.title||I.schema_id.replace(/_/g," ")},I.schema_id))]})]})]})}),a.jsx("div",{className:"mt-2",children:a.jsx(og,{title:"Entry: Operator Answers",badge:"UI",children:a.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Renders:"}),a.jsx("span",{className:"font-mono",children:((Pe=$.operator_entry)==null?void 0:Pe.renders)||"question_set"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Captures:"}),a.jsx("span",{className:"font-mono",children:((Ue=$.operator_entry)==null?void 0:Ue.captures)||"pgc_answers"})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),a.jsx("div",{className:"mt-2",children:a.jsx(og,{title:"Pass B: Clarification Merge",isOpen:d==="B",onToggle:()=>f(d==="B"?null:"B"),badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:W||"",onChange:we,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(I=>a.jsx("option",{value:I.template_id,children:I.name||I.template_id.replace(/_/g," ")},I.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:B||"",onChange:Y,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(I=>a.jsx("option",{value:I.schema_id,children:I.title||I.schema_id.replace(/_/g," ")},I.schema_id))]})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),["task","qa","intake_gate"].includes(c.type)&&a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Interaction Template"}),a.jsxs("select",{value:k||"",onChange:K,style:Xe,children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(I=>a.jsx("option",{value:I.template_id,children:I.name||I.template_id.replace(/_/g," ")},I.template_id))]}),c.task_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:c.task_ref,children:c.task_ref})]}),c.type==="qa"&&a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"QA Mode"}),a.jsx("select",{value:c.qa_mode||"semantic",onChange:I=>h("qa_mode",I.target.value),style:Xe,children:zB.map(I=>a.jsx("option",{value:I,children:I},I))})]}),c.type==="end"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Terminal Outcome"}),a.jsx("select",{value:c.terminal_outcome||"stabilized",onChange:I=>h("terminal_outcome",I.target.value),style:Xe,children:qB.map(I=>a.jsx("option",{value:I,children:I},I))})]}),a.jsxs("div",{children:[a.jsx("label",{style:xr,children:"Gate Outcome"}),a.jsx("input",{type:"text",value:c.gate_outcome||"",onChange:I=>h("gate_outcome",I.target.value),placeholder:"e.g., complete, failed",style:Xe})]})]}),a.jsxs("div",{className:"flex gap-4",children:[c.type==="qa"&&a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:c.requires_qa||!1,onChange:I=>h("requires_qa",I.target.checked)}),"Requires QA"]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:c.non_advancing||!1,onChange:I=>h("non_advancing",I.target.checked)}),"Non-advancing"]})]}),c.type==="task"&&a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("label",{style:xr,children:"Includes"})}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:P||"",onChange:Z,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(I=>{var U;const H=((U=I.fragment_id)==null?void 0:U.replace("role:",""))||I.id;return a.jsx("option",{value:H,children:I.name||(H==null?void 0:H.replace(/_/g," "))},I.fragment_id||I.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:z||"",onChange:re,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(I=>{var U;const H=((U=I.fragment_id)==null?void 0:U.replace("task:",""))||I.id;return a.jsx("option",{value:H,children:I.name||(H==null?void 0:H.replace(/_/g," "))},I.fragment_id||I.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:C||"",onChange:ne,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(I=>a.jsx("option",{value:I.schema_id,children:I.title||I.schema_id.replace(/_/g," ")},I.schema_id))]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:L||"",onChange:V,style:{...Xe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(I=>{var U;const H=((U=I.fragment_id)==null?void 0:U.replace("pgc:",""))||I.id;return a.jsx("option",{value:H,children:I.name||(H==null?void 0:H.replace(/_/g," "))},I.fragment_id||I.id)})]})]}),O.length>0&&a.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),a.jsx("div",{className:"space-y-2",children:O.map(([I,H])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:I,onChange:U=>{const se={...c.includes};delete se[I],se[U.target.value]=H;const Oe={...c,includes:se};u(Oe),t(Oe)},style:{...Xe,width:"35%",fontSize:10},placeholder:"KEY"}),a.jsx("input",{type:"text",value:H,onChange:U=>p(I,U.target.value),style:{...Xe,flex:1,fontSize:10},placeholder:"path/to/file"}),a.jsx("button",{onClick:()=>y(I),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},I))})]}),a.jsx("button",{onClick:g,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const HB=["auto","user_choice"],WB=["eq","ne","lt","lte","gt","gte"],Xr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},si={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function UB({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[i,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(d,f)=>{const h={...i,[d]:f};s(h),r(h)},l=()=>{const d=[...i.conditions||[],{type:"retry_count",operator:"lt",value:2}];o("conditions",d)},c=(d,f,h)=>{const p=[...i.conditions||[]];p[d]={...p[d],[f]:h},o("conditions",p)},u=d=>{const f=(i.conditions||[]).filter((h,p)=>p!==d);o("conditions",f)};return i?a.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),a.jsx("button",{onClick:()=>n(i.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Edge ID"}),a.jsx("input",{type:"text",value:i.edge_id||"",onChange:d=>o("edge_id",d.target.value),style:Xr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"From Node"}),a.jsx("select",{value:i.from_node_id||"",onChange:d=>o("from_node_id",d.target.value),style:Xr,children:t.map(d=>a.jsx("option",{value:d,children:d},d))})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"To Node"}),a.jsxs("select",{value:i.to_node_id||"",onChange:d=>o("to_node_id",d.target.value||null),style:Xr,children:[a.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(d=>a.jsx("option",{value:d,children:d},d))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Outcome"}),a.jsx("input",{type:"text",value:i.outcome||"",onChange:d=>o("outcome",d.target.value),placeholder:"success, failed, etc.",style:Xr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Label"}),a.jsx("input",{type:"text",value:i.label||"",onChange:d=>o("label",d.target.value),placeholder:"Human-readable label",style:Xr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Kind"}),a.jsx("select",{value:i.kind||"auto",onChange:d=>o("kind",d.target.value),style:Xr,children:HB.map(d=>a.jsx("option",{value:d,children:d},d))})]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:i.non_advancing||!1,onChange:d=>o("non_advancing",d.target.checked)}),"Non-advancing"]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:si,children:"Conditions"}),a.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),a.jsx("div",{className:"space-y-2",children:(i.conditions||[]).map((d,f)=>a.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"text",value:d.type||"",onChange:h=>c(f,"type",h.target.value),placeholder:"retry_count",style:{...Xr,flex:1,fontSize:10}}),a.jsx("select",{value:d.operator||"lt",onChange:h=>c(f,"operator",h.target.value),style:{...Xr,width:"auto",fontSize:10},children:WB.map(h=>a.jsx("option",{value:h,children:h},h))}),a.jsx("input",{type:"text",value:d.value??"",onChange:h=>{const p=isNaN(h.target.value)?h.target.value:Number(h.target.value);c(f,"value",p)},placeholder:"value",style:{...Xr,width:50,fontSize:10}}),a.jsx("button",{onClick:()=>u(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const VB={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function GB({workspaceId:e,artifactId:t,onArtifactSave:r}){var M,q,W;const[n,i]=m.useState("canvas"),[s,o]=m.useState(null),[l,c]=m.useState(null),[u,d]=m.useState(""),[f,h]=m.useState(null),{workflowJson:p,loading:y,error:g,saving:w,lastSaveResult:v,updateWorkflow:x}=qT(e,t,{onSave:B=>{r==null||r(t,B)}}),{templates:b}=DT(),{schemas:_}=LT(),{fragmentsByKind:S}=FT(),k=m.useMemo(()=>{var B;return!s||!p?null:((B=p.nodes)==null?void 0:B.find(K=>K.node_id===s))||null},[s,p]),N=m.useMemo(()=>{var B;return!l||!p?null:((B=p.edges)==null?void 0:B.find(K=>K.edge_id===l))||null},[l,p]),E=m.useMemo(()=>p!=null&&p.nodes?p.nodes.map(B=>B.node_id):[],[p]),j=m.useCallback(B=>{x(B)},[x]),R=m.useCallback(B=>{if(!p)return;const K=p.nodes.map(ne=>ne.node_id===s?B:ne);let Z=p.edges,re=p.entry_node_ids||[];B.node_id!==s&&(Z=p.edges.map(ne=>({...ne,from_node_id:ne.from_node_id===s?B.node_id:ne.from_node_id,to_node_id:ne.to_node_id===s?B.node_id:ne.to_node_id})),re=re.map(ne=>ne===s?B.node_id:ne),o(B.node_id)),x({...p,nodes:K,edges:Z,entry_node_ids:re})},[p,s,x]),T=m.useCallback(B=>{if(!p)return;const K=p.edges.map(Z=>Z.edge_id===l?B:Z);B.edge_id!==l&&c(B.edge_id),x({...p,edges:K})},[p,l,x]),P=m.useCallback(B=>{p&&(x({...p,nodes:p.nodes.filter(K=>K.node_id!==B),edges:p.edges.filter(K=>K.from_node_id!==B&&K.to_node_id!==B),entry_node_ids:(p.entry_node_ids||[]).filter(K=>K!==B)}),o(null))},[p,x]),z=m.useCallback(B=>{p&&(x({...p,edges:p.edges.filter(K=>K.edge_id!==B)}),c(null))},[p,x]),C=m.useCallback(B=>{o(B),B&&c(null)},[]),L=m.useCallback(B=>{c(B),B&&o(null)},[]),O=m.useCallback(B=>{B==="json"&&p&&(d(JSON.stringify(p,null,2)),h(null)),i(B)},[p]),$=m.useCallback(B=>{const K=B.target.value;d(K);try{const Z=JSON.parse(K);h(null),x(Z)}catch(Z){h(Z.message)}},[x]),D=((M=v==null?void 0:v.tier1_report)==null?void 0:M.results)||[],A=D.filter(B=>B.severity==="error").length,F=D.filter(B=>B.severity==="warning").length;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[w&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),!w&&!g&&p&&a.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((q=p.nodes)==null?void 0:q.length)||0," nodes, ",((W=p.edges)==null?void 0:W.length)||0," edges"]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>a.jsx("button",{onClick:()=>O(B.id),style:{...VB,color:n===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:n===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),y?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[n==="canvas"&&a.jsxs(a.Fragment,{children:[a.jsx(Vc,{children:a.jsx(LB,{workflowJson:p,onWorkflowChange:j,selectedNodeId:s,selectedEdgeId:l,onNodeSelect:C,onEdgeSelect:L})}),k&&a.jsx(BB,{node:k,onChange:R,onDelete:P,templates:b,schemas:_,roleFragments:S.role||[],taskFragments:S.task||[],pgcFragments:S.pgc||[]}),N&&a.jsx(UB,{edge:N,nodeIds:E,onChange:T,onDelete:z})]}),n==="json"&&a.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[a.jsx("textarea",{value:u,onChange:$,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:f?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),f&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",f]})]}),n==="metadata"&&a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:p?a.jsx(KB,{workflow:p}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),D.length>0&&a.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[A>0&&a.jsxs("span",{style:{color:"#ef4444"},children:[A," error",A!==1?"s":""]}),F>0&&a.jsxs("span",{style:{color:"#f59e0b"},children:[F," warning",F!==1?"s":""]}),A===0&&F===0&&a.jsx("span",{style:{color:"#10b981"},children:"Valid"}),a.jsx("span",{style:{color:"var(--text-muted)"},children:D.map(B=>B.message).join(" | ")})]})]})}function KB({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],i=e.thread_ownership||{},s=Object.entries(i),o=e.entry_node_ids||[];return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l.label}),a.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),a.jsxs("div",{children:[a.jsx("label",{style:r,children:"Entry Node IDs"}),a.jsx("div",{style:t,children:o.length>0?o.join(", "):"-"})]}),s.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),s.map(([l,c])=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l}),a.jsx("div",{style:t,children:c})]},l))]})]})}function ag({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:i}){const[s,o]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!s)return;const c=u=>{l.current&&!l.current.contains(u.target)&&o(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),t.length===0?null:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:i?"var(--text-primary)":"var(--text-muted)",background:i?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:i?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,a.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),s&&a.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>a.jsxs("button",{onClick:()=>{n(c.id),o(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&a.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function lg({label:e,isSelected:t,onClick:r}){return a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function YB({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:i=[],onArtifactSave:s,onCreateDcwWorkflow:o,initialTab:l=null,docTypeSource:c=null}){var Le,Pe,Ue;const[u,d]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&d(l)},[l]);const[f,h]=m.useState("source"),[p,y]=m.useState(null),[g,w]=m.useState(!1),[v,x]=m.useState(null),[b,_]=m.useState(null),[S,k]=m.useState(!1),[N,E]=m.useState(null),[j,R]=m.useState(null),[T,P]=m.useState(!1),[z,C]=m.useState(null),[L,O]=m.useState(null),[$,D]=m.useState(!1),[A,F]=m.useState(null),M=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const I=t.role_prompt_ref.split(":");return I.length!==4||I[0]!=="prompt"||I[1]!=="role"?null:{roleId:I[2],version:I[3]}},[t==null?void 0:t.role_prompt_ref]),q=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const I=t.template_ref.split(":");return I.length!==4||I[0]!=="prompt"||I[1]!=="template"?null:{templateId:I[2],version:I[3]}},[t==null?void 0:t.template_ref]),W=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const I=t.qa_template_ref.split(":");return I.length!==4||I[0]!=="prompt"||I[1]!=="template"?null:{templateId:I[2],version:I[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const I=t.pgc_template_ref.split(":");return I.length!==4||I[0]!=="prompt"||I[1]!=="template"?null:{templateId:I[2],version:I[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!M){y(null);return}w(!0),x(null),Se.getRole(M.roleId,M.version).then(I=>{y(I.content)}).catch(I=>{console.error("Failed to load role:",I),x(I.message)}).finally(()=>{w(!1)})},[M]),m.useEffect(()=>{if(!q){_(null);return}k(!0),E(null),Se.getTemplate(q.templateId,q.version).then(I=>{_(I.content)}).catch(I=>{console.error("Failed to load template:",I),E(I.message)}).finally(()=>{k(!1)})},[q]),m.useEffect(()=>{if(!W){R(null);return}P(!0),C(null),Se.getTemplate(W.templateId,W.version).then(I=>{R(I.content)}).catch(I=>{console.error("Failed to load QA template:",I),C(I.message)}).finally(()=>{P(!1)})},[W]),m.useEffect(()=>{if(!B){O(null);return}D(!0),F(null),Se.getTemplate(B.templateId,B.version).then(I=>{O(I.content)}).catch(I=>{console.error("Failed to load PGC template:",I),F(I.message)}).finally(()=>{D(!1)})},[B]);const K=m.useMemo(()=>{if(!t||u==="role_prompt")return null;const I=t.version||t.active_version;return`doctype:${t.doc_type_id}:${I}:${u}`},[t,u]),{content:Z,loading:re,error:ne,saving:V,isDirty:ee,updateContent:ve,lastSaveResult:fe}=_a(e,K,{onSave:I=>{s==null||s(K,I)}}),be=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],ce=m.useMemo(()=>t?be.filter(I=>I.id==="package"?!0:I.id==="role_prompt"?!!t.role_prompt_ref:I.id==="template"?!!t.template_ref:I.id==="qa_template"?!!t.qa_template_ref:I.id==="pgc_template"?!!t.pgc_template_ref:I.id==="workflow"?!0:t.artifacts?t.artifacts[I.id]!=null:!1):[],[t]),te=c==="task"||c==="schema";m.useEffect(()=>{te||ce.length>0&&!ce.find(I=>I.id===u)&&d(ce[0].id)},[ce,u,te]);const we=u==="role_prompt"||u==="template"||u==="qa_template"||u==="pgc_template",Y=u==="package",X=u==="schema",ue=u==="workflow",he=!we&&!Y&&!X&&!ue,_e=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:i.some(I=>I.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,i]),[ge,Q]=m.useState(!1),pe=async()=>{if(!(!(t!=null&&t.doc_type_id)||!o)){Q(!0);try{await o(t.doc_type_id)}finally{Q(!1)}}};if(!t&&!r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),a.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),a.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const We=c==="task"?"Interaction":c==="schema"?"Schema":null,Re=!te&&(u==="task_prompt"||u==="schema");return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),a.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:te?We:a.jsxs(a.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),te&&a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!te&&a.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[ce.find(I=>I.id==="package")&&a.jsx(lg,{label:"Package",isSelected:u==="package",onClick:()=>{d("package"),h("source")}}),ce.find(I=>I.id==="workflow")&&a.jsx(lg,{label:"Workflow",isSelected:u==="workflow",onClick:()=>{d("workflow"),h("source")}}),(()=>{const I=["role_prompt","task_prompt","template"],H=ce.filter(U=>I.includes(U.id)).map(U=>({id:U.id,label:U.id==="role_prompt"?"Role":U.id==="task_prompt"?"Task":"Template",viewOnly:U.viewOnly}));return H.length===0?null:a.jsx(ag,{label:"Generation",items:H,selectedId:I.includes(u)?u:null,onSelect:U=>{d(U),h("source")},isGroupActive:I.includes(u)})})(),(()=>{const I=["qa_prompt","qa_template"],H=ce.filter(U=>I.includes(U.id)).map(U=>({id:U.id,label:U.id==="qa_prompt"?"Prompt":"Template",viewOnly:U.viewOnly}));return H.length===0?null:a.jsx(ag,{label:"QA",items:H,selectedId:I.includes(u)?u:null,onSelect:U=>{d(U),h("source")},isGroupActive:I.includes(u)})})(),(()=>{const I=["pgc_context","pgc_template"],H=ce.filter(U=>I.includes(U.id)).map(U=>({id:U.id,label:U.id==="pgc_context"?"Context":"Template",viewOnly:U.viewOnly}));return H.length===0?null:a.jsx(ag,{label:"PGC",items:H,selectedId:I.includes(u)?u:null,onSelect:U=>{d(U),h("source")},isGroupActive:I.includes(u)})})(),ce.find(I=>I.id==="schema")&&a.jsx(lg,{label:"Schema",isSelected:u==="schema",onClick:()=>{d("schema"),h("source")}})]}),!te&&he&&!Re&&a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>h("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:f==="source"?"var(--action-primary)":"transparent",color:f==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),a.jsx("button",{onClick:()=>h("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:f==="resolved"?"var(--action-primary)":"transparent",color:f==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),f==="source"&&((Le=t==null?void 0:t.artifacts)==null?void 0:Le[u])&&a.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[u]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[u]]})]}),we&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:u==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),u==="role_prompt"&&M&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[M.roleId.replace(/_/g," ")," v",M.version]}),u==="template"&&q&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[q.templateId.replace(/_/g," ")," v",q.version]}),u==="qa_template"&&W&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[W.templateId.replace(/_/g," ")," v",W.version]}),u==="pgc_template"&&B&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Re&&a.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:u==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),X&&((Pe=t==null?void 0:t.artifacts)==null?void 0:Pe.schema)&&a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:ue?_e?a.jsx(GB,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 max-w-md",children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),a.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),o&&a.jsx("button",{onClick:pe,disabled:ge,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:ge?"wait":"pointer",opacity:ge?.7:1},children:ge?"Creating...":"Create Workflow"})]})}):u==="package"?a.jsx(CB,{workspaceId:e,docType:t,roles:n,onSave:s}):u==="role_prompt"?a.jsx(Jr,{content:p||"",onChange:()=>{},loading:g,saving:!1,isDirty:!1,error:v,readOnly:!0,placeholder:"No role prompt configured for this document type"}):u==="template"?a.jsx(Jr,{content:b||"",onChange:()=>{},loading:S,saving:!1,isDirty:!1,error:N,readOnly:!0,placeholder:"No template configured for this document type"}):u==="qa_template"?a.jsx(Jr,{content:j||"",onChange:()=>{},loading:T,saving:!1,isDirty:!1,error:z,readOnly:!0,placeholder:"No QA template configured for this document type"}):u==="pgc_template"?a.jsx(Jr,{content:L||"",onChange:()=>{},loading:$,saving:!1,isDirty:!1,error:A,readOnly:!0,placeholder:"No PGC template configured for this document type"}):f==="source"||X?a.jsx(Jr,{content:Z,onChange:Re?()=>{}:ve,loading:re,saving:Re?!1:V,isDirty:Re?!1:ee,error:ne,readOnly:Re,placeholder:`Enter ${((Ue=ce.find(I=>I.id===u))==null?void 0:Ue.label)||"prompt"} content...`,isJson:X}):a.jsx(NB,{workspaceId:e,artifactId:K})}),he&&(fe==null?void 0:fe.tier1)&&!fe.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function XB({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:i,loading:s,error:o,saving:l,isDirty:c,updateContent:u,lastSaveResult:d}=_a(e,n,{onSave:h=>{r==null||r(n,h)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),a.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase());return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),a.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(Jr,{content:i,onChange:u,loading:s,saving:l,isDirty:c,error:o,placeholder:"Enter role prompt content..."})}),(d==null?void 0:d.tier1)&&!d.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function $T(e){return typeof e>"u"||e===null}function QB(e){return typeof e=="object"&&e!==null}function ZB(e){return Array.isArray(e)?e:$T(e)?[]:[e]}function JB(e,t){var r,n,i,s;if(t)for(s=Object.keys(t),r=0,n=s.length;r<n;r+=1)i=s[r],e[i]=t[i];return e}function e9(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function t9(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var r9=$T,n9=QB,i9=ZB,s9=e9,o9=t9,a9=JB,lt={isNothing:r9,isObject:n9,toArray:i9,repeat:s9,isNegativeZero:o9,extend:a9};function BT(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function ra(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=BT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ra.prototype=Object.create(Error.prototype);ra.prototype.constructor=ra;ra.prototype.toString=function(t){return this.name+": "+BT(this,t)};var Tt=ra;function cg(e,t,r,n,i){var s="",o="",l=Math.floor(i/2)-1;return n-t>l&&(s=" ... ",t=n-l+s.length),r-n>l&&(o=" ...",r=n+l-o.length),{str:s+e.slice(t,r).replace(/\t/g,"")+o,pos:n-t+s.length}}function ug(e,t){return lt.repeat(" ",t-e.length)+e}function l9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],s,o=-1;s=r.exec(e.buffer);)i.push(s.index),n.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=n.length-2);o<0&&(o=n.length-1);var l="",c,u,d=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+d+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)u=cg(e.buffer,n[o-c],i[o-c],e.position-(n[o]-n[o-c]),f),l=lt.repeat(" ",t.indent)+ug((e.line-c+1).toString(),d)+" | "+u.str+`
`+l;for(u=cg(e.buffer,n[o],i[o],e.position,f),l+=lt.repeat(" ",t.indent)+ug((e.line+1).toString(),d)+" | "+u.str+`
`,l+=lt.repeat("-",t.indent+d+3+u.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)u=cg(e.buffer,n[o+c],i[o+c],e.position-(n[o]-n[o+c]),f),l+=lt.repeat(" ",t.indent)+ug((e.line+c+1).toString(),d)+" | "+u.str+`
`;return l.replace(/\n$/,"")}var c9=l9,u9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],d9=["scalar","sequence","mapping"];function f9(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function p9(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(u9.indexOf(r)===-1)throw new Tt('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=f9(t.styleAliases||null),d9.indexOf(this.kind)===-1)throw new Tt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var vt=p9;function ej(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(s,o){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(i=o)}),r[i]=n}),r}function h9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Av(e){return this.extend(e)}Av.prototype.extend=function(t){var r=[],n=[];if(t instanceof vt)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new Tt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof vt))throw new Tt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new Tt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Tt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof vt))throw new Tt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Av.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=ej(i,"implicit"),i.compiledExplicit=ej(i,"explicit"),i.compiledTypeMap=h9(i.compiledImplicit,i.compiledExplicit),i};var HT=Av,WT=new vt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),UT=new vt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),VT=new vt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),GT=new HT({explicit:[WT,UT,VT]});function m9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function g9(){return null}function v9(e){return e===null}var KT=new vt("tag:yaml.org,2002:null",{kind:"scalar",resolve:m9,construct:g9,predicate:v9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function x9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function y9(e){return e==="true"||e==="True"||e==="TRUE"}function b9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var YT=new vt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:x9,construct:y9,predicate:b9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function w9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function _9(e){return 48<=e&&e<=55}function S9(e){return 48<=e&&e<=57}function j9(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!w9(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!_9(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!S9(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function k9(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function N9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!lt.isNegativeZero(e)}var XT=new vt("tag:yaml.org,2002:int",{kind:"scalar",resolve:j9,construct:k9,predicate:N9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),C9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function E9(e){return!(e===null||!C9.test(e)||e[e.length-1]==="_")}function T9(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var R9=/^[-+]?[0-9]+e/;function A9(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(lt.isNegativeZero(e))return"-0.0";return r=e.toString(10),R9.test(r)?r.replace("e",".e"):r}function I9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||lt.isNegativeZero(e))}var QT=new vt("tag:yaml.org,2002:float",{kind:"scalar",resolve:E9,construct:T9,predicate:I9,represent:A9,defaultStyle:"lowercase"}),ZT=GT.extend({implicit:[KT,YT,XT,QT]}),JT=ZT,e4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),t4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function M9(e){return e===null?!1:e4.exec(e)!==null||t4.exec(e)!==null}function P9(e){var t,r,n,i,s,o,l,c=0,u=null,d,f,h;if(t=e4.exec(e),t===null&&(t=t4.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(s=+t[4],o=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(d=+t[10],f=+(t[11]||0),u=(d*60+f)*6e4,t[9]==="-"&&(u=-u)),h=new Date(Date.UTC(r,n,i,s,o,l,c)),u&&h.setTime(h.getTime()-u),h}function O9(e){return e.toISOString()}var r4=new vt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:M9,construct:P9,instanceOf:Date,represent:O9});function D9(e){return e==="<<"||e===null}var n4=new vt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:D9}),yy=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function L9(e){if(e===null)return!1;var t,r,n=0,i=e.length,s=yy;for(r=0;r<i;r++)if(t=s.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function F9(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,s=yy,o=0,l=[];for(t=0;t<i;t++)t%4===0&&t&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|s.indexOf(n.charAt(t));return r=i%4*6,r===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):r===18?(l.push(o>>10&255),l.push(o>>2&255)):r===12&&l.push(o>>4&255),new Uint8Array(l)}function z9(e){var t="",r=0,n,i,s=e.length,o=yy;for(n=0;n<s;n++)n%3===0&&n&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[n];return i=s%3,i===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):i===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):i===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function q9(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var i4=new vt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:L9,construct:F9,predicate:q9,represent:z9}),$9=Object.prototype.hasOwnProperty,B9=Object.prototype.toString;function H9(e){if(e===null)return!0;var t=[],r,n,i,s,o,l=e;for(r=0,n=l.length;r<n;r+=1){if(i=l[r],o=!1,B9.call(i)!=="[object Object]")return!1;for(s in i)if($9.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function W9(e){return e!==null?e:[]}var s4=new vt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:H9,construct:W9}),U9=Object.prototype.toString;function V9(e){if(e===null)return!0;var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(n=o[t],U9.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;s[t]=[i[0],n[i[0]]]}return!0}function G9(e){if(e===null)return[];var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1)n=o[t],i=Object.keys(n),s[t]=[i[0],n[i[0]]];return s}var o4=new vt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:V9,construct:G9}),K9=Object.prototype.hasOwnProperty;function Y9(e){if(e===null)return!0;var t,r=e;for(t in r)if(K9.call(r,t)&&r[t]!==null)return!1;return!0}function X9(e){return e!==null?e:{}}var a4=new vt("tag:yaml.org,2002:set",{kind:"mapping",resolve:Y9,construct:X9}),by=JT.extend({implicit:[r4,n4],explicit:[i4,s4,o4,a4]}),Xn=Object.prototype.hasOwnProperty,dc=1,l4=2,c4=3,fc=4,dg=1,Q9=2,tj=3,Z9=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,J9=/[\x85\u2028\u2029]/,eH=/[,\[\]\{\}]/,u4=/^(?:!|!!|![a-z\-]+!)$/i,d4=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function rj(e){return Object.prototype.toString.call(e)}function Hr(e){return e===10||e===13}function yi(e){return e===9||e===32}function zt(e){return e===9||e===32||e===10||e===13}function ns(e){return e===44||e===91||e===93||e===123||e===125}function tH(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function rH(e){return e===120?2:e===117?4:e===85?8:0}function nH(e){return 48<=e&&e<=57?e-48:-1}function nj(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function iH(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function f4(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var p4=new Array(256),h4=new Array(256);for(var $i=0;$i<256;$i++)p4[$i]=nj($i)?1:0,h4[$i]=nj($i);function sH(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||by,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function m4(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=c9(r),new Tt(t,r)}function le(e,t){throw m4(e,t)}function pc(e,t){e.onWarning&&e.onWarning.call(null,m4(e,t))}var ij={YAML:function(t,r,n){var i,s,o;t.version!==null&&le(t,"duplication of %YAML directive"),n.length!==1&&le(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&le(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&le(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&pc(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,s;n.length!==2&&le(t,"TAG directive accepts exactly two arguments"),i=n[0],s=n[1],u4.test(i)||le(t,"ill-formed tag handle (first argument) of the TAG directive"),Xn.call(t.tagMap,i)&&le(t,'there is a previously declared suffix for "'+i+'" tag handle'),d4.test(s)||le(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{le(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function Vn(e,t,r,n){var i,s,o,l;if(t<r){if(l=e.input.slice(t,r),n)for(i=0,s=l.length;i<s;i+=1)o=l.charCodeAt(i),o===9||32<=o&&o<=1114111||le(e,"expected valid JSON character");else Z9.test(l)&&le(e,"the stream contains non-printable characters");e.result+=l}}function sj(e,t,r,n){var i,s,o,l;for(lt.isObject(r)||le(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),o=0,l=i.length;o<l;o+=1)s=i[o],Xn.call(t,s)||(f4(t,s,r[s]),n[s]=!0)}function is(e,t,r,n,i,s,o,l,c){var u,d;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),u=0,d=i.length;u<d;u+=1)Array.isArray(i[u])&&le(e,"nested arrays are not supported inside keys"),typeof i=="object"&&rj(i[u])==="[object Object]"&&(i[u]="[object Object]");if(typeof i=="object"&&rj(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(u=0,d=s.length;u<d;u+=1)sj(e,t,s[u],r);else sj(e,t,s,r);else!e.json&&!Xn.call(r,i)&&Xn.call(t,i)&&(e.line=o||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,le(e,"duplicated mapping key")),f4(t,i,s),delete r[i];return t}function wy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):le(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function rt(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;yi(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Hr(i))for(wy(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&pc(e,"deficient indentation"),n}function fu(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||zt(r)))}function _y(e,t){t===1?e.result+=" ":t>1&&(e.result+=lt.repeat(`
`,t-1))}function oH(e,t,r){var n,i,s,o,l,c,u,d,f=e.kind,h=e.result,p;if(p=e.input.charCodeAt(e.position),zt(p)||ns(p)||p===35||p===38||p===42||p===33||p===124||p===62||p===39||p===34||p===37||p===64||p===96||(p===63||p===45)&&(i=e.input.charCodeAt(e.position+1),zt(i)||r&&ns(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,l=!1;p!==0;){if(p===58){if(i=e.input.charCodeAt(e.position+1),zt(i)||r&&ns(i))break}else if(p===35){if(n=e.input.charCodeAt(e.position-1),zt(n))break}else{if(e.position===e.lineStart&&fu(e)||r&&ns(p))break;if(Hr(p))if(c=e.line,u=e.lineStart,d=e.lineIndent,rt(e,!1,-1),e.lineIndent>=t){l=!0,p=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=u,e.lineIndent=d;break}}l&&(Vn(e,s,o,!1),_y(e,e.line-c),s=o=e.position,l=!1),yi(p)||(o=e.position+1),p=e.input.charCodeAt(++e.position)}return Vn(e,s,o,!1),e.result?!0:(e.kind=f,e.result=h,!1)}function aH(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Vn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else Hr(r)?(Vn(e,n,i,!0),_y(e,rt(e,!1,t)),n=i=e.position):e.position===e.lineStart&&fu(e)?le(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);le(e,"unexpected end of the stream within a single quoted scalar")}function lH(e,t){var r,n,i,s,o,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Vn(e,r,e.position,!0),e.position++,!0;if(l===92){if(Vn(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Hr(l))rt(e,!1,t);else if(l<256&&p4[l])e.result+=h4[l],e.position++;else if((o=rH(l))>0){for(i=o,s=0;i>0;i--)l=e.input.charCodeAt(++e.position),(o=tH(l))>=0?s=(s<<4)+o:le(e,"expected hexadecimal character");e.result+=iH(s),e.position++}else le(e,"unknown escape sequence");r=n=e.position}else Hr(l)?(Vn(e,r,n,!0),_y(e,rt(e,!1,t)),r=n=e.position):e.position===e.lineStart&&fu(e)?le(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}le(e,"unexpected end of the stream within a double quoted scalar")}function cH(e,t){var r=!0,n,i,s,o=e.tag,l,c=e.anchor,u,d,f,h,p,y=Object.create(null),g,w,v,x;if(x=e.input.charCodeAt(e.position),x===91)d=93,p=!1,l=[];else if(x===123)d=125,p=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),x=e.input.charCodeAt(++e.position);x!==0;){if(rt(e,!0,t),x=e.input.charCodeAt(e.position),x===d)return e.position++,e.tag=o,e.anchor=c,e.kind=p?"mapping":"sequence",e.result=l,!0;r?x===44&&le(e,"expected the node content, but found ','"):le(e,"missed comma between flow collection entries"),w=g=v=null,f=h=!1,x===63&&(u=e.input.charCodeAt(e.position+1),zt(u)&&(f=h=!0,e.position++,rt(e,!0,t))),n=e.line,i=e.lineStart,s=e.position,Ns(e,t,dc,!1,!0),w=e.tag,g=e.result,rt(e,!0,t),x=e.input.charCodeAt(e.position),(h||e.line===n)&&x===58&&(f=!0,x=e.input.charCodeAt(++e.position),rt(e,!0,t),Ns(e,t,dc,!1,!0),v=e.result),p?is(e,l,y,w,g,v,n,i,s):f?l.push(is(e,null,y,w,g,v,n,i,s)):l.push(g),rt(e,!0,t),x=e.input.charCodeAt(e.position),x===44?(r=!0,x=e.input.charCodeAt(++e.position)):r=!1}le(e,"unexpected end of the stream within a flow collection")}function uH(e,t){var r,n,i=dg,s=!1,o=!1,l=t,c=0,u=!1,d,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)dg===i?i=f===43?tj:Q9:le(e,"repeat of a chomping mode identifier");else if((d=nH(f))>=0)d===0?le(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?le(e,"repeat of an indentation width identifier"):(l=t+d-1,o=!0);else break;if(yi(f)){do f=e.input.charCodeAt(++e.position);while(yi(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Hr(f)&&f!==0)}for(;f!==0;){for(wy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>l&&(l=e.lineIndent),Hr(f)){c++;continue}if(e.lineIndent<l){i===tj?e.result+=lt.repeat(`
`,s?1+c:c):i===dg&&s&&(e.result+=`
`);break}for(n?yi(f)?(u=!0,e.result+=lt.repeat(`
`,s?1+c:c)):u?(u=!1,e.result+=lt.repeat(`
`,c+1)):c===0?s&&(e.result+=" "):e.result+=lt.repeat(`
`,c):e.result+=lt.repeat(`
`,s?1+c:c),s=!0,o=!0,c=0,r=e.position;!Hr(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Vn(e,r,e.position,!1)}return!0}function oj(e,t){var r,n=e.tag,i=e.anchor,s=[],o,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,le(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!zt(o))));){if(l=!0,e.position++,rt(e,!0,-1)&&e.lineIndent<=t){s.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Ns(e,t,c4,!1,!0),s.push(e.result),rt(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)le(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function dH(e,t,r){var n,i,s,o,l,c,u=e.tag,d=e.anchor,f={},h=Object.create(null),p=null,y=null,g=null,w=!1,v=!1,x;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),x=e.input.charCodeAt(e.position);x!==0;){if(!w&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,le(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),s=e.line,(x===63||x===58)&&zt(n))x===63?(w&&(is(e,f,h,p,y,null,o,l,c),p=y=g=null),v=!0,w=!0,i=!0):w?(w=!1,i=!0):le(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,x=n;else{if(o=e.line,l=e.lineStart,c=e.position,!Ns(e,r,l4,!1,!0))break;if(e.line===s){for(x=e.input.charCodeAt(e.position);yi(x);)x=e.input.charCodeAt(++e.position);if(x===58)x=e.input.charCodeAt(++e.position),zt(x)||le(e,"a whitespace character is expected after the key-value separator within a block mapping"),w&&(is(e,f,h,p,y,null,o,l,c),p=y=g=null),v=!0,w=!1,i=!1,p=e.tag,y=e.result;else if(v)le(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=u,e.anchor=d,!0}else if(v)le(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=u,e.anchor=d,!0}if((e.line===s||e.lineIndent>t)&&(w&&(o=e.line,l=e.lineStart,c=e.position),Ns(e,t,fc,!0,i)&&(w?y=e.result:g=e.result),w||(is(e,f,h,p,y,g,o,l,c),p=y=g=null),rt(e,!0,-1),x=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&x!==0)le(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return w&&is(e,f,h,p,y,null,o,l,c),v&&(e.tag=u,e.anchor=d,e.kind="mapping",e.result=f),v}function fH(e){var t,r=!1,n=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&le(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(n=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):le(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!zt(o);)o===33&&(n?le(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),u4.test(i)||le(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),eH.test(s)&&le(e,"tag suffix cannot contain flow indicator characters")}s&&!d4.test(s)&&le(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{le(e,"tag name is malformed: "+s)}return r?e.tag=s:Xn.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:le(e,'undeclared tag handle "'+i+'"'),!0}function pH(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&le(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!zt(r)&&!ns(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&le(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function hH(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!zt(n)&&!ns(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&le(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Xn.call(e.anchorMap,r)||le(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],rt(e,!0,-1),!0}function Ns(e,t,r,n,i){var s,o,l,c=1,u=!1,d=!1,f,h,p,y,g,w;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=l=fc===r||c4===r,n&&rt(e,!0,-1)&&(u=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;fH(e)||pH(e);)rt(e,!0,-1)?(u=!0,l=s,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=u||i),(c===1||fc===r)&&(dc===r||l4===r?g=t:g=t+1,w=e.position-e.lineStart,c===1?l&&(oj(e,w)||dH(e,w,g))||cH(e,g)?d=!0:(o&&uH(e,g)||aH(e,g)||lH(e,g)?d=!0:hH(e)?(d=!0,(e.tag!==null||e.anchor!==null)&&le(e,"alias node should not have any properties")):oH(e,g,dc===r)&&(d=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(d=l&&oj(e,w))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&le(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,h=e.implicitTypes.length;f<h;f+=1)if(y=e.implicitTypes[f],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xn.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,p=e.typeMap.multi[e.kind||"fallback"],f=0,h=p.length;f<h;f+=1)if(e.tag.slice(0,p[f].tag.length)===p[f].tag){y=p[f];break}y||le(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&le(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):le(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||d}function mH(e){var t=e.position,r,n,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(rt(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!zt(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&le(e,"directive name must not be less than one character in length");o!==0;){for(;yi(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Hr(o));break}if(Hr(o))break;for(r=e.position;o!==0&&!zt(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}o!==0&&wy(e),Xn.call(ij,n)?ij[n](e,n,i):pc(e,'unknown document directive "'+n+'"')}if(rt(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,rt(e,!0,-1)):s&&le(e,"directives end mark is expected"),Ns(e,e.lineIndent-1,fc,!1,!0),rt(e,!0,-1),e.checkLineBreaks&&J9.test(e.input.slice(t,e.position))&&pc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&fu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,rt(e,!0,-1));return}if(e.position<e.length-1)le(e,"end of the stream or a document separator is expected");else return}function g4(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new sH(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,le(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)mH(r);return r.documents}function gH(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=g4(e,r);if(typeof t!="function")return n;for(var i=0,s=n.length;i<s;i+=1)t(n[i])}function vH(e,t){var r=g4(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new Tt("expected a single document in the stream, but found more")}}var xH=gH,yH=vH,v4={loadAll:xH,load:yH},x4=Object.prototype.toString,y4=Object.prototype.hasOwnProperty,Sy=65279,bH=9,na=10,wH=13,_H=32,SH=33,jH=34,Iv=35,kH=37,NH=38,CH=39,EH=42,b4=44,TH=45,hc=58,RH=61,AH=62,IH=63,MH=64,w4=91,_4=93,PH=96,S4=123,OH=124,j4=125,jt={};jt[0]="\\0";jt[7]="\\a";jt[8]="\\b";jt[9]="\\t";jt[10]="\\n";jt[11]="\\v";jt[12]="\\f";jt[13]="\\r";jt[27]="\\e";jt[34]='\\"';jt[92]="\\\\";jt[133]="\\N";jt[160]="\\_";jt[8232]="\\L";jt[8233]="\\P";var DH=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],LH=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function FH(e,t){var r,n,i,s,o,l,c;if(t===null)return{};for(r={},n=Object.keys(t),i=0,s=n.length;i<s;i+=1)o=n[i],l=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&y4.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[o]=l;return r}function zH(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new Tt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+lt.repeat("0",n-t.length)+t}var qH=1,ia=2;function $H(e){this.schema=e.schema||by,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=lt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=FH(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?ia:qH,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function aj(e,t){for(var r=lt.repeat(" ",t),n=0,i=-1,s="",o,l=e.length;n<l;)i=e.indexOf(`
`,n),i===-1?(o=e.slice(n),n=l):(o=e.slice(n,i+1),n=i+1),o.length&&o!==`
`&&(s+=r),s+=o;return s}function Mv(e,t){return`
`+lt.repeat(" ",e.indent*t)}function BH(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function mc(e){return e===_H||e===bH}function sa(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Sy||65536<=e&&e<=1114111}function lj(e){return sa(e)&&e!==Sy&&e!==wH&&e!==na}function cj(e,t,r){var n=lj(e),i=n&&!mc(e);return(r?n:n&&e!==b4&&e!==w4&&e!==_4&&e!==S4&&e!==j4)&&e!==Iv&&!(t===hc&&!i)||lj(t)&&!mc(t)&&e===Iv||t===hc&&i}function HH(e){return sa(e)&&e!==Sy&&!mc(e)&&e!==TH&&e!==IH&&e!==hc&&e!==b4&&e!==w4&&e!==_4&&e!==S4&&e!==j4&&e!==Iv&&e!==NH&&e!==EH&&e!==SH&&e!==OH&&e!==RH&&e!==AH&&e!==CH&&e!==jH&&e!==kH&&e!==MH&&e!==PH}function WH(e){return!mc(e)&&e!==hc}function vo(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function k4(e){var t=/^\n* /;return t.test(e)}var N4=1,Pv=2,C4=3,E4=4,Bi=5;function UH(e,t,r,n,i,s,o,l){var c,u=0,d=null,f=!1,h=!1,p=n!==-1,y=-1,g=HH(vo(e,0))&&WH(vo(e,e.length-1));if(t||o)for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=vo(e,c),!sa(u))return Bi;g=g&&cj(u,d,l),d=u}else{for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=vo(e,c),u===na)f=!0,p&&(h=h||c-y-1>n&&e[y+1]!==" ",y=c);else if(!sa(u))return Bi;g=g&&cj(u,d,l),d=u}h=h||p&&c-y-1>n&&e[y+1]!==" "}return!f&&!h?g&&!o&&!i(e)?N4:s===ia?Bi:Pv:r>9&&k4(e)?Bi:o?s===ia?Bi:Pv:h?E4:C4}function VH(e,t,r,n,i){e.dump=function(){if(t.length===0)return e.quotingType===ia?'""':"''";if(!e.noCompatMode&&(DH.indexOf(t)!==-1||LH.test(t)))return e.quotingType===ia?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(u){return BH(e,u)}switch(UH(t,l,e.indent,o,c,e.quotingType,e.forceQuotes&&!n,i)){case N4:return t;case Pv:return"'"+t.replace(/'/g,"''")+"'";case C4:return"|"+uj(t,e.indent)+dj(aj(t,s));case E4:return">"+uj(t,e.indent)+dj(aj(GH(t,o),s));case Bi:return'"'+KH(t)+'"';default:throw new Tt("impossible error: invalid scalar style")}}()}function uj(e,t){var r=k4(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),s=i?"+":n?"":"-";return r+s+`
`}function dj(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function GH(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var u=e.indexOf(`
`);return u=u!==-1?u:e.length,r.lastIndex=u,fj(e.slice(0,u),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=r.exec(e);){var l=o[1],c=o[2];s=c[0]===" ",n+=l+(!i&&!s&&c!==""?`
`:"")+fj(c,t),i=s}return n}function fj(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,s,o=0,l=0,c="";n=r.exec(e);)l=n.index,l-i>t&&(s=o>i?o:l,c+=`
`+e.slice(i,s),i=s+1),o=l;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function KH(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=vo(e,i),n=jt[r],!n&&sa(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||zH(r);return t}function YH(e,t,r){var n="",i=e.tag,s,o,l;for(s=0,o=r.length;s<o;s+=1)l=r[s],e.replacer&&(l=e.replacer.call(r,String(s),l)),(mn(e,t,l,!1,!1)||typeof l>"u"&&mn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function pj(e,t,r,n){var i="",s=e.tag,o,l,c;for(o=0,l=r.length;o<l;o+=1)c=r[o],e.replacer&&(c=e.replacer.call(r,String(o),c)),(mn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&mn(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Mv(e,t)),e.dump&&na===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function XH(e,t,r){var n="",i=e.tag,s=Object.keys(r),o,l,c,u,d;for(o=0,l=s.length;o<l;o+=1)d="",n!==""&&(d+=", "),e.condenseFlow&&(d+='"'),c=s[o],u=r[c],e.replacer&&(u=e.replacer.call(r,c,u)),mn(e,t,c,!1,!1)&&(e.dump.length>1024&&(d+="? "),d+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),mn(e,t,u,!1,!1)&&(d+=e.dump,n+=d));e.tag=i,e.dump="{"+n+"}"}function QH(e,t,r,n){var i="",s=e.tag,o=Object.keys(r),l,c,u,d,f,h;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new Tt("sortKeys must be a boolean or a function");for(l=0,c=o.length;l<c;l+=1)h="",(!n||i!=="")&&(h+=Mv(e,t)),u=o[l],d=r[u],e.replacer&&(d=e.replacer.call(r,u,d)),mn(e,t+1,u,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&na===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,f&&(h+=Mv(e,t)),mn(e,t+1,d,!0,f)&&(e.dump&&na===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,i+=h));e.tag=s,e.dump=i||"{}"}function hj(e,t,r){var n,i,s,o,l,c;for(i=r?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(l=i[s],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,x4.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(y4.call(l.represent,c))n=l.represent[c](t,c);else throw new Tt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function mn(e,t,r,n,i,s,o){e.tag=null,e.dump=r,hj(e,r,!1)||hj(e,r,!0);var l=x4.call(e.dump),c=n,u;n&&(n=e.flowLevel<0||e.flowLevel>t);var d=l==="[object Object]"||l==="[object Array]",f,h;if(d&&(f=e.duplicates.indexOf(r),h=f!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(i=!1),h&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(d&&h&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(QH(e,t,e.dump,i),h&&(e.dump="&ref_"+f+e.dump)):(XH(e,t,e.dump),h&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?pj(e,t-1,e.dump,i):pj(e,t,e.dump,i),h&&(e.dump="&ref_"+f+e.dump)):(YH(e,t,e.dump),h&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&VH(e,e.dump,t,s,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Tt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(u=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",e.dump=u+" "+e.dump)}return!0}function ZH(e,t){var r=[],n=[],i,s;for(Ov(e,r,n),i=0,s=n.length;i<s;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(s)}function Ov(e,t,r){var n,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Ov(e[i],t,r);else for(n=Object.keys(e),i=0,s=n.length;i<s;i+=1)Ov(e[n[i]],t,r)}function JH(e,t){t=t||{};var r=new $H(t);r.noRefs||ZH(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),mn(r,0,n,!0,!0)?r.dump+`
`:""}var e7=JH,t7={dump:e7};function jy(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var r7=vt,n7=HT,i7=GT,s7=ZT,o7=JT,a7=by,l7=v4.load,c7=v4.loadAll,u7=t7.dump,d7=Tt,f7={binary:i4,float:QT,map:VT,null:KT,pairs:o4,set:a4,timestamp:r4,bool:YT,int:XT,merge:n4,omap:s4,seq:UT,str:WT},p7=jy("safeLoad","load"),h7=jy("safeLoadAll","loadAll"),m7=jy("safeDump","dump"),T4={Type:r7,Schema:n7,FAILSAFE_SCHEMA:i7,JSON_SCHEMA:s7,CORE_SCHEMA:o7,DEFAULT_SCHEMA:a7,load:l7,loadAll:c7,dump:u7,YAMLException:d7,types:f7,safeLoad:p7,safeLoadAll:h7,safeDump:m7};const g7=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],fg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},pg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function v7({workspaceId:e,template:t,onArtifactSave:r}){const[n,i]=m.useState("metadata"),[s,o]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[u,d]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,h=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:p,loading:y,error:g,saving:w,isDirty:v,updateContent:x,lastSaveResult:b}=_a(e,f,{onSave:j=>{r==null||r(f,j)}});m.useEffect(()=>{t&&(o({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const _=m.useCallback((j,R)=>{o(T=>({...T,[j]:R})),c(!0)},[]),S=m.useCallback(async()=>{if(!(!e||!h)){d(!0);try{const j=T4.dump({name:s.name||null,purpose:s.purpose||null,use_case:s.use_case||null},{lineWidth:-1});await Se.writeArtifact(e,h,j),c(!1),r==null||r(h,{success:!0})}catch(j){console.error("Failed to save metadata:",j),alert(`Failed to save metadata: ${j.message}`)}finally{d(!1)}}},[e,h,s,r]),k=m.useCallback(()=>{l&&S()},[l,S]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),a.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const N=s.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase()),E=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:N}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.active_version]}),a.jsx("span",{children:""}),a.jsx("span",{children:"Shared Template"}),s.purpose&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:s.purpose})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:E.map(j=>a.jsxs("button",{onClick:()=>i(j.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===j.id?"var(--text-primary)":"var(--text-muted)",background:n===j.id?"var(--bg-canvas)":"transparent",borderBottom:n===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[j.label,j.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),j.id==="template"&&v&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},j.id))}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:pg,children:"Template Name"}),a.jsx("input",{type:"text",value:s.name,onChange:j=>_("name",j.target.value),onBlur:k,placeholder:"e.g., Document Generator",style:fg}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),a.jsxs("div",{children:[a.jsx("label",{style:pg,children:"Template Purpose"}),a.jsx("select",{value:s.purpose,onChange:j=>{_("purpose",j.target.value),setTimeout(()=>S(),0)},style:fg,children:g7.map(j=>a.jsx("option",{value:j.value,children:j.label},j.value))}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),a.jsxs("div",{children:[a.jsx("label",{style:pg,children:"Use Case"}),a.jsx("textarea",{value:s.use_case,onChange:j=>_("use_case",j.target.value),onBlur:k,placeholder:"Describe when and how this template should be used...",rows:4,style:{...fg,resize:"vertical"}}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),u&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(Jr,{content:p,onChange:x,loading:y,saving:w,isDirty:v,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ro={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function x7({workspaceId:e,schema:t,onArtifactSave:r}){var v;const[n,i]=m.useState("content"),s=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:o,loading:l,error:c,saving:u,isDirty:d,updateContent:f,lastSaveResult:h}=_a(e,s,{onSave:x=>{r==null||r(s,x)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),a.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const p=t.title||((v=t.schema_id)==null?void 0:v.replace(/_/g," "))||"Schema",y=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],w=!e;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[p,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",y]}),w&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(x=>a.jsxs("button",{onClick:()=>i(x.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===x.id?"var(--text-primary)":"var(--text-muted)",background:n===x.id?"var(--bg-canvas)":"transparent",borderBottom:n===x.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[x.label,x.id==="content"&&d&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},x.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(Jr,{content:o,onChange:f,loading:l,saving:u,isDirty:d,error:c,placeholder:"Enter JSON schema...",readOnly:w,isJson:!0})}),n==="info"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Schema ID"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Version"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:y})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Title (from JSON)"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),a.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"File Path"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",y,"/schema.json"]})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Artifact ID"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",y]})]})]})}),(h==null?void 0:h.tier1)&&!h.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const y7={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},b7={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},hg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},no={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function w7({workspaceId:e,fragment:t,onArtifactSave:r}){var F;const[n,i]=m.useState("content"),[s,o]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[u,d]=m.useState(!1),[f,h]=m.useState(""),[p,y]=((F=t==null?void 0:t.fragment_id)==null?void 0:F.split(":"))||[null,null],g=t?p==="role"?`fragment:role:${y}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${p}_prompt`:null,w=t&&p==="role"?`fragment:role:${y}:${t.version}:meta`:null,{content:v,loading:x,error:b,saving:_,isDirty:S,updateContent:k,lastSaveResult:N}=_a(e,g,{onSave:M=>{r==null||r(g,M)}});m.useEffect(()=>{t&&(o({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const E=m.useCallback((M,q)=>{o(W=>({...W,[M]:q})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!w)){d(!0);try{const M=T4.dump({name:s.name||null,intent:s.intent||null,tags:s.tags.length>0?s.tags:null},{lineWidth:-1});await Se.writeArtifact(e,w,M),c(!1),r==null||r(w,{success:!0})}catch(M){console.error("Failed to save metadata:",M),alert(`Failed to save metadata: ${M.message}`)}finally{d(!1)}}},[e,w,s,r]),R=m.useCallback(()=>{l&&w&&j()},[l,w,j]),T=m.useCallback(()=>{const M=f.trim().toLowerCase();M&&!s.tags.includes(M)&&(E("tags",[...s.tags,M]),h(""))},[f,s.tags,E]),P=m.useCallback(M=>{E("tags",s.tags.filter(q=>q!==M))},[s.tags,E]),z=m.useCallback(M=>{M.key==="Enter"&&(M.preventDefault(),T())},[T]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),a.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const C=s.name||t.name||t.fragment_id,L=y7[p]||p,O=b7[p]||"var(--text-muted)",$=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],D=!e,A=w&&!D;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[C,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:O,color:"#fff"},children:L})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsxs("span",{children:["from ",t.source_doc_type]})]}),D&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:$.map(M=>a.jsxs("button",{onClick:()=>i(M.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===M.id?"var(--text-primary)":"var(--text-muted)",background:n===M.id?"var(--bg-canvas)":"transparent",borderBottom:n===M.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[M.label,M.id==="content"&&S&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),M.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},M.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(Jr,{content:v,onChange:k,loading:x,saving:_,isDirty:S,error:b,placeholder:"Enter prompt content...",readOnly:D})}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:no,children:"Kind"}),a.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:O}}),a.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:L})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),a.jsxs("div",{children:[a.jsx("label",{style:no,children:"Name"}),a.jsx("input",{type:"text",value:s.name,onChange:M=>E("name",M.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:hg,disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),a.jsxs("div",{children:[a.jsx("label",{style:no,children:"Intent"}),a.jsx("textarea",{value:s.intent,onChange:M=>E("intent",M.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...hg,resize:"vertical"},disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),a.jsxs("div",{children:[a.jsx("label",{style:no,children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:s.tags.map(M=>a.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[M,A&&a.jsx("button",{onClick:()=>P(M),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},M))}),A&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:f,onChange:M=>h(M.target.value),onKeyDown:z,placeholder:"Add tag...",style:{...hg,flex:1}}),a.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&a.jsxs("div",{children:[a.jsx("label",{style:no,children:"Source"}),a.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",a.jsx("strong",{children:t.source_doc_type})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),u&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!A&&!t.source_doc_type&&a.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(N==null?void 0:N.tier1)&&!N.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function _7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(i=>i(n))},t)}const pu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ls(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function ky(e){return"nodeType"in e}function Ut(e){var t,r;return e?Ls(e)?e:ky(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Ny(e){const{Document:t}=Ut(e);return e instanceof t}function Sa(e){return Ls(e)?!1:e instanceof Ut(e).HTMLElement}function R4(e){return e instanceof Ut(e).SVGElement}function Fs(e){return e?Ls(e)?e.document:ky(e)?Ny(e)?e:Sa(e)||R4(e)?e.ownerDocument:document:document:document}const Ur=pu?m.useLayoutEffect:m.useEffect;function Cy(e){const t=m.useRef(e);return Ur(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function S7(){const e=m.useRef(null),t=m.useCallback((n,i)=>{e.current=setInterval(n,i)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function oa(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Ur(()=>{r.current!==e&&(r.current=e)},t),r}function ja(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function gc(e){const t=Cy(e),r=m.useRef(null),n=m.useCallback(i=>{i!==r.current&&(t==null||t(i,r.current)),r.current=i},[]);return[r,n]}function Dv(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let mg={};function ka(e,t){return m.useMemo(()=>{if(t)return t;const r=mg[e]==null?0:mg[e]+1;return mg[e]=r,e+"-"+r},[e,t])}function A4(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((s,o)=>{const l=Object.entries(o);for(const[c,u]of l){const d=s[c];d!=null&&(s[c]=d+e*u)}return s},{...t})}}const hs=A4(1),aa=A4(-1);function j7(e){return"clientX"in e&&"clientY"in e}function Ey(e){if(!e)return!1;const{KeyboardEvent:t}=Ut(e.target);return t&&e instanceof t}function k7(e){if(!e)return!1;const{TouchEvent:t}=Ut(e.target);return t&&e instanceof t}function Lv(e){if(k7(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return j7(e)?{x:e.clientX,y:e.clientY}:null}const Cs=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Cs.Translate.toString(e),Cs.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),mj="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function N7(e){return e.matches(mj)?e:e.querySelector(mj)}const C7={display:"none"};function E7(e){let{id:t,value:r}=e;return G.createElement("div",{id:t,style:C7},r)}function T7(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return G.createElement("div",{id:t,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function R7(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const I4=m.createContext(null);function A7(e){const t=m.useContext(I4);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function I7(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:i,event:s}=n;e.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[e]),t]}const M7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},P7={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function O7(e){let{announcements:t=P7,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=M7}=e;const{announce:s,announcement:o}=R7(),l=ka("DndLiveRegion"),[c,u]=m.useState(!1);if(m.useEffect(()=>{u(!0)},[]),A7(m.useMemo(()=>({onDragStart(f){let{active:h}=f;s(t.onDragStart({active:h}))},onDragMove(f){let{active:h,over:p}=f;t.onDragMove&&s(t.onDragMove({active:h,over:p}))},onDragOver(f){let{active:h,over:p}=f;s(t.onDragOver({active:h,over:p}))},onDragEnd(f){let{active:h,over:p}=f;s(t.onDragEnd({active:h,over:p}))},onDragCancel(f){let{active:h,over:p}=f;s(t.onDragCancel({active:h,over:p}))}}),[s,t])),!c)return null;const d=G.createElement(G.Fragment,null,G.createElement(E7,{id:n,value:i.draggable}),G.createElement(T7,{id:l,announcement:o}));return r?ts.createPortal(d,r):d}var at;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(at||(at={}));function vc(){}function xc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function M4(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Cr=Object.freeze({x:0,y:0});function P4(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function O4(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function D7(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function gj(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function D4(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function vj(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const L4=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=vj(t,t.left,t.top),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=P4(vj(c),i);s.push({id:l,data:{droppableContainer:o,value:u}})}}return s.sort(O4)},L7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=gj(t),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=gj(c),d=i.reduce((h,p,y)=>h+P4(u[y],p),0),f=Number((d/4).toFixed(4));s.push({id:l,data:{droppableContainer:o,value:f}})}}return s.sort(O4)};function F7(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),o=i-n,l=s-r;if(n<i&&r<s){const c=t.width*t.height,u=e.width*e.height,d=o*l,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const z7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=[];for(const s of n){const{id:o}=s,l=r.get(o);if(l){const c=F7(l,t);c>0&&i.push({id:o,data:{droppableContainer:s,value:c}})}}return i.sort(D7)};function q7(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function F4(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Cr}function $7(e){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...r})}}const B7=$7(1);function H7(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function W7(e,t,r){const n=H7(t);if(!n)return e;const{scaleX:i,scaleY:s,x:o,y:l}=n,c=e.left-o-(1-i)*parseFloat(r),u=e.top-l-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?e.width/i:e.width,f=s?e.height/s:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const U7={ignoreTransform:!1};function zs(e,t){t===void 0&&(t=U7);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Ut(e).getComputedStyle(e);u&&(r=W7(r,u,d))}const{top:n,left:i,width:s,height:o,bottom:l,right:c}=r;return{top:n,left:i,width:s,height:o,bottom:l,right:c}}function xj(e){return zs(e,{ignoreTransform:!0})}function V7(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function G7(e,t){return t===void 0&&(t=Ut(e).getComputedStyle(e)),t.position==="fixed"}function K7(e,t){t===void 0&&(t=Ut(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?r.test(s):!1})}function hu(e,t){const r=[];function n(i){if(t!=null&&r.length>=t||!i)return r;if(Ny(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Sa(i)||R4(i)||r.includes(i))return r;const s=Ut(e).getComputedStyle(i);return i!==e&&K7(i,s)&&r.push(i),G7(i,s)?r:n(i.parentNode)}return e?n(e):r}function z4(e){const[t]=hu(e,1);return t??null}function gg(e){return!pu||!e?null:Ls(e)?e:ky(e)?Ny(e)||e===Fs(e).scrollingElement?window:Sa(e)?e:null:null}function q4(e){return Ls(e)?e.scrollX:e.scrollLeft}function $4(e){return Ls(e)?e.scrollY:e.scrollTop}function Fv(e){return{x:q4(e),y:$4(e)}}var ft;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ft||(ft={}));function B4(e){return!pu||!e?!1:e===document.scrollingElement}function H4(e){const t={x:0,y:0},r=B4(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,o=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:n,minScroll:t}}const Y7={x:.2,y:.2};function X7(e,t,r,n,i){let{top:s,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=Y7);const{isTop:u,isBottom:d,isLeft:f,isRight:h}=H4(e),p={x:0,y:0},y={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!u&&s<=t.top+g.height?(p.y=ft.Backward,y.y=n*Math.abs((t.top+g.height-s)/g.height)):!d&&c>=t.bottom-g.height&&(p.y=ft.Forward,y.y=n*Math.abs((t.bottom-g.height-c)/g.height)),!h&&l>=t.right-g.width?(p.x=ft.Forward,y.x=n*Math.abs((t.right-g.width-l)/g.width)):!f&&o<=t.left+g.width&&(p.x=ft.Backward,y.x=n*Math.abs((t.left+g.width-o)/g.width)),{direction:p,speed:y}}function Q7(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function W4(e){return e.reduce((t,r)=>hs(t,Fv(r)),Cr)}function Z7(e){return e.reduce((t,r)=>t+q4(r),0)}function J7(e){return e.reduce((t,r)=>t+$4(r),0)}function eW(e,t){if(t===void 0&&(t=zs),!e)return;const{top:r,left:n,bottom:i,right:s}=t(e);z4(e)&&(i<=0||s<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const tW=[["x",["left","right"],Z7],["y",["top","bottom"],J7]];class Ty{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=hu(r),i=W4(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,o,l]of tW)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(n),d=i[s]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Eo{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var i;(i=this.target)==null||i.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function rW(e){const{EventTarget:t}=Ut(e);return e instanceof t?e:Fs(e)}function vg(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ir;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ir||(ir={}));function yj(e){e.preventDefault()}function nW(e){e.stopPropagation()}var Ne;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ne||(Ne={}));const U4={start:[Ne.Space,Ne.Enter],cancel:[Ne.Esc],end:[Ne.Space,Ne.Enter,Ne.Tab]},iW=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Ne.Right:return{...r,x:r.x+25};case Ne.Left:return{...r,x:r.x-25};case Ne.Down:return{...r,y:r.y+25};case Ne.Up:return{...r,y:r.y-25}}};class mu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Eo(Fs(r)),this.windowListeners=new Eo(Ut(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ir.Resize,this.handleCancel),this.windowListeners.add(ir.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ir.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&eW(n),r(Cr)}handleKeyDown(t){if(Ey(t)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:s=U4,coordinateGetter:o=iW,scrollBehavior:l="smooth"}=i,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:Cr;this.referenceCoordinates||(this.referenceCoordinates=d);const f=o(t,{active:r,context:n.current,currentCoordinates:d});if(f){const h=aa(f,d),p={x:0,y:0},{scrollableAncestors:y}=n.current;for(const g of y){const w=t.code,{isTop:v,isRight:x,isLeft:b,isBottom:_,maxScroll:S,minScroll:k}=H4(g),N=Q7(g),E={x:Math.min(w===Ne.Right?N.right-N.width/2:N.right,Math.max(w===Ne.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(w===Ne.Down?N.bottom-N.height/2:N.bottom,Math.max(w===Ne.Down?N.top:N.top+N.height/2,f.y))},j=w===Ne.Right&&!x||w===Ne.Left&&!b,R=w===Ne.Down&&!_||w===Ne.Up&&!v;if(j&&E.x!==f.x){const T=g.scrollLeft+h.x,P=w===Ne.Right&&T<=S.x||w===Ne.Left&&T>=k.x;if(P&&!h.y){g.scrollTo({left:T,behavior:l});return}P?p.x=g.scrollLeft-T:p.x=w===Ne.Right?g.scrollLeft-S.x:g.scrollLeft-k.x,p.x&&g.scrollBy({left:-p.x,behavior:l});break}else if(R&&E.y!==f.y){const T=g.scrollTop+h.y,P=w===Ne.Down&&T<=S.y||w===Ne.Up&&T>=k.y;if(P&&!h.x){g.scrollTo({top:T,behavior:l});return}P?p.y=g.scrollTop-T:p.y=w===Ne.Down?g.scrollTop-S.y:g.scrollTop-k.y,p.y&&g.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,hs(aa(f,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}mu.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=U4,onActivation:i}=t,{active:s}=r;const{code:o}=e.nativeEvent;if(n.start.includes(o)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function bj(e){return!!(e&&"distance"in e)}function wj(e){return!!(e&&"delay"in e)}class Ry{constructor(t,r,n){var i;n===void 0&&(n=rW(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:s}=t,{target:o}=s;this.props=t,this.events=r,this.document=Fs(o),this.documentListeners=new Eo(this.document),this.listeners=new Eo(n),this.windowListeners=new Eo(Ut(o)),this.initialCoordinates=(i=Lv(s))!=null?i:Cr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ir.Resize,this.handleCancel),this.windowListeners.add(ir.DragStart,yj),this.windowListeners.add(ir.VisibilityChange,this.handleCancel),this.windowListeners.add(ir.ContextMenu,yj),this.documentListeners.add(ir.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(wj(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(bj(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:i}=this.props;i(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ir.Click,nW,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ir.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const c=(r=Lv(t))!=null?r:Cr,u=aa(i,c);if(!n&&l){if(bj(l)){if(l.tolerance!=null&&vg(u,l.tolerance))return this.handleCancel();if(vg(u,l.distance))return this.handleStart()}if(wj(l)&&vg(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Ne.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const sW={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class gu extends Ry{constructor(t){const{event:r}=t,n=Fs(r.target);super(t,sW,n)}}gu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const oW={move:{name:"mousemove"},end:{name:"mouseup"}};var zv;(function(e){e[e.RightClick=2]="RightClick"})(zv||(zv={}));class aW extends Ry{constructor(t){super(t,oW,Fs(t.event.target))}}aW.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===zv.RightClick?!1:(n==null||n({event:r}),!0)}}];const xg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class lW extends Ry{constructor(t){super(t,xg)}static setup(){return window.addEventListener(xg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(xg.move.name,t)};function t(){}}}lW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];var To;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(To||(To={}));var yc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(yc||(yc={}));function cW(e){let{acceleration:t,activator:r=To.Pointer,canScroll:n,draggingRect:i,enabled:s,interval:o=5,order:l=yc.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:h}=e;const p=dW({delta:f,disabled:!s}),[y,g]=S7(),w=m.useRef({x:0,y:0}),v=m.useRef({x:0,y:0}),x=m.useMemo(()=>{switch(r){case To.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case To.DraggableRect:return i}},[r,i,c]),b=m.useRef(null),_=m.useCallback(()=>{const k=b.current;if(!k)return;const N=w.current.x*v.current.x,E=w.current.y*v.current.y;k.scrollBy(N,E)},[]),S=m.useMemo(()=>l===yc.TreeOrder?[...u].reverse():u,[l,u]);m.useEffect(()=>{if(!s||!u.length||!x){g();return}for(const k of S){if((n==null?void 0:n(k))===!1)continue;const N=u.indexOf(k),E=d[N];if(!E)continue;const{direction:j,speed:R}=X7(k,E,x,t,h);for(const T of["x","y"])p[T][j[T]]||(R[T]=0,j[T]=0);if(R.x>0||R.y>0){g(),b.current=k,y(_,o),w.current=R,v.current=j;return}}w.current={x:0,y:0},v.current={x:0,y:0},g()},[t,_,n,g,s,o,JSON.stringify(x),JSON.stringify(p),y,u,S,d,JSON.stringify(h)])}const uW={x:{[ft.Backward]:!1,[ft.Forward]:!1},y:{[ft.Backward]:!1,[ft.Forward]:!1}};function dW(e){let{delta:t,disabled:r}=e;const n=Dv(t);return ja(i=>{if(r||!n||!i)return uW;const s={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[ft.Backward]:i.x[ft.Backward]||s.x===-1,[ft.Forward]:i.x[ft.Forward]||s.x===1},y:{[ft.Backward]:i.y[ft.Backward]||s.y===-1,[ft.Forward]:i.y[ft.Forward]||s.y===1}}},[r,t,n])}function fW(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return ja(i=>{var s;return t==null?null:(s=n??i)!=null?s:null},[n,t])}function pW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:i}=n,s=i.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,n)}));return[...r,...s]},[]),[e,t])}var la;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(la||(la={}));var qv;(function(e){e.Optimized="optimized"})(qv||(qv={}));const _j=new Map;function hW(e,t){let{dragging:r,dependencies:n,config:i}=t;const[s,o]=m.useState(null),{frequency:l,measure:c,strategy:u}=i,d=m.useRef(e),f=w(),h=oa(f),p=m.useCallback(function(v){v===void 0&&(v=[]),!h.current&&o(x=>x===null?v:x.concat(v.filter(b=>!x.includes(b))))},[h]),y=m.useRef(null),g=ja(v=>{if(f&&!r)return _j;if(!v||v===_j||d.current!==e||s!=null){const x=new Map;for(let b of e){if(!b)continue;if(s&&s.length>0&&!s.includes(b.id)&&b.rect.current){x.set(b.id,b.rect.current);continue}const _=b.node.current,S=_?new Ty(c(_),_):null;b.rect.current=S,S&&x.set(b.id,S)}return x}return v},[e,s,r,f,c]);return m.useEffect(()=>{d.current=e},[e]),m.useEffect(()=>{f||p()},[r,f]),m.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),m.useEffect(()=>{f||typeof l!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},l))},[l,f,p,...n]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:s!=null};function w(){switch(u){case la.Always:return!1;case la.BeforeDragging:return r;default:return!r}}}function V4(e,t){return ja(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function mW(e,t){return V4(e,t)}function gW(e){let{callback:t,disabled:r}=e;const n=Cy(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(n)},[n,r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function vu(e){let{callback:t,disabled:r}=e;const n=Cy(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(n)},[r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function vW(e){return new Ty(zs(e),e)}function Sj(e,t,r){t===void 0&&(t=vW);const[n,i]=m.useState(null);function s(){i(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=gW({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=vu({callback:s});return Ur(()=>{s(),e?(l==null||l.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[e]),n}function xW(e){const t=V4(e);return F4(e,t)}const jj=[];function yW(e){const t=m.useRef(e),r=ja(n=>e?n&&n!==jj&&e&&t.current&&e.parentNode===t.current.parentNode?n:hu(e):jj,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function bW(e){const[t,r]=m.useState(null),n=m.useRef(e),i=m.useCallback(s=>{const o=gg(s.target);o&&r(l=>l?(l.set(o,Fv(o)),new Map(l)):null)},[]);return m.useEffect(()=>{const s=n.current;if(e!==s){o(s);const l=e.map(c=>{const u=gg(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,Fv(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{o(e),o(s)};function o(l){l.forEach(c=>{const u=gg(c);u==null||u.removeEventListener("scroll",i)})}},[i,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,o)=>hs(s,o),Cr):W4(e):Cr,[e,t])}function kj(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Cr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?aa(e,r.current):Cr}function wW(e){m.useEffect(()=>{if(!pu)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function _W(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:i,handler:s}=n;return r[i]=o=>{s(o,t)},r},{}),[e,t])}function G4(e){return m.useMemo(()=>e?V7(e):null,[e])}const Nj=[];function SW(e,t){t===void 0&&(t=zs);const[r]=e,n=G4(r?Ut(r):null),[i,s]=m.useState(Nj);function o(){s(()=>e.length?e.map(c=>B4(c)?n:new Ty(t(c),c)):Nj)}const l=vu({callback:o});return Ur(()=>{l==null||l.disconnect(),o(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),i}function jW(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Sa(t)?t:e}function kW(e){let{measure:t}=e;const[r,n]=m.useState(null),i=m.useCallback(u=>{for(const{target:d}of u)if(Sa(d)){n(f=>{const h=t(d);return f?{...f,width:h.width,height:h.height}:h});break}},[t]),s=vu({callback:i}),o=m.useCallback(u=>{const d=jW(u);s==null||s.disconnect(),d&&(s==null||s.observe(d)),n(d?t(d):null)},[t,s]),[l,c]=gc(o);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const NW=[{sensor:gu,options:{}},{sensor:mu,options:{}}],CW={current:{}},kl={draggable:{measure:xj},droppable:{measure:xj,strategy:la.WhileDragging,frequency:qv.Optimized},dragOverlay:{measure:zs}};class Ro extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const EW={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ro,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:vc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:kl,measureDroppableContainers:vc,windowRect:null,measuringScheduled:!1},TW={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:vc,draggableNodes:new Map,over:null,measureDroppableContainers:vc},xu=m.createContext(TW),K4=m.createContext(EW);function RW(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ro}}}function AW(e,t){switch(t.type){case at.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case at.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case at.DragEnd:case at.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case at.RegisterDroppable:{const{element:r}=t,{id:n}=r,i=new Ro(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case at.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new Ro(e.droppable.containers);return o.set(r,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case at.UnregisterDroppable:{const{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const s=new Ro(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function IW(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:i}=m.useContext(xu),s=Dv(n),o=Dv(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&s&&o!=null){if(!Ey(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=N7(d);if(f){f.focus();break}}})}},[n,t,i,o,s]),null}function MW(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...n}),r):r}function PW(e){return m.useMemo(()=>({draggable:{...kl.draggable,...e==null?void 0:e.draggable},droppable:{...kl.droppable,...e==null?void 0:e.droppable},dragOverlay:{...kl.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function OW(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e;const s=m.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Ur(()=>{if(!o&&!l||!t){s.current=!1;return}if(s.current||!n)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=F4(d,n);if(o||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const h=z4(u);h&&h.scrollBy({top:f.y,left:f.x})}},[t,o,l,n,r])}const Y4=m.createContext({...Cr,scaleX:1,scaleY:1});var Cn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Cn||(Cn={}));const X4=m.memo(function(t){var r,n,i,s;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:d=NW,collisionDetection:f=z7,measuring:h,modifiers:p,...y}=t;const g=m.useReducer(AW,void 0,RW),[w,v]=g,[x,b]=I7(),[_,S]=m.useState(Cn.Uninitialized),k=_===Cn.Initialized,{draggable:{active:N,nodes:E,translate:j},droppable:{containers:R}}=w,T=N!=null?E.get(N):null,P=m.useRef({initial:null,translated:null}),z=m.useMemo(()=>{var Ve;return N!=null?{id:N,data:(Ve=T==null?void 0:T.data)!=null?Ve:CW,rect:P}:null},[N,T]),C=m.useRef(null),[L,O]=m.useState(null),[$,D]=m.useState(null),A=oa(y,Object.values(y)),F=ka("DndDescribedBy",o),M=m.useMemo(()=>R.getEnabled(),[R]),q=PW(h),{droppableRects:W,measureDroppableContainers:B,measuringScheduled:K}=hW(M,{dragging:k,dependencies:[j.x,j.y],config:q.droppable}),Z=fW(E,N),re=m.useMemo(()=>$?Lv($):null,[$]),ne=it(),V=mW(Z,q.draggable.measure);OW({activeNode:N!=null?E.get(N):null,config:ne.layoutShiftCompensation,initialRect:V,measure:q.draggable.measure});const ee=Sj(Z,q.draggable.measure,V),ve=Sj(Z?Z.parentElement:null),fe=m.useRef({activatorEvent:null,active:null,activeNode:Z,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),be=R.getNodeFor((r=fe.current.over)==null?void 0:r.id),ce=kW({measure:q.dragOverlay.measure}),te=(n=ce.nodeRef.current)!=null?n:Z,we=k?(i=ce.rect)!=null?i:ee:null,Y=!!(ce.nodeRef.current&&ce.rect),X=xW(Y?null:ee),ue=G4(te?Ut(te):null),he=yW(k?be??Z:null),_e=SW(he),ge=MW(p,{transform:{x:j.x-X.x,y:j.y-X.y,scaleX:1,scaleY:1},activatorEvent:$,active:z,activeNodeRect:ee,containerNodeRect:ve,draggingNodeRect:we,over:fe.current.over,overlayNodeRect:ce.rect,scrollableAncestors:he,scrollableAncestorRects:_e,windowRect:ue}),Q=re?hs(re,j):null,pe=bW(he),We=kj(pe),Re=kj(pe,[ee]),Le=hs(ge,We),Pe=we?B7(we,ge):null,Ue=z&&Pe?f({active:z,collisionRect:Pe,droppableRects:W,droppableContainers:M,pointerCoordinates:Q}):null,I=D4(Ue,"id"),[H,U]=m.useState(null),se=Y?ge:hs(ge,Re),Oe=q7(se,(s=H==null?void 0:H.rect)!=null?s:null,ee),kt=m.useRef(null),Mt=m.useCallback((Ve,Je)=>{let{sensor:Nt,options:Ir}=Je;if(C.current==null)return;const Ot=E.get(C.current);if(!Ot)return;const Ct=Ve.nativeEvent,tr=new Nt({active:C.current,activeNode:Ot,event:Ct,options:Ir,context:fe,onAbort(st){if(!E.get(st))return;const{onDragAbort:rr}=A.current,mr={id:st};rr==null||rr(mr),x({type:"onDragAbort",event:mr})},onPending(st,Mr,rr,mr){if(!E.get(st))return;const{onDragPending:ri}=A.current,Pr={id:st,constraint:Mr,initialCoordinates:rr,offset:mr};ri==null||ri(Pr),x({type:"onDragPending",event:Pr})},onStart(st){const Mr=C.current;if(Mr==null)return;const rr=E.get(Mr);if(!rr)return;const{onDragStart:mr}=A.current,ti={activatorEvent:Ct,active:{id:Mr,data:rr.data,rect:P}};ts.unstable_batchedUpdates(()=>{mr==null||mr(ti),S(Cn.Initializing),v({type:at.DragStart,initialCoordinates:st,active:Mr}),x({type:"onDragStart",event:ti}),O(kt.current),D(Ct)})},onMove(st){v({type:at.DragMove,coordinates:st})},onEnd:yn(at.DragEnd),onCancel:yn(at.DragCancel)});kt.current=tr;function yn(st){return async function(){const{active:rr,collisions:mr,over:ti,scrollAdjustedTranslate:ri}=fe.current;let Pr=null;if(rr&&ri){const{cancelDrop:ni}=A.current;Pr={activatorEvent:Ct,active:rr,collisions:mr,delta:ri,over:ti},st===at.DragEnd&&typeof ni=="function"&&await Promise.resolve(ni(Pr))&&(st=at.DragCancel)}C.current=null,ts.unstable_batchedUpdates(()=>{v({type:st}),S(Cn.Uninitialized),U(null),O(null),D(null),kt.current=null;const ni=st===at.DragEnd?"onDragEnd":"onDragCancel";if(Pr){const qs=A.current[ni];qs==null||qs(Pr),x({type:ni,event:Pr})}})}}},[E]),Pt=m.useCallback((Ve,Je)=>(Nt,Ir)=>{const Ot=Nt.nativeEvent,Ct=E.get(Ir);if(C.current!==null||!Ct||Ot.dndKit||Ot.defaultPrevented)return;const tr={active:Ct};Ve(Nt,Je.options,tr)===!0&&(Ot.dndKit={capturedBy:Je.sensor},C.current=Ir,Mt(Nt,Je))},[E,Mt]),Ar=pW(d,Pt);wW(d),Ur(()=>{ee&&_===Cn.Initializing&&S(Cn.Initialized)},[ee,_]),m.useEffect(()=>{const{onDragMove:Ve}=A.current,{active:Je,activatorEvent:Nt,collisions:Ir,over:Ot}=fe.current;if(!Je||!Nt)return;const Ct={active:Je,activatorEvent:Nt,collisions:Ir,delta:{x:Le.x,y:Le.y},over:Ot};ts.unstable_batchedUpdates(()=>{Ve==null||Ve(Ct),x({type:"onDragMove",event:Ct})})},[Le.x,Le.y]),m.useEffect(()=>{const{active:Ve,activatorEvent:Je,collisions:Nt,droppableContainers:Ir,scrollAdjustedTranslate:Ot}=fe.current;if(!Ve||C.current==null||!Je||!Ot)return;const{onDragOver:Ct}=A.current,tr=Ir.get(I),yn=tr&&tr.rect.current?{id:tr.id,rect:tr.rect.current,data:tr.data,disabled:tr.disabled}:null,st={active:Ve,activatorEvent:Je,collisions:Nt,delta:{x:Ot.x,y:Ot.y},over:yn};ts.unstable_batchedUpdates(()=>{U(yn),Ct==null||Ct(st),x({type:"onDragOver",event:st})})},[I]),Ur(()=>{fe.current={activatorEvent:$,active:z,activeNode:Z,collisionRect:Pe,collisions:Ue,droppableRects:W,draggableNodes:E,draggingNode:te,draggingNodeRect:we,droppableContainers:R,over:H,scrollableAncestors:he,scrollAdjustedTranslate:Le},P.current={initial:we,translated:Pe}},[z,Z,Ue,Pe,E,te,we,W,R,H,he,Le]),cW({...ne,delta:j,draggingRect:Pe,pointerCoordinates:Q,scrollableAncestors:he,scrollableAncestorRects:_e});const de=m.useMemo(()=>({active:z,activeNode:Z,activeNodeRect:ee,activatorEvent:$,collisions:Ue,containerNodeRect:ve,dragOverlay:ce,draggableNodes:E,droppableContainers:R,droppableRects:W,over:H,measureDroppableContainers:B,scrollableAncestors:he,scrollableAncestorRects:_e,measuringConfiguration:q,measuringScheduled:K,windowRect:ue}),[z,Z,ee,$,Ue,ve,ce,E,R,W,H,B,he,_e,q,K,ue]),ae=m.useMemo(()=>({activatorEvent:$,activators:Ar,active:z,activeNodeRect:ee,ariaDescribedById:{draggable:F},dispatch:v,draggableNodes:E,over:H,measureDroppableContainers:B}),[$,Ar,z,ee,v,F,E,H,B]);return G.createElement(I4.Provider,{value:b},G.createElement(xu.Provider,{value:ae},G.createElement(K4.Provider,{value:de},G.createElement(Y4.Provider,{value:Oe},u)),G.createElement(IW,{disabled:(l==null?void 0:l.restoreFocus)===!1})),G.createElement(O7,{...l,hiddenTextDescribedById:F}));function it(){const Ve=(L==null?void 0:L.autoScrollEnabled)===!1,Je=typeof c=="object"?c.enabled===!1:c===!1,Nt=k&&!Ve&&!Je;return typeof c=="object"?{...c,enabled:Nt}:{enabled:Nt}}}),DW=m.createContext(null),Cj="button",LW="Draggable";function FW(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e;const s=ka(LW),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:h}=m.useContext(xu),{role:p=Cj,roleDescription:y="draggable",tabIndex:g=0}=i??{},w=(c==null?void 0:c.id)===t,v=m.useContext(w?Y4:DW),[x,b]=gc(),[_,S]=gc(),k=_W(o,t),N=oa(r);Ur(()=>(f.set(t,{id:t,key:s,node:x,activatorNode:_,data:N}),()=>{const j=f.get(t);j&&j.key===s&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:p,tabIndex:g,"aria-disabled":n,"aria-pressed":w&&p===Cj?!0:void 0,"aria-roledescription":y,"aria-describedby":d.draggable}),[n,p,g,w,y,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:E,isDragging:w,listeners:n?void 0:k,node:x,over:h,setNodeRef:b,setActivatorNodeRef:S,transform:v}}function zW(){return m.useContext(K4)}const qW="Droppable",$W={timeout:25};function BW(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e;const s=ka(qW),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=m.useContext(xu),d=m.useRef({disabled:r}),f=m.useRef(!1),h=m.useRef(null),p=m.useRef(null),{disabled:y,updateMeasurementsFor:g,timeout:w}={...$W,...i},v=oa(g??n),x=m.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(v.current)?v.current:[v.current]),p.current=null},w)},[w]),b=vu({callback:x,disabled:y||!o}),_=m.useCallback((E,j)=>{b&&(j&&(b.unobserve(j),f.current=!1),E&&b.observe(E))},[b]),[S,k]=gc(_),N=oa(t);return m.useEffect(()=>{!b||!S.current||(b.disconnect(),f.current=!1,b.observe(S.current))},[S,b]),m.useEffect(()=>(l({type:at.RegisterDroppable,element:{id:n,key:s,disabled:r,node:S,rect:h,data:N}}),()=>l({type:at.UnregisterDroppable,key:s,id:n})),[n]),m.useEffect(()=>{r!==d.current.disabled&&(l({type:at.SetDroppableDisabled,id:n,key:s,disabled:r}),d.current.disabled=r)},[n,s,r,l]),{active:o,rect:h,isOver:(c==null?void 0:c.id)===n,node:S,over:c,setNodeRef:k}}function yu(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function HW(e,t){return e.reduce((r,n,i)=>{const s=t.get(n);return s&&(r[i]=s),r},Array(e.length))}function al(e){return e!==null&&e>=0}function WW(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function UW(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Q4=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e;const s=yu(t,n,r),o=t[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},ll={scaleX:1,scaleY:1},Z4=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:s,overIndex:o}=e;const l=(t=s[r])!=null?t:n;if(!l)return null;if(i===r){const u=s[o];return u?{x:0,y:r<o?u.top+u.height-(l.top+l.height):u.top-l.top,...ll}:null}const c=VW(s,i,r);return i>r&&i<=o?{x:0,y:-l.height-c,...ll}:i<r&&i>=o?{x:0,y:l.height+c,...ll}:{x:0,y:0,...ll}};function VW(e,t,r){const n=e[t],i=e[t-1],s=e[t+1];return n?r<t?i?n.top-(i.top+i.height):s?s.top-(n.top+n.height):0:s?s.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const J4="Sortable",eR=G.createContext({activeIndex:-1,containerId:J4,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Q4,disabled:{draggable:!1,droppable:!1}});function tR(e){let{children:t,id:r,items:n,strategy:i=Q4,disabled:s=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=zW(),f=ka(J4,r),h=l.rect!==null,p=m.useMemo(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),y=o!=null,g=o?p.indexOf(o.id):-1,w=u?p.indexOf(u.id):-1,v=m.useRef(p),x=!WW(p,v.current),b=w!==-1&&g===-1||x,_=UW(s);Ur(()=>{x&&y&&d(p)},[x,p,y,d]),m.useEffect(()=>{v.current=p},[p]);const S=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:_,disableTransforms:b,items:p,overIndex:w,useDragOverlay:h,sortedRects:HW(p,c),strategy:i}),[g,f,_.draggable,_.droppable,b,p,w,c,h,i]);return G.createElement(eR.Provider,{value:S},t)}const GW=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return yu(r,n,i).indexOf(t)},KW=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!n||l!==s&&i===o?!1:r?!0:o!==i&&t===c},YW={duration:200,easing:"ease"},rR="transform",XW=Cs.Transition.toString({property:rR,duration:0,easing:"linear"}),QW={roleDescription:"sortable"};function ZW(e){let{disabled:t,index:r,node:n,rect:i}=e;const[s,o]=m.useState(null),l=m.useRef(r);return Ur(()=>{if(!t&&r!==l.current&&n.current){const c=i.current;if(c){const u=zs(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&o(d)}}r!==l.current&&(l.current=r)},[t,r,n,i]),m.useEffect(()=>{s&&o(null)},[s]),s}function nR(e){let{animateLayoutChanges:t=KW,attributes:r,disabled:n,data:i,getNewIndex:s=GW,id:o,strategy:l,resizeObserverConfig:c,transition:u=YW}=e;const{items:d,containerId:f,activeIndex:h,disabled:p,disableTransforms:y,sortedRects:g,overIndex:w,useDragOverlay:v,strategy:x}=m.useContext(eR),b=JW(n,p),_=d.indexOf(o),S=m.useMemo(()=>({sortable:{containerId:f,index:_,items:d},...i}),[f,i,_,d]),k=m.useMemo(()=>d.slice(d.indexOf(o)),[d,o]),{rect:N,node:E,isOver:j,setNodeRef:R}=BW({id:o,data:S,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:T,activatorEvent:P,activeNodeRect:z,attributes:C,setNodeRef:L,listeners:O,isDragging:$,over:D,setActivatorNodeRef:A,transform:F}=FW({id:o,data:S,attributes:{...QW,...r},disabled:b.draggable}),M=_7(R,L),q=!!T,W=q&&!y&&al(h)&&al(w),B=!v&&$,K=B&&W?F:null,re=W?K??(l??x)({rects:g,activeNodeRect:z,activeIndex:h,overIndex:w,index:_}):null,ne=al(h)&&al(w)?s({id:o,items:d,activeIndex:h,overIndex:w}):_,V=T==null?void 0:T.id,ee=m.useRef({activeId:V,items:d,newIndex:ne,containerId:f}),ve=d!==ee.current.items,fe=t({active:T,containerId:f,isDragging:$,isSorting:q,id:o,index:_,items:d,newIndex:ee.current.newIndex,previousItems:ee.current.items,previousContainerId:ee.current.containerId,transition:u,wasDragging:ee.current.activeId!=null}),be=ZW({disabled:!fe,index:_,node:E,rect:N});return m.useEffect(()=>{q&&ee.current.newIndex!==ne&&(ee.current.newIndex=ne),f!==ee.current.containerId&&(ee.current.containerId=f),d!==ee.current.items&&(ee.current.items=d)},[q,ne,f,d]),m.useEffect(()=>{if(V===ee.current.activeId)return;if(V!=null&&ee.current.activeId==null){ee.current.activeId=V;return}const te=setTimeout(()=>{ee.current.activeId=V},50);return()=>clearTimeout(te)},[V]),{active:T,activeIndex:h,attributes:C,data:S,rect:N,index:_,newIndex:ne,items:d,isOver:j,isSorting:q,isDragging:$,listeners:O,node:E,overIndex:w,over:D,setNodeRef:M,setActivatorNodeRef:A,setDroppableNodeRef:R,setDraggableNodeRef:L,transform:be??re,transition:ce()};function ce(){if(be||ve&&ee.current.newIndex===_)return XW;if(!(B&&!Ey(P)||!u)&&(q||fe))return Cs.Transition.toString({...u,property:rR})}}function JW(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function bc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const eU=[Ne.Down,Ne.Right,Ne.Up,Ne.Left],iR=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:l}}=t;if(eU.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const h=i.get(f.id);if(h)switch(e.code){case Ne.Down:n.top<h.top&&c.push(f);break;case Ne.Up:n.top>h.top&&c.push(f);break;case Ne.Left:n.left>h.left&&c.push(f);break;case Ne.Right:n.left<h.left&&c.push(f);break}});const u=L7({collisionRect:n,droppableRects:i,droppableContainers:c});let d=D4(u,"id");if(d===(o==null?void 0:o.id)&&u.length>1&&(d=u[1].id),d!=null){const f=s.get(r.id),h=s.get(d),p=h?i.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&p&&f&&h){const w=hu(y).some((k,N)=>l[N]!==k),v=sR(f,h),x=tU(f,h),b=w||!v?{x:0,y:0}:{x:x?n.width-p.width:0,y:x?n.height-p.height:0},_={x:p.left,y:p.top};return b.x&&b.y?_:aa(_,b)}}}};function sR(e,t){return!bc(e)||!bc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function tU(e,t){return!bc(e)||!bc(t)||!sR(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const rU={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Dr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},nr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},oR={step_id:"new_step",produces:"",scope:"",inputs:[]},nU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function iU({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:i,onNavigateToWorkflow:s}){const[o,l]=m.useState("steps"),[c,u]=m.useState(""),[d,f]=m.useState(null),h=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:p,loading:y,error:g,saving:w,updateWorkflow:v}=qT(e,h,{onSave:j=>{n==null||n(h,j)}}),x=m.useCallback(j=>{j==="json"&&p&&(u(JSON.stringify(p,null,2)),f(null)),l(j)},[p]),b=m.useCallback(j=>{const R=j.target.value;u(R);try{const T=JSON.parse(R);f(null),v(T)}catch(T){f(T.message)}},[v]),_=m.useCallback((j,R)=>{if(!p)return;const T=[...p.steps];T[j]=R,v({...p,steps:T})},[p,v]),S=m.useCallback(j=>{if(!p)return;const R=p.steps.filter((T,P)=>P!==j);v({...p,steps:R})},[p,v]),k=m.useCallback(j=>{var T,P;if(!p)return;const R=j==="iteration"?{...nU,step_id:`new_iteration_${(((T=p.steps)==null?void 0:T.length)||0)+1}`}:{...oR,step_id:`new_step_${(((P=p.steps)==null?void 0:P.length)||0)+1}`};v({...p,steps:[...p.steps||[],R]})},[p,v]),N=m.useCallback((j,R)=>{if(!p)return;const T=yu(p.steps,j,R);v({...p,steps:T})},[p,v]),E=m.useCallback(()=>{!i||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&i(t.workflow_id)},[i,t]);return t?a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(p==null?void 0:p.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),((p==null?void 0:p.pow_class)||t.pow_class)&&a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(p==null?void 0:p.pow_class)||t.pow_class})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(p==null?void 0:p.description)&&`  ${p.description}`]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[w&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),i&&a.jsx("button",{onClick:E,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(j=>a.jsx("button",{onClick:()=>x(j.id),style:{...rU,color:o===j.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:j.label},j.id))}),y?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&a.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[a.jsx(sU,{steps:(p==null?void 0:p.steps)||[],documentTypes:r,onStepChange:_,onStepDelete:S,onReorder:N}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>k("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),a.jsx("button",{onClick:()=>k("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&a.jsxs("div",{className:"h-full flex flex-col p-4",children:[a.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:d?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),d&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",d]})]}),o==="metadata"&&a.jsx("div",{className:"h-full overflow-y-auto p-4",children:p?a.jsx(cU,{workflow:p,onUpdateWorkflow:v,onNavigateToWorkflow:s}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),a.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function sU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=M4(xc(gu,{activationConstraint:{distance:5}}),xc(mu,{coordinateGetter:iR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:u,over:d}=c;if(!d||u.id===d.id)return;const f=e.findIndex(p=>p.step_id===u.id),h=e.findIndex(p=>p.step_id===d.id);f!==-1&&h!==-1&&i(f,h)},[e,i]);return e.length===0?a.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):a.jsx(X4,{sensors:s,collisionDetection:L4,onDragEnd:l,children:a.jsx(tR,{items:o,strategy:Z4,children:e.map((c,u)=>a.jsx(oU,{step:c,index:u,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function oU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:u,isDragging:d}=nR({id:e.step_id}),f={transform:Cs.Transform.toString(c),transition:u,opacity:d?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(aR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o}})})}function aR({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i,dragHandleProps:s,depth:o=0}){var k,N,E;const[l,c]=m.useState(e),[u,d]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,h=(j,R)=>{const T={...l,[j]:R};c(T),n(t,T)},p=(j,R)=>{const T={...l.iterate_over,[j]:R},P={...l,iterate_over:T};c(P),n(t,P)},y=()=>{const j=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:j};c(R),n(t,R)},g=(j,R,T)=>{const P=[...l.inputs||[]];P[j]={...P[j],[R]:T};const z={...l,inputs:P};c(z),n(t,z)},w=j=>{const R=(l.inputs||[]).filter((P,z)=>z!==j),T={...l,inputs:R};c(T),n(t,T)},v=m.useCallback((j,R)=>{const T=[...l.steps||[]];T[j]=R;const P={...l,steps:T};c(P),n(t,P)},[l,t,n]),x=m.useCallback(j=>{const R=(l.steps||[]).filter((P,z)=>z!==j),T={...l,steps:R};c(T),n(t,T)},[l,t,n]),b=m.useCallback(()=>{var T;const j=[...l.steps||[],{...oR,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],R={...l,steps:j};c(R),n(t,R)},[l,t,n]),_=m.useCallback((j,R)=>{const T=yu(l.steps||[],j,R),P={...l,steps:T};c(P),n(t,P)},[l,t,n]),S={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return a.jsxs("div",{style:S,children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:u?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:u?"6px 6px 0 0":6},children:[s&&a.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[a.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),a.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),a.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),a.jsx("span",{style:{flex:1}}),a.jsx("button",{onClick:()=>d(!u),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:u?"Collapse":"Expand",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u?a.jsx("path",{d:"M18 15l-6-6-6 6"}):a.jsx("path",{d:"M6 9l6 6 6-6"})})}),a.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),u&&a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Step ID"}),a.jsx("input",{type:"text",value:l.step_id||"",onChange:j=>h("step_id",j.target.value),style:Dr})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Doc Type"}),a.jsxs("select",{value:((k=l.iterate_over)==null?void 0:k.doc_type)||"",onChange:j=>p("doc_type",j.target.value),style:Dr,children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(j=>a.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Collection Field"}),a.jsx("input",{type:"text",value:((N=l.iterate_over)==null?void 0:N.collection_field)||"",onChange:j=>p("collection_field",j.target.value),style:Dr})]}),a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Entity Type"}),a.jsx("input",{type:"text",value:((E=l.iterate_over)==null?void 0:E.entity_type)||"",onChange:j=>p("entity_type",j.target.value),style:Dr})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:j=>h("scope",j.target.value),style:Dr})]}),a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{style:nr,children:"Nested Steps"}),a.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),a.jsx(aU,{steps:l.steps||[],documentTypes:r,onStepChange:v,onStepDelete:x,onReorder:_})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Produces"}),a.jsxs("select",{value:l.produces||"",onChange:j=>h("produces",j.target.value),style:Dr,children:[a.jsx("option",{value:"",children:"-- Select document type --"}),r.map(j=>a.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:j=>h("scope",j.target.value),placeholder:"project",style:Dr})]}),a.jsxs("div",{children:[a.jsx("label",{style:nr,children:"Creates Entities"}),a.jsx("input",{type:"text",value:l.creates_entities||"",onChange:j=>h("creates_entities",j.target.value||void 0),placeholder:"e.g., epic",style:Dr})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:nr,children:"Inputs"}),a.jsx("button",{onClick:y,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):a.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((j,R)=>a.jsxs("div",{className:"flex gap-1 items-end",children:[a.jsxs("div",{style:{flex:1},children:[R===0&&a.jsx("label",{style:{...nr,fontSize:9},children:"Doc/Entity Type"}),a.jsxs("select",{value:j.doc_type||j.entity_type||"",onChange:T=>{const P=T.target.value;j.entity_type!==void 0?g(R,"entity_type",P):g(R,"doc_type",P)},style:{...Dr,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(T=>a.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),a.jsxs("div",{style:{width:"30%"},children:[R===0&&a.jsx("label",{style:{...nr,fontSize:9},children:"Scope"}),a.jsx("input",{type:"text",value:j.scope||"",onChange:T=>g(R,"scope",T.target.value),placeholder:"scope",style:{...Dr,fontSize:11}})]}),a.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[a.jsx("input",{type:"checkbox",checked:j.context||!1,onChange:T=>g(R,"context",T.target.checked||void 0)}),"ctx"]}),a.jsx("button",{onClick:()=>w(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function aU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=M4(xc(gu,{activationConstraint:{distance:5}}),xc(mu,{coordinateGetter:iR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:u,over:d}=c;if(!d||u.id===d.id)return;const f=e.findIndex(p=>p.step_id===u.id),h=e.findIndex(p=>p.step_id===d.id);f!==-1&&h!==-1&&i(f,h)},[e,i]);return e.length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):a.jsx(X4,{sensors:s,collisionDetection:L4,onDragEnd:l,children:a.jsx(tR,{items:o,strategy:Z4,children:e.map((c,u)=>a.jsx(lU,{step:c,index:u,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function lU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:u,isDragging:d}=nR({id:e.step_id}),f={transform:Cs.Transform.toString(c),transition:u,opacity:d?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(aR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o},depth:1})})}function cU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,i]=m.useState(""),s={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},o={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},u=Object.entries(c),d=e.document_types||{},f=Object.entries(d),h=e.pow_class||"reference",p=e.derived_from,y=e.source_version,g=e.tags||[],w=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),i(""))},v=b=>{t==null||t({...e,tags:g.filter(_=>_!==b)})},x=()=>{p!=null&&p.workflow_id&&r&&r(p.workflow_id)};return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"POW Class"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:h==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:h==="reference"?"#000":"var(--text-primary)"},children:h})})]}),p&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Derived From"}),a.jsx("div",{style:s,children:r?a.jsxs("button",{onClick:x,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[p.workflow_id," v",p.version]}):a.jsxs("span",{children:[p.workflow_id," v",p.version]})})]}),y&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Source Version"}),a.jsx("div",{style:s,children:y})]}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Tags"}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>a.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&a.jsx("button",{onClick:()=>v(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:n,onChange:b=>i(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),w())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),a.jsx("button",{onClick:w,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b.label}),a.jsx("div",{style:s,children:e[b.key]||"-"})]},b.key)),u.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),u.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:["parent: ",_.parent||"none"]})]},b))]}),f.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:[_.name,_.scope&&` (${_.scope})`,_.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function Ej({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(i=>i.status==="fail"),n=e.filter(i=>i.status==="pass");return t?a.jsx("div",{className:"flex items-center gap-2",children:r.length>0?a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):a.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):a.jsxs("div",{className:"space-y-2",children:[r.map((i,s)=>a.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx("span",{className:"text-red-400",children:"FAIL"}),a.jsx("span",{className:"font-mono",children:i.rule_id})]}),i.message&&a.jsx("div",{className:"mt-1 opacity-80",children:i.message}),i.artifact_id&&a.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:i.artifact_id})]},s)),n.length>0&&r.length>0&&a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function uU(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),i=[];let s=0,o=0;for(;s<r.length||o<n.length;)if(s>=r.length)i.push({type:"added",line:n[o],lineNum:o+1}),o++;else if(o>=n.length)i.push({type:"removed",line:r[s],lineNum:s+1}),s++;else if(r[s]===n[o])i.push({type:"same",line:r[s],oldLineNum:s+1,newLineNum:o+1}),s++,o++;else{let l=n.slice(o,o+5).indexOf(r[s]),c=r.slice(s,s+5).indexOf(n[o]);if(l!==-1&&(c===-1||l<=c)){for(let u=0;u<l;u++)i.push({type:"added",line:n[o+u],lineNum:o+u+1});o+=l}else if(c!==-1){for(let u=0;u<c;u++)i.push({type:"removed",line:r[s+u],lineNum:s+u+1});s+=c}else i.push({type:"removed",line:r[s],lineNum:s+1}),i.push({type:"added",line:n[o],lineNum:o+1}),s++,o++}return i}function dU({diff:e}){const[t,r]=m.useState(!0),n=uU(e.old_content,e.new_content),i={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return a.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:i[e.status]||i.M,children:e.status}),a.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),a.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&a.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:a.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((s,o)=>a.jsxs("div",{className:"flex",style:{background:s.type==="added"?"rgba(34, 197, 94, 0.1)":s.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:s.type==="added"?"3px solid #22c55e":s.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[a.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:s.type==="same"?s.oldLineNum:s.lineNum||""}),a.jsx("span",{className:"select-none px-1",style:{color:s.type==="added"?"#22c55e":s.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:s.type==="added"?"+":s.type==="removed"?"-":" "}),a.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:s.line})]},o))})})]})}function fU({workspaceId:e,artifactId:t=null,onClose:r}){const[n,i]=m.useState([]),[s,o]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(o(!0),c(null),Se.getDiff(e,t).then(d=>{i(d.diffs||[])}).catch(d=>{c(d.message)}).finally(()=>{o(!1)}))},[e,t]);const u=d=>{d.key==="Escape"&&(r==null||r())};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:d=>d.target===d.currentTarget&&(r==null?void 0:r()),onKeyDown:u,tabIndex:0,children:a.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),a.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?a.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((d,f)=>a.jsx(dU,{diff:d},d.artifact_id||f))}),a.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function pU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:i,kind:s,displayName:o,kindLabel:l,display:`${o} - ${l}`}}function hU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=pU(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function mU({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:i=[],modifiedFiles:s=[]}){const[o,l]=m.useState(""),[c,u]=m.useState(!1),d=hU(i),f=i.length,h=y=>{y.preventDefault(),o.trim()&&!n&&t(o.trim())},p=y=>{y.key==="Escape"&&!n&&r()};return a.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:y=>y.target===y.currentTarget&&!n&&r(),onKeyDown:p,children:[a.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&a.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),a.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:d.map(y=>a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:y.label}),a.jsx("div",{className:"space-y-1",children:y.items.map((g,w)=>a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),a.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),a.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),a.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},w))})]},y.scope))}),a.jsx("button",{type:"button",onClick:()=>u(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),a.jsxs("form",{onSubmit:h,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),a.jsx("textarea",{value:o,onChange:y=>l(y.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!o.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:o.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:o.trim()&&!n?"#000":"var(--text-muted)",cursor:o.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&a.jsx(fU,{workspaceId:e,onClose:()=>u(!1)})]})}function gU(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:o,kind:s,kindLabel:l,version:i,display:`${o} - ${l}`}}function vU({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:i,onClose:s,onRefresh:o}){var j,R;const[l,c]=m.useState(!1),[u,d]=m.useState(!1),[f,h]=m.useState(!1),[p,y]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,w=(t==null?void 0:t.modified_artifacts)??[],v=((j=t==null?void 0:t.tier1)==null?void 0:j.passed)??!0,x=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",_=t!=null&&t.expires_at?new Date(t.expires_at):null,S=async T=>{d(!0),y(null);try{const P=await Se.commit(e,T);c(!1),n==null||n(P),o==null||o()}catch(P){y(P.message)}finally{d(!1)}},k=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){h(!0);try{await Se.discard(e),i==null||i(),o==null||o()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{h(!1)}}},N=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await Se.closeWorkspace(e),s==null||s()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},E=T=>{if(!T)return null;const z=T-new Date;if(z<=0)return"Expired";const C=Math.floor(z/(1e3*60*60)),L=Math.floor(z%(1e3*60*60)/(1e3*60));return C>0?`${C}h ${L}m remaining`:`${L}m remaining`};return a.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:a.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),a.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),_&&a.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:E(_)})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),a.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),w.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",w.length,")"]}),a.jsx("div",{className:"space-y-1",children:w.map(T=>{const P=gU(T);return a.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[a.jsx("span",{style:{color:"var(--text-primary)"},children:P.displayName||T}),P.kindLabel&&a.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",P.kindLabel]})]},T)})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),a.jsx(Ej,{results:x,compact:!0})]}),x.length>0&&!v&&a.jsx("div",{className:"mt-3",children:a.jsx(Ej,{results:x})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[a.jsx("button",{onClick:()=>c(!0),disabled:!g||!v||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&v?"var(--action-success)":"var(--border-panel)",color:g&&v?"#000":"var(--text-muted)",cursor:g&&v&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!v&&g&&a.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&a.jsx("button",{onClick:k,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&a.jsx("button",{onClick:N,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&a.jsx(mU,{workspaceId:e,onCommit:S,onCancel:()=>{c(!1),y(null)},loading:u,modifiedArtifacts:w,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),p&&a.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:p})]})}function xU(){const{isAdmin:e,loading:t}=Ds(),[r,n]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,u]=m.useState(null),[d,f]=m.useState(null),[h,p]=m.useState(null),[y,g]=m.useState(null),[w,v]=m.useState(null),[x,b]=m.useState(null),[_,S]=m.useState(null),[k,N]=m.useState(!1),{workspaceId:E,loading:j,error:R,reinitialize:T}=Y$(),{state:P,loading:z,refresh:C}=X$(E),{documentTypes:L,loading:O,refresh:$}=Q$(),{roles:D,loading:A,refresh:F}=Z$(),{templates:M,loading:q,refresh:W}=DT(),{workflows:B,loading:K,refresh:Z}=_B(),{fragments:re,loading:ne,kindOptions:V,refresh:ee}=FT(),{schemas:ve,loading:fe,refresh:be}=LT(),ce=m.useCallback(async(de,ae=null,it="docworkflow")=>{if(n(de),u(null),f(null),p(null),s(null),b(ae),S(it),!!de){l(!0);try{const Ve=await Se.getDocumentType(de.doc_type_id);s(Ve)}catch(Ve){console.error("Failed to load doc type details:",Ve),s(de)}finally{l(!1)}}},[]),te=m.useCallback(de=>{ce(de,"task_prompt","task")},[ce]),we=m.useCallback(de=>{ce(de,"schema","schema")},[ce]),Y=m.useCallback(de=>{u(de),n(null),s(null),f(null),p(null),g(null),v(null)},[]),X=m.useCallback(de=>{f(de),n(null),s(null),u(null),p(null),g(null),v(null)},[]),ue=m.useCallback(de=>{p(de),n(null),s(null),u(null),f(null),g(null),v(null)},[]),he=m.useCallback(de=>{g(de),n(null),s(null),u(null),f(null),p(null),v(null)},[]),_e=m.useCallback(de=>{v(de),n(null),s(null),u(null),f(null),p(null),g(null)},[]),ge=m.useCallback(de=>{const ae=B.find(it=>it.workflow_id===de);ae&&ue(ae)},[B,ue]),Q=m.useCallback((de,ae)=>{C()},[C]),pe=m.useCallback(de=>{console.log("Committed:",de.commit_hash)},[]),We=m.useCallback(()=>{n(null),s(null),u(null),f(null),p(null)},[]),Re=m.useCallback(async de=>{if(E)try{const ae=await Se.createOrchestrationWorkflow(E,de);await Z(),C(),p({workflow_id:ae.workflow_id,active_version:ae.version,name:de.name||ae.workflow_id.replace(/_/g," ").replace(/\b\w/g,it=>it.toUpperCase())}),n(null),s(null),u(null),f(null)}catch(ae){console.error("Failed to create workflow:",ae),alert(`Failed to create workflow: ${ae.message}`)}},[E,Z,C]),Le=m.useCallback(async de=>{if(E)try{await Se.deleteOrchestrationWorkflow(E,de),await Z(),C(),p(null)}catch(ae){console.error("Failed to delete workflow:",ae),alert(`Failed to delete workflow: ${ae.message}`)}},[E,Z,C]),Pe=m.useCallback(async de=>{if(E)try{const ae=await Se.createDocumentType(E,de);await $(),C(),ce({doc_type_id:ae.doc_type_id,display_name:de.display_name||ae.doc_type_id.replace(/_/g," ").replace(/\b\w/g,it=>it.toUpperCase()),active_version:ae.version})}catch(ae){console.error("Failed to create document type:",ae),alert(`Failed to create document type: ${ae.message}`)}},[E,$,C,ce]);m.useCallback(async de=>{if(E)try{await Se.deleteDocumentType(E,de),await $(),C(),n(null),s(null)}catch(ae){console.error("Failed to delete document type:",ae),alert(`Failed to delete document type: ${ae.message}`)}},[E,$,C]);const Ue=m.useCallback(async de=>{if(E)try{await Se.createDcwWorkflow(E,{doc_type_id:de}),await Z(),C()}catch(ae){console.error("Failed to create DCW workflow:",ae),alert(`Failed to create workflow: ${ae.message}`)}},[E,Z,C]),I=m.useCallback(async de=>{if(E)try{const ae=await Se.createRolePrompt(E,de);await ee(),await F(),C(),he({fragment_id:`role:${ae.role_id}`,kind:"role",version:ae.version,name:de.name||ae.role_id.replace(/_/g," ").replace(/\b\w/g,it=>it.toUpperCase())})}catch(ae){console.error("Failed to create role prompt:",ae),alert(`Failed to create role prompt: ${ae.message}`)}},[E,ee,F,C,he]),H=m.useCallback(async de=>{if(E)try{const ae=await Se.createTemplate(E,de);await W(),C(),X({template_id:ae.template_id,active_version:ae.version,name:de.name||ae.template_id.replace(/_/g," ").replace(/\b\w/g,it=>it.toUpperCase())})}catch(ae){console.error("Failed to create template:",ae),alert(`Failed to create template: ${ae.message}`)}},[E,W,C,X]),U=m.useCallback(async de=>{if(E)try{const ae=await Se.createStandaloneSchema(E,de);await be(),C(),_e({schema_id:ae.schema_id,active_version:ae.version,title:de.title||ae.schema_id.replace(/_/g," ").replace(/\b\w/g,it=>it.toUpperCase())})}catch(ae){console.error("Failed to create schema:",ae),alert(`Failed to create schema: ${ae.message}`)}},[E,be,C,_e]),se=m.useCallback(()=>{T(),n(null),s(null),u(null),f(null),p(null)},[T]);if(t)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(j)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(R)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),a.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:R}),a.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const Oe=c&&!r&&!d&&!h&&!y&&!w,kt=d&&!r&&!c&&!h&&!y&&!w,Mt=h&&!r&&!c&&!d&&!y&&!w,Pt=y&&!r&&!c&&!d&&!h&&!w,Ar=w&&!r&&!c&&!d&&!h&&!y;return a.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"}),a.jsxs("button",{onClick:()=>N(!k),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:k?"var(--action-primary)":"var(--bg-panel)",color:k?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[a.jsx("span",{style:{fontSize:14},children:""}),a.jsx("span",{children:"Building Blocks"})]})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(SB,{documentTypes:L,roles:D,templates:M,workflows:B,promptFragments:re,promptFragmentKindOptions:V,schemas:ve,loading:O,rolesLoading:A,templatesLoading:q,workflowsLoading:K,promptFragmentsLoading:ne,schemasLoading:fe,selectedDocType:r,docTypeSource:_,selectedRole:c,selectedTemplate:d,selectedWorkflow:h,selectedFragment:y,selectedSchema:w,onSelectDocType:ce,onSelectRole:Y,onSelectTemplate:X,onSelectWorkflow:ue,onSelectFragment:he,onSelectStandaloneSchema:_e,onCreateWorkflow:Re,onCreateDocType:Pe,onCreateFragment:I,onCreateTemplate:H,onCreateSchema:U,onSelectTask:te,onSelectSchema:we,workspaceState:P}),Oe?a.jsx(XB,{workspaceId:E,role:c,onArtifactSave:Q}):kt?a.jsx(v7,{workspaceId:E,template:d,onArtifactSave:Q}):Pt?a.jsx(w7,{workspaceId:E,fragment:y,onArtifactSave:Q}):Mt?a.jsx(iU,{workspaceId:E,workflow:h,documentTypes:L,onArtifactSave:Q,onDelete:Le,onNavigateToWorkflow:ge}):Ar?a.jsx(x7,{workspaceId:E,schema:w,onArtifactSave:Q}):a.jsx(YB,{workspaceId:E,docType:i,loading:o,roles:D,workflows:B,onArtifactSave:Q,onCreateDcwWorkflow:Ue,initialTab:x,docTypeSource:_}),a.jsx(vU,{workspaceId:E,state:P,loading:z,onCommit:pe,onDiscard:We,onClose:se,onRefresh:C})]}),a.jsx(kB,{isOpen:k,onClose:()=>N(!1),promptFragments:re,promptFragmentKindOptions:V,templates:M,schemas:ve,documentTypes:L,promptFragmentsLoading:ne,templatesLoading:q,schemasLoading:fe,onSelectFragment:he,onSelectTemplate:X,onSelectSchema:we,onSelectStandaloneSchema:_e,onCreateFragment:I,onCreateTemplate:H,onCreateSchema:U})]})}function yU({user:e,onClick:t}){return a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function bU(){var T,P,z;const{user:e}=Ds(),[t,r]=m.useState(!1),{projects:n,loading:i,error:s,refresh:o}=U$({includeArchived:t}),[l,c]=m.useState(null),[u,d]=m.useState(null),[f,h]=m.useState(!1),[p,y]=m.useState(!1),{theme:g,setTheme:w}=PT(),v=Object.keys(n),x=l&&n[l]?l:v[0]||null;m.useEffect(()=>{if(x&&n[x]){const C=n[x];document.title=`${C.projectId} - The Combine`}else document.title="The Combine"},[x,n]);const b=C=>{c(C),d(null)},_=()=>{h(!0)},S=async C=>{await o(),C&&C.id&&(c(C.id),d("concierge_intake")),h(!1)},k=()=>{h(!1)},N=async(C,L)=>{try{await $e.updateProject(C,L),await o()}catch(O){throw console.error("Failed to update project:",O),O}},E=async C=>{try{if(await $e.archiveProject(C),!t){const L=Object.values(n).sort((D,A)=>{const F=(D.name||"").localeCompare(A.name||"");return F!==0?F:(D.projectId||"").localeCompare(A.projectId||"")}),O=L.findIndex(D=>D.id===C),$=L[O+1]||L[O-1]||null;c(($==null?void 0:$.id)||null)}await o()}catch(L){throw console.error("Failed to archive project:",L),L}},j=async C=>{try{await $e.unarchiveProject(C),await o()}catch(L){throw console.error("Failed to unarchive project:",L),L}},R=async C=>{try{await $e.deleteProject(C);const L=Object.values(n).sort((D,A)=>{const F=(D.name||"").localeCompare(A.name||"");return F!==0?F:(D.projectId||"").localeCompare(A.projectId||"")}),O=L.findIndex(D=>D.id===C),$=L[O+1]||L[O-1]||null;c(($==null?void 0:$.id)||null),await o()}catch(L){throw console.error("Failed to delete project:",L),L}};return i?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):s?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[a.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",s]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):a.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[a.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),a.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),a.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("path",{d:"M12 17h.01"})]})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(t6,{projects:n,selectedId:x,onSelectProject:b,onNewProject:_,showArchived:t,onToggleShowArchived:()=>r(C=>!C),userSection:a.jsx(yU,{user:e,onClick:()=>y(!0)})}),a.jsx("div",{className:"flex-1",children:x?a.jsx(Vc,{children:a.jsx(tB,{projectId:x,projectCode:(T=n[x])==null?void 0:T.projectId,projectName:(P=n[x])==null?void 0:P.name,isArchived:(z=n[x])==null?void 0:z.isArchived,autoExpandNodeId:u,theme:g,onThemeChange:w,onProjectUpdate:N,onProjectArchive:E,onProjectUnarchive:j,onProjectDelete:R})},x):a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center",children:a.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&a.jsx(cB,{onClose:k,onComplete:S}),p&&a.jsx(uB,{onClose:()=>y(!1)})]})]})}function wU(){const{isAuthenticated:e,loading:t}=Ds(),{theme:r}=PT(),[n,i]=m.useState(window.location.pathname);return m.useEffect(()=>{const s=()=>i(window.location.pathname);return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]),t?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?a.jsx("div",{className:`h-screen theme-${r}`,children:a.jsx(xU,{})}):a.jsx(bU,{}):n==="/learn"?a.jsx(wB,{}):a.jsx(vB,{})}function _U(){return a.jsx(K$,{children:a.jsx(wU,{})})}yg.createRoot(document.getElementById("root")).render(a.jsx(G.StrictMode,{children:a.jsx(_U,{})}));
//# sourceMappingURL=index-BGP8zUmR.js.map
