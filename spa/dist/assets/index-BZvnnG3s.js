(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var PS={exports:{}},Ec={},OS={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fa=Symbol.for("react.element"),AR=Symbol.for("react.portal"),IR=Symbol.for("react.fragment"),MR=Symbol.for("react.strict_mode"),PR=Symbol.for("react.profiler"),OR=Symbol.for("react.provider"),DR=Symbol.for("react.context"),LR=Symbol.for("react.forward_ref"),FR=Symbol.for("react.suspense"),zR=Symbol.for("react.memo"),qR=Symbol.for("react.lazy"),Ly=Symbol.iterator;function $R(e){return e===null||typeof e!="object"?null:(e=Ly&&e[Ly]||e["@@iterator"],typeof e=="function"?e:null)}var DS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},LS=Object.assign,FS={};function Es(e,t,n){this.props=e,this.context=t,this.refs=FS,this.updater=n||DS}Es.prototype.isReactComponent={};Es.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Es.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function zS(){}zS.prototype=Es.prototype;function Uv(e,t,n){this.props=e,this.context=t,this.refs=FS,this.updater=n||DS}var Vv=Uv.prototype=new zS;Vv.constructor=Uv;LS(Vv,Es.prototype);Vv.isPureReactComponent=!0;var Fy=Array.isArray,qS=Object.prototype.hasOwnProperty,Gv={current:null},$S={key:!0,ref:!0,__self:!0,__source:!0};function BS(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)qS.call(t,r)&&!$S.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:fa,type:e,key:s,ref:o,props:i,_owner:Gv.current}}function BR(e,t){return{$$typeof:fa,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Kv(e){return typeof e=="object"&&e!==null&&e.$$typeof===fa}function HR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var zy=/\/+/g;function Eu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?HR(""+e.key):t.toString(36)}function gl(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case fa:case AR:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Eu(o,0):r,Fy(i)?(n="",e!=null&&(n=e.replace(zy,"$&/")+"/"),gl(i,t,n,"",function(d){return d})):i!=null&&(Kv(i)&&(i=BR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(zy,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Fy(e))for(var l=0;l<e.length;l++){s=e[l];var c=r+Eu(s,l);o+=gl(s,t,n,c,i)}else if(c=$R(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=r+Eu(s,l++),o+=gl(s,t,n,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ra(e,t,n){if(e==null)return e;var r=[],i=0;return gl(e,r,"","",function(s){return t.call(n,s,i++)}),r}function WR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ft={current:null},vl={transition:null},UR={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:vl,ReactCurrentOwner:Gv};function HS(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Ra,forEach:function(e,t,n){Ra(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ra(e,function(){t++}),t},toArray:function(e){return Ra(e,function(t){return t})||[]},only:function(e){if(!Kv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Es;Ce.Fragment=IR;Ce.Profiler=PR;Ce.PureComponent=Uv;Ce.StrictMode=MR;Ce.Suspense=FR;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UR;Ce.act=HS;Ce.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=LS({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Gv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)qS.call(t,c)&&!$S.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:fa,type:e.type,key:i,ref:s,props:r,_owner:o}};Ce.createContext=function(e){return e={$$typeof:DR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:OR,_context:e},e.Consumer=e};Ce.createElement=BS;Ce.createFactory=function(e){var t=BS.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:LR,render:e}};Ce.isValidElement=Kv;Ce.lazy=function(e){return{$$typeof:qR,_payload:{_status:-1,_result:e},_init:WR}};Ce.memo=function(e,t){return{$$typeof:zR,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=vl.transition;vl.transition={};try{e()}finally{vl.transition=t}};Ce.unstable_act=HS;Ce.useCallback=function(e,t){return Ft.current.useCallback(e,t)};Ce.useContext=function(e){return Ft.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Ft.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Ft.current.useEffect(e,t)};Ce.useId=function(){return Ft.current.useId()};Ce.useImperativeHandle=function(e,t,n){return Ft.current.useImperativeHandle(e,t,n)};Ce.useInsertionEffect=function(e,t){return Ft.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Ft.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Ft.current.useMemo(e,t)};Ce.useReducer=function(e,t,n){return Ft.current.useReducer(e,t,n)};Ce.useRef=function(e){return Ft.current.useRef(e)};Ce.useState=function(e){return Ft.current.useState(e)};Ce.useSyncExternalStore=function(e,t,n){return Ft.current.useSyncExternalStore(e,t,n)};Ce.useTransition=function(){return Ft.current.useTransition()};Ce.version="18.3.1";OS.exports=Ce;var m=OS.exports;const V=Wv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VR=m,GR=Symbol.for("react.element"),KR=Symbol.for("react.fragment"),YR=Object.prototype.hasOwnProperty,XR=VR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QR={key:!0,ref:!0,__self:!0,__source:!0};function WS(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)YR.call(t,r)&&!QR.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:GR,type:e,key:s,ref:o,props:i,_owner:XR.current}}Ec.Fragment=KR;Ec.jsx=WS;Ec.jsxs=WS;PS.exports=Ec;var a=PS.exports,_g={},US={exports:{}},on={},VS={exports:{}},GS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,A){var F=O.length;O.push(A);e:for(;0<F;){var I=F-1>>>1,q=O[I];if(0<i(q,A))O[I]=A,O[F]=q,F=I;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var A=O[0],F=O.pop();if(F!==A){O[0]=F;e:for(var I=0,q=O.length,W=q>>>1;I<W;){var U=2*(I+1)-1,Z=O[U],B=U+1,ne=O[B];if(0>i(Z,F))B<q&&0>i(ne,Z)?(O[I]=ne,O[B]=F,I=B):(O[I]=Z,O[U]=F,I=U);else if(B<q&&0>i(ne,F))O[I]=ne,O[B]=F,I=B;else break e}}return A}function i(O,A){var F=O.sortIndex-A.sortIndex;return F!==0?F:O.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,x=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var A=n(d);A!==null;){if(A.callback===null)r(d);else if(A.startTime<=O)r(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=n(d)}}function _(O){if(g=!1,b(O),!x)if(n(c)!==null)x=!0,P(j);else{var A=n(d);A!==null&&$(_,A.startTime-O)}}function j(O,A){x=!1,g&&(g=!1,v(E),E=-1),h=!0;var F=p;try{for(b(A),f=n(c);f!==null&&(!(f.expirationTime>A)||O&&!T());){var I=f.callback;if(typeof I=="function"){f.callback=null,p=f.priorityLevel;var q=I(f.expirationTime<=A);A=e.unstable_now(),typeof q=="function"?f.callback=q:f===n(c)&&r(c),b(A)}else r(c);f=n(c)}if(f!==null)var W=!0;else{var U=n(d);U!==null&&$(_,U.startTime-A),W=!1}return W}finally{f=null,p=F,h=!1}}var k=!1,N=null,E=-1,S=5,R=-1;function T(){return!(e.unstable_now()-R<S)}function M(){if(N!==null){var O=e.unstable_now();R=O;var A=!0;try{A=N(!0,O)}finally{A?z():(k=!1,N=null)}}else k=!1}var z;if(typeof y=="function")z=function(){y(M)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,L=C.port2;C.port1.onmessage=M,z=function(){L.postMessage(null)}}else z=function(){w(M,0)};function P(O){N=O,k||(k=!0,z())}function $(O,A){E=w(function(){O(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){x||h||(x=!0,P(j))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var A=3;break;default:A=p}var F=p;p=A;try{return O()}finally{p=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,A){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var F=p;p=O;try{return A()}finally{p=F}},e.unstable_scheduleCallback=function(O,A,F){var I=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?I+F:I):F=I,O){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=F+q,O={id:u++,callback:A,priorityLevel:O,startTime:F,expirationTime:q,sortIndex:-1},F>I?(O.sortIndex=F,t(d,O),n(c)===null&&O===n(d)&&(g?(v(E),E=-1):g=!0,$(_,F-I))):(O.sortIndex=q,t(c,O),x||h||(x=!0,P(j))),O},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(O){var A=p;return function(){var F=p;p=A;try{return O.apply(this,arguments)}finally{p=F}}}})(GS);VS.exports=GS;var ZR=VS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JR=m,rn=ZR;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var KS=new Set,Po={};function Ci(e,t){ms(e,t),ms(e+"Capture",t)}function ms(e,t){for(Po[e]=t,e=0;e<t.length;e++)KS.add(t[e])}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jg=Object.prototype.hasOwnProperty,eA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qy={},$y={};function tA(e){return jg.call($y,e)?!0:jg.call(qy,e)?!1:eA.test(e)?$y[e]=!0:(qy[e]=!0,!1)}function nA(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function rA(e,t,n,r){if(t===null||typeof t>"u"||nA(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zt(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){St[e]=new zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];St[t]=new zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){St[e]=new zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){St[e]=new zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){St[e]=new zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){St[e]=new zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){St[e]=new zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){St[e]=new zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){St[e]=new zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Yv=/[\-:]([a-z])/g;function Xv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Yv,Xv);St[t]=new zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Yv,Xv);St[t]=new zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Yv,Xv);St[t]=new zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){St[e]=new zt(e,1,!1,e.toLowerCase(),null,!1,!1)});St.xlinkHref=new zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){St[e]=new zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Qv(e,t,n,r){var i=St.hasOwnProperty(t)?St[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(rA(t,n,i,r)&&(n=null),r||i===null?tA(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var vr=JR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Aa=Symbol.for("react.element"),Hi=Symbol.for("react.portal"),Wi=Symbol.for("react.fragment"),Zv=Symbol.for("react.strict_mode"),Sg=Symbol.for("react.profiler"),YS=Symbol.for("react.provider"),XS=Symbol.for("react.context"),Jv=Symbol.for("react.forward_ref"),kg=Symbol.for("react.suspense"),Ng=Symbol.for("react.suspense_list"),ex=Symbol.for("react.memo"),jr=Symbol.for("react.lazy"),QS=Symbol.for("react.offscreen"),By=Symbol.iterator;function $s(e){return e===null||typeof e!="object"?null:(e=By&&e[By]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Tu;function ao(e){if(Tu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Tu=t&&t[1]||""}return`
`+Tu+e}var Ru=!1;function Au(e,t){if(!e||Ru)return"";Ru=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ru=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ao(e):""}function iA(e){switch(e.tag){case 5:return ao(e.type);case 16:return ao("Lazy");case 13:return ao("Suspense");case 19:return ao("SuspenseList");case 0:case 2:case 15:return e=Au(e.type,!1),e;case 11:return e=Au(e.type.render,!1),e;case 1:return e=Au(e.type,!0),e;default:return""}}function Cg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Wi:return"Fragment";case Hi:return"Portal";case Sg:return"Profiler";case Zv:return"StrictMode";case kg:return"Suspense";case Ng:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case XS:return(e.displayName||"Context")+".Consumer";case YS:return(e._context.displayName||"Context")+".Provider";case Jv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ex:return t=e.displayName||null,t!==null?t:Cg(e.type)||"Memo";case jr:t=e._payload,e=e._init;try{return Cg(e(t))}catch{}}return null}function sA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cg(t);case 8:return t===Zv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ZS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function oA(e){var t=ZS(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ia(e){e._valueTracker||(e._valueTracker=oA(e))}function JS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ZS(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ml(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Eg(e,t){var n=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Hy(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Gr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ek(e,t){t=t.checked,t!=null&&Qv(e,"checked",t,!1)}function Tg(e,t){ek(e,t);var n=Gr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Rg(e,t.type,n):t.hasOwnProperty("defaultValue")&&Rg(e,t.type,Gr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wy(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Rg(e,t,n){(t!=="number"||Ml(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var lo=Array.isArray;function ss(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Gr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Ag(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Uy(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ee(92));if(lo(n)){if(1<n.length)throw Error(ee(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Gr(n)}}function tk(e,t){var n=Gr(t.value),r=Gr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Vy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function nk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ig(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?nk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ma,rk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ma=Ma||document.createElement("div"),Ma.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ma.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Oo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var wo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aA=["Webkit","ms","Moz","O"];Object.keys(wo).forEach(function(e){aA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),wo[t]=wo[e]})});function ik(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||wo.hasOwnProperty(e)&&wo[e]?(""+t).trim():t+"px"}function sk(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ik(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var lA=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mg(e,t){if(t){if(lA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function Pg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Og=null;function tx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Dg=null,os=null,as=null;function Gy(e){if(e=ma(e)){if(typeof Dg!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=Mc(t),Dg(e.stateNode,e.type,t))}}function ok(e){os?as?as.push(e):as=[e]:os=e}function ak(){if(os){var e=os,t=as;if(as=os=null,Gy(e),t)for(e=0;e<t.length;e++)Gy(t[e])}}function lk(e,t){return e(t)}function ck(){}var Iu=!1;function uk(e,t,n){if(Iu)return e(t,n);Iu=!0;try{return lk(e,t,n)}finally{Iu=!1,(os!==null||as!==null)&&(ck(),ak())}}function Do(e,t){var n=e.stateNode;if(n===null)return null;var r=Mc(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ee(231,t,typeof n));return n}var Lg=!1;if(cr)try{var Bs={};Object.defineProperty(Bs,"passive",{get:function(){Lg=!0}}),window.addEventListener("test",Bs,Bs),window.removeEventListener("test",Bs,Bs)}catch{Lg=!1}function cA(e,t,n,r,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(u){this.onError(u)}}var _o=!1,Pl=null,Ol=!1,Fg=null,uA={onError:function(e){_o=!0,Pl=e}};function dA(e,t,n,r,i,s,o,l,c){_o=!1,Pl=null,cA.apply(uA,arguments)}function fA(e,t,n,r,i,s,o,l,c){if(dA.apply(this,arguments),_o){if(_o){var d=Pl;_o=!1,Pl=null}else throw Error(ee(198));Ol||(Ol=!0,Fg=d)}}function Ei(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function dk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ky(e){if(Ei(e)!==e)throw Error(ee(188))}function pA(e){var t=e.alternate;if(!t){if(t=Ei(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Ky(i),e;if(s===r)return Ky(i),t;s=s.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?e:t}function fk(e){return e=pA(e),e!==null?pk(e):null}function pk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pk(e);if(t!==null)return t;e=e.sibling}return null}var hk=rn.unstable_scheduleCallback,Yy=rn.unstable_cancelCallback,hA=rn.unstable_shouldYield,mA=rn.unstable_requestPaint,rt=rn.unstable_now,gA=rn.unstable_getCurrentPriorityLevel,nx=rn.unstable_ImmediatePriority,mk=rn.unstable_UserBlockingPriority,Dl=rn.unstable_NormalPriority,vA=rn.unstable_LowPriority,gk=rn.unstable_IdlePriority,Tc=null,Bn=null;function xA(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Tc,e,void 0,(e.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:wA,yA=Math.log,bA=Math.LN2;function wA(e){return e>>>=0,e===0?32:31-(yA(e)/bA|0)|0}var Pa=64,Oa=4194304;function co(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ll(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=co(l):(s&=o,s!==0&&(r=co(s)))}else o=n&~i,o!==0?r=co(o):s!==0&&(r=co(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Tn(t),i=1<<n,r|=e[n],t&=~i;return r}function _A(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jA(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Tn(s),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=_A(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function zg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function vk(){var e=Pa;return Pa<<=1,!(Pa&4194240)&&(Pa=64),e}function Mu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function pa(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tn(t),e[t]=n}function SA(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Tn(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function rx(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Tn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var qe=0;function xk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var yk,ix,bk,wk,_k,qg=!1,Da=[],Or=null,Dr=null,Lr=null,Lo=new Map,Fo=new Map,Er=[],kA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xy(e,t){switch(e){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":Lr=null;break;case"pointerover":case"pointerout":Lo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(t.pointerId)}}function Hs(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=ma(t),t!==null&&ix(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function NA(e,t,n,r,i){switch(t){case"focusin":return Or=Hs(Or,e,t,n,r,i),!0;case"dragenter":return Dr=Hs(Dr,e,t,n,r,i),!0;case"mouseover":return Lr=Hs(Lr,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Lo.set(s,Hs(Lo.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Fo.set(s,Hs(Fo.get(s)||null,e,t,n,r,i)),!0}return!1}function jk(e){var t=ci(e.target);if(t!==null){var n=Ei(t);if(n!==null){if(t=n.tag,t===13){if(t=dk(n),t!==null){e.blockedOn=t,_k(e.priority,function(){bk(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=$g(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Og=r,n.target.dispatchEvent(r),Og=null}else return t=ma(n),t!==null&&ix(t),e.blockedOn=n,!1;t.shift()}return!0}function Qy(e,t,n){xl(e)&&n.delete(t)}function CA(){qg=!1,Or!==null&&xl(Or)&&(Or=null),Dr!==null&&xl(Dr)&&(Dr=null),Lr!==null&&xl(Lr)&&(Lr=null),Lo.forEach(Qy),Fo.forEach(Qy)}function Ws(e,t){e.blockedOn===t&&(e.blockedOn=null,qg||(qg=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,CA)))}function zo(e){function t(i){return Ws(i,e)}if(0<Da.length){Ws(Da[0],e);for(var n=1;n<Da.length;n++){var r=Da[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Or!==null&&Ws(Or,e),Dr!==null&&Ws(Dr,e),Lr!==null&&Ws(Lr,e),Lo.forEach(t),Fo.forEach(t),n=0;n<Er.length;n++)r=Er[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Er.length&&(n=Er[0],n.blockedOn===null);)jk(n),n.blockedOn===null&&Er.shift()}var ls=vr.ReactCurrentBatchConfig,Fl=!0;function EA(e,t,n,r){var i=qe,s=ls.transition;ls.transition=null;try{qe=1,sx(e,t,n,r)}finally{qe=i,ls.transition=s}}function TA(e,t,n,r){var i=qe,s=ls.transition;ls.transition=null;try{qe=4,sx(e,t,n,r)}finally{qe=i,ls.transition=s}}function sx(e,t,n,r){if(Fl){var i=$g(e,t,n,r);if(i===null)Hu(e,t,r,zl,n),Xy(e,r);else if(NA(i,e,t,n,r))r.stopPropagation();else if(Xy(e,r),t&4&&-1<kA.indexOf(e)){for(;i!==null;){var s=ma(i);if(s!==null&&yk(s),s=$g(e,t,n,r),s===null&&Hu(e,t,r,zl,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Hu(e,t,r,null,n)}}var zl=null;function $g(e,t,n,r){if(zl=null,e=tx(r),e=ci(e),e!==null)if(t=Ei(e),t===null)e=null;else if(n=t.tag,n===13){if(e=dk(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return zl=e,null}function Sk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gA()){case nx:return 1;case mk:return 4;case Dl:case vA:return 16;case gk:return 536870912;default:return 16}default:return 16}}var Mr=null,ox=null,yl=null;function kk(){if(yl)return yl;var e,t=ox,n=t.length,r,i="value"in Mr?Mr.value:Mr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return yl=i.slice(e,1<r?1-r:void 0)}function bl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function La(){return!0}function Zy(){return!1}function an(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?La:Zy,this.isPropagationStopped=Zy,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=La)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=La)},persist:function(){},isPersistent:La}),t}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ax=an(Ts),ha=et({},Ts,{view:0,detail:0}),RA=an(ha),Pu,Ou,Us,Rc=et({},ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Us&&(Us&&e.type==="mousemove"?(Pu=e.screenX-Us.screenX,Ou=e.screenY-Us.screenY):Ou=Pu=0,Us=e),Pu)},movementY:function(e){return"movementY"in e?e.movementY:Ou}}),Jy=an(Rc),AA=et({},Rc,{dataTransfer:0}),IA=an(AA),MA=et({},ha,{relatedTarget:0}),Du=an(MA),PA=et({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),OA=an(PA),DA=et({},Ts,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),LA=an(DA),FA=et({},Ts,{data:0}),e0=an(FA),zA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$A={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$A[e])?!!t[e]:!1}function lx(){return BA}var HA=et({},ha,{key:function(e){if(e.key){var t=zA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=bl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lx,charCode:function(e){return e.type==="keypress"?bl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),WA=an(HA),UA=et({},Rc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t0=an(UA),VA=et({},ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lx}),GA=an(VA),KA=et({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),YA=an(KA),XA=et({},Rc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),QA=an(XA),ZA=[9,13,27,32],cx=cr&&"CompositionEvent"in window,jo=null;cr&&"documentMode"in document&&(jo=document.documentMode);var JA=cr&&"TextEvent"in window&&!jo,Nk=cr&&(!cx||jo&&8<jo&&11>=jo),n0=" ",r0=!1;function Ck(e,t){switch(e){case"keyup":return ZA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ek(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ui=!1;function e5(e,t){switch(e){case"compositionend":return Ek(t);case"keypress":return t.which!==32?null:(r0=!0,n0);case"textInput":return e=t.data,e===n0&&r0?null:e;default:return null}}function t5(e,t){if(Ui)return e==="compositionend"||!cx&&Ck(e,t)?(e=kk(),yl=ox=Mr=null,Ui=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nk&&t.locale!=="ko"?null:t.data;default:return null}}var n5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!n5[e.type]:t==="textarea"}function Tk(e,t,n,r){ok(r),t=ql(t,"onChange"),0<t.length&&(n=new ax("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var So=null,qo=null;function r5(e){qk(e,0)}function Ac(e){var t=Ki(e);if(JS(t))return e}function i5(e,t){if(e==="change")return t}var Rk=!1;if(cr){var Lu;if(cr){var Fu="oninput"in document;if(!Fu){var s0=document.createElement("div");s0.setAttribute("oninput","return;"),Fu=typeof s0.oninput=="function"}Lu=Fu}else Lu=!1;Rk=Lu&&(!document.documentMode||9<document.documentMode)}function o0(){So&&(So.detachEvent("onpropertychange",Ak),qo=So=null)}function Ak(e){if(e.propertyName==="value"&&Ac(qo)){var t=[];Tk(t,qo,e,tx(e)),uk(r5,t)}}function s5(e,t,n){e==="focusin"?(o0(),So=t,qo=n,So.attachEvent("onpropertychange",Ak)):e==="focusout"&&o0()}function o5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ac(qo)}function a5(e,t){if(e==="click")return Ac(t)}function l5(e,t){if(e==="input"||e==="change")return Ac(t)}function c5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var An=typeof Object.is=="function"?Object.is:c5;function $o(e,t){if(An(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jg.call(t,i)||!An(e[i],t[i]))return!1}return!0}function a0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function l0(e,t){var n=a0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=a0(n)}}function Ik(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ik(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Mk(){for(var e=window,t=Ml();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ml(e.document)}return t}function ux(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function u5(e){var t=Mk(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ik(n.ownerDocument.documentElement,n)){if(r!==null&&ux(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=l0(n,s);var o=l0(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var d5=cr&&"documentMode"in document&&11>=document.documentMode,Vi=null,Bg=null,ko=null,Hg=!1;function c0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Hg||Vi==null||Vi!==Ml(r)||(r=Vi,"selectionStart"in r&&ux(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ko&&$o(ko,r)||(ko=r,r=ql(Bg,"onSelect"),0<r.length&&(t=new ax("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Vi)))}function Fa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Gi={animationend:Fa("Animation","AnimationEnd"),animationiteration:Fa("Animation","AnimationIteration"),animationstart:Fa("Animation","AnimationStart"),transitionend:Fa("Transition","TransitionEnd")},zu={},Pk={};cr&&(Pk=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function Ic(e){if(zu[e])return zu[e];if(!Gi[e])return e;var t=Gi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Pk)return zu[e]=t[n];return e}var Ok=Ic("animationend"),Dk=Ic("animationiteration"),Lk=Ic("animationstart"),Fk=Ic("transitionend"),zk=new Map,u0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qr(e,t){zk.set(e,t),Ci(t,[e])}for(var qu=0;qu<u0.length;qu++){var $u=u0[qu],f5=$u.toLowerCase(),p5=$u[0].toUpperCase()+$u.slice(1);Qr(f5,"on"+p5)}Qr(Ok,"onAnimationEnd");Qr(Dk,"onAnimationIteration");Qr(Lk,"onAnimationStart");Qr("dblclick","onDoubleClick");Qr("focusin","onFocus");Qr("focusout","onBlur");Qr(Fk,"onTransitionEnd");ms("onMouseEnter",["mouseout","mouseover"]);ms("onMouseLeave",["mouseout","mouseover"]);ms("onPointerEnter",["pointerout","pointerover"]);ms("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),h5=new Set("cancel close invalid load scroll toggle".split(" ").concat(uo));function d0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,fA(r,t,void 0,e),e.currentTarget=null}function qk(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;d0(i,l,d),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;d0(i,l,d),s=c}}}if(Ol)throw e=Fg,Ol=!1,Fg=null,e}function Ue(e,t){var n=t[Kg];n===void 0&&(n=t[Kg]=new Set);var r=e+"__bubble";n.has(r)||($k(t,e,2,!1),n.add(r))}function Bu(e,t,n){var r=0;t&&(r|=4),$k(n,e,r,t)}var za="_reactListening"+Math.random().toString(36).slice(2);function Bo(e){if(!e[za]){e[za]=!0,KS.forEach(function(n){n!=="selectionchange"&&(h5.has(n)||Bu(n,!1,e),Bu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[za]||(t[za]=!0,Bu("selectionchange",!1,t))}}function $k(e,t,n,r){switch(Sk(t)){case 1:var i=EA;break;case 4:i=TA;break;default:i=sx}n=i.bind(null,t,n,e),i=void 0,!Lg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hu(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ci(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}uk(function(){var d=s,u=tx(n),f=[];e:{var p=zk.get(e);if(p!==void 0){var h=ax,x=e;switch(e){case"keypress":if(bl(n)===0)break e;case"keydown":case"keyup":h=WA;break;case"focusin":x="focus",h=Du;break;case"focusout":x="blur",h=Du;break;case"beforeblur":case"afterblur":h=Du;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Jy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=IA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=GA;break;case Ok:case Dk:case Lk:h=OA;break;case Fk:h=YA;break;case"scroll":h=RA;break;case"wheel":h=QA;break;case"copy":case"cut":case"paste":h=LA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=t0}var g=(t&4)!==0,w=!g&&e==="scroll",v=g?p!==null?p+"Capture":null:p;g=[];for(var y=d,b;y!==null;){b=y;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,v!==null&&(_=Do(y,v),_!=null&&g.push(Ho(y,_,b)))),w)break;y=y.return}0<g.length&&(p=new h(p,x,null,n,u),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&n!==Og&&(x=n.relatedTarget||n.fromElement)&&(ci(x)||x[ur]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(x=n.relatedTarget||n.toElement,h=d,x=x?ci(x):null,x!==null&&(w=Ei(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(h=null,x=d),h!==x)){if(g=Jy,_="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=t0,_="onPointerLeave",v="onPointerEnter",y="pointer"),w=h==null?p:Ki(h),b=x==null?p:Ki(x),p=new g(_,y+"leave",h,n,u),p.target=w,p.relatedTarget=b,_=null,ci(u)===d&&(g=new g(v,y+"enter",x,n,u),g.target=b,g.relatedTarget=w,_=g),w=_,h&&x)t:{for(g=h,v=x,y=0,b=g;b;b=Pi(b))y++;for(b=0,_=v;_;_=Pi(_))b++;for(;0<y-b;)g=Pi(g),y--;for(;0<b-y;)v=Pi(v),b--;for(;y--;){if(g===v||v!==null&&g===v.alternate)break t;g=Pi(g),v=Pi(v)}g=null}else g=null;h!==null&&f0(f,p,h,g,!1),x!==null&&w!==null&&f0(f,w,x,g,!0)}}e:{if(p=d?Ki(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var j=i5;else if(i0(p))if(Rk)j=l5;else{j=o5;var k=s5}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(j=a5);if(j&&(j=j(e,d))){Tk(f,j,n,u);break e}k&&k(e,p,d),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&Rg(p,"number",p.value)}switch(k=d?Ki(d):window,e){case"focusin":(i0(k)||k.contentEditable==="true")&&(Vi=k,Bg=d,ko=null);break;case"focusout":ko=Bg=Vi=null;break;case"mousedown":Hg=!0;break;case"contextmenu":case"mouseup":case"dragend":Hg=!1,c0(f,n,u);break;case"selectionchange":if(d5)break;case"keydown":case"keyup":c0(f,n,u)}var N;if(cx)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ui?Ck(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Nk&&n.locale!=="ko"&&(Ui||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ui&&(N=kk()):(Mr=u,ox="value"in Mr?Mr.value:Mr.textContent,Ui=!0)),k=ql(d,E),0<k.length&&(E=new e0(E,e,null,n,u),f.push({event:E,listeners:k}),N?E.data=N:(N=Ek(n),N!==null&&(E.data=N)))),(N=JA?e5(e,n):t5(e,n))&&(d=ql(d,"onBeforeInput"),0<d.length&&(u=new e0("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:d}),u.data=N))}qk(f,t)})}function Ho(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ql(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Do(e,n),s!=null&&r.unshift(Ho(e,s,i)),s=Do(e,t),s!=null&&r.push(Ho(e,s,i))),e=e.return}return r}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function f0(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,i?(c=Do(n,s),c!=null&&o.unshift(Ho(n,c,l))):i||(c=Do(n,s),c!=null&&o.push(Ho(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var m5=/\r\n?/g,g5=/\u0000|\uFFFD/g;function p0(e){return(typeof e=="string"?e:""+e).replace(m5,`
`).replace(g5,"")}function qa(e,t,n){if(t=p0(t),p0(e)!==t&&n)throw Error(ee(425))}function $l(){}var Wg=null,Ug=null;function Vg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Gg=typeof setTimeout=="function"?setTimeout:void 0,v5=typeof clearTimeout=="function"?clearTimeout:void 0,h0=typeof Promise=="function"?Promise:void 0,x5=typeof queueMicrotask=="function"?queueMicrotask:typeof h0<"u"?function(e){return h0.resolve(null).then(e).catch(y5)}:Gg;function y5(e){setTimeout(function(){throw e})}function Wu(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),zo(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);zo(t)}function Fr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function m0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Rs=Math.random().toString(36).slice(2),qn="__reactFiber$"+Rs,Wo="__reactProps$"+Rs,ur="__reactContainer$"+Rs,Kg="__reactEvents$"+Rs,b5="__reactListeners$"+Rs,w5="__reactHandles$"+Rs;function ci(e){var t=e[qn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ur]||n[qn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=m0(e);e!==null;){if(n=e[qn])return n;e=m0(e)}return t}e=n,n=e.parentNode}return null}function ma(e){return e=e[qn]||e[ur],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ki(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function Mc(e){return e[Wo]||null}var Yg=[],Yi=-1;function Zr(e){return{current:e}}function Ve(e){0>Yi||(e.current=Yg[Yi],Yg[Yi]=null,Yi--)}function We(e,t){Yi++,Yg[Yi]=e.current,e.current=t}var Kr={},It=Zr(Kr),Ut=Zr(!1),bi=Kr;function gs(e,t){var n=e.type.contextTypes;if(!n)return Kr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Vt(e){return e=e.childContextTypes,e!=null}function Bl(){Ve(Ut),Ve(It)}function g0(e,t,n){if(It.current!==Kr)throw Error(ee(168));We(It,t),We(Ut,n)}function Bk(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ee(108,sA(e)||"Unknown",i));return et({},n,r)}function Hl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Kr,bi=It.current,We(It,e),We(Ut,Ut.current),!0}function v0(e,t,n){var r=e.stateNode;if(!r)throw Error(ee(169));n?(e=Bk(e,t,bi),r.__reactInternalMemoizedMergedChildContext=e,Ve(Ut),Ve(It),We(It,e)):Ve(Ut),We(Ut,n)}var er=null,Pc=!1,Uu=!1;function Hk(e){er===null?er=[e]:er.push(e)}function _5(e){Pc=!0,Hk(e)}function Jr(){if(!Uu&&er!==null){Uu=!0;var e=0,t=qe;try{var n=er;for(qe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}er=null,Pc=!1}catch(i){throw er!==null&&(er=er.slice(e+1)),hk(nx,Jr),i}finally{qe=t,Uu=!1}}return null}var Xi=[],Qi=0,Wl=null,Ul=0,dn=[],fn=0,wi=null,nr=1,rr="";function oi(e,t){Xi[Qi++]=Ul,Xi[Qi++]=Wl,Wl=e,Ul=t}function Wk(e,t,n){dn[fn++]=nr,dn[fn++]=rr,dn[fn++]=wi,wi=e;var r=nr;e=rr;var i=32-Tn(r)-1;r&=~(1<<i),n+=1;var s=32-Tn(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,nr=1<<32-Tn(t)+i|n<<i|r,rr=s+e}else nr=1<<s|n<<i|r,rr=e}function dx(e){e.return!==null&&(oi(e,1),Wk(e,1,0))}function fx(e){for(;e===Wl;)Wl=Xi[--Qi],Xi[Qi]=null,Ul=Xi[--Qi],Xi[Qi]=null;for(;e===wi;)wi=dn[--fn],dn[fn]=null,rr=dn[--fn],dn[fn]=null,nr=dn[--fn],dn[fn]=null}var nn=null,tn=null,Ke=!1,Cn=null;function Uk(e,t){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function x0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nn=e,tn=Fr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nn=e,tn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=wi!==null?{id:nr,overflow:rr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,nn=e,tn=null,!0):!1;default:return!1}}function Xg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Qg(e){if(Ke){var t=tn;if(t){var n=t;if(!x0(e,t)){if(Xg(e))throw Error(ee(418));t=Fr(n.nextSibling);var r=nn;t&&x0(e,t)?Uk(r,n):(e.flags=e.flags&-4097|2,Ke=!1,nn=e)}}else{if(Xg(e))throw Error(ee(418));e.flags=e.flags&-4097|2,Ke=!1,nn=e}}}function y0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nn=e}function $a(e){if(e!==nn)return!1;if(!Ke)return y0(e),Ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Vg(e.type,e.memoizedProps)),t&&(t=tn)){if(Xg(e))throw Vk(),Error(ee(418));for(;t;)Uk(e,t),t=Fr(t.nextSibling)}if(y0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){tn=Fr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}tn=null}}else tn=nn?Fr(e.stateNode.nextSibling):null;return!0}function Vk(){for(var e=tn;e;)e=Fr(e.nextSibling)}function vs(){tn=nn=null,Ke=!1}function px(e){Cn===null?Cn=[e]:Cn.push(e)}var j5=vr.ReactCurrentBatchConfig;function Vs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,e))}return e}function Ba(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function b0(e){var t=e._init;return t(e._payload)}function Gk(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function n(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=Br(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,_){return y===null||y.tag!==6?(y=Zu(b,v.mode,_),y.return=v,y):(y=i(y,b),y.return=v,y)}function c(v,y,b,_){var j=b.type;return j===Wi?u(v,y,b.props.children,_,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jr&&b0(j)===y.type)?(_=i(y,b.props),_.ref=Vs(v,y,b),_.return=v,_):(_=Cl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vs(v,y,b),_.return=v,_)}function d(v,y,b,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Ju(b,v.mode,_),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function u(v,y,b,_,j){return y===null||y.tag!==7?(y=gi(b,v.mode,_,j),y.return=v,y):(y=i(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Zu(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Aa:return b=Cl(y.type,y.key,y.props,null,v.mode,b),b.ref=Vs(v,null,y),b.return=v,b;case Hi:return y=Ju(y,v.mode,b),y.return=v,y;case jr:var _=y._init;return f(v,_(y._payload),b)}if(lo(y)||$s(y))return y=gi(y,v.mode,b,null),y.return=v,y;Ba(v,y)}return null}function p(v,y,b,_){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,y,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Aa:return b.key===j?c(v,y,b,_):null;case Hi:return b.key===j?d(v,y,b,_):null;case jr:return j=b._init,p(v,y,j(b._payload),_)}if(lo(b)||$s(b))return j!==null?null:u(v,y,b,_,null);Ba(v,b)}return null}function h(v,y,b,_,j){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(b)||null,l(y,v,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Aa:return v=v.get(_.key===null?b:_.key)||null,c(y,v,_,j);case Hi:return v=v.get(_.key===null?b:_.key)||null,d(y,v,_,j);case jr:var k=_._init;return h(v,y,b,k(_._payload),j)}if(lo(_)||$s(_))return v=v.get(b)||null,u(y,v,_,j,null);Ba(y,_)}return null}function x(v,y,b,_){for(var j=null,k=null,N=y,E=y=0,S=null;N!==null&&E<b.length;E++){N.index>E?(S=N,N=null):S=N.sibling;var R=p(v,N,b[E],_);if(R===null){N===null&&(N=S);break}e&&N&&R.alternate===null&&t(v,N),y=s(R,y,E),k===null?j=R:k.sibling=R,k=R,N=S}if(E===b.length)return n(v,N),Ke&&oi(v,E),j;if(N===null){for(;E<b.length;E++)N=f(v,b[E],_),N!==null&&(y=s(N,y,E),k===null?j=N:k.sibling=N,k=N);return Ke&&oi(v,E),j}for(N=r(v,N);E<b.length;E++)S=h(N,v,E,b[E],_),S!==null&&(e&&S.alternate!==null&&N.delete(S.key===null?E:S.key),y=s(S,y,E),k===null?j=S:k.sibling=S,k=S);return e&&N.forEach(function(T){return t(v,T)}),Ke&&oi(v,E),j}function g(v,y,b,_){var j=$s(b);if(typeof j!="function")throw Error(ee(150));if(b=j.call(b),b==null)throw Error(ee(151));for(var k=j=null,N=y,E=y=0,S=null,R=b.next();N!==null&&!R.done;E++,R=b.next()){N.index>E?(S=N,N=null):S=N.sibling;var T=p(v,N,R.value,_);if(T===null){N===null&&(N=S);break}e&&N&&T.alternate===null&&t(v,N),y=s(T,y,E),k===null?j=T:k.sibling=T,k=T,N=S}if(R.done)return n(v,N),Ke&&oi(v,E),j;if(N===null){for(;!R.done;E++,R=b.next())R=f(v,R.value,_),R!==null&&(y=s(R,y,E),k===null?j=R:k.sibling=R,k=R);return Ke&&oi(v,E),j}for(N=r(v,N);!R.done;E++,R=b.next())R=h(N,v,E,R.value,_),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?E:R.key),y=s(R,y,E),k===null?j=R:k.sibling=R,k=R);return e&&N.forEach(function(M){return t(v,M)}),Ke&&oi(v,E),j}function w(v,y,b,_){if(typeof b=="object"&&b!==null&&b.type===Wi&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Aa:e:{for(var j=b.key,k=y;k!==null;){if(k.key===j){if(j=b.type,j===Wi){if(k.tag===7){n(v,k.sibling),y=i(k,b.props.children),y.return=v,v=y;break e}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jr&&b0(j)===k.type){n(v,k.sibling),y=i(k,b.props),y.ref=Vs(v,k,b),y.return=v,v=y;break e}n(v,k);break}else t(v,k);k=k.sibling}b.type===Wi?(y=gi(b.props.children,v.mode,_,b.key),y.return=v,v=y):(_=Cl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vs(v,y,b),_.return=v,v=_)}return o(v);case Hi:e:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else t(v,y);y=y.sibling}y=Ju(b,v.mode,_),y.return=v,v=y}return o(v);case jr:return k=b._init,w(v,y,k(b._payload),_)}if(lo(b))return x(v,y,b,_);if($s(b))return g(v,y,b,_);Ba(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(v,y.sibling),y=i(y,b),y.return=v,v=y):(n(v,y),y=Zu(b,v.mode,_),y.return=v,v=y),o(v)):n(v,y)}return w}var xs=Gk(!0),Kk=Gk(!1),Vl=Zr(null),Gl=null,Zi=null,hx=null;function mx(){hx=Zi=Gl=null}function gx(e){var t=Vl.current;Ve(Vl),e._currentValue=t}function Zg(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function cs(e,t){Gl=e,hx=Zi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bt=!0),e.firstContext=null)}function vn(e){var t=e._currentValue;if(hx!==e)if(e={context:e,memoizedValue:t,next:null},Zi===null){if(Gl===null)throw Error(ee(308));Zi=e,Gl.dependencies={lanes:0,firstContext:e}}else Zi=Zi.next=e;return t}var ui=null;function vx(e){ui===null?ui=[e]:ui.push(e)}function Yk(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,vx(t)):(n.next=i.next,i.next=n),t.interleaved=n,dr(e,r)}function dr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Sr=!1;function xx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ar(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Me&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,dr(e,n)}return i=r.interleaved,i===null?(t.next=t,vx(r)):(t.next=i.next,i.next=t),r.interleaved=t,dr(e,n)}function wl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rx(e,n)}}function w0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Kl(e,t,n,r){var i=e.updateQueue;Sr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,u=d=c=null,l=s;do{var p=l.lane,h=l.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,g=l;switch(p=t,h=n,g.tag){case 1:if(x=g.payload,typeof x=="function"){f=x.call(h,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,p=typeof x=="function"?x.call(h,f,p):x,p==null)break e;f=et({},f,p);break e;case 2:Sr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,o|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ji|=o,e.lanes=o,e.memoizedState=f}}function _0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var ga={},Hn=Zr(ga),Uo=Zr(ga),Vo=Zr(ga);function di(e){if(e===ga)throw Error(ee(174));return e}function yx(e,t){switch(We(Vo,t),We(Uo,e),We(Hn,ga),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ig(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ig(t,e)}Ve(Hn),We(Hn,t)}function ys(){Ve(Hn),Ve(Uo),Ve(Vo)}function Qk(e){di(Vo.current);var t=di(Hn.current),n=Ig(t,e.type);t!==n&&(We(Uo,e),We(Hn,n))}function bx(e){Uo.current===e&&(Ve(Hn),Ve(Uo))}var Ze=Zr(0);function Yl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vu=[];function wx(){for(var e=0;e<Vu.length;e++)Vu[e]._workInProgressVersionPrimary=null;Vu.length=0}var _l=vr.ReactCurrentDispatcher,Gu=vr.ReactCurrentBatchConfig,_i=0,Je=null,ct=null,ht=null,Xl=!1,No=!1,Go=0,S5=0;function Et(){throw Error(ee(321))}function _x(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!An(e[n],t[n]))return!1;return!0}function jx(e,t,n,r,i,s){if(_i=s,Je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_l.current=e===null||e.memoizedState===null?E5:T5,e=n(r,i),No){s=0;do{if(No=!1,Go=0,25<=s)throw Error(ee(301));s+=1,ht=ct=null,t.updateQueue=null,_l.current=R5,e=n(r,i)}while(No)}if(_l.current=Ql,t=ct!==null&&ct.next!==null,_i=0,ht=ct=Je=null,Xl=!1,t)throw Error(ee(300));return e}function Sx(){var e=Go!==0;return Go=0,e}function zn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Je.memoizedState=ht=e:ht=ht.next=e,ht}function xn(){if(ct===null){var e=Je.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=ht===null?Je.memoizedState:ht.next;if(t!==null)ht=t,ct=e;else{if(e===null)throw Error(ee(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},ht===null?Je.memoizedState=ht=e:ht=ht.next=e}return ht}function Ko(e,t){return typeof t=="function"?t(e):t}function Ku(e){var t=xn(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=ct,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((_i&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=r):c=c.next=f,Je.lanes|=u,ji|=u}d=d.next}while(d!==null&&d!==s);c===null?o=r:c.next=l,An(r,t.memoizedState)||(Bt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,Je.lanes|=s,ji|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Yu(e){var t=xn(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);An(s,t.memoizedState)||(Bt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Zk(){}function Jk(e,t){var n=Je,r=xn(),i=t(),s=!An(r.memoizedState,i);if(s&&(r.memoizedState=i,Bt=!0),r=r.queue,kx(nN.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,Yo(9,tN.bind(null,n,r,i,t),void 0,null),gt===null)throw Error(ee(349));_i&30||eN(n,t,i)}return i}function eN(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function tN(e,t,n,r){t.value=n,t.getSnapshot=r,rN(t)&&iN(e)}function nN(e,t,n){return n(function(){rN(t)&&iN(e)})}function rN(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!An(e,n)}catch{return!0}}function iN(e){var t=dr(e,1);t!==null&&Rn(t,e,1,-1)}function j0(e){var t=zn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ko,lastRenderedState:e},t.queue=e,e=e.dispatch=C5.bind(null,Je,e),[t.memoizedState,e]}function Yo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function sN(){return xn().memoizedState}function jl(e,t,n,r){var i=zn();Je.flags|=e,i.memoizedState=Yo(1|t,n,void 0,r===void 0?null:r)}function Oc(e,t,n,r){var i=xn();r=r===void 0?null:r;var s=void 0;if(ct!==null){var o=ct.memoizedState;if(s=o.destroy,r!==null&&_x(r,o.deps)){i.memoizedState=Yo(t,n,s,r);return}}Je.flags|=e,i.memoizedState=Yo(1|t,n,s,r)}function S0(e,t){return jl(8390656,8,e,t)}function kx(e,t){return Oc(2048,8,e,t)}function oN(e,t){return Oc(4,2,e,t)}function aN(e,t){return Oc(4,4,e,t)}function lN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cN(e,t,n){return n=n!=null?n.concat([e]):null,Oc(4,4,lN.bind(null,t,e),n)}function Nx(){}function uN(e,t){var n=xn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&_x(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function dN(e,t){var n=xn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&_x(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function fN(e,t,n){return _i&21?(An(n,t)||(n=vk(),Je.lanes|=n,ji|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bt=!0),e.memoizedState=n)}function k5(e,t){var n=qe;qe=n!==0&&4>n?n:4,e(!0);var r=Gu.transition;Gu.transition={};try{e(!1),t()}finally{qe=n,Gu.transition=r}}function pN(){return xn().memoizedState}function N5(e,t,n){var r=$r(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},hN(e))mN(t,n);else if(n=Yk(e,t,n,r),n!==null){var i=Lt();Rn(n,e,r,i),gN(n,t,r)}}function C5(e,t,n){var r=$r(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(hN(e))mN(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,An(l,o)){var c=t.interleaved;c===null?(i.next=i,vx(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=Yk(e,t,i,r),n!==null&&(i=Lt(),Rn(n,e,r,i),gN(n,t,r))}}function hN(e){var t=e.alternate;return e===Je||t!==null&&t===Je}function mN(e,t){No=Xl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function gN(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rx(e,n)}}var Ql={readContext:vn,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},E5={readContext:vn,useCallback:function(e,t){return zn().memoizedState=[e,t===void 0?null:t],e},useContext:vn,useEffect:S0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,jl(4194308,4,lN.bind(null,t,e),n)},useLayoutEffect:function(e,t){return jl(4194308,4,e,t)},useInsertionEffect:function(e,t){return jl(4,2,e,t)},useMemo:function(e,t){var n=zn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=zn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=N5.bind(null,Je,e),[r.memoizedState,e]},useRef:function(e){var t=zn();return e={current:e},t.memoizedState=e},useState:j0,useDebugValue:Nx,useDeferredValue:function(e){return zn().memoizedState=e},useTransition:function(){var e=j0(!1),t=e[0];return e=k5.bind(null,e[1]),zn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Je,i=zn();if(Ke){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=t(),gt===null)throw Error(ee(349));_i&30||eN(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,S0(nN.bind(null,r,s,e),[e]),r.flags|=2048,Yo(9,tN.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=zn(),t=gt.identifierPrefix;if(Ke){var n=rr,r=nr;n=(r&~(1<<32-Tn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Go++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=S5++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},T5={readContext:vn,useCallback:uN,useContext:vn,useEffect:kx,useImperativeHandle:cN,useInsertionEffect:oN,useLayoutEffect:aN,useMemo:dN,useReducer:Ku,useRef:sN,useState:function(){return Ku(Ko)},useDebugValue:Nx,useDeferredValue:function(e){var t=xn();return fN(t,ct.memoizedState,e)},useTransition:function(){var e=Ku(Ko)[0],t=xn().memoizedState;return[e,t]},useMutableSource:Zk,useSyncExternalStore:Jk,useId:pN,unstable_isNewReconciler:!1},R5={readContext:vn,useCallback:uN,useContext:vn,useEffect:kx,useImperativeHandle:cN,useInsertionEffect:oN,useLayoutEffect:aN,useMemo:dN,useReducer:Yu,useRef:sN,useState:function(){return Yu(Ko)},useDebugValue:Nx,useDeferredValue:function(e){var t=xn();return ct===null?t.memoizedState=e:fN(t,ct.memoizedState,e)},useTransition:function(){var e=Yu(Ko)[0],t=xn().memoizedState;return[e,t]},useMutableSource:Zk,useSyncExternalStore:Jk,useId:pN,unstable_isNewReconciler:!1};function Sn(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Jg(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:et({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Dc={isMounted:function(e){return(e=e._reactInternals)?Ei(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Lt(),i=$r(e),s=ar(r,i);s.payload=t,n!=null&&(s.callback=n),t=zr(e,s,i),t!==null&&(Rn(t,e,i,r),wl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Lt(),i=$r(e),s=ar(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=zr(e,s,i),t!==null&&(Rn(t,e,i,r),wl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lt(),r=$r(e),i=ar(n,r);i.tag=2,t!=null&&(i.callback=t),t=zr(e,i,r),t!==null&&(Rn(t,e,r,n),wl(t,e,r))}};function k0(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!$o(n,r)||!$o(i,s):!0}function vN(e,t,n){var r=!1,i=Kr,s=t.contextType;return typeof s=="object"&&s!==null?s=vn(s):(i=Vt(t)?bi:It.current,r=t.contextTypes,s=(r=r!=null)?gs(e,i):Kr),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Dc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function N0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Dc.enqueueReplaceState(t,t.state,null)}function ev(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},xx(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=vn(s):(s=Vt(t)?bi:It.current,i.context=gs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Jg(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Dc.enqueueReplaceState(i,i.state,null),Kl(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function bs(e,t){try{var n="",r=t;do n+=iA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Xu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function tv(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var A5=typeof WeakMap=="function"?WeakMap:Map;function xN(e,t,n){n=ar(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Jl||(Jl=!0,dv=r),tv(e,t)},n}function yN(e,t,n){n=ar(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){tv(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){tv(e,t),typeof r!="function"&&(qr===null?qr=new Set([this]):qr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function C0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new A5;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=U5.bind(null,e,t,n),t.then(e,e))}function E0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function T0(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ar(-1,1),t.tag=2,zr(n,t,1))),n.lanes|=1),e)}var I5=vr.ReactCurrentOwner,Bt=!1;function Ot(e,t,n,r){t.child=e===null?Kk(t,null,n,r):xs(t,e.child,n,r)}function R0(e,t,n,r,i){n=n.render;var s=t.ref;return cs(t,i),r=jx(e,t,n,r,s,i),n=Sx(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fr(e,t,i)):(Ke&&n&&dx(t),t.flags|=1,Ot(e,t,r,i),t.child)}function A0(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!Px(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,bN(e,t,s,r,i)):(e=Cl(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:$o,n(o,r)&&e.ref===t.ref)return fr(e,t,i)}return t.flags|=1,e=Br(s,r),e.ref=t.ref,e.return=t,t.child=e}function bN(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if($o(s,r)&&e.ref===t.ref)if(Bt=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(Bt=!0);else return t.lanes=e.lanes,fr(e,t,i)}return nv(e,t,n,r,i)}function wN(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(es,Jt),Jt|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,We(es,Jt),Jt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,We(es,Jt),Jt|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,We(es,Jt),Jt|=r;return Ot(e,t,i,n),t.child}function _N(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function nv(e,t,n,r,i){var s=Vt(n)?bi:It.current;return s=gs(t,s),cs(t,i),n=jx(e,t,n,r,s,i),r=Sx(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fr(e,t,i)):(Ke&&r&&dx(t),t.flags|=1,Ot(e,t,n,i),t.child)}function I0(e,t,n,r,i){if(Vt(n)){var s=!0;Hl(t)}else s=!1;if(cs(t,i),t.stateNode===null)Sl(e,t),vN(t,n,r),ev(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=vn(d):(d=Vt(n)?bi:It.current,d=gs(t,d));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&N0(t,o,r,d),Sr=!1;var p=t.memoizedState;o.state=p,Kl(t,r,o,i),c=t.memoizedState,l!==r||p!==c||Ut.current||Sr?(typeof u=="function"&&(Jg(t,n,u,r),c=t.memoizedState),(l=Sr||k0(t,n,l,r,p,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Xk(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Sn(t.type,l),o.props=d,f=t.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=vn(c):(c=Vt(n)?bi:It.current,c=gs(t,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&N0(t,o,r,c),Sr=!1,p=t.memoizedState,o.state=p,Kl(t,r,o,i);var x=t.memoizedState;l!==f||p!==x||Ut.current||Sr?(typeof h=="function"&&(Jg(t,n,h,r),x=t.memoizedState),(d=Sr||k0(t,n,d,r,p,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return rv(e,t,n,r,s,i)}function rv(e,t,n,r,i,s){_N(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&v0(t,n,!1),fr(e,t,s);r=t.stateNode,I5.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=xs(t,e.child,null,s),t.child=xs(t,null,l,s)):Ot(e,t,l,s),t.memoizedState=r.state,i&&v0(t,n,!0),t.child}function jN(e){var t=e.stateNode;t.pendingContext?g0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&g0(e,t.context,!1),yx(e,t.containerInfo)}function M0(e,t,n,r,i){return vs(),px(i),t.flags|=256,Ot(e,t,n,r),t.child}var iv={dehydrated:null,treeContext:null,retryLane:0};function sv(e){return{baseLanes:e,cachePool:null,transitions:null}}function SN(e,t,n){var r=t.pendingProps,i=Ze.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),We(Ze,i&1),e===null)return Qg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=zc(o,r,0,null),e=gi(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=sv(n),t.memoizedState=iv,e):Cx(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return M5(e,t,o,r,l,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Br(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Br(l,s):(s=gi(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?sv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=iv,r}return s=e.child,e=s.sibling,r=Br(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Cx(e,t){return t=zc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ha(e,t,n,r){return r!==null&&px(r),xs(t,e.child,null,n),e=Cx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function M5(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=Xu(Error(ee(422))),Ha(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=zc({mode:"visible",children:r.children},i,0,null),s=gi(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&xs(t,e.child,null,o),t.child.memoizedState=sv(o),t.memoizedState=iv,s);if(!(t.mode&1))return Ha(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(ee(419)),r=Xu(s,r,void 0),Ha(e,t,o,r)}if(l=(o&e.childLanes)!==0,Bt||l){if(r=gt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,dr(e,i),Rn(r,e,i,-1))}return Mx(),r=Xu(Error(ee(421))),Ha(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=V5.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,tn=Fr(i.nextSibling),nn=t,Ke=!0,Cn=null,e!==null&&(dn[fn++]=nr,dn[fn++]=rr,dn[fn++]=wi,nr=e.id,rr=e.overflow,wi=t),t=Cx(t,r.children),t.flags|=4096,t)}function P0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Zg(e.return,t,n)}function Qu(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function kN(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Ot(e,t,r.children,n),r=Ze.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&P0(e,n,t);else if(e.tag===19)P0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(We(Ze,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Yl(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Qu(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Yl(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Qu(t,!0,n,null,s);break;case"together":Qu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ji|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,n=Br(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Br(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function P5(e,t,n){switch(t.tag){case 3:jN(t),vs();break;case 5:Qk(t);break;case 1:Vt(t.type)&&Hl(t);break;case 4:yx(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;We(Vl,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(We(Ze,Ze.current&1),t.flags|=128,null):n&t.child.childLanes?SN(e,t,n):(We(Ze,Ze.current&1),e=fr(e,t,n),e!==null?e.sibling:null);We(Ze,Ze.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return kN(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(Ze,Ze.current),r)break;return null;case 22:case 23:return t.lanes=0,wN(e,t,n)}return fr(e,t,n)}var NN,ov,CN,EN;NN=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ov=function(){};CN=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,di(Hn.current);var s=null;switch(n){case"input":i=Eg(e,i),r=Eg(e,r),s=[];break;case"select":i=et({},i,{value:void 0}),r=et({},r,{value:void 0}),s=[];break;case"textarea":i=Ag(e,i),r=Ag(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=$l)}Mg(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Po.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Po.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ue("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};EN=function(e,t,n,r){n!==r&&(t.flags|=4)};function Gs(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function O5(e,t,n){var r=t.pendingProps;switch(fx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(t),null;case 1:return Vt(t.type)&&Bl(),Tt(t),null;case 3:return r=t.stateNode,ys(),Ve(Ut),Ve(It),wx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&($a(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cn!==null&&(hv(Cn),Cn=null))),ov(e,t),Tt(t),null;case 5:bx(t);var i=di(Vo.current);if(n=t.type,e!==null&&t.stateNode!=null)CN(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ee(166));return Tt(t),null}if(e=di(Hn.current),$a(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[qn]=t,r[Wo]=s,e=(t.mode&1)!==0,n){case"dialog":Ue("cancel",r),Ue("close",r);break;case"iframe":case"object":case"embed":Ue("load",r);break;case"video":case"audio":for(i=0;i<uo.length;i++)Ue(uo[i],r);break;case"source":Ue("error",r);break;case"img":case"image":case"link":Ue("error",r),Ue("load",r);break;case"details":Ue("toggle",r);break;case"input":Hy(r,s),Ue("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ue("invalid",r);break;case"textarea":Uy(r,s),Ue("invalid",r)}Mg(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&qa(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&qa(r.textContent,l,e),i=["children",""+l]):Po.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ue("scroll",r)}switch(n){case"input":Ia(r),Wy(r,s,!0);break;case"textarea":Ia(r),Vy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=$l)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=nk(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[qn]=t,e[Wo]=r,NN(e,t,!1,!1),t.stateNode=e;e:{switch(o=Pg(n,r),n){case"dialog":Ue("cancel",e),Ue("close",e),i=r;break;case"iframe":case"object":case"embed":Ue("load",e),i=r;break;case"video":case"audio":for(i=0;i<uo.length;i++)Ue(uo[i],e);i=r;break;case"source":Ue("error",e),i=r;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),i=r;break;case"details":Ue("toggle",e),i=r;break;case"input":Hy(e,r),i=Eg(e,r),Ue("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=et({},r,{value:void 0}),Ue("invalid",e);break;case"textarea":Uy(e,r),i=Ag(e,r),Ue("invalid",e);break;default:i=r}Mg(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?sk(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rk(e,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Oo(e,c):typeof c=="number"&&Oo(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Po.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ue("scroll",e):c!=null&&Qv(e,s,c,o))}switch(n){case"input":Ia(e),Wy(e,r,!1);break;case"textarea":Ia(e),Vy(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Gr(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?ss(e,!!r.multiple,s,!1):r.defaultValue!=null&&ss(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=$l)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tt(t),null;case 6:if(e&&t.stateNode!=null)EN(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ee(166));if(n=di(Vo.current),di(Hn.current),$a(t)){if(r=t.stateNode,n=t.memoizedProps,r[qn]=t,(s=r.nodeValue!==n)&&(e=nn,e!==null))switch(e.tag){case 3:qa(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qa(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qn]=t,t.stateNode=r}return Tt(t),null;case 13:if(Ve(Ze),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ke&&tn!==null&&t.mode&1&&!(t.flags&128))Vk(),vs(),t.flags|=98560,s=!1;else if(s=$a(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(ee(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[qn]=t}else vs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tt(t),s=!1}else Cn!==null&&(hv(Cn),Cn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ze.current&1?ft===0&&(ft=3):Mx())),t.updateQueue!==null&&(t.flags|=4),Tt(t),null);case 4:return ys(),ov(e,t),e===null&&Bo(t.stateNode.containerInfo),Tt(t),null;case 10:return gx(t.type._context),Tt(t),null;case 17:return Vt(t.type)&&Bl(),Tt(t),null;case 19:if(Ve(Ze),s=t.memoizedState,s===null)return Tt(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)Gs(s,!1);else{if(ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Yl(e),o!==null){for(t.flags|=128,Gs(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return We(Ze,Ze.current&1|2),t.child}e=e.sibling}s.tail!==null&&rt()>ws&&(t.flags|=128,r=!0,Gs(s,!1),t.lanes=4194304)}else{if(!r)if(e=Yl(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Gs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ke)return Tt(t),null}else 2*rt()-s.renderingStartTime>ws&&n!==1073741824&&(t.flags|=128,r=!0,Gs(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=rt(),t.sibling=null,n=Ze.current,We(Ze,r?n&1|2:n&1),t):(Tt(t),null);case 22:case 23:return Ix(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Jt&1073741824&&(Tt(t),t.subtreeFlags&6&&(t.flags|=8192)):Tt(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function D5(e,t){switch(fx(t),t.tag){case 1:return Vt(t.type)&&Bl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ys(),Ve(Ut),Ve(It),wx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bx(t),null;case 13:if(Ve(Ze),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ve(Ze),null;case 4:return ys(),null;case 10:return gx(t.type._context),null;case 22:case 23:return Ix(),null;case 24:return null;default:return null}}var Wa=!1,At=!1,L5=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Ji(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tt(e,t,r)}else n.current=null}function av(e,t,n){try{n()}catch(r){tt(e,t,r)}}var O0=!1;function F5(e,t){if(Wg=Fl,e=Mk(),ux(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(l=o+i),f!==s||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===n&&++d===i&&(l=o),p===s&&++u===r&&(c=o),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ug={focusedElem:e,selectionRange:n},Fl=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,w=x.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Sn(t.type,g),w);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(_){tt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return x=O0,O0=!1,x}function Co(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&av(t,n,s)}i=i.next}while(i!==r)}}function Lc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function lv(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function TN(e){var t=e.alternate;t!==null&&(e.alternate=null,TN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qn],delete t[Wo],delete t[Kg],delete t[b5],delete t[w5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function RN(e){return e.tag===5||e.tag===3||e.tag===4}function D0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||RN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cv(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=$l));else if(r!==4&&(e=e.child,e!==null))for(cv(e,t,n),e=e.sibling;e!==null;)cv(e,t,n),e=e.sibling}function uv(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(uv(e,t,n),e=e.sibling;e!==null;)uv(e,t,n),e=e.sibling}var wt=null,kn=!1;function br(e,t,n){for(n=n.child;n!==null;)AN(e,t,n),n=n.sibling}function AN(e,t,n){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Tc,n)}catch{}switch(n.tag){case 5:At||Ji(n,t);case 6:var r=wt,i=kn;wt=null,br(e,t,n),wt=r,kn=i,wt!==null&&(kn?(e=wt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):wt.removeChild(n.stateNode));break;case 18:wt!==null&&(kn?(e=wt,n=n.stateNode,e.nodeType===8?Wu(e.parentNode,n):e.nodeType===1&&Wu(e,n),zo(e)):Wu(wt,n.stateNode));break;case 4:r=wt,i=kn,wt=n.stateNode.containerInfo,kn=!0,br(e,t,n),wt=r,kn=i;break;case 0:case 11:case 14:case 15:if(!At&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&av(n,t,o),i=i.next}while(i!==r)}br(e,t,n);break;case 1:if(!At&&(Ji(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){tt(n,t,l)}br(e,t,n);break;case 21:br(e,t,n);break;case 22:n.mode&1?(At=(r=At)||n.memoizedState!==null,br(e,t,n),At=r):br(e,t,n);break;default:br(e,t,n)}}function L0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new L5),t.forEach(function(r){var i=G5.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function _n(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:wt=l.stateNode,kn=!1;break e;case 3:wt=l.stateNode.containerInfo,kn=!0;break e;case 4:wt=l.stateNode.containerInfo,kn=!0;break e}l=l.return}if(wt===null)throw Error(ee(160));AN(s,o,i),wt=null,kn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){tt(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)IN(t,e),t=t.sibling}function IN(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_n(t,e),Ln(e),r&4){try{Co(3,e,e.return),Lc(3,e)}catch(g){tt(e,e.return,g)}try{Co(5,e,e.return)}catch(g){tt(e,e.return,g)}}break;case 1:_n(t,e),Ln(e),r&512&&n!==null&&Ji(n,n.return);break;case 5:if(_n(t,e),Ln(e),r&512&&n!==null&&Ji(n,n.return),e.flags&32){var i=e.stateNode;try{Oo(i,"")}catch(g){tt(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&ek(i,s),Pg(l,o);var d=Pg(l,s);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?sk(i,f):u==="dangerouslySetInnerHTML"?rk(i,f):u==="children"?Oo(i,f):Qv(i,u,f,d)}switch(l){case"input":Tg(i,s);break;case"textarea":tk(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?ss(i,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?ss(i,!!s.multiple,s.defaultValue,!0):ss(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wo]=s}catch(g){tt(e,e.return,g)}}break;case 6:if(_n(t,e),Ln(e),r&4){if(e.stateNode===null)throw Error(ee(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){tt(e,e.return,g)}}break;case 3:if(_n(t,e),Ln(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{zo(t.containerInfo)}catch(g){tt(e,e.return,g)}break;case 4:_n(t,e),Ln(e);break;case 13:_n(t,e),Ln(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Rx=rt())),r&4&&L0(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(At=(d=At)||u,_n(t,e),At=d):_n(t,e),Ln(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(ae=e,u=e.child;u!==null;){for(f=ae=u;ae!==null;){switch(p=ae,h=p.child,p.tag){case 0:case 11:case 14:case 15:Co(4,p,p.return);break;case 1:Ji(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){tt(r,n,g)}}break;case 5:Ji(p,p.return);break;case 22:if(p.memoizedState!==null){z0(f);continue}}h!==null?(h.return=p,ae=h):z0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ik("display",o))}catch(g){tt(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){tt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:_n(t,e),Ln(e),r&4&&L0(e);break;case 21:break;default:_n(t,e),Ln(e)}}function Ln(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(RN(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Oo(i,""),r.flags&=-33);var s=D0(e);uv(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=D0(e);cv(e,l,o);break;default:throw Error(ee(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function z5(e,t,n){ae=e,MN(e)}function MN(e,t,n){for(var r=(e.mode&1)!==0;ae!==null;){var i=ae,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Wa;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||At;l=Wa;var d=At;if(Wa=o,(At=c)&&!d)for(ae=i;ae!==null;)o=ae,c=o.child,o.tag===22&&o.memoizedState!==null?q0(i):c!==null?(c.return=o,ae=c):q0(i);for(;s!==null;)ae=s,MN(s),s=s.sibling;ae=i,Wa=l,At=d}F0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ae=s):F0(e)}}function F0(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:At||Lc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!At)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Sn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&_0(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}_0(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&zo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}At||t.flags&512&&lv(t)}catch(p){tt(t,t.return,p)}}if(t===e){ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,ae=n;break}ae=t.return}}function z0(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ae=n;break}ae=t.return}}function q0(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Lc(4,t)}catch(c){tt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){tt(t,i,c)}}var s=t.return;try{lv(t)}catch(c){tt(t,s,c)}break;case 5:var o=t.return;try{lv(t)}catch(c){tt(t,o,c)}}}catch(c){tt(t,t.return,c)}if(t===e){ae=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ae=l;break}ae=t.return}}var q5=Math.ceil,Zl=vr.ReactCurrentDispatcher,Ex=vr.ReactCurrentOwner,gn=vr.ReactCurrentBatchConfig,Me=0,gt=null,it=null,_t=0,Jt=0,es=Zr(0),ft=0,Xo=null,ji=0,Fc=0,Tx=0,Eo=null,$t=null,Rx=0,ws=1/0,Jn=null,Jl=!1,dv=null,qr=null,Ua=!1,Pr=null,ec=0,To=0,fv=null,kl=-1,Nl=0;function Lt(){return Me&6?rt():kl!==-1?kl:kl=rt()}function $r(e){return e.mode&1?Me&2&&_t!==0?_t&-_t:j5.transition!==null?(Nl===0&&(Nl=vk()),Nl):(e=qe,e!==0||(e=window.event,e=e===void 0?16:Sk(e.type)),e):1}function Rn(e,t,n,r){if(50<To)throw To=0,fv=null,Error(ee(185));pa(e,n,r),(!(Me&2)||e!==gt)&&(e===gt&&(!(Me&2)&&(Fc|=n),ft===4&&Tr(e,_t)),Gt(e,r),n===1&&Me===0&&!(t.mode&1)&&(ws=rt()+500,Pc&&Jr()))}function Gt(e,t){var n=e.callbackNode;jA(e,t);var r=Ll(e,e===gt?_t:0);if(r===0)n!==null&&Yy(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Yy(n),t===1)e.tag===0?_5($0.bind(null,e)):Hk($0.bind(null,e)),x5(function(){!(Me&6)&&Jr()}),n=null;else{switch(xk(r)){case 1:n=nx;break;case 4:n=mk;break;case 16:n=Dl;break;case 536870912:n=gk;break;default:n=Dl}n=$N(n,PN.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function PN(e,t){if(kl=-1,Nl=0,Me&6)throw Error(ee(327));var n=e.callbackNode;if(us()&&e.callbackNode!==n)return null;var r=Ll(e,e===gt?_t:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=tc(e,r);else{t=r;var i=Me;Me|=2;var s=DN();(gt!==e||_t!==t)&&(Jn=null,ws=rt()+500,mi(e,t));do try{H5();break}catch(l){ON(e,l)}while(!0);mx(),Zl.current=s,Me=i,it!==null?t=0:(gt=null,_t=0,t=ft)}if(t!==0){if(t===2&&(i=zg(e),i!==0&&(r=i,t=pv(e,i))),t===1)throw n=Xo,mi(e,0),Tr(e,r),Gt(e,rt()),n;if(t===6)Tr(e,r);else{if(i=e.current.alternate,!(r&30)&&!$5(i)&&(t=tc(e,r),t===2&&(s=zg(e),s!==0&&(r=s,t=pv(e,s))),t===1))throw n=Xo,mi(e,0),Tr(e,r),Gt(e,rt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ee(345));case 2:ai(e,$t,Jn);break;case 3:if(Tr(e,r),(r&130023424)===r&&(t=Rx+500-rt(),10<t)){if(Ll(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Lt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Gg(ai.bind(null,e,$t,Jn),t);break}ai(e,$t,Jn);break;case 4:if(Tr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Tn(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*q5(r/1960))-r,10<r){e.timeoutHandle=Gg(ai.bind(null,e,$t,Jn),r);break}ai(e,$t,Jn);break;case 5:ai(e,$t,Jn);break;default:throw Error(ee(329))}}}return Gt(e,rt()),e.callbackNode===n?PN.bind(null,e):null}function pv(e,t){var n=Eo;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=tc(e,t),e!==2&&(t=$t,$t=n,t!==null&&hv(t)),e}function hv(e){$t===null?$t=e:$t.push.apply($t,e)}function $5(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!An(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tr(e,t){for(t&=~Tx,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Tn(t),r=1<<n;e[n]=-1,t&=~r}}function $0(e){if(Me&6)throw Error(ee(327));us();var t=Ll(e,0);if(!(t&1))return Gt(e,rt()),null;var n=tc(e,t);if(e.tag!==0&&n===2){var r=zg(e);r!==0&&(t=r,n=pv(e,r))}if(n===1)throw n=Xo,mi(e,0),Tr(e,t),Gt(e,rt()),n;if(n===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ai(e,$t,Jn),Gt(e,rt()),null}function Ax(e,t){var n=Me;Me|=1;try{return e(t)}finally{Me=n,Me===0&&(ws=rt()+500,Pc&&Jr())}}function Si(e){Pr!==null&&Pr.tag===0&&!(Me&6)&&us();var t=Me;Me|=1;var n=gn.transition,r=qe;try{if(gn.transition=null,qe=1,e)return e()}finally{qe=r,gn.transition=n,Me=t,!(Me&6)&&Jr()}}function Ix(){Jt=es.current,Ve(es)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,v5(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(fx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Bl();break;case 3:ys(),Ve(Ut),Ve(It),wx();break;case 5:bx(r);break;case 4:ys();break;case 13:Ve(Ze);break;case 19:Ve(Ze);break;case 10:gx(r.type._context);break;case 22:case 23:Ix()}n=n.return}if(gt=e,it=e=Br(e.current,null),_t=Jt=t,ft=0,Xo=null,Tx=Fc=ji=0,$t=Eo=null,ui!==null){for(t=0;t<ui.length;t++)if(n=ui[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ui=null}return e}function ON(e,t){do{var n=it;try{if(mx(),_l.current=Ql,Xl){for(var r=Je.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xl=!1}if(_i=0,ht=ct=Je=null,No=!1,Go=0,Ex.current=null,n===null||n.return===null){ft=1,Xo=t,it=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=_t,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=E0(o);if(h!==null){h.flags&=-257,T0(h,o,l,s,t),h.mode&1&&C0(s,d,t),t=h,c=d;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){C0(s,d,t),Mx();break e}c=Error(ee(426))}}else if(Ke&&l.mode&1){var w=E0(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),T0(w,o,l,s,t),px(bs(c,l));break e}}s=c=bs(c,l),ft!==4&&(ft=2),Eo===null?Eo=[s]:Eo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=xN(s,c,t);w0(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qr===null||!qr.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=yN(s,l,t);w0(s,_);break e}}s=s.return}while(s!==null)}FN(n)}catch(j){t=j,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function DN(){var e=Zl.current;return Zl.current=Ql,e===null?Ql:e}function Mx(){(ft===0||ft===3||ft===2)&&(ft=4),gt===null||!(ji&268435455)&&!(Fc&268435455)||Tr(gt,_t)}function tc(e,t){var n=Me;Me|=2;var r=DN();(gt!==e||_t!==t)&&(Jn=null,mi(e,t));do try{B5();break}catch(i){ON(e,i)}while(!0);if(mx(),Me=n,Zl.current=r,it!==null)throw Error(ee(261));return gt=null,_t=0,ft}function B5(){for(;it!==null;)LN(it)}function H5(){for(;it!==null&&!hA();)LN(it)}function LN(e){var t=qN(e.alternate,e,Jt);e.memoizedProps=e.pendingProps,t===null?FN(e):it=t,Ex.current=null}function FN(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=D5(n,t),n!==null){n.flags&=32767,it=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ft=6,it=null;return}}else if(n=O5(n,t,Jt),n!==null){it=n;return}if(t=t.sibling,t!==null){it=t;return}it=t=e}while(t!==null);ft===0&&(ft=5)}function ai(e,t,n){var r=qe,i=gn.transition;try{gn.transition=null,qe=1,W5(e,t,n,r)}finally{gn.transition=i,qe=r}return null}function W5(e,t,n,r){do us();while(Pr!==null);if(Me&6)throw Error(ee(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(SA(e,s),e===gt&&(it=gt=null,_t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ua||(Ua=!0,$N(Dl,function(){return us(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=gn.transition,gn.transition=null;var o=qe;qe=1;var l=Me;Me|=4,Ex.current=null,F5(e,n),IN(n,e),u5(Ug),Fl=!!Wg,Ug=Wg=null,e.current=n,z5(n),mA(),Me=l,qe=o,gn.transition=s}else e.current=n;if(Ua&&(Ua=!1,Pr=e,ec=i),s=e.pendingLanes,s===0&&(qr=null),xA(n.stateNode),Gt(e,rt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Jl)throw Jl=!1,e=dv,dv=null,e;return ec&1&&e.tag!==0&&us(),s=e.pendingLanes,s&1?e===fv?To++:(To=0,fv=e):To=0,Jr(),null}function us(){if(Pr!==null){var e=xk(ec),t=gn.transition,n=qe;try{if(gn.transition=null,qe=16>e?16:e,Pr===null)var r=!1;else{if(e=Pr,Pr=null,ec=0,Me&6)throw Error(ee(331));var i=Me;for(Me|=4,ae=e.current;ae!==null;){var s=ae,o=s.child;if(ae.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ae=d;ae!==null;){var u=ae;switch(u.tag){case 0:case 11:case 15:Co(8,u,s)}var f=u.child;if(f!==null)f.return=u,ae=f;else for(;ae!==null;){u=ae;var p=u.sibling,h=u.return;if(TN(u),u===d){ae=null;break}if(p!==null){p.return=h,ae=p;break}ae=h}}}var x=s.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}ae=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ae=o;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Co(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ae=v;break e}ae=s.return}}var y=e.current;for(ae=y;ae!==null;){o=ae;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ae=b;else e:for(o=y;ae!==null;){if(l=ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Lc(9,l)}}catch(j){tt(l,l.return,j)}if(l===o){ae=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,ae=_;break e}ae=l.return}}if(Me=i,Jr(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Tc,e)}catch{}r=!0}return r}finally{qe=n,gn.transition=t}}return!1}function B0(e,t,n){t=bs(n,t),t=xN(e,t,1),e=zr(e,t,1),t=Lt(),e!==null&&(pa(e,1,t),Gt(e,t))}function tt(e,t,n){if(e.tag===3)B0(e,e,n);else for(;t!==null;){if(t.tag===3){B0(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qr===null||!qr.has(r))){e=bs(n,e),e=yN(t,e,1),t=zr(t,e,1),e=Lt(),t!==null&&(pa(t,1,e),Gt(t,e));break}}t=t.return}}function U5(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Lt(),e.pingedLanes|=e.suspendedLanes&n,gt===e&&(_t&n)===n&&(ft===4||ft===3&&(_t&130023424)===_t&&500>rt()-Rx?mi(e,0):Tx|=n),Gt(e,t)}function zN(e,t){t===0&&(e.mode&1?(t=Oa,Oa<<=1,!(Oa&130023424)&&(Oa=4194304)):t=1);var n=Lt();e=dr(e,t),e!==null&&(pa(e,t,n),Gt(e,n))}function V5(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),zN(e,n)}function G5(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(t),zN(e,n)}var qN;qN=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ut.current)Bt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Bt=!1,P5(e,t,n);Bt=!!(e.flags&131072)}else Bt=!1,Ke&&t.flags&1048576&&Wk(t,Ul,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Sl(e,t),e=t.pendingProps;var i=gs(t,It.current);cs(t,n),i=jx(null,t,r,e,i,n);var s=Sx();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vt(r)?(s=!0,Hl(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,xx(t),i.updater=Dc,t.stateNode=i,i._reactInternals=t,ev(t,r,e,n),t=rv(null,t,r,!0,s,n)):(t.tag=0,Ke&&s&&dx(t),Ot(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Sl(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Y5(r),e=Sn(r,e),i){case 0:t=nv(null,t,r,e,n);break e;case 1:t=I0(null,t,r,e,n);break e;case 11:t=R0(null,t,r,e,n);break e;case 14:t=A0(null,t,r,Sn(r.type,e),n);break e}throw Error(ee(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),nv(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),I0(e,t,r,i,n);case 3:e:{if(jN(t),e===null)throw Error(ee(387));r=t.pendingProps,s=t.memoizedState,i=s.element,Xk(e,t),Kl(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=bs(Error(ee(423)),t),t=M0(e,t,r,n,i);break e}else if(r!==i){i=bs(Error(ee(424)),t),t=M0(e,t,r,n,i);break e}else for(tn=Fr(t.stateNode.containerInfo.firstChild),nn=t,Ke=!0,Cn=null,n=Kk(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vs(),r===i){t=fr(e,t,n);break e}Ot(e,t,r,n)}t=t.child}return t;case 5:return Qk(t),e===null&&Qg(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Vg(r,i)?o=null:s!==null&&Vg(r,s)&&(t.flags|=32),_N(e,t),Ot(e,t,o,n),t.child;case 6:return e===null&&Qg(t),null;case 13:return SN(e,t,n);case 4:return yx(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=xs(t,null,r,n):Ot(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),R0(e,t,r,i,n);case 7:return Ot(e,t,t.pendingProps,n),t.child;case 8:return Ot(e,t,t.pendingProps.children,n),t.child;case 12:return Ot(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,We(Vl,r._currentValue),r._currentValue=o,s!==null)if(An(s.value,o)){if(s.children===i.children&&!Ut.current){t=fr(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=ar(-1,n&-n),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Zg(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Zg(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ot(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,cs(t,n),i=vn(i),r=r(i),t.flags|=1,Ot(e,t,r,n),t.child;case 14:return r=t.type,i=Sn(r,t.pendingProps),i=Sn(r.type,i),A0(e,t,r,i,n);case 15:return bN(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Sn(r,i),Sl(e,t),t.tag=1,Vt(r)?(e=!0,Hl(t)):e=!1,cs(t,n),vN(t,r,i),ev(t,r,i,n),rv(null,t,r,!0,e,n);case 19:return kN(e,t,n);case 22:return wN(e,t,n)}throw Error(ee(156,t.tag))};function $N(e,t){return hk(e,t)}function K5(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(e,t,n,r){return new K5(e,t,n,r)}function Px(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Y5(e){if(typeof e=="function")return Px(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Jv)return 11;if(e===ex)return 14}return 2}function Br(e,t){var n=e.alternate;return n===null?(n=hn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Cl(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")Px(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Wi:return gi(n.children,i,s,t);case Zv:o=8,i|=8;break;case Sg:return e=hn(12,n,t,i|2),e.elementType=Sg,e.lanes=s,e;case kg:return e=hn(13,n,t,i),e.elementType=kg,e.lanes=s,e;case Ng:return e=hn(19,n,t,i),e.elementType=Ng,e.lanes=s,e;case QS:return zc(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case YS:o=10;break e;case XS:o=9;break e;case Jv:o=11;break e;case ex:o=14;break e;case jr:o=16,r=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=hn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function gi(e,t,n,r){return e=hn(7,e,r,t),e.lanes=n,e}function zc(e,t,n,r){return e=hn(22,e,r,t),e.elementType=QS,e.lanes=n,e.stateNode={isHidden:!1},e}function Zu(e,t,n){return e=hn(6,e,null,t),e.lanes=n,e}function Ju(e,t,n){return t=hn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function X5(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mu(0),this.expirationTimes=Mu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ox(e,t,n,r,i,s,o,l,c){return e=new X5(e,t,n,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=hn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xx(s),e}function Q5(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function BN(e){if(!e)return Kr;e=e._reactInternals;e:{if(Ei(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var n=e.type;if(Vt(n))return Bk(e,n,t)}return t}function HN(e,t,n,r,i,s,o,l,c){return e=Ox(n,r,!0,e,i,s,o,l,c),e.context=BN(null),n=e.current,r=Lt(),i=$r(n),s=ar(r,i),s.callback=t??null,zr(n,s,i),e.current.lanes=i,pa(e,i,r),Gt(e,r),e}function qc(e,t,n,r){var i=t.current,s=Lt(),o=$r(i);return n=BN(n),t.context===null?t.context=n:t.pendingContext=n,t=ar(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=zr(i,t,o),e!==null&&(Rn(e,i,o,s),wl(e,i,o)),o}function nc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function H0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Dx(e,t){H0(e,t),(e=e.alternate)&&H0(e,t)}function Z5(){return null}var WN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lx(e){this._internalRoot=e}$c.prototype.render=Lx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));qc(e,t,null,null)};$c.prototype.unmount=Lx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Si(function(){qc(null,e,null,null)}),t[ur]=null}};function $c(e){this._internalRoot=e}$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=wk();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Er.length&&t!==0&&t<Er[n].priority;n++);Er.splice(n,0,e),n===0&&jk(e)}};function Fx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function W0(){}function J5(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=nc(o);s.call(d)}}var o=HN(t,r,e,0,null,!1,!1,"",W0);return e._reactRootContainer=o,e[ur]=o.current,Bo(e.nodeType===8?e.parentNode:e),Si(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=nc(c);l.call(d)}}var c=Ox(e,0,!1,null,null,!1,!1,"",W0);return e._reactRootContainer=c,e[ur]=c.current,Bo(e.nodeType===8?e.parentNode:e),Si(function(){qc(t,c,n,r)}),c}function Hc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=nc(o);l.call(c)}}qc(t,o,e,i)}else o=J5(n,t,e,i,r);return nc(o)}yk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=co(t.pendingLanes);n!==0&&(rx(t,n|1),Gt(t,rt()),!(Me&6)&&(ws=rt()+500,Jr()))}break;case 13:Si(function(){var r=dr(e,1);if(r!==null){var i=Lt();Rn(r,e,1,i)}}),Dx(e,1)}};ix=function(e){if(e.tag===13){var t=dr(e,134217728);if(t!==null){var n=Lt();Rn(t,e,134217728,n)}Dx(e,134217728)}};bk=function(e){if(e.tag===13){var t=$r(e),n=dr(e,t);if(n!==null){var r=Lt();Rn(n,e,t,r)}Dx(e,t)}};wk=function(){return qe};_k=function(e,t){var n=qe;try{return qe=e,t()}finally{qe=n}};Dg=function(e,t,n){switch(t){case"input":if(Tg(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Mc(r);if(!i)throw Error(ee(90));JS(r),Tg(r,i)}}}break;case"textarea":tk(e,n);break;case"select":t=n.value,t!=null&&ss(e,!!n.multiple,t,!1)}};lk=Ax;ck=Si;var e3={usingClientEntryPoint:!1,Events:[ma,Ki,Mc,ok,ak,Ax]},Ks={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t3={bundleType:Ks.bundleType,version:Ks.version,rendererPackageName:Ks.rendererPackageName,rendererConfig:Ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fk(e),e===null?null:e.stateNode},findFiberByHostInstance:Ks.findFiberByHostInstance||Z5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Va=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Va.isDisabled&&Va.supportsFiber)try{Tc=Va.inject(t3),Bn=Va}catch{}}on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e3;on.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fx(t))throw Error(ee(200));return Q5(e,t,null,n)};on.createRoot=function(e,t){if(!Fx(e))throw Error(ee(299));var n=!1,r="",i=WN;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Ox(e,1,!1,null,null,n,!1,r,i),e[ur]=t.current,Bo(e.nodeType===8?e.parentNode:e),new Lx(t)};on.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=fk(t),e=e===null?null:e.stateNode,e};on.flushSync=function(e){return Si(e)};on.hydrate=function(e,t,n){if(!Bc(t))throw Error(ee(200));return Hc(null,e,t,!0,n)};on.hydrateRoot=function(e,t,n){if(!Fx(e))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=WN;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=HN(t,null,e,1,n??null,i,!1,s,o),e[ur]=t.current,Bo(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new $c(t)};on.render=function(e,t,n){if(!Bc(t))throw Error(ee(200));return Hc(null,e,t,!1,n)};on.unmountComponentAtNode=function(e){if(!Bc(e))throw Error(ee(40));return e._reactRootContainer?(Si(function(){Hc(null,null,e,!1,function(){e._reactRootContainer=null,e[ur]=null})}),!0):!1};on.unstable_batchedUpdates=Ax;on.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Bc(n))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return Hc(e,t,n,!1,r)};on.version="18.3.1-next-f1338f8080-20240426";function UN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UN)}catch(e){console.error(e)}}UN(),US.exports=on;var ts=US.exports,U0=ts;_g.createRoot=U0.createRoot,_g.hydrateRoot=U0.hydrateRoot;function Yt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Yt(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var VN={exports:{}},GN={},KN={exports:{}},YN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _s=m;function n3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var r3=typeof Object.is=="function"?Object.is:n3,i3=_s.useState,s3=_s.useEffect,o3=_s.useLayoutEffect,a3=_s.useDebugValue;function l3(e,t){var n=t(),r=i3({inst:{value:n,getSnapshot:t}}),i=r[0].inst,s=r[1];return o3(function(){i.value=n,i.getSnapshot=t,ed(i)&&s({inst:i})},[e,n,t]),s3(function(){return ed(i)&&s({inst:i}),e(function(){ed(i)&&s({inst:i})})},[e]),a3(n),n}function ed(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r3(e,n)}catch{return!0}}function c3(e,t){return t()}var u3=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c3:l3;YN.useSyncExternalStore=_s.useSyncExternalStore!==void 0?_s.useSyncExternalStore:u3;KN.exports=YN;var d3=KN.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wc=m,f3=d3;function p3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var h3=typeof Object.is=="function"?Object.is:p3,m3=f3.useSyncExternalStore,g3=Wc.useRef,v3=Wc.useEffect,x3=Wc.useMemo,y3=Wc.useDebugValue;GN.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var s=g3(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=x3(function(){function c(h){if(!d){if(d=!0,u=h,h=r(h),i!==void 0&&o.hasValue){var x=o.value;if(i(x,h))return f=x}return f=h}if(x=f,h3(u,h))return x;var g=r(h);return i!==void 0&&i(x,g)?(u=h,x):(u=h,f=g)}var d=!1,u,f,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,i]);var l=m3(e,s[0],s[1]);return v3(function(){o.hasValue=!0,o.value=l},[l]),y3(l),l};VN.exports=GN;var b3=VN.exports;const w3=Wv(b3),_3={},V0=e=>{let t;const n=new Set,r=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(x=>x(t,h))}},i=()=>t,c={setState:r,getState:i,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(_3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,i,c);return c},j3=e=>e?V0(e):V0,{useDebugValue:S3}=V,{useSyncExternalStoreWithSelector:k3}=w3,N3=e=>e;function XN(e,t=N3,n){const r=k3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return S3(r),r}const G0=(e,t)=>{const n=j3(e),r=(i,s=t)=>XN(n,i,s);return Object.assign(r,n),r},C3=(e,t)=>e?G0(e,t):G0;function Mt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var E3={value:()=>{}};function Uc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new El(n)}function El(e){this._=e}function T3(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}El.prototype=Uc.prototype={constructor:El,on:function(e,t){var n=this._,r=T3(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=R3(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=K0(n[i],e.name,t);else if(t==null)for(i in n)n[i]=K0(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new El(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function R3(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function K0(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=E3,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var mv="http://www.w3.org/1999/xhtml";const Y0={svg:"http://www.w3.org/2000/svg",xhtml:mv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Y0.hasOwnProperty(t)?{space:Y0[t],local:e}:e}function A3(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===mv&&t.documentElement.namespaceURI===mv?t.createElement(e):t.createElementNS(n,e)}}function I3(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function QN(e){var t=Vc(e);return(t.local?I3:A3)(t)}function M3(){}function zx(e){return e==null?M3:function(){return this.querySelector(e)}}function P3(e){typeof e!="function"&&(e=zx(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,l=r[i]=new Array(o),c,d,u=0;u<o;++u)(c=s[u])&&(d=e.call(c,c.__data__,u,s))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new sn(r,this._parents)}function O3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function D3(){return[]}function ZN(e){return e==null?D3:function(){return this.querySelectorAll(e)}}function L3(e){return function(){return O3(e.apply(this,arguments))}}function F3(e){typeof e=="function"?e=L3(e):e=ZN(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&(r.push(e.call(c,c.__data__,d,o)),i.push(c));return new sn(r,i)}function JN(e){return function(){return this.matches(e)}}function eC(e){return function(t){return t.matches(e)}}var z3=Array.prototype.find;function q3(e){return function(){return z3.call(this.children,e)}}function $3(){return this.firstElementChild}function B3(e){return this.select(e==null?$3:q3(typeof e=="function"?e:eC(e)))}var H3=Array.prototype.filter;function W3(){return Array.from(this.children)}function U3(e){return function(){return H3.call(this.children,e)}}function V3(e){return this.selectAll(e==null?W3:U3(typeof e=="function"?e:eC(e)))}function G3(e){typeof e!="function"&&(e=JN(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,l=r[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new sn(r,this._parents)}function tC(e){return new Array(e.length)}function K3(){return new sn(this._enter||this._groups.map(tC),this._parents)}function rc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rc.prototype={constructor:rc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Y3(e){return function(){return e}}function X3(e,t,n,r,i,s){for(var o=0,l,c=t.length,d=s.length;o<d;++o)(l=t[o])?(l.__data__=s[o],r[o]=l):n[o]=new rc(e,s[o]);for(;o<c;++o)(l=t[o])&&(i[o]=l)}function Q3(e,t,n,r,i,s,o){var l,c,d=new Map,u=t.length,f=s.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=o.call(c,c.__data__,l,t)+"",d.has(h)?i[l]=c:d.set(h,c));for(l=0;l<f;++l)h=o.call(e,s[l],l,s)+"",(c=d.get(h))?(r[l]=c,c.__data__=s[l],d.delete(h)):n[l]=new rc(e,s[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(i[l]=c)}function Z3(e){return e.__data__}function J3(e,t){if(!arguments.length)return Array.from(this,Z3);var n=t?Q3:X3,r=this._parents,i=this._groups;typeof e!="function"&&(e=Y3(e));for(var s=i.length,o=new Array(s),l=new Array(s),c=new Array(s),d=0;d<s;++d){var u=r[d],f=i[d],p=f.length,h=eI(e.call(u,u&&u.__data__,d,r)),x=h.length,g=l[d]=new Array(x),w=o[d]=new Array(x),v=c[d]=new Array(p);n(u,f,g,w,v,h,t);for(var y=0,b=0,_,j;y<x;++y)if(_=g[y]){for(y>=b&&(b=y+1);!(j=w[b])&&++b<x;);_._next=j||null}}return o=new sn(o,r),o._enter=l,o._exit=c,o}function eI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tI(){return new sn(this._exit||this._groups.map(tC),this._parents)}function nI(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function rI(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),l=new Array(i),c=0;c<o;++c)for(var d=n[c],u=r[c],f=d.length,p=l[c]=new Array(f),h,x=0;x<f;++x)(h=d[x]||u[x])&&(p[x]=h);for(;c<i;++c)l[c]=n[c];return new sn(l,this._parents)}function iI(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function sI(e){e||(e=oI);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],l=o.length,c=i[s]=new Array(l),d,u=0;u<l;++u)(d=o[u])&&(c[u]=d);c.sort(t)}return new sn(i,this._parents).order()}function oI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function aI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function lI(){return Array.from(this)}function cI(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function uI(){let e=0;for(const t of this)++e;return e}function dI(){return!this.node()}function fI(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,l;s<o;++s)(l=i[s])&&e.call(l,l.__data__,s,i);return this}function pI(e){return function(){this.removeAttribute(e)}}function hI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function mI(e,t){return function(){this.setAttribute(e,t)}}function gI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function vI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function xI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function yI(e,t){var n=Vc(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?hI:pI:typeof t=="function"?n.local?xI:vI:n.local?gI:mI)(n,t))}function nC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function bI(e){return function(){this.style.removeProperty(e)}}function wI(e,t,n){return function(){this.style.setProperty(e,t,n)}}function _I(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function jI(e,t,n){return arguments.length>1?this.each((t==null?bI:typeof t=="function"?_I:wI)(e,t,n??"")):js(this.node(),e)}function js(e,t){return e.style.getPropertyValue(t)||nC(e).getComputedStyle(e,null).getPropertyValue(t)}function SI(e){return function(){delete this[e]}}function kI(e,t){return function(){this[e]=t}}function NI(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function CI(e,t){return arguments.length>1?this.each((t==null?SI:typeof t=="function"?NI:kI)(e,t)):this.node()[e]}function rC(e){return e.trim().split(/^|\s+/)}function qx(e){return e.classList||new iC(e)}function iC(e){this._node=e,this._names=rC(e.getAttribute("class")||"")}iC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function sC(e,t){for(var n=qx(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function oC(e,t){for(var n=qx(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function EI(e){return function(){sC(this,e)}}function TI(e){return function(){oC(this,e)}}function RI(e,t){return function(){(t.apply(this,arguments)?sC:oC)(this,e)}}function AI(e,t){var n=rC(e+"");if(arguments.length<2){for(var r=qx(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?RI:t?EI:TI)(n,t))}function II(){this.textContent=""}function MI(e){return function(){this.textContent=e}}function PI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function OI(e){return arguments.length?this.each(e==null?II:(typeof e=="function"?PI:MI)(e)):this.node().textContent}function DI(){this.innerHTML=""}function LI(e){return function(){this.innerHTML=e}}function FI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function zI(e){return arguments.length?this.each(e==null?DI:(typeof e=="function"?FI:LI)(e)):this.node().innerHTML}function qI(){this.nextSibling&&this.parentNode.appendChild(this)}function $I(){return this.each(qI)}function BI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function HI(){return this.each(BI)}function WI(e){var t=typeof e=="function"?e:QN(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function UI(){return null}function VI(e,t){var n=typeof e=="function"?e:QN(e),r=t==null?UI:typeof t=="function"?t:zx(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function GI(){var e=this.parentNode;e&&e.removeChild(this)}function KI(){return this.each(GI)}function YI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function XI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function QI(e){return this.select(e?XI:YI)}function ZI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function JI(e){return function(t){e.call(this,t,this.__data__)}}function eM(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function tM(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function nM(e,t,n){return function(){var r=this.__on,i,s=JI(t);if(r){for(var o=0,l=r.length;o<l;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function rM(e,t,n){var r=eM(e+""),i,s=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(i=0,u=l[c];i<s;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(l=t?nM:tM,i=0;i<s;++i)this.each(l(r[i],t,n));return this}function aC(e,t,n){var r=nC(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function iM(e,t){return function(){return aC(this,e,t)}}function sM(e,t){return function(){return aC(this,e,t.apply(this,arguments))}}function oM(e,t){return this.each((typeof t=="function"?sM:iM)(e,t))}function*aM(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var lC=[null];function sn(e,t){this._groups=e,this._parents=t}function va(){return new sn([[document.documentElement]],lC)}function lM(){return this}sn.prototype=va.prototype={constructor:sn,select:P3,selectAll:F3,selectChild:B3,selectChildren:V3,filter:G3,data:J3,enter:K3,exit:tI,join:nI,merge:rI,selection:lM,order:iI,sort:sI,call:aI,nodes:lI,node:cI,size:uI,empty:dI,each:fI,attr:yI,style:jI,property:CI,classed:AI,text:OI,html:zI,raise:$I,lower:HI,append:WI,insert:VI,remove:KI,clone:QI,datum:ZI,on:rM,dispatch:oM,[Symbol.iterator]:aM};function pn(e){return typeof e=="string"?new sn([[document.querySelector(e)]],[document.documentElement]):new sn([[e]],lC)}function cM(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Nn(e,t){if(e=cM(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const uM={passive:!1},Qo={capture:!0,passive:!1};function td(e){e.stopImmediatePropagation()}function ds(e){e.preventDefault(),e.stopImmediatePropagation()}function cC(e){var t=e.document.documentElement,n=pn(e).on("dragstart.drag",ds,Qo);"onselectstart"in t?n.on("selectstart.drag",ds,Qo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function uC(e,t){var n=e.document.documentElement,r=pn(e).on("dragstart.drag",null);t&&(r.on("click.drag",ds,Qo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ga=e=>()=>e;function gv(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:s,x:o,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}gv.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function dM(e){return!e.ctrlKey&&!e.button}function fM(){return this.parentNode}function pM(e,t){return t??{x:e.x,y:e.y}}function hM(){return navigator.maxTouchPoints||"ontouchstart"in this}function mM(){var e=dM,t=fM,n=pM,r=hM,i={},s=Uc("start","drag","end"),o=0,l,c,d,u,f=0;function p(_){_.on("mousedown.drag",h).filter(r).on("touchstart.drag",w).on("touchmove.drag",v,uM).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(_,j){if(!(u||!e.call(this,_,j))){var k=b(this,t.call(this,_,j),_,j,"mouse");k&&(pn(_.view).on("mousemove.drag",x,Qo).on("mouseup.drag",g,Qo),cC(_.view),td(_),d=!1,l=_.clientX,c=_.clientY,k("start",_))}}function x(_){if(ds(_),!d){var j=_.clientX-l,k=_.clientY-c;d=j*j+k*k>f}i.mouse("drag",_)}function g(_){pn(_.view).on("mousemove.drag mouseup.drag",null),uC(_.view,d),ds(_),i.mouse("end",_)}function w(_,j){if(e.call(this,_,j)){var k=_.changedTouches,N=t.call(this,_,j),E=k.length,S,R;for(S=0;S<E;++S)(R=b(this,N,_,j,k[S].identifier,k[S]))&&(td(_),R("start",_,k[S]))}}function v(_){var j=_.changedTouches,k=j.length,N,E;for(N=0;N<k;++N)(E=i[j[N].identifier])&&(ds(_),E("drag",_,j[N]))}function y(_){var j=_.changedTouches,k=j.length,N,E;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),N=0;N<k;++N)(E=i[j[N].identifier])&&(td(_),E("end",_,j[N]))}function b(_,j,k,N,E,S){var R=s.copy(),T=Nn(S||k,j),M,z,C;if((C=n.call(_,new gv("beforestart",{sourceEvent:k,target:p,identifier:E,active:o,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),N))!=null)return M=C.x-T[0]||0,z=C.y-T[1]||0,function L(P,$,O){var A=T,F;switch(P){case"start":i[E]=L,F=o++;break;case"end":delete i[E],--o;case"drag":T=Nn(O||$,j),F=o;break}R.call(P,_,new gv(P,{sourceEvent:$,subject:C,target:p,identifier:E,active:F,x:T[0]+M,y:T[1]+z,dx:T[0]-A[0],dy:T[1]-A[1],dispatch:R}),N)}}return p.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Ga(!!_),p):e},p.container=function(_){return arguments.length?(t=typeof _=="function"?_:Ga(_),p):t},p.subject=function(_){return arguments.length?(n=typeof _=="function"?_:Ga(_),p):n},p.touchable=function(_){return arguments.length?(r=typeof _=="function"?_:Ga(!!_),p):r},p.on=function(){var _=s.on.apply(s,arguments);return _===s?p:_},p.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,p):Math.sqrt(f)},p}function $x(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function dC(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function xa(){}var Zo=.7,ic=1/Zo,fs="\\s*([+-]?\\d+)\\s*",Jo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gM=/^#([0-9a-f]{3,8})$/,vM=new RegExp(`^rgb\\(${fs},${fs},${fs}\\)$`),xM=new RegExp(`^rgb\\(${Wn},${Wn},${Wn}\\)$`),yM=new RegExp(`^rgba\\(${fs},${fs},${fs},${Jo}\\)$`),bM=new RegExp(`^rgba\\(${Wn},${Wn},${Wn},${Jo}\\)$`),wM=new RegExp(`^hsl\\(${Jo},${Wn},${Wn}\\)$`),_M=new RegExp(`^hsla\\(${Jo},${Wn},${Wn},${Jo}\\)$`),X0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$x(xa,ea,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Q0,formatHex:Q0,formatHex8:jM,formatHsl:SM,formatRgb:Z0,toString:Z0});function Q0(){return this.rgb().formatHex()}function jM(){return this.rgb().formatHex8()}function SM(){return fC(this).formatHsl()}function Z0(){return this.rgb().formatRgb()}function ea(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=gM.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?J0(t):n===3?new Ht(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ka(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ka(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=vM.exec(e))?new Ht(t[1],t[2],t[3],1):(t=xM.exec(e))?new Ht(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yM.exec(e))?Ka(t[1],t[2],t[3],t[4]):(t=bM.exec(e))?Ka(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wM.exec(e))?nb(t[1],t[2]/100,t[3]/100,1):(t=_M.exec(e))?nb(t[1],t[2]/100,t[3]/100,t[4]):X0.hasOwnProperty(e)?J0(X0[e]):e==="transparent"?new Ht(NaN,NaN,NaN,0):null}function J0(e){return new Ht(e>>16&255,e>>8&255,e&255,1)}function Ka(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ht(e,t,n,r)}function kM(e){return e instanceof xa||(e=ea(e)),e?(e=e.rgb(),new Ht(e.r,e.g,e.b,e.opacity)):new Ht}function vv(e,t,n,r){return arguments.length===1?kM(e):new Ht(e,t,n,r??1)}function Ht(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}$x(Ht,vv,dC(xa,{brighter(e){return e=e==null?ic:Math.pow(ic,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zo:Math.pow(Zo,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ht(vi(this.r),vi(this.g),vi(this.b),sc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:eb,formatHex:eb,formatHex8:NM,formatRgb:tb,toString:tb}));function eb(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function NM(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi((isNaN(this.opacity)?1:this.opacity)*255)}`}function tb(){const e=sc(this.opacity);return`${e===1?"rgb(":"rgba("}${vi(this.r)}, ${vi(this.g)}, ${vi(this.b)}${e===1?")":`, ${e})`}`}function sc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fi(e){return e=vi(e),(e<16?"0":"")+e.toString(16)}function nb(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new En(e,t,n,r)}function fC(e){if(e instanceof En)return new En(e.h,e.s,e.l,e.opacity);if(e instanceof xa||(e=ea(e)),!e)return new En;if(e instanceof En)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(n-r)/l+(n<r)*6:n===s?o=(r-t)/l+2:o=(t-n)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new En(o,l,c,e.opacity)}function CM(e,t,n,r){return arguments.length===1?fC(e):new En(e,t,n,r??1)}function En(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}$x(En,CM,dC(xa,{brighter(e){return e=e==null?ic:Math.pow(ic,e),new En(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zo:Math.pow(Zo,e),new En(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Ht(nd(e>=240?e-240:e+120,i,r),nd(e,i,r),nd(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new En(rb(this.h),Ya(this.s),Ya(this.l),sc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sc(this.opacity);return`${e===1?"hsl(":"hsla("}${rb(this.h)}, ${Ya(this.s)*100}%, ${Ya(this.l)*100}%${e===1?")":`, ${e})`}`}}));function rb(e){return e=(e||0)%360,e<0?e+360:e}function Ya(e){return Math.max(0,Math.min(1,e||0))}function nd(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const pC=e=>()=>e;function EM(e,t){return function(n){return e+n*t}}function TM(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function RM(e){return(e=+e)==1?hC:function(t,n){return n-t?TM(t,n,e):pC(isNaN(t)?n:t)}}function hC(e,t){var n=t-e;return n?EM(e,n):pC(isNaN(e)?t:e)}const ib=function e(t){var n=RM(t);function r(i,s){var o=n((i=vv(i)).r,(s=vv(s)).r),l=n(i.g,s.g),c=n(i.b,s.b),d=hC(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=c(u),i.opacity=d(u),i+""}}return r.gamma=e,r}(1);function kr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var xv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rd=new RegExp(xv.source,"g");function AM(e){return function(){return e}}function IM(e){return function(t){return e(t)+""}}function MM(e,t){var n=xv.lastIndex=rd.lastIndex=0,r,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(r=xv.exec(e))&&(i=rd.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(r=r[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:kr(r,i)})),n=rd.lastIndex;return n<t.length&&(s=t.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?IM(c[0].x):AM(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var sb=180/Math.PI,yv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mC(e,t,n,r,i,s){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*sb,skewX:Math.atan(c)*sb,scaleX:o,scaleY:l}}var Xa;function PM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?yv:mC(t.a,t.b,t.c,t.d,t.e,t.f)}function OM(e){return e==null||(Xa||(Xa=document.createElementNS("http://www.w3.org/2000/svg","g")),Xa.setAttribute("transform",e),!(e=Xa.transform.baseVal.consolidate()))?yv:(e=e.matrix,mC(e.a,e.b,e.c,e.d,e.e,e.f))}function gC(e,t,n,r){function i(d){return d.length?d.pop()+" ":""}function s(d,u,f,p,h,x){if(d!==f||u!==p){var g=h.push("translate(",null,t,null,n);x.push({i:g-4,x:kr(d,f)},{i:g-2,x:kr(u,p)})}else(f||p)&&h.push("translate("+f+t+p+n)}function o(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(i(f)+"rotate(",null,r)-2,x:kr(d,u)})):u&&f.push(i(f)+"rotate("+u+r)}function l(d,u,f,p){d!==u?p.push({i:f.push(i(f)+"skewX(",null,r)-2,x:kr(d,u)}):u&&f.push(i(f)+"skewX("+u+r)}function c(d,u,f,p,h,x){if(d!==f||u!==p){var g=h.push(i(h)+"scale(",null,",",null,")");x.push({i:g-4,x:kr(d,f)},{i:g-2,x:kr(u,p)})}else(f!==1||p!==1)&&h.push(i(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),s(d.translateX,d.translateY,u.translateX,u.translateY,f,p),o(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var x=-1,g=p.length,w;++x<g;)f[(w=p[x]).i]=w.x(h);return f.join("")}}}var DM=gC(PM,"px, ","px)","deg)"),LM=gC(OM,", ",")",")"),FM=1e-12;function ob(e){return((e=Math.exp(e))+1/e)/2}function zM(e){return((e=Math.exp(e))-1/e)/2}function qM(e){return((e=Math.exp(2*e))-1)/(e+1)}const $M=function e(t,n,r){function i(s,o){var l=s[0],c=s[1],d=s[2],u=o[0],f=o[1],p=o[2],h=u-l,x=f-c,g=h*h+x*x,w,v;if(g<FM)v=Math.log(p/d)/t,w=function(N){return[l+N*h,c+N*x,d*Math.exp(t*N*v)]};else{var y=Math.sqrt(g),b=(p*p-d*d+r*g)/(2*d*n*y),_=(p*p-d*d-r*g)/(2*p*n*y),j=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(_*_+1)-_);v=(k-j)/t,w=function(N){var E=N*v,S=ob(j),R=d/(n*y)*(S*qM(t*E+j)-zM(j));return[l+R*h,c+R*x,d*S/ob(t*E+j)]}}return w.duration=v*1e3*t/Math.SQRT2,w}return i.rho=function(s){var o=Math.max(.001,+s),l=o*o,c=l*l;return e(o,l,c)},i}(Math.SQRT2,2,4);var Ss=0,fo=0,Ys=0,vC=1e3,oc,po,ac=0,ki=0,Gc=0,ta=typeof performance=="object"&&performance.now?performance:Date,xC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Bx(){return ki||(xC(BM),ki=ta.now()+Gc)}function BM(){ki=0}function lc(){this._call=this._time=this._next=null}lc.prototype=yC.prototype={constructor:lc,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Bx():+n)+(t==null?0:+t),!this._next&&po!==this&&(po?po._next=this:oc=this,po=this),this._call=e,this._time=n,bv()},stop:function(){this._call&&(this._call=null,this._time=1/0,bv())}};function yC(e,t,n){var r=new lc;return r.restart(e,t,n),r}function HM(){Bx(),++Ss;for(var e=oc,t;e;)(t=ki-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ss}function ab(){ki=(ac=ta.now())+Gc,Ss=fo=0;try{HM()}finally{Ss=0,UM(),ki=0}}function WM(){var e=ta.now(),t=e-ac;t>vC&&(Gc-=t,ac=e)}function UM(){for(var e,t=oc,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:oc=n);po=e,bv(r)}function bv(e){if(!Ss){fo&&(fo=clearTimeout(fo));var t=e-ki;t>24?(e<1/0&&(fo=setTimeout(ab,e-ta.now()-Gc)),Ys&&(Ys=clearInterval(Ys))):(Ys||(ac=ta.now(),Ys=setInterval(WM,vC)),Ss=1,xC(ab))}}function lb(e,t,n){var r=new lc;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var VM=Uc("start","end","cancel","interrupt"),GM=[],bC=0,cb=1,wv=2,Tl=3,ub=4,_v=5,Rl=6;function Kc(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;KM(e,n,{name:t,index:r,group:i,on:VM,tween:GM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:bC})}function Hx(e,t){var n=Mn(e,t);if(n.state>bC)throw new Error("too late; already scheduled");return n}function Kn(e,t){var n=Mn(e,t);if(n.state>Tl)throw new Error("too late; already running");return n}function Mn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function KM(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=yC(s,0,n.time);function s(d){n.state=cb,n.timer.restart(o,n.delay,n.time),n.delay<=d&&o(d-n.delay)}function o(d){var u,f,p,h;if(n.state!==cb)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Tl)return lb(o);h.state===ub?(h.state=Rl,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Rl,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(lb(function(){n.state===Tl&&(n.state=ub,n.timer.restart(l,n.delay,n.time),l(d))}),n.state=wv,n.on.call("start",e,e.__data__,n.index,n.group),n.state===wv){for(n.state=Tl,i=new Array(p=n.tween.length),u=0,f=-1;u<p;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=h);i.length=f+1}}function l(d){for(var u=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(c),n.state=_v,1),f=-1,p=i.length;++f<p;)i[f].call(e,u);n.state===_v&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Rl,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function Al(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>wv&&r.state<_v,r.state=Rl,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function YM(e){return this.each(function(){Al(this,e)})}function XM(e,t){var n,r;return function(){var i=Kn(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,l=r.length;o<l;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function QM(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Kn(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var l={name:t,value:n},c=0,d=i.length;c<d;++c)if(i[c].name===t){i[c]=l;break}c===d&&i.push(l)}s.tween=i}}function ZM(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Mn(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?XM:QM)(n,e,t))}function Wx(e,t,n){var r=e._id;return e.each(function(){var i=Kn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Mn(i,r).value[t]}}function wC(e,t){var n;return(typeof t=="number"?kr:t instanceof ea?ib:(n=ea(t))?(t=n,ib):MM)(e,t)}function JM(e){return function(){this.removeAttribute(e)}}function eP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tP(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function nP(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function rP(e,t,n){var r,i,s;return function(){var o,l=n(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,l)))}}function iP(e,t,n){var r,i,s;return function(){var o,l=n(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,l)))}}function sP(e,t){var n=Vc(e),r=n==="transform"?LM:wC;return this.attrTween(e,typeof t=="function"?(n.local?iP:rP)(n,r,Wx(this,"attr."+e,t)):t==null?(n.local?eP:JM)(n):(n.local?nP:tP)(n,r,t))}function oP(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function aP(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function lP(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&aP(e,s)),n}return i._value=t,i}function cP(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&oP(e,s)),n}return i._value=t,i}function uP(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Vc(e);return this.tween(n,(r.local?lP:cP)(r,t))}function dP(e,t){return function(){Hx(this,e).delay=+t.apply(this,arguments)}}function fP(e,t){return t=+t,function(){Hx(this,e).delay=t}}function pP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dP:fP)(t,e)):Mn(this.node(),t).delay}function hP(e,t){return function(){Kn(this,e).duration=+t.apply(this,arguments)}}function mP(e,t){return t=+t,function(){Kn(this,e).duration=t}}function gP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hP:mP)(t,e)):Mn(this.node(),t).duration}function vP(e,t){if(typeof t!="function")throw new Error;return function(){Kn(this,e).ease=t}}function xP(e){var t=this._id;return arguments.length?this.each(vP(t,e)):Mn(this.node(),t).ease}function yP(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Kn(this,e).ease=n}}function bP(e){if(typeof e!="function")throw new Error;return this.each(yP(this._id,e))}function wP(e){typeof e!="function"&&(e=JN(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,l=r[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new pr(r,this._parents,this._name,this._id)}function _P(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),l=0;l<s;++l)for(var c=t[l],d=n[l],u=c.length,f=o[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<r;++l)o[l]=t[l];return new pr(o,this._parents,this._name,this._id)}function jP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function SP(e,t,n){var r,i,s=jP(t)?Hx:Kn;return function(){var o=s(this,e),l=o.on;l!==r&&(i=(r=l).copy()).on(t,n),o.on=i}}function kP(e,t){var n=this._id;return arguments.length<2?Mn(this.node(),n).on.on(e):this.each(SP(n,e,t))}function NP(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function CP(){return this.on("end.remove",NP(this._id))}function EP(e){var t=this._name,n=this._id;typeof e!="function"&&(e=zx(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var l=r[o],c=l.length,d=s[o]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,Kc(d[p],t,n,p,d,Mn(u,n)));return new pr(s,this._parents,t,n)}function TP(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ZN(e));for(var r=this._groups,i=r.length,s=[],o=[],l=0;l<i;++l)for(var c=r[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,x=Mn(u,n),g=0,w=p.length;g<w;++g)(h=p[g])&&Kc(h,t,n,g,p,x);s.push(p),o.push(u)}return new pr(s,o,t,n)}var RP=va.prototype.constructor;function AP(){return new RP(this._groups,this._parents)}function IP(e,t){var n,r,i;return function(){var s=js(this,e),o=(this.style.removeProperty(e),js(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function _C(e){return function(){this.style.removeProperty(e)}}function MP(e,t,n){var r,i=n+"",s;return function(){var o=js(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function PP(e,t,n){var r,i,s;return function(){var o=js(this,e),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),js(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,l))}}function OP(e,t){var n,r,i,s="style."+t,o="end."+s,l;return function(){var c=Kn(this,e),d=c.on,u=c.value[s]==null?l||(l=_C(t)):void 0;(d!==n||i!==u)&&(r=(n=d).copy()).on(o,i=u),c.on=r}}function DP(e,t,n){var r=(e+="")=="transform"?DM:wC;return t==null?this.styleTween(e,IP(e,r)).on("end.style."+e,_C(e)):typeof t=="function"?this.styleTween(e,PP(e,r,Wx(this,"style."+e,t))).each(OP(this._id,e)):this.styleTween(e,MP(e,r,t),n).on("end.style."+e,null)}function LP(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function FP(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&LP(e,o,n)),r}return s._value=t,s}function zP(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,FP(e,t,n??""))}function qP(e){return function(){this.textContent=e}}function $P(e){return function(){var t=e(this);this.textContent=t??""}}function BP(e){return this.tween("text",typeof e=="function"?$P(Wx(this,"text",e)):qP(e==null?"":e+""))}function HP(e){return function(t){this.textContent=e.call(this,t)}}function WP(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&HP(i)),t}return r._value=e,r}function UP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,WP(e))}function VP(){for(var e=this._name,t=this._id,n=jC(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,c,d=0;d<l;++d)if(c=o[d]){var u=Mn(c,t);Kc(c,e,n,d,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new pr(r,this._parents,e,n)}function GP(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var l={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var d=Kn(this,r),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),i===0&&s()})}var KP=0;function pr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function jC(){return++KP}var Xn=va.prototype;pr.prototype={constructor:pr,select:EP,selectAll:TP,selectChild:Xn.selectChild,selectChildren:Xn.selectChildren,filter:wP,merge:_P,selection:AP,transition:VP,call:Xn.call,nodes:Xn.nodes,node:Xn.node,size:Xn.size,empty:Xn.empty,each:Xn.each,on:kP,attr:sP,attrTween:uP,style:DP,styleTween:zP,text:BP,textTween:UP,remove:CP,tween:ZM,delay:pP,duration:gP,ease:xP,easeVarying:bP,end:GP,[Symbol.iterator]:Xn[Symbol.iterator]};function YP(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var XP={time:null,delay:0,duration:250,ease:YP};function QP(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function ZP(e){var t,n;e instanceof pr?(t=e._id,e=e._name):(t=jC(),(n=XP).time=Bx(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&Kc(c,e,t,d,o,n||QP(c,t));return new pr(r,this._parents,e,t)}va.prototype.interrupt=YM;va.prototype.transition=ZP;const Qa=e=>()=>e;function JP(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function ir(e,t,n){this.k=e,this.x=t,this.y=n}ir.prototype={constructor:ir,scale:function(e){return e===1?this:new ir(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ir(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var lr=new ir(1,0,0);ir.prototype;function id(e){e.stopImmediatePropagation()}function Xs(e){e.preventDefault(),e.stopImmediatePropagation()}function eO(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function tO(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function db(){return this.__zoom||lr}function nO(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function rO(){return navigator.maxTouchPoints||"ontouchstart"in this}function iO(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function SC(){var e=eO,t=tO,n=iO,r=nO,i=rO,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=$M,d=Uc("start","zoom","end"),u,f,p,h=500,x=150,g=0,w=10;function v(C){C.property("__zoom",db).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",R).filter(i).on("touchstart.zoom",T).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(C,L,P,$){var O=C.selection?C.selection():C;O.property("__zoom",db),C!==O?j(C,L,P,$):O.interrupt().each(function(){k(this,arguments).event($).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},v.scaleBy=function(C,L,P,$){v.scaleTo(C,function(){var O=this.__zoom.k,A=typeof L=="function"?L.apply(this,arguments):L;return O*A},P,$)},v.scaleTo=function(C,L,P,$){v.transform(C,function(){var O=t.apply(this,arguments),A=this.__zoom,F=P==null?_(O):typeof P=="function"?P.apply(this,arguments):P,I=A.invert(F),q=typeof L=="function"?L.apply(this,arguments):L;return n(b(y(A,q),F,I),O,o)},P,$)},v.translateBy=function(C,L,P,$){v.transform(C,function(){return n(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof P=="function"?P.apply(this,arguments):P),t.apply(this,arguments),o)},null,$)},v.translateTo=function(C,L,P,$,O){v.transform(C,function(){var A=t.apply(this,arguments),F=this.__zoom,I=$==null?_(A):typeof $=="function"?$.apply(this,arguments):$;return n(lr.translate(I[0],I[1]).scale(F.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof P=="function"?-P.apply(this,arguments):-P),A,o)},$,O)};function y(C,L){return L=Math.max(s[0],Math.min(s[1],L)),L===C.k?C:new ir(L,C.x,C.y)}function b(C,L,P){var $=L[0]-P[0]*C.k,O=L[1]-P[1]*C.k;return $===C.x&&O===C.y?C:new ir(C.k,$,O)}function _(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function j(C,L,P,$){C.on("start.zoom",function(){k(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event($).end()}).tween("zoom",function(){var O=this,A=arguments,F=k(O,A).event($),I=t.apply(O,A),q=P==null?_(I):typeof P=="function"?P.apply(O,A):P,W=Math.max(I[1][0]-I[0][0],I[1][1]-I[0][1]),U=O.__zoom,Z=typeof L=="function"?L.apply(O,A):L,B=c(U.invert(q).concat(W/U.k),Z.invert(q).concat(W/Z.k));return function(ne){if(ne===1)ne=Z;else{var se=B(ne),ce=W/se[2];ne=new ir(ce,q[0]-se[0]*ce,q[1]-se[1]*ce)}F.zoom(null,ne)}})}function k(C,L,P){return!P&&C.__zooming||new N(C,L)}function N(C,L){this.that=C,this.args=L,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,L),this.taps=0}N.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,L){return this.mouse&&C!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var L=pn(this.that).datum();d.call(C,this.that,new JP(C,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:d}),L)}};function E(C,...L){if(!e.apply(this,arguments))return;var P=k(this,L).event(C),$=this.__zoom,O=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,r.apply(this,arguments)))),A=Nn(C);if(P.wheel)(P.mouse[0][0]!==A[0]||P.mouse[0][1]!==A[1])&&(P.mouse[1]=$.invert(P.mouse[0]=A)),clearTimeout(P.wheel);else{if($.k===O)return;P.mouse=[A,$.invert(A)],Al(this),P.start()}Xs(C),P.wheel=setTimeout(F,x),P.zoom("mouse",n(b(y($,O),P.mouse[0],P.mouse[1]),P.extent,o));function F(){P.wheel=null,P.end()}}function S(C,...L){if(p||!e.apply(this,arguments))return;var P=C.currentTarget,$=k(this,L,!0).event(C),O=pn(C.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",W,!0),A=Nn(C,P),F=C.clientX,I=C.clientY;cC(C.view),id(C),$.mouse=[A,this.__zoom.invert(A)],Al(this),$.start();function q(U){if(Xs(U),!$.moved){var Z=U.clientX-F,B=U.clientY-I;$.moved=Z*Z+B*B>g}$.event(U).zoom("mouse",n(b($.that.__zoom,$.mouse[0]=Nn(U,P),$.mouse[1]),$.extent,o))}function W(U){O.on("mousemove.zoom mouseup.zoom",null),uC(U.view,$.moved),Xs(U),$.event(U).end()}}function R(C,...L){if(e.apply(this,arguments)){var P=this.__zoom,$=Nn(C.changedTouches?C.changedTouches[0]:C,this),O=P.invert($),A=P.k*(C.shiftKey?.5:2),F=n(b(y(P,A),$,O),t.apply(this,L),o);Xs(C),l>0?pn(this).transition().duration(l).call(j,F,$,C):pn(this).call(v.transform,F,$,C)}}function T(C,...L){if(e.apply(this,arguments)){var P=C.touches,$=P.length,O=k(this,L,C.changedTouches.length===$).event(C),A,F,I,q;for(id(C),F=0;F<$;++F)I=P[F],q=Nn(I,this),q=[q,this.__zoom.invert(q),I.identifier],O.touch0?!O.touch1&&O.touch0[2]!==q[2]&&(O.touch1=q,O.taps=0):(O.touch0=q,A=!0,O.taps=1+!!u);u&&(u=clearTimeout(u)),A&&(O.taps<2&&(f=q[0],u=setTimeout(function(){u=null},h)),Al(this),O.start())}}function M(C,...L){if(this.__zooming){var P=k(this,L).event(C),$=C.changedTouches,O=$.length,A,F,I,q;for(Xs(C),A=0;A<O;++A)F=$[A],I=Nn(F,this),P.touch0&&P.touch0[2]===F.identifier?P.touch0[0]=I:P.touch1&&P.touch1[2]===F.identifier&&(P.touch1[0]=I);if(F=P.that.__zoom,P.touch1){var W=P.touch0[0],U=P.touch0[1],Z=P.touch1[0],B=P.touch1[1],ne=(ne=Z[0]-W[0])*ne+(ne=Z[1]-W[1])*ne,se=(se=B[0]-U[0])*se+(se=B[1]-U[1])*se;F=y(F,Math.sqrt(ne/se)),I=[(W[0]+Z[0])/2,(W[1]+Z[1])/2],q=[(U[0]+B[0])/2,(U[1]+B[1])/2]}else if(P.touch0)I=P.touch0[0],q=P.touch0[1];else return;P.zoom("touch",n(b(F,I,q),P.extent,o))}}function z(C,...L){if(this.__zooming){var P=k(this,L).event(C),$=C.changedTouches,O=$.length,A,F;for(id(C),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),A=0;A<O;++A)F=$[A],P.touch0&&P.touch0[2]===F.identifier?delete P.touch0:P.touch1&&P.touch1[2]===F.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(F=Nn(F,this),Math.hypot(f[0]-F[0],f[1]-F[1])<w)){var I=pn(this).on("dblclick.zoom");I&&I.apply(this,arguments)}}}return v.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:Qa(+C),v):r},v.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Qa(!!C),v):e},v.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:Qa(!!C),v):i},v.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Qa([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),v):t},v.scaleExtent=function(C){return arguments.length?(s[0]=+C[0],s[1]=+C[1],v):[s[0],s[1]]},v.translateExtent=function(C){return arguments.length?(o[0][0]=+C[0][0],o[1][0]=+C[1][0],o[0][1]=+C[0][1],o[1][1]=+C[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(C){return arguments.length?(n=C,v):n},v.duration=function(C){return arguments.length?(l=+C,v):l},v.interpolate=function(C){return arguments.length?(c=C,v):c},v.on=function(){var C=d.on.apply(d,arguments);return C===d?v:C},v.clickDistance=function(C){return arguments.length?(g=(C=+C)*C,v):Math.sqrt(g)},v.tapDistance=function(C){return arguments.length?(w=+C,v):w},v}const Yc=m.createContext(null),sO=Yc.Provider,hr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},kC=hr.error001();function Xe(e,t){const n=m.useContext(Yc);if(n===null)throw new Error(kC);return XN(n,e,t)}const vt=()=>{const e=m.useContext(Yc);if(e===null)throw new Error(kC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},oO=e=>e.userSelectionActive?"none":"all";function Hr({position:e,children:t,className:n,style:r,...i}){const s=Xe(oO),o=`${e}`.split("-");return V.createElement("div",{className:Yt(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},t)}function aO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:V.createElement(Hr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},V.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const lO=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),x=Yt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();h({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:V.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:x,visibility:p.width?"visible":"hidden",...u},i&&V.createElement("rect",{width:p.width+2*o[0],x:-o[0],y:-o[1],height:p.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),V.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:r},n),c)};var cO=m.memo(lO);const Ux=e=>({width:e.offsetWidth,height:e.offsetHeight}),ks=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Vx=(e={x:0,y:0},t)=>({x:ks(e.x,t[0][0],t[1][0]),y:ks(e.y,t[0][1],t[1][1])}),fb=(e,t,n)=>e<t?ks(Math.abs(e-t),1,50)/50:e>n?-ks(Math.abs(e-n),1,50)/50:0,NC=(e,t)=>{const n=fb(e.x,35,t.width-35)*20,r=fb(e.y,35,t.height-35)*20;return[n,r]},CC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},EC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),na=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),TC=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),pb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),uO=(e,t)=>TC(EC(na(e),na(t))),jv=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},dO=e=>mn(e.width)&&mn(e.height)&&mn(e.x)&&mn(e.y),mn=e=>!isNaN(e)&&isFinite(e),nt=Symbol.for("internals"),RC=["Enter"," ","Escape"],fO=(e,t)=>{},pO=e=>"nativeEvent"in e;function Sv(e){var i,s;const t=pO(e)?e.nativeEvent:e,n=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const AC=e=>"clientX"in e,Wr=(e,t)=>{var s,o;const n=AC(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},cc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},ya=({id:e,path:t,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>V.createElement(V.Fragment,null,V.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&V.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&mn(n)&&mn(r)?V.createElement(cO,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);ya.displayName="BaseEdge";function Qs(e,t,n){return n===void 0?n:r=>{const i=t().edges.find(s=>s.id===e);i&&n(r,{...i})}}function IC({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,o=Math.abs(r-t)/2,l=r<t?r+o:r-o;return[s,l,i,o]}function MC({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:l}){const c=e*.125+i*.375+o*.375+n*.125,d=t*.125+s*.375+l*.375+r*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Ni;(function(e){e.Strict="strict",e.Loose="loose"})(Ni||(Ni={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var ra;(function(e){e.Partial="partial",e.Full="full"})(ra||(ra={}));var Rr;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Rr||(Rr={}));var uc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(uc||(uc={}));var le;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(le||(le={}));function hb({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===le.Left||e===le.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function PC({sourceX:e,sourceY:t,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top}){const[o,l]=hb({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,d]=hb({pos:s,x1:r,y1:i,x2:e,y2:t}),[u,f,p,h]=MC({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${o},${l} ${c},${d} ${r},${i}`,u,f,p,h]}const Gx=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=le.Bottom,targetPosition:s=le.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:g})=>{const[w,v,y]=PC({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return V.createElement(ya,{path:w,labelX:v,labelY:y,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:g})});Gx.displayName="SimpleBezierEdge";const mb={[le.Left]:{x:-1,y:0},[le.Right]:{x:1,y:0},[le.Top]:{x:0,y:-1},[le.Bottom]:{x:0,y:1}},hO=({source:e,sourcePosition:t=le.Bottom,target:n})=>t===le.Left||t===le.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},gb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function mO({source:e,sourcePosition:t=le.Bottom,target:n,targetPosition:r=le.Top,center:i,offset:s}){const o=mb[t],l=mb[r],c={x:e.x+o.x*s,y:e.y+o.y*s},d={x:n.x+l.x*s,y:n.y+l.y*s},u=hO({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],x,g;const w={x:0,y:0},v={x:0,y:0},[y,b,_,j]=IC({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[f]*l[f]===-1){x=i.x??y,g=i.y??b;const N=[{x,y:c.y},{x,y:d.y}],E=[{x:c.x,y:g},{x:d.x,y:g}];o[f]===p?h=f==="x"?N:E:h=f==="x"?E:N}else{const N=[{x:c.x,y:d.y}],E=[{x:d.x,y:c.y}];if(f==="x"?h=o.x===p?E:N:h=o.y===p?N:E,t===r){const z=Math.abs(e[f]-n[f]);if(z<=s){const C=Math.min(s-1,s-z);o[f]===p?w[f]=(c[f]>e[f]?-1:1)*C:v[f]=(d[f]>n[f]?-1:1)*C}}if(t!==r){const z=f==="x"?"y":"x",C=o[f]===l[z],L=c[z]>d[z],P=c[z]<d[z];(o[f]===1&&(!C&&L||C&&P)||o[f]!==1&&(!C&&P||C&&L))&&(h=f==="x"?N:E)}const S={x:c.x+w.x,y:c.y+w.y},R={x:d.x+v.x,y:d.y+v.y},T=Math.max(Math.abs(S.x-h[0].x),Math.abs(R.x-h[0].x)),M=Math.max(Math.abs(S.y-h[0].y),Math.abs(R.y-h[0].y));T>=M?(x=(S.x+R.x)/2,g=h[0].y):(x=h[0].x,g=(S.y+R.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...h,{x:d.x+v.x,y:d.y+v.y},n],x,g,_,j]}function gO(e,t,n,r){const i=Math.min(gb(e,t)/2,gb(t,n)/2,r),{x:s,y:o}=t;if(e.x===s&&s===n.x||e.y===o&&o===n.y)return`L${s} ${o}`;if(e.y===o){const d=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${s+i*d},${o}Q ${s},${o} ${s},${o+i*u}`}const l=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*l},${o}`}function kv({sourceX:e,sourceY:t,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top,borderRadius:o=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,x]=mO({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:l,y:c},offset:d});return[u.reduce((w,v,y)=>{let b="";return y>0&&y<u.length-1?b=gO(u[y-1],v,u[y+1],o):b=`${y===0?"M":"L"}${v.x} ${v.y}`,w+=b,w},""),f,p,h,x]}const Xc=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=le.Bottom,targetPosition:p=le.Top,markerEnd:h,markerStart:x,pathOptions:g,interactionWidth:w})=>{const[v,y,b]=kv({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:p,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return V.createElement(ya,{path:v,labelX:y,labelY:b,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:x,interactionWidth:w})});Xc.displayName="SmoothStepEdge";const Kx=m.memo(e=>{var t;return V.createElement(Xc,{...e,pathOptions:m.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Kx.displayName="StepEdge";function vO({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,s,o,l]=IC({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,s,o,l]}const Yx=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[x,g,w]=vO({sourceX:e,sourceY:t,targetX:n,targetY:r});return V.createElement(ya,{path:x,labelX:g,labelY:w,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});Yx.displayName="StraightEdge";function Za(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function vb({pos:e,x1:t,y1:n,x2:r,y2:i,c:s}){switch(e){case le.Left:return[t-Za(t-r,s),n];case le.Right:return[t+Za(r-t,s),n];case le.Top:return[t,n-Za(n-i,s)];case le.Bottom:return[t,n+Za(i-n,s)]}}function OC({sourceX:e,sourceY:t,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top,curvature:o=.25}){const[l,c]=vb({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[d,u]=vb({pos:s,x1:r,y1:i,x2:e,y2:t,c:o}),[f,p,h,x]=MC({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${r},${i}`,f,p,h,x]}const dc=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=le.Bottom,targetPosition:s=le.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,pathOptions:g,interactionWidth:w})=>{const[v,y,b]=OC({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:g==null?void 0:g.curvature});return V.createElement(ya,{path:v,labelX:y,labelY:b,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:w})});dc.displayName="BezierEdge";const Xx=m.createContext(null),xO=Xx.Provider;Xx.Consumer;const yO=()=>m.useContext(Xx),bO=e=>"id"in e&&"source"in e&&"target"in e,wO=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Nv=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,_O=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),jO=(e,t)=>{if(!e.source||!e.target)return t;let n;return bO(e)?n={...e}:n={...e,id:wO(e)},_O(n,t)?t:t.concat(n)},Cv=({x:e,y:t},[n,r,i],s,[o,l])=>{const c={x:(e-n)/i,y:(t-r)/i};return s?{x:o*Math.round(c.x/o),y:l*Math.round(c.y/l)}:c},DC=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),xi=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},Qc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const{x:s,y:o}=xi(i,t).positionAbsolute;return EC(r,na({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return TC(n)},LC=(e,t,[n,r,i]=[0,0,1],s=!1,o=!1,l=[0,0])=>{const c={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:x=!1}=u;if(o&&!h||x)return!1;const{positionAbsolute:g}=xi(u,l),w={x:g.x,y:g.y,width:f||0,height:p||0},v=jv(c,w),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=s&&v>0,_=(f||0)*(p||0);(y||b||v>=_||u.dragging)&&d.push(u)}),d},FC=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},zC=(e,t,n,r,i,s=.1)=>{const o=t/(e.width*(1+s)),l=n/(e.height*(1+s)),c=Math.min(o,l),d=ks(c,r,i),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=n/2-f*d;return{x:p,y:h,zoom:d}},li=(e,t=0)=>e.transition().duration(t);function xb(e,t,n,r){return(t[n]||[]).reduce((i,s)=>{var o,l;return`${e.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+s.y+s.height/2}),i},[])}function SO(e,t,n,r,i,s){const{x:o,y:l}=Wr(e),d=t.elementsFromPoint(o,l).find(x=>x.classList.contains("react-flow__handle"));if(d){const x=d.getAttribute("data-nodeid");if(x){const g=Qx(void 0,d),w=d.getAttribute("data-handleid"),v=s({nodeId:x,id:w,type:g});if(v){const y=i.find(b=>b.nodeId===x&&b.type===g&&b.id===w);return{handle:{id:w,type:g,nodeId:x,x:(y==null?void 0:y.x)||n.x,y:(y==null?void 0:y.y)||n.y},validHandleResult:v}}}}let u=[],f=1/0;if(i.forEach(x=>{const g=Math.sqrt((x.x-n.x)**2+(x.y-n.y)**2);if(g<=r){const w=s(x);g<=f&&(g<f?u=[{handle:x,validHandleResult:w}]:g===f&&u.push({handle:x,validHandleResult:w}),f=g)}}),!u.length)return{handle:null,validHandleResult:qC()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:x})=>x.isValid),h=u.some(({handle:x})=>x.type==="target");return u.find(({handle:x,validHandleResult:g})=>h?x.type==="target":p?g.isValid:!0)||u[0]}const kO={source:null,target:null,sourceHandle:null,targetHandle:null},qC=()=>({handleDomNode:null,isValid:!1,connection:kO,endHandle:null});function $C(e,t,n,r,i,s,o){const l=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...qC(),handleDomNode:c};if(c){const u=Qx(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),x=c.classList.contains("connectableend"),g={source:l?f:n,sourceHandle:l?p:r,target:l?n:f,targetHandle:l?r:p};d.connection=g,h&&x&&(t===Ni.Strict?l&&u==="source"||!l&&u==="target":f!==n||p!==r)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=s(g))}return d}function NO({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((i,s)=>{if(s[nt]){const{handleBounds:o}=s[nt];let l=[],c=[];o&&(l=xb(s,o,"source",`${t}-${n}-${r}`),c=xb(s,o,"target",`${t}-${n}-${r}`)),i.push(...l,...c)}return i},[])}function Qx(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function sd(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function CO(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function BC({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=CC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:x,onConnectStart:g,panBy:w,getNodes:v,cancelConnection:y}=s();let b=0,_;const{x:j,y:k}=Wr(e),N=u==null?void 0:u.elementFromPoint(j,k),E=Qx(c,N),S=p==null?void 0:p.getBoundingClientRect();if(!S||!E)return;let R,T=Wr(e,S),M=!1,z=null,C=!1,L=null;const P=NO({nodes:v(),nodeId:n,handleId:t,handleType:E}),$=()=>{if(!h)return;const[F,I]=NC(T,S);w({x:F,y:I}),b=requestAnimationFrame($)};o({connectionPosition:T,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:n,handleId:t,type:E},connectionEndHandle:null}),g==null||g(e,{nodeId:n,handleId:t,handleType:E});function O(F){const{transform:I}=s();T=Wr(F,S);const{handle:q,validHandleResult:W}=SO(F,u,Cv(T,I,!1,[1,1]),x,P,U=>$C(U,f,n,t,i?"target":"source",l,u));if(_=q,M||($(),M=!0),L=W.handleDomNode,z=W.connection,C=W.isValid,o({connectionPosition:_&&C?DC({x:_.x,y:_.y},I):T,connectionStatus:CO(!!_,C),connectionEndHandle:W.endHandle}),!_&&!C&&!L)return sd(R);z.source!==z.target&&L&&(sd(R),R=L,L.classList.add("connecting","react-flow__handle-connecting"),L.classList.toggle("valid",C),L.classList.toggle("react-flow__handle-valid",C))}function A(F){var I,q;(_||L)&&z&&C&&(r==null||r(z)),(q=(I=s()).onConnectEnd)==null||q.call(I,F),c&&(d==null||d(F)),sd(R),y(),cancelAnimationFrame(b),M=!1,C=!1,z=null,L=null,u.removeEventListener("mousemove",O),u.removeEventListener("mouseup",A),u.removeEventListener("touchmove",O),u.removeEventListener("touchend",A)}u.addEventListener("mousemove",O),u.addEventListener("mouseup",A),u.addEventListener("touchmove",O),u.addEventListener("touchend",A)}const yb=()=>!0,EO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),TO=(e,t,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n}},HC=m.forwardRef(({type:e="source",position:t=le.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var S,R;const x=o||null,g=e==="target",w=vt(),v=yO(),{connectOnClick:y,noPanClassName:b}=Xe(EO,Mt),{connecting:_,clickConnecting:j}=Xe(TO(v,x,e),Mt);v||(R=(S=w.getState()).onError)==null||R.call(S,"010",hr.error010());const k=T=>{const{defaultEdgeOptions:M,onConnect:z,hasDefaultEdges:C}=w.getState(),L={...M,...T};if(C){const{edges:P,setEdges:$}=w.getState();$(jO(L,P))}z==null||z(L),l==null||l(L)},N=T=>{if(!v)return;const M=AC(T);i&&(M&&T.button===0||!M)&&BC({event:T,handleId:x,nodeId:v,onConnect:k,isTarget:g,getState:w.getState,setState:w.setState,isValidConnection:n||w.getState().isValidConnection||yb}),M?u==null||u(T):f==null||f(T)},E=T=>{const{onClickConnectStart:M,onClickConnectEnd:z,connectionClickStartHandle:C,connectionMode:L,isValidConnection:P}=w.getState();if(!v||!C&&!i)return;if(!C){M==null||M(T,{nodeId:v,handleId:x,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:x}});return}const $=CC(T.target),O=n||P||yb,{connection:A,isValid:F}=$C({nodeId:v,id:x,type:e},L,C.nodeId,C.handleId||null,C.type,O,$);F&&k(A),z==null||z(T),w.setState({connectionClickStartHandle:null})};return V.createElement("div",{"data-handleid":x,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${x}-${e}`,className:Yt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!g,target:g,connectable:r,connectablestart:i,connectableend:s,connecting:j,connectionindicator:r&&(i&&!_||s&&_)}]),onMouseDown:N,onTouchStart:N,onClick:y?E:void 0,ref:h,...p},c)});HC.displayName="Handle";var Vn=m.memo(HC);const WC=({data:e,isConnectable:t,targetPosition:n=le.Top,sourcePosition:r=le.Bottom})=>V.createElement(V.Fragment,null,V.createElement(Vn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,V.createElement(Vn,{type:"source",position:r,isConnectable:t}));WC.displayName="DefaultNode";var Ev=m.memo(WC);const UC=({data:e,isConnectable:t,sourcePosition:n=le.Bottom})=>V.createElement(V.Fragment,null,e==null?void 0:e.label,V.createElement(Vn,{type:"source",position:n,isConnectable:t}));UC.displayName="InputNode";var VC=m.memo(UC);const GC=({data:e,isConnectable:t,targetPosition:n=le.Top})=>V.createElement(V.Fragment,null,V.createElement(Vn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);GC.displayName="OutputNode";var KC=m.memo(GC);const Zx=()=>null;Zx.displayName="GroupNode";const RO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Ja=e=>e.id;function AO(e,t){return Mt(e.selectedNodes.map(Ja),t.selectedNodes.map(Ja))&&Mt(e.selectedEdges.map(Ja),t.selectedEdges.map(Ja))}const YC=m.memo(({onSelectionChange:e})=>{const t=vt(),{selectedNodes:n,selectedEdges:r}=Xe(RO,AO);return m.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[n,r,e]),null});YC.displayName="SelectionListener";const IO=e=>!!e.onSelectionChange;function MO({onSelectionChange:e}){const t=Xe(IO);return e||t?V.createElement(YC,{onSelectionChange:e}):null}const PO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oi(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ke(e,t,n){m.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const OO=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:x,minZoom:g,maxZoom:w,nodeExtent:v,onNodesChange:y,onEdgesChange:b,elementsSelectable:_,connectionMode:j,snapGrid:k,snapToGrid:N,translateExtent:E,connectOnClick:S,defaultEdgeOptions:R,fitView:T,fitViewOptions:M,onNodesDelete:z,onEdgesDelete:C,onNodeDrag:L,onNodeDragStart:P,onNodeDragStop:$,onSelectionDrag:O,onSelectionDragStart:A,onSelectionDragStop:F,noPanClassName:I,nodeOrigin:q,rfId:W,autoPanOnConnect:U,autoPanOnNodeDrag:Z,onError:B,connectionRadius:ne,isValidConnection:se,nodeDragThreshold:ce})=>{const{setNodes:J,setEdges:_e,setDefaultNodesAndEdges:G,setMinZoom:xe,setMaxZoom:fe,setTranslateExtent:oe,setNodeExtent:ve,reset:Y}=Xe(PO,Mt),Q=vt();return m.useEffect(()=>{const pe=r==null?void 0:r.map(he=>({...he,...R}));return G(n,pe),()=>{Y()}},[]),ke("defaultEdgeOptions",R,Q.setState),ke("connectionMode",j,Q.setState),ke("onConnect",i,Q.setState),ke("onConnectStart",s,Q.setState),ke("onConnectEnd",o,Q.setState),ke("onClickConnectStart",l,Q.setState),ke("onClickConnectEnd",c,Q.setState),ke("nodesDraggable",d,Q.setState),ke("nodesConnectable",u,Q.setState),ke("nodesFocusable",f,Q.setState),ke("edgesFocusable",p,Q.setState),ke("edgesUpdatable",h,Q.setState),ke("elementsSelectable",_,Q.setState),ke("elevateNodesOnSelect",x,Q.setState),ke("snapToGrid",N,Q.setState),ke("snapGrid",k,Q.setState),ke("onNodesChange",y,Q.setState),ke("onEdgesChange",b,Q.setState),ke("connectOnClick",S,Q.setState),ke("fitViewOnInit",T,Q.setState),ke("fitViewOnInitOptions",M,Q.setState),ke("onNodesDelete",z,Q.setState),ke("onEdgesDelete",C,Q.setState),ke("onNodeDrag",L,Q.setState),ke("onNodeDragStart",P,Q.setState),ke("onNodeDragStop",$,Q.setState),ke("onSelectionDrag",O,Q.setState),ke("onSelectionDragStart",A,Q.setState),ke("onSelectionDragStop",F,Q.setState),ke("noPanClassName",I,Q.setState),ke("nodeOrigin",q,Q.setState),ke("rfId",W,Q.setState),ke("autoPanOnConnect",U,Q.setState),ke("autoPanOnNodeDrag",Z,Q.setState),ke("onError",B,Q.setState),ke("connectionRadius",ne,Q.setState),ke("isValidConnection",se,Q.setState),ke("nodeDragThreshold",ce,Q.setState),Oi(e,J),Oi(t,_e),Oi(g,xe),Oi(w,fe),Oi(E,oe),Oi(v,ve),null},bb={display:"none"},DO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},XC="react-flow__node-desc",QC="react-flow__edge-desc",LO="react-flow__aria-live",FO=e=>e.ariaLiveMessage;function zO({rfId:e}){const t=Xe(FO);return V.createElement("div",{id:`${LO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:DO},t)}function qO({rfId:e,disableKeyboardA11y:t}){return V.createElement(V.Fragment,null,V.createElement("div",{id:`${XC}-${e}`,style:bb},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),V.createElement("div",{id:`${QC}-${e}`,style:bb},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&V.createElement(zO,{rfId:e}))}var ia=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=m.useState(!1),i=m.useRef(!1),s=m.useRef(new Set([])),[o,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&Sv(h))return!1;const g=_b(h.code,l);s.current.add(h[g]),wb(o,s.current,!1)&&(h.preventDefault(),r(!0))},f=h=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&Sv(h))return!1;const g=_b(h.code,l);wb(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(h[g]),h.key==="Meta"&&s.current.clear(),i.current=!1},p=()=>{s.current.clear(),r(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,r]),n};function wb(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function _b(e,t){return t.includes(e)?"code":"key"}function ZC(e,t,n,r){var l,c;const i=e.parentNode||e.parentId;if(!i)return n;const s=t.get(i),o=xi(s,r);return ZC(s,t,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((l=s[nt])==null?void 0:l.z)??0)>(n.z??0)?((c=s[nt])==null?void 0:c.z)??0:n.z??0},r)}function JC(e,t,n){e.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:l,z:c}=ZC(r,e,{...r.position,z:((s=r[nt])==null?void 0:s.z)??0},t);r.positionAbsolute={x:o,y:l},r[nt].z=c,n!=null&&n[r.id]&&(r[nt].isParent=!0)}})}function od(e,t,n,r){const i=new Map,s={},o=r?1e3:0;return e.forEach(l=>{var h;const c=(mn(l.zIndex)?l.zIndex:0)+(l.selected?o:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(s[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,nt,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[nt])==null?void 0:h.handleBounds,z:c}}),i.set(l.id,u)}),JC(i,n,s),i}function eE(e,t={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const x=n().filter(w=>{var y;const v=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(y=t.nodes)!=null&&y.length?v&&t.nodes.some(b=>b.id===w.id):v}),g=x.every(w=>w.width&&w.height);if(x.length>0&&g){const w=Qc(x,f),{x:v,y,zoom:b}=zC(w,r,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),_=lr.translate(v,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(li(c,t.duration),_):l.transform(c,_),!0}}return!1}function $O(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[nt]:r[nt],selected:n.selected})}),new Map(t)}function BO(e,t){return t.map(n=>{const r=e.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function el({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=n();e!=null&&e.length&&(c&&r({nodeInternals:$O(e,i)}),o==null||o(e)),t!=null&&t.length&&(d&&r({edges:BO(t,s)}),l==null||l(t))}const Di=()=>{},HO={zoomIn:Di,zoomOut:Di,zoomTo:Di,getZoom:()=>1,setViewport:Di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Di,fitBounds:Di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},WO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),UO=()=>{const e=vt(),{d3Zoom:t,d3Selection:n}=Xe(WO,Mt);return m.useMemo(()=>n&&t?{zoomIn:i=>t.scaleBy(li(n,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(li(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(li(n,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,l,c]=e.getState().transform,d=lr.translate(i.x??o,i.y??l).scale(i.zoom??c);t.transform(li(n,s==null?void 0:s.duration),d)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>eE(e.getState,i),setCenter:(i,s,o)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:d,f=l/2-i*u,p=c/2-s*u,h=lr.translate(f,p).scale(u);t.transform(li(n,o==null?void 0:o.duration),h)},fitBounds:(i,s)=>{const{width:o,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=zC(i,o,l,c,d,(s==null?void 0:s.padding)??.1),h=lr.translate(u,f).scale(p);t.transform(li(n,s==null?void 0:s.duration),h)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Cv(i,s,o,l)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:l,domNode:c}=e.getState();if(!c)return i;const{x:d,y:u}=c.getBoundingClientRect(),f={x:i.x-d,y:i.y-u};return Cv(f,s,o,l)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:l,y:c}=o.getBoundingClientRect(),d=DC(i,s);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:HO,[t,n])};function Zc(){const e=UO(),t=vt(),n=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),r=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),i=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(w=>({...w}))},[]),s=m.useCallback(g=>{const{edges:w=[]}=t.getState();return w.find(v=>v.id===g)},[]),o=m.useCallback(g=>{const{getNodes:w,setNodes:v,hasDefaultNodes:y,onNodesChange:b}=t.getState(),_=w(),j=typeof g=="function"?g(_):g;if(y)v(j);else if(b){const k=j.length===0?_.map(N=>({type:"remove",id:N.id})):j.map(N=>({item:N,type:"reset"}));b(k)}},[]),l=m.useCallback(g=>{const{edges:w=[],setEdges:v,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),_=typeof g=="function"?g(w):g;if(y)v(_);else if(b){const j=_.length===0?w.map(k=>({type:"remove",id:k.id})):_.map(k=>({item:k,type:"reset"}));b(j)}},[]),c=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{getNodes:v,setNodes:y,hasDefaultNodes:b,onNodesChange:_}=t.getState();if(b){const k=[...v(),...w];y(k)}else if(_){const j=w.map(k=>({item:k,type:"add"}));_(j)}},[]),d=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{edges:v=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:_}=t.getState();if(b)y([...v,...w]);else if(_){const j=w.map(k=>({item:k,type:"add"}));_(j)}},[]),u=m.useCallback(()=>{const{getNodes:g,edges:w=[],transform:v}=t.getState(),[y,b,_]=v;return{nodes:g().map(j=>({...j})),edges:w.map(j=>({...j})),viewport:{x:y,y:b,zoom:_}}},[]),f=m.useCallback(({nodes:g,edges:w})=>{const{nodeInternals:v,getNodes:y,edges:b,hasDefaultNodes:_,hasDefaultEdges:j,onNodesDelete:k,onEdgesDelete:N,onNodesChange:E,onEdgesChange:S}=t.getState(),R=(g||[]).map(L=>L.id),T=(w||[]).map(L=>L.id),M=y().reduce((L,P)=>{const $=P.parentNode||P.parentId,O=!R.includes(P.id)&&$&&L.find(F=>F.id===$);return(typeof P.deletable=="boolean"?P.deletable:!0)&&(R.includes(P.id)||O)&&L.push(P),L},[]),z=b.filter(L=>typeof L.deletable=="boolean"?L.deletable:!0),C=z.filter(L=>T.includes(L.id));if(M||C){const L=FC(M,z),P=[...C,...L],$=P.reduce((O,A)=>(O.includes(A.id)||O.push(A.id),O),[]);if((j||_)&&(j&&t.setState({edges:b.filter(O=>!$.includes(O.id))}),_&&(M.forEach(O=>{v.delete(O.id)}),t.setState({nodeInternals:new Map(v)}))),$.length>0&&(N==null||N(P),S&&S($.map(O=>({id:O,type:"remove"})))),M.length>0&&(k==null||k(M),E)){const O=M.map(A=>({id:A.id,type:"remove"}));E(O)}}},[]),p=m.useCallback(g=>{const w=dO(g),v=w?null:t.getState().nodeInternals.get(g.id);return!w&&!v?[null,null,w]:[w?g:pb(v),v,w]},[]),h=m.useCallback((g,w=!0,v)=>{const[y,b,_]=p(g);return y?(v||t.getState().getNodes()).filter(j=>{if(!_&&(j.id===b.id||!j.positionAbsolute))return!1;const k=pb(j),N=jv(k,y);return w&&N>0||N>=y.width*y.height}):[]},[]),x=m.useCallback((g,w,v=!0)=>{const[y]=p(g);if(!y)return!1;const b=jv(y,w);return v&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:x}),[e,n,r,i,s,o,l,c,d,u,f,h,x])}const VO={actInsideInputWithModifier:!1};var GO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=vt(),{deleteElements:r}=Zc(),i=ia(e,VO),s=ia(t);m.useEffect(()=>{if(i){const{edges:o,getNodes:l}=n.getState(),c=l().filter(u=>u.selected),d=o.filter(u=>u.selected);r({nodes:c,edges:d}),n.setState({nodesSelectionActive:!1})}},[i]),m.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function KO(e){const t=vt();m.useEffect(()=>{let n;const r=()=>{var s,o;if(!e.current)return;const i=Ux(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",hr.error004())),t.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Jx={position:"absolute",width:"100%",height:"100%",top:0,left:0},YO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,tl=e=>({x:e.x,y:e.y,zoom:e.k}),Li=(e,t)=>e.target.closest(`.${t}`),jb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Sb=e=>{const t=e.ctrlKey&&cc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},XO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),QO=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=pi.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:x,maxZoom:g,zoomActivationKeyCode:w,preventScrolling:v=!0,children:y,noWheelClassName:b,noPanClassName:_})=>{const j=m.useRef(),k=vt(),N=m.useRef(!1),E=m.useRef(!1),S=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:M,d3ZoomHandler:z,userSelectionActive:C}=Xe(XO,Mt),L=ia(w),P=m.useRef(0),$=m.useRef(!1),O=m.useRef();return KO(S),m.useEffect(()=>{if(S.current){const A=S.current.getBoundingClientRect(),F=SC().scaleExtent([x,g]).translateExtent(h),I=pn(S.current).call(F),q=lr.translate(p.x,p.y).scale(ks(p.zoom,x,g)),W=[[0,0],[A.width,A.height]],U=F.constrain()(q,W,h);F.transform(I,U),F.wheelDelta(Sb),k.setState({d3Zoom:F,d3Selection:I,d3ZoomHandler:I.on("wheel.zoom"),transform:[U.x,U.y,U.k],domNode:S.current.closest(".react-flow")})}},[]),m.useEffect(()=>{M&&T&&(o&&!L&&!C?M.on("wheel.zoom",A=>{if(Li(A,b))return!1;A.preventDefault(),A.stopImmediatePropagation();const F=M.property("__zoom").k||1;if(A.ctrlKey&&s){const se=Nn(A),ce=Sb(A),J=F*Math.pow(2,ce);T.scaleTo(M,J,se,A);return}const I=A.deltaMode===1?20:1;let q=c===pi.Vertical?0:A.deltaX*I,W=c===pi.Horizontal?0:A.deltaY*I;!cc()&&A.shiftKey&&c!==pi.Vertical&&(q=A.deltaY*I,W=0),T.translateBy(M,-(q/F)*l,-(W/F)*l,{internal:!0});const U=tl(M.property("__zoom")),{onViewportChangeStart:Z,onViewportChange:B,onViewportChangeEnd:ne}=k.getState();clearTimeout(O.current),$.current||($.current=!0,t==null||t(A,U),Z==null||Z(U)),$.current&&(e==null||e(A,U),B==null||B(U),O.current=setTimeout(()=>{n==null||n(A,U),ne==null||ne(U),$.current=!1},150))},{passive:!1}):typeof z<"u"&&M.on("wheel.zoom",function(A,F){if(!v&&A.type==="wheel"&&!A.ctrlKey||Li(A,b))return null;A.preventDefault(),z.call(this,A,F)},{passive:!1}))},[C,o,c,M,T,z,L,s,v,b,t,e,n]),m.useEffect(()=>{T&&T.on("start",A=>{var q,W;if(!A.sourceEvent||A.sourceEvent.internal)return null;P.current=(q=A.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:F}=k.getState(),I=tl(A.transform);N.current=!0,R.current=I,((W=A.sourceEvent)==null?void 0:W.type)==="mousedown"&&k.setState({paneDragging:!0}),F==null||F(I),t==null||t(A.sourceEvent,I)})},[T,t]),m.useEffect(()=>{T&&(C&&!N.current?T.on("zoom",null):C||T.on("zoom",A=>{var I;const{onViewportChange:F}=k.getState();if(k.setState({transform:[A.transform.x,A.transform.y,A.transform.k]}),E.current=!!(r&&jb(f,P.current??0)),(e||F)&&!((I=A.sourceEvent)!=null&&I.internal)){const q=tl(A.transform);F==null||F(q),e==null||e(A.sourceEvent,q)}}))},[C,T,e,f,r]),m.useEffect(()=>{T&&T.on("end",A=>{if(!A.sourceEvent||A.sourceEvent.internal)return null;const{onViewportChangeEnd:F}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),r&&jb(f,P.current??0)&&!E.current&&r(A.sourceEvent),E.current=!1,(n||F)&&YO(R.current,A.transform)){const I=tl(A.transform);R.current=I,clearTimeout(j.current),j.current=setTimeout(()=>{F==null||F(I),n==null||n(A.sourceEvent,I)},o?150:0)}})},[T,o,f,n,r]),m.useEffect(()=>{T&&T.filter(A=>{const F=L||i,I=s&&A.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&A.button===1&&A.type==="mousedown"&&(Li(A,"react-flow__node")||Li(A,"react-flow__edge")))return!0;if(!f&&!F&&!o&&!d&&!s||C||!d&&A.type==="dblclick"||Li(A,b)&&A.type==="wheel"||Li(A,_)&&(A.type!=="wheel"||o&&A.type==="wheel"&&!L)||!s&&A.ctrlKey&&A.type==="wheel"||!F&&!o&&!I&&A.type==="wheel"||!f&&(A.type==="mousedown"||A.type==="touchstart")||Array.isArray(f)&&!f.includes(A.button)&&A.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(A.button)||!A.button||A.button<=1;return(!A.ctrlKey||A.type==="wheel")&&q})},[C,T,i,s,o,d,f,u,L]),V.createElement("div",{className:"react-flow__renderer",ref:S,style:Jx},y)},ZO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function JO(){const{userSelectionActive:e,userSelectionRect:t}=Xe(ZO,Mt);return e&&t?V.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function kb(e,t){const n=t.parentNode||t.parentId,r=e.find(i=>i.id===n);if(r){const i=t.position.x+t.width-r.width,s=t.position.y+t.height-r.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);r.position.x=r.position.x-o,r.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);r.position.y=r.position.y-o,r.style.height+=o,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function tE(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,i)=>{const s=e.filter(l=>l.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const l of s)if(l)switch(l.type){case"select":{o.selected=l.selected;break}case"position":{typeof l.position<"u"&&(o.position=l.position),typeof l.positionAbsolute<"u"&&(o.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(o.dragging=l.dragging),o.expandParent&&kb(r,o);break}case"dimensions":{typeof l.dimensions<"u"&&(o.width=l.dimensions.width,o.height=l.dimensions.height),typeof l.updateStyle<"u"&&(o.style={...o.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(o.resizing=l.resizing),o.expandParent&&kb(r,o);break}case"remove":return r}return r.push(o),r},n)}function nE(e,t){return tE(e,t)}function eD(e,t){return tE(e,t)}const Nr=(e,t)=>({id:e,type:"select",selected:t});function ns(e,t){return e.reduce((n,r)=>{const i=t.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(Nr(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(Nr(r.id,!1))),n},[])}const ad=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},tD=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),rE=m.memo(({isSelecting:e,selectionMode:t=ra.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=vt(),x=m.useRef(0),g=m.useRef(0),w=m.useRef(),{userSelectionActive:v,elementsSelectable:y,dragging:b}=Xe(tD,Mt),_=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,g.current=0},j=z=>{s==null||s(z),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},k=z=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){z.preventDefault();return}o==null||o(z)},N=l?z=>l(z):void 0,E=z=>{const{resetSelectedElements:C,domNode:L}=h.getState();if(w.current=L==null?void 0:L.getBoundingClientRect(),!y||!e||z.button!==0||z.target!==p.current||!w.current)return;const{x:P,y:$}=Wr(z,w.current);C(),h.setState({userSelectionRect:{width:0,height:0,startX:P,startY:$,x:P,y:$}}),r==null||r(z)},S=z=>{const{userSelectionRect:C,nodeInternals:L,edges:P,transform:$,onNodesChange:O,onEdgesChange:A,nodeOrigin:F,getNodes:I}=h.getState();if(!e||!w.current||!C)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Wr(z,w.current),W=C.startX??0,U=C.startY??0,Z={...C,x:q.x<W?q.x:W,y:q.y<U?q.y:U,width:Math.abs(q.x-W),height:Math.abs(q.y-U)},B=I(),ne=LC(L,Z,$,t===ra.Partial,!0,F),se=FC(ne,P).map(J=>J.id),ce=ne.map(J=>J.id);if(x.current!==ce.length){x.current=ce.length;const J=ns(B,ce);J.length&&(O==null||O(J))}if(g.current!==se.length){g.current=se.length;const J=ns(P,se);J.length&&(A==null||A(J))}h.setState({userSelectionRect:Z})},R=z=>{if(z.button!==0)return;const{userSelectionRect:C}=h.getState();!v&&C&&z.target===p.current&&(j==null||j(z)),h.setState({nodesSelectionActive:x.current>0}),_(),i==null||i(z)},T=z=>{v&&(h.setState({nodesSelectionActive:x.current>0}),i==null||i(z)),_()},M=y&&(e||v);return V.createElement("div",{className:Yt(["react-flow__pane",{dragging:b,selection:e}]),onClick:M?void 0:ad(j,p),onContextMenu:ad(k,p),onWheel:ad(N,p),onMouseEnter:M?void 0:c,onMouseDown:M?E:void 0,onMouseMove:M?S:d,onMouseUp:M?R:void 0,onMouseLeave:M?T:u,ref:p,style:Jx},f,V.createElement(JO,null))});rE.displayName="Pane";function iE(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:iE(r,t):!1}function Nb(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function nD(e,t,n,r){return Array.from(e.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!iE(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function rD(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function sE(e,t,n,r,i=[0,0],s){const o=rD(e,e.extent||r);let l=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=f&&mn(p)&&mn(h)&&mn(f.width)&&mn(f.height)?[[p+e.width*i[0],h+e.height*i[1]],[p+f.width-e.width+e.width*i[0],h+f.height-e.height+e.height*i[1]]]:l}else s==null||s("005",hr.error005()),l=o;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=n.get(c);d=xi(f,i).positionAbsolute}const u=l&&l!=="parent"?Vx(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function ld({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?r.find(i=>i.id===e):r[0],r]}const Cb=(e,t,n,r)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),l={x:o.width*r[0],y:o.height*r[1]};return s.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-o.left-l.x)/n,y:(d.top-o.top-l.y)/n,...Ux(c)}})};function Zs(e,t,n){return n===void 0?n:r=>{const i=t().nodeInternals.get(e);i&&n(r,{...i})}}function Tv({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",hr.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&o)&&(s({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):i([e])}function iD(){const e=vt();return m.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=e.getState(),o=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,c={x:(o-r[0])/r[2],y:(l-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function cd(e){return(t,n,r)=>e==null?void 0:e(t,r)}function oE({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const l=vt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),x=m.useRef({x:0,y:0}),g=m.useRef(null),w=m.useRef(!1),v=m.useRef(!1),y=m.useRef(!1),b=iD();return m.useEffect(()=>{if(e!=null&&e.current){const _=pn(e.current),j=({x:E,y:S})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:M,updateNodePositions:z,nodeExtent:C,snapGrid:L,snapToGrid:P,nodeOrigin:$,onError:O}=l.getState();f.current={x:E,y:S};let A=!1,F={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&C){const q=Qc(u.current,$);F=na(q)}if(u.current=u.current.map(q=>{const W={x:E-q.distance.x,y:S-q.distance.y};P&&(W.x=L[0]*Math.round(W.x/L[0]),W.y=L[1]*Math.round(W.y/L[1]));const U=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];u.current.length>1&&C&&!q.extent&&(U[0][0]=q.positionAbsolute.x-F.x+C[0][0],U[1][0]=q.positionAbsolute.x+(q.width??0)-F.x2+C[1][0],U[0][1]=q.positionAbsolute.y-F.y+C[0][1],U[1][1]=q.positionAbsolute.y+(q.height??0)-F.y2+C[1][1]);const Z=sE(q,W,R,U,$,O);return A=A||q.position.x!==Z.position.x||q.position.y!==Z.position.y,q.position=Z.position,q.positionAbsolute=Z.positionAbsolute,q}),!A)return;z(u.current,!0,!0),d(!0);const I=i?T:cd(M);if(I&&g.current){const[q,W]=ld({nodeId:i,dragItems:u.current,nodeInternals:R});I(g.current,q,W)}},k=()=>{if(!h.current)return;const[E,S]=NC(x.current,h.current);if(E!==0||S!==0){const{transform:R,panBy:T}=l.getState();f.current.x=(f.current.x??0)-E/R[2],f.current.y=(f.current.y??0)-S/R[2],T({x:E,y:S})&&j(f.current)}p.current=requestAnimationFrame(k)},N=E=>{var $;const{nodeInternals:S,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:M,onNodeDragStart:z,onSelectionDragStart:C}=l.getState();v.current=!0;const L=i?z:cd(C);(!o||!s)&&!R&&i&&(($=S.get(i))!=null&&$.selected||M()),i&&s&&o&&Tv({id:i,store:l,nodeRef:e});const P=b(E);if(f.current=P,u.current=nD(S,T,P,i),L&&u.current){const[O,A]=ld({nodeId:i,dragItems:u.current,nodeInternals:S});L(E.sourceEvent,O,A)}};if(t)_.on(".drag",null);else{const E=mM().on("start",S=>{const{domNode:R,nodeDragThreshold:T}=l.getState();T===0&&N(S),y.current=!1;const M=b(S);f.current=M,h.current=(R==null?void 0:R.getBoundingClientRect())||null,x.current=Wr(S.sourceEvent,h.current)}).on("drag",S=>{var z,C;const R=b(S),{autoPanOnNodeDrag:T,nodeDragThreshold:M}=l.getState();if(S.sourceEvent.type==="touchmove"&&S.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!w.current&&v.current&&T&&(w.current=!0,k()),!v.current){const L=R.xSnapped-(((z=f==null?void 0:f.current)==null?void 0:z.x)??0),P=R.ySnapped-(((C=f==null?void 0:f.current)==null?void 0:C.y)??0);Math.sqrt(L*L+P*P)>M&&N(S)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&u.current&&v.current&&(g.current=S.sourceEvent,x.current=Wr(S.sourceEvent,h.current),j(R))}}).on("end",S=>{if(!(!v.current||y.current)&&(d(!1),w.current=!1,v.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:M,onSelectionDragStop:z}=l.getState(),C=i?M:cd(z);if(R(u.current,!1,!1),C){const[L,P]=ld({nodeId:i,dragItems:u.current,nodeInternals:T});C(S.sourceEvent,L,P)}}}).filter(S=>{const R=S.target;return!S.button&&(!n||!Nb(R,`.${n}`,e))&&(!r||Nb(R,r,e))});return _.call(E),()=>{_.on(".drag",null)}}}},[e,t,n,r,s,l,i,o,b]),c}function aE(){const e=vt();return m.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=o().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,x=n.isShiftPressed?4:1,g=n.x*p*x,w=n.y*h*x,v=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+g,y:y.positionAbsolute.y+w};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:_,position:j}=sE(y,b,r,i,void 0,d);y.position=j,y.positionAbsolute=_}return y});s(v,!0,!1)},[])}const ps={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Js=e=>{const t=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:x,onDoubleClick:g,style:w,className:v,isDraggable:y,isSelectable:b,isConnectable:_,isFocusable:j,selectNodesOnDrag:k,sourcePosition:N,targetPosition:E,hidden:S,resizeObserver:R,dragHandle:T,zIndex:M,isParent:z,noDragClassName:C,noPanClassName:L,initialized:P,disableKeyboardA11y:$,ariaLabel:O,rfId:A,hasHandleBounds:F})=>{const I=vt(),q=m.useRef(null),W=m.useRef(null),U=m.useRef(N),Z=m.useRef(E),B=m.useRef(r),ne=b||y||u||f||p||h,se=aE(),ce=Zs(n,I.getState,f),J=Zs(n,I.getState,p),_e=Zs(n,I.getState,h),G=Zs(n,I.getState,x),xe=Zs(n,I.getState,g),fe=Y=>{const{nodeDragThreshold:Q}=I.getState();if(b&&(!k||!y||Q>0)&&Tv({id:n,store:I,nodeRef:q}),u){const pe=I.getState().nodeInternals.get(n);pe&&u(Y,{...pe})}},oe=Y=>{if(!Sv(Y)&&!$)if(RC.includes(Y.key)&&b){const Q=Y.key==="Escape";Tv({id:n,store:I,unselect:Q,nodeRef:q})}else y&&d&&Object.prototype.hasOwnProperty.call(ps,Y.key)&&(I.setState({ariaLiveMessage:`Moved selected node ${Y.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),se({x:ps[Y.key].x,y:ps[Y.key].y,isShiftPressed:Y.shiftKey}))};m.useEffect(()=>()=>{W.current&&(R==null||R.unobserve(W.current),W.current=null)},[]),m.useEffect(()=>{if(q.current&&!S){const Y=q.current;(!P||!F||W.current!==Y)&&(W.current&&(R==null||R.unobserve(W.current)),R==null||R.observe(Y),W.current=Y)}},[S,P,F]),m.useEffect(()=>{const Y=B.current!==r,Q=U.current!==N,pe=Z.current!==E;q.current&&(Y||Q||pe)&&(Y&&(B.current=r),Q&&(U.current=N),pe&&(Z.current=E),I.getState().updateNodeDimensions([{id:n,nodeElement:q.current,forceUpdate:!0}]))},[n,r,N,E]);const ve=oE({nodeRef:q,disabled:S||!y,noDragClassName:C,handleSelector:T,nodeId:n,isSelectable:b,selectNodesOnDrag:k});return S?null:V.createElement("div",{className:Yt(["react-flow__node",`react-flow__node-${r}`,{[L]:y},v,{selected:d,selectable:b,parent:z,dragging:ve}]),ref:q,style:{zIndex:M,transform:`translate(${l}px,${c}px)`,pointerEvents:ne?"all":"none",visibility:P?"visible":"hidden",...w},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ce,onMouseMove:J,onMouseLeave:_e,onContextMenu:G,onClick:fe,onDoubleClick:xe,onKeyDown:j?oe:void 0,tabIndex:j?0:void 0,role:j?"button":void 0,"aria-describedby":$?void 0:`${XC}-${A}`,"aria-label":O},V.createElement(xO,{value:n},V.createElement(e,{id:n,data:i,type:r,xPos:s,yPos:o,selected:d,isConnectable:_,sourcePosition:N,targetPosition:E,dragging:ve,dragHandle:T,zIndex:M})))};return t.displayName="NodeWrapper",m.memo(t)};const sD=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Qc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function oD({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=vt(),{width:i,height:s,x:o,y:l,transformString:c,userSelectionActive:d}=Xe(sD,Mt),u=aE(),f=m.useRef(null);if(m.useEffect(()=>{var x;n||(x=f.current)==null||x.focus({preventScroll:!0})},[n]),oE({nodeRef:f}),d||!i||!s)return null;const p=e?x=>{const g=r.getState().getNodes().filter(w=>w.selected);e(x,g)}:void 0,h=x=>{Object.prototype.hasOwnProperty.call(ps,x.key)&&u({x:ps[x.key].x,y:ps[x.key].y,isShiftPressed:x.shiftKey})};return V.createElement("div",{className:Yt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},V.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:i,height:s,top:l,left:o}}))}var aD=m.memo(oD);const lD=e=>e.nodesSelectionActive,lE=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:x,onSelectionEnd:g,multiSelectionKeyCode:w,panActivationKeyCode:v,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:R,defaultViewport:T,translateExtent:M,minZoom:z,maxZoom:C,preventScrolling:L,onSelectionContextMenu:P,noWheelClassName:$,noPanClassName:O,disableKeyboardA11y:A})=>{const F=Xe(lD),I=ia(f),q=ia(v),W=q||R,U=q||k,Z=I||p&&W!==!0;return GO({deleteKeyCode:l,multiSelectionKeyCode:w}),V.createElement(QO,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:U,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:!I&&W,defaultViewport:T,translateExtent:M,minZoom:z,maxZoom:C,zoomActivationKeyCode:y,preventScrolling:L,noWheelClassName:$,noPanClassName:O},V.createElement(rE,{onSelectionStart:x,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:W,isSelecting:!!Z,selectionMode:h},e,F&&V.createElement(aD,{onSelectionContextMenu:P,noPanClassName:O,disableKeyboardA11y:A})))};lE.displayName="FlowRenderer";var cD=m.memo(lE);function uD(e){return Xe(m.useCallback(n=>e?LC(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function dD(e){const t={input:Js(e.input||VC),default:Js(e.default||Ev),output:Js(e.output||KC),group:Js(e.group||Zx)},n={},r=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=Js(e[s]||Ev),i),n);return{...t,...r}}const fD=({x:e,y:t,width:n,height:r,origin:i})=>!n||!r?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]},pD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),cE=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Xe(pD,Mt),l=uD(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));s(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),V.createElement("div",{className:"react-flow__nodes",style:Jx},l.map(u=>{var j,k,N;let f=u.type||"default";e.nodeTypes[f]||(o==null||o("003",hr.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),x=!!(u.selectable||i&&typeof u.selectable>"u"),g=!!(u.connectable||n&&typeof u.connectable>"u"),w=!!(u.focusable||r&&typeof u.focusable>"u"),v=e.nodeExtent?Vx(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(v==null?void 0:v.x)??0,b=(v==null?void 0:v.y)??0,_=fD({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return V.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||le.Bottom,targetPosition:u.targetPosition||le.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:x,isConnectable:g,isFocusable:w,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((j=u[nt])==null?void 0:j.z)??0,isParent:!!((k=u[nt])!=null&&k.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((N=u[nt])!=null&&N.handleBounds)})}))};cE.displayName="NodeRenderer";var hD=m.memo(cE);const mD=(e,t,n)=>n===le.Left?e-t:n===le.Right?e+t:e,gD=(e,t,n)=>n===le.Top?e-t:n===le.Bottom?e+t:e,Eb="react-flow__edgeupdater",Tb=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:l})=>V.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Yt([Eb,`${Eb}-${l}`]),cx:mD(t,r,e),cy:gD(n,r,e),r,stroke:"transparent",fill:"transparent"}),vD=()=>!0;var Fi=e=>{const t=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:g,style:w,source:v,target:y,sourceX:b,sourceY:_,targetX:j,targetY:k,sourcePosition:N,targetPosition:E,elementsSelectable:S,hidden:R,sourceHandleId:T,targetHandleId:M,onContextMenu:z,onMouseEnter:C,onMouseMove:L,onMouseLeave:P,reconnectRadius:$,onReconnect:O,onReconnectStart:A,onReconnectEnd:F,markerEnd:I,markerStart:q,rfId:W,ariaLabel:U,isFocusable:Z,isReconnectable:B,pathOptions:ne,interactionWidth:se,disableKeyboardA11y:ce})=>{const J=m.useRef(null),[_e,G]=m.useState(!1),[xe,fe]=m.useState(!1),oe=vt(),ve=m.useMemo(()=>`url('#${Nv(q,W)}')`,[q,W]),Y=m.useMemo(()=>`url('#${Nv(I,W)}')`,[I,W]);if(R)return null;const Q=Re=>{var yt;const{edges:X,addSelectedEdges:Pe,unselectNodesAndEdges:ge,multiSelectionActive:kt}=oe.getState(),xt=X.find(Qt=>Qt.id===n);xt&&(S&&(oe.setState({nodesSelectionActive:!1}),xt.selected&&kt?(ge({nodes:[],edges:[xt]}),(yt=J.current)==null||yt.blur()):Pe([n])),o&&o(Re,xt))},pe=Qs(n,oe.getState,l),he=Qs(n,oe.getState,z),we=Qs(n,oe.getState,C),ye=Qs(n,oe.getState,L),te=Qs(n,oe.getState,P),me=(Re,X)=>{if(Re.button!==0)return;const{edges:Pe,isValidConnection:ge}=oe.getState(),kt=X?y:v,xt=(X?M:T)||null,yt=X?"target":"source",Qt=ge||vD,D=X,H=Pe.find(Oe=>Oe.id===n);fe(!0),A==null||A(Re,H,yt);const K=Oe=>{fe(!1),F==null||F(Oe,H,yt)};BC({event:Re,handleId:xt,nodeId:kt,onConnect:Oe=>O==null?void 0:O(H,Oe),isTarget:D,getState:oe.getState,setState:oe.setState,isValidConnection:Qt,edgeUpdaterType:yt,onReconnectEnd:K})},Ge=Re=>me(Re,!0),Fe=Re=>me(Re,!1),$e=()=>G(!0),Te=()=>G(!1),Be=!S&&!o,at=Re=>{var X;if(!ce&&RC.includes(Re.key)&&S){const{unselectNodesAndEdges:Pe,addSelectedEdges:ge,edges:kt}=oe.getState();Re.key==="Escape"?((X=J.current)==null||X.blur(),Pe({edges:[kt.find(yt=>yt.id===n)]})):ge([n])}};return V.createElement("g",{className:Yt(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:c,animated:d,inactive:Be,updating:_e}]),onClick:Q,onDoubleClick:pe,onContextMenu:he,onMouseEnter:we,onMouseMove:ye,onMouseLeave:te,onKeyDown:Z?at:void 0,tabIndex:Z?0:void 0,role:Z?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":U===null?void 0:U||`Edge from ${v} to ${y}`,"aria-describedby":Z?`${QC}-${W}`:void 0,ref:J},!xe&&V.createElement(e,{id:n,source:v,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:g,data:s,style:w,sourceX:b,sourceY:_,targetX:j,targetY:k,sourcePosition:N,targetPosition:E,sourceHandleId:T,targetHandleId:M,markerStart:ve,markerEnd:Y,pathOptions:ne,interactionWidth:se}),B&&V.createElement(V.Fragment,null,(B==="source"||B===!0)&&V.createElement(Tb,{position:N,centerX:b,centerY:_,radius:$,onMouseDown:Ge,onMouseEnter:$e,onMouseOut:Te,type:"source"}),(B==="target"||B===!0)&&V.createElement(Tb,{position:E,centerX:j,centerY:k,radius:$,onMouseDown:Fe,onMouseEnter:$e,onMouseOut:Te,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function xD(e){const t={default:Fi(e.default||dc),straight:Fi(e.bezier||Yx),step:Fi(e.step||Kx),smoothstep:Fi(e.step||Xc),simplebezier:Fi(e.simplebezier||Gx)},n={},r=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Fi(e[s]||dc),i),n);return{...t,...r}}function Rb(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,s=(n==null?void 0:n.width)||t.width,o=(n==null?void 0:n.height)||t.height;switch(e){case le.Top:return{x:r+s/2,y:i};case le.Right:return{x:r+s,y:i+o/2};case le.Bottom:return{x:r+s/2,y:i+o};case le.Left:return{x:r,y:i+o/2}}}function Ab(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const yD=(e,t,n,r,i,s)=>{const o=Rb(n,e,t),l=Rb(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y}};function bD({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+s)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=na({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Ib(e){var r,i,s,o,l;const t=((r=e==null?void 0:e[nt])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const wD=[{level:0,isMaxLevel:!0,edges:[]}];function _D(e,t,n=!1){let r=-1;const i=e.reduce((o,l)=>{var u,f;const c=mn(l.zIndex);let d=c?l.zIndex:0;if(n){const p=t.get(l.target),h=t.get(l.source),x=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),g=Math.max(((u=h==null?void 0:h[nt])==null?void 0:u.z)||0,((f=p==null?void 0:p[nt])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(x?g:0)}return o[d]?o[d].push(l):o[d]=[l],r=d>r?d:r,o},{}),s=Object.entries(i).map(([o,l])=>{const c=+o;return{edges:l,level:c,isMaxLevel:c===r}});return s.length===0?wD:s}function jD(e,t,n){const r=Xe(m.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),l=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&bD({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:l.width,targetHeight:l.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return _D(r,t,n)}const SD=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),kD=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Mb={[uc.Arrow]:SD,[uc.ArrowClosed]:kD};function ND(e){const t=vt();return m.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Mb,e)?Mb[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",hr.error009(e)),null)},[e])}const CD=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const c=ND(t);return c?V.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0"},V.createElement(c,{color:n,strokeWidth:o})):null},ED=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const l=Nv(o,t);r.includes(l)||(i.push({id:l,color:o.color||e,...o}),r.push(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},uE=({defaultColor:e,rfId:t})=>{const n=Xe(m.useCallback(ED({defaultColor:e,rfId:t}),[e,t]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return V.createElement("defs",null,n.map(r=>V.createElement(CD,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};uE.displayName="MarkerDefinitions";var TD=m.memo(uE);const RD=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),dE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:g,children:w,disableKeyboardA11y:v})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:_,width:j,height:k,connectionMode:N,nodeInternals:E,onError:S}=Xe(RD,Mt),R=jD(t,E,n);return j?V.createElement(V.Fragment,null,R.map(({level:T,edges:M,isMaxLevel:z})=>V.createElement("svg",{key:T,style:{zIndex:T},width:j,height:k,className:"react-flow__edges react-flow__container"},z&&V.createElement(TD,{defaultColor:e,rfId:r}),V.createElement("g",null,M.map(C=>{const[L,P,$]=Ib(E.get(C.source)),[O,A,F]=Ib(E.get(C.target));if(!$||!F)return null;let I=C.type||"default";i[I]||(S==null||S("011",hr.error011(I)),I="default");const q=i[I]||i.default,W=N===Ni.Strict?A.target:(A.target??[]).concat(A.source??[]),U=Ab(P.source,C.sourceHandle),Z=Ab(W,C.targetHandle),B=(U==null?void 0:U.position)||le.Bottom,ne=(Z==null?void 0:Z.position)||le.Top,se=!!(C.focusable||y&&typeof C.focusable>"u"),ce=C.reconnectable||C.updatable,J=typeof p<"u"&&(ce||b&&typeof ce>"u");if(!U||!Z)return S==null||S("008",hr.error008(U,C)),null;const{sourceX:_e,sourceY:G,targetX:xe,targetY:fe}=yD(L,U,B,O,Z,ne);return V.createElement(q,{key:C.id,id:C.id,className:Yt([C.className,s]),type:I,data:C.data,selected:!!C.selected,animated:!!C.animated,hidden:!!C.hidden,label:C.label,labelStyle:C.labelStyle,labelShowBg:C.labelShowBg,labelBgStyle:C.labelBgStyle,labelBgPadding:C.labelBgPadding,labelBgBorderRadius:C.labelBgBorderRadius,style:C.style,source:C.source,target:C.target,sourceHandleId:C.sourceHandle,targetHandleId:C.targetHandle,markerEnd:C.markerEnd,markerStart:C.markerStart,sourceX:_e,sourceY:G,targetX:xe,targetY:fe,sourcePosition:B,targetPosition:ne,elementsSelectable:_,onContextMenu:o,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:g,rfId:r,ariaLabel:C.ariaLabel,isFocusable:se,isReconnectable:J,pathOptions:"pathOptions"in C?C.pathOptions:void 0,interactionWidth:C.interactionWidth,disableKeyboardA11y:v})})))),w):null};dE.displayName="EdgeRenderer";var AD=m.memo(dE);const ID=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function MD({children:e}){const t=Xe(ID);return V.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function PD(e){const t=Zc(),n=m.useRef(!1);m.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const OD={[le.Left]:le.Right,[le.Right]:le.Left,[le.Top]:le.Bottom,[le.Bottom]:le.Top},fE=({nodeId:e,handleType:t,style:n,type:r=Rr.Bezier,CustomComponent:i,connectionStatus:s})=>{var k,N,E;const{fromNode:o,handleId:l,toX:c,toY:d,connectionMode:u}=Xe(m.useCallback(S=>({fromNode:S.nodeInternals.get(e),handleId:S.connectionHandleId,toX:(S.connectionPosition.x-S.transform[0])/S.transform[2],toY:(S.connectionPosition.y-S.transform[1])/S.transform[2],connectionMode:S.connectionMode}),[e]),Mt),f=(k=o==null?void 0:o[nt])==null?void 0:k.handleBounds;let p=f==null?void 0:f[t];if(u===Ni.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!o||!p)return null;const h=l?p.find(S=>S.id===l):p[0],x=h?h.x+h.width/2:(o.width??0)/2,g=h?h.y+h.height/2:o.height??0,w=(((N=o.positionAbsolute)==null?void 0:N.x)??0)+x,v=(((E=o.positionAbsolute)==null?void 0:E.y)??0)+g,y=h==null?void 0:h.position,b=y?OD[y]:null;if(!y||!b)return null;if(i)return V.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:h,fromX:w,fromY:v,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:s});let _="";const j={sourceX:w,sourceY:v,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return r===Rr.Bezier?[_]=OC(j):r===Rr.Step?[_]=kv({...j,borderRadius:0}):r===Rr.SmoothStep?[_]=kv(j):r===Rr.SimpleBezier?[_]=PC(j):_=`M${w},${v} ${c},${d}`,V.createElement("path",{d:_,fill:"none",className:"react-flow__connection-path",style:n})};fE.displayName="ConnectionLine";const DD=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function LD({containerStyle:e,style:t,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:l,height:c,connectionStatus:d}=Xe(DD,Mt);return!(i&&s&&l&&o)?null:V.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},V.createElement("g",{className:Yt(["react-flow__connection",d])},V.createElement(fE,{nodeId:i,handleType:s,style:t,type:n,CustomComponent:r,connectionStatus:d})))}function Pb(e,t){return m.useRef(null),vt(),m.useMemo(()=>t(e),[e])}const pE=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:x,onSelectionStart:g,onSelectionEnd:w,connectionLineType:v,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:_,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:E,panActivationKeyCode:S,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:M,elementsSelectable:z,selectNodesOnDrag:C,defaultViewport:L,translateExtent:P,minZoom:$,maxZoom:O,preventScrolling:A,defaultMarkerColor:F,zoomOnScroll:I,zoomOnPinch:q,panOnScroll:W,panOnScrollSpeed:U,panOnScrollMode:Z,zoomOnDoubleClick:B,panOnDrag:ne,onPaneClick:se,onPaneMouseEnter:ce,onPaneMouseMove:J,onPaneMouseLeave:_e,onPaneScroll:G,onPaneContextMenu:xe,onEdgeContextMenu:fe,onEdgeMouseEnter:oe,onEdgeMouseMove:ve,onEdgeMouseLeave:Y,onReconnect:Q,onReconnectStart:pe,onReconnectEnd:he,reconnectRadius:we,noDragClassName:ye,noWheelClassName:te,noPanClassName:me,elevateEdgesOnSelect:Ge,disableKeyboardA11y:Fe,nodeOrigin:$e,nodeExtent:Te,rfId:Be})=>{const at=Pb(e,dD),Re=Pb(t,xD);return PD(s),V.createElement(cD,{onPaneClick:se,onPaneMouseEnter:ce,onPaneMouseMove:J,onPaneMouseLeave:_e,onPaneContextMenu:xe,onPaneScroll:G,deleteKeyCode:T,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,onSelectionStart:g,onSelectionEnd:w,multiSelectionKeyCode:E,panActivationKeyCode:S,zoomActivationKeyCode:R,elementsSelectable:z,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:I,zoomOnPinch:q,zoomOnDoubleClick:B,panOnScroll:W,panOnScrollSpeed:U,panOnScrollMode:Z,panOnDrag:ne,defaultViewport:L,translateExtent:P,minZoom:$,maxZoom:O,onSelectionContextMenu:x,preventScrolling:A,noDragClassName:ye,noWheelClassName:te,noPanClassName:me,disableKeyboardA11y:Fe},V.createElement(MD,null,V.createElement(AD,{edgeTypes:Re,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:M,onEdgeContextMenu:fe,onEdgeMouseEnter:oe,onEdgeMouseMove:ve,onEdgeMouseLeave:Y,onReconnect:Q,onReconnectStart:pe,onReconnectEnd:he,reconnectRadius:we,defaultMarkerColor:F,noPanClassName:me,elevateEdgesOnSelect:!!Ge,disableKeyboardA11y:Fe,rfId:Be},V.createElement(LD,{style:y,type:v,component:b,containerStyle:_})),V.createElement("div",{className:"react-flow__edgelabel-renderer"}),V.createElement(hD,{nodeTypes:at,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:C,onlyRenderVisibleElements:M,noPanClassName:me,noDragClassName:ye,disableKeyboardA11y:Fe,nodeOrigin:$e,nodeExtent:Te,rfId:Be})))};pE.displayName="GraphView";var FD=m.memo(pE);const Rv=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wr={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Rv,nodeExtent:Rv,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ni.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:fO,isValidConnection:void 0},zD=()=>C3((e,t)=>({...wr,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:od(n,r,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?od(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=n.reduce((g,w)=>{const v=i.get(w.id);if(v!=null&&v.hidden)i.set(v.id,{...v,[nt]:{...v[nt],handleBounds:void 0}});else if(v){const y=Ux(w.nodeElement);!!(y.width&&y.height&&(v.width!==y.width||v.height!==y.height||w.forceUpdate))&&(i.set(v.id,{...v,[nt]:{...v[nt],handleBounds:{source:Cb(".source",w.nodeElement,p,d),target:Cb(".target",w.nodeElement,p,d)}},...y}),g.push({id:v.id,type:"dimensions",dimensions:y}))}return g},[]);JC(i,d);const x=o||s&&!o&&eE(t,{initial:!0,...l});e({nodeInternals:new Map(i),fitViewOnInitDone:x}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=n.map(l=>{const c={id:l.id,type:"position",dragging:i};return r&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:l,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(s){const d=nE(n,l()),u=od(d,i,o,c);e({nodeInternals:u})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,l=null;r?o=n.map(c=>Nr(c,!0)):(o=ns(s(),n),l=ns(i,[])),el({changedNodes:o,changedEdges:l,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,l=null;r?o=n.map(c=>Nr(c,!0)):(o=ns(i,n),l=ns(s(),[])),el({changedNodes:l,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=t(),o=n||s(),l=r||i,c=o.map(u=>(u.selected=!1,Nr(u.id,!1))),d=l.map(u=>Nr(u.id,!1));el({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=t();r==null||r.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=t();r==null||r.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),s=r().filter(l=>l.selected).map(l=>Nr(l.id,!1)),o=n.filter(l=>l.selected).map(l=>Nr(l.id,!1));el({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(i=>{i.positionAbsolute=Vx(i.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:l,translateExtent:c}=t();if(!o||!l||!n.x&&!n.y)return!1;const d=lr.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),u=[[0,0],[i,s]],f=o==null?void 0:o.constrain()(d,u,c);return o.transform(l,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wr.connectionNodeId,connectionHandleId:wr.connectionHandleId,connectionHandleType:wr.connectionHandleType,connectionStatus:wr.connectionStatus,connectionStartHandle:wr.connectionStartHandle,connectionEndHandle:wr.connectionEndHandle}),reset:()=>e({...wr})}),Object.is),Jc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=zD()),V.createElement(sO,{value:t.current},e)};Jc.displayName="ReactFlowProvider";const hE=({children:e})=>m.useContext(Yc)?V.createElement(V.Fragment,null,e):V.createElement(Jc,null,e);hE.displayName="ReactFlowWrapper";const qD={input:VC,default:Ev,output:KC,group:Zx},$D={default:dc,straight:Yx,step:Kx,smoothstep:Xc,simplebezier:Gx},BD=[0,0],HD=[15,15],WD={x:0,y:0,zoom:1},UD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ey=m.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=qD,edgeTypes:o=$D,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:x,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:S,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:M,onSelectionDragStart:z,onSelectionDrag:C,onSelectionDragStop:L,onSelectionContextMenu:P,onSelectionStart:$,onSelectionEnd:O,connectionMode:A=Ni.Strict,connectionLineType:F=Rr.Bezier,connectionLineStyle:I,connectionLineComponent:q,connectionLineContainerStyle:W,deleteKeyCode:U="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:B=!1,selectionMode:ne=ra.Full,panActivationKeyCode:se="Space",multiSelectionKeyCode:ce=cc()?"Meta":"Control",zoomActivationKeyCode:J=cc()?"Meta":"Control",snapToGrid:_e=!1,snapGrid:G=HD,onlyRenderVisibleElements:xe=!1,selectNodesOnDrag:fe=!0,nodesDraggable:oe,nodesConnectable:ve,nodesFocusable:Y,nodeOrigin:Q=BD,edgesFocusable:pe,edgesUpdatable:he,elementsSelectable:we,defaultViewport:ye=WD,minZoom:te=.5,maxZoom:me=2,translateExtent:Ge=Rv,preventScrolling:Fe=!0,nodeExtent:$e,defaultMarkerColor:Te="#b1b1b7",zoomOnScroll:Be=!0,zoomOnPinch:at=!0,panOnScroll:Re=!1,panOnScrollSpeed:X=.5,panOnScrollMode:Pe=pi.Free,zoomOnDoubleClick:ge=!0,panOnDrag:kt=!0,onPaneClick:xt,onPaneMouseEnter:yt,onPaneMouseMove:Qt,onPaneMouseLeave:D,onPaneScroll:H,onPaneContextMenu:K,children:re,onEdgeContextMenu:Oe,onEdgeDoubleClick:lt,onEdgeMouseEnter:ln,onEdgeMouseMove:Nt,onEdgeMouseLeave:bt,onEdgeUpdate:qt,onEdgeUpdateStart:ue,onEdgeUpdateEnd:ie,onReconnect:He,onReconnectStart:Ct,onReconnectEnd:wn,reconnectRadius:ti=10,edgeUpdaterRadius:ni=10,onNodesChange:Dn,onEdgesChange:ri,noDragClassName:qs="nodrag",noWheelClassName:pR="nowheel",noPanClassName:Py="nopan",fitView:hR=!1,fitViewOptions:mR,connectOnClick:gR=!0,attributionPosition:vR,proOptions:xR,defaultEdgeOptions:yR,elevateNodesOnSelect:bR=!0,elevateEdgesOnSelect:wR=!1,disableKeyboardA11y:Oy=!1,autoPanOnConnect:_R=!0,autoPanOnNodeDrag:jR=!0,connectionRadius:SR=20,isValidConnection:kR,onError:NR,style:CR,id:Dy,nodeDragThreshold:ER,...TR},RR)=>{const Cu=Dy||"1";return V.createElement("div",{...TR,style:{...CR,...UD},ref:RR,className:Yt(["react-flow",i]),"data-testid":"rf__wrapper",id:Dy},V.createElement(hE,null,V.createElement(FD,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:k,nodeTypes:s,edgeTypes:o,connectionLineType:F,connectionLineStyle:I,connectionLineComponent:q,connectionLineContainerStyle:W,selectionKeyCode:Z,selectionOnDrag:B,selectionMode:ne,deleteKeyCode:U,multiSelectionKeyCode:ce,panActivationKeyCode:se,zoomActivationKeyCode:J,onlyRenderVisibleElements:xe,selectNodesOnDrag:fe,defaultViewport:ye,translateExtent:Ge,minZoom:te,maxZoom:me,preventScrolling:Fe,zoomOnScroll:Be,zoomOnPinch:at,zoomOnDoubleClick:ge,panOnScroll:Re,panOnScrollSpeed:X,panOnScrollMode:Pe,panOnDrag:kt,onPaneClick:xt,onPaneMouseEnter:yt,onPaneMouseMove:Qt,onPaneMouseLeave:D,onPaneScroll:H,onPaneContextMenu:K,onSelectionContextMenu:P,onSelectionStart:$,onSelectionEnd:O,onEdgeContextMenu:Oe,onEdgeDoubleClick:lt,onEdgeMouseEnter:ln,onEdgeMouseMove:Nt,onEdgeMouseLeave:bt,onReconnect:He??qt,onReconnectStart:Ct??ue,onReconnectEnd:wn??ie,reconnectRadius:ti??ni,defaultMarkerColor:Te,noDragClassName:qs,noWheelClassName:pR,noPanClassName:Py,elevateEdgesOnSelect:wR,rfId:Cu,disableKeyboardA11y:Oy,nodeOrigin:Q,nodeExtent:$e}),V.createElement(OO,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:x,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,nodesDraggable:oe,nodesConnectable:ve,nodesFocusable:Y,edgesFocusable:pe,edgesUpdatable:he,elementsSelectable:we,elevateNodesOnSelect:bR,minZoom:te,maxZoom:me,nodeExtent:$e,onNodesChange:Dn,onEdgesChange:ri,snapToGrid:_e,snapGrid:G,connectionMode:A,translateExtent:Ge,connectOnClick:gR,defaultEdgeOptions:yR,fitView:hR,fitViewOptions:mR,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:S,onSelectionDrag:C,onSelectionDragStart:z,onSelectionDragStop:L,noPanClassName:Py,nodeOrigin:Q,rfId:Cu,autoPanOnConnect:_R,autoPanOnNodeDrag:jR,onError:NR,connectionRadius:SR,isValidConnection:kR,nodeDragThreshold:ER}),V.createElement(MO,{onSelectionChange:M}),re,V.createElement(aO,{proOptions:xR,position:vR}),V.createElement(qO,{rfId:Cu,disableKeyboardA11y:Oy})))});ey.displayName="ReactFlow";function mE(e){return t=>{const[n,r]=m.useState(t),i=m.useCallback(s=>r(o=>e(s,o)),[]);return[n,r,i]}}const gE=mE(nE),vE=mE(eD),xE=({id:e,x:t,y:n,width:r,height:i,style:s,color:o,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:x,backgroundColor:g}=s||{},w=o||x||g;return V.createElement("rect",{className:Yt(["react-flow__minimap-node",{selected:h},d]),x:t,y:n,rx:u,ry:u,width:r,height:i,fill:w,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?v=>p(v,e):void 0})};xE.displayName="MiniMapNode";var VD=m.memo(xE);const GD=e=>e.nodeOrigin,KD=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),ud=e=>e instanceof Function?e:()=>e;function YD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:s=VD,onClick:o}){const l=Xe(KD,Mt),c=Xe(GD),d=ud(t),u=ud(e),f=ud(n),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return V.createElement(V.Fragment,null,l.map(h=>{const{x,y:g}=xi(h,c).positionAbsolute;return V.createElement(s,{key:h.id,x,y:g,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:r,strokeColor:u(h),strokeWidth:i,shapeRendering:p,onClick:o,id:h.id})}))}var XD=m.memo(YD);const QD=200,ZD=150,JD=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?uO(Qc(t,e.nodeOrigin),n):n,rfId:e.rfId}},e6="react-flow__minimap-desc";function yE({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:x=!1,zoomable:g=!1,ariaLabel:w="React Flow mini map",inversePan:v=!1,zoomStep:y=10,offsetScale:b=5}){const _=vt(),j=m.useRef(null),{boundingRect:k,viewBB:N,rfId:E}=Xe(JD,Mt),S=(e==null?void 0:e.width)??QD,R=(e==null?void 0:e.height)??ZD,T=k.width/S,M=k.height/R,z=Math.max(T,M),C=z*S,L=z*R,P=b*z,$=k.x-(C-k.width)/2-P,O=k.y-(L-k.height)/2-P,A=C+P*2,F=L+P*2,I=`${e6}-${E}`,q=m.useRef(0);q.current=z,m.useEffect(()=>{if(j.current){const Z=pn(j.current),B=ce=>{const{transform:J,d3Selection:_e,d3Zoom:G}=_.getState();if(ce.sourceEvent.type!=="wheel"||!_e||!G)return;const xe=-ce.sourceEvent.deltaY*(ce.sourceEvent.deltaMode===1?.05:ce.sourceEvent.deltaMode?1:.002)*y,fe=J[2]*Math.pow(2,xe);G.scaleTo(_e,fe)},ne=ce=>{const{transform:J,d3Selection:_e,d3Zoom:G,translateExtent:xe,width:fe,height:oe}=_.getState();if(ce.sourceEvent.type!=="mousemove"||!_e||!G)return;const ve=q.current*Math.max(1,J[2])*(v?-1:1),Y={x:J[0]-ce.sourceEvent.movementX*ve,y:J[1]-ce.sourceEvent.movementY*ve},Q=[[0,0],[fe,oe]],pe=lr.translate(Y.x,Y.y).scale(J[2]),he=G.constrain()(pe,Q,xe);G.transform(_e,he)},se=SC().on("zoom",x?ne:null).on("zoom.wheel",g?B:null);return Z.call(se),()=>{Z.on("zoom",null)}}},[x,g,v,y]);const W=p?Z=>{const B=Nn(Z);p(Z,{x:B[0],y:B[1]})}:void 0,U=h?(Z,B)=>{const ne=_.getState().nodeInternals.get(B);h(Z,ne)}:void 0;return V.createElement(Hr,{position:f,style:e,className:Yt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},V.createElement("svg",{width:S,height:R,viewBox:`${$} ${O} ${A} ${F}`,role:"img","aria-labelledby":I,ref:j,onClick:W},w&&V.createElement("title",{id:I},w),V.createElement(XD,{onClick:U,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:l}),V.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-P},${O-P}h${A+P*2}v${F+P*2}h${-A-P*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}yE.displayName="MiniMap";var bE=m.memo(yE);const nl={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},t6=180,n6=400,r6=260,i6=48;function s6(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function o6({projects:e,selectedId:t,onSelectProject:n,onNewProject:r,showArchived:i,onToggleShowArchived:s,userSection:o}){const[l,c]=m.useState(!1),[d,u]=m.useState(r6),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null);m.useEffect(()=>{x.current&&x.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((j,k)=>{const N=(j.name||"").localeCompare(k.name||"");return N!==0?N:(j.projectId||"").localeCompare(k.projectId||"")}),[e]),w=()=>{r()},v=m.useCallback(j=>{j.preventDefault(),p(!0)},[]),y=m.useCallback(j=>{if(!f)return;const k=Math.min(n6,Math.max(t6,j.clientX));u(k)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const _=l?i6:d;return a.jsxs("div",{ref:h,className:"h-full flex flex-col relative",style:{width:_,minWidth:_,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[a.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),a.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:i?"#f59e0b":"var(--text-muted)"},title:i?"Hide archived":"Show archived",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),a.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:a.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(j=>{const k=t===j.id;return a.jsxs("div",{ref:k?x:null,onClick:()=>n(j.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:k?"var(--state-active-bg)":"transparent",border:k?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:k?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:k?"#ffffff":nl[j.status]||nl.queued}}),a.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:k?"#ffffff":"var(--text-primary)"},children:j.name}),j.isArchived&&a.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:k?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[a.jsx("span",{className:"text-[10px] font-mono",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:j.projectId}),a.jsx("span",{className:"text-[10px]",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:s6(j.createdAt)})]})]},j.id)})}),l&&a.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(j=>a.jsx("div",{onClick:()=>n(j.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:j.name,children:a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:nl[j.status]||nl.queued,boxShadow:t===j.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},j.id))}),!l&&a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:w,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),a.jsx("span",{children:"New Project"})]})}),l&&a.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:w,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),o,!l&&a.jsx("div",{onMouseDown:v,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function a6({stations:e}){return e!=null&&e.length?a.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,n)=>{const r=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",i=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",s=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return a.jsxs(V.Fragment,{children:[n>0&&a.jsx("div",{className:"w-4 h-0.5",style:{background:i}}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:r}}),a.jsx("span",{className:"text-[7px] mt-0.5",style:{color:s,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const Ob={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},wE=(e,t)=>{var n;return((n=Ob[t])==null?void 0:n[e])||Ob.industrial.queued},jn={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},Ro={GAP:8,WIDTH:280},dd=["pgc","asm","draft","qa","done"],Ar=["industrial","light","blueprint"];function l6({questions:e,nodeWidth:t,onSubmit:n,onClose:r,onZoomComplete:i}){const[s,o]=m.useState({}),l=e.filter(c=>c.required).every(c=>s[c.id]);return m.useEffect(()=>{if(i){const c=setTimeout(()=>i(),150);return()=>clearTimeout(c)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+Ro.GAP,width:Ro.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:Ro.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),a.jsx("button",{onClick:r,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&a.jsx("span",{className:"text-amber-600",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:s[c.id]||"",onChange:d=>o(u=>({...u,[c.id]:d.target.value}))})]},c.id))}),a.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:a.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${l?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!l,onClick:()=>n(s),children:"Submit & Continue"})})]})}function c6({features:e,epicName:t,nodeWidth:n,onClose:r,onZoomComplete:i}){const s=e.length>6,o=s?240:320;return m.useEffect(()=>{if(i){const l=setTimeout(()=>i(),150);return()=>clearTimeout(l)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:n+Ro.GAP,width:o,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:Ro.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),a.jsx("button",{onClick:r,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${s?"":"grid grid-cols-2 gap-2"}`,children:e.map(l=>{const c=l.state==="complete"?"var(--state-stabilized-bg)":l.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return a.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${s?"mb-1":""}`,children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),a.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:l.name})]},l.id)})}),a.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const ty="/api/v1";class u6 extends Error{constructor(t,n,r){super(t),this.name="ApiError",this.status=n,this.data=r}}function d6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function ze(e,t={}){const n=`${ty}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},i=await fetch(n,r);if(!i.ok){const s=await i.json().catch(()=>({}));throw new u6(s.detail||`Request failed: ${i.status}`,i.status,s)}return i.status===204?null:i.json()}const Ye={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":d6()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const n=t.toString();return ze(`/projects${n?"?"+n:""}`)},getProject:e=>ze(`/projects/${e}`),getProjectTree:e=>ze(`/projects/${e}/tree`),createProject:e=>ze("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>ze(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>ze(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>ze(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>ze(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>ze(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const n=new URLSearchParams({project_id:e});return t&&n.set("document_type",t),ze(`/production/start?${n}`,{method:"POST"})},getProjectInterrupts:e=>ze(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>ze(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,n=null)=>ze("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:n})}),submitWorkflowInput:(e,t,n=null)=>ze(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:n})}),getExecutionStatus:e=>ze(`/document-workflows/executions/${e}`),getPgcAnswers:e=>ze(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>ze(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>ze(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>ze("/intake/start",{method:"POST"}),getIntakeState:e=>ze(`/intake/${e}`),submitIntakeMessage:(e,t)=>ze(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,n)=>ze(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:n})}),initializeIntake:e=>ze(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>ze(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,n)=>ze(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:n})}),updateWorkflowInstance:(e,t)=>ze(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>ze(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,n=0)=>ze(`/projects/${e}/workflow/history?limit=${t}&offset=${n}`),completeWorkflowInstance:e=>ze(`/projects/${e}/workflow/complete`,{method:"POST"})};function f6(e){const t=`${ty}/production/events?project_id=${e}`;return new EventSource(t)}function p6(e){const t=`${ty}/intake/${e}/events`;return new EventSource(t)}function h6(e){return`/auth/login/${e}`}function m6({block:e}){const{data:t}=e,n=t.content||t.value||"";return n?a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:n}),t.detail_ref&&a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Db({block:e}){const{data:t}=e,n=t.items||[],r=t.style||"bullet";if(n.length===0)return null;const i=r==="numbered"?"decimal":"disc";return a.jsxs("div",{style:{marginBottom:12},children:[t.title&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),a.jsx("ul",{style:{margin:0,paddingLeft:r==="check"?0:20,listStyle:r==="check"?"none":i},children:n.map((s,o)=>a.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:r==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[r==="check"&&a.jsx("span",{style:{color:"#10b981"},children:""}),typeof s=="string"?s:(s==null?void 0:s.value)||(s==null?void 0:s.text)||(s==null?void 0:s.question)||(s==null?void 0:s.description)||JSON.stringify(s)]},o))})]})}function g6({block:e}){const{data:t}=e,n=t.value||"unknown",r=t.label,s={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[n.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[r&&a.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[r,":"]}),a.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:s.bg,color:s.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:n})]})}function _E({block:e}){const{data:t}=e,{id:n,text:r,blocking:i,why_it_matters:s,priority:o,tags:l,options:c}=t,d={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},u=d[o]||d.should;return a.jsx("div",{style:{padding:"12px 16px",background:i?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${i?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:n}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:r}),s&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:s}),a.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[i&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),o&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:u.bg,color:u.text,textTransform:"uppercase"},children:o}),l==null?void 0:l.map((f,p)=>a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},p))]}),c&&c.length>0&&a.jsxs("div",{style:{marginTop:8},children:[a.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,p)=>a.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:p>0?8:4},children:f},p))]})]})]})})}function v6({block:e}){const{data:t}=e,n=t.items||[],r=t.total_count||n.length,i=t.blocking_count||n.filter(s=>s.blocking).length;return n.length===0?a.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{style:{color:"#374151"},children:r})," questions"]}),i>0&&a.jsxs("span",{style:{color:"#dc2626"},children:[a.jsx("strong",{children:i})," blocking"]})]}),n.map((s,o)=>a.jsx(_E,{block:{type:"schema:OpenQuestionV1",data:s}},s.id||o))]})}function Lb({block:e}){const{data:t}=e,n=t.items||[],r=t.title;if(n.length===0)return null;const i={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:r}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((s,o)=>{const l=s.severity||s.likelihood||"medium",c=i[l]||i.medium;return a.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[s.id&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:s.id}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:s.description||s.reason||JSON.stringify(s)}),s.impact&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",s.impact]}),s.mitigation&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",s.mitigation]})]}),a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},s.id||o)})})]})}function x6({block:e}){const{data:t}=e,r=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([i])=>t[i]&&typeof t[i]=="string").map(([i,s])=>({title:s,content:t[i]}));return r.length===0?null:a.jsx("div",{style:{marginBottom:12},children:r.map((i,s)=>a.jsxs("div",{style:{marginBottom:s<r.length-1?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:i.title}),a.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:i.content})})]},s))})}function Fb({block:e}){const{data:t}=e,{epic_id:n,title:r,name:i,intent:s,phase:o,mvp_phase:l,risk_level:c,stories:d,detail_ref:u}=t,f=o||l,p=r||i,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},x=h[c]||h.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},w=g[f]||g.mvp;return a.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[n&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:n}),a.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),s&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s}),d&&d.length>0&&a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[d.length," stories"]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:w.bg,color:w.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&a.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:x.bg,color:x.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),u&&a.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function y6({block:e}){const{data:t}=e,{story_id:n,title:r,intent:i,phase:s,risk_level:o,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[o]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[s]||u.mvp;return a.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[n&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:n}),a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:r})]}),i&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:i})]}),a.jsxs("div",{style:{display:"flex",gap:4},children:[s&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:s}),d&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:o})]})]})})}function b6({block:e}){const{type:t,data:n}=e;return a.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[a.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),a.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(n,null,2)})]})}function w6({block:e}){const{data:t}=e,n=t.items||[],[r,i]=m.useState({});if(n.length===0)return null;const s=o=>{i(l=>({...l,[o]:!l[o]}))};return a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((o,l)=>{const c=r[l],d=o.why_it_matters||o.impact_if_unresolved;return a.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[a.jsxs("button",{onClick:()=>d&&s(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:o.question||o.value||o.text||"Unknown"}),d&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:a.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&a.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[o.why_it_matters&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.why_it_matters})]}),o.impact_if_unresolved&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.impact_if_unresolved})]})]})]},l)})})}function _6({block:e}){const{data:t}=e,{description:n,user_statement:r}=t;return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:n}),r&&a.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',r,'"']})]})}function j6({block:e}){const{data:t}=e,{category:n,confidence:r,rationale:i}=t;return a.jsxs("div",{style:{marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:n}),r&&a.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",r]})]}),i&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i})]})}function S6({block:e}){const{data:t}=e,{explicit:n=[],inferred:r=[]}=t,i=n&&n.length>0,s=r&&r.length>0;return!i&&!s?null:a.jsxs("div",{style:{marginBottom:12},children:[i&&a.jsxs("div",{style:{marginBottom:s?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:o})]},l))})]}),s&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:o})]},l))})]})]})}function k6({block:e}){const{data:t}=e,{questions:n=[],missing_context:r=[],assumptions_made:i=[]}=t,s=n&&n.length>0,o=r&&r.length>0,l=i&&i.length>0;return!s&&!o&&!l?null:a.jsxs("div",{style:{marginBottom:12},children:[s&&a.jsxs("div",{style:{marginBottom:o||l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:c})]},d))})]}),o&&a.jsxs("div",{style:{marginBottom:l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:c})]},d))})]}),l&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:i.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#6b7280"},children:""}),a.jsx("span",{children:c})]},d))})]})]})}function N6({block:e}){const{data:t}=e,{status:n,rationale:r,next_action:i}=t,o={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[n]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("div",{style:{marginBottom:12},children:a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:o.bg,color:o.text},children:n})}),r&&a.jsx("p",{style:{margin:0,marginBottom:i?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:r}),i&&a.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:a.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",i]})})]})}const C6={"schema:ParagraphBlockV1":m6,"schema:StringListBlockV1":Db,"schema:IndicatorBlockV1":g6,"schema:OpenQuestionV1":_E,"schema:OpenQuestionsBlockV1":v6,"schema:RisksBlockV1":Lb,"schema:DependenciesBlockV1":Lb,"schema:SummaryBlockV1":x6,"schema:EpicSummaryBlockV1":Fb,"schema:StorySummaryBlockV1":y6,"schema:EpicStoriesCardBlockV1":Fb,"schema:StoriesBlockV1":Db,"schema:UnknownsBlockV1":w6,"schema:IntakeSummaryBlockV1":_6,"schema:IntakeProjectTypeBlockV1":j6,"schema:IntakeConstraintsBlockV1":S6,"schema:IntakeOpenGapsBlockV1":k6,"schema:IntakeOutcomeBlockV1":N6};function E6(e){return C6[e]||b6}function T6(e,t){const n=E6(e.type);return a.jsx(n,{block:e},e.key||t)}function jE({renderModel:e,variant:t="full",hideHeader:n=!1,onSectionClick:r,className:i=""}){var w;const[s,o]=m.useState(new Set(((w=e==null?void 0:e.sections)==null?void 0:w.map(v=>v.section_id))||[]));if(!e)return a.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return a.jsx(A6,{title:l,content:e.raw_content,reason:u.reason});const f=v=>{o(y=>{const b=new Set(y);return b.has(v)?b.delete(v):b.add(v),b})},p=t==="compact"||t==="sidecar",x=t==="sidecar"?d.filter(v=>v.viewer_tab==="overview"||!v.viewer_tab):d,g=(()=>{if(!l)return"Document";const v=l.indexOf(": ");return v>-1?l.slice(v+2):l})();return a.jsxs("div",{className:i,children:[t==="full"&&!n&&a.jsxs("div",{style:{marginBottom:24},children:[a.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&a.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:x.map(v=>a.jsx(R6,{section:v,isExpanded:s.has(v.section_id),onToggle:()=>f(v.section_id),onClick:()=>r==null?void 0:r(v),variant:t},v.section_id))}),x.length===0&&a.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function R6({section:e,isExpanded:t,onToggle:n,onClick:r,variant:i}){const{section_id:s,title:o,description:l,blocks:c=[],sidecar_max_items:d}=e,u=i==="compact"||i==="sidecar",f=i==="sidecar";if(c.length===0)return null;const p=f&&d&&c.length>d?c.slice(0,d):c,h=f&&d&&c.length>d;return a.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[a.jsxs("button",{onClick:n,style:{width:"100%",padding:u?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,fontSize:u?13:15,fontWeight:600,color:"#111827"},children:[o,h&&a.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",d," of ",c.length,")"]})]}),l&&!u&&a.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:l})]}),a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:a.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&a.jsxs("div",{style:{padding:u?12:18},children:[p.map((x,g)=>T6(x,g)),h&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-d," more in full view"]})]})]})}function A6({title:e,content:t,reason:n}){return a.jsxs("div",{children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",n||"unknown",")"]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function I6({renderModel:e,projectCode:t,documentName:n,isExpanded:r,onToggleExpand:i,onClose:s,onViewFull:o,nodeWidth:l=280}){const p=r?900:520,h=r?900:600,x=`${t||"DOC"} - ${n||"Document"}`,g=w=>{w.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:l+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const w=(e==null?void 0:e.title)||"DOCUMENT",v=w.indexOf(": ");return(v>-1?w.slice(v+2):w).toUpperCase()})()}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:i,title:r?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:r?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:s,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:r?600:400},children:a.jsx(jE,{renderModel:e,variant:"sidecar"})}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:o,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function M6({document:e,projectId:t,projectCode:n,nodeWidth:r,onClose:i,onZoomComplete:s,onViewFull:o}){const[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!0),[h,x]=m.useState(!1);return m.useEffect(()=>{if(s){const g=setTimeout(()=>s(),150);return()=>clearTimeout(g)}},[s]),m.useEffect(()=>{async function g(){var w;if(!t||!e.id){p(!1);return}try{p(!0);try{const y=await Ye.getDocumentRenderModel(t,e.id);if(y&&y.sections&&y.sections.length>0){c(y),u(null);return}if((w=y==null?void 0:y.metadata)!=null&&w.fallback&&y.raw_content){c(null),u(y.raw_content);return}}catch(y){console.log("RenderModel not available, falling back to raw document:",y.message)}const v=await Ye.getDocument(t,e.id);c(null),u((v==null?void 0:v.content)||null)}catch(v){console.error("Failed to fetch document for sidecar:",v)}finally{p(!1)}}g()},[t,e.id]),f?null:l?a.jsx(I6,{renderModel:l,projectCode:n,documentName:e.name,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id),nodeWidth:r}):a.jsx(P6,{document:e,projectCode:n,rawContent:d,nodeWidth:r,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id)})}function P6({document:e,projectCode:t,rawContent:n,nodeWidth:r,isExpanded:i,onToggleExpand:s,onClose:o,onViewFull:l}){var w;const p=i?900:520,h=i?900:600,x=`${t||"DOC"} - ${e.name||"Document"}`,g=v=>{v.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:r+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((w=e.name)==null?void 0:w.toUpperCase())||"DOCUMENT"}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:s,title:i?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:i?600:400},children:[a.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(n,null,2)})})]}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:l,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const O6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function D6({data:e}){var _,j,k;const n=(e.level||1)===1,r=e.isExpanded,i=e.expandType,s=((_=e.questions)==null?void 0:_.length)>0,o=((j=e.features)==null?void 0:j.length)>0,l=(k=e.stations)==null?void 0:k.some(N=>N.needs_input),c=e.state||"ready_for_production",d=["produced","stabilized","ready"].includes(c),u=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),p=u&&e.stations,h=u?"node-active":"",x=n?"DOCUMENT":"EPIC",g=n?"subway-node-header-doc":"subway-node-header-epic",w=d?"var(--state-produced-bg, var(--state-stabilized-bg))":u?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",v=d?"var(--state-produced-text, var(--state-stabilized-text))":u?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",y=u?"var(--state-in-production-bg, var(--state-active-bg))":d?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=O6[c]||c;return a.jsxs("div",{className:"relative",children:[a.jsx(Vn,{type:"target",position:le.Top,className:"!opacity-0",style:{left:"15%"}}),a.jsxs("div",{className:`subway-node rounded-lg border ${h} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:y},children:[a.jsxs("div",{className:`${g} border-b px-3 py-1.5 flex items-center justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:n?"var(--header-text-doc)":"var(--header-text-epic)"},children:x}),a.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&a.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:n?24:18,height:n?24:18,backgroundColor:w}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:v},children:b}),n&&e.desc&&a.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),p&&a.jsx(a6,{stations:e.stations}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[n&&d&&a.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"document")},children:"View Document"}),l&&s&&!r&&a.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"questions")},children:"Answer Questions"}),!n&&o&&(r&&i==="features"?a.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):a.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"features")},children:[a.jsx("span",{className:"text-indigo-400",children:e.features.length}),a.jsx("span",{children:"features"}),a.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),r&&i==="questions"&&s&&a.jsx(l6,{questions:e.questions,nodeWidth:e.width,onSubmit:N=>{var E;return(E=e.onSubmitQuestions)==null?void 0:E.call(e,e.id,N)},onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),r&&i==="features"&&o&&a.jsx(c6,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),r&&i==="document"&&n&&d&&a.jsx(M6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)},onViewFull:N=>{var E;return(E=e.onViewFullDocument)==null?void 0:E.call(e,N)}}),a.jsx(Vn,{type:"source",position:le.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function L6(){return a.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[a.jsx(Vn,{type:"target",position:le.Top,style:{opacity:0}}),a.jsx(Vn,{type:"source",position:le.Bottom,style:{opacity:0}})]})}function F6({projectId:e,projectCode:t,docTypeId:n,onClose:r}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null);return m.useEffect(()=>{async function p(){var h;try{d(!0),f(null);try{const g=await Ye.getDocumentRenderModel(e,n);if(g&&g.sections&&g.sections.length>0){s(g),l(null);return}if((h=g==null?void 0:g.metadata)!=null&&h.fallback&&g.raw_content){s(null),l(g.raw_content);return}}catch(g){console.log("RenderModel not available, falling back to raw document:",g.message)}const x=await Ye.getDocument(e,n);s(null),l((x==null?void 0:x.content)||null)}catch(x){f(x.message),console.error("Failed to fetch document:",x)}finally{d(!1)}}p()},[e,n]),m.useEffect(()=>{const p=h=>{h.key==="Escape"&&r()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[r]),c?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:a.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:p=>p.target===p.currentTarget&&r(),children:a.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[a.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsx("div",{children:t&&a.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),a.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-red-500",children:u})}),i&&a.jsx(jE,{renderModel:i,variant:"full"}),o&&!i&&a.jsx(z6,{content:o,docTypeId:n}),!i&&!o&&!u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function z6({content:e,docTypeId:t}){if(!e)return a.jsx("p",{className:"text-gray-500",children:"No content available"});const n=e.project_name||e.title||e.name,r=e.description||e.summary||e.preliminary_summary;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",a.jsx("strong",{children:t})," - displaying raw content"]}),(n||r)&&a.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[n&&a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n}),r&&a.jsx("p",{className:"text-gray-700 text-sm",children:r})]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const q6="/api/v1/admin";class $6 extends Error{constructor(t,n,r){super(t),this.name="AdminApiError",this.status=n,this.data=r,this.errorCode=r==null?void 0:r.error_code}}function B6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ne(e,t={}){var s;const n=`${q6}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const o=B6();o&&(r.headers["X-CSRF-Token"]=o)}const i=await fetch(n,r);if(!i.ok){const o=await i.json().catch(()=>({})),l=((s=o.detail)==null?void 0:s.message)||o.detail||`Request failed: ${i.status}`;throw new $6(l,i.status,o.detail||o)}return i.status===204?null:i.json()}const je={getCurrentWorkspace:async()=>{try{return await Ne("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ne("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ne(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ne(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,n)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:n})}),getPreview:(e,t,n="execution")=>Ne(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${n}`),getDiff:(e,t=null)=>{const n=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ne(`/workspaces/${e}/diff${n}`)},commit:(e,t)=>Ne(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ne(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ne("/workbench/document-types"),getDocumentType:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/document-types/${e}${n}`)},getDocumentTypeVersions:e=>Ne(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ne("/workbench/prompt-fragments"),getRoles:()=>Ne("/workbench/roles"),getTemplates:()=>Ne("/workbench/templates"),getSchemas:()=>Ne("/workbench/schemas"),getSchema:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/schemas/${e}${n}`)},getRole:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/roles/${e}${n}`)},getTemplate:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/templates/${e}${n}`)},getWorkflows:()=>Ne("/workbench/workflows"),getOrchestrationWorkflows:()=>Ne("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/workflows/${e}${n}`)},createOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ne(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ne(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ne(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ne(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ne("/workbench/active-releases"),invalidateCache:()=>Ne("/workbench/cache/invalidate",{method:"POST"}),getMechanicalOpTypes:()=>Ne("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Ne(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Ne("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Ne("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const n=t?`?version=${t}`:"";return Ne(`/workbench/mechanical-ops/${e}${n}`)}};function H6({projectId:e}){const[t,n]=m.useState(null),[r,i]=m.useState(!0),[s,o]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,x]=m.useState(!1),[g,w]=m.useState(null),[v,y]=m.useState(!1),[b,_]=m.useState(!1),j=m.useCallback(async()=>{if(e){i(!0),o(null);try{const M=await Ye.getWorkflowInstance(e);n(M)}catch(M){M.status===404?n(null):o(M.message)}finally{i(!1)}}},[e]);m.useEffect(()=>{j()},[j]);const k=async()=>{c(!0),p(!0);try{const M=await je.getOrchestrationWorkflows();u(M.workflows||[])}catch{u([])}finally{p(!1)}},N=async M=>{x(!0);try{const z=await Ye.createWorkflowInstance(e,M.workflow_id,M.active_version);n(z),c(!1)}catch(z){o(z.message)}finally{x(!1)}},E=async()=>{if(t&&(_(!b),!g)){y(!0);try{const M=await Ye.getWorkflowDrift(e);w(M)}catch(M){w({error:M.message})}finally{y(!1)}}};if(r)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(s&&!t)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:s});if(!t)return a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?a.jsx(W6,{workflows:d,loading:f,assigning:h,onSelect:N,onCancel:()=>c(!1)}):a.jsx("button",{onClick:k,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const S=t.effective_workflow||{},R=S.steps||[],T=t.base_workflow_ref||{};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:S.name||T.workflow_id||"Workflow"}),a.jsx(U6,{status:t.status})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",T.workflow_id," v",T.version,T.pow_class?` (${T.pow_class})`:""]})]}),a.jsx("button",{onClick:E,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:v?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&a.jsx(V6,{drift:g}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",R.length,")"]}),R.length===0?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):a.jsx("div",{className:"space-y-1",children:R.map((M,z)=>a.jsx(G6,{step:M,index:z},M.step_id||z))})]}),s&&a.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:s})]})}function W6({workflows:e,loading:t,assigning:n,onSelect:r,onCancel:i}){const s=e.filter(l=>(l.pow_class||"reference")==="reference"),o=e.filter(l=>l.pow_class==="template");return a.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs(a.Fragment,{children:[s.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),s.map(l=>a.jsxs("button",{onClick:()=>r(l),disabled:n,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:n?"default":"pointer",opacity:n?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),o.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),o.map(l=>a.jsxs("button",{onClick:()=>r(l),disabled:n,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:n?"default":"pointer",opacity:n?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),s.length===0&&o.length===0&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),a.jsx("button",{onClick:i,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function U6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},n=t[e]||t.active;return a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:n.bg,color:n.color},children:e})}function V6({drift:e}){return e.error?a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):a.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[a.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[a.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),a.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&a.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&a.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&a.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&a.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&a.jsx("div",{children:"~ Metadata changed"})]})]})}function G6({step:e,index:t}){return a.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&a.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&a.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function ny(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fd,zb;function K6(){if(zb)return fd;zb=1;function e(){this.__data__=[],this.size=0}return fd=e,fd}var pd,qb;function As(){if(qb)return pd;qb=1;function e(t,n){return t===n||t!==t&&n!==n}return pd=e,pd}var hd,$b;function eu(){if($b)return hd;$b=1;var e=As();function t(n,r){for(var i=n.length;i--;)if(e(n[i][0],r))return i;return-1}return hd=t,hd}var md,Bb;function Y6(){if(Bb)return md;Bb=1;var e=eu(),t=Array.prototype,n=t.splice;function r(i){var s=this.__data__,o=e(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():n.call(s,o,1),--this.size,!0}return md=r,md}var gd,Hb;function X6(){if(Hb)return gd;Hb=1;var e=eu();function t(n){var r=this.__data__,i=e(r,n);return i<0?void 0:r[i][1]}return gd=t,gd}var vd,Wb;function Q6(){if(Wb)return vd;Wb=1;var e=eu();function t(n){return e(this.__data__,n)>-1}return vd=t,vd}var xd,Ub;function Z6(){if(Ub)return xd;Ub=1;var e=eu();function t(n,r){var i=this.__data__,s=e(i,n);return s<0?(++this.size,i.push([n,r])):i[s][1]=r,this}return xd=t,xd}var yd,Vb;function tu(){if(Vb)return yd;Vb=1;var e=K6(),t=Y6(),n=X6(),r=Q6(),i=Z6();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,yd=s,yd}var bd,Gb;function J6(){if(Gb)return bd;Gb=1;var e=tu();function t(){this.__data__=new e,this.size=0}return bd=t,bd}var wd,Kb;function eL(){if(Kb)return wd;Kb=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return wd=e,wd}var _d,Yb;function tL(){if(Yb)return _d;Yb=1;function e(t){return this.__data__.get(t)}return _d=e,_d}var jd,Xb;function nL(){if(Xb)return jd;Xb=1;function e(t){return this.__data__.has(t)}return jd=e,jd}var Sd,Qb;function SE(){if(Qb)return Sd;Qb=1;var e=typeof Ta=="object"&&Ta&&Ta.Object===Object&&Ta;return Sd=e,Sd}var kd,Zb;function Pn(){if(Zb)return kd;Zb=1;var e=SE(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return kd=n,kd}var Nd,Jb;function Is(){if(Jb)return Nd;Jb=1;var e=Pn(),t=e.Symbol;return Nd=t,Nd}var Cd,e1;function rL(){if(e1)return Cd;e1=1;var e=Is(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,i=e?e.toStringTag:void 0;function s(o){var l=n.call(o,i),c=o[i];try{o[i]=void 0;var d=!0}catch{}var u=r.call(o);return d&&(l?o[i]=c:delete o[i]),u}return Cd=s,Cd}var Ed,t1;function iL(){if(t1)return Ed;t1=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Ed=n,Ed}var Td,n1;function Ti(){if(n1)return Td;n1=1;var e=Is(),t=rL(),n=iL(),r="[object Null]",i="[object Undefined]",s=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?i:r:s&&s in Object(l)?t(l):n(l)}return Td=o,Td}var Rd,r1;function yn(){if(r1)return Rd;r1=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Rd=e,Rd}var Ad,i1;function ba(){if(i1)return Ad;i1=1;var e=Ti(),t=yn(),n="[object AsyncFunction]",r="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==r||c==i||c==n||c==s}return Ad=o,Ad}var Id,s1;function sL(){if(s1)return Id;s1=1;var e=Pn(),t=e["__core-js_shared__"];return Id=t,Id}var Md,o1;function oL(){if(o1)return Md;o1=1;var e=sL(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return Md=n,Md}var Pd,a1;function kE(){if(a1)return Pd;a1=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Pd=n,Pd}var Od,l1;function aL(){if(l1)return Od;l1=1;var e=ba(),t=oL(),n=yn(),r=kE(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!n(p)||t(p))return!1;var h=e(p)?u:s;return h.test(r(p))}return Od=f,Od}var Dd,c1;function lL(){if(c1)return Dd;c1=1;function e(t,n){return t==null?void 0:t[n]}return Dd=e,Dd}var Ld,u1;function Ri(){if(u1)return Ld;u1=1;var e=aL(),t=lL();function n(r,i){var s=t(r,i);return e(s)?s:void 0}return Ld=n,Ld}var Fd,d1;function ry(){if(d1)return Fd;d1=1;var e=Ri(),t=Pn(),n=e(t,"Map");return Fd=n,Fd}var zd,f1;function nu(){if(f1)return zd;f1=1;var e=Ri(),t=e(Object,"create");return zd=t,zd}var qd,p1;function cL(){if(p1)return qd;p1=1;var e=nu();function t(){this.__data__=e?e(null):{},this.size=0}return qd=t,qd}var $d,h1;function uL(){if(h1)return $d;h1=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return $d=e,$d}var Bd,m1;function dL(){if(m1)return Bd;m1=1;var e=nu(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function i(s){var o=this.__data__;if(e){var l=o[s];return l===t?void 0:l}return r.call(o,s)?o[s]:void 0}return Bd=i,Bd}var Hd,g1;function fL(){if(g1)return Hd;g1=1;var e=nu(),t=Object.prototype,n=t.hasOwnProperty;function r(i){var s=this.__data__;return e?s[i]!==void 0:n.call(s,i)}return Hd=r,Hd}var Wd,v1;function pL(){if(v1)return Wd;v1=1;var e=nu(),t="__lodash_hash_undefined__";function n(r,i){var s=this.__data__;return this.size+=this.has(r)?0:1,s[r]=e&&i===void 0?t:i,this}return Wd=n,Wd}var Ud,x1;function hL(){if(x1)return Ud;x1=1;var e=cL(),t=uL(),n=dL(),r=fL(),i=pL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,Ud=s,Ud}var Vd,y1;function mL(){if(y1)return Vd;y1=1;var e=hL(),t=tu(),n=ry();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Vd=r,Vd}var Gd,b1;function gL(){if(b1)return Gd;b1=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Gd=e,Gd}var Kd,w1;function ru(){if(w1)return Kd;w1=1;var e=gL();function t(n,r){var i=n.__data__;return e(r)?i[typeof r=="string"?"string":"hash"]:i.map}return Kd=t,Kd}var Yd,_1;function vL(){if(_1)return Yd;_1=1;var e=ru();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return Yd=t,Yd}var Xd,j1;function xL(){if(j1)return Xd;j1=1;var e=ru();function t(n){return e(this,n).get(n)}return Xd=t,Xd}var Qd,S1;function yL(){if(S1)return Qd;S1=1;var e=ru();function t(n){return e(this,n).has(n)}return Qd=t,Qd}var Zd,k1;function bL(){if(k1)return Zd;k1=1;var e=ru();function t(n,r){var i=e(this,n),s=i.size;return i.set(n,r),this.size+=i.size==s?0:1,this}return Zd=t,Zd}var Jd,N1;function iy(){if(N1)return Jd;N1=1;var e=mL(),t=vL(),n=xL(),r=yL(),i=bL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,Jd=s,Jd}var ef,C1;function wL(){if(C1)return ef;C1=1;var e=tu(),t=ry(),n=iy(),r=200;function i(s,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<r-1)return c.push([s,o]),this.size=++l.size,this;l=this.__data__=new n(c)}return l.set(s,o),this.size=l.size,this}return ef=i,ef}var tf,E1;function iu(){if(E1)return tf;E1=1;var e=tu(),t=J6(),n=eL(),r=tL(),i=nL(),s=wL();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=n,o.prototype.get=r,o.prototype.has=i,o.prototype.set=s,tf=o,tf}var nf,T1;function sy(){if(T1)return nf;T1=1;function e(t,n){for(var r=-1,i=t==null?0:t.length;++r<i&&n(t[r],r,t)!==!1;);return t}return nf=e,nf}var rf,R1;function NE(){if(R1)return rf;R1=1;var e=Ri(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return rf=t,rf}var sf,A1;function su(){if(A1)return sf;A1=1;var e=NE();function t(n,r,i){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:i,writable:!0}):n[r]=i}return sf=t,sf}var of,I1;function ou(){if(I1)return of;I1=1;var e=su(),t=As(),n=Object.prototype,r=n.hasOwnProperty;function i(s,o,l){var c=s[o];(!(r.call(s,o)&&t(c,l))||l===void 0&&!(o in s))&&e(s,o,l)}return of=i,of}var af,M1;function wa(){if(M1)return af;M1=1;var e=ou(),t=su();function n(r,i,s,o){var l=!s;s||(s={});for(var c=-1,d=i.length;++c<d;){var u=i[c],f=o?o(s[u],r[u],u,s,r):void 0;f===void 0&&(f=r[u]),l?t(s,u,f):e(s,u,f)}return s}return af=n,af}var lf,P1;function _L(){if(P1)return lf;P1=1;function e(t,n){for(var r=-1,i=Array(t);++r<t;)i[r]=n(r);return i}return lf=e,lf}var cf,O1;function Yn(){if(O1)return cf;O1=1;function e(t){return t!=null&&typeof t=="object"}return cf=e,cf}var uf,D1;function jL(){if(D1)return uf;D1=1;var e=Ti(),t=Yn(),n="[object Arguments]";function r(i){return t(i)&&e(i)==n}return uf=r,uf}var df,L1;function _a(){if(L1)return df;L1=1;var e=jL(),t=Yn(),n=Object.prototype,r=n.hasOwnProperty,i=n.propertyIsEnumerable,s=e(function(){return arguments}())?e:function(o){return t(o)&&r.call(o,"callee")&&!i.call(o,"callee")};return df=s,df}var ff,F1;function ot(){if(F1)return ff;F1=1;var e=Array.isArray;return ff=e,ff}var ho={exports:{}},pf,z1;function SL(){if(z1)return pf;z1=1;function e(){return!1}return pf=e,pf}ho.exports;var q1;function Ms(){return q1||(q1=1,function(e,t){var n=Pn(),r=SL(),i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===i,l=o?n.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||r;e.exports=d}(ho,ho.exports)),ho.exports}var hf,$1;function au(){if($1)return hf;$1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,i){var s=typeof r;return i=i??e,!!i&&(s=="number"||s!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<i}return hf=n,hf}var mf,B1;function oy(){if(B1)return mf;B1=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return mf=t,mf}var gf,H1;function kL(){if(H1)return gf;H1=1;var e=Ti(),t=oy(),n=Yn(),r="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",x="[object String]",g="[object WeakMap]",w="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",_="[object Int8Array]",j="[object Int16Array]",k="[object Int32Array]",N="[object Uint8Array]",E="[object Uint8ClampedArray]",S="[object Uint16Array]",R="[object Uint32Array]",T={};T[y]=T[b]=T[_]=T[j]=T[k]=T[N]=T[E]=T[S]=T[R]=!0,T[r]=T[i]=T[w]=T[s]=T[v]=T[o]=T[l]=T[c]=T[d]=T[u]=T[f]=T[p]=T[h]=T[x]=T[g]=!1;function M(z){return n(z)&&t(z.length)&&!!T[e(z)]}return gf=M,gf}var vf,W1;function lu(){if(W1)return vf;W1=1;function e(t){return function(n){return t(n)}}return vf=e,vf}var mo={exports:{}};mo.exports;var U1;function ay(){return U1||(U1=1,function(e,t){var n=SE(),r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,o=s&&n.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l}(mo,mo.exports)),mo.exports}var xf,V1;function ja(){if(V1)return xf;V1=1;var e=kL(),t=lu(),n=ay(),r=n&&n.isTypedArray,i=r?t(r):e;return xf=i,xf}var yf,G1;function CE(){if(G1)return yf;G1=1;var e=_L(),t=_a(),n=ot(),r=Ms(),i=au(),s=ja(),o=Object.prototype,l=o.hasOwnProperty;function c(d,u){var f=n(d),p=!f&&t(d),h=!f&&!p&&r(d),x=!f&&!p&&!h&&s(d),g=f||p||h||x,w=g?e(d.length,String):[],v=w.length;for(var y in d)(u||l.call(d,y))&&!(g&&(y=="length"||h&&(y=="offset"||y=="parent")||x&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||i(y,v)))&&w.push(y);return w}return yf=c,yf}var bf,K1;function cu(){if(K1)return bf;K1=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,i=typeof r=="function"&&r.prototype||e;return n===i}return bf=t,bf}var wf,Y1;function EE(){if(Y1)return wf;Y1=1;function e(t,n){return function(r){return t(n(r))}}return wf=e,wf}var _f,X1;function NL(){if(X1)return _f;X1=1;var e=EE(),t=e(Object.keys,Object);return _f=t,_f}var jf,Q1;function ly(){if(Q1)return jf;Q1=1;var e=cu(),t=NL(),n=Object.prototype,r=n.hasOwnProperty;function i(s){if(!e(s))return t(s);var o=[];for(var l in Object(s))r.call(s,l)&&l!="constructor"&&o.push(l);return o}return jf=i,jf}var Sf,Z1;function xr(){if(Z1)return Sf;Z1=1;var e=ba(),t=oy();function n(r){return r!=null&&t(r.length)&&!e(r)}return Sf=n,Sf}var kf,J1;function ei(){if(J1)return kf;J1=1;var e=CE(),t=ly(),n=xr();function r(i){return n(i)?e(i):t(i)}return kf=r,kf}var Nf,ew;function CL(){if(ew)return Nf;ew=1;var e=wa(),t=ei();function n(r,i){return r&&e(i,t(i),r)}return Nf=n,Nf}var Cf,tw;function EL(){if(tw)return Cf;tw=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return Cf=e,Cf}var Ef,nw;function TL(){if(nw)return Ef;nw=1;var e=yn(),t=cu(),n=EL(),r=Object.prototype,i=r.hasOwnProperty;function s(o){if(!e(o))return n(o);var l=t(o),c=[];for(var d in o)d=="constructor"&&(l||!i.call(o,d))||c.push(d);return c}return Ef=s,Ef}var Tf,rw;function Ai(){if(rw)return Tf;rw=1;var e=CE(),t=TL(),n=xr();function r(i){return n(i)?e(i,!0):t(i)}return Tf=r,Tf}var Rf,iw;function RL(){if(iw)return Rf;iw=1;var e=wa(),t=Ai();function n(r,i){return r&&e(i,t(i),r)}return Rf=n,Rf}var go={exports:{}};go.exports;var sw;function TE(){return sw||(sw=1,function(e,t){var n=Pn(),r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,o=s?n.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(go,go.exports)),go.exports}var Af,ow;function RE(){if(ow)return Af;ow=1;function e(t,n){var r=-1,i=t.length;for(n||(n=Array(i));++r<i;)n[r]=t[r];return n}return Af=e,Af}var If,aw;function AE(){if(aw)return If;aw=1;function e(t,n){for(var r=-1,i=t==null?0:t.length,s=0,o=[];++r<i;){var l=t[r];n(l,r,t)&&(o[s++]=l)}return o}return If=e,If}var Mf,lw;function IE(){if(lw)return Mf;lw=1;function e(){return[]}return Mf=e,Mf}var Pf,cw;function cy(){if(cw)return Pf;cw=1;var e=AE(),t=IE(),n=Object.prototype,r=n.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),e(i(o),function(l){return r.call(o,l)}))}:t;return Pf=s,Pf}var Of,uw;function AL(){if(uw)return Of;uw=1;var e=wa(),t=cy();function n(r,i){return e(r,t(r),i)}return Of=n,Of}var Df,dw;function uy(){if(dw)return Df;dw=1;function e(t,n){for(var r=-1,i=n.length,s=t.length;++r<i;)t[s+r]=n[r];return t}return Df=e,Df}var Lf,fw;function uu(){if(fw)return Lf;fw=1;var e=EE(),t=e(Object.getPrototypeOf,Object);return Lf=t,Lf}var Ff,pw;function ME(){if(pw)return Ff;pw=1;var e=uy(),t=uu(),n=cy(),r=IE(),i=Object.getOwnPropertySymbols,s=i?function(o){for(var l=[];o;)e(l,n(o)),o=t(o);return l}:r;return Ff=s,Ff}var zf,hw;function IL(){if(hw)return zf;hw=1;var e=wa(),t=ME();function n(r,i){return e(r,t(r),i)}return zf=n,zf}var qf,mw;function PE(){if(mw)return qf;mw=1;var e=uy(),t=ot();function n(r,i,s){var o=i(r);return t(r)?o:e(o,s(r))}return qf=n,qf}var $f,gw;function OE(){if(gw)return $f;gw=1;var e=PE(),t=cy(),n=ei();function r(i){return e(i,n,t)}return $f=r,$f}var Bf,vw;function ML(){if(vw)return Bf;vw=1;var e=PE(),t=ME(),n=Ai();function r(i){return e(i,n,t)}return Bf=r,Bf}var Hf,xw;function PL(){if(xw)return Hf;xw=1;var e=Ri(),t=Pn(),n=e(t,"DataView");return Hf=n,Hf}var Wf,yw;function OL(){if(yw)return Wf;yw=1;var e=Ri(),t=Pn(),n=e(t,"Promise");return Wf=n,Wf}var Uf,bw;function DE(){if(bw)return Uf;bw=1;var e=Ri(),t=Pn(),n=e(t,"Set");return Uf=n,Uf}var Vf,ww;function DL(){if(ww)return Vf;ww=1;var e=Ri(),t=Pn(),n=e(t,"WeakMap");return Vf=n,Vf}var Gf,_w;function Ps(){if(_w)return Gf;_w=1;var e=PL(),t=ry(),n=OL(),r=DE(),i=DL(),s=Ti(),o=kE(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=o(e),x=o(t),g=o(n),w=o(r),v=o(i),y=s;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||n&&y(n.resolve())!=d||r&&y(new r)!=u||i&&y(new i)!=f)&&(y=function(b){var _=s(b),j=_==c?b.constructor:void 0,k=j?o(j):"";if(k)switch(k){case h:return p;case x:return l;case g:return d;case w:return u;case v:return f}return _}),Gf=y,Gf}var Kf,jw;function LL(){if(jw)return Kf;jw=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r){var i=r.length,s=new r.constructor(i);return i&&typeof r[0]=="string"&&t.call(r,"index")&&(s.index=r.index,s.input=r.input),s}return Kf=n,Kf}var Yf,Sw;function LE(){if(Sw)return Yf;Sw=1;var e=Pn(),t=e.Uint8Array;return Yf=t,Yf}var Xf,kw;function dy(){if(kw)return Xf;kw=1;var e=LE();function t(n){var r=new n.constructor(n.byteLength);return new e(r).set(new e(n)),r}return Xf=t,Xf}var Qf,Nw;function FL(){if(Nw)return Qf;Nw=1;var e=dy();function t(n,r){var i=r?e(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.byteLength)}return Qf=t,Qf}var Zf,Cw;function zL(){if(Cw)return Zf;Cw=1;var e=/\w*$/;function t(n){var r=new n.constructor(n.source,e.exec(n));return r.lastIndex=n.lastIndex,r}return Zf=t,Zf}var Jf,Ew;function qL(){if(Ew)return Jf;Ew=1;var e=Is(),t=e?e.prototype:void 0,n=t?t.valueOf:void 0;function r(i){return n?Object(n.call(i)):{}}return Jf=r,Jf}var ep,Tw;function FE(){if(Tw)return ep;Tw=1;var e=dy();function t(n,r){var i=r?e(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.length)}return ep=t,ep}var tp,Rw;function $L(){if(Rw)return tp;Rw=1;var e=dy(),t=FL(),n=zL(),r=qL(),i=FE(),s="[object Boolean]",o="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",x="[object DataView]",g="[object Float32Array]",w="[object Float64Array]",v="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",_="[object Uint8Array]",j="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]";function E(S,R,T){var M=S.constructor;switch(R){case h:return e(S);case s:case o:return new M(+S);case x:return t(S,T);case g:case w:case v:case y:case b:case _:case j:case k:case N:return i(S,T);case l:return new M;case c:case f:return new M(S);case d:return n(S);case u:return new M;case p:return r(S)}}return tp=E,tp}var np,Aw;function zE(){if(Aw)return np;Aw=1;var e=yn(),t=Object.create,n=function(){function r(){}return function(i){if(!e(i))return{};if(t)return t(i);r.prototype=i;var s=new r;return r.prototype=void 0,s}}();return np=n,np}var rp,Iw;function qE(){if(Iw)return rp;Iw=1;var e=zE(),t=uu(),n=cu();function r(i){return typeof i.constructor=="function"&&!n(i)?e(t(i)):{}}return rp=r,rp}var ip,Mw;function BL(){if(Mw)return ip;Mw=1;var e=Ps(),t=Yn(),n="[object Map]";function r(i){return t(i)&&e(i)==n}return ip=r,ip}var sp,Pw;function HL(){if(Pw)return sp;Pw=1;var e=BL(),t=lu(),n=ay(),r=n&&n.isMap,i=r?t(r):e;return sp=i,sp}var op,Ow;function WL(){if(Ow)return op;Ow=1;var e=Ps(),t=Yn(),n="[object Set]";function r(i){return t(i)&&e(i)==n}return op=r,op}var ap,Dw;function UL(){if(Dw)return ap;Dw=1;var e=WL(),t=lu(),n=ay(),r=n&&n.isSet,i=r?t(r):e;return ap=i,ap}var lp,Lw;function $E(){if(Lw)return lp;Lw=1;var e=iu(),t=sy(),n=ou(),r=CL(),i=RL(),s=TE(),o=RE(),l=AL(),c=IL(),d=OE(),u=ML(),f=Ps(),p=LL(),h=$L(),x=qE(),g=ot(),w=Ms(),v=HL(),y=yn(),b=UL(),_=ei(),j=Ai(),k=1,N=2,E=4,S="[object Arguments]",R="[object Array]",T="[object Boolean]",M="[object Date]",z="[object Error]",C="[object Function]",L="[object GeneratorFunction]",P="[object Map]",$="[object Number]",O="[object Object]",A="[object RegExp]",F="[object Set]",I="[object String]",q="[object Symbol]",W="[object WeakMap]",U="[object ArrayBuffer]",Z="[object DataView]",B="[object Float32Array]",ne="[object Float64Array]",se="[object Int8Array]",ce="[object Int16Array]",J="[object Int32Array]",_e="[object Uint8Array]",G="[object Uint8ClampedArray]",xe="[object Uint16Array]",fe="[object Uint32Array]",oe={};oe[S]=oe[R]=oe[U]=oe[Z]=oe[T]=oe[M]=oe[B]=oe[ne]=oe[se]=oe[ce]=oe[J]=oe[P]=oe[$]=oe[O]=oe[A]=oe[F]=oe[I]=oe[q]=oe[_e]=oe[G]=oe[xe]=oe[fe]=!0,oe[z]=oe[C]=oe[W]=!1;function ve(Y,Q,pe,he,we,ye){var te,me=Q&k,Ge=Q&N,Fe=Q&E;if(pe&&(te=we?pe(Y,he,we,ye):pe(Y)),te!==void 0)return te;if(!y(Y))return Y;var $e=g(Y);if($e){if(te=p(Y),!me)return o(Y,te)}else{var Te=f(Y),Be=Te==C||Te==L;if(w(Y))return s(Y,me);if(Te==O||Te==S||Be&&!we){if(te=Ge||Be?{}:x(Y),!me)return Ge?c(Y,i(te,Y)):l(Y,r(te,Y))}else{if(!oe[Te])return we?Y:{};te=h(Y,Te,me)}}ye||(ye=new e);var at=ye.get(Y);if(at)return at;ye.set(Y,te),b(Y)?Y.forEach(function(Pe){te.add(ve(Pe,Q,pe,Pe,Y,ye))}):v(Y)&&Y.forEach(function(Pe,ge){te.set(ge,ve(Pe,Q,pe,ge,Y,ye))});var Re=Fe?Ge?u:d:Ge?j:_,X=$e?void 0:Re(Y);return t(X||Y,function(Pe,ge){X&&(ge=Pe,Pe=Y[ge]),n(te,ge,ve(Pe,Q,pe,ge,Y,ye))}),te}return lp=ve,lp}var cp,Fw;function VL(){if(Fw)return cp;Fw=1;var e=$E(),t=4;function n(r){return e(r,t)}return cp=n,cp}var up,zw;function fy(){if(zw)return up;zw=1;function e(t){return function(){return t}}return up=e,up}var dp,qw;function GL(){if(qw)return dp;qw=1;function e(t){return function(n,r,i){for(var s=-1,o=Object(n),l=i(n),c=l.length;c--;){var d=l[t?c:++s];if(r(o[d],d,o)===!1)break}return n}}return dp=e,dp}var fp,$w;function py(){if($w)return fp;$w=1;var e=GL(),t=e();return fp=t,fp}var pp,Bw;function hy(){if(Bw)return pp;Bw=1;var e=py(),t=ei();function n(r,i){return r&&e(r,i,t)}return pp=n,pp}var hp,Hw;function KL(){if(Hw)return hp;Hw=1;var e=xr();function t(n,r){return function(i,s){if(i==null)return i;if(!e(i))return n(i,s);for(var o=i.length,l=r?o:-1,c=Object(i);(r?l--:++l<o)&&s(c[l],l,c)!==!1;);return i}}return hp=t,hp}var mp,Ww;function du(){if(Ww)return mp;Ww=1;var e=hy(),t=KL(),n=t(e);return mp=n,mp}var gp,Uw;function Ii(){if(Uw)return gp;Uw=1;function e(t){return t}return gp=e,gp}var vp,Vw;function BE(){if(Vw)return vp;Vw=1;var e=Ii();function t(n){return typeof n=="function"?n:e}return vp=t,vp}var xp,Gw;function HE(){if(Gw)return xp;Gw=1;var e=sy(),t=du(),n=BE(),r=ot();function i(s,o){var l=r(s)?e:t;return l(s,n(o))}return xp=i,xp}var yp,Kw;function WE(){return Kw||(Kw=1,yp=HE()),yp}var bp,Yw;function YL(){if(Yw)return bp;Yw=1;var e=du();function t(n,r){var i=[];return e(n,function(s,o,l){r(s,o,l)&&i.push(s)}),i}return bp=t,bp}var wp,Xw;function XL(){if(Xw)return wp;Xw=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return wp=t,wp}var _p,Qw;function QL(){if(Qw)return _p;Qw=1;function e(t){return this.__data__.has(t)}return _p=e,_p}var jp,Zw;function UE(){if(Zw)return jp;Zw=1;var e=iy(),t=XL(),n=QL();function r(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new e;++s<o;)this.add(i[s])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,jp=r,jp}var Sp,Jw;function ZL(){if(Jw)return Sp;Jw=1;function e(t,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(n(t[r],r,t))return!0;return!1}return Sp=e,Sp}var kp,e_;function VE(){if(e_)return kp;e_=1;function e(t,n){return t.has(n)}return kp=e,kp}var Np,t_;function GE(){if(t_)return Np;t_=1;var e=UE(),t=ZL(),n=VE(),r=1,i=2;function s(o,l,c,d,u,f){var p=c&r,h=o.length,x=l.length;if(h!=x&&!(p&&x>h))return!1;var g=f.get(o),w=f.get(l);if(g&&w)return g==l&&w==o;var v=-1,y=!0,b=c&i?new e:void 0;for(f.set(o,l),f.set(l,o);++v<h;){var _=o[v],j=l[v];if(d)var k=p?d(j,_,v,l,o,f):d(_,j,v,o,l,f);if(k!==void 0){if(k)continue;y=!1;break}if(b){if(!t(l,function(N,E){if(!n(b,E)&&(_===N||u(_,N,c,d,f)))return b.push(E)})){y=!1;break}}else if(!(_===j||u(_,j,c,d,f))){y=!1;break}}return f.delete(o),f.delete(l),y}return Np=s,Np}var Cp,n_;function JL(){if(n_)return Cp;n_=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(i,s){r[++n]=[s,i]}),r}return Cp=e,Cp}var Ep,r_;function my(){if(r_)return Ep;r_=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(i){r[++n]=i}),r}return Ep=e,Ep}var Tp,i_;function e8(){if(i_)return Tp;i_=1;var e=Is(),t=LE(),n=As(),r=GE(),i=JL(),s=my(),o=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",x="[object Set]",g="[object String]",w="[object Symbol]",v="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,_=b?b.valueOf:void 0;function j(k,N,E,S,R,T,M){switch(E){case y:if(k.byteLength!=N.byteLength||k.byteOffset!=N.byteOffset)return!1;k=k.buffer,N=N.buffer;case v:return!(k.byteLength!=N.byteLength||!T(new t(k),new t(N)));case c:case d:case p:return n(+k,+N);case u:return k.name==N.name&&k.message==N.message;case h:case g:return k==N+"";case f:var z=i;case x:var C=S&o;if(z||(z=s),k.size!=N.size&&!C)return!1;var L=M.get(k);if(L)return L==N;S|=l,M.set(k,N);var P=r(z(k),z(N),S,R,T,M);return M.delete(k),P;case w:if(_)return _.call(k)==_.call(N)}return!1}return Tp=j,Tp}var Rp,s_;function t8(){if(s_)return Rp;s_=1;var e=OE(),t=1,n=Object.prototype,r=n.hasOwnProperty;function i(s,o,l,c,d,u){var f=l&t,p=e(s),h=p.length,x=e(o),g=x.length;if(h!=g&&!f)return!1;for(var w=h;w--;){var v=p[w];if(!(f?v in o:r.call(o,v)))return!1}var y=u.get(s),b=u.get(o);if(y&&b)return y==o&&b==s;var _=!0;u.set(s,o),u.set(o,s);for(var j=f;++w<h;){v=p[w];var k=s[v],N=o[v];if(c)var E=f?c(N,k,v,o,s,u):c(k,N,v,s,o,u);if(!(E===void 0?k===N||d(k,N,l,c,u):E)){_=!1;break}j||(j=v=="constructor")}if(_&&!j){var S=s.constructor,R=o.constructor;S!=R&&"constructor"in s&&"constructor"in o&&!(typeof S=="function"&&S instanceof S&&typeof R=="function"&&R instanceof R)&&(_=!1)}return u.delete(s),u.delete(o),_}return Rp=i,Rp}var Ap,o_;function n8(){if(o_)return Ap;o_=1;var e=iu(),t=GE(),n=e8(),r=t8(),i=Ps(),s=ot(),o=Ms(),l=ja(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function x(g,w,v,y,b,_){var j=s(g),k=s(w),N=j?u:i(g),E=k?u:i(w);N=N==d?f:N,E=E==d?f:E;var S=N==f,R=E==f,T=N==E;if(T&&o(g)){if(!o(w))return!1;j=!0,S=!1}if(T&&!S)return _||(_=new e),j||l(g)?t(g,w,v,y,b,_):n(g,w,N,v,y,b,_);if(!(v&c)){var M=S&&h.call(g,"__wrapped__"),z=R&&h.call(w,"__wrapped__");if(M||z){var C=M?g.value():g,L=z?w.value():w;return _||(_=new e),b(C,L,v,y,_)}}return T?(_||(_=new e),r(g,w,v,y,b,_)):!1}return Ap=x,Ap}var Ip,a_;function KE(){if(a_)return Ip;a_=1;var e=n8(),t=Yn();function n(r,i,s,o,l){return r===i?!0:r==null||i==null||!t(r)&&!t(i)?r!==r&&i!==i:e(r,i,s,o,n,l)}return Ip=n,Ip}var Mp,l_;function r8(){if(l_)return Mp;l_=1;var e=iu(),t=KE(),n=1,r=2;function i(s,o,l,c){var d=l.length,u=d,f=!c;if(s==null)return!u;for(s=Object(s);d--;){var p=l[d];if(f&&p[2]?p[1]!==s[p[0]]:!(p[0]in s))return!1}for(;++d<u;){p=l[d];var h=p[0],x=s[h],g=p[1];if(f&&p[2]){if(x===void 0&&!(h in s))return!1}else{var w=new e;if(c)var v=c(x,g,h,s,o,w);if(!(v===void 0?t(g,x,n|r,c,w):v))return!1}}return!0}return Mp=i,Mp}var Pp,c_;function YE(){if(c_)return Pp;c_=1;var e=yn();function t(n){return n===n&&!e(n)}return Pp=t,Pp}var Op,u_;function i8(){if(u_)return Op;u_=1;var e=YE(),t=ei();function n(r){for(var i=t(r),s=i.length;s--;){var o=i[s],l=r[o];i[s]=[o,l,e(l)]}return i}return Op=n,Op}var Dp,d_;function XE(){if(d_)return Dp;d_=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return Dp=e,Dp}var Lp,f_;function s8(){if(f_)return Lp;f_=1;var e=r8(),t=i8(),n=XE();function r(i){var s=t(i);return s.length==1&&s[0][2]?n(s[0][0],s[0][1]):function(o){return o===i||e(o,i,s)}}return Lp=r,Lp}var Fp,p_;function Os(){if(p_)return Fp;p_=1;var e=Ti(),t=Yn(),n="[object Symbol]";function r(i){return typeof i=="symbol"||t(i)&&e(i)==n}return Fp=r,Fp}var zp,h_;function gy(){if(h_)return zp;h_=1;var e=ot(),t=Os(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(s,o){if(e(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:r.test(s)||!n.test(s)||o!=null&&s in Object(o)}return zp=i,zp}var qp,m_;function o8(){if(m_)return qp;m_=1;var e=iy(),t="Expected a function";function n(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var d=r.apply(this,o);return s.cache=c.set(l,d)||c,d};return s.cache=new(n.Cache||e),s}return n.Cache=e,qp=n,qp}var $p,g_;function a8(){if(g_)return $p;g_=1;var e=o8(),t=500;function n(r){var i=e(r,function(o){return s.size===t&&s.clear(),o}),s=i.cache;return i}return $p=n,$p}var Bp,v_;function l8(){if(v_)return Bp;v_=1;var e=a8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(t,function(o,l,c,d){s.push(c?d.replace(n,"$1"):l||o)}),s});return Bp=r,Bp}var Hp,x_;function fu(){if(x_)return Hp;x_=1;function e(t,n){for(var r=-1,i=t==null?0:t.length,s=Array(i);++r<i;)s[r]=n(t[r],r,t);return s}return Hp=e,Hp}var Wp,y_;function c8(){if(y_)return Wp;y_=1;var e=Is(),t=fu(),n=ot(),r=Os(),i=e?e.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(n(l))return t(l,o)+"";if(r(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Wp=o,Wp}var Up,b_;function QE(){if(b_)return Up;b_=1;var e=c8();function t(n){return n==null?"":e(n)}return Up=t,Up}var Vp,w_;function pu(){if(w_)return Vp;w_=1;var e=ot(),t=gy(),n=l8(),r=QE();function i(s,o){return e(s)?s:t(s,o)?[s]:n(r(s))}return Vp=i,Vp}var Gp,__;function Sa(){if(__)return Gp;__=1;var e=Os();function t(n){if(typeof n=="string"||e(n))return n;var r=n+"";return r=="0"&&1/n==-1/0?"-0":r}return Gp=t,Gp}var Kp,j_;function hu(){if(j_)return Kp;j_=1;var e=pu(),t=Sa();function n(r,i){i=e(i,r);for(var s=0,o=i.length;r!=null&&s<o;)r=r[t(i[s++])];return s&&s==o?r:void 0}return Kp=n,Kp}var Yp,S_;function u8(){if(S_)return Yp;S_=1;var e=hu();function t(n,r,i){var s=n==null?void 0:e(n,r);return s===void 0?i:s}return Yp=t,Yp}var Xp,k_;function d8(){if(k_)return Xp;k_=1;function e(t,n){return t!=null&&n in Object(t)}return Xp=e,Xp}var Qp,N_;function ZE(){if(N_)return Qp;N_=1;var e=pu(),t=_a(),n=ot(),r=au(),i=oy(),s=Sa();function o(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=s(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&i(f)&&r(h,f)&&(n(l)||t(l)))}return Qp=o,Qp}var Zp,C_;function JE(){if(C_)return Zp;C_=1;var e=d8(),t=ZE();function n(r,i){return r!=null&&t(r,i,e)}return Zp=n,Zp}var Jp,E_;function f8(){if(E_)return Jp;E_=1;var e=KE(),t=u8(),n=JE(),r=gy(),i=YE(),s=XE(),o=Sa(),l=1,c=2;function d(u,f){return r(u)&&i(f)?s(o(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?n(p,u):e(f,h,l|c)}}return Jp=d,Jp}var eh,T_;function eT(){if(T_)return eh;T_=1;function e(t){return function(n){return n==null?void 0:n[t]}}return eh=e,eh}var th,R_;function p8(){if(R_)return th;R_=1;var e=hu();function t(n){return function(r){return e(r,n)}}return th=t,th}var nh,A_;function h8(){if(A_)return nh;A_=1;var e=eT(),t=p8(),n=gy(),r=Sa();function i(s){return n(s)?e(r(s)):t(s)}return nh=i,nh}var rh,I_;function yr(){if(I_)return rh;I_=1;var e=s8(),t=f8(),n=Ii(),r=ot(),i=h8();function s(o){return typeof o=="function"?o:o==null?n:typeof o=="object"?r(o)?t(o[0],o[1]):e(o):i(o)}return rh=s,rh}var ih,M_;function tT(){if(M_)return ih;M_=1;var e=AE(),t=YL(),n=yr(),r=ot();function i(s,o){var l=r(s)?e:t;return l(s,n(o,3))}return ih=i,ih}var sh,P_;function m8(){if(P_)return sh;P_=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r,i){return r!=null&&t.call(r,i)}return sh=n,sh}var oh,O_;function nT(){if(O_)return oh;O_=1;var e=m8(),t=ZE();function n(r,i){return r!=null&&t(r,i,e)}return oh=n,oh}var ah,D_;function g8(){if(D_)return ah;D_=1;var e=ly(),t=Ps(),n=_a(),r=ot(),i=xr(),s=Ms(),o=cu(),l=ja(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(i(h)&&(r(h)||typeof h=="string"||typeof h.splice=="function"||s(h)||l(h)||n(h)))return!h.length;var x=t(h);if(x==c||x==d)return!h.size;if(o(h))return!e(h).length;for(var g in h)if(f.call(h,g))return!1;return!0}return ah=p,ah}var lh,L_;function rT(){if(L_)return lh;L_=1;function e(t){return t===void 0}return lh=e,lh}var ch,F_;function iT(){if(F_)return ch;F_=1;var e=du(),t=xr();function n(r,i){var s=-1,o=t(r)?Array(r.length):[];return e(r,function(l,c,d){o[++s]=i(l,c,d)}),o}return ch=n,ch}var uh,z_;function sT(){if(z_)return uh;z_=1;var e=fu(),t=yr(),n=iT(),r=ot();function i(s,o){var l=r(s)?e:n;return l(s,t(o,3))}return uh=i,uh}var dh,q_;function v8(){if(q_)return dh;q_=1;function e(t,n,r,i){var s=-1,o=t==null?0:t.length;for(i&&o&&(r=t[++s]);++s<o;)r=n(r,t[s],s,t);return r}return dh=e,dh}var fh,$_;function x8(){if($_)return fh;$_=1;function e(t,n,r,i,s){return s(t,function(o,l,c){r=i?(i=!1,o):n(r,o,l,c)}),r}return fh=e,fh}var ph,B_;function oT(){if(B_)return ph;B_=1;var e=v8(),t=du(),n=yr(),r=x8(),i=ot();function s(o,l,c){var d=i(o)?e:r,u=arguments.length<3;return d(o,n(l,4),c,u,t)}return ph=s,ph}var hh,H_;function y8(){if(H_)return hh;H_=1;var e=Ti(),t=ot(),n=Yn(),r="[object String]";function i(s){return typeof s=="string"||!t(s)&&n(s)&&e(s)==r}return hh=i,hh}var mh,W_;function b8(){if(W_)return mh;W_=1;var e=eT(),t=e("length");return mh=t,mh}var gh,U_;function w8(){if(U_)return gh;U_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,s="\\ufe0e\\ufe0f",o="\\u200d",l=RegExp("["+o+e+i+s+"]");function c(d){return l.test(d)}return gh=c,gh}var vh,V_;function _8(){if(V_)return vh;V_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,s="\\ufe0e\\ufe0f",o="["+e+"]",l="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",x=d+"?",g="["+s+"]?",w="(?:"+h+"(?:"+[u,f,p].join("|")+")"+g+x+")*",v=g+x+w,y="(?:"+[u+l+"?",l,f,p,o].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+v,"g");function _(j){for(var k=b.lastIndex=0;b.test(j);)++k;return k}return vh=_,vh}var xh,G_;function j8(){if(G_)return xh;G_=1;var e=b8(),t=w8(),n=_8();function r(i){return t(i)?n(i):e(i)}return xh=r,xh}var yh,K_;function S8(){if(K_)return yh;K_=1;var e=ly(),t=Ps(),n=xr(),r=y8(),i=j8(),s="[object Map]",o="[object Set]";function l(c){if(c==null)return 0;if(n(c))return r(c)?i(c):c.length;var d=t(c);return d==s||d==o?c.size:e(c).length}return yh=l,yh}var bh,Y_;function k8(){if(Y_)return bh;Y_=1;var e=sy(),t=zE(),n=hy(),r=yr(),i=uu(),s=ot(),o=Ms(),l=ba(),c=yn(),d=ja();function u(f,p,h){var x=s(f),g=x||o(f)||d(f);if(p=r(p,4),h==null){var w=f&&f.constructor;g?h=x?new w:[]:c(f)?h=l(w)?t(i(f)):{}:h={}}return(g?e:n)(f,function(v,y,b){return p(h,v,y,b)}),h}return bh=u,bh}var wh,X_;function N8(){if(X_)return wh;X_=1;var e=Is(),t=_a(),n=ot(),r=e?e.isConcatSpreadable:void 0;function i(s){return n(s)||t(s)||!!(r&&s&&s[r])}return wh=i,wh}var _h,Q_;function vy(){if(Q_)return _h;Q_=1;var e=uy(),t=N8();function n(r,i,s,o,l){var c=-1,d=r.length;for(s||(s=t),l||(l=[]);++c<d;){var u=r[c];i>0&&s(u)?i>1?n(u,i-1,s,o,l):e(l,u):o||(l[l.length]=u)}return l}return _h=n,_h}var jh,Z_;function C8(){if(Z_)return jh;Z_=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return jh=e,jh}var Sh,J_;function aT(){if(J_)return Sh;J_=1;var e=C8(),t=Math.max;function n(r,i,s){return i=t(i===void 0?r.length-1:i,0),function(){for(var o=arguments,l=-1,c=t(o.length-i,0),d=Array(c);++l<c;)d[l]=o[i+l];l=-1;for(var u=Array(i+1);++l<i;)u[l]=o[l];return u[i]=s(d),e(r,this,u)}}return Sh=n,Sh}var kh,e2;function E8(){if(e2)return kh;e2=1;var e=fy(),t=NE(),n=Ii(),r=t?function(i,s){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(s),writable:!0})}:n;return kh=r,kh}var Nh,t2;function T8(){if(t2)return Nh;t2=1;var e=800,t=16,n=Date.now;function r(i){var s=0,o=0;return function(){var l=n(),c=t-(l-o);if(o=l,c>0){if(++s>=e)return arguments[0]}else s=0;return i.apply(void 0,arguments)}}return Nh=r,Nh}var Ch,n2;function lT(){if(n2)return Ch;n2=1;var e=E8(),t=T8(),n=t(e);return Ch=n,Ch}var Eh,r2;function mu(){if(r2)return Eh;r2=1;var e=Ii(),t=aT(),n=lT();function r(i,s){return n(t(i,s,e),i+"")}return Eh=r,Eh}var Th,i2;function cT(){if(i2)return Th;i2=1;function e(t,n,r,i){for(var s=t.length,o=r+(i?1:-1);i?o--:++o<s;)if(n(t[o],o,t))return o;return-1}return Th=e,Th}var Rh,s2;function R8(){if(s2)return Rh;s2=1;function e(t){return t!==t}return Rh=e,Rh}var Ah,o2;function A8(){if(o2)return Ah;o2=1;function e(t,n,r){for(var i=r-1,s=t.length;++i<s;)if(t[i]===n)return i;return-1}return Ah=e,Ah}var Ih,a2;function I8(){if(a2)return Ih;a2=1;var e=cT(),t=R8(),n=A8();function r(i,s,o){return s===s?n(i,s,o):e(i,t,o)}return Ih=r,Ih}var Mh,l2;function M8(){if(l2)return Mh;l2=1;var e=I8();function t(n,r){var i=n==null?0:n.length;return!!i&&e(n,r,0)>-1}return Mh=t,Mh}var Ph,c2;function P8(){if(c2)return Ph;c2=1;function e(t,n,r){for(var i=-1,s=t==null?0:t.length;++i<s;)if(r(n,t[i]))return!0;return!1}return Ph=e,Ph}var Oh,u2;function O8(){if(u2)return Oh;u2=1;function e(){}return Oh=e,Oh}var Dh,d2;function D8(){if(d2)return Dh;d2=1;var e=DE(),t=O8(),n=my(),r=1/0,i=e&&1/n(new e([,-0]))[1]==r?function(s){return new e(s)}:t;return Dh=i,Dh}var Lh,f2;function L8(){if(f2)return Lh;f2=1;var e=UE(),t=M8(),n=P8(),r=VE(),i=D8(),s=my(),o=200;function l(c,d,u){var f=-1,p=t,h=c.length,x=!0,g=[],w=g;if(u)x=!1,p=n;else if(h>=o){var v=d?null:i(c);if(v)return s(v);x=!1,p=r,w=new e}else w=d?[]:g;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,x&&b===b){for(var _=w.length;_--;)if(w[_]===b)continue e;d&&w.push(b),g.push(y)}else p(w,b,u)||(w!==g&&w.push(b),g.push(y))}return g}return Lh=l,Lh}var Fh,p2;function uT(){if(p2)return Fh;p2=1;var e=xr(),t=Yn();function n(r){return t(r)&&e(r)}return Fh=n,Fh}var zh,h2;function F8(){if(h2)return zh;h2=1;var e=vy(),t=mu(),n=L8(),r=uT(),i=t(function(s){return n(e(s,1,r,!0))});return zh=i,zh}var qh,m2;function z8(){if(m2)return qh;m2=1;var e=fu();function t(n,r){return e(r,function(i){return n[i]})}return qh=t,qh}var $h,g2;function dT(){if(g2)return $h;g2=1;var e=z8(),t=ei();function n(r){return r==null?[]:e(r,t(r))}return $h=n,$h}var Bh,v2;function bn(){if(v2)return Bh;v2=1;var e;if(typeof ny=="function")try{e={clone:VL(),constant:fy(),each:WE(),filter:tT(),has:nT(),isArray:ot(),isEmpty:g8(),isFunction:ba(),isUndefined:rT(),keys:ei(),map:sT(),reduce:oT(),size:S8(),transform:k8(),union:F8(),values:dT()}}catch{}return e||(e=window._),Bh=e,Bh}var Hh,x2;function xy(){if(x2)return Hh;x2=1;var e=bn();Hh=i;var t="\0",n="\0",r="";function i(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[n]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},i.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},i.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(x){p.length>1?h.setNode(x,f):h.setNode(x)}),this},i.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=n,this._children[u]={},this._children[n][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return e.has(this._nodes,u)},i.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=n;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==n)return f}},i.prototype.children=function(u){if(e.isUndefined(u)&&(u=n),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===n)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},i.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},i.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},i.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},i.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(g,w){u(w)&&f.setNode(w,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,p.edge(g))});var h={};function x(g){var w=p.parent(g);return w===void 0||f.hasNode(w)?(h[g]=w,w):w in h?h[w]:x(w)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,x(g))}),f},i.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(x,g){return h.length>1?p.setEdge(x,g,f):p.setEdge(x,g),g}),this},i.prototype.setEdge=function(){var u,f,p,h,x=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(u=g.v,f=g.w,p=g.name,arguments.length===2&&(h=arguments[1],x=!0)):(u=g,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],x=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var w=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,w))return x&&(this._edgeLabels[w]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[w]=x?h:this._defaultEdgeLabelFn(u,f,p);var v=c(this._isDirected,u,f,p);return u=v.v,f=v.w,Object.freeze(v),this._edgeObjs[w]=v,s(this._preds[f],u),s(this._sucs[u],f),this._in[f][w]=v,this._out[u][w]=v,this._edgeCount++,this},i.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},i.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),x=this._edgeObjs[h];return x&&(u=x.v,f=x.w,delete this._edgeLabels[h],delete this._edgeObjs[h],o(this._preds[f],u),o(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},i.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.v===f}):h}},i.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.w===f}):h}},i.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function s(u,f){u[f]?u[f]++:u[f]=1}function o(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var x=""+f,g=""+p;if(!u&&x>g){var w=x;x=g,g=w}return x+r+g+r+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var x=""+f,g=""+p;if(!u&&x>g){var w=x;x=g,g=w}var v={v:x,w:g};return h&&(v.name=h),v}function d(u,f){return l(u,f.v,f.w,f.name)}return Hh}var Wh,y2;function q8(){return y2||(y2=1,Wh="2.1.8"),Wh}var Uh,b2;function $8(){return b2||(b2=1,Uh={Graph:xy(),version:q8()}),Uh}var Vh,w2;function B8(){if(w2)return Vh;w2=1;var e=bn(),t=xy();Vh={write:n,read:s};function n(o){var l={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:r(o),edges:i(o)};return e.isUndefined(o.graph())||(l.value=e.clone(o.graph())),l}function r(o){return e.map(o.nodes(),function(l){var c=o.node(l),d=o.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function i(o){return e.map(o.edges(),function(l){var c=o.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function s(o){var l=new t(o.options).setGraph(o.value);return e.each(o.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(o.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Vh}var Gh,_2;function H8(){if(_2)return Gh;_2=1;var e=bn();Gh=t;function t(n){var r={},i=[],s;function o(l){e.has(r,l)||(r[l]=!0,s.push(l),e.each(n.successors(l),o),e.each(n.predecessors(l),o))}return e.each(n.nodes(),function(l){s=[],o(l),s.length&&i.push(s)}),i}return Gh}var Kh,j2;function fT(){if(j2)return Kh;j2=1;var e=bn();Kh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(n){return n.key})},t.prototype.has=function(n){return e.has(this._keyIndices,n)},t.prototype.priority=function(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(n,r){var i=this._keyIndices;if(n=String(n),!e.has(i,n)){var s=this._arr,o=s.length;return i[n]=o,s.push({key:n,priority:r}),this._decrease(o),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key},t.prototype.decrease=function(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)},t.prototype._heapify=function(n){var r=this._arr,i=2*n,s=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,s<r.length&&(o=r[s].priority<r[o].priority?s:o),o!==n&&(this._swap(n,o),this._heapify(o)))},t.prototype._decrease=function(n){for(var r=this._arr,i=r[n].priority,s;n!==0&&(s=n>>1,!(r[s].priority<i));)this._swap(n,s),n=s},t.prototype._swap=function(n,r){var i=this._arr,s=this._keyIndices,o=i[n],l=i[r];i[n]=l,i[r]=o,s[l.key]=n,s[o.key]=r},Kh}var Yh,S2;function pT(){if(S2)return Yh;S2=1;var e=bn(),t=fT();Yh=r;var n=e.constant(1);function r(s,o,l,c){return i(s,String(o),l||n,c||function(d){return s.outEdges(d)})}function i(s,o,l,c){var d={},u=new t,f,p,h=function(x){var g=x.v!==f?x.v:x.w,w=d[g],v=l(x),y=p.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+x+" Weight: "+v);y<w.distance&&(w.distance=y,w.predecessor=f,u.decrease(g,y))};for(s.nodes().forEach(function(x){var g=x===o?0:Number.POSITIVE_INFINITY;d[x]={distance:g},u.add(x,g)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return Yh}var Xh,k2;function W8(){if(k2)return Xh;k2=1;var e=pT(),t=bn();Xh=n;function n(r,i,s){return t.transform(r.nodes(),function(o,l){o[l]=e(r,l,i,s)},{})}return Xh}var Qh,N2;function hT(){if(N2)return Qh;N2=1;var e=bn();Qh=t;function t(n){var r=0,i=[],s={},o=[];function l(c){var d=s[c]={onStack:!0,lowlink:r,index:r++};if(i.push(c),n.successors(c).forEach(function(p){e.has(s,p)?s[p].onStack&&(d.lowlink=Math.min(d.lowlink,s[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,s[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=i.pop(),s[f].onStack=!1,u.push(f);while(c!==f);o.push(u)}}return n.nodes().forEach(function(c){e.has(s,c)||l(c)}),o}return Qh}var Zh,C2;function U8(){if(C2)return Zh;C2=1;var e=bn(),t=hT();Zh=n;function n(r){return e.filter(t(r),function(i){return i.length>1||i.length===1&&r.hasEdge(i[0],i[0])})}return Zh}var Jh,E2;function V8(){if(E2)return Jh;E2=1;var e=bn();Jh=n;var t=e.constant(1);function n(i,s,o){return r(i,s||t,o||function(l){return i.outEdges(l)})}function r(i,s,o){var l={},c=i.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),o(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=s(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var x=p[d],g=u[h],w=p[h],v=x.distance+g.distance;v<w.distance&&(w.distance=v,w.predecessor=g.predecessor)})})}),l}return Jh}var em,T2;function mT(){if(T2)return em;T2=1;var e=bn();em=t,t.CycleException=n;function t(r){var i={},s={},o=[];function l(c){if(e.has(s,c))throw new n;e.has(i,c)||(s[c]=!0,i[c]=!0,e.each(r.predecessors(c),l),delete s[c],o.push(c))}if(e.each(r.sinks(),l),e.size(i)!==r.nodeCount())throw new n;return o}function n(){}return n.prototype=new Error,em}var tm,R2;function G8(){if(R2)return tm;R2=1;var e=mT();tm=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return tm}var nm,A2;function gT(){if(A2)return nm;A2=1;var e=bn();nm=t;function t(r,i,s){e.isArray(i)||(i=[i]);var o=(r.isDirected()?r.successors:r.neighbors).bind(r),l=[],c={};return e.each(i,function(d){if(!r.hasNode(d))throw new Error("Graph does not have node: "+d);n(r,d,s==="post",c,o,l)}),l}function n(r,i,s,o,l,c){e.has(o,i)||(o[i]=!0,s||c.push(i),e.each(l(i),function(d){n(r,d,s,o,l,c)}),s&&c.push(i))}return nm}var rm,I2;function K8(){if(I2)return rm;I2=1;var e=gT();rm=t;function t(n,r){return e(n,r,"post")}return rm}var im,M2;function Y8(){if(M2)return im;M2=1;var e=gT();im=t;function t(n,r){return e(n,r,"pre")}return im}var sm,P2;function X8(){if(P2)return sm;P2=1;var e=bn(),t=xy(),n=fT();sm=r;function r(i,s){var o=new t,l={},c=new n,d;function u(p){var h=p.v===d?p.w:p.v,x=c.priority(h);if(x!==void 0){var g=s(p);g<x&&(l[h]=d,c.decrease(h,g))}}if(i.nodeCount()===0)return o;e.each(i.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),o.setNode(p)}),c.decrease(i.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))o.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+i);f=!0}i.nodeEdges(d).forEach(u)}return o}return sm}var om,O2;function Q8(){return O2||(O2=1,om={components:H8(),dijkstra:pT(),dijkstraAll:W8(),findCycles:U8(),floydWarshall:V8(),isAcyclic:G8(),postorder:K8(),preorder:Y8(),prim:X8(),tarjan:hT(),topsort:mT()}),om}var am,D2;function Z8(){if(D2)return am;D2=1;var e=$8();return am={Graph:e.Graph,json:B8(),alg:Q8(),version:e.version},am}var fc;if(typeof ny=="function")try{fc=Z8()}catch{}fc||(fc=window.graphlib);var On=fc,lm,L2;function J8(){if(L2)return lm;L2=1;var e=$E(),t=1,n=4;function r(i){return e(i,t|n)}return lm=r,lm}var cm,F2;function gu(){if(F2)return cm;F2=1;var e=As(),t=xr(),n=au(),r=yn();function i(s,o,l){if(!r(l))return!1;var c=typeof o;return(c=="number"?t(l)&&n(o,l.length):c=="string"&&o in l)?e(l[o],s):!1}return cm=i,cm}var um,z2;function eF(){if(z2)return um;z2=1;var e=mu(),t=As(),n=gu(),r=Ai(),i=Object.prototype,s=i.hasOwnProperty,o=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&n(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=r(p),x=-1,g=h.length;++x<g;){var w=h[x],v=l[w];(v===void 0||t(v,i[w])&&!s.call(l,w))&&(l[w]=p[w])}return l});return um=o,um}var dm,q2;function tF(){if(q2)return dm;q2=1;var e=yr(),t=xr(),n=ei();function r(i){return function(s,o,l){var c=Object(s);if(!t(s)){var d=e(o,3);s=n(s),o=function(f){return d(c[f],f,c)}}var u=i(s,o,l);return u>-1?c[d?s[u]:u]:void 0}}return dm=r,dm}var fm,$2;function nF(){if($2)return fm;$2=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return fm=t,fm}var pm,B2;function rF(){if(B2)return pm;B2=1;var e=nF(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return pm=n,pm}var hm,H2;function iF(){if(H2)return hm;H2=1;var e=rF(),t=yn(),n=Os(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(n(d))return r;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=s.test(d);return f||o.test(d)?l(d.slice(2),f?2:8):i.test(d)?r:+d}return hm=c,hm}var mm,W2;function vT(){if(W2)return mm;W2=1;var e=iF(),t=1/0,n=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var s=i<0?-1:1;return s*n}return i===i?i:0}return mm=r,mm}var gm,U2;function sF(){if(U2)return gm;U2=1;var e=vT();function t(n){var r=e(n),i=r%1;return r===r?i?r-i:r:0}return gm=t,gm}var vm,V2;function oF(){if(V2)return vm;V2=1;var e=cT(),t=yr(),n=sF(),r=Math.max;function i(s,o,l){var c=s==null?0:s.length;if(!c)return-1;var d=l==null?0:n(l);return d<0&&(d=r(c+d,0)),e(s,t(o,3),d)}return vm=i,vm}var xm,G2;function aF(){if(G2)return xm;G2=1;var e=tF(),t=oF(),n=e(t);return xm=n,xm}var ym,K2;function xT(){if(K2)return ym;K2=1;var e=vy();function t(n){var r=n==null?0:n.length;return r?e(n,1):[]}return ym=t,ym}var bm,Y2;function lF(){if(Y2)return bm;Y2=1;var e=py(),t=BE(),n=Ai();function r(i,s){return i==null?i:e(i,t(s),n)}return bm=r,bm}var wm,X2;function cF(){if(X2)return wm;X2=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return wm=e,wm}var _m,Q2;function uF(){if(Q2)return _m;Q2=1;var e=su(),t=hy(),n=yr();function r(i,s){var o={};return s=n(s,3),t(i,function(l,c,d){e(o,c,s(l,c,d))}),o}return _m=r,_m}var jm,Z2;function yy(){if(Z2)return jm;Z2=1;var e=Os();function t(n,r,i){for(var s=-1,o=n.length;++s<o;){var l=n[s],c=r(l);if(c!=null&&(d===void 0?c===c&&!e(c):i(c,d)))var d=c,u=l}return u}return jm=t,jm}var Sm,J2;function dF(){if(J2)return Sm;J2=1;function e(t,n){return t>n}return Sm=e,Sm}var km,ej;function fF(){if(ej)return km;ej=1;var e=yy(),t=dF(),n=Ii();function r(i){return i&&i.length?e(i,n,t):void 0}return km=r,km}var Nm,tj;function yT(){if(tj)return Nm;tj=1;var e=su(),t=As();function n(r,i,s){(s!==void 0&&!t(r[i],s)||s===void 0&&!(i in r))&&e(r,i,s)}return Nm=n,Nm}var Cm,nj;function pF(){if(nj)return Cm;nj=1;var e=Ti(),t=uu(),n=Yn(),r="[object Object]",i=Function.prototype,s=Object.prototype,o=i.toString,l=s.hasOwnProperty,c=o.call(Object);function d(u){if(!n(u)||e(u)!=r)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&o.call(p)==c}return Cm=d,Cm}var Em,rj;function bT(){if(rj)return Em;rj=1;function e(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}return Em=e,Em}var Tm,ij;function hF(){if(ij)return Tm;ij=1;var e=wa(),t=Ai();function n(r){return e(r,t(r))}return Tm=n,Tm}var Rm,sj;function mF(){if(sj)return Rm;sj=1;var e=yT(),t=TE(),n=FE(),r=RE(),i=qE(),s=_a(),o=ot(),l=uT(),c=Ms(),d=ba(),u=yn(),f=pF(),p=ja(),h=bT(),x=hF();function g(w,v,y,b,_,j,k){var N=h(w,y),E=h(v,y),S=k.get(E);if(S){e(w,y,S);return}var R=j?j(N,E,y+"",w,v,k):void 0,T=R===void 0;if(T){var M=o(E),z=!M&&c(E),C=!M&&!z&&p(E);R=E,M||z||C?o(N)?R=N:l(N)?R=r(N):z?(T=!1,R=t(E,!0)):C?(T=!1,R=n(E,!0)):R=[]:f(E)||s(E)?(R=N,s(N)?R=x(N):(!u(N)||d(N))&&(R=i(E))):T=!1}T&&(k.set(E,R),_(R,E,b,j,k),k.delete(E)),e(w,y,R)}return Rm=g,Rm}var Am,oj;function gF(){if(oj)return Am;oj=1;var e=iu(),t=yT(),n=py(),r=mF(),i=yn(),s=Ai(),o=bT();function l(c,d,u,f,p){c!==d&&n(d,function(h,x){if(p||(p=new e),i(h))r(c,d,x,u,l,f,p);else{var g=f?f(o(c,x),h,x+"",c,d,p):void 0;g===void 0&&(g=h),t(c,x,g)}},s)}return Am=l,Am}var Im,aj;function vF(){if(aj)return Im;aj=1;var e=mu(),t=gu();function n(r){return e(function(i,s){var o=-1,l=s.length,c=l>1?s[l-1]:void 0,d=l>2?s[2]:void 0;for(c=r.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(s[0],s[1],d)&&(c=l<3?void 0:c,l=1),i=Object(i);++o<l;){var u=s[o];u&&r(i,u,o,c)}return i})}return Im=n,Im}var Mm,lj;function xF(){if(lj)return Mm;lj=1;var e=gF(),t=vF(),n=t(function(r,i,s){e(r,i,s)});return Mm=n,Mm}var Pm,cj;function wT(){if(cj)return Pm;cj=1;function e(t,n){return t<n}return Pm=e,Pm}var Om,uj;function yF(){if(uj)return Om;uj=1;var e=yy(),t=wT(),n=Ii();function r(i){return i&&i.length?e(i,n,t):void 0}return Om=r,Om}var Dm,dj;function bF(){if(dj)return Dm;dj=1;var e=yy(),t=yr(),n=wT();function r(i,s){return i&&i.length?e(i,t(s,2),n):void 0}return Dm=r,Dm}var Lm,fj;function wF(){if(fj)return Lm;fj=1;var e=Pn(),t=function(){return e.Date.now()};return Lm=t,Lm}var Fm,pj;function _F(){if(pj)return Fm;pj=1;var e=ou(),t=pu(),n=au(),r=yn(),i=Sa();function s(o,l,c,d){if(!r(o))return o;l=t(l,o);for(var u=-1,f=l.length,p=f-1,h=o;h!=null&&++u<f;){var x=i(l[u]),g=c;if(x==="__proto__"||x==="constructor"||x==="prototype")return o;if(u!=p){var w=h[x];g=d?d(w,x,h):void 0,g===void 0&&(g=r(w)?w:n(l[u+1])?[]:{})}e(h,x,g),h=h[x]}return o}return Fm=s,Fm}var zm,hj;function jF(){if(hj)return zm;hj=1;var e=hu(),t=_F(),n=pu();function r(i,s,o){for(var l=-1,c=s.length,d={};++l<c;){var u=s[l],f=e(i,u);o(f,u)&&t(d,n(u,i),f)}return d}return zm=r,zm}var qm,mj;function SF(){if(mj)return qm;mj=1;var e=jF(),t=JE();function n(r,i){return e(r,i,function(s,o){return t(r,o)})}return qm=n,qm}var $m,gj;function kF(){if(gj)return $m;gj=1;var e=xT(),t=aT(),n=lT();function r(i){return n(t(i,void 0,e),i+"")}return $m=r,$m}var Bm,vj;function NF(){if(vj)return Bm;vj=1;var e=SF(),t=kF(),n=t(function(r,i){return r==null?{}:e(r,i)});return Bm=n,Bm}var Hm,xj;function CF(){if(xj)return Hm;xj=1;var e=Math.ceil,t=Math.max;function n(r,i,s,o){for(var l=-1,c=t(e((i-r)/(s||1)),0),d=Array(c);c--;)d[o?c:++l]=r,r+=s;return d}return Hm=n,Hm}var Wm,yj;function EF(){if(yj)return Wm;yj=1;var e=CF(),t=gu(),n=vT();function r(i){return function(s,o,l){return l&&typeof l!="number"&&t(s,o,l)&&(o=l=void 0),s=n(s),o===void 0?(o=s,s=0):o=n(o),l=l===void 0?s<o?1:-1:n(l),e(s,o,l,i)}}return Wm=r,Wm}var Um,bj;function TF(){if(bj)return Um;bj=1;var e=EF(),t=e();return Um=t,Um}var Vm,wj;function RF(){if(wj)return Vm;wj=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return Vm=e,Vm}var Gm,_j;function AF(){if(_j)return Gm;_j=1;var e=Os();function t(n,r){if(n!==r){var i=n!==void 0,s=n===null,o=n===n,l=e(n),c=r!==void 0,d=r===null,u=r===r,f=e(r);if(!d&&!f&&!l&&n>r||l&&c&&u&&!d&&!f||s&&c&&u||!i&&u||!o)return 1;if(!s&&!l&&!f&&n<r||f&&i&&o&&!s&&!l||d&&i&&o||!c&&o||!u)return-1}return 0}return Gm=t,Gm}var Km,jj;function IF(){if(jj)return Km;jj=1;var e=AF();function t(n,r,i){for(var s=-1,o=n.criteria,l=r.criteria,c=o.length,d=i.length;++s<c;){var u=e(o[s],l[s]);if(u){if(s>=d)return u;var f=i[s];return u*(f=="desc"?-1:1)}}return n.index-r.index}return Km=t,Km}var Ym,Sj;function MF(){if(Sj)return Ym;Sj=1;var e=fu(),t=hu(),n=yr(),r=iT(),i=RF(),s=lu(),o=IF(),l=Ii(),c=ot();function d(u,f,p){f.length?f=e(f,function(g){return c(g)?function(w){return t(w,g.length===1?g[0]:g)}:g}):f=[l];var h=-1;f=e(f,s(n));var x=r(u,function(g,w,v){var y=e(f,function(b){return b(g)});return{criteria:y,index:++h,value:g}});return i(x,function(g,w){return o(g,w,p)})}return Ym=d,Ym}var Xm,kj;function PF(){if(kj)return Xm;kj=1;var e=vy(),t=MF(),n=mu(),r=gu(),i=n(function(s,o){if(s==null)return[];var l=o.length;return l>1&&r(s,o[0],o[1])?o=[]:l>2&&r(o[0],o[1],o[2])&&(o=[o[0]]),t(s,e(o,1),[])});return Xm=i,Xm}var Qm,Nj;function OF(){if(Nj)return Qm;Nj=1;var e=QE(),t=0;function n(r){var i=++t;return e(r)+i}return Qm=n,Qm}var Zm,Cj;function DF(){if(Cj)return Zm;Cj=1;function e(t,n,r){for(var i=-1,s=t.length,o=n.length,l={};++i<s;){var c=i<o?n[i]:void 0;r(l,t[i],c)}return l}return Zm=e,Zm}var Jm,Ej;function LF(){if(Ej)return Jm;Ej=1;var e=ou(),t=DF();function n(r,i){return t(r||[],i||[],e)}return Jm=n,Jm}var pc;if(typeof ny=="function")try{pc={cloneDeep:J8(),constant:fy(),defaults:eF(),each:WE(),filter:tT(),find:aF(),flatten:xT(),forEach:HE(),forIn:lF(),has:nT(),isUndefined:rT(),last:cF(),map:sT(),mapValues:uF(),max:fF(),merge:xF(),min:yF(),minBy:bF(),now:wF(),pick:NF(),range:TF(),reduce:oT(),sortBy:PF(),uniqueId:OF(),values:dT(),zipObject:LF()}}catch{}pc||(pc=window._);var Qe=pc,FF=vu;function vu(){var e={};e._next=e._prev=e,this._sentinel=e}vu.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return _T(t),t};vu.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&_T(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};vu.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,zF)),n=n._prev;return"["+e.join(", ")+"]"};function _T(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function zF(e,t){if(e!=="_next"&&e!=="_prev")return t}var sr=Qe,qF=On.Graph,$F=FF,BF=WF,HF=sr.constant(1);function WF(e,t){if(e.nodeCount()<=1)return[];var n=VF(e,t||HF),r=UF(n.graph,n.buckets,n.zeroIdx);return sr.flatten(sr.map(r,function(i){return e.outEdges(i.v,i.w)}),!0)}function UF(e,t,n){for(var r=[],i=t[t.length-1],s=t[0],o;e.nodeCount();){for(;o=s.dequeue();)eg(e,t,n,o);for(;o=i.dequeue();)eg(e,t,n,o);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(o=t[l].dequeue(),o){r=r.concat(eg(e,t,n,o,!0));break}}}return r}function eg(e,t,n,r,i){var s=i?[]:void 0;return sr.forEach(e.inEdges(r.v),function(o){var l=e.edge(o),c=e.node(o.v);i&&s.push({v:o.v,w:o.w}),c.out-=l,Av(t,n,c)}),sr.forEach(e.outEdges(r.v),function(o){var l=e.edge(o),c=o.w,d=e.node(c);d.in-=l,Av(t,n,d)}),e.removeNode(r.v),s}function VF(e,t){var n=new qF,r=0,i=0;sr.forEach(e.nodes(),function(l){n.setNode(l,{v:l,in:0,out:0})}),sr.forEach(e.edges(),function(l){var c=n.edge(l.v,l.w)||0,d=t(l),u=c+d;n.setEdge(l.v,l.w,u),i=Math.max(i,n.node(l.v).out+=d),r=Math.max(r,n.node(l.w).in+=d)});var s=sr.range(i+r+3).map(function(){return new $F}),o=r+1;return sr.forEach(n.nodes(),function(l){Av(s,o,n.node(l))}),{graph:n,buckets:s,zeroIdx:o}}function Av(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var hi=Qe,GF=BF,KF={run:YF,undo:QF};function YF(e){var t=e.graph().acyclicer==="greedy"?GF(e,n(e)):XF(e);hi.forEach(t,function(r){var i=e.edge(r);e.removeEdge(r),i.forwardName=r.name,i.reversed=!0,e.setEdge(r.w,r.v,i,hi.uniqueId("rev"))});function n(r){return function(i){return r.edge(i).weight}}}function XF(e){var t=[],n={},r={};function i(s){hi.has(r,s)||(r[s]=!0,n[s]=!0,hi.forEach(e.outEdges(s),function(o){hi.has(n,o.w)?t.push(o):i(o.w)}),delete n[s])}return hi.forEach(e.nodes(),i),t}function QF(e){hi.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var De=Qe,jT=On.Graph,Kt={addDummyNode:ST,simplify:ZF,asNonCompoundGraph:JF,successorWeights:ez,predecessorWeights:tz,intersectRect:nz,buildLayerMatrix:rz,normalizeRanks:iz,removeEmptyRanks:sz,addBorderNode:oz,maxRank:kT,partition:az,time:lz,notime:cz};function ST(e,t,n,r){var i;do i=De.uniqueId(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function ZF(e){var t=new jT().setGraph(e.graph());return De.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),De.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function JF(e){var t=new jT({multigraph:e.isMultigraph()}).setGraph(e.graph());return De.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),De.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function ez(e){var t=De.map(e.nodes(),function(n){var r={};return De.forEach(e.outEdges(n),function(i){r[i.w]=(r[i.w]||0)+e.edge(i).weight}),r});return De.zipObject(e.nodes(),t)}function tz(e){var t=De.map(e.nodes(),function(n){var r={};return De.forEach(e.inEdges(n),function(i){r[i.v]=(r[i.v]||0)+e.edge(i).weight}),r});return De.zipObject(e.nodes(),t)}function nz(e,t){var n=e.x,r=e.y,i=t.x-n,s=t.y-r,o=e.width/2,l=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(s)*o>Math.abs(i)*l?(s<0&&(l=-l),c=l*i/s,d=l):(i<0&&(o=-o),c=o,d=o*s/i),{x:n+c,y:r+d}}function rz(e){var t=De.map(De.range(kT(e)+1),function(){return[]});return De.forEach(e.nodes(),function(n){var r=e.node(n),i=r.rank;De.isUndefined(i)||(t[i][r.order]=n)}),t}function iz(e){var t=De.min(De.map(e.nodes(),function(n){return e.node(n).rank}));De.forEach(e.nodes(),function(n){var r=e.node(n);De.has(r,"rank")&&(r.rank-=t)})}function sz(e){var t=De.min(De.map(e.nodes(),function(s){return e.node(s).rank})),n=[];De.forEach(e.nodes(),function(s){var o=e.node(s).rank-t;n[o]||(n[o]=[]),n[o].push(s)});var r=0,i=e.graph().nodeRankFactor;De.forEach(n,function(s,o){De.isUndefined(s)&&o%i!==0?--r:r&&De.forEach(s,function(l){e.node(l).rank+=r})})}function oz(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),ST(e,"border",i,t)}function kT(e){return De.max(De.map(e.nodes(),function(t){var n=e.node(t).rank;if(!De.isUndefined(n))return n}))}function az(e,t){var n={lhs:[],rhs:[]};return De.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function lz(e,t){var n=De.now();try{return t()}finally{console.log(e+" time: "+(De.now()-n)+"ms")}}function cz(e,t){return t()}var NT=Qe,uz=Kt,dz={run:fz,undo:hz};function fz(e){e.graph().dummyChains=[],NT.forEach(e.edges(),function(t){pz(e,t)})}function pz(e,t){var n=t.v,r=e.node(n).rank,i=t.w,s=e.node(i).rank,o=t.name,l=e.edge(t),c=l.labelRank;if(s!==r+1){e.removeEdge(t);var d,u,f;for(f=0,++r;r<s;++f,++r)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:r},d=uz.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(n,d,{weight:l.weight},o),f===0&&e.graph().dummyChains.push(d),n=d;e.setEdge(n,i,{weight:l.weight},o)}}function hz(e){NT.forEach(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}var rl=Qe,xu={longestPath:mz,slack:gz};function mz(e){var t={};function n(r){var i=e.node(r);if(rl.has(t,r))return i.rank;t[r]=!0;var s=rl.min(rl.map(e.outEdges(r),function(o){return n(o.w)-e.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}rl.forEach(e.sources(),n)}function gz(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var hc=Qe,vz=On.Graph,mc=xu.slack,CT=xz;function xz(e){var t=new vz({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var i,s;yz(t,e)<r;)i=bz(t,e),s=t.hasNode(i.v)?mc(e,i):-mc(e,i),wz(t,e,s);return t}function yz(e,t){function n(r){hc.forEach(t.nodeEdges(r),function(i){var s=i.v,o=r===s?i.w:s;!e.hasNode(o)&&!mc(t,i)&&(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})}return hc.forEach(e.nodes(),n),e.nodeCount()}function bz(e,t){return hc.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return mc(t,n)})}function wz(e,t,n){hc.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var mr=Qe,_z=CT,jz=xu.slack,Sz=xu.longestPath,kz=On.alg.preorder,Nz=On.alg.postorder,Cz=Kt.simplify,Ez=Mi;Mi.initLowLimValues=wy;Mi.initCutValues=by;Mi.calcCutValue=ET;Mi.leaveEdge=RT;Mi.enterEdge=AT;Mi.exchangeEdges=IT;function Mi(e){e=Cz(e),Sz(e);var t=_z(e);wy(t),by(t,e);for(var n,r;n=RT(t);)r=AT(t,e,n),IT(t,e,n,r)}function by(e,t){var n=Nz(e,e.nodes());n=n.slice(0,n.length-1),mr.forEach(n,function(r){Tz(e,t,r)})}function Tz(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=ET(e,t,n)}function ET(e,t,n){var r=e.node(n),i=r.parent,s=!0,o=t.edge(n,i),l=0;return o||(s=!1,o=t.edge(i,n)),l=o.weight,mr.forEach(t.nodeEdges(n),function(c){var d=c.v===n,u=d?c.w:c.v;if(u!==i){var f=d===s,p=t.edge(c).weight;if(l+=f?p:-p,Az(e,n,u)){var h=e.edge(n,u).cutvalue;l+=f?-h:h}}}),l}function wy(e,t){arguments.length<2&&(t=e.nodes()[0]),TT(e,{},1,t)}function TT(e,t,n,r,i){var s=n,o=e.node(r);return t[r]=!0,mr.forEach(e.neighbors(r),function(l){mr.has(t,l)||(n=TT(e,t,n,l,r))}),o.low=s,o.lim=n++,i?o.parent=i:delete o.parent,n}function RT(e){return mr.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function AT(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var s=e.node(r),o=e.node(i),l=s,c=!1;s.lim>o.lim&&(l=o,c=!0);var d=mr.filter(t.edges(),function(u){return c===Tj(e,e.node(u.v),l)&&c!==Tj(e,e.node(u.w),l)});return mr.minBy(d,function(u){return jz(t,u)})}function IT(e,t,n,r){var i=n.v,s=n.w;e.removeEdge(i,s),e.setEdge(r.v,r.w,{}),wy(e),by(e,t),Rz(e,t)}function Rz(e,t){var n=mr.find(e.nodes(),function(i){return!t.node(i).parent}),r=kz(e,n);r=r.slice(1),mr.forEach(r,function(i){var s=e.node(i).parent,o=t.edge(i,s),l=!1;o||(o=t.edge(s,i),l=!0),t.node(i).rank=t.node(s).rank+(l?o.minlen:-o.minlen)})}function Az(e,t,n){return e.hasEdge(t,n)}function Tj(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var Iz=xu,MT=Iz.longestPath,Mz=CT,Pz=Ez,Oz=Dz;function Dz(e){switch(e.graph().ranker){case"network-simplex":Rj(e);break;case"tight-tree":Fz(e);break;case"longest-path":Lz(e);break;default:Rj(e)}}var Lz=MT;function Fz(e){MT(e),Mz(e)}function Rj(e){Pz(e)}var Iv=Qe,zz=qz;function qz(e){var t=Bz(e);Iv.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,s=$z(e,t,i.v,i.w),o=s.path,l=s.lca,c=0,d=o[c],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(d=o[c])!==l&&e.node(d).maxRank<r.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(d=o[c+1]).minRank<=r.rank;)c++;d=o[c]}e.setParent(n,d),n=e.successors(n)[0]}})}function $z(e,t,n,r){var i=[],s=[],o=Math.min(t[n].low,t[r].low),l=Math.max(t[n].lim,t[r].lim),c,d;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||l>t[c].lim));for(d=c,c=r;(c=e.parent(c))!==d;)s.push(c);return{path:i.concat(s.reverse()),lca:d}}function Bz(e){var t={},n=0;function r(i){var s=n;Iv.forEach(e.children(i),r),t[i]={low:s,lim:n++}}return Iv.forEach(e.children(),r),t}var or=Qe,Mv=Kt,Hz={run:Wz,cleanup:Gz};function Wz(e){var t=Mv.addDummyNode(e,"root",{},"_root"),n=Uz(e),r=or.max(or.values(n))-1,i=2*r+1;e.graph().nestingRoot=t,or.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var s=Vz(e)+1;or.forEach(e.children(),function(o){PT(e,t,i,s,r,n,o)}),e.graph().nodeRankFactor=i}function PT(e,t,n,r,i,s,o){var l=e.children(o);if(!l.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:n});return}var c=Mv.addBorderNode(e,"_bt"),d=Mv.addBorderNode(e,"_bb"),u=e.node(o);e.setParent(c,o),u.borderTop=c,e.setParent(d,o),u.borderBottom=d,or.forEach(l,function(f){PT(e,t,n,r,i,s,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,x=p.borderBottom?p.borderBottom:f,g=p.borderTop?r:2*r,w=h!==x?1:i-s[o]+1;e.setEdge(c,h,{weight:g,minlen:w,nestingEdge:!0}),e.setEdge(x,d,{weight:g,minlen:w,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+s[o]})}function Uz(e){var t={};function n(r,i){var s=e.children(r);s&&s.length&&or.forEach(s,function(o){n(o,i+1)}),t[r]=i}return or.forEach(e.children(),function(r){n(r,1)}),t}function Vz(e){return or.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function Gz(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,or.forEach(e.edges(),function(n){var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}var tg=Qe,Kz=Kt,Yz=Xz;function Xz(e){function t(n){var r=e.children(n),i=e.node(n);if(r.length&&tg.forEach(r,t),tg.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,o=i.maxRank+1;s<o;++s)Aj(e,"borderLeft","_bl",n,i,s),Aj(e,"borderRight","_br",n,i,s)}}tg.forEach(e.children(),t)}function Aj(e,t,n,r,i,s){var o={width:0,height:0,rank:s,borderType:t},l=i[t][s-1],c=Kz.addDummyNode(e,"border",o,n);i[t][s]=c,e.setParent(c,r),l&&e.setEdge(l,c,{weight:1})}var $n=Qe,Qz={adjust:Zz,undo:Jz};function Zz(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&OT(e)}function Jz(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&eq(e),(t==="lr"||t==="rl")&&(tq(e),OT(e))}function OT(e){$n.forEach(e.nodes(),function(t){Ij(e.node(t))}),$n.forEach(e.edges(),function(t){Ij(e.edge(t))})}function Ij(e){var t=e.width;e.width=e.height,e.height=t}function eq(e){$n.forEach(e.nodes(),function(t){ng(e.node(t))}),$n.forEach(e.edges(),function(t){var n=e.edge(t);$n.forEach(n.points,ng),$n.has(n,"y")&&ng(n)})}function ng(e){e.y=-e.y}function tq(e){$n.forEach(e.nodes(),function(t){rg(e.node(t))}),$n.forEach(e.edges(),function(t){var n=e.edge(t);$n.forEach(n.points,rg),$n.has(n,"x")&&rg(n)})}function rg(e){var t=e.x;e.x=e.y,e.y=t}var Qn=Qe,nq=rq;function rq(e){var t={},n=Qn.filter(e.nodes(),function(l){return!e.children(l).length}),r=Qn.max(Qn.map(n,function(l){return e.node(l).rank})),i=Qn.map(Qn.range(r+1),function(){return[]});function s(l){if(!Qn.has(t,l)){t[l]=!0;var c=e.node(l);i[c.rank].push(l),Qn.forEach(e.successors(l),s)}}var o=Qn.sortBy(n,function(l){return e.node(l).rank});return Qn.forEach(o,s),i}var _r=Qe,iq=sq;function sq(e,t){for(var n=0,r=1;r<t.length;++r)n+=oq(e,t[r-1],t[r]);return n}function oq(e,t,n){for(var r=_r.zipObject(n,_r.map(n,function(d,u){return u})),i=_r.flatten(_r.map(t,function(d){return _r.sortBy(_r.map(e.outEdges(d),function(u){return{pos:r[u.w],weight:e.edge(u).weight}}),"pos")}),!0),s=1;s<n.length;)s<<=1;var o=2*s-1;s-=1;var l=_r.map(new Array(o),function(){return 0}),c=0;return _r.forEach(i.forEach(function(d){var u=d.pos+s;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var Mj=Qe,aq=lq;function lq(e,t){return Mj.map(t,function(n){var r=e.inEdges(n);if(r.length){var i=Mj.reduce(r,function(s,o){var l=e.edge(o),c=e.node(o.v);return{sum:s.sum+l.weight*c.order,weight:s.weight+l.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:n}})}var en=Qe,cq=uq;function uq(e,t){var n={};en.forEach(e,function(i,s){var o=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};en.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),en.forEach(t.edges(),function(i){var s=n[i.v],o=n[i.w];!en.isUndefined(s)&&!en.isUndefined(o)&&(o.indegree++,s.out.push(n[i.w]))});var r=en.filter(n,function(i){return!i.indegree});return dq(r)}function dq(e){var t=[];function n(s){return function(o){o.merged||(en.isUndefined(o.barycenter)||en.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&fq(s,o)}}function r(s){return function(o){o.in.push(s),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),en.forEach(i.in.reverse(),n(i)),en.forEach(i.out,r(i))}return en.map(en.filter(t,function(s){return!s.merged}),function(s){return en.pick(s,["vs","i","barycenter","weight"])})}function fq(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var vo=Qe,pq=Kt,hq=mq;function mq(e,t){var n=pq.partition(e,function(u){return vo.has(u,"barycenter")}),r=n.lhs,i=vo.sortBy(n.rhs,function(u){return-u.i}),s=[],o=0,l=0,c=0;r.sort(gq(!!t)),c=Pj(s,i,c),vo.forEach(r,function(u){c+=u.vs.length,s.push(u.vs),o+=u.barycenter*u.weight,l+=u.weight,c=Pj(s,i,c)});var d={vs:vo.flatten(s,!0)};return l&&(d.barycenter=o/l,d.weight=l),d}function Pj(e,t,n){for(var r;t.length&&(r=vo.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function gq(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var Ir=Qe,vq=aq,xq=cq,yq=hq,bq=DT;function DT(e,t,n,r){var i=e.children(t),s=e.node(t),o=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,c={};o&&(i=Ir.filter(i,function(x){return x!==o&&x!==l}));var d=vq(e,i);Ir.forEach(d,function(x){if(e.children(x.v).length){var g=DT(e,x.v,n,r);c[x.v]=g,Ir.has(g,"barycenter")&&_q(x,g)}});var u=xq(d,n);wq(u,c);var f=yq(u,r);if(o&&(f.vs=Ir.flatten([o,f.vs,l],!0),e.predecessors(o).length)){var p=e.node(e.predecessors(o)[0]),h=e.node(e.predecessors(l)[0]);Ir.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function wq(e,t){Ir.forEach(e,function(n){n.vs=Ir.flatten(n.vs.map(function(r){return t[r]?t[r].vs:r}),!0)})}function _q(e,t){Ir.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var xo=Qe,jq=On.Graph,Sq=kq;function kq(e,t,n){var r=Nq(e),i=new jq({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(s){return e.node(s)});return xo.forEach(e.nodes(),function(s){var o=e.node(s),l=e.parent(s);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(s),i.setParent(s,l||r),xo.forEach(e[n](s),function(c){var d=c.v===s?c.w:c.v,u=i.edge(d,s),f=xo.isUndefined(u)?0:u.weight;i.setEdge(d,s,{weight:e.edge(c).weight+f})}),xo.has(o,"minRank")&&i.setNode(s,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function Nq(e){for(var t;e.hasNode(t=xo.uniqueId("_root")););return t}var Cq=Qe,Eq=Tq;function Tq(e,t,n){var r={},i;Cq.forEach(n,function(s){for(var o=e.parent(s),l,c;o;){if(l=e.parent(o),l?(c=r[l],r[l]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=l}})}var Ur=Qe,Rq=nq,Aq=iq,Iq=bq,Mq=Sq,Pq=Eq,Oq=On.Graph,Oj=Kt,Dq=Lq;function Lq(e){var t=Oj.maxRank(e),n=Dj(e,Ur.range(1,t+1),"inEdges"),r=Dj(e,Ur.range(t-1,-1,-1),"outEdges"),i=Rq(e);Lj(e,i);for(var s=Number.POSITIVE_INFINITY,o,l=0,c=0;c<4;++l,++c){Fq(l%2?n:r,l%4>=2),i=Oj.buildLayerMatrix(e);var d=Aq(e,i);d<s&&(c=0,o=Ur.cloneDeep(i),s=d)}Lj(e,o)}function Dj(e,t,n){return Ur.map(t,function(r){return Mq(e,r,n)})}function Fq(e,t){var n=new Oq;Ur.forEach(e,function(r){var i=r.graph().root,s=Iq(r,i,n,t);Ur.forEach(s.vs,function(o,l){r.node(o).order=l}),Pq(r,n,s.vs)})}function Lj(e,t){Ur.forEach(t,function(n){Ur.forEach(n,function(r,i){e.node(r).order=i})})}var be=Qe,zq=On.Graph,qq=Kt,$q={positionX:Zq};function Bq(e,t){var n={};function r(i,s){var o=0,l=0,c=i.length,d=be.last(s);return be.forEach(s,function(u,f){var p=Wq(e,u),h=p?e.node(p).order:c;(p||u===d)&&(be.forEach(s.slice(l,f+1),function(x){be.forEach(e.predecessors(x),function(g){var w=e.node(g),v=w.order;(v<o||h<v)&&!(w.dummy&&e.node(x).dummy)&&LT(n,g,x)})}),l=f+1,o=h)}),s}return be.reduce(t,r),n}function Hq(e,t){var n={};function r(s,o,l,c,d){var u;be.forEach(be.range(o,l),function(f){u=s[f],e.node(u).dummy&&be.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&LT(n,p,u)})})}function i(s,o){var l=-1,c,d=0;return be.forEach(o,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,r(o,d,f,l,c),d=f,l=c)}r(o,d,o.length,c,s.length)}),o}return be.reduce(t,i),n}function Wq(e,t){if(e.node(t).dummy)return be.find(e.predecessors(t),function(n){return e.node(n).dummy})}function LT(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function Uq(e,t,n){if(t>n){var r=t;t=n,n=r}return be.has(e[t],n)}function Vq(e,t,n,r){var i={},s={},o={};return be.forEach(t,function(l){be.forEach(l,function(c,d){i[c]=c,s[c]=c,o[c]=d})}),be.forEach(t,function(l){var c=-1;be.forEach(l,function(d){var u=r(d);if(u.length){u=be.sortBy(u,function(g){return o[g]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var x=u[p];s[d]===d&&c<o[x]&&!Uq(n,d,x)&&(s[x]=d,s[d]=i[d]=i[x],c=o[x])}}})}),{root:i,align:s}}function Gq(e,t,n,r,i){var s={},o=Kq(e,t,n,i),l=i?"borderLeft":"borderRight";function c(f,p){for(var h=o.nodes(),x=h.pop(),g={};x;)g[x]?f(x):(g[x]=!0,h.push(x),h=h.concat(p(x))),x=h.pop()}function d(f){s[f]=o.inEdges(f).reduce(function(p,h){return Math.max(p,s[h.v]+o.edge(h))},0)}function u(f){var p=o.outEdges(f).reduce(function(x,g){return Math.min(x,s[g.w]-o.edge(g))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(s[f]=Math.max(s[f],p))}return c(d,o.predecessors.bind(o)),c(u,o.successors.bind(o)),be.forEach(r,function(f){s[f]=s[n[f]]}),s}function Kq(e,t,n,r){var i=new zq,s=e.graph(),o=Jq(s.nodesep,s.edgesep,r);return be.forEach(t,function(l){var c;be.forEach(l,function(d){var u=n[d];if(i.setNode(u),c){var f=n[c],p=i.edge(f,u);i.setEdge(f,u,Math.max(o(e,d,c),p||0))}c=d})}),i}function Yq(e,t){return be.minBy(be.values(t),function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return be.forIn(n,function(s,o){var l=e$(e,o)/2;r=Math.max(s+l,r),i=Math.min(s-l,i)}),r-i})}function Xq(e,t){var n=be.values(t),r=be.min(n),i=be.max(n);be.forEach(["u","d"],function(s){be.forEach(["l","r"],function(o){var l=s+o,c=e[l],d;if(c!==t){var u=be.values(c);d=o==="l"?r-be.min(u):i-be.max(u),d&&(e[l]=be.mapValues(c,function(f){return f+d}))}})})}function Qq(e,t){return be.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=be.sortBy(be.map(e,r));return(i[1]+i[2])/2})}function Zq(e){var t=qq.buildLayerMatrix(e),n=be.merge(Bq(e,t),Hq(e,t)),r={},i;be.forEach(["u","d"],function(o){i=o==="u"?t:be.values(t).reverse(),be.forEach(["l","r"],function(l){l==="r"&&(i=be.map(i,function(f){return be.values(f).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),d=Vq(e,i,n,c),u=Gq(e,i,d.root,d.align,l==="r");l==="r"&&(u=be.mapValues(u,function(f){return-f})),r[o+l]=u})});var s=Yq(e,r);return Xq(r,s),Qq(r,e.graph().align)}function Jq(e,t,n){return function(r,i,s){var o=r.node(i),l=r.node(s),c=0,d;if(c+=o.width/2,be.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":d=-o.width/2;break;case"r":d=o.width/2;break}if(d&&(c+=n?d:-d),d=0,c+=(o.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,be.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=n?d:-d),d=0,c}}function e$(e,t){return e.node(t).width}var yo=Qe,FT=Kt,t$=$q.positionX,n$=r$;function r$(e){e=FT.asNonCompoundGraph(e),i$(e),yo.forEach(t$(e),function(t,n){e.node(n).x=t})}function i$(e){var t=FT.buildLayerMatrix(e),n=e.graph().ranksep,r=0;yo.forEach(t,function(i){var s=yo.max(yo.map(i,function(o){return e.node(o).height}));yo.forEach(i,function(o){e.node(o).y=r+s/2}),r+=s+n})}var Se=Qe,Fj=KF,zj=dz,s$=Oz,o$=Kt.normalizeRanks,a$=zz,l$=Kt.removeEmptyRanks,qj=Hz,c$=Yz,$j=Qz,u$=Dq,d$=n$,Yr=Kt,f$=On.Graph,p$=h$;function h$(e,t){var n=t&&t.debugTiming?Yr.time:Yr.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return k$(e)});n("  runLayout",function(){m$(r,n)}),n("  updateInputGraph",function(){g$(e,r)})})}function m$(e,t){t("    makeSpaceForEdgeLabels",function(){N$(e)}),t("    removeSelfEdges",function(){O$(e)}),t("    acyclic",function(){Fj.run(e)}),t("    nestingGraph.run",function(){qj.run(e)}),t("    rank",function(){s$(Yr.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){C$(e)}),t("    removeEmptyRanks",function(){l$(e)}),t("    nestingGraph.cleanup",function(){qj.cleanup(e)}),t("    normalizeRanks",function(){o$(e)}),t("    assignRankMinMax",function(){E$(e)}),t("    removeEdgeLabelProxies",function(){T$(e)}),t("    normalize.run",function(){zj.run(e)}),t("    parentDummyChains",function(){a$(e)}),t("    addBorderSegments",function(){c$(e)}),t("    order",function(){u$(e)}),t("    insertSelfEdges",function(){D$(e)}),t("    adjustCoordinateSystem",function(){$j.adjust(e)}),t("    position",function(){d$(e)}),t("    positionSelfEdges",function(){L$(e)}),t("    removeBorderNodes",function(){P$(e)}),t("    normalize.undo",function(){zj.undo(e)}),t("    fixupEdgeLabelCoords",function(){I$(e)}),t("    undoCoordinateSystem",function(){$j.undo(e)}),t("    translateGraph",function(){R$(e)}),t("    assignNodeIntersects",function(){A$(e)}),t("    reversePoints",function(){M$(e)}),t("    acyclic.undo",function(){Fj.undo(e)})}function g$(e,t){Se.forEach(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),Se.forEach(e.edges(),function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,Se.has(i,"x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var v$=["nodesep","edgesep","ranksep","marginx","marginy"],x$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},y$=["acyclicer","ranker","rankdir","align"],b$=["width","height"],w$={width:0,height:0},_$=["minlen","weight","width","height","labeloffset"],j$={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S$=["labelpos"];function k$(e){var t=new f$({multigraph:!0,compound:!0}),n=sg(e.graph());return t.setGraph(Se.merge({},x$,ig(n,v$),Se.pick(n,y$))),Se.forEach(e.nodes(),function(r){var i=sg(e.node(r));t.setNode(r,Se.defaults(ig(i,b$),w$)),t.setParent(r,e.parent(r))}),Se.forEach(e.edges(),function(r){var i=sg(e.edge(r));t.setEdge(r,Se.merge({},j$,ig(i,_$),Se.pick(i,S$)))}),t}function N$(e){var t=e.graph();t.ranksep/=2,Se.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function C$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-r.rank)/2+r.rank,e:t};Yr.addDummyNode(e,"edge-proxy",s,"_ep")}})}function E$(e){var t=0;Se.forEach(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Se.max(t,r.maxRank))}),e.graph().maxRank=t}function T$(e){Se.forEach(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function R$(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,s=e.graph(),o=s.marginx||0,l=s.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),n=Math.max(n,u+p/2),r=Math.min(r,f-h/2),i=Math.max(i,f+h/2)}Se.forEach(e.nodes(),function(d){c(e.node(d))}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.has(u,"x")&&c(u)}),t-=o,r-=l,Se.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=r}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.forEach(u.points,function(f){f.x-=t,f.y-=r}),Se.has(u,"x")&&(u.x-=t),Se.has(u,"y")&&(u.y-=r)}),s.width=n-t+o,s.height=i-r+l}function A$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),s,o;n.points?(s=n.points[0],o=n.points[n.points.length-1]):(n.points=[],s=i,o=r),n.points.unshift(Yr.intersectRect(r,s)),n.points.push(Yr.intersectRect(i,o))})}function I$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t);if(Se.has(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function M$(e){Se.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function P$(e){Se.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),s=e.node(Se.last(n.borderLeft)),o=e.node(Se.last(n.borderRight));n.width=Math.abs(o.x-s.x),n.height=Math.abs(i.y-r.y),n.x=s.x+n.width/2,n.y=r.y+n.height/2}}),Se.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function O$(e){Se.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function D$(e){var t=Yr.buildLayerMatrix(e);Se.forEach(t,function(n){var r=0;Se.forEach(n,function(i,s){var o=e.node(i);o.order=s+r,Se.forEach(o.selfEdges,function(l){Yr.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:o.rank,order:s+ ++r,e:l.e,label:l.label},"_se")}),delete o.selfEdges})})}function L$(e){Se.forEach(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),i=r.x+r.width/2,s=r.y,o=n.x-i,l=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:s-l},{x:i+5*o/6,y:s-l},{x:i+o,y:s},{x:i+5*o/6,y:s+l},{x:i+2*o/3,y:s+l}],n.label.x=n.x,n.label.y=n.y}})}function ig(e,t){return Se.mapValues(Se.pick(e,t),Number)}function sg(e){var t={};return Se.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var il=Qe,F$=Kt,z$=On.Graph,q$={debugOrdering:$$};function $$(e){var t=F$.buildLayerMatrix(e),n=new z$({compound:!0,multigraph:!0}).setGraph({});return il.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),il.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),il.forEach(t,function(r,i){var s="layer"+i;n.setNode(s,{rank:"same"}),il.reduce(r,function(o,l){return n.setEdge(o,l,{style:"invis"}),l})}),n}var B$="0.8.5",H$={graphlib:On,layout:p$,debug:q$,util:{time:Kt.time,notime:Kt.notime},version:B$};const gc=Wv(H$),Bj=(e,t)=>{const n=new gc.graphlib.Graph;return n.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),n.setDefaultEdgeLabel(()=>({})),e.forEach(r=>{n.setNode(r.id,{width:r.data.width??280,height:r.data.height??90})}),t.forEach(r=>{n.setEdge(r.source,r.target)}),gc.layout(n),{nodes:e.map(r=>{const i=n.node(r.id);return{...r,targetPosition:le.Top,sourcePosition:le.Bottom,position:{x:i.x-(r.data.width??280)/2,y:i.y-(r.data.height??90)/2}}}),edges:t}},Hj=(e,t,n)=>{let r=[],i=[],s=null,o=null,l=[];const c=n.theme||"industrial";return e.forEach((d,u)=>{var x,g;if((d.level||1)!==1)return;const f=280;let p=95;d.state==="active"&&d.stations&&(p+=35);const h=t===d.id;if(r.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...n},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),s){const w=(x=e[u-1])==null?void 0:x.state;i.push({id:"e-"+s+"-"+d.id,source:s,target:d.id,type:"smoothstep",animated:w==="active",style:{stroke:wE(w,c),strokeWidth:3}})}((g=d.children)==null?void 0:g.length)>0&&(o=d.id,l=d.children),s=d.id}),{nodes:r,edges:i,epicBacklogId:o,epicChildren:l}},Wj=(e,t,n,r,i)=>{const{nodes:s,edges:o}=e;if(!t||!n.length)return{nodes:s,edges:o};const l=s.find(b=>b.id===t);if(!l)return{nodes:s,edges:o};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=i.theme||"industrial",p=wE(u,f),h=u==="active",x=jn.EPIC_HEIGHT+jn.EPIC_GAP_Y,g=Math.ceil(n.length/jn.EPICS_PER_ROW),w=c+280*.15,v=50,y={};n.forEach((b,_)=>{const j=Math.floor(_/jn.EPICS_PER_ROW);y[j]||(y[j]=[]),y[j].push({epic:b,idx:_})});for(let b=0;b<g;b++){const _=y[b]||[];if(_.length===0)continue;const j=d+jn.EPIC_OFFSET_Y+b*x,k=`junction-row-${b}`;s.push({id:k,type:"waypoint",position:{x:w,y:j-v},draggable:!1,connectable:!1,selectable:!1}),b===0?o.push({id:`e-spine-drop-${b}`,source:t,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):o.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),_.forEach(({epic:N,idx:E})=>{const S=E%jn.EPICS_PER_ROW,R=c+jn.EPIC_OFFSET_X+S*(jn.EPIC_WIDTH+jn.EPIC_GAP_X),T=j,M=r===N.id;s.push({id:N.id,type:"documentNode",data:{...N,width:jn.EPIC_WIDTH,height:jn.EPIC_HEIGHT,isExpanded:M,...i},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:le.Top,sourcePosition:le.Bottom,zIndex:M?1e3:0}),o.push({id:`e-branch-${N.id}`,source:k,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:s,edges:o}},W$={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},Uj={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function U$(e){const t={};for(const n of e.projects)t[n.id]={id:n.id,projectId:n.project_id,name:n.name,description:n.description||"",status:n.status==="active"?"active":n.is_archived?"complete":"queued",icon:n.icon,createdAt:n.created_at,isArchived:n.is_archived||!1};return t}function V$(e,t=[]){const n=[],r=[],i={};for(const s of e.tracks){const o=G$(s,t);if((s.scope||"project")==="project")r.push({...o,mayOwn:s.may_own||[],childDocType:s.child_doc_type});else{const c=s.document_type;i[c]||(i[c]=[]),i[c].push(o)}}for(const s of r)s.childDocType&&i[s.childDocType]&&(s.children=i[s.childDocType].map(o=>({...o,level:2}))),n.push(s);return n}function G$(e,t=[]){const n=W$[e.state]||"ready_for_production",r=e.state==="awaiting_operator",i=t.find(l=>l.document_type===e.document_type);let s=null;(n==="in_production"||r)&&(s=K$(e.stations,e.state,e.station));let o=null;return i&&i.questions&&(o=i.questions.map((l,c)=>({id:l.id||`q${c+1}`,text:l.question||l.text||l,required:l.required!==!1}))),{id:e.document_type,name:e.document_name||Y$(e.document_type),desc:e.description||"",state:n,intent:"mandatory",level:1,stations:s,questions:o,interruptId:i==null?void 0:i.id,blockedBy:e.blocked_by||[]}}function K$(e,t,n){if(!e||e.length===0){const r=n||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return dd.map(i=>({id:i,label:Uj[i]||i.toUpperCase(),state:r===i?"active":dd.indexOf(i)<dd.indexOf(r)?"complete":"pending",needs_input:i==="pgc"&&t==="awaiting_operator"}))}return e.map(r=>({id:r.station,label:Uj[r.station]||r.station.toUpperCase(),state:r.state||"pending",needs_input:r.needs_input||!1}))}function Y$(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function X$({includeArchived:e=!1}={}){const[t,n]=m.useState({}),[r,i]=m.useState(!0),[s,o]=m.useState(null),l=m.useCallback(async()=>{i(!0),o(null);try{const d=await Ye.getProjects({includeArchived:e}),u=U$(d);n(u)}catch(d){o(d.message),console.error("Failed to fetch projects:",d)}finally{i(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await Ye.createProject({name:d,description:""});return n(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw o(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:r,error:s,addProject:c,refresh:l}}function Q$(e){const[t,n]=m.useState([]),[r,i]=m.useState("idle"),[s,o]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null),g=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[_,j]=await Promise.all([Ye.getProductionStatus(e),Ye.getProjectInterrupts(e).catch(()=>[])]);o(j),i(_.line_state),n(V$(_,j))}catch(_){u(_.message),console.error("Failed to fetch production status:",_)}finally{c(!1)}},[e]),w=m.useCallback(()=>{if(!e)return;h.current&&h.current.close();const _=f6(e);h.current=_,_.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),_.addEventListener("station_transition",j=>{try{const k=JSON.parse(j.data);console.log("Station transition:",k),g()}catch(k){console.error("Failed to parse station_transition:",k)}}),_.addEventListener("line_stopped",j=>{try{const k=JSON.parse(j.data);console.log("Line stopped:",k),i("stopped"),g()}catch(k){console.error("Failed to parse line_stopped:",k)}}),_.addEventListener("production_complete",j=>{try{const k=JSON.parse(j.data);console.log("Production complete:",k),i("complete"),g()}catch(k){console.error("Failed to parse production_complete:",k)}}),_.addEventListener("interrupt_resolved",j=>{try{const k=JSON.parse(j.data);console.log("Interrupt resolved:",k),g()}catch(k){console.error("Failed to parse interrupt_resolved:",k)}}),_.addEventListener("track_started",j=>{try{const k=JSON.parse(j.data);console.log("Track started:",k),i("active"),g()}catch(k){console.error("Failed to parse track_started:",k)}}),_.onerror=j=>{console.error("SSE error:",j),p(!1),u("Connection lost"),_.close(),x.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),w()},3e3)}},[e,g]),v=m.useCallback(()=>{x.current&&clearTimeout(x.current),h.current&&(h.current.close(),h.current=null),p(!1)},[]),y=m.useCallback(async(_,j)=>{try{await Ye.resolveInterrupt(_,{answers:j}),await g()}catch(k){throw console.error("Failed to resolve interrupt:",k),k}},[g]),b=m.useCallback(async(_=null)=>{try{await Ye.startProduction(e,_),i("active"),await g()}catch(j){throw console.error("Failed to start production:",j),j}},[e,g]);return m.useEffect(()=>(g(),w(),()=>v()),[g,w,v]),{data:t,lineState:r,interrupts:s,loading:l,error:d,connected:f,refresh:g,resolveInterrupt:y,startProduction:b}}const Vj="combine-theme";function zT(e="industrial"){const[t,n]=m.useState(()=>{if(typeof window>"u")return e;const s=localStorage.getItem(Vj);return s&&Ar.includes(s)?s:e});m.useEffect(()=>{localStorage.setItem(Vj,t)},[t]);const r=m.useCallback(s=>{Ar.includes(s)&&n(s)},[]),i=m.useCallback(()=>{n(s=>{const o=Ar.indexOf(s);return Ar[(o+1)%Ar.length]})},[]);return{theme:t,setTheme:r,cycleTheme:i}}function Z$(){const[e,t]=m.useState(null),[n,r]=m.useState("idle"),[i,s]=m.useState([]),[o,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[x,g]=m.useState([]),[w,v]=m.useState(!1),[y,b]=m.useState(null),[_,j]=m.useState(null),[k,N]=m.useState(null),[E,S]=m.useState(!1),[R,T]=m.useState(!1),M=m.useRef(null),z=m.useRef(!0);m.useEffect(()=>(z.current=!0,()=>{z.current=!1,M.current&&M.current.close()}),[]);const C=m.useCallback(I=>{z.current&&(r(I.phase),s(I.messages||[]),l(I.pending_prompt),d(I.pending_choices),f(I.interpretation||{}),h(I.confidence||0),g(I.missing_fields||[]),v(I.can_initialize||!1),b(I.gate_outcome),j(I.project))},[]),L=m.useCallback(async()=>{N(null),S(!0);try{const I=await Ye.startIntake();if(!z.current)return;t(I.execution_id),r(I.phase||"describe"),l(I.pending_prompt),s([]),f({}),j(null),b(null)}catch(I){if(!z.current)return;N(I.message||"Failed to start intake")}finally{z.current&&S(!1)}},[]),P=m.useCallback(async I=>{if(!e||!I.trim())return;N(null),T(!0);const q={role:"user",content:I};s(W=>[...W,q]);try{const W=await Ye.submitIntakeMessage(e,I);if(!z.current)return;C(W)}catch(W){if(!z.current)return;s(U=>U.filter(Z=>Z!==q)),N(W.message||"Failed to submit message")}finally{z.current&&T(!1)}},[e,C]),$=m.useCallback(async(I,q)=>{if(e){N(null),f(W=>({...W,[I]:{value:q,source:"user",locked:!0}}));try{const W=await Ye.updateIntakeField(e,I,q);if(!z.current)return;C(W)}catch(W){if(!z.current)return;N(W.message||"Failed to update field");const U=await Ye.getIntakeState(e);z.current&&C(U)}}},[e,C]),O=m.useCallback(async()=>{if(!(!e||!w)){N(null),S(!0);try{const I=await Ye.initializeIntake(e);if(!z.current)return;C(I),I.phase==="generating"&&A()}catch(I){if(!z.current)return;N(I.message||"Failed to initialize project"),S(!1)}}},[e,w,C]),A=m.useCallback(()=>{M.current&&M.current.close();const I=p6(e);M.current=I,I.addEventListener("started",q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake started:",W)}),I.addEventListener("progress",q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake progress:",W.current_node)}),I.addEventListener("complete",async q=>{if(!z.current)return;const W=JSON.parse(q.data);console.log("Intake complete:",W),I.close(),M.current=null,r("complete"),b(W.gate_outcome),j(W.project),S(!1)}),I.addEventListener("error",q=>{if(z.current&&I.readyState!==EventSource.CLOSED){try{const W=JSON.parse(q.data);N(W.message||"Generation failed")}catch{N("Connection lost during generation")}I.close(),M.current=null,S(!1)}}),I.onerror=()=>{z.current&&I.readyState===EventSource.CLOSED&&(M.current=null,S(!1))}},[e]),F=m.useCallback(()=>{M.current&&(M.current.close(),M.current=null),t(null),r("idle"),s([]),l(null),d(null),f({}),h(0),g([]),v(!1),b(null),j(null),N(null),S(!1),T(!1)},[]);return{executionId:e,phase:n,messages:i,pendingPrompt:o,pendingChoices:c,interpretation:u,confidence:p,missingFields:x,canInitialize:w,gateOutcome:y,project:_,error:k,loading:E,submitting:R,startIntake:L,submitMessage:P,updateField:$,lockAndGenerate:O,reset:F}}const qT=m.createContext(null);function J$({children:e}){const[t,n]=m.useState(null),[r,i]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{i(!0),o(null);try{const f=await Ye.getMe();f&&f.user?n(f.user):n(null)}catch(f){console.error("Auth check failed:",f),o(f.message),n(null)}finally{i(!1)}},[]),c=m.useCallback(f=>{window.location.href=h6(f)},[]),d=m.useCallback(async()=>{try{await Ye.logout(),n(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),n(null)}},[]),u={user:t,loading:r,error:s,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return a.jsx(qT.Provider,{value:u,children:e})}function Ds(){const e=m.useContext(qT);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function eB(){const[e,t]=m.useState(null),[n,r]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useCallback(async()=>{s(!0),l(null);try{let u=await je.getCurrentWorkspace();u||(u=await je.createWorkspace()),t(u.workspace_id),r(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{s(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await je.closeWorkspace(e,u),t(null),r(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:n,loading:i,error:o,closeWorkspace:d,reinitialize:c}}function tB(e,t=1e4){var u,f;const[n,r]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){r(null),s(!1);return}try{const p=await je.getWorkspaceState(e);r(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{s(!1)}},[e]);return m.useEffect(()=>{e&&(s(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:n,loading:i,error:o,refresh:d,isDirty:(n==null?void 0:n.is_dirty)??!1,modifiedArtifacts:(n==null?void 0:n.modified_artifacts)??[],tier1Passed:((u=n==null?void 0:n.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=n==null?void 0:n.tier1)==null?void 0:f.results)??[],expiresAt:n!=null&&n.expires_at?new Date(n.expires_at):null}}function nB(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getDocumentTypes();t(l.document_types||[])}catch(l){s(l.message),console.error("Failed to fetch document types:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{documentTypes:e,loading:n,error:i,refresh:o}}function rB(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getRoles();t(l.roles||[])}catch(l){s(l.message),console.error("Failed to fetch roles:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{roles:e,loading:n,error:i,refresh:o}}function ka(e,t,{debounceMs:n=500,onSave:r}={}){const[i,s]=m.useState(""),[o,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(""),l(""),d(!1);return}d(!0),f(null);try{const E=await je.getArtifact(e,t);s(E.content),l(E.content)}catch(E){f(E.message),console.error("Failed to load artifact:",E)}finally{d(!1)}},[e,t]),b=m.useCallback(async E=>{if(!(!e||!t)){h(!0),f(null);try{const S=await je.writeArtifact(e,t,E);g(S),l(E),r&&r(S)}catch(S){f(S.message),console.error("Failed to save artifact:",S)}finally{h(!1)}}},[e,t,r]),_=m.useCallback(E=>{v.current=E,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},n)},[b,n]),j=m.useCallback(E=>{s(E),E!==o&&_(E)},[o,_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),v.current=null,s(o)},[o]),N=m.useCallback(()=>{w.current&&clearTimeout(w.current),i!==o&&b(i)},[i,o,b]);return m.useEffect(()=>(y(),()=>{w.current&&clearTimeout(w.current)}),[y]),{content:i,originalContent:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateContent:j,reset:k,saveNow:N,reload:y}}const iB={documentNode:D6,waypoint:L6},sB={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function oB({projectId:e,projectCode:t,projectName:n,isArchived:r,autoExpandNodeId:i,theme:s,onThemeChange:o,onProjectUpdate:l,onProjectArchive:c,onProjectUnarchive:d,onProjectDelete:u}){const{data:f,lineState:p,loading:h,error:x,connected:g,resolveInterrupt:w}=Q$(e),[v,y]=m.useState([]),[b,_]=m.useState(null),[j,k]=m.useState(null),[N,E]=m.useState(null),[S,R]=m.useState(!1),[T,M]=m.useState(""),[z,C]=m.useState(!1),[L,P]=m.useState(!1),[$,O]=m.useState(!1),A=Zc();m.useEffect(()=>{f.length>0&&y(f)},[f]),m.useEffect(()=>{i&&v.length>0&&setTimeout(()=>{_(i),k("questions")},300)},[i,v.length]),m.useEffect(()=>{_(null),k(null)},[e]);const F=m.useCallback(()=>{const Y=Ar.indexOf(s);o(Ar[(Y+1)%Ar.length])},[s,o]),I=m.useCallback(()=>{M(n||""),R(!0)},[n]),q=m.useCallback(async()=>{if(!T.trim()||T===n){R(!1);return}P(!0);try{await l(e,{name:T.trim()}),R(!1)}catch(Y){console.error("Failed to update name:",Y)}finally{P(!1)}},[T,n,e,l]),W=m.useCallback(()=>{R(!1),M("")},[]),U=m.useCallback(async()=>{P(!0);try{r?await d(e):await c(e)}catch(Y){console.error("Failed to toggle archive:",Y)}finally{P(!1)}},[e,r,c,d]),Z=m.useCallback(async()=>{P(!0);try{await u(e),C(!1)}catch(Y){console.error("Failed to delete:",Y)}finally{P(!1)}},[e,u]),B=m.useCallback(Y=>{const Q=A.getNode(Y);if(Q){const he=window.innerWidth,we=-Q.position.x*.9+he/2-400,ye=-Q.position.y*.9+120;A.setViewport({x:we,y:ye,zoom:.9},{duration:800})}},[A]),ne=m.useMemo(()=>({onExpand:(Y,Q)=>{_(Y),k(Q)},onCollapse:()=>{_(null),k(null),setTimeout(()=>A.fitView({padding:.2,duration:300}),50)},onViewFullDocument:Y=>{E(Y)},onSubmitQuestions:async(Y,Q)=>{console.log("Submitted:",Y,Q);const pe=v.find(he=>he.id===Y);if(pe!=null&&pe.interruptId)try{await w(pe.interruptId,Q)}catch(he){console.error("Failed to submit answers:",he)}_(null),k(null),y(he=>{const we=ye=>ye.map(te=>te.id===Y&&te.stations?{...te,stations:te.stations.map(me=>me.id==="pgc"?{...me,state:"complete",needs_input:!1}:me.id==="asm"?{...me,state:"active"}:me)}:te.children?{...te,children:we(te.children)}:te);return we(he)})}}),[A,v,w]),{layoutNodes:se,layoutEdges:ce}=m.useMemo(()=>{if(v.length===0)return{layoutNodes:[],layoutEdges:[]};const Y={...ne,expandType:j,theme:s,onZoomToNode:B,projectId:e,projectCode:t},{nodes:Q,edges:pe,epicBacklogId:he,epicChildren:we}=Hj(v,b,Y),ye=Bj(Q,pe),{nodes:te,edges:me}=Wj(ye,he,we,b,Y);return{layoutNodes:te.map(Fe=>({...Fe,data:{...Fe.data,expandType:Fe.id===b?j:null}})),layoutEdges:me}},[v,b,j,ne,s,B,e,t]),[J,_e,G]=gE(se),[xe,fe,oe]=vE(ce);m.useEffect(()=>{if(v.length===0)return;const Y={...ne,expandType:j,theme:s,onZoomToNode:B,projectId:e,projectCode:t},{nodes:Q,edges:pe,epicBacklogId:he,epicChildren:we}=Hj(v,b,Y),ye=Bj(Q,pe),{nodes:te,edges:me}=Wj(ye,he,we,b,Y),Ge=te.map(Fe=>({...Fe,data:{...Fe.data,expandType:Fe.id===b?j:null}}));_e(Ge),fe(me)},[v,b,j,ne,_e,fe,s,B,e,t]);const ve=m.useCallback((Y,Q)=>{},[]);return h&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):x&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:a.jsx("p",{className:"text-red-500 mb-4",children:x})})}):a.jsxs("div",{className:"w-full h-full",children:[a.jsxs(ey,{nodes:J,edges:xe,onNodesChange:G,onEdgesChange:oe,onNodeClick:ve,nodeTypes:iB,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[a.jsx(Hr,{position:"top-left",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),a.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[p==="active"&&a.jsx("span",{className:"text-amber-500",children:" Active"}),p==="stopped"&&a.jsx("span",{className:"text-red-500",children:" Stopped"}),p==="complete"&&a.jsx("span",{className:"text-emerald-500",children:" Complete"}),p==="idle"&&a.jsx("span",{children:" Idle"}),!g&&a.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),a.jsx("button",{onClick:F,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:sB[s]})]})}),a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:a.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),S?a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("input",{type:"text",value:T,onChange:Y=>M(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&q(),Y.key==="Escape"&&W()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:L}),a.jsx("button",{onClick:q,disabled:L,className:"p-1 rounded hover:bg-white/10",title:"Save",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{onClick:W,disabled:L,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:a.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:n||"Untitled Project"})]}),!S&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:I,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{onClick:U,disabled:L,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:r?"#f59e0b":"var(--text-muted)"},title:r?"Unarchive project":"Archive project",children:a.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),r&&a.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),a.jsx("button",{onClick:()=>C(!0),disabled:L||!r,className:`p-1.5 rounded transition-colors ${r?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:r?1:.3,cursor:r?"pointer":"not-allowed"},title:r?"Delete project":"Archive project first to delete",children:a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[a.jsxs("button",{onClick:()=>O(!$),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[a.jsx("span",{children:"Workflow"}),a.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:$?"":""})]}),$&&a.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:a.jsx(H6,{projectId:e})})]})]})}),a.jsx(bE,{position:"top-right",nodeColor:Y=>{var pe;const Q=(pe=Y.data)==null?void 0:pe.state;return["produced","stabilized","ready"].includes(Q)?"#10b981":["in_production","active"].includes(Q)?"#f59e0b":["requirements_not_met","blocked"].includes(Q)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hr,{position:"bottom-left",children:a.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[a.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),a.jsx(Hr,{position:"bottom-right",children:a.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),N&&a.jsx(F6,{projectId:e,projectCode:t,docTypeId:N,onClose:()=>E(null)}),z&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:a.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),a.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",a.jsx("strong",{children:n})," and all its documents. This action cannot be undone."]}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>C(!1),disabled:L,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{onClick:Z,disabled:L,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:L?"Deleting...":"Delete"})]})]})})]})}function sl({messages:e,pendingPrompt:t}){const n=m.useRef(null);return m.useEffect(()=>{var r;(r=n.current)==null||r.scrollIntoView({behavior:"smooth"})},[e,t]),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.map((r,i)=>a.jsx("div",{className:`flex ${r.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${r.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:r.content})},i)),t&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),a.jsx("div",{ref:n})]})}function aB({onSubmit:e,disabled:t,placeholder:n}){const[r,i]=m.useState(""),s=m.useRef(null);m.useEffect(()=>{var c;t||(c=s.current)==null||c.focus()},[t]);const o=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),r.trim()&&!t&&(e(r.trim()),i("")))},l=()=>{r.trim()&&!t&&(e(r.trim()),i(""))};return a.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("textarea",{ref:s,value:r,onChange:c=>i(c.target.value),onKeyDown:o,disabled:t,placeholder:n||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:l,disabled:t||!r.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!r.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),a.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const lB={project_name:"Project Name",problem_statement:"Problem Statement",project_type:"Project Type"},cB=["project_name","problem_statement","project_type"];function uB({interpretation:e,missingFields:t,canInitialize:n,onUpdateField:r,onInitialize:i,loading:s}){const[o,l]=m.useState(null),[c,d]=m.useState(""),u=(h,x)=>{l(h),d(x)},f=async()=>{o&&c.trim()&&(await r(o,c.trim()),l(null),d(""))},p=()=>{l(null),d("")};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Review & Lock"}),t.length>0&&a.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded bg-amber-500/20 text-amber-400",children:[t.length," missing"]})]}),cB.map(h=>{const x=e[h];if(!x)return null;const g=x.locked,w=t.includes(h),v=o===h;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"text-[10px] font-medium",style:{color:"var(--text-muted)"},children:[lB[h]||h,w&&a.jsx("span",{className:"text-amber-400 ml-1",children:"*"})]}),g&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"locked"})]}),v?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:c,onChange:y=>d(y.target.value),onKeyDown:y=>{y.key==="Enter"&&f(),y.key==="Escape"&&p()},autoFocus:!0,className:"flex-1 rounded px-2 py-1.5 text-xs",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:f,className:"px-2 py-1 rounded text-xs bg-emerald-500 text-white",children:"Save"}),a.jsx("button",{onClick:p,className:"px-2 py-1 rounded text-xs",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Cancel"})]}):a.jsx("div",{onClick:()=>!g&&u(h,x.value),className:`rounded px-2 py-1.5 text-xs ${g?"cursor-default":"cursor-pointer hover:bg-white/5"} ${w?"border border-amber-500/50":""}`,style:{background:"var(--bg-input)",color:x.value?"var(--text-primary)":"var(--text-muted)"},children:x.value||"Click to edit..."})]},h)}),a.jsx("button",{onClick:i,disabled:!n||s,className:`w-full py-2.5 rounded-lg text-sm font-medium transition-colors ${n&&!s?"bg-violet-500 text-white hover:bg-violet-400":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:s?"Initializing...":"Lock & Initialize Project"}),!n&&a.jsx("p",{className:"text-[10px] text-center",style:{color:"var(--text-muted)"},children:"Fill all required fields to continue"})]})}function dB(){return a.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[a.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-violet-500/20"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent animate-spin"}),a.jsx("div",{className:"absolute inset-3 rounded-full bg-violet-500/20 animate-pulse"})]}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"Generating Project"}),a.jsx("p",{className:"text-xs text-center max-w-[200px]",style:{color:"var(--text-muted)"},children:"Creating intake document and running quality checks..."}),a.jsxs("div",{className:"flex gap-1 mt-4",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"300ms"}})]})]})}const Gj={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function fB({type:e,className:t}){switch(e){case"check":return a.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 9v4M12 17h.01"}),a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function pB({gateOutcome:e,project:t,onViewProject:n,onClose:r}){const i=Gj[e]||Gj.blocked,s=e==="qualified";return a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:`w-16 h-16 rounded-full ${i.iconBg} flex items-center justify-center mx-auto mb-4`,children:a.jsx(fB,{type:i.icon,className:`w-8 h-8 ${i.iconColor}`})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:i.title}),a.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:i.description}),s&&t&&a.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[a.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),a.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[s&&t&&a.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),a.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function hB({onClose:e,onComplete:t}){const{phase:n,messages:r,pendingPrompt:i,interpretation:s,missingFields:o,canInitialize:l,gateOutcome:c,project:d,error:u,loading:f,submitting:p,startIntake:h,submitMessage:x,updateField:g,lockAndGenerate:w,reset:v}=Z$();m.useEffect(()=>(h(),()=>v()),[]);const y=()=>{v(),e()},b=()=>{d&&t&&t(d),y()},_=()=>{const k=[{id:"describe",label:"Describe"},{id:"review",label:"Review"},{id:"generating",label:"Generate"},{id:"complete",label:"Done"}],N=k.findIndex(E=>E.id===n);return a.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:k.map((E,S)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 py-0.5 rounded ${S===N?"bg-violet-500/30 text-violet-300":S<N?"text-emerald-400":"text-slate-500"}`,children:E.label}),S<k.length-1&&a.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},E.id))})},j=()=>{if(f&&n==="idle")return a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});switch(n){case"describe":return a.jsxs(a.Fragment,{children:[a.jsx(sl,{messages:r,pendingPrompt:i}),a.jsx(aB,{onSubmit:x,disabled:p,placeholder:"Describe what you want to build..."})]});case"review":return a.jsxs(a.Fragment,{children:[a.jsx(sl,{messages:r}),a.jsx("div",{className:"border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx(uB,{interpretation:s,missingFields:o,canInitialize:l,onUpdateField:g,onInitialize:w,loading:f})})]});case"generating":return a.jsxs(a.Fragment,{children:[a.jsx(sl,{messages:r}),a.jsx(dB,{})]});case"complete":return a.jsxs(a.Fragment,{children:[a.jsx(sl,{messages:r}),a.jsx(pB,{gateOutcome:c,project:d,onViewProject:b,onClose:y})]});default:return null}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:a.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),_()]})]}),a.jsx("button",{onClick:y,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),u&&a.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:u}),j()]})})}function mB({onClose:e}){const{user:t,logout:n,isAdmin:r}=Ds(),[i,s]=m.useState(null),[o,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{i==="linked"&&p()},[i]);const p=async()=>{try{d(!0);const j=await fetch("/auth/accounts",{credentials:"include"});if(j.ok){const k=await j.json();l(k.identities||[])}}catch(j){console.error("Failed to load accounts:",j)}finally{d(!1)}},h=j=>{window.location.href=`/auth/accounts/link/${j}`},x=async j=>{var k;if(o.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${j} account?`))try{const N=(k=document.cookie.split("; ").find(S=>S.startsWith("csrf=")||S.startsWith("__Host-csrf=")))==null?void 0:k.split("=")[1],E=await fetch(`/auth/accounts/${j}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(E.ok)f({type:"success",text:"Account unlinked"}),await p();else{const S=await E.json();throw new Error(S.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},g=async()=>{await n(),e()},w=j=>{s(i===j?null:j),f(null)},v={google:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=j=>{const k={user:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),a.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return k[j]||k.user},_=j=>{switch(j){case"account":return a.jsxs("div",{className:"px-4 py-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return a.jsxs("div",{className:"px-4 py-3",children:[u&&a.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-2 mb-4",children:o.map(k=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[v[k.provider_id],a.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:k.provider_email})]}),a.jsx("button",{onClick:()=>x(k.provider_id),disabled:o.length<=1,className:`text-xs px-2 py-1 rounded ${o.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},k.provider_id))}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),a.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.google,"Google"]}),a.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.microsoft,"Microsoft"]})]})]})]});default:return a.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),a.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?a.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),a.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r&&a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),a.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),a.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),a.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),a.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(j=>a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("button",{onClick:()=>!j.future&&w(j.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${j.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:j.future,children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:b(j.icon)}),a.jsx("span",{className:"flex-1 text-sm text-left",children:j.label}),j.future?a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):a.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:i===j.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),i===j.id&&!j.future&&a.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:_(j.id)})]},j.id))]}),a.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Ie={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function gB(){return a.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Ie.bg,borderColor:Ie.border},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Ie.textPrimary},children:"THE COMBINE"}),a.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Ie.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function vB(){return a.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Ie.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),a.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Ie.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),a.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Ie.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ie.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ie.textMuted,children:["Learn how The Combine works",a.jsx("span",{"aria-hidden":"true",children:""})]})]})}function xB(){const e=[{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return a.jsx("section",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,n)=>a.jsxs("div",{className:"flex-1 text-center group",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Ie.bgElevated,border:`1px solid ${Ie.border}`,color:Ie.textMuted},children:t.icon}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Ie.textPrimary},children:t.title}),a.jsx("p",{className:"text-xs",style:{color:Ie.textMuted},children:t.description}),n<e.length-1&&a.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Ie.border}})]},n))})})}function yB(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return a.jsx("section",{className:"text-center",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,n)=>a.jsx("span",{className:"text-xs",style:{color:Ie.textMuted},children:t},n))})})}function bB({onLogin:e}){return a.jsxs("section",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Ie.textSecondary},children:"Ready?"}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ie.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ie.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ie.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ie.bg,border:`1px solid ${Ie.border}`,color:Ie.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ie.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ie.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function wB(){return a.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ie.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ie.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ie.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ie.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ie.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ie.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ie.border},children:" 2026 The Combine"})]})}function _B(){const{login:e}=Ds();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ie.bg},children:[a.jsx(gB,{}),a.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:a.jsxs("div",{className:"space-y-12",children:[a.jsx(vB,{}),a.jsx(xB,{}),a.jsx(yB,{}),a.jsx(bB,{onLogin:e})]})}),a.jsx(wB,{})]})}const Ee={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function jB(){return a.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Ee.bg,borderColor:Ee.border},children:[a.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Ee.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ee.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ee.textMuted,children:[a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),a.jsx("span",{className:"text-sm",children:"Back"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),a.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Ee.textPrimary},children:"THE COMBINE"})]}),a.jsx("div",{className:"w-16"})," "]})}function ii({title:e,children:t}){return a.jsxs("section",{className:"mb-16",children:[e&&a.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Ee.textPrimary},children:e}),t]})}function pt({children:e,className:t=""}){return a.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Ee.textSecondary},children:e})}function eo({children:e}){return a.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Ee.textPrimary,borderLeft:`2px solid ${Ee.border}`},children:e})}function ol({items:e}){return a.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,n)=>a.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Ee.textSecondary},children:[a.jsx("span",{style:{color:Ee.textMuted},children:"-"}),t]},n))})}function al({number:e,title:t,children:n}){return a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[a.jsxs("span",{className:"text-sm font-mono",style:{color:Ee.textMuted},children:[e,"."]}),a.jsx("h3",{className:"text-base font-medium",style:{color:Ee.textPrimary},children:t})]}),a.jsx("div",{className:"pl-7",children:a.jsx(pt,{children:n})})]})}function ll({title:e,children:t}){return a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Ee.textPrimary},children:e}),a.jsx(pt,{className:"mb-0",children:t})]})}function SB({onLogin:e}){return a.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Ee.bgElevated,border:`1px solid ${Ee.border}`},children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Ee.textPrimary},children:"When You're Ready"}),a.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),a.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),a.jsx(pt,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ee.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ee.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.bg,border:`1px solid ${Ee.border}`,color:Ee.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ee.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ee.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function kB(){return a.jsxs("footer",{className:"py-8 text-center",children:[a.jsx("p",{className:"text-sm mb-6",style:{color:Ee.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ee.border},children:" 2026 The Combine"})]})]})}function NB(){const{login:e}=Ds();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ee.bg},children:[a.jsx(jB,{}),a.jsx("main",{className:"flex-1 px-6 py-12",children:a.jsxs("article",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Ee.textPrimary},children:"Learn More"}),a.jsxs(ii,{title:"What The Combine Is",children:[a.jsx(pt,{children:"The Combine is an AI-assisted production system for knowledge work."}),a.jsx(pt,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),a.jsx(eo,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),a.jsx(eo,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),a.jsxs(ii,{title:"Why It Exists",children:[a.jsx(pt,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),a.jsx(pt,{children:"It breaks down when the work must be:"}),a.jsx(ol,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),a.jsx(pt,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),a.jsxs(ii,{title:'Why "The Combine"',children:[a.jsx(pt,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),a.jsx(pt,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),a.jsx(pt,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),a.jsx(pt,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),a.jsx(pt,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),a.jsx(ol,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),a.jsx(pt,{children:"This is not automation for speed. It is industrialization for reliability."}),a.jsx(eo,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),a.jsxs(ii,{title:"How It Works",children:[a.jsx(al,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),a.jsx(al,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),a.jsx(al,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),a.jsx(al,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),a.jsxs(ii,{title:"What Makes It Different",children:[a.jsx(ll,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),a.jsx(ll,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),a.jsx(ll,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),a.jsx(ll,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),a.jsxs(ii,{title:"What The Combine Is Not",children:[a.jsx(ol,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),a.jsx(pt,{children:"If you want improvisation, there are better tools."}),a.jsx(eo,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),a.jsxs(ii,{title:"Who It's For",children:[a.jsx(pt,{children:"The Combine is designed for people responsible for outcomes, including:"}),a.jsx(ol,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),a.jsx(eo,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),a.jsx(SB,{onLogin:e})]})}),a.jsx(kB,{})]})}function $T(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getTemplates();t(l.templates||[])}catch(l){s(l.message),console.error("Failed to fetch templates:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{templates:e,loading:n,error:i,refresh:o}}function CB(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){s(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{workflows:e,loading:n,error:i,refresh:o}}function BT(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{r(!0),s(null);try{const l=await je.getSchemas();t(l.schemas||[])}catch(l){s(l.message),console.error("Failed to fetch schemas:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{o()},[o]),{schemas:e,loading:n,error:i,refresh:o}}function HT(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[i,s]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){r(!0),s(null);try{const h=await je.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&s(h.message||"Failed to load prompt fragments")}finally{f&&r(!1)}}return p(),()=>{f=!1}},[]);const o=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:o.role.length,task:o.task.length,qa:o.qa.length,pgc:o.pgc.length,questions:o.questions.length,reflection:o.reflection.length}),[e,o]),c=m.useCallback(f=>!f||f==="all"?e:o[f]||[],[e,o]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{r(!0),s(null);try{const f=await je.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),s(f.message||"Failed to refresh")}finally{r(!1)}},[]);return{fragments:e,loading:n,error:i,fragmentsByKind:o,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const og="doctype-browser-collapsed";function WT(e,t){const[n,r]=m.useState(()=>{try{const s=JSON.parse(localStorage.getItem(og)||"{}");return e in s?s[e]:t}catch{return t}}),i=m.useCallback(s=>{const o=typeof s=="function"?s(n):s;r(o);try{const l=JSON.parse(localStorage.getItem(og)||"{}");l[e]=o,localStorage.setItem(og,JSON.stringify(l))}catch{}},[e,n]);return[n,i]}function Kj({title:e,defaultOpen:t=!0,children:n}){const[r,i]=WT(`group:${e}`,t);return a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>i(!r),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:r?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),r&&n]})}function Yj({title:e,action:t,defaultOpen:n=!0,dotColor:r,children:i}){const[s,o]=WT(`sub:${e}`,n);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:s?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),r&&a.jsx("span",{style:{color:r,fontSize:8},children:""}),a.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),s&&i]})}function Xj({selected:e,onClick:t,label:n,sublabel:r,badge:i}){return a.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:n}),i&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:i})]}),r&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function Qj({loading:e,empty:t,emptyMessage:n="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:n}):null}function EB({documentTypes:e=[],roles:t=[],templates:n=[],workflows:r=[],promptFragments:i=[],promptFragmentKindOptions:s=[],schemas:o=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:x=null,selectedRole:g=null,selectedTemplate:w=null,selectedWorkflow:v=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:_,onSelectRole:j,onSelectTemplate:k,onSelectWorkflow:N,onSelectFragment:E,onSelectStandaloneSchema:S,onCreateWorkflow:R,onCreateDocType:T,onCreateFragment:M,onCreateTemplate:z,onCreateSchema:C,onSelectTask:L,onSelectSchema:P,workspaceState:$=null}){var ye;const[O,A]=m.useState(null),[F,I]=m.useState(null),[q,W]=m.useState(""),[U,Z]=m.useState(!1),[B,ne]=m.useState(!1),[se,ce]=m.useState(""),[J,_e]=m.useState(!1),G=[...e].sort((te,me)=>(te.display_name||"").localeCompare(me.display_name||"")),xe=r.filter(te=>(te.pow_class||"reference")==="reference"),fe=te=>{const me=te.pow_class||"reference";return me==="reference"?"ref":me==="template"?"tpl":"inst"},oe=e.filter(te=>te.active_version).length+r.filter(te=>te.active_version).length,ve=((ye=$==null?void 0:$.modified_artifacts)==null?void 0:ye.length)??0,Y=($==null?void 0:$.is_dirty)??!1,Q=()=>{A(null),I(null),W("")},pe=()=>{ne(!1),ce("")},he=async()=>{const te=se.trim().toLowerCase().replace(/\s+/g,"_");if(!(!te||!/^[a-z][a-z0-9_]*$/.test(te))){_e(!0);try{await(T==null?void 0:T({doc_type_id:te})),pe()}catch{}finally{_e(!1)}}},we=async()=>{const te=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!te||!/^[a-z][a-z0-9_]*$/.test(te))){Z(!0);try{const me={workflow_id:te,pow_class:"template"};F&&(me.derived_from={workflow_id:F.workflow_id,version:F.active_version},me.source_version=F.active_version),await(R==null?void 0:R(me)),Q()}catch{}finally{Z(!1)}}};return a.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(Kj,{title:"Production Workflows",defaultOpen:!0,children:[a.jsxs(Yj,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&a.jsx("button",{onClick:()=>A(O?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[O==="choose"&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("button",{onClick:()=>A("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:xe.length===0,children:["From Reference",xe.length===0?" (none available)":""]}),a.jsx("button",{onClick:()=>A("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),a.jsx("button",{onClick:Q,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),O==="from_reference"&&!F&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),xe.map(te=>a.jsxs("button",{onClick:()=>I(te),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("div",{className:"font-medium",children:te.name||te.workflow_id.replace(/_/g," ").replace(/\b\w/g,me=>me.toUpperCase())}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",te.active_version]})]},te.workflow_id)),a.jsx("button",{onClick:()=>A("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(O==="blank"||O==="from_reference"&&F)&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[F&&a.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",F.name||F.workflow_id," v",F.active_version]}),a.jsx("input",{type:"text",value:q,onChange:te=>W(te.target.value),onKeyDown:te=>{te.key==="Enter"&&we(),te.key==="Escape"&&Q()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:U,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:we,disabled:U||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:U?"wait":"pointer",opacity:!q.trim()||U?.5:1},children:U?"Creating...":"Create"}),a.jsx("button",{onClick:Q,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(Qj,{loading:u,empty:!u&&r.length===0,emptyMessage:"No workflows"}),!u&&r.length>0&&a.jsx("div",{className:"py-1",children:r.map(te=>a.jsx(Xj,{selected:(v==null?void 0:v.workflow_id)===te.workflow_id,onClick:()=>N==null?void 0:N(te),label:te.name||te.workflow_id.replace(/_/g," ").replace(/\b\w/g,me=>me.toUpperCase()),sublabel:`v${te.active_version}`,badge:fe(te)},te.workflow_id))})]}),a.jsxs(Yj,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&a.jsx("button",{onClick:()=>ne(!B),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[B&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:se,onChange:te=>ce(te.target.value),onKeyDown:te=>{te.key==="Enter"&&he(),te.key==="Escape"&&pe()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:J,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:he,disabled:J||!se.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:J?"wait":"pointer",opacity:!se.trim()||J?.5:1},children:J?"Creating...":"Create"}),a.jsx("button",{onClick:pe,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(Qj,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&G.length>0&&a.jsx("div",{className:"py-1",children:G.map(te=>a.jsx(Xj,{selected:x==="docworkflow"&&(h==null?void 0:h.doc_type_id)===te.doc_type_id,onClick:()=>_==null?void 0:_(te),label:te.display_name,badge:`v${te.active_version}`},te.doc_type_id))})]})]}),a.jsxs(Kj,{title:"Governance",defaultOpen:!1,children:[a.jsx("div",{className:"px-4 py-3",children:a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),a.jsxs("div",{children:[oe," active ",oe===1?"release":"releases"]})]})}),$&&a.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),Y&&a.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[ve," dirty"]})]})]})]})})}function TB({kinds:e=[],selectedKind:t="all",onSelect:n}){return a.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:r,label:i,count:s})=>{const o=t===r;return a.jsxs("button",{onClick:()=>n==null?void 0:n(r),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:o?"var(--action-primary)":"var(--bg-panel)",color:o?"#000":"var(--text-secondary)",border:o?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[i,s!==void 0&&a.jsxs("span",{style:{marginLeft:4,opacity:o?.7:.6},children:["(",s,")"]})]},r)})})}function cl({title:e,count:t,dotColor:n,defaultOpen:r=!1,action:i,children:s}){const[o,l]=m.useState(r);return a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[a.jsxs("button",{onClick:()=>l(!o),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),a.jsx("span",{style:{color:n,fontSize:10},children:""}),a.jsx("span",{className:"font-semibold",children:e})]}),a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),i&&a.jsx("div",{className:"pr-3",children:i})]}),o&&a.jsx("div",{style:{background:"var(--bg-panel)"},children:s})]})}function to({onClick:e,label:t,sublabel:n,badge:r}){return a.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:t}),r&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:r})]}),n&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function ul({loading:e,empty:t,emptyMessage:n="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:n}):null}function RB({isOpen:e,onClose:t,promptFragments:n=[],promptFragmentKindOptions:r=[],templates:i=[],schemas:s=[],documentTypes:o=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,onSelectFragment:h,onSelectTemplate:x,onSelectSchema:g,onSelectStandaloneSchema:w,onSelectMechanicalOp:v,onCreateFragment:y,onCreateTemplate:b,onCreateSchema:_}){const[j,k]=m.useState("all"),[N,E]=m.useState(!1),[S,R]=m.useState("role"),[T,M]=m.useState(""),[z,C]=m.useState(!1),[L,P]=m.useState(!1),[$,O]=m.useState(""),[A,F]=m.useState(!1),[I,q]=m.useState(!1),[W,U]=m.useState(""),[Z,B]=m.useState(!1),ne=j==="all"?n:n.filter(G=>G.kind===j);m.useEffect(()=>{e||(E(!1),P(!1),q(!1),M(""),O(""),U(""))},[e]);const se=m.useCallback((G,xe)=>{G==null||G(xe)},[]),ce=async()=>{const G=T.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){C(!0);try{await(y==null?void 0:y({role_id:G,kind:S})),E(!1),M("")}catch{}finally{C(!1)}}},J=async()=>{const G=$.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){F(!0);try{await(b==null?void 0:b({template_id:G})),P(!1),O("")}catch{}finally{F(!1)}}},_e=async()=>{const G=W.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){B(!0);try{await(_==null?void 0:_({schema_id:G})),q(!1),U("")}catch{}finally{B(!1)}}};return e?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),a.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),a.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(cl,{title:"Prompt Fragments",count:n.length,dotColor:"#f59e0b",defaultOpen:!0,action:y&&a.jsx("button",{onClick:()=>E(!N),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[N&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),a.jsx("select",{value:S,onChange:G=>R(G.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:a.jsx("option",{value:"role",children:"Role"})})]}),a.jsx("input",{type:"text",value:T,onChange:G=>M(G.target.value),onKeyDown:G=>{G.key==="Enter"&&ce(),G.key==="Escape"&&E(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:z,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:ce,disabled:z||!T.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:z?"wait":"pointer",opacity:!T.trim()||z?.5:1},children:z?"Creating...":"Create"}),a.jsx("button",{onClick:()=>E(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),r.length>0&&a.jsx(TB,{kinds:r,selectedKind:j,onSelect:k}),a.jsx(ul,{loading:d,empty:!d&&ne.length===0,emptyMessage:j==="all"?"No prompt fragments":`No ${j} fragments`}),!d&&ne.length>0&&a.jsx("div",{className:"py-1",children:ne.map(G=>a.jsx(to,{onClick:()=>se(h,G),label:G.name||G.fragment_id,sublabel:`${G.kind}  v${G.version}`,badge:G.kind},G.fragment_id))})]}),a.jsxs(cl,{title:"Templates",count:i.length,dotColor:"var(--dot-green)",action:b&&a.jsx("button",{onClick:()=>P(!L),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[L&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:$,onChange:G=>O(G.target.value),onKeyDown:G=>{G.key==="Enter"&&J(),G.key==="Escape"&&P(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:A,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:J,disabled:A||!$.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:A?"wait":"pointer",opacity:!$.trim()||A?.5:1},children:A?"Creating...":"Create"}),a.jsx("button",{onClick:()=>P(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ul,{loading:u,empty:!u&&i.length===0,emptyMessage:"No templates"}),!u&&i.length>0&&a.jsx("div",{className:"py-1",children:i.map(G=>a.jsx(to,{onClick:()=>se(x,G),label:G.name||G.template_id.replace(/_/g," ").replace(/\b\w/g,xe=>xe.toUpperCase()),sublabel:`v${G.active_version}`},G.template_id))})]}),a.jsxs(cl,{title:"Schemas",count:s.length||o.length,dotColor:"var(--dot-blue)",action:_&&a.jsx("button",{onClick:()=>q(!I),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[I&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:W,onChange:G=>U(G.target.value),onKeyDown:G=>{G.key==="Enter"&&_e(),G.key==="Escape"&&q(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:Z,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:_e,disabled:Z||!W.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Z?"wait":"pointer",opacity:!W.trim()||Z?.5:1},children:Z?"Creating...":"Create"}),a.jsx("button",{onClick:()=>q(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ul,{loading:f,empty:!f&&s.length===0&&o.length===0,emptyMessage:"No schemas"}),!f&&s.length>0&&a.jsx("div",{className:"py-1",children:s.map(G=>a.jsx(to,{onClick:()=>se(w,G),label:G.title||G.schema_id,sublabel:`v${G.active_version}`},`standalone-${G.schema_id}`))}),s.length===0&&o.length>0&&a.jsx("div",{className:"py-1",children:o.map(G=>a.jsx(to,{onClick:()=>se(g,{doc_type_id:G.doc_type_id,display_name:G.display_name,active_version:G.active_version}),label:G.display_name,sublabel:`from ${G.doc_type_id}`},`schema-${G.doc_type_id}`))})]}),a.jsxs(cl,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[a.jsx(ul,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&a.jsx("div",{className:"py-1",children:l.map(G=>{const xe=c.filter(fe=>fe.type===G.type_id);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsx("span",{style:{fontSize:10},children:""}),a.jsx("span",{children:G.name}),a.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",xe.length,")"]})]}),xe.length>0?xe.map(fe=>a.jsx(to,{onClick:()=>se(v,fe),label:fe.name,sublabel:`v${fe.active_version}`,badge:fe.type},fe.op_id)):a.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},G.type_id)})}),!p&&l.length===0&&c.length===0&&a.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),a.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function tr({content:e,onChange:t,loading:n=!1,saving:r=!1,isDirty:i=!1,error:s=null,readOnly:o=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o&&a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!o&&i&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&!o&&a.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),n&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),r&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!r&&!n&&i&&a.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),s&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",s]})]})]}),a.jsx("div",{className:"flex-1 relative",children:n?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):a.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:o,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function AB({workspaceId:e,artifactId:t}){const[n,r]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){r(null),s(!1);return}(async()=>{s(!0),l(null);try{const d=await je.getPreview(e,t);r(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{s(!1)}})()},[e,t]),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(n==null?void 0:n.provenance)&&a.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[n.provenance.role&&a.jsxs("div",{children:["Role: ",n.provenance.role]}),n.provenance.schema&&a.jsxs("div",{children:["Schema: ",n.provenance.schema]}),n.provenance.package&&a.jsxs("div",{children:["Package: ",n.provenance.package]})]})]}),a.jsx("div",{className:"flex-1 relative overflow-auto",children:i?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):o?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[a.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:o})]})}):a.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(n==null?void 0:n.resolved_prompt)||"No preview available"})})]})}function IB({workspaceId:e,docType:t,roles:n=[],onSave:r}){const[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,_,j;t&&(s({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((_=t.ui)==null?void 0:_.category)||"",ui_display_order:((j=t.ui)==null?void 0:j.display_order)||0}),h(!1),f(null))},[t]);const x=m.useCallback((b,_)=>{s(j=>({...j,[b]:_})),h(!0)},[]),g=m.useCallback((b,_)=>{const j=_.split(",").map(k=>k.trim()).filter(k=>k);s(k=>({...k,[b]:j})),h(!0)},[]),w=m.useCallback(b=>{if(!b)return"";const _=n.find(j=>j.role_id===b);return _?`prompt:role:${b}:${_.active_version}`:""},[n]),v=m.useCallback(b=>{if(!b)return"";const _=b.split(":");return _.length>=3&&_[0]==="prompt"&&_[1]==="role"?_[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!i)){d(!0),f(null);try{const b=t.version||t.active_version,_=`doctype:${t.doc_type_id}:${b}:manifest`,j=MB(t.doc_type_id,b,i),k=await je.writeArtifact(e,_,j);h(!1),r==null||r(_,k)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,i,r]);return!t||!i?a.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"flex items-center gap-2",children:p&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),a.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsxs(no,{title:"Identity",children:[a.jsx(Zt,{label:"Display Name",children:a.jsx("input",{type:"text",value:i.display_name,onChange:b=>x("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Description",children:a.jsx("textarea",{value:i.description,onChange:b=>x("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"Classification",children:[a.jsx(Zt,{label:"Authority Level",children:a.jsxs("select",{value:i.authority_level,onChange:b=>x("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"descriptive",children:"Descriptive"}),a.jsx("option",{value:"prescriptive",children:"Prescriptive"}),a.jsx("option",{value:"constructive",children:"Constructive"}),a.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),a.jsx(Zt,{label:"Creation Mode",children:a.jsxs("select",{value:i.creation_mode,onChange:b=>x("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"llm_generated",children:"LLM Generated"}),a.jsx("option",{value:"constructed",children:"Constructed"}),a.jsx("option",{value:"extracted",children:"Extracted"})]})}),a.jsx(Zt,{label:"Scope",children:a.jsxs("select",{value:i.scope,onChange:b=>x("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"epic",children:"Epic"}),a.jsx("option",{value:"feature",children:"Feature"})]})})]}),a.jsx(no,{title:"Shared References",children:a.jsxs(Zt,{label:"Role Prompt",children:[a.jsxs("select",{value:v(i.role_prompt_ref),onChange:b=>x("role_prompt_ref",w(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"None"}),n.map(b=>a.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())},b.role_id))]}),i.role_prompt_ref&&a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:i.role_prompt_ref})]})}),a.jsxs(no,{title:"Dependencies",children:[a.jsx(Zt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Parent Doc Type",children:a.jsx("input",{type:"text",value:i.parent_doc_type,onChange:b=>x("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"UI Configuration",children:[a.jsx(Zt,{label:"Icon",children:a.jsx("input",{type:"text",value:i.ui_icon,onChange:b=>x("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Category",children:a.jsxs("select",{value:i.ui_category,onChange:b=>x("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"Select category..."}),a.jsx("option",{value:"intake",children:"Intake"}),a.jsx("option",{value:"architecture",children:"Architecture"}),a.jsx("option",{value:"planning",children:"Planning"}),a.jsx("option",{value:"execution",children:"Execution"})]})}),a.jsx(Zt,{label:"Display Order",children:a.jsx("input",{type:"number",value:i.ui_display_order,onChange:b=>x("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function no({title:e,children:t}){return a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),a.jsx("div",{className:"space-y-4",children:t})]})}function Zt({label:e,hint:t,children:n}){return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&a.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),n]})}function MB(e,t,n){return[`# ${n.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${n.display_name}"`,`version: "${t}"`,"description: >",`  ${n.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${n.authority_level}`,`creation_mode: ${n.creation_mode}`,n.production_mode?`production_mode: ${n.production_mode}`:"production_mode: null",`scope: ${n.scope}`,"","# Dependencies",`required_inputs: [${n.required_inputs.map(i=>`"${i}"`).join(", ")}]`,`optional_inputs: [${n.optional_inputs.map(i=>`"${i}"`).join(", ")}]`,`creates_children: [${n.creates_children.map(i=>`"${i}"`).join(", ")}]`,`parent_doc_type: ${n.parent_doc_type?`"${n.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${n.role_prompt_ref?`"${n.role_prompt_ref}"`:"null"}`,`template_ref: ${n.template_ref?`"${n.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${n.ui_icon||"file"}`,`  category: ${n.ui_category||"other"}`,`  display_order: ${n.ui_display_order||0}`,""].join(`
`)}function UT(e,t,{debounceMs:n=1e3,onSave:r}={}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(null),l(null),d(!1);return}d(!0),f(null);try{const N=await je.getArtifact(e,t),E=JSON.parse(N.content);s(E),l(E)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{d(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){h(!0),f(null);try{const E=JSON.stringify(N,null,2),S=await je.writeArtifact(e,t,E);g(S),l(N),r&&r(S)}catch(E){f(E.message),console.error("Failed to save workflow:",E)}finally{h(!1)}}},[e,t,r]),_=m.useCallback(N=>{v.current=N,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},n)},[b,n]),j=m.useCallback(N=>{s(N),_(N)},[_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),i&&b(i)},[i,b]);return m.useEffect(()=>(y(),()=>{w.current&&clearTimeout(w.current)}),[y]),{workflowJson:i,originalJson:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateWorkflow:j,saveNow:k,reload:y}}function PB({data:e,selected:t}){const{config:n,isEntry:r}=e,i=e.type==="end";return a.jsxs("div",{style:{background:n.bgColor,border:`2px solid ${t?n.color:n.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${n.color}60, 0 0 20px ${n.color}80, 0 0 40px ${n.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[a.jsx(Vn,{type:"target",position:le.Top,style:{background:n.color,width:8,height:8,border:"none"}}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[a.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:n.color,letterSpacing:"0.05em"},children:n.label}),r&&a.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:n.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),a.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&a.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),a.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!i&&a.jsx(Vn,{type:"source",position:le.Bottom,style:{background:n.color,width:8,height:8,border:"none"}})]})}const OB=m.memo(PB),vc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},DB={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},Zj=220,Jj=110;function eS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],n=e.nodes.map(i=>{const s=vc[i.type]||vc.task,l=i.type==="end"&&["blocked","abandoned"].includes(i.terminal_outcome)?DB:s;return{id:i.node_id,type:"workflowNode",position:i._position||{x:0,y:0},data:{...i,config:l,isEntry:t.includes(i.node_id)}}}),r=(e.edges||[]).map(i=>{const s=i.non_advancing||!i.to_node_id,o=i.conditions&&i.conditions.length>0;let l=i.label||i.outcome;if(o){const c=i.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id||i.from_node_id,type:"smoothstep",animated:s,label:l,data:{...i},style:{stroke:s?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:s?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:i.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:n,edges:r}}function tS(e,t,n="TB"){const r=new gc.graphlib.Graph;return r.setDefaultEdgeLabel(()=>({})),r.setGraph({rankdir:n,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(i=>{r.setNode(i.id,{width:Zj,height:Jj})}),t.forEach(i=>{i.target!==i.source&&r.setEdge(i.source,i.target)}),gc.layout(r),e.map(i=>{const s=r.node(i.id);return s?{...i,position:{x:s.x-Zj/2,y:s.y-Jj/2}}:i})}function LB(e,t){const n=new Set(t.map(s=>s.id||s.node_id));let r=1,i=`${e}_${r}`;for(;n.has(i);)r++,i=`${e}_${r}`;return i}function FB(e,t,n){const r=new Set(n.map(o=>o.id||o.edge_id));let i=1,s=`${e}_to_${t}`;for(;r.has(s);)i++,s=`${e}_to_${t}_${i}`;return s}function zB(e,t={x:100,y:100}){const r={node_id:e+"_new",type:e,description:""};return e==="end"&&(r.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(r.task_ref="",r.includes={}),e==="qa"&&(r.requires_qa=!0,r.qa_mode="semantic"),r}const qB={workflowNode:OB},$B=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function BB({workflowJson:e,onWorkflowChange:t,selectedNodeId:n,selectedEdgeId:r,onNodeSelect:i,onEdgeSelect:s}){const o=Zc(),[l,c,d]=gE([]),[u,f,p]=vE([]),[h,x]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:S,edges:R}=eS(e);(!S.some(M=>M.position.x!==0||M.position.y!==0)||!g.current)&&(S=tS(S,R),g.current=!0),c(S),f(R)},[e,c,f]),m.useEffect(()=>{c(S=>S.map(R=>({...R,selected:R.id===n})))},[n,c]);const w=m.useCallback(S=>{if(!e)return;const T={edge_id:FB(S.source,S.target,e.edges||[]),from_node_id:S.source,to_node_id:S.target,outcome:"success",label:"",kind:"auto"},M={...e,edges:[...e.edges||[],T]};t(M)},[e,t]),v=m.useCallback((S,R)=>{if(!e)return;const T=e.nodes.map(M=>M.node_id===R.id?{...M,_position:R.position}:M);t({...e,nodes:T})},[e,t]),y=m.useCallback((S,R)=>{i==null||i(R.id)},[i]),b=m.useCallback((S,R)=>{s==null||s(R.id)},[s]),_=m.useCallback(()=>{i==null||i(null),s==null||s(null)},[i,s]),j=m.useCallback(S=>{if(S.key==="Delete"||S.key==="Backspace"){if(n&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==n),edges:e.edges.filter(T=>T.from_node_id!==n&&T.to_node_id!==n),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==n)};t(R),i==null||i(null)}else if(r&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==r)};t(R),s==null||s(null)}}},[n,r,e,t,i,s]),k=m.useCallback(S=>{if(!e)return;const R=LB(S,e.nodes||[]),T=zB(S);T.node_id=R;const M=o.getViewport(),z=(-M.x+window.innerWidth/2)/M.zoom,C=(-M.y+window.innerHeight/2)/M.zoom;T._position={x:z-110,y:C-50};const L={...e,nodes:[...e.nodes||[],T]};t(L),x(!1),i==null||i(R)},[e,t,o,i]),N=m.useCallback(()=>{if(!e)return;let{nodes:S,edges:R}=eS(e);S=tS(S,R);const T=e.nodes.map(M=>{const z=S.find(C=>C.id===M.node_id);return z?{...M,_position:z.position}:M});t({...e,nodes:T}),setTimeout(()=>{o.fitView({padding:.2,duration:300})},50)},[e,t,o]),E=m.useCallback(()=>{o.fitView({padding:.2,duration:300})},[o]);return a.jsx("div",{className:"flex-1 relative",onKeyDown:j,tabIndex:0,style:{outline:"none"},children:a.jsxs(ey,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:w,onNodeDragStop:v,onNodeClick:y,onEdgeClick:b,onPaneClick:_,nodeTypes:qB,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[a.jsx(Hr,{position:"top-left",children:a.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>x(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&a.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:$B.map(S=>{const R=vc[S.value]||{};return a.jsxs("button",{onClick:()=>k(S.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),S.label]},S.value)})})]}),a.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),a.jsx("button",{onClick:E,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),a.jsx(bE,{position:"bottom-right",nodeColor:S=>{var T;const R=(T=S.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hr,{position:"bottom-left",children:a.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(vc).map(([S,R])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},S))})}),a.jsx(Hr,{position:"top-right",children:a.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const HB=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],nS=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],rS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],WB=["semantic","structural","hybrid"],UB=["stabilized","blocked","abandoned"],Le={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Rt={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},VB={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function ag(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function lg(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function zi(e){var i;if(!e)return"";const t=e.kind||"role",n=((i=e.fragment_id)==null?void 0:i.replace(`${t}:`,""))||e.id||"",r=e.version||e.active_version||"1.0.0";return`prompt:${t}:${n}:${r}`}function qi(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function dl(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function fl(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function cg({title:e,defaultOpen:t=!1,isOpen:n,onToggle:r,children:i,badge:s}){const[o,l]=m.useState(t),c=n!==void 0,d=c?n:o,u=()=>{c&&r?r():l(!o)};return a.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:a.jsx("path",{d:"M9 18l6-6-6-6"})}),a.jsx("span",{style:{...Rt,marginBottom:0},children:e})]}),s&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:s})]}),d&&a.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:i})]})}function iS(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function pl(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function GB({node:e,onChange:t,onDelete:n,templates:r=[],schemas:i=[],roleFragments:s=[],taskFragments:o=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var he,we,ye,te,me,Ge,Fe,$e,Te,Be,at,Re,X,Pe,ge,kt,xt,yt,Qt;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const x=(D,H)=>{const K={...u,[D]:H};f(K),t(K)},g=(D,H)=>{const K={...u.includes,[D]:H},re={...u,includes:K};f(re),t(re)},w=D=>{const H={...u.includes};delete H[D];const K={...u,includes:H};f(K),t(K)},v=()=>{const D={...u.includes,NEW_KEY:""},H={...u,includes:D};f(H),t(H)},y=D=>{const H={...u,internals:D};f(H),t(H)},b=(D,H)=>{const K=u.internals||k(),re={...K.question_generation,[D]:H};y({...K,question_generation:re})},_=(D,H)=>{const K=u.internals||k(),re={...K.question_generation.includes,[D]:H},Oe={...K.question_generation,includes:re};y({...K,question_generation:Oe})},j=(D,H)=>{const K=u.internals||k(),re={...K.clarification_merge,[D]:H};y({...K,clarification_merge:re})},k=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const N=u.type==="pgc",E=lg(u.task_ref),S=u.includes||{},R=S.ROLE_PROMPT||"",T=S.TASK_PROMPT||"",M=S.OUTPUT_SCHEMA||"",z=S.PGC_CONTEXT||"",C=qi(R),L=qi(T),P=fl(M),$=qi(z),O=Object.entries(S).filter(([D])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(D)),A=u.internals||k(),F=lg((he=A.question_generation)==null?void 0:he.template_ref),I=qi((ye=(we=A.question_generation)==null?void 0:we.includes)==null?void 0:ye.ROLE_PROMPT),q=qi((me=(te=A.question_generation)==null?void 0:te.includes)==null?void 0:me.TASK_PROMPT),W=qi((Fe=(Ge=A.question_generation)==null?void 0:Ge.includes)==null?void 0:Fe.PGC_CONTEXT),U=fl(($e=A.question_generation)==null?void 0:$e.output_schema_ref),Z=lg((Te=A.clarification_merge)==null?void 0:Te.template_ref),B=fl((Be=A.clarification_merge)==null?void 0:Be.output_schema_ref),ne=D=>{const H=D.target.value;if(!H){x("task_ref","");return}const K=r.find(re=>re.template_id===H);K&&x("task_ref",ag(K))},se=D=>{const H=D.target.value;if(!H){w("ROLE_PROMPT");return}const K=s.find(re=>re.fragment_id===`role:${H}`||re.id===H);K&&g("ROLE_PROMPT",zi(K))},ce=D=>{const H=D.target.value;if(!H){w("TASK_PROMPT");return}const K=o.find(re=>re.fragment_id===`task:${H}`||re.id===H);K&&g("TASK_PROMPT",zi(K))},J=D=>{const H=D.target.value;if(!H){w("OUTPUT_SCHEMA");return}const K=i.find(re=>re.schema_id===H);K&&g("OUTPUT_SCHEMA",dl(K))},_e=D=>{const H=D.target.value;if(!H){w("PGC_CONTEXT");return}const K=l.find(re=>re.fragment_id===`pgc:${H}`||re.id===H);K&&g("PGC_CONTEXT",zi(K))},G=D=>{const H=D.target.value,K=rS.find(lt=>lt.value===H),re=(K==null?void 0:K.produces)||`pgc_clarifications.${H}`,Oe={...u,gate_kind:H,produces:re};f(Oe),t(Oe)},xe=D=>{const H=D.target.value;if(!H){b("template_ref","");return}const K=r.find(re=>re.template_id===H);K&&b("template_ref",ag(K))},fe=D=>{const H=D.target.value;if(!H){_("ROLE_PROMPT","");return}const K=s.find(re=>re.fragment_id===`role:${H}`||re.id===H);K&&_("ROLE_PROMPT",zi(K))},oe=D=>{const H=D.target.value;if(!H){_("TASK_PROMPT","");return}const K=o.find(re=>re.fragment_id===`task:${H}`||re.id===H);K&&_("TASK_PROMPT",zi(K))},ve=D=>{const H=D.target.value;if(!H){_("PGC_CONTEXT","");return}const K=l.find(re=>re.fragment_id===`pgc:${H}`||re.id===H);K&&_("PGC_CONTEXT",zi(K))},Y=D=>{const H=D.target.value;if(!H){b("output_schema_ref","");return}const K=i.find(re=>re.schema_id===H);K&&b("output_schema_ref",dl(K))},Q=D=>{const H=D.target.value;if(!H){j("template_ref","");return}const K=r.find(re=>re.template_id===H);K&&j("template_ref",ag(K))},pe=D=>{const H=D.target.value;if(!H){j("output_schema_ref","");return}const K=i.find(re=>re.schema_id===H);K&&j("output_schema_ref",dl(K))};return a.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:N?"PGC Gate Properties":"Node Properties"}),a.jsx("button",{onClick:()=>n(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Node ID"}),a.jsx("input",{type:"text",value:u.node_id||"",onChange:D=>x("node_id",D.target.value),style:Le})]}),a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Type"}),a.jsx("select",{value:u.type||"task",onChange:D=>x("type",D.target.value),style:Le,children:HB.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))})]}),N&&a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Gate Kind"}),a.jsx("select",{value:u.gate_kind||"discovery",onChange:G,style:Le,children:rS.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))})]}),a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Description"}),a.jsx("textarea",{value:u.description||"",onChange:D=>x("description",D.target.value),rows:2,style:{...Le,resize:"vertical"}})]}),(N||["task","intake_gate"].includes(u.type))&&a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Produces"}),a.jsx("input",{type:"text",value:u.produces||"",onChange:D=>x("produces",D.target.value),placeholder:N?"pgc_clarifications.discovery":"document_type",style:Le})]}),N&&a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{style:VB,children:"Gate Internals"}),a.jsx(cg,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:F||"",onChange:xe,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),r.map(D=>a.jsx("option",{value:D.template_id,children:D.name||D.template_id.replace(/_/g," ")},D.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:I||"",onChange:fe,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("role:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:q||"",onChange:oe,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("task:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:W||"",onChange:ve,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("pgc:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:U||"",onChange:Y,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]})}),a.jsx("div",{className:"mt-2",children:a.jsx(cg,{title:"Entry: Operator Answers",badge:"UI",children:a.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Renders:"}),a.jsx("span",{className:"font-mono",children:((at=A.operator_entry)==null?void 0:at.renders)||"question_set"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Captures:"}),a.jsx("span",{className:"font-mono",children:((Re=A.operator_entry)==null?void 0:Re.captures)||"pgc_answers"})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),a.jsx("div",{className:"mt-2",children:a.jsx(cg,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((X=A.clarification_merge)==null?void 0:X.internal_type)||"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),a.jsxs("select",{value:((Pe=A.clarification_merge)==null?void 0:Pe.internal_type)||"LLM",onChange:D=>j("internal_type",D.target.value),style:{...Le,fontSize:11},children:[a.jsx("option",{value:"LLM",children:"LLM"}),a.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((ge=A.clarification_merge)==null?void 0:ge.internal_type)||"LLM")==="LLM"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:Z||"",onChange:Q,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),r.map(D=>a.jsx("option",{value:D.template_id,children:D.name||D.template_id.replace(/_/g," ")},D.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:B||"",onChange:pe,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]}),((kt=A.clarification_merge)==null?void 0:kt.internal_type)==="MECH"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),a.jsxs("select",{value:pl((xt=A.clarification_merge)==null?void 0:xt.op_ref)||"",onChange:D=>{const H=D.target.value;if(!H){j("op_ref","");return}const K=d.find(re=>re.op_id===H);K&&j("op_ref",iS(K))},style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(D=>D.type==="merger").map(D=>a.jsx("option",{value:D.op_id,children:D.name},D.op_id))]})]}),((yt=A.clarification_merge)==null?void 0:yt.op_ref)&&(()=>{const D=pl(A.clarification_merge.op_ref),H=d.find(K=>K.op_id===D);return H?a.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:B||"",onChange:pe,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Internal Type"}),a.jsx("select",{value:u.internal_type||"LLM",onChange:D=>x("internal_type",D.target.value),style:Le,children:nS.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))}),a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Qt=nS.find(D=>D.value===(u.internal_type||"LLM")))==null?void 0:Qt.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Interaction Template"}),a.jsxs("select",{value:E||"",onChange:ne,style:Le,children:[a.jsx("option",{value:"",children:"-- Select Template --"}),r.map(D=>a.jsx("option",{value:D.template_id,children:D.name||D.template_id.replace(/_/g," ")},D.template_id))]}),u.task_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Mechanical Operation"}),a.jsxs("select",{value:pl(u.op_ref)||"",onChange:D=>{const H=D.target.value;if(!H){x("op_ref","");return}const K=d.find(re=>re.op_id===H);K&&x("op_ref",iS(K))},style:Le,children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(D=>{const H=d.filter(K=>K.type===D.type_id);return H.length===0?null:a.jsx("optgroup",{label:D.name,children:H.map(K=>a.jsx("option",{value:K.op_id,children:K.name},K.op_id))},D.type_id)})]}),u.op_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const D=pl(u.op_ref),H=d.find(re=>re.op_id===D),K=H?c.find(re=>re.type_id===H.type):null;return H?a.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(K==null?void 0:K.name)||H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Output Schema"}),a.jsxs("select",{value:fl(u.output_schema_ref)||"",onChange:D=>{const H=D.target.value;if(!H){x("output_schema_ref","");return}const K=i.find(re=>re.schema_id===H);K&&x("output_schema_ref",dl(K))},style:Le,children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"#3b82f6",color:"#fff"},children:"UI"}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:"Operator Entry"})]}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"This node presents a form to the operator and captures their input."})]}),a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Renders"}),a.jsx("input",{type:"text",value:u.renders||"",onChange:D=>x("renders",D.target.value),placeholder:"e.g., question_set",style:Le})]}),a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Captures"}),a.jsx("input",{type:"text",value:u.captures||"",onChange:D=>x("captures",D.target.value),placeholder:"e.g., user_answers",style:Le})]})]}),u.type==="qa"&&a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"QA Mode"}),a.jsx("select",{value:u.qa_mode||"semantic",onChange:D=>x("qa_mode",D.target.value),style:Le,children:WB.map(D=>a.jsx("option",{value:D,children:D},D))})]}),u.type==="end"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Terminal Outcome"}),a.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:D=>x("terminal_outcome",D.target.value),style:Le,children:UB.map(D=>a.jsx("option",{value:D,children:D},D))})]}),a.jsxs("div",{children:[a.jsx("label",{style:Rt,children:"Gate Outcome"}),a.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:D=>x("gate_outcome",D.target.value),placeholder:"e.g., complete, failed",style:Le})]})]}),a.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:D=>x("requires_qa",D.target.checked)}),"Requires QA"]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:D=>x("non_advancing",D.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("label",{style:Rt,children:"Includes"})}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:C||"",onChange:se,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("role:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:L||"",onChange:ce,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("task:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:P||"",onChange:J,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(D=>a.jsx("option",{value:D.schema_id,children:D.title||D.schema_id.replace(/_/g," ")},D.schema_id))]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:$||"",onChange:_e,style:{...Le,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(D=>{var K;const H=((K=D.fragment_id)==null?void 0:K.replace("pgc:",""))||D.id;return a.jsx("option",{value:H,children:D.name||(H==null?void 0:H.replace(/_/g," "))},D.fragment_id||D.id)})]})]}),O.length>0&&a.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),a.jsx("div",{className:"space-y-2",children:O.map(([D,H])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:D,onChange:K=>{const re={...u.includes};delete re[D],re[K.target.value]=H;const Oe={...u,includes:re};f(Oe),t(Oe)},style:{...Le,width:"35%",fontSize:10},placeholder:"KEY"}),a.jsx("input",{type:"text",value:H,onChange:K=>g(D,K.target.value),style:{...Le,flex:1,fontSize:10},placeholder:"path/to/file"}),a.jsx("button",{onClick:()=>w(D),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},D))})]}),a.jsx("button",{onClick:v,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const KB=["auto","user_choice"],YB=["eq","ne","lt","lte","gt","gte"],Zn={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},si={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function XB({edge:e,nodeIds:t,onChange:n,onDelete:r}){const[i,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(u,f)=>{const p={...i,[u]:f};s(p),n(p)},l=()=>{const u=[...i.conditions||[],{type:"retry_count",operator:"lt",value:2}];o("conditions",u)},c=(u,f,p)=>{const h=[...i.conditions||[]];h[u]={...h[u],[f]:p},o("conditions",h)},d=u=>{const f=(i.conditions||[]).filter((p,h)=>h!==u);o("conditions",f)};return i?a.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),a.jsx("button",{onClick:()=>r(i.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Edge ID"}),a.jsx("input",{type:"text",value:i.edge_id||"",onChange:u=>o("edge_id",u.target.value),style:Zn})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"From Node"}),a.jsx("select",{value:i.from_node_id||"",onChange:u=>o("from_node_id",u.target.value),style:Zn,children:t.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"To Node"}),a.jsxs("select",{value:i.to_node_id||"",onChange:u=>o("to_node_id",u.target.value||null),style:Zn,children:[a.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>a.jsx("option",{value:u,children:u},u))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Outcome"}),a.jsx("input",{type:"text",value:i.outcome||"",onChange:u=>o("outcome",u.target.value),placeholder:"success, failed, etc.",style:Zn})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Label"}),a.jsx("input",{type:"text",value:i.label||"",onChange:u=>o("label",u.target.value),placeholder:"Human-readable label",style:Zn})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Kind"}),a.jsx("select",{value:i.kind||"auto",onChange:u=>o("kind",u.target.value),style:Zn,children:KB.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:i.non_advancing||!1,onChange:u=>o("non_advancing",u.target.checked)}),"Non-advancing"]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:si,children:"Conditions"}),a.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),a.jsx("div",{className:"space-y-2",children:(i.conditions||[]).map((u,f)=>a.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Zn,flex:1,fontSize:10}}),a.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Zn,width:"auto",fontSize:10},children:YB.map(p=>a.jsx("option",{value:p,children:p},p))}),a.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Zn,width:50,fontSize:10}}),a.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const QB={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function ZB({workspaceId:e,artifactId:t,onArtifactSave:n,mechanicalOpTypes:r=[],mechanicalOps:i=[]}){var W,U,Z;const[s,o]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,x]=m.useState(null),{workflowJson:g,loading:w,error:v,saving:y,lastSaveResult:b,updateWorkflow:_}=UT(e,t,{onSave:B=>{n==null||n(t,B)}}),{templates:j}=$T(),{schemas:k}=BT(),{fragmentsByKind:N}=HT(),E=m.useMemo(()=>{var B;return!l||!g?null:((B=g.nodes)==null?void 0:B.find(ne=>ne.node_id===l))||null},[l,g]),S=m.useMemo(()=>{var B;return!d||!g?null:((B=g.edges)==null?void 0:B.find(ne=>ne.edge_id===d))||null},[d,g]),R=m.useMemo(()=>g!=null&&g.nodes?g.nodes.map(B=>B.node_id):[],[g]),T=m.useCallback(B=>{_(B)},[_]),M=m.useCallback(B=>{if(!g)return;const ne=g.nodes.map(J=>J.node_id===l?B:J);let se=g.edges,ce=g.entry_node_ids||[];B.node_id!==l&&(se=g.edges.map(J=>({...J,from_node_id:J.from_node_id===l?B.node_id:J.from_node_id,to_node_id:J.to_node_id===l?B.node_id:J.to_node_id})),ce=ce.map(J=>J===l?B.node_id:J),c(B.node_id)),_({...g,nodes:ne,edges:se,entry_node_ids:ce})},[g,l,_]),z=m.useCallback(B=>{if(!g)return;const ne=g.edges.map(se=>se.edge_id===d?B:se);B.edge_id!==d&&u(B.edge_id),_({...g,edges:ne})},[g,d,_]),C=m.useCallback(B=>{g&&(_({...g,nodes:g.nodes.filter(ne=>ne.node_id!==B),edges:g.edges.filter(ne=>ne.from_node_id!==B&&ne.to_node_id!==B),entry_node_ids:(g.entry_node_ids||[]).filter(ne=>ne!==B)}),c(null))},[g,_]),L=m.useCallback(B=>{g&&(_({...g,edges:g.edges.filter(ne=>ne.edge_id!==B)}),u(null))},[g,_]),P=m.useCallback(B=>{c(B),B&&u(null)},[]),$=m.useCallback(B=>{u(B),B&&c(null)},[]),O=m.useCallback(B=>{B==="json"&&g&&(p(JSON.stringify(g,null,2)),x(null)),o(B)},[g]),A=m.useCallback(B=>{const ne=B.target.value;p(ne);try{const se=JSON.parse(ne);x(null),_(se)}catch(se){x(se.message)}},[_]),F=((W=b==null?void 0:b.tier1_report)==null?void 0:W.results)||[],I=F.filter(B=>B.severity==="error").length,q=F.filter(B=>B.severity==="warning").length;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[y&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),v&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:v}),!y&&!v&&g&&a.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((U=g.nodes)==null?void 0:U.length)||0," nodes, ",((Z=g.edges)==null?void 0:Z.length)||0," edges"]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>a.jsx("button",{onClick:()=>O(B.id),style:{...QB,color:s===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:s===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),w?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s==="canvas"&&a.jsxs(a.Fragment,{children:[a.jsx(Jc,{children:a.jsx(BB,{workflowJson:g,onWorkflowChange:T,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:P,onEdgeSelect:$})}),E&&a.jsx(GB,{node:E,onChange:M,onDelete:C,templates:j,schemas:k,roleFragments:N.role||[],taskFragments:N.task||[],pgcFragments:N.pgc||[],mechanicalOpTypes:r,mechanicalOps:i}),S&&a.jsx(XB,{edge:S,nodeIds:R,onChange:z,onDelete:L})]}),s==="json"&&a.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[a.jsx("textarea",{value:f,onChange:A,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),s==="metadata"&&a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:g?a.jsx(JB,{workflow:g}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),F.length>0&&a.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[I>0&&a.jsxs("span",{style:{color:"#ef4444"},children:[I," error",I!==1?"s":""]}),q>0&&a.jsxs("span",{style:{color:"#f59e0b"},children:[q," warning",q!==1?"s":""]}),I===0&&q===0&&a.jsx("span",{style:{color:"#10b981"},children:"Valid"}),a.jsx("span",{style:{color:"var(--text-muted)"},children:F.map(B=>B.message).join(" | ")})]})]})}function JB({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},n={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},r=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],i=e.thread_ownership||{},s=Object.entries(i),o=e.entry_node_ids||[];return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),r.map(l=>a.jsxs("div",{children:[a.jsx("label",{style:n,children:l.label}),a.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),a.jsxs("div",{children:[a.jsx("label",{style:n,children:"Entry Node IDs"}),a.jsx("div",{style:t,children:o.length>0?o.join(", "):"-"})]}),s.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),s.map(([l,c])=>a.jsxs("div",{children:[a.jsx("label",{style:n,children:l}),a.jsx("div",{style:t,children:c})]},l))]})]})}function ug({label:e,items:t,selectedId:n,onSelect:r,isGroupActive:i}){const[s,o]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!s)return;const c=d=>{l.current&&!l.current.contains(d.target)&&o(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),t.length===0?null:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:i?"var(--text-primary)":"var(--text-muted)",background:i?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:i?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,a.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),s&&a.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>a.jsxs("button",{onClick:()=>{r(c.id),o(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:n===c.id?"var(--bg-selected)":"transparent",color:n===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&a.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function dg({label:e,isSelected:t,onClick:n}){return a.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function e9({workspaceId:e,docType:t,loading:n=!1,roles:r=[],workflows:i=[],onArtifactSave:s,onCreateDcwWorkflow:o,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var Be,at,Re;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,x]=m.useState("source"),[g,w]=m.useState(null),[v,y]=m.useState(!1),[b,_]=m.useState(null),[j,k]=m.useState(null),[N,E]=m.useState(!1),[S,R]=m.useState(null),[T,M]=m.useState(null),[z,C]=m.useState(!1),[L,P]=m.useState(null),[$,O]=m.useState(null),[A,F]=m.useState(!1),[I,q]=m.useState(null),W=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const X=t.role_prompt_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="role"?null:{roleId:X[2],version:X[3]}},[t==null?void 0:t.role_prompt_ref]),U=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const X=t.template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.template_ref]),Z=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const X=t.qa_template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const X=t.pgc_template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!W){w(null);return}y(!0),_(null),je.getRole(W.roleId,W.version).then(X=>{w(X.content)}).catch(X=>{console.error("Failed to load role:",X),_(X.message)}).finally(()=>{y(!1)})},[W]),m.useEffect(()=>{if(!U){k(null);return}E(!0),R(null),je.getTemplate(U.templateId,U.version).then(X=>{k(X.content)}).catch(X=>{console.error("Failed to load template:",X),R(X.message)}).finally(()=>{E(!1)})},[U]),m.useEffect(()=>{if(!Z){M(null);return}C(!0),P(null),je.getTemplate(Z.templateId,Z.version).then(X=>{M(X.content)}).catch(X=>{console.error("Failed to load QA template:",X),P(X.message)}).finally(()=>{C(!1)})},[Z]),m.useEffect(()=>{if(!B){O(null);return}F(!0),q(null),je.getTemplate(B.templateId,B.version).then(X=>{O(X.content)}).catch(X=>{console.error("Failed to load PGC template:",X),q(X.message)}).finally(()=>{F(!1)})},[B]);const ne=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const X=t.version||t.active_version;return`doctype:${t.doc_type_id}:${X}:${f}`},[t,f]),{content:se,loading:ce,error:J,saving:_e,isDirty:G,updateContent:xe,lastSaveResult:fe}=ka(e,ne,{onSave:X=>{s==null||s(ne,X)}}),oe=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],ve=m.useMemo(()=>t?oe.filter(X=>X.id==="package"?!0:X.id==="role_prompt"?!!t.role_prompt_ref:X.id==="template"?!!t.template_ref:X.id==="qa_template"?!!t.qa_template_ref:X.id==="pgc_template"?!!t.pgc_template_ref:X.id==="workflow"?!0:t.artifacts?t.artifacts[X.id]!=null:!1):[],[t]),Y=c==="task"||c==="schema";m.useEffect(()=>{Y||ve.length>0&&!ve.find(X=>X.id===f)&&p(ve[0].id)},[ve,f,Y]);const Q=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",pe=f==="package",he=f==="schema",we=f==="workflow",ye=!Q&&!pe&&!he&&!we,te=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:i.some(X=>X.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,i]),[me,Ge]=m.useState(!1),Fe=async()=>{if(!(!(t!=null&&t.doc_type_id)||!o)){Ge(!0);try{await o(t.doc_type_id)}finally{Ge(!1)}}};if(!t&&!n)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),a.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(n)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),a.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const $e=c==="task"?"Interaction":c==="schema"?"Schema":null,Te=!Y&&(f==="task_prompt"||f==="schema");return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),a.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:Y?$e:a.jsxs(a.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),Y&&a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!Y&&a.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[ve.find(X=>X.id==="package")&&a.jsx(dg,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),x("source")}}),ve.find(X=>X.id==="workflow")&&a.jsx(dg,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),x("source")}}),(()=>{const X=["role_prompt","task_prompt","template"],Pe=ve.filter(ge=>X.includes(ge.id)).map(ge=>({id:ge.id,label:ge.id==="role_prompt"?"Role":ge.id==="task_prompt"?"Task":"Template",viewOnly:ge.viewOnly}));return Pe.length===0?null:a.jsx(ug,{label:"Generation",items:Pe,selectedId:X.includes(f)?f:null,onSelect:ge=>{p(ge),x("source")},isGroupActive:X.includes(f)})})(),(()=>{const X=["qa_prompt","qa_template"],Pe=ve.filter(ge=>X.includes(ge.id)).map(ge=>({id:ge.id,label:ge.id==="qa_prompt"?"Prompt":"Template",viewOnly:ge.viewOnly}));return Pe.length===0?null:a.jsx(ug,{label:"QA",items:Pe,selectedId:X.includes(f)?f:null,onSelect:ge=>{p(ge),x("source")},isGroupActive:X.includes(f)})})(),(()=>{const X=["pgc_context","pgc_template"],Pe=ve.filter(ge=>X.includes(ge.id)).map(ge=>({id:ge.id,label:ge.id==="pgc_context"?"Context":"Template",viewOnly:ge.viewOnly}));return Pe.length===0?null:a.jsx(ug,{label:"PGC",items:Pe,selectedId:X.includes(f)?f:null,onSelect:ge=>{p(ge),x("source")},isGroupActive:X.includes(f)})})(),ve.find(X=>X.id==="schema")&&a.jsx(dg,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),x("source")}})]}),!Y&&ye&&!Te&&a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>x("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),a.jsx("button",{onClick:()=>x("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((Be=t==null?void 0:t.artifacts)==null?void 0:Be[f])&&a.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),Q&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&W&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[W.roleId.replace(/_/g," ")," v",W.version]}),f==="template"&&U&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[U.templateId.replace(/_/g," ")," v",U.version]}),f==="qa_template"&&Z&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[Z.templateId.replace(/_/g," ")," v",Z.version]}),f==="pgc_template"&&B&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Te&&a.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),he&&((at=t==null?void 0:t.artifacts)==null?void 0:at.schema)&&a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:we?te?a.jsx(ZB,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s,mechanicalOpTypes:d,mechanicalOps:u}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 max-w-md",children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),a.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),o&&a.jsx("button",{onClick:Fe,disabled:me,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:me?"wait":"pointer",opacity:me?.7:1},children:me?"Creating...":"Create Workflow"})]})}):f==="package"?a.jsx(IB,{workspaceId:e,docType:t,roles:r,onSave:s}):f==="role_prompt"?a.jsx(tr,{content:g||"",onChange:()=>{},loading:v,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?a.jsx(tr,{content:j||"",onChange:()=>{},loading:N,saving:!1,isDirty:!1,error:S,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?a.jsx(tr,{content:T||"",onChange:()=>{},loading:z,saving:!1,isDirty:!1,error:L,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?a.jsx(tr,{content:$||"",onChange:()=>{},loading:A,saving:!1,isDirty:!1,error:I,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||he?a.jsx(tr,{content:se,onChange:Te?()=>{}:xe,loading:ce,saving:Te?!1:_e,isDirty:Te?!1:G,error:J,readOnly:Te,placeholder:`Enter ${((Re=ve.find(X=>X.id===f))==null?void 0:Re.label)||"prompt"} content...`,isJson:he}):a.jsx(AB,{workspaceId:e,artifactId:ne})}),ye&&(fe==null?void 0:fe.tier1)&&!fe.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function t9({workspaceId:e,role:t,onArtifactSave:n}){const r=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:i,loading:s,error:o,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=ka(e,r,{onSave:p=>{n==null||n(r,p)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),a.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),a.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:i,onChange:d,loading:s,saving:l,isDirty:c,error:o,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function VT(e){return typeof e>"u"||e===null}function n9(e){return typeof e=="object"&&e!==null}function r9(e){return Array.isArray(e)?e:VT(e)?[]:[e]}function i9(e,t){var n,r,i,s;if(t)for(s=Object.keys(t),n=0,r=s.length;n<r;n+=1)i=s[n],e[i]=t[i];return e}function s9(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function o9(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var a9=VT,l9=n9,c9=r9,u9=s9,d9=o9,f9=i9,dt={isNothing:a9,isObject:l9,toArray:c9,repeat:u9,isNegativeZero:d9,extend:f9};function GT(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function sa(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=GT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}sa.prototype=Object.create(Error.prototype);sa.prototype.constructor=sa;sa.prototype.toString=function(t){return this.name+": "+GT(this,t)};var Dt=sa;function fg(e,t,n,r,i){var s="",o="",l=Math.floor(i/2)-1;return r-t>l&&(s=" ... ",t=r-l+s.length),n-r>l&&(o=" ...",n=r+l-o.length),{str:s+e.slice(t,n).replace(/\t/g,"")+o,pos:r-t+s.length}}function pg(e,t){return dt.repeat(" ",t-e.length)+e}function p9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],i=[],s,o=-1;s=n.exec(e.buffer);)i.push(s.index),r.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)d=fg(e.buffer,r[o-c],i[o-c],e.position-(r[o]-r[o-c]),f),l=dt.repeat(" ",t.indent)+pg((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=fg(e.buffer,r[o],i[o],e.position,f),l+=dt.repeat(" ",t.indent)+pg((e.line+1).toString(),u)+" | "+d.str+`
`,l+=dt.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)d=fg(e.buffer,r[o+c],i[o+c],e.position-(r[o]-r[o+c]),f),l+=dt.repeat(" ",t.indent)+pg((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var h9=p9,m9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],g9=["scalar","sequence","mapping"];function v9(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function x9(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(m9.indexOf(n)===-1)throw new Dt('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=v9(t.styleAliases||null),g9.indexOf(this.kind)===-1)throw new Dt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var jt=x9;function sS(e,t){var n=[];return e[t].forEach(function(r){var i=n.length;n.forEach(function(s,o){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(i=o)}),n[i]=r}),n}function y9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function Pv(e){return this.extend(e)}Pv.prototype.extend=function(t){var n=[],r=[];if(t instanceof jt)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new Dt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(s){if(!(s instanceof jt))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new Dt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Dt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(s){if(!(s instanceof jt))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Pv.prototype);return i.implicit=(this.implicit||[]).concat(n),i.explicit=(this.explicit||[]).concat(r),i.compiledImplicit=sS(i,"implicit"),i.compiledExplicit=sS(i,"explicit"),i.compiledTypeMap=y9(i.compiledImplicit,i.compiledExplicit),i};var KT=Pv,YT=new jt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),XT=new jt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),QT=new jt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),ZT=new KT({explicit:[YT,XT,QT]});function b9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function w9(){return null}function _9(e){return e===null}var JT=new jt("tag:yaml.org,2002:null",{kind:"scalar",resolve:b9,construct:w9,predicate:_9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function j9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function S9(e){return e==="true"||e==="True"||e==="TRUE"}function k9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var e4=new jt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:j9,construct:S9,predicate:k9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function N9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function C9(e){return 48<=e&&e<=55}function E9(e){return 48<=e&&e<=57}function T9(e){if(e===null)return!1;var t=e.length,n=0,r=!1,i;if(!t)return!1;if(i=e[n],(i==="-"||i==="+")&&(i=e[++n]),i==="0"){if(n+1===t)return!0;if(i=e[++n],i==="b"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!N9(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}if(i==="o"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!C9(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}}if(i==="_")return!1;for(;n<t;n++)if(i=e[n],i!=="_"){if(!E9(e.charCodeAt(n)))return!1;r=!0}return!(!r||i==="_")}function R9(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function A9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!dt.isNegativeZero(e)}var t4=new jt("tag:yaml.org,2002:int",{kind:"scalar",resolve:T9,construct:R9,predicate:A9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),I9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function M9(e){return!(e===null||!I9.test(e)||e[e.length-1]==="_")}function P9(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var O9=/^[-+]?[0-9]+e/;function D9(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(dt.isNegativeZero(e))return"-0.0";return n=e.toString(10),O9.test(n)?n.replace("e",".e"):n}function L9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||dt.isNegativeZero(e))}var n4=new jt("tag:yaml.org,2002:float",{kind:"scalar",resolve:M9,construct:P9,predicate:L9,represent:D9,defaultStyle:"lowercase"}),r4=ZT.extend({implicit:[JT,e4,t4,n4]}),i4=r4,s4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),o4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function F9(e){return e===null?!1:s4.exec(e)!==null||o4.exec(e)!==null}function z9(e){var t,n,r,i,s,o,l,c=0,d=null,u,f,p;if(t=s4.exec(e),t===null&&(t=o4.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(s=+t[4],o=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(n,r,i,s,o,l,c)),d&&p.setTime(p.getTime()-d),p}function q9(e){return e.toISOString()}var a4=new jt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:F9,construct:z9,instanceOf:Date,represent:q9});function $9(e){return e==="<<"||e===null}var l4=new jt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:$9}),_y=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function B9(e){if(e===null)return!1;var t,n,r=0,i=e.length,s=_y;for(n=0;n<i;n++)if(t=s.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function H9(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,s=_y,o=0,l=[];for(t=0;t<i;t++)t%4===0&&t&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|s.indexOf(r.charAt(t));return n=i%4*6,n===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):n===18?(l.push(o>>10&255),l.push(o>>2&255)):n===12&&l.push(o>>4&255),new Uint8Array(l)}function W9(e){var t="",n=0,r,i,s=e.length,o=_y;for(r=0;r<s;r++)r%3===0&&r&&(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]),n=(n<<8)+e[r];return i=s%3,i===0?(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]):i===2?(t+=o[n>>10&63],t+=o[n>>4&63],t+=o[n<<2&63],t+=o[64]):i===1&&(t+=o[n>>2&63],t+=o[n<<4&63],t+=o[64],t+=o[64]),t}function U9(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var c4=new jt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:B9,construct:H9,predicate:U9,represent:W9}),V9=Object.prototype.hasOwnProperty,G9=Object.prototype.toString;function K9(e){if(e===null)return!0;var t=[],n,r,i,s,o,l=e;for(n=0,r=l.length;n<r;n+=1){if(i=l[n],o=!1,G9.call(i)!=="[object Object]")return!1;for(s in i)if(V9.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function Y9(e){return e!==null?e:[]}var u4=new jt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:K9,construct:Y9}),X9=Object.prototype.toString;function Q9(e){if(e===null)return!0;var t,n,r,i,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1){if(r=o[t],X9.call(r)!=="[object Object]"||(i=Object.keys(r),i.length!==1))return!1;s[t]=[i[0],r[i[0]]]}return!0}function Z9(e){if(e===null)return[];var t,n,r,i,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1)r=o[t],i=Object.keys(r),s[t]=[i[0],r[i[0]]];return s}var d4=new jt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Q9,construct:Z9}),J9=Object.prototype.hasOwnProperty;function eH(e){if(e===null)return!0;var t,n=e;for(t in n)if(J9.call(n,t)&&n[t]!==null)return!1;return!0}function tH(e){return e!==null?e:{}}var f4=new jt("tag:yaml.org,2002:set",{kind:"mapping",resolve:eH,construct:tH}),jy=i4.extend({implicit:[a4,l4],explicit:[c4,u4,d4,f4]}),Xr=Object.prototype.hasOwnProperty,xc=1,p4=2,h4=3,yc=4,hg=1,nH=2,oS=3,rH=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,iH=/[\x85\u2028\u2029]/,sH=/[,\[\]\{\}]/,m4=/^(?:!|!!|![a-z\-]+!)$/i,g4=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function aS(e){return Object.prototype.toString.call(e)}function Un(e){return e===10||e===13}function yi(e){return e===9||e===32}function Wt(e){return e===9||e===32||e===10||e===13}function rs(e){return e===44||e===91||e===93||e===123||e===125}function oH(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function aH(e){return e===120?2:e===117?4:e===85?8:0}function lH(e){return 48<=e&&e<=57?e-48:-1}function lS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function cH(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function v4(e,t,n){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}var x4=new Array(256),y4=new Array(256);for(var $i=0;$i<256;$i++)x4[$i]=lS($i)?1:0,y4[$i]=lS($i);function uH(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||jy,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function b4(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=h9(n),new Dt(t,n)}function de(e,t){throw b4(e,t)}function bc(e,t){e.onWarning&&e.onWarning.call(null,b4(e,t))}var cS={YAML:function(t,n,r){var i,s,o;t.version!==null&&de(t,"duplication of %YAML directive"),r.length!==1&&de(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),i===null&&de(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&de(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&bc(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var i,s;r.length!==2&&de(t,"TAG directive accepts exactly two arguments"),i=r[0],s=r[1],m4.test(i)||de(t,"ill-formed tag handle (first argument) of the TAG directive"),Xr.call(t.tagMap,i)&&de(t,'there is a previously declared suffix for "'+i+'" tag handle'),g4.test(s)||de(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{de(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function Vr(e,t,n,r){var i,s,o,l;if(t<n){if(l=e.input.slice(t,n),r)for(i=0,s=l.length;i<s;i+=1)o=l.charCodeAt(i),o===9||32<=o&&o<=1114111||de(e,"expected valid JSON character");else rH.test(l)&&de(e,"the stream contains non-printable characters");e.result+=l}}function uS(e,t,n,r){var i,s,o,l;for(dt.isObject(n)||de(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(n),o=0,l=i.length;o<l;o+=1)s=i[o],Xr.call(t,s)||(v4(t,s,n[s]),r[s]=!0)}function is(e,t,n,r,i,s,o,l,c){var d,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),d=0,u=i.length;d<u;d+=1)Array.isArray(i[d])&&de(e,"nested arrays are not supported inside keys"),typeof i=="object"&&aS(i[d])==="[object Object]"&&(i[d]="[object Object]");if(typeof i=="object"&&aS(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(d=0,u=s.length;d<u;d+=1)uS(e,t,s[d],n);else uS(e,t,s,n);else!e.json&&!Xr.call(n,i)&&Xr.call(t,i)&&(e.line=o||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,de(e,"duplicated mapping key")),v4(t,i,s),delete n[i];return t}function Sy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):de(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function st(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);i!==0;){for(;yi(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Un(i))for(Sy(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&bc(e,"deficient indentation"),r}function yu(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||Wt(n)))}function ky(e,t){t===1?e.result+=" ":t>1&&(e.result+=dt.repeat(`
`,t-1))}function dH(e,t,n){var r,i,s,o,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Wt(h)||rs(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(i=e.input.charCodeAt(e.position+1),Wt(i)||n&&rs(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,l=!1;h!==0;){if(h===58){if(i=e.input.charCodeAt(e.position+1),Wt(i)||n&&rs(i))break}else if(h===35){if(r=e.input.charCodeAt(e.position-1),Wt(r))break}else{if(e.position===e.lineStart&&yu(e)||n&&rs(h))break;if(Un(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,st(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Vr(e,s,o,!1),ky(e,e.line-c),s=o=e.position,l=!1),yi(h)||(o=e.position+1),h=e.input.charCodeAt(++e.position)}return Vr(e,s,o,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function fH(e,t){var n,r,i;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Vr(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,i=e.position;else return!0;else Un(n)?(Vr(e,r,i,!0),ky(e,st(e,!1,t)),r=i=e.position):e.position===e.lineStart&&yu(e)?de(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);de(e,"unexpected end of the stream within a single quoted scalar")}function pH(e,t){var n,r,i,s,o,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Vr(e,n,e.position,!0),e.position++,!0;if(l===92){if(Vr(e,n,e.position,!0),l=e.input.charCodeAt(++e.position),Un(l))st(e,!1,t);else if(l<256&&x4[l])e.result+=y4[l],e.position++;else if((o=aH(l))>0){for(i=o,s=0;i>0;i--)l=e.input.charCodeAt(++e.position),(o=oH(l))>=0?s=(s<<4)+o:de(e,"expected hexadecimal character");e.result+=cH(s),e.position++}else de(e,"unknown escape sequence");n=r=e.position}else Un(l)?(Vr(e,n,r,!0),ky(e,st(e,!1,t)),n=r=e.position):e.position===e.lineStart&&yu(e)?de(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}de(e,"unexpected end of the stream within a double quoted scalar")}function hH(e,t){var n=!0,r,i,s,o=e.tag,l,c=e.anchor,d,u,f,p,h,x=Object.create(null),g,w,v,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(st(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=o,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;n?y===44&&de(e,"expected the node content, but found ','"):de(e,"missed comma between flow collection entries"),w=g=v=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Wt(d)&&(f=p=!0,e.position++,st(e,!0,t))),r=e.line,i=e.lineStart,s=e.position,Ns(e,t,xc,!1,!0),w=e.tag,g=e.result,st(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===r)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),st(e,!0,t),Ns(e,t,xc,!1,!0),v=e.result),h?is(e,l,x,w,g,v,r,i,s):f?l.push(is(e,null,x,w,g,v,r,i,s)):l.push(g),st(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(n=!0,y=e.input.charCodeAt(++e.position)):n=!1}de(e,"unexpected end of the stream within a flow collection")}function mH(e,t){var n,r,i=hg,s=!1,o=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)r=!1;else if(f===62)r=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)hg===i?i=f===43?oS:nH:de(e,"repeat of a chomping mode identifier");else if((u=lH(f))>=0)u===0?de(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?de(e,"repeat of an indentation width identifier"):(l=t+u-1,o=!0);else break;if(yi(f)){do f=e.input.charCodeAt(++e.position);while(yi(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Un(f)&&f!==0)}for(;f!==0;){for(Sy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>l&&(l=e.lineIndent),Un(f)){c++;continue}if(e.lineIndent<l){i===oS?e.result+=dt.repeat(`
`,s?1+c:c):i===hg&&s&&(e.result+=`
`);break}for(r?yi(f)?(d=!0,e.result+=dt.repeat(`
`,s?1+c:c)):d?(d=!1,e.result+=dt.repeat(`
`,c+1)):c===0?s&&(e.result+=" "):e.result+=dt.repeat(`
`,c):e.result+=dt.repeat(`
`,s?1+c:c),s=!0,o=!0,c=0,n=e.position;!Un(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Vr(e,n,e.position,!1)}return!0}function dS(e,t){var n,r=e.tag,i=e.anchor,s=[],o,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,de(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!Wt(o))));){if(l=!0,e.position++,st(e,!0,-1)&&e.lineIndent<=t){s.push(null),c=e.input.charCodeAt(e.position);continue}if(n=e.line,Ns(e,t,h4,!1,!0),s.push(e.result),st(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&c!==0)de(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=r,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function gH(e,t,n){var r,i,s,o,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,x=null,g=null,w=!1,v=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!w&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,de(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,(y===63||y===58)&&Wt(r))y===63?(w&&(is(e,f,p,h,x,null,o,l,c),h=x=g=null),v=!0,w=!0,i=!0):w?(w=!1,i=!0):de(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=r;else{if(o=e.line,l=e.lineStart,c=e.position,!Ns(e,n,p4,!1,!0))break;if(e.line===s){for(y=e.input.charCodeAt(e.position);yi(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Wt(y)||de(e,"a whitespace character is expected after the key-value separator within a block mapping"),w&&(is(e,f,p,h,x,null,o,l,c),h=x=g=null),v=!0,w=!1,i=!1,h=e.tag,x=e.result;else if(v)de(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(v)de(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===s||e.lineIndent>t)&&(w&&(o=e.line,l=e.lineStart,c=e.position),Ns(e,t,yc,!0,i)&&(w?x=e.result:g=e.result),w||(is(e,f,p,h,x,g,o,l,c),h=x=g=null),st(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&y!==0)de(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return w&&is(e,f,p,h,x,null,o,l,c),v&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),v}function vH(e){var t,n=!1,r=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&de(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(n=!0,o=e.input.charCodeAt(++e.position)):o===33?(r=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,n){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):de(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Wt(o);)o===33&&(r?de(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),m4.test(i)||de(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),sH.test(s)&&de(e,"tag suffix cannot contain flow indicator characters")}s&&!g4.test(s)&&de(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{de(e,"tag name is malformed: "+s)}return n?e.tag=s:Xr.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:de(e,'undeclared tag handle "'+i+'"'),!0}function xH(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&de(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Wt(n)&&!rs(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&de(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function yH(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Wt(r)&&!rs(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&de(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Xr.call(e.anchorMap,n)||de(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],st(e,!0,-1),!0}function Ns(e,t,n,r,i){var s,o,l,c=1,d=!1,u=!1,f,p,h,x,g,w;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=l=yc===n||h4===n,r&&st(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;vH(e)||xH(e);)st(e,!0,-1)?(d=!0,l=s,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||i),(c===1||yc===n)&&(xc===n||p4===n?g=t:g=t+1,w=e.position-e.lineStart,c===1?l&&(dS(e,w)||gH(e,w,g))||hH(e,g)?u=!0:(o&&mH(e,g)||fH(e,g)||pH(e,g)?u=!0:yH(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&de(e,"alias node should not have any properties")):dH(e,g,xc===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&dS(e,w))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&de(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(x=e.implicitTypes[f],x.resolve(e.result)){e.result=x.construct(e.result),e.tag=x.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xr.call(e.typeMap[e.kind||"fallback"],e.tag))x=e.typeMap[e.kind||"fallback"][e.tag];else for(x=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){x=h[f];break}x||de(e,"unknown tag !<"+e.tag+">"),e.result!==null&&x.kind!==e.kind&&de(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+x.kind+'", not "'+e.kind+'"'),x.resolve(e.result,e.tag)?(e.result=x.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):de(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function bH(e){var t=e.position,n,r,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(st(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),n=e.position;o!==0&&!Wt(o);)o=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),i=[],r.length<1&&de(e,"directive name must not be less than one character in length");o!==0;){for(;yi(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Un(o));break}if(Un(o))break;for(n=e.position;o!==0&&!Wt(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(n,e.position))}o!==0&&Sy(e),Xr.call(cS,r)?cS[r](e,r,i):bc(e,'unknown document directive "'+r+'"')}if(st(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,st(e,!0,-1)):s&&de(e,"directives end mark is expected"),Ns(e,e.lineIndent-1,yc,!1,!0),st(e,!0,-1),e.checkLineBreaks&&iH.test(e.input.slice(t,e.position))&&bc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&yu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,st(e,!0,-1));return}if(e.position<e.length-1)de(e,"end of the stream or a document separator is expected");else return}function w4(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new uH(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,de(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)bH(n);return n.documents}function wH(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=w4(e,n);if(typeof t!="function")return r;for(var i=0,s=r.length;i<s;i+=1)t(r[i])}function _H(e,t){var n=w4(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new Dt("expected a single document in the stream, but found more")}}var jH=wH,SH=_H,_4={loadAll:jH,load:SH},j4=Object.prototype.toString,S4=Object.prototype.hasOwnProperty,Ny=65279,kH=9,oa=10,NH=13,CH=32,EH=33,TH=34,Ov=35,RH=37,AH=38,IH=39,MH=42,k4=44,PH=45,wc=58,OH=61,DH=62,LH=63,FH=64,N4=91,C4=93,zH=96,E4=123,qH=124,T4=125,Pt={};Pt[0]="\\0";Pt[7]="\\a";Pt[8]="\\b";Pt[9]="\\t";Pt[10]="\\n";Pt[11]="\\v";Pt[12]="\\f";Pt[13]="\\r";Pt[27]="\\e";Pt[34]='\\"';Pt[92]="\\\\";Pt[133]="\\N";Pt[160]="\\_";Pt[8232]="\\L";Pt[8233]="\\P";var $H=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],BH=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function HH(e,t){var n,r,i,s,o,l,c;if(t===null)return{};for(n={},r=Object.keys(t),i=0,s=r.length;i<s;i+=1)o=r[i],l=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&S4.call(c.styleAliases,l)&&(l=c.styleAliases[l]),n[o]=l;return n}function WH(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new Dt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+dt.repeat("0",r-t.length)+t}var UH=1,aa=2;function VH(e){this.schema=e.schema||jy,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=dt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=HH(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?aa:UH,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function fS(e,t){for(var n=dt.repeat(" ",t),r=0,i=-1,s="",o,l=e.length;r<l;)i=e.indexOf(`
`,r),i===-1?(o=e.slice(r),r=l):(o=e.slice(r,i+1),r=i+1),o.length&&o!==`
`&&(s+=n),s+=o;return s}function Dv(e,t){return`
`+dt.repeat(" ",e.indent*t)}function GH(e,t){var n,r,i;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(i=e.implicitTypes[n],i.resolve(t))return!0;return!1}function _c(e){return e===CH||e===kH}function la(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Ny||65536<=e&&e<=1114111}function pS(e){return la(e)&&e!==Ny&&e!==NH&&e!==oa}function hS(e,t,n){var r=pS(e),i=r&&!_c(e);return(n?r:r&&e!==k4&&e!==N4&&e!==C4&&e!==E4&&e!==T4)&&e!==Ov&&!(t===wc&&!i)||pS(t)&&!_c(t)&&e===Ov||t===wc&&i}function KH(e){return la(e)&&e!==Ny&&!_c(e)&&e!==PH&&e!==LH&&e!==wc&&e!==k4&&e!==N4&&e!==C4&&e!==E4&&e!==T4&&e!==Ov&&e!==AH&&e!==MH&&e!==EH&&e!==qH&&e!==OH&&e!==DH&&e!==IH&&e!==TH&&e!==RH&&e!==FH&&e!==zH}function YH(e){return!_c(e)&&e!==wc}function bo(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function R4(e){var t=/^\n* /;return t.test(e)}var A4=1,Lv=2,I4=3,M4=4,Bi=5;function XH(e,t,n,r,i,s,o,l){var c,d=0,u=null,f=!1,p=!1,h=r!==-1,x=-1,g=KH(bo(e,0))&&YH(bo(e,e.length-1));if(t||o)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=bo(e,c),!la(d))return Bi;g=g&&hS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=bo(e,c),d===oa)f=!0,h&&(p=p||c-x-1>r&&e[x+1]!==" ",x=c);else if(!la(d))return Bi;g=g&&hS(d,u,l),u=d}p=p||h&&c-x-1>r&&e[x+1]!==" "}return!f&&!p?g&&!o&&!i(e)?A4:s===aa?Bi:Lv:n>9&&R4(e)?Bi:o?s===aa?Bi:Lv:p?M4:I4}function QH(e,t,n,r,i){e.dump=function(){if(t.length===0)return e.quotingType===aa?'""':"''";if(!e.noCompatMode&&($H.indexOf(t)!==-1||BH.test(t)))return e.quotingType===aa?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,n),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),l=r||e.flowLevel>-1&&n>=e.flowLevel;function c(d){return GH(e,d)}switch(XH(t,l,e.indent,o,c,e.quotingType,e.forceQuotes&&!r,i)){case A4:return t;case Lv:return"'"+t.replace(/'/g,"''")+"'";case I4:return"|"+mS(t,e.indent)+gS(fS(t,s));case M4:return">"+mS(t,e.indent)+gS(fS(ZH(t,o),s));case Bi:return'"'+JH(t)+'"';default:throw new Dt("impossible error: invalid scalar style")}}()}function mS(e,t){var n=R4(e)?String(t):"",r=e[e.length-1]===`
`,i=r&&(e[e.length-2]===`
`||e===`
`),s=i?"+":r?"":"-";return n+s+`
`}function gS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function ZH(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,n.lastIndex=d,vS(e.slice(0,d),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=n.exec(e);){var l=o[1],c=o[2];s=c[0]===" ",r+=l+(!i&&!s&&c!==""?`
`:"")+vS(c,t),i=s}return r}function vS(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,i=0,s,o=0,l=0,c="";r=n.exec(e);)l=r.index,l-i>t&&(s=o>i?o:l,c+=`
`+e.slice(i,s),i=s+1),o=l;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function JH(e){for(var t="",n=0,r,i=0;i<e.length;n>=65536?i+=2:i++)n=bo(e,i),r=Pt[n],!r&&la(n)?(t+=e[i],n>=65536&&(t+=e[i+1])):t+=r||WH(n);return t}function e7(e,t,n){var r="",i=e.tag,s,o,l;for(s=0,o=n.length;s<o;s+=1)l=n[s],e.replacer&&(l=e.replacer.call(n,String(s),l)),(gr(e,t,l,!1,!1)||typeof l>"u"&&gr(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=i,e.dump="["+r+"]"}function xS(e,t,n,r){var i="",s=e.tag,o,l,c;for(o=0,l=n.length;o<l;o+=1)c=n[o],e.replacer&&(c=e.replacer.call(n,String(o),c)),(gr(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&gr(e,t+1,null,!0,!0,!1,!0))&&((!r||i!=="")&&(i+=Dv(e,t)),e.dump&&oa===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function t7(e,t,n){var r="",i=e.tag,s=Object.keys(n),o,l,c,d,u;for(o=0,l=s.length;o<l;o+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=s[o],d=n[c],e.replacer&&(d=e.replacer.call(n,c,d)),gr(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),gr(e,t,d,!1,!1)&&(u+=e.dump,r+=u));e.tag=i,e.dump="{"+r+"}"}function n7(e,t,n,r){var i="",s=e.tag,o=Object.keys(n),l,c,d,u,f,p;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new Dt("sortKeys must be a boolean or a function");for(l=0,c=o.length;l<c;l+=1)p="",(!r||i!=="")&&(p+=Dv(e,t)),d=o[l],u=n[d],e.replacer&&(u=e.replacer.call(n,d,u)),gr(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&oa===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Dv(e,t)),gr(e,t+1,u,!0,f)&&(e.dump&&oa===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,i+=p));e.tag=s,e.dump=i||"{}"}function yS(e,t,n){var r,i,s,o,l,c;for(i=n?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(l=i[s],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(n?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,j4.call(l.represent)==="[object Function]")r=l.represent(t,c);else if(S4.call(l.represent,c))r=l.represent[c](t,c);else throw new Dt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=r}return!0}return!1}function gr(e,t,n,r,i,s,o){e.tag=null,e.dump=n,yS(e,n,!1)||yS(e,n,!0);var l=j4.call(e.dump),c=r,d;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(n),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(i=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")r&&Object.keys(e.dump).length!==0?(n7(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(t7(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?xS(e,t-1,e.dump,i):xS(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(e7(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&QH(e,e.dump,t,s,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Dt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function r7(e,t){var n=[],r=[],i,s;for(Fv(e,n,r),i=0,s=r.length;i<s;i+=1)t.duplicates.push(n[r[i]]);t.usedDuplicates=new Array(s)}function Fv(e,t,n){var r,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)n.indexOf(i)===-1&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Fv(e[i],t,n);else for(r=Object.keys(e),i=0,s=r.length;i<s;i+=1)Fv(e[r[i]],t,n)}function i7(e,t){t=t||{};var n=new VH(t);n.noRefs||r7(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),gr(n,0,r,!0,!0)?n.dump+`
`:""}var s7=i7,o7={dump:s7};function Cy(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var a7=jt,l7=KT,c7=ZT,u7=r4,d7=i4,f7=jy,p7=_4.load,h7=_4.loadAll,m7=o7.dump,g7=Dt,v7={binary:c4,float:n4,map:QT,null:JT,pairs:d4,set:f4,timestamp:a4,bool:e4,int:t4,merge:l4,omap:u4,seq:XT,str:YT},x7=Cy("safeLoad","load"),y7=Cy("safeLoadAll","loadAll"),b7=Cy("safeDump","dump"),P4={Type:a7,Schema:l7,FAILSAFE_SCHEMA:c7,JSON_SCHEMA:u7,CORE_SCHEMA:d7,DEFAULT_SCHEMA:f7,load:p7,loadAll:h7,dump:m7,YAMLException:g7,types:v7,safeLoad:x7,safeLoadAll:y7,safeDump:b7};const w7=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],mg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},gg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function _7({workspaceId:e,template:t,onArtifactSave:n}){const[r,i]=m.useState("metadata"),[s,o]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:x,error:g,saving:w,isDirty:v,updateContent:y,lastSaveResult:b}=ka(e,f,{onSave:S=>{n==null||n(f,S)}});m.useEffect(()=>{t&&(o({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const _=m.useCallback((S,R)=>{o(T=>({...T,[S]:R})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const S=P4.dump({name:s.name||null,purpose:s.purpose||null,use_case:s.use_case||null},{lineWidth:-1});await je.writeArtifact(e,p,S),c(!1),n==null||n(p,{success:!0})}catch(S){console.error("Failed to save metadata:",S),alert(`Failed to save metadata: ${S.message}`)}finally{u(!1)}}},[e,p,s,n]),k=m.useCallback(()=>{l&&j()},[l,j]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),a.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const N=s.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase()),E=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:N}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.active_version]}),a.jsx("span",{children:""}),a.jsx("span",{children:"Shared Template"}),s.purpose&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:s.purpose})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:E.map(S=>a.jsxs("button",{onClick:()=>i(S.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===S.id?"var(--text-primary)":"var(--text-muted)",background:r===S.id?"var(--bg-canvas)":"transparent",borderBottom:r===S.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[S.label,S.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),S.id==="template"&&v&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},S.id))}),r==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:gg,children:"Template Name"}),a.jsx("input",{type:"text",value:s.name,onChange:S=>_("name",S.target.value),onBlur:k,placeholder:"e.g., Document Generator",style:mg}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),a.jsxs("div",{children:[a.jsx("label",{style:gg,children:"Template Purpose"}),a.jsx("select",{value:s.purpose,onChange:S=>{_("purpose",S.target.value),setTimeout(()=>j(),0)},style:mg,children:w7.map(S=>a.jsx("option",{value:S.value,children:S.label},S.value))}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),a.jsxs("div",{children:[a.jsx("label",{style:gg,children:"Use Case"}),a.jsx("textarea",{value:s.use_case,onChange:S=>_("use_case",S.target.value),onBlur:k,placeholder:"Describe when and how this template should be used...",rows:4,style:{...mg,resize:"vertical"}}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),r==="template"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:h,onChange:y,loading:x,saving:w,isDirty:v,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ro={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function j7({workspaceId:e,schema:t,onArtifactSave:n}){var v;const[r,i]=m.useState("content"),s=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:o,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=ka(e,s,{onSave:y=>{n==null||n(s,y)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),a.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((v=t.schema_id)==null?void 0:v.replace(/_/g," "))||"Schema",x=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],w=!e;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",x]}),w&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(y=>a.jsxs("button",{onClick:()=>i(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===y.id?"var(--text-primary)":"var(--text-muted)",background:r===y.id?"var(--bg-canvas)":"transparent",borderBottom:r===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),r==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:o,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:w,isJson:!0})}),r==="info"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Schema ID"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Version"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Title (from JSON)"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),a.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"File Path"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",x,"/schema.json"]})]}),a.jsxs("div",{children:[a.jsx("label",{style:ro,children:"Artifact ID"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",x]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const S7={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},k7={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},vg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function N7({workspaceId:e,fragment:t,onArtifactSave:n}){var F;const[r,i]=m.useState("content"),[s,o]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,x]=((F=t==null?void 0:t.fragment_id)==null?void 0:F.split(":"))||[null,null],g=t?h==="role"?`fragment:role:${x}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,w=t&&h==="role"?`fragment:role:${x}:${t.version}:meta`:null,{content:v,loading:y,error:b,saving:_,isDirty:j,updateContent:k,lastSaveResult:N}=ka(e,g,{onSave:I=>{n==null||n(g,I)}});m.useEffect(()=>{t&&(o({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const E=m.useCallback((I,q)=>{o(W=>({...W,[I]:q})),c(!0)},[]),S=m.useCallback(async()=>{if(!(!e||!w)){u(!0);try{const I=P4.dump({name:s.name||null,intent:s.intent||null,tags:s.tags.length>0?s.tags:null},{lineWidth:-1});await je.writeArtifact(e,w,I),c(!1),n==null||n(w,{success:!0})}catch(I){console.error("Failed to save metadata:",I),alert(`Failed to save metadata: ${I.message}`)}finally{u(!1)}}},[e,w,s,n]),R=m.useCallback(()=>{l&&w&&S()},[l,w,S]),T=m.useCallback(()=>{const I=f.trim().toLowerCase();I&&!s.tags.includes(I)&&(E("tags",[...s.tags,I]),p(""))},[f,s.tags,E]),M=m.useCallback(I=>{E("tags",s.tags.filter(q=>q!==I))},[s.tags,E]),z=m.useCallback(I=>{I.key==="Enter"&&(I.preventDefault(),T())},[T]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),a.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const C=s.name||t.name||t.fragment_id,L=S7[h]||h,P=k7[h]||"var(--text-muted)",$=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],O=!e,A=w&&!O;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[C,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:P,color:"#fff"},children:L})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsxs("span",{children:["from ",t.source_doc_type]})]}),O&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:$.map(I=>a.jsxs("button",{onClick:()=>i(I.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===I.id?"var(--text-primary)":"var(--text-muted)",background:r===I.id?"var(--bg-canvas)":"transparent",borderBottom:r===I.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[I.label,I.id==="content"&&j&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),I.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},I.id))}),r==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tr,{content:v,onChange:k,loading:y,saving:_,isDirty:j,error:b,placeholder:"Enter prompt content...",readOnly:O})}),r==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Kind"}),a.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:P}}),a.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:L})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Name"}),a.jsx("input",{type:"text",value:s.name,onChange:I=>E("name",I.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:vg,disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Intent"}),a.jsx("textarea",{value:s.intent,onChange:I=>E("intent",I.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...vg,resize:"vertical"},disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:s.tags.map(I=>a.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[I,A&&a.jsx("button",{onClick:()=>M(I),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},I))}),A&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),onKeyDown:z,placeholder:"Add tag...",style:{...vg,flex:1}}),a.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Source"}),a.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",a.jsx("strong",{children:t.source_doc_type})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!A&&!t.source_doc_type&&a.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(N==null?void 0:N.tier1)&&!N.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const so={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},oo={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function C7({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[n,r]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){r(null),s(null);return}(async()=>{l(!0),d(null);try{const g=await je.getMechanicalOp(e.op_id);r(g);const w=t.find(v=>v.type_id===g.type);if(w)s(w);else try{const v=await je.getMechanicalOpType(g.type);s(v)}catch{}}catch(g){console.error("Failed to load mechanical op details:",g),d(g.message),r(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),a.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=n||e;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(i==null?void 0:i.name)||u.type}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o&&a.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&a.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!o&&a.jsxs("div",{className:"space-y-6 max-w-2xl",children:[a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:oo,children:"Operation ID"}),a.jsx("div",{style:so,className:"font-mono",children:u.op_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:oo,children:"Name"}),a.jsx("div",{style:so,children:u.name})]}),u.description&&a.jsxs("div",{children:[a.jsx("label",{style:oo,children:"Description"}),a.jsx("div",{style:{...so,whiteSpace:"pre-wrap"},children:u.description})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:oo,children:"Type"}),a.jsx("div",{style:so,children:u.type})]}),a.jsxs("div",{children:[a.jsx("label",{style:oo,children:"Version"}),a.jsx("div",{style:so,children:u.active_version||u.version})]})]})]})]}),i&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),a.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("span",{style:{fontSize:16},children:[i.icon==="git-merge"&&"",i.icon==="scissors"&&"",i.icon==="check-circle"&&"",i.icon==="shuffle"&&"",i.icon==="git-branch"&&""]}),a.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:i.name}),a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:i.category})]}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:i.description}),a.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=i.inputs)==null?void 0:f.length)>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),i.inputs.map((x,g)=>a.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[x.name,": ",x.type]},g))]}),((p=i.outputs)==null?void 0:p.length)>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),i.outputs.map((x,g)=>a.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[x.name,": ",x.type]},g))]})]})]})]}),u.config&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),a.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),a.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),a.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),a.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),a.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(x=>a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:x},x))})]})]})]}),a.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[a.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",a.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function E7(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>r=>{t.forEach(i=>i(r))},t)}const bu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ls(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ey(e){return"nodeType"in e}function Xt(e){var t,n;return e?Ls(e)?e:Ey(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Ty(e){const{Document:t}=Xt(e);return e instanceof t}function Na(e){return Ls(e)?!1:e instanceof Xt(e).HTMLElement}function O4(e){return e instanceof Xt(e).SVGElement}function Fs(e){return e?Ls(e)?e.document:Ey(e)?Ty(e)?e:Na(e)||O4(e)?e.ownerDocument:document:document:document}const Gn=bu?m.useLayoutEffect:m.useEffect;function Ry(e){const t=m.useRef(e);return Gn(()=>{t.current=e}),m.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}function T7(){const e=m.useRef(null),t=m.useCallback((r,i)=>{e.current=setInterval(r,i)},[]),n=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function ca(e,t){t===void 0&&(t=[e]);const n=m.useRef(e);return Gn(()=>{n.current!==e&&(n.current=e)},t),n}function Ca(e,t){const n=m.useRef();return m.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function jc(e){const t=Ry(e),n=m.useRef(null),r=m.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,r]}function zv(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let xg={};function Ea(e,t){return m.useMemo(()=>{if(t)return t;const n=xg[e]==null?0:xg[e]+1;return xg[e]=n,e+"-"+n},[e,t])}function D4(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((s,o)=>{const l=Object.entries(o);for(const[c,d]of l){const u=s[c];u!=null&&(s[c]=u+e*d)}return s},{...t})}}const hs=D4(1),ua=D4(-1);function R7(e){return"clientX"in e&&"clientY"in e}function Ay(e){if(!e)return!1;const{KeyboardEvent:t}=Xt(e.target);return t&&e instanceof t}function A7(e){if(!e)return!1;const{TouchEvent:t}=Xt(e.target);return t&&e instanceof t}function qv(e){if(A7(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return R7(e)?{x:e.clientX,y:e.clientY}:null}const Cs=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Cs.Translate.toString(e),Cs.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),bS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function I7(e){return e.matches(bS)?e:e.querySelector(bS)}const M7={display:"none"};function P7(e){let{id:t,value:n}=e;return V.createElement("div",{id:t,style:M7},n)}function O7(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return V.createElement("div",{id:t,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function D7(){const[e,t]=m.useState("");return{announce:m.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const L4=m.createContext(null);function L7(e){const t=m.useContext(L4);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function F7(){const[e]=m.useState(()=>new Set),t=m.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[m.useCallback(r=>{let{type:i,event:s}=r;e.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[e]),t]}const z7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},q7={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function $7(e){let{announcements:t=q7,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=z7}=e;const{announce:s,announcement:o}=D7(),l=Ea("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),L7(m.useMemo(()=>({onDragStart(f){let{active:p}=f;s(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&s(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;s(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;s(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;s(t.onDragCancel({active:p,over:h}))}}),[s,t])),!c)return null;const u=V.createElement(V.Fragment,null,V.createElement(P7,{id:r,value:i.draggable}),V.createElement(O7,{id:l,announcement:o}));return n?ts.createPortal(u,n):u}var ut;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ut||(ut={}));function Sc(){}function kc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function F4(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const In=Object.freeze({x:0,y:0});function z4(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function q4(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function B7(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function wS(e){let{left:t,top:n,height:r,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+r},{x:t+i,y:n+r}]}function $4(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function _S(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const B4=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=_S(t,t.left,t.top),s=[];for(const o of r){const{id:l}=o,c=n.get(l);if(c){const d=z4(_S(c),i);s.push({id:l,data:{droppableContainer:o,value:d}})}}return s.sort(q4)},H7=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=wS(t),s=[];for(const o of r){const{id:l}=o,c=n.get(l);if(c){const d=wS(c),u=i.reduce((p,h,x)=>p+z4(d[x],h),0),f=Number((u/4).toFixed(4));s.push({id:l,data:{droppableContainer:o,value:f}})}}return s.sort(q4)};function W7(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),o=i-r,l=s-n;if(r<i&&n<s){const c=t.width*t.height,d=e.width*e.height,u=o*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const U7=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=[];for(const s of r){const{id:o}=s,l=n.get(o);if(l){const c=W7(l,t);c>0&&i.push({id:o,data:{droppableContainer:s,value:c}})}}return i.sort(B7)};function V7(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function H4(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:In}function G7(e){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...n})}}const K7=G7(1);function Y7(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function X7(e,t,n){const r=Y7(t);if(!r)return e;const{scaleX:i,scaleY:s,x:o,y:l}=r,c=e.left-o-(1-i)*parseFloat(n),d=e.top-l-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),u=i?e.width/i:e.width,f=s?e.height/s:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const Q7={ignoreTransform:!1};function zs(e,t){t===void 0&&(t=Q7);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Xt(e).getComputedStyle(e);d&&(n=X7(n,d,u))}const{top:r,left:i,width:s,height:o,bottom:l,right:c}=n;return{top:r,left:i,width:s,height:o,bottom:l,right:c}}function jS(e){return zs(e,{ignoreTransform:!0})}function Z7(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function J7(e,t){return t===void 0&&(t=Xt(e).getComputedStyle(e)),t.position==="fixed"}function eW(e,t){t===void 0&&(t=Xt(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?n.test(s):!1})}function wu(e,t){const n=[];function r(i){if(t!=null&&n.length>=t||!i)return n;if(Ty(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Na(i)||O4(i)||n.includes(i))return n;const s=Xt(e).getComputedStyle(i);return i!==e&&eW(i,s)&&n.push(i),J7(i,s)?n:r(i.parentNode)}return e?r(e):n}function W4(e){const[t]=wu(e,1);return t??null}function yg(e){return!bu||!e?null:Ls(e)?e:Ey(e)?Ty(e)||e===Fs(e).scrollingElement?window:Na(e)?e:null:null}function U4(e){return Ls(e)?e.scrollX:e.scrollLeft}function V4(e){return Ls(e)?e.scrollY:e.scrollTop}function $v(e){return{x:U4(e),y:V4(e)}}var mt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(mt||(mt={}));function G4(e){return!bu||!e?!1:e===document.scrollingElement}function K4(e){const t={x:0,y:0},n=G4(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,o=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:r,minScroll:t}}const tW={x:.2,y:.2};function nW(e,t,n,r,i){let{top:s,left:o,right:l,bottom:c}=n;r===void 0&&(r=10),i===void 0&&(i=tW);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=K4(e),h={x:0,y:0},x={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!d&&s<=t.top+g.height?(h.y=mt.Backward,x.y=r*Math.abs((t.top+g.height-s)/g.height)):!u&&c>=t.bottom-g.height&&(h.y=mt.Forward,x.y=r*Math.abs((t.bottom-g.height-c)/g.height)),!p&&l>=t.right-g.width?(h.x=mt.Forward,x.x=r*Math.abs((t.right-g.width-l)/g.width)):!f&&o<=t.left+g.width&&(h.x=mt.Backward,x.x=r*Math.abs((t.left+g.width-o)/g.width)),{direction:h,speed:x}}function rW(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:t,left:n,right:r,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:i,width:e.clientWidth,height:e.clientHeight}}function Y4(e){return e.reduce((t,n)=>hs(t,$v(n)),In)}function iW(e){return e.reduce((t,n)=>t+U4(n),0)}function sW(e){return e.reduce((t,n)=>t+V4(n),0)}function oW(e,t){if(t===void 0&&(t=zs),!e)return;const{top:n,left:r,bottom:i,right:s}=t(e);W4(e)&&(i<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const aW=[["x",["left","right"],iW],["y",["top","bottom"],sW]];class Iy{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=wu(n),i=Y4(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,o,l]of aW)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(r),u=i[s]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ao{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var i;(i=this.target)==null||i.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function lW(e){const{EventTarget:t}=Xt(e);return e instanceof t?e:Fs(e)}function bg(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var un;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(un||(un={}));function SS(e){e.preventDefault()}function cW(e){e.stopPropagation()}var Ae;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ae||(Ae={}));const X4={start:[Ae.Space,Ae.Enter],cancel:[Ae.Esc],end:[Ae.Space,Ae.Enter,Ae.Tab]},uW=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Ae.Right:return{...n,x:n.x+25};case Ae.Left:return{...n,x:n.x-25};case Ae.Down:return{...n,y:n.y+25};case Ae.Up:return{...n,y:n.y-25}}};class _u{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Ao(Fs(n)),this.windowListeners=new Ao(Xt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(un.Resize,this.handleCancel),this.windowListeners.add(un.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(un.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&oW(r),n(In)}handleKeyDown(t){if(Ay(t)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:s=X4,coordinateGetter:o=uW,scrollBehavior:l="smooth"}=i,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=r.current,u=d?{x:d.left,y:d.top}:In;this.referenceCoordinates||(this.referenceCoordinates=u);const f=o(t,{active:n,context:r.current,currentCoordinates:u});if(f){const p=ua(f,u),h={x:0,y:0},{scrollableAncestors:x}=r.current;for(const g of x){const w=t.code,{isTop:v,isRight:y,isLeft:b,isBottom:_,maxScroll:j,minScroll:k}=K4(g),N=rW(g),E={x:Math.min(w===Ae.Right?N.right-N.width/2:N.right,Math.max(w===Ae.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(w===Ae.Down?N.bottom-N.height/2:N.bottom,Math.max(w===Ae.Down?N.top:N.top+N.height/2,f.y))},S=w===Ae.Right&&!y||w===Ae.Left&&!b,R=w===Ae.Down&&!_||w===Ae.Up&&!v;if(S&&E.x!==f.x){const T=g.scrollLeft+p.x,M=w===Ae.Right&&T<=j.x||w===Ae.Left&&T>=k.x;if(M&&!p.y){g.scrollTo({left:T,behavior:l});return}M?h.x=g.scrollLeft-T:h.x=w===Ae.Right?g.scrollLeft-j.x:g.scrollLeft-k.x,h.x&&g.scrollBy({left:-h.x,behavior:l});break}else if(R&&E.y!==f.y){const T=g.scrollTop+p.y,M=w===Ae.Down&&T<=j.y||w===Ae.Up&&T>=k.y;if(M&&!p.x){g.scrollTo({top:T,behavior:l});return}M?h.y=g.scrollTop-T:h.y=w===Ae.Down?g.scrollTop-j.y:g.scrollTop-k.y,h.y&&g.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,hs(ua(f,this.referenceCoordinates),h))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}_u.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=X4,onActivation:i}=t,{active:s}=n;const{code:o}=e.nativeEvent;if(r.start.includes(o)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function kS(e){return!!(e&&"distance"in e)}function NS(e){return!!(e&&"delay"in e)}class My{constructor(t,n,r){var i;r===void 0&&(r=lW(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:o}=s;this.props=t,this.events=n,this.document=Fs(o),this.documentListeners=new Ao(this.document),this.listeners=new Ao(r),this.windowListeners=new Ao(Xt(o)),this.initialCoordinates=(i=qv(s))!=null?i:In,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(un.Resize,this.handleCancel),this.windowListeners.add(un.DragStart,SS),this.windowListeners.add(un.VisibilityChange,this.handleCancel),this.windowListeners.add(un.ContextMenu,SS),this.documentListeners.add(un.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(NS(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(kS(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:i}=this.props;i(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(un.Click,cW,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(un.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const c=(n=qv(t))!=null?n:In,d=ua(i,c);if(!r&&l){if(kS(l)){if(l.tolerance!=null&&bg(d,l.tolerance))return this.handleCancel();if(bg(d,l.distance))return this.handleStart()}if(NS(l)&&bg(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Ae.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const dW={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ju extends My{constructor(t){const{event:n}=t,r=Fs(n.target);super(t,dW,r)}}ju.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const fW={move:{name:"mousemove"},end:{name:"mouseup"}};var Bv;(function(e){e[e.RightClick=2]="RightClick"})(Bv||(Bv={}));class pW extends My{constructor(t){super(t,fW,Fs(t.event.target))}}pW.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Bv.RightClick?!1:(r==null||r({event:n}),!0)}}];const wg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class hW extends My{constructor(t){super(t,wg)}static setup(){return window.addEventListener(wg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(wg.move.name,t)};function t(){}}}hW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var Io;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Io||(Io={}));var Nc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Nc||(Nc={}));function mW(e){let{acceleration:t,activator:n=Io.Pointer,canScroll:r,draggingRect:i,enabled:s,interval:o=5,order:l=Nc.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=vW({delta:f,disabled:!s}),[x,g]=T7(),w=m.useRef({x:0,y:0}),v=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(n){case Io.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Io.DraggableRect:return i}},[n,i,c]),b=m.useRef(null),_=m.useCallback(()=>{const k=b.current;if(!k)return;const N=w.current.x*v.current.x,E=w.current.y*v.current.y;k.scrollBy(N,E)},[]),j=m.useMemo(()=>l===Nc.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!s||!d.length||!y){g();return}for(const k of j){if((r==null?void 0:r(k))===!1)continue;const N=d.indexOf(k),E=u[N];if(!E)continue;const{direction:S,speed:R}=nW(k,E,y,t,p);for(const T of["x","y"])h[T][S[T]]||(R[T]=0,S[T]=0);if(R.x>0||R.y>0){g(),b.current=k,x(_,o),w.current=R,v.current=S;return}}w.current={x:0,y:0},v.current={x:0,y:0},g()},[t,_,r,g,s,o,JSON.stringify(y),JSON.stringify(h),x,d,j,u,JSON.stringify(p)])}const gW={x:{[mt.Backward]:!1,[mt.Forward]:!1},y:{[mt.Backward]:!1,[mt.Forward]:!1}};function vW(e){let{delta:t,disabled:n}=e;const r=zv(t);return Ca(i=>{if(n||!r||!i)return gW;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[mt.Backward]:i.x[mt.Backward]||s.x===-1,[mt.Forward]:i.x[mt.Forward]||s.x===1},y:{[mt.Backward]:i.y[mt.Backward]||s.y===-1,[mt.Forward]:i.y[mt.Forward]||s.y===1}}},[n,t,r])}function xW(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ca(i=>{var s;return t==null?null:(s=r??i)!=null?s:null},[r,t])}function yW(e,t){return m.useMemo(()=>e.reduce((n,r)=>{const{sensor:i}=r,s=i.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,r)}));return[...n,...s]},[]),[e,t])}var da;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(da||(da={}));var Hv;(function(e){e.Optimized="optimized"})(Hv||(Hv={}));const CS=new Map;function bW(e,t){let{dragging:n,dependencies:r,config:i}=t;const[s,o]=m.useState(null),{frequency:l,measure:c,strategy:d}=i,u=m.useRef(e),f=w(),p=ca(f),h=m.useCallback(function(v){v===void 0&&(v=[]),!p.current&&o(y=>y===null?v:y.concat(v.filter(b=>!y.includes(b))))},[p]),x=m.useRef(null),g=Ca(v=>{if(f&&!n)return CS;if(!v||v===CS||u.current!==e||s!=null){const y=new Map;for(let b of e){if(!b)continue;if(s&&s.length>0&&!s.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const _=b.node.current,j=_?new Iy(c(_),_):null;b.rect.current=j,j&&y.set(b.id,j)}return y}return v},[e,s,n,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[n,f]),m.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),m.useEffect(()=>{f||typeof l!="number"||x.current!==null||(x.current=setTimeout(()=>{h(),x.current=null},l))},[l,f,h,...r]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:s!=null};function w(){switch(d){case da.Always:return!1;case da.BeforeDragging:return n;default:return!n}}}function Q4(e,t){return Ca(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function wW(e,t){return Q4(e,t)}function _W(e){let{callback:t,disabled:n}=e;const r=Ry(t),i=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Su(e){let{callback:t,disabled:n}=e;const r=Ry(t),i=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function jW(e){return new Iy(zs(e),e)}function ES(e,t,n){t===void 0&&(t=jW);const[r,i]=m.useState(null);function s(){i(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??n)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const o=_W({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=Su({callback:s});return Gn(()=>{s(),e?(l==null||l.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[e]),r}function SW(e){const t=Q4(e);return H4(e,t)}const TS=[];function kW(e){const t=m.useRef(e),n=Ca(r=>e?r&&r!==TS&&e&&t.current&&e.parentNode===t.current.parentNode?r:wu(e):TS,[e]);return m.useEffect(()=>{t.current=e},[e]),n}function NW(e){const[t,n]=m.useState(null),r=m.useRef(e),i=m.useCallback(s=>{const o=yg(s.target);o&&n(l=>l?(l.set(o,$v(o)),new Map(l)):null)},[]);return m.useEffect(()=>{const s=r.current;if(e!==s){o(s);const l=e.map(c=>{const d=yg(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,$v(d)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),r.current=e}return()=>{o(e),o(s)};function o(l){l.forEach(c=>{const d=yg(c);d==null||d.removeEventListener("scroll",i)})}},[i,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,o)=>hs(s,o),In):Y4(e):In,[e,t])}function RS(e,t){t===void 0&&(t=[]);const n=m.useRef(null);return m.useEffect(()=>{n.current=null},t),m.useEffect(()=>{const r=e!==In;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?ua(e,n.current):In}function CW(e){m.useEffect(()=>{if(!bu)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function EW(e,t){return m.useMemo(()=>e.reduce((n,r)=>{let{eventName:i,handler:s}=r;return n[i]=o=>{s(o,t)},n},{}),[e,t])}function Z4(e){return m.useMemo(()=>e?Z7(e):null,[e])}const AS=[];function TW(e,t){t===void 0&&(t=zs);const[n]=e,r=Z4(n?Xt(n):null),[i,s]=m.useState(AS);function o(){s(()=>e.length?e.map(c=>G4(c)?r:new Iy(t(c),c)):AS)}const l=Su({callback:o});return Gn(()=>{l==null||l.disconnect(),o(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),i}function RW(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Na(t)?t:e}function AW(e){let{measure:t}=e;const[n,r]=m.useState(null),i=m.useCallback(d=>{for(const{target:u}of d)if(Na(u)){r(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),s=Su({callback:i}),o=m.useCallback(d=>{const u=RW(d);s==null||s.disconnect(),u&&(s==null||s.observe(u)),r(u?t(u):null)},[t,s]),[l,c]=jc(o);return m.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const IW=[{sensor:ju,options:{}},{sensor:_u,options:{}}],MW={current:{}},Il={draggable:{measure:jS},droppable:{measure:jS,strategy:da.WhileDragging,frequency:Hv.Optimized},dragOverlay:{measure:zs}};class Mo extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const PW={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Mo,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Sc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Il,measureDroppableContainers:Sc,windowRect:null,measuringScheduled:!1},OW={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Sc,draggableNodes:new Map,over:null,measureDroppableContainers:Sc},ku=m.createContext(OW),J4=m.createContext(PW);function DW(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Mo}}}function LW(e,t){switch(t.type){case ut.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ut.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ut.DragEnd:case ut.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ut.RegisterDroppable:{const{element:n}=t,{id:r}=n,i=new Mo(e.droppable.containers);return i.set(r,n),{...e,droppable:{...e.droppable,containers:i}}}case ut.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const o=new Mo(e.droppable.containers);return o.set(n,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case ut.UnregisterDroppable:{const{id:n,key:r}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new Mo(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function FW(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:i}=m.useContext(ku),s=zv(r),o=zv(n==null?void 0:n.id);return m.useEffect(()=>{if(!t&&!r&&s&&o!=null){if(!Ay(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=I7(u);if(f){f.focus();break}}})}},[r,t,i,o,s]),null}function zW(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...r}),n):n}function qW(e){return m.useMemo(()=>({draggable:{...Il.draggable,...e==null?void 0:e.draggable},droppable:{...Il.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Il.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function $W(e){let{activeNode:t,measure:n,initialRect:r,config:i=!0}=e;const s=m.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Gn(()=>{if(!o&&!l||!t){s.current=!1;return}if(s.current||!r)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=n(d),f=H4(u,r);if(o||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=W4(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,o,l,r,n])}const eR=m.createContext({...In,scaleX:1,scaleY:1});var Cr;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Cr||(Cr={}));const tR=m.memo(function(t){var n,r,i,s;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:u=IW,collisionDetection:f=U7,measuring:p,modifiers:h,...x}=t;const g=m.useReducer(LW,void 0,DW),[w,v]=g,[y,b]=F7(),[_,j]=m.useState(Cr.Uninitialized),k=_===Cr.Initialized,{draggable:{active:N,nodes:E,translate:S},droppable:{containers:R}}=w,T=N!=null?E.get(N):null,M=m.useRef({initial:null,translated:null}),z=m.useMemo(()=>{var re;return N!=null?{id:N,data:(re=T==null?void 0:T.data)!=null?re:MW,rect:M}:null},[N,T]),C=m.useRef(null),[L,P]=m.useState(null),[$,O]=m.useState(null),A=ca(x,Object.values(x)),F=Ea("DndDescribedBy",o),I=m.useMemo(()=>R.getEnabled(),[R]),q=qW(p),{droppableRects:W,measureDroppableContainers:U,measuringScheduled:Z}=bW(I,{dragging:k,dependencies:[S.x,S.y],config:q.droppable}),B=xW(E,N),ne=m.useMemo(()=>$?qv($):null,[$]),se=K(),ce=wW(B,q.draggable.measure);$W({activeNode:N!=null?E.get(N):null,config:se.layoutShiftCompensation,initialRect:ce,measure:q.draggable.measure});const J=ES(B,q.draggable.measure,ce),_e=ES(B?B.parentElement:null),G=m.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),xe=R.getNodeFor((n=G.current.over)==null?void 0:n.id),fe=AW({measure:q.dragOverlay.measure}),oe=(r=fe.nodeRef.current)!=null?r:B,ve=k?(i=fe.rect)!=null?i:J:null,Y=!!(fe.nodeRef.current&&fe.rect),Q=SW(Y?null:J),pe=Z4(oe?Xt(oe):null),he=kW(k?xe??B:null),we=TW(he),ye=zW(h,{transform:{x:S.x-Q.x,y:S.y-Q.y,scaleX:1,scaleY:1},activatorEvent:$,active:z,activeNodeRect:J,containerNodeRect:_e,draggingNodeRect:ve,over:G.current.over,overlayNodeRect:fe.rect,scrollableAncestors:he,scrollableAncestorRects:we,windowRect:pe}),te=ne?hs(ne,S):null,me=NW(he),Ge=RS(me),Fe=RS(me,[J]),$e=hs(ye,Ge),Te=ve?K7(ve,ye):null,Be=z&&Te?f({active:z,collisionRect:Te,droppableRects:W,droppableContainers:I,pointerCoordinates:te}):null,at=$4(Be,"id"),[Re,X]=m.useState(null),Pe=Y?ye:hs(ye,Fe),ge=V7(Pe,(s=Re==null?void 0:Re.rect)!=null?s:null,J),kt=m.useRef(null),xt=m.useCallback((re,Oe)=>{let{sensor:lt,options:ln}=Oe;if(C.current==null)return;const Nt=E.get(C.current);if(!Nt)return;const bt=re.nativeEvent,qt=new lt({active:C.current,activeNode:Nt,event:bt,options:ln,context:G,onAbort(ie){if(!E.get(ie))return;const{onDragAbort:Ct}=A.current,wn={id:ie};Ct==null||Ct(wn),y({type:"onDragAbort",event:wn})},onPending(ie,He,Ct,wn){if(!E.get(ie))return;const{onDragPending:ni}=A.current,Dn={id:ie,constraint:He,initialCoordinates:Ct,offset:wn};ni==null||ni(Dn),y({type:"onDragPending",event:Dn})},onStart(ie){const He=C.current;if(He==null)return;const Ct=E.get(He);if(!Ct)return;const{onDragStart:wn}=A.current,ti={activatorEvent:bt,active:{id:He,data:Ct.data,rect:M}};ts.unstable_batchedUpdates(()=>{wn==null||wn(ti),j(Cr.Initializing),v({type:ut.DragStart,initialCoordinates:ie,active:He}),y({type:"onDragStart",event:ti}),P(kt.current),O(bt)})},onMove(ie){v({type:ut.DragMove,coordinates:ie})},onEnd:ue(ut.DragEnd),onCancel:ue(ut.DragCancel)});kt.current=qt;function ue(ie){return async function(){const{active:Ct,collisions:wn,over:ti,scrollAdjustedTranslate:ni}=G.current;let Dn=null;if(Ct&&ni){const{cancelDrop:ri}=A.current;Dn={activatorEvent:bt,active:Ct,collisions:wn,delta:ni,over:ti},ie===ut.DragEnd&&typeof ri=="function"&&await Promise.resolve(ri(Dn))&&(ie=ut.DragCancel)}C.current=null,ts.unstable_batchedUpdates(()=>{v({type:ie}),j(Cr.Uninitialized),X(null),P(null),O(null),kt.current=null;const ri=ie===ut.DragEnd?"onDragEnd":"onDragCancel";if(Dn){const qs=A.current[ri];qs==null||qs(Dn),y({type:ri,event:Dn})}})}}},[E]),yt=m.useCallback((re,Oe)=>(lt,ln)=>{const Nt=lt.nativeEvent,bt=E.get(ln);if(C.current!==null||!bt||Nt.dndKit||Nt.defaultPrevented)return;const qt={active:bt};re(lt,Oe.options,qt)===!0&&(Nt.dndKit={capturedBy:Oe.sensor},C.current=ln,xt(lt,Oe))},[E,xt]),Qt=yW(u,yt);CW(u),Gn(()=>{J&&_===Cr.Initializing&&j(Cr.Initialized)},[J,_]),m.useEffect(()=>{const{onDragMove:re}=A.current,{active:Oe,activatorEvent:lt,collisions:ln,over:Nt}=G.current;if(!Oe||!lt)return;const bt={active:Oe,activatorEvent:lt,collisions:ln,delta:{x:$e.x,y:$e.y},over:Nt};ts.unstable_batchedUpdates(()=>{re==null||re(bt),y({type:"onDragMove",event:bt})})},[$e.x,$e.y]),m.useEffect(()=>{const{active:re,activatorEvent:Oe,collisions:lt,droppableContainers:ln,scrollAdjustedTranslate:Nt}=G.current;if(!re||C.current==null||!Oe||!Nt)return;const{onDragOver:bt}=A.current,qt=ln.get(at),ue=qt&&qt.rect.current?{id:qt.id,rect:qt.rect.current,data:qt.data,disabled:qt.disabled}:null,ie={active:re,activatorEvent:Oe,collisions:lt,delta:{x:Nt.x,y:Nt.y},over:ue};ts.unstable_batchedUpdates(()=>{X(ue),bt==null||bt(ie),y({type:"onDragOver",event:ie})})},[at]),Gn(()=>{G.current={activatorEvent:$,active:z,activeNode:B,collisionRect:Te,collisions:Be,droppableRects:W,draggableNodes:E,draggingNode:oe,draggingNodeRect:ve,droppableContainers:R,over:Re,scrollableAncestors:he,scrollAdjustedTranslate:$e},M.current={initial:ve,translated:Te}},[z,B,Be,Te,E,oe,ve,W,R,Re,he,$e]),mW({...se,delta:S,draggingRect:Te,pointerCoordinates:te,scrollableAncestors:he,scrollableAncestorRects:we});const D=m.useMemo(()=>({active:z,activeNode:B,activeNodeRect:J,activatorEvent:$,collisions:Be,containerNodeRect:_e,dragOverlay:fe,draggableNodes:E,droppableContainers:R,droppableRects:W,over:Re,measureDroppableContainers:U,scrollableAncestors:he,scrollableAncestorRects:we,measuringConfiguration:q,measuringScheduled:Z,windowRect:pe}),[z,B,J,$,Be,_e,fe,E,R,W,Re,U,he,we,q,Z,pe]),H=m.useMemo(()=>({activatorEvent:$,activators:Qt,active:z,activeNodeRect:J,ariaDescribedById:{draggable:F},dispatch:v,draggableNodes:E,over:Re,measureDroppableContainers:U}),[$,Qt,z,J,v,F,E,Re,U]);return V.createElement(L4.Provider,{value:b},V.createElement(ku.Provider,{value:H},V.createElement(J4.Provider,{value:D},V.createElement(eR.Provider,{value:ge},d)),V.createElement(FW,{disabled:(l==null?void 0:l.restoreFocus)===!1})),V.createElement($7,{...l,hiddenTextDescribedById:F}));function K(){const re=(L==null?void 0:L.autoScrollEnabled)===!1,Oe=typeof c=="object"?c.enabled===!1:c===!1,lt=k&&!re&&!Oe;return typeof c=="object"?{...c,enabled:lt}:{enabled:lt}}}),BW=m.createContext(null),IS="button",HW="Draggable";function WW(e){let{id:t,data:n,disabled:r=!1,attributes:i}=e;const s=Ea(HW),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(ku),{role:h=IS,roleDescription:x="draggable",tabIndex:g=0}=i??{},w=(c==null?void 0:c.id)===t,v=m.useContext(w?eR:BW),[y,b]=jc(),[_,j]=jc(),k=EW(o,t),N=ca(n);Gn(()=>(f.set(t,{id:t,key:s,node:y,activatorNode:_,data:N}),()=>{const S=f.get(t);S&&S.key===s&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":r,"aria-pressed":w&&h===IS?!0:void 0,"aria-roledescription":x,"aria-describedby":u.draggable}),[r,h,g,w,x,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:E,isDragging:w,listeners:r?void 0:k,node:y,over:p,setNodeRef:b,setActivatorNodeRef:j,transform:v}}function UW(){return m.useContext(J4)}const VW="Droppable",GW={timeout:25};function KW(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:i}=e;const s=Ea(VW),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(ku),u=m.useRef({disabled:n}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:x,updateMeasurementsFor:g,timeout:w}={...GW,...i},v=ca(g??r),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(v.current)?v.current:[v.current]),h.current=null},w)},[w]),b=Su({callback:y,disabled:x||!o}),_=m.useCallback((E,S)=>{b&&(S&&(b.unobserve(S),f.current=!1),E&&b.observe(E))},[b]),[j,k]=jc(_),N=ca(t);return m.useEffect(()=>{!b||!j.current||(b.disconnect(),f.current=!1,b.observe(j.current))},[j,b]),m.useEffect(()=>(l({type:ut.RegisterDroppable,element:{id:r,key:s,disabled:n,node:j,rect:p,data:N}}),()=>l({type:ut.UnregisterDroppable,key:s,id:r})),[r]),m.useEffect(()=>{n!==u.current.disabled&&(l({type:ut.SetDroppableDisabled,id:r,key:s,disabled:n}),u.current.disabled=n)},[r,s,n,l]),{active:o,rect:p,isOver:(c==null?void 0:c.id)===r,node:j,over:c,setNodeRef:k}}function Nu(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function YW(e,t){return e.reduce((n,r,i)=>{const s=t.get(r);return s&&(n[i]=s),n},Array(e.length))}function hl(e){return e!==null&&e>=0}function XW(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function QW(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const nR=e=>{let{rects:t,activeIndex:n,overIndex:r,index:i}=e;const s=Nu(t,r,n),o=t[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},ml={scaleX:1,scaleY:1},rR=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:i,rects:s,overIndex:o}=e;const l=(t=s[n])!=null?t:r;if(!l)return null;if(i===n){const d=s[o];return d?{x:0,y:n<o?d.top+d.height-(l.top+l.height):d.top-l.top,...ml}:null}const c=ZW(s,i,n);return i>n&&i<=o?{x:0,y:-l.height-c,...ml}:i<n&&i>=o?{x:0,y:l.height+c,...ml}:{x:0,y:0,...ml}};function ZW(e,t,n){const r=e[t],i=e[t-1],s=e[t+1];return r?n<t?i?r.top-(i.top+i.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const iR="Sortable",sR=V.createContext({activeIndex:-1,containerId:iR,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:nR,disabled:{draggable:!1,droppable:!1}});function oR(e){let{children:t,id:n,items:r,strategy:i=nR,disabled:s=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=UW(),f=Ea(iR,n),p=l.rect!==null,h=m.useMemo(()=>r.map(k=>typeof k=="object"&&"id"in k?k.id:k),[r]),x=o!=null,g=o?h.indexOf(o.id):-1,w=d?h.indexOf(d.id):-1,v=m.useRef(h),y=!XW(h,v.current),b=w!==-1&&g===-1||y,_=QW(s);Gn(()=>{y&&x&&u(h)},[y,h,x,u]),m.useEffect(()=>{v.current=h},[h]);const j=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:_,disableTransforms:b,items:h,overIndex:w,useDragOverlay:p,sortedRects:YW(h,c),strategy:i}),[g,f,_.draggable,_.droppable,b,h,w,c,p,i]);return V.createElement(sR.Provider,{value:j},t)}const JW=e=>{let{id:t,items:n,activeIndex:r,overIndex:i}=e;return Nu(n,r,i).indexOf(t)},eU=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!r||l!==s&&i===o?!1:n?!0:o!==i&&t===c},tU={duration:200,easing:"ease"},aR="transform",nU=Cs.Transition.toString({property:aR,duration:0,easing:"linear"}),rU={roleDescription:"sortable"};function iU(e){let{disabled:t,index:n,node:r,rect:i}=e;const[s,o]=m.useState(null),l=m.useRef(n);return Gn(()=>{if(!t&&n!==l.current&&r.current){const c=i.current;if(c){const d=zs(r.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&o(u)}}n!==l.current&&(l.current=n)},[t,n,r,i]),m.useEffect(()=>{s&&o(null)},[s]),s}function lR(e){let{animateLayoutChanges:t=eU,attributes:n,disabled:r,data:i,getNewIndex:s=JW,id:o,strategy:l,resizeObserverConfig:c,transition:d=tU}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:x,sortedRects:g,overIndex:w,useDragOverlay:v,strategy:y}=m.useContext(sR),b=sU(r,h),_=u.indexOf(o),j=m.useMemo(()=>({sortable:{containerId:f,index:_,items:u},...i}),[f,i,_,u]),k=m.useMemo(()=>u.slice(u.indexOf(o)),[u,o]),{rect:N,node:E,isOver:S,setNodeRef:R}=KW({id:o,data:j,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:T,activatorEvent:M,activeNodeRect:z,attributes:C,setNodeRef:L,listeners:P,isDragging:$,over:O,setActivatorNodeRef:A,transform:F}=WW({id:o,data:j,attributes:{...rU,...n},disabled:b.draggable}),I=E7(R,L),q=!!T,W=q&&!x&&hl(p)&&hl(w),U=!v&&$,Z=U&&W?F:null,ne=W?Z??(l??y)({rects:g,activeNodeRect:z,activeIndex:p,overIndex:w,index:_}):null,se=hl(p)&&hl(w)?s({id:o,items:u,activeIndex:p,overIndex:w}):_,ce=T==null?void 0:T.id,J=m.useRef({activeId:ce,items:u,newIndex:se,containerId:f}),_e=u!==J.current.items,G=t({active:T,containerId:f,isDragging:$,isSorting:q,id:o,index:_,items:u,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:d,wasDragging:J.current.activeId!=null}),xe=iU({disabled:!G,index:_,node:E,rect:N});return m.useEffect(()=>{q&&J.current.newIndex!==se&&(J.current.newIndex=se),f!==J.current.containerId&&(J.current.containerId=f),u!==J.current.items&&(J.current.items=u)},[q,se,f,u]),m.useEffect(()=>{if(ce===J.current.activeId)return;if(ce!=null&&J.current.activeId==null){J.current.activeId=ce;return}const oe=setTimeout(()=>{J.current.activeId=ce},50);return()=>clearTimeout(oe)},[ce]),{active:T,activeIndex:p,attributes:C,data:j,rect:N,index:_,newIndex:se,items:u,isOver:S,isSorting:q,isDragging:$,listeners:P,node:E,overIndex:w,over:O,setNodeRef:I,setActivatorNodeRef:A,setDroppableNodeRef:R,setDraggableNodeRef:L,transform:xe??ne,transition:fe()};function fe(){if(xe||_e&&J.current.newIndex===_)return nU;if(!(U&&!Ay(M)||!d)&&(q||G))return Cs.Transition.toString({...d,property:aR})}}function sU(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Cc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const oU=[Ae.Down,Ae.Right,Ae.Up,Ae.Left],cR=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:l}}=t;if(oU.includes(e.code)){if(e.preventDefault(),!n||!r)return;const c=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=i.get(f.id);if(p)switch(e.code){case Ae.Down:r.top<p.top&&c.push(f);break;case Ae.Up:r.top>p.top&&c.push(f);break;case Ae.Left:r.left>p.left&&c.push(f);break;case Ae.Right:r.left<p.left&&c.push(f);break}});const d=H7({collisionRect:r,droppableRects:i,droppableContainers:c});let u=$4(d,"id");if(u===(o==null?void 0:o.id)&&d.length>1&&(u=d[1].id),u!=null){const f=s.get(n.id),p=s.get(u),h=p?i.get(p.id):null,x=p==null?void 0:p.node.current;if(x&&h&&f&&p){const w=wu(x).some((k,N)=>l[N]!==k),v=uR(f,p),y=aU(f,p),b=w||!v?{x:0,y:0}:{x:y?r.width-h.width:0,y:y?r.height-h.height:0},_={x:h.left,y:h.top};return b.x&&b.y?_:ua(_,b)}}}};function uR(e,t){return!Cc(e)||!Cc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function aU(e,t){return!Cc(e)||!Cc(t)||!uR(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const lU={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Fn={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},cn={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},dR={step_id:"new_step",produces:"",scope:"",inputs:[]},cU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function uU({workspaceId:e,workflow:t,documentTypes:n=[],onArtifactSave:r,onDelete:i,onNavigateToWorkflow:s}){const[o,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:x,error:g,saving:w,updateWorkflow:v}=UT(e,p,{onSave:S=>{r==null||r(p,S)}}),y=m.useCallback(S=>{S==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(S)},[h]),b=m.useCallback(S=>{const R=S.target.value;d(R);try{const T=JSON.parse(R);f(null),v(T)}catch(T){f(T.message)}},[v]),_=m.useCallback((S,R)=>{if(!h)return;const T=[...h.steps];T[S]=R,v({...h,steps:T})},[h,v]),j=m.useCallback(S=>{if(!h)return;const R=h.steps.filter((T,M)=>M!==S);v({...h,steps:R})},[h,v]),k=m.useCallback(S=>{var T,M;if(!h)return;const R=S==="iteration"?{...cU,step_id:`new_iteration_${(((T=h.steps)==null?void 0:T.length)||0)+1}`}:{...dR,step_id:`new_step_${(((M=h.steps)==null?void 0:M.length)||0)+1}`};v({...h,steps:[...h.steps||[],R]})},[h,v]),N=m.useCallback((S,R)=>{if(!h)return;const T=Nu(h.steps,S,R);v({...h,steps:T})},[h,v]),E=m.useCallback(()=>{!i||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&i(t.workflow_id)},[i,t]);return t?a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[w&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),i&&a.jsx("button",{onClick:E,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(S=>a.jsx("button",{onClick:()=>y(S.id),style:{...lU,color:o===S.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===S.id?"2px solid var(--action-primary)":"2px solid transparent"},children:S.label},S.id))}),x?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&a.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[a.jsx(dU,{steps:(h==null?void 0:h.steps)||[],documentTypes:n,onStepChange:_,onStepDelete:j,onReorder:N}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>k("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),a.jsx("button",{onClick:()=>k("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&a.jsxs("div",{className:"h-full flex flex-col p-4",children:[a.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),o==="metadata"&&a.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?a.jsx(mU,{workflow:h,onUpdateWorkflow:v,onNavigateToWorkflow:s}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),a.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function dU({steps:e,documentTypes:t=[],onStepChange:n,onStepDelete:r,onReorder:i}){const s=F4(kc(ju,{activationConstraint:{distance:5}}),kc(_u,{coordinateGetter:cR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):a.jsx(tR,{sensors:s,collisionDetection:B4,onDragEnd:l,children:a.jsx(oR,{items:o,strategy:rR,children:e.map((c,d)=>a.jsx(fU,{step:c,index:d,documentTypes:t,onChange:n,onDelete:r},c.step_id))})})}function fU({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=lR({id:e.step_id}),f={transform:Cs.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(fR,{step:e,index:t,documentTypes:n,onChange:r,onDelete:i,dragHandleProps:{...s,...o}})})}function fR({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:i,dragHandleProps:s,depth:o=0}){var k,N,E;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(S,R)=>{const T={...l,[S]:R};c(T),r(t,T)},h=(S,R)=>{const T={...l.iterate_over,[S]:R},M={...l,iterate_over:T};c(M),r(t,M)},x=()=>{const S=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:S};c(R),r(t,R)},g=(S,R,T)=>{const M=[...l.inputs||[]];M[S]={...M[S],[R]:T};const z={...l,inputs:M};c(z),r(t,z)},w=S=>{const R=(l.inputs||[]).filter((M,z)=>z!==S),T={...l,inputs:R};c(T),r(t,T)},v=m.useCallback((S,R)=>{const T=[...l.steps||[]];T[S]=R;const M={...l,steps:T};c(M),r(t,M)},[l,t,r]),y=m.useCallback(S=>{const R=(l.steps||[]).filter((M,z)=>z!==S),T={...l,steps:R};c(T),r(t,T)},[l,t,r]),b=m.useCallback(()=>{var T;const S=[...l.steps||[],{...dR,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],R={...l,steps:S};c(R),r(t,R)},[l,t,r]),_=m.useCallback((S,R)=>{const T=Nu(l.steps||[],S,R),M={...l,steps:T};c(M),r(t,M)},[l,t,r]),j={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return a.jsxs("div",{style:j,children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[s&&a.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[a.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),a.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),a.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),a.jsx("span",{style:{flex:1}}),a.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?a.jsx("path",{d:"M18 15l-6-6-6 6"}):a.jsx("path",{d:"M6 9l6 6 6-6"})})}),a.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Step ID"}),a.jsx("input",{type:"text",value:l.step_id||"",onChange:S=>p("step_id",S.target.value),style:Fn})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Doc Type"}),a.jsxs("select",{value:((k=l.iterate_over)==null?void 0:k.doc_type)||"",onChange:S=>h("doc_type",S.target.value),style:Fn,children:[a.jsx("option",{value:"",children:"-- Select --"}),n.map(S=>a.jsx("option",{value:S.doc_type_id,children:S.doc_type_id},S.doc_type_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Collection Field"}),a.jsx("input",{type:"text",value:((N=l.iterate_over)==null?void 0:N.collection_field)||"",onChange:S=>h("collection_field",S.target.value),style:Fn})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Entity Type"}),a.jsx("input",{type:"text",value:((E=l.iterate_over)==null?void 0:E.entity_type)||"",onChange:S=>h("entity_type",S.target.value),style:Fn})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:S=>p("scope",S.target.value),style:Fn})]}),a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{style:cn,children:"Nested Steps"}),a.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),a.jsx(pU,{steps:l.steps||[],documentTypes:n,onStepChange:v,onStepDelete:y,onReorder:_})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Produces"}),a.jsxs("select",{value:l.produces||"",onChange:S=>p("produces",S.target.value),style:Fn,children:[a.jsx("option",{value:"",children:"-- Select document type --"}),n.map(S=>a.jsx("option",{value:S.doc_type_id,children:S.doc_type_id},S.doc_type_id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:S=>p("scope",S.target.value),placeholder:"project",style:Fn})]}),a.jsxs("div",{children:[a.jsx("label",{style:cn,children:"Creates Entities"}),a.jsx("input",{type:"text",value:l.creates_entities||"",onChange:S=>p("creates_entities",S.target.value||void 0),placeholder:"e.g., epic",style:Fn})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:cn,children:"Inputs"}),a.jsx("button",{onClick:x,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):a.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((S,R)=>a.jsxs("div",{className:"flex gap-1 items-end",children:[a.jsxs("div",{style:{flex:1},children:[R===0&&a.jsx("label",{style:{...cn,fontSize:9},children:"Doc/Entity Type"}),a.jsxs("select",{value:S.doc_type||S.entity_type||"",onChange:T=>{const M=T.target.value;S.entity_type!==void 0?g(R,"entity_type",M):g(R,"doc_type",M)},style:{...Fn,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select --"}),n.map(T=>a.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),a.jsxs("div",{style:{width:"30%"},children:[R===0&&a.jsx("label",{style:{...cn,fontSize:9},children:"Scope"}),a.jsx("input",{type:"text",value:S.scope||"",onChange:T=>g(R,"scope",T.target.value),placeholder:"scope",style:{...Fn,fontSize:11}})]}),a.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[a.jsx("input",{type:"checkbox",checked:S.context||!1,onChange:T=>g(R,"context",T.target.checked||void 0)}),"ctx"]}),a.jsx("button",{onClick:()=>w(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function pU({steps:e,documentTypes:t=[],onStepChange:n,onStepDelete:r,onReorder:i}){const s=F4(kc(ju,{activationConstraint:{distance:5}}),kc(_u,{coordinateGetter:cR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):a.jsx(tR,{sensors:s,collisionDetection:B4,onDragEnd:l,children:a.jsx(oR,{items:o,strategy:rR,children:e.map((c,d)=>a.jsx(hU,{step:c,index:d,documentTypes:t,onChange:n,onDelete:r},c.step_id))})})}function hU({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=lR({id:e.step_id}),f={transform:Cs.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(fR,{step:e,index:t,documentTypes:n,onChange:r,onDelete:i,dragHandleProps:{...s,...o},depth:1})})}function mU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:n}){const[r,i]=m.useState(""),s={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},o={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,x=e.source_version,g=e.tags||[],w=()=>{const b=r.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),i(""))},v=b=>{t==null||t({...e,tags:g.filter(_=>_!==b)})},y=()=>{h!=null&&h.workflow_id&&n&&n(h.workflow_id)};return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"POW Class"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Derived From"}),a.jsx("div",{style:s,children:n?a.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):a.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),x&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Source Version"}),a.jsx("div",{style:s,children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Tags"}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>a.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&a.jsx("button",{onClick:()=>v(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:r,onChange:b=>i(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),w())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),a.jsx("button",{onClick:w,disabled:!r.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:r.trim()?"pointer":"default",opacity:r.trim()?1:.5},children:"Add"})]})]}),a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b.label}),a.jsx("div",{style:s,children:e[b.key]||"-"})]},b.key)),d.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:["parent: ",_.parent||"none"]})]},b))]}),f.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:[_.name,_.scope&&` (${_.scope})`,_.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function MS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const n=e.filter(i=>i.status==="fail"),r=e.filter(i=>i.status==="pass");return t?a.jsx("div",{className:"flex items-center gap-2",children:n.length>0?a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[n.length," error",n.length!==1?"s":""]}):a.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):a.jsxs("div",{className:"space-y-2",children:[n.map((i,s)=>a.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx("span",{className:"text-red-400",children:"FAIL"}),a.jsx("span",{className:"font-mono",children:i.rule_id})]}),i.message&&a.jsx("div",{className:"mt-1 opacity-80",children:i.message}),i.artifact_id&&a.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:i.artifact_id})]},s)),r.length>0&&n.length>0&&a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[r.length," rule",r.length!==1?"s":""," passed"]})]})}function gU(e,t){const n=(e||"").split(`
`),r=(t||"").split(`
`),i=[];let s=0,o=0;for(;s<n.length||o<r.length;)if(s>=n.length)i.push({type:"added",line:r[o],lineNum:o+1}),o++;else if(o>=r.length)i.push({type:"removed",line:n[s],lineNum:s+1}),s++;else if(n[s]===r[o])i.push({type:"same",line:n[s],oldLineNum:s+1,newLineNum:o+1}),s++,o++;else{let l=r.slice(o,o+5).indexOf(n[s]),c=n.slice(s,s+5).indexOf(r[o]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)i.push({type:"added",line:r[o+d],lineNum:o+d+1});o+=l}else if(c!==-1){for(let d=0;d<c;d++)i.push({type:"removed",line:n[s+d],lineNum:s+d+1});s+=c}else i.push({type:"removed",line:n[s],lineNum:s+1}),i.push({type:"added",line:r[o],lineNum:o+1}),s++,o++}return i}function vU({diff:e}){const[t,n]=m.useState(!0),r=gU(e.old_content,e.new_content),i={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return a.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>n(!t),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:i[e.status]||i.M,children:e.status}),a.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),a.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&a.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:a.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:r.map((s,o)=>a.jsxs("div",{className:"flex",style:{background:s.type==="added"?"rgba(34, 197, 94, 0.1)":s.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:s.type==="added"?"3px solid #22c55e":s.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[a.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:s.type==="same"?s.oldLineNum:s.lineNum||""}),a.jsx("span",{className:"select-none px-1",style:{color:s.type==="added"?"#22c55e":s.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:s.type==="added"?"+":s.type==="removed"?"-":" "}),a.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:s.line})]},o))})})]})}function xU({workspaceId:e,artifactId:t=null,onClose:n}){const[r,i]=m.useState([]),[s,o]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(o(!0),c(null),je.getDiff(e,t).then(u=>{i(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{o(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(n==null||n())};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(n==null?void 0:n()),onKeyDown:d,tabIndex:0,children:a.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),a.jsx("button",{onClick:n,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?a.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):r.length===0?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):r.map((u,f)=>a.jsx(vU,{diff:u},u.artifact_id||f))}),a.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function yU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[n,r,i,s]=t,o=r.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:n,name:r,version:i,kind:s,displayName:o,kindLabel:l,display:`${o} - ${l}`}}function bU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(n=>{const r=yU(n);t[r.scope]&&t[r.scope].items.push(r)}),Object.entries(t).filter(([n,r])=>r.items.length>0).map(([n,r])=>({scope:n,...r}))}function wU({workspaceId:e,onCommit:t,onCancel:n,loading:r=!1,modifiedArtifacts:i=[],modifiedFiles:s=[]}){const[o,l]=m.useState(""),[c,d]=m.useState(!1),u=bU(i),f=i.length,p=x=>{x.preventDefault(),o.trim()&&!r&&t(o.trim())},h=x=>{x.key==="Escape"&&!r&&n()};return a.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:x=>x.target===x.currentTarget&&!r&&n(),onKeyDown:h,children:[a.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&a.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),a.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(x=>a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:x.label}),a.jsx("div",{className:"space-y-1",children:x.items.map((g,w)=>a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),a.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),a.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),a.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},w))})]},x.scope))}),a.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),a.jsxs("form",{onSubmit:p,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),a.jsx("textarea",{value:o,onChange:x=>l(x.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:r}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:n,disabled:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!o.trim()||r,className:"px-4 py-2 rounded text-sm font-medium",style:{background:o.trim()&&!r?"var(--action-success)":"var(--border-panel)",color:o.trim()&&!r?"#000":"var(--text-muted)",cursor:o.trim()&&!r?"pointer":"not-allowed"},children:r?"Committing...":"Commit"})]})]})]}),c&&e&&a.jsx(xU,{workspaceId:e,onClose:()=>d(!1)})]})}function _U(e){const t=e.split(":");if(t.length!==4)return{display:e};const[n,r,i,s]=t,o=r.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:n,name:r,displayName:o,kind:s,kindLabel:l,version:i,display:`${o} - ${l}`}}function jU({workspaceId:e,state:t,loading:n,onCommit:r,onDiscard:i,onClose:s,onRefresh:o}){var S,R;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,x]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,w=(t==null?void 0:t.modified_artifacts)??[],v=((S=t==null?void 0:t.tier1)==null?void 0:S.passed)??!0,y=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",_=t!=null&&t.expires_at?new Date(t.expires_at):null,j=async T=>{u(!0),x(null);try{const M=await je.commit(e,T);c(!1),r==null||r(M),o==null||o()}catch(M){x(M.message)}finally{u(!1)}},k=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await je.discard(e),i==null||i(),o==null||o()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},N=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await je.closeWorkspace(e),s==null||s()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},E=T=>{if(!T)return null;const z=T-new Date;if(z<=0)return"Expired";const C=Math.floor(z/(1e3*60*60)),L=Math.floor(z%(1e3*60*60)/(1e3*60));return C>0?`${C}h ${L}m remaining`:`${L}m remaining`};return a.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:a.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),n?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),a.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),_&&a.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:E(_)})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),a.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),w.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",w.length,")"]}),a.jsx("div",{className:"space-y-1",children:w.map(T=>{const M=_U(T);return a.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[a.jsx("span",{style:{color:"var(--text-primary)"},children:M.displayName||T}),M.kindLabel&&a.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",M.kindLabel]})]},T)})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),a.jsx(MS,{results:y,compact:!0})]}),y.length>0&&!v&&a.jsx("div",{className:"mt-3",children:a.jsx(MS,{results:y})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[a.jsx("button",{onClick:()=>c(!0),disabled:!g||!v||n,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&v?"var(--action-success)":"var(--border-panel)",color:g&&v?"#000":"var(--text-muted)",cursor:g&&v&&!n?"pointer":"not-allowed",opacity:n?.5:1},children:"Commit Changes"}),!v&&g&&a.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&a.jsx("button",{onClick:k,disabled:f||n,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||n?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&a.jsx("button",{onClick:N,disabled:n,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:n?.5:1},children:"Close Workspace"})]}),l&&a.jsx(wU,{workspaceId:e,onCommit:j,onCancel:()=>{c(!1),x(null)},loading:d,modifiedArtifacts:w,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&a.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function SU(){const{isAdmin:e,loading:t}=Ds(),[n,r]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[x,g]=m.useState(null),[w,v]=m.useState(null),[y,b]=m.useState(null),[_,j]=m.useState(null),[k,N]=m.useState(!1),{workspaceId:E,loading:S,error:R,reinitialize:T}=eB(),{state:M,loading:z,refresh:C}=tB(E),{documentTypes:L,loading:P,refresh:$}=nB(),{roles:O,loading:A,refresh:F}=rB(),{templates:I,loading:q,refresh:W}=$T(),{workflows:U,loading:Z,refresh:B}=CB(),{fragments:ne,loading:se,kindOptions:ce,refresh:J}=HT(),{schemas:_e,loading:G,refresh:xe}=BT(),[fe,oe]=m.useState([]),[ve,Y]=m.useState([]),[Q,pe]=m.useState(!1),[he,we]=m.useState(null);m.useEffect(()=>{(async()=>{pe(!0);try{const[ie,He]=await Promise.all([je.getMechanicalOpTypes(),je.getMechanicalOps()]);oe(ie.types||[]),Y(He.operations||[])}catch(ie){console.error("Failed to load mechanical ops:",ie)}finally{pe(!1)}})()},[]);const ye=m.useCallback(async(ue,ie=null,He="docworkflow")=>{if(r(ue),d(null),f(null),h(null),s(null),g(null),v(null),we(null),b(ie),j(He),!!ue){l(!0);try{const Ct=await je.getDocumentType(ue.doc_type_id);s(Ct)}catch(Ct){console.error("Failed to load doc type details:",Ct),s(ue)}finally{l(!1)}}},[]),te=m.useCallback(ue=>{ye(ue,"task_prompt","task")},[ye]),me=m.useCallback(ue=>{ye(ue,"schema","schema")},[ye]),Ge=m.useCallback(ue=>{d(ue),r(null),s(null),f(null),h(null),g(null),v(null),we(null)},[]),Fe=m.useCallback(ue=>{f(ue),r(null),s(null),d(null),h(null),g(null),v(null),we(null)},[]),$e=m.useCallback(ue=>{h(ue),r(null),s(null),d(null),f(null),g(null),v(null),we(null)},[]),Te=m.useCallback(ue=>{g(ue),r(null),s(null),d(null),f(null),h(null),v(null),we(null)},[]),Be=m.useCallback(ue=>{v(ue),r(null),s(null),d(null),f(null),h(null),g(null),we(null)},[]),at=m.useCallback(ue=>{we(ue),r(null),s(null),d(null),f(null),h(null),g(null),v(null)},[]),Re=m.useCallback(ue=>{const ie=U.find(He=>He.workflow_id===ue);ie&&$e(ie)},[U,$e]),X=m.useCallback((ue,ie)=>{C()},[C]),Pe=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),ge=m.useCallback(()=>{r(null),s(null),d(null),f(null),h(null),g(null),v(null),we(null)},[]),kt=m.useCallback(async ue=>{if(E)try{const ie=await je.createOrchestrationWorkflow(E,ue);await B(),C(),h({workflow_id:ie.workflow_id,active_version:ie.version,name:ue.name||ie.workflow_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())}),r(null),s(null),d(null),f(null)}catch(ie){console.error("Failed to create workflow:",ie),alert(`Failed to create workflow: ${ie.message}`)}},[E,B,C]),xt=m.useCallback(async ue=>{if(E)try{await je.deleteOrchestrationWorkflow(E,ue),await B(),C(),h(null)}catch(ie){console.error("Failed to delete workflow:",ie),alert(`Failed to delete workflow: ${ie.message}`)}},[E,B,C]),yt=m.useCallback(async ue=>{if(E)try{const ie=await je.createDocumentType(E,ue);await $(),C(),ye({doc_type_id:ie.doc_type_id,display_name:ue.display_name||ie.doc_type_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase()),active_version:ie.version})}catch(ie){console.error("Failed to create document type:",ie),alert(`Failed to create document type: ${ie.message}`)}},[E,$,C,ye]);m.useCallback(async ue=>{if(E)try{await je.deleteDocumentType(E,ue),await $(),C(),r(null),s(null)}catch(ie){console.error("Failed to delete document type:",ie),alert(`Failed to delete document type: ${ie.message}`)}},[E,$,C]);const Qt=m.useCallback(async ue=>{if(E)try{await je.createDcwWorkflow(E,{doc_type_id:ue}),await B(),C()}catch(ie){console.error("Failed to create DCW workflow:",ie),alert(`Failed to create workflow: ${ie.message}`)}},[E,B,C]),D=m.useCallback(async ue=>{if(E)try{const ie=await je.createRolePrompt(E,ue);await J(),await F(),C(),Te({fragment_id:`role:${ie.role_id}`,kind:"role",version:ie.version,name:ue.name||ie.role_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(ie){console.error("Failed to create role prompt:",ie),alert(`Failed to create role prompt: ${ie.message}`)}},[E,J,F,C,Te]),H=m.useCallback(async ue=>{if(E)try{const ie=await je.createTemplate(E,ue);await W(),C(),Fe({template_id:ie.template_id,active_version:ie.version,name:ue.name||ie.template_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(ie){console.error("Failed to create template:",ie),alert(`Failed to create template: ${ie.message}`)}},[E,W,C,Fe]),K=m.useCallback(async ue=>{if(E)try{const ie=await je.createStandaloneSchema(E,ue);await xe(),C(),Be({schema_id:ie.schema_id,active_version:ie.version,title:ue.title||ie.schema_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(ie){console.error("Failed to create schema:",ie),alert(`Failed to create schema: ${ie.message}`)}},[E,xe,C,Be]),re=m.useCallback(()=>{T(),r(null),s(null),d(null),f(null),h(null),g(null),v(null),we(null)},[T]);if(t)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(S)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(R)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),a.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:R}),a.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const Oe=c&&!n&&!u&&!p&&!x&&!w&&!he,lt=u&&!n&&!c&&!p&&!x&&!w&&!he,ln=p&&!n&&!c&&!u&&!x&&!w&&!he,Nt=x&&!n&&!c&&!u&&!p&&!w&&!he,bt=w&&!n&&!c&&!u&&!p&&!x&&!he,qt=he&&!n&&!c&&!u&&!p&&!x&&!w;return a.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"}),a.jsxs("button",{onClick:()=>N(!k),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:k?"var(--action-primary)":"var(--bg-panel)",color:k?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[a.jsx("span",{style:{fontSize:14},children:""}),a.jsx("span",{children:"Building Blocks"})]})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(EB,{documentTypes:L,roles:O,templates:I,workflows:U,promptFragments:ne,promptFragmentKindOptions:ce,schemas:_e,loading:P,rolesLoading:A,templatesLoading:q,workflowsLoading:Z,promptFragmentsLoading:se,schemasLoading:G,selectedDocType:n,docTypeSource:_,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:x,selectedSchema:w,onSelectDocType:ye,onSelectRole:Ge,onSelectTemplate:Fe,onSelectWorkflow:$e,onSelectFragment:Te,onSelectStandaloneSchema:Be,onCreateWorkflow:kt,onCreateDocType:yt,onCreateFragment:D,onCreateTemplate:H,onCreateSchema:K,onSelectTask:te,onSelectSchema:me,workspaceState:M}),Oe?a.jsx(t9,{workspaceId:E,role:c,onArtifactSave:X}):lt?a.jsx(_7,{workspaceId:E,template:u,onArtifactSave:X}):Nt?a.jsx(N7,{workspaceId:E,fragment:x,onArtifactSave:X}):ln?a.jsx(uU,{workspaceId:E,workflow:p,documentTypes:L,onArtifactSave:X,onDelete:xt,onNavigateToWorkflow:Re}):bt?a.jsx(j7,{workspaceId:E,schema:w,onArtifactSave:X}):qt?a.jsx(C7,{mechanicalOp:he,mechanicalOpTypes:fe}):a.jsx(e9,{workspaceId:E,docType:i,loading:o,roles:O,workflows:U,onArtifactSave:X,onCreateDcwWorkflow:Qt,initialTab:y,docTypeSource:_,mechanicalOpTypes:fe,mechanicalOps:ve}),a.jsx(jU,{workspaceId:E,state:M,loading:z,onCommit:Pe,onDiscard:ge,onClose:re,onRefresh:C})]}),a.jsx(RB,{isOpen:k,onClose:()=>N(!1),promptFragments:ne,promptFragmentKindOptions:ce,templates:I,schemas:_e,documentTypes:L,promptFragmentsLoading:se,templatesLoading:q,schemasLoading:G,onSelectFragment:Te,onSelectTemplate:Fe,onSelectSchema:me,onSelectStandaloneSchema:Be,onCreateFragment:D,onCreateTemplate:H,onCreateSchema:K,mechanicalOpTypes:fe,mechanicalOps:ve,mechanicalOpsLoading:Q,onSelectMechanicalOp:at})]})}function kU({user:e,onClick:t}){return a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function NU(){var T,M,z;const{user:e}=Ds(),[t,n]=m.useState(!1),{projects:r,loading:i,error:s,refresh:o}=X$({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,x]=m.useState(!1),{theme:g,setTheme:w}=zT(),v=Object.keys(r),y=l&&r[l]?l:v[0]||null;m.useEffect(()=>{if(y&&r[y]){const C=r[y];document.title=`${C.projectId} - The Combine`}else document.title="The Combine"},[y,r]);const b=C=>{c(C),u(null)},_=()=>{p(!0)},j=async C=>{await o(),C&&C.id&&(c(C.id),u("concierge_intake")),p(!1)},k=()=>{p(!1)},N=async(C,L)=>{try{await Ye.updateProject(C,L),await o()}catch(P){throw console.error("Failed to update project:",P),P}},E=async C=>{try{if(await Ye.archiveProject(C),!t){const L=Object.values(r).sort((O,A)=>{const F=(O.name||"").localeCompare(A.name||"");return F!==0?F:(O.projectId||"").localeCompare(A.projectId||"")}),P=L.findIndex(O=>O.id===C),$=L[P+1]||L[P-1]||null;c(($==null?void 0:$.id)||null)}await o()}catch(L){throw console.error("Failed to archive project:",L),L}},S=async C=>{try{await Ye.unarchiveProject(C),await o()}catch(L){throw console.error("Failed to unarchive project:",L),L}},R=async C=>{try{await Ye.deleteProject(C);const L=Object.values(r).sort((O,A)=>{const F=(O.name||"").localeCompare(A.name||"");return F!==0?F:(O.projectId||"").localeCompare(A.projectId||"")}),P=L.findIndex(O=>O.id===C),$=L[P+1]||L[P-1]||null;c(($==null?void 0:$.id)||null),await o()}catch(L){throw console.error("Failed to delete project:",L),L}};return i?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):s?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[a.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",s]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):a.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[a.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),a.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),a.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("path",{d:"M12 17h.01"})]})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(o6,{projects:r,selectedId:y,onSelectProject:b,onNewProject:_,showArchived:t,onToggleShowArchived:()=>n(C=>!C),userSection:a.jsx(kU,{user:e,onClick:()=>x(!0)})}),a.jsx("div",{className:"flex-1",children:y?a.jsx(Jc,{children:a.jsx(oB,{projectId:y,projectCode:(T=r[y])==null?void 0:T.projectId,projectName:(M=r[y])==null?void 0:M.name,isArchived:(z=r[y])==null?void 0:z.isArchived,autoExpandNodeId:d,theme:g,onThemeChange:w,onProjectUpdate:N,onProjectArchive:E,onProjectUnarchive:S,onProjectDelete:R})},y):a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center",children:a.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&a.jsx(hB,{onClose:k,onComplete:j}),h&&a.jsx(mB,{onClose:()=>x(!1)})]})]})}function CU(){const{isAuthenticated:e,loading:t}=Ds(),{theme:n}=zT(),[r,i]=m.useState(window.location.pathname);return m.useEffect(()=>{const s=()=>i(window.location.pathname);return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]),t?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${n}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?r==="/admin/workbench"?a.jsx("div",{className:`h-screen theme-${n}`,children:a.jsx(SU,{})}):a.jsx(NU,{}):r==="/learn"?a.jsx(NB,{}):a.jsx(_B,{})}function EU(){return a.jsx(J$,{children:a.jsx(CU,{})})}_g.createRoot(document.getElementById("root")).render(a.jsx(V.StrictMode,{children:a.jsx(EU,{})}));
//# sourceMappingURL=index-BZvnnG3s.js.map
