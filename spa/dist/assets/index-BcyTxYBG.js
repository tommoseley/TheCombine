(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var Pa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var YS={exports:{}},Dc={},XS={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ma=Symbol.for("react.element"),GT=Symbol.for("react.portal"),KT=Symbol.for("react.fragment"),YT=Symbol.for("react.strict_mode"),XT=Symbol.for("react.profiler"),QT=Symbol.for("react.provider"),ZT=Symbol.for("react.context"),JT=Symbol.for("react.forward_ref"),e5=Symbol.for("react.suspense"),t5=Symbol.for("react.memo"),r5=Symbol.for("react.lazy"),Qy=Symbol.iterator;function n5(e){return e===null||typeof e!="object"?null:(e=Qy&&e[Qy]||e["@@iterator"],typeof e=="function"?e:null)}var QS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ZS=Object.assign,JS={};function Io(e,t,r){this.props=e,this.context=t,this.refs=JS,this.updater=r||QS}Io.prototype.isReactComponent={};Io.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Io.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ek(){}ek.prototype=Io.prototype;function sv(e,t,r){this.props=e,this.context=t,this.refs=JS,this.updater=r||QS}var ov=sv.prototype=new ek;ov.constructor=sv;ZS(ov,Io.prototype);ov.isPureReactComponent=!0;var Zy=Array.isArray,tk=Object.prototype.hasOwnProperty,iv={current:null},rk={key:!0,ref:!0,__self:!0,__source:!0};function nk(e,t,r){var n,s={},o=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)tk.call(t,n)&&!rk.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:ma,type:e,key:o,ref:a,props:s,_owner:iv.current}}function s5(e,t){return{$$typeof:ma,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function av(e){return typeof e=="object"&&e!==null&&e.$$typeof===ma}function o5(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Jy=/\/+/g;function Du(e,t){return typeof e=="object"&&e!==null&&e.key!=null?o5(""+e.key):t.toString(36)}function bl(e,t,r,n,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ma:case GT:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+Du(a,0):n,Zy(s)?(r="",e!=null&&(r=e.replace(Jy,"$&/")+"/"),bl(s,t,r,"",function(d){return d})):s!=null&&(av(s)&&(s=s5(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Jy,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",Zy(e))for(var l=0;l<e.length;l++){o=e[l];var c=n+Du(o,l);a+=bl(o,t,r,c,s)}else if(c=n5(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=n+Du(o,l++),a+=bl(o,t,r,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Oa(e,t,r){if(e==null)return e;var n=[],s=0;return bl(e,n,"","",function(o){return t.call(r,o,s++)}),n}function i5(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $t={current:null},_l={transition:null},a5={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:_l,ReactCurrentOwner:iv};function sk(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:Oa,forEach:function(e,t,r){Oa(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Oa(e,function(){t++}),t},toArray:function(e){return Oa(e,function(t){return t})||[]},only:function(e){if(!av(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ie.Component=Io;Ie.Fragment=KT;Ie.Profiler=XT;Ie.PureComponent=sv;Ie.StrictMode=YT;Ie.Suspense=e5;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a5;Ie.act=sk;Ie.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=ZS({},e.props),s=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=iv.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)tk.call(t,c)&&!rk.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:ma,type:e.type,key:s,ref:o,props:n,_owner:a}};Ie.createContext=function(e){return e={$$typeof:ZT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:QT,_context:e},e.Consumer=e};Ie.createElement=nk;Ie.createFactory=function(e){var t=nk.bind(null,e);return t.type=e,t};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(e){return{$$typeof:JT,render:e}};Ie.isValidElement=av;Ie.lazy=function(e){return{$$typeof:r5,_payload:{_status:-1,_result:e},_init:i5}};Ie.memo=function(e,t){return{$$typeof:t5,type:e,compare:t===void 0?null:t}};Ie.startTransition=function(e){var t=_l.transition;_l.transition={};try{e()}finally{_l.transition=t}};Ie.unstable_act=sk;Ie.useCallback=function(e,t){return $t.current.useCallback(e,t)};Ie.useContext=function(e){return $t.current.useContext(e)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(e){return $t.current.useDeferredValue(e)};Ie.useEffect=function(e,t){return $t.current.useEffect(e,t)};Ie.useId=function(){return $t.current.useId()};Ie.useImperativeHandle=function(e,t,r){return $t.current.useImperativeHandle(e,t,r)};Ie.useInsertionEffect=function(e,t){return $t.current.useInsertionEffect(e,t)};Ie.useLayoutEffect=function(e,t){return $t.current.useLayoutEffect(e,t)};Ie.useMemo=function(e,t){return $t.current.useMemo(e,t)};Ie.useReducer=function(e,t,r){return $t.current.useReducer(e,t,r)};Ie.useRef=function(e){return $t.current.useRef(e)};Ie.useState=function(e){return $t.current.useState(e)};Ie.useSyncExternalStore=function(e,t,r){return $t.current.useSyncExternalStore(e,t,r)};Ie.useTransition=function(){return $t.current.useTransition()};Ie.version="18.3.1";XS.exports=Ie;var m=XS.exports;const Y=nv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l5=m,c5=Symbol.for("react.element"),u5=Symbol.for("react.fragment"),d5=Object.prototype.hasOwnProperty,f5=l5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p5={key:!0,ref:!0,__self:!0,__source:!0};function ok(e,t,r){var n,s={},o=null,a=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)d5.call(t,n)&&!p5.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:c5,type:e,key:o,ref:a,props:s,_owner:f5.current}}Dc.Fragment=u5;Dc.jsx=ok;Dc.jsxs=ok;YS.exports=Dc;var i=YS.exports,Mx={},ik={exports:{}},ir={},ak={exports:{}},lk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(L,I){var M=L.length;L.push(I);e:for(;0<M;){var F=M-1>>>1,q=L[F];if(0<s(q,I))L[F]=I,L[M]=q,M=F;else break e}}function r(L){return L.length===0?null:L[0]}function n(L){if(L.length===0)return null;var I=L[0],M=L.pop();if(M!==I){L[0]=M;e:for(var F=0,q=L.length,H=q>>>1;F<H;){var V=2*(F+1)-1,Z=L[V],B=V+1,re=L[B];if(0>s(Z,M))B<q&&0>s(re,Z)?(L[F]=re,L[B]=M,F=B):(L[F]=Z,L[V]=M,F=V);else if(B<q&&0>s(re,M))L[F]=re,L[B]=M,F=B;else break e}}return I}function s(L,I){var M=L.sortIndex-I.sortIndex;return M!==0?M:L.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,g=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(L){for(var I=r(d);I!==null;){if(I.callback===null)n(d);else if(I.startTime<=L)n(d),I.sortIndex=I.expirationTime,t(c,I);else break;I=r(d)}}function j(L){if(x=!1,b(L),!g)if(r(c)!==null)g=!0,R(N);else{var I=r(d);I!==null&&D(j,I.startTime-L)}}function N(L,I){g=!1,x&&(x=!1,v(S),S=-1),h=!0;var M=p;try{for(b(I),f=r(c);f!==null&&(!(f.expirationTime>I)||L&&!E());){var F=f.callback;if(typeof F=="function"){f.callback=null,p=f.priorityLevel;var q=F(f.expirationTime<=I);I=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(I)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var V=r(d);V!==null&&D(j,V.startTime-I),H=!1}return H}finally{f=null,p=M,h=!1}}var T=!1,C=null,S=-1,w=5,A=-1;function E(){return!(e.unstable_now()-A<w)}function O(){if(C!==null){var L=e.unstable_now();A=L;var I=!0;try{I=C(!0,L)}finally{I?z():(T=!1,C=null)}}else T=!1}var z;if(typeof y=="function")z=function(){y(O)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,P=k.port2;k.port1.onmessage=O,z=function(){P.postMessage(null)}}else z=function(){_(O,0)};function R(L){C=L,T||(T=!0,z())}function D(L,I){S=_(function(){L(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){g||h||(g=!0,R(N))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(L){switch(p){case 1:case 2:case 3:var I=3;break;default:I=p}var M=p;p=I;try{return L()}finally{p=M}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,I){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var M=p;p=L;try{return I()}finally{p=M}},e.unstable_scheduleCallback=function(L,I,M){var F=e.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?F+M:F):M=F,L){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=M+q,L={id:u++,callback:I,priorityLevel:L,startTime:M,expirationTime:q,sortIndex:-1},M>F?(L.sortIndex=M,t(d,L),r(c)===null&&L===r(d)&&(x?(v(S),S=-1):x=!0,D(j,M-F))):(L.sortIndex=q,t(c,L),g||h||(g=!0,R(N))),L},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(L){var I=p;return function(){var M=p;p=I;try{return L.apply(this,arguments)}finally{p=M}}}})(lk);ak.exports=lk;var h5=ak.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m5=m,sr=h5;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ck=new Set,Di={};function Es(e,t){yo(e,t),yo(e+"Capture",t)}function yo(e,t){for(Di[e]=t,e=0;e<t.length;e++)ck.add(t[e])}var dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dx=Object.prototype.hasOwnProperty,x5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,e0={},t0={};function g5(e){return Dx.call(t0,e)?!0:Dx.call(e0,e)?!1:x5.test(e)?t0[e]=!0:(e0[e]=!0,!1)}function v5(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function y5(e,t,r,n){if(t===null||typeof t>"u"||v5(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qt(e,t,r,n,s,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Et[e]=new qt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Et[t]=new qt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Et[e]=new qt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Et[e]=new qt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Et[e]=new qt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Et[e]=new qt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Et[e]=new qt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Et[e]=new qt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Et[e]=new qt(e,5,!1,e.toLowerCase(),null,!1,!1)});var lv=/[\-:]([a-z])/g;function cv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(lv,cv);Et[t]=new qt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(lv,cv);Et[t]=new qt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(lv,cv);Et[t]=new qt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Et[e]=new qt(e,1,!1,e.toLowerCase(),null,!1,!1)});Et.xlinkHref=new qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Et[e]=new qt(e,1,!1,e.toLowerCase(),null,!0,!0)});function uv(e,t,r,n){var s=Et.hasOwnProperty(t)?Et[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(y5(t,r,s,n)&&(r=null),n||s===null?g5(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var yn=m5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ma=Symbol.for("react.element"),Vs=Symbol.for("react.portal"),Gs=Symbol.for("react.fragment"),dv=Symbol.for("react.strict_mode"),Lx=Symbol.for("react.profiler"),uk=Symbol.for("react.provider"),dk=Symbol.for("react.context"),fv=Symbol.for("react.forward_ref"),zx=Symbol.for("react.suspense"),Fx=Symbol.for("react.suspense_list"),pv=Symbol.for("react.memo"),kn=Symbol.for("react.lazy"),fk=Symbol.for("react.offscreen"),r0=Symbol.iterator;function Uo(e){return e===null||typeof e!="object"?null:(e=r0&&e[r0]||e["@@iterator"],typeof e=="function"?e:null)}var nt=Object.assign,Lu;function di(e){if(Lu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Lu=t&&t[1]||""}return`
`+Lu+e}var zu=!1;function Fu(e,t){if(!e||zu)return"";zu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=n.stack.split(`
`),a=s.length-1,l=o.length-1;1<=a&&0<=l&&s[a]!==o[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==o[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==o[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{zu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?di(e):""}function b5(e){switch(e.tag){case 5:return di(e.type);case 16:return di("Lazy");case 13:return di("Suspense");case 19:return di("SuspenseList");case 0:case 2:case 15:return e=Fu(e.type,!1),e;case 11:return e=Fu(e.type.render,!1),e;case 1:return e=Fu(e.type,!0),e;default:return""}}function $x(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Gs:return"Fragment";case Vs:return"Portal";case Lx:return"Profiler";case dv:return"StrictMode";case zx:return"Suspense";case Fx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dk:return(e.displayName||"Context")+".Consumer";case uk:return(e._context.displayName||"Context")+".Provider";case fv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case pv:return t=e.displayName||null,t!==null?t:$x(e.type)||"Memo";case kn:t=e._payload,e=e._init;try{return $x(e(t))}catch{}}return null}function _5(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $x(t);case 8:return t===dv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Yn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function w5(e){var t=pk(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Da(e){e._valueTracker||(e._valueTracker=w5(e))}function hk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=pk(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ll(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function qx(e,t){var r=t.checked;return nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function n0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Yn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mk(e,t){t=t.checked,t!=null&&uv(e,"checked",t,!1)}function Bx(e,t){mk(e,t);var r=Yn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wx(e,t.type,r):t.hasOwnProperty("defaultValue")&&Wx(e,t.type,Yn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function s0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Wx(e,t,r){(t!=="number"||Ll(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var fi=Array.isArray;function lo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Yn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Hx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function o0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(J(92));if(fi(r)){if(1<r.length)throw Error(J(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Yn(r)}}function xk(e,t){var r=Yn(t.value),n=Yn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function i0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ux(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var La,vk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(La=La||document.createElement("div"),La.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=La.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Li(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Si={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},j5=["Webkit","ms","Moz","O"];Object.keys(Si).forEach(function(e){j5.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Si[t]=Si[e]})});function yk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Si.hasOwnProperty(e)&&Si[e]?(""+t).trim():t+"px"}function bk(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=yk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var S5=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vx(e,t){if(t){if(S5[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function Gx(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kx=null;function hv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Yx=null,co=null,uo=null;function a0(e){if(e=va(e)){if(typeof Yx!="function")throw Error(J(280));var t=e.stateNode;t&&(t=qc(t),Yx(e.stateNode,e.type,t))}}function _k(e){co?uo?uo.push(e):uo=[e]:co=e}function wk(){if(co){var e=co,t=uo;if(uo=co=null,a0(e),t)for(e=0;e<t.length;e++)a0(t[e])}}function jk(e,t){return e(t)}function Sk(){}var $u=!1;function kk(e,t,r){if($u)return e(t,r);$u=!0;try{return jk(e,t,r)}finally{$u=!1,(co!==null||uo!==null)&&(Sk(),wk())}}function zi(e,t){var r=e.stateNode;if(r===null)return null;var n=qc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(J(231,t,typeof r));return r}var Xx=!1;if(dn)try{var Vo={};Object.defineProperty(Vo,"passive",{get:function(){Xx=!0}}),window.addEventListener("test",Vo,Vo),window.removeEventListener("test",Vo,Vo)}catch{Xx=!1}function k5(e,t,r,n,s,o,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var ki=!1,zl=null,Fl=!1,Qx=null,N5={onError:function(e){ki=!0,zl=e}};function C5(e,t,r,n,s,o,a,l,c){ki=!1,zl=null,k5.apply(N5,arguments)}function E5(e,t,r,n,s,o,a,l,c){if(C5.apply(this,arguments),ki){if(ki){var d=zl;ki=!1,zl=null}else throw Error(J(198));Fl||(Fl=!0,Qx=d)}}function Ts(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Nk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function l0(e){if(Ts(e)!==e)throw Error(J(188))}function T5(e){var t=e.alternate;if(!t){if(t=Ts(e),t===null)throw Error(J(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return l0(s),e;if(o===n)return l0(s),t;o=o.sibling}throw Error(J(188))}if(r.return!==n.return)r=s,n=o;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=o;break}if(l===n){a=!0,n=s,r=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===r){a=!0,r=o,n=s;break}if(l===n){a=!0,n=o,r=s;break}l=l.sibling}if(!a)throw Error(J(189))}}if(r.alternate!==n)throw Error(J(190))}if(r.tag!==3)throw Error(J(188));return r.stateNode.current===r?e:t}function Ck(e){return e=T5(e),e!==null?Ek(e):null}function Ek(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ek(e);if(t!==null)return t;e=e.sibling}return null}var Tk=sr.unstable_scheduleCallback,c0=sr.unstable_cancelCallback,R5=sr.unstable_shouldYield,A5=sr.unstable_requestPaint,lt=sr.unstable_now,I5=sr.unstable_getCurrentPriorityLevel,mv=sr.unstable_ImmediatePriority,Rk=sr.unstable_UserBlockingPriority,$l=sr.unstable_NormalPriority,P5=sr.unstable_LowPriority,Ak=sr.unstable_IdlePriority,Lc=null,Hr=null;function O5(e){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(Lc,e,void 0,(e.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:L5,M5=Math.log,D5=Math.LN2;function L5(e){return e>>>=0,e===0?32:31-(M5(e)/D5|0)|0}var za=64,Fa=4194304;function pi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ql(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,o=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=pi(l):(o&=a,o!==0&&(n=pi(o)))}else a=r&~s,a!==0?n=pi(a):o!==0&&(n=pi(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Rr(t),s=1<<r,n|=e[r],t&=~s;return n}function z5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F5(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Rr(o),l=1<<a,c=s[a];c===-1?(!(l&r)||l&n)&&(s[a]=z5(l,t)):c<=t&&(e.expiredLanes|=l),o&=~l}}function Zx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ik(){var e=za;return za<<=1,!(za&4194240)&&(za=64),e}function qu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xa(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Rr(t),e[t]=r}function $5(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Rr(r),o=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~o}}function xv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Rr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Ue=0;function Pk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ok,gv,Mk,Dk,Lk,Jx=!1,$a=[],Ln=null,zn=null,Fn=null,Fi=new Map,$i=new Map,Rn=[],q5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function u0(e,t){switch(e){case"focusin":case"focusout":Ln=null;break;case"dragenter":case"dragleave":zn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Fi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$i.delete(t.pointerId)}}function Go(e,t,r,n,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},t!==null&&(t=va(t),t!==null&&gv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function B5(e,t,r,n,s){switch(t){case"focusin":return Ln=Go(Ln,e,t,r,n,s),!0;case"dragenter":return zn=Go(zn,e,t,r,n,s),!0;case"mouseover":return Fn=Go(Fn,e,t,r,n,s),!0;case"pointerover":var o=s.pointerId;return Fi.set(o,Go(Fi.get(o)||null,e,t,r,n,s)),!0;case"gotpointercapture":return o=s.pointerId,$i.set(o,Go($i.get(o)||null,e,t,r,n,s)),!0}return!1}function zk(e){var t=us(e.target);if(t!==null){var r=Ts(t);if(r!==null){if(t=r.tag,t===13){if(t=Nk(r),t!==null){e.blockedOn=t,Lk(e.priority,function(){Mk(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function wl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=eg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Kx=n,r.target.dispatchEvent(n),Kx=null}else return t=va(r),t!==null&&gv(t),e.blockedOn=r,!1;t.shift()}return!0}function d0(e,t,r){wl(e)&&r.delete(t)}function W5(){Jx=!1,Ln!==null&&wl(Ln)&&(Ln=null),zn!==null&&wl(zn)&&(zn=null),Fn!==null&&wl(Fn)&&(Fn=null),Fi.forEach(d0),$i.forEach(d0)}function Ko(e,t){e.blockedOn===t&&(e.blockedOn=null,Jx||(Jx=!0,sr.unstable_scheduleCallback(sr.unstable_NormalPriority,W5)))}function qi(e){function t(s){return Ko(s,e)}if(0<$a.length){Ko($a[0],e);for(var r=1;r<$a.length;r++){var n=$a[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ln!==null&&Ko(Ln,e),zn!==null&&Ko(zn,e),Fn!==null&&Ko(Fn,e),Fi.forEach(t),$i.forEach(t),r=0;r<Rn.length;r++)n=Rn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Rn.length&&(r=Rn[0],r.blockedOn===null);)zk(r),r.blockedOn===null&&Rn.shift()}var fo=yn.ReactCurrentBatchConfig,Bl=!0;function H5(e,t,r,n){var s=Ue,o=fo.transition;fo.transition=null;try{Ue=1,vv(e,t,r,n)}finally{Ue=s,fo.transition=o}}function U5(e,t,r,n){var s=Ue,o=fo.transition;fo.transition=null;try{Ue=4,vv(e,t,r,n)}finally{Ue=s,fo.transition=o}}function vv(e,t,r,n){if(Bl){var s=eg(e,t,r,n);if(s===null)Qu(e,t,n,Wl,r),u0(e,n);else if(B5(s,e,t,r,n))n.stopPropagation();else if(u0(e,n),t&4&&-1<q5.indexOf(e)){for(;s!==null;){var o=va(s);if(o!==null&&Ok(o),o=eg(e,t,r,n),o===null&&Qu(e,t,n,Wl,r),o===s)break;s=o}s!==null&&n.stopPropagation()}else Qu(e,t,n,null,r)}}var Wl=null;function eg(e,t,r,n){if(Wl=null,e=hv(n),e=us(e),e!==null)if(t=Ts(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Nk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wl=e,null}function Fk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(I5()){case mv:return 1;case Rk:return 4;case $l:case P5:return 16;case Ak:return 536870912;default:return 16}default:return 16}}var Mn=null,yv=null,jl=null;function $k(){if(jl)return jl;var e,t=yv,r=t.length,n,s="value"in Mn?Mn.value:Mn.textContent,o=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[o-n];n++);return jl=s.slice(e,1<n?1-n:void 0)}function Sl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function qa(){return!0}function f0(){return!1}function ar(e){function t(r,n,s,o,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?qa:f0,this.isPropagationStopped=f0,this}return nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qa)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qa)},persist:function(){},isPersistent:qa}),t}var Po={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bv=ar(Po),ga=nt({},Po,{view:0,detail:0}),V5=ar(ga),Bu,Wu,Yo,zc=nt({},ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_v,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yo&&(Yo&&e.type==="mousemove"?(Bu=e.screenX-Yo.screenX,Wu=e.screenY-Yo.screenY):Wu=Bu=0,Yo=e),Bu)},movementY:function(e){return"movementY"in e?e.movementY:Wu}}),p0=ar(zc),G5=nt({},zc,{dataTransfer:0}),K5=ar(G5),Y5=nt({},ga,{relatedTarget:0}),Hu=ar(Y5),X5=nt({},Po,{animationName:0,elapsedTime:0,pseudoElement:0}),Q5=ar(X5),Z5=nt({},Po,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),J5=ar(Z5),eR=nt({},Po,{data:0}),h0=ar(eR),tR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sR(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=nR[e])?!!t[e]:!1}function _v(){return sR}var oR=nt({},ga,{key:function(e){if(e.key){var t=tR[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Sl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?rR[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_v,charCode:function(e){return e.type==="keypress"?Sl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Sl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iR=ar(oR),aR=nt({},zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),m0=ar(aR),lR=nt({},ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_v}),cR=ar(lR),uR=nt({},Po,{propertyName:0,elapsedTime:0,pseudoElement:0}),dR=ar(uR),fR=nt({},zc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),pR=ar(fR),hR=[9,13,27,32],wv=dn&&"CompositionEvent"in window,Ni=null;dn&&"documentMode"in document&&(Ni=document.documentMode);var mR=dn&&"TextEvent"in window&&!Ni,qk=dn&&(!wv||Ni&&8<Ni&&11>=Ni),x0=" ",g0=!1;function Bk(e,t){switch(e){case"keyup":return hR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ks=!1;function xR(e,t){switch(e){case"compositionend":return Wk(t);case"keypress":return t.which!==32?null:(g0=!0,x0);case"textInput":return e=t.data,e===x0&&g0?null:e;default:return null}}function gR(e,t){if(Ks)return e==="compositionend"||!wv&&Bk(e,t)?(e=$k(),jl=yv=Mn=null,Ks=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qk&&t.locale!=="ko"?null:t.data;default:return null}}var vR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function v0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!vR[e.type]:t==="textarea"}function Hk(e,t,r,n){_k(n),t=Hl(t,"onChange"),0<t.length&&(r=new bv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ci=null,Bi=null;function yR(e){tN(e,0)}function Fc(e){var t=Qs(e);if(hk(t))return e}function bR(e,t){if(e==="change")return t}var Uk=!1;if(dn){var Uu;if(dn){var Vu="oninput"in document;if(!Vu){var y0=document.createElement("div");y0.setAttribute("oninput","return;"),Vu=typeof y0.oninput=="function"}Uu=Vu}else Uu=!1;Uk=Uu&&(!document.documentMode||9<document.documentMode)}function b0(){Ci&&(Ci.detachEvent("onpropertychange",Vk),Bi=Ci=null)}function Vk(e){if(e.propertyName==="value"&&Fc(Bi)){var t=[];Hk(t,Bi,e,hv(e)),kk(yR,t)}}function _R(e,t,r){e==="focusin"?(b0(),Ci=t,Bi=r,Ci.attachEvent("onpropertychange",Vk)):e==="focusout"&&b0()}function wR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Fc(Bi)}function jR(e,t){if(e==="click")return Fc(t)}function SR(e,t){if(e==="input"||e==="change")return Fc(t)}function kR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ir=typeof Object.is=="function"?Object.is:kR;function Wi(e,t){if(Ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Dx.call(t,s)||!Ir(e[s],t[s]))return!1}return!0}function _0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function w0(e,t){var r=_0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_0(r)}}function Gk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Gk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Kk(){for(var e=window,t=Ll();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ll(e.document)}return t}function jv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function NR(e){var t=Kk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Gk(r.ownerDocument.documentElement,r)){if(n!==null&&jv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,o=Math.min(n.start,s);n=n.end===void 0?o:Math.min(n.end,s),!e.extend&&o>n&&(s=n,n=o,o=s),s=w0(r,o);var a=w0(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var CR=dn&&"documentMode"in document&&11>=document.documentMode,Ys=null,tg=null,Ei=null,rg=!1;function j0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;rg||Ys==null||Ys!==Ll(n)||(n=Ys,"selectionStart"in n&&jv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ei&&Wi(Ei,n)||(Ei=n,n=Hl(tg,"onSelect"),0<n.length&&(t=new bv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ys)))}function Ba(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Xs={animationend:Ba("Animation","AnimationEnd"),animationiteration:Ba("Animation","AnimationIteration"),animationstart:Ba("Animation","AnimationStart"),transitionend:Ba("Transition","TransitionEnd")},Gu={},Yk={};dn&&(Yk=document.createElement("div").style,"AnimationEvent"in window||(delete Xs.animationend.animation,delete Xs.animationiteration.animation,delete Xs.animationstart.animation),"TransitionEvent"in window||delete Xs.transitionend.transition);function $c(e){if(Gu[e])return Gu[e];if(!Xs[e])return e;var t=Xs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Yk)return Gu[e]=t[r];return e}var Xk=$c("animationend"),Qk=$c("animationiteration"),Zk=$c("animationstart"),Jk=$c("transitionend"),eN=new Map,S0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jn(e,t){eN.set(e,t),Es(t,[e])}for(var Ku=0;Ku<S0.length;Ku++){var Yu=S0[Ku],ER=Yu.toLowerCase(),TR=Yu[0].toUpperCase()+Yu.slice(1);Jn(ER,"on"+TR)}Jn(Xk,"onAnimationEnd");Jn(Qk,"onAnimationIteration");Jn(Zk,"onAnimationStart");Jn("dblclick","onDoubleClick");Jn("focusin","onFocus");Jn("focusout","onBlur");Jn(Jk,"onTransitionEnd");yo("onMouseEnter",["mouseout","mouseover"]);yo("onMouseLeave",["mouseout","mouseover"]);yo("onPointerEnter",["pointerout","pointerover"]);yo("onPointerLeave",["pointerout","pointerover"]);Es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Es("onBeforeInput",["compositionend","keypress","textInput","paste"]);Es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RR=new Set("cancel close invalid load scroll toggle".split(" ").concat(hi));function k0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,E5(n,t,void 0,e),e.currentTarget=null}function tN(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;k0(s,l,d),o=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;k0(s,l,d),o=c}}}if(Fl)throw e=Qx,Fl=!1,Qx=null,e}function Xe(e,t){var r=t[ag];r===void 0&&(r=t[ag]=new Set);var n=e+"__bubble";r.has(n)||(rN(t,e,2,!1),r.add(n))}function Xu(e,t,r){var n=0;t&&(n|=4),rN(r,e,n,t)}var Wa="_reactListening"+Math.random().toString(36).slice(2);function Hi(e){if(!e[Wa]){e[Wa]=!0,ck.forEach(function(r){r!=="selectionchange"&&(RR.has(r)||Xu(r,!1,e),Xu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Wa]||(t[Wa]=!0,Xu("selectionchange",!1,t))}}function rN(e,t,r,n){switch(Fk(t)){case 1:var s=H5;break;case 4:s=U5;break;default:s=vv}r=s.bind(null,t,r,e),s=void 0,!Xx||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Qu(e,t,r,n,s){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=us(l),a===null)return;if(c=a.tag,c===5||c===6){n=o=a;continue e}l=l.parentNode}}n=n.return}kk(function(){var d=o,u=hv(r),f=[];e:{var p=eN.get(e);if(p!==void 0){var h=bv,g=e;switch(e){case"keypress":if(Sl(r)===0)break e;case"keydown":case"keyup":h=iR;break;case"focusin":g="focus",h=Hu;break;case"focusout":g="blur",h=Hu;break;case"beforeblur":case"afterblur":h=Hu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=p0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=K5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=cR;break;case Xk:case Qk:case Zk:h=Q5;break;case Jk:h=dR;break;case"scroll":h=V5;break;case"wheel":h=pR;break;case"copy":case"cut":case"paste":h=J5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=m0}var x=(t&4)!==0,_=!x&&e==="scroll",v=x?p!==null?p+"Capture":null:p;x=[];for(var y=d,b;y!==null;){b=y;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,v!==null&&(j=zi(y,v),j!=null&&x.push(Ui(y,j,b)))),_)break;y=y.return}0<x.length&&(p=new h(p,g,null,r,u),f.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Kx&&(g=r.relatedTarget||r.fromElement)&&(us(g)||g[fn]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(g=r.relatedTarget||r.toElement,h=d,g=g?us(g):null,g!==null&&(_=Ts(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(h=null,g=d),h!==g)){if(x=p0,j="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(x=m0,j="onPointerLeave",v="onPointerEnter",y="pointer"),_=h==null?p:Qs(h),b=g==null?p:Qs(g),p=new x(j,y+"leave",h,r,u),p.target=_,p.relatedTarget=b,j=null,us(u)===d&&(x=new x(v,y+"enter",g,r,u),x.target=b,x.relatedTarget=_,j=x),_=j,h&&g)t:{for(x=h,v=g,y=0,b=x;b;b=Ds(b))y++;for(b=0,j=v;j;j=Ds(j))b++;for(;0<y-b;)x=Ds(x),y--;for(;0<b-y;)v=Ds(v),b--;for(;y--;){if(x===v||v!==null&&x===v.alternate)break t;x=Ds(x),v=Ds(v)}x=null}else x=null;h!==null&&N0(f,p,h,x,!1),g!==null&&_!==null&&N0(f,_,g,x,!0)}}e:{if(p=d?Qs(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var N=bR;else if(v0(p))if(Uk)N=SR;else{N=wR;var T=_R}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=jR);if(N&&(N=N(e,d))){Hk(f,N,r,u);break e}T&&T(e,p,d),e==="focusout"&&(T=p._wrapperState)&&T.controlled&&p.type==="number"&&Wx(p,"number",p.value)}switch(T=d?Qs(d):window,e){case"focusin":(v0(T)||T.contentEditable==="true")&&(Ys=T,tg=d,Ei=null);break;case"focusout":Ei=tg=Ys=null;break;case"mousedown":rg=!0;break;case"contextmenu":case"mouseup":case"dragend":rg=!1,j0(f,r,u);break;case"selectionchange":if(CR)break;case"keydown":case"keyup":j0(f,r,u)}var C;if(wv)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Ks?Bk(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(qk&&r.locale!=="ko"&&(Ks||S!=="onCompositionStart"?S==="onCompositionEnd"&&Ks&&(C=$k()):(Mn=u,yv="value"in Mn?Mn.value:Mn.textContent,Ks=!0)),T=Hl(d,S),0<T.length&&(S=new h0(S,e,null,r,u),f.push({event:S,listeners:T}),C?S.data=C:(C=Wk(r),C!==null&&(S.data=C)))),(C=mR?xR(e,r):gR(e,r))&&(d=Hl(d,"onBeforeInput"),0<d.length&&(u=new h0("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=C))}tN(f,t)})}function Ui(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Hl(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=zi(e,r),o!=null&&n.unshift(Ui(e,o,s)),o=zi(e,t),o!=null&&n.push(Ui(e,o,s))),e=e.return}return n}function Ds(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function N0(e,t,r,n,s){for(var o=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=zi(r,o),c!=null&&a.unshift(Ui(r,c,l))):s||(c=zi(r,o),c!=null&&a.push(Ui(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var AR=/\r\n?/g,IR=/\u0000|\uFFFD/g;function C0(e){return(typeof e=="string"?e:""+e).replace(AR,`
`).replace(IR,"")}function Ha(e,t,r){if(t=C0(t),C0(e)!==t&&r)throw Error(J(425))}function Ul(){}var ng=null,sg=null;function og(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ig=typeof setTimeout=="function"?setTimeout:void 0,PR=typeof clearTimeout=="function"?clearTimeout:void 0,E0=typeof Promise=="function"?Promise:void 0,OR=typeof queueMicrotask=="function"?queueMicrotask:typeof E0<"u"?function(e){return E0.resolve(null).then(e).catch(MR)}:ig;function MR(e){setTimeout(function(){throw e})}function Zu(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),qi(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);qi(t)}function $n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function T0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Oo=Math.random().toString(36).slice(2),Br="__reactFiber$"+Oo,Vi="__reactProps$"+Oo,fn="__reactContainer$"+Oo,ag="__reactEvents$"+Oo,DR="__reactListeners$"+Oo,LR="__reactHandles$"+Oo;function us(e){var t=e[Br];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fn]||r[Br]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=T0(e);e!==null;){if(r=e[Br])return r;e=T0(e)}return t}e=r,r=e.parentNode}return null}function va(e){return e=e[Br]||e[fn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function qc(e){return e[Vi]||null}var lg=[],Zs=-1;function es(e){return{current:e}}function Qe(e){0>Zs||(e.current=lg[Zs],lg[Zs]=null,Zs--)}function Ke(e,t){Zs++,lg[Zs]=e.current,e.current=t}var Xn={},Pt=es(Xn),Gt=es(!1),_s=Xn;function bo(e,t){var r=e.type.contextTypes;if(!r)return Xn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Kt(e){return e=e.childContextTypes,e!=null}function Vl(){Qe(Gt),Qe(Pt)}function R0(e,t,r){if(Pt.current!==Xn)throw Error(J(168));Ke(Pt,t),Ke(Gt,r)}function nN(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(J(108,_5(e)||"Unknown",s));return nt({},r,n)}function Gl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xn,_s=Pt.current,Ke(Pt,e),Ke(Gt,Gt.current),!0}function A0(e,t,r){var n=e.stateNode;if(!n)throw Error(J(169));r?(e=nN(e,t,_s),n.__reactInternalMemoizedMergedChildContext=e,Qe(Gt),Qe(Pt),Ke(Pt,e)):Qe(Gt),Ke(Gt,r)}var tn=null,Bc=!1,Ju=!1;function sN(e){tn===null?tn=[e]:tn.push(e)}function zR(e){Bc=!0,sN(e)}function ts(){if(!Ju&&tn!==null){Ju=!0;var e=0,t=Ue;try{var r=tn;for(Ue=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}tn=null,Bc=!1}catch(s){throw tn!==null&&(tn=tn.slice(e+1)),Tk(mv,ts),s}finally{Ue=t,Ju=!1}}return null}var Js=[],eo=0,Kl=null,Yl=0,dr=[],fr=0,ws=null,nn=1,sn="";function as(e,t){Js[eo++]=Yl,Js[eo++]=Kl,Kl=e,Yl=t}function oN(e,t,r){dr[fr++]=nn,dr[fr++]=sn,dr[fr++]=ws,ws=e;var n=nn;e=sn;var s=32-Rr(n)-1;n&=~(1<<s),r+=1;var o=32-Rr(t)+s;if(30<o){var a=s-s%5;o=(n&(1<<a)-1).toString(32),n>>=a,s-=a,nn=1<<32-Rr(t)+s|r<<s|n,sn=o+e}else nn=1<<o|r<<s|n,sn=e}function Sv(e){e.return!==null&&(as(e,1),oN(e,1,0))}function kv(e){for(;e===Kl;)Kl=Js[--eo],Js[eo]=null,Yl=Js[--eo],Js[eo]=null;for(;e===ws;)ws=dr[--fr],dr[fr]=null,sn=dr[--fr],dr[fr]=null,nn=dr[--fr],dr[fr]=null}var nr=null,rr=null,Ze=!1,Er=null;function iN(e,t){var r=hr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function I0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nr=e,rr=$n(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nr=e,rr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ws!==null?{id:nn,overflow:sn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=hr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,nr=e,rr=null,!0):!1;default:return!1}}function cg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ug(e){if(Ze){var t=rr;if(t){var r=t;if(!I0(e,t)){if(cg(e))throw Error(J(418));t=$n(r.nextSibling);var n=nr;t&&I0(e,t)?iN(n,r):(e.flags=e.flags&-4097|2,Ze=!1,nr=e)}}else{if(cg(e))throw Error(J(418));e.flags=e.flags&-4097|2,Ze=!1,nr=e}}}function P0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nr=e}function Ua(e){if(e!==nr)return!1;if(!Ze)return P0(e),Ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!og(e.type,e.memoizedProps)),t&&(t=rr)){if(cg(e))throw aN(),Error(J(418));for(;t;)iN(e,t),t=$n(t.nextSibling)}if(P0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){rr=$n(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}rr=null}}else rr=nr?$n(e.stateNode.nextSibling):null;return!0}function aN(){for(var e=rr;e;)e=$n(e.nextSibling)}function _o(){rr=nr=null,Ze=!1}function Nv(e){Er===null?Er=[e]:Er.push(e)}var FR=yn.ReactCurrentBatchConfig;function Xo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(J(309));var n=r.stateNode}if(!n)throw Error(J(147,e));var s=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var l=s.refs;a===null?delete l[o]:l[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(J(284));if(!r._owner)throw Error(J(290,e))}return e}function Va(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function O0(e){var t=e._init;return t(e._payload)}function lN(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function s(v,y){return v=Hn(v,y),v.index=0,v.sibling=null,v}function o(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,j){return y===null||y.tag!==6?(y=id(b,v.mode,j),y.return=v,y):(y=s(y,b),y.return=v,y)}function c(v,y,b,j){var N=b.type;return N===Gs?u(v,y,b.props.children,j,b.key):y!==null&&(y.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===kn&&O0(N)===y.type)?(j=s(y,b.props),j.ref=Xo(v,y,b),j.return=v,j):(j=Al(b.type,b.key,b.props,null,v.mode,j),j.ref=Xo(v,y,b),j.return=v,j)}function d(v,y,b,j){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=ad(b,v.mode,j),y.return=v,y):(y=s(y,b.children||[]),y.return=v,y)}function u(v,y,b,j,N){return y===null||y.tag!==7?(y=gs(b,v.mode,j,N),y.return=v,y):(y=s(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=id(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ma:return b=Al(y.type,y.key,y.props,null,v.mode,b),b.ref=Xo(v,null,y),b.return=v,b;case Vs:return y=ad(y,v.mode,b),y.return=v,y;case kn:var j=y._init;return f(v,j(y._payload),b)}if(fi(y)||Uo(y))return y=gs(y,v.mode,b,null),y.return=v,y;Va(v,y)}return null}function p(v,y,b,j){var N=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:l(v,y,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ma:return b.key===N?c(v,y,b,j):null;case Vs:return b.key===N?d(v,y,b,j):null;case kn:return N=b._init,p(v,y,N(b._payload),j)}if(fi(b)||Uo(b))return N!==null?null:u(v,y,b,j,null);Va(v,b)}return null}function h(v,y,b,j,N){if(typeof j=="string"&&j!==""||typeof j=="number")return v=v.get(b)||null,l(y,v,""+j,N);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ma:return v=v.get(j.key===null?b:j.key)||null,c(y,v,j,N);case Vs:return v=v.get(j.key===null?b:j.key)||null,d(y,v,j,N);case kn:var T=j._init;return h(v,y,b,T(j._payload),N)}if(fi(j)||Uo(j))return v=v.get(b)||null,u(y,v,j,N,null);Va(y,j)}return null}function g(v,y,b,j){for(var N=null,T=null,C=y,S=y=0,w=null;C!==null&&S<b.length;S++){C.index>S?(w=C,C=null):w=C.sibling;var A=p(v,C,b[S],j);if(A===null){C===null&&(C=w);break}e&&C&&A.alternate===null&&t(v,C),y=o(A,y,S),T===null?N=A:T.sibling=A,T=A,C=w}if(S===b.length)return r(v,C),Ze&&as(v,S),N;if(C===null){for(;S<b.length;S++)C=f(v,b[S],j),C!==null&&(y=o(C,y,S),T===null?N=C:T.sibling=C,T=C);return Ze&&as(v,S),N}for(C=n(v,C);S<b.length;S++)w=h(C,v,S,b[S],j),w!==null&&(e&&w.alternate!==null&&C.delete(w.key===null?S:w.key),y=o(w,y,S),T===null?N=w:T.sibling=w,T=w);return e&&C.forEach(function(E){return t(v,E)}),Ze&&as(v,S),N}function x(v,y,b,j){var N=Uo(b);if(typeof N!="function")throw Error(J(150));if(b=N.call(b),b==null)throw Error(J(151));for(var T=N=null,C=y,S=y=0,w=null,A=b.next();C!==null&&!A.done;S++,A=b.next()){C.index>S?(w=C,C=null):w=C.sibling;var E=p(v,C,A.value,j);if(E===null){C===null&&(C=w);break}e&&C&&E.alternate===null&&t(v,C),y=o(E,y,S),T===null?N=E:T.sibling=E,T=E,C=w}if(A.done)return r(v,C),Ze&&as(v,S),N;if(C===null){for(;!A.done;S++,A=b.next())A=f(v,A.value,j),A!==null&&(y=o(A,y,S),T===null?N=A:T.sibling=A,T=A);return Ze&&as(v,S),N}for(C=n(v,C);!A.done;S++,A=b.next())A=h(C,v,S,A.value,j),A!==null&&(e&&A.alternate!==null&&C.delete(A.key===null?S:A.key),y=o(A,y,S),T===null?N=A:T.sibling=A,T=A);return e&&C.forEach(function(O){return t(v,O)}),Ze&&as(v,S),N}function _(v,y,b,j){if(typeof b=="object"&&b!==null&&b.type===Gs&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ma:e:{for(var N=b.key,T=y;T!==null;){if(T.key===N){if(N=b.type,N===Gs){if(T.tag===7){r(v,T.sibling),y=s(T,b.props.children),y.return=v,v=y;break e}}else if(T.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===kn&&O0(N)===T.type){r(v,T.sibling),y=s(T,b.props),y.ref=Xo(v,T,b),y.return=v,v=y;break e}r(v,T);break}else t(v,T);T=T.sibling}b.type===Gs?(y=gs(b.props.children,v.mode,j,b.key),y.return=v,v=y):(j=Al(b.type,b.key,b.props,null,v.mode,j),j.ref=Xo(v,y,b),j.return=v,v=j)}return a(v);case Vs:e:{for(T=b.key;y!==null;){if(y.key===T)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=s(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=ad(b,v.mode,j),y.return=v,v=y}return a(v);case kn:return T=b._init,_(v,y,T(b._payload),j)}if(fi(b))return g(v,y,b,j);if(Uo(b))return x(v,y,b,j);Va(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=s(y,b),y.return=v,v=y):(r(v,y),y=id(b,v.mode,j),y.return=v,v=y),a(v)):r(v,y)}return _}var wo=lN(!0),cN=lN(!1),Xl=es(null),Ql=null,to=null,Cv=null;function Ev(){Cv=to=Ql=null}function Tv(e){var t=Xl.current;Qe(Xl),e._currentValue=t}function dg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function po(e,t){Ql=e,Cv=to=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ht=!0),e.firstContext=null)}function gr(e){var t=e._currentValue;if(Cv!==e)if(e={context:e,memoizedValue:t,next:null},to===null){if(Ql===null)throw Error(J(308));to=e,Ql.dependencies={lanes:0,firstContext:e}}else to=to.next=e;return t}var ds=null;function Rv(e){ds===null?ds=[e]:ds.push(e)}function uN(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Rv(t)):(r.next=s.next,s.next=r),t.interleaved=r,pn(e,n)}function pn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Nn=!1;function Av(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dN(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Le&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,pn(e,r)}return s=n.interleaved,s===null?(t.next=t,Rv(n)):(t.next=s.next,s.next=t),n.interleaved=t,pn(e,r)}function kl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,xv(e,r)}}function M0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=a:o=o.next=a,r=r.next}while(r!==null);o===null?s=o=t:o=o.next=t}else s=o=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Zl(e,t,r,n){var s=e.updateQueue;Nn=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?o=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;a=0,u=d=c=null,l=o;do{var p=l.lane,h=l.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,x=l;switch(p=t,h=r,x.tag){case 1:if(g=x.payload,typeof g=="function"){f=g.call(h,f,p);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,p=typeof g=="function"?g.call(h,f,p):g,p==null)break e;f=nt({},f,p);break e;case 2:Nn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Ss|=a,e.lanes=a,e.memoizedState=f}}function D0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(J(191,s));s.call(n)}}}var ya={},Ur=es(ya),Gi=es(ya),Ki=es(ya);function fs(e){if(e===ya)throw Error(J(174));return e}function Iv(e,t){switch(Ke(Ki,t),Ke(Gi,e),Ke(Ur,ya),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ux(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ux(t,e)}Qe(Ur),Ke(Ur,t)}function jo(){Qe(Ur),Qe(Gi),Qe(Ki)}function fN(e){fs(Ki.current);var t=fs(Ur.current),r=Ux(t,e.type);t!==r&&(Ke(Gi,e),Ke(Ur,r))}function Pv(e){Gi.current===e&&(Qe(Ur),Qe(Gi))}var tt=es(0);function Jl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ed=[];function Ov(){for(var e=0;e<ed.length;e++)ed[e]._workInProgressVersionPrimary=null;ed.length=0}var Nl=yn.ReactCurrentDispatcher,td=yn.ReactCurrentBatchConfig,js=0,rt=null,ht=null,yt=null,ec=!1,Ti=!1,Yi=0,$R=0;function Rt(){throw Error(J(321))}function Mv(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ir(e[r],t[r]))return!1;return!0}function Dv(e,t,r,n,s,o){if(js=o,rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nl.current=e===null||e.memoizedState===null?HR:UR,e=r(n,s),Ti){o=0;do{if(Ti=!1,Yi=0,25<=o)throw Error(J(301));o+=1,yt=ht=null,t.updateQueue=null,Nl.current=VR,e=r(n,s)}while(Ti)}if(Nl.current=tc,t=ht!==null&&ht.next!==null,js=0,yt=ht=rt=null,ec=!1,t)throw Error(J(300));return e}function Lv(){var e=Yi!==0;return Yi=0,e}function qr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?rt.memoizedState=yt=e:yt=yt.next=e,yt}function vr(){if(ht===null){var e=rt.alternate;e=e!==null?e.memoizedState:null}else e=ht.next;var t=yt===null?rt.memoizedState:yt.next;if(t!==null)yt=t,ht=e;else{if(e===null)throw Error(J(310));ht=e,e={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},yt===null?rt.memoizedState=yt=e:yt=yt.next=e}return yt}function Xi(e,t){return typeof t=="function"?t(e):t}function rd(e){var t=vr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=ht,s=n.baseQueue,o=r.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}n.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,n=n.baseState;var l=a=null,c=null,d=o;do{var u=d.lane;if((js&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,a=n):c=c.next=f,rt.lanes|=u,Ss|=u}d=d.next}while(d!==null&&d!==o);c===null?a=n:c.next=l,Ir(n,t.memoizedState)||(Ht=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do o=s.lane,rt.lanes|=o,Ss|=o,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function nd(e){var t=vr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,o=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do o=e(o,a.action),a=a.next;while(a!==s);Ir(o,t.memoizedState)||(Ht=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function pN(){}function hN(e,t){var r=rt,n=vr(),s=t(),o=!Ir(n.memoizedState,s);if(o&&(n.memoizedState=s,Ht=!0),n=n.queue,zv(gN.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||yt!==null&&yt.memoizedState.tag&1){if(r.flags|=2048,Qi(9,xN.bind(null,r,n,s,t),void 0,null),_t===null)throw Error(J(349));js&30||mN(r,t,s)}return s}function mN(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function xN(e,t,r,n){t.value=r,t.getSnapshot=n,vN(t)&&yN(e)}function gN(e,t,r){return r(function(){vN(t)&&yN(e)})}function vN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ir(e,r)}catch{return!0}}function yN(e){var t=pn(e,1);t!==null&&Ar(t,e,1,-1)}function L0(e){var t=qr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xi,lastRenderedState:e},t.queue=e,e=e.dispatch=WR.bind(null,rt,e),[t.memoizedState,e]}function Qi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function bN(){return vr().memoizedState}function Cl(e,t,r,n){var s=qr();rt.flags|=e,s.memoizedState=Qi(1|t,r,void 0,n===void 0?null:n)}function Wc(e,t,r,n){var s=vr();n=n===void 0?null:n;var o=void 0;if(ht!==null){var a=ht.memoizedState;if(o=a.destroy,n!==null&&Mv(n,a.deps)){s.memoizedState=Qi(t,r,o,n);return}}rt.flags|=e,s.memoizedState=Qi(1|t,r,o,n)}function z0(e,t){return Cl(8390656,8,e,t)}function zv(e,t){return Wc(2048,8,e,t)}function _N(e,t){return Wc(4,2,e,t)}function wN(e,t){return Wc(4,4,e,t)}function jN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function SN(e,t,r){return r=r!=null?r.concat([e]):null,Wc(4,4,jN.bind(null,t,e),r)}function Fv(){}function kN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Mv(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function NN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Mv(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function CN(e,t,r){return js&21?(Ir(r,t)||(r=Ik(),rt.lanes|=r,Ss|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ht=!0),e.memoizedState=r)}function qR(e,t){var r=Ue;Ue=r!==0&&4>r?r:4,e(!0);var n=td.transition;td.transition={};try{e(!1),t()}finally{Ue=r,td.transition=n}}function EN(){return vr().memoizedState}function BR(e,t,r){var n=Wn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},TN(e))RN(t,r);else if(r=uN(e,t,r,n),r!==null){var s=Ft();Ar(r,e,n,s),AN(r,t,n)}}function WR(e,t,r){var n=Wn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(TN(e))RN(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,l=o(a,r);if(s.hasEagerState=!0,s.eagerState=l,Ir(l,a)){var c=t.interleaved;c===null?(s.next=s,Rv(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=uN(e,t,s,n),r!==null&&(s=Ft(),Ar(r,e,n,s),AN(r,t,n))}}function TN(e){var t=e.alternate;return e===rt||t!==null&&t===rt}function RN(e,t){Ti=ec=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function AN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,xv(e,r)}}var tc={readContext:gr,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},HR={readContext:gr,useCallback:function(e,t){return qr().memoizedState=[e,t===void 0?null:t],e},useContext:gr,useEffect:z0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Cl(4194308,4,jN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Cl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Cl(4,2,e,t)},useMemo:function(e,t){var r=qr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=qr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=BR.bind(null,rt,e),[n.memoizedState,e]},useRef:function(e){var t=qr();return e={current:e},t.memoizedState=e},useState:L0,useDebugValue:Fv,useDeferredValue:function(e){return qr().memoizedState=e},useTransition:function(){var e=L0(!1),t=e[0];return e=qR.bind(null,e[1]),qr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rt,s=qr();if(Ze){if(r===void 0)throw Error(J(407));r=r()}else{if(r=t(),_t===null)throw Error(J(349));js&30||mN(n,t,r)}s.memoizedState=r;var o={value:r,getSnapshot:t};return s.queue=o,z0(gN.bind(null,n,o,e),[e]),n.flags|=2048,Qi(9,xN.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=qr(),t=_t.identifierPrefix;if(Ze){var r=sn,n=nn;r=(n&~(1<<32-Rr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Yi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=$R++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},UR={readContext:gr,useCallback:kN,useContext:gr,useEffect:zv,useImperativeHandle:SN,useInsertionEffect:_N,useLayoutEffect:wN,useMemo:NN,useReducer:rd,useRef:bN,useState:function(){return rd(Xi)},useDebugValue:Fv,useDeferredValue:function(e){var t=vr();return CN(t,ht.memoizedState,e)},useTransition:function(){var e=rd(Xi)[0],t=vr().memoizedState;return[e,t]},useMutableSource:pN,useSyncExternalStore:hN,useId:EN,unstable_isNewReconciler:!1},VR={readContext:gr,useCallback:kN,useContext:gr,useEffect:zv,useImperativeHandle:SN,useInsertionEffect:_N,useLayoutEffect:wN,useMemo:NN,useReducer:nd,useRef:bN,useState:function(){return nd(Xi)},useDebugValue:Fv,useDeferredValue:function(e){var t=vr();return ht===null?t.memoizedState=e:CN(t,ht.memoizedState,e)},useTransition:function(){var e=nd(Xi)[0],t=vr().memoizedState;return[e,t]},useMutableSource:pN,useSyncExternalStore:hN,useId:EN,unstable_isNewReconciler:!1};function kr(e,t){if(e&&e.defaultProps){t=nt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function fg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Hc={isMounted:function(e){return(e=e._reactInternals)?Ts(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ft(),s=Wn(e),o=cn(n,s);o.payload=t,r!=null&&(o.callback=r),t=qn(e,o,s),t!==null&&(Ar(t,e,s,n),kl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ft(),s=Wn(e),o=cn(n,s);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=qn(e,o,s),t!==null&&(Ar(t,e,s,n),kl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ft(),n=Wn(e),s=cn(r,n);s.tag=2,t!=null&&(s.callback=t),t=qn(e,s,n),t!==null&&(Ar(t,e,n,r),kl(t,e,n))}};function F0(e,t,r,n,s,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,a):t.prototype&&t.prototype.isPureReactComponent?!Wi(r,n)||!Wi(s,o):!0}function IN(e,t,r){var n=!1,s=Xn,o=t.contextType;return typeof o=="object"&&o!==null?o=gr(o):(s=Kt(t)?_s:Pt.current,n=t.contextTypes,o=(n=n!=null)?bo(e,s):Xn),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Hc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function $0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Hc.enqueueReplaceState(t,t.state,null)}function pg(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Av(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=gr(o):(o=Kt(t)?_s:Pt.current,s.context=bo(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(fg(e,t,o,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Hc.enqueueReplaceState(s,s.state,null),Zl(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function So(e,t){try{var r="",n=t;do r+=b5(n),n=n.return;while(n);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function sd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function hg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var GR=typeof WeakMap=="function"?WeakMap:Map;function PN(e,t,r){r=cn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){nc||(nc=!0,Sg=n),hg(e,t)},r}function ON(e,t,r){r=cn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){hg(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){hg(e,t),typeof n!="function"&&(Bn===null?Bn=new Set([this]):Bn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function q0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new GR;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=aA.bind(null,e,t,r),t.then(e,e))}function B0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function W0(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=cn(-1,1),t.tag=2,qn(r,t,1))),r.lanes|=1),e)}var KR=yn.ReactCurrentOwner,Ht=!1;function Lt(e,t,r,n){t.child=e===null?cN(t,null,r,n):wo(t,e.child,r,n)}function H0(e,t,r,n,s){r=r.render;var o=t.ref;return po(t,s),n=Dv(e,t,r,n,o,s),r=Lv(),e!==null&&!Ht?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,hn(e,t,s)):(Ze&&r&&Sv(t),t.flags|=1,Lt(e,t,n,s),t.child)}function U0(e,t,r,n,s){if(e===null){var o=r.type;return typeof o=="function"&&!Gv(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,MN(e,t,o,n,s)):(e=Al(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var a=o.memoizedProps;if(r=r.compare,r=r!==null?r:Wi,r(a,n)&&e.ref===t.ref)return hn(e,t,s)}return t.flags|=1,e=Hn(o,n),e.ref=t.ref,e.return=t,t.child=e}function MN(e,t,r,n,s){if(e!==null){var o=e.memoizedProps;if(Wi(o,n)&&e.ref===t.ref)if(Ht=!1,t.pendingProps=n=o,(e.lanes&s)!==0)e.flags&131072&&(Ht=!0);else return t.lanes=e.lanes,hn(e,t,s)}return mg(e,t,r,n,s)}function DN(e,t,r){var n=t.pendingProps,s=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(no,er),er|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ke(no,er),er|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Ke(no,er),er|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Ke(no,er),er|=n;return Lt(e,t,s,r),t.child}function LN(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function mg(e,t,r,n,s){var o=Kt(r)?_s:Pt.current;return o=bo(t,o),po(t,s),r=Dv(e,t,r,n,o,s),n=Lv(),e!==null&&!Ht?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,hn(e,t,s)):(Ze&&n&&Sv(t),t.flags|=1,Lt(e,t,r,s),t.child)}function V0(e,t,r,n,s){if(Kt(r)){var o=!0;Gl(t)}else o=!1;if(po(t,s),t.stateNode===null)El(e,t),IN(t,r,n),pg(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=gr(d):(d=Kt(r)?_s:Pt.current,d=bo(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==d)&&$0(t,a,n,d),Nn=!1;var p=t.memoizedState;a.state=p,Zl(t,n,a,s),c=t.memoizedState,l!==n||p!==c||Gt.current||Nn?(typeof u=="function"&&(fg(t,r,u,n),c=t.memoizedState),(l=Nn||F0(t,r,l,n,p,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=d,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,dN(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:kr(t.type,l),a.props=d,f=t.pendingProps,p=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=gr(c):(c=Kt(r)?_s:Pt.current,c=bo(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==c)&&$0(t,a,n,c),Nn=!1,p=t.memoizedState,a.state=p,Zl(t,n,a,s);var g=t.memoizedState;l!==f||p!==g||Gt.current||Nn?(typeof h=="function"&&(fg(t,r,h,n),g=t.memoizedState),(d=Nn||F0(t,r,d,n,p,g,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=c,n=d):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return xg(e,t,r,n,o,s)}function xg(e,t,r,n,s,o){LN(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&A0(t,r,!1),hn(e,t,o);n=t.stateNode,KR.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,l,o)):Lt(e,t,l,o),t.memoizedState=n.state,s&&A0(t,r,!0),t.child}function zN(e){var t=e.stateNode;t.pendingContext?R0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&R0(e,t.context,!1),Iv(e,t.containerInfo)}function G0(e,t,r,n,s){return _o(),Nv(s),t.flags|=256,Lt(e,t,r,n),t.child}var gg={dehydrated:null,treeContext:null,retryLane:0};function vg(e){return{baseLanes:e,cachePool:null,transitions:null}}function FN(e,t,r){var n=t.pendingProps,s=tt.current,o=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ke(tt,s&1),e===null)return ug(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,o?(n=t.mode,o=t.child,a={mode:"hidden",children:a},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Gc(a,n,0,null),e=gs(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=vg(r),t.memoizedState=gg,e):$v(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return YR(e,t,a,n,l,s,r);if(o){o=n.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Hn(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Hn(l,o):(o=gs(o,a,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,a=e.child.memoizedState,a=a===null?vg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~r,t.memoizedState=gg,n}return o=e.child,e=o.sibling,n=Hn(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function $v(e,t){return t=Gc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ga(e,t,r,n){return n!==null&&Nv(n),wo(t,e.child,null,r),e=$v(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function YR(e,t,r,n,s,o,a){if(r)return t.flags&256?(t.flags&=-257,n=sd(Error(J(422))),Ga(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,s=t.mode,n=Gc({mode:"visible",children:n.children},s,0,null),o=gs(o,s,a,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&wo(t,e.child,null,a),t.child.memoizedState=vg(a),t.memoizedState=gg,o);if(!(t.mode&1))return Ga(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,o=Error(J(419)),n=sd(o,n,void 0),Ga(e,t,a,n)}if(l=(a&e.childLanes)!==0,Ht||l){if(n=_t,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,pn(e,s),Ar(n,e,s,-1))}return Vv(),n=sd(Error(J(421))),Ga(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=lA.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,rr=$n(s.nextSibling),nr=t,Ze=!0,Er=null,e!==null&&(dr[fr++]=nn,dr[fr++]=sn,dr[fr++]=ws,nn=e.id,sn=e.overflow,ws=t),t=$v(t,n.children),t.flags|=4096,t)}function K0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),dg(e.return,t,r)}function od(e,t,r,n,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s)}function $N(e,t,r){var n=t.pendingProps,s=n.revealOrder,o=n.tail;if(Lt(e,t,n.children,r),n=tt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&K0(e,r,t);else if(e.tag===19)K0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ke(tt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Jl(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),od(t,!1,s,r,o);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Jl(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}od(t,!0,r,null,o);break;case"together":od(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function El(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ss|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,r=Hn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Hn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function XR(e,t,r){switch(t.tag){case 3:zN(t),_o();break;case 5:fN(t);break;case 1:Kt(t.type)&&Gl(t);break;case 4:Iv(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ke(Xl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ke(tt,tt.current&1),t.flags|=128,null):r&t.child.childLanes?FN(e,t,r):(Ke(tt,tt.current&1),e=hn(e,t,r),e!==null?e.sibling:null);Ke(tt,tt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return $N(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ke(tt,tt.current),n)break;return null;case 22:case 23:return t.lanes=0,DN(e,t,r)}return hn(e,t,r)}var qN,yg,BN,WN;qN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};yg=function(){};BN=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,fs(Ur.current);var o=null;switch(r){case"input":s=qx(e,s),n=qx(e,n),o=[];break;case"select":s=nt({},s,{value:void 0}),n=nt({},n,{value:void 0}),o=[];break;case"textarea":s=Hx(e,s),n=Hx(e,n),o=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ul)}Vx(r,n);var a;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Di.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var c=n[d];if(l=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(o||(o=[]),o.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Di.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Xe("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};WN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Qo(e,t){if(!Ze)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function QR(e,t,r){var n=t.pendingProps;switch(kv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Kt(t.type)&&Vl(),At(t),null;case 3:return n=t.stateNode,jo(),Qe(Gt),Qe(Pt),Ov(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ua(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Er!==null&&(Cg(Er),Er=null))),yg(e,t),At(t),null;case 5:Pv(t);var s=fs(Ki.current);if(r=t.type,e!==null&&t.stateNode!=null)BN(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(J(166));return At(t),null}if(e=fs(Ur.current),Ua(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Br]=t,n[Vi]=o,e=(t.mode&1)!==0,r){case"dialog":Xe("cancel",n),Xe("close",n);break;case"iframe":case"object":case"embed":Xe("load",n);break;case"video":case"audio":for(s=0;s<hi.length;s++)Xe(hi[s],n);break;case"source":Xe("error",n);break;case"img":case"image":case"link":Xe("error",n),Xe("load",n);break;case"details":Xe("toggle",n);break;case"input":n0(n,o),Xe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Xe("invalid",n);break;case"textarea":o0(n,o),Xe("invalid",n)}Vx(r,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="children"?typeof l=="string"?n.textContent!==l&&(o.suppressHydrationWarning!==!0&&Ha(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Ha(n.textContent,l,e),s=["children",""+l]):Di.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Xe("scroll",n)}switch(r){case"input":Da(n),s0(n,o,!0);break;case"textarea":Da(n),i0(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=Ul)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Br]=t,e[Vi]=n,qN(e,t,!1,!1),t.stateNode=e;e:{switch(a=Gx(r,n),r){case"dialog":Xe("cancel",e),Xe("close",e),s=n;break;case"iframe":case"object":case"embed":Xe("load",e),s=n;break;case"video":case"audio":for(s=0;s<hi.length;s++)Xe(hi[s],e);s=n;break;case"source":Xe("error",e),s=n;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),s=n;break;case"details":Xe("toggle",e),s=n;break;case"input":n0(e,n),s=qx(e,n),Xe("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=nt({},n,{value:void 0}),Xe("invalid",e);break;case"textarea":o0(e,n),s=Hx(e,n),Xe("invalid",e);break;default:s=n}Vx(r,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?bk(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&vk(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Li(e,c):typeof c=="number"&&Li(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Di.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Xe("scroll",e):c!=null&&uv(e,o,c,a))}switch(r){case"input":Da(e),s0(e,n,!1);break;case"textarea":Da(e),i0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Yn(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?lo(e,!!n.multiple,o,!1):n.defaultValue!=null&&lo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ul)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)WN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(J(166));if(r=fs(Ki.current),fs(Ur.current),Ua(t)){if(n=t.stateNode,r=t.memoizedProps,n[Br]=t,(o=n.nodeValue!==r)&&(e=nr,e!==null))switch(e.tag){case 3:Ha(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ha(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Br]=t,t.stateNode=n}return At(t),null;case 13:if(Qe(tt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&rr!==null&&t.mode&1&&!(t.flags&128))aN(),_o(),t.flags|=98560,o=!1;else if(o=Ua(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(J(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(J(317));o[Br]=t}else _o(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;At(t),o=!1}else Er!==null&&(Cg(Er),Er=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||tt.current&1?gt===0&&(gt=3):Vv())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return jo(),yg(e,t),e===null&&Hi(t.stateNode.containerInfo),At(t),null;case 10:return Tv(t.type._context),At(t),null;case 17:return Kt(t.type)&&Vl(),At(t),null;case 19:if(Qe(tt),o=t.memoizedState,o===null)return At(t),null;if(n=(t.flags&128)!==0,a=o.rendering,a===null)if(n)Qo(o,!1);else{if(gt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Jl(e),a!==null){for(t.flags|=128,Qo(o,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ke(tt,tt.current&1|2),t.child}e=e.sibling}o.tail!==null&&lt()>ko&&(t.flags|=128,n=!0,Qo(o,!1),t.lanes=4194304)}else{if(!n)if(e=Jl(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Qo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Ze)return At(t),null}else 2*lt()-o.renderingStartTime>ko&&r!==1073741824&&(t.flags|=128,n=!0,Qo(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(r=o.last,r!==null?r.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=lt(),t.sibling=null,r=tt.current,Ke(tt,n?r&1|2:r&1),t):(At(t),null);case 22:case 23:return Uv(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?er&1073741824&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function ZR(e,t){switch(kv(t),t.tag){case 1:return Kt(t.type)&&Vl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return jo(),Qe(Gt),Qe(Pt),Ov(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Pv(t),null;case 13:if(Qe(tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));_o()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qe(tt),null;case 4:return jo(),null;case 10:return Tv(t.type._context),null;case 22:case 23:return Uv(),null;case 24:return null;default:return null}}var Ka=!1,It=!1,JR=typeof WeakSet=="function"?WeakSet:Set,le=null;function ro(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ot(e,t,n)}else r.current=null}function bg(e,t,r){try{r()}catch(n){ot(e,t,n)}}var Y0=!1;function eA(e,t){if(ng=Bl,e=Kk(),jv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(l=a+s),f!==o||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++d===s&&(l=a),p===o&&++u===n&&(c=a),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(sg={focusedElem:e,selectionRange:r},Bl=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,_=g.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?x:kr(t.type,x),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(j){ot(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return g=Y0,Y0=!1,g}function Ri(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&bg(t,r,o)}s=s.next}while(s!==n)}}function Uc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function _g(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function HN(e){var t=e.alternate;t!==null&&(e.alternate=null,HN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Br],delete t[Vi],delete t[ag],delete t[DR],delete t[LR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function UN(e){return e.tag===5||e.tag===3||e.tag===4}function X0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||UN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ul));else if(n!==4&&(e=e.child,e!==null))for(wg(e,t,r),e=e.sibling;e!==null;)wg(e,t,r),e=e.sibling}function jg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(jg(e,t,r),e=e.sibling;e!==null;)jg(e,t,r),e=e.sibling}var kt=null,Nr=!1;function wn(e,t,r){for(r=r.child;r!==null;)VN(e,t,r),r=r.sibling}function VN(e,t,r){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(Lc,r)}catch{}switch(r.tag){case 5:It||ro(r,t);case 6:var n=kt,s=Nr;kt=null,wn(e,t,r),kt=n,Nr=s,kt!==null&&(Nr?(e=kt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):kt.removeChild(r.stateNode));break;case 18:kt!==null&&(Nr?(e=kt,r=r.stateNode,e.nodeType===8?Zu(e.parentNode,r):e.nodeType===1&&Zu(e,r),qi(e)):Zu(kt,r.stateNode));break;case 4:n=kt,s=Nr,kt=r.stateNode.containerInfo,Nr=!0,wn(e,t,r),kt=n,Nr=s;break;case 0:case 11:case 14:case 15:if(!It&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&bg(r,t,a),s=s.next}while(s!==n)}wn(e,t,r);break;case 1:if(!It&&(ro(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ot(r,t,l)}wn(e,t,r);break;case 21:wn(e,t,r);break;case 22:r.mode&1?(It=(n=It)||r.memoizedState!==null,wn(e,t,r),It=n):wn(e,t,r);break;default:wn(e,t,r)}}function Q0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new JR),t.forEach(function(n){var s=cA.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function jr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var o=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:kt=l.stateNode,Nr=!1;break e;case 3:kt=l.stateNode.containerInfo,Nr=!0;break e;case 4:kt=l.stateNode.containerInfo,Nr=!0;break e}l=l.return}if(kt===null)throw Error(J(160));VN(o,a,s),kt=null,Nr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){ot(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)GN(t,e),t=t.sibling}function GN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(jr(t,e),Fr(e),n&4){try{Ri(3,e,e.return),Uc(3,e)}catch(x){ot(e,e.return,x)}try{Ri(5,e,e.return)}catch(x){ot(e,e.return,x)}}break;case 1:jr(t,e),Fr(e),n&512&&r!==null&&ro(r,r.return);break;case 5:if(jr(t,e),Fr(e),n&512&&r!==null&&ro(r,r.return),e.flags&32){var s=e.stateNode;try{Li(s,"")}catch(x){ot(e,e.return,x)}}if(n&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,a=r!==null?r.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&mk(s,o),Gx(l,a);var d=Gx(l,o);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?bk(s,f):u==="dangerouslySetInnerHTML"?vk(s,f):u==="children"?Li(s,f):uv(s,u,f,d)}switch(l){case"input":Bx(s,o);break;case"textarea":xk(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?lo(s,!!o.multiple,h,!1):p!==!!o.multiple&&(o.defaultValue!=null?lo(s,!!o.multiple,o.defaultValue,!0):lo(s,!!o.multiple,o.multiple?[]:"",!1))}s[Vi]=o}catch(x){ot(e,e.return,x)}}break;case 6:if(jr(t,e),Fr(e),n&4){if(e.stateNode===null)throw Error(J(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(x){ot(e,e.return,x)}}break;case 3:if(jr(t,e),Fr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qi(t.containerInfo)}catch(x){ot(e,e.return,x)}break;case 4:jr(t,e),Fr(e);break;case 13:jr(t,e),Fr(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Wv=lt())),n&4&&Q0(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(It=(d=It)||u,jr(t,e),It=d):jr(t,e),Fr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(le=e,u=e.child;u!==null;){for(f=le=u;le!==null;){switch(p=le,h=p.child,p.tag){case 0:case 11:case 14:case 15:Ri(4,p,p.return);break;case 1:ro(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(x){ot(n,r,x)}}break;case 5:ro(p,p.return);break;case 22:if(p.memoizedState!==null){J0(f);continue}}h!==null?(h.return=p,le=h):J0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=yk("display",a))}catch(x){ot(e,e.return,x)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(x){ot(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:jr(t,e),Fr(e),n&4&&Q0(e);break;case 21:break;default:jr(t,e),Fr(e)}}function Fr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(UN(r)){var n=r;break e}r=r.return}throw Error(J(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Li(s,""),n.flags&=-33);var o=X0(e);jg(e,o,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=X0(e);wg(e,l,a);break;default:throw Error(J(161))}}catch(c){ot(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tA(e,t,r){le=e,KN(e)}function KN(e,t,r){for(var n=(e.mode&1)!==0;le!==null;){var s=le,o=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Ka;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||It;l=Ka;var d=It;if(Ka=a,(It=c)&&!d)for(le=s;le!==null;)a=le,c=a.child,a.tag===22&&a.memoizedState!==null?eb(s):c!==null?(c.return=a,le=c):eb(s);for(;o!==null;)le=o,KN(o),o=o.sibling;le=s,Ka=l,It=d}Z0(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,le=o):Z0(e)}}function Z0(e){for(;le!==null;){var t=le;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:It||Uc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!It)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:kr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&D0(t,o,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}D0(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&qi(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}It||t.flags&512&&_g(t)}catch(p){ot(t,t.return,p)}}if(t===e){le=null;break}if(r=t.sibling,r!==null){r.return=t.return,le=r;break}le=t.return}}function J0(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var r=t.sibling;if(r!==null){r.return=t.return,le=r;break}le=t.return}}function eb(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Uc(4,t)}catch(c){ot(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){ot(t,s,c)}}var o=t.return;try{_g(t)}catch(c){ot(t,o,c)}break;case 5:var a=t.return;try{_g(t)}catch(c){ot(t,a,c)}}}catch(c){ot(t,t.return,c)}if(t===e){le=null;break}var l=t.sibling;if(l!==null){l.return=t.return,le=l;break}le=t.return}}var rA=Math.ceil,rc=yn.ReactCurrentDispatcher,qv=yn.ReactCurrentOwner,xr=yn.ReactCurrentBatchConfig,Le=0,_t=null,ut=null,Nt=0,er=0,no=es(0),gt=0,Zi=null,Ss=0,Vc=0,Bv=0,Ai=null,Wt=null,Wv=0,ko=1/0,en=null,nc=!1,Sg=null,Bn=null,Ya=!1,Dn=null,sc=0,Ii=0,kg=null,Tl=-1,Rl=0;function Ft(){return Le&6?lt():Tl!==-1?Tl:Tl=lt()}function Wn(e){return e.mode&1?Le&2&&Nt!==0?Nt&-Nt:FR.transition!==null?(Rl===0&&(Rl=Ik()),Rl):(e=Ue,e!==0||(e=window.event,e=e===void 0?16:Fk(e.type)),e):1}function Ar(e,t,r,n){if(50<Ii)throw Ii=0,kg=null,Error(J(185));xa(e,r,n),(!(Le&2)||e!==_t)&&(e===_t&&(!(Le&2)&&(Vc|=r),gt===4&&An(e,Nt)),Yt(e,n),r===1&&Le===0&&!(t.mode&1)&&(ko=lt()+500,Bc&&ts()))}function Yt(e,t){var r=e.callbackNode;F5(e,t);var n=ql(e,e===_t?Nt:0);if(n===0)r!==null&&c0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&c0(r),t===1)e.tag===0?zR(tb.bind(null,e)):sN(tb.bind(null,e)),OR(function(){!(Le&6)&&ts()}),r=null;else{switch(Pk(n)){case 1:r=mv;break;case 4:r=Rk;break;case 16:r=$l;break;case 536870912:r=Ak;break;default:r=$l}r=rC(r,YN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function YN(e,t){if(Tl=-1,Rl=0,Le&6)throw Error(J(327));var r=e.callbackNode;if(ho()&&e.callbackNode!==r)return null;var n=ql(e,e===_t?Nt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=oc(e,n);else{t=n;var s=Le;Le|=2;var o=QN();(_t!==e||Nt!==t)&&(en=null,ko=lt()+500,xs(e,t));do try{oA();break}catch(l){XN(e,l)}while(!0);Ev(),rc.current=o,Le=s,ut!==null?t=0:(_t=null,Nt=0,t=gt)}if(t!==0){if(t===2&&(s=Zx(e),s!==0&&(n=s,t=Ng(e,s))),t===1)throw r=Zi,xs(e,0),An(e,n),Yt(e,lt()),r;if(t===6)An(e,n);else{if(s=e.current.alternate,!(n&30)&&!nA(s)&&(t=oc(e,n),t===2&&(o=Zx(e),o!==0&&(n=o,t=Ng(e,o))),t===1))throw r=Zi,xs(e,0),An(e,n),Yt(e,lt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(J(345));case 2:ls(e,Wt,en);break;case 3:if(An(e,n),(n&130023424)===n&&(t=Wv+500-lt(),10<t)){if(ql(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Ft(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ig(ls.bind(null,e,Wt,en),t);break}ls(e,Wt,en);break;case 4:if(An(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Rr(n);o=1<<a,a=t[a],a>s&&(s=a),n&=~o}if(n=s,n=lt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*rA(n/1960))-n,10<n){e.timeoutHandle=ig(ls.bind(null,e,Wt,en),n);break}ls(e,Wt,en);break;case 5:ls(e,Wt,en);break;default:throw Error(J(329))}}}return Yt(e,lt()),e.callbackNode===r?YN.bind(null,e):null}function Ng(e,t){var r=Ai;return e.current.memoizedState.isDehydrated&&(xs(e,t).flags|=256),e=oc(e,t),e!==2&&(t=Wt,Wt=r,t!==null&&Cg(t)),e}function Cg(e){Wt===null?Wt=e:Wt.push.apply(Wt,e)}function nA(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],o=s.getSnapshot;s=s.value;try{if(!Ir(o(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function An(e,t){for(t&=~Bv,t&=~Vc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Rr(t),n=1<<r;e[r]=-1,t&=~n}}function tb(e){if(Le&6)throw Error(J(327));ho();var t=ql(e,0);if(!(t&1))return Yt(e,lt()),null;var r=oc(e,t);if(e.tag!==0&&r===2){var n=Zx(e);n!==0&&(t=n,r=Ng(e,n))}if(r===1)throw r=Zi,xs(e,0),An(e,t),Yt(e,lt()),r;if(r===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ls(e,Wt,en),Yt(e,lt()),null}function Hv(e,t){var r=Le;Le|=1;try{return e(t)}finally{Le=r,Le===0&&(ko=lt()+500,Bc&&ts())}}function ks(e){Dn!==null&&Dn.tag===0&&!(Le&6)&&ho();var t=Le;Le|=1;var r=xr.transition,n=Ue;try{if(xr.transition=null,Ue=1,e)return e()}finally{Ue=n,xr.transition=r,Le=t,!(Le&6)&&ts()}}function Uv(){er=no.current,Qe(no)}function xs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,PR(r)),ut!==null)for(r=ut.return;r!==null;){var n=r;switch(kv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Vl();break;case 3:jo(),Qe(Gt),Qe(Pt),Ov();break;case 5:Pv(n);break;case 4:jo();break;case 13:Qe(tt);break;case 19:Qe(tt);break;case 10:Tv(n.type._context);break;case 22:case 23:Uv()}r=r.return}if(_t=e,ut=e=Hn(e.current,null),Nt=er=t,gt=0,Zi=null,Bv=Vc=Ss=0,Wt=Ai=null,ds!==null){for(t=0;t<ds.length;t++)if(r=ds[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,o=r.pending;if(o!==null){var a=o.next;o.next=s,n.next=a}r.pending=n}ds=null}return e}function XN(e,t){do{var r=ut;try{if(Ev(),Nl.current=tc,ec){for(var n=rt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ec=!1}if(js=0,yt=ht=rt=null,Ti=!1,Yi=0,qv.current=null,r===null||r.return===null){gt=1,Zi=t,ut=null;break}e:{var o=e,a=r.return,l=r,c=t;if(t=Nt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=B0(a);if(h!==null){h.flags&=-257,W0(h,a,l,o,t),h.mode&1&&q0(o,d,t),t=h,c=d;var g=t.updateQueue;if(g===null){var x=new Set;x.add(c),t.updateQueue=x}else g.add(c);break e}else{if(!(t&1)){q0(o,d,t),Vv();break e}c=Error(J(426))}}else if(Ze&&l.mode&1){var _=B0(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),W0(_,a,l,o,t),Nv(So(c,l));break e}}o=c=So(c,l),gt!==4&&(gt=2),Ai===null?Ai=[o]:Ai.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=PN(o,c,t);M0(o,v);break e;case 1:l=c;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Bn===null||!Bn.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var j=ON(o,l,t);M0(o,j);break e}}o=o.return}while(o!==null)}JN(r)}catch(N){t=N,ut===r&&r!==null&&(ut=r=r.return);continue}break}while(!0)}function QN(){var e=rc.current;return rc.current=tc,e===null?tc:e}function Vv(){(gt===0||gt===3||gt===2)&&(gt=4),_t===null||!(Ss&268435455)&&!(Vc&268435455)||An(_t,Nt)}function oc(e,t){var r=Le;Le|=2;var n=QN();(_t!==e||Nt!==t)&&(en=null,xs(e,t));do try{sA();break}catch(s){XN(e,s)}while(!0);if(Ev(),Le=r,rc.current=n,ut!==null)throw Error(J(261));return _t=null,Nt=0,gt}function sA(){for(;ut!==null;)ZN(ut)}function oA(){for(;ut!==null&&!R5();)ZN(ut)}function ZN(e){var t=tC(e.alternate,e,er);e.memoizedProps=e.pendingProps,t===null?JN(e):ut=t,qv.current=null}function JN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=ZR(r,t),r!==null){r.flags&=32767,ut=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{gt=6,ut=null;return}}else if(r=QR(r,t,er),r!==null){ut=r;return}if(t=t.sibling,t!==null){ut=t;return}ut=t=e}while(t!==null);gt===0&&(gt=5)}function ls(e,t,r){var n=Ue,s=xr.transition;try{xr.transition=null,Ue=1,iA(e,t,r,n)}finally{xr.transition=s,Ue=n}return null}function iA(e,t,r,n){do ho();while(Dn!==null);if(Le&6)throw Error(J(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if($5(e,o),e===_t&&(ut=_t=null,Nt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ya||(Ya=!0,rC($l,function(){return ho(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=xr.transition,xr.transition=null;var a=Ue;Ue=1;var l=Le;Le|=4,qv.current=null,eA(e,r),GN(r,e),NR(sg),Bl=!!ng,sg=ng=null,e.current=r,tA(r),A5(),Le=l,Ue=a,xr.transition=o}else e.current=r;if(Ya&&(Ya=!1,Dn=e,sc=s),o=e.pendingLanes,o===0&&(Bn=null),O5(r.stateNode),Yt(e,lt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(nc)throw nc=!1,e=Sg,Sg=null,e;return sc&1&&e.tag!==0&&ho(),o=e.pendingLanes,o&1?e===kg?Ii++:(Ii=0,kg=e):Ii=0,ts(),null}function ho(){if(Dn!==null){var e=Pk(sc),t=xr.transition,r=Ue;try{if(xr.transition=null,Ue=16>e?16:e,Dn===null)var n=!1;else{if(e=Dn,Dn=null,sc=0,Le&6)throw Error(J(331));var s=Le;for(Le|=4,le=e.current;le!==null;){var o=le,a=o.child;if(le.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(le=d;le!==null;){var u=le;switch(u.tag){case 0:case 11:case 15:Ri(8,u,o)}var f=u.child;if(f!==null)f.return=u,le=f;else for(;le!==null;){u=le;var p=u.sibling,h=u.return;if(HN(u),u===d){le=null;break}if(p!==null){p.return=h,le=p;break}le=h}}}var g=o.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var _=x.sibling;x.sibling=null,x=_}while(x!==null)}}le=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,le=a;else e:for(;le!==null;){if(o=le,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ri(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,le=v;break e}le=o.return}}var y=e.current;for(le=y;le!==null;){a=le;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,le=b;else e:for(a=y;le!==null;){if(l=le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Uc(9,l)}}catch(N){ot(l,l.return,N)}if(l===a){le=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,le=j;break e}le=l.return}}if(Le=s,ts(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(Lc,e)}catch{}n=!0}return n}finally{Ue=r,xr.transition=t}}return!1}function rb(e,t,r){t=So(r,t),t=PN(e,t,1),e=qn(e,t,1),t=Ft(),e!==null&&(xa(e,1,t),Yt(e,t))}function ot(e,t,r){if(e.tag===3)rb(e,e,r);else for(;t!==null;){if(t.tag===3){rb(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Bn===null||!Bn.has(n))){e=So(r,e),e=ON(t,e,1),t=qn(t,e,1),e=Ft(),t!==null&&(xa(t,1,e),Yt(t,e));break}}t=t.return}}function aA(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ft(),e.pingedLanes|=e.suspendedLanes&r,_t===e&&(Nt&r)===r&&(gt===4||gt===3&&(Nt&130023424)===Nt&&500>lt()-Wv?xs(e,0):Bv|=r),Yt(e,t)}function eC(e,t){t===0&&(e.mode&1?(t=Fa,Fa<<=1,!(Fa&130023424)&&(Fa=4194304)):t=1);var r=Ft();e=pn(e,t),e!==null&&(xa(e,t,r),Yt(e,r))}function lA(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),eC(e,r)}function cA(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(J(314))}n!==null&&n.delete(t),eC(e,r)}var tC;tC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Gt.current)Ht=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ht=!1,XR(e,t,r);Ht=!!(e.flags&131072)}else Ht=!1,Ze&&t.flags&1048576&&oN(t,Yl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;El(e,t),e=t.pendingProps;var s=bo(t,Pt.current);po(t,r),s=Dv(null,t,n,e,s,r);var o=Lv();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kt(n)?(o=!0,Gl(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Av(t),s.updater=Hc,t.stateNode=s,s._reactInternals=t,pg(t,n,e,r),t=xg(null,t,n,!0,o,r)):(t.tag=0,Ze&&o&&Sv(t),Lt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(El(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=dA(n),e=kr(n,e),s){case 0:t=mg(null,t,n,e,r);break e;case 1:t=V0(null,t,n,e,r);break e;case 11:t=H0(null,t,n,e,r);break e;case 14:t=U0(null,t,n,kr(n.type,e),r);break e}throw Error(J(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),mg(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),V0(e,t,n,s,r);case 3:e:{if(zN(t),e===null)throw Error(J(387));n=t.pendingProps,o=t.memoizedState,s=o.element,dN(e,t),Zl(t,n,null,r);var a=t.memoizedState;if(n=a.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=So(Error(J(423)),t),t=G0(e,t,n,r,s);break e}else if(n!==s){s=So(Error(J(424)),t),t=G0(e,t,n,r,s);break e}else for(rr=$n(t.stateNode.containerInfo.firstChild),nr=t,Ze=!0,Er=null,r=cN(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_o(),n===s){t=hn(e,t,r);break e}Lt(e,t,n,r)}t=t.child}return t;case 5:return fN(t),e===null&&ug(t),n=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,a=s.children,og(n,s)?a=null:o!==null&&og(n,o)&&(t.flags|=32),LN(e,t),Lt(e,t,a,r),t.child;case 6:return e===null&&ug(t),null;case 13:return FN(e,t,r);case 4:return Iv(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=wo(t,null,n,r):Lt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),H0(e,t,n,s,r);case 7:return Lt(e,t,t.pendingProps,r),t.child;case 8:return Lt(e,t,t.pendingProps.children,r),t.child;case 12:return Lt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,o=t.memoizedProps,a=s.value,Ke(Xl,n._currentValue),n._currentValue=a,o!==null)if(Ir(o.value,a)){if(o.children===s.children&&!Gt.current){t=hn(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){a=o.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=cn(-1,r&-r),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),dg(o.return,r,t),l.lanes|=r;break}c=c.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(J(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),dg(a,r,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Lt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,po(t,r),s=gr(s),n=n(s),t.flags|=1,Lt(e,t,n,r),t.child;case 14:return n=t.type,s=kr(n,t.pendingProps),s=kr(n.type,s),U0(e,t,n,s,r);case 15:return MN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),El(e,t),t.tag=1,Kt(n)?(e=!0,Gl(t)):e=!1,po(t,r),IN(t,n,s),pg(t,n,s,r),xg(null,t,n,!0,e,r);case 19:return $N(e,t,r);case 22:return DN(e,t,r)}throw Error(J(156,t.tag))};function rC(e,t){return Tk(e,t)}function uA(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(e,t,r,n){return new uA(e,t,r,n)}function Gv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dA(e){if(typeof e=="function")return Gv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===fv)return 11;if(e===pv)return 14}return 2}function Hn(e,t){var r=e.alternate;return r===null?(r=hr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Al(e,t,r,n,s,o){var a=2;if(n=e,typeof e=="function")Gv(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Gs:return gs(r.children,s,o,t);case dv:a=8,s|=8;break;case Lx:return e=hr(12,r,t,s|2),e.elementType=Lx,e.lanes=o,e;case zx:return e=hr(13,r,t,s),e.elementType=zx,e.lanes=o,e;case Fx:return e=hr(19,r,t,s),e.elementType=Fx,e.lanes=o,e;case fk:return Gc(r,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case uk:a=10;break e;case dk:a=9;break e;case fv:a=11;break e;case pv:a=14;break e;case kn:a=16,n=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=hr(a,r,t,s),t.elementType=e,t.type=n,t.lanes=o,t}function gs(e,t,r,n){return e=hr(7,e,n,t),e.lanes=r,e}function Gc(e,t,r,n){return e=hr(22,e,n,t),e.elementType=fk,e.lanes=r,e.stateNode={isHidden:!1},e}function id(e,t,r){return e=hr(6,e,null,t),e.lanes=r,e}function ad(e,t,r){return t=hr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function fA(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qu(0),this.expirationTimes=qu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qu(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Kv(e,t,r,n,s,o,a,l,c){return e=new fA(e,t,r,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=hr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Av(o),e}function pA(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function nC(e){if(!e)return Xn;e=e._reactInternals;e:{if(Ts(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var r=e.type;if(Kt(r))return nN(e,r,t)}return t}function sC(e,t,r,n,s,o,a,l,c){return e=Kv(r,n,!0,e,s,o,a,l,c),e.context=nC(null),r=e.current,n=Ft(),s=Wn(r),o=cn(n,s),o.callback=t??null,qn(r,o,s),e.current.lanes=s,xa(e,s,n),Yt(e,n),e}function Kc(e,t,r,n){var s=t.current,o=Ft(),a=Wn(s);return r=nC(r),t.context===null?t.context=r:t.pendingContext=r,t=cn(o,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=qn(s,t,a),e!==null&&(Ar(e,s,a,o),kl(e,s,a)),a}function ic(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function nb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Yv(e,t){nb(e,t),(e=e.alternate)&&nb(e,t)}function hA(){return null}var oC=typeof reportError=="function"?reportError:function(e){console.error(e)};function Xv(e){this._internalRoot=e}Yc.prototype.render=Xv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));Kc(e,t,null,null)};Yc.prototype.unmount=Xv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ks(function(){Kc(null,e,null,null)}),t[fn]=null}};function Yc(e){this._internalRoot=e}Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Dk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Rn.length&&t!==0&&t<Rn[r].priority;r++);Rn.splice(r,0,e),r===0&&zk(e)}};function Qv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Xc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function sb(){}function mA(e,t,r,n,s){if(s){if(typeof n=="function"){var o=n;n=function(){var d=ic(a);o.call(d)}}var a=sC(t,n,e,0,null,!1,!1,"",sb);return e._reactRootContainer=a,e[fn]=a.current,Hi(e.nodeType===8?e.parentNode:e),ks(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=ic(c);l.call(d)}}var c=Kv(e,0,!1,null,null,!1,!1,"",sb);return e._reactRootContainer=c,e[fn]=c.current,Hi(e.nodeType===8?e.parentNode:e),ks(function(){Kc(t,c,r,n)}),c}function Qc(e,t,r,n,s){var o=r._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var l=s;s=function(){var c=ic(a);l.call(c)}}Kc(t,a,e,s)}else a=mA(r,t,e,s,n);return ic(a)}Ok=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=pi(t.pendingLanes);r!==0&&(xv(t,r|1),Yt(t,lt()),!(Le&6)&&(ko=lt()+500,ts()))}break;case 13:ks(function(){var n=pn(e,1);if(n!==null){var s=Ft();Ar(n,e,1,s)}}),Yv(e,1)}};gv=function(e){if(e.tag===13){var t=pn(e,134217728);if(t!==null){var r=Ft();Ar(t,e,134217728,r)}Yv(e,134217728)}};Mk=function(e){if(e.tag===13){var t=Wn(e),r=pn(e,t);if(r!==null){var n=Ft();Ar(r,e,t,n)}Yv(e,t)}};Dk=function(){return Ue};Lk=function(e,t){var r=Ue;try{return Ue=e,t()}finally{Ue=r}};Yx=function(e,t,r){switch(t){case"input":if(Bx(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=qc(n);if(!s)throw Error(J(90));hk(n),Bx(n,s)}}}break;case"textarea":xk(e,r);break;case"select":t=r.value,t!=null&&lo(e,!!r.multiple,t,!1)}};jk=Hv;Sk=ks;var xA={usingClientEntryPoint:!1,Events:[va,Qs,qc,_k,wk,Hv]},Zo={findFiberByHostInstance:us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gA={bundleType:Zo.bundleType,version:Zo.version,rendererPackageName:Zo.rendererPackageName,rendererConfig:Zo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ck(e),e===null?null:e.stateNode},findFiberByHostInstance:Zo.findFiberByHostInstance||hA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xa.isDisabled&&Xa.supportsFiber)try{Lc=Xa.inject(gA),Hr=Xa}catch{}}ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xA;ir.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qv(t))throw Error(J(200));return pA(e,t,null,r)};ir.createRoot=function(e,t){if(!Qv(e))throw Error(J(299));var r=!1,n="",s=oC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Kv(e,1,!1,null,null,r,!1,n,s),e[fn]=t.current,Hi(e.nodeType===8?e.parentNode:e),new Xv(t)};ir.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=Ck(t),e=e===null?null:e.stateNode,e};ir.flushSync=function(e){return ks(e)};ir.hydrate=function(e,t,r){if(!Xc(t))throw Error(J(200));return Qc(null,e,t,!0,r)};ir.hydrateRoot=function(e,t,r){if(!Qv(e))throw Error(J(405));var n=r!=null&&r.hydratedSources||null,s=!1,o="",a=oC;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=sC(t,null,e,1,r??null,s,!1,o,a),e[fn]=t.current,Hi(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Yc(t)};ir.render=function(e,t,r){if(!Xc(t))throw Error(J(200));return Qc(null,e,t,!1,r)};ir.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(J(40));return e._reactRootContainer?(ks(function(){Qc(null,null,e,!1,function(){e._reactRootContainer=null,e[fn]=null})}),!0):!1};ir.unstable_batchedUpdates=Hv;ir.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xc(r))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return Qc(e,t,r,!1,n)};ir.version="18.3.1-next-f1338f8080-20240426";function iC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iC)}catch(e){console.error(e)}}iC(),ik.exports=ir;var so=ik.exports,ob=so;Mx.createRoot=ob.createRoot,Mx.hydrateRoot=ob.hydrateRoot;function Qt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Qt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var aC={exports:{}},lC={},cC={exports:{}},uC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var No=m;function vA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yA=typeof Object.is=="function"?Object.is:vA,bA=No.useState,_A=No.useEffect,wA=No.useLayoutEffect,jA=No.useDebugValue;function SA(e,t){var r=t(),n=bA({inst:{value:r,getSnapshot:t}}),s=n[0].inst,o=n[1];return wA(function(){s.value=r,s.getSnapshot=t,ld(s)&&o({inst:s})},[e,r,t]),_A(function(){return ld(s)&&o({inst:s}),e(function(){ld(s)&&o({inst:s})})},[e]),jA(r),r}function ld(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!yA(e,r)}catch{return!0}}function kA(e,t){return t()}var NA=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?kA:SA;uC.useSyncExternalStore=No.useSyncExternalStore!==void 0?No.useSyncExternalStore:NA;cC.exports=uC;var CA=cC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zc=m,EA=CA;function TA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var RA=typeof Object.is=="function"?Object.is:TA,AA=EA.useSyncExternalStore,IA=Zc.useRef,PA=Zc.useEffect,OA=Zc.useMemo,MA=Zc.useDebugValue;lC.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var o=IA(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=OA(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),s!==void 0&&a.hasValue){var g=a.value;if(s(g,h))return f=g}return f=h}if(g=f,RA(u,h))return g;var x=n(h);return s!==void 0&&s(g,x)?(u=h,g):(u=h,f=x)}var d=!1,u,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,s]);var l=AA(e,o[0],o[1]);return PA(function(){a.hasValue=!0,a.value=l},[l]),MA(l),l};aC.exports=lC;var DA=aC.exports;const LA=nv(DA),zA={},ib=e=>{let t;const r=new Set,n=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(g=>g(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>d,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(zA?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,s,c);return c},FA=e=>e?ib(e):ib,{useDebugValue:$A}=Y,{useSyncExternalStoreWithSelector:qA}=LA,BA=e=>e;function dC(e,t=BA,r){const n=qA(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return $A(n),n}const ab=(e,t)=>{const r=FA(e),n=(s,o=t)=>dC(r,s,o);return Object.assign(n,r),n},WA=(e,t)=>e?ab(e,t):ab;function Ot(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var HA={value:()=>{}};function Jc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Il(r)}function Il(e){this._=e}function UA(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Il.prototype=Jc.prototype={constructor:Il,on:function(e,t){var r=this._,n=UA(e+"",r),s,o=-1,a=n.length;if(arguments.length<2){for(;++o<a;)if((s=(e=n[o]).type)&&(s=VA(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(s=(e=n[o]).type)r[s]=lb(r[s],e.name,t);else if(t==null)for(s in r)r[s]=lb(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Il(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,o;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,s=o.length;n<s;++n)o[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],s=0,o=n.length;s<o;++s)n[s].value.apply(t,r)}};function VA(e,t){for(var r=0,n=e.length,s;r<n;++r)if((s=e[r]).name===t)return s.value}function lb(e,t,r){for(var n=0,s=e.length;n<s;++n)if(e[n].name===t){e[n]=HA,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var Eg="http://www.w3.org/1999/xhtml";const cb={svg:"http://www.w3.org/2000/svg",xhtml:Eg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function eu(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),cb.hasOwnProperty(t)?{space:cb[t],local:e}:e}function GA(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===Eg&&t.documentElement.namespaceURI===Eg?t.createElement(e):t.createElementNS(r,e)}}function KA(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function fC(e){var t=eu(e);return(t.local?KA:GA)(t)}function YA(){}function Zv(e){return e==null?YA:function(){return this.querySelector(e)}}function XA(e){typeof e!="function"&&(e=Zv(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],a=o.length,l=n[s]=new Array(a),c,d,u=0;u<a;++u)(c=o[u])&&(d=e.call(c,c.__data__,u,o))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new or(n,this._parents)}function QA(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ZA(){return[]}function pC(e){return e==null?ZA:function(){return this.querySelectorAll(e)}}function JA(e){return function(){return QA(e.apply(this,arguments))}}function e6(e){typeof e=="function"?e=JA(e):e=pC(e);for(var t=this._groups,r=t.length,n=[],s=[],o=0;o<r;++o)for(var a=t[o],l=a.length,c,d=0;d<l;++d)(c=a[d])&&(n.push(e.call(c,c.__data__,d,a)),s.push(c));return new or(n,s)}function hC(e){return function(){return this.matches(e)}}function mC(e){return function(t){return t.matches(e)}}var t6=Array.prototype.find;function r6(e){return function(){return t6.call(this.children,e)}}function n6(){return this.firstElementChild}function s6(e){return this.select(e==null?n6:r6(typeof e=="function"?e:mC(e)))}var o6=Array.prototype.filter;function i6(){return Array.from(this.children)}function a6(e){return function(){return o6.call(this.children,e)}}function l6(e){return this.selectAll(e==null?i6:a6(typeof e=="function"?e:mC(e)))}function c6(e){typeof e!="function"&&(e=hC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],a=o.length,l=n[s]=[],c,d=0;d<a;++d)(c=o[d])&&e.call(c,c.__data__,d,o)&&l.push(c);return new or(n,this._parents)}function xC(e){return new Array(e.length)}function u6(){return new or(this._enter||this._groups.map(xC),this._parents)}function ac(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ac.prototype={constructor:ac,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function d6(e){return function(){return e}}function f6(e,t,r,n,s,o){for(var a=0,l,c=t.length,d=o.length;a<d;++a)(l=t[a])?(l.__data__=o[a],n[a]=l):r[a]=new ac(e,o[a]);for(;a<c;++a)(l=t[a])&&(s[a]=l)}function p6(e,t,r,n,s,o,a){var l,c,d=new Map,u=t.length,f=o.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=a.call(c,c.__data__,l,t)+"",d.has(h)?s[l]=c:d.set(h,c));for(l=0;l<f;++l)h=a.call(e,o[l],l,o)+"",(c=d.get(h))?(n[l]=c,c.__data__=o[l],d.delete(h)):r[l]=new ac(e,o[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(s[l]=c)}function h6(e){return e.__data__}function m6(e,t){if(!arguments.length)return Array.from(this,h6);var r=t?p6:f6,n=this._parents,s=this._groups;typeof e!="function"&&(e=d6(e));for(var o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),d=0;d<o;++d){var u=n[d],f=s[d],p=f.length,h=x6(e.call(u,u&&u.__data__,d,n)),g=h.length,x=l[d]=new Array(g),_=a[d]=new Array(g),v=c[d]=new Array(p);r(u,f,x,_,v,h,t);for(var y=0,b=0,j,N;y<g;++y)if(j=x[y]){for(y>=b&&(b=y+1);!(N=_[b])&&++b<g;);j._next=N||null}}return a=new or(a,n),a._enter=l,a._exit=c,a}function x6(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function g6(){return new or(this._exit||this._groups.map(xC),this._parents)}function v6(e,t,r){var n=this.enter(),s=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?o.remove():r(o),n&&s?n.merge(s).order():s}function y6(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,s=r.length,o=n.length,a=Math.min(s,o),l=new Array(s),c=0;c<a;++c)for(var d=r[c],u=n[c],f=d.length,p=l[c]=new Array(f),h,g=0;g<f;++g)(h=d[g]||u[g])&&(p[g]=h);for(;c<s;++c)l[c]=r[c];return new or(l,this._parents)}function b6(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],s=n.length-1,o=n[s],a;--s>=0;)(a=n[s])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function _6(e){e||(e=w6);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,s=new Array(n),o=0;o<n;++o){for(var a=r[o],l=a.length,c=s[o]=new Array(l),d,u=0;u<l;++u)(d=a[u])&&(c[u]=d);c.sort(t)}return new or(s,this._parents).order()}function w6(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function j6(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function S6(){return Array.from(this)}function k6(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length;s<o;++s){var a=n[s];if(a)return a}return null}function N6(){let e=0;for(const t of this)++e;return e}function C6(){return!this.node()}function E6(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var s=t[r],o=0,a=s.length,l;o<a;++o)(l=s[o])&&e.call(l,l.__data__,o,s);return this}function T6(e){return function(){this.removeAttribute(e)}}function R6(e){return function(){this.removeAttributeNS(e.space,e.local)}}function A6(e,t){return function(){this.setAttribute(e,t)}}function I6(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function P6(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function O6(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function M6(e,t){var r=eu(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?R6:T6:typeof t=="function"?r.local?O6:P6:r.local?I6:A6)(r,t))}function gC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function D6(e){return function(){this.style.removeProperty(e)}}function L6(e,t,r){return function(){this.style.setProperty(e,t,r)}}function z6(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function F6(e,t,r){return arguments.length>1?this.each((t==null?D6:typeof t=="function"?z6:L6)(e,t,r??"")):Co(this.node(),e)}function Co(e,t){return e.style.getPropertyValue(t)||gC(e).getComputedStyle(e,null).getPropertyValue(t)}function $6(e){return function(){delete this[e]}}function q6(e,t){return function(){this[e]=t}}function B6(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function W6(e,t){return arguments.length>1?this.each((t==null?$6:typeof t=="function"?B6:q6)(e,t)):this.node()[e]}function vC(e){return e.trim().split(/^|\s+/)}function Jv(e){return e.classList||new yC(e)}function yC(e){this._node=e,this._names=vC(e.getAttribute("class")||"")}yC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function bC(e,t){for(var r=Jv(e),n=-1,s=t.length;++n<s;)r.add(t[n])}function _C(e,t){for(var r=Jv(e),n=-1,s=t.length;++n<s;)r.remove(t[n])}function H6(e){return function(){bC(this,e)}}function U6(e){return function(){_C(this,e)}}function V6(e,t){return function(){(t.apply(this,arguments)?bC:_C)(this,e)}}function G6(e,t){var r=vC(e+"");if(arguments.length<2){for(var n=Jv(this.node()),s=-1,o=r.length;++s<o;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?V6:t?H6:U6)(r,t))}function K6(){this.textContent=""}function Y6(e){return function(){this.textContent=e}}function X6(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Q6(e){return arguments.length?this.each(e==null?K6:(typeof e=="function"?X6:Y6)(e)):this.node().textContent}function Z6(){this.innerHTML=""}function J6(e){return function(){this.innerHTML=e}}function eI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function tI(e){return arguments.length?this.each(e==null?Z6:(typeof e=="function"?eI:J6)(e)):this.node().innerHTML}function rI(){this.nextSibling&&this.parentNode.appendChild(this)}function nI(){return this.each(rI)}function sI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function oI(){return this.each(sI)}function iI(e){var t=typeof e=="function"?e:fC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function aI(){return null}function lI(e,t){var r=typeof e=="function"?e:fC(e),n=t==null?aI:typeof t=="function"?t:Zv(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function cI(){var e=this.parentNode;e&&e.removeChild(this)}function uI(){return this.each(cI)}function dI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function pI(e){return this.select(e?fI:dI)}function hI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function mI(e){return function(t){e.call(this,t,this.__data__)}}function xI(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function gI(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,s=t.length,o;r<s;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function vI(e,t,r){return function(){var n=this.__on,s,o=mI(t);if(n){for(var a=0,l=n.length;a<l;++a)if((s=n[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=r),s.value=t;return}}this.addEventListener(e.type,o,r),s={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(s):this.__on=[s]}}function yI(e,t,r){var n=xI(e+""),s,o=n.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(s=0,u=l[c];s<o;++s)if((a=n[s]).type===u.type&&a.name===u.name)return u.value}return}for(l=t?vI:gI,s=0;s<o;++s)this.each(l(n[s],t,r));return this}function wC(e,t,r){var n=gC(e),s=n.CustomEvent;typeof s=="function"?s=new s(t,r):(s=n.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function bI(e,t){return function(){return wC(this,e,t)}}function _I(e,t){return function(){return wC(this,e,t.apply(this,arguments))}}function wI(e,t){return this.each((typeof t=="function"?_I:bI)(e,t))}function*jI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length,a;s<o;++s)(a=n[s])&&(yield a)}var jC=[null];function or(e,t){this._groups=e,this._parents=t}function ba(){return new or([[document.documentElement]],jC)}function SI(){return this}or.prototype=ba.prototype={constructor:or,select:XA,selectAll:e6,selectChild:s6,selectChildren:l6,filter:c6,data:m6,enter:u6,exit:g6,join:v6,merge:y6,selection:SI,order:b6,sort:_6,call:j6,nodes:S6,node:k6,size:N6,empty:C6,each:E6,attr:M6,style:F6,property:W6,classed:G6,text:Q6,html:tI,raise:nI,lower:oI,append:iI,insert:lI,remove:uI,clone:pI,datum:hI,on:yI,dispatch:wI,[Symbol.iterator]:jI};function pr(e){return typeof e=="string"?new or([[document.querySelector(e)]],[document.documentElement]):new or([[e]],jC)}function kI(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Cr(e,t){if(e=kI(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const NI={passive:!1},Ji={capture:!0,passive:!1};function cd(e){e.stopImmediatePropagation()}function mo(e){e.preventDefault(),e.stopImmediatePropagation()}function SC(e){var t=e.document.documentElement,r=pr(e).on("dragstart.drag",mo,Ji);"onselectstart"in t?r.on("selectstart.drag",mo,Ji):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function kC(e,t){var r=e.document.documentElement,n=pr(e).on("dragstart.drag",null);t&&(n.on("click.drag",mo,Ji),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Qa=e=>()=>e;function Tg(e,{sourceEvent:t,subject:r,target:n,identifier:s,active:o,x:a,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}Tg.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function CI(e){return!e.ctrlKey&&!e.button}function EI(){return this.parentNode}function TI(e,t){return t??{x:e.x,y:e.y}}function RI(){return navigator.maxTouchPoints||"ontouchstart"in this}function AI(){var e=CI,t=EI,r=TI,n=RI,s={},o=Jc("start","drag","end"),a=0,l,c,d,u,f=0;function p(j){j.on("mousedown.drag",h).filter(n).on("touchstart.drag",_).on("touchmove.drag",v,NI).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(j,N){if(!(u||!e.call(this,j,N))){var T=b(this,t.call(this,j,N),j,N,"mouse");T&&(pr(j.view).on("mousemove.drag",g,Ji).on("mouseup.drag",x,Ji),SC(j.view),cd(j),d=!1,l=j.clientX,c=j.clientY,T("start",j))}}function g(j){if(mo(j),!d){var N=j.clientX-l,T=j.clientY-c;d=N*N+T*T>f}s.mouse("drag",j)}function x(j){pr(j.view).on("mousemove.drag mouseup.drag",null),kC(j.view,d),mo(j),s.mouse("end",j)}function _(j,N){if(e.call(this,j,N)){var T=j.changedTouches,C=t.call(this,j,N),S=T.length,w,A;for(w=0;w<S;++w)(A=b(this,C,j,N,T[w].identifier,T[w]))&&(cd(j),A("start",j,T[w]))}}function v(j){var N=j.changedTouches,T=N.length,C,S;for(C=0;C<T;++C)(S=s[N[C].identifier])&&(mo(j),S("drag",j,N[C]))}function y(j){var N=j.changedTouches,T=N.length,C,S;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),C=0;C<T;++C)(S=s[N[C].identifier])&&(cd(j),S("end",j,N[C]))}function b(j,N,T,C,S,w){var A=o.copy(),E=Cr(w||T,N),O,z,k;if((k=r.call(j,new Tg("beforestart",{sourceEvent:T,target:p,identifier:S,active:a,x:E[0],y:E[1],dx:0,dy:0,dispatch:A}),C))!=null)return O=k.x-E[0]||0,z=k.y-E[1]||0,function P(R,D,L){var I=E,M;switch(R){case"start":s[S]=P,M=a++;break;case"end":delete s[S],--a;case"drag":E=Cr(L||D,N),M=a;break}A.call(R,j,new Tg(R,{sourceEvent:D,subject:k,target:p,identifier:S,active:M,x:E[0]+O,y:E[1]+z,dx:E[0]-I[0],dy:E[1]-I[1],dispatch:A}),C)}}return p.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Qa(!!j),p):e},p.container=function(j){return arguments.length?(t=typeof j=="function"?j:Qa(j),p):t},p.subject=function(j){return arguments.length?(r=typeof j=="function"?j:Qa(j),p):r},p.touchable=function(j){return arguments.length?(n=typeof j=="function"?j:Qa(!!j),p):n},p.on=function(){var j=o.on.apply(o,arguments);return j===o?p:j},p.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,p):Math.sqrt(f)},p}function ey(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function NC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function _a(){}var ea=.7,lc=1/ea,xo="\\s*([+-]?\\d+)\\s*",ta="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",II=/^#([0-9a-f]{3,8})$/,PI=new RegExp(`^rgb\\(${xo},${xo},${xo}\\)$`),OI=new RegExp(`^rgb\\(${Vr},${Vr},${Vr}\\)$`),MI=new RegExp(`^rgba\\(${xo},${xo},${xo},${ta}\\)$`),DI=new RegExp(`^rgba\\(${Vr},${Vr},${Vr},${ta}\\)$`),LI=new RegExp(`^hsl\\(${ta},${Vr},${Vr}\\)$`),zI=new RegExp(`^hsla\\(${ta},${Vr},${Vr},${ta}\\)$`),ub={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ey(_a,ra,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:db,formatHex:db,formatHex8:FI,formatHsl:$I,formatRgb:fb,toString:fb});function db(){return this.rgb().formatHex()}function FI(){return this.rgb().formatHex8()}function $I(){return CC(this).formatHsl()}function fb(){return this.rgb().formatRgb()}function ra(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=II.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?pb(t):r===3?new Ut(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Za(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Za(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=PI.exec(e))?new Ut(t[1],t[2],t[3],1):(t=OI.exec(e))?new Ut(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=MI.exec(e))?Za(t[1],t[2],t[3],t[4]):(t=DI.exec(e))?Za(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=LI.exec(e))?xb(t[1],t[2]/100,t[3]/100,1):(t=zI.exec(e))?xb(t[1],t[2]/100,t[3]/100,t[4]):ub.hasOwnProperty(e)?pb(ub[e]):e==="transparent"?new Ut(NaN,NaN,NaN,0):null}function pb(e){return new Ut(e>>16&255,e>>8&255,e&255,1)}function Za(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ut(e,t,r,n)}function qI(e){return e instanceof _a||(e=ra(e)),e?(e=e.rgb(),new Ut(e.r,e.g,e.b,e.opacity)):new Ut}function Rg(e,t,r,n){return arguments.length===1?qI(e):new Ut(e,t,r,n??1)}function Ut(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ey(Ut,Rg,NC(_a,{brighter(e){return e=e==null?lc:Math.pow(lc,e),new Ut(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ea:Math.pow(ea,e),new Ut(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ut(vs(this.r),vs(this.g),vs(this.b),cc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hb,formatHex:hb,formatHex8:BI,formatRgb:mb,toString:mb}));function hb(){return`#${ps(this.r)}${ps(this.g)}${ps(this.b)}`}function BI(){return`#${ps(this.r)}${ps(this.g)}${ps(this.b)}${ps((isNaN(this.opacity)?1:this.opacity)*255)}`}function mb(){const e=cc(this.opacity);return`${e===1?"rgb(":"rgba("}${vs(this.r)}, ${vs(this.g)}, ${vs(this.b)}${e===1?")":`, ${e})`}`}function cc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ps(e){return e=vs(e),(e<16?"0":"")+e.toString(16)}function xb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Tr(e,t,r,n)}function CC(e){if(e instanceof Tr)return new Tr(e.h,e.s,e.l,e.opacity);if(e instanceof _a||(e=ra(e)),!e)return new Tr;if(e instanceof Tr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,l=o-s,c=(o+s)/2;return l?(t===o?a=(r-n)/l+(r<n)*6:r===o?a=(n-t)/l+2:a=(t-r)/l+4,l/=c<.5?o+s:2-o-s,a*=60):l=c>0&&c<1?0:a,new Tr(a,l,c,e.opacity)}function WI(e,t,r,n){return arguments.length===1?CC(e):new Tr(e,t,r,n??1)}function Tr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ey(Tr,WI,NC(_a,{brighter(e){return e=e==null?lc:Math.pow(lc,e),new Tr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ea:Math.pow(ea,e),new Tr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new Ut(ud(e>=240?e-240:e+120,s,n),ud(e,s,n),ud(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new Tr(gb(this.h),Ja(this.s),Ja(this.l),cc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=cc(this.opacity);return`${e===1?"hsl(":"hsla("}${gb(this.h)}, ${Ja(this.s)*100}%, ${Ja(this.l)*100}%${e===1?")":`, ${e})`}`}}));function gb(e){return e=(e||0)%360,e<0?e+360:e}function Ja(e){return Math.max(0,Math.min(1,e||0))}function ud(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const EC=e=>()=>e;function HI(e,t){return function(r){return e+r*t}}function UI(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function VI(e){return(e=+e)==1?TC:function(t,r){return r-t?UI(t,r,e):EC(isNaN(t)?r:t)}}function TC(e,t){var r=t-e;return r?HI(e,r):EC(isNaN(e)?t:e)}const vb=function e(t){var r=VI(t);function n(s,o){var a=r((s=Rg(s)).r,(o=Rg(o)).r),l=r(s.g,o.g),c=r(s.b,o.b),d=TC(s.opacity,o.opacity);return function(u){return s.r=a(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return n.gamma=e,n}(1);function Cn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var Ag=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dd=new RegExp(Ag.source,"g");function GI(e){return function(){return e}}function KI(e){return function(t){return e(t)+""}}function YI(e,t){var r=Ag.lastIndex=dd.lastIndex=0,n,s,o,a=-1,l=[],c=[];for(e=e+"",t=t+"";(n=Ag.exec(e))&&(s=dd.exec(t));)(o=s.index)>r&&(o=t.slice(r,o),l[a]?l[a]+=o:l[++a]=o),(n=n[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:Cn(n,s)})),r=dd.lastIndex;return r<t.length&&(o=t.slice(r),l[a]?l[a]+=o:l[++a]=o),l.length<2?c[0]?KI(c[0].x):GI(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var yb=180/Math.PI,Ig={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function RC(e,t,r,n,s,o){var a,l,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,a=-a),{translateX:s,translateY:o,rotate:Math.atan2(t,e)*yb,skewX:Math.atan(c)*yb,scaleX:a,scaleY:l}}var el;function XI(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ig:RC(t.a,t.b,t.c,t.d,t.e,t.f)}function QI(e){return e==null||(el||(el=document.createElementNS("http://www.w3.org/2000/svg","g")),el.setAttribute("transform",e),!(e=el.transform.baseVal.consolidate()))?Ig:(e=e.matrix,RC(e.a,e.b,e.c,e.d,e.e,e.f))}function AC(e,t,r,n){function s(d){return d.length?d.pop()+" ":""}function o(d,u,f,p,h,g){if(d!==f||u!==p){var x=h.push("translate(",null,t,null,r);g.push({i:x-4,x:Cn(d,f)},{i:x-2,x:Cn(u,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function a(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(s(f)+"rotate(",null,n)-2,x:Cn(d,u)})):u&&f.push(s(f)+"rotate("+u+n)}function l(d,u,f,p){d!==u?p.push({i:f.push(s(f)+"skewX(",null,n)-2,x:Cn(d,u)}):u&&f.push(s(f)+"skewX("+u+n)}function c(d,u,f,p,h,g){if(d!==f||u!==p){var x=h.push(s(h)+"scale(",null,",",null,")");g.push({i:x-4,x:Cn(d,f)},{i:x-2,x:Cn(u,p)})}else(f!==1||p!==1)&&h.push(s(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),o(d.translateX,d.translateY,u.translateX,u.translateY,f,p),a(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var g=-1,x=p.length,_;++g<x;)f[(_=p[g]).i]=_.x(h);return f.join("")}}}var ZI=AC(XI,"px, ","px)","deg)"),JI=AC(QI,", ",")",")"),eP=1e-12;function bb(e){return((e=Math.exp(e))+1/e)/2}function tP(e){return((e=Math.exp(e))-1/e)/2}function rP(e){return((e=Math.exp(2*e))-1)/(e+1)}const nP=function e(t,r,n){function s(o,a){var l=o[0],c=o[1],d=o[2],u=a[0],f=a[1],p=a[2],h=u-l,g=f-c,x=h*h+g*g,_,v;if(x<eP)v=Math.log(p/d)/t,_=function(C){return[l+C*h,c+C*g,d*Math.exp(t*C*v)]};else{var y=Math.sqrt(x),b=(p*p-d*d+n*x)/(2*d*r*y),j=(p*p-d*d-n*x)/(2*p*r*y),N=Math.log(Math.sqrt(b*b+1)-b),T=Math.log(Math.sqrt(j*j+1)-j);v=(T-N)/t,_=function(C){var S=C*v,w=bb(N),A=d/(r*y)*(w*rP(t*S+N)-tP(N));return[l+A*h,c+A*g,d*w/bb(t*S+N)]}}return _.duration=v*1e3*t/Math.SQRT2,_}return s.rho=function(o){var a=Math.max(.001,+o),l=a*a,c=l*l;return e(a,l,c)},s}(Math.SQRT2,2,4);var Eo=0,mi=0,Jo=0,IC=1e3,uc,xi,dc=0,Ns=0,tu=0,na=typeof performance=="object"&&performance.now?performance:Date,PC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ty(){return Ns||(PC(sP),Ns=na.now()+tu)}function sP(){Ns=0}function fc(){this._call=this._time=this._next=null}fc.prototype=OC.prototype={constructor:fc,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?ty():+r)+(t==null?0:+t),!this._next&&xi!==this&&(xi?xi._next=this:uc=this,xi=this),this._call=e,this._time=r,Pg()},stop:function(){this._call&&(this._call=null,this._time=1/0,Pg())}};function OC(e,t,r){var n=new fc;return n.restart(e,t,r),n}function oP(){ty(),++Eo;for(var e=uc,t;e;)(t=Ns-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Eo}function _b(){Ns=(dc=na.now())+tu,Eo=mi=0;try{oP()}finally{Eo=0,aP(),Ns=0}}function iP(){var e=na.now(),t=e-dc;t>IC&&(tu-=t,dc=e)}function aP(){for(var e,t=uc,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:uc=r);xi=e,Pg(n)}function Pg(e){if(!Eo){mi&&(mi=clearTimeout(mi));var t=e-Ns;t>24?(e<1/0&&(mi=setTimeout(_b,e-na.now()-tu)),Jo&&(Jo=clearInterval(Jo))):(Jo||(dc=na.now(),Jo=setInterval(iP,IC)),Eo=1,PC(_b))}}function wb(e,t,r){var n=new fc;return t=t==null?0:+t,n.restart(s=>{n.stop(),e(s+t)},t,r),n}var lP=Jc("start","end","cancel","interrupt"),cP=[],MC=0,jb=1,Og=2,Pl=3,Sb=4,Mg=5,Ol=6;function ru(e,t,r,n,s,o){var a=e.__transition;if(!a)e.__transition={};else if(r in a)return;uP(e,r,{name:t,index:n,group:s,on:lP,tween:cP,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:MC})}function ry(e,t){var r=Or(e,t);if(r.state>MC)throw new Error("too late; already scheduled");return r}function Yr(e,t){var r=Or(e,t);if(r.state>Pl)throw new Error("too late; already running");return r}function Or(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function uP(e,t,r){var n=e.__transition,s;n[t]=r,r.timer=OC(o,0,r.time);function o(d){r.state=jb,r.timer.restart(a,r.delay,r.time),r.delay<=d&&a(d-r.delay)}function a(d){var u,f,p,h;if(r.state!==jb)return c();for(u in n)if(h=n[u],h.name===r.name){if(h.state===Pl)return wb(a);h.state===Sb?(h.state=Ol,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[u]):+u<t&&(h.state=Ol,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[u])}if(wb(function(){r.state===Pl&&(r.state=Sb,r.timer.restart(l,r.delay,r.time),l(d))}),r.state=Og,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Og){for(r.state=Pl,s=new Array(p=r.tween.length),u=0,f=-1;u<p;++u)(h=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(s[++f]=h);s.length=f+1}}function l(d){for(var u=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(c),r.state=Mg,1),f=-1,p=s.length;++f<p;)s[f].call(e,u);r.state===Mg&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Ol,r.timer.stop(),delete n[t];for(var d in n)return;delete e.__transition}}function Ml(e,t){var r=e.__transition,n,s,o=!0,a;if(r){t=t==null?null:t+"";for(a in r){if((n=r[a]).name!==t){o=!1;continue}s=n.state>Og&&n.state<Mg,n.state=Ol,n.timer.stop(),n.on.call(s?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[a]}o&&delete e.__transition}}function dP(e){return this.each(function(){Ml(this,e)})}function fP(e,t){var r,n;return function(){var s=Yr(this,e),o=s.tween;if(o!==r){n=r=o;for(var a=0,l=n.length;a<l;++a)if(n[a].name===t){n=n.slice(),n.splice(a,1);break}}s.tween=n}}function pP(e,t,r){var n,s;if(typeof r!="function")throw new Error;return function(){var o=Yr(this,e),a=o.tween;if(a!==n){s=(n=a).slice();for(var l={name:t,value:r},c=0,d=s.length;c<d;++c)if(s[c].name===t){s[c]=l;break}c===d&&s.push(l)}o.tween=s}}function hP(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Or(this.node(),r).tween,s=0,o=n.length,a;s<o;++s)if((a=n[s]).name===e)return a.value;return null}return this.each((t==null?fP:pP)(r,e,t))}function ny(e,t,r){var n=e._id;return e.each(function(){var s=Yr(this,n);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return Or(s,n).value[t]}}function DC(e,t){var r;return(typeof t=="number"?Cn:t instanceof ra?vb:(r=ra(t))?(t=r,vb):YI)(e,t)}function mP(e){return function(){this.removeAttribute(e)}}function xP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function gP(e,t,r){var n,s=r+"",o;return function(){var a=this.getAttribute(e);return a===s?null:a===n?o:o=t(n=a,r)}}function vP(e,t,r){var n,s=r+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===n?o:o=t(n=a,r)}}function yP(e,t,r){var n,s,o;return function(){var a,l=r(this),c;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=l+"",a===c?null:a===n&&c===s?o:(s=c,o=t(n=a,l)))}}function bP(e,t,r){var n,s,o;return function(){var a,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=l+"",a===c?null:a===n&&c===s?o:(s=c,o=t(n=a,l)))}}function _P(e,t){var r=eu(e),n=r==="transform"?JI:DC;return this.attrTween(e,typeof t=="function"?(r.local?bP:yP)(r,n,ny(this,"attr."+e,t)):t==null?(r.local?xP:mP)(r):(r.local?vP:gP)(r,n,t))}function wP(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function jP(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function SP(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&jP(e,o)),r}return s._value=t,s}function kP(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&wP(e,o)),r}return s._value=t,s}function NP(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=eu(e);return this.tween(r,(n.local?SP:kP)(n,t))}function CP(e,t){return function(){ry(this,e).delay=+t.apply(this,arguments)}}function EP(e,t){return t=+t,function(){ry(this,e).delay=t}}function TP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?CP:EP)(t,e)):Or(this.node(),t).delay}function RP(e,t){return function(){Yr(this,e).duration=+t.apply(this,arguments)}}function AP(e,t){return t=+t,function(){Yr(this,e).duration=t}}function IP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?RP:AP)(t,e)):Or(this.node(),t).duration}function PP(e,t){if(typeof t!="function")throw new Error;return function(){Yr(this,e).ease=t}}function OP(e){var t=this._id;return arguments.length?this.each(PP(t,e)):Or(this.node(),t).ease}function MP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Yr(this,e).ease=r}}function DP(e){if(typeof e!="function")throw new Error;return this.each(MP(this._id,e))}function LP(e){typeof e!="function"&&(e=hC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],a=o.length,l=n[s]=[],c,d=0;d<a;++d)(c=o[d])&&e.call(c,c.__data__,d,o)&&l.push(c);return new mn(n,this._parents,this._name,this._id)}function zP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,s=r.length,o=Math.min(n,s),a=new Array(n),l=0;l<o;++l)for(var c=t[l],d=r[l],u=c.length,f=a[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<n;++l)a[l]=t[l];return new mn(a,this._parents,this._name,this._id)}function FP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function $P(e,t,r){var n,s,o=FP(t)?ry:Yr;return function(){var a=o(this,e),l=a.on;l!==n&&(s=(n=l).copy()).on(t,r),a.on=s}}function qP(e,t){var r=this._id;return arguments.length<2?Or(this.node(),r).on.on(e):this.each($P(r,e,t))}function BP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function WP(){return this.on("end.remove",BP(this._id))}function HP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Zv(e));for(var n=this._groups,s=n.length,o=new Array(s),a=0;a<s;++a)for(var l=n[a],c=l.length,d=o[a]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,ru(d[p],t,r,p,d,Or(u,r)));return new mn(o,this._parents,t,r)}function UP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=pC(e));for(var n=this._groups,s=n.length,o=[],a=[],l=0;l<s;++l)for(var c=n[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,g=Or(u,r),x=0,_=p.length;x<_;++x)(h=p[x])&&ru(h,t,r,x,p,g);o.push(p),a.push(u)}return new mn(o,a,t,r)}var VP=ba.prototype.constructor;function GP(){return new VP(this._groups,this._parents)}function KP(e,t){var r,n,s;return function(){var o=Co(this,e),a=(this.style.removeProperty(e),Co(this,e));return o===a?null:o===r&&a===n?s:s=t(r=o,n=a)}}function LC(e){return function(){this.style.removeProperty(e)}}function YP(e,t,r){var n,s=r+"",o;return function(){var a=Co(this,e);return a===s?null:a===n?o:o=t(n=a,r)}}function XP(e,t,r){var n,s,o;return function(){var a=Co(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Co(this,e))),a===c?null:a===n&&c===s?o:(s=c,o=t(n=a,l))}}function QP(e,t){var r,n,s,o="style."+t,a="end."+o,l;return function(){var c=Yr(this,e),d=c.on,u=c.value[o]==null?l||(l=LC(t)):void 0;(d!==r||s!==u)&&(n=(r=d).copy()).on(a,s=u),c.on=n}}function ZP(e,t,r){var n=(e+="")=="transform"?ZI:DC;return t==null?this.styleTween(e,KP(e,n)).on("end.style."+e,LC(e)):typeof t=="function"?this.styleTween(e,XP(e,n,ny(this,"style."+e,t))).each(QP(this._id,e)):this.styleTween(e,YP(e,n,t),r).on("end.style."+e,null)}function JP(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function eO(e,t,r){var n,s;function o(){var a=t.apply(this,arguments);return a!==s&&(n=(s=a)&&JP(e,a,r)),n}return o._value=t,o}function tO(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,eO(e,t,r??""))}function rO(e){return function(){this.textContent=e}}function nO(e){return function(){var t=e(this);this.textContent=t??""}}function sO(e){return this.tween("text",typeof e=="function"?nO(ny(this,"text",e)):rO(e==null?"":e+""))}function oO(e){return function(t){this.textContent=e.call(this,t)}}function iO(e){var t,r;function n(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&oO(s)),t}return n._value=e,n}function aO(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,iO(e))}function lO(){for(var e=this._name,t=this._id,r=zC(),n=this._groups,s=n.length,o=0;o<s;++o)for(var a=n[o],l=a.length,c,d=0;d<l;++d)if(c=a[d]){var u=Or(c,t);ru(c,e,r,d,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new mn(n,this._parents,e,r)}function cO(){var e,t,r=this,n=r._id,s=r.size();return new Promise(function(o,a){var l={value:a},c={value:function(){--s===0&&o()}};r.each(function(){var d=Yr(this,n),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),s===0&&o()})}var uO=0;function mn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function zC(){return++uO}var Qr=ba.prototype;mn.prototype={constructor:mn,select:HP,selectAll:UP,selectChild:Qr.selectChild,selectChildren:Qr.selectChildren,filter:LP,merge:zP,selection:GP,transition:lO,call:Qr.call,nodes:Qr.nodes,node:Qr.node,size:Qr.size,empty:Qr.empty,each:Qr.each,on:qP,attr:_P,attrTween:NP,style:ZP,styleTween:tO,text:sO,textTween:aO,remove:WP,tween:hP,delay:TP,duration:IP,ease:OP,easeVarying:DP,end:cO,[Symbol.iterator]:Qr[Symbol.iterator]};function dO(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var fO={time:null,delay:0,duration:250,ease:dO};function pO(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function hO(e){var t,r;e instanceof mn?(t=e._id,e=e._name):(t=zC(),(r=fO).time=ty(),e=e==null?null:e+"");for(var n=this._groups,s=n.length,o=0;o<s;++o)for(var a=n[o],l=a.length,c,d=0;d<l;++d)(c=a[d])&&ru(c,e,t,d,a,r||pO(c,t));return new mn(n,this._parents,e,t)}ba.prototype.interrupt=dP;ba.prototype.transition=hO;const tl=e=>()=>e;function mO(e,{sourceEvent:t,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function on(e,t,r){this.k=e,this.x=t,this.y=r}on.prototype={constructor:on,scale:function(e){return e===1?this:new on(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new on(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var un=new on(1,0,0);on.prototype;function fd(e){e.stopImmediatePropagation()}function ei(e){e.preventDefault(),e.stopImmediatePropagation()}function xO(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function gO(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function kb(){return this.__zoom||un}function vO(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function yO(){return navigator.maxTouchPoints||"ontouchstart"in this}function bO(e,t,r){var n=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function FC(){var e=xO,t=gO,r=bO,n=vO,s=yO,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,c=nP,d=Jc("start","zoom","end"),u,f,p,h=500,g=150,x=0,_=10;function v(k){k.property("__zoom",kb).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",A).filter(s).on("touchstart.zoom",E).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(k,P,R,D){var L=k.selection?k.selection():k;L.property("__zoom",kb),k!==L?N(k,P,R,D):L.interrupt().each(function(){T(this,arguments).event(D).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},v.scaleBy=function(k,P,R,D){v.scaleTo(k,function(){var L=this.__zoom.k,I=typeof P=="function"?P.apply(this,arguments):P;return L*I},R,D)},v.scaleTo=function(k,P,R,D){v.transform(k,function(){var L=t.apply(this,arguments),I=this.__zoom,M=R==null?j(L):typeof R=="function"?R.apply(this,arguments):R,F=I.invert(M),q=typeof P=="function"?P.apply(this,arguments):P;return r(b(y(I,q),M,F),L,a)},R,D)},v.translateBy=function(k,P,R,D){v.transform(k,function(){return r(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof R=="function"?R.apply(this,arguments):R),t.apply(this,arguments),a)},null,D)},v.translateTo=function(k,P,R,D,L){v.transform(k,function(){var I=t.apply(this,arguments),M=this.__zoom,F=D==null?j(I):typeof D=="function"?D.apply(this,arguments):D;return r(un.translate(F[0],F[1]).scale(M.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof R=="function"?-R.apply(this,arguments):-R),I,a)},D,L)};function y(k,P){return P=Math.max(o[0],Math.min(o[1],P)),P===k.k?k:new on(P,k.x,k.y)}function b(k,P,R){var D=P[0]-R[0]*k.k,L=P[1]-R[1]*k.k;return D===k.x&&L===k.y?k:new on(k.k,D,L)}function j(k){return[(+k[0][0]+ +k[1][0])/2,(+k[0][1]+ +k[1][1])/2]}function N(k,P,R,D){k.on("start.zoom",function(){T(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(D).end()}).tween("zoom",function(){var L=this,I=arguments,M=T(L,I).event(D),F=t.apply(L,I),q=R==null?j(F):typeof R=="function"?R.apply(L,I):R,H=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),V=L.__zoom,Z=typeof P=="function"?P.apply(L,I):P,B=c(V.invert(q).concat(H/V.k),Z.invert(q).concat(H/Z.k));return function(re){if(re===1)re=Z;else{var oe=B(re),X=H/oe[2];re=new on(X,q[0]-oe[0]*X,q[1]-oe[1]*X)}M.zoom(null,re)}})}function T(k,P,R){return!R&&k.__zooming||new C(k,P)}function C(k,P){this.that=k,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(k,P),this.taps=0}C.prototype={event:function(k){return k&&(this.sourceEvent=k),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(k,P){return this.mouse&&k!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&k!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&k!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(k){var P=pr(this.that).datum();d.call(k,this.that,new mO(k,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:d}),P)}};function S(k,...P){if(!e.apply(this,arguments))return;var R=T(this,P).event(k),D=this.__zoom,L=Math.max(o[0],Math.min(o[1],D.k*Math.pow(2,n.apply(this,arguments)))),I=Cr(k);if(R.wheel)(R.mouse[0][0]!==I[0]||R.mouse[0][1]!==I[1])&&(R.mouse[1]=D.invert(R.mouse[0]=I)),clearTimeout(R.wheel);else{if(D.k===L)return;R.mouse=[I,D.invert(I)],Ml(this),R.start()}ei(k),R.wheel=setTimeout(M,g),R.zoom("mouse",r(b(y(D,L),R.mouse[0],R.mouse[1]),R.extent,a));function M(){R.wheel=null,R.end()}}function w(k,...P){if(p||!e.apply(this,arguments))return;var R=k.currentTarget,D=T(this,P,!0).event(k),L=pr(k.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",H,!0),I=Cr(k,R),M=k.clientX,F=k.clientY;SC(k.view),fd(k),D.mouse=[I,this.__zoom.invert(I)],Ml(this),D.start();function q(V){if(ei(V),!D.moved){var Z=V.clientX-M,B=V.clientY-F;D.moved=Z*Z+B*B>x}D.event(V).zoom("mouse",r(b(D.that.__zoom,D.mouse[0]=Cr(V,R),D.mouse[1]),D.extent,a))}function H(V){L.on("mousemove.zoom mouseup.zoom",null),kC(V.view,D.moved),ei(V),D.event(V).end()}}function A(k,...P){if(e.apply(this,arguments)){var R=this.__zoom,D=Cr(k.changedTouches?k.changedTouches[0]:k,this),L=R.invert(D),I=R.k*(k.shiftKey?.5:2),M=r(b(y(R,I),D,L),t.apply(this,P),a);ei(k),l>0?pr(this).transition().duration(l).call(N,M,D,k):pr(this).call(v.transform,M,D,k)}}function E(k,...P){if(e.apply(this,arguments)){var R=k.touches,D=R.length,L=T(this,P,k.changedTouches.length===D).event(k),I,M,F,q;for(fd(k),M=0;M<D;++M)F=R[M],q=Cr(F,this),q=[q,this.__zoom.invert(q),F.identifier],L.touch0?!L.touch1&&L.touch0[2]!==q[2]&&(L.touch1=q,L.taps=0):(L.touch0=q,I=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),I&&(L.taps<2&&(f=q[0],u=setTimeout(function(){u=null},h)),Ml(this),L.start())}}function O(k,...P){if(this.__zooming){var R=T(this,P).event(k),D=k.changedTouches,L=D.length,I,M,F,q;for(ei(k),I=0;I<L;++I)M=D[I],F=Cr(M,this),R.touch0&&R.touch0[2]===M.identifier?R.touch0[0]=F:R.touch1&&R.touch1[2]===M.identifier&&(R.touch1[0]=F);if(M=R.that.__zoom,R.touch1){var H=R.touch0[0],V=R.touch0[1],Z=R.touch1[0],B=R.touch1[1],re=(re=Z[0]-H[0])*re+(re=Z[1]-H[1])*re,oe=(oe=B[0]-V[0])*oe+(oe=B[1]-V[1])*oe;M=y(M,Math.sqrt(re/oe)),F=[(H[0]+Z[0])/2,(H[1]+Z[1])/2],q=[(V[0]+B[0])/2,(V[1]+B[1])/2]}else if(R.touch0)F=R.touch0[0],q=R.touch0[1];else return;R.zoom("touch",r(b(M,F,q),R.extent,a))}}function z(k,...P){if(this.__zooming){var R=T(this,P).event(k),D=k.changedTouches,L=D.length,I,M;for(fd(k),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),I=0;I<L;++I)M=D[I],R.touch0&&R.touch0[2]===M.identifier?delete R.touch0:R.touch1&&R.touch1[2]===M.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&(M=Cr(M,this),Math.hypot(f[0]-M[0],f[1]-M[1])<_)){var F=pr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return v.wheelDelta=function(k){return arguments.length?(n=typeof k=="function"?k:tl(+k),v):n},v.filter=function(k){return arguments.length?(e=typeof k=="function"?k:tl(!!k),v):e},v.touchable=function(k){return arguments.length?(s=typeof k=="function"?k:tl(!!k),v):s},v.extent=function(k){return arguments.length?(t=typeof k=="function"?k:tl([[+k[0][0],+k[0][1]],[+k[1][0],+k[1][1]]]),v):t},v.scaleExtent=function(k){return arguments.length?(o[0]=+k[0],o[1]=+k[1],v):[o[0],o[1]]},v.translateExtent=function(k){return arguments.length?(a[0][0]=+k[0][0],a[1][0]=+k[1][0],a[0][1]=+k[0][1],a[1][1]=+k[1][1],v):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},v.constrain=function(k){return arguments.length?(r=k,v):r},v.duration=function(k){return arguments.length?(l=+k,v):l},v.interpolate=function(k){return arguments.length?(c=k,v):c},v.on=function(){var k=d.on.apply(d,arguments);return k===d?v:k},v.clickDistance=function(k){return arguments.length?(x=(k=+k)*k,v):Math.sqrt(x)},v.tapDistance=function(k){return arguments.length?(_=+k,v):_},v}const nu=m.createContext(null),_O=nu.Provider,xn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},$C=xn.error001();function Je(e,t){const r=m.useContext(nu);if(r===null)throw new Error($C);return dC(r,e,t)}const wt=()=>{const e=m.useContext(nu);if(e===null)throw new Error($C);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},wO=e=>e.userSelectionActive?"none":"all";function Un({position:e,children:t,className:r,style:n,...s}){const o=Je(wO),a=`${e}`.split("-");return Y.createElement("div",{className:Qt(["react-flow__panel",r,...a]),style:{...n,pointerEvents:o},...s},t)}function jO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:Y.createElement(Un,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},Y.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const SO=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:s=!0,labelBgStyle:o={},labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),g=Qt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const x=f.current.getBBox();h({x:x.x,y:x.y,width:x.width,height:x.height})}},[r]),typeof r>"u"||!r?null:Y.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:g,visibility:p.width?"visible":"hidden",...u},s&&Y.createElement("rect",{width:p.width+2*a[0],x:-a[0],y:-a[1],height:p.height+2*a[1],className:"react-flow__edge-textbg",style:o,rx:l,ry:l}),Y.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var kO=m.memo(SO);const sy=e=>({width:e.offsetWidth,height:e.offsetHeight}),To=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),oy=(e={x:0,y:0},t)=>({x:To(e.x,t[0][0],t[1][0]),y:To(e.y,t[0][1],t[1][1])}),Nb=(e,t,r)=>e<t?To(Math.abs(e-t),1,50)/50:e>r?-To(Math.abs(e-r),1,50)/50:0,qC=(e,t)=>{const r=Nb(e.x,35,t.width-35)*20,n=Nb(e.y,35,t.height-35)*20;return[r,n]},BC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},WC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),sa=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),HC=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),Cb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),NO=(e,t)=>HC(WC(sa(e),sa(t))),Dg=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},CO=e=>mr(e.width)&&mr(e.height)&&mr(e.x)&&mr(e.y),mr=e=>!isNaN(e)&&isFinite(e),it=Symbol.for("internals"),UC=["Enter"," ","Escape"],EO=(e,t)=>{},TO=e=>"nativeEvent"in e;function Lg(e){var s,o;const t=TO(e)?e.nativeEvent:e,r=((o=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:o[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const VC=e=>"clientX"in e,Vn=(e,t)=>{var o,a;const r=VC(e),n=r?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,s=r?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},pc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},wa=({id:e,path:t,labelX:r,labelY:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>Y.createElement(Y.Fragment,null,Y.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&Y.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&mr(r)&&mr(n)?Y.createElement(kO,{x:r,y:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);wa.displayName="BaseEdge";function ti(e,t,r){return r===void 0?r:n=>{const s=t().edges.find(o=>o.id===e);s&&r(n,{...s})}}function GC({sourceX:e,sourceY:t,targetX:r,targetY:n}){const s=Math.abs(r-e)/2,o=r<e?r+s:r-s,a=Math.abs(n-t)/2,l=n<t?n+a:n-a;return[o,l,s,a]}function KC({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:s,sourceControlY:o,targetControlX:a,targetControlY:l}){const c=e*.125+s*.375+a*.375+r*.125,d=t*.125+o*.375+l*.375+n*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Cs;(function(e){e.Strict="strict",e.Loose="loose"})(Cs||(Cs={}));var hs;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(hs||(hs={}));var oa;(function(e){e.Partial="partial",e.Full="full"})(oa||(oa={}));var In;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(In||(In={}));var hc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(hc||(hc={}));var ce;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ce||(ce={}));function Eb({pos:e,x1:t,y1:r,x2:n,y2:s}){return e===ce.Left||e===ce.Right?[.5*(t+n),r]:[t,.5*(r+s)]}function YC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:o=ce.Top}){const[a,l]=Eb({pos:r,x1:e,y1:t,x2:n,y2:s}),[c,d]=Eb({pos:o,x1:n,y1:s,x2:e,y2:t}),[u,f,p,h]=KC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${n},${s}`,u,f,p,h]}const iy=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=ce.Bottom,targetPosition:o=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:g,interactionWidth:x})=>{const[_,v,y]=YC({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o});return Y.createElement(wa,{path:_,labelX:v,labelY:y,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:g,interactionWidth:x})});iy.displayName="SimpleBezierEdge";const Tb={[ce.Left]:{x:-1,y:0},[ce.Right]:{x:1,y:0},[ce.Top]:{x:0,y:-1},[ce.Bottom]:{x:0,y:1}},RO=({source:e,sourcePosition:t=ce.Bottom,target:r})=>t===ce.Left||t===ce.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Rb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function AO({source:e,sourcePosition:t=ce.Bottom,target:r,targetPosition:n=ce.Top,center:s,offset:o}){const a=Tb[t],l=Tb[n],c={x:e.x+a.x*o,y:e.y+a.y*o},d={x:r.x+l.x*o,y:r.y+l.y*o},u=RO({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],g,x;const _={x:0,y:0},v={x:0,y:0},[y,b,j,N]=GC({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(a[f]*l[f]===-1){g=s.x??y,x=s.y??b;const C=[{x:g,y:c.y},{x:g,y:d.y}],S=[{x:c.x,y:x},{x:d.x,y:x}];a[f]===p?h=f==="x"?C:S:h=f==="x"?S:C}else{const C=[{x:c.x,y:d.y}],S=[{x:d.x,y:c.y}];if(f==="x"?h=a.x===p?S:C:h=a.y===p?C:S,t===n){const z=Math.abs(e[f]-r[f]);if(z<=o){const k=Math.min(o-1,o-z);a[f]===p?_[f]=(c[f]>e[f]?-1:1)*k:v[f]=(d[f]>r[f]?-1:1)*k}}if(t!==n){const z=f==="x"?"y":"x",k=a[f]===l[z],P=c[z]>d[z],R=c[z]<d[z];(a[f]===1&&(!k&&P||k&&R)||a[f]!==1&&(!k&&R||k&&P))&&(h=f==="x"?C:S)}const w={x:c.x+_.x,y:c.y+_.y},A={x:d.x+v.x,y:d.y+v.y},E=Math.max(Math.abs(w.x-h[0].x),Math.abs(A.x-h[0].x)),O=Math.max(Math.abs(w.y-h[0].y),Math.abs(A.y-h[0].y));E>=O?(g=(w.x+A.x)/2,x=h[0].y):(g=h[0].x,x=(w.y+A.y)/2)}return[[e,{x:c.x+_.x,y:c.y+_.y},...h,{x:d.x+v.x,y:d.y+v.y},r],g,x,j,N]}function IO(e,t,r,n){const s=Math.min(Rb(e,t)/2,Rb(t,r)/2,n),{x:o,y:a}=t;if(e.x===o&&o===r.x||e.y===a&&a===r.y)return`L${o} ${a}`;if(e.y===a){const d=e.x<r.x?-1:1,u=e.y<r.y?1:-1;return`L ${o+s*d},${a}Q ${o},${a} ${o},${a+s*u}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${a+s*c}Q ${o},${a} ${o+s*l},${a}`}function zg({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:o=ce.Top,borderRadius:a=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,g]=AO({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:s},targetPosition:o,center:{x:l,y:c},offset:d});return[u.reduce((_,v,y)=>{let b="";return y>0&&y<u.length-1?b=IO(u[y-1],v,u[y+1],a):b=`${y===0?"M":"L"}${v.x} ${v.y}`,_+=b,_},""),f,p,h,g]}const su=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=ce.Bottom,targetPosition:p=ce.Top,markerEnd:h,markerStart:g,pathOptions:x,interactionWidth:_})=>{const[v,y,b]=zg({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset});return Y.createElement(wa,{path:v,labelX:y,labelY:b,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:g,interactionWidth:_})});su.displayName="SmoothStepEdge";const ay=m.memo(e=>{var t;return Y.createElement(su,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});ay.displayName="StepEdge";function PO({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[s,o,a,l]=GC({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,s,o,a,l]}const ly=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[g,x,_]=PO({sourceX:e,sourceY:t,targetX:r,targetY:n});return Y.createElement(wa,{path:g,labelX:x,labelY:_,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});ly.displayName="StraightEdge";function rl(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ab({pos:e,x1:t,y1:r,x2:n,y2:s,c:o}){switch(e){case ce.Left:return[t-rl(t-n,o),r];case ce.Right:return[t+rl(n-t,o),r];case ce.Top:return[t,r-rl(r-s,o)];case ce.Bottom:return[t,r+rl(s-r,o)]}}function XC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:o=ce.Top,curvature:a=.25}){const[l,c]=Ab({pos:r,x1:e,y1:t,x2:n,y2:s,c:a}),[d,u]=Ab({pos:o,x1:n,y1:s,x2:e,y2:t,c:a}),[f,p,h,g]=KC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${n},${s}`,f,p,h,g]}const mc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=ce.Bottom,targetPosition:o=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:g,pathOptions:x,interactionWidth:_})=>{const[v,y,b]=XC({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o,curvature:x==null?void 0:x.curvature});return Y.createElement(wa,{path:v,labelX:y,labelY:b,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:g,interactionWidth:_})});mc.displayName="BezierEdge";const cy=m.createContext(null),OO=cy.Provider;cy.Consumer;const MO=()=>m.useContext(cy),DO=e=>"id"in e&&"source"in e&&"target"in e,LO=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Fg=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,zO=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),FO=(e,t)=>{if(!e.source||!e.target)return t;let r;return DO(e)?r={...e}:r={...e,id:LO(e)},zO(r,t)?t:t.concat(r)},$g=({x:e,y:t},[r,n,s],o,[a,l])=>{const c={x:(e-r)/s,y:(t-n)/s};return o?{x:a*Math.round(c.x/a),y:l*Math.round(c.y/l)}:c},QC=({x:e,y:t},[r,n,s])=>({x:e*s+r,y:t*s+n}),ys=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-n};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:s}},ou=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,s)=>{const{x:o,y:a}=ys(s,t).positionAbsolute;return WC(n,sa({x:o,y:a,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return HC(r)},ZC=(e,t,[r,n,s]=[0,0,1],o=!1,a=!1,l=[0,0])=>{const c={x:(t.x-r)/s,y:(t.y-n)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:g=!1}=u;if(a&&!h||g)return!1;const{positionAbsolute:x}=ys(u,l),_={x:x.x,y:x.y,width:f||0,height:p||0},v=Dg(c,_),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=o&&v>0,j=(f||0)*(p||0);(y||b||v>=j||u.dragging)&&d.push(u)}),d},JC=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},eE=(e,t,r,n,s,o=.1)=>{const a=t/(e.width*(1+o)),l=r/(e.height*(1+o)),c=Math.min(a,l),d=To(c,n,s),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=r/2-f*d;return{x:p,y:h,zoom:d}},cs=(e,t=0)=>e.transition().duration(t);function Ib(e,t,r,n){return(t[r]||[]).reduce((s,o)=>{var a,l;return`${e.id}-${o.id}-${r}`!==n&&s.push({id:o.id||null,type:r,nodeId:e.id,x:(((a=e.positionAbsolute)==null?void 0:a.x)??0)+o.x+o.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+o.y+o.height/2}),s},[])}function $O(e,t,r,n,s,o){const{x:a,y:l}=Vn(e),d=t.elementsFromPoint(a,l).find(g=>g.classList.contains("react-flow__handle"));if(d){const g=d.getAttribute("data-nodeid");if(g){const x=uy(void 0,d),_=d.getAttribute("data-handleid"),v=o({nodeId:g,id:_,type:x});if(v){const y=s.find(b=>b.nodeId===g&&b.type===x&&b.id===_);return{handle:{id:_,type:x,nodeId:g,x:(y==null?void 0:y.x)||r.x,y:(y==null?void 0:y.y)||r.y},validHandleResult:v}}}}let u=[],f=1/0;if(s.forEach(g=>{const x=Math.sqrt((g.x-r.x)**2+(g.y-r.y)**2);if(x<=n){const _=o(g);x<=f&&(x<f?u=[{handle:g,validHandleResult:_}]:x===f&&u.push({handle:g,validHandleResult:_}),f=x)}}),!u.length)return{handle:null,validHandleResult:tE()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:g})=>g.isValid),h=u.some(({handle:g})=>g.type==="target");return u.find(({handle:g,validHandleResult:x})=>h?g.type==="target":p?x.isValid:!0)||u[0]}const qO={source:null,target:null,sourceHandle:null,targetHandle:null},tE=()=>({handleDomNode:null,isValid:!1,connection:qO,endHandle:null});function rE(e,t,r,n,s,o,a){const l=s==="target",c=a.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...tE(),handleDomNode:c};if(c){const u=uy(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),g=c.classList.contains("connectableend"),x={source:l?f:r,sourceHandle:l?p:n,target:l?r:f,targetHandle:l?n:p};d.connection=x,h&&g&&(t===Cs.Strict?l&&u==="source"||!l&&u==="target":f!==r||p!==n)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=o(x))}return d}function BO({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((s,o)=>{if(o[it]){const{handleBounds:a}=o[it];let l=[],c=[];a&&(l=Ib(o,a,"source",`${t}-${r}-${n}`),c=Ib(o,a,"target",`${t}-${r}-${n}`)),s.push(...l,...c)}return s},[])}function uy(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function pd(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function WO(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function nE({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:s,getState:o,setState:a,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=BC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:g,onConnectStart:x,panBy:_,getNodes:v,cancelConnection:y}=o();let b=0,j;const{x:N,y:T}=Vn(e),C=u==null?void 0:u.elementFromPoint(N,T),S=uy(c,C),w=p==null?void 0:p.getBoundingClientRect();if(!w||!S)return;let A,E=Vn(e,w),O=!1,z=null,k=!1,P=null;const R=BO({nodes:v(),nodeId:r,handleId:t,handleType:S}),D=()=>{if(!h)return;const[M,F]=qC(E,w);_({x:M,y:F}),b=requestAnimationFrame(D)};a({connectionPosition:E,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:S,connectionStartHandle:{nodeId:r,handleId:t,type:S},connectionEndHandle:null}),x==null||x(e,{nodeId:r,handleId:t,handleType:S});function L(M){const{transform:F}=o();E=Vn(M,w);const{handle:q,validHandleResult:H}=$O(M,u,$g(E,F,!1,[1,1]),g,R,V=>rE(V,f,r,t,s?"target":"source",l,u));if(j=q,O||(D(),O=!0),P=H.handleDomNode,z=H.connection,k=H.isValid,a({connectionPosition:j&&k?QC({x:j.x,y:j.y},F):E,connectionStatus:WO(!!j,k),connectionEndHandle:H.endHandle}),!j&&!k&&!P)return pd(A);z.source!==z.target&&P&&(pd(A),A=P,P.classList.add("connecting","react-flow__handle-connecting"),P.classList.toggle("valid",k),P.classList.toggle("react-flow__handle-valid",k))}function I(M){var F,q;(j||P)&&z&&k&&(n==null||n(z)),(q=(F=o()).onConnectEnd)==null||q.call(F,M),c&&(d==null||d(M)),pd(A),y(),cancelAnimationFrame(b),O=!1,k=!1,z=null,P=null,u.removeEventListener("mousemove",L),u.removeEventListener("mouseup",I),u.removeEventListener("touchmove",L),u.removeEventListener("touchend",I)}u.addEventListener("mousemove",L),u.addEventListener("mouseup",I),u.addEventListener("touchmove",L),u.addEventListener("touchend",I)}const Pb=()=>!0,HO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),UO=(e,t,r)=>n=>{const{connectionStartHandle:s,connectionEndHandle:o,connectionClickStartHandle:a}=n;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.handleId)===t&&(a==null?void 0:a.type)===r}},sE=m.forwardRef(({type:e="source",position:t=ce.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:o=!0,id:a,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var w,A;const g=a||null,x=e==="target",_=wt(),v=MO(),{connectOnClick:y,noPanClassName:b}=Je(HO,Ot),{connecting:j,clickConnecting:N}=Je(UO(v,g,e),Ot);v||(A=(w=_.getState()).onError)==null||A.call(w,"010",xn.error010());const T=E=>{const{defaultEdgeOptions:O,onConnect:z,hasDefaultEdges:k}=_.getState(),P={...O,...E};if(k){const{edges:R,setEdges:D}=_.getState();D(FO(P,R))}z==null||z(P),l==null||l(P)},C=E=>{if(!v)return;const O=VC(E);s&&(O&&E.button===0||!O)&&nE({event:E,handleId:g,nodeId:v,onConnect:T,isTarget:x,getState:_.getState,setState:_.setState,isValidConnection:r||_.getState().isValidConnection||Pb}),O?u==null||u(E):f==null||f(E)},S=E=>{const{onClickConnectStart:O,onClickConnectEnd:z,connectionClickStartHandle:k,connectionMode:P,isValidConnection:R}=_.getState();if(!v||!k&&!s)return;if(!k){O==null||O(E,{nodeId:v,handleId:g,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:g}});return}const D=BC(E.target),L=r||R||Pb,{connection:I,isValid:M}=rE({nodeId:v,id:g,type:e},P,k.nodeId,k.handleId||null,k.type,L,D);M&&T(I),z==null||z(E),_.setState({connectionClickStartHandle:null})};return Y.createElement("div",{"data-handleid":g,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${g}-${e}`,className:Qt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!x,target:x,connectable:n,connectablestart:s,connectableend:o,connecting:N,connectionindicator:n&&(s&&!j||o&&j)}]),onMouseDown:C,onTouchStart:C,onClick:y?S:void 0,ref:h,...p},c)});sE.displayName="Handle";var yr=m.memo(sE);const oE=({data:e,isConnectable:t,targetPosition:r=ce.Top,sourcePosition:n=ce.Bottom})=>Y.createElement(Y.Fragment,null,Y.createElement(yr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,Y.createElement(yr,{type:"source",position:n,isConnectable:t}));oE.displayName="DefaultNode";var qg=m.memo(oE);const iE=({data:e,isConnectable:t,sourcePosition:r=ce.Bottom})=>Y.createElement(Y.Fragment,null,e==null?void 0:e.label,Y.createElement(yr,{type:"source",position:r,isConnectable:t}));iE.displayName="InputNode";var aE=m.memo(iE);const lE=({data:e,isConnectable:t,targetPosition:r=ce.Top})=>Y.createElement(Y.Fragment,null,Y.createElement(yr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);lE.displayName="OutputNode";var cE=m.memo(lE);const dy=()=>null;dy.displayName="GroupNode";const VO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),nl=e=>e.id;function GO(e,t){return Ot(e.selectedNodes.map(nl),t.selectedNodes.map(nl))&&Ot(e.selectedEdges.map(nl),t.selectedEdges.map(nl))}const uE=m.memo(({onSelectionChange:e})=>{const t=wt(),{selectedNodes:r,selectedEdges:n}=Je(VO,GO);return m.useEffect(()=>{const s={nodes:r,edges:n};e==null||e(s),t.getState().onSelectionChange.forEach(o=>o(s))},[r,n,e]),null});uE.displayName="SelectionListener";const KO=e=>!!e.onSelectionChange;function YO({onSelectionChange:e}){const t=Je(KO);return e||t?Y.createElement(uE,{onSelectionChange:e}):null}const XO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Ls(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Re(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const QO=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:s,onConnectStart:o,onConnectEnd:a,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:g,minZoom:x,maxZoom:_,nodeExtent:v,onNodesChange:y,onEdgesChange:b,elementsSelectable:j,connectionMode:N,snapGrid:T,snapToGrid:C,translateExtent:S,connectOnClick:w,defaultEdgeOptions:A,fitView:E,fitViewOptions:O,onNodesDelete:z,onEdgesDelete:k,onNodeDrag:P,onNodeDragStart:R,onNodeDragStop:D,onSelectionDrag:L,onSelectionDragStart:I,onSelectionDragStop:M,noPanClassName:F,nodeOrigin:q,rfId:H,autoPanOnConnect:V,autoPanOnNodeDrag:Z,onError:B,connectionRadius:re,isValidConnection:oe,nodeDragThreshold:X})=>{const{setNodes:Q,setEdges:fe,setDefaultNodesAndEdges:xe,setMinZoom:be,setMaxZoom:ye,setTranslateExtent:ae,setNodeExtent:K,reset:te}=Je(XO,Ot),ee=wt();return m.useEffect(()=>{const ke=n==null?void 0:n.map(je=>({...je,...A}));return xe(r,ke),()=>{te()}},[]),Re("defaultEdgeOptions",A,ee.setState),Re("connectionMode",N,ee.setState),Re("onConnect",s,ee.setState),Re("onConnectStart",o,ee.setState),Re("onConnectEnd",a,ee.setState),Re("onClickConnectStart",l,ee.setState),Re("onClickConnectEnd",c,ee.setState),Re("nodesDraggable",d,ee.setState),Re("nodesConnectable",u,ee.setState),Re("nodesFocusable",f,ee.setState),Re("edgesFocusable",p,ee.setState),Re("edgesUpdatable",h,ee.setState),Re("elementsSelectable",j,ee.setState),Re("elevateNodesOnSelect",g,ee.setState),Re("snapToGrid",C,ee.setState),Re("snapGrid",T,ee.setState),Re("onNodesChange",y,ee.setState),Re("onEdgesChange",b,ee.setState),Re("connectOnClick",w,ee.setState),Re("fitViewOnInit",E,ee.setState),Re("fitViewOnInitOptions",O,ee.setState),Re("onNodesDelete",z,ee.setState),Re("onEdgesDelete",k,ee.setState),Re("onNodeDrag",P,ee.setState),Re("onNodeDragStart",R,ee.setState),Re("onNodeDragStop",D,ee.setState),Re("onSelectionDrag",L,ee.setState),Re("onSelectionDragStart",I,ee.setState),Re("onSelectionDragStop",M,ee.setState),Re("noPanClassName",F,ee.setState),Re("nodeOrigin",q,ee.setState),Re("rfId",H,ee.setState),Re("autoPanOnConnect",V,ee.setState),Re("autoPanOnNodeDrag",Z,ee.setState),Re("onError",B,ee.setState),Re("connectionRadius",re,ee.setState),Re("isValidConnection",oe,ee.setState),Re("nodeDragThreshold",X,ee.setState),Ls(e,Q),Ls(t,fe),Ls(x,be),Ls(_,ye),Ls(S,ae),Ls(v,K),null},Ob={display:"none"},ZO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},dE="react-flow__node-desc",fE="react-flow__edge-desc",JO="react-flow__aria-live",eM=e=>e.ariaLiveMessage;function tM({rfId:e}){const t=Je(eM);return Y.createElement("div",{id:`${JO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ZO},t)}function rM({rfId:e,disableKeyboardA11y:t}){return Y.createElement(Y.Fragment,null,Y.createElement("div",{id:`${dE}-${e}`,style:Ob},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),Y.createElement("div",{id:`${fE}-${e}`,style:Ob},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&Y.createElement(tM,{rfId:e}))}var ia=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),s=m.useRef(!1),o=m.useRef(new Set([])),[a,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Lg(h))return!1;const x=Db(h.code,l);o.current.add(h[x]),Mb(a,o.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Lg(h))return!1;const x=Db(h.code,l);Mb(a,o.current,!0)?(n(!1),o.current.clear()):o.current.delete(h[x]),h.key==="Meta"&&o.current.clear(),s.current=!1},p=()=>{o.current.clear(),n(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function Mb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(s=>t.has(s)))}function Db(e,t){return t.includes(e)?"code":"key"}function pE(e,t,r,n){var l,c;const s=e.parentNode||e.parentId;if(!s)return r;const o=t.get(s),a=ys(o,n);return pE(o,t,{x:(r.x??0)+a.x,y:(r.y??0)+a.y,z:(((l=o[it])==null?void 0:l.z)??0)>(r.z??0)?((c=o[it])==null?void 0:c.z)??0:r.z??0},n)}function hE(e,t,r){e.forEach(n=>{var o;const s=n.parentNode||n.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[n.id]){const{x:a,y:l,z:c}=pE(n,e,{...n.position,z:((o=n[it])==null?void 0:o.z)??0},t);n.positionAbsolute={x:a,y:l},n[it].z=c,r!=null&&r[n.id]&&(n[it].isParent=!0)}})}function hd(e,t,r,n){const s=new Map,o={},a=n?1e3:0;return e.forEach(l=>{var h;const c=(mr(l.zIndex)?l.zIndex:0)+(l.selected?a:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(o[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,it,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[it])==null?void 0:h.handleBounds,z:c}}),s.set(l.id,u)}),hE(s,r,o),s}function mE(e,t={}){const{getNodes:r,width:n,height:s,minZoom:o,maxZoom:a,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const g=r().filter(_=>{var y;const v=t.includeHiddenNodes?_.width&&_.height:!_.hidden;return(y=t.nodes)!=null&&y.length?v&&t.nodes.some(b=>b.id===_.id):v}),x=g.every(_=>_.width&&_.height);if(g.length>0&&x){const _=ou(g,f),{x:v,y,zoom:b}=eE(_,n,s,t.minZoom??o,t.maxZoom??a,t.padding??.1),j=un.translate(v,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(cs(c,t.duration),j):l.transform(c,j),!0}}return!1}function nM(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[it]:n[it],selected:r.selected})}),new Map(t)}function sM(e,t){return t.map(r=>{const n=e.find(s=>s.id===r.id);return n&&(r.selected=n.selected),r})}function sl({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:s,edges:o,onNodesChange:a,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=r();e!=null&&e.length&&(c&&n({nodeInternals:nM(e,s)}),a==null||a(e)),t!=null&&t.length&&(d&&n({edges:sM(t,o)}),l==null||l(t))}const zs=()=>{},oM={zoomIn:zs,zoomOut:zs,zoomTo:zs,getZoom:()=>1,setViewport:zs,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:zs,fitBounds:zs,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},iM=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),aM=()=>{const e=wt(),{d3Zoom:t,d3Selection:r}=Je(iM,Ot);return m.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(cs(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(cs(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,o)=>t.scaleTo(cs(r,o==null?void 0:o.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,o)=>{const[a,l,c]=e.getState().transform,d=un.translate(s.x??a,s.y??l).scale(s.zoom??c);t.transform(cs(r,o==null?void 0:o.duration),d)},getViewport:()=>{const[s,o,a]=e.getState().transform;return{x:s,y:o,zoom:a}},fitView:s=>mE(e.getState,s),setCenter:(s,o,a)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(a==null?void 0:a.zoom)<"u"?a.zoom:d,f=l/2-s*u,p=c/2-o*u,h=un.translate(f,p).scale(u);t.transform(cs(r,a==null?void 0:a.duration),h)},fitBounds:(s,o)=>{const{width:a,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=eE(s,a,l,c,d,(o==null?void 0:o.padding)??.1),h=un.translate(u,f).scale(p);t.transform(cs(r,o==null?void 0:o.duration),h)},project:s=>{const{transform:o,snapToGrid:a,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),$g(s,o,a,l)},screenToFlowPosition:s=>{const{transform:o,snapToGrid:a,snapGrid:l,domNode:c}=e.getState();if(!c)return s;const{x:d,y:u}=c.getBoundingClientRect(),f={x:s.x-d,y:s.y-u};return $g(f,o,a,l)},flowToScreenPosition:s=>{const{transform:o,domNode:a}=e.getState();if(!a)return s;const{x:l,y:c}=a.getBoundingClientRect(),d=QC(s,o);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:oM,[t,r])};function iu(){const e=aM(),t=wt(),r=m.useCallback(()=>t.getState().getNodes().map(x=>({...x})),[]),n=m.useCallback(x=>t.getState().nodeInternals.get(x),[]),s=m.useCallback(()=>{const{edges:x=[]}=t.getState();return x.map(_=>({..._}))},[]),o=m.useCallback(x=>{const{edges:_=[]}=t.getState();return _.find(v=>v.id===x)},[]),a=m.useCallback(x=>{const{getNodes:_,setNodes:v,hasDefaultNodes:y,onNodesChange:b}=t.getState(),j=_(),N=typeof x=="function"?x(j):x;if(y)v(N);else if(b){const T=N.length===0?j.map(C=>({type:"remove",id:C.id})):N.map(C=>({item:C,type:"reset"}));b(T)}},[]),l=m.useCallback(x=>{const{edges:_=[],setEdges:v,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),j=typeof x=="function"?x(_):x;if(y)v(j);else if(b){const N=j.length===0?_.map(T=>({type:"remove",id:T.id})):j.map(T=>({item:T,type:"reset"}));b(N)}},[]),c=m.useCallback(x=>{const _=Array.isArray(x)?x:[x],{getNodes:v,setNodes:y,hasDefaultNodes:b,onNodesChange:j}=t.getState();if(b){const T=[...v(),..._];y(T)}else if(j){const N=_.map(T=>({item:T,type:"add"}));j(N)}},[]),d=m.useCallback(x=>{const _=Array.isArray(x)?x:[x],{edges:v=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:j}=t.getState();if(b)y([...v,..._]);else if(j){const N=_.map(T=>({item:T,type:"add"}));j(N)}},[]),u=m.useCallback(()=>{const{getNodes:x,edges:_=[],transform:v}=t.getState(),[y,b,j]=v;return{nodes:x().map(N=>({...N})),edges:_.map(N=>({...N})),viewport:{x:y,y:b,zoom:j}}},[]),f=m.useCallback(({nodes:x,edges:_})=>{const{nodeInternals:v,getNodes:y,edges:b,hasDefaultNodes:j,hasDefaultEdges:N,onNodesDelete:T,onEdgesDelete:C,onNodesChange:S,onEdgesChange:w}=t.getState(),A=(x||[]).map(P=>P.id),E=(_||[]).map(P=>P.id),O=y().reduce((P,R)=>{const D=R.parentNode||R.parentId,L=!A.includes(R.id)&&D&&P.find(M=>M.id===D);return(typeof R.deletable=="boolean"?R.deletable:!0)&&(A.includes(R.id)||L)&&P.push(R),P},[]),z=b.filter(P=>typeof P.deletable=="boolean"?P.deletable:!0),k=z.filter(P=>E.includes(P.id));if(O||k){const P=JC(O,z),R=[...k,...P],D=R.reduce((L,I)=>(L.includes(I.id)||L.push(I.id),L),[]);if((N||j)&&(N&&t.setState({edges:b.filter(L=>!D.includes(L.id))}),j&&(O.forEach(L=>{v.delete(L.id)}),t.setState({nodeInternals:new Map(v)}))),D.length>0&&(C==null||C(R),w&&w(D.map(L=>({id:L,type:"remove"})))),O.length>0&&(T==null||T(O),S)){const L=O.map(I=>({id:I.id,type:"remove"}));S(L)}}},[]),p=m.useCallback(x=>{const _=CO(x),v=_?null:t.getState().nodeInternals.get(x.id);return!_&&!v?[null,null,_]:[_?x:Cb(v),v,_]},[]),h=m.useCallback((x,_=!0,v)=>{const[y,b,j]=p(x);return y?(v||t.getState().getNodes()).filter(N=>{if(!j&&(N.id===b.id||!N.positionAbsolute))return!1;const T=Cb(N),C=Dg(T,y);return _&&C>0||C>=y.width*y.height}):[]},[]),g=m.useCallback((x,_,v=!0)=>{const[y]=p(x);if(!y)return!1;const b=Dg(y,_);return v&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:s,getEdge:o,setNodes:a,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:g}),[e,r,n,s,o,a,l,c,d,u,f,h,g])}const lM={actInsideInputWithModifier:!1};var cM=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=wt(),{deleteElements:n}=iu(),s=ia(e,lM),o=ia(t);m.useEffect(()=>{if(s){const{edges:a,getNodes:l}=r.getState(),c=l().filter(u=>u.selected),d=a.filter(u=>u.selected);n({nodes:c,edges:d}),r.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])};function uM(e){const t=wt();m.useEffect(()=>{let r;const n=()=>{var o,a;if(!e.current)return;const s=sy(e.current);(s.height===0||s.width===0)&&((a=(o=t.getState()).onError)==null||a.call(o,"004",xn.error004())),t.setState({width:s.width||500,height:s.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const fy={position:"absolute",width:"100%",height:"100%",top:0,left:0},dM=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ol=e=>({x:e.x,y:e.y,zoom:e.k}),Fs=(e,t)=>e.target.closest(`.${t}`),Lb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),zb=e=>{const t=e.ctrlKey&&pc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},fM=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),pM=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:s=!0,zoomOnPinch:o=!0,panOnScroll:a=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=hs.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:g,maxZoom:x,zoomActivationKeyCode:_,preventScrolling:v=!0,children:y,noWheelClassName:b,noPanClassName:j})=>{const N=m.useRef(),T=wt(),C=m.useRef(!1),S=m.useRef(!1),w=m.useRef(null),A=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:E,d3Selection:O,d3ZoomHandler:z,userSelectionActive:k}=Je(fM,Ot),P=ia(_),R=m.useRef(0),D=m.useRef(!1),L=m.useRef();return uM(w),m.useEffect(()=>{if(w.current){const I=w.current.getBoundingClientRect(),M=FC().scaleExtent([g,x]).translateExtent(h),F=pr(w.current).call(M),q=un.translate(p.x,p.y).scale(To(p.zoom,g,x)),H=[[0,0],[I.width,I.height]],V=M.constrain()(q,H,h);M.transform(F,V),M.wheelDelta(zb),T.setState({d3Zoom:M,d3Selection:F,d3ZoomHandler:F.on("wheel.zoom"),transform:[V.x,V.y,V.k],domNode:w.current.closest(".react-flow")})}},[]),m.useEffect(()=>{O&&E&&(a&&!P&&!k?O.on("wheel.zoom",I=>{if(Fs(I,b))return!1;I.preventDefault(),I.stopImmediatePropagation();const M=O.property("__zoom").k||1;if(I.ctrlKey&&o){const oe=Cr(I),X=zb(I),Q=M*Math.pow(2,X);E.scaleTo(O,Q,oe,I);return}const F=I.deltaMode===1?20:1;let q=c===hs.Vertical?0:I.deltaX*F,H=c===hs.Horizontal?0:I.deltaY*F;!pc()&&I.shiftKey&&c!==hs.Vertical&&(q=I.deltaY*F,H=0),E.translateBy(O,-(q/M)*l,-(H/M)*l,{internal:!0});const V=ol(O.property("__zoom")),{onViewportChangeStart:Z,onViewportChange:B,onViewportChangeEnd:re}=T.getState();clearTimeout(L.current),D.current||(D.current=!0,t==null||t(I,V),Z==null||Z(V)),D.current&&(e==null||e(I,V),B==null||B(V),L.current=setTimeout(()=>{r==null||r(I,V),re==null||re(V),D.current=!1},150))},{passive:!1}):typeof z<"u"&&O.on("wheel.zoom",function(I,M){if(!v&&I.type==="wheel"&&!I.ctrlKey||Fs(I,b))return null;I.preventDefault(),z.call(this,I,M)},{passive:!1}))},[k,a,c,O,E,z,P,o,v,b,t,e,r]),m.useEffect(()=>{E&&E.on("start",I=>{var q,H;if(!I.sourceEvent||I.sourceEvent.internal)return null;R.current=(q=I.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:M}=T.getState(),F=ol(I.transform);C.current=!0,A.current=F,((H=I.sourceEvent)==null?void 0:H.type)==="mousedown"&&T.setState({paneDragging:!0}),M==null||M(F),t==null||t(I.sourceEvent,F)})},[E,t]),m.useEffect(()=>{E&&(k&&!C.current?E.on("zoom",null):k||E.on("zoom",I=>{var F;const{onViewportChange:M}=T.getState();if(T.setState({transform:[I.transform.x,I.transform.y,I.transform.k]}),S.current=!!(n&&Lb(f,R.current??0)),(e||M)&&!((F=I.sourceEvent)!=null&&F.internal)){const q=ol(I.transform);M==null||M(q),e==null||e(I.sourceEvent,q)}}))},[k,E,e,f,n]),m.useEffect(()=>{E&&E.on("end",I=>{if(!I.sourceEvent||I.sourceEvent.internal)return null;const{onViewportChangeEnd:M}=T.getState();if(C.current=!1,T.setState({paneDragging:!1}),n&&Lb(f,R.current??0)&&!S.current&&n(I.sourceEvent),S.current=!1,(r||M)&&dM(A.current,I.transform)){const F=ol(I.transform);A.current=F,clearTimeout(N.current),N.current=setTimeout(()=>{M==null||M(F),r==null||r(I.sourceEvent,F)},a?150:0)}})},[E,a,f,r,n]),m.useEffect(()=>{E&&E.filter(I=>{const M=P||s,F=o&&I.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&I.button===1&&I.type==="mousedown"&&(Fs(I,"react-flow__node")||Fs(I,"react-flow__edge")))return!0;if(!f&&!M&&!a&&!d&&!o||k||!d&&I.type==="dblclick"||Fs(I,b)&&I.type==="wheel"||Fs(I,j)&&(I.type!=="wheel"||a&&I.type==="wheel"&&!P)||!o&&I.ctrlKey&&I.type==="wheel"||!M&&!a&&!F&&I.type==="wheel"||!f&&(I.type==="mousedown"||I.type==="touchstart")||Array.isArray(f)&&!f.includes(I.button)&&I.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(I.button)||!I.button||I.button<=1;return(!I.ctrlKey||I.type==="wheel")&&q})},[k,E,s,o,a,d,f,u,P]),Y.createElement("div",{className:"react-flow__renderer",ref:w,style:fy},y)},hM=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function mM(){const{userSelectionActive:e,userSelectionRect:t}=Je(hM,Ot);return e&&t?Y.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Fb(e,t){const r=t.parentNode||t.parentId,n=e.find(s=>s.id===r);if(n){const s=t.position.x+t.width-n.width,o=t.position.y+t.height-n.height;if(s>0||o>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,s>0&&(n.style.width+=s),o>0&&(n.style.height+=o),t.position.x<0){const a=Math.abs(t.position.x);n.position.x=n.position.x-a,n.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);n.position.y=n.position.y-a,n.style.height+=a,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function xE(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,s)=>{const o=e.filter(l=>l.id===s.id);if(o.length===0)return n.push(s),n;const a={...s};for(const l of o)if(l)switch(l.type){case"select":{a.selected=l.selected;break}case"position":{typeof l.position<"u"&&(a.position=l.position),typeof l.positionAbsolute<"u"&&(a.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(a.dragging=l.dragging),a.expandParent&&Fb(n,a);break}case"dimensions":{typeof l.dimensions<"u"&&(a.width=l.dimensions.width,a.height=l.dimensions.height),typeof l.updateStyle<"u"&&(a.style={...a.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(a.resizing=l.resizing),a.expandParent&&Fb(n,a);break}case"remove":return n}return n.push(a),n},r)}function gE(e,t){return xE(e,t)}function xM(e,t){return xE(e,t)}const En=(e,t)=>({id:e,type:"select",selected:t});function oo(e,t){return e.reduce((r,n)=>{const s=t.includes(n.id);return!n.selected&&s?(n.selected=!0,r.push(En(n.id,!0))):n.selected&&!s&&(n.selected=!1,r.push(En(n.id,!1))),r},[])}const md=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},gM=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),vE=m.memo(({isSelecting:e,selectionMode:t=oa.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:s,onPaneClick:o,onPaneContextMenu:a,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=wt(),g=m.useRef(0),x=m.useRef(0),_=m.useRef(),{userSelectionActive:v,elementsSelectable:y,dragging:b}=Je(gM,Ot),j=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),g.current=0,x.current=0},N=z=>{o==null||o(z),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},T=z=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){z.preventDefault();return}a==null||a(z)},C=l?z=>l(z):void 0,S=z=>{const{resetSelectedElements:k,domNode:P}=h.getState();if(_.current=P==null?void 0:P.getBoundingClientRect(),!y||!e||z.button!==0||z.target!==p.current||!_.current)return;const{x:R,y:D}=Vn(z,_.current);k(),h.setState({userSelectionRect:{width:0,height:0,startX:R,startY:D,x:R,y:D}}),n==null||n(z)},w=z=>{const{userSelectionRect:k,nodeInternals:P,edges:R,transform:D,onNodesChange:L,onEdgesChange:I,nodeOrigin:M,getNodes:F}=h.getState();if(!e||!_.current||!k)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Vn(z,_.current),H=k.startX??0,V=k.startY??0,Z={...k,x:q.x<H?q.x:H,y:q.y<V?q.y:V,width:Math.abs(q.x-H),height:Math.abs(q.y-V)},B=F(),re=ZC(P,Z,D,t===oa.Partial,!0,M),oe=JC(re,R).map(Q=>Q.id),X=re.map(Q=>Q.id);if(g.current!==X.length){g.current=X.length;const Q=oo(B,X);Q.length&&(L==null||L(Q))}if(x.current!==oe.length){x.current=oe.length;const Q=oo(R,oe);Q.length&&(I==null||I(Q))}h.setState({userSelectionRect:Z})},A=z=>{if(z.button!==0)return;const{userSelectionRect:k}=h.getState();!v&&k&&z.target===p.current&&(N==null||N(z)),h.setState({nodesSelectionActive:g.current>0}),j(),s==null||s(z)},E=z=>{v&&(h.setState({nodesSelectionActive:g.current>0}),s==null||s(z)),j()},O=y&&(e||v);return Y.createElement("div",{className:Qt(["react-flow__pane",{dragging:b,selection:e}]),onClick:O?void 0:md(N,p),onContextMenu:md(T,p),onWheel:md(C,p),onMouseEnter:O?void 0:c,onMouseDown:O?S:void 0,onMouseMove:O?w:d,onMouseUp:O?A:void 0,onMouseLeave:O?E:u,ref:p,style:fy},f,Y.createElement(mM,null))});vE.displayName="Pane";function yE(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:yE(n,t):!1}function $b(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function vM(e,t,r,n){return Array.from(e.values()).filter(s=>(s.selected||s.id===n)&&(!s.parentNode||s.parentId||!yE(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var o,a;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((o=s.positionAbsolute)==null?void 0:o.x)??0),y:r.y-(((a=s.positionAbsolute)==null?void 0:a.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function yM(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function bE(e,t,r,n,s=[0,0],o){const a=yM(e,e.extent||n);let l=a;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=ys(f,s).positionAbsolute;l=f&&mr(p)&&mr(h)&&mr(f.width)&&mr(f.height)?[[p+e.width*s[0],h+e.height*s[1]],[p+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:l}else o==null||o("005",xn.error005()),l=a;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=ys(f,s).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=r.get(c);d=ys(f,s).positionAbsolute}const u=l&&l!=="parent"?oy(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function xd({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?n.find(s=>s.id===e):n[0],n]}const qb=(e,t,r,n)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const o=Array.from(s),a=t.getBoundingClientRect(),l={x:a.width*n[0],y:a.height*n[1]};return o.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-a.left-l.x)/r,y:(d.top-a.top-l.y)/r,...sy(c)}})};function ri(e,t,r){return r===void 0?r:n=>{const s=t().nodeInternals.get(e);s&&r(n,{...s})}}function Bg({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:o,multiSelectionActive:a,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",xn.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(r||d.selected&&a)&&(o({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=n==null?void 0:n.current)==null?void 0:u.blur()})):s([e])}function bM(){const e=wt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:s,snapToGrid:o}=e.getState(),a=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(a-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:o?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:o?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function gd(e){return(t,r,n)=>e==null?void 0:e(t,n)}function _E({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:o,selectNodesOnDrag:a}){const l=wt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),g=m.useRef({x:0,y:0}),x=m.useRef(null),_=m.useRef(!1),v=m.useRef(!1),y=m.useRef(!1),b=bM();return m.useEffect(()=>{if(e!=null&&e.current){const j=pr(e.current),N=({x:S,y:w})=>{const{nodeInternals:A,onNodeDrag:E,onSelectionDrag:O,updateNodePositions:z,nodeExtent:k,snapGrid:P,snapToGrid:R,nodeOrigin:D,onError:L}=l.getState();f.current={x:S,y:w};let I=!1,M={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&k){const q=ou(u.current,D);M=sa(q)}if(u.current=u.current.map(q=>{const H={x:S-q.distance.x,y:w-q.distance.y};R&&(H.x=P[0]*Math.round(H.x/P[0]),H.y=P[1]*Math.round(H.y/P[1]));const V=[[k[0][0],k[0][1]],[k[1][0],k[1][1]]];u.current.length>1&&k&&!q.extent&&(V[0][0]=q.positionAbsolute.x-M.x+k[0][0],V[1][0]=q.positionAbsolute.x+(q.width??0)-M.x2+k[1][0],V[0][1]=q.positionAbsolute.y-M.y+k[0][1],V[1][1]=q.positionAbsolute.y+(q.height??0)-M.y2+k[1][1]);const Z=bE(q,H,A,V,D,L);return I=I||q.position.x!==Z.position.x||q.position.y!==Z.position.y,q.position=Z.position,q.positionAbsolute=Z.positionAbsolute,q}),!I)return;z(u.current,!0,!0),d(!0);const F=s?E:gd(O);if(F&&x.current){const[q,H]=xd({nodeId:s,dragItems:u.current,nodeInternals:A});F(x.current,q,H)}},T=()=>{if(!h.current)return;const[S,w]=qC(g.current,h.current);if(S!==0||w!==0){const{transform:A,panBy:E}=l.getState();f.current.x=(f.current.x??0)-S/A[2],f.current.y=(f.current.y??0)-w/A[2],E({x:S,y:w})&&N(f.current)}p.current=requestAnimationFrame(T)},C=S=>{var D;const{nodeInternals:w,multiSelectionActive:A,nodesDraggable:E,unselectNodesAndEdges:O,onNodeDragStart:z,onSelectionDragStart:k}=l.getState();v.current=!0;const P=s?z:gd(k);(!a||!o)&&!A&&s&&((D=w.get(s))!=null&&D.selected||O()),s&&o&&a&&Bg({id:s,store:l,nodeRef:e});const R=b(S);if(f.current=R,u.current=vM(w,E,R,s),P&&u.current){const[L,I]=xd({nodeId:s,dragItems:u.current,nodeInternals:w});P(S.sourceEvent,L,I)}};if(t)j.on(".drag",null);else{const S=AI().on("start",w=>{const{domNode:A,nodeDragThreshold:E}=l.getState();E===0&&C(w),y.current=!1;const O=b(w);f.current=O,h.current=(A==null?void 0:A.getBoundingClientRect())||null,g.current=Vn(w.sourceEvent,h.current)}).on("drag",w=>{var z,k;const A=b(w),{autoPanOnNodeDrag:E,nodeDragThreshold:O}=l.getState();if(w.sourceEvent.type==="touchmove"&&w.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!_.current&&v.current&&E&&(_.current=!0,T()),!v.current){const P=A.xSnapped-(((z=f==null?void 0:f.current)==null?void 0:z.x)??0),R=A.ySnapped-(((k=f==null?void 0:f.current)==null?void 0:k.y)??0);Math.sqrt(P*P+R*R)>O&&C(w)}(f.current.x!==A.xSnapped||f.current.y!==A.ySnapped)&&u.current&&v.current&&(x.current=w.sourceEvent,g.current=Vn(w.sourceEvent,h.current),N(A))}}).on("end",w=>{if(!(!v.current||y.current)&&(d(!1),_.current=!1,v.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:A,nodeInternals:E,onNodeDragStop:O,onSelectionDragStop:z}=l.getState(),k=s?O:gd(z);if(A(u.current,!1,!1),k){const[P,R]=xd({nodeId:s,dragItems:u.current,nodeInternals:E});k(w.sourceEvent,P,R)}}}).filter(w=>{const A=w.target;return!w.button&&(!r||!$b(A,`.${r}`,e))&&(!n||$b(A,n,e))});return j.call(S),()=>{j.on(".drag",null)}}}},[e,t,r,n,o,l,s,a,b]),c}function wE(){const e=wt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:s,updateNodePositions:o,getNodes:a,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=a().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,g=r.isShiftPressed?4:1,x=r.x*p*g,_=r.y*h*g,v=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+x,y:y.positionAbsolute.y+_};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:j,position:N}=bE(y,b,n,s,void 0,d);y.position=N,y.positionAbsolute=j}return y});o(v,!0,!1)},[])}const go={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var ni=e=>{const t=({id:r,type:n,data:s,xPos:o,yPos:a,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:g,onDoubleClick:x,style:_,className:v,isDraggable:y,isSelectable:b,isConnectable:j,isFocusable:N,selectNodesOnDrag:T,sourcePosition:C,targetPosition:S,hidden:w,resizeObserver:A,dragHandle:E,zIndex:O,isParent:z,noDragClassName:k,noPanClassName:P,initialized:R,disableKeyboardA11y:D,ariaLabel:L,rfId:I,hasHandleBounds:M})=>{const F=wt(),q=m.useRef(null),H=m.useRef(null),V=m.useRef(C),Z=m.useRef(S),B=m.useRef(n),re=b||y||u||f||p||h,oe=wE(),X=ri(r,F.getState,f),Q=ri(r,F.getState,p),fe=ri(r,F.getState,h),xe=ri(r,F.getState,g),be=ri(r,F.getState,x),ye=te=>{const{nodeDragThreshold:ee}=F.getState();if(b&&(!T||!y||ee>0)&&Bg({id:r,store:F,nodeRef:q}),u){const ke=F.getState().nodeInternals.get(r);ke&&u(te,{...ke})}},ae=te=>{if(!Lg(te)&&!D)if(UC.includes(te.key)&&b){const ee=te.key==="Escape";Bg({id:r,store:F,unselect:ee,nodeRef:q})}else y&&d&&Object.prototype.hasOwnProperty.call(go,te.key)&&(F.setState({ariaLiveMessage:`Moved selected node ${te.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~a}`}),oe({x:go[te.key].x,y:go[te.key].y,isShiftPressed:te.shiftKey}))};m.useEffect(()=>()=>{H.current&&(A==null||A.unobserve(H.current),H.current=null)},[]),m.useEffect(()=>{if(q.current&&!w){const te=q.current;(!R||!M||H.current!==te)&&(H.current&&(A==null||A.unobserve(H.current)),A==null||A.observe(te),H.current=te)}},[w,R,M]),m.useEffect(()=>{const te=B.current!==n,ee=V.current!==C,ke=Z.current!==S;q.current&&(te||ee||ke)&&(te&&(B.current=n),ee&&(V.current=C),ke&&(Z.current=S),F.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,n,C,S]);const K=_E({nodeRef:q,disabled:w||!y,noDragClassName:k,handleSelector:E,nodeId:r,isSelectable:b,selectNodesOnDrag:T});return w?null:Y.createElement("div",{className:Qt(["react-flow__node",`react-flow__node-${n}`,{[P]:y},v,{selected:d,selectable:b,parent:z,dragging:K}]),ref:q,style:{zIndex:O,transform:`translate(${l}px,${c}px)`,pointerEvents:re?"all":"none",visibility:R?"visible":"hidden",..._},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:X,onMouseMove:Q,onMouseLeave:fe,onContextMenu:xe,onClick:ye,onDoubleClick:be,onKeyDown:N?ae:void 0,tabIndex:N?0:void 0,role:N?"button":void 0,"aria-describedby":D?void 0:`${dE}-${I}`,"aria-label":L},Y.createElement(OO,{value:r},Y.createElement(e,{id:r,data:s,type:n,xPos:o,yPos:a,selected:d,isConnectable:j,sourcePosition:C,targetPosition:S,dragging:K,dragHandle:E,zIndex:O})))};return t.displayName="NodeWrapper",m.memo(t)};const _M=e=>{const t=e.getNodes().filter(r=>r.selected);return{...ou(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function wM({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=wt(),{width:s,height:o,x:a,y:l,transformString:c,userSelectionActive:d}=Je(_M,Ot),u=wE(),f=m.useRef(null);if(m.useEffect(()=>{var g;r||(g=f.current)==null||g.focus({preventScroll:!0})},[r]),_E({nodeRef:f}),d||!s||!o)return null;const p=e?g=>{const x=n.getState().getNodes().filter(_=>_.selected);e(g,x)}:void 0,h=g=>{Object.prototype.hasOwnProperty.call(go,g.key)&&u({x:go[g.key].x,y:go[g.key].y,isShiftPressed:g.shiftKey})};return Y.createElement("div",{className:Qt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},Y.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:s,height:o,top:l,left:a}}))}var jM=m.memo(wM);const SM=e=>e.nodesSelectionActive,jE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:a,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:g,onSelectionEnd:x,multiSelectionKeyCode:_,panActivationKeyCode:v,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:N,panOnScroll:T,panOnScrollSpeed:C,panOnScrollMode:S,zoomOnDoubleClick:w,panOnDrag:A,defaultViewport:E,translateExtent:O,minZoom:z,maxZoom:k,preventScrolling:P,onSelectionContextMenu:R,noWheelClassName:D,noPanClassName:L,disableKeyboardA11y:I})=>{const M=Je(SM),F=ia(f),q=ia(v),H=q||A,V=q||T,Z=F||p&&H!==!0;return cM({deleteKeyCode:l,multiSelectionKeyCode:_}),Y.createElement(pM,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:N,panOnScroll:V,panOnScrollSpeed:C,panOnScrollMode:S,zoomOnDoubleClick:w,panOnDrag:!F&&H,defaultViewport:E,translateExtent:O,minZoom:z,maxZoom:k,zoomActivationKeyCode:y,preventScrolling:P,noWheelClassName:D,noPanClassName:L},Y.createElement(vE,{onSelectionStart:g,onSelectionEnd:x,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:a,panOnDrag:H,isSelecting:!!Z,selectionMode:h},e,M&&Y.createElement(jM,{onSelectionContextMenu:R,noPanClassName:L,disableKeyboardA11y:I})))};jE.displayName="FlowRenderer";var kM=m.memo(jE);function NM(e){return Je(m.useCallback(r=>e?ZC(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function CM(e){const t={input:ni(e.input||aE),default:ni(e.default||qg),output:ni(e.output||cE),group:ni(e.group||dy)},r={},n=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,o)=>(s[o]=ni(e[o]||qg),s),r);return{...t,...n}}const EM=({x:e,y:t,width:r,height:n,origin:s})=>!r||!n?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-n*s[1]},TM=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),SE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,updateNodeDimensions:o,onError:a}=Je(TM,Ot),l=NM(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));o(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),Y.createElement("div",{className:"react-flow__nodes",style:fy},l.map(u=>{var N,T,C;let f=u.type||"default";e.nodeTypes[f]||(a==null||a("003",xn.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),g=!!(u.selectable||s&&typeof u.selectable>"u"),x=!!(u.connectable||r&&typeof u.connectable>"u"),_=!!(u.focusable||n&&typeof u.focusable>"u"),v=e.nodeExtent?oy(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(v==null?void 0:v.x)??0,b=(v==null?void 0:v.y)??0,j=EM({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return Y.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||ce.Bottom,targetPosition:u.targetPosition||ce.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:j.x,yPosOrigin:j.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:g,isConnectable:x,isFocusable:_,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((N=u[it])==null?void 0:N.z)??0,isParent:!!((T=u[it])!=null&&T.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((C=u[it])!=null&&C.handleBounds)})}))};SE.displayName="NodeRenderer";var RM=m.memo(SE);const AM=(e,t,r)=>r===ce.Left?e-t:r===ce.Right?e+t:e,IM=(e,t,r)=>r===ce.Top?e-t:r===ce.Bottom?e+t:e,Bb="react-flow__edgeupdater",Wb=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:o,onMouseOut:a,type:l})=>Y.createElement("circle",{onMouseDown:s,onMouseEnter:o,onMouseOut:a,className:Qt([Bb,`${Bb}-${l}`]),cx:AM(t,n,e),cy:IM(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),PM=()=>!0;var $s=e=>{const t=({id:r,className:n,type:s,data:o,onClick:a,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:x,style:_,source:v,target:y,sourceX:b,sourceY:j,targetX:N,targetY:T,sourcePosition:C,targetPosition:S,elementsSelectable:w,hidden:A,sourceHandleId:E,targetHandleId:O,onContextMenu:z,onMouseEnter:k,onMouseMove:P,onMouseLeave:R,reconnectRadius:D,onReconnect:L,onReconnectStart:I,onReconnectEnd:M,markerEnd:F,markerStart:q,rfId:H,ariaLabel:V,isFocusable:Z,isReconnectable:B,pathOptions:re,interactionWidth:oe,disableKeyboardA11y:X})=>{const Q=m.useRef(null),[fe,xe]=m.useState(!1),[be,ye]=m.useState(!1),ae=wt(),K=m.useMemo(()=>`url('#${Fg(q,H)}')`,[q,H]),te=m.useMemo(()=>`url('#${Fg(F,H)}')`,[F,H]);if(A)return null;const ee=pe=>{var st;const{edges:U,addSelectedEdges:ve,unselectNodesAndEdges:he,multiSelectionActive:Fe}=ae.getState(),He=U.find(Ge=>Ge.id===r);He&&(w&&(ae.setState({nodesSelectionActive:!1}),He.selected&&Fe?(he({nodes:[],edges:[He]}),(st=Q.current)==null||st.blur()):ve([r])),a&&a(pe,He))},ke=ti(r,ae.getState,l),je=ti(r,ae.getState,z),Te=ti(r,ae.getState,k),Ne=ti(r,ae.getState,P),ne=ti(r,ae.getState,R),Se=(pe,U)=>{if(pe.button!==0)return;const{edges:ve,isValidConnection:he}=ae.getState(),Fe=U?y:v,He=(U?O:E)||null,st=U?"target":"source",Ge=he||PM,$=U,W=ve.find($e=>$e.id===r);ye(!0),I==null||I(pe,W,st);const G=$e=>{ye(!1),M==null||M($e,W,st)};nE({event:pe,handleId:He,nodeId:Fe,onConnect:$e=>L==null?void 0:L(W,$e),isTarget:$,getState:ae.getState,setState:ae.setState,isValidConnection:Ge,edgeUpdaterType:st,onReconnectEnd:G})},Ve=pe=>Se(pe,!0),ct=pe=>Se(pe,!1),We=()=>xe(!0),Pe=()=>xe(!1),ie=!w&&!a,ge=pe=>{var U;if(!X&&UC.includes(pe.key)&&w){const{unselectNodesAndEdges:ve,addSelectedEdges:he,edges:Fe}=ae.getState();pe.key==="Escape"?((U=Q.current)==null||U.blur(),ve({edges:[Fe.find(st=>st.id===r)]})):he([r])}};return Y.createElement("g",{className:Qt(["react-flow__edge",`react-flow__edge-${s}`,n,{selected:c,animated:d,inactive:ie,updating:fe}]),onClick:ee,onDoubleClick:ke,onContextMenu:je,onMouseEnter:Te,onMouseMove:Ne,onMouseLeave:ne,onKeyDown:Z?ge:void 0,tabIndex:Z?0:void 0,role:Z?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":V===null?void 0:V||`Edge from ${v} to ${y}`,"aria-describedby":Z?`${fE}-${H}`:void 0,ref:Q},!be&&Y.createElement(e,{id:r,source:v,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:x,data:o,style:_,sourceX:b,sourceY:j,targetX:N,targetY:T,sourcePosition:C,targetPosition:S,sourceHandleId:E,targetHandleId:O,markerStart:K,markerEnd:te,pathOptions:re,interactionWidth:oe}),B&&Y.createElement(Y.Fragment,null,(B==="source"||B===!0)&&Y.createElement(Wb,{position:C,centerX:b,centerY:j,radius:D,onMouseDown:Ve,onMouseEnter:We,onMouseOut:Pe,type:"source"}),(B==="target"||B===!0)&&Y.createElement(Wb,{position:S,centerX:N,centerY:T,radius:D,onMouseDown:ct,onMouseEnter:We,onMouseOut:Pe,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function OM(e){const t={default:$s(e.default||mc),straight:$s(e.bezier||ly),step:$s(e.step||ay),smoothstep:$s(e.step||su),simplebezier:$s(e.simplebezier||iy)},r={},n=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,o)=>(s[o]=$s(e[o]||mc),s),r);return{...t,...n}}function Hb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,o=(r==null?void 0:r.width)||t.width,a=(r==null?void 0:r.height)||t.height;switch(e){case ce.Top:return{x:n+o/2,y:s};case ce.Right:return{x:n+o,y:s+a/2};case ce.Bottom:return{x:n+o/2,y:s+a};case ce.Left:return{x:n,y:s+a/2}}}function Ub(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const MM=(e,t,r,n,s,o)=>{const a=Hb(r,e,t),l=Hb(o,n,s);return{sourceX:a.x,sourceY:a.y,targetX:l.x,targetY:l.y}};function DM({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:s,targetHeight:o,width:a,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+n,t.y+o)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=sa({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:a/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Vb(e){var n,s,o,a,l;const t=((n=e==null?void 0:e[it])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)<"u";return[{x:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const LM=[{level:0,isMaxLevel:!0,edges:[]}];function zM(e,t,r=!1){let n=-1;const s=e.reduce((a,l)=>{var u,f;const c=mr(l.zIndex);let d=c?l.zIndex:0;if(r){const p=t.get(l.target),h=t.get(l.source),g=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),x=Math.max(((u=h==null?void 0:h[it])==null?void 0:u.z)||0,((f=p==null?void 0:p[it])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(g?x:0)}return a[d]?a[d].push(l):a[d]=[l],n=d>n?d:n,a},{}),o=Object.entries(s).map(([a,l])=>{const c=+a;return{edges:l,level:c,isMaxLevel:c===n}});return o.length===0?LM:o}function FM(e,t,r){const n=Je(m.useCallback(s=>e?s.edges.filter(o=>{const a=t.get(o.source),l=t.get(o.target);return(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&DM({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return zM(n,t,r)}const $M=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),qM=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Gb={[hc.Arrow]:$M,[hc.ArrowClosed]:qM};function BM(e){const t=wt();return m.useMemo(()=>{var s,o;return Object.prototype.hasOwnProperty.call(Gb,e)?Gb[e]:((o=(s=t.getState()).onError)==null||o.call(s,"009",xn.error009(e)),null)},[e])}const WM=({id:e,type:t,color:r,width:n=12.5,height:s=12.5,markerUnits:o="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{const c=BM(t);return c?Y.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:l,refX:"0",refY:"0"},Y.createElement(c,{color:r,strokeWidth:a})):null},HM=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((s,o)=>([o.markerStart,o.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const l=Fg(a,t);n.includes(l)||(s.push({id:l,color:a.color||e,...a}),n.push(l))}}),s),[]).sort((s,o)=>s.id.localeCompare(o.id))},kE=({defaultColor:e,rfId:t})=>{const r=Je(m.useCallback(HM({defaultColor:e,rfId:t}),[e,t]),(n,s)=>!(n.length!==s.length||n.some((o,a)=>o.id!==s[a].id)));return Y.createElement("defs",null,r.map(n=>Y.createElement(WM,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};kE.displayName="MarkerDefinitions";var UM=m.memo(kE);const VM=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),NE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:s,noPanClassName:o,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:x,children:_,disableKeyboardA11y:v})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:j,width:N,height:T,connectionMode:C,nodeInternals:S,onError:w}=Je(VM,Ot),A=FM(t,S,r);return N?Y.createElement(Y.Fragment,null,A.map(({level:E,edges:O,isMaxLevel:z})=>Y.createElement("svg",{key:E,style:{zIndex:E},width:N,height:T,className:"react-flow__edges react-flow__container"},z&&Y.createElement(UM,{defaultColor:e,rfId:n}),Y.createElement("g",null,O.map(k=>{const[P,R,D]=Vb(S.get(k.source)),[L,I,M]=Vb(S.get(k.target));if(!D||!M)return null;let F=k.type||"default";s[F]||(w==null||w("011",xn.error011(F)),F="default");const q=s[F]||s.default,H=C===Cs.Strict?I.target:(I.target??[]).concat(I.source??[]),V=Ub(R.source,k.sourceHandle),Z=Ub(H,k.targetHandle),B=(V==null?void 0:V.position)||ce.Bottom,re=(Z==null?void 0:Z.position)||ce.Top,oe=!!(k.focusable||y&&typeof k.focusable>"u"),X=k.reconnectable||k.updatable,Q=typeof p<"u"&&(X||b&&typeof X>"u");if(!V||!Z)return w==null||w("008",xn.error008(V,k)),null;const{sourceX:fe,sourceY:xe,targetX:be,targetY:ye}=MM(P,V,B,L,Z,re);return Y.createElement(q,{key:k.id,id:k.id,className:Qt([k.className,o]),type:F,data:k.data,selected:!!k.selected,animated:!!k.animated,hidden:!!k.hidden,label:k.label,labelStyle:k.labelStyle,labelShowBg:k.labelShowBg,labelBgStyle:k.labelBgStyle,labelBgPadding:k.labelBgPadding,labelBgBorderRadius:k.labelBgBorderRadius,style:k.style,source:k.source,target:k.target,sourceHandleId:k.sourceHandle,targetHandleId:k.targetHandle,markerEnd:k.markerEnd,markerStart:k.markerStart,sourceX:fe,sourceY:xe,targetX:be,targetY:ye,sourcePosition:B,targetPosition:re,elementsSelectable:j,onContextMenu:a,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:x,rfId:n,ariaLabel:k.ariaLabel,isFocusable:oe,isReconnectable:Q,pathOptions:"pathOptions"in k?k.pathOptions:void 0,interactionWidth:k.interactionWidth,disableKeyboardA11y:v})})))),_):null};NE.displayName="EdgeRenderer";var GM=m.memo(NE);const KM=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function YM({children:e}){const t=Je(KM);return Y.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function XM(e){const t=iu(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const QM={[ce.Left]:ce.Right,[ce.Right]:ce.Left,[ce.Top]:ce.Bottom,[ce.Bottom]:ce.Top},CE=({nodeId:e,handleType:t,style:r,type:n=In.Bezier,CustomComponent:s,connectionStatus:o})=>{var T,C,S;const{fromNode:a,handleId:l,toX:c,toY:d,connectionMode:u}=Je(m.useCallback(w=>({fromNode:w.nodeInternals.get(e),handleId:w.connectionHandleId,toX:(w.connectionPosition.x-w.transform[0])/w.transform[2],toY:(w.connectionPosition.y-w.transform[1])/w.transform[2],connectionMode:w.connectionMode}),[e]),Ot),f=(T=a==null?void 0:a[it])==null?void 0:T.handleBounds;let p=f==null?void 0:f[t];if(u===Cs.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!a||!p)return null;const h=l?p.find(w=>w.id===l):p[0],g=h?h.x+h.width/2:(a.width??0)/2,x=h?h.y+h.height/2:a.height??0,_=(((C=a.positionAbsolute)==null?void 0:C.x)??0)+g,v=(((S=a.positionAbsolute)==null?void 0:S.y)??0)+x,y=h==null?void 0:h.position,b=y?QM[y]:null;if(!y||!b)return null;if(s)return Y.createElement(s,{connectionLineType:n,connectionLineStyle:r,fromNode:a,fromHandle:h,fromX:_,fromY:v,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:o});let j="";const N={sourceX:_,sourceY:v,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return n===In.Bezier?[j]=XC(N):n===In.Step?[j]=zg({...N,borderRadius:0}):n===In.SmoothStep?[j]=zg(N):n===In.SimpleBezier?[j]=YC(N):j=`M${_},${v} ${c},${d}`,Y.createElement("path",{d:j,fill:"none",className:"react-flow__connection-path",style:r})};CE.displayName="ConnectionLine";const ZM=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function JM({containerStyle:e,style:t,type:r,component:n}){const{nodeId:s,handleType:o,nodesConnectable:a,width:l,height:c,connectionStatus:d}=Je(ZM,Ot);return!(s&&o&&l&&a)?null:Y.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},Y.createElement("g",{className:Qt(["react-flow__connection",d])},Y.createElement(CE,{nodeId:s,handleType:o,style:t,type:r,CustomComponent:n,connectionStatus:d})))}function Kb(e,t){return m.useRef(null),wt(),m.useMemo(()=>t(e),[e])}const EE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:s,onInit:o,onNodeClick:a,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:g,onSelectionStart:x,onSelectionEnd:_,connectionLineType:v,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:j,selectionKeyCode:N,selectionOnDrag:T,selectionMode:C,multiSelectionKeyCode:S,panActivationKeyCode:w,zoomActivationKeyCode:A,deleteKeyCode:E,onlyRenderVisibleElements:O,elementsSelectable:z,selectNodesOnDrag:k,defaultViewport:P,translateExtent:R,minZoom:D,maxZoom:L,preventScrolling:I,defaultMarkerColor:M,zoomOnScroll:F,zoomOnPinch:q,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:Z,zoomOnDoubleClick:B,panOnDrag:re,onPaneClick:oe,onPaneMouseEnter:X,onPaneMouseMove:Q,onPaneMouseLeave:fe,onPaneScroll:xe,onPaneContextMenu:be,onEdgeContextMenu:ye,onEdgeMouseEnter:ae,onEdgeMouseMove:K,onEdgeMouseLeave:te,onReconnect:ee,onReconnectStart:ke,onReconnectEnd:je,reconnectRadius:Te,noDragClassName:Ne,noWheelClassName:ne,noPanClassName:Se,elevateEdgesOnSelect:Ve,disableKeyboardA11y:ct,nodeOrigin:We,nodeExtent:Pe,rfId:ie})=>{const ge=Kb(e,CM),pe=Kb(t,OM);return XM(o),Y.createElement(kM,{onPaneClick:oe,onPaneMouseEnter:X,onPaneMouseMove:Q,onPaneMouseLeave:fe,onPaneContextMenu:be,onPaneScroll:xe,deleteKeyCode:E,selectionKeyCode:N,selectionOnDrag:T,selectionMode:C,onSelectionStart:x,onSelectionEnd:_,multiSelectionKeyCode:S,panActivationKeyCode:w,zoomActivationKeyCode:A,elementsSelectable:z,onMove:r,onMoveStart:n,onMoveEnd:s,zoomOnScroll:F,zoomOnPinch:q,zoomOnDoubleClick:B,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:Z,panOnDrag:re,defaultViewport:P,translateExtent:R,minZoom:D,maxZoom:L,onSelectionContextMenu:g,preventScrolling:I,noDragClassName:Ne,noWheelClassName:ne,noPanClassName:Se,disableKeyboardA11y:ct},Y.createElement(YM,null,Y.createElement(GM,{edgeTypes:pe,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:O,onEdgeContextMenu:ye,onEdgeMouseEnter:ae,onEdgeMouseMove:K,onEdgeMouseLeave:te,onReconnect:ee,onReconnectStart:ke,onReconnectEnd:je,reconnectRadius:Te,defaultMarkerColor:M,noPanClassName:Se,elevateEdgesOnSelect:!!Ve,disableKeyboardA11y:ct,rfId:ie},Y.createElement(JM,{style:y,type:v,component:b,containerStyle:j})),Y.createElement("div",{className:"react-flow__edgelabel-renderer"}),Y.createElement(RM,{nodeTypes:ge,onNodeClick:a,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:k,onlyRenderVisibleElements:O,noPanClassName:Se,noDragClassName:Ne,disableKeyboardA11y:ct,nodeOrigin:We,nodeExtent:Pe,rfId:ie})))};EE.displayName="GraphView";var e8=m.memo(EE);const Wg=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],jn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Wg,nodeExtent:Wg,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Cs.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:EO,isValidConnection:void 0},t8=()=>WA((e,t)=>({...jn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:s,elevateNodesOnSelect:o}=t();e({nodeInternals:hd(r,n,s,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(s=>({...n,...s}))})},setDefaultNodesAndEdges:(r,n)=>{const s=typeof r<"u",o=typeof n<"u",a=s?hd(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:o?n:[],hasDefaultNodes:s,hasDefaultEdges:o})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:s,fitViewOnInit:o,fitViewOnInitDone:a,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((x,_)=>{const v=s.get(_.id);if(v!=null&&v.hidden)s.set(v.id,{...v,[it]:{...v[it],handleBounds:void 0}});else if(v){const y=sy(_.nodeElement);!!(y.width&&y.height&&(v.width!==y.width||v.height!==y.height||_.forceUpdate))&&(s.set(v.id,{...v,[it]:{...v[it],handleBounds:{source:qb(".source",_.nodeElement,p,d),target:qb(".target",_.nodeElement,p,d)}},...y}),x.push({id:v.id,type:"dimensions",dimensions:y}))}return x},[]);hE(s,d);const g=a||o&&!a&&mE(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:g}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,s=!1)=>{const{triggerNodeChanges:o}=t(),a=r.map(l=>{const c={id:l.id,type:"position",dragging:s};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});o(a)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:s,hasDefaultNodes:o,nodeOrigin:a,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(o){const d=gE(r,l()),u=hd(d,s,a,c);e({nodeInternals:u})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let a,l=null;n?a=r.map(c=>En(c,!0)):(a=oo(o(),r),l=oo(s,[])),sl({changedNodes:a,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let a,l=null;n?a=r.map(c=>En(c,!0)):(a=oo(s,r),l=oo(o(),[])),sl({changedNodes:l,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:s,getNodes:o}=t(),a=r||o(),l=n||s,c=a.map(u=>(u.selected=!1,En(u.id,!1))),d=l.map(u=>En(u.id,!1));sl({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:s}=t();n==null||n.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:s}=t();n==null||n.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),o=n().filter(l=>l.selected).map(l=>En(l.id,!1)),a=r.filter(l=>l.selected).map(l=>En(l.id,!1));sl({changedNodes:o,changedEdges:a,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(s=>{s.positionAbsolute=oy(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:s,height:o,d3Zoom:a,d3Selection:l,translateExtent:c}=t();if(!a||!l||!r.x&&!r.y)return!1;const d=un.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),u=[[0,0],[s,o]],f=a==null?void 0:a.constrain()(d,u,c);return a.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:jn.connectionNodeId,connectionHandleId:jn.connectionHandleId,connectionHandleType:jn.connectionHandleType,connectionStatus:jn.connectionStatus,connectionStartHandle:jn.connectionStartHandle,connectionEndHandle:jn.connectionEndHandle}),reset:()=>e({...jn})}),Object.is),Mo=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=t8()),Y.createElement(_O,{value:t.current},e)};Mo.displayName="ReactFlowProvider";const TE=({children:e})=>m.useContext(nu)?Y.createElement(Y.Fragment,null,e):Y.createElement(Mo,null,e);TE.displayName="ReactFlowWrapper";const r8={input:aE,default:qg,output:cE,group:dy},n8={default:mc,straight:ly,step:ay,smoothstep:su,simplebezier:iy},s8=[0,0],o8=[15,15],i8={x:0,y:0,zoom:1},a8={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ja=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:o=r8,edgeTypes:a=n8,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:g,onConnectEnd:x,onClickConnectStart:_,onClickConnectEnd:v,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:N,onNodeDoubleClick:T,onNodeDragStart:C,onNodeDrag:S,onNodeDragStop:w,onNodesDelete:A,onEdgesDelete:E,onSelectionChange:O,onSelectionDragStart:z,onSelectionDrag:k,onSelectionDragStop:P,onSelectionContextMenu:R,onSelectionStart:D,onSelectionEnd:L,connectionMode:I=Cs.Strict,connectionLineType:M=In.Bezier,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:H,deleteKeyCode:V="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:B=!1,selectionMode:re=oa.Full,panActivationKeyCode:oe="Space",multiSelectionKeyCode:X=pc()?"Meta":"Control",zoomActivationKeyCode:Q=pc()?"Meta":"Control",snapToGrid:fe=!1,snapGrid:xe=o8,onlyRenderVisibleElements:be=!1,selectNodesOnDrag:ye=!0,nodesDraggable:ae,nodesConnectable:K,nodesFocusable:te,nodeOrigin:ee=s8,edgesFocusable:ke,edgesUpdatable:je,elementsSelectable:Te,defaultViewport:Ne=i8,minZoom:ne=.5,maxZoom:Se=2,translateExtent:Ve=Wg,preventScrolling:ct=!0,nodeExtent:We,defaultMarkerColor:Pe="#b1b1b7",zoomOnScroll:ie=!0,zoomOnPinch:ge=!0,panOnScroll:pe=!1,panOnScrollSpeed:U=.5,panOnScrollMode:ve=hs.Free,zoomOnDoubleClick:he=!0,panOnDrag:Fe=!0,onPaneClick:He,onPaneMouseEnter:st,onPaneMouseMove:Ge,onPaneMouseLeave:$,onPaneScroll:W,onPaneContextMenu:G,children:se,onEdgeContextMenu:$e,onEdgeDoubleClick:pt,onEdgeMouseEnter:lr,onEdgeMouseMove:Tt,onEdgeMouseLeave:jt,onEdgeUpdate:Bt,onEdgeUpdateStart:Lr,onEdgeUpdateEnd:at,onReconnect:ue,onReconnectStart:de,onReconnectEnd:Ye,reconnectRadius:wr=10,edgeUpdaterRadius:ns=10,onNodesChange:zr,onEdgesChange:ss,noDragClassName:Ho="nodrag",noWheelClassName:TT="nowheel",noPanClassName:Ky="nopan",fitView:RT=!1,fitViewOptions:AT,connectOnClick:IT=!0,attributionPosition:PT,proOptions:OT,defaultEdgeOptions:MT,elevateNodesOnSelect:DT=!0,elevateEdgesOnSelect:LT=!1,disableKeyboardA11y:Yy=!1,autoPanOnConnect:zT=!0,autoPanOnNodeDrag:FT=!0,connectionRadius:$T=20,isValidConnection:qT,onError:BT,style:WT,id:Xy,nodeDragThreshold:HT,...UT},VT)=>{const Mu=Xy||"1";return Y.createElement("div",{...UT,style:{...WT,...a8},ref:VT,className:Qt(["react-flow",s]),"data-testid":"rf__wrapper",id:Xy},Y.createElement(TE,null,Y.createElement(e8,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:N,onNodeDoubleClick:T,nodeTypes:o,edgeTypes:a,connectionLineType:M,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:H,selectionKeyCode:Z,selectionOnDrag:B,selectionMode:re,deleteKeyCode:V,multiSelectionKeyCode:X,panActivationKeyCode:oe,zoomActivationKeyCode:Q,onlyRenderVisibleElements:be,selectNodesOnDrag:ye,defaultViewport:Ne,translateExtent:Ve,minZoom:ne,maxZoom:Se,preventScrolling:ct,zoomOnScroll:ie,zoomOnPinch:ge,zoomOnDoubleClick:he,panOnScroll:pe,panOnScrollSpeed:U,panOnScrollMode:ve,panOnDrag:Fe,onPaneClick:He,onPaneMouseEnter:st,onPaneMouseMove:Ge,onPaneMouseLeave:$,onPaneScroll:W,onPaneContextMenu:G,onSelectionContextMenu:R,onSelectionStart:D,onSelectionEnd:L,onEdgeContextMenu:$e,onEdgeDoubleClick:pt,onEdgeMouseEnter:lr,onEdgeMouseMove:Tt,onEdgeMouseLeave:jt,onReconnect:ue??Bt,onReconnectStart:de??Lr,onReconnectEnd:Ye??at,reconnectRadius:wr??ns,defaultMarkerColor:Pe,noDragClassName:Ho,noWheelClassName:TT,noPanClassName:Ky,elevateEdgesOnSelect:LT,rfId:Mu,disableKeyboardA11y:Yy,nodeOrigin:ee,nodeExtent:We}),Y.createElement(QO,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:g,onConnectEnd:x,onClickConnectStart:_,onClickConnectEnd:v,nodesDraggable:ae,nodesConnectable:K,nodesFocusable:te,edgesFocusable:ke,edgesUpdatable:je,elementsSelectable:Te,elevateNodesOnSelect:DT,minZoom:ne,maxZoom:Se,nodeExtent:We,onNodesChange:zr,onEdgesChange:ss,snapToGrid:fe,snapGrid:xe,connectionMode:I,translateExtent:Ve,connectOnClick:IT,defaultEdgeOptions:MT,fitView:RT,fitViewOptions:AT,onNodesDelete:A,onEdgesDelete:E,onNodeDragStart:C,onNodeDrag:S,onNodeDragStop:w,onSelectionDrag:k,onSelectionDragStart:z,onSelectionDragStop:P,noPanClassName:Ky,nodeOrigin:ee,rfId:Mu,autoPanOnConnect:zT,autoPanOnNodeDrag:FT,onError:BT,connectionRadius:$T,isValidConnection:qT,nodeDragThreshold:HT}),Y.createElement(YO,{onSelectionChange:O}),se,Y.createElement(jO,{proOptions:OT,position:PT}),Y.createElement(rM,{rfId:Mu,disableKeyboardA11y:Yy})))});ja.displayName="ReactFlow";function RE(e){return t=>{const[r,n]=m.useState(t),s=m.useCallback(o=>n(a=>e(o,a)),[]);return[r,n,s]}}const AE=RE(gE),IE=RE(xM),PE=({id:e,x:t,y:r,width:n,height:s,style:o,color:a,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:g,backgroundColor:x}=o||{},_=a||g||x;return Y.createElement("rect",{className:Qt(["react-flow__minimap-node",{selected:h},d]),x:t,y:r,rx:u,ry:u,width:n,height:s,fill:_,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?v=>p(v,e):void 0})};PE.displayName="MiniMapNode";var l8=m.memo(PE);const c8=e=>e.nodeOrigin,u8=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),vd=e=>e instanceof Function?e:()=>e;function d8({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:s=2,nodeComponent:o=l8,onClick:a}){const l=Je(u8,Ot),c=Je(c8),d=vd(t),u=vd(e),f=vd(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Y.createElement(Y.Fragment,null,l.map(h=>{const{x:g,y:x}=ys(h,c).positionAbsolute;return Y.createElement(o,{key:h.id,x:g,y:x,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:n,strokeColor:u(h),strokeWidth:s,shapeRendering:p,onClick:a,id:h.id})}))}var f8=m.memo(d8);const p8=200,h8=150,m8=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?NO(ou(t,e.nodeOrigin),r):r,rfId:e.rfId}},x8="react-flow__minimap-desc";function OE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:s="",nodeBorderRadius:o=5,nodeStrokeWidth:a=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:g=!1,zoomable:x=!1,ariaLabel:_="React Flow mini map",inversePan:v=!1,zoomStep:y=10,offsetScale:b=5}){const j=wt(),N=m.useRef(null),{boundingRect:T,viewBB:C,rfId:S}=Je(m8,Ot),w=(e==null?void 0:e.width)??p8,A=(e==null?void 0:e.height)??h8,E=T.width/w,O=T.height/A,z=Math.max(E,O),k=z*w,P=z*A,R=b*z,D=T.x-(k-T.width)/2-R,L=T.y-(P-T.height)/2-R,I=k+R*2,M=P+R*2,F=`${x8}-${S}`,q=m.useRef(0);q.current=z,m.useEffect(()=>{if(N.current){const Z=pr(N.current),B=X=>{const{transform:Q,d3Selection:fe,d3Zoom:xe}=j.getState();if(X.sourceEvent.type!=="wheel"||!fe||!xe)return;const be=-X.sourceEvent.deltaY*(X.sourceEvent.deltaMode===1?.05:X.sourceEvent.deltaMode?1:.002)*y,ye=Q[2]*Math.pow(2,be);xe.scaleTo(fe,ye)},re=X=>{const{transform:Q,d3Selection:fe,d3Zoom:xe,translateExtent:be,width:ye,height:ae}=j.getState();if(X.sourceEvent.type!=="mousemove"||!fe||!xe)return;const K=q.current*Math.max(1,Q[2])*(v?-1:1),te={x:Q[0]-X.sourceEvent.movementX*K,y:Q[1]-X.sourceEvent.movementY*K},ee=[[0,0],[ye,ae]],ke=un.translate(te.x,te.y).scale(Q[2]),je=xe.constrain()(ke,ee,be);xe.transform(fe,je)},oe=FC().on("zoom",g?re:null).on("zoom.wheel",x?B:null);return Z.call(oe),()=>{Z.on("zoom",null)}}},[g,x,v,y]);const H=p?Z=>{const B=Cr(Z);p(Z,{x:B[0],y:B[1]})}:void 0,V=h?(Z,B)=>{const re=j.getState().nodeInternals.get(B);h(Z,re)}:void 0;return Y.createElement(Un,{position:f,style:e,className:Qt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},Y.createElement("svg",{width:w,height:A,viewBox:`${D} ${L} ${I} ${M}`,role:"img","aria-labelledby":F,ref:N,onClick:H},_&&Y.createElement("title",{id:F},_),Y.createElement(f8,{onClick:V,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:l}),Y.createElement("path",{className:"react-flow__minimap-mask",d:`M${D-R},${L-R}h${I+R*2}v${M+R*2}h${-I-R*2}z
        M${C.x},${C.y}h${C.width}v${C.height}h${-C.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}OE.displayName="MiniMap";var ME=m.memo(OE);const il={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},g8=180,v8=400,y8=260,b8=48;function _8(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function w8({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:s,onToggleShowArchived:o,userSection:a}){const[l,c]=m.useState(!1),[d,u]=m.useState(y8),[f,p]=m.useState(!1),h=m.useRef(null),g=m.useRef(null);m.useEffect(()=>{g.current&&g.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const x=m.useMemo(()=>Object.values(e).sort((N,T)=>{const C=(N.name||"").localeCompare(T.name||"");return C!==0?C:(N.projectId||"").localeCompare(T.projectId||"")}),[e]),_=()=>{n()},v=m.useCallback(N=>{N.preventDefault(),p(!0)},[]),y=m.useCallback(N=>{if(!f)return;const T=Math.min(v8,Math.max(g8,N.clientX));u(T)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const j=l?b8:d;return i.jsxs("div",{ref:h,className:"h-full flex flex-col relative",onWheel:N=>N.stopPropagation(),style:{width:j,minWidth:j,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),i.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:s?"#f59e0b":"var(--text-muted)"},title:s?"Hide archived":"Show archived",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),i.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:i.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&i.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:x.map(N=>{const T=t===N.id;return i.jsxs("div",{ref:T?g:null,onClick:()=>r(N.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:T?"var(--state-active-bg)":"transparent",border:T?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:T?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:T?"#ffffff":il[N.status]||il.queued}}),i.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:T?"#ffffff":"var(--text-primary)"},children:N.name}),N.isArchived&&i.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:T?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:i.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[i.jsx("span",{className:"text-[10px] font-mono",style:{color:T?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:N.projectId}),i.jsx("span",{className:"text-[10px]",style:{color:T?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:_8(N.createdAt)})]})]},N.id)})}),l&&i.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:x.map(N=>i.jsx("div",{onClick:()=>r(N.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:N.name,children:i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:il[N.status]||il.queued,boxShadow:t===N.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},N.id))}),!l&&i.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsxs("button",{onClick:_,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[i.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),i.jsx("span",{children:"New Project"})]})}),l&&i.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:i.jsx("button",{onClick:_,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:i.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),a,!l&&i.jsx("div",{onMouseDown:v,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function j8({stations:e}){if(!(e!=null&&e.length))return null;const t=e.reduce((o,a,l)=>a.state==="complete"?l:o,-1),r=e.findIndex(o=>o.state==="active"),n=e.find(o=>o.state==="active"),s=n==null?void 0:n.currentStep;return i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"relative flex items-start",children:[i.jsx("div",{className:"absolute h-0.5 left-0 right-0",style:{top:5,background:"var(--state-queued-bg)"}}),t>=0&&i.jsx("div",{className:"absolute h-0.5 left-0",style:{top:5,width:`${(t+.5)/e.length*100}%`,background:"var(--state-stabilized-bg)"}}),r>=0&&i.jsx("div",{className:"absolute h-0.5",style:{top:5,left:t>=0?`${(t+.5)/e.length*100}%`:"0%",width:t>=0?`${(r-t)/e.length*100}%`:`${(r+.5)/e.length*100}%`,background:"var(--state-active-bg)"}}),e.map(o=>{const a=o.state==="active",c=o.state==="complete"?"var(--state-stabilized-bg)":a?"var(--state-active-bg)":o.state==="failed"?"var(--state-blocked-bg)":"var(--state-queued-bg)",d=a?"var(--state-active-text)":"var(--text-muted)";return i.jsxs("div",{className:"flex-1 flex flex-col items-center relative z-10",children:[i.jsx("div",{className:`w-3 h-3 rounded-full${a?" station-active":""}${a&&o.needs_input?" station-needs-input":""}`,style:{background:c,boxShadow:a&&o.needs_input?"0 0 0 2px var(--state-active-bg)":void 0}}),i.jsx("span",{className:"text-[7px] mt-0.5",style:{color:a&&o.needs_input?"var(--state-active-text)":d,fontWeight:a?500:400},children:o.label})]},o.id)})]}),s&&i.jsx("div",{className:"text-center text-[8px] mt-1 font-medium",style:{color:"var(--state-active-text)"},children:s.name})]})}const Yb={light:{blocked:"#ef4444",in_progress:"#6366f1",ready:"#eab308",stabilized:"#10b981",active:"#6366f1",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},industrial:{blocked:"#ef4444",in_progress:"#f59e0b",ready:"#eab308",stabilized:"#10b981",active:"#f59e0b",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},blueprint:{blocked:"#ef4444",in_progress:"#fbbf24",ready:"#eab308",stabilized:"#10b981",active:"#fbbf24",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"}};function S8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const DE=(e,t)=>{var n;const r=S8(e);return((n=Yb[t])==null?void 0:n[r])||Yb.industrial.ready},Sr={WPS_PER_ROW:3,WP_WIDTH:220,WP_HEIGHT:85,WP_GAP_X:50,WP_GAP_Y:100,WP_OFFSET_X:80,WP_OFFSET_Y:80},xc={GAP:8},Pn=["industrial","light","blueprint"],k8=400,N8=560;function C8({question:e,value:t,onChange:r}){const n=e.answer_type||"text",s=e.choices||[];if(n==="single_choice"&&s.length>0)return i.jsx("div",{className:"space-y-1.5",children:s.map(o=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("input",{type:"radio",name:e.id,value:o.value,checked:t===o.value,onChange:()=>r(o.value),className:"w-3.5 h-3.5 accent-amber-500"}),i.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:o.label})]},o.value))});if(n==="multi_choice"&&s.length>0){const o=Array.isArray(t)?t:[];return i.jsx("div",{className:"space-y-1.5",children:s.map(a=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("input",{type:"checkbox",checked:o.includes(a.value),onChange:l=>{l.target.checked?r([...o,a.value]):r(o.filter(c=>c!==a.value))},className:"w-3.5 h-3.5 accent-amber-500"}),i.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:a.label})]},a.value))})}return n==="boolean"?i.jsx("div",{className:"flex gap-3",children:[{label:"Yes",value:!0},{label:"No",value:!1}].map(o=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("input",{type:"radio",name:e.id,checked:t===o.value,onChange:()=>r(o.value),className:"w-3.5 h-3.5 accent-amber-500"}),i.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:o.label})]},String(o.value)))}):n==="number"?i.jsx("input",{type:"number",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:o=>r(o.target.value?Number(o.target.value):"")}):n==="free_text"||n==="long_text"?i.jsx("textarea",{className:"w-full rounded px-2 py-1.5 text-xs border resize-none",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)",minHeight:60},value:t||"",onChange:o=>r(o.target.value)}):i.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:o=>r(o.target.value)})}function E8({priority:e}){if(!e)return null;const t={must:{bg:"bg-red-500/20",text:"text-red-400"},should:{bg:"bg-amber-500/20",text:"text-amber-400"},could:{bg:"bg-blue-500/20",text:"text-blue-400"}},r=t[e]||t.should;return i.jsx("span",{className:`${r.bg} ${r.text} text-[8px] px-1.5 py-0.5 rounded uppercase font-semibold`,children:e})}function T8({questions:e,nodeWidth:t,onSubmit:r,onClose:n}){const[s,o]=m.useState({}),[a,l]=m.useState(!1),[c,d]=m.useState(!1),u=e.filter(x=>x.required).every(x=>{const _=s[x.id];return Array.isArray(_)?_.length>0:_!==void 0&&_!==""}),f=a?N8:k8,p=(x,_)=>{o(v=>({...v,[x]:_}))},h=async()=>{d(!0);try{await r(s)}catch(x){console.error("Submit failed:",x),d(!1)}},g=x=>x.stopPropagation();return i.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:t+xc.GAP,width:f,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",transition:"width 0.2s ease",userSelect:"text"},onMouseDown:g,onPointerDown:g,onWheel:g,children:[i.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:xc.GAP}}),i.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),i.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[i.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:()=>l(!a),title:a?"Contract":"Expand",className:"hover:opacity-70 transition-opacity p-1",style:{color:"var(--text-sidecar-muted)"},children:a?i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),i.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]})]}),i.jsx("div",{className:`p-3 space-y-4 overflow-y-auto nowheel ${a?"max-h-[520px]":"max-h-[420px]"}`,children:e.map(x=>i.jsxs("div",{className:"pb-3",style:{borderBottom:"1px solid var(--border-input)"},children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[i.jsxs("label",{className:"block text-[11px] font-medium",style:{color:"var(--text-sidecar)"},children:[x.text," ",x.required&&i.jsx("span",{className:"text-amber-500",children:"*"})]}),i.jsx(E8,{priority:x.priority})]}),x.why_it_matters&&i.jsx("p",{className:"text-[9px] mb-2 italic",style:{color:"var(--text-sidecar-muted)"},children:x.why_it_matters}),i.jsx(C8,{question:x,value:s[x.id],onChange:_=>p(x.id,_)})]},x.id))}),i.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:i.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${u&&!c?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!u||c,onClick:h,children:c?"Submitting...":"Submit & Continue"})})]})}const Xb={DRAFT:{bg:"#e5e7eb",text:"#374151"},READY:{bg:"#fef3c7",text:"#92400e"},IN_PROGRESS:{bg:"#fde68a",text:"#78350f"},ACCEPTED:{bg:"#d1fae5",text:"#065f46"},REJECTED:{bg:"#fee2e2",text:"#991b1b"},BLOCKED:{bg:"#fecaca",text:"#991b1b"}},Qb={A:{bg:"#dbeafe",text:"#1e40af"},B:{bg:"#fef3c7",text:"#92400e"}};function R8(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString(void 0,{month:"short",day:"numeric"})+" "+t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}catch{return e}}function A8({workStatements:e,wpName:t,nodeWidth:r,onClose:n,onZoomComplete:s}){m.useEffect(()=>{if(s){const l=setTimeout(()=>s(),150);return()=>clearTimeout(l)}},[s]);const a=l=>l.stopPropagation();return i.jsxs("div",{className:"absolute top-0 border border-sky-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:r+xc.GAP,width:320,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",userSelect:"text"},onMouseDown:a,onPointerDown:a,onWheel:a,children:[i.jsx("div",{className:"absolute border-t-2 border-dashed border-sky-500/60",style:{top:14,right:"100%",width:xc.GAP}}),i.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-sky-500",style:{top:11,right:"100%",marginRight:-4}}),i.jsxs("div",{className:"bg-sky-500/10 border-b border-sky-500/30 px-3 py-2 flex justify-between items-center",children:[i.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Work Statements - ",t]}),i.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),i.jsxs("div",{className:"p-2 max-h-72 overflow-y-auto space-y-1.5",children:[e.map(l=>{const c=l.state||l.status||"DRAFT",d=Xb[c]||Xb.DRAFT,u=l.verification_mode||l.mode||"A",f=Qb[u]||Qb.A;return i.jsxs("div",{className:"px-2.5 py-2 rounded border",style:{borderColor:"var(--border-node)",background:"var(--bg-sidecar)"},children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[i.jsx("span",{className:"text-[10px] font-medium truncate flex-1",style:{color:"var(--text-sidecar)"},children:l.title||l.ws_id||l.id}),i.jsxs("span",{className:"text-[8px] font-bold px-1.5 py-0.5 rounded flex-shrink-0",style:{background:f.bg,color:f.text},children:["Mode ",u]})]}),i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{className:"text-[8px] font-semibold uppercase px-1.5 py-0.5 rounded",style:{background:d.bg,color:d.text},children:c}),l.updated_at&&i.jsx("span",{className:"text-[8px]",style:{color:"var(--text-sidecar-muted)"},children:R8(l.updated_at)})]})]},l.ws_id||l.id)}),e.length===0&&i.jsx("div",{className:"text-center py-4 text-[10px]",style:{color:"var(--text-sidecar-muted)"},children:"No work statements yet"})]}),i.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," work statement",e.length!==1?"s":""]})]})}const I8={blocked:{bg:"var(--state-blocked-bg)",text:"var(--state-blocked-text)"},in_progress:{bg:"var(--state-active-bg)",text:"var(--state-active-text)"},ready:{bg:"var(--state-ready-bg)",text:"var(--state-ready-text)"},stabilized:{bg:"var(--state-stabilized-bg)",text:"var(--state-stabilized-text)"}};function P8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const O8={blocked:"Blocked",in_progress:"In Progress",ready:"Ready",stabilized:"Stabilized"};function M8(e){return e?e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):""}function D8({data:e}){var A,E,O,z,k,P;const r=(e.level||1)===1,n=e.isExpanded,s=e.expandType,o=((A=e.questions)==null?void 0:A.length)>0,a=((E=e.workStatements)==null?void 0:E.length)>0,l=(O=e.stations)==null?void 0:O.some(R=>R.state==="active"&&R.needs_input),c=e.state||"ready_for_production",d=P8(c),u=d==="stabilized",f=d==="in_progress",p=d==="blocked",h=((z=e.stations)==null?void 0:z.length)>0,g=f?"node-active":"",x=r?"DOCUMENT":"WORK PACKAGE",_=r?"subway-node-header-doc":"subway-node-header-wp",v=I8[d],y=v.bg,b=v.text,j=v.bg,N=O8[d],T=e.ws_done??0,C=e.ws_total??0,S=e.mode_b_count??0,w=((k=e.dependencies)==null?void 0:k.length)??e.dep_count??0;return i.jsxs("div",{className:"relative",children:[i.jsx(yr,{type:"target",position:ce.Top,className:"!opacity-0",style:{left:"15%"}}),i.jsxs("div",{className:`subway-node rounded-lg border ${g} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:j},children:[i.jsxs("div",{className:`${_} border-b px-3 py-1.5 flex items-center justify-between`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-wp, var(--header-text-doc))"},children:x}),i.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&i.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:y}}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:b},children:N}),r&&e.desc&&i.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),!r&&i.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[i.jsxs("span",{className:"text-[8px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-badge, rgba(100,116,139,0.15))",color:"var(--text-muted)"},children:[T,"/",C," WS"]}),w>0&&i.jsxs("span",{className:"text-[8px] px-1.5 py-0.5 rounded",style:{background:"rgba(234,179,8,0.15)",color:"#a16207"},children:[w," dep",w!==1?"s":""]}),S>0&&i.jsxs("span",{className:"text-[8px] px-1.5 py-0.5 rounded",style:{background:"rgba(245,158,11,0.15)",color:"#b45309"},children:[S," Mode B"]})]}),h&&i.jsx(j8,{stations:e.stations}),i.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[u&&i.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-stabilized-bg)",color:"white"},onClick:R=>{var D;R.stopPropagation(),(D=e.onViewFullDocument)==null||D.call(e,e.instanceId?{docTypeId:e.docTypeId,instanceId:e.instanceId}:e.id)},children:"View Document"}),r&&d==="ready"&&i.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-ready-bg)",color:"white"},onClick:R=>{var D;R.stopPropagation(),(D=e.onStartProduction)==null||D.call(e,e.id)},children:"Start Production"}),l&&o&&!n&&i.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all amber-pulse",style:{backgroundColor:"var(--state-active-bg)",color:"white"},onClick:R=>{var D;R.stopPropagation(),(D=e.onExpand)==null||D.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&a&&(n&&s==="workStatements"?i.jsxs("span",{className:"text-[9px]",style:{color:"var(--text-muted)"},children:[e.workStatements.length," work statements expanded"]}):i.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:R=>{var D;R.stopPropagation(),(D=e.onExpand)==null||D.call(e,e.id,"workStatements")},children:[i.jsx("span",{style:{color:"var(--state-active-text, #f59e0b)"},children:e.workStatements.length}),i.jsx("span",{children:"work statements"}),i.jsx("span",{style:{color:"var(--state-active-text, #f59e0b)"},children:""})]}))]}),((P=e.blockedBy)==null?void 0:P.length)>0&&(p||d==="ready")&&i.jsxs("div",{className:"mt-2 pt-2 border-t text-[8px]",style:{borderColor:"var(--border-node)",color:"var(--text-muted)"},children:[i.jsx("span",{className:"font-medium",children:"Waiting for: "}),e.blockedBy.map(M8).join(", ")]})]})]}),n&&s==="questions"&&o&&i.jsx(T8,{questions:e.questions,nodeWidth:e.width,onSubmit:R=>{var D;return(D=e.onSubmitQuestions)==null?void 0:D.call(e,e.id,R)},onClose:()=>{var R;return(R=e.onCollapse)==null?void 0:R.call(e)}}),n&&s==="workStatements"&&a&&i.jsx(A8,{workStatements:e.workStatements,wpName:e.name,nodeWidth:e.width,onClose:()=>{var R;return(R=e.onCollapse)==null?void 0:R.call(e)},onZoomComplete:()=>{var R;return(R=e.onZoomToNode)==null?void 0:R.call(e,e.id)}}),i.jsx(yr,{type:"source",position:ce.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function L8(){return i.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[i.jsx(yr,{type:"target",position:ce.Top,style:{opacity:0}}),i.jsx(yr,{type:"source",position:ce.Bottom,style:{opacity:0}})]})}const py="/api/v1";class z8 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function F8(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ce(e,t={}){const r=`${py}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},s=await fetch(r,n);if(!s.ok){const o=await s.json().catch(()=>({}));throw new z8(o.detail||`Request failed: ${s.status}`,s.status,o)}return s.status===204?null:s.json()}const ze={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":F8()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return Ce(`/projects${r?"?"+r:""}`)},getProject:e=>Ce(`/projects/${e}`),getProjectTree:e=>Ce(`/projects/${e}/tree`),createProject:e=>Ce("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>Ce(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),saveFloorLayout:(e,t)=>Ce(`/projects/${e}`,{method:"PATCH",body:JSON.stringify({metadata:{floor_layout:t}})}),archiveProject:e=>Ce(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>Ce(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>Ce(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>Ce(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),Ce(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>Ce(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>Ce(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),getExecutions:()=>Ce("/executions"),getExecution:e=>Ce(`/executions/${e}`),getExecutionTranscript:e=>Ce(`/executions/${e}/transcript`),getExecutionQACoverage:e=>Ce(`/executions/${e}/qa-coverage`),getDocumentWorkflowExecutions:()=>Ce("/document-workflows/executions"),getDocumentWorkflowExecution:e=>Ce(`/document-workflows/executions/${e}`),startWorkflow:(e,t,r=null)=>Ce("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>Ce(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>Ce(`/document-workflows/executions/${e}`),getPgcAnswers:e=>Ce(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return Ce(`/projects/${e}/documents/${t}${n}`)},getDocumentRenderModel:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return Ce(`/projects/${e}/documents/${t}/render-model${n}`)},getDocumentPgc:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return Ce(`/projects/${e}/documents/${t}/pgc${n}`)},startIntake:()=>Ce("/intake/start",{method:"POST"}),getIntakeState:e=>Ce(`/intake/${e}`),submitIntakeMessage:(e,t)=>Ce(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>Ce(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>Ce(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>Ce(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>Ce(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>Ce(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>Ce(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>Ce(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>Ce(`/projects/${e}/workflow/complete`,{method:"POST"}),createIntent:(e,t)=>Ce("/intents",{method:"POST",body:JSON.stringify({project_id:e,...t})}),getIntent:e=>Ce(`/intents/${e}`)};function $8(e){const t=`${py}/production/events?project_id=${e}`;return new EventSource(t)}function q8(e){const t=`${py}/intake/${e}/events`;return new EventSource(t)}function B8(e){return`/auth/login/${e}`}function W8({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&i.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Zb({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const s=n==="numbered"?"decimal":"disc";return i.jsxs("div",{style:{marginBottom:12},children:[t.title&&i.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),i.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":s},children:r.map((o,a)=>i.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&i.jsx("span",{style:{color:"#10b981"},children:""}),typeof o=="string"?o:typeof o=="object"&&o!==null?i.jsx(H8,{item:o}):String(o)]},(o==null?void 0:o.id)||a))})]})}function H8({item:e}){const t=e.value||e.text||e.constraint||e.assumption||e.guardrail||e.recommendation||e.question||e.description||e.statement||e.name;return t?i.jsxs("span",{children:[e.id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af",marginRight:6},children:e.id}),t,e.constraint_type&&i.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.constraint_type}),e.confidence&&i.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:e.confidence==="high"?"#dcfce7":e.confidence==="medium"?"#fef3c7":"#fee2e2",color:e.confidence==="high"?"#166534":e.confidence==="medium"?"#92400e":"#991b1b"},children:e.confidence}),e.validation_approach&&i.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:[i.jsx("span",{style:{fontWeight:500},children:"Validation:"})," ",e.validation_approach]})]}):i.jsx("span",{children:Object.entries(e).map(([r,n],s)=>i.jsxs("span",{children:[s>0&&"  ",i.jsxs("span",{style:{fontWeight:500},children:[r,":"]})," ",typeof n=="string"?n:JSON.stringify(n)]},r))})}function U8({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,o={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&i.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),i.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:o.bg,color:o.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function LE({block:e}){const{data:t}=e,r=t.text||t.question||t.decision_area,{id:n,blocking:s,priority:o,tags:a,options:l}=t,c=t.why_it_matters||t.why_early,d=t.directed_to,u=t.recommendation_direction,f={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},p=f[o]||f.should;return i.jsx("div",{style:{padding:"12px 16px",background:s?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${s?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[i.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:n}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:r}),c&&i.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:c}),i.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[s&&i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),d&&i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:d.replace(/_/g," ")}),o&&i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:p.bg,color:p.text,textTransform:"uppercase"},children:o}),a==null?void 0:a.map((h,g)=>i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:h},g))]}),l&&l.length>0&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("span",{style:{fontSize:11,color:"#6b7280",fontWeight:500},children:"Options: "}),l.map((h,g)=>i.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:g>0?8:4},children:h},g))]}),u&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:"#059669"},children:["Recommendation: ",u]})]})]})})}function V8({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,s=t.blocking_count||r.filter(o=>o.blocking).length;return r.length===0?i.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[i.jsxs("span",{style:{color:"#6b7280"},children:[i.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),s>0&&i.jsxs("span",{style:{color:"#dc2626"},children:[i.jsx("strong",{children:s})," blocking"]})]}),r.map((o,a)=>i.jsx(LE,{block:{type:"schema:OpenQuestionV1",data:o}},o.id||a))]})}function Jb({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const s={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return i.jsxs("div",{style:{marginBottom:12},children:[n&&i.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,a)=>{const l=o.severity||o.impact||o.likelihood||"medium",c=s[l]||s.medium;return i.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[o.id&&i.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:o.id}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:o.risk||o.description||o.reason||JSON.stringify(o)}),o.impact&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",o.impact]}),o.impact_on_planning&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Planning impact: ",o.impact_on_planning]}),(o.mitigation||o.mitigation_direction)&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",o.mitigation||o.mitigation_direction]}),o.status&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:11,color:c.text,opacity:.7,textTransform:"capitalize"},children:["Status: ",o.status]})]}),i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},o.id||a)})})]})}function G8({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition",refined_description:"Description",architectural_style:"Architectural Style",style:"Architectural Style"}).filter(([s])=>t[s]&&typeof t[s]=="string").map(([s,o])=>({title:o,content:t[s]}));return n.length===0&&!t.title?null:i.jsxs("div",{style:{marginBottom:12},children:[t.title&&i.jsx("h3",{style:{fontSize:16,fontWeight:600,color:"#1f2937",marginBottom:12},children:t.title}),n.map((s,o)=>i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:s.title}),i.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:i.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:s.content})})]},o))]})}function K8({block:e}){const{data:t}=e,{story_id:r,title:n,intent:s,phase:o,risk_level:a,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[a]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[o]||u.mvp;return i.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&i.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),i.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),s&&i.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:s})]}),i.jsxs("div",{style:{display:"flex",gap:4},children:[o&&i.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:o}),d&&i.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:a})]})]})})}function Y8({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=t.technology||(Array.isArray(t.technology_choices)?t.technology_choices.join(", "):null),n=t.interfaces||[],s=t.dependencies||t.depends_on_components||[],o=t.responsibilities||[],a=t.layer,l=t.mvp_phase,c={fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:2},d={fontSize:13,color:"#374151",lineHeight:1.5,margin:0},u=(f,p)=>({fontSize:12,padding:"2px 8px",background:f,color:p,borderRadius:4});return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[i.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),a&&i.jsx("span",{style:u("#f0fdf4","#166534"),children:a}),l&&i.jsx("span",{style:u("#eff6ff","#1e40af"),children:l})]}),t.purpose&&i.jsx("p",{style:{...d,marginBottom:10,color:"#475569"},children:t.purpose}),r&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:c,children:"Technology"}),i.jsx("p",{style:d,children:r})]}),Array.isArray(o)&&o.length>0&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:c,children:"Responsibilities"}),i.jsx("ul",{style:{margin:0,paddingLeft:18},children:o.map((f,p)=>i.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:f},p))})]}),Array.isArray(n)&&n.length>0&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:c,children:"Interfaces"}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:n.map((f,p)=>i.jsx("span",{style:u("#e0e7ff","#3730a3"),children:f},p))})]}),Array.isArray(s)&&s.length>0&&i.jsxs("div",{children:[i.jsx("div",{style:c,children:"Dependencies"}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:s.map((f,p)=>i.jsx("span",{style:u("#fef3c7","#92400e"),children:f},p))})]})]})}function hy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yd,e1;function X8(){if(e1)return yd;e1=1;function e(){this.__data__=[],this.size=0}return yd=e,yd}var bd,t1;function Do(){if(t1)return bd;t1=1;function e(t,r){return t===r||t!==t&&r!==r}return bd=e,bd}var _d,r1;function au(){if(r1)return _d;r1=1;var e=Do();function t(r,n){for(var s=r.length;s--;)if(e(r[s][0],n))return s;return-1}return _d=t,_d}var wd,n1;function Q8(){if(n1)return wd;n1=1;var e=au(),t=Array.prototype,r=t.splice;function n(s){var o=this.__data__,a=e(o,s);if(a<0)return!1;var l=o.length-1;return a==l?o.pop():r.call(o,a,1),--this.size,!0}return wd=n,wd}var jd,s1;function Z8(){if(s1)return jd;s1=1;var e=au();function t(r){var n=this.__data__,s=e(n,r);return s<0?void 0:n[s][1]}return jd=t,jd}var Sd,o1;function J8(){if(o1)return Sd;o1=1;var e=au();function t(r){return e(this.__data__,r)>-1}return Sd=t,Sd}var kd,i1;function eD(){if(i1)return kd;i1=1;var e=au();function t(r,n){var s=this.__data__,o=e(s,r);return o<0?(++this.size,s.push([r,n])):s[o][1]=n,this}return kd=t,kd}var Nd,a1;function lu(){if(a1)return Nd;a1=1;var e=X8(),t=Q8(),r=Z8(),n=J8(),s=eD();function o(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,Nd=o,Nd}var Cd,l1;function tD(){if(l1)return Cd;l1=1;var e=lu();function t(){this.__data__=new e,this.size=0}return Cd=t,Cd}var Ed,c1;function rD(){if(c1)return Ed;c1=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Ed=e,Ed}var Td,u1;function nD(){if(u1)return Td;u1=1;function e(t){return this.__data__.get(t)}return Td=e,Td}var Rd,d1;function sD(){if(d1)return Rd;d1=1;function e(t){return this.__data__.has(t)}return Rd=e,Rd}var Ad,f1;function zE(){if(f1)return Ad;f1=1;var e=typeof Pa=="object"&&Pa&&Pa.Object===Object&&Pa;return Ad=e,Ad}var Id,p1;function Mr(){if(p1)return Id;p1=1;var e=zE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Id=r,Id}var Pd,h1;function Lo(){if(h1)return Pd;h1=1;var e=Mr(),t=e.Symbol;return Pd=t,Pd}var Od,m1;function oD(){if(m1)return Od;m1=1;var e=Lo(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,s=e?e.toStringTag:void 0;function o(a){var l=r.call(a,s),c=a[s];try{a[s]=void 0;var d=!0}catch{}var u=n.call(a);return d&&(l?a[s]=c:delete a[s]),u}return Od=o,Od}var Md,x1;function iD(){if(x1)return Md;x1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Md=r,Md}var Dd,g1;function Rs(){if(g1)return Dd;g1=1;var e=Lo(),t=oD(),r=iD(),n="[object Null]",s="[object Undefined]",o=e?e.toStringTag:void 0;function a(l){return l==null?l===void 0?s:n:o&&o in Object(l)?t(l):r(l)}return Dd=a,Dd}var Ld,v1;function br(){if(v1)return Ld;v1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Ld=e,Ld}var zd,y1;function Sa(){if(y1)return zd;y1=1;var e=Rs(),t=br(),r="[object AsyncFunction]",n="[object Function]",s="[object GeneratorFunction]",o="[object Proxy]";function a(l){if(!t(l))return!1;var c=e(l);return c==n||c==s||c==r||c==o}return zd=a,zd}var Fd,b1;function aD(){if(b1)return Fd;b1=1;var e=Mr(),t=e["__core-js_shared__"];return Fd=t,Fd}var $d,_1;function lD(){if(_1)return $d;_1=1;var e=aD(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return $d=r,$d}var qd,w1;function FE(){if(w1)return qd;w1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return qd=r,qd}var Bd,j1;function cD(){if(j1)return Bd;j1=1;var e=Sa(),t=lD(),r=br(),n=FE(),s=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,a=Function.prototype,l=Object.prototype,c=a.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?u:o;return h.test(n(p))}return Bd=f,Bd}var Wd,S1;function uD(){if(S1)return Wd;S1=1;function e(t,r){return t==null?void 0:t[r]}return Wd=e,Wd}var Hd,k1;function As(){if(k1)return Hd;k1=1;var e=cD(),t=uD();function r(n,s){var o=t(n,s);return e(o)?o:void 0}return Hd=r,Hd}var Ud,N1;function my(){if(N1)return Ud;N1=1;var e=As(),t=Mr(),r=e(t,"Map");return Ud=r,Ud}var Vd,C1;function cu(){if(C1)return Vd;C1=1;var e=As(),t=e(Object,"create");return Vd=t,Vd}var Gd,E1;function dD(){if(E1)return Gd;E1=1;var e=cu();function t(){this.__data__=e?e(null):{},this.size=0}return Gd=t,Gd}var Kd,T1;function fD(){if(T1)return Kd;T1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Kd=e,Kd}var Yd,R1;function pD(){if(R1)return Yd;R1=1;var e=cu(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function s(o){var a=this.__data__;if(e){var l=a[o];return l===t?void 0:l}return n.call(a,o)?a[o]:void 0}return Yd=s,Yd}var Xd,A1;function hD(){if(A1)return Xd;A1=1;var e=cu(),t=Object.prototype,r=t.hasOwnProperty;function n(s){var o=this.__data__;return e?o[s]!==void 0:r.call(o,s)}return Xd=n,Xd}var Qd,I1;function mD(){if(I1)return Qd;I1=1;var e=cu(),t="__lodash_hash_undefined__";function r(n,s){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=e&&s===void 0?t:s,this}return Qd=r,Qd}var Zd,P1;function xD(){if(P1)return Zd;P1=1;var e=dD(),t=fD(),r=pD(),n=hD(),s=mD();function o(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,Zd=o,Zd}var Jd,O1;function gD(){if(O1)return Jd;O1=1;var e=xD(),t=lu(),r=my();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Jd=n,Jd}var ef,M1;function vD(){if(M1)return ef;M1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return ef=e,ef}var tf,D1;function uu(){if(D1)return tf;D1=1;var e=vD();function t(r,n){var s=r.__data__;return e(n)?s[typeof n=="string"?"string":"hash"]:s.map}return tf=t,tf}var rf,L1;function yD(){if(L1)return rf;L1=1;var e=uu();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return rf=t,rf}var nf,z1;function bD(){if(z1)return nf;z1=1;var e=uu();function t(r){return e(this,r).get(r)}return nf=t,nf}var sf,F1;function _D(){if(F1)return sf;F1=1;var e=uu();function t(r){return e(this,r).has(r)}return sf=t,sf}var of,$1;function wD(){if($1)return of;$1=1;var e=uu();function t(r,n){var s=e(this,r),o=s.size;return s.set(r,n),this.size+=s.size==o?0:1,this}return of=t,of}var af,q1;function xy(){if(q1)return af;q1=1;var e=gD(),t=yD(),r=bD(),n=_D(),s=wD();function o(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,af=o,af}var lf,B1;function jD(){if(B1)return lf;B1=1;var e=lu(),t=my(),r=xy(),n=200;function s(o,a){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([o,a]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(o,a),this.size=l.size,this}return lf=s,lf}var cf,W1;function du(){if(W1)return cf;W1=1;var e=lu(),t=tD(),r=rD(),n=nD(),s=sD(),o=jD();function a(l){var c=this.__data__=new e(l);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=r,a.prototype.get=n,a.prototype.has=s,a.prototype.set=o,cf=a,cf}var uf,H1;function gy(){if(H1)return uf;H1=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s&&r(t[n],n,t)!==!1;);return t}return uf=e,uf}var df,U1;function $E(){if(U1)return df;U1=1;var e=As(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return df=t,df}var ff,V1;function fu(){if(V1)return ff;V1=1;var e=$E();function t(r,n,s){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:s,writable:!0}):r[n]=s}return ff=t,ff}var pf,G1;function pu(){if(G1)return pf;G1=1;var e=fu(),t=Do(),r=Object.prototype,n=r.hasOwnProperty;function s(o,a,l){var c=o[a];(!(n.call(o,a)&&t(c,l))||l===void 0&&!(a in o))&&e(o,a,l)}return pf=s,pf}var hf,K1;function ka(){if(K1)return hf;K1=1;var e=pu(),t=fu();function r(n,s,o,a){var l=!o;o||(o={});for(var c=-1,d=s.length;++c<d;){var u=s[c],f=a?a(o[u],n[u],u,o,n):void 0;f===void 0&&(f=n[u]),l?t(o,u,f):e(o,u,f)}return o}return hf=r,hf}var mf,Y1;function SD(){if(Y1)return mf;Y1=1;function e(t,r){for(var n=-1,s=Array(t);++n<t;)s[n]=r(n);return s}return mf=e,mf}var xf,X1;function Xr(){if(X1)return xf;X1=1;function e(t){return t!=null&&typeof t=="object"}return xf=e,xf}var gf,Q1;function kD(){if(Q1)return gf;Q1=1;var e=Rs(),t=Xr(),r="[object Arguments]";function n(s){return t(s)&&e(s)==r}return gf=n,gf}var vf,Z1;function Na(){if(Z1)return vf;Z1=1;var e=kD(),t=Xr(),r=Object.prototype,n=r.hasOwnProperty,s=r.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(a){return t(a)&&n.call(a,"callee")&&!s.call(a,"callee")};return vf=o,vf}var yf,J1;function ft(){if(J1)return yf;J1=1;var e=Array.isArray;return yf=e,yf}var gi={exports:{}},bf,e_;function ND(){if(e_)return bf;e_=1;function e(){return!1}return bf=e,bf}gi.exports;var t_;function zo(){return t_||(t_=1,function(e,t){var r=Mr(),n=ND(),s=t&&!t.nodeType&&t,o=s&&!0&&e&&!e.nodeType&&e,a=o&&o.exports===s,l=a?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d}(gi,gi.exports)),gi.exports}var _f,r_;function hu(){if(r_)return _f;r_=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,s){var o=typeof n;return s=s??e,!!s&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<s}return _f=r,_f}var wf,n_;function vy(){if(n_)return wf;n_=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return wf=t,wf}var jf,s_;function CD(){if(s_)return jf;s_=1;var e=Rs(),t=vy(),r=Xr(),n="[object Arguments]",s="[object Array]",o="[object Boolean]",a="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",g="[object String]",x="[object WeakMap]",_="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",j="[object Int8Array]",N="[object Int16Array]",T="[object Int32Array]",C="[object Uint8Array]",S="[object Uint8ClampedArray]",w="[object Uint16Array]",A="[object Uint32Array]",E={};E[y]=E[b]=E[j]=E[N]=E[T]=E[C]=E[S]=E[w]=E[A]=!0,E[n]=E[s]=E[_]=E[o]=E[v]=E[a]=E[l]=E[c]=E[d]=E[u]=E[f]=E[p]=E[h]=E[g]=E[x]=!1;function O(z){return r(z)&&t(z.length)&&!!E[e(z)]}return jf=O,jf}var Sf,o_;function mu(){if(o_)return Sf;o_=1;function e(t){return function(r){return t(r)}}return Sf=e,Sf}var vi={exports:{}};vi.exports;var i_;function yy(){return i_||(i_=1,function(e,t){var r=zE(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,a=o&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=l}(vi,vi.exports)),vi.exports}var kf,a_;function Ca(){if(a_)return kf;a_=1;var e=CD(),t=mu(),r=yy(),n=r&&r.isTypedArray,s=n?t(n):e;return kf=s,kf}var Nf,l_;function qE(){if(l_)return Nf;l_=1;var e=SD(),t=Na(),r=ft(),n=zo(),s=hu(),o=Ca(),a=Object.prototype,l=a.hasOwnProperty;function c(d,u){var f=r(d),p=!f&&t(d),h=!f&&!p&&n(d),g=!f&&!p&&!h&&o(d),x=f||p||h||g,_=x?e(d.length,String):[],v=_.length;for(var y in d)(u||l.call(d,y))&&!(x&&(y=="length"||h&&(y=="offset"||y=="parent")||g&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||s(y,v)))&&_.push(y);return _}return Nf=c,Nf}var Cf,c_;function xu(){if(c_)return Cf;c_=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,s=typeof n=="function"&&n.prototype||e;return r===s}return Cf=t,Cf}var Ef,u_;function BE(){if(u_)return Ef;u_=1;function e(t,r){return function(n){return t(r(n))}}return Ef=e,Ef}var Tf,d_;function ED(){if(d_)return Tf;d_=1;var e=BE(),t=e(Object.keys,Object);return Tf=t,Tf}var Rf,f_;function by(){if(f_)return Rf;f_=1;var e=xu(),t=ED(),r=Object.prototype,n=r.hasOwnProperty;function s(o){if(!e(o))return t(o);var a=[];for(var l in Object(o))n.call(o,l)&&l!="constructor"&&a.push(l);return a}return Rf=s,Rf}var Af,p_;function bn(){if(p_)return Af;p_=1;var e=Sa(),t=vy();function r(n){return n!=null&&t(n.length)&&!e(n)}return Af=r,Af}var If,h_;function rs(){if(h_)return If;h_=1;var e=qE(),t=by(),r=bn();function n(s){return r(s)?e(s):t(s)}return If=n,If}var Pf,m_;function TD(){if(m_)return Pf;m_=1;var e=ka(),t=rs();function r(n,s){return n&&e(s,t(s),n)}return Pf=r,Pf}var Of,x_;function RD(){if(x_)return Of;x_=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return Of=e,Of}var Mf,g_;function AD(){if(g_)return Mf;g_=1;var e=br(),t=xu(),r=RD(),n=Object.prototype,s=n.hasOwnProperty;function o(a){if(!e(a))return r(a);var l=t(a),c=[];for(var d in a)d=="constructor"&&(l||!s.call(a,d))||c.push(d);return c}return Mf=o,Mf}var Df,v_;function Is(){if(v_)return Df;v_=1;var e=qE(),t=AD(),r=bn();function n(s){return r(s)?e(s,!0):t(s)}return Df=n,Df}var Lf,y_;function ID(){if(y_)return Lf;y_=1;var e=ka(),t=Is();function r(n,s){return n&&e(s,t(s),n)}return Lf=r,Lf}var yi={exports:{}};yi.exports;var b_;function WE(){return b_||(b_=1,function(e,t){var r=Mr(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,a=o?r.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(yi,yi.exports)),yi.exports}var zf,__;function HE(){if(__)return zf;__=1;function e(t,r){var n=-1,s=t.length;for(r||(r=Array(s));++n<s;)r[n]=t[n];return r}return zf=e,zf}var Ff,w_;function UE(){if(w_)return Ff;w_=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=0,a=[];++n<s;){var l=t[n];r(l,n,t)&&(a[o++]=l)}return a}return Ff=e,Ff}var $f,j_;function VE(){if(j_)return $f;j_=1;function e(){return[]}return $f=e,$f}var qf,S_;function _y(){if(S_)return qf;S_=1;var e=UE(),t=VE(),r=Object.prototype,n=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,o=s?function(a){return a==null?[]:(a=Object(a),e(s(a),function(l){return n.call(a,l)}))}:t;return qf=o,qf}var Bf,k_;function PD(){if(k_)return Bf;k_=1;var e=ka(),t=_y();function r(n,s){return e(n,t(n),s)}return Bf=r,Bf}var Wf,N_;function wy(){if(N_)return Wf;N_=1;function e(t,r){for(var n=-1,s=r.length,o=t.length;++n<s;)t[o+n]=r[n];return t}return Wf=e,Wf}var Hf,C_;function gu(){if(C_)return Hf;C_=1;var e=BE(),t=e(Object.getPrototypeOf,Object);return Hf=t,Hf}var Uf,E_;function GE(){if(E_)return Uf;E_=1;var e=wy(),t=gu(),r=_y(),n=VE(),s=Object.getOwnPropertySymbols,o=s?function(a){for(var l=[];a;)e(l,r(a)),a=t(a);return l}:n;return Uf=o,Uf}var Vf,T_;function OD(){if(T_)return Vf;T_=1;var e=ka(),t=GE();function r(n,s){return e(n,t(n),s)}return Vf=r,Vf}var Gf,R_;function KE(){if(R_)return Gf;R_=1;var e=wy(),t=ft();function r(n,s,o){var a=s(n);return t(n)?a:e(a,o(n))}return Gf=r,Gf}var Kf,A_;function YE(){if(A_)return Kf;A_=1;var e=KE(),t=_y(),r=rs();function n(s){return e(s,r,t)}return Kf=n,Kf}var Yf,I_;function MD(){if(I_)return Yf;I_=1;var e=KE(),t=GE(),r=Is();function n(s){return e(s,r,t)}return Yf=n,Yf}var Xf,P_;function DD(){if(P_)return Xf;P_=1;var e=As(),t=Mr(),r=e(t,"DataView");return Xf=r,Xf}var Qf,O_;function LD(){if(O_)return Qf;O_=1;var e=As(),t=Mr(),r=e(t,"Promise");return Qf=r,Qf}var Zf,M_;function XE(){if(M_)return Zf;M_=1;var e=As(),t=Mr(),r=e(t,"Set");return Zf=r,Zf}var Jf,D_;function zD(){if(D_)return Jf;D_=1;var e=As(),t=Mr(),r=e(t,"WeakMap");return Jf=r,Jf}var ep,L_;function Fo(){if(L_)return ep;L_=1;var e=DD(),t=my(),r=LD(),n=XE(),s=zD(),o=Rs(),a=FE(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=a(e),g=a(t),x=a(r),_=a(n),v=a(s),y=o;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||r&&y(r.resolve())!=d||n&&y(new n)!=u||s&&y(new s)!=f)&&(y=function(b){var j=o(b),N=j==c?b.constructor:void 0,T=N?a(N):"";if(T)switch(T){case h:return p;case g:return l;case x:return d;case _:return u;case v:return f}return j}),ep=y,ep}var tp,z_;function FD(){if(z_)return tp;z_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var s=n.length,o=new n.constructor(s);return s&&typeof n[0]=="string"&&t.call(n,"index")&&(o.index=n.index,o.input=n.input),o}return tp=r,tp}var rp,F_;function QE(){if(F_)return rp;F_=1;var e=Mr(),t=e.Uint8Array;return rp=t,rp}var np,$_;function jy(){if($_)return np;$_=1;var e=QE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return np=t,np}var sp,q_;function $D(){if(q_)return sp;q_=1;var e=jy();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.byteLength)}return sp=t,sp}var op,B_;function qD(){if(B_)return op;B_=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return op=t,op}var ip,W_;function BD(){if(W_)return ip;W_=1;var e=Lo(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(s){return r?Object(r.call(s)):{}}return ip=n,ip}var ap,H_;function ZE(){if(H_)return ap;H_=1;var e=jy();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.length)}return ap=t,ap}var lp,U_;function WD(){if(U_)return lp;U_=1;var e=jy(),t=$D(),r=qD(),n=BD(),s=ZE(),o="[object Boolean]",a="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",g="[object DataView]",x="[object Float32Array]",_="[object Float64Array]",v="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",j="[object Uint8Array]",N="[object Uint8ClampedArray]",T="[object Uint16Array]",C="[object Uint32Array]";function S(w,A,E){var O=w.constructor;switch(A){case h:return e(w);case o:case a:return new O(+w);case g:return t(w,E);case x:case _:case v:case y:case b:case j:case N:case T:case C:return s(w,E);case l:return new O;case c:case f:return new O(w);case d:return r(w);case u:return new O;case p:return n(w)}}return lp=S,lp}var cp,V_;function JE(){if(V_)return cp;V_=1;var e=br(),t=Object.create,r=function(){function n(){}return function(s){if(!e(s))return{};if(t)return t(s);n.prototype=s;var o=new n;return n.prototype=void 0,o}}();return cp=r,cp}var up,G_;function e4(){if(G_)return up;G_=1;var e=JE(),t=gu(),r=xu();function n(s){return typeof s.constructor=="function"&&!r(s)?e(t(s)):{}}return up=n,up}var dp,K_;function HD(){if(K_)return dp;K_=1;var e=Fo(),t=Xr(),r="[object Map]";function n(s){return t(s)&&e(s)==r}return dp=n,dp}var fp,Y_;function UD(){if(Y_)return fp;Y_=1;var e=HD(),t=mu(),r=yy(),n=r&&r.isMap,s=n?t(n):e;return fp=s,fp}var pp,X_;function VD(){if(X_)return pp;X_=1;var e=Fo(),t=Xr(),r="[object Set]";function n(s){return t(s)&&e(s)==r}return pp=n,pp}var hp,Q_;function GD(){if(Q_)return hp;Q_=1;var e=VD(),t=mu(),r=yy(),n=r&&r.isSet,s=n?t(n):e;return hp=s,hp}var mp,Z_;function t4(){if(Z_)return mp;Z_=1;var e=du(),t=gy(),r=pu(),n=TD(),s=ID(),o=WE(),a=HE(),l=PD(),c=OD(),d=YE(),u=MD(),f=Fo(),p=FD(),h=WD(),g=e4(),x=ft(),_=zo(),v=UD(),y=br(),b=GD(),j=rs(),N=Is(),T=1,C=2,S=4,w="[object Arguments]",A="[object Array]",E="[object Boolean]",O="[object Date]",z="[object Error]",k="[object Function]",P="[object GeneratorFunction]",R="[object Map]",D="[object Number]",L="[object Object]",I="[object RegExp]",M="[object Set]",F="[object String]",q="[object Symbol]",H="[object WeakMap]",V="[object ArrayBuffer]",Z="[object DataView]",B="[object Float32Array]",re="[object Float64Array]",oe="[object Int8Array]",X="[object Int16Array]",Q="[object Int32Array]",fe="[object Uint8Array]",xe="[object Uint8ClampedArray]",be="[object Uint16Array]",ye="[object Uint32Array]",ae={};ae[w]=ae[A]=ae[V]=ae[Z]=ae[E]=ae[O]=ae[B]=ae[re]=ae[oe]=ae[X]=ae[Q]=ae[R]=ae[D]=ae[L]=ae[I]=ae[M]=ae[F]=ae[q]=ae[fe]=ae[xe]=ae[be]=ae[ye]=!0,ae[z]=ae[k]=ae[H]=!1;function K(te,ee,ke,je,Te,Ne){var ne,Se=ee&T,Ve=ee&C,ct=ee&S;if(ke&&(ne=Te?ke(te,je,Te,Ne):ke(te)),ne!==void 0)return ne;if(!y(te))return te;var We=x(te);if(We){if(ne=p(te),!Se)return a(te,ne)}else{var Pe=f(te),ie=Pe==k||Pe==P;if(_(te))return o(te,Se);if(Pe==L||Pe==w||ie&&!Te){if(ne=Ve||ie?{}:g(te),!Se)return Ve?c(te,s(ne,te)):l(te,n(ne,te))}else{if(!ae[Pe])return Te?te:{};ne=h(te,Pe,Se)}}Ne||(Ne=new e);var ge=Ne.get(te);if(ge)return ge;Ne.set(te,ne),b(te)?te.forEach(function(ve){ne.add(K(ve,ee,ke,ve,te,Ne))}):v(te)&&te.forEach(function(ve,he){ne.set(he,K(ve,ee,ke,he,te,Ne))});var pe=ct?Ve?u:d:Ve?N:j,U=We?void 0:pe(te);return t(U||te,function(ve,he){U&&(he=ve,ve=te[he]),r(ne,he,K(ve,ee,ke,he,te,Ne))}),ne}return mp=K,mp}var xp,J_;function KD(){if(J_)return xp;J_=1;var e=t4(),t=4;function r(n){return e(n,t)}return xp=r,xp}var gp,ew;function Sy(){if(ew)return gp;ew=1;function e(t){return function(){return t}}return gp=e,gp}var vp,tw;function YD(){if(tw)return vp;tw=1;function e(t){return function(r,n,s){for(var o=-1,a=Object(r),l=s(r),c=l.length;c--;){var d=l[t?c:++o];if(n(a[d],d,a)===!1)break}return r}}return vp=e,vp}var yp,rw;function ky(){if(rw)return yp;rw=1;var e=YD(),t=e();return yp=t,yp}var bp,nw;function Ny(){if(nw)return bp;nw=1;var e=ky(),t=rs();function r(n,s){return n&&e(n,s,t)}return bp=r,bp}var _p,sw;function XD(){if(sw)return _p;sw=1;var e=bn();function t(r,n){return function(s,o){if(s==null)return s;if(!e(s))return r(s,o);for(var a=s.length,l=n?a:-1,c=Object(s);(n?l--:++l<a)&&o(c[l],l,c)!==!1;);return s}}return _p=t,_p}var wp,ow;function vu(){if(ow)return wp;ow=1;var e=Ny(),t=XD(),r=t(e);return wp=r,wp}var jp,iw;function Ps(){if(iw)return jp;iw=1;function e(t){return t}return jp=e,jp}var Sp,aw;function r4(){if(aw)return Sp;aw=1;var e=Ps();function t(r){return typeof r=="function"?r:e}return Sp=t,Sp}var kp,lw;function n4(){if(lw)return kp;lw=1;var e=gy(),t=vu(),r=r4(),n=ft();function s(o,a){var l=n(o)?e:t;return l(o,r(a))}return kp=s,kp}var Np,cw;function s4(){return cw||(cw=1,Np=n4()),Np}var Cp,uw;function QD(){if(uw)return Cp;uw=1;var e=vu();function t(r,n){var s=[];return e(r,function(o,a,l){n(o,a,l)&&s.push(o)}),s}return Cp=t,Cp}var Ep,dw;function ZD(){if(dw)return Ep;dw=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Ep=t,Ep}var Tp,fw;function JD(){if(fw)return Tp;fw=1;function e(t){return this.__data__.has(t)}return Tp=e,Tp}var Rp,pw;function o4(){if(pw)return Rp;pw=1;var e=xy(),t=ZD(),r=JD();function n(s){var o=-1,a=s==null?0:s.length;for(this.__data__=new e;++o<a;)this.add(s[o])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,Rp=n,Rp}var Ap,hw;function eL(){if(hw)return Ap;hw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s;)if(r(t[n],n,t))return!0;return!1}return Ap=e,Ap}var Ip,mw;function i4(){if(mw)return Ip;mw=1;function e(t,r){return t.has(r)}return Ip=e,Ip}var Pp,xw;function a4(){if(xw)return Pp;xw=1;var e=o4(),t=eL(),r=i4(),n=1,s=2;function o(a,l,c,d,u,f){var p=c&n,h=a.length,g=l.length;if(h!=g&&!(p&&g>h))return!1;var x=f.get(a),_=f.get(l);if(x&&_)return x==l&&_==a;var v=-1,y=!0,b=c&s?new e:void 0;for(f.set(a,l),f.set(l,a);++v<h;){var j=a[v],N=l[v];if(d)var T=p?d(N,j,v,l,a,f):d(j,N,v,a,l,f);if(T!==void 0){if(T)continue;y=!1;break}if(b){if(!t(l,function(C,S){if(!r(b,S)&&(j===C||u(j,C,c,d,f)))return b.push(S)})){y=!1;break}}else if(!(j===N||u(j,N,c,d,f))){y=!1;break}}return f.delete(a),f.delete(l),y}return Pp=o,Pp}var Op,gw;function tL(){if(gw)return Op;gw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s,o){n[++r]=[o,s]}),n}return Op=e,Op}var Mp,vw;function Cy(){if(vw)return Mp;vw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s){n[++r]=s}),n}return Mp=e,Mp}var Dp,yw;function rL(){if(yw)return Dp;yw=1;var e=Lo(),t=QE(),r=Do(),n=a4(),s=tL(),o=Cy(),a=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",g="[object Set]",x="[object String]",_="[object Symbol]",v="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,j=b?b.valueOf:void 0;function N(T,C,S,w,A,E,O){switch(S){case y:if(T.byteLength!=C.byteLength||T.byteOffset!=C.byteOffset)return!1;T=T.buffer,C=C.buffer;case v:return!(T.byteLength!=C.byteLength||!E(new t(T),new t(C)));case c:case d:case p:return r(+T,+C);case u:return T.name==C.name&&T.message==C.message;case h:case x:return T==C+"";case f:var z=s;case g:var k=w&a;if(z||(z=o),T.size!=C.size&&!k)return!1;var P=O.get(T);if(P)return P==C;w|=l,O.set(T,C);var R=n(z(T),z(C),w,A,E,O);return O.delete(T),R;case _:if(j)return j.call(T)==j.call(C)}return!1}return Dp=N,Dp}var Lp,bw;function nL(){if(bw)return Lp;bw=1;var e=YE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function s(o,a,l,c,d,u){var f=l&t,p=e(o),h=p.length,g=e(a),x=g.length;if(h!=x&&!f)return!1;for(var _=h;_--;){var v=p[_];if(!(f?v in a:n.call(a,v)))return!1}var y=u.get(o),b=u.get(a);if(y&&b)return y==a&&b==o;var j=!0;u.set(o,a),u.set(a,o);for(var N=f;++_<h;){v=p[_];var T=o[v],C=a[v];if(c)var S=f?c(C,T,v,a,o,u):c(T,C,v,o,a,u);if(!(S===void 0?T===C||d(T,C,l,c,u):S)){j=!1;break}N||(N=v=="constructor")}if(j&&!N){var w=o.constructor,A=a.constructor;w!=A&&"constructor"in o&&"constructor"in a&&!(typeof w=="function"&&w instanceof w&&typeof A=="function"&&A instanceof A)&&(j=!1)}return u.delete(o),u.delete(a),j}return Lp=s,Lp}var zp,_w;function sL(){if(_w)return zp;_w=1;var e=du(),t=a4(),r=rL(),n=nL(),s=Fo(),o=ft(),a=zo(),l=Ca(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function g(x,_,v,y,b,j){var N=o(x),T=o(_),C=N?u:s(x),S=T?u:s(_);C=C==d?f:C,S=S==d?f:S;var w=C==f,A=S==f,E=C==S;if(E&&a(x)){if(!a(_))return!1;N=!0,w=!1}if(E&&!w)return j||(j=new e),N||l(x)?t(x,_,v,y,b,j):r(x,_,C,v,y,b,j);if(!(v&c)){var O=w&&h.call(x,"__wrapped__"),z=A&&h.call(_,"__wrapped__");if(O||z){var k=O?x.value():x,P=z?_.value():_;return j||(j=new e),b(k,P,v,y,j)}}return E?(j||(j=new e),n(x,_,v,y,b,j)):!1}return zp=g,zp}var Fp,ww;function l4(){if(ww)return Fp;ww=1;var e=sL(),t=Xr();function r(n,s,o,a,l){return n===s?!0:n==null||s==null||!t(n)&&!t(s)?n!==n&&s!==s:e(n,s,o,a,r,l)}return Fp=r,Fp}var $p,jw;function oL(){if(jw)return $p;jw=1;var e=du(),t=l4(),r=1,n=2;function s(o,a,l,c){var d=l.length,u=d,f=!c;if(o==null)return!u;for(o=Object(o);d--;){var p=l[d];if(f&&p[2]?p[1]!==o[p[0]]:!(p[0]in o))return!1}for(;++d<u;){p=l[d];var h=p[0],g=o[h],x=p[1];if(f&&p[2]){if(g===void 0&&!(h in o))return!1}else{var _=new e;if(c)var v=c(g,x,h,o,a,_);if(!(v===void 0?t(x,g,r|n,c,_):v))return!1}}return!0}return $p=s,$p}var qp,Sw;function c4(){if(Sw)return qp;Sw=1;var e=br();function t(r){return r===r&&!e(r)}return qp=t,qp}var Bp,kw;function iL(){if(kw)return Bp;kw=1;var e=c4(),t=rs();function r(n){for(var s=t(n),o=s.length;o--;){var a=s[o],l=n[a];s[o]=[a,l,e(l)]}return s}return Bp=r,Bp}var Wp,Nw;function u4(){if(Nw)return Wp;Nw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Wp=e,Wp}var Hp,Cw;function aL(){if(Cw)return Hp;Cw=1;var e=oL(),t=iL(),r=u4();function n(s){var o=t(s);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(a){return a===s||e(a,s,o)}}return Hp=n,Hp}var Up,Ew;function $o(){if(Ew)return Up;Ew=1;var e=Rs(),t=Xr(),r="[object Symbol]";function n(s){return typeof s=="symbol"||t(s)&&e(s)==r}return Up=n,Up}var Vp,Tw;function Ey(){if(Tw)return Vp;Tw=1;var e=ft(),t=$o(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(o,a){if(e(o))return!1;var l=typeof o;return l=="number"||l=="symbol"||l=="boolean"||o==null||t(o)?!0:n.test(o)||!r.test(o)||a!=null&&o in Object(a)}return Vp=s,Vp}var Gp,Rw;function lL(){if(Rw)return Gp;Rw=1;var e=xy(),t="Expected a function";function r(n,s){if(typeof n!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var o=function(){var a=arguments,l=s?s.apply(this,a):a[0],c=o.cache;if(c.has(l))return c.get(l);var d=n.apply(this,a);return o.cache=c.set(l,d)||c,d};return o.cache=new(r.Cache||e),o}return r.Cache=e,Gp=r,Gp}var Kp,Aw;function cL(){if(Aw)return Kp;Aw=1;var e=lL(),t=500;function r(n){var s=e(n,function(a){return o.size===t&&o.clear(),a}),o=s.cache;return s}return Kp=r,Kp}var Yp,Iw;function uL(){if(Iw)return Yp;Iw=1;var e=cL(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(s){var o=[];return s.charCodeAt(0)===46&&o.push(""),s.replace(t,function(a,l,c,d){o.push(c?d.replace(r,"$1"):l||a)}),o});return Yp=n,Yp}var Xp,Pw;function yu(){if(Pw)return Xp;Pw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=Array(s);++n<s;)o[n]=r(t[n],n,t);return o}return Xp=e,Xp}var Qp,Ow;function dL(){if(Ow)return Qp;Ow=1;var e=Lo(),t=yu(),r=ft(),n=$o(),s=e?e.prototype:void 0,o=s?s.toString:void 0;function a(l){if(typeof l=="string")return l;if(r(l))return t(l,a)+"";if(n(l))return o?o.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Qp=a,Qp}var Zp,Mw;function d4(){if(Mw)return Zp;Mw=1;var e=dL();function t(r){return r==null?"":e(r)}return Zp=t,Zp}var Jp,Dw;function bu(){if(Dw)return Jp;Dw=1;var e=ft(),t=Ey(),r=uL(),n=d4();function s(o,a){return e(o)?o:t(o,a)?[o]:r(n(o))}return Jp=s,Jp}var eh,Lw;function Ea(){if(Lw)return eh;Lw=1;var e=$o();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return eh=t,eh}var th,zw;function _u(){if(zw)return th;zw=1;var e=bu(),t=Ea();function r(n,s){s=e(s,n);for(var o=0,a=s.length;n!=null&&o<a;)n=n[t(s[o++])];return o&&o==a?n:void 0}return th=r,th}var rh,Fw;function fL(){if(Fw)return rh;Fw=1;var e=_u();function t(r,n,s){var o=r==null?void 0:e(r,n);return o===void 0?s:o}return rh=t,rh}var nh,$w;function pL(){if($w)return nh;$w=1;function e(t,r){return t!=null&&r in Object(t)}return nh=e,nh}var sh,qw;function f4(){if(qw)return sh;qw=1;var e=bu(),t=Na(),r=ft(),n=hu(),s=vy(),o=Ea();function a(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=o(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&s(f)&&n(h,f)&&(r(l)||t(l)))}return sh=a,sh}var oh,Bw;function p4(){if(Bw)return oh;Bw=1;var e=pL(),t=f4();function r(n,s){return n!=null&&t(n,s,e)}return oh=r,oh}var ih,Ww;function hL(){if(Ww)return ih;Ww=1;var e=l4(),t=fL(),r=p4(),n=Ey(),s=c4(),o=u4(),a=Ea(),l=1,c=2;function d(u,f){return n(u)&&s(f)?o(a(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?r(p,u):e(f,h,l|c)}}return ih=d,ih}var ah,Hw;function h4(){if(Hw)return ah;Hw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return ah=e,ah}var lh,Uw;function mL(){if(Uw)return lh;Uw=1;var e=_u();function t(r){return function(n){return e(n,r)}}return lh=t,lh}var ch,Vw;function xL(){if(Vw)return ch;Vw=1;var e=h4(),t=mL(),r=Ey(),n=Ea();function s(o){return r(o)?e(n(o)):t(o)}return ch=s,ch}var uh,Gw;function _n(){if(Gw)return uh;Gw=1;var e=aL(),t=hL(),r=Ps(),n=ft(),s=xL();function o(a){return typeof a=="function"?a:a==null?r:typeof a=="object"?n(a)?t(a[0],a[1]):e(a):s(a)}return uh=o,uh}var dh,Kw;function m4(){if(Kw)return dh;Kw=1;var e=UE(),t=QD(),r=_n(),n=ft();function s(o,a){var l=n(o)?e:t;return l(o,r(a,3))}return dh=s,dh}var fh,Yw;function gL(){if(Yw)return fh;Yw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,s){return n!=null&&t.call(n,s)}return fh=r,fh}var ph,Xw;function x4(){if(Xw)return ph;Xw=1;var e=gL(),t=f4();function r(n,s){return n!=null&&t(n,s,e)}return ph=r,ph}var hh,Qw;function vL(){if(Qw)return hh;Qw=1;var e=by(),t=Fo(),r=Na(),n=ft(),s=bn(),o=zo(),a=xu(),l=Ca(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(s(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||l(h)||r(h)))return!h.length;var g=t(h);if(g==c||g==d)return!h.size;if(a(h))return!e(h).length;for(var x in h)if(f.call(h,x))return!1;return!0}return hh=p,hh}var mh,Zw;function g4(){if(Zw)return mh;Zw=1;function e(t){return t===void 0}return mh=e,mh}var xh,Jw;function v4(){if(Jw)return xh;Jw=1;var e=vu(),t=bn();function r(n,s){var o=-1,a=t(n)?Array(n.length):[];return e(n,function(l,c,d){a[++o]=s(l,c,d)}),a}return xh=r,xh}var gh,ej;function y4(){if(ej)return gh;ej=1;var e=yu(),t=_n(),r=v4(),n=ft();function s(o,a){var l=n(o)?e:r;return l(o,t(a,3))}return gh=s,gh}var vh,tj;function yL(){if(tj)return vh;tj=1;function e(t,r,n,s){var o=-1,a=t==null?0:t.length;for(s&&a&&(n=t[++o]);++o<a;)n=r(n,t[o],o,t);return n}return vh=e,vh}var yh,rj;function bL(){if(rj)return yh;rj=1;function e(t,r,n,s,o){return o(t,function(a,l,c){n=s?(s=!1,a):r(n,a,l,c)}),n}return yh=e,yh}var bh,nj;function b4(){if(nj)return bh;nj=1;var e=yL(),t=vu(),r=_n(),n=bL(),s=ft();function o(a,l,c){var d=s(a)?e:n,u=arguments.length<3;return d(a,r(l,4),c,u,t)}return bh=o,bh}var _h,sj;function _L(){if(sj)return _h;sj=1;var e=Rs(),t=ft(),r=Xr(),n="[object String]";function s(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==n}return _h=s,_h}var wh,oj;function wL(){if(oj)return wh;oj=1;var e=h4(),t=e("length");return wh=t,wh}var jh,ij;function jL(){if(ij)return jh;ij=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",a="\\u200d",l=RegExp("["+a+e+s+o+"]");function c(d){return l.test(d)}return jh=c,jh}var Sh,aj;function SL(){if(aj)return Sh;aj=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",a="["+e+"]",l="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",g=d+"?",x="["+o+"]?",_="(?:"+h+"(?:"+[u,f,p].join("|")+")"+x+g+")*",v=x+g+_,y="(?:"+[u+l+"?",l,f,p,a].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+v,"g");function j(N){for(var T=b.lastIndex=0;b.test(N);)++T;return T}return Sh=j,Sh}var kh,lj;function kL(){if(lj)return kh;lj=1;var e=wL(),t=jL(),r=SL();function n(s){return t(s)?r(s):e(s)}return kh=n,kh}var Nh,cj;function NL(){if(cj)return Nh;cj=1;var e=by(),t=Fo(),r=bn(),n=_L(),s=kL(),o="[object Map]",a="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?s(c):c.length;var d=t(c);return d==o||d==a?c.size:e(c).length}return Nh=l,Nh}var Ch,uj;function CL(){if(uj)return Ch;uj=1;var e=gy(),t=JE(),r=Ny(),n=_n(),s=gu(),o=ft(),a=zo(),l=Sa(),c=br(),d=Ca();function u(f,p,h){var g=o(f),x=g||a(f)||d(f);if(p=n(p,4),h==null){var _=f&&f.constructor;x?h=g?new _:[]:c(f)?h=l(_)?t(s(f)):{}:h={}}return(x?e:r)(f,function(v,y,b){return p(h,v,y,b)}),h}return Ch=u,Ch}var Eh,dj;function EL(){if(dj)return Eh;dj=1;var e=Lo(),t=Na(),r=ft(),n=e?e.isConcatSpreadable:void 0;function s(o){return r(o)||t(o)||!!(n&&o&&o[n])}return Eh=s,Eh}var Th,fj;function Ty(){if(fj)return Th;fj=1;var e=wy(),t=EL();function r(n,s,o,a,l){var c=-1,d=n.length;for(o||(o=t),l||(l=[]);++c<d;){var u=n[c];s>0&&o(u)?s>1?r(u,s-1,o,a,l):e(l,u):a||(l[l.length]=u)}return l}return Th=r,Th}var Rh,pj;function TL(){if(pj)return Rh;pj=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Rh=e,Rh}var Ah,hj;function _4(){if(hj)return Ah;hj=1;var e=TL(),t=Math.max;function r(n,s,o){return s=t(s===void 0?n.length-1:s,0),function(){for(var a=arguments,l=-1,c=t(a.length-s,0),d=Array(c);++l<c;)d[l]=a[s+l];l=-1;for(var u=Array(s+1);++l<s;)u[l]=a[l];return u[s]=o(d),e(n,this,u)}}return Ah=r,Ah}var Ih,mj;function RL(){if(mj)return Ih;mj=1;var e=Sy(),t=$E(),r=Ps(),n=t?function(s,o){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return Ih=n,Ih}var Ph,xj;function AL(){if(xj)return Ph;xj=1;var e=800,t=16,r=Date.now;function n(s){var o=0,a=0;return function(){var l=r(),c=t-(l-a);if(a=l,c>0){if(++o>=e)return arguments[0]}else o=0;return s.apply(void 0,arguments)}}return Ph=n,Ph}var Oh,gj;function w4(){if(gj)return Oh;gj=1;var e=RL(),t=AL(),r=t(e);return Oh=r,Oh}var Mh,vj;function wu(){if(vj)return Mh;vj=1;var e=Ps(),t=_4(),r=w4();function n(s,o){return r(t(s,o,e),s+"")}return Mh=n,Mh}var Dh,yj;function j4(){if(yj)return Dh;yj=1;function e(t,r,n,s){for(var o=t.length,a=n+(s?1:-1);s?a--:++a<o;)if(r(t[a],a,t))return a;return-1}return Dh=e,Dh}var Lh,bj;function IL(){if(bj)return Lh;bj=1;function e(t){return t!==t}return Lh=e,Lh}var zh,_j;function PL(){if(_j)return zh;_j=1;function e(t,r,n){for(var s=n-1,o=t.length;++s<o;)if(t[s]===r)return s;return-1}return zh=e,zh}var Fh,wj;function OL(){if(wj)return Fh;wj=1;var e=j4(),t=IL(),r=PL();function n(s,o,a){return o===o?r(s,o,a):e(s,t,a)}return Fh=n,Fh}var $h,jj;function ML(){if(jj)return $h;jj=1;var e=OL();function t(r,n){var s=r==null?0:r.length;return!!s&&e(r,n,0)>-1}return $h=t,$h}var qh,Sj;function DL(){if(Sj)return qh;Sj=1;function e(t,r,n){for(var s=-1,o=t==null?0:t.length;++s<o;)if(n(r,t[s]))return!0;return!1}return qh=e,qh}var Bh,kj;function LL(){if(kj)return Bh;kj=1;function e(){}return Bh=e,Bh}var Wh,Nj;function zL(){if(Nj)return Wh;Nj=1;var e=XE(),t=LL(),r=Cy(),n=1/0,s=e&&1/r(new e([,-0]))[1]==n?function(o){return new e(o)}:t;return Wh=s,Wh}var Hh,Cj;function FL(){if(Cj)return Hh;Cj=1;var e=o4(),t=ML(),r=DL(),n=i4(),s=zL(),o=Cy(),a=200;function l(c,d,u){var f=-1,p=t,h=c.length,g=!0,x=[],_=x;if(u)g=!1,p=r;else if(h>=a){var v=d?null:s(c);if(v)return o(v);g=!1,p=n,_=new e}else _=d?[]:x;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,g&&b===b){for(var j=_.length;j--;)if(_[j]===b)continue e;d&&_.push(b),x.push(y)}else p(_,b,u)||(_!==x&&_.push(b),x.push(y))}return x}return Hh=l,Hh}var Uh,Ej;function S4(){if(Ej)return Uh;Ej=1;var e=bn(),t=Xr();function r(n){return t(n)&&e(n)}return Uh=r,Uh}var Vh,Tj;function $L(){if(Tj)return Vh;Tj=1;var e=Ty(),t=wu(),r=FL(),n=S4(),s=t(function(o){return r(e(o,1,n,!0))});return Vh=s,Vh}var Gh,Rj;function qL(){if(Rj)return Gh;Rj=1;var e=yu();function t(r,n){return e(n,function(s){return r[s]})}return Gh=t,Gh}var Kh,Aj;function k4(){if(Aj)return Kh;Aj=1;var e=qL(),t=rs();function r(n){return n==null?[]:e(n,t(n))}return Kh=r,Kh}var Yh,Ij;function _r(){if(Ij)return Yh;Ij=1;var e;if(typeof hy=="function")try{e={clone:KD(),constant:Sy(),each:s4(),filter:m4(),has:x4(),isArray:ft(),isEmpty:vL(),isFunction:Sa(),isUndefined:g4(),keys:rs(),map:y4(),reduce:b4(),size:NL(),transform:CL(),union:$L(),values:k4()}}catch{}return e||(e=window._),Yh=e,Yh}var Xh,Pj;function Ry(){if(Pj)return Xh;Pj=1;var e=_r();Xh=s;var t="\0",r="\0",n="";function s(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(u){return this._label=u,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},s.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},s.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(g){p.length>1?h.setNode(g,f):h.setNode(g)}),this},s.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=r,this._children[u]={},this._children[r][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},s.prototype.node=function(u){return this._nodes[u]},s.prototype.hasNode=function(u){return e.has(this._nodes,u)},s.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},s.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},s.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},s.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==r)return f}},s.prototype.children=function(u){if(e.isUndefined(u)&&(u=r),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===r)return this.nodes();if(this.hasNode(u))return[]}},s.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},s.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},s.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},s.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},s.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(x,_){u(_)&&f.setNode(_,x)}),e.each(this._edgeObjs,function(x){f.hasNode(x.v)&&f.hasNode(x.w)&&f.setEdge(x,p.edge(x))});var h={};function g(x){var _=p.parent(x);return _===void 0||f.hasNode(_)?(h[x]=_,_):_ in h?h[_]:g(_)}return this._isCompound&&e.each(f.nodes(),function(x){f.setParent(x,g(x))}),f},s.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(g,x){return h.length>1?p.setEdge(g,x,f):p.setEdge(g,x),x}),this},s.prototype.setEdge=function(){var u,f,p,h,g=!1,x=arguments[0];typeof x=="object"&&x!==null&&"v"in x?(u=x.v,f=x.w,p=x.name,arguments.length===2&&(h=arguments[1],g=!0)):(u=x,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],g=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var _=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,_))return g&&(this._edgeLabels[_]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[_]=g?h:this._defaultEdgeLabelFn(u,f,p);var v=c(this._isDirected,u,f,p);return u=v.v,f=v.w,Object.freeze(v),this._edgeObjs[_]=v,o(this._preds[f],u),o(this._sucs[u],f),this._in[f][_]=v,this._out[u][_]=v,this._edgeCount++,this},s.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},s.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),g=this._edgeObjs[h];return g&&(u=g.v,f=g.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[f],u),a(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},s.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(g){return g.v===f}):h}},s.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(g){return g.w===f}):h}},s.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function o(u,f){u[f]?u[f]++:u[f]=1}function a(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var g=""+f,x=""+p;if(!u&&g>x){var _=g;g=x,x=_}return g+n+x+n+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var g=""+f,x=""+p;if(!u&&g>x){var _=g;g=x,x=_}var v={v:g,w:x};return h&&(v.name=h),v}function d(u,f){return l(u,f.v,f.w,f.name)}return Xh}var Qh,Oj;function BL(){return Oj||(Oj=1,Qh="2.1.8"),Qh}var Zh,Mj;function WL(){return Mj||(Mj=1,Zh={Graph:Ry(),version:BL()}),Zh}var Jh,Dj;function HL(){if(Dj)return Jh;Dj=1;var e=_r(),t=Ry();Jh={write:r,read:o};function r(a){var l={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:n(a),edges:s(a)};return e.isUndefined(a.graph())||(l.value=e.clone(a.graph())),l}function n(a){return e.map(a.nodes(),function(l){var c=a.node(l),d=a.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function s(a){return e.map(a.edges(),function(l){var c=a.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function o(a){var l=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(a.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Jh}var em,Lj;function UL(){if(Lj)return em;Lj=1;var e=_r();em=t;function t(r){var n={},s=[],o;function a(l){e.has(n,l)||(n[l]=!0,o.push(l),e.each(r.successors(l),a),e.each(r.predecessors(l),a))}return e.each(r.nodes(),function(l){o=[],a(l),o.length&&s.push(o)}),s}return em}var tm,zj;function N4(){if(zj)return tm;zj=1;var e=_r();tm=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var s=this._keyIndices;if(r=String(r),!e.has(s,r)){var o=this._arr,a=o.length;return s[r]=a,o.push({key:r,priority:n}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var s=this._keyIndices[r];if(n>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[s].priority+" New: "+n);this._arr[s].priority=n,this._decrease(s)},t.prototype._heapify=function(r){var n=this._arr,s=2*r,o=s+1,a=r;s<n.length&&(a=n[s].priority<n[a].priority?s:a,o<n.length&&(a=n[o].priority<n[a].priority?o:a),a!==r&&(this._swap(r,a),this._heapify(a)))},t.prototype._decrease=function(r){for(var n=this._arr,s=n[r].priority,o;r!==0&&(o=r>>1,!(n[o].priority<s));)this._swap(r,o),r=o},t.prototype._swap=function(r,n){var s=this._arr,o=this._keyIndices,a=s[r],l=s[n];s[r]=l,s[n]=a,o[l.key]=r,o[a.key]=n},tm}var rm,Fj;function C4(){if(Fj)return rm;Fj=1;var e=_r(),t=N4();rm=n;var r=e.constant(1);function n(o,a,l,c){return s(o,String(a),l||r,c||function(d){return o.outEdges(d)})}function s(o,a,l,c){var d={},u=new t,f,p,h=function(g){var x=g.v!==f?g.v:g.w,_=d[x],v=l(g),y=p.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+v);y<_.distance&&(_.distance=y,_.predecessor=f,u.decrease(x,y))};for(o.nodes().forEach(function(g){var x=g===a?0:Number.POSITIVE_INFINITY;d[g]={distance:x},u.add(g,x)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return rm}var nm,$j;function VL(){if($j)return nm;$j=1;var e=C4(),t=_r();nm=r;function r(n,s,o){return t.transform(n.nodes(),function(a,l){a[l]=e(n,l,s,o)},{})}return nm}var sm,qj;function E4(){if(qj)return sm;qj=1;var e=_r();sm=t;function t(r){var n=0,s=[],o={},a=[];function l(c){var d=o[c]={onStack:!0,lowlink:n,index:n++};if(s.push(c),r.successors(c).forEach(function(p){e.has(o,p)?o[p].onStack&&(d.lowlink=Math.min(d.lowlink,o[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,o[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=s.pop(),o[f].onStack=!1,u.push(f);while(c!==f);a.push(u)}}return r.nodes().forEach(function(c){e.has(o,c)||l(c)}),a}return sm}var om,Bj;function GL(){if(Bj)return om;Bj=1;var e=_r(),t=E4();om=r;function r(n){return e.filter(t(n),function(s){return s.length>1||s.length===1&&n.hasEdge(s[0],s[0])})}return om}var im,Wj;function KL(){if(Wj)return im;Wj=1;var e=_r();im=r;var t=e.constant(1);function r(s,o,a){return n(s,o||t,a||function(l){return s.outEdges(l)})}function n(s,o,a){var l={},c=s.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),a(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=o(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var g=p[d],x=u[h],_=p[h],v=g.distance+x.distance;v<_.distance&&(_.distance=v,_.predecessor=x.predecessor)})})}),l}return im}var am,Hj;function T4(){if(Hj)return am;Hj=1;var e=_r();am=t,t.CycleException=r;function t(n){var s={},o={},a=[];function l(c){if(e.has(o,c))throw new r;e.has(s,c)||(o[c]=!0,s[c]=!0,e.each(n.predecessors(c),l),delete o[c],a.push(c))}if(e.each(n.sinks(),l),e.size(s)!==n.nodeCount())throw new r;return a}function r(){}return r.prototype=new Error,am}var lm,Uj;function YL(){if(Uj)return lm;Uj=1;var e=T4();lm=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return lm}var cm,Vj;function R4(){if(Vj)return cm;Vj=1;var e=_r();cm=t;function t(n,s,o){e.isArray(s)||(s=[s]);var a=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(s,function(d){if(!n.hasNode(d))throw new Error("Graph does not have node: "+d);r(n,d,o==="post",c,a,l)}),l}function r(n,s,o,a,l,c){e.has(a,s)||(a[s]=!0,o||c.push(s),e.each(l(s),function(d){r(n,d,o,a,l,c)}),o&&c.push(s))}return cm}var um,Gj;function XL(){if(Gj)return um;Gj=1;var e=R4();um=t;function t(r,n){return e(r,n,"post")}return um}var dm,Kj;function QL(){if(Kj)return dm;Kj=1;var e=R4();dm=t;function t(r,n){return e(r,n,"pre")}return dm}var fm,Yj;function ZL(){if(Yj)return fm;Yj=1;var e=_r(),t=Ry(),r=N4();fm=n;function n(s,o){var a=new t,l={},c=new r,d;function u(p){var h=p.v===d?p.w:p.v,g=c.priority(h);if(g!==void 0){var x=o(p);x<g&&(l[h]=d,c.decrease(h,x))}}if(s.nodeCount()===0)return a;e.each(s.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),a.setNode(p)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))a.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(d).forEach(u)}return a}return fm}var pm,Xj;function JL(){return Xj||(Xj=1,pm={components:UL(),dijkstra:C4(),dijkstraAll:VL(),findCycles:GL(),floydWarshall:KL(),isAcyclic:YL(),postorder:XL(),preorder:QL(),prim:ZL(),tarjan:E4(),topsort:T4()}),pm}var hm,Qj;function ez(){if(Qj)return hm;Qj=1;var e=WL();return hm={Graph:e.Graph,json:HL(),alg:JL(),version:e.version},hm}var gc;if(typeof hy=="function")try{gc=ez()}catch{}gc||(gc=window.graphlib);var Dr=gc,mm,Zj;function tz(){if(Zj)return mm;Zj=1;var e=t4(),t=1,r=4;function n(s){return e(s,t|r)}return mm=n,mm}var xm,Jj;function ju(){if(Jj)return xm;Jj=1;var e=Do(),t=bn(),r=hu(),n=br();function s(o,a,l){if(!n(l))return!1;var c=typeof a;return(c=="number"?t(l)&&r(a,l.length):c=="string"&&a in l)?e(l[a],o):!1}return xm=s,xm}var gm,e2;function rz(){if(e2)return gm;e2=1;var e=wu(),t=Do(),r=ju(),n=Is(),s=Object.prototype,o=s.hasOwnProperty,a=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=n(p),g=-1,x=h.length;++g<x;){var _=h[g],v=l[_];(v===void 0||t(v,s[_])&&!o.call(l,_))&&(l[_]=p[_])}return l});return gm=a,gm}var vm,t2;function nz(){if(t2)return vm;t2=1;var e=_n(),t=bn(),r=rs();function n(s){return function(o,a,l){var c=Object(o);if(!t(o)){var d=e(a,3);o=r(o),a=function(f){return d(c[f],f,c)}}var u=s(o,a,l);return u>-1?c[d?o[u]:u]:void 0}}return vm=n,vm}var ym,r2;function sz(){if(r2)return ym;r2=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return ym=t,ym}var bm,n2;function oz(){if(n2)return bm;n2=1;var e=sz(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return bm=r,bm}var _m,s2;function iz(){if(s2)return _m;s2=1;var e=oz(),t=br(),r=$o(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return n;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=o.test(d);return f||a.test(d)?l(d.slice(2),f?2:8):s.test(d)?n:+d}return _m=c,_m}var wm,o2;function A4(){if(o2)return wm;o2=1;var e=iz(),t=1/0,r=17976931348623157e292;function n(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var o=s<0?-1:1;return o*r}return s===s?s:0}return wm=n,wm}var jm,i2;function az(){if(i2)return jm;i2=1;var e=A4();function t(r){var n=e(r),s=n%1;return n===n?s?n-s:n:0}return jm=t,jm}var Sm,a2;function lz(){if(a2)return Sm;a2=1;var e=j4(),t=_n(),r=az(),n=Math.max;function s(o,a,l){var c=o==null?0:o.length;if(!c)return-1;var d=l==null?0:r(l);return d<0&&(d=n(c+d,0)),e(o,t(a,3),d)}return Sm=s,Sm}var km,l2;function cz(){if(l2)return km;l2=1;var e=nz(),t=lz(),r=e(t);return km=r,km}var Nm,c2;function I4(){if(c2)return Nm;c2=1;var e=Ty();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return Nm=t,Nm}var Cm,u2;function uz(){if(u2)return Cm;u2=1;var e=ky(),t=r4(),r=Is();function n(s,o){return s==null?s:e(s,t(o),r)}return Cm=n,Cm}var Em,d2;function dz(){if(d2)return Em;d2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Em=e,Em}var Tm,f2;function fz(){if(f2)return Tm;f2=1;var e=fu(),t=Ny(),r=_n();function n(s,o){var a={};return o=r(o,3),t(s,function(l,c,d){e(a,c,o(l,c,d))}),a}return Tm=n,Tm}var Rm,p2;function Ay(){if(p2)return Rm;p2=1;var e=$o();function t(r,n,s){for(var o=-1,a=r.length;++o<a;){var l=r[o],c=n(l);if(c!=null&&(d===void 0?c===c&&!e(c):s(c,d)))var d=c,u=l}return u}return Rm=t,Rm}var Am,h2;function pz(){if(h2)return Am;h2=1;function e(t,r){return t>r}return Am=e,Am}var Im,m2;function hz(){if(m2)return Im;m2=1;var e=Ay(),t=pz(),r=Ps();function n(s){return s&&s.length?e(s,r,t):void 0}return Im=n,Im}var Pm,x2;function P4(){if(x2)return Pm;x2=1;var e=fu(),t=Do();function r(n,s,o){(o!==void 0&&!t(n[s],o)||o===void 0&&!(s in n))&&e(n,s,o)}return Pm=r,Pm}var Om,g2;function mz(){if(g2)return Om;g2=1;var e=Rs(),t=gu(),r=Xr(),n="[object Object]",s=Function.prototype,o=Object.prototype,a=s.toString,l=o.hasOwnProperty,c=a.call(Object);function d(u){if(!r(u)||e(u)!=n)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&a.call(p)==c}return Om=d,Om}var Mm,v2;function O4(){if(v2)return Mm;v2=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Mm=e,Mm}var Dm,y2;function xz(){if(y2)return Dm;y2=1;var e=ka(),t=Is();function r(n){return e(n,t(n))}return Dm=r,Dm}var Lm,b2;function gz(){if(b2)return Lm;b2=1;var e=P4(),t=WE(),r=ZE(),n=HE(),s=e4(),o=Na(),a=ft(),l=S4(),c=zo(),d=Sa(),u=br(),f=mz(),p=Ca(),h=O4(),g=xz();function x(_,v,y,b,j,N,T){var C=h(_,y),S=h(v,y),w=T.get(S);if(w){e(_,y,w);return}var A=N?N(C,S,y+"",_,v,T):void 0,E=A===void 0;if(E){var O=a(S),z=!O&&c(S),k=!O&&!z&&p(S);A=S,O||z||k?a(C)?A=C:l(C)?A=n(C):z?(E=!1,A=t(S,!0)):k?(E=!1,A=r(S,!0)):A=[]:f(S)||o(S)?(A=C,o(C)?A=g(C):(!u(C)||d(C))&&(A=s(S))):E=!1}E&&(T.set(S,A),j(A,S,b,N,T),T.delete(S)),e(_,y,A)}return Lm=x,Lm}var zm,_2;function vz(){if(_2)return zm;_2=1;var e=du(),t=P4(),r=ky(),n=gz(),s=br(),o=Is(),a=O4();function l(c,d,u,f,p){c!==d&&r(d,function(h,g){if(p||(p=new e),s(h))n(c,d,g,u,l,f,p);else{var x=f?f(a(c,g),h,g+"",c,d,p):void 0;x===void 0&&(x=h),t(c,g,x)}},o)}return zm=l,zm}var Fm,w2;function yz(){if(w2)return Fm;w2=1;var e=wu(),t=ju();function r(n){return e(function(s,o){var a=-1,l=o.length,c=l>1?o[l-1]:void 0,d=l>2?o[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(o[0],o[1],d)&&(c=l<3?void 0:c,l=1),s=Object(s);++a<l;){var u=o[a];u&&n(s,u,a,c)}return s})}return Fm=r,Fm}var $m,j2;function bz(){if(j2)return $m;j2=1;var e=vz(),t=yz(),r=t(function(n,s,o){e(n,s,o)});return $m=r,$m}var qm,S2;function M4(){if(S2)return qm;S2=1;function e(t,r){return t<r}return qm=e,qm}var Bm,k2;function _z(){if(k2)return Bm;k2=1;var e=Ay(),t=M4(),r=Ps();function n(s){return s&&s.length?e(s,r,t):void 0}return Bm=n,Bm}var Wm,N2;function wz(){if(N2)return Wm;N2=1;var e=Ay(),t=_n(),r=M4();function n(s,o){return s&&s.length?e(s,t(o,2),r):void 0}return Wm=n,Wm}var Hm,C2;function jz(){if(C2)return Hm;C2=1;var e=Mr(),t=function(){return e.Date.now()};return Hm=t,Hm}var Um,E2;function Sz(){if(E2)return Um;E2=1;var e=pu(),t=bu(),r=hu(),n=br(),s=Ea();function o(a,l,c,d){if(!n(a))return a;l=t(l,a);for(var u=-1,f=l.length,p=f-1,h=a;h!=null&&++u<f;){var g=s(l[u]),x=c;if(g==="__proto__"||g==="constructor"||g==="prototype")return a;if(u!=p){var _=h[g];x=d?d(_,g,h):void 0,x===void 0&&(x=n(_)?_:r(l[u+1])?[]:{})}e(h,g,x),h=h[g]}return a}return Um=o,Um}var Vm,T2;function kz(){if(T2)return Vm;T2=1;var e=_u(),t=Sz(),r=bu();function n(s,o,a){for(var l=-1,c=o.length,d={};++l<c;){var u=o[l],f=e(s,u);a(f,u)&&t(d,r(u,s),f)}return d}return Vm=n,Vm}var Gm,R2;function Nz(){if(R2)return Gm;R2=1;var e=kz(),t=p4();function r(n,s){return e(n,s,function(o,a){return t(n,a)})}return Gm=r,Gm}var Km,A2;function Cz(){if(A2)return Km;A2=1;var e=I4(),t=_4(),r=w4();function n(s){return r(t(s,void 0,e),s+"")}return Km=n,Km}var Ym,I2;function Ez(){if(I2)return Ym;I2=1;var e=Nz(),t=Cz(),r=t(function(n,s){return n==null?{}:e(n,s)});return Ym=r,Ym}var Xm,P2;function Tz(){if(P2)return Xm;P2=1;var e=Math.ceil,t=Math.max;function r(n,s,o,a){for(var l=-1,c=t(e((s-n)/(o||1)),0),d=Array(c);c--;)d[a?c:++l]=n,n+=o;return d}return Xm=r,Xm}var Qm,O2;function Rz(){if(O2)return Qm;O2=1;var e=Tz(),t=ju(),r=A4();function n(s){return function(o,a,l){return l&&typeof l!="number"&&t(o,a,l)&&(a=l=void 0),o=r(o),a===void 0?(a=o,o=0):a=r(a),l=l===void 0?o<a?1:-1:r(l),e(o,a,l,s)}}return Qm=n,Qm}var Zm,M2;function Az(){if(M2)return Zm;M2=1;var e=Rz(),t=e();return Zm=t,Zm}var Jm,D2;function Iz(){if(D2)return Jm;D2=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Jm=e,Jm}var ex,L2;function Pz(){if(L2)return ex;L2=1;var e=$o();function t(r,n){if(r!==n){var s=r!==void 0,o=r===null,a=r===r,l=e(r),c=n!==void 0,d=n===null,u=n===n,f=e(n);if(!d&&!f&&!l&&r>n||l&&c&&u&&!d&&!f||o&&c&&u||!s&&u||!a)return 1;if(!o&&!l&&!f&&r<n||f&&s&&a&&!o&&!l||d&&s&&a||!c&&a||!u)return-1}return 0}return ex=t,ex}var tx,z2;function Oz(){if(z2)return tx;z2=1;var e=Pz();function t(r,n,s){for(var o=-1,a=r.criteria,l=n.criteria,c=a.length,d=s.length;++o<c;){var u=e(a[o],l[o]);if(u){if(o>=d)return u;var f=s[o];return u*(f=="desc"?-1:1)}}return r.index-n.index}return tx=t,tx}var rx,F2;function Mz(){if(F2)return rx;F2=1;var e=yu(),t=_u(),r=_n(),n=v4(),s=Iz(),o=mu(),a=Oz(),l=Ps(),c=ft();function d(u,f,p){f.length?f=e(f,function(x){return c(x)?function(_){return t(_,x.length===1?x[0]:x)}:x}):f=[l];var h=-1;f=e(f,o(r));var g=n(u,function(x,_,v){var y=e(f,function(b){return b(x)});return{criteria:y,index:++h,value:x}});return s(g,function(x,_){return a(x,_,p)})}return rx=d,rx}var nx,$2;function Dz(){if($2)return nx;$2=1;var e=Ty(),t=Mz(),r=wu(),n=ju(),s=r(function(o,a){if(o==null)return[];var l=a.length;return l>1&&n(o,a[0],a[1])?a=[]:l>2&&n(a[0],a[1],a[2])&&(a=[a[0]]),t(o,e(a,1),[])});return nx=s,nx}var sx,q2;function Lz(){if(q2)return sx;q2=1;var e=d4(),t=0;function r(n){var s=++t;return e(n)+s}return sx=r,sx}var ox,B2;function zz(){if(B2)return ox;B2=1;function e(t,r,n){for(var s=-1,o=t.length,a=r.length,l={};++s<o;){var c=s<a?r[s]:void 0;n(l,t[s],c)}return l}return ox=e,ox}var ix,W2;function Fz(){if(W2)return ix;W2=1;var e=pu(),t=zz();function r(n,s){return t(n||[],s||[],e)}return ix=r,ix}var vc;if(typeof hy=="function")try{vc={cloneDeep:tz(),constant:Sy(),defaults:rz(),each:s4(),filter:m4(),find:cz(),flatten:I4(),forEach:n4(),forIn:uz(),has:x4(),isUndefined:g4(),last:dz(),map:y4(),mapValues:fz(),max:hz(),merge:bz(),min:_z(),minBy:wz(),now:jz(),pick:Ez(),range:Az(),reduce:b4(),sortBy:Dz(),uniqueId:Lz(),values:k4(),zipObject:Fz()}}catch{}vc||(vc=window._);var et=vc,$z=Su;function Su(){var e={};e._next=e._prev=e,this._sentinel=e}Su.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return D4(t),t};Su.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&D4(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};Su.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,qz)),r=r._prev;return"["+e.join(", ")+"]"};function D4(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function qz(e,t){if(e!=="_next"&&e!=="_prev")return t}var an=et,Bz=Dr.Graph,Wz=$z,Hz=Vz,Uz=an.constant(1);function Vz(e,t){if(e.nodeCount()<=1)return[];var r=Kz(e,t||Uz),n=Gz(r.graph,r.buckets,r.zeroIdx);return an.flatten(an.map(n,function(s){return e.outEdges(s.v,s.w)}),!0)}function Gz(e,t,r){for(var n=[],s=t[t.length-1],o=t[0],a;e.nodeCount();){for(;a=o.dequeue();)ax(e,t,r,a);for(;a=s.dequeue();)ax(e,t,r,a);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(a=t[l].dequeue(),a){n=n.concat(ax(e,t,r,a,!0));break}}}return n}function ax(e,t,r,n,s){var o=s?[]:void 0;return an.forEach(e.inEdges(n.v),function(a){var l=e.edge(a),c=e.node(a.v);s&&o.push({v:a.v,w:a.w}),c.out-=l,Hg(t,r,c)}),an.forEach(e.outEdges(n.v),function(a){var l=e.edge(a),c=a.w,d=e.node(c);d.in-=l,Hg(t,r,d)}),e.removeNode(n.v),o}function Kz(e,t){var r=new Bz,n=0,s=0;an.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),an.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,d=t(l),u=c+d;r.setEdge(l.v,l.w,u),s=Math.max(s,r.node(l.v).out+=d),n=Math.max(n,r.node(l.w).in+=d)});var o=an.range(s+n+3).map(function(){return new Wz}),a=n+1;return an.forEach(r.nodes(),function(l){Hg(o,a,r.node(l))}),{graph:r,buckets:o,zeroIdx:a}}function Hg(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var ms=et,Yz=Hz,Xz={run:Qz,undo:Jz};function Qz(e){var t=e.graph().acyclicer==="greedy"?Yz(e,r(e)):Zz(e);ms.forEach(t,function(n){var s=e.edge(n);e.removeEdge(n),s.forwardName=n.name,s.reversed=!0,e.setEdge(n.w,n.v,s,ms.uniqueId("rev"))});function r(n){return function(s){return n.edge(s).weight}}}function Zz(e){var t=[],r={},n={};function s(o){ms.has(n,o)||(n[o]=!0,r[o]=!0,ms.forEach(e.outEdges(o),function(a){ms.has(r,a.w)?t.push(a):s(a.w)}),delete r[o])}return ms.forEach(e.nodes(),s),t}function Jz(e){ms.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var Be=et,L4=Dr.Graph,Xt={addDummyNode:z4,simplify:eF,asNonCompoundGraph:tF,successorWeights:rF,predecessorWeights:nF,intersectRect:sF,buildLayerMatrix:oF,normalizeRanks:iF,removeEmptyRanks:aF,addBorderNode:lF,maxRank:F4,partition:cF,time:uF,notime:dF};function z4(e,t,r,n){var s;do s=Be.uniqueId(n);while(e.hasNode(s));return r.dummy=t,e.setNode(s,r),s}function eF(e){var t=new L4().setGraph(e.graph());return Be.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),Be.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},s=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+s.weight,minlen:Math.max(n.minlen,s.minlen)})}),t}function tF(e){var t=new L4({multigraph:e.isMultigraph()}).setGraph(e.graph());return Be.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),Be.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function rF(e){var t=Be.map(e.nodes(),function(r){var n={};return Be.forEach(e.outEdges(r),function(s){n[s.w]=(n[s.w]||0)+e.edge(s).weight}),n});return Be.zipObject(e.nodes(),t)}function nF(e){var t=Be.map(e.nodes(),function(r){var n={};return Be.forEach(e.inEdges(r),function(s){n[s.v]=(n[s.v]||0)+e.edge(s).weight}),n});return Be.zipObject(e.nodes(),t)}function sF(e,t){var r=e.x,n=e.y,s=t.x-r,o=t.y-n,a=e.width/2,l=e.height/2;if(!s&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(o)*a>Math.abs(s)*l?(o<0&&(l=-l),c=l*s/o,d=l):(s<0&&(a=-a),c=a,d=a*o/s),{x:r+c,y:n+d}}function oF(e){var t=Be.map(Be.range(F4(e)+1),function(){return[]});return Be.forEach(e.nodes(),function(r){var n=e.node(r),s=n.rank;Be.isUndefined(s)||(t[s][n.order]=r)}),t}function iF(e){var t=Be.min(Be.map(e.nodes(),function(r){return e.node(r).rank}));Be.forEach(e.nodes(),function(r){var n=e.node(r);Be.has(n,"rank")&&(n.rank-=t)})}function aF(e){var t=Be.min(Be.map(e.nodes(),function(o){return e.node(o).rank})),r=[];Be.forEach(e.nodes(),function(o){var a=e.node(o).rank-t;r[a]||(r[a]=[]),r[a].push(o)});var n=0,s=e.graph().nodeRankFactor;Be.forEach(r,function(o,a){Be.isUndefined(o)&&a%s!==0?--n:n&&Be.forEach(o,function(l){e.node(l).rank+=n})})}function lF(e,t,r,n){var s={width:0,height:0};return arguments.length>=4&&(s.rank=r,s.order=n),z4(e,"border",s,t)}function F4(e){return Be.max(Be.map(e.nodes(),function(t){var r=e.node(t).rank;if(!Be.isUndefined(r))return r}))}function cF(e,t){var r={lhs:[],rhs:[]};return Be.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function uF(e,t){var r=Be.now();try{return t()}finally{console.log(e+" time: "+(Be.now()-r)+"ms")}}function dF(e,t){return t()}var $4=et,fF=Xt,pF={run:hF,undo:xF};function hF(e){e.graph().dummyChains=[],$4.forEach(e.edges(),function(t){mF(e,t)})}function mF(e,t){var r=t.v,n=e.node(r).rank,s=t.w,o=e.node(s).rank,a=t.name,l=e.edge(t),c=l.labelRank;if(o!==n+1){e.removeEdge(t);var d,u,f;for(f=0,++n;n<o;++f,++n)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},d=fF.addDummyNode(e,"edge",u,"_d"),n===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(r,d,{weight:l.weight},a),f===0&&e.graph().dummyChains.push(d),r=d;e.setEdge(r,s,{weight:l.weight},a)}}function xF(e){$4.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,s;for(e.setEdge(r.edgeObj,n);r.dummy;)s=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=s,r=e.node(t)})}var al=et,ku={longestPath:gF,slack:vF};function gF(e){var t={};function r(n){var s=e.node(n);if(al.has(t,n))return s.rank;t[n]=!0;var o=al.min(al.map(e.outEdges(n),function(a){return r(a.w)-e.edge(a).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),s.rank=o}al.forEach(e.sources(),r)}function vF(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var yc=et,yF=Dr.Graph,bc=ku.slack,q4=bF;function bF(e){var t=new yF({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var s,o;_F(t,e)<n;)s=wF(t,e),o=t.hasNode(s.v)?bc(e,s):-bc(e,s),jF(t,e,o);return t}function _F(e,t){function r(n){yc.forEach(t.nodeEdges(n),function(s){var o=s.v,a=n===o?s.w:o;!e.hasNode(a)&&!bc(t,s)&&(e.setNode(a,{}),e.setEdge(n,a,{}),r(a))})}return yc.forEach(e.nodes(),r),e.nodeCount()}function wF(e,t){return yc.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return bc(t,r)})}function jF(e,t,r){yc.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var gn=et,SF=q4,kF=ku.slack,NF=ku.longestPath,CF=Dr.alg.preorder,EF=Dr.alg.postorder,TF=Xt.simplify,RF=Os;Os.initLowLimValues=Py;Os.initCutValues=Iy;Os.calcCutValue=B4;Os.leaveEdge=H4;Os.enterEdge=U4;Os.exchangeEdges=V4;function Os(e){e=TF(e),NF(e);var t=SF(e);Py(t),Iy(t,e);for(var r,n;r=H4(t);)n=U4(t,e,r),V4(t,e,r,n)}function Iy(e,t){var r=EF(e,e.nodes());r=r.slice(0,r.length-1),gn.forEach(r,function(n){AF(e,t,n)})}function AF(e,t,r){var n=e.node(r),s=n.parent;e.edge(r,s).cutvalue=B4(e,t,r)}function B4(e,t,r){var n=e.node(r),s=n.parent,o=!0,a=t.edge(r,s),l=0;return a||(o=!1,a=t.edge(s,r)),l=a.weight,gn.forEach(t.nodeEdges(r),function(c){var d=c.v===r,u=d?c.w:c.v;if(u!==s){var f=d===o,p=t.edge(c).weight;if(l+=f?p:-p,PF(e,r,u)){var h=e.edge(r,u).cutvalue;l+=f?-h:h}}}),l}function Py(e,t){arguments.length<2&&(t=e.nodes()[0]),W4(e,{},1,t)}function W4(e,t,r,n,s){var o=r,a=e.node(n);return t[n]=!0,gn.forEach(e.neighbors(n),function(l){gn.has(t,l)||(r=W4(e,t,r,l,n))}),a.low=o,a.lim=r++,s?a.parent=s:delete a.parent,r}function H4(e){return gn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function U4(e,t,r){var n=r.v,s=r.w;t.hasEdge(n,s)||(n=r.w,s=r.v);var o=e.node(n),a=e.node(s),l=o,c=!1;o.lim>a.lim&&(l=a,c=!0);var d=gn.filter(t.edges(),function(u){return c===H2(e,e.node(u.v),l)&&c!==H2(e,e.node(u.w),l)});return gn.minBy(d,function(u){return kF(t,u)})}function V4(e,t,r,n){var s=r.v,o=r.w;e.removeEdge(s,o),e.setEdge(n.v,n.w,{}),Py(e),Iy(e,t),IF(e,t)}function IF(e,t){var r=gn.find(e.nodes(),function(s){return!t.node(s).parent}),n=CF(e,r);n=n.slice(1),gn.forEach(n,function(s){var o=e.node(s).parent,a=t.edge(s,o),l=!1;a||(a=t.edge(o,s),l=!0),t.node(s).rank=t.node(o).rank+(l?a.minlen:-a.minlen)})}function PF(e,t,r){return e.hasEdge(t,r)}function H2(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var OF=ku,G4=OF.longestPath,MF=q4,DF=RF,LF=zF;function zF(e){switch(e.graph().ranker){case"network-simplex":U2(e);break;case"tight-tree":$F(e);break;case"longest-path":FF(e);break;default:U2(e)}}var FF=G4;function $F(e){G4(e),MF(e)}function U2(e){DF(e)}var Ug=et,qF=BF;function BF(e){var t=HF(e);Ug.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),s=n.edgeObj,o=WF(e,t,s.v,s.w),a=o.path,l=o.lca,c=0,d=a[c],u=!0;r!==s.w;){if(n=e.node(r),u){for(;(d=a[c])!==l&&e.node(d).maxRank<n.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<a.length-1&&e.node(d=a[c+1]).minRank<=n.rank;)c++;d=a[c]}e.setParent(r,d),r=e.successors(r)[0]}})}function WF(e,t,r,n){var s=[],o=[],a=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,d;c=r;do c=e.parent(c),s.push(c);while(c&&(t[c].low>a||l>t[c].lim));for(d=c,c=n;(c=e.parent(c))!==d;)o.push(c);return{path:s.concat(o.reverse()),lca:d}}function HF(e){var t={},r=0;function n(s){var o=r;Ug.forEach(e.children(s),n),t[s]={low:o,lim:r++}}return Ug.forEach(e.children(),n),t}var ln=et,Vg=Xt,UF={run:VF,cleanup:YF};function VF(e){var t=Vg.addDummyNode(e,"root",{},"_root"),r=GF(e),n=ln.max(ln.values(r))-1,s=2*n+1;e.graph().nestingRoot=t,ln.forEach(e.edges(),function(a){e.edge(a).minlen*=s});var o=KF(e)+1;ln.forEach(e.children(),function(a){K4(e,t,s,o,n,r,a)}),e.graph().nodeRankFactor=s}function K4(e,t,r,n,s,o,a){var l=e.children(a);if(!l.length){a!==t&&e.setEdge(t,a,{weight:0,minlen:r});return}var c=Vg.addBorderNode(e,"_bt"),d=Vg.addBorderNode(e,"_bb"),u=e.node(a);e.setParent(c,a),u.borderTop=c,e.setParent(d,a),u.borderBottom=d,ln.forEach(l,function(f){K4(e,t,r,n,s,o,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,g=p.borderBottom?p.borderBottom:f,x=p.borderTop?n:2*n,_=h!==g?1:s-o[a]+1;e.setEdge(c,h,{weight:x,minlen:_,nestingEdge:!0}),e.setEdge(g,d,{weight:x,minlen:_,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,c,{weight:0,minlen:s+o[a]})}function GF(e){var t={};function r(n,s){var o=e.children(n);o&&o.length&&ln.forEach(o,function(a){r(a,s+1)}),t[n]=s}return ln.forEach(e.children(),function(n){r(n,1)}),t}function KF(e){return ln.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function YF(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,ln.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var lx=et,XF=Xt,QF=ZF;function ZF(e){function t(r){var n=e.children(r),s=e.node(r);if(n.length&&lx.forEach(n,t),lx.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var o=s.minRank,a=s.maxRank+1;o<a;++o)V2(e,"borderLeft","_bl",r,s,o),V2(e,"borderRight","_br",r,s,o)}}lx.forEach(e.children(),t)}function V2(e,t,r,n,s,o){var a={width:0,height:0,rank:o,borderType:t},l=s[t][o-1],c=XF.addDummyNode(e,"border",a,r);s[t][o]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var Wr=et,JF={adjust:e$,undo:t$};function e$(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&Y4(e)}function t$(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&r$(e),(t==="lr"||t==="rl")&&(n$(e),Y4(e))}function Y4(e){Wr.forEach(e.nodes(),function(t){G2(e.node(t))}),Wr.forEach(e.edges(),function(t){G2(e.edge(t))})}function G2(e){var t=e.width;e.width=e.height,e.height=t}function r$(e){Wr.forEach(e.nodes(),function(t){cx(e.node(t))}),Wr.forEach(e.edges(),function(t){var r=e.edge(t);Wr.forEach(r.points,cx),Wr.has(r,"y")&&cx(r)})}function cx(e){e.y=-e.y}function n$(e){Wr.forEach(e.nodes(),function(t){ux(e.node(t))}),Wr.forEach(e.edges(),function(t){var r=e.edge(t);Wr.forEach(r.points,ux),Wr.has(r,"x")&&ux(r)})}function ux(e){var t=e.x;e.x=e.y,e.y=t}var Zr=et,s$=o$;function o$(e){var t={},r=Zr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Zr.max(Zr.map(r,function(l){return e.node(l).rank})),s=Zr.map(Zr.range(n+1),function(){return[]});function o(l){if(!Zr.has(t,l)){t[l]=!0;var c=e.node(l);s[c.rank].push(l),Zr.forEach(e.successors(l),o)}}var a=Zr.sortBy(r,function(l){return e.node(l).rank});return Zr.forEach(a,o),s}var Sn=et,i$=a$;function a$(e,t){for(var r=0,n=1;n<t.length;++n)r+=l$(e,t[n-1],t[n]);return r}function l$(e,t,r){for(var n=Sn.zipObject(r,Sn.map(r,function(d,u){return u})),s=Sn.flatten(Sn.map(t,function(d){return Sn.sortBy(Sn.map(e.outEdges(d),function(u){return{pos:n[u.w],weight:e.edge(u).weight}}),"pos")}),!0),o=1;o<r.length;)o<<=1;var a=2*o-1;o-=1;var l=Sn.map(new Array(a),function(){return 0}),c=0;return Sn.forEach(s.forEach(function(d){var u=d.pos+o;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var K2=et,c$=u$;function u$(e,t){return K2.map(t,function(r){var n=e.inEdges(r);if(n.length){var s=K2.reduce(n,function(o,a){var l=e.edge(a),c=e.node(a.v);return{sum:o.sum+l.weight*c.order,weight:o.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}var tr=et,d$=f$;function f$(e,t){var r={};tr.forEach(e,function(s,o){var a=r[s.v]={indegree:0,in:[],out:[],vs:[s.v],i:o};tr.isUndefined(s.barycenter)||(a.barycenter=s.barycenter,a.weight=s.weight)}),tr.forEach(t.edges(),function(s){var o=r[s.v],a=r[s.w];!tr.isUndefined(o)&&!tr.isUndefined(a)&&(a.indegree++,o.out.push(r[s.w]))});var n=tr.filter(r,function(s){return!s.indegree});return p$(n)}function p$(e){var t=[];function r(o){return function(a){a.merged||(tr.isUndefined(a.barycenter)||tr.isUndefined(o.barycenter)||a.barycenter>=o.barycenter)&&h$(o,a)}}function n(o){return function(a){a.in.push(o),--a.indegree===0&&e.push(a)}}for(;e.length;){var s=e.pop();t.push(s),tr.forEach(s.in.reverse(),r(s)),tr.forEach(s.out,n(s))}return tr.map(tr.filter(t,function(o){return!o.merged}),function(o){return tr.pick(o,["vs","i","barycenter","weight"])})}function h$(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var bi=et,m$=Xt,x$=g$;function g$(e,t){var r=m$.partition(e,function(u){return bi.has(u,"barycenter")}),n=r.lhs,s=bi.sortBy(r.rhs,function(u){return-u.i}),o=[],a=0,l=0,c=0;n.sort(v$(!!t)),c=Y2(o,s,c),bi.forEach(n,function(u){c+=u.vs.length,o.push(u.vs),a+=u.barycenter*u.weight,l+=u.weight,c=Y2(o,s,c)});var d={vs:bi.flatten(o,!0)};return l&&(d.barycenter=a/l,d.weight=l),d}function Y2(e,t,r){for(var n;t.length&&(n=bi.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function v$(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var On=et,y$=c$,b$=d$,_$=x$,w$=X4;function X4(e,t,r,n){var s=e.children(t),o=e.node(t),a=o?o.borderLeft:void 0,l=o?o.borderRight:void 0,c={};a&&(s=On.filter(s,function(g){return g!==a&&g!==l}));var d=y$(e,s);On.forEach(d,function(g){if(e.children(g.v).length){var x=X4(e,g.v,r,n);c[g.v]=x,On.has(x,"barycenter")&&S$(g,x)}});var u=b$(d,r);j$(u,c);var f=_$(u,n);if(a&&(f.vs=On.flatten([a,f.vs,l],!0),e.predecessors(a).length)){var p=e.node(e.predecessors(a)[0]),h=e.node(e.predecessors(l)[0]);On.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function j$(e,t){On.forEach(e,function(r){r.vs=On.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function S$(e,t){On.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var _i=et,k$=Dr.Graph,N$=C$;function C$(e,t,r){var n=E$(e),s=new k$({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(o){return e.node(o)});return _i.forEach(e.nodes(),function(o){var a=e.node(o),l=e.parent(o);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(o),s.setParent(o,l||n),_i.forEach(e[r](o),function(c){var d=c.v===o?c.w:c.v,u=s.edge(d,o),f=_i.isUndefined(u)?0:u.weight;s.setEdge(d,o,{weight:e.edge(c).weight+f})}),_i.has(a,"minRank")&&s.setNode(o,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),s}function E$(e){for(var t;e.hasNode(t=_i.uniqueId("_root")););return t}var T$=et,R$=A$;function A$(e,t,r){var n={},s;T$.forEach(r,function(o){for(var a=e.parent(o),l,c;a;){if(l=e.parent(a),l?(c=n[l],n[l]=a):(c=s,s=a),c&&c!==a){t.setEdge(c,a);return}a=l}})}var Gn=et,I$=s$,P$=i$,O$=w$,M$=N$,D$=R$,L$=Dr.Graph,X2=Xt,z$=F$;function F$(e){var t=X2.maxRank(e),r=Q2(e,Gn.range(1,t+1),"inEdges"),n=Q2(e,Gn.range(t-1,-1,-1),"outEdges"),s=I$(e);Z2(e,s);for(var o=Number.POSITIVE_INFINITY,a,l=0,c=0;c<4;++l,++c){$$(l%2?r:n,l%4>=2),s=X2.buildLayerMatrix(e);var d=P$(e,s);d<o&&(c=0,a=Gn.cloneDeep(s),o=d)}Z2(e,a)}function Q2(e,t,r){return Gn.map(t,function(n){return M$(e,n,r)})}function $$(e,t){var r=new L$;Gn.forEach(e,function(n){var s=n.graph().root,o=O$(n,s,r,t);Gn.forEach(o.vs,function(a,l){n.node(a).order=l}),D$(n,r,o.vs)})}function Z2(e,t){Gn.forEach(t,function(r){Gn.forEach(r,function(n,s){e.node(n).order=s})})}var _e=et,q$=Dr.Graph,B$=Xt,W$={positionX:eq};function H$(e,t){var r={};function n(s,o){var a=0,l=0,c=s.length,d=_e.last(o);return _e.forEach(o,function(u,f){var p=V$(e,u),h=p?e.node(p).order:c;(p||u===d)&&(_e.forEach(o.slice(l,f+1),function(g){_e.forEach(e.predecessors(g),function(x){var _=e.node(x),v=_.order;(v<a||h<v)&&!(_.dummy&&e.node(g).dummy)&&Q4(r,x,g)})}),l=f+1,a=h)}),o}return _e.reduce(t,n),r}function U$(e,t){var r={};function n(o,a,l,c,d){var u;_e.forEach(_e.range(a,l),function(f){u=o[f],e.node(u).dummy&&_e.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&Q4(r,p,u)})})}function s(o,a){var l=-1,c,d=0;return _e.forEach(a,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,n(a,d,f,l,c),d=f,l=c)}n(a,d,a.length,c,o.length)}),a}return _e.reduce(t,s),r}function V$(e,t){if(e.node(t).dummy)return _e.find(e.predecessors(t),function(r){return e.node(r).dummy})}function Q4(e,t,r){if(t>r){var n=t;t=r,r=n}var s=e[t];s||(e[t]=s={}),s[r]=!0}function G$(e,t,r){if(t>r){var n=t;t=r,r=n}return _e.has(e[t],r)}function K$(e,t,r,n){var s={},o={},a={};return _e.forEach(t,function(l){_e.forEach(l,function(c,d){s[c]=c,o[c]=c,a[c]=d})}),_e.forEach(t,function(l){var c=-1;_e.forEach(l,function(d){var u=n(d);if(u.length){u=_e.sortBy(u,function(x){return a[x]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var g=u[p];o[d]===d&&c<a[g]&&!G$(r,d,g)&&(o[g]=d,o[d]=s[d]=s[g],c=a[g])}}})}),{root:s,align:o}}function Y$(e,t,r,n,s){var o={},a=X$(e,t,r,s),l=s?"borderLeft":"borderRight";function c(f,p){for(var h=a.nodes(),g=h.pop(),x={};g;)x[g]?f(g):(x[g]=!0,h.push(g),h=h.concat(p(g))),g=h.pop()}function d(f){o[f]=a.inEdges(f).reduce(function(p,h){return Math.max(p,o[h.v]+a.edge(h))},0)}function u(f){var p=a.outEdges(f).reduce(function(g,x){return Math.min(g,o[x.w]-a.edge(x))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(o[f]=Math.max(o[f],p))}return c(d,a.predecessors.bind(a)),c(u,a.successors.bind(a)),_e.forEach(n,function(f){o[f]=o[r[f]]}),o}function X$(e,t,r,n){var s=new q$,o=e.graph(),a=tq(o.nodesep,o.edgesep,n);return _e.forEach(t,function(l){var c;_e.forEach(l,function(d){var u=r[d];if(s.setNode(u),c){var f=r[c],p=s.edge(f,u);s.setEdge(f,u,Math.max(a(e,d,c),p||0))}c=d})}),s}function Q$(e,t){return _e.minBy(_e.values(t),function(r){var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return _e.forIn(r,function(o,a){var l=rq(e,a)/2;n=Math.max(o+l,n),s=Math.min(o-l,s)}),n-s})}function Z$(e,t){var r=_e.values(t),n=_e.min(r),s=_e.max(r);_e.forEach(["u","d"],function(o){_e.forEach(["l","r"],function(a){var l=o+a,c=e[l],d;if(c!==t){var u=_e.values(c);d=a==="l"?n-_e.min(u):s-_e.max(u),d&&(e[l]=_e.mapValues(c,function(f){return f+d}))}})})}function J$(e,t){return _e.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var s=_e.sortBy(_e.map(e,n));return(s[1]+s[2])/2})}function eq(e){var t=B$.buildLayerMatrix(e),r=_e.merge(H$(e,t),U$(e,t)),n={},s;_e.forEach(["u","d"],function(a){s=a==="u"?t:_e.values(t).reverse(),_e.forEach(["l","r"],function(l){l==="r"&&(s=_e.map(s,function(f){return _e.values(f).reverse()}));var c=(a==="u"?e.predecessors:e.successors).bind(e),d=K$(e,s,r,c),u=Y$(e,s,d.root,d.align,l==="r");l==="r"&&(u=_e.mapValues(u,function(f){return-f})),n[a+l]=u})});var o=Q$(e,n);return Z$(n,o),J$(n,e.graph().align)}function tq(e,t,r){return function(n,s,o){var a=n.node(s),l=n.node(o),c=0,d;if(c+=a.width/2,_e.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":d=-a.width/2;break;case"r":d=a.width/2;break}if(d&&(c+=r?d:-d),d=0,c+=(a.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,_e.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=r?d:-d),d=0,c}}function rq(e,t){return e.node(t).width}var wi=et,Z4=Xt,nq=W$.positionX,sq=oq;function oq(e){e=Z4.asNonCompoundGraph(e),iq(e),wi.forEach(nq(e),function(t,r){e.node(r).x=t})}function iq(e){var t=Z4.buildLayerMatrix(e),r=e.graph().ranksep,n=0;wi.forEach(t,function(s){var o=wi.max(wi.map(s,function(a){return e.node(a).height}));wi.forEach(s,function(a){e.node(a).y=n+o/2}),n+=o+r})}var Ee=et,J2=Xz,eS=pF,aq=LF,lq=Xt.normalizeRanks,cq=qF,uq=Xt.removeEmptyRanks,tS=UF,dq=QF,rS=JF,fq=z$,pq=sq,Qn=Xt,hq=Dr.Graph,mq=xq;function xq(e,t){var r=t&&t.debugTiming?Qn.time:Qn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return Cq(e)});r("  runLayout",function(){gq(n,r)}),r("  updateInputGraph",function(){vq(e,n)})})}function gq(e,t){t("    makeSpaceForEdgeLabels",function(){Eq(e)}),t("    removeSelfEdges",function(){Lq(e)}),t("    acyclic",function(){J2.run(e)}),t("    nestingGraph.run",function(){tS.run(e)}),t("    rank",function(){aq(Qn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){Tq(e)}),t("    removeEmptyRanks",function(){uq(e)}),t("    nestingGraph.cleanup",function(){tS.cleanup(e)}),t("    normalizeRanks",function(){lq(e)}),t("    assignRankMinMax",function(){Rq(e)}),t("    removeEdgeLabelProxies",function(){Aq(e)}),t("    normalize.run",function(){eS.run(e)}),t("    parentDummyChains",function(){cq(e)}),t("    addBorderSegments",function(){dq(e)}),t("    order",function(){fq(e)}),t("    insertSelfEdges",function(){zq(e)}),t("    adjustCoordinateSystem",function(){rS.adjust(e)}),t("    position",function(){pq(e)}),t("    positionSelfEdges",function(){Fq(e)}),t("    removeBorderNodes",function(){Dq(e)}),t("    normalize.undo",function(){eS.undo(e)}),t("    fixupEdgeLabelCoords",function(){Oq(e)}),t("    undoCoordinateSystem",function(){rS.undo(e)}),t("    translateGraph",function(){Iq(e)}),t("    assignNodeIntersects",function(){Pq(e)}),t("    reversePoints",function(){Mq(e)}),t("    acyclic.undo",function(){J2.undo(e)})}function vq(e,t){Ee.forEach(e.nodes(),function(r){var n=e.node(r),s=t.node(r);n&&(n.x=s.x,n.y=s.y,t.children(r).length&&(n.width=s.width,n.height=s.height))}),Ee.forEach(e.edges(),function(r){var n=e.edge(r),s=t.edge(r);n.points=s.points,Ee.has(s,"x")&&(n.x=s.x,n.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var yq=["nodesep","edgesep","ranksep","marginx","marginy"],bq={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},_q=["acyclicer","ranker","rankdir","align"],wq=["width","height"],jq={width:0,height:0},Sq=["minlen","weight","width","height","labeloffset"],kq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Nq=["labelpos"];function Cq(e){var t=new hq({multigraph:!0,compound:!0}),r=fx(e.graph());return t.setGraph(Ee.merge({},bq,dx(r,yq),Ee.pick(r,_q))),Ee.forEach(e.nodes(),function(n){var s=fx(e.node(n));t.setNode(n,Ee.defaults(dx(s,wq),jq)),t.setParent(n,e.parent(n))}),Ee.forEach(e.edges(),function(n){var s=fx(e.edge(n));t.setEdge(n,Ee.merge({},kq,dx(s,Sq),Ee.pick(s,Nq)))}),t}function Eq(e){var t=e.graph();t.ranksep/=2,Ee.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function Tq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),s=e.node(t.w),o={rank:(s.rank-n.rank)/2+n.rank,e:t};Qn.addDummyNode(e,"edge-proxy",o,"_ep")}})}function Rq(e){var t=0;Ee.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=Ee.max(t,n.maxRank))}),e.graph().maxRank=t}function Aq(e){Ee.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function Iq(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,s=0,o=e.graph(),a=o.marginx||0,l=o.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),r=Math.max(r,u+p/2),n=Math.min(n,f-h/2),s=Math.max(s,f+h/2)}Ee.forEach(e.nodes(),function(d){c(e.node(d))}),Ee.forEach(e.edges(),function(d){var u=e.edge(d);Ee.has(u,"x")&&c(u)}),t-=a,n-=l,Ee.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=n}),Ee.forEach(e.edges(),function(d){var u=e.edge(d);Ee.forEach(u.points,function(f){f.x-=t,f.y-=n}),Ee.has(u,"x")&&(u.x-=t),Ee.has(u,"y")&&(u.y-=n)}),o.width=r-t+a,o.height=s-n+l}function Pq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),s=e.node(t.w),o,a;r.points?(o=r.points[0],a=r.points[r.points.length-1]):(r.points=[],o=s,a=n),r.points.unshift(Qn.intersectRect(n,o)),r.points.push(Qn.intersectRect(s,a))})}function Oq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t);if(Ee.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Mq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function Dq(e){Ee.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),s=e.node(r.borderBottom),o=e.node(Ee.last(r.borderLeft)),a=e.node(Ee.last(r.borderRight));r.width=Math.abs(a.x-o.x),r.height=Math.abs(s.y-n.y),r.x=o.x+r.width/2,r.y=n.y+r.height/2}}),Ee.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function Lq(e){Ee.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function zq(e){var t=Qn.buildLayerMatrix(e);Ee.forEach(t,function(r){var n=0;Ee.forEach(r,function(s,o){var a=e.node(s);a.order=o+n,Ee.forEach(a.selfEdges,function(l){Qn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:a.rank,order:o+ ++n,e:l.e,label:l.label},"_se")}),delete a.selfEdges})})}function Fq(e){Ee.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),s=n.x+n.width/2,o=n.y,a=r.x-s,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:s+2*a/3,y:o-l},{x:s+5*a/6,y:o-l},{x:s+a,y:o},{x:s+5*a/6,y:o+l},{x:s+2*a/3,y:o+l}],r.label.x=r.x,r.label.y=r.y}})}function dx(e,t){return Ee.mapValues(Ee.pick(e,t),Number)}function fx(e){var t={};return Ee.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var ll=et,$q=Xt,qq=Dr.Graph,Bq={debugOrdering:Wq};function Wq(e){var t=$q.buildLayerMatrix(e),r=new qq({compound:!0,multigraph:!0}).setGraph({});return ll.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),ll.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),ll.forEach(t,function(n,s){var o="layer"+s;r.setNode(o,{rank:"same"}),ll.reduce(n,function(a,l){return r.setEdge(a,l,{style:"invis"}),l})}),r}var Hq="0.8.5",Uq={graphlib:Dr,layout:mq,debug:Bq,util:{time:Xt.time,notime:Xt.notime},version:Hq};const _c=nv(Uq),wc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},Vq={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},Gq=220,Kq=110;function nS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(s=>{const o=wc[s.type]||wc.task,l=s.type==="end"&&["blocked","abandoned"].includes(s.terminal_outcome)?Vq:o;return{id:s.node_id,type:"workflowNode",position:s._position||{x:0,y:0},data:{...s,config:l,isEntry:t.includes(s.node_id)}}}),n=(e.edges||[]).map(s=>{const o=s.non_advancing||!s.to_node_id,a=s.conditions&&s.conditions.length>0;let l=s.label||s.outcome;if(a){const c=s.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:s.edge_id,source:s.from_node_id,target:s.to_node_id||s.from_node_id,type:"smoothstep",animated:o,label:l,data:{...s},style:{stroke:o?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:o?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:s.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function jc(e,t,r="TB",n=Gq,s=Kq){const o=new _c.graphlib.Graph;return o.setDefaultEdgeLabel(()=>({})),o.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(a=>{o.setNode(a.id,{width:n,height:s})}),t.forEach(a=>{a.target!==a.source&&o.setEdge(a.source,a.target)}),_c.layout(o),e.map(a=>{const l=o.node(a.id);return l?{...a,position:{x:l.x-n/2,y:l.y-s/2}}:a})}function Yq(e,t){const r=new Set(t.map(o=>o.id||o.node_id));let n=1,s=`${e}_${n}`;for(;r.has(s);)n++,s=`${e}_${n}`;return s}function Xq(e,t,r){const n=new Set(r.map(a=>a.id||a.edge_id));let s=1,o=`${e}_to_${t}`;for(;n.has(o);)s++,o=`${e}_to_${t}_${s}`;return o}function Qq(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const Sc={action:{color:"#1d4ed8",bgColor:"#eff6ff",borderColor:"#3b82f6",label:"Action"},gate:{color:"#b45309",bgColor:"#fef3c7",borderColor:"#f59e0b",label:"Gate"},escalation:{color:"#b91c1c",bgColor:"#fee2e2",borderColor:"#ef4444",label:"Escalation"},parallel_fork:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Fork"},parallel_join:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Join"},start:{color:"#047857",bgColor:"#d1fae5",borderColor:"#10b981",label:"Start"},end:{color:"#374151",bgColor:"#f3f4f6",borderColor:"#6b7280",label:"End"}},kc={normal:{stroke:"#64748b",strokeWidth:2},error:{stroke:"#ef4444",strokeWidth:2,strokeDasharray:"6,3"},retry:{stroke:"#f97316",strokeWidth:2,strokeDasharray:"6,3",animated:!0},parallel:{stroke:"#8b5cf6",strokeWidth:2}},Zq=160,Jq=80;function e9({data:e}){const{config:t,showLineage:r}=e,n=e.type==="end",s=e.type==="start",o=r&&(e.dcw_ref||e.task_ref||e.operation_ref||e.gate_profile),a=e.component,l=e.output,c=a||l;return i.jsxs("div",{style:{background:t.bgColor,border:`2px solid ${t.borderColor}`,borderRadius:8,padding:"10px 14px",minWidth:260,maxWidth:360,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[!s&&i.jsx(yr,{type:"target",position:ce.Top,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}}),i.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:t.color,letterSpacing:"0.05em",marginBottom:4},children:t.label}),i.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e293b",lineHeight:"18px",marginBottom:6},children:e.label}),e.actor&&i.jsx("div",{style:{fontSize:11,color:"#4f46e5",fontWeight:500,marginBottom:4},children:e.actor}),c&&i.jsxs("div",{style:{marginTop:6,paddingTop:6,borderTop:"1px solid #e2e8f0",display:"flex",flexDirection:"column",gap:4},children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[i.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Component"}),i.jsx("span",{style:{fontSize:11,color:"#0d9488",fontWeight:500,lineHeight:1.4},children:a})]}),l&&i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[i.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Output"}),i.jsx("span",{style:{fontSize:11,color:"#7c3aed",fontWeight:500,lineHeight:1.4},children:l})]})]}),o&&i.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px dashed #cbd5e1"},children:[e.dcw_ref&&i.jsx(px,{label:"DCW",value:e.dcw_ref}),e.task_ref&&i.jsx(px,{label:"Task",value:e.task_ref}),e.operation_ref&&i.jsx(px,{label:"Op",value:e.operation_ref}),e.gate_profile&&i.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3},children:[i.jsx("span",{style:{fontWeight:600},children:"Gate:"})," ",Array.isArray(e.gate_profile)?e.gate_profile.join(" -> "):e.gate_profile]})]}),!n&&i.jsx(yr,{type:"source",position:ce.Bottom,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}})]})}function px({label:e,value:t}){const r=t.length>30?"..."+t.slice(-27):t;return i.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3,fontFamily:"monospace"},title:t,children:[i.jsxs("span",{style:{fontWeight:600,fontFamily:"inherit"},children:[e,":"]})," ",r]})}const J4=m.memo(e9),t9={archWorkflowNode:J4};function r9(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const r=[...e].sort((s,o)=>(s.step||s.order||0)-(o.step||o.order||0)).map((s,o)=>({node_id:`step_${o+1}`,type:"action",label:s.action||`Step ${o+1}`,actor:s.actor,description:s.description,inputs:s.inputs,outputs:s.outputs,notes:s.notes})),n=[];for(let s=0;s<r.length-1;s++)n.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:r[s].node_id,to_node_id:r[s+1].node_id,type:"normal"});return{nodes:r,edges:n}}function n9(e,t){const r=e.map(o=>{const a=Sc[o.type]||Sc.action;return{id:o.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...o,config:a}}}),n=t.map(o=>{const a=o.type||"normal",l=kc[a]||kc.normal;return{id:o.edge_id,source:o.from_node_id,target:o.to_node_id,type:"smoothstep",animated:l.animated||!1,label:o.label,style:{stroke:l.stroke,strokeWidth:l.strokeWidth,strokeDasharray:l.strokeDasharray},labelStyle:{fontSize:9,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:l.stroke}}});return{nodes:jc(r,n,"TB",Zq,Jq),edges:n}}function sS({block:e}){const{data:t}=e;if(!t||!t.name)return null;const[r,n]=m.useState(!1),{graphNodes:s,graphEdges:o,isV1:a}=m.useMemo(()=>{const d=Array.isArray(t.nodes)&&t.nodes.length>0,u=Array.isArray(t.steps)&&t.steps.length>0;if(d)return{graphNodes:t.nodes,graphEdges:t.edges||[],isV1:!1};if(u){const{nodes:f,edges:p}=r9(t.steps);return{graphNodes:f,graphEdges:p,isV1:!0}}return{graphNodes:[],graphEdges:[],isV1:!1}},[t.nodes,t.edges,t.steps]),l=m.useMemo(()=>s.length===0?null:n9(s,o),[s,o]),c=r?600:350;return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.description&&i.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),t.trigger&&i.jsxs("p",{style:{margin:"0 0 8px",fontSize:13,color:"#6b7280",fontStyle:"italic"},children:["Trigger: ",t.trigger]}),l&&l.nodes.length>0?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{height:c,border:"1px solid #e5e7eb",borderRadius:6,background:"#ffffff",overflow:"hidden",transition:"height 0.2s ease"},children:i.jsx(Mo,{children:i.jsx(ja,{nodes:l.nodes,edges:l.edges,nodeTypes:t9,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!1,fitView:!0,fitViewOptions:{padding:.2},proOptions:{hideAttribution:!0},minZoom:.3,maxZoom:1.5})})}),i.jsx("button",{onClick:()=>n(d=>!d),style:{marginTop:6,padding:"3px 10px",fontSize:11,color:"#6366f1",background:"none",border:"1px solid #e5e7eb",borderRadius:4,cursor:"pointer"},children:r?"Collapse":"Expand"})]}):i.jsx("p",{style:{margin:0,fontSize:13,color:"#9ca3af",fontStyle:"italic"},children:"No workflow steps defined."})]})}function s9({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.acceptance_criteria)?t.acceptance_criteria:[];return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.target&&i.jsx("p",{style:{margin:"0 0 6px",fontSize:13,color:"#475569"},children:t.target}),t.rationale&&i.jsx("p",{style:{margin:"0 0 8px",fontSize:12,color:"#6b7280",fontStyle:"italic"},children:t.rationale}),r.length>0&&i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Acceptance Criteria"}),i.jsx("ul",{style:{margin:0,paddingLeft:18},children:r.map((n,s)=>i.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:n},s))})]})]})}function o9({block:e}){const{data:t}=e,r=(t==null?void 0:t.name)||(t==null?void 0:t.entity_name);if(!t||!r)return null;const n=Array.isArray(t.fields)?t.fields:[],s=Array.isArray(t.primary_keys)?t.primary_keys:[],o=Array.isArray(t.relationships)?t.relationships:[];return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:r}),t.description&&i.jsx("p",{style:{margin:"0 0 10px",fontSize:13,color:"#475569"},children:t.description}),n.length>0&&i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"2px solid #e2e8f0"},children:[i.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Field"}),i.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Type"}),i.jsx("th",{style:{textAlign:"center",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Required"}),i.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Notes"})]})}),i.jsx("tbody",{children:n.map((a,l)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[i.jsxs("td",{style:{padding:"4px 8px",fontFamily:"monospace",color:"#1e293b",fontWeight:s.includes(a.name)?600:400},children:[a.name,s.includes(a.name)?" (PK)":""]}),i.jsx("td",{style:{padding:"4px 8px",color:"#6366f1",fontFamily:"monospace"},children:a.type}),i.jsx("td",{style:{padding:"4px 8px",textAlign:"center"},children:a.required?"Yes":"No"}),i.jsx("td",{style:{padding:"4px 8px",color:"#6b7280"},children:Array.isArray(a.notes)?a.notes.join("; "):a.notes||a.description||""})]},l))})]}),o.length>0&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Relationships"}),i.jsx("ul",{style:{margin:0,paddingLeft:18},children:o.map((a,l)=>i.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:typeof a=="string"?a:`${a.type||""} ${a.target||""} ${a.description||""}`.trim()},l))})]})]})}function i9({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.endpoints)?t.endpoints:[],n={GET:{bg:"#d1fae5",color:"#065f46"},POST:{bg:"#dbeafe",color:"#1e40af"},PUT:{bg:"#fef3c7",color:"#92400e"},PATCH:{bg:"#fef3c7",color:"#92400e"},DELETE:{bg:"#fee2e2",color:"#991b1b"}};return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[i.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.type&&i.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#f0fdf4",color:"#166534",borderRadius:4},children:t.type}),t.protocol&&i.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#eff6ff",color:"#1e40af",borderRadius:4},children:t.protocol})]}),t.description&&i.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),(t.authentication||t.authorization)&&i.jsxs("div",{style:{marginBottom:8,fontSize:12,color:"#6b7280"},children:[t.authentication&&i.jsxs("span",{children:["Auth: ",t.authentication]}),t.authentication&&t.authorization&&i.jsx("span",{children:" | "}),t.authorization&&i.jsxs("span",{children:["Authz: ",t.authorization]})]}),r.length>0&&i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.map((s,o)=>{const a=n[s.method]||{bg:"#f3f4f6",color:"#374151"};return i.jsxs("div",{style:{padding:"8px 10px",background:"#ffffff",borderRadius:6,border:"1px solid #e5e7eb"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 6px",borderRadius:3,background:a.bg,color:a.color,fontFamily:"monospace"},children:s.method}),i.jsx("code",{style:{fontSize:13,color:"#1e293b"},children:s.path})]}),s.description&&i.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:s.description})]},o)})})]})}function a9({block:e}){const{type:t,data:r}=e;return i.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[i.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),i.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function l9({block:e}){const{data:t}=e,r=t.items||[],[n,s]=m.useState({});if(r.length===0)return null;const o=a=>{s(l=>({...l,[a]:!l[a]}))};return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((a,l)=>{const c=n[l],d=a.why_it_matters||a.impact_if_unresolved;return i.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[i.jsxs("button",{onClick:()=>d&&o(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[i.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:a.question||a.value||a.text||"Unknown"}),d&&i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:i.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&i.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[a.why_it_matters&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),i.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.why_it_matters})]}),a.impact_if_unresolved&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),i.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.impact_if_unresolved})]})]})]},l)})})}function c9({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return i.jsxs("div",{style:{marginBottom:12},children:[r&&i.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&i.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function u9({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:s}=t;return i.jsxs("div",{style:{marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[i.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&i.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),s&&i.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s})]})}function d9({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,s=r&&r.length>0,o=n&&n.length>0;return!s&&!o?null:i.jsxs("div",{style:{marginBottom:12},children:[s&&i.jsxs("div",{style:{marginBottom:o?16:0},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((a,l)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#f59e0b"},children:""}),i.jsx("span",{children:a})]},l))})]}),o&&i.jsxs("div",{children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((a,l)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#3b82f6"},children:""}),i.jsx("span",{children:a})]},l))})]})]})}function f9({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:s=[]}=t,o=r&&r.length>0,a=n&&n.length>0,l=s&&s.length>0;return!o&&!a&&!l?null:i.jsxs("div",{style:{marginBottom:12},children:[o&&i.jsxs("div",{style:{marginBottom:a||l?16:0},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#3b82f6"},children:""}),i.jsx("span",{children:c})]},d))})]}),a&&i.jsxs("div",{style:{marginBottom:l?16:0},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#f59e0b"},children:""}),i.jsx("span",{children:c})]},d))})]}),l&&i.jsxs("div",{children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:s.map((c,d)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#6b7280"},children:""}),i.jsx("span",{children:c})]},d))})]})]})}function p9({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:s}=t,a={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return i.jsxs("div",{style:{marginBottom:12},children:[r&&i.jsx("div",{style:{marginBottom:12},children:i.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:a.bg,color:a.text},children:r})}),n&&i.jsx("p",{style:{margin:0,marginBottom:s?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),s&&i.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:i.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",s]})})]})}const h9={"schema:ParagraphBlockV1":W8,"schema:StringListBlockV1":Zb,"schema:IndicatorBlockV1":U8,"schema:OpenQuestionV1":LE,"schema:OpenQuestionsBlockV1":V8,"schema:RisksBlockV1":Jb,"schema:DependenciesBlockV1":Jb,"schema:ArchComponentBlockV1":Y8,"schema:WorkflowBlockV1":sS,"schema:WorkflowBlockV2":sS,"schema:QualityAttributeBlockV1":s9,"schema:DataModelBlockV1":o9,"schema:InterfaceBlockV1":i9,"schema:SummaryBlockV1":G8,"schema:StorySummaryBlockV1":K8,"schema:StoriesBlockV1":Zb,"schema:UnknownsBlockV1":l9,"schema:IntakeSummaryBlockV1":c9,"schema:IntakeProjectTypeBlockV1":u9,"schema:IntakeConstraintsBlockV1":d9,"schema:IntakeOpenGapsBlockV1":f9,"schema:IntakeOutcomeBlockV1":p9};function m9(e){return h9[e]||a9}function x9(e,t){const r=m9(e.type);return i.jsx(r,{block:e},e.key||t)}function e3({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:s=""}){var _;const[o,a]=m.useState(new Set(((_=e==null?void 0:e.sections)==null?void 0:_.map(v=>v.section_id))||[]));if(!e)return i.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return i.jsx(_9,{title:l,content:e.raw_content,reason:u.reason});const f=v=>{a(y=>{const b=new Set(y);return b.has(v)?b.delete(v):b.add(v),b})},p=t==="compact"||t==="sidecar",g=t==="sidecar"?d.filter(v=>v.viewer_tab==="overview"||!v.viewer_tab):d,x=(()=>{if(!l)return"Document";const v=l.indexOf(": ");return v>-1?l.slice(v+2):l})();return i.jsxs("div",{className:s,children:[t==="full"&&!r&&i.jsxs("div",{style:{marginBottom:24},children:[i.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:x}),c&&i.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:g.map(v=>i.jsx(b9,{section:v,isExpanded:o.has(v.section_id),onToggle:()=>f(v.section_id),onClick:()=>n==null?void 0:n(v),variant:t},v.section_id))}),g.length===0&&i.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function g9(e){if(!e||!e.data)return"";const{type:t,data:r}=e;switch(t){case"schema:ParagraphBlockV1":return r.text||"";case"schema:StringListBlockV1":return(r.items||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.text||""}`).join(`
`);case"schema:IndicatorBlockV1":return`${r.label||""}: ${r.value||""}`;case"schema:OpenQuestionV1":return`Q: ${r.question||""}
A: ${r.answer||"No answer yet"}`;case"schema:OpenQuestionsBlockV1":return(r.questions||[]).map(n=>`Q: ${n.question||""}
A: ${n.answer||"No answer yet"}`).join(`

`);case"schema:RisksBlockV1":case"schema:DependenciesBlockV1":return(r.items||[]).map(n=>`- ${n.title||n.name||""}: ${n.description||""}`).join(`
`);case"schema:SummaryBlockV1":return r.summary||r.text||"";case"schema:EpicSummaryBlockV1":case"schema:StorySummaryBlockV1":return[r.title||"",r.description||r.summary||""].filter(Boolean).join(`

`);case"schema:UnknownsBlockV1":return(r.items||r.unknowns||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.description||n.text||""}`).join(`
`);case"schema:IntakeSummaryBlockV1":return r.summary||"";case"schema:IntakeProjectTypeBlockV1":return`Project Type: ${r.project_type||r.type||""}`;case"schema:IntakeConstraintsBlockV1":return(r.constraints||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOpenGapsBlockV1":return(r.gaps||r.open_gaps||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOutcomeBlockV1":return`Outcome: ${r.outcome||r.status||""}`;default:return r.text?r.text:r.content?r.content:r.summary?r.summary:r.items&&Array.isArray(r.items)?r.items.map(n=>typeof n=="string"?`- ${n}`:`- ${JSON.stringify(n)}`).join(`
`):""}}function v9({size:e=14}){return i.jsxs("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"5",y:"5",width:"9",height:"9",rx:"1"}),i.jsx("path",{d:"M2 11V3a1 1 0 011-1h8"})]})}function y9({size:e=14}){return i.jsx("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("path",{d:"M3 8l4 4 6-7"})})}function b9({section:e,isExpanded:t,onToggle:r,onClick:n,variant:s}){const[o,a]=m.useState(!1),{section_id:l,title:c,description:d,blocks:u=[],sidecar_max_items:f}=e,p=s==="compact"||s==="sidecar",h=s==="sidecar";if(u.length===0)return null;const g=async v=>{v.stopPropagation();const y=u.map(g9).filter(Boolean).join(`

`);try{await navigator.clipboard.writeText(y),a(!0),setTimeout(()=>a(!1),2e3)}catch(b){console.error("Failed to copy:",b)}},x=h&&f&&u.length>f?u.slice(0,f):u,_=h&&f&&u.length>f;return i.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[i.jsxs("button",{onClick:r,style:{width:"100%",padding:p?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[i.jsxs("div",{children:[i.jsxs("h3",{style:{margin:0,fontSize:p?13:15,fontWeight:600,color:"#111827"},children:[c,_&&i.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",f," of ",u.length,")"]})]}),d&&!p&&i.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:d})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("button",{onClick:g,title:o?"Copied!":"Copy section",style:{padding:4,background:"none",border:"none",cursor:"pointer",color:o?"#10b981":"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,transition:"color 0.2s"},children:o?i.jsx(y9,{size:14}):i.jsx(v9,{size:14})}),i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:i.jsx("path",{d:"M4 6l4 4 4-4"})})]})]}),t&&i.jsxs("div",{style:{padding:p?12:18},children:[x.map((v,y)=>x9(v,y)),_&&i.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",u.length-f," more in full view"]})]})]})}function _9({title:e,content:t,reason:r}){return i.jsxs("div",{children:[i.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),i.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:i.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function w9({workflow:e,onClose:t,spawnedDocuments:r}){var s,o,a,l;m.useEffect(()=>{const c=d=>{d.key==="Escape"&&t()};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t]);const n=((s=e==null?void 0:e.block)==null?void 0:s.data)||{};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-end",style:{background:"rgba(0,0,0,0.4)"},onClick:c=>c.target===c.currentTarget&&t(),children:i.jsxs("div",{className:"h-full w-full max-w-2xl flex flex-col shadow-2xl",style:{background:"#ffffff"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-base font-semibold",style:{color:"#1e293b"},children:"Workflow Audit"}),i.jsx("p",{className:"text-sm",style:{color:"#64748b"},children:e.name})]}),i.jsx("button",{onClick:t,className:"p-1.5 rounded hover:bg-gray-200 transition-colors",children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-auto p-4",style:{background:"#f8fafc"},onWheel:c=>c.stopPropagation(),children:[i.jsxs("div",{className:"mb-4 flex gap-4",children:[i.jsx(hx,{label:"Nodes",value:((o=n.nodes)==null?void 0:o.length)||((a=n.steps)==null?void 0:a.length)||0}),i.jsx(hx,{label:"Edges",value:((l=n.edges)==null?void 0:l.length)||0}),n.trigger&&i.jsx(hx,{label:"Trigger",value:n.trigger,isText:!0})]}),(n.nodes||n.steps)&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:n.nodes?"Nodes":"Steps"}),i.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f1f5f9"},children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"ID"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Station"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Label"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Actor"})]})}),i.jsx("tbody",{children:(n.nodes||n.steps).map((c,d)=>i.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[i.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.node_id||`step_${d+1}`}),i.jsx("td",{className:"px-3 py-2",children:i.jsx(oS,{type:c.type||"action"})}),i.jsx("td",{className:"px-3 py-2",children:c.station?i.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:"#f0fdf4",color:"#166534"},children:c.station.label}):"-"}),i.jsx("td",{className:"px-3 py-2",style:{color:"#1e293b"},children:c.label||c.action||"-"}),i.jsx("td",{className:"px-3 py-2",style:{color:"#64748b"},children:c.actor||"-"})]},c.node_id||d))})]})})]}),n.edges&&n.edges.length>0&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:"Edges"}),i.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f1f5f9"},children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"From"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"To"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Label"})]})}),i.jsx("tbody",{children:n.edges.map((c,d)=>i.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[i.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.from_node_id}),i.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.to_node_id}),i.jsx("td",{className:"px-3 py-2",children:i.jsx(j9,{type:c.type||"normal"})}),i.jsx("td",{className:"px-3 py-2",style:{color:"#64748b"},children:c.label||"-"})]},c.edge_id||d))})]})})]}),r&&r.length>0&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:"Spawned Documents"}),i.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f1f5f9"},children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Idempotency Key"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Title"})]})}),i.jsx("tbody",{children:r.map((c,d)=>i.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[i.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.instance_id||"-"}),i.jsx("td",{className:"px-3 py-2",children:i.jsx(oS,{type:c.doc_type_id||"epic"})}),i.jsx("td",{className:"px-3 py-2",style:{color:"#1e293b"},children:c.title||c.name||"-"})]},c.instance_id||d))})]})})]}),i.jsxs("details",{className:"rounded border",style:{borderColor:"#e2e8f0"},children:[i.jsx("summary",{className:"px-3 py-2 cursor-pointer text-sm font-medium",style:{background:"#f1f5f9",color:"#64748b"},children:"Raw JSON"}),i.jsx("div",{className:"p-3 overflow-auto",style:{background:"#ffffff"},children:i.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap",style:{color:"#374151",lineHeight:1.5},children:JSON.stringify(n,null,2)})})]})]})]})})}function hx({label:e,value:t,isText:r=!1}){return i.jsxs("div",{className:"px-3 py-1.5 rounded",style:{background:"#e0e7ff",color:"#4338ca"},children:[i.jsxs("span",{className:"text-xs font-medium",children:[e,": "]}),i.jsx("span",{className:`text-sm font-semibold ${r?"":"tabular-nums"}`,children:t})]})}function oS({type:e}){const t={start:{bg:"#dcfce7",color:"#166534"},end:{bg:"#fee2e2",color:"#991b1b"},action:{bg:"#dbeafe",color:"#1e40af"},gate:{bg:"#fef3c7",color:"#92400e"},decision:{bg:"#fef3c7",color:"#92400e"},error:{bg:"#fee2e2",color:"#991b1b"}},r=t[e]||t.action;return i.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:r.bg,color:r.color},children:e})}function j9({type:e}){const t={normal:{bg:"#f1f5f9",color:"#64748b"},error:{bg:"#fee2e2",color:"#991b1b"},retry:{bg:"#fef3c7",color:"#92400e"},conditional:{bg:"#e0e7ff",color:"#4338ca"}},r=t[e]||t.normal;return i.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:r.bg,color:r.color},children:e})}const S9={archWorkflowNode:J4},k9=300,N9=140;function C9(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const r=[...e].sort((s,o)=>(s.step||s.order||0)-(o.step||o.order||0)).map((s,o)=>({...s,node_id:`step_${o+1}`,type:s.type||"action",label:s.action||s.label||`Step ${o+1}`})),n=[];for(let s=0;s<r.length-1;s++)n.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:r[s].node_id,to_node_id:r[s+1].node_id,type:"normal"});return{nodes:r,edges:n}}function E9(e,t,r=!1){const n=e.map(a=>{const l=Sc[a.type]||Sc.action;return{id:a.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...a,config:l,showLineage:r}}}),s=t.map(a=>{const l=a.type||"normal",c=kc[l]||kc.normal;return{id:a.edge_id,source:a.from_node_id,target:a.to_node_id,type:"smoothstep",animated:c.animated||!1,label:a.label,style:{stroke:c.stroke,strokeWidth:c.strokeWidth,strokeDasharray:c.strokeDasharray},labelStyle:{fontSize:10,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:c.stroke}}});return{nodes:jc(n,s,"TB",k9,N9),edges:s}}function T9({workflows:e}){var u;const[t,r]=m.useState(((u=e[0])==null?void 0:u.id)||null),[n,s]=m.useState(!1),[o,a]=m.useState(!1),l=e.find(f=>f.id===t),c=m.useMemo(()=>{var _;if(!((_=l==null?void 0:l.block)!=null&&_.data))return null;const f=l.block.data,p=Array.isArray(f.nodes)&&f.nodes.length>0,h=Array.isArray(f.steps)&&f.steps.length>0;let g,x;if(p)g=f.nodes,x=f.edges||[];else if(h){const v=C9(f.steps);g=v.nodes,x=v.edges}else return null;return E9(g,x,n)},[l,n]),d=f=>{const p=e.findIndex(h=>h.id===t);f.key==="ArrowDown"&&p<e.length-1?(f.preventDefault(),r(e[p+1].id)):f.key==="ArrowUp"&&p>0&&(f.preventDefault(),r(e[p-1].id))};return i.jsxs("div",{className:"flex h-full",onKeyDown:d,tabIndex:0,children:[i.jsx("div",{className:"flex-shrink-0 border-r overflow-y-auto",style:{width:220,background:"#f8fafc",borderColor:"#e2e8f0"},onWheel:f=>f.stopPropagation(),children:i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#64748b"},children:["Workflows (",e.length,")"]}),e.map(f=>{const p=f.id===t;return i.jsxs("button",{onClick:()=>r(f.id),className:"w-full text-left p-2.5 rounded-md mb-1 transition-colors",style:{background:p?"#eef2ff":"transparent",borderLeft:p?"3px solid #4f46e5":"3px solid transparent"},children:[i.jsx("div",{className:"text-sm font-medium truncate",style:{color:p?"#4f46e5":"#1e293b"},children:f.name}),i.jsxs("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:[f.nodeCount," steps"]})]},f.id)})]})}),i.jsx("div",{className:"flex-1 flex flex-col min-w-0",children:l?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-b",style:{borderColor:"#e2e8f0"},children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold",style:{color:"#1e293b"},children:l.name}),l.description&&i.jsx("p",{className:"text-sm mt-0.5",style:{color:"#64748b"},children:l.description}),l.trigger&&i.jsxs("p",{className:"text-sm mt-1 italic",style:{color:"#9ca3af"},children:["Trigger: ",l.trigger]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>s(f=>!f),className:"px-3 py-1.5 text-xs font-medium rounded transition-colors",style:{background:n?"#eef2ff":"#f1f5f9",color:n?"#4f46e5":"#64748b",border:`1px solid ${n?"#c7d2fe":"#e2e8f0"}`},children:n?"Hide Lineage":"Show Lineage"}),i.jsx("button",{onClick:()=>a(!0),className:"px-3 py-1.5 text-xs font-medium rounded transition-colors",style:{background:"#f1f5f9",color:"#64748b",border:"1px solid #e2e8f0"},children:"Audit"})]})]})}),i.jsx("div",{className:"flex-1 min-h-0",style:{background:"#ffffff"},children:c&&c.nodes.length>0?i.jsx(Mo,{children:i.jsx(ja,{nodes:c.nodes,edges:c.edges,nodeTypes:S9,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!0,fitView:!0,fitViewOptions:{padding:.15},proOptions:{hideAttribution:!0},minZoom:.2,maxZoom:2})}):i.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"No workflow steps defined"})})]}):i.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"Select a workflow from the list"})}),o&&l&&i.jsx(w9,{workflow:l,onClose:()=>a(!1)})]})}function R9({components:e}){var a,l,c,d;const[t,r]=m.useState(((a=e[0])==null?void 0:a.id)||null),n=e.find(u=>u.id===t),s=u=>{const f=e.findIndex(p=>p.id===t);u.key==="ArrowDown"&&f<e.length-1?(u.preventDefault(),r(e[f+1].id)):u.key==="ArrowUp"&&f>0&&(u.preventDefault(),r(e[f-1].id))},o=(u,f)=>({fontSize:12,padding:"3px 10px",background:u,color:f,borderRadius:4,fontWeight:500});return i.jsxs("div",{className:"flex h-full",onKeyDown:s,tabIndex:0,children:[i.jsx("div",{className:"flex-shrink-0 border-r overflow-y-auto",style:{width:220,background:"#f8fafc",borderColor:"#e2e8f0"},onWheel:u=>u.stopPropagation(),children:i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#64748b"},children:["Components (",e.length,")"]}),e.map(u=>{const f=u.id===t;return i.jsxs("button",{onClick:()=>r(u.id),className:"w-full text-left p-2.5 rounded-md mb-1 transition-colors",style:{background:f?"#eef2ff":"transparent",borderLeft:f?"3px solid #4f46e5":"3px solid transparent"},children:[i.jsx("div",{className:"text-sm font-medium truncate",style:{color:f?"#4f46e5":"#1e293b"},children:u.name}),u.layer&&i.jsx("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:u.layer})]},u.id)})]})}),i.jsx("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto",onWheel:u=>u.stopPropagation(),children:n?i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h2",{className:"text-xl font-semibold",style:{color:"#1e293b"},children:n.name}),n.layer&&i.jsx("span",{style:o("#f0fdf4","#166534"),children:n.layer}),n.mvpPhase&&i.jsx("span",{style:o("#eff6ff","#1e40af"),children:n.mvpPhase})]}),n.purpose&&i.jsx("p",{className:"text-base",style:{color:"#475569",lineHeight:1.6},children:n.purpose})]}),n.technology&&i.jsx(cl,{title:"Technology",children:i.jsx("p",{style:{color:"#374151",fontSize:14},children:n.technology})}),((l=n.responsibilities)==null?void 0:l.length)>0&&i.jsx(cl,{title:"Responsibilities",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:n.responsibilities.map((u,f)=>i.jsx("li",{style:{color:"#374151",fontSize:14},children:u},f))})}),((c=n.interfaces)==null?void 0:c.length)>0&&i.jsx(cl,{title:"Interfaces",children:i.jsx("div",{className:"flex flex-wrap gap-2",children:n.interfaces.map((u,f)=>i.jsx("span",{style:o("#e0e7ff","#3730a3"),children:u},f))})}),((d=n.dependencies)==null?void 0:d.length)>0&&i.jsx(cl,{title:"Dependencies",children:i.jsx("div",{className:"flex flex-wrap gap-2",children:n.dependencies.map((u,f)=>i.jsx("span",{style:o("#fef3c7","#92400e"),children:u},f))})})]}):i.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"Select a component from the list"})})]})}function cl({title:e,children:t}){return i.jsxs("div",{className:"mb-5",children:[i.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#6b7280"},children:e}),t]})}function A9({renderModel:e,projectId:t,projectCode:r,docTypeId:n,executionId:s,docTypeName:o,onClose:a}){const[l,c]=m.useState(null),{tabDefs:d,tabSections:u,isRawContentMode:f}=m.useMemo(()=>{var P,R;const S=(P=e==null?void 0:e.rendering_config)==null?void 0:P.detail_html,w=e==null?void 0:e.information_architecture,A=(e==null?void 0:e.sections)||[],E=e==null?void 0:e.raw_content;if(!(S!=null&&S.tabs)||!(w!=null&&w.sections))return{tabDefs:[{id:"overview",label:"Overview",sections:[]}],tabSections:{overview:A},isRawContentMode:!1};const O={};if(w.sections.forEach(D=>{O[D.id]={binds:D.binds||[],label:D.label||D.id}}),A.length===0&&E&&typeof E=="object"){const D=new Set;if(w.sections.forEach(M=>(M.binds||[]).forEach(F=>D.add(F))),[...D].some(M=>E[M]!==void 0&&E[M]!==null)){const M={};return S.tabs.forEach(F=>{const q=[];(F.sections||[]).forEach(H=>{const V=O[H];V&&V.binds.forEach(Z=>{const B=E[Z];B!=null&&q.push({fieldName:Z,label:V.label,data:B})})}),M[F.id]=q}),{tabDefs:S.tabs,tabSections:M,isRawContentMode:!0}}const I=E.raw===!0&&typeof E.content=="string"?E.content:null;if(I){const M=((R=S.tabs[0])==null?void 0:R.id)||"overview",F={};return S.tabs.forEach(q=>{F[q.id]=[]}),F[M]=[{fieldName:"_fallback",label:"Content",data:I}],{tabDefs:S.tabs,tabSections:F,isRawContentMode:!0}}}const z={};S.tabs.forEach(D=>{(D.sections||[]).forEach(L=>{const I=O[L];I&&I.binds.forEach(M=>{z[M]=D.id})})});const k={};return S.tabs.forEach(D=>{k[D.id]=[]}),A.forEach(D=>{const L=D.section_id,I=z[L]||"overview";k[I]?k[I].push(D):k.overview&&k.overview.push(D)}),{tabDefs:S.tabs,tabSections:k,isRawContentMode:!1}},[e]),p=l||(d.length>0?d[0].id:"overview"),h=m.useMemo(()=>{if(f){const E=(u.workflows||[]).find(z=>z.fieldName==="workflows"),O=E==null?void 0:E.data;return!Array.isArray(O)||!O.length?[]:O.map((z,k)=>{var P,R;return{id:z.id||`wf-${k}`,name:z.name||`Workflow ${k+1}`,description:z.description,trigger:z.trigger,nodeCount:((P=z.nodes)==null?void 0:P.length)||((R=z.steps)==null?void 0:R.length)||0,rawItem:z}})}const S=u.workflows||[];if(!S.length)return[];const w=S[0];return w!=null&&w.blocks?w.blocks.map((A,E)=>{var O,z,k,P,R,D,L;return{id:A.block_id||`wf-${E}`,name:((O=A.data)==null?void 0:O.name)||`Workflow ${E+1}`,description:(z=A.data)==null?void 0:z.description,trigger:(k=A.data)==null?void 0:k.trigger,nodeCount:((R=(P=A.data)==null?void 0:P.nodes)==null?void 0:R.length)||((L=(D=A.data)==null?void 0:D.steps)==null?void 0:L.length)||0,block:A}}):[]},[u.workflows,f]),g=m.useMemo(()=>{if(f){const E=(u.components||[]).find(z=>z.fieldName==="components"),O=E==null?void 0:E.data;return!Array.isArray(O)||!O.length?[]:O.map((z,k)=>({id:z.id||`comp-${k}`,name:z.name||`Component ${k+1}`,purpose:z.purpose,layer:z.layer,mvpPhase:z.mvp_phase,technology:z.technology||(Array.isArray(z.technology_choices)?z.technology_choices.join(", "):null),interfaces:z.interfaces||[],dependencies:z.dependencies||z.depends_on_components||[],responsibilities:z.responsibilities||[],rawItem:z}))}const S=u.components||[];if(!S.length)return[];const w=S[0];return w!=null&&w.blocks?w.blocks.map((A,E)=>{const O=A.data||{};return{id:A.block_id||`comp-${E}`,name:O.name||`Component ${E+1}`,purpose:O.purpose,layer:O.layer,mvpPhase:O.mvp_phase,technology:O.technology||(Array.isArray(O.technology_choices)?O.technology_choices.join(", "):null),interfaces:O.interfaces||[],dependencies:O.dependencies||O.depends_on_components||[],responsibilities:O.responsibilities||[],block:A}}):[]},[u.components,f]),x=m.useMemo(()=>d.map(S=>{var z,k;const w=u[S.id]||[],A=S.id==="workflows"||S.id==="components",E=S.id==="workflows"?h.length:S.id==="components"?g.length:null;if(f){const P=A?E>0:w.length>0;return{id:S.id,label:S.label,count:A?E||null:w.length||null,disabled:!P}}const O=((k=(z=w[0])==null?void 0:z.blocks)==null?void 0:k.length)||null;return{id:S.id,label:S.label,count:A?E||null:O,disabled:S.id!=="overview"&&!w.length}}),[d,u,h,g,f]),_=(e==null?void 0:e.metadata)||{},v=s?`/admin?execution=${s}`:"/admin",y=(()=>{const S=(e==null?void 0:e.title)||"Document",w=S.indexOf(": ");return w>-1?S.slice(w+2):S})(),b=S=>{if(!S)return null;try{return new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},j=b(_.created_at),N=b(_.updated_at),T=_.lifecycle_state,C=S=>{if(!e)return null;const w=u[S]||[];return{...e,sections:w}};return i.jsxs("div",{className:"flex flex-col h-full",style:{background:"#ffffff"},children:[i.jsxs("div",{className:"px-5 py-3 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:4},children:[r&&i.jsx("a",{href:v,target:"_blank",rel:"noopener noreferrer",title:s?`View execution ${s}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:r}),i.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:o||(n==null?void 0:n.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase()))||"Document"}),T&&i.jsx("span",{style:{padding:"2px 8px",background:T==="complete"?"#dcfce7":"#fef3c7",color:T==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:T})]}),i.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"#111827",lineHeight:1.3},children:y}),j&&i.jsxs("div",{style:{marginTop:2,fontSize:12,color:"#9ca3af"},children:["Generated ",j,N&&N!==j&&i.jsxs("span",{children:["  Updated ",N]})]})]}),i.jsx("div",{className:"flex items-center gap-1 px-4 border-b",style:{background:"#ffffff",borderColor:"#e2e8f0",minHeight:40},children:x.map(S=>{const w=p===S.id;return i.jsxs("button",{onClick:()=>!S.disabled&&c(S.id),disabled:S.disabled,className:"relative px-4 py-2 text-sm font-medium transition-colors",style:{color:w?"#4f46e5":S.disabled?"#9ca3af":"#64748b",background:"transparent",border:"none",cursor:S.disabled?"not-allowed":"pointer"},children:[S.label,S.count!==null&&i.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs rounded-full",style:{background:w?"#eef2ff":"#f1f5f9",color:w?"#4f46e5":"#64748b"},children:S.count}),w&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"#4f46e5"}})]},S.id)})}),i.jsx("div",{className:"flex-1 overflow-hidden",style:{minHeight:0},children:p==="workflows"&&h.length>0?i.jsx(T9,{workflows:h}):p==="components"&&g.length>0?i.jsx(R9,{components:g}):f?i.jsx(P9,{fields:u[p]||[]}):i.jsx(I9,{renderModel:C(p),sections:u[p]||[]})},p)]})}function I9({renderModel:e,sections:t}){return i.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:r=>r.stopPropagation(),children:e&&t.length>0?i.jsx(e3,{renderModel:e,variant:"full",hideHeader:!0}):i.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})})}function P9({fields:e}){return!e||e.length===0?i.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:t=>t.stopPropagation(),children:i.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})}):i.jsx("div",{className:"h-full overflow-y-auto p-6 space-y-6",onWheel:t=>t.stopPropagation(),children:e.map((t,r)=>i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[i.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:t.label||Oy(t.fieldName)}),Array.isArray(t.data)&&i.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t.data.length})]}),i.jsx("div",{style:{padding:16},children:i.jsx(O9,{data:t.data,fieldName:t.fieldName})})]},t.fieldName||r))})}function O9({data:e,fieldName:t}){return e==null?i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"No data"}):typeof e=="string"?i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6,whiteSpace:"pre-wrap"},children:e}):Array.isArray(e)?e.length===0?i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"Empty list"}):i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((r,n)=>i.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"#374151"},children:[i.jsx("span",{style:{color:"#6b7280",marginTop:2,flexShrink:0,fontSize:12},children:""}),i.jsx("div",{style:{flex:1},children:typeof r=="string"?i.jsx("span",{children:r}):typeof r=="object"&&r!==null?i.jsx(M9,{item:r}):i.jsx("span",{children:String(r)})})]},typeof r=="object"&&(r==null?void 0:r.id)||n))}):typeof e=="object"?i.jsx("div",{className:"space-y-3",children:Object.entries(e).map(([r,n])=>i.jsxs("div",{style:{borderLeft:"3px solid #e2e8f0",paddingLeft:12},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:Oy(r)}),i.jsx("div",{style:{fontSize:14,color:"#1f2937"},children:typeof n=="string"?n:typeof n=="object"?JSON.stringify(n,null,2):String(n)})]},r))}):i.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",fontFamily:"monospace"},children:JSON.stringify(e,null,2)})}function M9({item:e}){const r=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title","problem_understanding","architectural_intent","proposed_system_shape"].find(h=>e[h]&&typeof e[h]=="string"),n=r?e[r]:null,s=e.id,o=e.confidence,a=e.likelihood,l=e.constraint_type,c=e.why_it_matters||e.why_early,d=e.impact_on_planning||e.impact_if_unresolved||e.impact,u=e.mitigation_direction,f=e.recommendation_direction,p=e.validation_approach;return n?i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:s}),i.jsx("span",{style:{fontWeight:500},children:n}),l&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:l}),o&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:o==="high"?"#dcfce7":o==="medium"?"#fef3c7":"#fee2e2",color:o==="high"?"#166534":o==="medium"?"#92400e":"#991b1b"},children:o}),a&&i.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[a,e.impact?`/${e.impact}`:""]})]}),p&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Validation: ",p]}),c&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Why: ",c]}),d&&typeof d=="string"&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Impact: ",d]}),u&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Mitigation: ",u]}),f&&i.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",f]})]}):i.jsx("span",{style:{fontSize:13,color:"#374151"},children:Object.entries(e).map(([h,g],x)=>i.jsxs("span",{children:[x>0&&"  ",i.jsxs("span",{style:{fontWeight:500},children:[Oy(h),":"]})," ",typeof g=="string"?g:JSON.stringify(g)]},h))})}function Oy(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function D9({projectId:e,projectCode:t,docTypeId:r,instanceId:n,onClose:s}){var C,S,w,A;const[o,a]=m.useState(null),[l,c]=m.useState(null),[d,u]=m.useState({}),[f,p]=m.useState(null),[h,g]=m.useState(null),[x,_]=m.useState(!0),[v,y]=m.useState(null);if(m.useEffect(()=>{async function E(){var O,z;try{_(!0),y(null),ze.getDocumentPgc(e,r,n).then(P=>{P!=null&&P.has_pgc&&g(P)}).catch(()=>{});try{const P=await ze.getDocumentRenderModel(e,r,n);if(P!=null&&P.metadata&&u(P.metadata),P!=null&&P.title&&p(P.title),(O=P==null?void 0:P.rendering_config)!=null&&O.detail_html){a(P),c(null);return}if(P&&P.sections&&P.sections.length>0){a(P),c(null);return}if((z=P==null?void 0:P.metadata)!=null&&z.fallback&&P.raw_content){a(null),c(P.raw_content);return}}catch(P){console.log("RenderModel not available, falling back to raw document:",P.message)}const k=await ze.getDocument(e,r,n);a(null),c((k==null?void 0:k.content)||null)}catch(k){y(k.message),console.error("Failed to fetch document:",k)}finally{_(!1)}}E()},[e,r,n]),m.useEffect(()=>{const E=O=>{O.key==="Escape"&&s()};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[s]),x)return i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:i.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})});const b=(o==null?void 0:o.metadata)||d,j=b.execution_id,N=j?`/admin?execution=${j}`:"/admin";return((C=o==null?void 0:o.rendering_config)==null?void 0:C.detail_html)&&o?i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:E=>E.target===E.currentTarget&&s(),children:i.jsxs("div",{className:"relative w-full max-w-6xl h-[90vh] overflow-hidden rounded-lg shadow-2xl flex flex-col",style:{background:"#ffffff"},children:[i.jsx("button",{onClick:s,className:"absolute top-2 right-3 z-10 p-1.5 rounded-lg hover:bg-gray-200 transition-colors",style:{background:"rgba(255,255,255,0.9)"},children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),i.jsx(A9,{renderModel:o,projectId:e,projectCode:t,docTypeId:r,executionId:j,docTypeName:b.document_type_name,pgcContext:h,onClose:s})]})}):i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:E=>E.target===E.currentTarget&&s(),children:i.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[i.jsx(L9,{title:(o==null?void 0:o.title)||f,projectCode:t,adminUrl:N,executionId:j,metadata:b,onClose:s}),((S=b==null?void 0:b.spawned_children)==null?void 0:S.count)>0&&i.jsx(z9,{children:b.spawned_children}),i.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:((w=b==null?void 0:b.spawned_children)==null?void 0:w.count)>0?"calc(90vh - 130px)":"calc(90vh - 80px)"},onWheel:E=>E.stopPropagation(),children:[v&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-red-500",children:v})}),o&&i.jsx(e3,{renderModel:o,variant:"full",hideHeader:!0}),l&&!o&&i.jsx(F9,{content:l,docTypeId:r}),!o&&!l&&!v&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"No content available"})}),h&&((A=h.clarifications)==null?void 0:A.length)>0&&i.jsx(W9,{pgcContext:h})]})]})})}function L9({title:e,projectCode:t,adminUrl:r,executionId:n,metadata:s,onClose:o}){const a=(()=>{if(!e)return"Document";const h=e.indexOf(": ");return h>-1?e.slice(h+2):e})(),l=(s==null?void 0:s.document_type_name)||(s!=null&&s.document_type?s.document_type.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase()):null),c=h=>{if(!h)return null;try{return new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},d=c(s==null?void 0:s.created_at),u=c(s==null?void 0:s.updated_at),f=s==null?void 0:s.version,p=s==null?void 0:s.lifecycle_state;return i.jsx("div",{className:"sticky top-0 px-6 py-4 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:6},children:[t&&i.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:n?`View execution ${n}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:t}),l&&i.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:l}),p&&i.jsx("span",{style:{padding:"2px 8px",background:p==="complete"?"#dcfce7":"#fef3c7",color:p==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:p}),f&&f>1&&i.jsxs("span",{style:{padding:"2px 8px",background:"#f3f4f6",color:"#6b7280",fontSize:11,fontWeight:600,borderRadius:4},children:["v",f]})]}),i.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#111827",lineHeight:1.3},children:a}),d&&i.jsxs("div",{style:{marginTop:4,fontSize:12,color:"#9ca3af"},children:["Generated ",d,u&&u!==d&&i.jsxs("span",{children:["  Updated ",u]})]})]}),i.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",style:{flexShrink:0,marginLeft:12},children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})})}function z9({children:e}){const{count:t,items:r}=e;return i.jsxs("div",{className:"flex items-center gap-3 flex-wrap px-6 py-3",style:{background:"#f0fdf4",borderBottom:"1px solid #bbf7d0"},children:[i.jsxs("span",{style:{fontSize:13,color:"#166534",fontWeight:600},children:["This plan produced ",t," Epic document",t!==1?"s":""]}),i.jsx("div",{className:"flex items-center gap-1.5 flex-wrap",children:r.map(n=>i.jsx("span",{title:n.title||n.name,style:{padding:"2px 8px",background:"#dcfce7",color:"#15803d",fontSize:11,fontWeight:500,borderRadius:4,whiteSpace:"nowrap"},children:n.name||n.epic_id},n.epic_id))})]})}function F9({content:e,docTypeId:t}){if(!e)return i.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n={preliminary_summary:{title:"Summary",icon:"S",color:"#7c3aed",render:"summary"},stakeholder_questions:{title:"Stakeholder Questions",icon:"?",color:"#dc2626",render:"questions"},unknowns:{title:"Unknowns to Resolve",icon:"?",color:"#d97706"},early_decision_points:{title:"Early Decision Points",icon:"D",color:"#7c3aed"},risks:{title:"Risks",icon:"!",color:"#dc2626"},known_constraints:{title:"Known Constraints",icon:"C",color:"#6b7280"},assumptions:{title:"Assumptions",icon:"A",color:"#d97706"},mvp_guardrails:{title:"MVP Guardrails",icon:"G",color:"#059669"},recommendations_for_pm:{title:"Recommendations for PM",icon:"R",color:"#2563eb"},pgc_clarifications:{title:"PGC Clarifications",icon:"Q",color:"#7c3aed",render:"clarifications"}},s=new Set(["project_name","title","name","meta","description","summary"]),o=Object.keys(e).filter(l=>!s.has(l)&&(Array.isArray(e[l])||typeof e[l]=="object"&&e[l]!==null));return o.length>0?i.jsxs("div",{className:"space-y-6",children:[r&&i.jsxs("div",{style:{borderBottom:"2px solid #7c3aed",paddingBottom:12},children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r}),i.jsx("span",{className:"text-xs font-mono text-gray-400",children:t})]}),Object.entries(n).map(([l,c])=>{const d=e[l];return d?c.render==="summary"&&typeof d=="object"&&!Array.isArray(d)?i.jsx($9,{data:d,config:c},l):c.render==="questions"&&Array.isArray(d)?i.jsx(q9,{data:d,config:c},l):c.render==="clarifications"&&Array.isArray(d)?i.jsx(B9,{data:d,config:c},l):Array.isArray(d)?i.jsx(lS,{data:d,config:c},l):null:null}),o.filter(l=>!n[l]).map(l=>{const c=e[l];return Array.isArray(c)?i.jsx(lS,{data:c,config:{title:aa(l),icon:"#",color:"#6b7280"}},l):typeof c=="object"&&c!==null?i.jsx(U9,{data:c,label:aa(l)},l):null}),i.jsxs("details",{style:{borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("summary",{style:{padding:"12px 16px",cursor:"pointer",fontSize:13,fontWeight:600,color:"#6b7280",background:"#f8fafc",borderRadius:8},children:"Raw Data (JSON)"}),i.jsx("div",{style:{padding:16,overflow:"auto"},children:i.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(e,null,2)})})]})]}):i.jsx(V9,{content:e,docTypeId:t,title:r})}function $9({data:e,config:t}){const r=[{key:"problem_understanding",label:"Problem Understanding"},{key:"architectural_intent",label:"Architectural Intent"},{key:"proposed_system_shape",label:"Proposed System Shape"}];return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Nu,{config:t}),i.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.map(n=>e[n.key]?i.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:n.label}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:e[n.key]})]},n.key):null),Object.entries(e).filter(([n])=>!r.some(s=>s.key===n)).map(([n,s])=>typeof s=="string"?i.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:aa(n)}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:s})]},n):null)]})]})}function q9({data:e,config:t}){const r=e.filter(s=>s.blocking),n=e.filter(s=>!s.blocking);return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Nu,{config:t,count:e.length}),i.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.length>0&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#dc2626",marginBottom:8,textTransform:"uppercase"},children:"Blocking"}),r.map((s,o)=>i.jsx(iS,{q:s,borderColor:"#dc2626"},s.id||o))]}),n.length>0&&i.jsxs("div",{children:[r.length>0&&i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,textTransform:"uppercase"},children:"Non-blocking"}),n.map((s,o)=>i.jsx(iS,{q:s,borderColor:"#d1d5db"},s.id||o))]})]})]})}function iS({q:e,borderColor:t}){return i.jsxs("div",{style:{borderLeft:`3px solid ${t}`,paddingLeft:12,marginBottom:8},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2},children:[e.id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.id}),e.directed_to&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.directed_to.replace(/_/g," ")})]}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,fontWeight:500},children:e.question||e.text||G9(e)}),e.notes&&i.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0 0"},children:e.notes})]})}function B9({data:e,config:t}){const r={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}};return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Nu,{config:t,count:e.length}),i.jsx("div",{style:{padding:16},className:"space-y-3",children:e.map((n,s)=>{const o=r[n.constraint_kind]||r.selection;return i.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12,marginBottom:8},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[n.question_id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:n.question_id}),n.binding&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),n.constraint_kind&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:o.bg,color:o.color,borderRadius:4},children:n.constraint_kind}),n.binding_source&&i.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",n.binding_source]})]}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:n.question}),n.why_it_matters&&i.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:n.why_it_matters}),n.answer&&i.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[i.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),i.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:n.answer})]})]},n.question_id||s)})})]})}function W9({pgcContext:e}){const{clarifications:t}=e,r=t.filter(s=>s.binding),n=t.filter(s=>!s.binding);return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,marginTop:24},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[i.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:"#7c3aed15",color:"#7c3aed"},children:"Q"}),i.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:"Pre-Generation Clarifications"}),i.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t.length})]}),i.jsxs("div",{style:{padding:16},className:"space-y-4",children:[r.length>0&&i.jsxs("div",{children:[i.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#1e40af",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Binding Constraints (",r.length,")"]}),r.map((s,o)=>i.jsx(aS,{item:s},s.question_id||o))]}),n.length>0&&i.jsxs("div",{children:[r.length>0&&i.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,marginTop:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Informational (",n.length,")"]}),n.map((s,o)=>i.jsx(aS,{item:s},s.question_id||o))]})]})]})}function aS({item:e}){const t={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}},r=t[e.constraint_kind]||t.selection;return i.jsxs("div",{style:{borderLeft:`3px solid ${e.binding?"#3b82f6":"#d1d5db"}`,paddingLeft:12,marginBottom:12},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[e.question_id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.question_id}),e.binding&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),e.constraint_kind&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:r.bg,color:r.color,borderRadius:4},children:e.constraint_kind}),e.binding_source&&i.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",e.binding_source]})]}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:e.question}),e.why_it_matters&&i.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:e.why_it_matters}),e.answer&&i.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[i.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),i.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:e.answer})]})]})}function lS({data:e,config:t}){return!e||e.length===0?null:i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Nu,{config:t,count:e.length}),i.jsx("div",{style:{padding:16},children:i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((r,n)=>i.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"#374151"},children:[i.jsx("span",{style:{color:t.color,marginTop:2,flexShrink:0,fontSize:12},children:t.icon==="!"?"":""}),i.jsx("div",{style:{flex:1},children:typeof r=="string"?i.jsx("span",{children:r}):typeof r=="object"&&r!==null?i.jsx(H9,{item:r}):i.jsx("span",{children:String(r)})})]},typeof r=="object"&&r.id||n))})})]})}function H9({item:e}){const r=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title"].find(h=>e[h]&&typeof e[h]=="string"),n=r?e[r]:null,s=e.id,o=e.confidence,a=e.constraint_type,l=e.validation_approach,c=e.impact_on_planning||e.impact_if_unresolved,d=e.mitigation_direction,u=e.likelihood,f=e.why_it_matters||e.why_early,p=e.recommendation_direction;return n?i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:s}),i.jsx("span",{style:{fontWeight:500},children:n}),a&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:a}),o&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:o==="high"?"#dcfce7":o==="medium"?"#fef3c7":"#fee2e2",color:o==="high"?"#166534":o==="medium"?"#92400e":"#991b1b"},children:o}),u&&i.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[u,"/",e.impact||"?"]})]}),l&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Validation: ",l]}),f&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Why: ",f]}),c&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Impact: ",c]}),d&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Mitigation: ",d]}),p&&i.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",p]})]}):i.jsx("span",{style:{fontSize:13,color:"#374151"},children:Object.entries(e).map(([h,g],x)=>i.jsxs("span",{children:[x>0&&"  ",i.jsxs("span",{style:{fontWeight:500},children:[aa(h),":"]})," ",typeof g=="string"?g:JSON.stringify(g)]},h))})}function U9({data:e,label:t}){return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontWeight:600,fontSize:14,color:"#1f2937"},children:t}),i.jsx("div",{style:{padding:16},children:Object.entries(e).map(([r,n])=>i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:aa(r)}),i.jsx("div",{style:{fontSize:14,color:"#1f2937"},children:typeof n=="string"?n:typeof n=="object"?JSON.stringify(n,null,2):String(n)})]},r))})]})}function Nu({config:e,count:t}){return i.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[i.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:`${e.color}15`,color:e.color},children:e.icon}),i.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:e.title}),t!==void 0&&i.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t})]})}function V9({content:e,docTypeId:t,title:r}){return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",i.jsx("strong",{children:t})," - displaying raw content"]}),r&&i.jsx("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r})}),i.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:i.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}function G9(e){if(typeof e=="string")return e;if(typeof e!="object"||e===null)return String(e);for(const t of Object.values(e))if(typeof t=="string"&&t.length>10)return t;return JSON.stringify(e)}function aa(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}const K9="/api/v1/admin";class Y9 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function X9(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ae(e,t={}){var o;const r=`${K9}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const a=X9();a&&(n.headers["X-CSRF-Token"]=a)}const s=await fetch(r,n);if(!s.ok){const a=await s.json().catch(()=>({})),l=((o=a.detail)==null?void 0:o.message)||a.detail||`Request failed: ${s.status}`;throw new Y9(l,s.status,a.detail||a)}return s.status===204?null:s.json()}const we={getCurrentWorkspace:async()=>{try{return await Ae("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ae("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ae(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ae(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ae(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>Ae(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ae(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ae(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ae(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ae(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ae("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ae(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ae("/workbench/prompt-fragments"),getRoles:()=>Ae("/workbench/roles"),getTemplates:()=>Ae("/workbench/templates"),getSchemas:()=>Ae("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ae("/workbench/workflows"),getOrchestrationWorkflows:()=>Ae("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ae(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ae(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ae(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ae(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ae(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ae(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ae(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ae(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ae("/workbench/active-releases"),invalidateCache:()=>Ae("/workbench/invalidate-cache",{method:"POST"}),getMechanicalOpTypes:()=>Ae("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Ae(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Ae("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Ae("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/mechanical-ops/${e}${r}`)}};function Q9({projectId:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,a]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,g]=m.useState(!1),[x,_]=m.useState(null),[v,y]=m.useState(!1),[b,j]=m.useState(!1),N=m.useCallback(async()=>{try{const k=((await we.getOrchestrationWorkflows()).workflows||[]).filter(R=>R.workflow_id!=="intake_and_route"),P=k.find(R=>R.workflow_id==="software_product_development")||k[0];if(P){const R=await ze.createWorkflowInstance(e,P.workflow_id,P.active_version);r(R)}}catch(z){console.error("Failed to auto-assign workflow:",z)}},[e]),T=m.useCallback(async()=>{if(e){s(!0),a(null);try{const z=await ze.getWorkflowInstance(e);r(z)}catch(z){z.status===404?(r(null),await N()):a(z.message)}finally{s(!1)}}},[e,N]);m.useEffect(()=>{T()},[T]);const C=async()=>{c(!0),p(!0);try{const k=((await we.getOrchestrationWorkflows()).workflows||[]).filter(P=>P.workflow_id!=="intake_and_route");u(k)}catch{u([])}finally{p(!1)}},S=async z=>{g(!0);try{const k=await ze.createWorkflowInstance(e,z.workflow_id,z.active_version);r(k),c(!1)}catch(k){a(k.message)}finally{g(!1)}},w=async()=>{if(t&&(j(!b),!x)){y(!0);try{const z=await ze.getWorkflowDrift(e);_(z)}catch(z){_({error:z.message})}finally{y(!1)}}};if(n)return i.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(o&&!t)return i.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:o});if(!t)return i.jsxs("div",{className:"p-4",children:[i.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?i.jsx(Z9,{workflows:d,loading:f,assigning:h,onSelect:S,onCancel:()=>c(!1)}):i.jsx("button",{onClick:C,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const A=t.effective_workflow||{},E=A.steps||[],O=t.base_workflow_ref||{};return i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:A.name||O.workflow_id||"Workflow"}),i.jsx(J9,{status:t.status})]}),i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",O.workflow_id," v",O.version,O.pow_class?` (${O.pow_class})`:""]})]}),i.jsx("button",{onClick:w,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:v?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&x&&i.jsx(eB,{drift:x}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",E.length,")"]}),E.length===0?i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):i.jsx("div",{className:"space-y-1",children:E.map((z,k)=>i.jsx(tB,{step:z,index:k},z.step_id||k))})]}),o&&i.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:o})]})}function Z9({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:s}){const o=e.filter(l=>(l.pow_class||"reference")==="reference"),a=e.filter(l=>l.pow_class==="template");return i.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):i.jsxs(i.Fragment,{children:[o.length>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),o.map(l=>i.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[i.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),i.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),a.length>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),a.map(l=>i.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[i.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),i.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),o.length===0&&a.length===0&&i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),i.jsx("button",{onClick:s,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function J9({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function eB({drift:e}){return e.error?i.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):i.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[i.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[i.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),i.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&i.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&i.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&i.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&i.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&i.jsx("div",{children:"~ Metadata changed"})]})]})}function tB({step:e,index:t}){return i.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&i.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&i.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}const mx=(e,t,r=null)=>{const n=new _c.graphlib.Graph;return n.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),n.setDefaultEdgeLabel(()=>({})),e.forEach(s=>{n.setNode(s.id,{width:s.data.width??280,height:s.data.height??90})}),t.forEach(s=>{n.setEdge(s.source,s.target)}),_c.layout(n),{nodes:e.map(s=>{const o=n.node(s.id),a={x:o.x-(s.data.width??280)/2,y:o.y-(s.data.height??90)/2},l=r==null?void 0:r[s.id];return{...s,targetPosition:ce.Top,sourcePosition:ce.Bottom,position:l||a}}),edges:t}},xx=(e,t,r)=>{let n=[],s=[],o=null,a=null,l=[];const c=r.theme||"industrial";return e.forEach((d,u)=>{var g,x,_;if((d.level||1)!==1)return;const f=280;let p=95;((g=d.stations)==null?void 0:g.length)>0&&(p+=35);const h=t===d.id;if(n.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...r},connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),o){const v=(x=e[u-1])==null?void 0:x.state;s.push({id:"e-"+o+"-"+d.id,source:o,target:d.id,type:"smoothstep",animated:v==="active",style:{stroke:DE(v,c),strokeWidth:3}})}((_=d.children)==null?void 0:_.length)>0&&(a=d.id,l=d.children),o=d.id}),{nodes:n,edges:s,parentId:a,childNodes:l}},gx=(e,t,r,n,s)=>{const{nodes:o,edges:a}=e;if(!t||!r.length)return{nodes:o,edges:a};const l=o.find(b=>b.id===t);if(!l)return{nodes:o,edges:a};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=s.theme||"industrial",p=DE(u,f),h=u==="active",g=Sr.WP_HEIGHT+Sr.WP_GAP_Y,x=Math.ceil(r.length/Sr.WPS_PER_ROW),_=c+280*.15,v=50,y={};r.forEach((b,j)=>{const N=Math.floor(j/Sr.WPS_PER_ROW);y[N]||(y[N]=[]),y[N].push({child:b,idx:j})});for(let b=0;b<x;b++){const j=y[b]||[];if(j.length===0)continue;const N=d+Sr.WP_OFFSET_Y+b*g,T=`junction-row-${b}`;o.push({id:T,type:"waypoint",position:{x:_,y:N-v},draggable:!1,connectable:!1,selectable:!1}),b===0?a.push({id:`e-spine-drop-${b}`,source:t,target:T,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):a.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:T,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),j.forEach(({child:C,idx:S})=>{const w=S%Sr.WPS_PER_ROW,A=c+Sr.WP_OFFSET_X+w*(Sr.WP_WIDTH+Sr.WP_GAP_X),E=N,O=n===C.id;o.push({id:C.id,type:"documentNode",data:{...C,width:Sr.WP_WIDTH,height:Sr.WP_HEIGHT,isExpanded:O,...s},draggable:!1,connectable:!1,position:{x:A,y:E},targetPosition:ce.Top,sourcePosition:ce.Bottom,zIndex:O?1e3:0}),a.push({id:`e-branch-${C.id}`,source:T,target:C.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:o,edges:a}},rB={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"};function nB(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1,metadata:r.metadata||{}};return t}function sB(e,t=[]){const r=[],n=[],s={};for(const o of e.tracks){const a=oB(o,t);if((o.scope||"project")==="project")n.push({...a,mayOwn:o.may_own||[],childDocType:o.child_doc_type});else{const c=o.document_type;s[c]||(s[c]=[]),s[c].push({...a,sequence:o.sequence})}}for(const o of n)o.childDocType&&s[o.childDocType]&&(o.children=s[o.childDocType].sort((a,l)=>(a.sequence??999)-(l.sequence??999)).map(a=>({...a,level:2,docTypeId:a.docTypeId,instanceId:a.instanceId}))),r.push(o);return r}function oB(e,t=[]){var a,l,c,d,u,f,p;const r=rB[e.state]||"ready_for_production";e.state;const n=t.find(h=>h.document_type===e.document_type);let s=null;e.stations&&e.stations.length>0&&(s=iB(e.stations,e.state,e.station));let o=null;if(n){const h=n.questions||((l=(a=n.payload)==null?void 0:a.data)==null?void 0:l.questions)||(Array.isArray((c=n.payload)==null?void 0:c.data)?n.payload.data:null);h&&Array.isArray(h)&&(o=h.map((g,x)=>({id:g.id||`q${x+1}`,text:g.question||g.text||g,required:g.required!==!1,choices:g.choices||null,answer_type:g.answer_type||"text",why_it_matters:g.why_it_matters||null,priority:g.priority||null,blocking:g.blocking!==!1,default:g.default||null,constraint_kind:g.constraint_kind||null})))}return{id:e.identifier||e.document_type,docTypeId:e.document_type,instanceId:e.instance_id||null,name:e.document_name||aB(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:s,questions:o,interruptId:n==null?void 0:n.id,blockedBy:e.blocked_by||[],ws_done:e.ws_done??((d=e.metadata)==null?void 0:d.ws_done)??0,ws_total:e.ws_total??((u=e.metadata)==null?void 0:u.ws_total)??0,mode_b_count:e.mode_b_count??((f=e.metadata)==null?void 0:f.mode_b_count)??0,dependencies:e.dependencies||[],workStatements:e.work_statements||((p=e.metadata)==null?void 0:p.work_statements)||[]}}function iB(e,t,r){return!e||e.length===0?null:e.map(n=>({id:n.station,label:n.label||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function aB(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function lB({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,s]=m.useState(!0),[o,a]=m.useState(null),l=m.useCallback(async()=>{s(!0),a(null);try{const d=await ze.getProjects({includeArchived:e}),u=nB(d);r(u)}catch(d){a(d.message),console.error("Failed to fetch projects:",d)}finally{s(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await ze.createProject({name:d,description:""});return r(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw a(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:o,addProject:c,refresh:l}}function cB(e){const[t,r]=m.useState([]),[n,s]=m.useState("idle"),[o,a]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,g]=m.useState(null),x=m.useRef(null),_=m.useRef(null),v=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[C,S]=await Promise.all([ze.getProductionStatus(e),ze.getProjectInterrupts(e).catch(()=>[])]);a(S),s(C.line_state),r(sB(C,S))}catch(C){u(C.message),console.error("Failed to fetch production status:",C)}finally{c(!1)}},[e]),y=m.useCallback(()=>{if(!e)return;x.current&&x.current.close();const C=$8(e);x.current=C,C.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),C.addEventListener("station_transition",S=>{try{const w=JSON.parse(S.data);console.log("Station transition:",w),v()}catch(w){console.error("Failed to parse station_transition:",w)}}),C.addEventListener("line_stopped",S=>{try{const w=JSON.parse(S.data);console.log("Line stopped:",w),s("stopped"),v()}catch(w){console.error("Failed to parse line_stopped:",w)}}),C.addEventListener("production_complete",S=>{try{const w=JSON.parse(S.data);console.log("Production complete:",w),s("complete"),v()}catch(w){console.error("Failed to parse production_complete:",w)}}),C.addEventListener("interrupt_resolved",S=>{try{const w=JSON.parse(S.data);console.log("Interrupt resolved:",w),v()}catch(w){console.error("Failed to parse interrupt_resolved:",w)}}),C.addEventListener("track_started",S=>{try{const w=JSON.parse(S.data);console.log("Track started:",w),s("active"),v()}catch(w){console.error("Failed to parse track_started:",w)}}),C.addEventListener("track_stabilized",S=>{try{const w=JSON.parse(S.data);console.log("Track stabilized:",w),v()}catch(w){console.error("Failed to parse track_stabilized:",w)}}),C.addEventListener("children_updated",S=>{try{const w=JSON.parse(S.data);console.log("Children updated:",w),v()}catch(w){console.error("Failed to parse children_updated:",w)}}),C.addEventListener("stations_declared",S=>{try{const w=JSON.parse(S.data);console.log("Stations declared:",w);const{document_type:A,stations:E}=w;r(O=>{const z=O.some(P=>P.id===A);console.log("stations_declared raw stations:",E);const k=E.map(P=>({id:P.id,label:P.label,state:P.state,phases:P.phases||[],phase:null}));return console.log("stations_declared processed:",k),z?O.map(P=>P.id===A?{...P,state:"in_production",stations:k}:P):[...O,{id:A,name:A.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase()),state:"in_production",stations:k}]})}catch(w){console.error("Failed to parse stations_declared:",w)}}),C.addEventListener("station_changed",S=>{try{const w=JSON.parse(S.data);console.log("Station changed:",w);const{document_type:A,station_id:E,state:O}=w;r(z=>z.map(k=>k.id!==A||!k.stations?k:{...k,stations:k.stations.map(P=>P.id===E?{...P,state:O}:P)}))}catch(w){console.error("Failed to parse station_changed:",w)}}),C.addEventListener("internal_step",S=>{try{const w=JSON.parse(S.data);console.log("Internal step:",w);const{document_type:A,station_id:E,step:O}=w;r(z=>z.map(k=>k.id!==A||!k.stations?k:{...k,stations:k.stations.map(P=>P.id===E?{...P,currentStep:O}:P)}))}catch(w){console.error("Failed to parse internal_step:",w)}}),C.onerror=S=>{console.error("SSE error:",S),p(!1),u("Connection lost"),C.close(),_.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),y()},3e3)}},[e,v]),b=m.useCallback(()=>{_.current&&clearTimeout(_.current),x.current&&(x.current.close(),x.current=null),p(!1)},[]),j=m.useCallback(async(C,S)=>{try{await ze.resolveInterrupt(C,{answers:S})}catch(w){throw console.error("Failed to resolve interrupt:",w),w}},[]),N=m.useCallback(async(C=null)=>{var S;try{g(null),await ze.startProduction(e,C),s("active")}catch(w){console.error("Failed to start production:",w);const A=((S=w.data)==null?void 0:S.message)||w.message||"Failed to start production";throw g({type:"error",message:A}),C&&r(E=>E.map(O=>O.id===C?{...O,state:"ready_for_production",stations:null}:O)),s("idle"),v(),w}},[e,v]),T=m.useCallback(()=>{g(null)},[]);return m.useEffect(()=>(v(),y(),()=>b()),[v,y,b]),{data:t,lineState:n,interrupts:o,loading:l,error:d,connected:f,notification:h,dismissNotification:T,refresh:v,resolveInterrupt:j,startProduction:N}}const cS="combine-theme";function t3(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const o=localStorage.getItem(cS);return o&&Pn.includes(o)?o:e});m.useEffect(()=>{localStorage.setItem(cS,t)},[t]);const n=m.useCallback(o=>{Pn.includes(o)&&r(o)},[]),s=m.useCallback(()=>{r(o=>{const a=Pn.indexOf(o);return Pn[(a+1)%Pn.length]})},[]);return{theme:t,setTheme:n,cycleTheme:s}}function uB(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[s,o]=m.useState([]),[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[g,x]=m.useState([]),[_,v]=m.useState(!1),[y,b]=m.useState(null),[j,N]=m.useState(null),[T,C]=m.useState(null),[S,w]=m.useState(!1),[A,E]=m.useState(!1),[O,z]=m.useState(null),[k,P]=m.useState(null),[R,D]=m.useState(null),L=m.useRef(null),I=m.useRef(null),M=m.useRef(!0);m.useEffect(()=>(M.current=!0,()=>{M.current=!1,L.current&&L.current.close()}),[]);const F=m.useCallback(X=>{M.current&&(n(X.phase),o(X.messages||[]),l(X.pending_prompt),d(X.pending_choices),f(X.interpretation||{}),h(X.confidence||0),x(X.missing_fields||[]),v(X.can_initialize||!1),b(X.gate_outcome),N(X.project),z(X.intake_classification),P(X.intake_gate_phase),D(X.operational_error||null))},[]),q=m.useCallback(async()=>{C(null),w(!0);try{const X=await ze.startIntake();if(!M.current)return;t(X.execution_id),F(X)}catch(X){if(!M.current)return;C(X.message||"Failed to start intake")}finally{M.current&&w(!1)}},[]),H=m.useCallback(async X=>{if(!e||!X.trim())return;C(null),D(null),E(!0),I.current=X;const Q={role:"user",content:X};o(fe=>[...fe,Q]);try{const fe=await ze.submitIntakeMessage(e,X);if(!M.current)return;F(fe)}catch(fe){if(!M.current)return;o(xe=>xe.filter(be=>be!==Q)),C(fe.message||"Failed to submit message")}finally{M.current&&E(!1)}},[e,F]),V=m.useCallback(async()=>{I.current&&(D(null),await H(I.current))},[H]),Z=m.useCallback(async(X,Q)=>{if(e){C(null),f(fe=>({...fe,[X]:{value:Q,source:"user",locked:!0}}));try{const fe=await ze.updateIntakeField(e,X,Q);if(!M.current)return;F(fe)}catch(fe){if(!M.current)return;C(fe.message||"Failed to update field");const xe=await ze.getIntakeState(e);M.current&&F(xe)}}},[e,F]),B=m.useCallback(async()=>{if(!(!e||!_)){C(null),w(!0);try{const X=await ze.initializeIntake(e);if(!M.current)return;F(X),X.phase==="generating"&&re()}catch(X){if(!M.current)return;C(X.message||"Failed to initialize project"),w(!1)}}},[e,_,F]),re=m.useCallback(()=>{L.current&&L.current.close();const X=q8(e);L.current=X,X.addEventListener("started",Q=>{if(!M.current)return;const fe=JSON.parse(Q.data);console.log("Intake started:",fe)}),X.addEventListener("progress",Q=>{if(!M.current)return;const fe=JSON.parse(Q.data);console.log("Intake progress:",fe.current_node)}),X.addEventListener("complete",async Q=>{if(!M.current)return;const fe=JSON.parse(Q.data);console.log("Intake complete:",fe),X.close(),L.current=null,n("complete"),b(fe.gate_outcome),N(fe.project),w(!1)}),X.addEventListener("error",Q=>{if(M.current&&X.readyState!==EventSource.CLOSED){try{const fe=JSON.parse(Q.data);C(fe.message||"Generation failed")}catch{C("Connection lost during generation")}X.close(),L.current=null,w(!1)}}),X.onerror=()=>{M.current&&X.readyState===EventSource.CLOSED&&(L.current=null,w(!1))}},[e]),oe=m.useCallback(()=>{L.current&&(L.current.close(),L.current=null),t(null),n("idle"),o([]),l(null),d(null),f({}),h(0),x([]),v(!1),b(null),N(null),C(null),w(!1),E(!1),D(null),I.current=null},[]);return{executionId:e,phase:r,messages:s,pendingPrompt:a,pendingChoices:c,interpretation:u,confidence:p,missingFields:g,canInitialize:_,gateOutcome:y,project:j,error:T,loading:S,submitting:A,intakeClassification:O,intakeGatePhase:k,operationalError:R,startIntake:q,submitMessage:H,updateField:Z,lockAndGenerate:B,retryLastMessage:V,reset:oe}}const r3=m.createContext(null);function dB({children:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,a]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{s(!0),a(null);try{const f=await ze.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),a(f.message),r(null)}finally{s(!1)}},[]),c=m.useCallback(f=>{window.location.href=B8(f)},[]),d=m.useCallback(async()=>{try{await ze.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),u={user:t,loading:n,error:o,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return i.jsx(r3.Provider,{value:u,children:e})}function Ms(){const e=m.useContext(r3);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function fB(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[s,o]=m.useState(!0),[a,l]=m.useState(null),c=m.useCallback(async()=>{o(!0),l(null);try{let u=await we.getCurrentWorkspace();u||(u=await we.createWorkspace()),t(u.workspace_id),n(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{o(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await we.closeWorkspace(e,u),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:s,error:a,closeWorkspace:d,reinitialize:c}}function pB(e,t=1e4){var u,f;const[r,n]=m.useState(null),[s,o]=m.useState(!0),[a,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){n(null),o(!1);return}try{const p=await we.getWorkspaceState(e);n(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{o(!1)}},[e]);return m.useEffect(()=>{e&&(o(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:r,loading:s,error:a,refresh:d,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((u=r==null?void 0:r.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function hB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getDocumentTypes();t(l.document_types||[])}catch(l){o(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{documentTypes:e,loading:r,error:s,refresh:a}}function mB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getRoles();t(l.roles||[])}catch(l){o(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{roles:e,loading:r,error:s,refresh:a}}function Ta(e,t,{debounceMs:r=500,onSave:n}={}){const[s,o]=m.useState(""),[a,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[g,x]=m.useState(null),_=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){o(""),l(""),d(!1);return}d(!0),f(null);try{const S=await we.getArtifact(e,t);o(S.content),l(S.content)}catch(S){f(S.message),console.error("Failed to load artifact:",S)}finally{d(!1)}},[e,t]),b=m.useCallback(async S=>{if(!(!e||!t)){h(!0),f(null);try{const w=await we.writeArtifact(e,t,S);x(w),l(S),n&&n(w)}catch(w){f(w.message),console.error("Failed to save artifact:",w)}finally{h(!1)}}},[e,t,n]),j=m.useCallback(S=>{v.current=S,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),N=m.useCallback(S=>{o(S),S!==a&&j(S)},[a,j]),T=m.useCallback(()=>{_.current&&clearTimeout(_.current),v.current=null,o(a)},[a]),C=m.useCallback(()=>{_.current&&clearTimeout(_.current),s!==a&&b(s)},[s,a,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{content:s,originalContent:a,loading:c,error:u,saving:p,lastSaveResult:g,isDirty:s!==a,updateContent:N,reset:T,saveNow:C,reload:y}}const xB={documentNode:D8,waypoint:L8},gB={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function vB({projectId:e,projectCode:t,projectName:r,isArchived:n,savedLayout:s,autoExpandNodeId:o,theme:a,onThemeChange:l,onProjectUpdate:c,onProjectArchive:d,onProjectUnarchive:u,onProjectDelete:f}){const{data:p,lineState:h,loading:g,error:x,connected:_,notification:v,dismissNotification:y,resolveInterrupt:b,startProduction:j}=cB(e),[N,T]=m.useState([]),[C,S]=m.useState(null),[w,A]=m.useState(null),[E,O]=m.useState(null),[z,k]=m.useState(!1),[P,R]=m.useState(""),[D,L]=m.useState(!1),[I,M]=m.useState(!1),[F,q]=m.useState(!1),H=iu(),V=m.useRef((s==null?void 0:s.node_positions)||null),Z=m.useRef((s==null?void 0:s.viewport)||null),B=m.useRef(null),re=m.useRef(!1);m.useEffect(()=>{p.length>0&&T(p)},[p]),m.useEffect(()=>{o&&N.length>0&&setTimeout(()=>{S(o),A("questions")},300)},[o,N.length]),m.useEffect(()=>{S(null),A(null)},[e]),m.useEffect(()=>()=>{B.current&&clearTimeout(B.current)},[]);const oe=m.useCallback(()=>{const ie=Pn.indexOf(a);l(Pn[(ie+1)%Pn.length])},[a,l]),X=m.useCallback(()=>{B.current&&clearTimeout(B.current),B.current=setTimeout(()=>{const ie={node_positions:V.current,viewport:Z.current};ze.saveFloorLayout(e,ie).catch(ge=>console.error("Failed to save floor layout:",ge))},800)},[e]),Q=m.useCallback((ie,ge)=>{const pe={...V.current||{}};pe[ge.id]=ge.position,V.current=pe,X()},[X]),fe=m.useCallback((ie,ge)=>{ge&&(Z.current=ge,X())},[X]),xe=m.useCallback(()=>{R(r||""),k(!0)},[r]),be=m.useCallback(async()=>{if(!P.trim()||P===r){k(!1);return}M(!0);try{await c(e,{name:P.trim()}),k(!1)}catch(ie){console.error("Failed to update name:",ie)}finally{M(!1)}},[P,r,e,c]),ye=m.useCallback(()=>{k(!1),R("")},[]),ae=m.useCallback(async()=>{M(!0);try{n?await u(e):await d(e)}catch(ie){console.error("Failed to toggle archive:",ie)}finally{M(!1)}},[e,n,d,u]),K=m.useCallback(async()=>{M(!0);try{await f(e),L(!1)}catch(ie){console.error("Failed to delete:",ie)}finally{M(!1)}},[e,f]),te=m.useCallback(ie=>{const ge=H.getNode(ie);if(ge){const U=window.innerWidth,ve=-ge.position.x*.9+U/2-400,he=-ge.position.y*.9+120;H.setViewport({x:ve,y:he,zoom:.9},{duration:800})}},[H]),ee=m.useMemo(()=>({onExpand:(ie,ge)=>{S(ie),A(ge)},onCollapse:()=>{S(null),A(null),setTimeout(()=>H.fitView({padding:.2,duration:300}),50)},onViewFullDocument:ie=>{O(ie)},onStartProduction:async ie=>{console.log("Starting production for:",ie),T(ge=>ge.map(pe=>pe.id===ie?{...pe,_prevState:pe.state,state:"in_production"}:pe));try{await j(ie)}catch{T(pe=>pe.map(U=>U.id===ie?{...U,state:U._prevState||"ready_for_production",stations:null}:U))}},onSubmitQuestions:async(ie,ge)=>{console.log("Submitted:",ie,ge),S(null),A(null),T(U=>{const ve=he=>he.map(Fe=>Fe.id===ie&&Fe.stations?{...Fe,state:"in_production",stations:Fe.stations.map(He=>He.id==="pgc"?{...He,state:"complete",needs_input:!1}:He.id==="asm"?{...He,state:"active"}:He)}:Fe.children?{...Fe,children:ve(Fe.children)}:Fe);return ve(U)});const pe=N.find(U=>U.id===ie);if(pe!=null&&pe.interruptId)try{await b(pe.interruptId,ge)}catch(U){console.error("Failed to submit answers:",U)}}}),[H,N,b,j]),{layoutNodes:ke,layoutEdges:je}=m.useMemo(()=>{if(N.length===0)return{layoutNodes:[],layoutEdges:[]};const ie={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:ge,edges:pe,parentId:U,childNodes:ve}=xx(N,C,ie),he=mx(ge,pe,V.current),{nodes:Fe,edges:He}=gx(he,U,ve,C,ie);return{layoutNodes:Fe.map(Ge=>({...Ge,data:{...Ge.data,expandType:Ge.id===C?w:null}})),layoutEdges:He}},[N,C,w,ee,a,te,e,t]),[Te,Ne,ne]=AE(ke),[Se,Ve,ct]=IE(je);m.useEffect(()=>{if(N.length===0)return;const ie={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:ge,edges:pe,parentId:U,childNodes:ve}=xx(N,C,ie),he=mx(ge,pe,V.current),{nodes:Fe,edges:He}=gx(he,U,ve,C,ie),st=Fe.map(Ge=>({...Ge,data:{...Ge.data,expandType:Ge.id===C?w:null}}));Ne(st),Ve(He)},[N,C,w,ee,Ne,Ve,a,te,e,t]),m.useEffect(()=>{!re.current&&Z.current&&Te.length>0&&(re.current=!0,setTimeout(()=>{H.setViewport(Z.current,{duration:0})},100))},[Te.length,H]);const We=m.useCallback(()=>{V.current=null,Z.current=null,ze.saveFloorLayout(e,null).catch(Ge=>console.error("Failed to clear floor layout:",Ge));const ie={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:ge,edges:pe,parentId:U,childNodes:ve}=xx(N,C,ie),he=mx(ge,pe,null),{nodes:Fe,edges:He}=gx(he,U,ve,C,ie),st=Fe.map(Ge=>({...Ge,data:{...Ge.data,expandType:Ge.id===C?w:null}}));Ne(st),Ve(He),setTimeout(()=>H.fitView({padding:.2,duration:300}),50)},[e,ee,w,a,te,t,N,C,Ne,Ve,H]),Pe=m.useCallback((ie,ge)=>{},[]);return g&&N.length===0?i.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):x&&N.length===0?i.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:i.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:i.jsx("p",{className:"text-red-500 mb-4",children:x})})}):i.jsxs("div",{className:"w-full h-full",children:[i.jsxs(ja,{nodes:Te,edges:Se,onNodesChange:ne,onEdgesChange:ct,onNodeClick:Pe,onNodeDragStop:Q,onMoveEnd:fe,nodeTypes:xB,nodesDraggable:!0,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,zoomOnScroll:!0,fitView:!Z.current,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[i.jsx(Un,{position:"top-left",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:i.jsxs("div",{className:"flex items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),i.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[h==="active"&&i.jsx("span",{className:"text-amber-500",children:" Active"}),h==="stopped"&&i.jsx("span",{className:"text-red-500",children:" Stopped"}),h==="complete"&&i.jsx("span",{className:"text-emerald-500",children:" Complete"}),h==="idle"&&i.jsx("span",{children:" Idle"}),!_&&i.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("button",{onClick:We,className:"subway-button p-1.5 rounded-md transition-colors",title:"Reset layout",children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M3 12a9 9 0 019-9 9.75 9.75 0 016.74 2.74L21 8"}),i.jsx("path",{d:"M21 3v5h-5"}),i.jsx("path",{d:"M21 12a9 9 0 01-9 9 9.75 9.75 0 01-6.74-2.74L3 16"}),i.jsx("path",{d:"M3 21v-5h5"})]})}),i.jsx("button",{onClick:oe,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:gB[a]})]})]})}),i.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:i.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),z?i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("input",{type:"text",value:P,onChange:ie=>R(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"&&be(),ie.key==="Escape"&&ye()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:I}),i.jsx("button",{onClick:be,disabled:I,className:"p-1 rounded hover:bg-white/10",title:"Save",children:i.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M5 13l4 4L19 7"})})}),i.jsx("button",{onClick:ye,disabled:I,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:i.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):i.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!z&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:xe,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),i.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),i.jsx("button",{onClick:ae,disabled:I,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:i.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&i.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),i.jsx("button",{onClick:()=>L(!0),disabled:I||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:i.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),i.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[i.jsxs("button",{onClick:()=>q(!F),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[i.jsx("span",{children:"Workflow"}),i.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:F?"":""})]}),F&&i.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:i.jsx(Q9,{projectId:e})})]})]})}),i.jsx(ME,{position:"top-right",nodeColor:ie=>{var ve;const ge=(ve=ie.data)==null?void 0:ve.state,pe=document.querySelector('[class*="theme-"]')||document.body,U=getComputedStyle(pe);return["produced","stabilized","ready","complete"].includes(ge)?U.getPropertyValue("--state-stabilized-bg").trim():["requirements_not_met","blocked","halted","failed"].includes(ge)?U.getPropertyValue("--state-blocked-bg").trim():["in_production","active","queued","awaiting_operator"].includes(ge)?U.getPropertyValue("--state-active-bg").trim():(["ready_for_production","waiting","pending_acceptance"].includes(ge),U.getPropertyValue("--state-ready-bg").trim())},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),i.jsx(Un,{position:"bottom-left",children:i.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[i.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"Stabilized"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-ready-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"In Progress"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-blocked-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"Blocked"})]})]})}),i.jsx(Un,{position:"bottom-right",children:i.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan | Drag nodes to rearrange"})})]}),v&&i.jsxs("div",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 px-5 py-3 rounded-lg shadow-lg border",style:{background:v.type==="error"?"#fef2f2":"#f0fdf4",borderColor:v.type==="error"?"#fecaca":"#bbf7d0",maxWidth:500,animation:"fadeIn 0.2s ease-out"},children:[i.jsx("span",{style:{fontSize:18,color:v.type==="error"?"#dc2626":"#16a34a",flexShrink:0},children:v.type==="error"?"":""}),i.jsx("span",{style:{fontSize:13,color:"#1f2937",lineHeight:1.4},children:v.message}),i.jsx("button",{onClick:y,style:{marginLeft:"auto",background:"none",border:"none",color:"#9ca3af",fontSize:18,cursor:"pointer",padding:"0 2px",lineHeight:1,flexShrink:0},children:""})]}),E&&i.jsx(D9,{projectId:e,projectCode:t,docTypeId:typeof E=="object"?E.docTypeId:E,instanceId:typeof E=="object"?E.instanceId:void 0,onClose:()=>O(null)}),D&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:i.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),i.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",i.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>L(!1),disabled:I,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),i.jsx("button",{onClick:K,disabled:I,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:I?"Deleting...":"Delete"})]})]})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function n3(e){return typeof e>"u"||e===null}function yB(e){return typeof e=="object"&&e!==null}function bB(e){return Array.isArray(e)?e:n3(e)?[]:[e]}function _B(e,t){var r,n,s,o;if(t)for(o=Object.keys(t),r=0,n=o.length;r<n;r+=1)s=o[r],e[s]=t[s];return e}function wB(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function jB(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var SB=n3,kB=yB,NB=bB,CB=wB,EB=jB,TB=_B,xt={isNothing:SB,isObject:kB,toArray:NB,repeat:CB,isNegativeZero:EB,extend:TB};function s3(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function la(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=s3(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}la.prototype=Object.create(Error.prototype);la.prototype.constructor=la;la.prototype.toString=function(t){return this.name+": "+s3(this,t)};var zt=la;function vx(e,t,r,n,s){var o="",a="",l=Math.floor(s/2)-1;return n-t>l&&(o=" ... ",t=n-l+o.length),r-n>l&&(a=" ...",r=n+l-a.length),{str:o+e.slice(t,r).replace(/\t/g,"")+a,pos:n-t+o.length}}function yx(e,t){return xt.repeat(" ",t-e.length)+e}function RB(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],s=[],o,a=-1;o=r.exec(e.buffer);)s.push(o.index),n.push(o.index+o[0].length),e.position<=o.index&&a<0&&(a=n.length-2);a<0&&(a=n.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,s.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(a-c<0);c++)d=vx(e.buffer,n[a-c],s[a-c],e.position-(n[a]-n[a-c]),f),l=xt.repeat(" ",t.indent)+yx((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=vx(e.buffer,n[a],s[a],e.position,f),l+=xt.repeat(" ",t.indent)+yx((e.line+1).toString(),u)+" | "+d.str+`
`,l+=xt.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(a+c>=s.length);c++)d=vx(e.buffer,n[a+c],s[a+c],e.position-(n[a]-n[a+c]),f),l+=xt.repeat(" ",t.indent)+yx((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var AB=RB,IB=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],PB=["scalar","sequence","mapping"];function OB(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function MB(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(IB.indexOf(r)===-1)throw new zt('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=OB(t.styleAliases||null),PB.indexOf(this.kind)===-1)throw new zt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Ct=MB;function uS(e,t){var r=[];return e[t].forEach(function(n){var s=r.length;r.forEach(function(o,a){o.tag===n.tag&&o.kind===n.kind&&o.multi===n.multi&&(s=a)}),r[s]=n}),r}function DB(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Gg(e){return this.extend(e)}Gg.prototype.extend=function(t){var r=[],n=[];if(t instanceof Ct)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new zt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(o){if(!(o instanceof Ct))throw new zt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&o.loadKind!=="scalar")throw new zt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new zt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(o){if(!(o instanceof Ct))throw new zt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Gg.prototype);return s.implicit=(this.implicit||[]).concat(r),s.explicit=(this.explicit||[]).concat(n),s.compiledImplicit=uS(s,"implicit"),s.compiledExplicit=uS(s,"explicit"),s.compiledTypeMap=DB(s.compiledImplicit,s.compiledExplicit),s};var o3=Gg,i3=new Ct("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),a3=new Ct("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),l3=new Ct("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),c3=new o3({explicit:[i3,a3,l3]});function LB(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function zB(){return null}function FB(e){return e===null}var u3=new Ct("tag:yaml.org,2002:null",{kind:"scalar",resolve:LB,construct:zB,predicate:FB,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function $B(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function qB(e){return e==="true"||e==="True"||e==="TRUE"}function BB(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var d3=new Ct("tag:yaml.org,2002:bool",{kind:"scalar",resolve:$B,construct:qB,predicate:BB,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function WB(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function HB(e){return 48<=e&&e<=55}function UB(e){return 48<=e&&e<=57}function VB(e){if(e===null)return!1;var t=e.length,r=0,n=!1,s;if(!t)return!1;if(s=e[r],(s==="-"||s==="+")&&(s=e[++r]),s==="0"){if(r+1===t)return!0;if(s=e[++r],s==="b"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(s!=="0"&&s!=="1")return!1;n=!0}return n&&s!=="_"}if(s==="x"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!WB(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}if(s==="o"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!HB(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}}if(s==="_")return!1;for(;r<t;r++)if(s=e[r],s!=="_"){if(!UB(e.charCodeAt(r)))return!1;n=!0}return!(!n||s==="_")}function GB(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function KB(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!xt.isNegativeZero(e)}var f3=new Ct("tag:yaml.org,2002:int",{kind:"scalar",resolve:VB,construct:GB,predicate:KB,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YB=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function XB(e){return!(e===null||!YB.test(e)||e[e.length-1]==="_")}function QB(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var ZB=/^[-+]?[0-9]+e/;function JB(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(xt.isNegativeZero(e))return"-0.0";return r=e.toString(10),ZB.test(r)?r.replace("e",".e"):r}function e7(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||xt.isNegativeZero(e))}var p3=new Ct("tag:yaml.org,2002:float",{kind:"scalar",resolve:XB,construct:QB,predicate:e7,represent:JB,defaultStyle:"lowercase"}),h3=c3.extend({implicit:[u3,d3,f3,p3]}),m3=h3,x3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),g3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function t7(e){return e===null?!1:x3.exec(e)!==null||g3.exec(e)!==null}function r7(e){var t,r,n,s,o,a,l,c=0,d=null,u,f,p;if(t=x3.exec(e),t===null&&(t=g3.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(r,n,s));if(o=+t[4],a=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(r,n,s,o,a,l,c)),d&&p.setTime(p.getTime()-d),p}function n7(e){return e.toISOString()}var v3=new Ct("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:t7,construct:r7,instanceOf:Date,represent:n7});function s7(e){return e==="<<"||e===null}var y3=new Ct("tag:yaml.org,2002:merge",{kind:"scalar",resolve:s7}),My=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function o7(e){if(e===null)return!1;var t,r,n=0,s=e.length,o=My;for(r=0;r<s;r++)if(t=o.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function i7(e){var t,r,n=e.replace(/[\r\n=]/g,""),s=n.length,o=My,a=0,l=[];for(t=0;t<s;t++)t%4===0&&t&&(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)),a=a<<6|o.indexOf(n.charAt(t));return r=s%4*6,r===0?(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)):r===18?(l.push(a>>10&255),l.push(a>>2&255)):r===12&&l.push(a>>4&255),new Uint8Array(l)}function a7(e){var t="",r=0,n,s,o=e.length,a=My;for(n=0;n<o;n++)n%3===0&&n&&(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]),r=(r<<8)+e[n];return s=o%3,s===0?(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]):s===2?(t+=a[r>>10&63],t+=a[r>>4&63],t+=a[r<<2&63],t+=a[64]):s===1&&(t+=a[r>>2&63],t+=a[r<<4&63],t+=a[64],t+=a[64]),t}function l7(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var b3=new Ct("tag:yaml.org,2002:binary",{kind:"scalar",resolve:o7,construct:i7,predicate:l7,represent:a7}),c7=Object.prototype.hasOwnProperty,u7=Object.prototype.toString;function d7(e){if(e===null)return!0;var t=[],r,n,s,o,a,l=e;for(r=0,n=l.length;r<n;r+=1){if(s=l[r],a=!1,u7.call(s)!=="[object Object]")return!1;for(o in s)if(c7.call(s,o))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(o)===-1)t.push(o);else return!1}return!0}function f7(e){return e!==null?e:[]}var _3=new Ct("tag:yaml.org,2002:omap",{kind:"sequence",resolve:d7,construct:f7}),p7=Object.prototype.toString;function h7(e){if(e===null)return!0;var t,r,n,s,o,a=e;for(o=new Array(a.length),t=0,r=a.length;t<r;t+=1){if(n=a[t],p7.call(n)!=="[object Object]"||(s=Object.keys(n),s.length!==1))return!1;o[t]=[s[0],n[s[0]]]}return!0}function m7(e){if(e===null)return[];var t,r,n,s,o,a=e;for(o=new Array(a.length),t=0,r=a.length;t<r;t+=1)n=a[t],s=Object.keys(n),o[t]=[s[0],n[s[0]]];return o}var w3=new Ct("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:h7,construct:m7}),x7=Object.prototype.hasOwnProperty;function g7(e){if(e===null)return!0;var t,r=e;for(t in r)if(x7.call(r,t)&&r[t]!==null)return!1;return!0}function v7(e){return e!==null?e:{}}var j3=new Ct("tag:yaml.org,2002:set",{kind:"mapping",resolve:g7,construct:v7}),Dy=m3.extend({implicit:[v3,y3],explicit:[b3,_3,w3,j3]}),Zn=Object.prototype.hasOwnProperty,Nc=1,S3=2,k3=3,Cc=4,bx=1,y7=2,dS=3,b7=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,_7=/[\x85\u2028\u2029]/,w7=/[,\[\]\{\}]/,N3=/^(?:!|!!|![a-z\-]+!)$/i,C3=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function fS(e){return Object.prototype.toString.call(e)}function Gr(e){return e===10||e===13}function bs(e){return e===9||e===32}function Vt(e){return e===9||e===32||e===10||e===13}function io(e){return e===44||e===91||e===93||e===123||e===125}function j7(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function S7(e){return e===120?2:e===117?4:e===85?8:0}function k7(e){return 48<=e&&e<=57?e-48:-1}function pS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function N7(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function E3(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var T3=new Array(256),R3=new Array(256);for(var qs=0;qs<256;qs++)T3[qs]=pS(qs)?1:0,R3[qs]=pS(qs);function C7(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Dy,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function A3(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=AB(r),new zt(t,r)}function me(e,t){throw A3(e,t)}function Ec(e,t){e.onWarning&&e.onWarning.call(null,A3(e,t))}var hS={YAML:function(t,r,n){var s,o,a;t.version!==null&&me(t,"duplication of %YAML directive"),n.length!==1&&me(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),s===null&&me(t,"ill-formed argument of the YAML directive"),o=parseInt(s[1],10),a=parseInt(s[2],10),o!==1&&me(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&Ec(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var s,o;n.length!==2&&me(t,"TAG directive accepts exactly two arguments"),s=n[0],o=n[1],N3.test(s)||me(t,"ill-formed tag handle (first argument) of the TAG directive"),Zn.call(t.tagMap,s)&&me(t,'there is a previously declared suffix for "'+s+'" tag handle'),C3.test(o)||me(t,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{me(t,"tag prefix is malformed: "+o)}t.tagMap[s]=o}};function Kn(e,t,r,n){var s,o,a,l;if(t<r){if(l=e.input.slice(t,r),n)for(s=0,o=l.length;s<o;s+=1)a=l.charCodeAt(s),a===9||32<=a&&a<=1114111||me(e,"expected valid JSON character");else b7.test(l)&&me(e,"the stream contains non-printable characters");e.result+=l}}function mS(e,t,r,n){var s,o,a,l;for(xt.isObject(r)||me(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(r),a=0,l=s.length;a<l;a+=1)o=s[a],Zn.call(t,o)||(E3(t,o,r[o]),n[o]=!0)}function ao(e,t,r,n,s,o,a,l,c){var d,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),d=0,u=s.length;d<u;d+=1)Array.isArray(s[d])&&me(e,"nested arrays are not supported inside keys"),typeof s=="object"&&fS(s[d])==="[object Object]"&&(s[d]="[object Object]");if(typeof s=="object"&&fS(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(o))for(d=0,u=o.length;d<u;d+=1)mS(e,t,o[d],r);else mS(e,t,o,r);else!e.json&&!Zn.call(r,s)&&Zn.call(t,s)&&(e.line=a||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,me(e,"duplicated mapping key")),E3(t,s,o),delete r[s];return t}function Ly(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):me(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function dt(e,t,r){for(var n=0,s=e.input.charCodeAt(e.position);s!==0;){for(;bs(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Gr(s))for(Ly(e),s=e.input.charCodeAt(e.position),n++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&Ec(e,"deficient indentation"),n}function Cu(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Vt(r)))}function zy(e,t){t===1?e.result+=" ":t>1&&(e.result+=xt.repeat(`
`,t-1))}function E7(e,t,r){var n,s,o,a,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Vt(h)||io(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(s=e.input.charCodeAt(e.position+1),Vt(s)||r&&io(s)))return!1;for(e.kind="scalar",e.result="",o=a=e.position,l=!1;h!==0;){if(h===58){if(s=e.input.charCodeAt(e.position+1),Vt(s)||r&&io(s))break}else if(h===35){if(n=e.input.charCodeAt(e.position-1),Vt(n))break}else{if(e.position===e.lineStart&&Cu(e)||r&&io(h))break;if(Gr(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,dt(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Kn(e,o,a,!1),zy(e,e.line-c),o=a=e.position,l=!1),bs(h)||(a=e.position+1),h=e.input.charCodeAt(++e.position)}return Kn(e,o,a,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function T7(e,t){var r,n,s;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=s=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Kn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,s=e.position;else return!0;else Gr(r)?(Kn(e,n,s,!0),zy(e,dt(e,!1,t)),n=s=e.position):e.position===e.lineStart&&Cu(e)?me(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);me(e,"unexpected end of the stream within a single quoted scalar")}function R7(e,t){var r,n,s,o,a,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Kn(e,r,e.position,!0),e.position++,!0;if(l===92){if(Kn(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Gr(l))dt(e,!1,t);else if(l<256&&T3[l])e.result+=R3[l],e.position++;else if((a=S7(l))>0){for(s=a,o=0;s>0;s--)l=e.input.charCodeAt(++e.position),(a=j7(l))>=0?o=(o<<4)+a:me(e,"expected hexadecimal character");e.result+=N7(o),e.position++}else me(e,"unknown escape sequence");r=n=e.position}else Gr(l)?(Kn(e,r,n,!0),zy(e,dt(e,!1,t)),r=n=e.position):e.position===e.lineStart&&Cu(e)?me(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}me(e,"unexpected end of the stream within a double quoted scalar")}function A7(e,t){var r=!0,n,s,o,a=e.tag,l,c=e.anchor,d,u,f,p,h,g=Object.create(null),x,_,v,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(dt(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=a,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;r?y===44&&me(e,"expected the node content, but found ','"):me(e,"missed comma between flow collection entries"),_=x=v=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Vt(d)&&(f=p=!0,e.position++,dt(e,!0,t))),n=e.line,s=e.lineStart,o=e.position,Ro(e,t,Nc,!1,!0),_=e.tag,x=e.result,dt(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===n)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),dt(e,!0,t),Ro(e,t,Nc,!1,!0),v=e.result),h?ao(e,l,g,_,x,v,n,s,o):f?l.push(ao(e,null,g,_,x,v,n,s,o)):l.push(x),dt(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}me(e,"unexpected end of the stream within a flow collection")}function I7(e,t){var r,n,s=bx,o=!1,a=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)bx===s?s=f===43?dS:y7:me(e,"repeat of a chomping mode identifier");else if((u=k7(f))>=0)u===0?me(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?me(e,"repeat of an indentation width identifier"):(l=t+u-1,a=!0);else break;if(bs(f)){do f=e.input.charCodeAt(++e.position);while(bs(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Gr(f)&&f!==0)}for(;f!==0;){for(Ly(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!a||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>l&&(l=e.lineIndent),Gr(f)){c++;continue}if(e.lineIndent<l){s===dS?e.result+=xt.repeat(`
`,o?1+c:c):s===bx&&o&&(e.result+=`
`);break}for(n?bs(f)?(d=!0,e.result+=xt.repeat(`
`,o?1+c:c)):d?(d=!1,e.result+=xt.repeat(`
`,c+1)):c===0?o&&(e.result+=" "):e.result+=xt.repeat(`
`,c):e.result+=xt.repeat(`
`,o?1+c:c),o=!0,a=!0,c=0,r=e.position;!Gr(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Kn(e,r,e.position,!1)}return!0}function xS(e,t){var r,n=e.tag,s=e.anchor,o=[],a,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,me(e,"tab characters must not be used in indentation")),!(c!==45||(a=e.input.charCodeAt(e.position+1),!Vt(a))));){if(l=!0,e.position++,dt(e,!0,-1)&&e.lineIndent<=t){o.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Ro(e,t,k3,!1,!0),o.push(e.result),dt(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)me(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=s,e.kind="sequence",e.result=o,!0):!1}function P7(e,t,r){var n,s,o,a,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,g=null,x=null,_=!1,v=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!_&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,me(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),o=e.line,(y===63||y===58)&&Vt(n))y===63?(_&&(ao(e,f,p,h,g,null,a,l,c),h=g=x=null),v=!0,_=!0,s=!0):_?(_=!1,s=!0):me(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=n;else{if(a=e.line,l=e.lineStart,c=e.position,!Ro(e,r,S3,!1,!0))break;if(e.line===o){for(y=e.input.charCodeAt(e.position);bs(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Vt(y)||me(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(ao(e,f,p,h,g,null,a,l,c),h=g=x=null),v=!0,_=!1,s=!1,h=e.tag,g=e.result;else if(v)me(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(v)me(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===o||e.lineIndent>t)&&(_&&(a=e.line,l=e.lineStart,c=e.position),Ro(e,t,Cc,!0,s)&&(_?g=e.result:x=e.result),_||(ao(e,f,p,h,g,x,a,l,c),h=g=x=null),dt(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&y!==0)me(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&ao(e,f,p,h,g,null,a,l,c),v&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),v}function O7(e){var t,r=!1,n=!1,s,o,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&me(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(r=!0,a=e.input.charCodeAt(++e.position)):a===33?(n=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,r){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(o=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):me(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Vt(a);)a===33&&(n?me(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),N3.test(s)||me(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);o=e.input.slice(t,e.position),w7.test(o)&&me(e,"tag suffix cannot contain flow indicator characters")}o&&!C3.test(o)&&me(e,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{me(e,"tag name is malformed: "+o)}return r?e.tag=o:Zn.call(e.tagMap,s)?e.tag=e.tagMap[s]+o:s==="!"?e.tag="!"+o:s==="!!"?e.tag="tag:yaml.org,2002:"+o:me(e,'undeclared tag handle "'+s+'"'),!0}function M7(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&me(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Vt(r)&&!io(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&me(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function D7(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Vt(n)&&!io(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&me(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Zn.call(e.anchorMap,r)||me(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],dt(e,!0,-1),!0}function Ro(e,t,r,n,s){var o,a,l,c=1,d=!1,u=!1,f,p,h,g,x,_;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=a=l=Cc===r||k3===r,n&&dt(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;O7(e)||M7(e);)dt(e,!0,-1)?(d=!0,l=o,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||s),(c===1||Cc===r)&&(Nc===r||S3===r?x=t:x=t+1,_=e.position-e.lineStart,c===1?l&&(xS(e,_)||P7(e,_,x))||A7(e,x)?u=!0:(a&&I7(e,x)||T7(e,x)||R7(e,x)?u=!0:D7(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&me(e,"alias node should not have any properties")):E7(e,x,Nc===r)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&xS(e,_))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&me(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(g=e.implicitTypes[f],g.resolve(e.result)){e.result=g.construct(e.result),e.tag=g.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Zn.call(e.typeMap[e.kind||"fallback"],e.tag))g=e.typeMap[e.kind||"fallback"][e.tag];else for(g=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){g=h[f];break}g||me(e,"unknown tag !<"+e.tag+">"),e.result!==null&&g.kind!==e.kind&&me(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+g.kind+'", not "'+e.kind+'"'),g.resolve(e.result,e.tag)?(e.result=g.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):me(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function L7(e){var t=e.position,r,n,s,o=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(dt(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(o=!0,a=e.input.charCodeAt(++e.position),r=e.position;a!==0&&!Vt(a);)a=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),s=[],n.length<1&&me(e,"directive name must not be less than one character in length");a!==0;){for(;bs(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Gr(a));break}if(Gr(a))break;for(r=e.position;a!==0&&!Vt(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(r,e.position))}a!==0&&Ly(e),Zn.call(hS,n)?hS[n](e,n,s):Ec(e,'unknown document directive "'+n+'"')}if(dt(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,dt(e,!0,-1)):o&&me(e,"directives end mark is expected"),Ro(e,e.lineIndent-1,Cc,!1,!0),dt(e,!0,-1),e.checkLineBreaks&&_7.test(e.input.slice(t,e.position))&&Ec(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Cu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,dt(e,!0,-1));return}if(e.position<e.length-1)me(e,"end of the stream or a document separator is expected");else return}function I3(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new C7(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,me(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)L7(r);return r.documents}function z7(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=I3(e,r);if(typeof t!="function")return n;for(var s=0,o=n.length;s<o;s+=1)t(n[s])}function F7(e,t){var r=I3(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new zt("expected a single document in the stream, but found more")}}var $7=z7,q7=F7,P3={loadAll:$7,load:q7},O3=Object.prototype.toString,M3=Object.prototype.hasOwnProperty,Fy=65279,B7=9,ca=10,W7=13,H7=32,U7=33,V7=34,Kg=35,G7=37,K7=38,Y7=39,X7=42,D3=44,Q7=45,Tc=58,Z7=61,J7=62,eW=63,tW=64,L3=91,z3=93,rW=96,F3=123,nW=124,$3=125,Mt={};Mt[0]="\\0";Mt[7]="\\a";Mt[8]="\\b";Mt[9]="\\t";Mt[10]="\\n";Mt[11]="\\v";Mt[12]="\\f";Mt[13]="\\r";Mt[27]="\\e";Mt[34]='\\"';Mt[92]="\\\\";Mt[133]="\\N";Mt[160]="\\_";Mt[8232]="\\L";Mt[8233]="\\P";var sW=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],oW=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function iW(e,t){var r,n,s,o,a,l,c;if(t===null)return{};for(r={},n=Object.keys(t),s=0,o=n.length;s<o;s+=1)a=n[s],l=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),c=e.compiledTypeMap.fallback[a],c&&M3.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[a]=l;return r}function aW(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new zt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+xt.repeat("0",n-t.length)+t}var lW=1,ua=2;function cW(e){this.schema=e.schema||Dy,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=xt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=iW(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?ua:lW,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function gS(e,t){for(var r=xt.repeat(" ",t),n=0,s=-1,o="",a,l=e.length;n<l;)s=e.indexOf(`
`,n),s===-1?(a=e.slice(n),n=l):(a=e.slice(n,s+1),n=s+1),a.length&&a!==`
`&&(o+=r),o+=a;return o}function Yg(e,t){return`
`+xt.repeat(" ",e.indent*t)}function uW(e,t){var r,n,s;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(s=e.implicitTypes[r],s.resolve(t))return!0;return!1}function Rc(e){return e===H7||e===B7}function da(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Fy||65536<=e&&e<=1114111}function vS(e){return da(e)&&e!==Fy&&e!==W7&&e!==ca}function yS(e,t,r){var n=vS(e),s=n&&!Rc(e);return(r?n:n&&e!==D3&&e!==L3&&e!==z3&&e!==F3&&e!==$3)&&e!==Kg&&!(t===Tc&&!s)||vS(t)&&!Rc(t)&&e===Kg||t===Tc&&s}function dW(e){return da(e)&&e!==Fy&&!Rc(e)&&e!==Q7&&e!==eW&&e!==Tc&&e!==D3&&e!==L3&&e!==z3&&e!==F3&&e!==$3&&e!==Kg&&e!==K7&&e!==X7&&e!==U7&&e!==nW&&e!==Z7&&e!==J7&&e!==Y7&&e!==V7&&e!==G7&&e!==tW&&e!==rW}function fW(e){return!Rc(e)&&e!==Tc}function ji(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function q3(e){var t=/^\n* /;return t.test(e)}var B3=1,Xg=2,W3=3,H3=4,Us=5;function pW(e,t,r,n,s,o,a,l){var c,d=0,u=null,f=!1,p=!1,h=n!==-1,g=-1,x=dW(ji(e,0))&&fW(ji(e,e.length-1));if(t||a)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=ji(e,c),!da(d))return Us;x=x&&yS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=ji(e,c),d===ca)f=!0,h&&(p=p||c-g-1>n&&e[g+1]!==" ",g=c);else if(!da(d))return Us;x=x&&yS(d,u,l),u=d}p=p||h&&c-g-1>n&&e[g+1]!==" "}return!f&&!p?x&&!a&&!s(e)?B3:o===ua?Us:Xg:r>9&&q3(e)?Us:a?o===ua?Us:Xg:p?H3:W3}function hW(e,t,r,n,s){e.dump=function(){if(t.length===0)return e.quotingType===ua?'""':"''";if(!e.noCompatMode&&(sW.indexOf(t)!==-1||oW.test(t)))return e.quotingType===ua?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,r),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(d){return uW(e,d)}switch(pW(t,l,e.indent,a,c,e.quotingType,e.forceQuotes&&!n,s)){case B3:return t;case Xg:return"'"+t.replace(/'/g,"''")+"'";case W3:return"|"+bS(t,e.indent)+_S(gS(t,o));case H3:return">"+bS(t,e.indent)+_S(gS(mW(t,a),o));case Us:return'"'+xW(t)+'"';default:throw new zt("impossible error: invalid scalar style")}}()}function bS(e,t){var r=q3(e)?String(t):"",n=e[e.length-1]===`
`,s=n&&(e[e.length-2]===`
`||e===`
`),o=s?"+":n?"":"-";return r+o+`
`}function _S(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function mW(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,r.lastIndex=d,wS(e.slice(0,d),t)}(),s=e[0]===`
`||e[0]===" ",o,a;a=r.exec(e);){var l=a[1],c=a[2];o=c[0]===" ",n+=l+(!s&&!o&&c!==""?`
`:"")+wS(c,t),s=o}return n}function wS(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,s=0,o,a=0,l=0,c="";n=r.exec(e);)l=n.index,l-s>t&&(o=a>s?a:l,c+=`
`+e.slice(s,o),s=o+1),a=l;return c+=`
`,e.length-s>t&&a>s?c+=e.slice(s,a)+`
`+e.slice(a+1):c+=e.slice(s),c.slice(1)}function xW(e){for(var t="",r=0,n,s=0;s<e.length;r>=65536?s+=2:s++)r=ji(e,s),n=Mt[r],!n&&da(r)?(t+=e[s],r>=65536&&(t+=e[s+1])):t+=n||aW(r);return t}function gW(e,t,r){var n="",s=e.tag,o,a,l;for(o=0,a=r.length;o<a;o+=1)l=r[o],e.replacer&&(l=e.replacer.call(r,String(o),l)),(vn(e,t,l,!1,!1)||typeof l>"u"&&vn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=s,e.dump="["+n+"]"}function jS(e,t,r,n){var s="",o=e.tag,a,l,c;for(a=0,l=r.length;a<l;a+=1)c=r[a],e.replacer&&(c=e.replacer.call(r,String(a),c)),(vn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&vn(e,t+1,null,!0,!0,!1,!0))&&((!n||s!=="")&&(s+=Yg(e,t)),e.dump&&ca===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=o,e.dump=s||"[]"}function vW(e,t,r){var n="",s=e.tag,o=Object.keys(r),a,l,c,d,u;for(a=0,l=o.length;a<l;a+=1)u="",n!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=o[a],d=r[c],e.replacer&&(d=e.replacer.call(r,c,d)),vn(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),vn(e,t,d,!1,!1)&&(u+=e.dump,n+=u));e.tag=s,e.dump="{"+n+"}"}function yW(e,t,r,n){var s="",o=e.tag,a=Object.keys(r),l,c,d,u,f,p;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new zt("sortKeys must be a boolean or a function");for(l=0,c=a.length;l<c;l+=1)p="",(!n||s!=="")&&(p+=Yg(e,t)),d=a[l],u=r[d],e.replacer&&(u=e.replacer.call(r,d,u)),vn(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&ca===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Yg(e,t)),vn(e,t+1,u,!0,f)&&(e.dump&&ca===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,s+=p));e.tag=o,e.dump=s||"{}"}function SS(e,t,r){var n,s,o,a,l,c;for(s=r?e.explicitTypes:e.implicitTypes,o=0,a=s.length;o<a;o+=1)if(l=s[o],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,O3.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(M3.call(l.represent,c))n=l.represent[c](t,c);else throw new zt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function vn(e,t,r,n,s,o,a){e.tag=null,e.dump=r,SS(e,r,!1)||SS(e,r,!0);var l=O3.call(e.dump),c=n,d;n&&(n=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(r),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(s=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(yW(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(vW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?jS(e,t-1,e.dump,s):jS(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(gW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&hW(e,e.dump,t,o,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new zt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function bW(e,t){var r=[],n=[],s,o;for(Qg(e,r,n),s=0,o=n.length;s<o;s+=1)t.duplicates.push(r[n[s]]);t.usedDuplicates=new Array(o)}function Qg(e,t,r){var n,s,o;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)r.indexOf(s)===-1&&r.push(s);else if(t.push(e),Array.isArray(e))for(s=0,o=e.length;s<o;s+=1)Qg(e[s],t,r);else for(n=Object.keys(e),s=0,o=n.length;s<o;s+=1)Qg(e[n[s]],t,r)}function _W(e,t){t=t||{};var r=new cW(t);r.noRefs||bW(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),vn(r,0,n,!0,!0)?r.dump+`
`:""}var wW=_W,jW={dump:wW};function $y(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var SW=Ct,kW=o3,NW=c3,CW=h3,EW=m3,TW=Dy,RW=P3.load,AW=P3.loadAll,IW=jW.dump,PW=zt,OW={binary:b3,float:p3,map:l3,null:u3,pairs:w3,set:j3,timestamp:v3,bool:d3,int:f3,merge:y3,omap:_3,seq:a3,str:i3},MW=$y("safeLoad","load"),DW=$y("safeLoadAll","loadAll"),LW=$y("safeDump","dump"),qy={Type:SW,Schema:kW,FAILSAFE_SCHEMA:NW,JSON_SCHEMA:CW,CORE_SCHEMA:EW,DEFAULT_SCHEMA:TW,load:RW,loadAll:AW,dump:IW,YAMLException:PW,types:OW,safeLoad:MW,safeLoadAll:DW,safeDump:LW};function kS({messages:e,pendingPrompt:t,introContent:r}){const n=m.useRef(null);return m.useEffect(()=>{var s;(s=n.current)==null||s.scrollIntoView({behavior:"smooth"})},[e,t]),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",onWheel:s=>s.stopPropagation(),children:[r,e.map((s,o)=>i.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${s.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:s.content})},o)),t&&i.jsx("div",{className:"flex justify-start",children:i.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),i.jsx("div",{ref:n})]})}function zW({onSubmit:e,disabled:t,placeholder:r}){const[n,s]=m.useState(""),o=m.useRef(null);m.useEffect(()=>{var c;t||(c=o.current)==null||c.focus()},[t]);const a=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),s("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),s(""))};return i.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("textarea",{ref:o,value:n,onChange:c=>s(c.target.value),onKeyDown:a,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),i.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),i.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const NS={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function FW({type:e,className:t}){switch(e){case"check":return i.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return i.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M12 9v4M12 17h.01"}),i.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return i.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return i.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),i.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function $W({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const s=NS[e]||NS.blocked,o=e==="qualified";return i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:`w-16 h-16 rounded-full ${s.iconBg} flex items-center justify-center mx-auto mb-4`,children:i.jsx(FW,{type:s.icon,className:`w-8 h-8 ${s.iconColor}`})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:s.title}),i.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:s.description}),o&&t&&i.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[i.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),i.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),i.jsxs("div",{className:"flex gap-2 justify-center",children:[o&&t&&i.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),i.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function qW({operation:e,context:t,onSubmit:r,onCancel:n}){var _;const[s,o]=m.useState("confirm"),[a,l]=m.useState(!1),[c,d]=m.useState((t==null?void 0:t.project_type)||""),[u,f]=m.useState(""),h=((e==null?void 0:e.config)||{}).entry_prompt||"Review the intake classification.",g=[{value:"greenfield",label:"Greenfield (New Project)"},{value:"enhancement",label:"Enhancement (Existing Project)"},{value:"migration",label:"Migration"},{value:"integration",label:"Integration"},{value:"unknown",label:"Unknown / Other"}],x=()=>{l(!0);const v={confirmed:s==="confirm",timestamp:new Date().toISOString()};s==="correct"&&(v.corrected_project_type=c),u.trim()&&(v.notes=u.trim()),r(v)};return i.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-green, #22c55e)",color:"#fff"},children:"Intake"}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Concierge Entry"}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirm or correct the intake classification"})]})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",onWheel:v=>v.stopPropagation(),children:i.jsxs("div",{className:"max-w-2xl space-y-6",children:[i.jsx("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:i.jsx("div",{className:"text-sm",style:{color:"var(--text-primary)"},children:h})}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirmation requested"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Classification Result"}),i.jsxs("div",{className:"p-4 rounded space-y-3",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Intent Classification"}),i.jsx("span",{className:"px-3 py-1 rounded font-semibold",style:{background:"var(--accent-primary, #3b82f6)",color:"#fff",fontSize:12},children:((_=t==null?void 0:t.project_type)==null?void 0:_.replace(/_/g," ").toUpperCase())||"Unknown"})]}),(t==null?void 0:t.artifact_type)&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Artifact Type"}),i.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.artifact_type.replace(/_/g," ")})]}),(t==null?void 0:t.audience)&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Audience"}),i.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.audience})]}),(t==null?void 0:t.intake_summary)&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Summary"}),i.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.intake_summary})]}),(t==null?void 0:t.classification_rationale)&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Rationale"}),i.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:t.classification_rationale})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Your Decision"}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>o("confirm"),className:"flex-1 p-4 rounded text-left",style:{background:s==="confirm"?"rgba(34, 197, 94, 0.1)":"var(--bg-panel)",border:s==="confirm"?"2px solid #22c55e":"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Confirm"}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"The classification is correct"})]}),i.jsxs("button",{onClick:()=>o("correct"),className:"flex-1 p-4 rounded text-left",style:{background:s==="correct"?"rgba(249, 115, 22, 0.1)":"var(--bg-panel)",border:s==="correct"?"2px solid #f97316":"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Correct"}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"I need to change the classification before proceeding"})]})]})]}),s==="correct"&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Correct Intent Classification"}),i.jsxs("select",{value:c,onChange:v=>d(v.target.value),className:"w-full p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[i.jsx("option",{value:"",children:"Select intent classification..."}),g.map(v=>i.jsx("option",{value:v.value,children:v.label},v.value))]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Notes (Optional)"}),i.jsx("textarea",{value:u,onChange:v=>f(v.target.value),placeholder:"Add any additional context or notes...",className:"w-full p-3 rounded text-sm",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:80,resize:"vertical"}})]})]})}),i.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[n&&i.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:"Cancel"}),i.jsxs("button",{onClick:x,disabled:a||s==="correct"&&!c,className:"px-4 py-2 rounded text-sm font-semibold flex items-center gap-2",style:{background:s==="confirm"?"#22c55e":"#f97316",color:"#fff",opacity:a||s==="correct"&&!c?.5:1},children:[a&&i.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="confirm"?"Confirm Classification":"Submit Correction"]})]})]})}function BW({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:s,gateOutcome:o,project:a,error:l,loading:c,submitting:d,intakeClassification:u,intakeGatePhase:f,operationalError:p,startIntake:h,submitMessage:g,retryLastMessage:x,reset:_}=uB(),[v,y]=m.useState(null);m.useEffect(()=>(h(),fetch("/content/concierge-intro.yaml").then(S=>S.text()).then(S=>y(qy.load(S))).catch(S=>console.error("Failed to load intro content:",S)),()=>_()),[]);const b=()=>{_(),e()},j=()=>{a&&t&&t(a),b()},N=S=>{g(JSON.stringify(S))},T=()=>{const S=[{id:"describe",label:"Describe"},{id:"confirm",label:"Confirm"},{id:"complete",label:"Done"}];let w=r;f==="awaiting_confirmation"&&(w="confirm"),(w==="review"||w==="generating")&&(w="complete");const A=S.findIndex(E=>E.id===w);return i.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:S.map((E,O)=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`px-2 py-0.5 rounded ${O===A?"bg-violet-500/30 text-violet-300":O<A?"text-emerald-400":"text-slate-500"}`,children:E.label}),O<S.length-1&&i.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},E.id))})},C=()=>{var S;if(c&&r==="idle")return i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});if(p)return i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-6 text-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-500/20 flex items-center justify-center",children:i.jsxs("svg",{className:"w-6 h-6 text-amber-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),i.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),i.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"The AI provider is temporarily unavailable."}),i.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"This is usually resolved within a few moments."})]}),i.jsx("button",{onClick:x,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors bg-violet-500/20 hover:bg-violet-500/30",style:{color:"var(--text-primary)"},children:"Retry"})]});if(f==="awaiting_confirmation"&&u)return i.jsx(qW,{operation:{config:{entry_prompt:s}},context:u,onSubmit:N,onCancel:b});switch(r){case"describe":const w=v?i.jsxs("div",{className:"mb-4 pb-4 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("h3",{className:"text-base font-semibold mb-3",style:{color:"var(--text-primary)"},children:v.title}),i.jsx("div",{className:"text-sm space-y-3",style:{color:"var(--text-secondary)"},children:(S=v.paragraphs)==null?void 0:S.map((A,E)=>i.jsx("p",{children:A},E))}),v.call_to_action&&i.jsx("p",{className:"text-sm font-medium mt-4",style:{color:"var(--text-primary)"},children:v.call_to_action})]}):null;return i.jsxs(i.Fragment,{children:[i.jsx(kS,{messages:n,pendingPrompt:s,introContent:w}),i.jsx(zW,{onSubmit:g,disabled:d,placeholder:"Describe what you want to build..."})]});case"complete":return i.jsxs(i.Fragment,{children:[i.jsx(kS,{messages:n}),i.jsx($W,{gateOutcome:o,project:a,onViewProject:j,onClose:b})]});default:return null}};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:i.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},onWheel:S=>S.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),T()]})]}),i.jsx("button",{onClick:b,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l&&i.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:l}),C()]})})}function WW({onClose:e}){const{user:t,logout:r,isAdmin:n}=Ms(),[s,o]=m.useState(null),[a,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{s==="linked"&&p()},[s]);const p=async()=>{try{d(!0);const N=await fetch("/auth/accounts",{credentials:"include"});if(N.ok){const T=await N.json();l(T.identities||[])}}catch(N){console.error("Failed to load accounts:",N)}finally{d(!1)}},h=N=>{window.location.href=`/auth/accounts/link/${N}`},g=async N=>{var T;if(a.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${N} account?`))try{const C=(T=document.cookie.split("; ").find(w=>w.startsWith("csrf=")||w.startsWith("__Host-csrf=")))==null?void 0:T.split("=")[1],S=await fetch(`/auth/accounts/${N}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":C||""}});if(S.ok)f({type:"success",text:"Account unlinked"}),await p();else{const w=await S.json();throw new Error(w.detail||"Failed to unlink")}}catch(C){f({type:"error",text:C.message})}},x=async()=>{await r(),e()},_=N=>{o(s===N?null:N),f(null)},v={google:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[i.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),i.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),i.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),i.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[i.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),i.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),i.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),i.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=N=>{const T={user:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),i.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"9",cy:"7",r:"4"}),i.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),i.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),i.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"3"}),i.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return T[N]||T.user},j=N=>{switch(N){case"account":return i.jsxs("div",{className:"px-4 py-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),i.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),i.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return i.jsxs("div",{className:"px-4 py-3",children:[u&&i.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?i.jsx("div",{className:"flex items-center justify-center py-4",children:i.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"space-y-2 mb-4",children:a.map(T=>i.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[v[T.provider_id],i.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:T.provider_email})]}),i.jsx("button",{onClick:()=>g(T.provider_id),disabled:a.length<=1,className:`text-xs px-2 py-1 rounded ${a.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},T.provider_id))}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),i.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.google,"Google"]}),i.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.microsoft,"Microsoft"]})]})]})]});default:return i.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),i.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?i.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):i.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsxs("div",{className:"flex-1 overflow-hidden",children:[i.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),i.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),i.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&i.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),i.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[i.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),i.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),i.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),i.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[i.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),i.jsx("polyline",{points:"14 2 14 8 20 8"}),i.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),i.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),i.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),i.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(N=>i.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[i.jsxs("button",{onClick:()=>!N.future&&_(N.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${N.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:N.future,children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:b(N.icon)}),i.jsx("span",{className:"flex-1 text-sm text-left",children:N.label}),N.future?i.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):i.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:s===N.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),s===N.id&&!N.future&&i.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:j(N.id)})]},N.id))]}),i.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsxs("button",{onClick:x,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),i.jsx("polyline",{points:"16 17 21 12 16 7"}),i.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const De={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function HW(){return i.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:De.bg,borderColor:De.border},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:De.textPrimary},children:"THE COMBINE"}),i.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:De.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function UW(){return i.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:De.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),i.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:De.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),i.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:De.textMuted},onMouseOver:e=>e.currentTarget.style.color=De.textSecondary,onMouseOut:e=>e.currentTarget.style.color=De.textMuted,children:["Learn how The Combine works",i.jsx("span",{"aria-hidden":"true",children:""})]})]})}function VW(){const e=[{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return i.jsx("section",{className:"max-w-4xl mx-auto",children:i.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>i.jsxs("div",{className:"flex-1 text-center group",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:De.bgElevated,border:`1px solid ${De.border}`,color:De.textMuted},children:t.icon}),i.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:De.textPrimary},children:t.title}),i.jsx("p",{className:"text-xs",style:{color:De.textMuted},children:t.description}),r<e.length-1&&i.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:De.border}})]},r))})})}function GW(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return i.jsx("section",{className:"text-center",children:i.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>i.jsx("span",{className:"text-xs",style:{color:De.textMuted},children:t},r))})})}function KW({onLogin:e}){return i.jsxs("section",{className:"text-center",children:[i.jsx("p",{className:"text-sm font-medium mb-4",style:{color:De.textSecondary},children:"Ready?"}),i.jsxs("div",{className:"inline-flex flex-col gap-3",children:[i.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:De.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=De.accentHover,onMouseOut:t=>t.currentTarget.style.background=De.accent,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[i.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),i.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),i.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),i.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),i.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:De.bg,border:`1px solid ${De.border}`,color:De.textPrimary},onMouseOver:t=>t.currentTarget.style.background=De.bgElevated,onMouseOut:t=>t.currentTarget.style.background=De.bg,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[i.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),i.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),i.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),i.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function YW(){return i.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[i.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:De.textSubtle},onMouseOver:e=>e.currentTarget.style.color=De.textMuted,onMouseOut:e=>e.currentTarget.style.color=De.textSubtle,children:"Terms"}),i.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:De.textSubtle},onMouseOver:e=>e.currentTarget.style.color=De.textMuted,onMouseOut:e=>e.currentTarget.style.color=De.textSubtle,children:"Privacy"}),i.jsx("span",{className:"text-xs",style:{color:De.border},children:" 2026 The Combine"})]})}function XW(){const{login:e}=Ms();return i.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:De.bg},children:[i.jsx(HW,{}),i.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:i.jsxs("div",{className:"space-y-12",children:[i.jsx(UW,{}),i.jsx(VW,{}),i.jsx(GW,{}),i.jsx(KW,{onLogin:e})]})}),i.jsx(YW,{})]})}const Oe={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function QW(){return i.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Oe.bg,borderColor:Oe.border},children:[i.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Oe.textMuted},onMouseOver:e=>e.currentTarget.style.color=Oe.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Oe.textMuted,children:[i.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),i.jsx("span",{className:"text-sm",children:"Back"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),i.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Oe.textPrimary},children:"THE COMBINE"})]}),i.jsx("div",{className:"w-16"})," "]})}function os({title:e,children:t}){return i.jsxs("section",{className:"mb-16",children:[e&&i.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Oe.textPrimary},children:e}),t]})}function vt({children:e,className:t=""}){return i.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Oe.textSecondary},children:e})}function si({children:e}){return i.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Oe.textPrimary,borderLeft:`2px solid ${Oe.border}`},children:e})}function ul({items:e}){return i.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>i.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Oe.textSecondary},children:[i.jsx("span",{style:{color:Oe.textMuted},children:"-"}),t]},r))})}function dl({number:e,title:t,children:r}){return i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[i.jsxs("span",{className:"text-sm font-mono",style:{color:Oe.textMuted},children:[e,"."]}),i.jsx("h3",{className:"text-base font-medium",style:{color:Oe.textPrimary},children:t})]}),i.jsx("div",{className:"pl-7",children:i.jsx(vt,{children:r})})]})}function fl({title:e,children:t}){return i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Oe.textPrimary},children:e}),i.jsx(vt,{className:"mb-0",children:t})]})}function ZW({onLogin:e}){return i.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Oe.bgElevated,border:`1px solid ${Oe.border}`},children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Oe.textPrimary},children:"When You're Ready"}),i.jsx(vt,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),i.jsx(vt,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),i.jsx(vt,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),i.jsxs("div",{className:"inline-flex flex-col gap-3",children:[i.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Oe.accentHover,onMouseOut:t=>t.currentTarget.style.background=Oe.accent,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[i.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),i.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),i.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),i.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),i.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.bg,border:`1px solid ${Oe.border}`,color:Oe.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Oe.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Oe.bg,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[i.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),i.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),i.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),i.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function JW(){return i.jsxs("footer",{className:"py-8 text-center",children:[i.jsx("p",{className:"text-sm mb-6",style:{color:Oe.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),i.jsxs("div",{className:"flex items-center justify-center gap-6",children:[i.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Terms"}),i.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Privacy"}),i.jsx("span",{className:"text-xs",style:{color:Oe.border},children:" 2026 The Combine"})]})]})}function eH(){const{login:e}=Ms();return i.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Oe.bg},children:[i.jsx(QW,{}),i.jsx("main",{className:"flex-1 px-6 py-12",children:i.jsxs("article",{className:"max-w-2xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Oe.textPrimary},children:"Learn More"}),i.jsxs(os,{title:"What The Combine Is",children:[i.jsx(vt,{children:"The Combine is an AI-assisted production system for knowledge work."}),i.jsx(vt,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),i.jsx(si,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),i.jsx(si,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),i.jsxs(os,{title:"Why It Exists",children:[i.jsx(vt,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),i.jsx(vt,{children:"It breaks down when the work must be:"}),i.jsx(ul,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),i.jsx(vt,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),i.jsxs(os,{title:'Why "The Combine"',children:[i.jsx(vt,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),i.jsx(vt,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),i.jsx(vt,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),i.jsx(vt,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),i.jsx(vt,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),i.jsx(ul,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),i.jsx(vt,{children:"This is not automation for speed. It is industrialization for reliability."}),i.jsx(si,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),i.jsxs(os,{title:"How It Works",children:[i.jsx(dl,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),i.jsx(dl,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),i.jsx(dl,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),i.jsx(dl,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),i.jsxs(os,{title:"What Makes It Different",children:[i.jsx(fl,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),i.jsx(fl,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),i.jsx(fl,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),i.jsx(fl,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),i.jsxs(os,{title:"What The Combine Is Not",children:[i.jsx(ul,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),i.jsx(vt,{children:"If you want improvisation, there are better tools."}),i.jsx(si,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),i.jsxs(os,{title:"Who It's For",children:[i.jsx(vt,{children:"The Combine is designed for people responsible for outcomes, including:"}),i.jsx(ul,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),i.jsx(si,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),i.jsx(ZW,{onLogin:e})]})}),i.jsx(JW,{})]})}function U3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getTemplates();t(l.templates||[])}catch(l){o(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{templates:e,loading:r,error:s,refresh:a}}function tH(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){o(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{workflows:e,loading:r,error:s,refresh:a}}function V3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getSchemas();t(l.schemas||[])}catch(l){o(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{schemas:e,loading:r,error:s,refresh:a}}function G3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){n(!0),o(null);try{const h=await we.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&o(h.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return p(),()=>{f=!1}},[]);const a=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:a.role.length,task:a.task.length,qa:a.qa.length,pgc:a.pgc.length,questions:a.questions.length,reflection:a.reflection.length}),[e,a]),c=m.useCallback(f=>!f||f==="all"?e:a[f]||[],[e,a]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{n(!0),o(null);try{const f=await we.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),o(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:s,fragmentsByKind:a,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const _x="doctype-browser-collapsed";function K3(e,t){const[r,n]=m.useState(()=>{try{const o=JSON.parse(localStorage.getItem(_x)||"{}");return e in o?o[e]:t}catch{return t}}),s=m.useCallback(o=>{const a=typeof o=="function"?o(r):o;n(a);try{const l=JSON.parse(localStorage.getItem(_x)||"{}");l[e]=a,localStorage.setItem(_x,JSON.stringify(l))}catch{}},[e,r]);return[r,s]}function CS({title:e,defaultOpen:t=!0,children:r}){const[n,s]=K3(`group:${e}`,t);return i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>s(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[i.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function ES({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:s}){const[o,a]=K3(`sub:${e}`,r);return i.jsxs("div",{children:[i.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[i.jsxs("button",{onClick:()=>a(!o),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[i.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&i.jsx("span",{style:{color:n,fontSize:8},children:""}),i.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),o&&s]})}function TS({selected:e,onClick:t,label:r,sublabel:n,badge:s}){return i.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-medium truncate",children:r}),s&&i.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:s})]}),n&&i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function RS({loading:e,empty:t,emptyMessage:r="None found"}){return e?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function rH({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:s=[],promptFragmentKindOptions:o=[],schemas:a=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:g=null,selectedRole:x=null,selectedTemplate:_=null,selectedWorkflow:v=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:j,onSelectRole:N,onSelectTemplate:T,onSelectWorkflow:C,onSelectFragment:S,onSelectStandaloneSchema:w,onCreateWorkflow:A,onCreateDocType:E,onCreateFragment:O,onCreateTemplate:z,onCreateSchema:k,onSelectTask:P,onSelectSchema:R,workspaceState:D=null}){var Ne;const[L,I]=m.useState(null),[M,F]=m.useState(null),[q,H]=m.useState(""),[V,Z]=m.useState(!1),[B,re]=m.useState(!1),[oe,X]=m.useState(""),[Q,fe]=m.useState(!1),xe=[...e].sort((ne,Se)=>(ne.display_name||"").localeCompare(Se.display_name||"")),be=n.filter(ne=>(ne.pow_class||"reference")==="reference"),ye=ne=>{const Se=ne.pow_class||"reference";return Se==="reference"?"ref":Se==="template"?"tpl":"inst"},ae=e.filter(ne=>ne.active_version).length+n.filter(ne=>ne.active_version).length,K=((Ne=D==null?void 0:D.modified_artifacts)==null?void 0:Ne.length)??0,te=(D==null?void 0:D.is_dirty)??!1,ee=()=>{I(null),F(null),H("")},ke=()=>{re(!1),X("")},je=async()=>{const ne=oe.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){fe(!0);try{await(E==null?void 0:E({doc_type_id:ne})),ke()}catch{}finally{fe(!1)}}},Te=async()=>{const ne=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){Z(!0);try{const Se={workflow_id:ne,pow_class:"template"};M&&(Se.derived_from={workflow_id:M.workflow_id,version:M.active_version},Se.source_version=M.active_version),await(A==null?void 0:A(Se)),ee()}catch{}finally{Z(!1)}}};return i.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs(CS,{title:"Production Workflows",defaultOpen:!0,children:[i.jsxs(ES,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:A&&i.jsx("button",{onClick:()=>I(L?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[L==="choose"&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsxs("button",{onClick:()=>I("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:be.length===0,children:["From Reference",be.length===0?" (none available)":""]}),i.jsx("button",{onClick:()=>I("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),i.jsx("button",{onClick:ee,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),L==="from_reference"&&!M&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),be.map(ne=>i.jsxs("button",{onClick:()=>F(ne),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[i.jsx("div",{className:"font-medium",children:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,Se=>Se.toUpperCase())}),i.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",ne.active_version]})]},ne.workflow_id)),i.jsx("button",{onClick:()=>I("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(L==="blank"||L==="from_reference"&&M)&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[M&&i.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",M.name||M.workflow_id," v",M.active_version]}),i.jsx("input",{type:"text",value:q,onChange:ne=>H(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&Te(),ne.key==="Escape"&&ee()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:V,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:Te,disabled:V||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:V?"wait":"pointer",opacity:!q.trim()||V?.5:1},children:V?"Creating...":"Create"}),i.jsx("button",{onClick:ee,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(RS,{loading:u,empty:!u&&n.length===0,emptyMessage:"No workflows"}),!u&&n.length>0&&i.jsx("div",{className:"py-1",children:n.map(ne=>i.jsx(TS,{selected:(v==null?void 0:v.workflow_id)===ne.workflow_id,onClick:()=>C==null?void 0:C(ne),label:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,Se=>Se.toUpperCase()),sublabel:`v${ne.active_version}`,badge:ye(ne)},ne.workflow_id))})]}),i.jsxs(ES,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:E&&i.jsx("button",{onClick:()=>re(!B),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[B&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("input",{type:"text",value:oe,onChange:ne=>X(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&je(),ne.key==="Escape"&&ke()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:Q,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:je,disabled:Q||!oe.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Q?"wait":"pointer",opacity:!oe.trim()||Q?.5:1},children:Q?"Creating...":"Create"}),i.jsx("button",{onClick:ke,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(RS,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&xe.length>0&&i.jsx("div",{className:"py-1",children:xe.map(ne=>i.jsx(TS,{selected:g==="docworkflow"&&(h==null?void 0:h.doc_type_id)===ne.doc_type_id,onClick:()=>j==null?void 0:j(ne),label:ne.display_name,badge:`v${ne.active_version}`},ne.doc_type_id))})]})]}),i.jsxs(CS,{title:"Governance",defaultOpen:!1,children:[i.jsx("div",{className:"px-4 py-3",children:i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),i.jsxs("div",{children:[ae," active ",ae===1?"release":"releases"]})]})}),D&&i.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),te&&i.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[K," dirty"]})]})]})]})})}function nH({kinds:e=[],selectedKind:t="all",onSelect:r}){return i.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:s,count:o})=>{const a=t===n;return i.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:a?"var(--action-primary)":"var(--bg-panel)",color:a?"#000":"var(--text-secondary)",border:a?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[s,o!==void 0&&i.jsxs("span",{style:{marginLeft:4,opacity:a?.7:.6},children:["(",o,")"]})]},n)})})}function pl({title:e,count:t,dotColor:r,defaultOpen:n=!1,action:s,children:o}){const[a,l]=m.useState(n);return i.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[i.jsxs("button",{onClick:()=>l(!a),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{style:{color:"var(--text-muted)",transform:a?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),i.jsx("span",{style:{color:r,fontSize:10},children:""}),i.jsx("span",{className:"font-semibold",children:e})]}),i.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),s&&i.jsx("div",{className:"pr-3",children:s})]}),a&&i.jsx("div",{style:{background:"var(--bg-panel)"},children:o})]})}function oi({onClick:e,label:t,sublabel:r,badge:n,isSelected:s}){return i.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:s?"var(--bg-selected, rgba(99, 102, 241, 0.15))":"transparent",border:"none",borderLeft:s?"3px solid var(--action-primary)":"3px solid transparent",color:s?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer"},children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-medium truncate",children:t}),n&&i.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:n})]}),r&&i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function hl({loading:e,empty:t,emptyMessage:r="None found"}){return e?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function sH({isOpen:e,onClose:t,promptFragments:r=[],promptFragmentKindOptions:n=[],templates:s=[],schemas:o=[],documentTypes:a=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,selectedFragment:h=null,selectedTemplate:g=null,selectedSchema:x=null,selectedMechanicalOp:_=null,onSelectFragment:v,onSelectTemplate:y,onSelectSchema:b,onSelectStandaloneSchema:j,onSelectMechanicalOp:N,onCreateFragment:T,onCreateTemplate:C,onCreateSchema:S}){const[w,A]=m.useState("all"),[E,O]=m.useState(!1),[z,k]=m.useState("role"),[P,R]=m.useState(""),[D,L]=m.useState(!1),[I,M]=m.useState(!1),[F,q]=m.useState(""),[H,V]=m.useState(!1),[Z,B]=m.useState(!1),[re,oe]=m.useState(""),[X,Q]=m.useState(!1),fe=w==="all"?r:r.filter(K=>K.kind===w);m.useEffect(()=>{e||(O(!1),M(!1),B(!1),R(""),q(""),oe(""))},[e]);const xe=m.useCallback((K,te)=>{K==null||K(te)},[]),be=async()=>{const K=P.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){L(!0);try{await(T==null?void 0:T({role_id:K,kind:z})),O(!1),R("")}catch{}finally{L(!1)}}},ye=async()=>{const K=F.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){V(!0);try{await(C==null?void 0:C({template_id:K})),M(!1),q("")}catch{}finally{V(!1)}}},ae=async()=>{const K=re.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){Q(!0);try{await(S==null?void 0:S({schema_id:K})),B(!1),oe("")}catch{}finally{Q(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),i.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[i.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),i.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs(pl,{title:"Prompt Fragments",count:r.length,dotColor:"#f59e0b",defaultOpen:!0,action:T&&i.jsx("button",{onClick:()=>O(!E),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[E&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),i.jsx("select",{value:z,onChange:K=>k(K.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:i.jsx("option",{value:"role",children:"Role"})})]}),i.jsx("input",{type:"text",value:P,onChange:K=>R(K.target.value),onKeyDown:K=>{K.key==="Enter"&&be(),K.key==="Escape"&&O(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:D,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:be,disabled:D||!P.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:D?"wait":"pointer",opacity:!P.trim()||D?.5:1},children:D?"Creating...":"Create"}),i.jsx("button",{onClick:()=>O(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.length>0&&i.jsx(nH,{kinds:n,selectedKind:w,onSelect:A}),i.jsx(hl,{loading:d,empty:!d&&fe.length===0,emptyMessage:w==="all"?"No prompt fragments":`No ${w} fragments`}),!d&&fe.length>0&&i.jsx("div",{className:"py-1",children:fe.map(K=>i.jsx(oi,{onClick:()=>xe(v,K),label:K.name||K.fragment_id,sublabel:`${K.kind}  v${K.version}`,badge:K.kind,isSelected:(h==null?void 0:h.fragment_id)===K.fragment_id},K.fragment_id))})]}),i.jsxs(pl,{title:"Templates",count:s.length,dotColor:"var(--dot-green)",action:C&&i.jsx("button",{onClick:()=>M(!I),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[I&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("input",{type:"text",value:F,onChange:K=>q(K.target.value),onKeyDown:K=>{K.key==="Enter"&&ye(),K.key==="Escape"&&M(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:H,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:ye,disabled:H||!F.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:H?"wait":"pointer",opacity:!F.trim()||H?.5:1},children:H?"Creating...":"Create"}),i.jsx("button",{onClick:()=>M(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(hl,{loading:u,empty:!u&&s.length===0,emptyMessage:"No templates"}),!u&&s.length>0&&i.jsx("div",{className:"py-1",children:s.map(K=>i.jsx(oi,{onClick:()=>xe(y,K),label:K.name||K.template_id.replace(/_/g," ").replace(/\b\w/g,te=>te.toUpperCase()),sublabel:`v${K.active_version}`,isSelected:(g==null?void 0:g.template_id)===K.template_id},K.template_id))})]}),i.jsxs(pl,{title:"Schemas",count:o.length||a.length,dotColor:"var(--dot-blue)",action:S&&i.jsx("button",{onClick:()=>B(!Z),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[Z&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("input",{type:"text",value:re,onChange:K=>oe(K.target.value),onKeyDown:K=>{K.key==="Enter"&&ae(),K.key==="Escape"&&B(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:X,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:ae,disabled:X||!re.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:X?"wait":"pointer",opacity:!re.trim()||X?.5:1},children:X?"Creating...":"Create"}),i.jsx("button",{onClick:()=>B(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(hl,{loading:f,empty:!f&&o.length===0&&a.length===0,emptyMessage:"No schemas"}),!f&&o.length>0&&i.jsx("div",{className:"py-1",children:o.map(K=>i.jsx(oi,{onClick:()=>xe(j,K),label:K.title||K.schema_id,sublabel:`v${K.active_version}`,isSelected:(x==null?void 0:x.schema_id)===K.schema_id},`standalone-${K.schema_id}`))}),o.length===0&&a.length>0&&i.jsx("div",{className:"py-1",children:a.map(K=>i.jsx(oi,{onClick:()=>xe(b,{doc_type_id:K.doc_type_id,display_name:K.display_name,active_version:K.active_version}),label:K.display_name,sublabel:`from ${K.doc_type_id}`},`schema-${K.doc_type_id}`))})]}),i.jsxs(pl,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[i.jsx(hl,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&i.jsx("div",{className:"py-1",children:l.map(K=>{const te=c.filter(ee=>ee.type===K.type_id);return i.jsxs("div",{children:[i.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsx("span",{style:{fontSize:10},children:""}),i.jsx("span",{children:K.name}),i.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",te.length,")"]})]}),te.length>0?te.map(ee=>i.jsx(oi,{onClick:()=>xe(N,ee),label:ee.name,sublabel:`v${ee.active_version}`,badge:ee.type,isSelected:(_==null?void 0:_.op_id)===ee.op_id},ee.op_id)):i.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},K.type_id)})}),!p&&l.length===0&&c.length===0&&i.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),i.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function rn({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:s=!1,error:o=null,readOnly:a=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[a&&i.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!a&&s&&i.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[c&&!a&&i.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&i.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&s&&i.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),o&&i.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",o]})]})]}),i.jsx("div",{className:"flex-1 relative",children:r?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):i.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:a,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function oH({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[s,o]=m.useState(!0),[a,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),o(!1);return}(async()=>{o(!0),l(null);try{const d=await we.getPreview(e,t);n(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{o(!1)}})()},[e,t]),i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),i.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&i.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&i.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&i.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&i.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),i.jsx("div",{className:"flex-1 relative overflow-auto",children:s?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):a?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[i.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),i.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:a})]})}):i.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function iH({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[s,o]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,j,N;t&&(o({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((j=t.ui)==null?void 0:j.category)||"",ui_display_order:((N=t.ui)==null?void 0:N.display_order)||0}),h(!1),f(null))},[t]);const g=m.useCallback((b,j)=>{o(N=>({...N,[b]:j})),h(!0)},[]),x=m.useCallback((b,j)=>{const N=j.split(",").map(T=>T.trim()).filter(T=>T);o(T=>({...T,[b]:N})),h(!0)},[]),_=m.useCallback(b=>{if(!b)return"";const j=r.find(N=>N.role_id===b);return j?`prompt:role:${b}:${j.active_version}`:""},[r]),v=m.useCallback(b=>{if(!b)return"";const j=b.split(":");return j.length>=3&&j[0]==="prompt"&&j[1]==="role"?j[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!s)){d(!0),f(null);try{const b=t.version||t.active_version,j=`doctype:${t.doc_type_id}:${b}:manifest`,N=aH(t.doc_type_id,b,s),T=await we.writeArtifact(e,j,N);h(!1),n==null||n(j,T)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,s,n]);return!t||!s?i.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsx("div",{className:"flex items-center gap-2",children:p&&i.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[c&&i.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&i.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),i.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"max-w-2xl space-y-6",children:[i.jsxs(ii,{title:"Identity",children:[i.jsx(Jt,{label:"Display Name",children:i.jsx("input",{type:"text",value:s.display_name,onChange:b=>g("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Description",children:i.jsx("textarea",{value:s.description,onChange:b=>g("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),i.jsxs(ii,{title:"Classification",children:[i.jsx(Jt,{label:"Authority Level",children:i.jsxs("select",{value:s.authority_level,onChange:b=>g("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"descriptive",children:"Descriptive"}),i.jsx("option",{value:"prescriptive",children:"Prescriptive"}),i.jsx("option",{value:"constructive",children:"Constructive"}),i.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),i.jsx(Jt,{label:"Creation Mode",children:i.jsxs("select",{value:s.creation_mode,onChange:b=>g("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"llm_generated",children:"LLM Generated"}),i.jsx("option",{value:"constructed",children:"Constructed"}),i.jsx("option",{value:"extracted",children:"Extracted"})]})}),i.jsx(Jt,{label:"Scope",children:i.jsxs("select",{value:s.scope,onChange:b=>g("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"project",children:"Project"}),i.jsx("option",{value:"work_package",children:"Work Package"}),i.jsx("option",{value:"work_statement",children:"Work Statement"})]})})]}),i.jsx(ii,{title:"Shared References",children:i.jsxs(Jt,{label:"Role Prompt",children:[i.jsxs("select",{value:v(s.role_prompt_ref),onChange:b=>g("role_prompt_ref",_(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"",children:"None"}),r.map(b=>i.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())},b.role_id))]}),s.role_prompt_ref&&i.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:s.role_prompt_ref})]})}),i.jsxs(ii,{title:"Dependencies",children:[i.jsx(Jt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:i.jsx("input",{type:"text",value:s.required_inputs.join(", "),onChange:b=>x("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:i.jsx("input",{type:"text",value:s.optional_inputs.join(", "),onChange:b=>x("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Parent Doc Type",children:i.jsx("input",{type:"text",value:s.parent_doc_type,onChange:b=>g("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:i.jsx("input",{type:"text",value:s.creates_children.join(", "),onChange:b=>x("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),i.jsxs(ii,{title:"UI Configuration",children:[i.jsx(Jt,{label:"Icon",children:i.jsx("input",{type:"text",value:s.ui_icon,onChange:b=>g("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Category",children:i.jsxs("select",{value:s.ui_category,onChange:b=>g("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"",children:"Select category..."}),i.jsx("option",{value:"intake",children:"Intake"}),i.jsx("option",{value:"architecture",children:"Architecture"}),i.jsx("option",{value:"planning",children:"Planning"}),i.jsx("option",{value:"execution",children:"Execution"})]})}),i.jsx(Jt,{label:"Display Order",children:i.jsx("input",{type:"number",value:s.ui_display_order,onChange:b=>g("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function ii({title:e,children:t}){return i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),i.jsx("div",{className:"space-y-4",children:t})]})}function Jt({label:e,hint:t,children:r}){return i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&i.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function aH(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(s=>`"${s}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(s=>`"${s}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(s=>`"${s}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function Y3(e,t,{debounceMs:r=1e3,onSave:n}={}){const[s,o]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[g,x]=m.useState(null),_=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){o(null),l(null),d(!1);return}d(!0),f(null);try{const C=await we.getArtifact(e,t),S=JSON.parse(C.content);o(S),l(S)}catch(C){f(C.message),console.error("Failed to load workflow artifact:",C)}finally{d(!1)}},[e,t]),b=m.useCallback(async C=>{if(!(!e||!t)){h(!0),f(null);try{const S=JSON.stringify(C,null,2),w=await we.writeArtifact(e,t,S);x(w),l(C),n&&n(w)}catch(S){f(S.message),console.error("Failed to save workflow:",S)}finally{h(!1)}}},[e,t,n]),j=m.useCallback(C=>{v.current=C,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),N=m.useCallback(C=>{o(C),j(C)},[j]),T=m.useCallback(()=>{_.current&&clearTimeout(_.current),s&&b(s)},[s,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{workflowJson:s,originalJson:a,loading:c,error:u,saving:p,lastSaveResult:g,isDirty:s!==a,updateWorkflow:N,saveNow:T,reload:y}}function lH({data:e,selected:t}){const{config:r,isEntry:n}=e,s=e.type==="end";return i.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[i.jsx(yr,{type:"target",position:ce.Top,style:{background:r.color,width:8,height:8,border:"none"}}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[i.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&i.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),i.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&i.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),i.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!s&&i.jsx(yr,{type:"source",position:ce.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const cH=m.memo(lH),uH={workflowNode:cH},dH=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function fH({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:s,onEdgeSelect:o}){const a=iu(),[l,c,d]=AE([]),[u,f,p]=IE([]),[h,g]=m.useState(!1),x=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:w,edges:A}=nS(e);(!w.some(O=>O.position.x!==0||O.position.y!==0)||!x.current)&&(w=jc(w,A),x.current=!0),c(w),f(A)},[e,c,f]),m.useEffect(()=>{c(w=>w.map(A=>({...A,selected:A.id===r})))},[r,c]);const _=m.useCallback(w=>{if(!e)return;const E={edge_id:Xq(w.source,w.target,e.edges||[]),from_node_id:w.source,to_node_id:w.target,outcome:"success",label:"",kind:"auto"},O={...e,edges:[...e.edges||[],E]};t(O)},[e,t]),v=m.useCallback((w,A)=>{if(!e)return;const E=e.nodes.map(O=>O.node_id===A.id?{...O,_position:A.position}:O);t({...e,nodes:E})},[e,t]),y=m.useCallback((w,A)=>{s==null||s(A.id)},[s]),b=m.useCallback((w,A)=>{o==null||o(A.id)},[o]),j=m.useCallback(()=>{s==null||s(null),o==null||o(null)},[s,o]),N=m.useCallback(w=>{if(w.key==="Delete"||w.key==="Backspace"){if(r&&e){const A={...e,nodes:e.nodes.filter(E=>E.node_id!==r),edges:e.edges.filter(E=>E.from_node_id!==r&&E.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(E=>E!==r)};t(A),s==null||s(null)}else if(n&&e){const A={...e,edges:e.edges.filter(E=>E.edge_id!==n)};t(A),o==null||o(null)}}},[r,n,e,t,s,o]),T=m.useCallback(w=>{if(!e)return;const A=Yq(w,e.nodes||[]),E=Qq(w);E.node_id=A;const O=a.getViewport(),z=(-O.x+window.innerWidth/2)/O.zoom,k=(-O.y+window.innerHeight/2)/O.zoom;E._position={x:z-110,y:k-50};const P={...e,nodes:[...e.nodes||[],E]};t(P),g(!1),s==null||s(A)},[e,t,a,s]),C=m.useCallback(()=>{if(!e)return;let{nodes:w,edges:A}=nS(e);w=jc(w,A);const E=e.nodes.map(O=>{const z=w.find(k=>k.id===O.node_id);return z?{...O,_position:z.position}:O});t({...e,nodes:E}),setTimeout(()=>{a.fitView({padding:.2,duration:300})},50)},[e,t,a]),S=m.useCallback(()=>{a.fitView({padding:.2,duration:300})},[a]);return i.jsx("div",{className:"flex-1 relative",onKeyDown:N,tabIndex:0,style:{outline:"none"},children:i.jsxs(ja,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:_,onNodeDragStop:v,onNodeClick:y,onEdgeClick:b,onPaneClick:j,nodeTypes:uH,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[i.jsx(Un,{position:"top-left",children:i.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>g(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&i.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:dH.map(w=>{const A=wc[w.value]||{};return i.jsxs("button",{onClick:()=>T(w.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[i.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:A.color}}),w.label]},w.value)})})]}),i.jsx("button",{onClick:C,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),i.jsx("button",{onClick:S,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),i.jsx(ME,{position:"bottom-right",nodeColor:w=>{var E;const A=(E=w.data)==null?void 0:E.config;return(A==null?void 0:A.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),i.jsx(Un,{position:"bottom-left",children:i.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(wc).map(([w,A])=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:A.color}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:A.label})]},w))})}),i.jsx(Un,{position:"top-right",children:i.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const pH=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],AS=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],IS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"work_package",label:"Work Package Gate",produces:"pgc_clarifications.work_package"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],hH=["semantic","structural","hybrid"],mH=["stabilized","blocked","abandoned"],qe={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},St={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},xH={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function wx(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function jx(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function Bs(e){var s;if(!e)return"";const t=e.kind||"role",r=((s=e.fragment_id)==null?void 0:s.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function Ws(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function ml(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function xl(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function Sx({title:e,defaultOpen:t=!1,isOpen:r,onToggle:n,children:s,badge:o}){const[a,l]=m.useState(t),c=r!==void 0,d=c?r:a,u=()=>{c&&n?n():l(!a)};return i.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:i.jsx("path",{d:"M9 18l6-6-6-6"})}),i.jsx("span",{style:{...St,marginBottom:0},children:e})]}),o&&i.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:o})]}),d&&i.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:s})]})}function kx(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function Hs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function gH({node:e,onChange:t,onDelete:r,templates:n=[],schemas:s=[],roleFragments:o=[],taskFragments:a=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var je,Te,Ne,ne,Se,Ve,ct,We,Pe,ie,ge,pe,U,ve,he,Fe,He,st,Ge;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const g=($,W)=>{const G={...u,[$]:W};f(G),t(G)},x=($,W)=>{const G={...u.includes,[$]:W},se={...u,includes:G};f(se),t(se)},_=$=>{const W={...u.includes};delete W[$];const G={...u,includes:W};f(G),t(G)},v=()=>{const $={...u.includes,NEW_KEY:""},W={...u,includes:$};f(W),t(W)},y=$=>{const W={...u,internals:$};f(W),t(W)},b=($,W)=>{const G=u.internals||T(),se={...G.question_generation,[$]:W};y({...G,question_generation:se})},j=($,W)=>{const G=u.internals||T(),se={...G.question_generation.includes,[$]:W},$e={...G.question_generation,includes:se};y({...G,question_generation:$e})},N=($,W)=>{const G=u.internals||T(),se={...G.clarification_merge,[$]:W};y({...G,clarification_merge:se})},T=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const C=u.type==="pgc",S=jx(u.task_ref),w=u.includes||{},A=w.ROLE_PROMPT||"",E=w.TASK_PROMPT||"",O=w.OUTPUT_SCHEMA||"",z=w.PGC_CONTEXT||"",k=Ws(A),P=Ws(E),R=xl(O),D=Ws(z),L=Object.entries(w).filter(([$])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes($)),I=u.internals||T(),M=jx((je=I.question_generation)==null?void 0:je.template_ref),F=Ws((Ne=(Te=I.question_generation)==null?void 0:Te.includes)==null?void 0:Ne.ROLE_PROMPT),q=Ws((Se=(ne=I.question_generation)==null?void 0:ne.includes)==null?void 0:Se.TASK_PROMPT),H=Ws((ct=(Ve=I.question_generation)==null?void 0:Ve.includes)==null?void 0:ct.PGC_CONTEXT),V=xl((We=I.question_generation)==null?void 0:We.output_schema_ref),Z=jx((Pe=I.clarification_merge)==null?void 0:Pe.template_ref),B=xl((ie=I.clarification_merge)==null?void 0:ie.output_schema_ref),re=$=>{const W=$.target.value;if(!W){g("task_ref","");return}const G=n.find(se=>se.template_id===W);G&&g("task_ref",wx(G))},oe=$=>{const W=$.target.value;if(!W){_("ROLE_PROMPT");return}const G=o.find(se=>se.fragment_id===`role:${W}`||se.id===W);G&&x("ROLE_PROMPT",Bs(G))},X=$=>{const W=$.target.value;if(!W){_("TASK_PROMPT");return}const G=a.find(se=>se.fragment_id===`task:${W}`||se.id===W);G&&x("TASK_PROMPT",Bs(G))},Q=$=>{const W=$.target.value;if(!W){_("OUTPUT_SCHEMA");return}const G=s.find(se=>se.schema_id===W);G&&x("OUTPUT_SCHEMA",ml(G))},fe=$=>{const W=$.target.value;if(!W){_("PGC_CONTEXT");return}const G=l.find(se=>se.fragment_id===`pgc:${W}`||se.id===W);G&&x("PGC_CONTEXT",Bs(G))},xe=$=>{const W=$.target.value,G=IS.find(pt=>pt.value===W),se=(G==null?void 0:G.produces)||`pgc_clarifications.${W}`,$e={...u,gate_kind:W,produces:se};f($e),t($e)},be=$=>{const W=$.target.value;if(!W){b("template_ref","");return}const G=n.find(se=>se.template_id===W);G&&b("template_ref",wx(G))},ye=$=>{const W=$.target.value;if(!W){j("ROLE_PROMPT","");return}const G=o.find(se=>se.fragment_id===`role:${W}`||se.id===W);G&&j("ROLE_PROMPT",Bs(G))},ae=$=>{const W=$.target.value;if(!W){j("TASK_PROMPT","");return}const G=a.find(se=>se.fragment_id===`task:${W}`||se.id===W);G&&j("TASK_PROMPT",Bs(G))},K=$=>{const W=$.target.value;if(!W){j("PGC_CONTEXT","");return}const G=l.find(se=>se.fragment_id===`pgc:${W}`||se.id===W);G&&j("PGC_CONTEXT",Bs(G))},te=$=>{const W=$.target.value;if(!W){b("output_schema_ref","");return}const G=s.find(se=>se.schema_id===W);G&&b("output_schema_ref",ml(G))},ee=$=>{const W=$.target.value;if(!W){N("template_ref","");return}const G=n.find(se=>se.template_id===W);G&&N("template_ref",wx(G))},ke=$=>{const W=$.target.value;if(!W){N("output_schema_ref","");return}const G=s.find(se=>se.schema_id===W);G&&N("output_schema_ref",ml(G))};return i.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[i.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:C?"PGC Gate Properties":"Node Properties"}),i.jsx("button",{onClick:()=>r(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Node ID"}),i.jsx("input",{type:"text",value:u.node_id||"",onChange:$=>g("node_id",$.target.value),style:qe})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Type"}),i.jsx("select",{value:u.type||"task",onChange:$=>g("type",$.target.value),style:qe,children:pH.map($=>i.jsx("option",{value:$.value,children:$.label},$.value))})]}),C&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Gate Kind"}),i.jsx("select",{value:u.gate_kind||"discovery",onChange:xe,style:qe,children:IS.map($=>i.jsx("option",{value:$.value,children:$.label},$.value))})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Description"}),i.jsx("textarea",{value:u.description||"",onChange:$=>g("description",$.target.value),rows:2,style:{...qe,resize:"vertical"}})]}),(C||["task","intake_gate"].includes(u.type))&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Produces"}),i.jsx("input",{type:"text",value:u.produces||"",onChange:$=>g("produces",$.target.value),placeholder:C?"pgc_clarifications.discovery":"document_type",style:qe})]}),C&&i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{style:xH,children:"Gate Internals"}),i.jsx(Sx,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),i.jsxs("select",{value:M||"",onChange:be,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Template --"}),n.map($=>i.jsx("option",{value:$.template_id,children:$.name||$.template_id.replace(/_/g," ")},$.template_id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),i.jsxs("select",{value:F||"",onChange:ye,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Role --"}),o.map($=>{var G;const W=((G=$.fragment_id)==null?void 0:G.replace("role:",""))||$.id;return i.jsx("option",{value:W,children:$.name||(W==null?void 0:W.replace(/_/g," "))},$.fragment_id||$.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),i.jsxs("select",{value:q||"",onChange:ae,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Task --"}),a.map($=>{var G;const W=((G=$.fragment_id)==null?void 0:G.replace("task:",""))||$.id;return i.jsx("option",{value:W,children:$.name||(W==null?void 0:W.replace(/_/g," "))},$.fragment_id||$.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),i.jsxs("select",{value:H||"",onChange:K,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map($=>{var G;const W=((G=$.fragment_id)==null?void 0:G.replace("pgc:",""))||$.id;return i.jsx("option",{value:W,children:$.name||(W==null?void 0:W.replace(/_/g," "))},$.fragment_id||$.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:V||"",onChange:te,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map($=>i.jsx("option",{value:$.schema_id,children:$.title||$.schema_id.replace(/_/g," ")},$.schema_id))]})]})]})}),i.jsx("div",{className:"mt-2",children:i.jsx(Sx,{title:"Entry: Operator Answers",badge:"UI",children:i.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Renders:"}),i.jsx("span",{className:"font-mono",children:((ge=I.operator_entry)==null?void 0:ge.renders)||"question_set"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Captures:"}),i.jsx("span",{className:"font-mono",children:((pe=I.operator_entry)==null?void 0:pe.captures)||"pgc_answers"})]}),i.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),i.jsx("div",{className:"mt-2",children:i.jsx(Sx,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((U=I.clarification_merge)==null?void 0:U.internal_type)||"LLM",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),i.jsxs("select",{value:((ve=I.clarification_merge)==null?void 0:ve.internal_type)||"LLM",onChange:$=>N("internal_type",$.target.value),style:{...qe,fontSize:11},children:[i.jsx("option",{value:"LLM",children:"LLM"}),i.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((he=I.clarification_merge)==null?void 0:he.internal_type)||"LLM")==="LLM"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),i.jsxs("select",{value:Z||"",onChange:ee,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Template --"}),n.map($=>i.jsx("option",{value:$.template_id,children:$.name||$.template_id.replace(/_/g," ")},$.template_id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:B||"",onChange:ke,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map($=>i.jsx("option",{value:$.schema_id,children:$.title||$.schema_id.replace(/_/g," ")},$.schema_id))]})]})]}),((Fe=I.clarification_merge)==null?void 0:Fe.internal_type)==="MECH"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),i.jsxs("select",{value:Hs((He=I.clarification_merge)==null?void 0:He.op_ref)||"",onChange:$=>{const W=$.target.value;if(!W){N("op_ref","");return}const G=d.find(se=>se.op_id===W);G&&N("op_ref",kx(G))},style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter($=>$.type==="merger").map($=>i.jsx("option",{value:$.op_id,children:$.name},$.op_id))]})]}),((st=I.clarification_merge)==null?void 0:st.op_ref)&&(()=>{const $=Hs(I.clarification_merge.op_ref),W=d.find(G=>G.op_id===$);return W?i.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:W.type}),i.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&i.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:B||"",onChange:ke,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map($=>i.jsx("option",{value:$.schema_id,children:$.title||$.schema_id.replace(/_/g," ")},$.schema_id))]})]})]}),i.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Internal Type"}),i.jsx("select",{value:u.internal_type||"LLM",onChange:$=>g("internal_type",$.target.value),style:qe,children:AS.map($=>i.jsx("option",{value:$.value,children:$.label},$.value))}),i.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Ge=AS.find($=>$.value===(u.internal_type||"LLM")))==null?void 0:Ge.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Interaction Template"}),i.jsxs("select",{value:S||"",onChange:re,style:qe,children:[i.jsx("option",{value:"",children:"-- Select Template --"}),n.map($=>i.jsx("option",{value:$.template_id,children:$.name||$.template_id.replace(/_/g," ")},$.template_id))]}),u.task_ref&&i.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Mechanical Operation"}),i.jsxs("select",{value:Hs(u.op_ref)||"",onChange:$=>{const W=$.target.value;if(!W){g("op_ref","");return}const G=d.find(se=>se.op_id===W);G&&g("op_ref",kx(G))},style:qe,children:[i.jsx("option",{value:"",children:"-- Select Operation --"}),c.map($=>{const W=d.filter(G=>G.type===$.type_id);return W.length===0?null:i.jsx("optgroup",{label:$.name,children:W.map(G=>i.jsx("option",{value:G.op_id,children:G.name},G.op_id))},$.type_id)})]}),u.op_ref&&i.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const $=Hs(u.op_ref),W=d.find(se=>se.op_id===$),G=W?c.find(se=>se.type_id===W.type):null;return W?i.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(G==null?void 0:G.name)||W.type}),i.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&i.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Output Schema"}),i.jsxs("select",{value:xl(u.output_schema_ref)||"",onChange:$=>{const W=$.target.value;if(!W){g("output_schema_ref","");return}const G=s.find(se=>se.schema_id===W);G&&g("output_schema_ref",ml(G))},style:qe,children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map($=>i.jsx("option",{value:$.schema_id,children:$.title||$.schema_id.replace(/_/g," ")},$.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Entry Operation"}),i.jsxs("select",{value:Hs(u.op_ref)||"",onChange:$=>{const W=$.target.value;if(!W){g("op_ref","");return}const G=d.find(se=>se.op_id===W);G&&g("op_ref",kx(G))},style:qe,children:[i.jsx("option",{value:"",children:"-- Select Entry Operation --"}),d.filter($=>$.type==="entry").map($=>i.jsx("option",{value:$.op_id,children:$.name},$.op_id))]}),u.op_ref&&i.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const $=Hs(u.op_ref),W=d.find(se=>se.op_id===$);if(!W)return null;const G=W.config||{};return i.jsxs("div",{className:"p-2 rounded text-xs space-y-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-orange, #f97316)",color:"#fff"},children:"Entry"}),i.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&i.jsx("div",{style:{color:"var(--text-muted)"},children:W.description}),i.jsxs("div",{className:"pt-2 border-t space-y-1",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Renders:"}),i.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:G.renders||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Captures:"}),i.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:G.captures||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Layout:"}),i.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:G.layout||"form"})]})]}),G.entry_prompt&&i.jsxs("div",{className:"p-2 rounded mt-2",style:{background:"var(--bg-panel)"},children:[i.jsx("div",{className:"text-[10px] uppercase mb-1",style:{color:"var(--text-muted)"},children:"Entry Prompt"}),i.jsx("div",{style:{color:"var(--text-primary)"},children:G.entry_prompt})]})]})})(),!u.op_ref&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Select an Entry operation above, or define custom renders/captures below."}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Renders"}),i.jsx("input",{type:"text",value:u.renders||"",onChange:$=>g("renders",$.target.value),placeholder:"e.g., question_set",style:qe})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Captures"}),i.jsx("input",{type:"text",value:u.captures||"",onChange:$=>g("captures",$.target.value),placeholder:"e.g., user_answers",style:qe})]})]})]}),u.type==="qa"&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"QA Mode"}),i.jsx("select",{value:u.qa_mode||"semantic",onChange:$=>g("qa_mode",$.target.value),style:qe,children:hH.map($=>i.jsx("option",{value:$,children:$},$))})]}),u.type==="end"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Terminal Outcome"}),i.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:$=>g("terminal_outcome",$.target.value),style:qe,children:mH.map($=>i.jsx("option",{value:$,children:$},$))})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Gate Outcome"}),i.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:$=>g("gate_outcome",$.target.value),placeholder:"e.g., complete, failed",style:qe})]})]}),i.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&i.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:$=>g("requires_qa",$.target.checked)}),"Requires QA"]}),i.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:$=>g("non_advancing",$.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&i.jsxs("div",{children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsx("label",{style:St,children:"Includes"})}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),i.jsxs("select",{value:k||"",onChange:oe,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Role --"}),o.map($=>{var G;const W=((G=$.fragment_id)==null?void 0:G.replace("role:",""))||$.id;return i.jsx("option",{value:W,children:$.name||(W==null?void 0:W.replace(/_/g," "))},$.fragment_id||$.id)})]})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),i.jsxs("select",{value:P||"",onChange:X,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Task --"}),a.map($=>{var G;const W=((G=$.fragment_id)==null?void 0:G.replace("task:",""))||$.id;return i.jsx("option",{value:W,children:$.name||(W==null?void 0:W.replace(/_/g," "))},$.fragment_id||$.id)})]})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:R||"",onChange:Q,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map($=>i.jsx("option",{value:$.schema_id,children:$.title||$.schema_id.replace(/_/g," ")},$.schema_id))]})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),i.jsxs("select",{value:D||"",onChange:fe,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map($=>{var G;const W=((G=$.fragment_id)==null?void 0:G.replace("pgc:",""))||$.id;return i.jsx("option",{value:W,children:$.name||(W==null?void 0:W.replace(/_/g," "))},$.fragment_id||$.id)})]})]}),L.length>0&&i.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),i.jsx("div",{className:"space-y-2",children:L.map(([$,W])=>i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{type:"text",value:$,onChange:G=>{const se={...u.includes};delete se[$],se[G.target.value]=W;const $e={...u,includes:se};f($e),t($e)},style:{...qe,width:"35%",fontSize:10},placeholder:"KEY"}),i.jsx("input",{type:"text",value:W,onChange:G=>x($,G.target.value),style:{...qe,flex:1,fontSize:10},placeholder:"path/to/file"}),i.jsx("button",{onClick:()=>_($),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},$))})]}),i.jsx("button",{onClick:v,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const vH=["auto","user_choice"],yH=["eq","ne","lt","lte","gt","gte"],Jr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},is={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function bH({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[s,o]=m.useState(e);m.useEffect(()=>{o(e)},[e]);const a=(u,f)=>{const p={...s,[u]:f};o(p),r(p)},l=()=>{const u=[...s.conditions||[],{type:"retry_count",operator:"lt",value:2}];a("conditions",u)},c=(u,f,p)=>{const h=[...s.conditions||[]];h[u]={...h[u],[f]:p},a("conditions",h)},d=u=>{const f=(s.conditions||[]).filter((p,h)=>h!==u);a("conditions",f)};return s?i.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[i.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),i.jsx("button",{onClick:()=>n(s.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Edge ID"}),i.jsx("input",{type:"text",value:s.edge_id||"",onChange:u=>a("edge_id",u.target.value),style:Jr})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"From Node"}),i.jsx("select",{value:s.from_node_id||"",onChange:u=>a("from_node_id",u.target.value),style:Jr,children:t.map(u=>i.jsx("option",{value:u,children:u},u))})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"To Node"}),i.jsxs("select",{value:s.to_node_id||"",onChange:u=>a("to_node_id",u.target.value||null),style:Jr,children:[i.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>i.jsx("option",{value:u,children:u},u))]})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Outcome"}),i.jsx("input",{type:"text",value:s.outcome||"",onChange:u=>a("outcome",u.target.value),placeholder:"success, failed, etc.",style:Jr})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Label"}),i.jsx("input",{type:"text",value:s.label||"",onChange:u=>a("label",u.target.value),placeholder:"Human-readable label",style:Jr})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Kind"}),i.jsx("select",{value:s.kind||"auto",onChange:u=>a("kind",u.target.value),style:Jr,children:vH.map(u=>i.jsx("option",{value:u,children:u},u))})]}),i.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("input",{type:"checkbox",checked:s.non_advancing||!1,onChange:u=>a("non_advancing",u.target.checked)}),"Non-advancing"]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("label",{style:is,children:"Conditions"}),i.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),i.jsx("div",{className:"space-y-2",children:(s.conditions||[]).map((u,f)=>i.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:i.jsxs("div",{className:"flex gap-1 items-center",children:[i.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Jr,flex:1,fontSize:10}}),i.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Jr,width:"auto",fontSize:10},children:yH.map(p=>i.jsx("option",{value:p,children:p},p))}),i.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Jr,width:50,fontSize:10}}),i.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const _H={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function wH({workspaceId:e,artifactId:t,onArtifactSave:r,mechanicalOpTypes:n=[],mechanicalOps:s=[]}){var H,V,Z;const[o,a]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,g]=m.useState(null),{workflowJson:x,loading:_,error:v,saving:y,lastSaveResult:b,updateWorkflow:j}=Y3(e,t,{onSave:B=>{r==null||r(t,B)}}),{templates:N}=U3(),{schemas:T}=V3(),{fragmentsByKind:C}=G3(),S=m.useMemo(()=>{var B;return!l||!x?null:((B=x.nodes)==null?void 0:B.find(re=>re.node_id===l))||null},[l,x]),w=m.useMemo(()=>{var B;return!d||!x?null:((B=x.edges)==null?void 0:B.find(re=>re.edge_id===d))||null},[d,x]),A=m.useMemo(()=>x!=null&&x.nodes?x.nodes.map(B=>B.node_id):[],[x]),E=m.useCallback(B=>{j(B)},[j]),O=m.useCallback(B=>{if(!x)return;const re=x.nodes.map(Q=>Q.node_id===l?B:Q);let oe=x.edges,X=x.entry_node_ids||[];B.node_id!==l&&(oe=x.edges.map(Q=>({...Q,from_node_id:Q.from_node_id===l?B.node_id:Q.from_node_id,to_node_id:Q.to_node_id===l?B.node_id:Q.to_node_id})),X=X.map(Q=>Q===l?B.node_id:Q),c(B.node_id)),j({...x,nodes:re,edges:oe,entry_node_ids:X})},[x,l,j]),z=m.useCallback(B=>{if(!x)return;const re=x.edges.map(oe=>oe.edge_id===d?B:oe);B.edge_id!==d&&u(B.edge_id),j({...x,edges:re})},[x,d,j]),k=m.useCallback(B=>{x&&(j({...x,nodes:x.nodes.filter(re=>re.node_id!==B),edges:x.edges.filter(re=>re.from_node_id!==B&&re.to_node_id!==B),entry_node_ids:(x.entry_node_ids||[]).filter(re=>re!==B)}),c(null))},[x,j]),P=m.useCallback(B=>{x&&(j({...x,edges:x.edges.filter(re=>re.edge_id!==B)}),u(null))},[x,j]),R=m.useCallback(B=>{c(B),B&&u(null)},[]),D=m.useCallback(B=>{u(B),B&&c(null)},[]),L=m.useCallback(B=>{B==="json"&&x&&(p(JSON.stringify(x,null,2)),g(null)),a(B)},[x]),I=m.useCallback(B=>{const re=B.target.value;p(re);try{const oe=JSON.parse(re);g(null),j(oe)}catch(oe){g(oe.message)}},[j]),M=((H=b==null?void 0:b.tier1_report)==null?void 0:H.results)||[],F=M.filter(B=>B.severity==="error").length,q=M.filter(B=>B.severity==="warning").length;return i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center gap-3",children:[y&&i.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),v&&i.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:v}),!y&&!v&&x&&i.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((V=x.nodes)==null?void 0:V.length)||0," nodes, ",((Z=x.edges)==null?void 0:Z.length)||0," edges"]})]})}),i.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>i.jsx("button",{onClick:()=>L(B.id),style:{..._H,color:o===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),_?i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o==="canvas"&&i.jsxs(i.Fragment,{children:[i.jsx(Mo,{children:i.jsx(fH,{workflowJson:x,onWorkflowChange:E,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:R,onEdgeSelect:D})}),S&&i.jsx(gH,{node:S,onChange:O,onDelete:k,templates:N,schemas:T,roleFragments:C.role||[],taskFragments:C.task||[],pgcFragments:C.pgc||[],mechanicalOpTypes:n,mechanicalOps:s}),w&&i.jsx(bH,{edge:w,nodeIds:A,onChange:z,onDelete:P})]}),o==="json"&&i.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[i.jsx("textarea",{value:f,onChange:I,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&i.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),o==="metadata"&&i.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:x?i.jsx(jH,{workflow:x}):i.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),M.length>0&&i.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[F>0&&i.jsxs("span",{style:{color:"#ef4444"},children:[F," error",F!==1?"s":""]}),q>0&&i.jsxs("span",{style:{color:"#f59e0b"},children:[q," warning",q!==1?"s":""]}),F===0&&q===0&&i.jsx("span",{style:{color:"#10b981"},children:"Valid"}),i.jsx("span",{style:{color:"var(--text-muted)"},children:M.map(B=>B.message).join(" | ")})]})]})}function jH({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],s=e.thread_ownership||{},o=Object.entries(s),a=e.entry_node_ids||[];return i.jsxs("div",{className:"space-y-4 max-w-lg",children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>i.jsxs("div",{children:[i.jsx("label",{style:r,children:l.label}),i.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),i.jsxs("div",{children:[i.jsx("label",{style:r,children:"Entry Node IDs"}),i.jsx("div",{style:t,children:a.length>0?a.join(", "):"-"})]}),o.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),o.map(([l,c])=>i.jsxs("div",{children:[i.jsx("label",{style:r,children:l}),i.jsx("div",{style:t,children:c})]},l))]})]})}function Nx({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:s}){const[o,a]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!o)return;const c=d=>{l.current&&!l.current.contains(d.target)&&a(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[o]),t.length===0?null:i.jsxs("div",{ref:l,style:{position:"relative"},children:[i.jsxs("button",{onClick:()=>a(!o),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:s?"var(--text-primary)":"var(--text-muted)",background:s?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:s?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,i.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),o&&i.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>i.jsxs("button",{onClick:()=>{n(c.id),a(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&i.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function Cx({label:e,isSelected:t,onClick:r}){return i.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function SH({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:s=[],onArtifactSave:o,onCreateDcwWorkflow:a,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var ie,ge,pe;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,g]=m.useState("source"),[x,_]=m.useState(null),[v,y]=m.useState(!1),[b,j]=m.useState(null),[N,T]=m.useState(null),[C,S]=m.useState(!1),[w,A]=m.useState(null),[E,O]=m.useState(null),[z,k]=m.useState(!1),[P,R]=m.useState(null),[D,L]=m.useState(null),[I,M]=m.useState(!1),[F,q]=m.useState(null),H=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const U=t.role_prompt_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="role"?null:{roleId:U[2],version:U[3]}},[t==null?void 0:t.role_prompt_ref]),V=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const U=t.template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.template_ref]),Z=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const U=t.qa_template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const U=t.pgc_template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!H){_(null);return}y(!0),j(null),we.getRole(H.roleId,H.version).then(U=>{_(U.content)}).catch(U=>{console.error("Failed to load role:",U),j(U.message)}).finally(()=>{y(!1)})},[H]),m.useEffect(()=>{if(!V){T(null);return}S(!0),A(null),we.getTemplate(V.templateId,V.version).then(U=>{T(U.content)}).catch(U=>{console.error("Failed to load template:",U),A(U.message)}).finally(()=>{S(!1)})},[V]),m.useEffect(()=>{if(!Z){O(null);return}k(!0),R(null),we.getTemplate(Z.templateId,Z.version).then(U=>{O(U.content)}).catch(U=>{console.error("Failed to load QA template:",U),R(U.message)}).finally(()=>{k(!1)})},[Z]),m.useEffect(()=>{if(!B){L(null);return}M(!0),q(null),we.getTemplate(B.templateId,B.version).then(U=>{L(U.content)}).catch(U=>{console.error("Failed to load PGC template:",U),q(U.message)}).finally(()=>{M(!1)})},[B]);const re=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const U=t.version||t.active_version;return`doctype:${t.doc_type_id}:${U}:${f}`},[t,f]),{content:oe,loading:X,error:Q,saving:fe,isDirty:xe,updateContent:be,lastSaveResult:ye}=Ta(e,re,{onSave:U=>{o==null||o(re,U)}}),ae=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],K=m.useMemo(()=>t?ae.filter(U=>U.id==="package"?!0:U.id==="role_prompt"?!!t.role_prompt_ref:U.id==="template"?!!t.template_ref:U.id==="qa_template"?!!t.qa_template_ref:U.id==="pgc_template"?!!t.pgc_template_ref:U.id==="workflow"?!0:t.artifacts?t.artifacts[U.id]!=null:!1):[],[t]),te=c==="task"||c==="schema";m.useEffect(()=>{te||K.length>0&&!K.find(U=>U.id===f)&&p(K[0].id)},[K,f,te]);const ee=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",ke=f==="package",je=f==="schema",Te=f==="workflow",Ne=!ee&&!ke&&!je&&!Te,ne=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:s.some(U=>U.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,s]),[Se,Ve]=m.useState(!1),ct=async()=>{if(!(!(t!=null&&t.doc_type_id)||!a)){Ve(!0);try{await a(t.doc_type_id)}finally{Ve(!1)}}};if(!t&&!r)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),i.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),i.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const We=c==="task"?"Interaction":c==="schema"?"Schema":null,Pe=!te&&(f==="task_prompt"||f==="schema");return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),i.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:te?We:i.jsxs(i.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),te&&i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!te&&i.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[K.find(U=>U.id==="package")&&i.jsx(Cx,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),g("source")}}),K.find(U=>U.id==="workflow")&&i.jsx(Cx,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),g("source")}}),(()=>{const U=["role_prompt","task_prompt","template"],ve=K.filter(he=>U.includes(he.id)).map(he=>({id:he.id,label:he.id==="role_prompt"?"Role":he.id==="task_prompt"?"Task":"Template",viewOnly:he.viewOnly}));return ve.length===0?null:i.jsx(Nx,{label:"Generation",items:ve,selectedId:U.includes(f)?f:null,onSelect:he=>{p(he),g("source")},isGroupActive:U.includes(f)})})(),(()=>{const U=["qa_prompt","qa_template"],ve=K.filter(he=>U.includes(he.id)).map(he=>({id:he.id,label:he.id==="qa_prompt"?"Prompt":"Template",viewOnly:he.viewOnly}));return ve.length===0?null:i.jsx(Nx,{label:"QA",items:ve,selectedId:U.includes(f)?f:null,onSelect:he=>{p(he),g("source")},isGroupActive:U.includes(f)})})(),(()=>{const U=["pgc_context","pgc_template"],ve=K.filter(he=>U.includes(he.id)).map(he=>({id:he.id,label:he.id==="pgc_context"?"Context":"Template",viewOnly:he.viewOnly}));return ve.length===0?null:i.jsx(Nx,{label:"PGC",items:ve,selectedId:U.includes(f)?f:null,onSelect:he=>{p(he),g("source")},isGroupActive:U.includes(f)})})(),K.find(U=>U.id==="schema")&&i.jsx(Cx,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),g("source")}})]}),!te&&Ne&&!Pe&&i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>g("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),i.jsx("button",{onClick:()=>g("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((ie=t==null?void 0:t.artifacts)==null?void 0:ie[f])&&i.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),ee&&i.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&H&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[H.roleId.replace(/_/g," ")," v",H.version]}),f==="template"&&V&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[V.templateId.replace(/_/g," ")," v",V.version]}),f==="qa_template"&&Z&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[Z.templateId.replace(/_/g," ")," v",Z.version]}),f==="pgc_template"&&B&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Pe&&i.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),je&&((ge=t==null?void 0:t.artifacts)==null?void 0:ge.schema)&&i.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),i.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:Te?ne?i.jsx(wH,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:o,mechanicalOpTypes:d,mechanicalOps:u}):i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8 max-w-md",children:[i.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),i.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),a&&i.jsx("button",{onClick:ct,disabled:Se,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:Se?"wait":"pointer",opacity:Se?.7:1},children:Se?"Creating...":"Create Workflow"})]})}):f==="package"?i.jsx(iH,{workspaceId:e,docType:t,roles:n,onSave:o}):f==="role_prompt"?i.jsx(rn,{content:x||"",onChange:()=>{},loading:v,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?i.jsx(rn,{content:N||"",onChange:()=>{},loading:C,saving:!1,isDirty:!1,error:w,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?i.jsx(rn,{content:E||"",onChange:()=>{},loading:z,saving:!1,isDirty:!1,error:P,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?i.jsx(rn,{content:D||"",onChange:()=>{},loading:I,saving:!1,isDirty:!1,error:F,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||je?i.jsx(rn,{content:oe,onChange:Pe?()=>{}:be,loading:X,saving:Pe?!1:fe,isDirty:Pe?!1:xe,error:Q,readOnly:Pe,placeholder:`Enter ${((pe=K.find(U=>U.id===f))==null?void 0:pe.label)||"prompt"} content...`,isJson:je}):i.jsx(oH,{workspaceId:e,artifactId:re})}),Ne&&(ye==null?void 0:ye.tier1)&&!ye.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function kH({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:s,loading:o,error:a,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=Ta(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),i.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),i.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),i.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:s,onChange:d,loading:o,saving:l,isDirty:c,error:a,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const NH=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],Ex={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Tx={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function CH({workspaceId:e,template:t,onArtifactSave:r}){const[n,s]=m.useState("metadata"),[o,a]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:g,error:x,saving:_,isDirty:v,updateContent:y,lastSaveResult:b}=Ta(e,f,{onSave:w=>{r==null||r(f,w)}});m.useEffect(()=>{t&&(a({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const j=m.useCallback((w,A)=>{a(E=>({...E,[w]:A})),c(!0)},[]),N=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const w=qy.dump({name:o.name||null,purpose:o.purpose||null,use_case:o.use_case||null},{lineWidth:-1});await we.writeArtifact(e,p,w),c(!1),r==null||r(p,{success:!0})}catch(w){console.error("Failed to save metadata:",w),alert(`Failed to save metadata: ${w.message}`)}finally{u(!1)}}},[e,p,o,r]),T=m.useCallback(()=>{l&&N()},[l,N]);if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),i.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const C=o.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase()),S=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:C}),i.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsxs("span",{children:["v",t.active_version]}),i.jsx("span",{children:""}),i.jsx("span",{children:"Shared Template"}),o.purpose&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:o.purpose})]})]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:S.map(w=>i.jsxs("button",{onClick:()=>s(w.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===w.id?"var(--text-primary)":"var(--text-muted)",background:n===w.id?"var(--bg-canvas)":"transparent",borderBottom:n===w.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[w.label,w.id==="metadata"&&l&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),w.id==="template"&&v&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},w.id))}),n==="metadata"&&i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"max-w-xl space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{style:Tx,children:"Template Name"}),i.jsx("input",{type:"text",value:o.name,onChange:w=>j("name",w.target.value),onBlur:T,placeholder:"e.g., Document Generator",style:Ex}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),i.jsxs("div",{children:[i.jsx("label",{style:Tx,children:"Template Purpose"}),i.jsx("select",{value:o.purpose,onChange:w=>{j("purpose",w.target.value),setTimeout(()=>N(),0)},style:Ex,children:NH.map(w=>i.jsx("option",{value:w.value,children:w.label},w.value))}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),i.jsxs("div",{children:[i.jsx("label",{style:Tx,children:"Use Case"}),i.jsx("textarea",{value:o.use_case,onChange:w=>j("use_case",w.target.value),onBlur:T,placeholder:"Describe when and how this template should be used...",rows:4,style:{...Ex,resize:"vertical"}}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:h,onChange:y,loading:g,saving:_,isDirty:v,error:x,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ai={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function EH({workspaceId:e,schema:t,onArtifactSave:r}){var v;const[n,s]=m.useState("content"),o=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:a,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=Ta(e,o,{onSave:y=>{r==null||r(o,y)}});if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),i.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((v=t.schema_id)==null?void 0:v.replace(/_/g," "))||"Schema",g=t.active_version||t.version||"1.0.0",x=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],_=!e;return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,i.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),i.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsxs("span",{children:["v",g]}),_&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:x.map(y=>i.jsxs("button",{onClick:()=>s(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===y.id?"var(--text-primary)":"var(--text-muted)",background:n===y.id?"var(--bg-canvas)":"transparent",borderBottom:n===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),n==="content"&&i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:a,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:_,isJson:!0})}),n==="info"&&i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"max-w-xl space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Schema ID"}),i.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Version"}),i.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:g})]}),i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Title (from JSON)"}),i.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),i.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"File Path"}),i.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",g,"/schema.json"]})]}),i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Artifact ID"}),i.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",g]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const TH={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},RH={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},Rx={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},li={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function AH({workspaceId:e,fragment:t,onArtifactSave:r}){var M;const[n,s]=m.useState("content"),[o,a]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,g]=((M=t==null?void 0:t.fragment_id)==null?void 0:M.split(":"))||[null,null],x=t?h==="role"?`fragment:role:${g}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,_=t&&h==="role"?`fragment:role:${g}:${t.version}:meta`:null,{content:v,loading:y,error:b,saving:j,isDirty:N,updateContent:T,lastSaveResult:C}=Ta(e,x,{onSave:F=>{r==null||r(x,F)}});m.useEffect(()=>{t&&(a({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const S=m.useCallback((F,q)=>{a(H=>({...H,[F]:q})),c(!0)},[]),w=m.useCallback(async()=>{if(!(!e||!_)){u(!0);try{const F=qy.dump({name:o.name||null,intent:o.intent||null,tags:o.tags.length>0?o.tags:null},{lineWidth:-1});await we.writeArtifact(e,_,F),c(!1),r==null||r(_,{success:!0})}catch(F){console.error("Failed to save metadata:",F),alert(`Failed to save metadata: ${F.message}`)}finally{u(!1)}}},[e,_,o,r]),A=m.useCallback(()=>{l&&_&&w()},[l,_,w]),E=m.useCallback(()=>{const F=f.trim().toLowerCase();F&&!o.tags.includes(F)&&(S("tags",[...o.tags,F]),p(""))},[f,o.tags,S]),O=m.useCallback(F=>{S("tags",o.tags.filter(q=>q!==F))},[o.tags,S]),z=m.useCallback(F=>{F.key==="Enter"&&(F.preventDefault(),E())},[E]);if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),i.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const k=o.name||t.name||t.fragment_id,P=TH[h]||h,R=RH[h]||"var(--text-muted)",D=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],L=!e,I=_&&!L;return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[k,i.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:R,color:"#fff"},children:P})]}),i.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsxs("span",{children:["from ",t.source_doc_type]})]}),L&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:D.map(F=>i.jsxs("button",{onClick:()=>s(F.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===F.id?"var(--text-primary)":"var(--text-muted)",background:n===F.id?"var(--bg-canvas)":"transparent",borderBottom:n===F.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[F.label,F.id==="content"&&N&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),F.id==="metadata"&&l&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},F.id))}),n==="content"&&i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:v,onChange:T,loading:y,saving:j,isDirty:N,error:b,placeholder:"Enter prompt content...",readOnly:L})}),n==="metadata"&&i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"max-w-xl space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{style:li,children:"Kind"}),i.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:R}}),i.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:P})]}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),i.jsxs("div",{children:[i.jsx("label",{style:li,children:"Name"}),i.jsx("input",{type:"text",value:o.name,onChange:F=>S("name",F.target.value),onBlur:A,placeholder:"e.g., Technical Architect Role",style:Rx,disabled:!I}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),i.jsxs("div",{children:[i.jsx("label",{style:li,children:"Intent"}),i.jsx("textarea",{value:o.intent,onChange:F=>S("intent",F.target.value),onBlur:A,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...Rx,resize:"vertical"},disabled:!I}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),i.jsxs("div",{children:[i.jsx("label",{style:li,children:"Tags"}),i.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:o.tags.map(F=>i.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[F,I&&i.jsx("button",{onClick:()=>O(F),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},F))}),I&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:f,onChange:F=>p(F.target.value),onKeyDown:z,placeholder:"Add tag...",style:{...Rx,flex:1}}),i.jsx("button",{onClick:E,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&i.jsxs("div",{children:[i.jsx("label",{style:li,children:"Source"}),i.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",i.jsx("strong",{children:t.source_doc_type})]}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!I&&!t.source_doc_type&&i.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(C==null?void 0:C.tier1)&&!C.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ci={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ui={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function IH({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[r,n]=m.useState(null),[s,o]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){n(null),o(null);return}(async()=>{l(!0),d(null);try{const x=await we.getMechanicalOp(e.op_id);n(x);const _=t.find(v=>v.type_id===x.type);if(_)o(_);else try{const v=await we.getMechanicalOpType(x.type);o(v)}catch{}}catch(x){console.error("Failed to load mechanical op details:",x),d(x.message),n(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),i.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=r||e;return i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(s==null?void 0:s.name)||u.type}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a&&i.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&i.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!a&&i.jsxs("div",{className:"space-y-6 max-w-2xl",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:ui,children:"Operation ID"}),i.jsx("div",{style:ci,className:"font-mono",children:u.op_id})]}),i.jsxs("div",{children:[i.jsx("label",{style:ui,children:"Name"}),i.jsx("div",{style:ci,children:u.name})]}),u.description&&i.jsxs("div",{children:[i.jsx("label",{style:ui,children:"Description"}),i.jsx("div",{style:{...ci,whiteSpace:"pre-wrap"},children:u.description})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:ui,children:"Type"}),i.jsx("div",{style:ci,children:u.type})]}),i.jsxs("div",{children:[i.jsx("label",{style:ui,children:"Version"}),i.jsx("div",{style:ci,children:u.active_version||u.version})]})]})]})]}),s&&i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),i.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("span",{style:{fontSize:16},children:[s.icon==="git-merge"&&"",s.icon==="scissors"&&"",s.icon==="check-circle"&&"",s.icon==="shuffle"&&"",s.icon==="git-branch"&&""]}),i.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:s.name}),i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:s.category})]}),i.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=s.inputs)==null?void 0:f.length)>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),s.inputs.map((g,x)=>i.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[g.name,": ",g.type]},x))]}),((p=s.outputs)==null?void 0:p.length)>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),s.outputs.map((g,x)=>i.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[g.name,": ",g.type]},x))]})]})]})]}),u.config&&i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),i.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),i.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&i.jsxs("div",{className:"flex justify-between text-xs",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),i.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&i.jsxs("div",{className:"flex justify-between text-xs",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),i.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&i.jsxs("div",{children:[i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),i.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(g=>i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:g},g))})]})]})]}),i.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[i.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",i.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function PH(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(s=>s(n))},t)}const Eu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function qo(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function By(e){return"nodeType"in e}function Zt(e){var t,r;return e?qo(e)?e:By(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Wy(e){const{Document:t}=Zt(e);return e instanceof t}function Ra(e){return qo(e)?!1:e instanceof Zt(e).HTMLElement}function X3(e){return e instanceof Zt(e).SVGElement}function Bo(e){return e?qo(e)?e.document:By(e)?Wy(e)?e:Ra(e)||X3(e)?e.ownerDocument:document:document:document}const Kr=Eu?m.useLayoutEffect:m.useEffect;function Hy(e){const t=m.useRef(e);return Kr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function OH(){const e=m.useRef(null),t=m.useCallback((n,s)=>{e.current=setInterval(n,s)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function fa(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Kr(()=>{r.current!==e&&(r.current=e)},t),r}function Aa(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function Ac(e){const t=Hy(e),r=m.useRef(null),n=m.useCallback(s=>{s!==r.current&&(t==null||t(s,r.current)),r.current=s},[]);return[r,n]}function Zg(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Ax={};function Ia(e,t){return m.useMemo(()=>{if(t)return t;const r=Ax[e]==null?0:Ax[e]+1;return Ax[e]=r,e+"-"+r},[e,t])}function Q3(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((o,a)=>{const l=Object.entries(a);for(const[c,d]of l){const u=o[c];u!=null&&(o[c]=u+e*d)}return o},{...t})}}const vo=Q3(1),pa=Q3(-1);function MH(e){return"clientX"in e&&"clientY"in e}function Uy(e){if(!e)return!1;const{KeyboardEvent:t}=Zt(e.target);return t&&e instanceof t}function DH(e){if(!e)return!1;const{TouchEvent:t}=Zt(e.target);return t&&e instanceof t}function Jg(e){if(DH(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return MH(e)?{x:e.clientX,y:e.clientY}:null}const Ao=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Ao.Translate.toString(e),Ao.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),PS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function LH(e){return e.matches(PS)?e:e.querySelector(PS)}const zH={display:"none"};function FH(e){let{id:t,value:r}=e;return Y.createElement("div",{id:t,style:zH},r)}function $H(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function qH(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const Z3=m.createContext(null);function BH(e){const t=m.useContext(Z3);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function WH(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:s,event:o}=n;e.forEach(a=>{var l;return(l=a[s])==null?void 0:l.call(a,o)})},[e]),t]}const HH={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},UH={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function VH(e){let{announcements:t=UH,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=HH}=e;const{announce:o,announcement:a}=qH(),l=Ia("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),BH(m.useMemo(()=>({onDragStart(f){let{active:p}=f;o(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&o(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;o(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;o(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;o(t.onDragCancel({active:p,over:h}))}}),[o,t])),!c)return null;const u=Y.createElement(Y.Fragment,null,Y.createElement(FH,{id:n,value:s.draggable}),Y.createElement($H,{id:l,announcement:a}));return r?so.createPortal(u,r):u}var mt;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(mt||(mt={}));function Ic(){}function Pc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function J3(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Pr=Object.freeze({x:0,y:0});function eT(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function tT(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function GH(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function OS(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function rT(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function MS(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const nT=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=MS(t,t.left,t.top),o=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=eT(MS(c),s);o.push({id:l,data:{droppableContainer:a,value:d}})}}return o.sort(tT)},KH=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=OS(t),o=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=OS(c),u=s.reduce((p,h,g)=>p+eT(d[g],h),0),f=Number((u/4).toFixed(4));o.push({id:l,data:{droppableContainer:a,value:f}})}}return o.sort(tT)};function YH(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),a=s-n,l=o-r;if(n<s&&r<o){const c=t.width*t.height,d=e.width*e.height,u=a*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const XH=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const o of n){const{id:a}=o,l=r.get(a);if(l){const c=YH(l,t);c>0&&s.push({id:a,data:{droppableContainer:o,value:c}})}}return s.sort(GH)};function QH(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function sT(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Pr}function ZH(e){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return s.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...r})}}const JH=ZH(1);function eU(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function tU(e,t,r){const n=eU(t);if(!n)return e;const{scaleX:s,scaleY:o,x:a,y:l}=n,c=e.left-a-(1-s)*parseFloat(r),d=e.top-l-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),u=s?e.width/s:e.width,f=o?e.height/o:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const rU={ignoreTransform:!1};function Wo(e,t){t===void 0&&(t=rU);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Zt(e).getComputedStyle(e);d&&(r=tU(r,d,u))}const{top:n,left:s,width:o,height:a,bottom:l,right:c}=r;return{top:n,left:s,width:o,height:a,bottom:l,right:c}}function DS(e){return Wo(e,{ignoreTransform:!0})}function nU(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function sU(e,t){return t===void 0&&(t=Zt(e).getComputedStyle(e)),t.position==="fixed"}function oU(e,t){t===void 0&&(t=Zt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?r.test(o):!1})}function Tu(e,t){const r=[];function n(s){if(t!=null&&r.length>=t||!s)return r;if(Wy(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!Ra(s)||X3(s)||r.includes(s))return r;const o=Zt(e).getComputedStyle(s);return s!==e&&oU(s,o)&&r.push(s),sU(s,o)?r:n(s.parentNode)}return e?n(e):r}function oT(e){const[t]=Tu(e,1);return t??null}function Ix(e){return!Eu||!e?null:qo(e)?e:By(e)?Wy(e)||e===Bo(e).scrollingElement?window:Ra(e)?e:null:null}function iT(e){return qo(e)?e.scrollX:e.scrollLeft}function aT(e){return qo(e)?e.scrollY:e.scrollTop}function ev(e){return{x:iT(e),y:aT(e)}}var bt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(bt||(bt={}));function lT(e){return!Eu||!e?!1:e===document.scrollingElement}function cT(e){const t={x:0,y:0},r=lT(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,a=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:s,isLeft:o,isBottom:a,isRight:l,maxScroll:n,minScroll:t}}const iU={x:.2,y:.2};function aU(e,t,r,n,s){let{top:o,left:a,right:l,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=iU);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=cT(e),h={x:0,y:0},g={x:0,y:0},x={height:t.height*s.y,width:t.width*s.x};return!d&&o<=t.top+x.height?(h.y=bt.Backward,g.y=n*Math.abs((t.top+x.height-o)/x.height)):!u&&c>=t.bottom-x.height&&(h.y=bt.Forward,g.y=n*Math.abs((t.bottom-x.height-c)/x.height)),!p&&l>=t.right-x.width?(h.x=bt.Forward,g.x=n*Math.abs((t.right-x.width-l)/x.width)):!f&&a<=t.left+x.width&&(h.x=bt.Backward,g.x=n*Math.abs((t.left+x.width-a)/x.width)),{direction:h,speed:g}}function lU(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:a}=window;return{top:0,left:0,right:o,bottom:a,width:o,height:a}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function uT(e){return e.reduce((t,r)=>vo(t,ev(r)),Pr)}function cU(e){return e.reduce((t,r)=>t+iT(r),0)}function uU(e){return e.reduce((t,r)=>t+aT(r),0)}function dU(e,t){if(t===void 0&&(t=Wo),!e)return;const{top:r,left:n,bottom:s,right:o}=t(e);oT(e)&&(s<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const fU=[["x",["left","right"],cU],["y",["top","bottom"],uU]];class Vy{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Tu(r),s=uT(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,a,l]of fU)for(const c of a)Object.defineProperty(this,c,{get:()=>{const d=l(n),u=s[o]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Pi{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var s;(s=this.target)==null||s.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function pU(e){const{EventTarget:t}=Zt(e);return e instanceof t?e:Bo(e)}function Px(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ur;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ur||(ur={}));function LS(e){e.preventDefault()}function hU(e){e.stopPropagation()}var Me;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Me||(Me={}));const dT={start:[Me.Space,Me.Enter],cancel:[Me.Esc],end:[Me.Space,Me.Enter,Me.Tab]},mU=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Me.Right:return{...r,x:r.x+25};case Me.Left:return{...r,x:r.x-25};case Me.Down:return{...r,y:r.y+25};case Me.Up:return{...r,y:r.y-25}}};class Ru{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Pi(Bo(r)),this.windowListeners=new Pi(Zt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ur.Resize,this.handleCancel),this.windowListeners.add(ur.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ur.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&dU(n),r(Pr)}handleKeyDown(t){if(Uy(t)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:o=dT,coordinateGetter:a=mU,scrollBehavior:l="smooth"}=s,{code:c}=t;if(o.end.includes(c)){this.handleEnd(t);return}if(o.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=n.current,u=d?{x:d.left,y:d.top}:Pr;this.referenceCoordinates||(this.referenceCoordinates=u);const f=a(t,{active:r,context:n.current,currentCoordinates:u});if(f){const p=pa(f,u),h={x:0,y:0},{scrollableAncestors:g}=n.current;for(const x of g){const _=t.code,{isTop:v,isRight:y,isLeft:b,isBottom:j,maxScroll:N,minScroll:T}=cT(x),C=lU(x),S={x:Math.min(_===Me.Right?C.right-C.width/2:C.right,Math.max(_===Me.Right?C.left:C.left+C.width/2,f.x)),y:Math.min(_===Me.Down?C.bottom-C.height/2:C.bottom,Math.max(_===Me.Down?C.top:C.top+C.height/2,f.y))},w=_===Me.Right&&!y||_===Me.Left&&!b,A=_===Me.Down&&!j||_===Me.Up&&!v;if(w&&S.x!==f.x){const E=x.scrollLeft+p.x,O=_===Me.Right&&E<=N.x||_===Me.Left&&E>=T.x;if(O&&!p.y){x.scrollTo({left:E,behavior:l});return}O?h.x=x.scrollLeft-E:h.x=_===Me.Right?x.scrollLeft-N.x:x.scrollLeft-T.x,h.x&&x.scrollBy({left:-h.x,behavior:l});break}else if(A&&S.y!==f.y){const E=x.scrollTop+p.y,O=_===Me.Down&&E<=N.y||_===Me.Up&&E>=T.y;if(O&&!p.x){x.scrollTo({top:E,behavior:l});return}O?h.y=x.scrollTop-E:h.y=_===Me.Down?x.scrollTop-N.y:x.scrollTop-T.y,h.y&&x.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,vo(pa(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ru.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=dT,onActivation:s}=t,{active:o}=r;const{code:a}=e.nativeEvent;if(n.start.includes(a)){const l=o.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function zS(e){return!!(e&&"distance"in e)}function FS(e){return!!(e&&"delay"in e)}class Gy{constructor(t,r,n){var s;n===void 0&&(n=pU(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:a}=o;this.props=t,this.events=r,this.document=Bo(a),this.documentListeners=new Pi(this.document),this.listeners=new Pi(n),this.windowListeners=new Pi(Zt(a)),this.initialCoordinates=(s=Jg(o))!=null?s:Pr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ur.Resize,this.handleCancel),this.windowListeners.add(ur.DragStart,LS),this.windowListeners.add(ur.VisibilityChange,this.handleCancel),this.windowListeners.add(ur.ContextMenu,LS),this.documentListeners.add(ur.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(FS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(zS(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ur.Click,hU,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ur.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:s,props:o}=this,{onMove:a,options:{activationConstraint:l}}=o;if(!s)return;const c=(r=Jg(t))!=null?r:Pr,d=pa(s,c);if(!n&&l){if(zS(l)){if(l.tolerance!=null&&Px(d,l.tolerance))return this.handleCancel();if(Px(d,l.distance))return this.handleStart()}if(FS(l)&&Px(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),a(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Me.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const xU={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Au extends Gy{constructor(t){const{event:r}=t,n=Bo(r.target);super(t,xU,n)}}Au.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const gU={move:{name:"mousemove"},end:{name:"mouseup"}};var tv;(function(e){e[e.RightClick=2]="RightClick"})(tv||(tv={}));class vU extends Gy{constructor(t){super(t,gU,Bo(t.event.target))}}vU.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===tv.RightClick?!1:(n==null||n({event:r}),!0)}}];const Ox={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class yU extends Gy{constructor(t){super(t,Ox)}static setup(){return window.addEventListener(Ox.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Ox.move.name,t)};function t(){}}}yU.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var Oi;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Oi||(Oi={}));var Oc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Oc||(Oc={}));function bU(e){let{acceleration:t,activator:r=Oi.Pointer,canScroll:n,draggingRect:s,enabled:o,interval:a=5,order:l=Oc.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=wU({delta:f,disabled:!o}),[g,x]=OH(),_=m.useRef({x:0,y:0}),v=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(r){case Oi.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Oi.DraggableRect:return s}},[r,s,c]),b=m.useRef(null),j=m.useCallback(()=>{const T=b.current;if(!T)return;const C=_.current.x*v.current.x,S=_.current.y*v.current.y;T.scrollBy(C,S)},[]),N=m.useMemo(()=>l===Oc.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!o||!d.length||!y){x();return}for(const T of N){if((n==null?void 0:n(T))===!1)continue;const C=d.indexOf(T),S=u[C];if(!S)continue;const{direction:w,speed:A}=aU(T,S,y,t,p);for(const E of["x","y"])h[E][w[E]]||(A[E]=0,w[E]=0);if(A.x>0||A.y>0){x(),b.current=T,g(j,a),_.current=A,v.current=w;return}}_.current={x:0,y:0},v.current={x:0,y:0},x()},[t,j,n,x,o,a,JSON.stringify(y),JSON.stringify(h),g,d,N,u,JSON.stringify(p)])}const _U={x:{[bt.Backward]:!1,[bt.Forward]:!1},y:{[bt.Backward]:!1,[bt.Forward]:!1}};function wU(e){let{delta:t,disabled:r}=e;const n=Zg(t);return Aa(s=>{if(r||!n||!s)return _U;const o={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[bt.Backward]:s.x[bt.Backward]||o.x===-1,[bt.Forward]:s.x[bt.Forward]||o.x===1},y:{[bt.Backward]:s.y[bt.Backward]||o.y===-1,[bt.Forward]:s.y[bt.Forward]||o.y===1}}},[r,t,n])}function jU(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Aa(s=>{var o;return t==null?null:(o=n??s)!=null?o:null},[n,t])}function SU(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:s}=n,o=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,n)}));return[...r,...o]},[]),[e,t])}var ha;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(ha||(ha={}));var rv;(function(e){e.Optimized="optimized"})(rv||(rv={}));const $S=new Map;function kU(e,t){let{dragging:r,dependencies:n,config:s}=t;const[o,a]=m.useState(null),{frequency:l,measure:c,strategy:d}=s,u=m.useRef(e),f=_(),p=fa(f),h=m.useCallback(function(v){v===void 0&&(v=[]),!p.current&&a(y=>y===null?v:y.concat(v.filter(b=>!y.includes(b))))},[p]),g=m.useRef(null),x=Aa(v=>{if(f&&!r)return $S;if(!v||v===$S||u.current!==e||o!=null){const y=new Map;for(let b of e){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const j=b.node.current,N=j?new Vy(c(j),j):null;b.rect.current=N,N&&y.set(b.id,N)}return y}return v},[e,o,r,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{o&&o.length>0&&a(null)},[JSON.stringify(o)]),m.useEffect(()=>{f||typeof l!="number"||g.current!==null||(g.current=setTimeout(()=>{h(),g.current=null},l))},[l,f,h,...n]),{droppableRects:x,measureDroppableContainers:h,measuringScheduled:o!=null};function _(){switch(d){case ha.Always:return!1;case ha.BeforeDragging:return r;default:return!r}}}function fT(e,t){return Aa(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function NU(e,t){return fT(e,t)}function CU(e){let{callback:t,disabled:r}=e;const n=Hy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Iu(e){let{callback:t,disabled:r}=e;const n=Hy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function EU(e){return new Vy(Wo(e),e)}function qS(e,t,r){t===void 0&&(t=EU);const[n,s]=m.useState(null);function o(){s(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??r)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const a=CU({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){o();break}}}}),l=Iu({callback:o});return Kr(()=>{o(),e?(l==null||l.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),a==null||a.disconnect())},[e]),n}function TU(e){const t=fT(e);return sT(e,t)}const BS=[];function RU(e){const t=m.useRef(e),r=Aa(n=>e?n&&n!==BS&&e&&t.current&&e.parentNode===t.current.parentNode?n:Tu(e):BS,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function AU(e){const[t,r]=m.useState(null),n=m.useRef(e),s=m.useCallback(o=>{const a=Ix(o.target);a&&r(l=>l?(l.set(a,ev(a)),new Map(l)):null)},[]);return m.useEffect(()=>{const o=n.current;if(e!==o){a(o);const l=e.map(c=>{const d=Ix(c);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,ev(d)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{a(e),a(o)};function a(l){l.forEach(c=>{const d=Ix(c);d==null||d.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,a)=>vo(o,a),Pr):uT(e):Pr,[e,t])}function WS(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Pr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?pa(e,r.current):Pr}function IU(e){m.useEffect(()=>{if(!Eu)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function PU(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:s,handler:o}=n;return r[s]=a=>{o(a,t)},r},{}),[e,t])}function pT(e){return m.useMemo(()=>e?nU(e):null,[e])}const HS=[];function OU(e,t){t===void 0&&(t=Wo);const[r]=e,n=pT(r?Zt(r):null),[s,o]=m.useState(HS);function a(){o(()=>e.length?e.map(c=>lT(c)?n:new Vy(t(c),c)):HS)}const l=Iu({callback:a});return Kr(()=>{l==null||l.disconnect(),a(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),s}function MU(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ra(t)?t:e}function DU(e){let{measure:t}=e;const[r,n]=m.useState(null),s=m.useCallback(d=>{for(const{target:u}of d)if(Ra(u)){n(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),o=Iu({callback:s}),a=m.useCallback(d=>{const u=MU(d);o==null||o.disconnect(),u&&(o==null||o.observe(u)),n(u?t(u):null)},[t,o]),[l,c]=Ac(a);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const LU=[{sensor:Au,options:{}},{sensor:Ru,options:{}}],zU={current:{}},Dl={draggable:{measure:DS},droppable:{measure:DS,strategy:ha.WhileDragging,frequency:rv.Optimized},dragOverlay:{measure:Wo}};class Mi extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const FU={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Mi,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ic},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Dl,measureDroppableContainers:Ic,windowRect:null,measuringScheduled:!1},$U={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ic,draggableNodes:new Map,over:null,measureDroppableContainers:Ic},Pu=m.createContext($U),hT=m.createContext(FU);function qU(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Mi}}}function BU(e,t){switch(t.type){case mt.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case mt.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case mt.DragEnd:case mt.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case mt.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new Mi(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case mt.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;const a=new Mi(e.droppable.containers);return a.set(r,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case mt.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new Mi(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function WU(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:s}=m.useContext(Pu),o=Zg(n),a=Zg(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&o&&a!=null){if(!Uy(o)||document.activeElement===o.target)return;const l=s.get(a);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=LH(u);if(f){f.focus();break}}})}},[n,t,s,a,o]),null}function HU(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...n}),r):r}function UU(e){return m.useMemo(()=>({draggable:{...Dl.draggable,...e==null?void 0:e.draggable},droppable:{...Dl.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Dl.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function VU(e){let{activeNode:t,measure:r,initialRect:n,config:s=!0}=e;const o=m.useRef(!1),{x:a,y:l}=typeof s=="boolean"?{x:s,y:s}:s;Kr(()=>{if(!a&&!l||!t){o.current=!1;return}if(o.current||!n)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=r(d),f=sT(u,n);if(a||(f.x=0),l||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=oT(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,a,l,n,r])}const mT=m.createContext({...Pr,scaleX:1,scaleY:1});var Tn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Tn||(Tn={}));const xT=m.memo(function(t){var r,n,s,o;let{id:a,accessibility:l,autoScroll:c=!0,children:d,sensors:u=LU,collisionDetection:f=XH,measuring:p,modifiers:h,...g}=t;const x=m.useReducer(BU,void 0,qU),[_,v]=x,[y,b]=WH(),[j,N]=m.useState(Tn.Uninitialized),T=j===Tn.Initialized,{draggable:{active:C,nodes:S,translate:w},droppable:{containers:A}}=_,E=C!=null?S.get(C):null,O=m.useRef({initial:null,translated:null}),z=m.useMemo(()=>{var se;return C!=null?{id:C,data:(se=E==null?void 0:E.data)!=null?se:zU,rect:O}:null},[C,E]),k=m.useRef(null),[P,R]=m.useState(null),[D,L]=m.useState(null),I=fa(g,Object.values(g)),M=Ia("DndDescribedBy",a),F=m.useMemo(()=>A.getEnabled(),[A]),q=UU(p),{droppableRects:H,measureDroppableContainers:V,measuringScheduled:Z}=kU(F,{dragging:T,dependencies:[w.x,w.y],config:q.droppable}),B=jU(S,C),re=m.useMemo(()=>D?Jg(D):null,[D]),oe=G(),X=NU(B,q.draggable.measure);VU({activeNode:C!=null?S.get(C):null,config:oe.layoutShiftCompensation,initialRect:X,measure:q.draggable.measure});const Q=qS(B,q.draggable.measure,X),fe=qS(B?B.parentElement:null),xe=m.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:H,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:A,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),be=A.getNodeFor((r=xe.current.over)==null?void 0:r.id),ye=DU({measure:q.dragOverlay.measure}),ae=(n=ye.nodeRef.current)!=null?n:B,K=T?(s=ye.rect)!=null?s:Q:null,te=!!(ye.nodeRef.current&&ye.rect),ee=TU(te?null:Q),ke=pT(ae?Zt(ae):null),je=RU(T?be??B:null),Te=OU(je),Ne=HU(h,{transform:{x:w.x-ee.x,y:w.y-ee.y,scaleX:1,scaleY:1},activatorEvent:D,active:z,activeNodeRect:Q,containerNodeRect:fe,draggingNodeRect:K,over:xe.current.over,overlayNodeRect:ye.rect,scrollableAncestors:je,scrollableAncestorRects:Te,windowRect:ke}),ne=re?vo(re,w):null,Se=AU(je),Ve=WS(Se),ct=WS(Se,[Q]),We=vo(Ne,Ve),Pe=K?JH(K,Ne):null,ie=z&&Pe?f({active:z,collisionRect:Pe,droppableRects:H,droppableContainers:F,pointerCoordinates:ne}):null,ge=rT(ie,"id"),[pe,U]=m.useState(null),ve=te?Ne:vo(Ne,ct),he=QH(ve,(o=pe==null?void 0:pe.rect)!=null?o:null,Q),Fe=m.useRef(null),He=m.useCallback((se,$e)=>{let{sensor:pt,options:lr}=$e;if(k.current==null)return;const Tt=S.get(k.current);if(!Tt)return;const jt=se.nativeEvent,Bt=new pt({active:k.current,activeNode:Tt,event:jt,options:lr,context:xe,onAbort(at){if(!S.get(at))return;const{onDragAbort:de}=I.current,Ye={id:at};de==null||de(Ye),y({type:"onDragAbort",event:Ye})},onPending(at,ue,de,Ye){if(!S.get(at))return;const{onDragPending:ns}=I.current,zr={id:at,constraint:ue,initialCoordinates:de,offset:Ye};ns==null||ns(zr),y({type:"onDragPending",event:zr})},onStart(at){const ue=k.current;if(ue==null)return;const de=S.get(ue);if(!de)return;const{onDragStart:Ye}=I.current,wr={activatorEvent:jt,active:{id:ue,data:de.data,rect:O}};so.unstable_batchedUpdates(()=>{Ye==null||Ye(wr),N(Tn.Initializing),v({type:mt.DragStart,initialCoordinates:at,active:ue}),y({type:"onDragStart",event:wr}),R(Fe.current),L(jt)})},onMove(at){v({type:mt.DragMove,coordinates:at})},onEnd:Lr(mt.DragEnd),onCancel:Lr(mt.DragCancel)});Fe.current=Bt;function Lr(at){return async function(){const{active:de,collisions:Ye,over:wr,scrollAdjustedTranslate:ns}=xe.current;let zr=null;if(de&&ns){const{cancelDrop:ss}=I.current;zr={activatorEvent:jt,active:de,collisions:Ye,delta:ns,over:wr},at===mt.DragEnd&&typeof ss=="function"&&await Promise.resolve(ss(zr))&&(at=mt.DragCancel)}k.current=null,so.unstable_batchedUpdates(()=>{v({type:at}),N(Tn.Uninitialized),U(null),R(null),L(null),Fe.current=null;const ss=at===mt.DragEnd?"onDragEnd":"onDragCancel";if(zr){const Ho=I.current[ss];Ho==null||Ho(zr),y({type:ss,event:zr})}})}}},[S]),st=m.useCallback((se,$e)=>(pt,lr)=>{const Tt=pt.nativeEvent,jt=S.get(lr);if(k.current!==null||!jt||Tt.dndKit||Tt.defaultPrevented)return;const Bt={active:jt};se(pt,$e.options,Bt)===!0&&(Tt.dndKit={capturedBy:$e.sensor},k.current=lr,He(pt,$e))},[S,He]),Ge=SU(u,st);IU(u),Kr(()=>{Q&&j===Tn.Initializing&&N(Tn.Initialized)},[Q,j]),m.useEffect(()=>{const{onDragMove:se}=I.current,{active:$e,activatorEvent:pt,collisions:lr,over:Tt}=xe.current;if(!$e||!pt)return;const jt={active:$e,activatorEvent:pt,collisions:lr,delta:{x:We.x,y:We.y},over:Tt};so.unstable_batchedUpdates(()=>{se==null||se(jt),y({type:"onDragMove",event:jt})})},[We.x,We.y]),m.useEffect(()=>{const{active:se,activatorEvent:$e,collisions:pt,droppableContainers:lr,scrollAdjustedTranslate:Tt}=xe.current;if(!se||k.current==null||!$e||!Tt)return;const{onDragOver:jt}=I.current,Bt=lr.get(ge),Lr=Bt&&Bt.rect.current?{id:Bt.id,rect:Bt.rect.current,data:Bt.data,disabled:Bt.disabled}:null,at={active:se,activatorEvent:$e,collisions:pt,delta:{x:Tt.x,y:Tt.y},over:Lr};so.unstable_batchedUpdates(()=>{U(Lr),jt==null||jt(at),y({type:"onDragOver",event:at})})},[ge]),Kr(()=>{xe.current={activatorEvent:D,active:z,activeNode:B,collisionRect:Pe,collisions:ie,droppableRects:H,draggableNodes:S,draggingNode:ae,draggingNodeRect:K,droppableContainers:A,over:pe,scrollableAncestors:je,scrollAdjustedTranslate:We},O.current={initial:K,translated:Pe}},[z,B,ie,Pe,S,ae,K,H,A,pe,je,We]),bU({...oe,delta:w,draggingRect:Pe,pointerCoordinates:ne,scrollableAncestors:je,scrollableAncestorRects:Te});const $=m.useMemo(()=>({active:z,activeNode:B,activeNodeRect:Q,activatorEvent:D,collisions:ie,containerNodeRect:fe,dragOverlay:ye,draggableNodes:S,droppableContainers:A,droppableRects:H,over:pe,measureDroppableContainers:V,scrollableAncestors:je,scrollableAncestorRects:Te,measuringConfiguration:q,measuringScheduled:Z,windowRect:ke}),[z,B,Q,D,ie,fe,ye,S,A,H,pe,V,je,Te,q,Z,ke]),W=m.useMemo(()=>({activatorEvent:D,activators:Ge,active:z,activeNodeRect:Q,ariaDescribedById:{draggable:M},dispatch:v,draggableNodes:S,over:pe,measureDroppableContainers:V}),[D,Ge,z,Q,v,M,S,pe,V]);return Y.createElement(Z3.Provider,{value:b},Y.createElement(Pu.Provider,{value:W},Y.createElement(hT.Provider,{value:$},Y.createElement(mT.Provider,{value:he},d)),Y.createElement(WU,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Y.createElement(VH,{...l,hiddenTextDescribedById:M}));function G(){const se=(P==null?void 0:P.autoScrollEnabled)===!1,$e=typeof c=="object"?c.enabled===!1:c===!1,pt=T&&!se&&!$e;return typeof c=="object"?{...c,enabled:pt}:{enabled:pt}}}),GU=m.createContext(null),US="button",KU="Draggable";function YU(e){let{id:t,data:r,disabled:n=!1,attributes:s}=e;const o=Ia(KU),{activators:a,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(Pu),{role:h=US,roleDescription:g="draggable",tabIndex:x=0}=s??{},_=(c==null?void 0:c.id)===t,v=m.useContext(_?mT:GU),[y,b]=Ac(),[j,N]=Ac(),T=PU(a,t),C=fa(r);Kr(()=>(f.set(t,{id:t,key:o,node:y,activatorNode:j,data:C}),()=>{const w=f.get(t);w&&w.key===o&&f.delete(t)}),[f,t]);const S=m.useMemo(()=>({role:h,tabIndex:x,"aria-disabled":n,"aria-pressed":_&&h===US?!0:void 0,"aria-roledescription":g,"aria-describedby":u.draggable}),[n,h,x,_,g,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:S,isDragging:_,listeners:n?void 0:T,node:y,over:p,setNodeRef:b,setActivatorNodeRef:N,transform:v}}function XU(){return m.useContext(hT)}const QU="Droppable",ZU={timeout:25};function JU(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:s}=e;const o=Ia(QU),{active:a,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(Pu),u=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:g,updateMeasurementsFor:x,timeout:_}={...ZU,...s},v=fa(x??n),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(v.current)?v.current:[v.current]),h.current=null},_)},[_]),b=Iu({callback:y,disabled:g||!a}),j=m.useCallback((S,w)=>{b&&(w&&(b.unobserve(w),f.current=!1),S&&b.observe(S))},[b]),[N,T]=Ac(j),C=fa(t);return m.useEffect(()=>{!b||!N.current||(b.disconnect(),f.current=!1,b.observe(N.current))},[N,b]),m.useEffect(()=>(l({type:mt.RegisterDroppable,element:{id:n,key:o,disabled:r,node:N,rect:p,data:C}}),()=>l({type:mt.UnregisterDroppable,key:o,id:n})),[n]),m.useEffect(()=>{r!==u.current.disabled&&(l({type:mt.SetDroppableDisabled,id:n,key:o,disabled:r}),u.current.disabled=r)},[n,o,r,l]),{active:a,rect:p,isOver:(c==null?void 0:c.id)===n,node:N,over:c,setNodeRef:T}}function Ou(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function eV(e,t){return e.reduce((r,n,s)=>{const o=t.get(n);return o&&(r[s]=o),r},Array(e.length))}function gl(e){return e!==null&&e>=0}function tV(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function rV(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const gT=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const o=Ou(t,n,r),a=t[s],l=o[s];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},vl={scaleX:1,scaleY:1},vT=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:o,overIndex:a}=e;const l=(t=o[r])!=null?t:n;if(!l)return null;if(s===r){const d=o[a];return d?{x:0,y:r<a?d.top+d.height-(l.top+l.height):d.top-l.top,...vl}:null}const c=nV(o,s,r);return s>r&&s<=a?{x:0,y:-l.height-c,...vl}:s<r&&s>=a?{x:0,y:l.height+c,...vl}:{x:0,y:0,...vl}};function nV(e,t,r){const n=e[t],s=e[t-1],o=e[t+1];return n?r<t?s?n.top-(s.top+s.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):s?n.top-(s.top+s.height):0:0}const yT="Sortable",bT=Y.createContext({activeIndex:-1,containerId:yT,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:gT,disabled:{draggable:!1,droppable:!1}});function _T(e){let{children:t,id:r,items:n,strategy:s=gT,disabled:o=!1}=e;const{active:a,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=XU(),f=Ia(yT,r),p=l.rect!==null,h=m.useMemo(()=>n.map(T=>typeof T=="object"&&"id"in T?T.id:T),[n]),g=a!=null,x=a?h.indexOf(a.id):-1,_=d?h.indexOf(d.id):-1,v=m.useRef(h),y=!tV(h,v.current),b=_!==-1&&x===-1||y,j=rV(o);Kr(()=>{y&&g&&u(h)},[y,h,g,u]),m.useEffect(()=>{v.current=h},[h]);const N=m.useMemo(()=>({activeIndex:x,containerId:f,disabled:j,disableTransforms:b,items:h,overIndex:_,useDragOverlay:p,sortedRects:eV(h,c),strategy:s}),[x,f,j.draggable,j.droppable,b,h,_,c,p,s]);return Y.createElement(bT.Provider,{value:N},t)}const sV=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return Ou(r,n,s).indexOf(t)},oV=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:o,newIndex:a,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!n||l!==o&&s===a?!1:r?!0:a!==s&&t===c},iV={duration:200,easing:"ease"},wT="transform",aV=Ao.Transition.toString({property:wT,duration:0,easing:"linear"}),lV={roleDescription:"sortable"};function cV(e){let{disabled:t,index:r,node:n,rect:s}=e;const[o,a]=m.useState(null),l=m.useRef(r);return Kr(()=>{if(!t&&r!==l.current&&n.current){const c=s.current;if(c){const d=Wo(n.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&a(u)}}r!==l.current&&(l.current=r)},[t,r,n,s]),m.useEffect(()=>{o&&a(null)},[o]),o}function jT(e){let{animateLayoutChanges:t=oV,attributes:r,disabled:n,data:s,getNewIndex:o=sV,id:a,strategy:l,resizeObserverConfig:c,transition:d=iV}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:g,sortedRects:x,overIndex:_,useDragOverlay:v,strategy:y}=m.useContext(bT),b=uV(n,h),j=u.indexOf(a),N=m.useMemo(()=>({sortable:{containerId:f,index:j,items:u},...s}),[f,s,j,u]),T=m.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:C,node:S,isOver:w,setNodeRef:A}=JU({id:a,data:N,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...c}}),{active:E,activatorEvent:O,activeNodeRect:z,attributes:k,setNodeRef:P,listeners:R,isDragging:D,over:L,setActivatorNodeRef:I,transform:M}=YU({id:a,data:N,attributes:{...lV,...r},disabled:b.draggable}),F=PH(A,P),q=!!E,H=q&&!g&&gl(p)&&gl(_),V=!v&&D,Z=V&&H?M:null,re=H?Z??(l??y)({rects:x,activeNodeRect:z,activeIndex:p,overIndex:_,index:j}):null,oe=gl(p)&&gl(_)?o({id:a,items:u,activeIndex:p,overIndex:_}):j,X=E==null?void 0:E.id,Q=m.useRef({activeId:X,items:u,newIndex:oe,containerId:f}),fe=u!==Q.current.items,xe=t({active:E,containerId:f,isDragging:D,isSorting:q,id:a,index:j,items:u,newIndex:Q.current.newIndex,previousItems:Q.current.items,previousContainerId:Q.current.containerId,transition:d,wasDragging:Q.current.activeId!=null}),be=cV({disabled:!xe,index:j,node:S,rect:C});return m.useEffect(()=>{q&&Q.current.newIndex!==oe&&(Q.current.newIndex=oe),f!==Q.current.containerId&&(Q.current.containerId=f),u!==Q.current.items&&(Q.current.items=u)},[q,oe,f,u]),m.useEffect(()=>{if(X===Q.current.activeId)return;if(X!=null&&Q.current.activeId==null){Q.current.activeId=X;return}const ae=setTimeout(()=>{Q.current.activeId=X},50);return()=>clearTimeout(ae)},[X]),{active:E,activeIndex:p,attributes:k,data:N,rect:C,index:j,newIndex:oe,items:u,isOver:w,isSorting:q,isDragging:D,listeners:R,node:S,overIndex:_,over:L,setNodeRef:F,setActivatorNodeRef:I,setDroppableNodeRef:A,setDraggableNodeRef:P,transform:be??re,transition:ye()};function ye(){if(be||fe&&Q.current.newIndex===j)return aV;if(!(V&&!Uy(O)||!d)&&(q||xe))return Ao.Transition.toString({...d,property:wT})}}function uV(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Mc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const dV=[Me.Down,Me.Right,Me.Up,Me.Left],ST=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:o,over:a,scrollableAncestors:l}}=t;if(dV.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];o.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=s.get(f.id);if(p)switch(e.code){case Me.Down:n.top<p.top&&c.push(f);break;case Me.Up:n.top>p.top&&c.push(f);break;case Me.Left:n.left>p.left&&c.push(f);break;case Me.Right:n.left<p.left&&c.push(f);break}});const d=KH({collisionRect:n,droppableRects:s,droppableContainers:c});let u=rT(d,"id");if(u===(a==null?void 0:a.id)&&d.length>1&&(u=d[1].id),u!=null){const f=o.get(r.id),p=o.get(u),h=p?s.get(p.id):null,g=p==null?void 0:p.node.current;if(g&&h&&f&&p){const _=Tu(g).some((T,C)=>l[C]!==T),v=kT(f,p),y=fV(f,p),b=_||!v?{x:0,y:0}:{x:y?n.width-h.width:0,y:y?n.height-h.height:0},j={x:h.left,y:h.top};return b.x&&b.y?j:pa(j,b)}}}};function kT(e,t){return!Mc(e)||!Mc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function fV(e,t){return!Mc(e)||!Mc(t)||!kT(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const pV={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},$r={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},cr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},NT={step_id:"new_step",produces:"",scope:"",inputs:[]},hV={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function mV({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:s,onNavigateToWorkflow:o}){const[a,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:g,error:x,saving:_,updateWorkflow:v}=Y3(e,p,{onSave:w=>{n==null||n(p,w)}}),y=m.useCallback(w=>{w==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(w)},[h]),b=m.useCallback(w=>{const A=w.target.value;d(A);try{const E=JSON.parse(A);f(null),v(E)}catch(E){f(E.message)}},[v]),j=m.useCallback((w,A)=>{if(!h)return;const E=[...h.steps];E[w]=A,v({...h,steps:E})},[h,v]),N=m.useCallback(w=>{if(!h)return;const A=h.steps.filter((E,O)=>O!==w);v({...h,steps:A})},[h,v]),T=m.useCallback(w=>{var E,O;if(!h)return;const A=w==="iteration"?{...hV,step_id:`new_iteration_${(((E=h.steps)==null?void 0:E.length)||0)+1}`}:{...NT,step_id:`new_step_${(((O=h.steps)==null?void 0:O.length)||0)+1}`};v({...h,steps:[...h.steps||[],A]})},[h,v]),C=m.useCallback((w,A)=>{if(!h)return;const E=Ou(h.steps,w,A);v({...h,steps:E})},[h,v]),S=m.useCallback(()=>{!s||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&s(t.workflow_id)},[s,t]);return t?i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[_&&i.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),x&&i.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:x}),s&&i.jsx("button",{onClick:S,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),i.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(w=>i.jsx("button",{onClick:()=>y(w.id),style:{...pV,color:a===w.id?"var(--text-primary)":"var(--text-muted)",borderBottom:a===w.id?"2px solid var(--action-primary)":"2px solid transparent"},children:w.label},w.id))}),g?i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):i.jsxs("div",{className:"flex-1 overflow-hidden",children:[a==="steps"&&i.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[i.jsx(xV,{steps:(h==null?void 0:h.steps)||[],documentTypes:r,onStepChange:j,onStepDelete:N,onReorder:C}),i.jsxs("div",{className:"flex gap-2 mt-3",children:[i.jsx("button",{onClick:()=>T("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),i.jsx("button",{onClick:()=>T("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),a==="json"&&i.jsxs("div",{className:"h-full flex flex-col p-4",children:[i.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&i.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),a==="metadata"&&i.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?i.jsx(bV,{workflow:h,onUpdateWorkflow:v,onNavigateToWorkflow:o}):i.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),i.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function xV({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const o=J3(Pc(Au,{activationConstraint:{distance:5}}),Pc(Ru,{coordinateGetter:ST})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?i.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):i.jsx(xT,{sensors:o,collisionDetection:nT,onDragEnd:l,children:i.jsx(_T,{items:a,strategy:vT,children:e.map((c,d)=>i.jsx(gV,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function gV({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=jT({id:e.step_id}),f={transform:Ao.Transform.toString(c),transition:d,opacity:u?.5:1};return i.jsx("div",{ref:l,style:f,children:i.jsx(CT,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...o,...a}})})}function CT({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s,dragHandleProps:o,depth:a=0}){var T,C,S;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(w,A)=>{const E={...l,[w]:A};c(E),n(t,E)},h=(w,A)=>{const E={...l.iterate_over,[w]:A},O={...l,iterate_over:E};c(O),n(t,O)},g=()=>{const w=[...l.inputs||[],{doc_type:"",scope:""}],A={...l,inputs:w};c(A),n(t,A)},x=(w,A,E)=>{const O=[...l.inputs||[]];O[w]={...O[w],[A]:E};const z={...l,inputs:O};c(z),n(t,z)},_=w=>{const A=(l.inputs||[]).filter((O,z)=>z!==w),E={...l,inputs:A};c(E),n(t,E)},v=m.useCallback((w,A)=>{const E=[...l.steps||[]];E[w]=A;const O={...l,steps:E};c(O),n(t,O)},[l,t,n]),y=m.useCallback(w=>{const A=(l.steps||[]).filter((O,z)=>z!==w),E={...l,steps:A};c(E),n(t,E)},[l,t,n]),b=m.useCallback(()=>{var E;const w=[...l.steps||[],{...NT,step_id:`nested_step_${(((E=l.steps)==null?void 0:E.length)||0)+1}`}],A={...l,steps:w};c(A),n(t,A)},[l,t,n]),j=m.useCallback((w,A)=>{const E=Ou(l.steps||[],w,A),O={...l,steps:E};c(O),n(t,O)},[l,t,n]),N={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:a*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return i.jsxs("div",{style:N,children:[i.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[o&&i.jsx("span",{...o,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:i.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[i.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),i.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),i.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),i.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),i.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),i.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),i.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),i.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),i.jsx("span",{style:{flex:1}}),i.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?i.jsx("path",{d:"M18 15l-6-6-6 6"}):i.jsx("path",{d:"M6 9l6 6 6-6"})})}),i.jsx("button",{onClick:()=>s(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&i.jsxs("div",{className:"p-3 space-y-2",children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Step ID"}),i.jsx("input",{type:"text",value:l.step_id||"",onChange:w=>p("step_id",w.target.value),style:$r})]}),f?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Doc Type"}),i.jsxs("select",{value:((T=l.iterate_over)==null?void 0:T.doc_type)||"",onChange:w=>h("doc_type",w.target.value),style:$r,children:[i.jsx("option",{value:"",children:"-- Select --"}),r.map(w=>i.jsx("option",{value:w.doc_type_id,children:w.doc_type_id},w.doc_type_id))]})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Collection Field"}),i.jsx("input",{type:"text",value:((C=l.iterate_over)==null?void 0:C.collection_field)||"",onChange:w=>h("collection_field",w.target.value),style:$r})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Entity Type"}),i.jsx("input",{type:"text",value:((S=l.iterate_over)==null?void 0:S.entity_type)||"",onChange:w=>h("entity_type",w.target.value),style:$r})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Scope"}),i.jsx("input",{type:"text",value:l.scope||"",onChange:w=>p("scope",w.target.value),style:$r})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{style:cr,children:"Nested Steps"}),i.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),i.jsx(vV,{steps:l.steps||[],documentTypes:r,onStepChange:v,onStepDelete:y,onReorder:j})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Produces"}),i.jsxs("select",{value:l.produces||"",onChange:w=>p("produces",w.target.value),style:$r,children:[i.jsx("option",{value:"",children:"-- Select document type --"}),r.map(w=>i.jsx("option",{value:w.doc_type_id,children:w.doc_type_id},w.doc_type_id))]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Scope"}),i.jsx("input",{type:"text",value:l.scope||"",onChange:w=>p("scope",w.target.value),placeholder:"project",style:$r})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Creates Entities"}),i.jsx("input",{type:"text",value:l.creates_entities||"",onChange:w=>p("creates_entities",w.target.value||void 0),placeholder:"e.g., epic",style:$r})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("label",{style:cr,children:"Inputs"}),i.jsx("button",{onClick:g,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?i.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):i.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((w,A)=>i.jsxs("div",{className:"flex gap-1 items-end",children:[i.jsxs("div",{style:{flex:1},children:[A===0&&i.jsx("label",{style:{...cr,fontSize:9},children:"Doc/Entity Type"}),i.jsxs("select",{value:w.doc_type||w.entity_type||"",onChange:E=>{const O=E.target.value;w.entity_type!==void 0?x(A,"entity_type",O):x(A,"doc_type",O)},style:{...$r,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select --"}),r.map(E=>i.jsx("option",{value:E.doc_type_id,children:E.doc_type_id},E.doc_type_id))]})]}),i.jsxs("div",{style:{width:"30%"},children:[A===0&&i.jsx("label",{style:{...cr,fontSize:9},children:"Scope"}),i.jsx("input",{type:"text",value:w.scope||"",onChange:E=>x(A,"scope",E.target.value),placeholder:"scope",style:{...$r,fontSize:11}})]}),i.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[i.jsx("input",{type:"checkbox",checked:w.context||!1,onChange:E=>x(A,"context",E.target.checked||void 0)}),"ctx"]}),i.jsx("button",{onClick:()=>_(A),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},A))})]})]})]})]})}function vV({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const o=J3(Pc(Au,{activationConstraint:{distance:5}}),Pc(Ru,{coordinateGetter:ST})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?i.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):i.jsx(xT,{sensors:o,collisionDetection:nT,onDragEnd:l,children:i.jsx(_T,{items:a,strategy:vT,children:e.map((c,d)=>i.jsx(yV,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function yV({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=jT({id:e.step_id}),f={transform:Ao.Transform.toString(c),transition:d,opacity:u?.5:1};return i.jsx("div",{ref:l,style:f,children:i.jsx(CT,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...o,...a},depth:1})})}function bV({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,s]=m.useState(""),o={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},a={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,g=e.source_version,x=e.tags||[],_=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||x.includes(b)||(t==null||t({...e,tags:[...x,b]}),s(""))},v=b=>{t==null||t({...e,tags:x.filter(j=>j!==b)})},y=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return i.jsxs("div",{className:"space-y-4 max-w-lg",children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),i.jsxs("div",{children:[i.jsx("label",{style:a,children:"POW Class"}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&i.jsxs("div",{children:[i.jsx("label",{style:a,children:"Derived From"}),i.jsx("div",{style:o,children:r?i.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):i.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),g&&i.jsxs("div",{children:[i.jsx("label",{style:a,children:"Source Version"}),i.jsx("div",{style:o,children:g})]}),i.jsxs("div",{children:[i.jsx("label",{style:a,children:"Tags"}),i.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[x.length===0&&i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),x.map(b=>i.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&i.jsx("button",{onClick:()=>v(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{type:"text",value:n,onChange:b=>s(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),_())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),i.jsx("button",{onClick:_,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>i.jsxs("div",{children:[i.jsx("label",{style:a,children:b.label}),i.jsx("div",{style:o,children:e[b.key]||"-"})]},b.key)),d.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,j])=>i.jsxs("div",{children:[i.jsx("label",{style:a,children:b}),i.jsxs("div",{style:o,children:["parent: ",j.parent||"none"]})]},b))]}),f.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,j])=>i.jsxs("div",{children:[i.jsx("label",{style:a,children:b}),i.jsxs("div",{style:o,children:[j.name,j.scope&&` (${j.scope})`,j.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function VS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(s=>s.status==="fail"),n=e.filter(s=>s.status==="pass");return t?i.jsx("div",{className:"flex items-center gap-2",children:r.length>0?i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):i.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):i.jsxs("div",{className:"space-y-2",children:[r.map((s,o)=>i.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[i.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[i.jsx("span",{className:"text-red-400",children:"FAIL"}),i.jsx("span",{className:"font-mono",children:s.rule_id})]}),s.message&&i.jsx("div",{className:"mt-1 opacity-80",children:s.message}),s.artifact_id&&i.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:s.artifact_id})]},o)),n.length>0&&r.length>0&&i.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function _V(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),s=[];let o=0,a=0;for(;o<r.length||a<n.length;)if(o>=r.length)s.push({type:"added",line:n[a],lineNum:a+1}),a++;else if(a>=n.length)s.push({type:"removed",line:r[o],lineNum:o+1}),o++;else if(r[o]===n[a])s.push({type:"same",line:r[o],oldLineNum:o+1,newLineNum:a+1}),o++,a++;else{let l=n.slice(a,a+5).indexOf(r[o]),c=r.slice(o,o+5).indexOf(n[a]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)s.push({type:"added",line:n[a+d],lineNum:a+d+1});a+=l}else if(c!==-1){for(let d=0;d<c;d++)s.push({type:"removed",line:r[o+d],lineNum:o+d+1});o+=c}else s.push({type:"removed",line:r[o],lineNum:o+1}),s.push({type:"added",line:n[a],lineNum:a+1}),o++,a++}return s}function wV({diff:e}){const[t,r]=m.useState(!0),n=_V(e.old_content,e.new_content),s={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return i.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:s[e.status]||s.M,children:e.status}),i.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),i.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&i.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:i.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((o,a)=>i.jsxs("div",{className:"flex",style:{background:o.type==="added"?"rgba(34, 197, 94, 0.1)":o.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:o.type==="added"?"3px solid #22c55e":o.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[i.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:o.type==="same"?o.oldLineNum:o.lineNum||""}),i.jsx("span",{className:"select-none px-1",style:{color:o.type==="added"?"#22c55e":o.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:o.type==="added"?"+":o.type==="removed"?"-":" "}),i.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:o.line})]},a))})})]})}function jV({workspaceId:e,artifactId:t=null,onClose:r}){const[n,s]=m.useState([]),[o,a]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(a(!0),c(null),we.getDiff(e,t).then(u=>{s(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{a(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(r==null||r())};return i.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(r==null?void 0:r()),onKeyDown:d,tabIndex:0,children:i.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),i.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o?i.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?i.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?i.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((u,f)=>i.jsx(wV,{diff:u},u.artifact_id||f))}),i.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function SV(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,s,o]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:s,kind:o,displayName:a,kindLabel:l,display:`${a} - ${l}`}}function kV(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=SV(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function NV({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:s=[],modifiedFiles:o=[]}){const[a,l]=m.useState(""),[c,d]=m.useState(!1),u=kV(s),f=s.length,p=g=>{g.preventDefault(),a.trim()&&!n&&t(a.trim())},h=g=>{g.key==="Escape"&&!n&&r()};return i.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:g=>g.target===g.currentTarget&&!n&&r(),onKeyDown:h,children:[i.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&i.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),i.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(g=>i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:g.label}),i.jsx("div",{className:"space-y-1",children:g.items.map((x,_)=>i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),i.jsx("span",{style:{color:"var(--text-primary)"},children:x.displayName}),i.jsx("span",{style:{color:"var(--text-muted)"},children:x.kindLabel}),i.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",x.version]})]},_))})]},g.scope))}),i.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),i.jsxs("form",{onSubmit:p,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),i.jsx("textarea",{value:a,onChange:g=>l(g.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:!a.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:a.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:a.trim()&&!n?"#000":"var(--text-muted)",cursor:a.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&i.jsx(jV,{workspaceId:e,onClose:()=>d(!1)})]})}function CV(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,s,o]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:a,kind:o,kindLabel:l,version:s,display:`${a} - ${l}`}}function EV({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:s,onClose:o,onRefresh:a}){var w,A;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,g]=m.useState(null),x=(t==null?void 0:t.is_dirty)??!1,_=(t==null?void 0:t.modified_artifacts)??[],v=((w=t==null?void 0:t.tier1)==null?void 0:w.passed)??!0,y=((A=t==null?void 0:t.tier1)==null?void 0:A.results)??[],b=(t==null?void 0:t.branch)??"",j=t!=null&&t.expires_at?new Date(t.expires_at):null,N=async E=>{u(!0),g(null);try{const O=await we.commit(e,E);c(!1),n==null||n(O),a==null||a()}catch(O){g(O.message)}finally{u(!1)}},T=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await we.discard(e),s==null||s(),a==null||a()}catch(E){console.error("Discard failed:",E),alert("Failed to discard changes: "+E.message)}finally{p(!1)}}},C=async()=>{if(x){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await we.closeWorkspace(e),o==null||o()}catch(E){console.error("Close failed:",E),alert("Failed to close workspace: "+E.message)}},S=E=>{if(!E)return null;const z=E-new Date;if(z<=0)return"Expired";const k=Math.floor(z/(1e3*60*60)),P=Math.floor(z%(1e3*60*60)/(1e3*60));return k>0?`${k}h ${P}m remaining`:`${P}m remaining`};return i.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:i.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?i.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),i.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),j&&i.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:S(j)})]}),i.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),i.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:x?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:x?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:x?"Modified":"Clean"})]}),_.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",_.length,")"]}),i.jsx("div",{className:"space-y-1",children:_.map(E=>{const O=CV(E);return i.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:E,children:[i.jsx("span",{style:{color:"var(--text-primary)"},children:O.displayName||E}),O.kindLabel&&i.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",O.kindLabel]})]},E)})})]})]}),i.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),i.jsx(VS,{results:y,compact:!0})]}),y.length>0&&!v&&i.jsx("div",{className:"mt-3",children:i.jsx(VS,{results:y})})]})]}),i.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[i.jsx("button",{onClick:()=>c(!0),disabled:!x||!v||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:x&&v?"var(--action-success)":"var(--border-panel)",color:x&&v?"#000":"var(--text-muted)",cursor:x&&v&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!v&&x&&i.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),x&&i.jsx("button",{onClick:T,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!x&&i.jsx("button",{onClick:C,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&i.jsx(NV,{workspaceId:e,onCommit:N,onCancel:()=>{c(!1),g(null)},loading:d,modifiedArtifacts:_,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&i.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function TV(){const{isAdmin:e,loading:t}=Ms(),[r,n]=m.useState(null),[s,o]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[g,x]=m.useState(null),[_,v]=m.useState(null),[y,b]=m.useState(null),[j,N]=m.useState(null),[T,C]=m.useState(!1),{workspaceId:S,loading:w,error:A,reinitialize:E}=fB(),{state:O,loading:z,refresh:k}=pB(S),{documentTypes:P,loading:R,refresh:D}=hB(),{roles:L,loading:I,refresh:M}=mB(),{templates:F,loading:q,refresh:H}=U3(),{workflows:V,loading:Z,refresh:B}=tH(),{fragments:re,loading:oe,kindOptions:X,refresh:Q}=G3(),{schemas:fe,loading:xe,refresh:be}=V3(),[ye,ae]=m.useState([]),[K,te]=m.useState([]),[ee,ke]=m.useState(!1),[je,Te]=m.useState(null),Ne=m.useCallback(async()=>{ke(!0);try{const[ue,de]=await Promise.all([we.getMechanicalOpTypes(),we.getMechanicalOps()]);ae(ue.types||[]),te(de.operations||[])}catch(ue){console.error("Failed to load mechanical ops:",ue)}finally{ke(!1)}},[]);m.useEffect(()=>{Ne()},[Ne]);const ne=m.useCallback(async(ue,de=null,Ye="docworkflow")=>{if(n(ue),d(null),f(null),h(null),o(null),x(null),v(null),Te(null),b(de),N(Ye),!!ue){l(!0);try{const wr=await we.getDocumentType(ue.doc_type_id);o(wr)}catch(wr){console.error("Failed to load doc type details:",wr),o(ue)}finally{l(!1)}}},[]),Se=m.useCallback(ue=>{ne(ue,"task_prompt","task")},[ne]),Ve=m.useCallback(ue=>{ne(ue,"schema","schema")},[ne]),ct=m.useCallback(ue=>{d(ue),n(null),o(null),f(null),h(null),x(null),v(null),Te(null)},[]),We=m.useCallback(ue=>{f(ue),n(null),o(null),d(null),h(null),x(null),v(null),Te(null)},[]),Pe=m.useCallback(ue=>{h(ue),n(null),o(null),d(null),f(null),x(null),v(null),Te(null)},[]),ie=m.useCallback(ue=>{x(ue),n(null),o(null),d(null),f(null),h(null),v(null),Te(null)},[]),ge=m.useCallback(ue=>{v(ue),n(null),o(null),d(null),f(null),h(null),x(null),Te(null)},[]),pe=m.useCallback(ue=>{Te(ue),n(null),o(null),d(null),f(null),h(null),x(null),v(null)},[]),U=m.useCallback(ue=>{const de=V.find(Ye=>Ye.workflow_id===ue);de&&Pe(de)},[V,Pe]),ve=m.useCallback((ue,de)=>{k()},[k]),he=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),Fe=m.useCallback(()=>{n(null),o(null),d(null),f(null),h(null),x(null),v(null),Te(null)},[]),He=m.useCallback(async ue=>{if(S)try{const de=await we.createOrchestrationWorkflow(S,ue);await B(),k(),h({workflow_id:de.workflow_id,active_version:de.version,name:ue.name||de.workflow_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())}),n(null),o(null),d(null),f(null)}catch(de){console.error("Failed to create workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[S,B,k]),st=m.useCallback(async ue=>{if(S)try{await we.deleteOrchestrationWorkflow(S,ue),await B(),k(),h(null)}catch(de){console.error("Failed to delete workflow:",de),alert(`Failed to delete workflow: ${de.message}`)}},[S,B,k]),Ge=m.useCallback(async ue=>{if(S)try{const de=await we.createDocumentType(S,ue);await D(),k(),ne({doc_type_id:de.doc_type_id,display_name:ue.display_name||de.doc_type_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase()),active_version:de.version})}catch(de){console.error("Failed to create document type:",de),alert(`Failed to create document type: ${de.message}`)}},[S,D,k,ne]);m.useCallback(async ue=>{if(S)try{await we.deleteDocumentType(S,ue),await D(),k(),n(null),o(null)}catch(de){console.error("Failed to delete document type:",de),alert(`Failed to delete document type: ${de.message}`)}},[S,D,k]);const $=m.useCallback(async ue=>{if(S)try{await we.createDcwWorkflow(S,{doc_type_id:ue}),await B(),k()}catch(de){console.error("Failed to create DCW workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[S,B,k]),W=m.useCallback(async ue=>{if(S)try{const de=await we.createRolePrompt(S,ue);await Q(),await M(),k(),ie({fragment_id:`role:${de.role_id}`,kind:"role",version:de.version,name:ue.name||de.role_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create role prompt:",de),alert(`Failed to create role prompt: ${de.message}`)}},[S,Q,M,k,ie]),G=m.useCallback(async ue=>{if(S)try{const de=await we.createTemplate(S,ue);await H(),k(),We({template_id:de.template_id,active_version:de.version,name:ue.name||de.template_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create template:",de),alert(`Failed to create template: ${de.message}`)}},[S,H,k,We]),se=m.useCallback(async ue=>{if(S)try{const de=await we.createStandaloneSchema(S,ue);await be(),k(),ge({schema_id:de.schema_id,active_version:de.version,title:ue.title||de.schema_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create schema:",de),alert(`Failed to create schema: ${de.message}`)}},[S,be,k,ge]),$e=m.useCallback(()=>{E(),n(null),o(null),d(null),f(null),h(null),x(null),v(null),Te(null)},[E]),pt=m.useCallback(async()=>{try{await we.invalidateCache(),await Promise.all([D(),M(),H(),B(),Q(),be(),Ne(),k()])}catch(ue){console.error("Failed to reload config:",ue),alert(`Failed to reload config: ${ue.message}`)}},[D,M,H,B,Q,be,Ne,k]);if(t)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),i.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(w)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),i.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(A)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),i.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:A}),i.jsx("button",{onClick:E,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const lr=c&&!r&&!u&&!p&&!g&&!_&&!je,Tt=u&&!r&&!c&&!p&&!g&&!_&&!je,jt=p&&!r&&!c&&!u&&!g&&!_&&!je,Bt=g&&!r&&!c&&!u&&!p&&!_&&!je,Lr=_&&!r&&!c&&!u&&!p&&!g&&!je,at=je&&!r&&!c&&!u&&!p&&!g&&!_;return i.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{window.location.href="/"},title:"Return to Home"}),i.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:pt,className:"flex items-center gap-1 px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{background:"var(--bg-panel)",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:11},title:"Reload config from disk (invalidate cache)",children:[i.jsx("span",{style:{fontSize:12},children:""}),i.jsx("span",{children:"Reload"})]}),i.jsxs("button",{onClick:()=>C(!T),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:T?"var(--action-primary)":"var(--bg-panel)",color:T?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[i.jsx("span",{style:{fontSize:14},children:""}),i.jsx("span",{children:"Building Blocks"})]})]})]}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx(rH,{documentTypes:P,roles:L,templates:F,workflows:V,promptFragments:re,promptFragmentKindOptions:X,schemas:fe,loading:R,rolesLoading:I,templatesLoading:q,workflowsLoading:Z,promptFragmentsLoading:oe,schemasLoading:xe,selectedDocType:r,docTypeSource:j,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:g,selectedSchema:_,onSelectDocType:ne,onSelectRole:ct,onSelectTemplate:We,onSelectWorkflow:Pe,onSelectFragment:ie,onSelectStandaloneSchema:ge,onCreateWorkflow:He,onCreateDocType:Ge,onCreateFragment:W,onCreateTemplate:G,onCreateSchema:se,onSelectTask:Se,onSelectSchema:Ve,workspaceState:O}),lr?i.jsx(kH,{workspaceId:S,role:c,onArtifactSave:ve}):Tt?i.jsx(CH,{workspaceId:S,template:u,onArtifactSave:ve}):Bt?i.jsx(AH,{workspaceId:S,fragment:g,onArtifactSave:ve}):jt?i.jsx(mV,{workspaceId:S,workflow:p,documentTypes:P,onArtifactSave:ve,onDelete:st,onNavigateToWorkflow:U}):Lr?i.jsx(EH,{workspaceId:S,schema:_,onArtifactSave:ve}):at?i.jsx(IH,{mechanicalOp:je,mechanicalOpTypes:ye}):i.jsx(SH,{workspaceId:S,docType:s,loading:a,roles:L,workflows:V,onArtifactSave:ve,onCreateDcwWorkflow:$,initialTab:y,docTypeSource:j,mechanicalOpTypes:ye,mechanicalOps:K}),i.jsx(EV,{workspaceId:S,state:O,loading:z,onCommit:he,onDiscard:Fe,onClose:$e,onRefresh:k})]}),i.jsx(sH,{isOpen:T,onClose:()=>C(!1),promptFragments:re,promptFragmentKindOptions:X,templates:F,schemas:fe,documentTypes:P,promptFragmentsLoading:oe,templatesLoading:q,schemasLoading:xe,selectedFragment:g,selectedTemplate:u,selectedSchema:_,selectedMechanicalOp:je,onSelectFragment:ie,onSelectTemplate:We,onSelectSchema:Ve,onSelectStandaloneSchema:ge,onCreateFragment:W,onCreateTemplate:G,onCreateSchema:se,mechanicalOpTypes:ye,mechanicalOps:K,mechanicalOpsLoading:ee,onSelectMechanicalOp:pe})]})}function RV({onSelectExecution:e}){const[t,r]=m.useState([]),[n,s]=m.useState([]),[o,a]=m.useState({}),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState("all"),[h,g]=m.useState("all"),[x,_]=m.useState("all"),[v,y]=m.useState(""),[b,j]=m.useState("startedAt"),[N,T]=m.useState("desc");m.useEffect(()=>{C()},[]);async function C(){var R;c(!0),u(null);try{const[D,L,I]=await Promise.allSettled([ze.getExecutions(),ze.getDocumentWorkflowExecutions(),ze.getProjects()]);if(D.status==="fulfilled"&&r(D.value.executions||[]),L.status==="fulfilled"&&s(L.value||[]),I.status==="fulfilled"){const M=((R=I.value)==null?void 0:R.projects)||I.value||[],F={};for(const q of Array.isArray(M)?M:[]){const H=q.project_id||q.projectId;q.id&&H&&(F[q.id]=H)}a(F)}}catch(D){u(D.message)}finally{c(!1)}}const S=m.useMemo(()=>[...t.map(R=>({id:R.execution_id,type:"workflow",workflowId:R.workflow_id,projectId:R.project_id,projectCode:o[R.project_id]||"--",documentType:R.document_type||R.workflow_id||"--",status:R.status,startedAt:R.started_at,label:R.workflow_id})),...n.map(R=>({id:R.execution_id,type:"document",workflowId:R.workflow_id,projectId:R.project_id,projectCode:o[R.project_id]||"--",documentType:R.document_type||R.workflow_id||"--",status:R.status,startedAt:R.created_at||R.updated_at,label:R.document_type||R.workflow_id}))],[t,n,o]),w=m.useMemo(()=>[...new Set(S.map(R=>R.documentType).filter(Boolean).filter(R=>R!=="--"))].sort(),[S]),A=m.useMemo(()=>[...new Set(S.map(R=>{var D;return(D=R.status)==null?void 0:D.toLowerCase()}).filter(Boolean))],[S]),E=m.useMemo(()=>{const R=v.toLowerCase().trim();return S.filter(D=>{var L,I,M;if(f!=="all"&&((L=D.status)==null?void 0:L.toLowerCase())!==f||h!=="all"&&D.type!==h||x!=="all"&&D.documentType!==x)return!1;if(R){const F=(I=D.id)==null?void 0:I.toLowerCase().includes(R),q=(M=D.projectCode)==null?void 0:M.toLowerCase().includes(R);if(!F&&!q)return!1}return!0})},[S,f,h,x,v]),O=m.useMemo(()=>{const R=[...E];return R.sort((D,L)=>{let I=D[b],M=L[b];if(I==null&&M==null)return 0;if(I==null)return 1;if(M==null)return-1;if(b==="startedAt"&&(I=new Date(I).getTime(),M=new Date(M).getTime()),typeof I=="string"&&typeof M=="string"){const q=I.localeCompare(M);return N==="asc"?q:-q}const F=I<M?-1:I>M?1:0;return N==="asc"?F:-F}),R},[E,b,N]);function z(R){b===R?T(D=>D==="asc"?"desc":"asc"):(j(R),T("asc"))}function k({columnKey:R}){return b!==R?null:i.jsx("span",{className:"ml-1",children:N==="asc"?"":""})}if(l)return i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading executions..."})});const P=[{key:"id",label:"Execution ID",minWidth:"200px"},{key:"projectCode",label:"Project"},{key:"type",label:"Source"},{key:"documentType",label:"Document Type"},{key:"status",label:"Status"},{key:"startedAt",label:"Started"}];return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("div",{className:"flex items-center gap-4 p-4 border-b flex-shrink-0 flex-wrap",style:{borderColor:"var(--border-panel)"},children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("input",{type:"text",value:v,onChange:R=>y(R.target.value),placeholder:"Search by ID or project...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)",width:"200px"}})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status:"}),i.jsxs("select",{value:f,onChange:R=>p(R.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"all",children:"All"}),A.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Source:"}),i.jsxs("select",{value:h,onChange:R=>g(R.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"all",children:"All"}),i.jsx("option",{value:"workflow",children:"Workflows"}),i.jsx("option",{value:"document",children:"Documents"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Type:"}),i.jsxs("select",{value:x,onChange:R=>_(R.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"all",children:"All"}),w.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsx("button",{onClick:C,className:"text-xs px-3 py-1 rounded hover:opacity-80 transition-opacity ml-auto",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Refresh"}),i.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[O.length," execution",O.length!==1?"s":""]})]}),d&&i.jsx("div",{className:"p-3 m-4 rounded text-sm",style:{background:"var(--bg-error, #fecaca)",color:"#991b1b"},children:d}),i.jsx("div",{className:"flex-1 overflow-auto",children:i.jsxs("table",{className:"w-full text-sm",style:{color:"var(--text-primary)"},children:[i.jsx("thead",{children:i.jsx("tr",{className:"border-b",style:{borderColor:"var(--border-panel)"},children:P.map(R=>i.jsxs("th",{onClick:()=>z(R.key),className:"text-left p-3 font-medium text-xs cursor-pointer hover:opacity-80 select-none",style:{color:"var(--text-muted)",minWidth:R.minWidth||void 0},children:[R.label,i.jsx(k,{columnKey:R.key})]},R.key))})}),i.jsxs("tbody",{children:[O.map(R=>i.jsxs("tr",{onClick:()=>e(R.id),className:"border-b cursor-pointer hover:bg-white/5 transition-colors",style:{borderColor:"var(--border-panel)"},children:[i.jsx("td",{className:"p-3 font-mono text-xs",style:{minWidth:"200px"},children:R.id}),i.jsx("td",{className:"p-3 font-mono text-xs",children:R.projectCode}),i.jsx("td",{className:"p-3",children:i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:R.type==="workflow"?"var(--accent-primary, #3b82f6)":"var(--accent-secondary, #8b5cf6)",color:"white",opacity:.8},children:R.type})}),i.jsx("td",{className:"p-3 text-xs",children:R.documentType}),i.jsx("td",{className:"p-3",children:i.jsx(AV,{status:R.status})}),i.jsx("td",{className:"p-3 text-xs",style:{color:"var(--text-muted)"},children:R.startedAt?IV(R.startedAt):"-"})]},R.id)),O.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:P.length,className:"p-8 text-center",style:{color:"var(--text-muted)"},children:"No executions found."})})]})]})})]})}function AV({status:e}){const t=(e||"").toLowerCase();let r="var(--text-muted)";return t.includes("complete")||t==="done"?r="var(--state-complete, #10b981)":t.includes("running")||t.includes("active")||t.includes("progress")?r="var(--state-active, #f59e0b)":t.includes("fail")||t.includes("error")?r="var(--state-error, #ef4444)":t.includes("wait")||t.includes("pending")?r="var(--state-pending, #6b7280)":t.includes("cancel")&&(r="var(--text-muted)"),i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:r,color:"white"},children:e||"unknown"})}function IV(e){try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric"})+" "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return e}}function PV({executionId:e,onBack:t}){const[r,n]=m.useState(null),[s,o]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState("overview");m.useEffect(()=>{p()},[e]);async function p(){d(!0);try{const[g,x,_,v]=await Promise.allSettled([ze.getExecution(e),ze.getDocumentWorkflowExecution(e),ze.getExecutionTranscript(e),ze.getExecutionQACoverage(e)]);if(x.status==="fulfilled"&&x.value){const y=x.value;n({execution_id:y.execution_id,workflow_id:y.workflow_id,project_id:y.project_id,status:y.status,current_step_id:y.current_node_id,document_type:y.document_type,started_at:y.created_at,completed_at:y.updated_at,produced_documents:y.produced_documents})}else g.status==="fulfilled"&&g.value&&n(g.value);_.status==="fulfilled"&&o(_.value),v.status==="fulfilled"&&l(v.value)}catch(g){console.error("Failed to load execution detail:",g)}finally{d(!1)}}if(c)return i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading execution..."})});const h=[{id:"overview",label:"Overview"},{id:"transcript",label:`Transcript${s?` (${s.total_runs||0})`:""}`},{id:"qa",label:"QA Coverage"}];return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("div",{className:"flex items-center gap-3 p-4 border-b flex-shrink-0",style:{borderColor:"var(--border-panel)"},children:[i.jsx("button",{onClick:t,className:"text-xs px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Back"}),i.jsx("span",{className:"font-mono text-sm",style:{color:"var(--text-primary)"},children:e}),(r==null?void 0:r.status)&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:ET(r.status),color:"white"},children:r.status})]}),i.jsx("div",{className:"flex border-b px-4 flex-shrink-0",style:{borderColor:"var(--border-panel)"},children:h.map(g=>i.jsxs("button",{onClick:()=>f(g.id),className:"px-3 py-2 text-xs transition-colors relative",style:{color:u===g.id?"var(--text-primary)":"var(--text-muted)",fontWeight:u===g.id?600:400},children:[g.label,u===g.id&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-primary)"}})]},g.id))}),i.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[u==="overview"&&i.jsx(OV,{execution:r,transcript:s}),u==="transcript"&&i.jsx(MV,{transcript:s}),u==="qa"&&i.jsx(DV,{qaCoverage:a})]})]})}function OV({execution:e,transcript:t}){var r;return e?i.jsxs("div",{className:"space-y-4 max-w-2xl",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(Dt,{label:"Execution ID",value:e.execution_id,mono:!0}),i.jsx(Dt,{label:"Workflow",value:e.workflow_id}),i.jsx(Dt,{label:"Project",value:e.project_id}),i.jsx(Dt,{label:"Status",value:e.status}),i.jsx(Dt,{label:"Started",value:KS(e.started_at)}),i.jsx(Dt,{label:"Completed",value:KS(e.completed_at)}),i.jsx(Dt,{label:"Current Step",value:e.current_step_id||"-"}),i.jsx(Dt,{label:"Completed Steps",value:((r=e.completed_steps)==null?void 0:r.length)||0})]}),t&&i.jsxs("div",{className:"mt-6 p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("h3",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:"Cost Summary"}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsx(Dt,{label:"Total Runs",value:t.total_runs||0}),i.jsx(Dt,{label:"Total Tokens",value:(t.total_tokens||0).toLocaleString()}),i.jsx(Dt,{label:"Total Cost",value:`$${(t.total_cost||0).toFixed(4)}`})]})]})]}):i.jsx("p",{style:{color:"var(--text-muted)"},children:"No execution data available."})}function MV({transcript:e}){var s;const[t,r]=m.useState({});if(!e||!((s=e.transcript)!=null&&s.length))return i.jsx("p",{style:{color:"var(--text-muted)"},children:"No transcript data available."});const n=o=>{r(a=>({...a,[o]:!a[o]}))};return i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"flex items-center gap-4 mb-4",children:i.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[e.total_runs," run",e.total_runs!==1?"s":""," |"," ",(e.total_tokens||0).toLocaleString()," tokens |"," ","$",(e.total_cost||0).toFixed(4)]})}),e.transcript.map((o,a)=>{var l,c,d,u,f;return i.jsxs("div",{className:"rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("button",{onClick:()=>n(a),className:"w-full text-left p-3 hover:opacity-80 transition-opacity",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{style:{color:"var(--text-muted)",fontSize:"10px"},children:t[a]?"":""}),i.jsxs("span",{className:"font-mono font-medium",style:{color:"var(--text-primary)"},children:["#",o.run_number]}),i.jsx("span",{style:{color:"var(--text-muted)"},children:o.role}),o.node_id&&i.jsx("span",{className:"font-mono",style:{color:"var(--text-muted)"},children:o.node_id}),o.task_ref&&i.jsx("span",{className:"font-mono",style:{color:"var(--text-muted)",opacity:.7},children:o.task_ref}),i.jsx("span",{className:"ml-auto",style:{color:"var(--text-muted)"},children:o.model})]}),i.jsxs("div",{className:"flex items-center gap-4",style:{color:"var(--text-muted)"},children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:ET(o.status),color:"white"},children:o.status}),o.duration&&i.jsx("span",{children:o.duration}),i.jsxs("span",{children:[(typeof o.tokens=="number"?o.tokens:((l=o.tokens)==null?void 0:l.total)||0).toLocaleString()," tokens"]}),i.jsxs("span",{children:["$",(o.cost||0).toFixed(4)]})]})]}),t[a]&&i.jsxs("div",{className:"border-t px-3 pb-3",style:{borderColor:"var(--border-panel)"},children:[((c=o.inputs)==null?void 0:c.length)>0&&i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:["Inputs (",o.inputs.length,")"]}),o.inputs.map((p,h)=>i.jsx(GS,{label:p.kind,content:p.content,size:p.size},h))]}),((d=o.outputs)==null?void 0:d.length)>0&&i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:["Outputs (",o.outputs.length,")"]}),o.outputs.map((p,h)=>i.jsx(GS,{label:p.kind,content:p.content,size:p.size,parseStatus:p.parse_status,validationStatus:p.validation_status},h))]}),!((u=o.inputs)!=null&&u.length)&&!((f=o.outputs)!=null&&f.length)&&i.jsx("p",{className:"mt-3",style:{color:"var(--text-muted)"},children:"No input/output content recorded."})]})]},a)})]})}function GS({label:e,content:t,size:r,parseStatus:n,validationStatus:s}){const[o,a]=m.useState(!1),l=t&&t.length>0,c=l&&t.length>500;return i.jsxs("div",{className:"mb-2 rounded",style:{border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5",style:{background:"var(--bg-canvas)"},children:[i.jsx("span",{className:"font-mono font-medium text-xs",style:{color:"var(--accent-primary)"},children:e||"content"}),r>0&&i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:r>1024?`${(r/1024).toFixed(1)} KB`:`${r} B`}),n&&i.jsx("span",{className:"text-xs px-1 rounded",style:{background:n==="ok"?"var(--state-complete, #10b981)":"var(--state-error, #ef4444)",color:"white"},children:n}),s&&i.jsx("span",{className:"text-xs px-1 rounded",style:{background:s==="valid"?"var(--state-complete, #10b981)":"var(--state-error, #ef4444)",color:"white"},children:s}),c&&i.jsx("button",{onClick:()=>a(!o),className:"ml-auto text-xs hover:opacity-80",style:{color:"var(--accent-primary)"},children:o?"Collapse":"Expand"})]}),l&&i.jsx("pre",{className:"p-2 text-xs overflow-x-auto",style:{color:"var(--text-primary)",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:o?"none":"200px",overflow:o?"visible":"hidden",borderTop:"1px solid var(--border-panel)"},children:t}),!l&&i.jsx("p",{className:"px-2 py-1 text-xs",style:{color:"var(--text-muted)"},children:"(empty)"})]})}function DV({qaCoverage:e}){if(!e)return i.jsx("p",{style:{color:"var(--text-muted)"},children:"No QA coverage data available."});const t=e.summary||{},r=e.qa_nodes||[];return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[i.jsx(Dt,{label:"Passed",value:t.passed||0}),i.jsx(Dt,{label:"Failed",value:t.failed||0}),i.jsx(Dt,{label:"Errors",value:t.errors||0}),i.jsx(Dt,{label:"Warnings",value:t.warnings||0})]}),r.length>0&&i.jsxs("div",{className:"space-y-2 mt-4",children:[i.jsx("h3",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"QA Nodes"}),r.map((n,s)=>{var o;return i.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"font-mono font-medium mb-1",style:{color:"var(--text-primary)"},children:n.node_id||`Node ${s+1}`}),((o=n.findings)==null?void 0:o.length)>0&&i.jsx("ul",{className:"list-disc list-inside",style:{color:"var(--text-muted)"},children:n.findings.map((a,l)=>i.jsx("li",{children:typeof a=="string"?a:JSON.stringify(a)},l))})]},s)})]})]})}function Dt({label:e,value:t,mono:r}){return i.jsxs("div",{children:[i.jsx("div",{className:"text-xs mb-0.5",style:{color:"var(--text-muted)"},children:e}),i.jsx("div",{className:`text-sm ${r?"font-mono":""}`,style:{color:"var(--text-primary)"},children:t||"-"})]})}function ET(e){const t=(e||"").toLowerCase();return t.includes("complete")||t==="done"||t==="success"?"var(--state-complete, #10b981)":t.includes("running")||t.includes("active")||t.includes("progress")?"var(--state-active, #f59e0b)":t.includes("fail")||t.includes("error")?"var(--state-error, #ef4444)":"var(--state-pending, #6b7280)"}function KS(e){if(!e)return"-";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})+" "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return e}}const LV="/api/v1";function zV(){const[e,t]=m.useState(null),[r,n]=m.useState(!0),[s,o]=m.useState(null),[a,l]=m.useState(7);m.useEffect(()=>{c()},[a]);async function c(){n(!0),o(null);try{const f=await fetch(`${LV}/telemetry/costs?days=${a}`,{credentials:"same-origin"});if(!f.ok)throw new Error(`HTTP ${f.status}`);const p=await f.json();t(p)}catch(f){o(f.message)}finally{n(!1)}}if(r)return i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading cost data..."})});if(s)return i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"p-3 rounded text-sm",style:{background:"#fecaca",color:"#991b1b"},children:["Failed to load cost data: ",s]})});const d=(e==null?void 0:e.summary)||{},u=(e==null?void 0:e.daily_data)||[];return i.jsxs("div",{className:"h-full overflow-auto p-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:"Period:"}),[7,14,30].map(f=>i.jsxs("button",{onClick:()=>l(f),className:"text-xs px-3 py-1.5 rounded transition-opacity",style:{background:a===f?"var(--accent-primary)":"transparent",color:a===f?"white":"var(--text-muted)",border:a===f?"none":"1px solid var(--border-panel)"},children:[f," days"]},f)),i.jsx("button",{onClick:c,className:"text-xs px-3 py-1 rounded hover:opacity-80 transition-opacity ml-auto",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Refresh"})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[i.jsx(yl,{label:"Total Cost",value:`$${(d.total_cost||0).toFixed(2)}`}),i.jsx(yl,{label:"Total Tokens",value:(d.total_tokens||0).toLocaleString()}),i.jsx(yl,{label:"Total Calls",value:d.total_calls||0}),i.jsx(yl,{label:"Avg Cost/Day",value:`$${(d.avg_cost_per_day||0).toFixed(2)}`})]}),i.jsx("div",{className:"rounded",style:{border:"1px solid var(--border-panel)"},children:i.jsxs("table",{className:"w-full text-sm",style:{color:"var(--text-primary)"},children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsx("th",{className:"text-left p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Date"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Cost"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Tokens"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Calls"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Errors"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Workflow"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Document"})]})}),i.jsxs("tbody",{children:[u.map((f,p)=>i.jsxs("tr",{className:"border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("td",{className:"p-3 text-xs",children:f.date_short||f.date}),i.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.cost||0).toFixed(4)]}),i.jsx("td",{className:"p-3 text-xs text-right font-mono",children:(f.tokens||0).toLocaleString()}),i.jsx("td",{className:"p-3 text-xs text-right",children:f.calls||0}),i.jsx("td",{className:"p-3 text-xs text-right",style:{color:f.errors>0?"var(--state-error, #ef4444)":"var(--text-muted)"},children:f.errors||0}),i.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.workflow_cost||0).toFixed(4)]}),i.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.document_cost||0).toFixed(4)]})]},p)),u.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-8 text-center",style:{color:"var(--text-muted)"},children:"No cost data for this period."})})]})]})})]})}function yl({label:e,value:t}){return i.jsxs("div",{className:"p-4 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:e}),i.jsx("div",{className:"text-lg font-medium font-mono",style:{color:"var(--text-primary)"},children:t})]})}function FV(){const{isAdmin:e,loading:t}=Ms(),[r,n]=m.useState("executions"),[s,o]=m.useState(null);if(m.useEffect(()=>{const c=new URLSearchParams(window.location.search).get("execution");if(c){o(c),n("executions");return}const d=window.location.pathname.match(/^\/admin\/executions\/(.+)$/);d&&(o(d[1]),n("executions"))},[]),t)return i.jsx("div",{className:"flex h-screen items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return i.jsx("div",{className:"flex h-screen items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[i.jsx("p",{style:{color:"var(--text-primary)"},children:"Admin access required."}),i.jsx("a",{href:"/",className:"text-sm mt-2 inline-block",style:{color:"var(--accent-primary)"},children:"Return to Production Floor"})]})});const a=[{id:"executions",label:"Executions"},{id:"costs",label:"Costs"}];return i.jsxs("div",{className:"flex flex-col h-screen",style:{background:"var(--bg-canvas)"},children:[i.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("a",{href:"/",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[i.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),i.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),i.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--accent-primary)",color:"white",opacity:.9},children:"ADMIN"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("a",{href:"/admin/workbench",className:"text-xs px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Workbench"}),i.jsx("a",{href:"/",className:"text-xs px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Production Floor"})]})]}),i.jsx("div",{className:"flex border-b px-4 flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:a.map(l=>i.jsxs("button",{onClick:()=>{n(l.id),l.id!=="executions"&&o(null)},className:"px-4 py-2 text-sm transition-colors relative",style:{color:r===l.id?"var(--text-primary)":"var(--text-muted)",fontWeight:r===l.id?600:400},children:[l.label,r===l.id&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-primary)"}})]},l.id))}),i.jsxs("div",{className:"flex-1 overflow-hidden",children:[r==="executions"&&(s?i.jsx(PV,{executionId:s,onBack:()=>o(null)}):i.jsx(RV,{onSelectExecution:o})),r==="costs"&&i.jsx(zV,{})]})]})}function $V({user:e,onClick:t}){return i.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?i.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[i.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function qV(){var E,O,z,k,P;const{user:e}=Ms(),[t,r]=m.useState(!1),{projects:n,loading:s,error:o,refresh:a}=lB({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,g]=m.useState(!1),{theme:x,setTheme:_}=t3(),v=Object.keys(n),y=l&&n[l]?l:v[0]||null;m.useEffect(()=>{if(y&&n[y]){const R=n[y];document.title=`${R.projectId} - The Combine`}else document.title="The Combine"},[y,n]);const b=R=>{c(R),u(null)},j=()=>{p(!0)},N=async R=>{await a(),R&&R.id&&(c(R.id),u("concierge_intake")),p(!1)},T=()=>{p(!1)},C=async(R,D)=>{try{await ze.updateProject(R,D),await a()}catch(L){throw console.error("Failed to update project:",L),L}},S=async R=>{try{if(await ze.archiveProject(R),!t){const D=Object.values(n).sort((M,F)=>{const q=(M.name||"").localeCompare(F.name||"");return q!==0?q:(M.projectId||"").localeCompare(F.projectId||"")}),L=D.findIndex(M=>M.id===R),I=D[L+1]||D[L-1]||null;c((I==null?void 0:I.id)||null)}await a()}catch(D){throw console.error("Failed to archive project:",D),D}},w=async R=>{try{await ze.unarchiveProject(R),await a()}catch(D){throw console.error("Failed to unarchive project:",D),D}},A=async R=>{try{await ze.deleteProject(R);const D=Object.values(n).sort((M,F)=>{const q=(M.name||"").localeCompare(F.name||"");return q!==0?q:(M.projectId||"").localeCompare(F.projectId||"")}),L=D.findIndex(M=>M.id===R),I=D[L+1]||D[L-1]||null;c((I==null?void 0:I.id)||null),await a()}catch(D){throw console.error("Failed to delete project:",D),D}};return s?i.jsx("div",{className:`flex h-screen items-center justify-center theme-${x}`,style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):o?i.jsx("div",{className:`flex h-screen items-center justify-center theme-${x}`,style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[i.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",o]}),i.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):i.jsxs("div",{className:`flex flex-col h-screen theme-${x}`,children:[i.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),i.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),i.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),i.jsx("path",{d:"M12 17h.01"})]})})]}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx(w8,{projects:n,selectedId:y,onSelectProject:b,onNewProject:j,showArchived:t,onToggleShowArchived:()=>r(R=>!R),userSection:i.jsx($V,{user:e,onClick:()=>g(!0)})}),i.jsx("div",{className:"flex-1",children:y?i.jsx(Mo,{children:i.jsx(vB,{projectId:y,projectCode:(E=n[y])==null?void 0:E.projectId,projectName:(O=n[y])==null?void 0:O.name,isArchived:(z=n[y])==null?void 0:z.isArchived,savedLayout:(P=(k=n[y])==null?void 0:k.metadata)==null?void 0:P.floor_layout,autoExpandNodeId:d,theme:x,onThemeChange:_,onProjectUpdate:C,onProjectArchive:S,onProjectUnarchive:w,onProjectDelete:A})},y):i.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:i.jsx("div",{className:"text-center",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&i.jsx(BW,{onClose:T,onComplete:N}),h&&i.jsx(WW,{onClose:()=>g(!1)})]})]})}function BV(){const{isAuthenticated:e,loading:t}=Ms(),{theme:r}=t3(),[n,s]=m.useState(window.location.pathname);return m.useEffect(()=>{const o=()=>s(window.location.pathname);return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),t?i.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?i.jsx("div",{className:`h-screen theme-${r}`,children:i.jsx(TV,{})}):n==="/admin"||n.startsWith("/admin/executions")?i.jsx("div",{className:`h-screen theme-${r}`,children:i.jsx(FV,{})}):i.jsx(qV,{}):n==="/learn"?i.jsx(eH,{}):i.jsx(XW,{})}function WV(){return i.jsx(dB,{children:i.jsx(BV,{})})}Mx.createRoot(document.getElementById("root")).render(i.jsx(Y.StrictMode,{children:i.jsx(WV,{})}));
//# sourceMappingURL=index-BcyTxYBG.js.map
