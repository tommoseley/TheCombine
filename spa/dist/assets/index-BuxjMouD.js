(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var Ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var XS={exports:{}},Ic={},QS={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ha=Symbol.for("react.element"),KT=Symbol.for("react.portal"),YT=Symbol.for("react.fragment"),XT=Symbol.for("react.strict_mode"),QT=Symbol.for("react.profiler"),ZT=Symbol.for("react.provider"),JT=Symbol.for("react.context"),e5=Symbol.for("react.forward_ref"),t5=Symbol.for("react.suspense"),r5=Symbol.for("react.memo"),n5=Symbol.for("react.lazy"),Qy=Symbol.iterator;function s5(e){return e===null||typeof e!="object"?null:(e=Qy&&e[Qy]||e["@@iterator"],typeof e=="function"?e:null)}var ZS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},JS=Object.assign,ek={};function Io(e,t,r){this.props=e,this.context=t,this.refs=ek,this.updater=r||ZS}Io.prototype.isReactComponent={};Io.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Io.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function tk(){}tk.prototype=Io.prototype;function rv(e,t,r){this.props=e,this.context=t,this.refs=ek,this.updater=r||ZS}var nv=rv.prototype=new tk;nv.constructor=rv;JS(nv,Io.prototype);nv.isPureReactComponent=!0;var Zy=Array.isArray,rk=Object.prototype.hasOwnProperty,sv={current:null},nk={key:!0,ref:!0,__self:!0,__source:!0};function sk(e,t,r){var n,s={},o=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)rk.call(t,n)&&!nk.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:ha,type:e,key:o,ref:a,props:s,_owner:sv.current}}function o5(e,t){return{$$typeof:ha,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ov(e){return typeof e=="object"&&e!==null&&e.$$typeof===ha}function i5(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Jy=/\/+/g;function Ou(e,t){return typeof e=="object"&&e!==null&&e.key!=null?i5(""+e.key):t.toString(36)}function vl(e,t,r,n,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ha:case KT:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+Ou(a,0):n,Zy(s)?(r="",e!=null&&(r=e.replace(Jy,"$&/")+"/"),vl(s,t,r,"",function(d){return d})):s!=null&&(ov(s)&&(s=o5(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Jy,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",Zy(e))for(var l=0;l<e.length;l++){o=e[l];var c=n+Ou(o,l);a+=vl(o,t,r,c,s)}else if(c=s5(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=n+Ou(o,l++),a+=vl(o,t,r,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Pa(e,t,r){if(e==null)return e;var n=[],s=0;return vl(e,n,"","",function(o){return t.call(r,o,s++)}),n}function a5(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $t={current:null},yl={transition:null},l5={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:yl,ReactCurrentOwner:sv};function ok(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:Pa,forEach:function(e,t,r){Pa(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Pa(e,function(){t++}),t},toArray:function(e){return Pa(e,function(t){return t})||[]},only:function(e){if(!ov(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ie.Component=Io;Ie.Fragment=YT;Ie.Profiler=QT;Ie.PureComponent=rv;Ie.StrictMode=XT;Ie.Suspense=t5;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l5;Ie.act=ok;Ie.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=JS({},e.props),s=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=sv.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)rk.call(t,c)&&!nk.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:ha,type:e.type,key:s,ref:o,props:n,_owner:a}};Ie.createContext=function(e){return e={$$typeof:JT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ZT,_context:e},e.Consumer=e};Ie.createElement=sk;Ie.createFactory=function(e){var t=sk.bind(null,e);return t.type=e,t};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(e){return{$$typeof:e5,render:e}};Ie.isValidElement=ov;Ie.lazy=function(e){return{$$typeof:n5,_payload:{_status:-1,_result:e},_init:a5}};Ie.memo=function(e,t){return{$$typeof:r5,type:e,compare:t===void 0?null:t}};Ie.startTransition=function(e){var t=yl.transition;yl.transition={};try{e()}finally{yl.transition=t}};Ie.unstable_act=ok;Ie.useCallback=function(e,t){return $t.current.useCallback(e,t)};Ie.useContext=function(e){return $t.current.useContext(e)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(e){return $t.current.useDeferredValue(e)};Ie.useEffect=function(e,t){return $t.current.useEffect(e,t)};Ie.useId=function(){return $t.current.useId()};Ie.useImperativeHandle=function(e,t,r){return $t.current.useImperativeHandle(e,t,r)};Ie.useInsertionEffect=function(e,t){return $t.current.useInsertionEffect(e,t)};Ie.useLayoutEffect=function(e,t){return $t.current.useLayoutEffect(e,t)};Ie.useMemo=function(e,t){return $t.current.useMemo(e,t)};Ie.useReducer=function(e,t,r){return $t.current.useReducer(e,t,r)};Ie.useRef=function(e){return $t.current.useRef(e)};Ie.useState=function(e){return $t.current.useState(e)};Ie.useSyncExternalStore=function(e,t,r){return $t.current.useSyncExternalStore(e,t,r)};Ie.useTransition=function(){return $t.current.useTransition()};Ie.version="18.3.1";QS.exports=Ie;var m=QS.exports;const Y=tv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c5=m,u5=Symbol.for("react.element"),d5=Symbol.for("react.fragment"),f5=Object.prototype.hasOwnProperty,p5=c5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h5={key:!0,ref:!0,__self:!0,__source:!0};function ik(e,t,r){var n,s={},o=null,a=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)f5.call(t,n)&&!h5.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:u5,type:e,key:o,ref:a,props:s,_owner:p5.current}}Ic.Fragment=d5;Ic.jsx=ik;Ic.jsxs=ik;XS.exports=Ic;var i=XS.exports,Ig={},ak={exports:{}},ir={},lk={exports:{}},ck={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,I){var O=M.length;M.push(I);e:for(;0<O;){var F=O-1>>>1,q=M[F];if(0<s(q,I))M[F]=I,M[O]=q,O=F;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var I=M[0],O=M.pop();if(O!==I){M[0]=O;e:for(var F=0,q=M.length,H=q>>>1;F<H;){var V=2*(F+1)-1,Z=M[V],B=V+1,re=M[B];if(0>s(Z,O))B<q&&0>s(re,Z)?(M[F]=re,M[B]=O,F=B):(M[F]=Z,M[V]=O,F=V);else if(B<q&&0>s(re,O))M[F]=re,M[B]=O,F=B;else break e}}return I}function s(M,I){var O=M.sortIndex-I.sortIndex;return O!==0?O:M.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,v=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var I=r(d);I!==null;){if(I.callback===null)n(d);else if(I.startTime<=M)n(d),I.sortIndex=I.expirationTime,t(c,I);else break;I=r(d)}}function j(M){if(g=!1,b(M),!v)if(r(c)!==null)v=!0,R(k);else{var I=r(d);I!==null&&L(j,I.startTime-M)}}function k(M,I){v=!1,g&&(g=!1,x(C),C=-1),h=!0;var O=p;try{for(b(I),f=r(c);f!==null&&(!(f.expirationTime>I)||M&&!T());){var F=f.callback;if(typeof F=="function"){f.callback=null,p=f.priorityLevel;var q=F(f.expirationTime<=I);I=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(I)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var V=r(d);V!==null&&L(j,V.startTime-I),H=!1}return H}finally{f=null,p=O,h=!1}}var N=!1,S=null,C=-1,w=5,A=-1;function T(){return!(e.unstable_now()-A<w)}function D(){if(S!==null){var M=e.unstable_now();A=M;var I=!0;try{I=S(!0,M)}finally{I?$():(N=!1,S=null)}}else N=!1}var $;if(typeof y=="function")$=function(){y(D)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,P=E.port2;E.port1.onmessage=D,$=function(){P.postMessage(null)}}else $=function(){_(D,0)};function R(M){S=M,N||(N=!0,$())}function L(M,I){C=_(function(){M(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,R(k))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(M){switch(p){case 1:case 2:case 3:var I=3;break;default:I=p}var O=p;p=I;try{return M()}finally{p=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,I){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var O=p;p=M;try{return I()}finally{p=O}},e.unstable_scheduleCallback=function(M,I,O){var F=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?F+O:F):O=F,M){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=O+q,M={id:u++,callback:I,priorityLevel:M,startTime:O,expirationTime:q,sortIndex:-1},O>F?(M.sortIndex=O,t(d,M),r(c)===null&&M===r(d)&&(g?(x(C),C=-1):g=!0,L(j,O-F))):(M.sortIndex=q,t(c,M),v||h||(v=!0,R(k))),M},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(M){var I=p;return function(){var O=p;p=I;try{return M.apply(this,arguments)}finally{p=O}}}})(ck);lk.exports=ck;var m5=lk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g5=m,sr=m5;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uk=new Set,Mi={};function Es(e,t){yo(e,t),yo(e+"Capture",t)}function yo(e,t){for(Mi[e]=t,e=0;e<t.length;e++)uk.add(t[e])}var dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pg=Object.prototype.hasOwnProperty,x5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,e0={},t0={};function v5(e){return Pg.call(t0,e)?!0:Pg.call(e0,e)?!1:x5.test(e)?t0[e]=!0:(e0[e]=!0,!1)}function y5(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function b5(e,t,r,n){if(t===null||typeof t>"u"||y5(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qt(e,t,r,n,s,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Et[e]=new qt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Et[t]=new qt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Et[e]=new qt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Et[e]=new qt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Et[e]=new qt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Et[e]=new qt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Et[e]=new qt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Et[e]=new qt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Et[e]=new qt(e,5,!1,e.toLowerCase(),null,!1,!1)});var iv=/[\-:]([a-z])/g;function av(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(iv,av);Et[t]=new qt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(iv,av);Et[t]=new qt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(iv,av);Et[t]=new qt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Et[e]=new qt(e,1,!1,e.toLowerCase(),null,!1,!1)});Et.xlinkHref=new qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Et[e]=new qt(e,1,!1,e.toLowerCase(),null,!0,!0)});function lv(e,t,r,n){var s=Et.hasOwnProperty(t)?Et[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(b5(t,r,s,n)&&(r=null),n||s===null?v5(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var yn=g5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oa=Symbol.for("react.element"),Vs=Symbol.for("react.portal"),Gs=Symbol.for("react.fragment"),cv=Symbol.for("react.strict_mode"),Og=Symbol.for("react.profiler"),dk=Symbol.for("react.provider"),fk=Symbol.for("react.context"),uv=Symbol.for("react.forward_ref"),Mg=Symbol.for("react.suspense"),Dg=Symbol.for("react.suspense_list"),dv=Symbol.for("react.memo"),kn=Symbol.for("react.lazy"),pk=Symbol.for("react.offscreen"),r0=Symbol.iterator;function Ho(e){return e===null||typeof e!="object"?null:(e=r0&&e[r0]||e["@@iterator"],typeof e=="function"?e:null)}var nt=Object.assign,Mu;function ui(e){if(Mu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Mu=t&&t[1]||""}return`
`+Mu+e}var Du=!1;function Lu(e,t){if(!e||Du)return"";Du=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=n.stack.split(`
`),a=s.length-1,l=o.length-1;1<=a&&0<=l&&s[a]!==o[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==o[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==o[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{Du=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ui(e):""}function _5(e){switch(e.tag){case 5:return ui(e.type);case 16:return ui("Lazy");case 13:return ui("Suspense");case 19:return ui("SuspenseList");case 0:case 2:case 15:return e=Lu(e.type,!1),e;case 11:return e=Lu(e.type.render,!1),e;case 1:return e=Lu(e.type,!0),e;default:return""}}function Lg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Gs:return"Fragment";case Vs:return"Portal";case Og:return"Profiler";case cv:return"StrictMode";case Mg:return"Suspense";case Dg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case fk:return(e.displayName||"Context")+".Consumer";case dk:return(e._context.displayName||"Context")+".Provider";case uv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case dv:return t=e.displayName||null,t!==null?t:Lg(e.type)||"Memo";case kn:t=e._payload,e=e._init;try{return Lg(e(t))}catch{}}return null}function w5(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lg(t);case 8:return t===cv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Yn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function hk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function j5(e){var t=hk(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ma(e){e._valueTracker||(e._valueTracker=j5(e))}function mk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=hk(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ml(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zg(e,t){var r=t.checked;return nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function n0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Yn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function gk(e,t){t=t.checked,t!=null&&lv(e,"checked",t,!1)}function Fg(e,t){gk(e,t);var r=Yn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$g(e,t.type,r):t.hasOwnProperty("defaultValue")&&$g(e,t.type,Yn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function s0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function $g(e,t,r){(t!=="number"||Ml(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var di=Array.isArray;function lo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Yn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function qg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function o0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(J(92));if(di(r)){if(1<r.length)throw Error(J(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Yn(r)}}function xk(e,t){var r=Yn(t.value),n=Yn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function i0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function vk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?vk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Da,yk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Da=Da||document.createElement("div"),Da.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Da.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Di(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ji={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S5=["Webkit","ms","Moz","O"];Object.keys(ji).forEach(function(e){S5.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ji[t]=ji[e]})});function bk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ji.hasOwnProperty(e)&&ji[e]?(""+t).trim():t+"px"}function _k(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=bk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var k5=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wg(e,t){if(t){if(k5[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function Hg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ug=null;function fv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Vg=null,co=null,uo=null;function a0(e){if(e=xa(e)){if(typeof Vg!="function")throw Error(J(280));var t=e.stateNode;t&&(t=Lc(t),Vg(e.stateNode,e.type,t))}}function wk(e){co?uo?uo.push(e):uo=[e]:co=e}function jk(){if(co){var e=co,t=uo;if(uo=co=null,a0(e),t)for(e=0;e<t.length;e++)a0(t[e])}}function Sk(e,t){return e(t)}function kk(){}var zu=!1;function Nk(e,t,r){if(zu)return e(t,r);zu=!0;try{return Sk(e,t,r)}finally{zu=!1,(co!==null||uo!==null)&&(kk(),jk())}}function Li(e,t){var r=e.stateNode;if(r===null)return null;var n=Lc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(J(231,t,typeof r));return r}var Gg=!1;if(dn)try{var Uo={};Object.defineProperty(Uo,"passive",{get:function(){Gg=!0}}),window.addEventListener("test",Uo,Uo),window.removeEventListener("test",Uo,Uo)}catch{Gg=!1}function N5(e,t,r,n,s,o,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var Si=!1,Dl=null,Ll=!1,Kg=null,C5={onError:function(e){Si=!0,Dl=e}};function E5(e,t,r,n,s,o,a,l,c){Si=!1,Dl=null,N5.apply(C5,arguments)}function T5(e,t,r,n,s,o,a,l,c){if(E5.apply(this,arguments),Si){if(Si){var d=Dl;Si=!1,Dl=null}else throw Error(J(198));Ll||(Ll=!0,Kg=d)}}function Ts(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Ck(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function l0(e){if(Ts(e)!==e)throw Error(J(188))}function R5(e){var t=e.alternate;if(!t){if(t=Ts(e),t===null)throw Error(J(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return l0(s),e;if(o===n)return l0(s),t;o=o.sibling}throw Error(J(188))}if(r.return!==n.return)r=s,n=o;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=o;break}if(l===n){a=!0,n=s,r=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===r){a=!0,r=o,n=s;break}if(l===n){a=!0,n=o,r=s;break}l=l.sibling}if(!a)throw Error(J(189))}}if(r.alternate!==n)throw Error(J(190))}if(r.tag!==3)throw Error(J(188));return r.stateNode.current===r?e:t}function Ek(e){return e=R5(e),e!==null?Tk(e):null}function Tk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Tk(e);if(t!==null)return t;e=e.sibling}return null}var Rk=sr.unstable_scheduleCallback,c0=sr.unstable_cancelCallback,A5=sr.unstable_shouldYield,I5=sr.unstable_requestPaint,lt=sr.unstable_now,P5=sr.unstable_getCurrentPriorityLevel,pv=sr.unstable_ImmediatePriority,Ak=sr.unstable_UserBlockingPriority,zl=sr.unstable_NormalPriority,O5=sr.unstable_LowPriority,Ik=sr.unstable_IdlePriority,Pc=null,Hr=null;function M5(e){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(Pc,e,void 0,(e.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:z5,D5=Math.log,L5=Math.LN2;function z5(e){return e>>>=0,e===0?32:31-(D5(e)/L5|0)|0}var La=64,za=4194304;function fi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,o=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=fi(l):(o&=a,o!==0&&(n=fi(o)))}else a=r&~s,a!==0?n=fi(a):o!==0&&(n=fi(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Rr(t),s=1<<r,n|=e[r],t&=~s;return n}function F5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $5(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Rr(o),l=1<<a,c=s[a];c===-1?(!(l&r)||l&n)&&(s[a]=F5(l,t)):c<=t&&(e.expiredLanes|=l),o&=~l}}function Yg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Pk(){var e=La;return La<<=1,!(La&4194240)&&(La=64),e}function Fu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ma(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Rr(t),e[t]=r}function q5(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Rr(r),o=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~o}}function hv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Rr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Ue=0;function Ok(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Mk,mv,Dk,Lk,zk,Xg=!1,Fa=[],Ln=null,zn=null,Fn=null,zi=new Map,Fi=new Map,Rn=[],B5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function u0(e,t){switch(e){case"focusin":case"focusout":Ln=null;break;case"dragenter":case"dragleave":zn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":zi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fi.delete(t.pointerId)}}function Vo(e,t,r,n,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},t!==null&&(t=xa(t),t!==null&&mv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function W5(e,t,r,n,s){switch(t){case"focusin":return Ln=Vo(Ln,e,t,r,n,s),!0;case"dragenter":return zn=Vo(zn,e,t,r,n,s),!0;case"mouseover":return Fn=Vo(Fn,e,t,r,n,s),!0;case"pointerover":var o=s.pointerId;return zi.set(o,Vo(zi.get(o)||null,e,t,r,n,s)),!0;case"gotpointercapture":return o=s.pointerId,Fi.set(o,Vo(Fi.get(o)||null,e,t,r,n,s)),!0}return!1}function Fk(e){var t=us(e.target);if(t!==null){var r=Ts(t);if(r!==null){if(t=r.tag,t===13){if(t=Ck(r),t!==null){e.blockedOn=t,zk(e.priority,function(){Dk(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Qg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ug=n,r.target.dispatchEvent(n),Ug=null}else return t=xa(r),t!==null&&mv(t),e.blockedOn=r,!1;t.shift()}return!0}function d0(e,t,r){bl(e)&&r.delete(t)}function H5(){Xg=!1,Ln!==null&&bl(Ln)&&(Ln=null),zn!==null&&bl(zn)&&(zn=null),Fn!==null&&bl(Fn)&&(Fn=null),zi.forEach(d0),Fi.forEach(d0)}function Go(e,t){e.blockedOn===t&&(e.blockedOn=null,Xg||(Xg=!0,sr.unstable_scheduleCallback(sr.unstable_NormalPriority,H5)))}function $i(e){function t(s){return Go(s,e)}if(0<Fa.length){Go(Fa[0],e);for(var r=1;r<Fa.length;r++){var n=Fa[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ln!==null&&Go(Ln,e),zn!==null&&Go(zn,e),Fn!==null&&Go(Fn,e),zi.forEach(t),Fi.forEach(t),r=0;r<Rn.length;r++)n=Rn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Rn.length&&(r=Rn[0],r.blockedOn===null);)Fk(r),r.blockedOn===null&&Rn.shift()}var fo=yn.ReactCurrentBatchConfig,$l=!0;function U5(e,t,r,n){var s=Ue,o=fo.transition;fo.transition=null;try{Ue=1,gv(e,t,r,n)}finally{Ue=s,fo.transition=o}}function V5(e,t,r,n){var s=Ue,o=fo.transition;fo.transition=null;try{Ue=4,gv(e,t,r,n)}finally{Ue=s,fo.transition=o}}function gv(e,t,r,n){if($l){var s=Qg(e,t,r,n);if(s===null)Yu(e,t,n,ql,r),u0(e,n);else if(W5(s,e,t,r,n))n.stopPropagation();else if(u0(e,n),t&4&&-1<B5.indexOf(e)){for(;s!==null;){var o=xa(s);if(o!==null&&Mk(o),o=Qg(e,t,r,n),o===null&&Yu(e,t,n,ql,r),o===s)break;s=o}s!==null&&n.stopPropagation()}else Yu(e,t,n,null,r)}}var ql=null;function Qg(e,t,r,n){if(ql=null,e=fv(n),e=us(e),e!==null)if(t=Ts(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Ck(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ql=e,null}function $k(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(P5()){case pv:return 1;case Ak:return 4;case zl:case O5:return 16;case Ik:return 536870912;default:return 16}default:return 16}}var Mn=null,xv=null,_l=null;function qk(){if(_l)return _l;var e,t=xv,r=t.length,n,s="value"in Mn?Mn.value:Mn.textContent,o=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[o-n];n++);return _l=s.slice(e,1<n?1-n:void 0)}function wl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $a(){return!0}function f0(){return!1}function ar(e){function t(r,n,s,o,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?$a:f0,this.isPropagationStopped=f0,this}return nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$a)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$a)},persist:function(){},isPersistent:$a}),t}var Po={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vv=ar(Po),ga=nt({},Po,{view:0,detail:0}),G5=ar(ga),$u,qu,Ko,Oc=nt({},ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ko&&(Ko&&e.type==="mousemove"?($u=e.screenX-Ko.screenX,qu=e.screenY-Ko.screenY):qu=$u=0,Ko=e),$u)},movementY:function(e){return"movementY"in e?e.movementY:qu}}),p0=ar(Oc),K5=nt({},Oc,{dataTransfer:0}),Y5=ar(K5),X5=nt({},ga,{relatedTarget:0}),Bu=ar(X5),Q5=nt({},Po,{animationName:0,elapsedTime:0,pseudoElement:0}),Z5=ar(Q5),J5=nt({},Po,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),eR=ar(J5),tR=nt({},Po,{data:0}),h0=ar(tR),rR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oR(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=sR[e])?!!t[e]:!1}function yv(){return oR}var iR=nt({},ga,{key:function(e){if(e.key){var t=rR[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?nR[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yv,charCode:function(e){return e.type==="keypress"?wl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),aR=ar(iR),lR=nt({},Oc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),m0=ar(lR),cR=nt({},ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yv}),uR=ar(cR),dR=nt({},Po,{propertyName:0,elapsedTime:0,pseudoElement:0}),fR=ar(dR),pR=nt({},Oc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),hR=ar(pR),mR=[9,13,27,32],bv=dn&&"CompositionEvent"in window,ki=null;dn&&"documentMode"in document&&(ki=document.documentMode);var gR=dn&&"TextEvent"in window&&!ki,Bk=dn&&(!bv||ki&&8<ki&&11>=ki),g0=" ",x0=!1;function Wk(e,t){switch(e){case"keyup":return mR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ks=!1;function xR(e,t){switch(e){case"compositionend":return Hk(t);case"keypress":return t.which!==32?null:(x0=!0,g0);case"textInput":return e=t.data,e===g0&&x0?null:e;default:return null}}function vR(e,t){if(Ks)return e==="compositionend"||!bv&&Wk(e,t)?(e=qk(),_l=xv=Mn=null,Ks=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bk&&t.locale!=="ko"?null:t.data;default:return null}}var yR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function v0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!yR[e.type]:t==="textarea"}function Uk(e,t,r,n){wk(n),t=Bl(t,"onChange"),0<t.length&&(r=new vv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ni=null,qi=null;function bR(e){rN(e,0)}function Mc(e){var t=Qs(e);if(mk(t))return e}function _R(e,t){if(e==="change")return t}var Vk=!1;if(dn){var Wu;if(dn){var Hu="oninput"in document;if(!Hu){var y0=document.createElement("div");y0.setAttribute("oninput","return;"),Hu=typeof y0.oninput=="function"}Wu=Hu}else Wu=!1;Vk=Wu&&(!document.documentMode||9<document.documentMode)}function b0(){Ni&&(Ni.detachEvent("onpropertychange",Gk),qi=Ni=null)}function Gk(e){if(e.propertyName==="value"&&Mc(qi)){var t=[];Uk(t,qi,e,fv(e)),Nk(bR,t)}}function wR(e,t,r){e==="focusin"?(b0(),Ni=t,qi=r,Ni.attachEvent("onpropertychange",Gk)):e==="focusout"&&b0()}function jR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mc(qi)}function SR(e,t){if(e==="click")return Mc(t)}function kR(e,t){if(e==="input"||e==="change")return Mc(t)}function NR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ir=typeof Object.is=="function"?Object.is:NR;function Bi(e,t){if(Ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Pg.call(t,s)||!Ir(e[s],t[s]))return!1}return!0}function _0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function w0(e,t){var r=_0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_0(r)}}function Kk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Kk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Yk(){for(var e=window,t=Ml();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ml(e.document)}return t}function _v(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function CR(e){var t=Yk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Kk(r.ownerDocument.documentElement,r)){if(n!==null&&_v(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,o=Math.min(n.start,s);n=n.end===void 0?o:Math.min(n.end,s),!e.extend&&o>n&&(s=n,n=o,o=s),s=w0(r,o);var a=w0(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ER=dn&&"documentMode"in document&&11>=document.documentMode,Ys=null,Zg=null,Ci=null,Jg=!1;function j0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Jg||Ys==null||Ys!==Ml(n)||(n=Ys,"selectionStart"in n&&_v(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ci&&Bi(Ci,n)||(Ci=n,n=Bl(Zg,"onSelect"),0<n.length&&(t=new vv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ys)))}function qa(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Xs={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},Uu={},Xk={};dn&&(Xk=document.createElement("div").style,"AnimationEvent"in window||(delete Xs.animationend.animation,delete Xs.animationiteration.animation,delete Xs.animationstart.animation),"TransitionEvent"in window||delete Xs.transitionend.transition);function Dc(e){if(Uu[e])return Uu[e];if(!Xs[e])return e;var t=Xs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Xk)return Uu[e]=t[r];return e}var Qk=Dc("animationend"),Zk=Dc("animationiteration"),Jk=Dc("animationstart"),eN=Dc("transitionend"),tN=new Map,S0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jn(e,t){tN.set(e,t),Es(t,[e])}for(var Vu=0;Vu<S0.length;Vu++){var Gu=S0[Vu],TR=Gu.toLowerCase(),RR=Gu[0].toUpperCase()+Gu.slice(1);Jn(TR,"on"+RR)}Jn(Qk,"onAnimationEnd");Jn(Zk,"onAnimationIteration");Jn(Jk,"onAnimationStart");Jn("dblclick","onDoubleClick");Jn("focusin","onFocus");Jn("focusout","onBlur");Jn(eN,"onTransitionEnd");yo("onMouseEnter",["mouseout","mouseover"]);yo("onMouseLeave",["mouseout","mouseover"]);yo("onPointerEnter",["pointerout","pointerover"]);yo("onPointerLeave",["pointerout","pointerover"]);Es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Es("onBeforeInput",["compositionend","keypress","textInput","paste"]);Es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AR=new Set("cancel close invalid load scroll toggle".split(" ").concat(pi));function k0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,T5(n,t,void 0,e),e.currentTarget=null}function rN(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;k0(s,l,d),o=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;k0(s,l,d),o=c}}}if(Ll)throw e=Kg,Ll=!1,Kg=null,e}function Xe(e,t){var r=t[sx];r===void 0&&(r=t[sx]=new Set);var n=e+"__bubble";r.has(n)||(nN(t,e,2,!1),r.add(n))}function Ku(e,t,r){var n=0;t&&(n|=4),nN(r,e,n,t)}var Ba="_reactListening"+Math.random().toString(36).slice(2);function Wi(e){if(!e[Ba]){e[Ba]=!0,uk.forEach(function(r){r!=="selectionchange"&&(AR.has(r)||Ku(r,!1,e),Ku(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ba]||(t[Ba]=!0,Ku("selectionchange",!1,t))}}function nN(e,t,r,n){switch($k(t)){case 1:var s=U5;break;case 4:s=V5;break;default:s=gv}r=s.bind(null,t,r,e),s=void 0,!Gg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Yu(e,t,r,n,s){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=us(l),a===null)return;if(c=a.tag,c===5||c===6){n=o=a;continue e}l=l.parentNode}}n=n.return}Nk(function(){var d=o,u=fv(r),f=[];e:{var p=tN.get(e);if(p!==void 0){var h=vv,v=e;switch(e){case"keypress":if(wl(r)===0)break e;case"keydown":case"keyup":h=aR;break;case"focusin":v="focus",h=Bu;break;case"focusout":v="blur",h=Bu;break;case"beforeblur":case"afterblur":h=Bu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=p0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Y5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=uR;break;case Qk:case Zk:case Jk:h=Z5;break;case eN:h=fR;break;case"scroll":h=G5;break;case"wheel":h=hR;break;case"copy":case"cut":case"paste":h=eR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=m0}var g=(t&4)!==0,_=!g&&e==="scroll",x=g?p!==null?p+"Capture":null:p;g=[];for(var y=d,b;y!==null;){b=y;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,x!==null&&(j=Li(y,x),j!=null&&g.push(Hi(y,j,b)))),_)break;y=y.return}0<g.length&&(p=new h(p,v,null,r,u),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Ug&&(v=r.relatedTarget||r.fromElement)&&(us(v)||v[fn]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=d,v=v?us(v):null,v!==null&&(_=Ts(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=d),h!==v)){if(g=p0,j="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=m0,j="onPointerLeave",x="onPointerEnter",y="pointer"),_=h==null?p:Qs(h),b=v==null?p:Qs(v),p=new g(j,y+"leave",h,r,u),p.target=_,p.relatedTarget=b,j=null,us(u)===d&&(g=new g(x,y+"enter",v,r,u),g.target=b,g.relatedTarget=_,j=g),_=j,h&&v)t:{for(g=h,x=v,y=0,b=g;b;b=Ds(b))y++;for(b=0,j=x;j;j=Ds(j))b++;for(;0<y-b;)g=Ds(g),y--;for(;0<b-y;)x=Ds(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break t;g=Ds(g),x=Ds(x)}g=null}else g=null;h!==null&&N0(f,p,h,g,!1),v!==null&&_!==null&&N0(f,_,v,g,!0)}}e:{if(p=d?Qs(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var k=_R;else if(v0(p))if(Vk)k=kR;else{k=jR;var N=wR}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=SR);if(k&&(k=k(e,d))){Uk(f,k,r,u);break e}N&&N(e,p,d),e==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&$g(p,"number",p.value)}switch(N=d?Qs(d):window,e){case"focusin":(v0(N)||N.contentEditable==="true")&&(Ys=N,Zg=d,Ci=null);break;case"focusout":Ci=Zg=Ys=null;break;case"mousedown":Jg=!0;break;case"contextmenu":case"mouseup":case"dragend":Jg=!1,j0(f,r,u);break;case"selectionchange":if(ER)break;case"keydown":case"keyup":j0(f,r,u)}var S;if(bv)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Ks?Wk(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(Bk&&r.locale!=="ko"&&(Ks||C!=="onCompositionStart"?C==="onCompositionEnd"&&Ks&&(S=qk()):(Mn=u,xv="value"in Mn?Mn.value:Mn.textContent,Ks=!0)),N=Bl(d,C),0<N.length&&(C=new h0(C,e,null,r,u),f.push({event:C,listeners:N}),S?C.data=S:(S=Hk(r),S!==null&&(C.data=S)))),(S=gR?xR(e,r):vR(e,r))&&(d=Bl(d,"onBeforeInput"),0<d.length&&(u=new h0("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=S))}rN(f,t)})}function Hi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Bl(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Li(e,r),o!=null&&n.unshift(Hi(e,o,s)),o=Li(e,t),o!=null&&n.push(Hi(e,o,s))),e=e.return}return n}function Ds(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function N0(e,t,r,n,s){for(var o=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=Li(r,o),c!=null&&a.unshift(Hi(r,c,l))):s||(c=Li(r,o),c!=null&&a.push(Hi(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var IR=/\r\n?/g,PR=/\u0000|\uFFFD/g;function C0(e){return(typeof e=="string"?e:""+e).replace(IR,`
`).replace(PR,"")}function Wa(e,t,r){if(t=C0(t),C0(e)!==t&&r)throw Error(J(425))}function Wl(){}var ex=null,tx=null;function rx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var nx=typeof setTimeout=="function"?setTimeout:void 0,OR=typeof clearTimeout=="function"?clearTimeout:void 0,E0=typeof Promise=="function"?Promise:void 0,MR=typeof queueMicrotask=="function"?queueMicrotask:typeof E0<"u"?function(e){return E0.resolve(null).then(e).catch(DR)}:nx;function DR(e){setTimeout(function(){throw e})}function Xu(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),$i(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);$i(t)}function $n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function T0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Oo=Math.random().toString(36).slice(2),Br="__reactFiber$"+Oo,Ui="__reactProps$"+Oo,fn="__reactContainer$"+Oo,sx="__reactEvents$"+Oo,LR="__reactListeners$"+Oo,zR="__reactHandles$"+Oo;function us(e){var t=e[Br];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fn]||r[Br]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=T0(e);e!==null;){if(r=e[Br])return r;e=T0(e)}return t}e=r,r=e.parentNode}return null}function xa(e){return e=e[Br]||e[fn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function Lc(e){return e[Ui]||null}var ox=[],Zs=-1;function es(e){return{current:e}}function Qe(e){0>Zs||(e.current=ox[Zs],ox[Zs]=null,Zs--)}function Ke(e,t){Zs++,ox[Zs]=e.current,e.current=t}var Xn={},Pt=es(Xn),Gt=es(!1),_s=Xn;function bo(e,t){var r=e.type.contextTypes;if(!r)return Xn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Kt(e){return e=e.childContextTypes,e!=null}function Hl(){Qe(Gt),Qe(Pt)}function R0(e,t,r){if(Pt.current!==Xn)throw Error(J(168));Ke(Pt,t),Ke(Gt,r)}function sN(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(J(108,w5(e)||"Unknown",s));return nt({},r,n)}function Ul(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xn,_s=Pt.current,Ke(Pt,e),Ke(Gt,Gt.current),!0}function A0(e,t,r){var n=e.stateNode;if(!n)throw Error(J(169));r?(e=sN(e,t,_s),n.__reactInternalMemoizedMergedChildContext=e,Qe(Gt),Qe(Pt),Ke(Pt,e)):Qe(Gt),Ke(Gt,r)}var tn=null,zc=!1,Qu=!1;function oN(e){tn===null?tn=[e]:tn.push(e)}function FR(e){zc=!0,oN(e)}function ts(){if(!Qu&&tn!==null){Qu=!0;var e=0,t=Ue;try{var r=tn;for(Ue=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}tn=null,zc=!1}catch(s){throw tn!==null&&(tn=tn.slice(e+1)),Rk(pv,ts),s}finally{Ue=t,Qu=!1}}return null}var Js=[],eo=0,Vl=null,Gl=0,dr=[],fr=0,ws=null,nn=1,sn="";function as(e,t){Js[eo++]=Gl,Js[eo++]=Vl,Vl=e,Gl=t}function iN(e,t,r){dr[fr++]=nn,dr[fr++]=sn,dr[fr++]=ws,ws=e;var n=nn;e=sn;var s=32-Rr(n)-1;n&=~(1<<s),r+=1;var o=32-Rr(t)+s;if(30<o){var a=s-s%5;o=(n&(1<<a)-1).toString(32),n>>=a,s-=a,nn=1<<32-Rr(t)+s|r<<s|n,sn=o+e}else nn=1<<o|r<<s|n,sn=e}function wv(e){e.return!==null&&(as(e,1),iN(e,1,0))}function jv(e){for(;e===Vl;)Vl=Js[--eo],Js[eo]=null,Gl=Js[--eo],Js[eo]=null;for(;e===ws;)ws=dr[--fr],dr[fr]=null,sn=dr[--fr],dr[fr]=null,nn=dr[--fr],dr[fr]=null}var nr=null,rr=null,Ze=!1,Er=null;function aN(e,t){var r=hr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function I0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nr=e,rr=$n(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nr=e,rr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ws!==null?{id:nn,overflow:sn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=hr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,nr=e,rr=null,!0):!1;default:return!1}}function ix(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ax(e){if(Ze){var t=rr;if(t){var r=t;if(!I0(e,t)){if(ix(e))throw Error(J(418));t=$n(r.nextSibling);var n=nr;t&&I0(e,t)?aN(n,r):(e.flags=e.flags&-4097|2,Ze=!1,nr=e)}}else{if(ix(e))throw Error(J(418));e.flags=e.flags&-4097|2,Ze=!1,nr=e}}}function P0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nr=e}function Ha(e){if(e!==nr)return!1;if(!Ze)return P0(e),Ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!rx(e.type,e.memoizedProps)),t&&(t=rr)){if(ix(e))throw lN(),Error(J(418));for(;t;)aN(e,t),t=$n(t.nextSibling)}if(P0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){rr=$n(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}rr=null}}else rr=nr?$n(e.stateNode.nextSibling):null;return!0}function lN(){for(var e=rr;e;)e=$n(e.nextSibling)}function _o(){rr=nr=null,Ze=!1}function Sv(e){Er===null?Er=[e]:Er.push(e)}var $R=yn.ReactCurrentBatchConfig;function Yo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(J(309));var n=r.stateNode}if(!n)throw Error(J(147,e));var s=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var l=s.refs;a===null?delete l[o]:l[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(J(284));if(!r._owner)throw Error(J(290,e))}return e}function Ua(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function O0(e){var t=e._init;return t(e._payload)}function cN(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=Hn(x,y),x.index=0,x.sibling=null,x}function o(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,y,b,j){return y===null||y.tag!==6?(y=sd(b,x.mode,j),y.return=x,y):(y=s(y,b),y.return=x,y)}function c(x,y,b,j){var k=b.type;return k===Gs?u(x,y,b.props.children,j,b.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===kn&&O0(k)===y.type)?(j=s(y,b.props),j.ref=Yo(x,y,b),j.return=x,j):(j=Tl(b.type,b.key,b.props,null,x.mode,j),j.ref=Yo(x,y,b),j.return=x,j)}function d(x,y,b,j){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=od(b,x.mode,j),y.return=x,y):(y=s(y,b.children||[]),y.return=x,y)}function u(x,y,b,j,k){return y===null||y.tag!==7?(y=xs(b,x.mode,j,k),y.return=x,y):(y=s(y,b),y.return=x,y)}function f(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=sd(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Oa:return b=Tl(y.type,y.key,y.props,null,x.mode,b),b.ref=Yo(x,null,y),b.return=x,b;case Vs:return y=od(y,x.mode,b),y.return=x,y;case kn:var j=y._init;return f(x,j(y._payload),b)}if(di(y)||Ho(y))return y=xs(y,x.mode,b,null),y.return=x,y;Ua(x,y)}return null}function p(x,y,b,j){var k=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:l(x,y,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Oa:return b.key===k?c(x,y,b,j):null;case Vs:return b.key===k?d(x,y,b,j):null;case kn:return k=b._init,p(x,y,k(b._payload),j)}if(di(b)||Ho(b))return k!==null?null:u(x,y,b,j,null);Ua(x,b)}return null}function h(x,y,b,j,k){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(b)||null,l(y,x,""+j,k);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Oa:return x=x.get(j.key===null?b:j.key)||null,c(y,x,j,k);case Vs:return x=x.get(j.key===null?b:j.key)||null,d(y,x,j,k);case kn:var N=j._init;return h(x,y,b,N(j._payload),k)}if(di(j)||Ho(j))return x=x.get(b)||null,u(y,x,j,k,null);Ua(y,j)}return null}function v(x,y,b,j){for(var k=null,N=null,S=y,C=y=0,w=null;S!==null&&C<b.length;C++){S.index>C?(w=S,S=null):w=S.sibling;var A=p(x,S,b[C],j);if(A===null){S===null&&(S=w);break}e&&S&&A.alternate===null&&t(x,S),y=o(A,y,C),N===null?k=A:N.sibling=A,N=A,S=w}if(C===b.length)return r(x,S),Ze&&as(x,C),k;if(S===null){for(;C<b.length;C++)S=f(x,b[C],j),S!==null&&(y=o(S,y,C),N===null?k=S:N.sibling=S,N=S);return Ze&&as(x,C),k}for(S=n(x,S);C<b.length;C++)w=h(S,x,C,b[C],j),w!==null&&(e&&w.alternate!==null&&S.delete(w.key===null?C:w.key),y=o(w,y,C),N===null?k=w:N.sibling=w,N=w);return e&&S.forEach(function(T){return t(x,T)}),Ze&&as(x,C),k}function g(x,y,b,j){var k=Ho(b);if(typeof k!="function")throw Error(J(150));if(b=k.call(b),b==null)throw Error(J(151));for(var N=k=null,S=y,C=y=0,w=null,A=b.next();S!==null&&!A.done;C++,A=b.next()){S.index>C?(w=S,S=null):w=S.sibling;var T=p(x,S,A.value,j);if(T===null){S===null&&(S=w);break}e&&S&&T.alternate===null&&t(x,S),y=o(T,y,C),N===null?k=T:N.sibling=T,N=T,S=w}if(A.done)return r(x,S),Ze&&as(x,C),k;if(S===null){for(;!A.done;C++,A=b.next())A=f(x,A.value,j),A!==null&&(y=o(A,y,C),N===null?k=A:N.sibling=A,N=A);return Ze&&as(x,C),k}for(S=n(x,S);!A.done;C++,A=b.next())A=h(S,x,C,A.value,j),A!==null&&(e&&A.alternate!==null&&S.delete(A.key===null?C:A.key),y=o(A,y,C),N===null?k=A:N.sibling=A,N=A);return e&&S.forEach(function(D){return t(x,D)}),Ze&&as(x,C),k}function _(x,y,b,j){if(typeof b=="object"&&b!==null&&b.type===Gs&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Oa:e:{for(var k=b.key,N=y;N!==null;){if(N.key===k){if(k=b.type,k===Gs){if(N.tag===7){r(x,N.sibling),y=s(N,b.props.children),y.return=x,x=y;break e}}else if(N.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===kn&&O0(k)===N.type){r(x,N.sibling),y=s(N,b.props),y.ref=Yo(x,N,b),y.return=x,x=y;break e}r(x,N);break}else t(x,N);N=N.sibling}b.type===Gs?(y=xs(b.props.children,x.mode,j,b.key),y.return=x,x=y):(j=Tl(b.type,b.key,b.props,null,x.mode,j),j.ref=Yo(x,y,b),j.return=x,x=j)}return a(x);case Vs:e:{for(N=b.key;y!==null;){if(y.key===N)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(x,y.sibling),y=s(y,b.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=od(b,x.mode,j),y.return=x,x=y}return a(x);case kn:return N=b._init,_(x,y,N(b._payload),j)}if(di(b))return v(x,y,b,j);if(Ho(b))return g(x,y,b,j);Ua(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(x,y.sibling),y=s(y,b),y.return=x,x=y):(r(x,y),y=sd(b,x.mode,j),y.return=x,x=y),a(x)):r(x,y)}return _}var wo=cN(!0),uN=cN(!1),Kl=es(null),Yl=null,to=null,kv=null;function Nv(){kv=to=Yl=null}function Cv(e){var t=Kl.current;Qe(Kl),e._currentValue=t}function lx(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function po(e,t){Yl=e,kv=to=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ht=!0),e.firstContext=null)}function xr(e){var t=e._currentValue;if(kv!==e)if(e={context:e,memoizedValue:t,next:null},to===null){if(Yl===null)throw Error(J(308));to=e,Yl.dependencies={lanes:0,firstContext:e}}else to=to.next=e;return t}var ds=null;function Ev(e){ds===null?ds=[e]:ds.push(e)}function dN(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Ev(t)):(r.next=s.next,s.next=r),t.interleaved=r,pn(e,n)}function pn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Nn=!1;function Tv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fN(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Le&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,pn(e,r)}return s=n.interleaved,s===null?(t.next=t,Ev(n)):(t.next=s.next,s.next=t),n.interleaved=t,pn(e,r)}function jl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hv(e,r)}}function M0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=a:o=o.next=a,r=r.next}while(r!==null);o===null?s=o=t:o=o.next=t}else s=o=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Xl(e,t,r,n){var s=e.updateQueue;Nn=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?o=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;a=0,u=d=c=null,l=o;do{var p=l.lane,h=l.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(p=t,h=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(h,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,p=typeof v=="function"?v.call(h,f,p):v,p==null)break e;f=nt({},f,p);break e;case 2:Nn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Ss|=a,e.lanes=a,e.memoizedState=f}}function D0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(J(191,s));s.call(n)}}}var va={},Ur=es(va),Vi=es(va),Gi=es(va);function fs(e){if(e===va)throw Error(J(174));return e}function Rv(e,t){switch(Ke(Gi,t),Ke(Vi,e),Ke(Ur,va),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Bg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Bg(t,e)}Qe(Ur),Ke(Ur,t)}function jo(){Qe(Ur),Qe(Vi),Qe(Gi)}function pN(e){fs(Gi.current);var t=fs(Ur.current),r=Bg(t,e.type);t!==r&&(Ke(Vi,e),Ke(Ur,r))}function Av(e){Vi.current===e&&(Qe(Ur),Qe(Vi))}var tt=es(0);function Ql(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Zu=[];function Iv(){for(var e=0;e<Zu.length;e++)Zu[e]._workInProgressVersionPrimary=null;Zu.length=0}var Sl=yn.ReactCurrentDispatcher,Ju=yn.ReactCurrentBatchConfig,js=0,rt=null,ht=null,yt=null,Zl=!1,Ei=!1,Ki=0,qR=0;function Rt(){throw Error(J(321))}function Pv(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ir(e[r],t[r]))return!1;return!0}function Ov(e,t,r,n,s,o){if(js=o,rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Sl.current=e===null||e.memoizedState===null?UR:VR,e=r(n,s),Ei){o=0;do{if(Ei=!1,Ki=0,25<=o)throw Error(J(301));o+=1,yt=ht=null,t.updateQueue=null,Sl.current=GR,e=r(n,s)}while(Ei)}if(Sl.current=Jl,t=ht!==null&&ht.next!==null,js=0,yt=ht=rt=null,Zl=!1,t)throw Error(J(300));return e}function Mv(){var e=Ki!==0;return Ki=0,e}function qr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?rt.memoizedState=yt=e:yt=yt.next=e,yt}function vr(){if(ht===null){var e=rt.alternate;e=e!==null?e.memoizedState:null}else e=ht.next;var t=yt===null?rt.memoizedState:yt.next;if(t!==null)yt=t,ht=e;else{if(e===null)throw Error(J(310));ht=e,e={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},yt===null?rt.memoizedState=yt=e:yt=yt.next=e}return yt}function Yi(e,t){return typeof t=="function"?t(e):t}function ed(e){var t=vr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=ht,s=n.baseQueue,o=r.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}n.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,n=n.baseState;var l=a=null,c=null,d=o;do{var u=d.lane;if((js&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,a=n):c=c.next=f,rt.lanes|=u,Ss|=u}d=d.next}while(d!==null&&d!==o);c===null?a=n:c.next=l,Ir(n,t.memoizedState)||(Ht=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do o=s.lane,rt.lanes|=o,Ss|=o,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function td(e){var t=vr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,o=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do o=e(o,a.action),a=a.next;while(a!==s);Ir(o,t.memoizedState)||(Ht=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function hN(){}function mN(e,t){var r=rt,n=vr(),s=t(),o=!Ir(n.memoizedState,s);if(o&&(n.memoizedState=s,Ht=!0),n=n.queue,Dv(vN.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||yt!==null&&yt.memoizedState.tag&1){if(r.flags|=2048,Xi(9,xN.bind(null,r,n,s,t),void 0,null),_t===null)throw Error(J(349));js&30||gN(r,t,s)}return s}function gN(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function xN(e,t,r,n){t.value=r,t.getSnapshot=n,yN(t)&&bN(e)}function vN(e,t,r){return r(function(){yN(t)&&bN(e)})}function yN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ir(e,r)}catch{return!0}}function bN(e){var t=pn(e,1);t!==null&&Ar(t,e,1,-1)}function L0(e){var t=qr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:e},t.queue=e,e=e.dispatch=HR.bind(null,rt,e),[t.memoizedState,e]}function Xi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function _N(){return vr().memoizedState}function kl(e,t,r,n){var s=qr();rt.flags|=e,s.memoizedState=Xi(1|t,r,void 0,n===void 0?null:n)}function Fc(e,t,r,n){var s=vr();n=n===void 0?null:n;var o=void 0;if(ht!==null){var a=ht.memoizedState;if(o=a.destroy,n!==null&&Pv(n,a.deps)){s.memoizedState=Xi(t,r,o,n);return}}rt.flags|=e,s.memoizedState=Xi(1|t,r,o,n)}function z0(e,t){return kl(8390656,8,e,t)}function Dv(e,t){return Fc(2048,8,e,t)}function wN(e,t){return Fc(4,2,e,t)}function jN(e,t){return Fc(4,4,e,t)}function SN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function kN(e,t,r){return r=r!=null?r.concat([e]):null,Fc(4,4,SN.bind(null,t,e),r)}function Lv(){}function NN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Pv(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function CN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Pv(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function EN(e,t,r){return js&21?(Ir(r,t)||(r=Pk(),rt.lanes|=r,Ss|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ht=!0),e.memoizedState=r)}function BR(e,t){var r=Ue;Ue=r!==0&&4>r?r:4,e(!0);var n=Ju.transition;Ju.transition={};try{e(!1),t()}finally{Ue=r,Ju.transition=n}}function TN(){return vr().memoizedState}function WR(e,t,r){var n=Wn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},RN(e))AN(t,r);else if(r=dN(e,t,r,n),r!==null){var s=Ft();Ar(r,e,n,s),IN(r,t,n)}}function HR(e,t,r){var n=Wn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(RN(e))AN(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,l=o(a,r);if(s.hasEagerState=!0,s.eagerState=l,Ir(l,a)){var c=t.interleaved;c===null?(s.next=s,Ev(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=dN(e,t,s,n),r!==null&&(s=Ft(),Ar(r,e,n,s),IN(r,t,n))}}function RN(e){var t=e.alternate;return e===rt||t!==null&&t===rt}function AN(e,t){Ei=Zl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function IN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hv(e,r)}}var Jl={readContext:xr,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},UR={readContext:xr,useCallback:function(e,t){return qr().memoizedState=[e,t===void 0?null:t],e},useContext:xr,useEffect:z0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,kl(4194308,4,SN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return kl(4194308,4,e,t)},useInsertionEffect:function(e,t){return kl(4,2,e,t)},useMemo:function(e,t){var r=qr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=qr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=WR.bind(null,rt,e),[n.memoizedState,e]},useRef:function(e){var t=qr();return e={current:e},t.memoizedState=e},useState:L0,useDebugValue:Lv,useDeferredValue:function(e){return qr().memoizedState=e},useTransition:function(){var e=L0(!1),t=e[0];return e=BR.bind(null,e[1]),qr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rt,s=qr();if(Ze){if(r===void 0)throw Error(J(407));r=r()}else{if(r=t(),_t===null)throw Error(J(349));js&30||gN(n,t,r)}s.memoizedState=r;var o={value:r,getSnapshot:t};return s.queue=o,z0(vN.bind(null,n,o,e),[e]),n.flags|=2048,Xi(9,xN.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=qr(),t=_t.identifierPrefix;if(Ze){var r=sn,n=nn;r=(n&~(1<<32-Rr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ki++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=qR++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},VR={readContext:xr,useCallback:NN,useContext:xr,useEffect:Dv,useImperativeHandle:kN,useInsertionEffect:wN,useLayoutEffect:jN,useMemo:CN,useReducer:ed,useRef:_N,useState:function(){return ed(Yi)},useDebugValue:Lv,useDeferredValue:function(e){var t=vr();return EN(t,ht.memoizedState,e)},useTransition:function(){var e=ed(Yi)[0],t=vr().memoizedState;return[e,t]},useMutableSource:hN,useSyncExternalStore:mN,useId:TN,unstable_isNewReconciler:!1},GR={readContext:xr,useCallback:NN,useContext:xr,useEffect:Dv,useImperativeHandle:kN,useInsertionEffect:wN,useLayoutEffect:jN,useMemo:CN,useReducer:td,useRef:_N,useState:function(){return td(Yi)},useDebugValue:Lv,useDeferredValue:function(e){var t=vr();return ht===null?t.memoizedState=e:EN(t,ht.memoizedState,e)},useTransition:function(){var e=td(Yi)[0],t=vr().memoizedState;return[e,t]},useMutableSource:hN,useSyncExternalStore:mN,useId:TN,unstable_isNewReconciler:!1};function kr(e,t){if(e&&e.defaultProps){t=nt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function cx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var $c={isMounted:function(e){return(e=e._reactInternals)?Ts(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ft(),s=Wn(e),o=cn(n,s);o.payload=t,r!=null&&(o.callback=r),t=qn(e,o,s),t!==null&&(Ar(t,e,s,n),jl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ft(),s=Wn(e),o=cn(n,s);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=qn(e,o,s),t!==null&&(Ar(t,e,s,n),jl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ft(),n=Wn(e),s=cn(r,n);s.tag=2,t!=null&&(s.callback=t),t=qn(e,s,n),t!==null&&(Ar(t,e,n,r),jl(t,e,n))}};function F0(e,t,r,n,s,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,a):t.prototype&&t.prototype.isPureReactComponent?!Bi(r,n)||!Bi(s,o):!0}function PN(e,t,r){var n=!1,s=Xn,o=t.contextType;return typeof o=="object"&&o!==null?o=xr(o):(s=Kt(t)?_s:Pt.current,n=t.contextTypes,o=(n=n!=null)?bo(e,s):Xn),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$c,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function $0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&$c.enqueueReplaceState(t,t.state,null)}function ux(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Tv(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=xr(o):(o=Kt(t)?_s:Pt.current,s.context=bo(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(cx(e,t,o,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&$c.enqueueReplaceState(s,s.state,null),Xl(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function So(e,t){try{var r="",n=t;do r+=_5(n),n=n.return;while(n);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function rd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function dx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var KR=typeof WeakMap=="function"?WeakMap:Map;function ON(e,t,r){r=cn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){tc||(tc=!0,_x=n),dx(e,t)},r}function MN(e,t,r){r=cn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){dx(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){dx(e,t),typeof n!="function"&&(Bn===null?Bn=new Set([this]):Bn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function q0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new KR;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=lA.bind(null,e,t,r),t.then(e,e))}function B0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function W0(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=cn(-1,1),t.tag=2,qn(r,t,1))),r.lanes|=1),e)}var YR=yn.ReactCurrentOwner,Ht=!1;function Lt(e,t,r,n){t.child=e===null?uN(t,null,r,n):wo(t,e.child,r,n)}function H0(e,t,r,n,s){r=r.render;var o=t.ref;return po(t,s),n=Ov(e,t,r,n,o,s),r=Mv(),e!==null&&!Ht?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,hn(e,t,s)):(Ze&&r&&wv(t),t.flags|=1,Lt(e,t,n,s),t.child)}function U0(e,t,r,n,s){if(e===null){var o=r.type;return typeof o=="function"&&!Uv(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,DN(e,t,o,n,s)):(e=Tl(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var a=o.memoizedProps;if(r=r.compare,r=r!==null?r:Bi,r(a,n)&&e.ref===t.ref)return hn(e,t,s)}return t.flags|=1,e=Hn(o,n),e.ref=t.ref,e.return=t,t.child=e}function DN(e,t,r,n,s){if(e!==null){var o=e.memoizedProps;if(Bi(o,n)&&e.ref===t.ref)if(Ht=!1,t.pendingProps=n=o,(e.lanes&s)!==0)e.flags&131072&&(Ht=!0);else return t.lanes=e.lanes,hn(e,t,s)}return fx(e,t,r,n,s)}function LN(e,t,r){var n=t.pendingProps,s=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(no,er),er|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ke(no,er),er|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Ke(no,er),er|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Ke(no,er),er|=n;return Lt(e,t,s,r),t.child}function zN(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function fx(e,t,r,n,s){var o=Kt(r)?_s:Pt.current;return o=bo(t,o),po(t,s),r=Ov(e,t,r,n,o,s),n=Mv(),e!==null&&!Ht?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,hn(e,t,s)):(Ze&&n&&wv(t),t.flags|=1,Lt(e,t,r,s),t.child)}function V0(e,t,r,n,s){if(Kt(r)){var o=!0;Ul(t)}else o=!1;if(po(t,s),t.stateNode===null)Nl(e,t),PN(t,r,n),ux(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=xr(d):(d=Kt(r)?_s:Pt.current,d=bo(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==d)&&$0(t,a,n,d),Nn=!1;var p=t.memoizedState;a.state=p,Xl(t,n,a,s),c=t.memoizedState,l!==n||p!==c||Gt.current||Nn?(typeof u=="function"&&(cx(t,r,u,n),c=t.memoizedState),(l=Nn||F0(t,r,l,n,p,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=d,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,fN(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:kr(t.type,l),a.props=d,f=t.pendingProps,p=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=xr(c):(c=Kt(r)?_s:Pt.current,c=bo(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==c)&&$0(t,a,n,c),Nn=!1,p=t.memoizedState,a.state=p,Xl(t,n,a,s);var v=t.memoizedState;l!==f||p!==v||Gt.current||Nn?(typeof h=="function"&&(cx(t,r,h,n),v=t.memoizedState),(d=Nn||F0(t,r,d,n,p,v,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),a.props=n,a.state=v,a.context=c,n=d):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return px(e,t,r,n,o,s)}function px(e,t,r,n,s,o){zN(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&A0(t,r,!1),hn(e,t,o);n=t.stateNode,YR.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,l,o)):Lt(e,t,l,o),t.memoizedState=n.state,s&&A0(t,r,!0),t.child}function FN(e){var t=e.stateNode;t.pendingContext?R0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&R0(e,t.context,!1),Rv(e,t.containerInfo)}function G0(e,t,r,n,s){return _o(),Sv(s),t.flags|=256,Lt(e,t,r,n),t.child}var hx={dehydrated:null,treeContext:null,retryLane:0};function mx(e){return{baseLanes:e,cachePool:null,transitions:null}}function $N(e,t,r){var n=t.pendingProps,s=tt.current,o=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ke(tt,s&1),e===null)return ax(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,o?(n=t.mode,o=t.child,a={mode:"hidden",children:a},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Wc(a,n,0,null),e=xs(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=mx(r),t.memoizedState=hx,e):zv(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return XR(e,t,a,n,l,s,r);if(o){o=n.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Hn(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Hn(l,o):(o=xs(o,a,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,a=e.child.memoizedState,a=a===null?mx(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~r,t.memoizedState=hx,n}return o=e.child,e=o.sibling,n=Hn(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function zv(e,t){return t=Wc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Va(e,t,r,n){return n!==null&&Sv(n),wo(t,e.child,null,r),e=zv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function XR(e,t,r,n,s,o,a){if(r)return t.flags&256?(t.flags&=-257,n=rd(Error(J(422))),Va(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,s=t.mode,n=Wc({mode:"visible",children:n.children},s,0,null),o=xs(o,s,a,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&wo(t,e.child,null,a),t.child.memoizedState=mx(a),t.memoizedState=hx,o);if(!(t.mode&1))return Va(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,o=Error(J(419)),n=rd(o,n,void 0),Va(e,t,a,n)}if(l=(a&e.childLanes)!==0,Ht||l){if(n=_t,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,pn(e,s),Ar(n,e,s,-1))}return Hv(),n=rd(Error(J(421))),Va(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=cA.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,rr=$n(s.nextSibling),nr=t,Ze=!0,Er=null,e!==null&&(dr[fr++]=nn,dr[fr++]=sn,dr[fr++]=ws,nn=e.id,sn=e.overflow,ws=t),t=zv(t,n.children),t.flags|=4096,t)}function K0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),lx(e.return,t,r)}function nd(e,t,r,n,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s)}function qN(e,t,r){var n=t.pendingProps,s=n.revealOrder,o=n.tail;if(Lt(e,t,n.children,r),n=tt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&K0(e,r,t);else if(e.tag===19)K0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ke(tt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Ql(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),nd(t,!1,s,r,o);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ql(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}nd(t,!0,r,null,o);break;case"together":nd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Nl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ss|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,r=Hn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Hn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function QR(e,t,r){switch(t.tag){case 3:FN(t),_o();break;case 5:pN(t);break;case 1:Kt(t.type)&&Ul(t);break;case 4:Rv(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ke(Kl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ke(tt,tt.current&1),t.flags|=128,null):r&t.child.childLanes?$N(e,t,r):(Ke(tt,tt.current&1),e=hn(e,t,r),e!==null?e.sibling:null);Ke(tt,tt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return qN(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ke(tt,tt.current),n)break;return null;case 22:case 23:return t.lanes=0,LN(e,t,r)}return hn(e,t,r)}var BN,gx,WN,HN;BN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};gx=function(){};WN=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,fs(Ur.current);var o=null;switch(r){case"input":s=zg(e,s),n=zg(e,n),o=[];break;case"select":s=nt({},s,{value:void 0}),n=nt({},n,{value:void 0}),o=[];break;case"textarea":s=qg(e,s),n=qg(e,n),o=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Wl)}Wg(r,n);var a;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Mi.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var c=n[d];if(l=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(o||(o=[]),o.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Mi.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Xe("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};HN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Xo(e,t){if(!Ze)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ZR(e,t,r){var n=t.pendingProps;switch(jv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Kt(t.type)&&Hl(),At(t),null;case 3:return n=t.stateNode,jo(),Qe(Gt),Qe(Pt),Iv(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ha(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Er!==null&&(Sx(Er),Er=null))),gx(e,t),At(t),null;case 5:Av(t);var s=fs(Gi.current);if(r=t.type,e!==null&&t.stateNode!=null)WN(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(J(166));return At(t),null}if(e=fs(Ur.current),Ha(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Br]=t,n[Ui]=o,e=(t.mode&1)!==0,r){case"dialog":Xe("cancel",n),Xe("close",n);break;case"iframe":case"object":case"embed":Xe("load",n);break;case"video":case"audio":for(s=0;s<pi.length;s++)Xe(pi[s],n);break;case"source":Xe("error",n);break;case"img":case"image":case"link":Xe("error",n),Xe("load",n);break;case"details":Xe("toggle",n);break;case"input":n0(n,o),Xe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Xe("invalid",n);break;case"textarea":o0(n,o),Xe("invalid",n)}Wg(r,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="children"?typeof l=="string"?n.textContent!==l&&(o.suppressHydrationWarning!==!0&&Wa(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Wa(n.textContent,l,e),s=["children",""+l]):Mi.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Xe("scroll",n)}switch(r){case"input":Ma(n),s0(n,o,!0);break;case"textarea":Ma(n),i0(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=Wl)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=vk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Br]=t,e[Ui]=n,BN(e,t,!1,!1),t.stateNode=e;e:{switch(a=Hg(r,n),r){case"dialog":Xe("cancel",e),Xe("close",e),s=n;break;case"iframe":case"object":case"embed":Xe("load",e),s=n;break;case"video":case"audio":for(s=0;s<pi.length;s++)Xe(pi[s],e);s=n;break;case"source":Xe("error",e),s=n;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),s=n;break;case"details":Xe("toggle",e),s=n;break;case"input":n0(e,n),s=zg(e,n),Xe("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=nt({},n,{value:void 0}),Xe("invalid",e);break;case"textarea":o0(e,n),s=qg(e,n),Xe("invalid",e);break;default:s=n}Wg(r,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?_k(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&yk(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Di(e,c):typeof c=="number"&&Di(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Mi.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Xe("scroll",e):c!=null&&lv(e,o,c,a))}switch(r){case"input":Ma(e),s0(e,n,!1);break;case"textarea":Ma(e),i0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Yn(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?lo(e,!!n.multiple,o,!1):n.defaultValue!=null&&lo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Wl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)HN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(J(166));if(r=fs(Gi.current),fs(Ur.current),Ha(t)){if(n=t.stateNode,r=t.memoizedProps,n[Br]=t,(o=n.nodeValue!==r)&&(e=nr,e!==null))switch(e.tag){case 3:Wa(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Wa(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Br]=t,t.stateNode=n}return At(t),null;case 13:if(Qe(tt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&rr!==null&&t.mode&1&&!(t.flags&128))lN(),_o(),t.flags|=98560,o=!1;else if(o=Ha(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(J(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(J(317));o[Br]=t}else _o(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;At(t),o=!1}else Er!==null&&(Sx(Er),Er=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||tt.current&1?xt===0&&(xt=3):Hv())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return jo(),gx(e,t),e===null&&Wi(t.stateNode.containerInfo),At(t),null;case 10:return Cv(t.type._context),At(t),null;case 17:return Kt(t.type)&&Hl(),At(t),null;case 19:if(Qe(tt),o=t.memoizedState,o===null)return At(t),null;if(n=(t.flags&128)!==0,a=o.rendering,a===null)if(n)Xo(o,!1);else{if(xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ql(e),a!==null){for(t.flags|=128,Xo(o,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ke(tt,tt.current&1|2),t.child}e=e.sibling}o.tail!==null&&lt()>ko&&(t.flags|=128,n=!0,Xo(o,!1),t.lanes=4194304)}else{if(!n)if(e=Ql(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Xo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Ze)return At(t),null}else 2*lt()-o.renderingStartTime>ko&&r!==1073741824&&(t.flags|=128,n=!0,Xo(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(r=o.last,r!==null?r.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=lt(),t.sibling=null,r=tt.current,Ke(tt,n?r&1|2:r&1),t):(At(t),null);case 22:case 23:return Wv(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?er&1073741824&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function JR(e,t){switch(jv(t),t.tag){case 1:return Kt(t.type)&&Hl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return jo(),Qe(Gt),Qe(Pt),Iv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Av(t),null;case 13:if(Qe(tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));_o()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qe(tt),null;case 4:return jo(),null;case 10:return Cv(t.type._context),null;case 22:case 23:return Wv(),null;case 24:return null;default:return null}}var Ga=!1,It=!1,eA=typeof WeakSet=="function"?WeakSet:Set,le=null;function ro(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ot(e,t,n)}else r.current=null}function xx(e,t,r){try{r()}catch(n){ot(e,t,n)}}var Y0=!1;function tA(e,t){if(ex=$l,e=Yk(),_v(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(l=a+s),f!==o||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++d===s&&(l=a),p===o&&++u===n&&(c=a),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(tx={focusedElem:e,selectionRange:r},$l=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,_=v.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:kr(t.type,g),_);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(j){ot(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return v=Y0,Y0=!1,v}function Ti(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&xx(t,r,o)}s=s.next}while(s!==n)}}function qc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function vx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function UN(e){var t=e.alternate;t!==null&&(e.alternate=null,UN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Br],delete t[Ui],delete t[sx],delete t[LR],delete t[zR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function VN(e){return e.tag===5||e.tag===3||e.tag===4}function X0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||VN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Wl));else if(n!==4&&(e=e.child,e!==null))for(yx(e,t,r),e=e.sibling;e!==null;)yx(e,t,r),e=e.sibling}function bx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(bx(e,t,r),e=e.sibling;e!==null;)bx(e,t,r),e=e.sibling}var kt=null,Nr=!1;function wn(e,t,r){for(r=r.child;r!==null;)GN(e,t,r),r=r.sibling}function GN(e,t,r){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(Pc,r)}catch{}switch(r.tag){case 5:It||ro(r,t);case 6:var n=kt,s=Nr;kt=null,wn(e,t,r),kt=n,Nr=s,kt!==null&&(Nr?(e=kt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):kt.removeChild(r.stateNode));break;case 18:kt!==null&&(Nr?(e=kt,r=r.stateNode,e.nodeType===8?Xu(e.parentNode,r):e.nodeType===1&&Xu(e,r),$i(e)):Xu(kt,r.stateNode));break;case 4:n=kt,s=Nr,kt=r.stateNode.containerInfo,Nr=!0,wn(e,t,r),kt=n,Nr=s;break;case 0:case 11:case 14:case 15:if(!It&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&xx(r,t,a),s=s.next}while(s!==n)}wn(e,t,r);break;case 1:if(!It&&(ro(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ot(r,t,l)}wn(e,t,r);break;case 21:wn(e,t,r);break;case 22:r.mode&1?(It=(n=It)||r.memoizedState!==null,wn(e,t,r),It=n):wn(e,t,r);break;default:wn(e,t,r)}}function Q0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new eA),t.forEach(function(n){var s=uA.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function jr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var o=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:kt=l.stateNode,Nr=!1;break e;case 3:kt=l.stateNode.containerInfo,Nr=!0;break e;case 4:kt=l.stateNode.containerInfo,Nr=!0;break e}l=l.return}if(kt===null)throw Error(J(160));GN(o,a,s),kt=null,Nr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){ot(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)KN(t,e),t=t.sibling}function KN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(jr(t,e),Fr(e),n&4){try{Ti(3,e,e.return),qc(3,e)}catch(g){ot(e,e.return,g)}try{Ti(5,e,e.return)}catch(g){ot(e,e.return,g)}}break;case 1:jr(t,e),Fr(e),n&512&&r!==null&&ro(r,r.return);break;case 5:if(jr(t,e),Fr(e),n&512&&r!==null&&ro(r,r.return),e.flags&32){var s=e.stateNode;try{Di(s,"")}catch(g){ot(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,a=r!==null?r.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&gk(s,o),Hg(l,a);var d=Hg(l,o);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?_k(s,f):u==="dangerouslySetInnerHTML"?yk(s,f):u==="children"?Di(s,f):lv(s,u,f,d)}switch(l){case"input":Fg(s,o);break;case"textarea":xk(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?lo(s,!!o.multiple,h,!1):p!==!!o.multiple&&(o.defaultValue!=null?lo(s,!!o.multiple,o.defaultValue,!0):lo(s,!!o.multiple,o.multiple?[]:"",!1))}s[Ui]=o}catch(g){ot(e,e.return,g)}}break;case 6:if(jr(t,e),Fr(e),n&4){if(e.stateNode===null)throw Error(J(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(g){ot(e,e.return,g)}}break;case 3:if(jr(t,e),Fr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$i(t.containerInfo)}catch(g){ot(e,e.return,g)}break;case 4:jr(t,e),Fr(e);break;case 13:jr(t,e),Fr(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(qv=lt())),n&4&&Q0(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(It=(d=It)||u,jr(t,e),It=d):jr(t,e),Fr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(le=e,u=e.child;u!==null;){for(f=le=u;le!==null;){switch(p=le,h=p.child,p.tag){case 0:case 11:case 14:case 15:Ti(4,p,p.return);break;case 1:ro(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){ot(n,r,g)}}break;case 5:ro(p,p.return);break;case 22:if(p.memoizedState!==null){J0(f);continue}}h!==null?(h.return=p,le=h):J0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=bk("display",a))}catch(g){ot(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){ot(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:jr(t,e),Fr(e),n&4&&Q0(e);break;case 21:break;default:jr(t,e),Fr(e)}}function Fr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(VN(r)){var n=r;break e}r=r.return}throw Error(J(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Di(s,""),n.flags&=-33);var o=X0(e);bx(e,o,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=X0(e);yx(e,l,a);break;default:throw Error(J(161))}}catch(c){ot(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function rA(e,t,r){le=e,YN(e)}function YN(e,t,r){for(var n=(e.mode&1)!==0;le!==null;){var s=le,o=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Ga;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||It;l=Ga;var d=It;if(Ga=a,(It=c)&&!d)for(le=s;le!==null;)a=le,c=a.child,a.tag===22&&a.memoizedState!==null?eb(s):c!==null?(c.return=a,le=c):eb(s);for(;o!==null;)le=o,YN(o),o=o.sibling;le=s,Ga=l,It=d}Z0(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,le=o):Z0(e)}}function Z0(e){for(;le!==null;){var t=le;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:It||qc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!It)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:kr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&D0(t,o,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}D0(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&$i(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}It||t.flags&512&&vx(t)}catch(p){ot(t,t.return,p)}}if(t===e){le=null;break}if(r=t.sibling,r!==null){r.return=t.return,le=r;break}le=t.return}}function J0(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var r=t.sibling;if(r!==null){r.return=t.return,le=r;break}le=t.return}}function eb(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{qc(4,t)}catch(c){ot(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){ot(t,s,c)}}var o=t.return;try{vx(t)}catch(c){ot(t,o,c)}break;case 5:var a=t.return;try{vx(t)}catch(c){ot(t,a,c)}}}catch(c){ot(t,t.return,c)}if(t===e){le=null;break}var l=t.sibling;if(l!==null){l.return=t.return,le=l;break}le=t.return}}var nA=Math.ceil,ec=yn.ReactCurrentDispatcher,Fv=yn.ReactCurrentOwner,gr=yn.ReactCurrentBatchConfig,Le=0,_t=null,ut=null,Nt=0,er=0,no=es(0),xt=0,Qi=null,Ss=0,Bc=0,$v=0,Ri=null,Wt=null,qv=0,ko=1/0,en=null,tc=!1,_x=null,Bn=null,Ka=!1,Dn=null,rc=0,Ai=0,wx=null,Cl=-1,El=0;function Ft(){return Le&6?lt():Cl!==-1?Cl:Cl=lt()}function Wn(e){return e.mode&1?Le&2&&Nt!==0?Nt&-Nt:$R.transition!==null?(El===0&&(El=Pk()),El):(e=Ue,e!==0||(e=window.event,e=e===void 0?16:$k(e.type)),e):1}function Ar(e,t,r,n){if(50<Ai)throw Ai=0,wx=null,Error(J(185));ma(e,r,n),(!(Le&2)||e!==_t)&&(e===_t&&(!(Le&2)&&(Bc|=r),xt===4&&An(e,Nt)),Yt(e,n),r===1&&Le===0&&!(t.mode&1)&&(ko=lt()+500,zc&&ts()))}function Yt(e,t){var r=e.callbackNode;$5(e,t);var n=Fl(e,e===_t?Nt:0);if(n===0)r!==null&&c0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&c0(r),t===1)e.tag===0?FR(tb.bind(null,e)):oN(tb.bind(null,e)),MR(function(){!(Le&6)&&ts()}),r=null;else{switch(Ok(n)){case 1:r=pv;break;case 4:r=Ak;break;case 16:r=zl;break;case 536870912:r=Ik;break;default:r=zl}r=nC(r,XN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function XN(e,t){if(Cl=-1,El=0,Le&6)throw Error(J(327));var r=e.callbackNode;if(ho()&&e.callbackNode!==r)return null;var n=Fl(e,e===_t?Nt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=nc(e,n);else{t=n;var s=Le;Le|=2;var o=ZN();(_t!==e||Nt!==t)&&(en=null,ko=lt()+500,gs(e,t));do try{iA();break}catch(l){QN(e,l)}while(!0);Nv(),ec.current=o,Le=s,ut!==null?t=0:(_t=null,Nt=0,t=xt)}if(t!==0){if(t===2&&(s=Yg(e),s!==0&&(n=s,t=jx(e,s))),t===1)throw r=Qi,gs(e,0),An(e,n),Yt(e,lt()),r;if(t===6)An(e,n);else{if(s=e.current.alternate,!(n&30)&&!sA(s)&&(t=nc(e,n),t===2&&(o=Yg(e),o!==0&&(n=o,t=jx(e,o))),t===1))throw r=Qi,gs(e,0),An(e,n),Yt(e,lt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(J(345));case 2:ls(e,Wt,en);break;case 3:if(An(e,n),(n&130023424)===n&&(t=qv+500-lt(),10<t)){if(Fl(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Ft(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=nx(ls.bind(null,e,Wt,en),t);break}ls(e,Wt,en);break;case 4:if(An(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Rr(n);o=1<<a,a=t[a],a>s&&(s=a),n&=~o}if(n=s,n=lt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*nA(n/1960))-n,10<n){e.timeoutHandle=nx(ls.bind(null,e,Wt,en),n);break}ls(e,Wt,en);break;case 5:ls(e,Wt,en);break;default:throw Error(J(329))}}}return Yt(e,lt()),e.callbackNode===r?XN.bind(null,e):null}function jx(e,t){var r=Ri;return e.current.memoizedState.isDehydrated&&(gs(e,t).flags|=256),e=nc(e,t),e!==2&&(t=Wt,Wt=r,t!==null&&Sx(t)),e}function Sx(e){Wt===null?Wt=e:Wt.push.apply(Wt,e)}function sA(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],o=s.getSnapshot;s=s.value;try{if(!Ir(o(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function An(e,t){for(t&=~$v,t&=~Bc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Rr(t),n=1<<r;e[r]=-1,t&=~n}}function tb(e){if(Le&6)throw Error(J(327));ho();var t=Fl(e,0);if(!(t&1))return Yt(e,lt()),null;var r=nc(e,t);if(e.tag!==0&&r===2){var n=Yg(e);n!==0&&(t=n,r=jx(e,n))}if(r===1)throw r=Qi,gs(e,0),An(e,t),Yt(e,lt()),r;if(r===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ls(e,Wt,en),Yt(e,lt()),null}function Bv(e,t){var r=Le;Le|=1;try{return e(t)}finally{Le=r,Le===0&&(ko=lt()+500,zc&&ts())}}function ks(e){Dn!==null&&Dn.tag===0&&!(Le&6)&&ho();var t=Le;Le|=1;var r=gr.transition,n=Ue;try{if(gr.transition=null,Ue=1,e)return e()}finally{Ue=n,gr.transition=r,Le=t,!(Le&6)&&ts()}}function Wv(){er=no.current,Qe(no)}function gs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,OR(r)),ut!==null)for(r=ut.return;r!==null;){var n=r;switch(jv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hl();break;case 3:jo(),Qe(Gt),Qe(Pt),Iv();break;case 5:Av(n);break;case 4:jo();break;case 13:Qe(tt);break;case 19:Qe(tt);break;case 10:Cv(n.type._context);break;case 22:case 23:Wv()}r=r.return}if(_t=e,ut=e=Hn(e.current,null),Nt=er=t,xt=0,Qi=null,$v=Bc=Ss=0,Wt=Ri=null,ds!==null){for(t=0;t<ds.length;t++)if(r=ds[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,o=r.pending;if(o!==null){var a=o.next;o.next=s,n.next=a}r.pending=n}ds=null}return e}function QN(e,t){do{var r=ut;try{if(Nv(),Sl.current=Jl,Zl){for(var n=rt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Zl=!1}if(js=0,yt=ht=rt=null,Ei=!1,Ki=0,Fv.current=null,r===null||r.return===null){xt=1,Qi=t,ut=null;break}e:{var o=e,a=r.return,l=r,c=t;if(t=Nt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=B0(a);if(h!==null){h.flags&=-257,W0(h,a,l,o,t),h.mode&1&&q0(o,d,t),t=h,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){q0(o,d,t),Hv();break e}c=Error(J(426))}}else if(Ze&&l.mode&1){var _=B0(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),W0(_,a,l,o,t),Sv(So(c,l));break e}}o=c=So(c,l),xt!==4&&(xt=2),Ri===null?Ri=[o]:Ri.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var x=ON(o,c,t);M0(o,x);break e;case 1:l=c;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Bn===null||!Bn.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var j=MN(o,l,t);M0(o,j);break e}}o=o.return}while(o!==null)}eC(r)}catch(k){t=k,ut===r&&r!==null&&(ut=r=r.return);continue}break}while(!0)}function ZN(){var e=ec.current;return ec.current=Jl,e===null?Jl:e}function Hv(){(xt===0||xt===3||xt===2)&&(xt=4),_t===null||!(Ss&268435455)&&!(Bc&268435455)||An(_t,Nt)}function nc(e,t){var r=Le;Le|=2;var n=ZN();(_t!==e||Nt!==t)&&(en=null,gs(e,t));do try{oA();break}catch(s){QN(e,s)}while(!0);if(Nv(),Le=r,ec.current=n,ut!==null)throw Error(J(261));return _t=null,Nt=0,xt}function oA(){for(;ut!==null;)JN(ut)}function iA(){for(;ut!==null&&!A5();)JN(ut)}function JN(e){var t=rC(e.alternate,e,er);e.memoizedProps=e.pendingProps,t===null?eC(e):ut=t,Fv.current=null}function eC(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=JR(r,t),r!==null){r.flags&=32767,ut=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{xt=6,ut=null;return}}else if(r=ZR(r,t,er),r!==null){ut=r;return}if(t=t.sibling,t!==null){ut=t;return}ut=t=e}while(t!==null);xt===0&&(xt=5)}function ls(e,t,r){var n=Ue,s=gr.transition;try{gr.transition=null,Ue=1,aA(e,t,r,n)}finally{gr.transition=s,Ue=n}return null}function aA(e,t,r,n){do ho();while(Dn!==null);if(Le&6)throw Error(J(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(q5(e,o),e===_t&&(ut=_t=null,Nt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ka||(Ka=!0,nC(zl,function(){return ho(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=gr.transition,gr.transition=null;var a=Ue;Ue=1;var l=Le;Le|=4,Fv.current=null,tA(e,r),KN(r,e),CR(tx),$l=!!ex,tx=ex=null,e.current=r,rA(r),I5(),Le=l,Ue=a,gr.transition=o}else e.current=r;if(Ka&&(Ka=!1,Dn=e,rc=s),o=e.pendingLanes,o===0&&(Bn=null),M5(r.stateNode),Yt(e,lt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(tc)throw tc=!1,e=_x,_x=null,e;return rc&1&&e.tag!==0&&ho(),o=e.pendingLanes,o&1?e===wx?Ai++:(Ai=0,wx=e):Ai=0,ts(),null}function ho(){if(Dn!==null){var e=Ok(rc),t=gr.transition,r=Ue;try{if(gr.transition=null,Ue=16>e?16:e,Dn===null)var n=!1;else{if(e=Dn,Dn=null,rc=0,Le&6)throw Error(J(331));var s=Le;for(Le|=4,le=e.current;le!==null;){var o=le,a=o.child;if(le.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(le=d;le!==null;){var u=le;switch(u.tag){case 0:case 11:case 15:Ti(8,u,o)}var f=u.child;if(f!==null)f.return=u,le=f;else for(;le!==null;){u=le;var p=u.sibling,h=u.return;if(UN(u),u===d){le=null;break}if(p!==null){p.return=h,le=p;break}le=h}}}var v=o.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(g!==null)}}le=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,le=a;else e:for(;le!==null;){if(o=le,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ti(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,le=x;break e}le=o.return}}var y=e.current;for(le=y;le!==null;){a=le;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,le=b;else e:for(a=y;le!==null;){if(l=le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:qc(9,l)}}catch(k){ot(l,l.return,k)}if(l===a){le=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,le=j;break e}le=l.return}}if(Le=s,ts(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(Pc,e)}catch{}n=!0}return n}finally{Ue=r,gr.transition=t}}return!1}function rb(e,t,r){t=So(r,t),t=ON(e,t,1),e=qn(e,t,1),t=Ft(),e!==null&&(ma(e,1,t),Yt(e,t))}function ot(e,t,r){if(e.tag===3)rb(e,e,r);else for(;t!==null;){if(t.tag===3){rb(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Bn===null||!Bn.has(n))){e=So(r,e),e=MN(t,e,1),t=qn(t,e,1),e=Ft(),t!==null&&(ma(t,1,e),Yt(t,e));break}}t=t.return}}function lA(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ft(),e.pingedLanes|=e.suspendedLanes&r,_t===e&&(Nt&r)===r&&(xt===4||xt===3&&(Nt&130023424)===Nt&&500>lt()-qv?gs(e,0):$v|=r),Yt(e,t)}function tC(e,t){t===0&&(e.mode&1?(t=za,za<<=1,!(za&130023424)&&(za=4194304)):t=1);var r=Ft();e=pn(e,t),e!==null&&(ma(e,t,r),Yt(e,r))}function cA(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),tC(e,r)}function uA(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(J(314))}n!==null&&n.delete(t),tC(e,r)}var rC;rC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Gt.current)Ht=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ht=!1,QR(e,t,r);Ht=!!(e.flags&131072)}else Ht=!1,Ze&&t.flags&1048576&&iN(t,Gl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Nl(e,t),e=t.pendingProps;var s=bo(t,Pt.current);po(t,r),s=Ov(null,t,n,e,s,r);var o=Mv();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kt(n)?(o=!0,Ul(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Tv(t),s.updater=$c,t.stateNode=s,s._reactInternals=t,ux(t,n,e,r),t=px(null,t,n,!0,o,r)):(t.tag=0,Ze&&o&&wv(t),Lt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Nl(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=fA(n),e=kr(n,e),s){case 0:t=fx(null,t,n,e,r);break e;case 1:t=V0(null,t,n,e,r);break e;case 11:t=H0(null,t,n,e,r);break e;case 14:t=U0(null,t,n,kr(n.type,e),r);break e}throw Error(J(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),fx(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),V0(e,t,n,s,r);case 3:e:{if(FN(t),e===null)throw Error(J(387));n=t.pendingProps,o=t.memoizedState,s=o.element,fN(e,t),Xl(t,n,null,r);var a=t.memoizedState;if(n=a.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=So(Error(J(423)),t),t=G0(e,t,n,r,s);break e}else if(n!==s){s=So(Error(J(424)),t),t=G0(e,t,n,r,s);break e}else for(rr=$n(t.stateNode.containerInfo.firstChild),nr=t,Ze=!0,Er=null,r=uN(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_o(),n===s){t=hn(e,t,r);break e}Lt(e,t,n,r)}t=t.child}return t;case 5:return pN(t),e===null&&ax(t),n=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,a=s.children,rx(n,s)?a=null:o!==null&&rx(n,o)&&(t.flags|=32),zN(e,t),Lt(e,t,a,r),t.child;case 6:return e===null&&ax(t),null;case 13:return $N(e,t,r);case 4:return Rv(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=wo(t,null,n,r):Lt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),H0(e,t,n,s,r);case 7:return Lt(e,t,t.pendingProps,r),t.child;case 8:return Lt(e,t,t.pendingProps.children,r),t.child;case 12:return Lt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,o=t.memoizedProps,a=s.value,Ke(Kl,n._currentValue),n._currentValue=a,o!==null)if(Ir(o.value,a)){if(o.children===s.children&&!Gt.current){t=hn(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){a=o.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=cn(-1,r&-r),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),lx(o.return,r,t),l.lanes|=r;break}c=c.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(J(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),lx(a,r,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Lt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,po(t,r),s=xr(s),n=n(s),t.flags|=1,Lt(e,t,n,r),t.child;case 14:return n=t.type,s=kr(n,t.pendingProps),s=kr(n.type,s),U0(e,t,n,s,r);case 15:return DN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:kr(n,s),Nl(e,t),t.tag=1,Kt(n)?(e=!0,Ul(t)):e=!1,po(t,r),PN(t,n,s),ux(t,n,s,r),px(null,t,n,!0,e,r);case 19:return qN(e,t,r);case 22:return LN(e,t,r)}throw Error(J(156,t.tag))};function nC(e,t){return Rk(e,t)}function dA(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(e,t,r,n){return new dA(e,t,r,n)}function Uv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function fA(e){if(typeof e=="function")return Uv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===uv)return 11;if(e===dv)return 14}return 2}function Hn(e,t){var r=e.alternate;return r===null?(r=hr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Tl(e,t,r,n,s,o){var a=2;if(n=e,typeof e=="function")Uv(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Gs:return xs(r.children,s,o,t);case cv:a=8,s|=8;break;case Og:return e=hr(12,r,t,s|2),e.elementType=Og,e.lanes=o,e;case Mg:return e=hr(13,r,t,s),e.elementType=Mg,e.lanes=o,e;case Dg:return e=hr(19,r,t,s),e.elementType=Dg,e.lanes=o,e;case pk:return Wc(r,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case dk:a=10;break e;case fk:a=9;break e;case uv:a=11;break e;case dv:a=14;break e;case kn:a=16,n=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=hr(a,r,t,s),t.elementType=e,t.type=n,t.lanes=o,t}function xs(e,t,r,n){return e=hr(7,e,n,t),e.lanes=r,e}function Wc(e,t,r,n){return e=hr(22,e,n,t),e.elementType=pk,e.lanes=r,e.stateNode={isHidden:!1},e}function sd(e,t,r){return e=hr(6,e,null,t),e.lanes=r,e}function od(e,t,r){return t=hr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function pA(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fu(0),this.expirationTimes=Fu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fu(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vv(e,t,r,n,s,o,a,l,c){return e=new pA(e,t,r,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=hr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tv(o),e}function hA(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function sC(e){if(!e)return Xn;e=e._reactInternals;e:{if(Ts(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var r=e.type;if(Kt(r))return sN(e,r,t)}return t}function oC(e,t,r,n,s,o,a,l,c){return e=Vv(r,n,!0,e,s,o,a,l,c),e.context=sC(null),r=e.current,n=Ft(),s=Wn(r),o=cn(n,s),o.callback=t??null,qn(r,o,s),e.current.lanes=s,ma(e,s,n),Yt(e,n),e}function Hc(e,t,r,n){var s=t.current,o=Ft(),a=Wn(s);return r=sC(r),t.context===null?t.context=r:t.pendingContext=r,t=cn(o,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=qn(s,t,a),e!==null&&(Ar(e,s,a,o),jl(e,s,a)),a}function sc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function nb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Gv(e,t){nb(e,t),(e=e.alternate)&&nb(e,t)}function mA(){return null}var iC=typeof reportError=="function"?reportError:function(e){console.error(e)};function Kv(e){this._internalRoot=e}Uc.prototype.render=Kv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));Hc(e,t,null,null)};Uc.prototype.unmount=Kv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ks(function(){Hc(null,e,null,null)}),t[fn]=null}};function Uc(e){this._internalRoot=e}Uc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Lk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Rn.length&&t!==0&&t<Rn[r].priority;r++);Rn.splice(r,0,e),r===0&&Fk(e)}};function Yv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function sb(){}function gA(e,t,r,n,s){if(s){if(typeof n=="function"){var o=n;n=function(){var d=sc(a);o.call(d)}}var a=oC(t,n,e,0,null,!1,!1,"",sb);return e._reactRootContainer=a,e[fn]=a.current,Wi(e.nodeType===8?e.parentNode:e),ks(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=sc(c);l.call(d)}}var c=Vv(e,0,!1,null,null,!1,!1,"",sb);return e._reactRootContainer=c,e[fn]=c.current,Wi(e.nodeType===8?e.parentNode:e),ks(function(){Hc(t,c,r,n)}),c}function Gc(e,t,r,n,s){var o=r._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var l=s;s=function(){var c=sc(a);l.call(c)}}Hc(t,a,e,s)}else a=gA(r,t,e,s,n);return sc(a)}Mk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=fi(t.pendingLanes);r!==0&&(hv(t,r|1),Yt(t,lt()),!(Le&6)&&(ko=lt()+500,ts()))}break;case 13:ks(function(){var n=pn(e,1);if(n!==null){var s=Ft();Ar(n,e,1,s)}}),Gv(e,1)}};mv=function(e){if(e.tag===13){var t=pn(e,134217728);if(t!==null){var r=Ft();Ar(t,e,134217728,r)}Gv(e,134217728)}};Dk=function(e){if(e.tag===13){var t=Wn(e),r=pn(e,t);if(r!==null){var n=Ft();Ar(r,e,t,n)}Gv(e,t)}};Lk=function(){return Ue};zk=function(e,t){var r=Ue;try{return Ue=e,t()}finally{Ue=r}};Vg=function(e,t,r){switch(t){case"input":if(Fg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Lc(n);if(!s)throw Error(J(90));mk(n),Fg(n,s)}}}break;case"textarea":xk(e,r);break;case"select":t=r.value,t!=null&&lo(e,!!r.multiple,t,!1)}};Sk=Bv;kk=ks;var xA={usingClientEntryPoint:!1,Events:[xa,Qs,Lc,wk,jk,Bv]},Qo={findFiberByHostInstance:us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vA={bundleType:Qo.bundleType,version:Qo.version,rendererPackageName:Qo.rendererPackageName,rendererConfig:Qo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ek(e),e===null?null:e.stateNode},findFiberByHostInstance:Qo.findFiberByHostInstance||mA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ya=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ya.isDisabled&&Ya.supportsFiber)try{Pc=Ya.inject(vA),Hr=Ya}catch{}}ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xA;ir.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yv(t))throw Error(J(200));return hA(e,t,null,r)};ir.createRoot=function(e,t){if(!Yv(e))throw Error(J(299));var r=!1,n="",s=iC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Vv(e,1,!1,null,null,r,!1,n,s),e[fn]=t.current,Wi(e.nodeType===8?e.parentNode:e),new Kv(t)};ir.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=Ek(t),e=e===null?null:e.stateNode,e};ir.flushSync=function(e){return ks(e)};ir.hydrate=function(e,t,r){if(!Vc(t))throw Error(J(200));return Gc(null,e,t,!0,r)};ir.hydrateRoot=function(e,t,r){if(!Yv(e))throw Error(J(405));var n=r!=null&&r.hydratedSources||null,s=!1,o="",a=iC;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=oC(t,null,e,1,r??null,s,!1,o,a),e[fn]=t.current,Wi(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Uc(t)};ir.render=function(e,t,r){if(!Vc(t))throw Error(J(200));return Gc(null,e,t,!1,r)};ir.unmountComponentAtNode=function(e){if(!Vc(e))throw Error(J(40));return e._reactRootContainer?(ks(function(){Gc(null,null,e,!1,function(){e._reactRootContainer=null,e[fn]=null})}),!0):!1};ir.unstable_batchedUpdates=Bv;ir.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Vc(r))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return Gc(e,t,r,!1,n)};ir.version="18.3.1-next-f1338f8080-20240426";function aC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aC)}catch(e){console.error(e)}}aC(),ak.exports=ir;var so=ak.exports,ob=so;Ig.createRoot=ob.createRoot,Ig.hydrateRoot=ob.hydrateRoot;function Qt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Qt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var lC={exports:{}},cC={},uC={exports:{}},dC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var No=m;function yA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var bA=typeof Object.is=="function"?Object.is:yA,_A=No.useState,wA=No.useEffect,jA=No.useLayoutEffect,SA=No.useDebugValue;function kA(e,t){var r=t(),n=_A({inst:{value:r,getSnapshot:t}}),s=n[0].inst,o=n[1];return jA(function(){s.value=r,s.getSnapshot=t,id(s)&&o({inst:s})},[e,r,t]),wA(function(){return id(s)&&o({inst:s}),e(function(){id(s)&&o({inst:s})})},[e]),SA(r),r}function id(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!bA(e,r)}catch{return!0}}function NA(e,t){return t()}var CA=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?NA:kA;dC.useSyncExternalStore=No.useSyncExternalStore!==void 0?No.useSyncExternalStore:CA;uC.exports=dC;var EA=uC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kc=m,TA=EA;function RA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var AA=typeof Object.is=="function"?Object.is:RA,IA=TA.useSyncExternalStore,PA=Kc.useRef,OA=Kc.useEffect,MA=Kc.useMemo,DA=Kc.useDebugValue;cC.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var o=PA(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=MA(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),s!==void 0&&a.hasValue){var v=a.value;if(s(v,h))return f=v}return f=h}if(v=f,AA(u,h))return v;var g=n(h);return s!==void 0&&s(v,g)?(u=h,v):(u=h,f=g)}var d=!1,u,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,s]);var l=IA(e,o[0],o[1]);return OA(function(){a.hasValue=!0,a.value=l},[l]),DA(l),l};lC.exports=cC;var LA=lC.exports;const zA=tv(LA),FA={},ib=e=>{let t;const r=new Set,n=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(v=>v(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>d,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(FA?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,s,c);return c},$A=e=>e?ib(e):ib,{useDebugValue:qA}=Y,{useSyncExternalStoreWithSelector:BA}=zA,WA=e=>e;function fC(e,t=WA,r){const n=BA(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return qA(n),n}const ab=(e,t)=>{const r=$A(e),n=(s,o=t)=>fC(r,s,o);return Object.assign(n,r),n},HA=(e,t)=>e?ab(e,t):ab;function Ot(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var UA={value:()=>{}};function Yc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Rl(r)}function Rl(e){this._=e}function VA(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Rl.prototype=Yc.prototype={constructor:Rl,on:function(e,t){var r=this._,n=VA(e+"",r),s,o=-1,a=n.length;if(arguments.length<2){for(;++o<a;)if((s=(e=n[o]).type)&&(s=GA(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(s=(e=n[o]).type)r[s]=lb(r[s],e.name,t);else if(t==null)for(s in r)r[s]=lb(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Rl(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,o;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,s=o.length;n<s;++n)o[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],s=0,o=n.length;s<o;++s)n[s].value.apply(t,r)}};function GA(e,t){for(var r=0,n=e.length,s;r<n;++r)if((s=e[r]).name===t)return s.value}function lb(e,t,r){for(var n=0,s=e.length;n<s;++n)if(e[n].name===t){e[n]=UA,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var kx="http://www.w3.org/1999/xhtml";const cb={svg:"http://www.w3.org/2000/svg",xhtml:kx,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),cb.hasOwnProperty(t)?{space:cb[t],local:e}:e}function KA(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===kx&&t.documentElement.namespaceURI===kx?t.createElement(e):t.createElementNS(r,e)}}function YA(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function pC(e){var t=Xc(e);return(t.local?YA:KA)(t)}function XA(){}function Xv(e){return e==null?XA:function(){return this.querySelector(e)}}function QA(e){typeof e!="function"&&(e=Xv(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],a=o.length,l=n[s]=new Array(a),c,d,u=0;u<a;++u)(c=o[u])&&(d=e.call(c,c.__data__,u,o))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new or(n,this._parents)}function ZA(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function JA(){return[]}function hC(e){return e==null?JA:function(){return this.querySelectorAll(e)}}function eI(e){return function(){return ZA(e.apply(this,arguments))}}function tI(e){typeof e=="function"?e=eI(e):e=hC(e);for(var t=this._groups,r=t.length,n=[],s=[],o=0;o<r;++o)for(var a=t[o],l=a.length,c,d=0;d<l;++d)(c=a[d])&&(n.push(e.call(c,c.__data__,d,a)),s.push(c));return new or(n,s)}function mC(e){return function(){return this.matches(e)}}function gC(e){return function(t){return t.matches(e)}}var rI=Array.prototype.find;function nI(e){return function(){return rI.call(this.children,e)}}function sI(){return this.firstElementChild}function oI(e){return this.select(e==null?sI:nI(typeof e=="function"?e:gC(e)))}var iI=Array.prototype.filter;function aI(){return Array.from(this.children)}function lI(e){return function(){return iI.call(this.children,e)}}function cI(e){return this.selectAll(e==null?aI:lI(typeof e=="function"?e:gC(e)))}function uI(e){typeof e!="function"&&(e=mC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],a=o.length,l=n[s]=[],c,d=0;d<a;++d)(c=o[d])&&e.call(c,c.__data__,d,o)&&l.push(c);return new or(n,this._parents)}function xC(e){return new Array(e.length)}function dI(){return new or(this._enter||this._groups.map(xC),this._parents)}function oc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}oc.prototype={constructor:oc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function fI(e){return function(){return e}}function pI(e,t,r,n,s,o){for(var a=0,l,c=t.length,d=o.length;a<d;++a)(l=t[a])?(l.__data__=o[a],n[a]=l):r[a]=new oc(e,o[a]);for(;a<c;++a)(l=t[a])&&(s[a]=l)}function hI(e,t,r,n,s,o,a){var l,c,d=new Map,u=t.length,f=o.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=a.call(c,c.__data__,l,t)+"",d.has(h)?s[l]=c:d.set(h,c));for(l=0;l<f;++l)h=a.call(e,o[l],l,o)+"",(c=d.get(h))?(n[l]=c,c.__data__=o[l],d.delete(h)):r[l]=new oc(e,o[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(s[l]=c)}function mI(e){return e.__data__}function gI(e,t){if(!arguments.length)return Array.from(this,mI);var r=t?hI:pI,n=this._parents,s=this._groups;typeof e!="function"&&(e=fI(e));for(var o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),d=0;d<o;++d){var u=n[d],f=s[d],p=f.length,h=xI(e.call(u,u&&u.__data__,d,n)),v=h.length,g=l[d]=new Array(v),_=a[d]=new Array(v),x=c[d]=new Array(p);r(u,f,g,_,x,h,t);for(var y=0,b=0,j,k;y<v;++y)if(j=g[y]){for(y>=b&&(b=y+1);!(k=_[b])&&++b<v;);j._next=k||null}}return a=new or(a,n),a._enter=l,a._exit=c,a}function xI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vI(){return new or(this._exit||this._groups.map(xC),this._parents)}function yI(e,t,r){var n=this.enter(),s=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?o.remove():r(o),n&&s?n.merge(s).order():s}function bI(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,s=r.length,o=n.length,a=Math.min(s,o),l=new Array(s),c=0;c<a;++c)for(var d=r[c],u=n[c],f=d.length,p=l[c]=new Array(f),h,v=0;v<f;++v)(h=d[v]||u[v])&&(p[v]=h);for(;c<s;++c)l[c]=r[c];return new or(l,this._parents)}function _I(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],s=n.length-1,o=n[s],a;--s>=0;)(a=n[s])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function wI(e){e||(e=jI);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,s=new Array(n),o=0;o<n;++o){for(var a=r[o],l=a.length,c=s[o]=new Array(l),d,u=0;u<l;++u)(d=a[u])&&(c[u]=d);c.sort(t)}return new or(s,this._parents).order()}function jI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function SI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function kI(){return Array.from(this)}function NI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length;s<o;++s){var a=n[s];if(a)return a}return null}function CI(){let e=0;for(const t of this)++e;return e}function EI(){return!this.node()}function TI(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var s=t[r],o=0,a=s.length,l;o<a;++o)(l=s[o])&&e.call(l,l.__data__,o,s);return this}function RI(e){return function(){this.removeAttribute(e)}}function AI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function II(e,t){return function(){this.setAttribute(e,t)}}function PI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function OI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function MI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function DI(e,t){var r=Xc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?AI:RI:typeof t=="function"?r.local?MI:OI:r.local?PI:II)(r,t))}function vC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function LI(e){return function(){this.style.removeProperty(e)}}function zI(e,t,r){return function(){this.style.setProperty(e,t,r)}}function FI(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function $I(e,t,r){return arguments.length>1?this.each((t==null?LI:typeof t=="function"?FI:zI)(e,t,r??"")):Co(this.node(),e)}function Co(e,t){return e.style.getPropertyValue(t)||vC(e).getComputedStyle(e,null).getPropertyValue(t)}function qI(e){return function(){delete this[e]}}function BI(e,t){return function(){this[e]=t}}function WI(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function HI(e,t){return arguments.length>1?this.each((t==null?qI:typeof t=="function"?WI:BI)(e,t)):this.node()[e]}function yC(e){return e.trim().split(/^|\s+/)}function Qv(e){return e.classList||new bC(e)}function bC(e){this._node=e,this._names=yC(e.getAttribute("class")||"")}bC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function _C(e,t){for(var r=Qv(e),n=-1,s=t.length;++n<s;)r.add(t[n])}function wC(e,t){for(var r=Qv(e),n=-1,s=t.length;++n<s;)r.remove(t[n])}function UI(e){return function(){_C(this,e)}}function VI(e){return function(){wC(this,e)}}function GI(e,t){return function(){(t.apply(this,arguments)?_C:wC)(this,e)}}function KI(e,t){var r=yC(e+"");if(arguments.length<2){for(var n=Qv(this.node()),s=-1,o=r.length;++s<o;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?GI:t?UI:VI)(r,t))}function YI(){this.textContent=""}function XI(e){return function(){this.textContent=e}}function QI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ZI(e){return arguments.length?this.each(e==null?YI:(typeof e=="function"?QI:XI)(e)):this.node().textContent}function JI(){this.innerHTML=""}function e6(e){return function(){this.innerHTML=e}}function t6(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function r6(e){return arguments.length?this.each(e==null?JI:(typeof e=="function"?t6:e6)(e)):this.node().innerHTML}function n6(){this.nextSibling&&this.parentNode.appendChild(this)}function s6(){return this.each(n6)}function o6(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function i6(){return this.each(o6)}function a6(e){var t=typeof e=="function"?e:pC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function l6(){return null}function c6(e,t){var r=typeof e=="function"?e:pC(e),n=t==null?l6:typeof t=="function"?t:Xv(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function u6(){var e=this.parentNode;e&&e.removeChild(this)}function d6(){return this.each(u6)}function f6(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function p6(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function h6(e){return this.select(e?p6:f6)}function m6(e){return arguments.length?this.property("__data__",e):this.node().__data__}function g6(e){return function(t){e.call(this,t,this.__data__)}}function x6(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function v6(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,s=t.length,o;r<s;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function y6(e,t,r){return function(){var n=this.__on,s,o=g6(t);if(n){for(var a=0,l=n.length;a<l;++a)if((s=n[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=r),s.value=t;return}}this.addEventListener(e.type,o,r),s={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(s):this.__on=[s]}}function b6(e,t,r){var n=x6(e+""),s,o=n.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(s=0,u=l[c];s<o;++s)if((a=n[s]).type===u.type&&a.name===u.name)return u.value}return}for(l=t?y6:v6,s=0;s<o;++s)this.each(l(n[s],t,r));return this}function jC(e,t,r){var n=vC(e),s=n.CustomEvent;typeof s=="function"?s=new s(t,r):(s=n.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function _6(e,t){return function(){return jC(this,e,t)}}function w6(e,t){return function(){return jC(this,e,t.apply(this,arguments))}}function j6(e,t){return this.each((typeof t=="function"?w6:_6)(e,t))}function*S6(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length,a;s<o;++s)(a=n[s])&&(yield a)}var SC=[null];function or(e,t){this._groups=e,this._parents=t}function ya(){return new or([[document.documentElement]],SC)}function k6(){return this}or.prototype=ya.prototype={constructor:or,select:QA,selectAll:tI,selectChild:oI,selectChildren:cI,filter:uI,data:gI,enter:dI,exit:vI,join:yI,merge:bI,selection:k6,order:_I,sort:wI,call:SI,nodes:kI,node:NI,size:CI,empty:EI,each:TI,attr:DI,style:$I,property:HI,classed:KI,text:ZI,html:r6,raise:s6,lower:i6,append:a6,insert:c6,remove:d6,clone:h6,datum:m6,on:b6,dispatch:j6,[Symbol.iterator]:S6};function pr(e){return typeof e=="string"?new or([[document.querySelector(e)]],[document.documentElement]):new or([[e]],SC)}function N6(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Cr(e,t){if(e=N6(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const C6={passive:!1},Zi={capture:!0,passive:!1};function ad(e){e.stopImmediatePropagation()}function mo(e){e.preventDefault(),e.stopImmediatePropagation()}function kC(e){var t=e.document.documentElement,r=pr(e).on("dragstart.drag",mo,Zi);"onselectstart"in t?r.on("selectstart.drag",mo,Zi):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function NC(e,t){var r=e.document.documentElement,n=pr(e).on("dragstart.drag",null);t&&(n.on("click.drag",mo,Zi),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Xa=e=>()=>e;function Nx(e,{sourceEvent:t,subject:r,target:n,identifier:s,active:o,x:a,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}Nx.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function E6(e){return!e.ctrlKey&&!e.button}function T6(){return this.parentNode}function R6(e,t){return t??{x:e.x,y:e.y}}function A6(){return navigator.maxTouchPoints||"ontouchstart"in this}function I6(){var e=E6,t=T6,r=R6,n=A6,s={},o=Yc("start","drag","end"),a=0,l,c,d,u,f=0;function p(j){j.on("mousedown.drag",h).filter(n).on("touchstart.drag",_).on("touchmove.drag",x,C6).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(j,k){if(!(u||!e.call(this,j,k))){var N=b(this,t.call(this,j,k),j,k,"mouse");N&&(pr(j.view).on("mousemove.drag",v,Zi).on("mouseup.drag",g,Zi),kC(j.view),ad(j),d=!1,l=j.clientX,c=j.clientY,N("start",j))}}function v(j){if(mo(j),!d){var k=j.clientX-l,N=j.clientY-c;d=k*k+N*N>f}s.mouse("drag",j)}function g(j){pr(j.view).on("mousemove.drag mouseup.drag",null),NC(j.view,d),mo(j),s.mouse("end",j)}function _(j,k){if(e.call(this,j,k)){var N=j.changedTouches,S=t.call(this,j,k),C=N.length,w,A;for(w=0;w<C;++w)(A=b(this,S,j,k,N[w].identifier,N[w]))&&(ad(j),A("start",j,N[w]))}}function x(j){var k=j.changedTouches,N=k.length,S,C;for(S=0;S<N;++S)(C=s[k[S].identifier])&&(mo(j),C("drag",j,k[S]))}function y(j){var k=j.changedTouches,N=k.length,S,C;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),S=0;S<N;++S)(C=s[k[S].identifier])&&(ad(j),C("end",j,k[S]))}function b(j,k,N,S,C,w){var A=o.copy(),T=Cr(w||N,k),D,$,E;if((E=r.call(j,new Nx("beforestart",{sourceEvent:N,target:p,identifier:C,active:a,x:T[0],y:T[1],dx:0,dy:0,dispatch:A}),S))!=null)return D=E.x-T[0]||0,$=E.y-T[1]||0,function P(R,L,M){var I=T,O;switch(R){case"start":s[C]=P,O=a++;break;case"end":delete s[C],--a;case"drag":T=Cr(M||L,k),O=a;break}A.call(R,j,new Nx(R,{sourceEvent:L,subject:E,target:p,identifier:C,active:O,x:T[0]+D,y:T[1]+$,dx:T[0]-I[0],dy:T[1]-I[1],dispatch:A}),S)}}return p.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Xa(!!j),p):e},p.container=function(j){return arguments.length?(t=typeof j=="function"?j:Xa(j),p):t},p.subject=function(j){return arguments.length?(r=typeof j=="function"?j:Xa(j),p):r},p.touchable=function(j){return arguments.length?(n=typeof j=="function"?j:Xa(!!j),p):n},p.on=function(){var j=o.on.apply(o,arguments);return j===o?p:j},p.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,p):Math.sqrt(f)},p}function Zv(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function CC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ba(){}var Ji=.7,ic=1/Ji,go="\\s*([+-]?\\d+)\\s*",ea="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",P6=/^#([0-9a-f]{3,8})$/,O6=new RegExp(`^rgb\\(${go},${go},${go}\\)$`),M6=new RegExp(`^rgb\\(${Vr},${Vr},${Vr}\\)$`),D6=new RegExp(`^rgba\\(${go},${go},${go},${ea}\\)$`),L6=new RegExp(`^rgba\\(${Vr},${Vr},${Vr},${ea}\\)$`),z6=new RegExp(`^hsl\\(${ea},${Vr},${Vr}\\)$`),F6=new RegExp(`^hsla\\(${ea},${Vr},${Vr},${ea}\\)$`),ub={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zv(ba,ta,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:db,formatHex:db,formatHex8:$6,formatHsl:q6,formatRgb:fb,toString:fb});function db(){return this.rgb().formatHex()}function $6(){return this.rgb().formatHex8()}function q6(){return EC(this).formatHsl()}function fb(){return this.rgb().formatRgb()}function ta(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=P6.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?pb(t):r===3?new Ut(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Qa(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Qa(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=O6.exec(e))?new Ut(t[1],t[2],t[3],1):(t=M6.exec(e))?new Ut(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=D6.exec(e))?Qa(t[1],t[2],t[3],t[4]):(t=L6.exec(e))?Qa(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=z6.exec(e))?gb(t[1],t[2]/100,t[3]/100,1):(t=F6.exec(e))?gb(t[1],t[2]/100,t[3]/100,t[4]):ub.hasOwnProperty(e)?pb(ub[e]):e==="transparent"?new Ut(NaN,NaN,NaN,0):null}function pb(e){return new Ut(e>>16&255,e>>8&255,e&255,1)}function Qa(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ut(e,t,r,n)}function B6(e){return e instanceof ba||(e=ta(e)),e?(e=e.rgb(),new Ut(e.r,e.g,e.b,e.opacity)):new Ut}function Cx(e,t,r,n){return arguments.length===1?B6(e):new Ut(e,t,r,n??1)}function Ut(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Zv(Ut,Cx,CC(ba,{brighter(e){return e=e==null?ic:Math.pow(ic,e),new Ut(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ji:Math.pow(Ji,e),new Ut(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ut(vs(this.r),vs(this.g),vs(this.b),ac(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hb,formatHex:hb,formatHex8:W6,formatRgb:mb,toString:mb}));function hb(){return`#${ps(this.r)}${ps(this.g)}${ps(this.b)}`}function W6(){return`#${ps(this.r)}${ps(this.g)}${ps(this.b)}${ps((isNaN(this.opacity)?1:this.opacity)*255)}`}function mb(){const e=ac(this.opacity);return`${e===1?"rgb(":"rgba("}${vs(this.r)}, ${vs(this.g)}, ${vs(this.b)}${e===1?")":`, ${e})`}`}function ac(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ps(e){return e=vs(e),(e<16?"0":"")+e.toString(16)}function gb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Tr(e,t,r,n)}function EC(e){if(e instanceof Tr)return new Tr(e.h,e.s,e.l,e.opacity);if(e instanceof ba||(e=ta(e)),!e)return new Tr;if(e instanceof Tr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,l=o-s,c=(o+s)/2;return l?(t===o?a=(r-n)/l+(r<n)*6:r===o?a=(n-t)/l+2:a=(t-r)/l+4,l/=c<.5?o+s:2-o-s,a*=60):l=c>0&&c<1?0:a,new Tr(a,l,c,e.opacity)}function H6(e,t,r,n){return arguments.length===1?EC(e):new Tr(e,t,r,n??1)}function Tr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Zv(Tr,H6,CC(ba,{brighter(e){return e=e==null?ic:Math.pow(ic,e),new Tr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ji:Math.pow(Ji,e),new Tr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new Ut(ld(e>=240?e-240:e+120,s,n),ld(e,s,n),ld(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new Tr(xb(this.h),Za(this.s),Za(this.l),ac(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ac(this.opacity);return`${e===1?"hsl(":"hsla("}${xb(this.h)}, ${Za(this.s)*100}%, ${Za(this.l)*100}%${e===1?")":`, ${e})`}`}}));function xb(e){return e=(e||0)%360,e<0?e+360:e}function Za(e){return Math.max(0,Math.min(1,e||0))}function ld(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const TC=e=>()=>e;function U6(e,t){return function(r){return e+r*t}}function V6(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function G6(e){return(e=+e)==1?RC:function(t,r){return r-t?V6(t,r,e):TC(isNaN(t)?r:t)}}function RC(e,t){var r=t-e;return r?U6(e,r):TC(isNaN(e)?t:e)}const vb=function e(t){var r=G6(t);function n(s,o){var a=r((s=Cx(s)).r,(o=Cx(o)).r),l=r(s.g,o.g),c=r(s.b,o.b),d=RC(s.opacity,o.opacity);return function(u){return s.r=a(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return n.gamma=e,n}(1);function Cn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var Ex=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cd=new RegExp(Ex.source,"g");function K6(e){return function(){return e}}function Y6(e){return function(t){return e(t)+""}}function X6(e,t){var r=Ex.lastIndex=cd.lastIndex=0,n,s,o,a=-1,l=[],c=[];for(e=e+"",t=t+"";(n=Ex.exec(e))&&(s=cd.exec(t));)(o=s.index)>r&&(o=t.slice(r,o),l[a]?l[a]+=o:l[++a]=o),(n=n[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:Cn(n,s)})),r=cd.lastIndex;return r<t.length&&(o=t.slice(r),l[a]?l[a]+=o:l[++a]=o),l.length<2?c[0]?Y6(c[0].x):K6(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var yb=180/Math.PI,Tx={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function AC(e,t,r,n,s,o){var a,l,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,a=-a),{translateX:s,translateY:o,rotate:Math.atan2(t,e)*yb,skewX:Math.atan(c)*yb,scaleX:a,scaleY:l}}var Ja;function Q6(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Tx:AC(t.a,t.b,t.c,t.d,t.e,t.f)}function Z6(e){return e==null||(Ja||(Ja=document.createElementNS("http://www.w3.org/2000/svg","g")),Ja.setAttribute("transform",e),!(e=Ja.transform.baseVal.consolidate()))?Tx:(e=e.matrix,AC(e.a,e.b,e.c,e.d,e.e,e.f))}function IC(e,t,r,n){function s(d){return d.length?d.pop()+" ":""}function o(d,u,f,p,h,v){if(d!==f||u!==p){var g=h.push("translate(",null,t,null,r);v.push({i:g-4,x:Cn(d,f)},{i:g-2,x:Cn(u,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function a(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(s(f)+"rotate(",null,n)-2,x:Cn(d,u)})):u&&f.push(s(f)+"rotate("+u+n)}function l(d,u,f,p){d!==u?p.push({i:f.push(s(f)+"skewX(",null,n)-2,x:Cn(d,u)}):u&&f.push(s(f)+"skewX("+u+n)}function c(d,u,f,p,h,v){if(d!==f||u!==p){var g=h.push(s(h)+"scale(",null,",",null,")");v.push({i:g-4,x:Cn(d,f)},{i:g-2,x:Cn(u,p)})}else(f!==1||p!==1)&&h.push(s(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),o(d.translateX,d.translateY,u.translateX,u.translateY,f,p),a(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var v=-1,g=p.length,_;++v<g;)f[(_=p[v]).i]=_.x(h);return f.join("")}}}var J6=IC(Q6,"px, ","px)","deg)"),eP=IC(Z6,", ",")",")"),tP=1e-12;function bb(e){return((e=Math.exp(e))+1/e)/2}function rP(e){return((e=Math.exp(e))-1/e)/2}function nP(e){return((e=Math.exp(2*e))-1)/(e+1)}const sP=function e(t,r,n){function s(o,a){var l=o[0],c=o[1],d=o[2],u=a[0],f=a[1],p=a[2],h=u-l,v=f-c,g=h*h+v*v,_,x;if(g<tP)x=Math.log(p/d)/t,_=function(S){return[l+S*h,c+S*v,d*Math.exp(t*S*x)]};else{var y=Math.sqrt(g),b=(p*p-d*d+n*g)/(2*d*r*y),j=(p*p-d*d-n*g)/(2*p*r*y),k=Math.log(Math.sqrt(b*b+1)-b),N=Math.log(Math.sqrt(j*j+1)-j);x=(N-k)/t,_=function(S){var C=S*x,w=bb(k),A=d/(r*y)*(w*nP(t*C+k)-rP(k));return[l+A*h,c+A*v,d*w/bb(t*C+k)]}}return _.duration=x*1e3*t/Math.SQRT2,_}return s.rho=function(o){var a=Math.max(.001,+o),l=a*a,c=l*l;return e(a,l,c)},s}(Math.SQRT2,2,4);var Eo=0,hi=0,Zo=0,PC=1e3,lc,mi,cc=0,Ns=0,Qc=0,ra=typeof performance=="object"&&performance.now?performance:Date,OC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Jv(){return Ns||(OC(oP),Ns=ra.now()+Qc)}function oP(){Ns=0}function uc(){this._call=this._time=this._next=null}uc.prototype=MC.prototype={constructor:uc,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Jv():+r)+(t==null?0:+t),!this._next&&mi!==this&&(mi?mi._next=this:lc=this,mi=this),this._call=e,this._time=r,Rx()},stop:function(){this._call&&(this._call=null,this._time=1/0,Rx())}};function MC(e,t,r){var n=new uc;return n.restart(e,t,r),n}function iP(){Jv(),++Eo;for(var e=lc,t;e;)(t=Ns-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Eo}function _b(){Ns=(cc=ra.now())+Qc,Eo=hi=0;try{iP()}finally{Eo=0,lP(),Ns=0}}function aP(){var e=ra.now(),t=e-cc;t>PC&&(Qc-=t,cc=e)}function lP(){for(var e,t=lc,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:lc=r);mi=e,Rx(n)}function Rx(e){if(!Eo){hi&&(hi=clearTimeout(hi));var t=e-Ns;t>24?(e<1/0&&(hi=setTimeout(_b,e-ra.now()-Qc)),Zo&&(Zo=clearInterval(Zo))):(Zo||(cc=ra.now(),Zo=setInterval(aP,PC)),Eo=1,OC(_b))}}function wb(e,t,r){var n=new uc;return t=t==null?0:+t,n.restart(s=>{n.stop(),e(s+t)},t,r),n}var cP=Yc("start","end","cancel","interrupt"),uP=[],DC=0,jb=1,Ax=2,Al=3,Sb=4,Ix=5,Il=6;function Zc(e,t,r,n,s,o){var a=e.__transition;if(!a)e.__transition={};else if(r in a)return;dP(e,r,{name:t,index:n,group:s,on:cP,tween:uP,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:DC})}function ey(e,t){var r=Or(e,t);if(r.state>DC)throw new Error("too late; already scheduled");return r}function Yr(e,t){var r=Or(e,t);if(r.state>Al)throw new Error("too late; already running");return r}function Or(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function dP(e,t,r){var n=e.__transition,s;n[t]=r,r.timer=MC(o,0,r.time);function o(d){r.state=jb,r.timer.restart(a,r.delay,r.time),r.delay<=d&&a(d-r.delay)}function a(d){var u,f,p,h;if(r.state!==jb)return c();for(u in n)if(h=n[u],h.name===r.name){if(h.state===Al)return wb(a);h.state===Sb?(h.state=Il,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[u]):+u<t&&(h.state=Il,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[u])}if(wb(function(){r.state===Al&&(r.state=Sb,r.timer.restart(l,r.delay,r.time),l(d))}),r.state=Ax,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Ax){for(r.state=Al,s=new Array(p=r.tween.length),u=0,f=-1;u<p;++u)(h=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(s[++f]=h);s.length=f+1}}function l(d){for(var u=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(c),r.state=Ix,1),f=-1,p=s.length;++f<p;)s[f].call(e,u);r.state===Ix&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Il,r.timer.stop(),delete n[t];for(var d in n)return;delete e.__transition}}function Pl(e,t){var r=e.__transition,n,s,o=!0,a;if(r){t=t==null?null:t+"";for(a in r){if((n=r[a]).name!==t){o=!1;continue}s=n.state>Ax&&n.state<Ix,n.state=Il,n.timer.stop(),n.on.call(s?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[a]}o&&delete e.__transition}}function fP(e){return this.each(function(){Pl(this,e)})}function pP(e,t){var r,n;return function(){var s=Yr(this,e),o=s.tween;if(o!==r){n=r=o;for(var a=0,l=n.length;a<l;++a)if(n[a].name===t){n=n.slice(),n.splice(a,1);break}}s.tween=n}}function hP(e,t,r){var n,s;if(typeof r!="function")throw new Error;return function(){var o=Yr(this,e),a=o.tween;if(a!==n){s=(n=a).slice();for(var l={name:t,value:r},c=0,d=s.length;c<d;++c)if(s[c].name===t){s[c]=l;break}c===d&&s.push(l)}o.tween=s}}function mP(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Or(this.node(),r).tween,s=0,o=n.length,a;s<o;++s)if((a=n[s]).name===e)return a.value;return null}return this.each((t==null?pP:hP)(r,e,t))}function ty(e,t,r){var n=e._id;return e.each(function(){var s=Yr(this,n);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return Or(s,n).value[t]}}function LC(e,t){var r;return(typeof t=="number"?Cn:t instanceof ta?vb:(r=ta(t))?(t=r,vb):X6)(e,t)}function gP(e){return function(){this.removeAttribute(e)}}function xP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function vP(e,t,r){var n,s=r+"",o;return function(){var a=this.getAttribute(e);return a===s?null:a===n?o:o=t(n=a,r)}}function yP(e,t,r){var n,s=r+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===n?o:o=t(n=a,r)}}function bP(e,t,r){var n,s,o;return function(){var a,l=r(this),c;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=l+"",a===c?null:a===n&&c===s?o:(s=c,o=t(n=a,l)))}}function _P(e,t,r){var n,s,o;return function(){var a,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=l+"",a===c?null:a===n&&c===s?o:(s=c,o=t(n=a,l)))}}function wP(e,t){var r=Xc(e),n=r==="transform"?eP:LC;return this.attrTween(e,typeof t=="function"?(r.local?_P:bP)(r,n,ty(this,"attr."+e,t)):t==null?(r.local?xP:gP)(r):(r.local?yP:vP)(r,n,t))}function jP(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function SP(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function kP(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&SP(e,o)),r}return s._value=t,s}function NP(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&jP(e,o)),r}return s._value=t,s}function CP(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Xc(e);return this.tween(r,(n.local?kP:NP)(n,t))}function EP(e,t){return function(){ey(this,e).delay=+t.apply(this,arguments)}}function TP(e,t){return t=+t,function(){ey(this,e).delay=t}}function RP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?EP:TP)(t,e)):Or(this.node(),t).delay}function AP(e,t){return function(){Yr(this,e).duration=+t.apply(this,arguments)}}function IP(e,t){return t=+t,function(){Yr(this,e).duration=t}}function PP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?AP:IP)(t,e)):Or(this.node(),t).duration}function OP(e,t){if(typeof t!="function")throw new Error;return function(){Yr(this,e).ease=t}}function MP(e){var t=this._id;return arguments.length?this.each(OP(t,e)):Or(this.node(),t).ease}function DP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Yr(this,e).ease=r}}function LP(e){if(typeof e!="function")throw new Error;return this.each(DP(this._id,e))}function zP(e){typeof e!="function"&&(e=mC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],a=o.length,l=n[s]=[],c,d=0;d<a;++d)(c=o[d])&&e.call(c,c.__data__,d,o)&&l.push(c);return new mn(n,this._parents,this._name,this._id)}function FP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,s=r.length,o=Math.min(n,s),a=new Array(n),l=0;l<o;++l)for(var c=t[l],d=r[l],u=c.length,f=a[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<n;++l)a[l]=t[l];return new mn(a,this._parents,this._name,this._id)}function $P(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function qP(e,t,r){var n,s,o=$P(t)?ey:Yr;return function(){var a=o(this,e),l=a.on;l!==n&&(s=(n=l).copy()).on(t,r),a.on=s}}function BP(e,t){var r=this._id;return arguments.length<2?Or(this.node(),r).on.on(e):this.each(qP(r,e,t))}function WP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function HP(){return this.on("end.remove",WP(this._id))}function UP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Xv(e));for(var n=this._groups,s=n.length,o=new Array(s),a=0;a<s;++a)for(var l=n[a],c=l.length,d=o[a]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,Zc(d[p],t,r,p,d,Or(u,r)));return new mn(o,this._parents,t,r)}function VP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=hC(e));for(var n=this._groups,s=n.length,o=[],a=[],l=0;l<s;++l)for(var c=n[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,v=Or(u,r),g=0,_=p.length;g<_;++g)(h=p[g])&&Zc(h,t,r,g,p,v);o.push(p),a.push(u)}return new mn(o,a,t,r)}var GP=ya.prototype.constructor;function KP(){return new GP(this._groups,this._parents)}function YP(e,t){var r,n,s;return function(){var o=Co(this,e),a=(this.style.removeProperty(e),Co(this,e));return o===a?null:o===r&&a===n?s:s=t(r=o,n=a)}}function zC(e){return function(){this.style.removeProperty(e)}}function XP(e,t,r){var n,s=r+"",o;return function(){var a=Co(this,e);return a===s?null:a===n?o:o=t(n=a,r)}}function QP(e,t,r){var n,s,o;return function(){var a=Co(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Co(this,e))),a===c?null:a===n&&c===s?o:(s=c,o=t(n=a,l))}}function ZP(e,t){var r,n,s,o="style."+t,a="end."+o,l;return function(){var c=Yr(this,e),d=c.on,u=c.value[o]==null?l||(l=zC(t)):void 0;(d!==r||s!==u)&&(n=(r=d).copy()).on(a,s=u),c.on=n}}function JP(e,t,r){var n=(e+="")=="transform"?J6:LC;return t==null?this.styleTween(e,YP(e,n)).on("end.style."+e,zC(e)):typeof t=="function"?this.styleTween(e,QP(e,n,ty(this,"style."+e,t))).each(ZP(this._id,e)):this.styleTween(e,XP(e,n,t),r).on("end.style."+e,null)}function eO(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function tO(e,t,r){var n,s;function o(){var a=t.apply(this,arguments);return a!==s&&(n=(s=a)&&eO(e,a,r)),n}return o._value=t,o}function rO(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,tO(e,t,r??""))}function nO(e){return function(){this.textContent=e}}function sO(e){return function(){var t=e(this);this.textContent=t??""}}function oO(e){return this.tween("text",typeof e=="function"?sO(ty(this,"text",e)):nO(e==null?"":e+""))}function iO(e){return function(t){this.textContent=e.call(this,t)}}function aO(e){var t,r;function n(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&iO(s)),t}return n._value=e,n}function lO(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,aO(e))}function cO(){for(var e=this._name,t=this._id,r=FC(),n=this._groups,s=n.length,o=0;o<s;++o)for(var a=n[o],l=a.length,c,d=0;d<l;++d)if(c=a[d]){var u=Or(c,t);Zc(c,e,r,d,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new mn(n,this._parents,e,r)}function uO(){var e,t,r=this,n=r._id,s=r.size();return new Promise(function(o,a){var l={value:a},c={value:function(){--s===0&&o()}};r.each(function(){var d=Yr(this,n),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),s===0&&o()})}var dO=0;function mn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function FC(){return++dO}var Qr=ya.prototype;mn.prototype={constructor:mn,select:UP,selectAll:VP,selectChild:Qr.selectChild,selectChildren:Qr.selectChildren,filter:zP,merge:FP,selection:KP,transition:cO,call:Qr.call,nodes:Qr.nodes,node:Qr.node,size:Qr.size,empty:Qr.empty,each:Qr.each,on:BP,attr:wP,attrTween:CP,style:JP,styleTween:rO,text:oO,textTween:lO,remove:HP,tween:mP,delay:RP,duration:PP,ease:MP,easeVarying:LP,end:uO,[Symbol.iterator]:Qr[Symbol.iterator]};function fO(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var pO={time:null,delay:0,duration:250,ease:fO};function hO(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function mO(e){var t,r;e instanceof mn?(t=e._id,e=e._name):(t=FC(),(r=pO).time=Jv(),e=e==null?null:e+"");for(var n=this._groups,s=n.length,o=0;o<s;++o)for(var a=n[o],l=a.length,c,d=0;d<l;++d)(c=a[d])&&Zc(c,e,t,d,a,r||hO(c,t));return new mn(n,this._parents,e,t)}ya.prototype.interrupt=fP;ya.prototype.transition=mO;const el=e=>()=>e;function gO(e,{sourceEvent:t,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function on(e,t,r){this.k=e,this.x=t,this.y=r}on.prototype={constructor:on,scale:function(e){return e===1?this:new on(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new on(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var un=new on(1,0,0);on.prototype;function ud(e){e.stopImmediatePropagation()}function Jo(e){e.preventDefault(),e.stopImmediatePropagation()}function xO(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function vO(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function kb(){return this.__zoom||un}function yO(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function bO(){return navigator.maxTouchPoints||"ontouchstart"in this}function _O(e,t,r){var n=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function $C(){var e=xO,t=vO,r=_O,n=yO,s=bO,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,c=sP,d=Yc("start","zoom","end"),u,f,p,h=500,v=150,g=0,_=10;function x(E){E.property("__zoom",kb).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",A).filter(s).on("touchstart.zoom",T).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",$).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(E,P,R,L){var M=E.selection?E.selection():E;M.property("__zoom",kb),E!==M?k(E,P,R,L):M.interrupt().each(function(){N(this,arguments).event(L).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},x.scaleBy=function(E,P,R,L){x.scaleTo(E,function(){var M=this.__zoom.k,I=typeof P=="function"?P.apply(this,arguments):P;return M*I},R,L)},x.scaleTo=function(E,P,R,L){x.transform(E,function(){var M=t.apply(this,arguments),I=this.__zoom,O=R==null?j(M):typeof R=="function"?R.apply(this,arguments):R,F=I.invert(O),q=typeof P=="function"?P.apply(this,arguments):P;return r(b(y(I,q),O,F),M,a)},R,L)},x.translateBy=function(E,P,R,L){x.transform(E,function(){return r(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof R=="function"?R.apply(this,arguments):R),t.apply(this,arguments),a)},null,L)},x.translateTo=function(E,P,R,L,M){x.transform(E,function(){var I=t.apply(this,arguments),O=this.__zoom,F=L==null?j(I):typeof L=="function"?L.apply(this,arguments):L;return r(un.translate(F[0],F[1]).scale(O.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof R=="function"?-R.apply(this,arguments):-R),I,a)},L,M)};function y(E,P){return P=Math.max(o[0],Math.min(o[1],P)),P===E.k?E:new on(P,E.x,E.y)}function b(E,P,R){var L=P[0]-R[0]*E.k,M=P[1]-R[1]*E.k;return L===E.x&&M===E.y?E:new on(E.k,L,M)}function j(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function k(E,P,R,L){E.on("start.zoom",function(){N(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(L).end()}).tween("zoom",function(){var M=this,I=arguments,O=N(M,I).event(L),F=t.apply(M,I),q=R==null?j(F):typeof R=="function"?R.apply(M,I):R,H=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),V=M.__zoom,Z=typeof P=="function"?P.apply(M,I):P,B=c(V.invert(q).concat(H/V.k),Z.invert(q).concat(H/Z.k));return function(re){if(re===1)re=Z;else{var oe=B(re),X=H/oe[2];re=new on(X,q[0]-oe[0]*X,q[1]-oe[1]*X)}O.zoom(null,re)}})}function N(E,P,R){return!R&&E.__zooming||new S(E,P)}function S(E,P){this.that=E,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(E,P),this.taps=0}S.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,P){return this.mouse&&E!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var P=pr(this.that).datum();d.call(E,this.that,new gO(E,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:d}),P)}};function C(E,...P){if(!e.apply(this,arguments))return;var R=N(this,P).event(E),L=this.__zoom,M=Math.max(o[0],Math.min(o[1],L.k*Math.pow(2,n.apply(this,arguments)))),I=Cr(E);if(R.wheel)(R.mouse[0][0]!==I[0]||R.mouse[0][1]!==I[1])&&(R.mouse[1]=L.invert(R.mouse[0]=I)),clearTimeout(R.wheel);else{if(L.k===M)return;R.mouse=[I,L.invert(I)],Pl(this),R.start()}Jo(E),R.wheel=setTimeout(O,v),R.zoom("mouse",r(b(y(L,M),R.mouse[0],R.mouse[1]),R.extent,a));function O(){R.wheel=null,R.end()}}function w(E,...P){if(p||!e.apply(this,arguments))return;var R=E.currentTarget,L=N(this,P,!0).event(E),M=pr(E.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",H,!0),I=Cr(E,R),O=E.clientX,F=E.clientY;kC(E.view),ud(E),L.mouse=[I,this.__zoom.invert(I)],Pl(this),L.start();function q(V){if(Jo(V),!L.moved){var Z=V.clientX-O,B=V.clientY-F;L.moved=Z*Z+B*B>g}L.event(V).zoom("mouse",r(b(L.that.__zoom,L.mouse[0]=Cr(V,R),L.mouse[1]),L.extent,a))}function H(V){M.on("mousemove.zoom mouseup.zoom",null),NC(V.view,L.moved),Jo(V),L.event(V).end()}}function A(E,...P){if(e.apply(this,arguments)){var R=this.__zoom,L=Cr(E.changedTouches?E.changedTouches[0]:E,this),M=R.invert(L),I=R.k*(E.shiftKey?.5:2),O=r(b(y(R,I),L,M),t.apply(this,P),a);Jo(E),l>0?pr(this).transition().duration(l).call(k,O,L,E):pr(this).call(x.transform,O,L,E)}}function T(E,...P){if(e.apply(this,arguments)){var R=E.touches,L=R.length,M=N(this,P,E.changedTouches.length===L).event(E),I,O,F,q;for(ud(E),O=0;O<L;++O)F=R[O],q=Cr(F,this),q=[q,this.__zoom.invert(q),F.identifier],M.touch0?!M.touch1&&M.touch0[2]!==q[2]&&(M.touch1=q,M.taps=0):(M.touch0=q,I=!0,M.taps=1+!!u);u&&(u=clearTimeout(u)),I&&(M.taps<2&&(f=q[0],u=setTimeout(function(){u=null},h)),Pl(this),M.start())}}function D(E,...P){if(this.__zooming){var R=N(this,P).event(E),L=E.changedTouches,M=L.length,I,O,F,q;for(Jo(E),I=0;I<M;++I)O=L[I],F=Cr(O,this),R.touch0&&R.touch0[2]===O.identifier?R.touch0[0]=F:R.touch1&&R.touch1[2]===O.identifier&&(R.touch1[0]=F);if(O=R.that.__zoom,R.touch1){var H=R.touch0[0],V=R.touch0[1],Z=R.touch1[0],B=R.touch1[1],re=(re=Z[0]-H[0])*re+(re=Z[1]-H[1])*re,oe=(oe=B[0]-V[0])*oe+(oe=B[1]-V[1])*oe;O=y(O,Math.sqrt(re/oe)),F=[(H[0]+Z[0])/2,(H[1]+Z[1])/2],q=[(V[0]+B[0])/2,(V[1]+B[1])/2]}else if(R.touch0)F=R.touch0[0],q=R.touch0[1];else return;R.zoom("touch",r(b(O,F,q),R.extent,a))}}function $(E,...P){if(this.__zooming){var R=N(this,P).event(E),L=E.changedTouches,M=L.length,I,O;for(ud(E),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),I=0;I<M;++I)O=L[I],R.touch0&&R.touch0[2]===O.identifier?delete R.touch0:R.touch1&&R.touch1[2]===O.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&(O=Cr(O,this),Math.hypot(f[0]-O[0],f[1]-O[1])<_)){var F=pr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return x.wheelDelta=function(E){return arguments.length?(n=typeof E=="function"?E:el(+E),x):n},x.filter=function(E){return arguments.length?(e=typeof E=="function"?E:el(!!E),x):e},x.touchable=function(E){return arguments.length?(s=typeof E=="function"?E:el(!!E),x):s},x.extent=function(E){return arguments.length?(t=typeof E=="function"?E:el([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),x):t},x.scaleExtent=function(E){return arguments.length?(o[0]=+E[0],o[1]=+E[1],x):[o[0],o[1]]},x.translateExtent=function(E){return arguments.length?(a[0][0]=+E[0][0],a[1][0]=+E[1][0],a[0][1]=+E[0][1],a[1][1]=+E[1][1],x):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},x.constrain=function(E){return arguments.length?(r=E,x):r},x.duration=function(E){return arguments.length?(l=+E,x):l},x.interpolate=function(E){return arguments.length?(c=E,x):c},x.on=function(){var E=d.on.apply(d,arguments);return E===d?x:E},x.clickDistance=function(E){return arguments.length?(g=(E=+E)*E,x):Math.sqrt(g)},x.tapDistance=function(E){return arguments.length?(_=+E,x):_},x}const Jc=m.createContext(null),wO=Jc.Provider,gn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},qC=gn.error001();function Je(e,t){const r=m.useContext(Jc);if(r===null)throw new Error(qC);return fC(r,e,t)}const wt=()=>{const e=m.useContext(Jc);if(e===null)throw new Error(qC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},jO=e=>e.userSelectionActive?"none":"all";function Un({position:e,children:t,className:r,style:n,...s}){const o=Je(jO),a=`${e}`.split("-");return Y.createElement("div",{className:Qt(["react-flow__panel",r,...a]),style:{...n,pointerEvents:o},...s},t)}function SO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:Y.createElement(Un,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},Y.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const kO=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:s=!0,labelBgStyle:o={},labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),v=Qt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();h({x:g.x,y:g.y,width:g.width,height:g.height})}},[r]),typeof r>"u"||!r?null:Y.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:v,visibility:p.width?"visible":"hidden",...u},s&&Y.createElement("rect",{width:p.width+2*a[0],x:-a[0],y:-a[1],height:p.height+2*a[1],className:"react-flow__edge-textbg",style:o,rx:l,ry:l}),Y.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var NO=m.memo(kO);const ry=e=>({width:e.offsetWidth,height:e.offsetHeight}),To=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),ny=(e={x:0,y:0},t)=>({x:To(e.x,t[0][0],t[1][0]),y:To(e.y,t[0][1],t[1][1])}),Nb=(e,t,r)=>e<t?To(Math.abs(e-t),1,50)/50:e>r?-To(Math.abs(e-r),1,50)/50:0,BC=(e,t)=>{const r=Nb(e.x,35,t.width-35)*20,n=Nb(e.y,35,t.height-35)*20;return[r,n]},WC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},HC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),na=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),UC=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),Cb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),CO=(e,t)=>UC(HC(na(e),na(t))),Px=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},EO=e=>mr(e.width)&&mr(e.height)&&mr(e.x)&&mr(e.y),mr=e=>!isNaN(e)&&isFinite(e),it=Symbol.for("internals"),VC=["Enter"," ","Escape"],TO=(e,t)=>{},RO=e=>"nativeEvent"in e;function Ox(e){var s,o;const t=RO(e)?e.nativeEvent:e,r=((o=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:o[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const GC=e=>"clientX"in e,Vn=(e,t)=>{var o,a;const r=GC(e),n=r?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,s=r?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},dc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},_a=({id:e,path:t,labelX:r,labelY:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>Y.createElement(Y.Fragment,null,Y.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&Y.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&mr(r)&&mr(n)?Y.createElement(NO,{x:r,y:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);_a.displayName="BaseEdge";function ei(e,t,r){return r===void 0?r:n=>{const s=t().edges.find(o=>o.id===e);s&&r(n,{...s})}}function KC({sourceX:e,sourceY:t,targetX:r,targetY:n}){const s=Math.abs(r-e)/2,o=r<e?r+s:r-s,a=Math.abs(n-t)/2,l=n<t?n+a:n-a;return[o,l,s,a]}function YC({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:s,sourceControlY:o,targetControlX:a,targetControlY:l}){const c=e*.125+s*.375+a*.375+r*.125,d=t*.125+o*.375+l*.375+n*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Cs;(function(e){e.Strict="strict",e.Loose="loose"})(Cs||(Cs={}));var hs;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(hs||(hs={}));var sa;(function(e){e.Partial="partial",e.Full="full"})(sa||(sa={}));var In;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(In||(In={}));var fc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(fc||(fc={}));var ce;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ce||(ce={}));function Eb({pos:e,x1:t,y1:r,x2:n,y2:s}){return e===ce.Left||e===ce.Right?[.5*(t+n),r]:[t,.5*(r+s)]}function XC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:o=ce.Top}){const[a,l]=Eb({pos:r,x1:e,y1:t,x2:n,y2:s}),[c,d]=Eb({pos:o,x1:n,y1:s,x2:e,y2:t}),[u,f,p,h]=YC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${n},${s}`,u,f,p,h]}const sy=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=ce.Bottom,targetPosition:o=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:g})=>{const[_,x,y]=XC({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o});return Y.createElement(_a,{path:_,labelX:x,labelY:y,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:g})});sy.displayName="SimpleBezierEdge";const Tb={[ce.Left]:{x:-1,y:0},[ce.Right]:{x:1,y:0},[ce.Top]:{x:0,y:-1},[ce.Bottom]:{x:0,y:1}},AO=({source:e,sourcePosition:t=ce.Bottom,target:r})=>t===ce.Left||t===ce.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Rb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function IO({source:e,sourcePosition:t=ce.Bottom,target:r,targetPosition:n=ce.Top,center:s,offset:o}){const a=Tb[t],l=Tb[n],c={x:e.x+a.x*o,y:e.y+a.y*o},d={x:r.x+l.x*o,y:r.y+l.y*o},u=AO({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],v,g;const _={x:0,y:0},x={x:0,y:0},[y,b,j,k]=KC({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(a[f]*l[f]===-1){v=s.x??y,g=s.y??b;const S=[{x:v,y:c.y},{x:v,y:d.y}],C=[{x:c.x,y:g},{x:d.x,y:g}];a[f]===p?h=f==="x"?S:C:h=f==="x"?C:S}else{const S=[{x:c.x,y:d.y}],C=[{x:d.x,y:c.y}];if(f==="x"?h=a.x===p?C:S:h=a.y===p?S:C,t===n){const $=Math.abs(e[f]-r[f]);if($<=o){const E=Math.min(o-1,o-$);a[f]===p?_[f]=(c[f]>e[f]?-1:1)*E:x[f]=(d[f]>r[f]?-1:1)*E}}if(t!==n){const $=f==="x"?"y":"x",E=a[f]===l[$],P=c[$]>d[$],R=c[$]<d[$];(a[f]===1&&(!E&&P||E&&R)||a[f]!==1&&(!E&&R||E&&P))&&(h=f==="x"?S:C)}const w={x:c.x+_.x,y:c.y+_.y},A={x:d.x+x.x,y:d.y+x.y},T=Math.max(Math.abs(w.x-h[0].x),Math.abs(A.x-h[0].x)),D=Math.max(Math.abs(w.y-h[0].y),Math.abs(A.y-h[0].y));T>=D?(v=(w.x+A.x)/2,g=h[0].y):(v=h[0].x,g=(w.y+A.y)/2)}return[[e,{x:c.x+_.x,y:c.y+_.y},...h,{x:d.x+x.x,y:d.y+x.y},r],v,g,j,k]}function PO(e,t,r,n){const s=Math.min(Rb(e,t)/2,Rb(t,r)/2,n),{x:o,y:a}=t;if(e.x===o&&o===r.x||e.y===a&&a===r.y)return`L${o} ${a}`;if(e.y===a){const d=e.x<r.x?-1:1,u=e.y<r.y?1:-1;return`L ${o+s*d},${a}Q ${o},${a} ${o},${a+s*u}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${a+s*c}Q ${o},${a} ${o+s*l},${a}`}function Mx({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:o=ce.Top,borderRadius:a=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,v]=IO({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:s},targetPosition:o,center:{x:l,y:c},offset:d});return[u.reduce((_,x,y)=>{let b="";return y>0&&y<u.length-1?b=PO(u[y-1],x,u[y+1],a):b=`${y===0?"M":"L"}${x.x} ${x.y}`,_+=b,_},""),f,p,h,v]}const eu=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=ce.Bottom,targetPosition:p=ce.Top,markerEnd:h,markerStart:v,pathOptions:g,interactionWidth:_})=>{const[x,y,b]=Mx({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return Y.createElement(_a,{path:x,labelX:y,labelY:b,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:v,interactionWidth:_})});eu.displayName="SmoothStepEdge";const oy=m.memo(e=>{var t;return Y.createElement(eu,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});oy.displayName="StepEdge";function OO({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[s,o,a,l]=KC({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,s,o,a,l]}const iy=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[v,g,_]=OO({sourceX:e,sourceY:t,targetX:r,targetY:n});return Y.createElement(_a,{path:v,labelX:g,labelY:_,label:s,labelStyle:o,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});iy.displayName="StraightEdge";function tl(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ab({pos:e,x1:t,y1:r,x2:n,y2:s,c:o}){switch(e){case ce.Left:return[t-tl(t-n,o),r];case ce.Right:return[t+tl(n-t,o),r];case ce.Top:return[t,r-tl(r-s,o)];case ce.Bottom:return[t,r+tl(s-r,o)]}}function QC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:o=ce.Top,curvature:a=.25}){const[l,c]=Ab({pos:r,x1:e,y1:t,x2:n,y2:s,c:a}),[d,u]=Ab({pos:o,x1:n,y1:s,x2:e,y2:t,c:a}),[f,p,h,v]=YC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${n},${s}`,f,p,h,v]}const pc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=ce.Bottom,targetPosition:o=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,pathOptions:g,interactionWidth:_})=>{const[x,y,b]=QC({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o,curvature:g==null?void 0:g.curvature});return Y.createElement(_a,{path:x,labelX:y,labelY:b,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:_})});pc.displayName="BezierEdge";const ay=m.createContext(null),MO=ay.Provider;ay.Consumer;const DO=()=>m.useContext(ay),LO=e=>"id"in e&&"source"in e&&"target"in e,zO=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Dx=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,FO=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),$O=(e,t)=>{if(!e.source||!e.target)return t;let r;return LO(e)?r={...e}:r={...e,id:zO(e)},FO(r,t)?t:t.concat(r)},Lx=({x:e,y:t},[r,n,s],o,[a,l])=>{const c={x:(e-r)/s,y:(t-n)/s};return o?{x:a*Math.round(c.x/a),y:l*Math.round(c.y/l)}:c},ZC=({x:e,y:t},[r,n,s])=>({x:e*s+r,y:t*s+n}),ys=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-n};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:s}},tu=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,s)=>{const{x:o,y:a}=ys(s,t).positionAbsolute;return HC(n,na({x:o,y:a,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return UC(r)},JC=(e,t,[r,n,s]=[0,0,1],o=!1,a=!1,l=[0,0])=>{const c={x:(t.x-r)/s,y:(t.y-n)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:v=!1}=u;if(a&&!h||v)return!1;const{positionAbsolute:g}=ys(u,l),_={x:g.x,y:g.y,width:f||0,height:p||0},x=Px(c,_),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=o&&x>0,j=(f||0)*(p||0);(y||b||x>=j||u.dragging)&&d.push(u)}),d},eE=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},tE=(e,t,r,n,s,o=.1)=>{const a=t/(e.width*(1+o)),l=r/(e.height*(1+o)),c=Math.min(a,l),d=To(c,n,s),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=r/2-f*d;return{x:p,y:h,zoom:d}},cs=(e,t=0)=>e.transition().duration(t);function Ib(e,t,r,n){return(t[r]||[]).reduce((s,o)=>{var a,l;return`${e.id}-${o.id}-${r}`!==n&&s.push({id:o.id||null,type:r,nodeId:e.id,x:(((a=e.positionAbsolute)==null?void 0:a.x)??0)+o.x+o.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+o.y+o.height/2}),s},[])}function qO(e,t,r,n,s,o){const{x:a,y:l}=Vn(e),d=t.elementsFromPoint(a,l).find(v=>v.classList.contains("react-flow__handle"));if(d){const v=d.getAttribute("data-nodeid");if(v){const g=ly(void 0,d),_=d.getAttribute("data-handleid"),x=o({nodeId:v,id:_,type:g});if(x){const y=s.find(b=>b.nodeId===v&&b.type===g&&b.id===_);return{handle:{id:_,type:g,nodeId:v,x:(y==null?void 0:y.x)||r.x,y:(y==null?void 0:y.y)||r.y},validHandleResult:x}}}}let u=[],f=1/0;if(s.forEach(v=>{const g=Math.sqrt((v.x-r.x)**2+(v.y-r.y)**2);if(g<=n){const _=o(v);g<=f&&(g<f?u=[{handle:v,validHandleResult:_}]:g===f&&u.push({handle:v,validHandleResult:_}),f=g)}}),!u.length)return{handle:null,validHandleResult:rE()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:v})=>v.isValid),h=u.some(({handle:v})=>v.type==="target");return u.find(({handle:v,validHandleResult:g})=>h?v.type==="target":p?g.isValid:!0)||u[0]}const BO={source:null,target:null,sourceHandle:null,targetHandle:null},rE=()=>({handleDomNode:null,isValid:!1,connection:BO,endHandle:null});function nE(e,t,r,n,s,o,a){const l=s==="target",c=a.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...rE(),handleDomNode:c};if(c){const u=ly(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),v=c.classList.contains("connectableend"),g={source:l?f:r,sourceHandle:l?p:n,target:l?r:f,targetHandle:l?n:p};d.connection=g,h&&v&&(t===Cs.Strict?l&&u==="source"||!l&&u==="target":f!==r||p!==n)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=o(g))}return d}function WO({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((s,o)=>{if(o[it]){const{handleBounds:a}=o[it];let l=[],c=[];a&&(l=Ib(o,a,"source",`${t}-${r}-${n}`),c=Ib(o,a,"target",`${t}-${r}-${n}`)),s.push(...l,...c)}return s},[])}function ly(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function dd(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function HO(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function sE({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:s,getState:o,setState:a,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=WC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:v,onConnectStart:g,panBy:_,getNodes:x,cancelConnection:y}=o();let b=0,j;const{x:k,y:N}=Vn(e),S=u==null?void 0:u.elementFromPoint(k,N),C=ly(c,S),w=p==null?void 0:p.getBoundingClientRect();if(!w||!C)return;let A,T=Vn(e,w),D=!1,$=null,E=!1,P=null;const R=WO({nodes:x(),nodeId:r,handleId:t,handleType:C}),L=()=>{if(!h)return;const[O,F]=BC(T,w);_({x:O,y:F}),b=requestAnimationFrame(L)};a({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:C,connectionStartHandle:{nodeId:r,handleId:t,type:C},connectionEndHandle:null}),g==null||g(e,{nodeId:r,handleId:t,handleType:C});function M(O){const{transform:F}=o();T=Vn(O,w);const{handle:q,validHandleResult:H}=qO(O,u,Lx(T,F,!1,[1,1]),v,R,V=>nE(V,f,r,t,s?"target":"source",l,u));if(j=q,D||(L(),D=!0),P=H.handleDomNode,$=H.connection,E=H.isValid,a({connectionPosition:j&&E?ZC({x:j.x,y:j.y},F):T,connectionStatus:HO(!!j,E),connectionEndHandle:H.endHandle}),!j&&!E&&!P)return dd(A);$.source!==$.target&&P&&(dd(A),A=P,P.classList.add("connecting","react-flow__handle-connecting"),P.classList.toggle("valid",E),P.classList.toggle("react-flow__handle-valid",E))}function I(O){var F,q;(j||P)&&$&&E&&(n==null||n($)),(q=(F=o()).onConnectEnd)==null||q.call(F,O),c&&(d==null||d(O)),dd(A),y(),cancelAnimationFrame(b),D=!1,E=!1,$=null,P=null,u.removeEventListener("mousemove",M),u.removeEventListener("mouseup",I),u.removeEventListener("touchmove",M),u.removeEventListener("touchend",I)}u.addEventListener("mousemove",M),u.addEventListener("mouseup",I),u.addEventListener("touchmove",M),u.addEventListener("touchend",I)}const Pb=()=>!0,UO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),VO=(e,t,r)=>n=>{const{connectionStartHandle:s,connectionEndHandle:o,connectionClickStartHandle:a}=n;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.handleId)===t&&(a==null?void 0:a.type)===r}},oE=m.forwardRef(({type:e="source",position:t=ce.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:o=!0,id:a,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var w,A;const v=a||null,g=e==="target",_=wt(),x=DO(),{connectOnClick:y,noPanClassName:b}=Je(UO,Ot),{connecting:j,clickConnecting:k}=Je(VO(x,v,e),Ot);x||(A=(w=_.getState()).onError)==null||A.call(w,"010",gn.error010());const N=T=>{const{defaultEdgeOptions:D,onConnect:$,hasDefaultEdges:E}=_.getState(),P={...D,...T};if(E){const{edges:R,setEdges:L}=_.getState();L($O(P,R))}$==null||$(P),l==null||l(P)},S=T=>{if(!x)return;const D=GC(T);s&&(D&&T.button===0||!D)&&sE({event:T,handleId:v,nodeId:x,onConnect:N,isTarget:g,getState:_.getState,setState:_.setState,isValidConnection:r||_.getState().isValidConnection||Pb}),D?u==null||u(T):f==null||f(T)},C=T=>{const{onClickConnectStart:D,onClickConnectEnd:$,connectionClickStartHandle:E,connectionMode:P,isValidConnection:R}=_.getState();if(!x||!E&&!s)return;if(!E){D==null||D(T,{nodeId:x,handleId:v,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:x,type:e,handleId:v}});return}const L=WC(T.target),M=r||R||Pb,{connection:I,isValid:O}=nE({nodeId:x,id:v,type:e},P,E.nodeId,E.handleId||null,E.type,M,L);O&&N(I),$==null||$(T),_.setState({connectionClickStartHandle:null})};return Y.createElement("div",{"data-handleid":v,"data-nodeid":x,"data-handlepos":t,"data-id":`${x}-${v}-${e}`,className:Qt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!g,target:g,connectable:n,connectablestart:s,connectableend:o,connecting:k,connectionindicator:n&&(s&&!j||o&&j)}]),onMouseDown:S,onTouchStart:S,onClick:y?C:void 0,ref:h,...p},c)});oE.displayName="Handle";var yr=m.memo(oE);const iE=({data:e,isConnectable:t,targetPosition:r=ce.Top,sourcePosition:n=ce.Bottom})=>Y.createElement(Y.Fragment,null,Y.createElement(yr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,Y.createElement(yr,{type:"source",position:n,isConnectable:t}));iE.displayName="DefaultNode";var zx=m.memo(iE);const aE=({data:e,isConnectable:t,sourcePosition:r=ce.Bottom})=>Y.createElement(Y.Fragment,null,e==null?void 0:e.label,Y.createElement(yr,{type:"source",position:r,isConnectable:t}));aE.displayName="InputNode";var lE=m.memo(aE);const cE=({data:e,isConnectable:t,targetPosition:r=ce.Top})=>Y.createElement(Y.Fragment,null,Y.createElement(yr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);cE.displayName="OutputNode";var uE=m.memo(cE);const cy=()=>null;cy.displayName="GroupNode";const GO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),rl=e=>e.id;function KO(e,t){return Ot(e.selectedNodes.map(rl),t.selectedNodes.map(rl))&&Ot(e.selectedEdges.map(rl),t.selectedEdges.map(rl))}const dE=m.memo(({onSelectionChange:e})=>{const t=wt(),{selectedNodes:r,selectedEdges:n}=Je(GO,KO);return m.useEffect(()=>{const s={nodes:r,edges:n};e==null||e(s),t.getState().onSelectionChange.forEach(o=>o(s))},[r,n,e]),null});dE.displayName="SelectionListener";const YO=e=>!!e.onSelectionChange;function XO({onSelectionChange:e}){const t=Je(YO);return e||t?Y.createElement(dE,{onSelectionChange:e}):null}const QO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Ls(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Re(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const ZO=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:s,onConnectStart:o,onConnectEnd:a,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:v,minZoom:g,maxZoom:_,nodeExtent:x,onNodesChange:y,onEdgesChange:b,elementsSelectable:j,connectionMode:k,snapGrid:N,snapToGrid:S,translateExtent:C,connectOnClick:w,defaultEdgeOptions:A,fitView:T,fitViewOptions:D,onNodesDelete:$,onEdgesDelete:E,onNodeDrag:P,onNodeDragStart:R,onNodeDragStop:L,onSelectionDrag:M,onSelectionDragStart:I,onSelectionDragStop:O,noPanClassName:F,nodeOrigin:q,rfId:H,autoPanOnConnect:V,autoPanOnNodeDrag:Z,onError:B,connectionRadius:re,isValidConnection:oe,nodeDragThreshold:X})=>{const{setNodes:Q,setEdges:fe,setDefaultNodesAndEdges:ge,setMinZoom:be,setMaxZoom:ye,setTranslateExtent:ae,setNodeExtent:K,reset:te}=Je(QO,Ot),ee=wt();return m.useEffect(()=>{const ke=n==null?void 0:n.map(je=>({...je,...A}));return ge(r,ke),()=>{te()}},[]),Re("defaultEdgeOptions",A,ee.setState),Re("connectionMode",k,ee.setState),Re("onConnect",s,ee.setState),Re("onConnectStart",o,ee.setState),Re("onConnectEnd",a,ee.setState),Re("onClickConnectStart",l,ee.setState),Re("onClickConnectEnd",c,ee.setState),Re("nodesDraggable",d,ee.setState),Re("nodesConnectable",u,ee.setState),Re("nodesFocusable",f,ee.setState),Re("edgesFocusable",p,ee.setState),Re("edgesUpdatable",h,ee.setState),Re("elementsSelectable",j,ee.setState),Re("elevateNodesOnSelect",v,ee.setState),Re("snapToGrid",S,ee.setState),Re("snapGrid",N,ee.setState),Re("onNodesChange",y,ee.setState),Re("onEdgesChange",b,ee.setState),Re("connectOnClick",w,ee.setState),Re("fitViewOnInit",T,ee.setState),Re("fitViewOnInitOptions",D,ee.setState),Re("onNodesDelete",$,ee.setState),Re("onEdgesDelete",E,ee.setState),Re("onNodeDrag",P,ee.setState),Re("onNodeDragStart",R,ee.setState),Re("onNodeDragStop",L,ee.setState),Re("onSelectionDrag",M,ee.setState),Re("onSelectionDragStart",I,ee.setState),Re("onSelectionDragStop",O,ee.setState),Re("noPanClassName",F,ee.setState),Re("nodeOrigin",q,ee.setState),Re("rfId",H,ee.setState),Re("autoPanOnConnect",V,ee.setState),Re("autoPanOnNodeDrag",Z,ee.setState),Re("onError",B,ee.setState),Re("connectionRadius",re,ee.setState),Re("isValidConnection",oe,ee.setState),Re("nodeDragThreshold",X,ee.setState),Ls(e,Q),Ls(t,fe),Ls(g,be),Ls(_,ye),Ls(C,ae),Ls(x,K),null},Ob={display:"none"},JO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},fE="react-flow__node-desc",pE="react-flow__edge-desc",eM="react-flow__aria-live",tM=e=>e.ariaLiveMessage;function rM({rfId:e}){const t=Je(tM);return Y.createElement("div",{id:`${eM}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:JO},t)}function nM({rfId:e,disableKeyboardA11y:t}){return Y.createElement(Y.Fragment,null,Y.createElement("div",{id:`${fE}-${e}`,style:Ob},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),Y.createElement("div",{id:`${pE}-${e}`,style:Ob},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&Y.createElement(rM,{rfId:e}))}var oa=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),s=m.useRef(!1),o=m.useRef(new Set([])),[a,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Ox(h))return!1;const g=Db(h.code,l);o.current.add(h[g]),Mb(a,o.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Ox(h))return!1;const g=Db(h.code,l);Mb(a,o.current,!0)?(n(!1),o.current.clear()):o.current.delete(h[g]),h.key==="Meta"&&o.current.clear(),s.current=!1},p=()=>{o.current.clear(),n(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function Mb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(s=>t.has(s)))}function Db(e,t){return t.includes(e)?"code":"key"}function hE(e,t,r,n){var l,c;const s=e.parentNode||e.parentId;if(!s)return r;const o=t.get(s),a=ys(o,n);return hE(o,t,{x:(r.x??0)+a.x,y:(r.y??0)+a.y,z:(((l=o[it])==null?void 0:l.z)??0)>(r.z??0)?((c=o[it])==null?void 0:c.z)??0:r.z??0},n)}function mE(e,t,r){e.forEach(n=>{var o;const s=n.parentNode||n.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[n.id]){const{x:a,y:l,z:c}=hE(n,e,{...n.position,z:((o=n[it])==null?void 0:o.z)??0},t);n.positionAbsolute={x:a,y:l},n[it].z=c,r!=null&&r[n.id]&&(n[it].isParent=!0)}})}function fd(e,t,r,n){const s=new Map,o={},a=n?1e3:0;return e.forEach(l=>{var h;const c=(mr(l.zIndex)?l.zIndex:0)+(l.selected?a:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(o[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,it,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[it])==null?void 0:h.handleBounds,z:c}}),s.set(l.id,u)}),mE(s,r,o),s}function gE(e,t={}){const{getNodes:r,width:n,height:s,minZoom:o,maxZoom:a,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const v=r().filter(_=>{var y;const x=t.includeHiddenNodes?_.width&&_.height:!_.hidden;return(y=t.nodes)!=null&&y.length?x&&t.nodes.some(b=>b.id===_.id):x}),g=v.every(_=>_.width&&_.height);if(v.length>0&&g){const _=tu(v,f),{x,y,zoom:b}=tE(_,n,s,t.minZoom??o,t.maxZoom??a,t.padding??.1),j=un.translate(x,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(cs(c,t.duration),j):l.transform(c,j),!0}}return!1}function sM(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[it]:n[it],selected:r.selected})}),new Map(t)}function oM(e,t){return t.map(r=>{const n=e.find(s=>s.id===r.id);return n&&(r.selected=n.selected),r})}function nl({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:s,edges:o,onNodesChange:a,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=r();e!=null&&e.length&&(c&&n({nodeInternals:sM(e,s)}),a==null||a(e)),t!=null&&t.length&&(d&&n({edges:oM(t,o)}),l==null||l(t))}const zs=()=>{},iM={zoomIn:zs,zoomOut:zs,zoomTo:zs,getZoom:()=>1,setViewport:zs,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:zs,fitBounds:zs,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},aM=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),lM=()=>{const e=wt(),{d3Zoom:t,d3Selection:r}=Je(aM,Ot);return m.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(cs(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(cs(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,o)=>t.scaleTo(cs(r,o==null?void 0:o.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,o)=>{const[a,l,c]=e.getState().transform,d=un.translate(s.x??a,s.y??l).scale(s.zoom??c);t.transform(cs(r,o==null?void 0:o.duration),d)},getViewport:()=>{const[s,o,a]=e.getState().transform;return{x:s,y:o,zoom:a}},fitView:s=>gE(e.getState,s),setCenter:(s,o,a)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(a==null?void 0:a.zoom)<"u"?a.zoom:d,f=l/2-s*u,p=c/2-o*u,h=un.translate(f,p).scale(u);t.transform(cs(r,a==null?void 0:a.duration),h)},fitBounds:(s,o)=>{const{width:a,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=tE(s,a,l,c,d,(o==null?void 0:o.padding)??.1),h=un.translate(u,f).scale(p);t.transform(cs(r,o==null?void 0:o.duration),h)},project:s=>{const{transform:o,snapToGrid:a,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Lx(s,o,a,l)},screenToFlowPosition:s=>{const{transform:o,snapToGrid:a,snapGrid:l,domNode:c}=e.getState();if(!c)return s;const{x:d,y:u}=c.getBoundingClientRect(),f={x:s.x-d,y:s.y-u};return Lx(f,o,a,l)},flowToScreenPosition:s=>{const{transform:o,domNode:a}=e.getState();if(!a)return s;const{x:l,y:c}=a.getBoundingClientRect(),d=ZC(s,o);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:iM,[t,r])};function ru(){const e=lM(),t=wt(),r=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),n=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(_=>({..._}))},[]),o=m.useCallback(g=>{const{edges:_=[]}=t.getState();return _.find(x=>x.id===g)},[]),a=m.useCallback(g=>{const{getNodes:_,setNodes:x,hasDefaultNodes:y,onNodesChange:b}=t.getState(),j=_(),k=typeof g=="function"?g(j):g;if(y)x(k);else if(b){const N=k.length===0?j.map(S=>({type:"remove",id:S.id})):k.map(S=>({item:S,type:"reset"}));b(N)}},[]),l=m.useCallback(g=>{const{edges:_=[],setEdges:x,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),j=typeof g=="function"?g(_):g;if(y)x(j);else if(b){const k=j.length===0?_.map(N=>({type:"remove",id:N.id})):j.map(N=>({item:N,type:"reset"}));b(k)}},[]),c=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{getNodes:x,setNodes:y,hasDefaultNodes:b,onNodesChange:j}=t.getState();if(b){const N=[...x(),..._];y(N)}else if(j){const k=_.map(N=>({item:N,type:"add"}));j(k)}},[]),d=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{edges:x=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:j}=t.getState();if(b)y([...x,..._]);else if(j){const k=_.map(N=>({item:N,type:"add"}));j(k)}},[]),u=m.useCallback(()=>{const{getNodes:g,edges:_=[],transform:x}=t.getState(),[y,b,j]=x;return{nodes:g().map(k=>({...k})),edges:_.map(k=>({...k})),viewport:{x:y,y:b,zoom:j}}},[]),f=m.useCallback(({nodes:g,edges:_})=>{const{nodeInternals:x,getNodes:y,edges:b,hasDefaultNodes:j,hasDefaultEdges:k,onNodesDelete:N,onEdgesDelete:S,onNodesChange:C,onEdgesChange:w}=t.getState(),A=(g||[]).map(P=>P.id),T=(_||[]).map(P=>P.id),D=y().reduce((P,R)=>{const L=R.parentNode||R.parentId,M=!A.includes(R.id)&&L&&P.find(O=>O.id===L);return(typeof R.deletable=="boolean"?R.deletable:!0)&&(A.includes(R.id)||M)&&P.push(R),P},[]),$=b.filter(P=>typeof P.deletable=="boolean"?P.deletable:!0),E=$.filter(P=>T.includes(P.id));if(D||E){const P=eE(D,$),R=[...E,...P],L=R.reduce((M,I)=>(M.includes(I.id)||M.push(I.id),M),[]);if((k||j)&&(k&&t.setState({edges:b.filter(M=>!L.includes(M.id))}),j&&(D.forEach(M=>{x.delete(M.id)}),t.setState({nodeInternals:new Map(x)}))),L.length>0&&(S==null||S(R),w&&w(L.map(M=>({id:M,type:"remove"})))),D.length>0&&(N==null||N(D),C)){const M=D.map(I=>({id:I.id,type:"remove"}));C(M)}}},[]),p=m.useCallback(g=>{const _=EO(g),x=_?null:t.getState().nodeInternals.get(g.id);return!_&&!x?[null,null,_]:[_?g:Cb(x),x,_]},[]),h=m.useCallback((g,_=!0,x)=>{const[y,b,j]=p(g);return y?(x||t.getState().getNodes()).filter(k=>{if(!j&&(k.id===b.id||!k.positionAbsolute))return!1;const N=Cb(k),S=Px(N,y);return _&&S>0||S>=y.width*y.height}):[]},[]),v=m.useCallback((g,_,x=!0)=>{const[y]=p(g);if(!y)return!1;const b=Px(y,_);return x&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:s,getEdge:o,setNodes:a,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:v}),[e,r,n,s,o,a,l,c,d,u,f,h,v])}const cM={actInsideInputWithModifier:!1};var uM=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=wt(),{deleteElements:n}=ru(),s=oa(e,cM),o=oa(t);m.useEffect(()=>{if(s){const{edges:a,getNodes:l}=r.getState(),c=l().filter(u=>u.selected),d=a.filter(u=>u.selected);n({nodes:c,edges:d}),r.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])};function dM(e){const t=wt();m.useEffect(()=>{let r;const n=()=>{var o,a;if(!e.current)return;const s=ry(e.current);(s.height===0||s.width===0)&&((a=(o=t.getState()).onError)==null||a.call(o,"004",gn.error004())),t.setState({width:s.width||500,height:s.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const uy={position:"absolute",width:"100%",height:"100%",top:0,left:0},fM=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,sl=e=>({x:e.x,y:e.y,zoom:e.k}),Fs=(e,t)=>e.target.closest(`.${t}`),Lb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),zb=e=>{const t=e.ctrlKey&&dc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},pM=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),hM=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:s=!0,zoomOnPinch:o=!0,panOnScroll:a=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=hs.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:v,maxZoom:g,zoomActivationKeyCode:_,preventScrolling:x=!0,children:y,noWheelClassName:b,noPanClassName:j})=>{const k=m.useRef(),N=wt(),S=m.useRef(!1),C=m.useRef(!1),w=m.useRef(null),A=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:D,d3ZoomHandler:$,userSelectionActive:E}=Je(pM,Ot),P=oa(_),R=m.useRef(0),L=m.useRef(!1),M=m.useRef();return dM(w),m.useEffect(()=>{if(w.current){const I=w.current.getBoundingClientRect(),O=$C().scaleExtent([v,g]).translateExtent(h),F=pr(w.current).call(O),q=un.translate(p.x,p.y).scale(To(p.zoom,v,g)),H=[[0,0],[I.width,I.height]],V=O.constrain()(q,H,h);O.transform(F,V),O.wheelDelta(zb),N.setState({d3Zoom:O,d3Selection:F,d3ZoomHandler:F.on("wheel.zoom"),transform:[V.x,V.y,V.k],domNode:w.current.closest(".react-flow")})}},[]),m.useEffect(()=>{D&&T&&(a&&!P&&!E?D.on("wheel.zoom",I=>{if(Fs(I,b))return!1;I.preventDefault(),I.stopImmediatePropagation();const O=D.property("__zoom").k||1;if(I.ctrlKey&&o){const oe=Cr(I),X=zb(I),Q=O*Math.pow(2,X);T.scaleTo(D,Q,oe,I);return}const F=I.deltaMode===1?20:1;let q=c===hs.Vertical?0:I.deltaX*F,H=c===hs.Horizontal?0:I.deltaY*F;!dc()&&I.shiftKey&&c!==hs.Vertical&&(q=I.deltaY*F,H=0),T.translateBy(D,-(q/O)*l,-(H/O)*l,{internal:!0});const V=sl(D.property("__zoom")),{onViewportChangeStart:Z,onViewportChange:B,onViewportChangeEnd:re}=N.getState();clearTimeout(M.current),L.current||(L.current=!0,t==null||t(I,V),Z==null||Z(V)),L.current&&(e==null||e(I,V),B==null||B(V),M.current=setTimeout(()=>{r==null||r(I,V),re==null||re(V),L.current=!1},150))},{passive:!1}):typeof $<"u"&&D.on("wheel.zoom",function(I,O){if(!x&&I.type==="wheel"&&!I.ctrlKey||Fs(I,b))return null;I.preventDefault(),$.call(this,I,O)},{passive:!1}))},[E,a,c,D,T,$,P,o,x,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",I=>{var q,H;if(!I.sourceEvent||I.sourceEvent.internal)return null;R.current=(q=I.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:O}=N.getState(),F=sl(I.transform);S.current=!0,A.current=F,((H=I.sourceEvent)==null?void 0:H.type)==="mousedown"&&N.setState({paneDragging:!0}),O==null||O(F),t==null||t(I.sourceEvent,F)})},[T,t]),m.useEffect(()=>{T&&(E&&!S.current?T.on("zoom",null):E||T.on("zoom",I=>{var F;const{onViewportChange:O}=N.getState();if(N.setState({transform:[I.transform.x,I.transform.y,I.transform.k]}),C.current=!!(n&&Lb(f,R.current??0)),(e||O)&&!((F=I.sourceEvent)!=null&&F.internal)){const q=sl(I.transform);O==null||O(q),e==null||e(I.sourceEvent,q)}}))},[E,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",I=>{if(!I.sourceEvent||I.sourceEvent.internal)return null;const{onViewportChangeEnd:O}=N.getState();if(S.current=!1,N.setState({paneDragging:!1}),n&&Lb(f,R.current??0)&&!C.current&&n(I.sourceEvent),C.current=!1,(r||O)&&fM(A.current,I.transform)){const F=sl(I.transform);A.current=F,clearTimeout(k.current),k.current=setTimeout(()=>{O==null||O(F),r==null||r(I.sourceEvent,F)},a?150:0)}})},[T,a,f,r,n]),m.useEffect(()=>{T&&T.filter(I=>{const O=P||s,F=o&&I.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&I.button===1&&I.type==="mousedown"&&(Fs(I,"react-flow__node")||Fs(I,"react-flow__edge")))return!0;if(!f&&!O&&!a&&!d&&!o||E||!d&&I.type==="dblclick"||Fs(I,b)&&I.type==="wheel"||Fs(I,j)&&(I.type!=="wheel"||a&&I.type==="wheel"&&!P)||!o&&I.ctrlKey&&I.type==="wheel"||!O&&!a&&!F&&I.type==="wheel"||!f&&(I.type==="mousedown"||I.type==="touchstart")||Array.isArray(f)&&!f.includes(I.button)&&I.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(I.button)||!I.button||I.button<=1;return(!I.ctrlKey||I.type==="wheel")&&q})},[E,T,s,o,a,d,f,u,P]),Y.createElement("div",{className:"react-flow__renderer",ref:w,style:uy},y)},mM=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function gM(){const{userSelectionActive:e,userSelectionRect:t}=Je(mM,Ot);return e&&t?Y.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Fb(e,t){const r=t.parentNode||t.parentId,n=e.find(s=>s.id===r);if(n){const s=t.position.x+t.width-n.width,o=t.position.y+t.height-n.height;if(s>0||o>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,s>0&&(n.style.width+=s),o>0&&(n.style.height+=o),t.position.x<0){const a=Math.abs(t.position.x);n.position.x=n.position.x-a,n.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);n.position.y=n.position.y-a,n.style.height+=a,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function xE(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,s)=>{const o=e.filter(l=>l.id===s.id);if(o.length===0)return n.push(s),n;const a={...s};for(const l of o)if(l)switch(l.type){case"select":{a.selected=l.selected;break}case"position":{typeof l.position<"u"&&(a.position=l.position),typeof l.positionAbsolute<"u"&&(a.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(a.dragging=l.dragging),a.expandParent&&Fb(n,a);break}case"dimensions":{typeof l.dimensions<"u"&&(a.width=l.dimensions.width,a.height=l.dimensions.height),typeof l.updateStyle<"u"&&(a.style={...a.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(a.resizing=l.resizing),a.expandParent&&Fb(n,a);break}case"remove":return n}return n.push(a),n},r)}function vE(e,t){return xE(e,t)}function xM(e,t){return xE(e,t)}const En=(e,t)=>({id:e,type:"select",selected:t});function oo(e,t){return e.reduce((r,n)=>{const s=t.includes(n.id);return!n.selected&&s?(n.selected=!0,r.push(En(n.id,!0))):n.selected&&!s&&(n.selected=!1,r.push(En(n.id,!1))),r},[])}const pd=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},vM=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),yE=m.memo(({isSelecting:e,selectionMode:t=sa.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:s,onPaneClick:o,onPaneContextMenu:a,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=wt(),v=m.useRef(0),g=m.useRef(0),_=m.useRef(),{userSelectionActive:x,elementsSelectable:y,dragging:b}=Je(vM,Ot),j=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,g.current=0},k=$=>{o==null||o($),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},N=$=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){$.preventDefault();return}a==null||a($)},S=l?$=>l($):void 0,C=$=>{const{resetSelectedElements:E,domNode:P}=h.getState();if(_.current=P==null?void 0:P.getBoundingClientRect(),!y||!e||$.button!==0||$.target!==p.current||!_.current)return;const{x:R,y:L}=Vn($,_.current);E(),h.setState({userSelectionRect:{width:0,height:0,startX:R,startY:L,x:R,y:L}}),n==null||n($)},w=$=>{const{userSelectionRect:E,nodeInternals:P,edges:R,transform:L,onNodesChange:M,onEdgesChange:I,nodeOrigin:O,getNodes:F}=h.getState();if(!e||!_.current||!E)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Vn($,_.current),H=E.startX??0,V=E.startY??0,Z={...E,x:q.x<H?q.x:H,y:q.y<V?q.y:V,width:Math.abs(q.x-H),height:Math.abs(q.y-V)},B=F(),re=JC(P,Z,L,t===sa.Partial,!0,O),oe=eE(re,R).map(Q=>Q.id),X=re.map(Q=>Q.id);if(v.current!==X.length){v.current=X.length;const Q=oo(B,X);Q.length&&(M==null||M(Q))}if(g.current!==oe.length){g.current=oe.length;const Q=oo(R,oe);Q.length&&(I==null||I(Q))}h.setState({userSelectionRect:Z})},A=$=>{if($.button!==0)return;const{userSelectionRect:E}=h.getState();!x&&E&&$.target===p.current&&(k==null||k($)),h.setState({nodesSelectionActive:v.current>0}),j(),s==null||s($)},T=$=>{x&&(h.setState({nodesSelectionActive:v.current>0}),s==null||s($)),j()},D=y&&(e||x);return Y.createElement("div",{className:Qt(["react-flow__pane",{dragging:b,selection:e}]),onClick:D?void 0:pd(k,p),onContextMenu:pd(N,p),onWheel:pd(S,p),onMouseEnter:D?void 0:c,onMouseDown:D?C:void 0,onMouseMove:D?w:d,onMouseUp:D?A:void 0,onMouseLeave:D?T:u,ref:p,style:uy},f,Y.createElement(gM,null))});yE.displayName="Pane";function bE(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:bE(n,t):!1}function $b(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function yM(e,t,r,n){return Array.from(e.values()).filter(s=>(s.selected||s.id===n)&&(!s.parentNode||s.parentId||!bE(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var o,a;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((o=s.positionAbsolute)==null?void 0:o.x)??0),y:r.y-(((a=s.positionAbsolute)==null?void 0:a.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function bM(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function _E(e,t,r,n,s=[0,0],o){const a=bM(e,e.extent||n);let l=a;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=ys(f,s).positionAbsolute;l=f&&mr(p)&&mr(h)&&mr(f.width)&&mr(f.height)?[[p+e.width*s[0],h+e.height*s[1]],[p+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:l}else o==null||o("005",gn.error005()),l=a;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=ys(f,s).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=r.get(c);d=ys(f,s).positionAbsolute}const u=l&&l!=="parent"?ny(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function hd({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?n.find(s=>s.id===e):n[0],n]}const qb=(e,t,r,n)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const o=Array.from(s),a=t.getBoundingClientRect(),l={x:a.width*n[0],y:a.height*n[1]};return o.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-a.left-l.x)/r,y:(d.top-a.top-l.y)/r,...ry(c)}})};function ti(e,t,r){return r===void 0?r:n=>{const s=t().nodeInternals.get(e);s&&r(n,{...s})}}function Fx({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:o,multiSelectionActive:a,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",gn.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(r||d.selected&&a)&&(o({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=n==null?void 0:n.current)==null?void 0:u.blur()})):s([e])}function _M(){const e=wt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:s,snapToGrid:o}=e.getState(),a=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(a-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:o?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:o?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function md(e){return(t,r,n)=>e==null?void 0:e(t,n)}function wE({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:o,selectNodesOnDrag:a}){const l=wt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),v=m.useRef({x:0,y:0}),g=m.useRef(null),_=m.useRef(!1),x=m.useRef(!1),y=m.useRef(!1),b=_M();return m.useEffect(()=>{if(e!=null&&e.current){const j=pr(e.current),k=({x:C,y:w})=>{const{nodeInternals:A,onNodeDrag:T,onSelectionDrag:D,updateNodePositions:$,nodeExtent:E,snapGrid:P,snapToGrid:R,nodeOrigin:L,onError:M}=l.getState();f.current={x:C,y:w};let I=!1,O={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&E){const q=tu(u.current,L);O=na(q)}if(u.current=u.current.map(q=>{const H={x:C-q.distance.x,y:w-q.distance.y};R&&(H.x=P[0]*Math.round(H.x/P[0]),H.y=P[1]*Math.round(H.y/P[1]));const V=[[E[0][0],E[0][1]],[E[1][0],E[1][1]]];u.current.length>1&&E&&!q.extent&&(V[0][0]=q.positionAbsolute.x-O.x+E[0][0],V[1][0]=q.positionAbsolute.x+(q.width??0)-O.x2+E[1][0],V[0][1]=q.positionAbsolute.y-O.y+E[0][1],V[1][1]=q.positionAbsolute.y+(q.height??0)-O.y2+E[1][1]);const Z=_E(q,H,A,V,L,M);return I=I||q.position.x!==Z.position.x||q.position.y!==Z.position.y,q.position=Z.position,q.positionAbsolute=Z.positionAbsolute,q}),!I)return;$(u.current,!0,!0),d(!0);const F=s?T:md(D);if(F&&g.current){const[q,H]=hd({nodeId:s,dragItems:u.current,nodeInternals:A});F(g.current,q,H)}},N=()=>{if(!h.current)return;const[C,w]=BC(v.current,h.current);if(C!==0||w!==0){const{transform:A,panBy:T}=l.getState();f.current.x=(f.current.x??0)-C/A[2],f.current.y=(f.current.y??0)-w/A[2],T({x:C,y:w})&&k(f.current)}p.current=requestAnimationFrame(N)},S=C=>{var L;const{nodeInternals:w,multiSelectionActive:A,nodesDraggable:T,unselectNodesAndEdges:D,onNodeDragStart:$,onSelectionDragStart:E}=l.getState();x.current=!0;const P=s?$:md(E);(!a||!o)&&!A&&s&&((L=w.get(s))!=null&&L.selected||D()),s&&o&&a&&Fx({id:s,store:l,nodeRef:e});const R=b(C);if(f.current=R,u.current=yM(w,T,R,s),P&&u.current){const[M,I]=hd({nodeId:s,dragItems:u.current,nodeInternals:w});P(C.sourceEvent,M,I)}};if(t)j.on(".drag",null);else{const C=I6().on("start",w=>{const{domNode:A,nodeDragThreshold:T}=l.getState();T===0&&S(w),y.current=!1;const D=b(w);f.current=D,h.current=(A==null?void 0:A.getBoundingClientRect())||null,v.current=Vn(w.sourceEvent,h.current)}).on("drag",w=>{var $,E;const A=b(w),{autoPanOnNodeDrag:T,nodeDragThreshold:D}=l.getState();if(w.sourceEvent.type==="touchmove"&&w.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!_.current&&x.current&&T&&(_.current=!0,N()),!x.current){const P=A.xSnapped-((($=f==null?void 0:f.current)==null?void 0:$.x)??0),R=A.ySnapped-(((E=f==null?void 0:f.current)==null?void 0:E.y)??0);Math.sqrt(P*P+R*R)>D&&S(w)}(f.current.x!==A.xSnapped||f.current.y!==A.ySnapped)&&u.current&&x.current&&(g.current=w.sourceEvent,v.current=Vn(w.sourceEvent,h.current),k(A))}}).on("end",w=>{if(!(!x.current||y.current)&&(d(!1),_.current=!1,x.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:A,nodeInternals:T,onNodeDragStop:D,onSelectionDragStop:$}=l.getState(),E=s?D:md($);if(A(u.current,!1,!1),E){const[P,R]=hd({nodeId:s,dragItems:u.current,nodeInternals:T});E(w.sourceEvent,P,R)}}}).filter(w=>{const A=w.target;return!w.button&&(!r||!$b(A,`.${r}`,e))&&(!n||$b(A,n,e))});return j.call(C),()=>{j.on(".drag",null)}}}},[e,t,r,n,o,l,s,a,b]),c}function jE(){const e=wt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:s,updateNodePositions:o,getNodes:a,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=a().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,v=r.isShiftPressed?4:1,g=r.x*p*v,_=r.y*h*v,x=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+g,y:y.positionAbsolute.y+_};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:j,position:k}=_E(y,b,n,s,void 0,d);y.position=k,y.positionAbsolute=j}return y});o(x,!0,!1)},[])}const xo={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var ri=e=>{const t=({id:r,type:n,data:s,xPos:o,yPos:a,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:v,onDoubleClick:g,style:_,className:x,isDraggable:y,isSelectable:b,isConnectable:j,isFocusable:k,selectNodesOnDrag:N,sourcePosition:S,targetPosition:C,hidden:w,resizeObserver:A,dragHandle:T,zIndex:D,isParent:$,noDragClassName:E,noPanClassName:P,initialized:R,disableKeyboardA11y:L,ariaLabel:M,rfId:I,hasHandleBounds:O})=>{const F=wt(),q=m.useRef(null),H=m.useRef(null),V=m.useRef(S),Z=m.useRef(C),B=m.useRef(n),re=b||y||u||f||p||h,oe=jE(),X=ti(r,F.getState,f),Q=ti(r,F.getState,p),fe=ti(r,F.getState,h),ge=ti(r,F.getState,v),be=ti(r,F.getState,g),ye=te=>{const{nodeDragThreshold:ee}=F.getState();if(b&&(!N||!y||ee>0)&&Fx({id:r,store:F,nodeRef:q}),u){const ke=F.getState().nodeInternals.get(r);ke&&u(te,{...ke})}},ae=te=>{if(!Ox(te)&&!L)if(VC.includes(te.key)&&b){const ee=te.key==="Escape";Fx({id:r,store:F,unselect:ee,nodeRef:q})}else y&&d&&Object.prototype.hasOwnProperty.call(xo,te.key)&&(F.setState({ariaLiveMessage:`Moved selected node ${te.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~a}`}),oe({x:xo[te.key].x,y:xo[te.key].y,isShiftPressed:te.shiftKey}))};m.useEffect(()=>()=>{H.current&&(A==null||A.unobserve(H.current),H.current=null)},[]),m.useEffect(()=>{if(q.current&&!w){const te=q.current;(!R||!O||H.current!==te)&&(H.current&&(A==null||A.unobserve(H.current)),A==null||A.observe(te),H.current=te)}},[w,R,O]),m.useEffect(()=>{const te=B.current!==n,ee=V.current!==S,ke=Z.current!==C;q.current&&(te||ee||ke)&&(te&&(B.current=n),ee&&(V.current=S),ke&&(Z.current=C),F.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,n,S,C]);const K=wE({nodeRef:q,disabled:w||!y,noDragClassName:E,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:N});return w?null:Y.createElement("div",{className:Qt(["react-flow__node",`react-flow__node-${n}`,{[P]:y},x,{selected:d,selectable:b,parent:$,dragging:K}]),ref:q,style:{zIndex:D,transform:`translate(${l}px,${c}px)`,pointerEvents:re?"all":"none",visibility:R?"visible":"hidden",..._},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:X,onMouseMove:Q,onMouseLeave:fe,onContextMenu:ge,onClick:ye,onDoubleClick:be,onKeyDown:k?ae:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":L?void 0:`${fE}-${I}`,"aria-label":M},Y.createElement(MO,{value:r},Y.createElement(e,{id:r,data:s,type:n,xPos:o,yPos:a,selected:d,isConnectable:j,sourcePosition:S,targetPosition:C,dragging:K,dragHandle:T,zIndex:D})))};return t.displayName="NodeWrapper",m.memo(t)};const wM=e=>{const t=e.getNodes().filter(r=>r.selected);return{...tu(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function jM({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=wt(),{width:s,height:o,x:a,y:l,transformString:c,userSelectionActive:d}=Je(wM,Ot),u=jE(),f=m.useRef(null);if(m.useEffect(()=>{var v;r||(v=f.current)==null||v.focus({preventScroll:!0})},[r]),wE({nodeRef:f}),d||!s||!o)return null;const p=e?v=>{const g=n.getState().getNodes().filter(_=>_.selected);e(v,g)}:void 0,h=v=>{Object.prototype.hasOwnProperty.call(xo,v.key)&&u({x:xo[v.key].x,y:xo[v.key].y,isShiftPressed:v.shiftKey})};return Y.createElement("div",{className:Qt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},Y.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:s,height:o,top:l,left:a}}))}var SM=m.memo(jM);const kM=e=>e.nodesSelectionActive,SE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:a,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:v,onSelectionEnd:g,multiSelectionKeyCode:_,panActivationKeyCode:x,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:k,panOnScroll:N,panOnScrollSpeed:S,panOnScrollMode:C,zoomOnDoubleClick:w,panOnDrag:A,defaultViewport:T,translateExtent:D,minZoom:$,maxZoom:E,preventScrolling:P,onSelectionContextMenu:R,noWheelClassName:L,noPanClassName:M,disableKeyboardA11y:I})=>{const O=Je(kM),F=oa(f),q=oa(x),H=q||A,V=q||N,Z=F||p&&H!==!0;return uM({deleteKeyCode:l,multiSelectionKeyCode:_}),Y.createElement(hM,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:k,panOnScroll:V,panOnScrollSpeed:S,panOnScrollMode:C,zoomOnDoubleClick:w,panOnDrag:!F&&H,defaultViewport:T,translateExtent:D,minZoom:$,maxZoom:E,zoomActivationKeyCode:y,preventScrolling:P,noWheelClassName:L,noPanClassName:M},Y.createElement(yE,{onSelectionStart:v,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:a,panOnDrag:H,isSelecting:!!Z,selectionMode:h},e,O&&Y.createElement(SM,{onSelectionContextMenu:R,noPanClassName:M,disableKeyboardA11y:I})))};SE.displayName="FlowRenderer";var NM=m.memo(SE);function CM(e){return Je(m.useCallback(r=>e?JC(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function EM(e){const t={input:ri(e.input||lE),default:ri(e.default||zx),output:ri(e.output||uE),group:ri(e.group||cy)},r={},n=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,o)=>(s[o]=ri(e[o]||zx),s),r);return{...t,...n}}const TM=({x:e,y:t,width:r,height:n,origin:s})=>!r||!n?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-n*s[1]},RM=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),kE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,updateNodeDimensions:o,onError:a}=Je(RM,Ot),l=CM(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));o(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),Y.createElement("div",{className:"react-flow__nodes",style:uy},l.map(u=>{var k,N,S;let f=u.type||"default";e.nodeTypes[f]||(a==null||a("003",gn.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),v=!!(u.selectable||s&&typeof u.selectable>"u"),g=!!(u.connectable||r&&typeof u.connectable>"u"),_=!!(u.focusable||n&&typeof u.focusable>"u"),x=e.nodeExtent?ny(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(x==null?void 0:x.x)??0,b=(x==null?void 0:x.y)??0,j=TM({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return Y.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||ce.Bottom,targetPosition:u.targetPosition||ce.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:j.x,yPosOrigin:j.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:v,isConnectable:g,isFocusable:_,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((k=u[it])==null?void 0:k.z)??0,isParent:!!((N=u[it])!=null&&N.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((S=u[it])!=null&&S.handleBounds)})}))};kE.displayName="NodeRenderer";var AM=m.memo(kE);const IM=(e,t,r)=>r===ce.Left?e-t:r===ce.Right?e+t:e,PM=(e,t,r)=>r===ce.Top?e-t:r===ce.Bottom?e+t:e,Bb="react-flow__edgeupdater",Wb=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:o,onMouseOut:a,type:l})=>Y.createElement("circle",{onMouseDown:s,onMouseEnter:o,onMouseOut:a,className:Qt([Bb,`${Bb}-${l}`]),cx:IM(t,n,e),cy:PM(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),OM=()=>!0;var $s=e=>{const t=({id:r,className:n,type:s,data:o,onClick:a,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:g,style:_,source:x,target:y,sourceX:b,sourceY:j,targetX:k,targetY:N,sourcePosition:S,targetPosition:C,elementsSelectable:w,hidden:A,sourceHandleId:T,targetHandleId:D,onContextMenu:$,onMouseEnter:E,onMouseMove:P,onMouseLeave:R,reconnectRadius:L,onReconnect:M,onReconnectStart:I,onReconnectEnd:O,markerEnd:F,markerStart:q,rfId:H,ariaLabel:V,isFocusable:Z,isReconnectable:B,pathOptions:re,interactionWidth:oe,disableKeyboardA11y:X})=>{const Q=m.useRef(null),[fe,ge]=m.useState(!1),[be,ye]=m.useState(!1),ae=wt(),K=m.useMemo(()=>`url('#${Dx(q,H)}')`,[q,H]),te=m.useMemo(()=>`url('#${Dx(F,H)}')`,[F,H]);if(A)return null;const ee=pe=>{var st;const{edges:U,addSelectedEdges:ve,unselectNodesAndEdges:he,multiSelectionActive:Fe}=ae.getState(),He=U.find(Ge=>Ge.id===r);He&&(w&&(ae.setState({nodesSelectionActive:!1}),He.selected&&Fe?(he({nodes:[],edges:[He]}),(st=Q.current)==null||st.blur()):ve([r])),a&&a(pe,He))},ke=ei(r,ae.getState,l),je=ei(r,ae.getState,$),Te=ei(r,ae.getState,E),Ne=ei(r,ae.getState,P),ne=ei(r,ae.getState,R),Se=(pe,U)=>{if(pe.button!==0)return;const{edges:ve,isValidConnection:he}=ae.getState(),Fe=U?y:x,He=(U?D:T)||null,st=U?"target":"source",Ge=he||OM,z=U,W=ve.find($e=>$e.id===r);ye(!0),I==null||I(pe,W,st);const G=$e=>{ye(!1),O==null||O($e,W,st)};sE({event:pe,handleId:He,nodeId:Fe,onConnect:$e=>M==null?void 0:M(W,$e),isTarget:z,getState:ae.getState,setState:ae.setState,isValidConnection:Ge,edgeUpdaterType:st,onReconnectEnd:G})},Ve=pe=>Se(pe,!0),ct=pe=>Se(pe,!1),We=()=>ge(!0),Pe=()=>ge(!1),ie=!w&&!a,xe=pe=>{var U;if(!X&&VC.includes(pe.key)&&w){const{unselectNodesAndEdges:ve,addSelectedEdges:he,edges:Fe}=ae.getState();pe.key==="Escape"?((U=Q.current)==null||U.blur(),ve({edges:[Fe.find(st=>st.id===r)]})):he([r])}};return Y.createElement("g",{className:Qt(["react-flow__edge",`react-flow__edge-${s}`,n,{selected:c,animated:d,inactive:ie,updating:fe}]),onClick:ee,onDoubleClick:ke,onContextMenu:je,onMouseEnter:Te,onMouseMove:Ne,onMouseLeave:ne,onKeyDown:Z?xe:void 0,tabIndex:Z?0:void 0,role:Z?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":V===null?void 0:V||`Edge from ${x} to ${y}`,"aria-describedby":Z?`${pE}-${H}`:void 0,ref:Q},!be&&Y.createElement(e,{id:r,source:x,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:g,data:o,style:_,sourceX:b,sourceY:j,targetX:k,targetY:N,sourcePosition:S,targetPosition:C,sourceHandleId:T,targetHandleId:D,markerStart:K,markerEnd:te,pathOptions:re,interactionWidth:oe}),B&&Y.createElement(Y.Fragment,null,(B==="source"||B===!0)&&Y.createElement(Wb,{position:S,centerX:b,centerY:j,radius:L,onMouseDown:Ve,onMouseEnter:We,onMouseOut:Pe,type:"source"}),(B==="target"||B===!0)&&Y.createElement(Wb,{position:C,centerX:k,centerY:N,radius:L,onMouseDown:ct,onMouseEnter:We,onMouseOut:Pe,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function MM(e){const t={default:$s(e.default||pc),straight:$s(e.bezier||iy),step:$s(e.step||oy),smoothstep:$s(e.step||eu),simplebezier:$s(e.simplebezier||sy)},r={},n=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,o)=>(s[o]=$s(e[o]||pc),s),r);return{...t,...n}}function Hb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,o=(r==null?void 0:r.width)||t.width,a=(r==null?void 0:r.height)||t.height;switch(e){case ce.Top:return{x:n+o/2,y:s};case ce.Right:return{x:n+o,y:s+a/2};case ce.Bottom:return{x:n+o/2,y:s+a};case ce.Left:return{x:n,y:s+a/2}}}function Ub(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const DM=(e,t,r,n,s,o)=>{const a=Hb(r,e,t),l=Hb(o,n,s);return{sourceX:a.x,sourceY:a.y,targetX:l.x,targetY:l.y}};function LM({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:s,targetHeight:o,width:a,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+n,t.y+o)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=na({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:a/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Vb(e){var n,s,o,a,l;const t=((n=e==null?void 0:e[it])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)<"u";return[{x:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const zM=[{level:0,isMaxLevel:!0,edges:[]}];function FM(e,t,r=!1){let n=-1;const s=e.reduce((a,l)=>{var u,f;const c=mr(l.zIndex);let d=c?l.zIndex:0;if(r){const p=t.get(l.target),h=t.get(l.source),v=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),g=Math.max(((u=h==null?void 0:h[it])==null?void 0:u.z)||0,((f=p==null?void 0:p[it])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(v?g:0)}return a[d]?a[d].push(l):a[d]=[l],n=d>n?d:n,a},{}),o=Object.entries(s).map(([a,l])=>{const c=+a;return{edges:l,level:c,isMaxLevel:c===n}});return o.length===0?zM:o}function $M(e,t,r){const n=Je(m.useCallback(s=>e?s.edges.filter(o=>{const a=t.get(o.source),l=t.get(o.target);return(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&LM({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return FM(n,t,r)}const qM=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),BM=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Gb={[fc.Arrow]:qM,[fc.ArrowClosed]:BM};function WM(e){const t=wt();return m.useMemo(()=>{var s,o;return Object.prototype.hasOwnProperty.call(Gb,e)?Gb[e]:((o=(s=t.getState()).onError)==null||o.call(s,"009",gn.error009(e)),null)},[e])}const HM=({id:e,type:t,color:r,width:n=12.5,height:s=12.5,markerUnits:o="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{const c=WM(t);return c?Y.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:l,refX:"0",refY:"0"},Y.createElement(c,{color:r,strokeWidth:a})):null},UM=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((s,o)=>([o.markerStart,o.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const l=Dx(a,t);n.includes(l)||(s.push({id:l,color:a.color||e,...a}),n.push(l))}}),s),[]).sort((s,o)=>s.id.localeCompare(o.id))},NE=({defaultColor:e,rfId:t})=>{const r=Je(m.useCallback(UM({defaultColor:e,rfId:t}),[e,t]),(n,s)=>!(n.length!==s.length||n.some((o,a)=>o.id!==s[a].id)));return Y.createElement("defs",null,r.map(n=>Y.createElement(HM,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};NE.displayName="MarkerDefinitions";var VM=m.memo(NE);const GM=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),CE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:s,noPanClassName:o,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:g,children:_,disableKeyboardA11y:x})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:j,width:k,height:N,connectionMode:S,nodeInternals:C,onError:w}=Je(GM,Ot),A=$M(t,C,r);return k?Y.createElement(Y.Fragment,null,A.map(({level:T,edges:D,isMaxLevel:$})=>Y.createElement("svg",{key:T,style:{zIndex:T},width:k,height:N,className:"react-flow__edges react-flow__container"},$&&Y.createElement(VM,{defaultColor:e,rfId:n}),Y.createElement("g",null,D.map(E=>{const[P,R,L]=Vb(C.get(E.source)),[M,I,O]=Vb(C.get(E.target));if(!L||!O)return null;let F=E.type||"default";s[F]||(w==null||w("011",gn.error011(F)),F="default");const q=s[F]||s.default,H=S===Cs.Strict?I.target:(I.target??[]).concat(I.source??[]),V=Ub(R.source,E.sourceHandle),Z=Ub(H,E.targetHandle),B=(V==null?void 0:V.position)||ce.Bottom,re=(Z==null?void 0:Z.position)||ce.Top,oe=!!(E.focusable||y&&typeof E.focusable>"u"),X=E.reconnectable||E.updatable,Q=typeof p<"u"&&(X||b&&typeof X>"u");if(!V||!Z)return w==null||w("008",gn.error008(V,E)),null;const{sourceX:fe,sourceY:ge,targetX:be,targetY:ye}=DM(P,V,B,M,Z,re);return Y.createElement(q,{key:E.id,id:E.id,className:Qt([E.className,o]),type:F,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:fe,sourceY:ge,targetX:be,targetY:ye,sourcePosition:B,targetPosition:re,elementsSelectable:j,onContextMenu:a,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:g,rfId:n,ariaLabel:E.ariaLabel,isFocusable:oe,isReconnectable:Q,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth,disableKeyboardA11y:x})})))),_):null};CE.displayName="EdgeRenderer";var KM=m.memo(CE);const YM=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function XM({children:e}){const t=Je(YM);return Y.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function QM(e){const t=ru(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const ZM={[ce.Left]:ce.Right,[ce.Right]:ce.Left,[ce.Top]:ce.Bottom,[ce.Bottom]:ce.Top},EE=({nodeId:e,handleType:t,style:r,type:n=In.Bezier,CustomComponent:s,connectionStatus:o})=>{var N,S,C;const{fromNode:a,handleId:l,toX:c,toY:d,connectionMode:u}=Je(m.useCallback(w=>({fromNode:w.nodeInternals.get(e),handleId:w.connectionHandleId,toX:(w.connectionPosition.x-w.transform[0])/w.transform[2],toY:(w.connectionPosition.y-w.transform[1])/w.transform[2],connectionMode:w.connectionMode}),[e]),Ot),f=(N=a==null?void 0:a[it])==null?void 0:N.handleBounds;let p=f==null?void 0:f[t];if(u===Cs.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!a||!p)return null;const h=l?p.find(w=>w.id===l):p[0],v=h?h.x+h.width/2:(a.width??0)/2,g=h?h.y+h.height/2:a.height??0,_=(((S=a.positionAbsolute)==null?void 0:S.x)??0)+v,x=(((C=a.positionAbsolute)==null?void 0:C.y)??0)+g,y=h==null?void 0:h.position,b=y?ZM[y]:null;if(!y||!b)return null;if(s)return Y.createElement(s,{connectionLineType:n,connectionLineStyle:r,fromNode:a,fromHandle:h,fromX:_,fromY:x,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:o});let j="";const k={sourceX:_,sourceY:x,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return n===In.Bezier?[j]=QC(k):n===In.Step?[j]=Mx({...k,borderRadius:0}):n===In.SmoothStep?[j]=Mx(k):n===In.SimpleBezier?[j]=XC(k):j=`M${_},${x} ${c},${d}`,Y.createElement("path",{d:j,fill:"none",className:"react-flow__connection-path",style:r})};EE.displayName="ConnectionLine";const JM=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function e8({containerStyle:e,style:t,type:r,component:n}){const{nodeId:s,handleType:o,nodesConnectable:a,width:l,height:c,connectionStatus:d}=Je(JM,Ot);return!(s&&o&&l&&a)?null:Y.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},Y.createElement("g",{className:Qt(["react-flow__connection",d])},Y.createElement(EE,{nodeId:s,handleType:o,style:t,type:r,CustomComponent:n,connectionStatus:d})))}function Kb(e,t){return m.useRef(null),wt(),m.useMemo(()=>t(e),[e])}const TE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:s,onInit:o,onNodeClick:a,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:v,onSelectionStart:g,onSelectionEnd:_,connectionLineType:x,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:j,selectionKeyCode:k,selectionOnDrag:N,selectionMode:S,multiSelectionKeyCode:C,panActivationKeyCode:w,zoomActivationKeyCode:A,deleteKeyCode:T,onlyRenderVisibleElements:D,elementsSelectable:$,selectNodesOnDrag:E,defaultViewport:P,translateExtent:R,minZoom:L,maxZoom:M,preventScrolling:I,defaultMarkerColor:O,zoomOnScroll:F,zoomOnPinch:q,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:Z,zoomOnDoubleClick:B,panOnDrag:re,onPaneClick:oe,onPaneMouseEnter:X,onPaneMouseMove:Q,onPaneMouseLeave:fe,onPaneScroll:ge,onPaneContextMenu:be,onEdgeContextMenu:ye,onEdgeMouseEnter:ae,onEdgeMouseMove:K,onEdgeMouseLeave:te,onReconnect:ee,onReconnectStart:ke,onReconnectEnd:je,reconnectRadius:Te,noDragClassName:Ne,noWheelClassName:ne,noPanClassName:Se,elevateEdgesOnSelect:Ve,disableKeyboardA11y:ct,nodeOrigin:We,nodeExtent:Pe,rfId:ie})=>{const xe=Kb(e,EM),pe=Kb(t,MM);return QM(o),Y.createElement(NM,{onPaneClick:oe,onPaneMouseEnter:X,onPaneMouseMove:Q,onPaneMouseLeave:fe,onPaneContextMenu:be,onPaneScroll:ge,deleteKeyCode:T,selectionKeyCode:k,selectionOnDrag:N,selectionMode:S,onSelectionStart:g,onSelectionEnd:_,multiSelectionKeyCode:C,panActivationKeyCode:w,zoomActivationKeyCode:A,elementsSelectable:$,onMove:r,onMoveStart:n,onMoveEnd:s,zoomOnScroll:F,zoomOnPinch:q,zoomOnDoubleClick:B,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:Z,panOnDrag:re,defaultViewport:P,translateExtent:R,minZoom:L,maxZoom:M,onSelectionContextMenu:v,preventScrolling:I,noDragClassName:Ne,noWheelClassName:ne,noPanClassName:Se,disableKeyboardA11y:ct},Y.createElement(XM,null,Y.createElement(KM,{edgeTypes:pe,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:D,onEdgeContextMenu:ye,onEdgeMouseEnter:ae,onEdgeMouseMove:K,onEdgeMouseLeave:te,onReconnect:ee,onReconnectStart:ke,onReconnectEnd:je,reconnectRadius:Te,defaultMarkerColor:O,noPanClassName:Se,elevateEdgesOnSelect:!!Ve,disableKeyboardA11y:ct,rfId:ie},Y.createElement(e8,{style:y,type:x,component:b,containerStyle:j})),Y.createElement("div",{className:"react-flow__edgelabel-renderer"}),Y.createElement(AM,{nodeTypes:xe,onNodeClick:a,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:E,onlyRenderVisibleElements:D,noPanClassName:Se,noDragClassName:Ne,disableKeyboardA11y:ct,nodeOrigin:We,nodeExtent:Pe,rfId:ie})))};TE.displayName="GraphView";var t8=m.memo(TE);const $x=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],jn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:$x,nodeExtent:$x,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Cs.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:TO,isValidConnection:void 0},r8=()=>HA((e,t)=>({...jn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:s,elevateNodesOnSelect:o}=t();e({nodeInternals:fd(r,n,s,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(s=>({...n,...s}))})},setDefaultNodesAndEdges:(r,n)=>{const s=typeof r<"u",o=typeof n<"u",a=s?fd(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:o?n:[],hasDefaultNodes:s,hasDefaultEdges:o})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:s,fitViewOnInit:o,fitViewOnInitDone:a,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((g,_)=>{const x=s.get(_.id);if(x!=null&&x.hidden)s.set(x.id,{...x,[it]:{...x[it],handleBounds:void 0}});else if(x){const y=ry(_.nodeElement);!!(y.width&&y.height&&(x.width!==y.width||x.height!==y.height||_.forceUpdate))&&(s.set(x.id,{...x,[it]:{...x[it],handleBounds:{source:qb(".source",_.nodeElement,p,d),target:qb(".target",_.nodeElement,p,d)}},...y}),g.push({id:x.id,type:"dimensions",dimensions:y}))}return g},[]);mE(s,d);const v=a||o&&!a&&gE(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:v}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,s=!1)=>{const{triggerNodeChanges:o}=t(),a=r.map(l=>{const c={id:l.id,type:"position",dragging:s};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});o(a)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:s,hasDefaultNodes:o,nodeOrigin:a,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(o){const d=vE(r,l()),u=fd(d,s,a,c);e({nodeInternals:u})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let a,l=null;n?a=r.map(c=>En(c,!0)):(a=oo(o(),r),l=oo(s,[])),nl({changedNodes:a,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let a,l=null;n?a=r.map(c=>En(c,!0)):(a=oo(s,r),l=oo(o(),[])),nl({changedNodes:l,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:s,getNodes:o}=t(),a=r||o(),l=n||s,c=a.map(u=>(u.selected=!1,En(u.id,!1))),d=l.map(u=>En(u.id,!1));nl({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:s}=t();n==null||n.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:s}=t();n==null||n.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),o=n().filter(l=>l.selected).map(l=>En(l.id,!1)),a=r.filter(l=>l.selected).map(l=>En(l.id,!1));nl({changedNodes:o,changedEdges:a,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(s=>{s.positionAbsolute=ny(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:s,height:o,d3Zoom:a,d3Selection:l,translateExtent:c}=t();if(!a||!l||!r.x&&!r.y)return!1;const d=un.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),u=[[0,0],[s,o]],f=a==null?void 0:a.constrain()(d,u,c);return a.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:jn.connectionNodeId,connectionHandleId:jn.connectionHandleId,connectionHandleType:jn.connectionHandleType,connectionStatus:jn.connectionStatus,connectionStartHandle:jn.connectionStartHandle,connectionEndHandle:jn.connectionEndHandle}),reset:()=>e({...jn})}),Object.is),wa=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=r8()),Y.createElement(wO,{value:t.current},e)};wa.displayName="ReactFlowProvider";const RE=({children:e})=>m.useContext(Jc)?Y.createElement(Y.Fragment,null,e):Y.createElement(wa,null,e);RE.displayName="ReactFlowWrapper";const n8={input:lE,default:zx,output:uE,group:cy},s8={default:pc,straight:iy,step:oy,smoothstep:eu,simplebezier:sy},o8=[0,0],i8=[15,15],a8={x:0,y:0,zoom:1},l8={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},nu=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:o=n8,edgeTypes:a=s8,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:v,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:x,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:k,onNodeDoubleClick:N,onNodeDragStart:S,onNodeDrag:C,onNodeDragStop:w,onNodesDelete:A,onEdgesDelete:T,onSelectionChange:D,onSelectionDragStart:$,onSelectionDrag:E,onSelectionDragStop:P,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:M,connectionMode:I=Cs.Strict,connectionLineType:O=In.Bezier,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:H,deleteKeyCode:V="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:B=!1,selectionMode:re=sa.Full,panActivationKeyCode:oe="Space",multiSelectionKeyCode:X=dc()?"Meta":"Control",zoomActivationKeyCode:Q=dc()?"Meta":"Control",snapToGrid:fe=!1,snapGrid:ge=i8,onlyRenderVisibleElements:be=!1,selectNodesOnDrag:ye=!0,nodesDraggable:ae,nodesConnectable:K,nodesFocusable:te,nodeOrigin:ee=o8,edgesFocusable:ke,edgesUpdatable:je,elementsSelectable:Te,defaultViewport:Ne=a8,minZoom:ne=.5,maxZoom:Se=2,translateExtent:Ve=$x,preventScrolling:ct=!0,nodeExtent:We,defaultMarkerColor:Pe="#b1b1b7",zoomOnScroll:ie=!0,zoomOnPinch:xe=!0,panOnScroll:pe=!1,panOnScrollSpeed:U=.5,panOnScrollMode:ve=hs.Free,zoomOnDoubleClick:he=!0,panOnDrag:Fe=!0,onPaneClick:He,onPaneMouseEnter:st,onPaneMouseMove:Ge,onPaneMouseLeave:z,onPaneScroll:W,onPaneContextMenu:G,children:se,onEdgeContextMenu:$e,onEdgeDoubleClick:pt,onEdgeMouseEnter:lr,onEdgeMouseMove:Tt,onEdgeMouseLeave:jt,onEdgeUpdate:Bt,onEdgeUpdateStart:Lr,onEdgeUpdateEnd:at,onReconnect:ue,onReconnectStart:de,onReconnectEnd:Ye,reconnectRadius:wr=10,edgeUpdaterRadius:ns=10,onNodesChange:zr,onEdgesChange:ss,noDragClassName:Wo="nodrag",noWheelClassName:RT="nowheel",noPanClassName:Ky="nopan",fitView:AT=!1,fitViewOptions:IT,connectOnClick:PT=!0,attributionPosition:OT,proOptions:MT,defaultEdgeOptions:DT,elevateNodesOnSelect:LT=!0,elevateEdgesOnSelect:zT=!1,disableKeyboardA11y:Yy=!1,autoPanOnConnect:FT=!0,autoPanOnNodeDrag:$T=!0,connectionRadius:qT=20,isValidConnection:BT,onError:WT,style:HT,id:Xy,nodeDragThreshold:UT,...VT},GT)=>{const Pu=Xy||"1";return Y.createElement("div",{...VT,style:{...HT,...l8},ref:GT,className:Qt(["react-flow",s]),"data-testid":"rf__wrapper",id:Xy},Y.createElement(RE,null,Y.createElement(t8,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:k,onNodeDoubleClick:N,nodeTypes:o,edgeTypes:a,connectionLineType:O,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:H,selectionKeyCode:Z,selectionOnDrag:B,selectionMode:re,deleteKeyCode:V,multiSelectionKeyCode:X,panActivationKeyCode:oe,zoomActivationKeyCode:Q,onlyRenderVisibleElements:be,selectNodesOnDrag:ye,defaultViewport:Ne,translateExtent:Ve,minZoom:ne,maxZoom:Se,preventScrolling:ct,zoomOnScroll:ie,zoomOnPinch:xe,zoomOnDoubleClick:he,panOnScroll:pe,panOnScrollSpeed:U,panOnScrollMode:ve,panOnDrag:Fe,onPaneClick:He,onPaneMouseEnter:st,onPaneMouseMove:Ge,onPaneMouseLeave:z,onPaneScroll:W,onPaneContextMenu:G,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:M,onEdgeContextMenu:$e,onEdgeDoubleClick:pt,onEdgeMouseEnter:lr,onEdgeMouseMove:Tt,onEdgeMouseLeave:jt,onReconnect:ue??Bt,onReconnectStart:de??Lr,onReconnectEnd:Ye??at,reconnectRadius:wr??ns,defaultMarkerColor:Pe,noDragClassName:Wo,noWheelClassName:RT,noPanClassName:Ky,elevateEdgesOnSelect:zT,rfId:Pu,disableKeyboardA11y:Yy,nodeOrigin:ee,nodeExtent:We}),Y.createElement(ZO,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:v,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:x,nodesDraggable:ae,nodesConnectable:K,nodesFocusable:te,edgesFocusable:ke,edgesUpdatable:je,elementsSelectable:Te,elevateNodesOnSelect:LT,minZoom:ne,maxZoom:Se,nodeExtent:We,onNodesChange:zr,onEdgesChange:ss,snapToGrid:fe,snapGrid:ge,connectionMode:I,translateExtent:Ve,connectOnClick:PT,defaultEdgeOptions:DT,fitView:AT,fitViewOptions:IT,onNodesDelete:A,onEdgesDelete:T,onNodeDragStart:S,onNodeDrag:C,onNodeDragStop:w,onSelectionDrag:E,onSelectionDragStart:$,onSelectionDragStop:P,noPanClassName:Ky,nodeOrigin:ee,rfId:Pu,autoPanOnConnect:FT,autoPanOnNodeDrag:$T,onError:WT,connectionRadius:qT,isValidConnection:BT,nodeDragThreshold:UT}),Y.createElement(XO,{onSelectionChange:D}),se,Y.createElement(SO,{proOptions:MT,position:OT}),Y.createElement(nM,{rfId:Pu,disableKeyboardA11y:Yy})))});nu.displayName="ReactFlow";function AE(e){return t=>{const[r,n]=m.useState(t),s=m.useCallback(o=>n(a=>e(o,a)),[]);return[r,n,s]}}const IE=AE(vE),PE=AE(xM),OE=({id:e,x:t,y:r,width:n,height:s,style:o,color:a,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:v,backgroundColor:g}=o||{},_=a||v||g;return Y.createElement("rect",{className:Qt(["react-flow__minimap-node",{selected:h},d]),x:t,y:r,rx:u,ry:u,width:n,height:s,fill:_,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?x=>p(x,e):void 0})};OE.displayName="MiniMapNode";var c8=m.memo(OE);const u8=e=>e.nodeOrigin,d8=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),gd=e=>e instanceof Function?e:()=>e;function f8({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:s=2,nodeComponent:o=c8,onClick:a}){const l=Je(d8,Ot),c=Je(u8),d=gd(t),u=gd(e),f=gd(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Y.createElement(Y.Fragment,null,l.map(h=>{const{x:v,y:g}=ys(h,c).positionAbsolute;return Y.createElement(o,{key:h.id,x:v,y:g,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:n,strokeColor:u(h),strokeWidth:s,shapeRendering:p,onClick:a,id:h.id})}))}var p8=m.memo(f8);const h8=200,m8=150,g8=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?CO(tu(t,e.nodeOrigin),r):r,rfId:e.rfId}},x8="react-flow__minimap-desc";function ME({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:s="",nodeBorderRadius:o=5,nodeStrokeWidth:a=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:v=!1,zoomable:g=!1,ariaLabel:_="React Flow mini map",inversePan:x=!1,zoomStep:y=10,offsetScale:b=5}){const j=wt(),k=m.useRef(null),{boundingRect:N,viewBB:S,rfId:C}=Je(g8,Ot),w=(e==null?void 0:e.width)??h8,A=(e==null?void 0:e.height)??m8,T=N.width/w,D=N.height/A,$=Math.max(T,D),E=$*w,P=$*A,R=b*$,L=N.x-(E-N.width)/2-R,M=N.y-(P-N.height)/2-R,I=E+R*2,O=P+R*2,F=`${x8}-${C}`,q=m.useRef(0);q.current=$,m.useEffect(()=>{if(k.current){const Z=pr(k.current),B=X=>{const{transform:Q,d3Selection:fe,d3Zoom:ge}=j.getState();if(X.sourceEvent.type!=="wheel"||!fe||!ge)return;const be=-X.sourceEvent.deltaY*(X.sourceEvent.deltaMode===1?.05:X.sourceEvent.deltaMode?1:.002)*y,ye=Q[2]*Math.pow(2,be);ge.scaleTo(fe,ye)},re=X=>{const{transform:Q,d3Selection:fe,d3Zoom:ge,translateExtent:be,width:ye,height:ae}=j.getState();if(X.sourceEvent.type!=="mousemove"||!fe||!ge)return;const K=q.current*Math.max(1,Q[2])*(x?-1:1),te={x:Q[0]-X.sourceEvent.movementX*K,y:Q[1]-X.sourceEvent.movementY*K},ee=[[0,0],[ye,ae]],ke=un.translate(te.x,te.y).scale(Q[2]),je=ge.constrain()(ke,ee,be);ge.transform(fe,je)},oe=$C().on("zoom",v?re:null).on("zoom.wheel",g?B:null);return Z.call(oe),()=>{Z.on("zoom",null)}}},[v,g,x,y]);const H=p?Z=>{const B=Cr(Z);p(Z,{x:B[0],y:B[1]})}:void 0,V=h?(Z,B)=>{const re=j.getState().nodeInternals.get(B);h(Z,re)}:void 0;return Y.createElement(Un,{position:f,style:e,className:Qt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},Y.createElement("svg",{width:w,height:A,viewBox:`${L} ${M} ${I} ${O}`,role:"img","aria-labelledby":F,ref:k,onClick:H},_&&Y.createElement("title",{id:F},_),Y.createElement(p8,{onClick:V,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:l}),Y.createElement("path",{className:"react-flow__minimap-mask",d:`M${L-R},${M-R}h${I+R*2}v${O+R*2}h${-I-R*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}ME.displayName="MiniMap";var DE=m.memo(ME);const ol={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},v8=180,y8=400,b8=260,_8=48;function w8(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function j8({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:s,onToggleShowArchived:o,userSection:a}){const[l,c]=m.useState(!1),[d,u]=m.useState(b8),[f,p]=m.useState(!1),h=m.useRef(null),v=m.useRef(null);m.useEffect(()=>{v.current&&v.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((k,N)=>{const S=(k.name||"").localeCompare(N.name||"");return S!==0?S:(k.projectId||"").localeCompare(N.projectId||"")}),[e]),_=()=>{n()},x=m.useCallback(k=>{k.preventDefault(),p(!0)},[]),y=m.useCallback(k=>{if(!f)return;const N=Math.min(y8,Math.max(v8,k.clientX));u(N)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const j=l?_8:d;return i.jsxs("div",{ref:h,className:"h-full flex flex-col relative",onWheel:k=>k.stopPropagation(),style:{width:j,minWidth:j,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),i.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:s?"#f59e0b":"var(--text-muted)"},title:s?"Hide archived":"Show archived",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),i.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:i.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&i.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(k=>{const N=t===k.id;return i.jsxs("div",{ref:N?v:null,onClick:()=>r(k.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:N?"var(--state-active-bg)":"transparent",border:N?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:N?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:N?"#ffffff":ol[k.status]||ol.queued}}),i.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:N?"#ffffff":"var(--text-primary)"},children:k.name}),k.isArchived&&i.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:N?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:i.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),i.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[i.jsx("span",{className:"text-[10px] font-mono",style:{color:N?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:k.projectId}),i.jsx("span",{className:"text-[10px]",style:{color:N?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:w8(k.createdAt)})]})]},k.id)})}),l&&i.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(k=>i.jsx("div",{onClick:()=>r(k.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:k.name,children:i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:ol[k.status]||ol.queued,boxShadow:t===k.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},k.id))}),!l&&i.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsxs("button",{onClick:_,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[i.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),i.jsx("span",{children:"New Project"})]})}),l&&i.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:i.jsx("button",{onClick:_,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:i.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),a,!l&&i.jsx("div",{onMouseDown:x,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function S8({stations:e}){if(!(e!=null&&e.length))return null;const t=e.reduce((o,a,l)=>a.state==="complete"?l:o,-1),r=e.findIndex(o=>o.state==="active"),n=e.find(o=>o.state==="active"),s=n==null?void 0:n.currentStep;return i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"relative flex items-start",children:[i.jsx("div",{className:"absolute h-0.5 left-0 right-0",style:{top:5,background:"var(--state-queued-bg)"}}),t>=0&&i.jsx("div",{className:"absolute h-0.5 left-0",style:{top:5,width:`${(t+.5)/e.length*100}%`,background:"var(--state-stabilized-bg)"}}),r>=0&&i.jsx("div",{className:"absolute h-0.5",style:{top:5,left:t>=0?`${(t+.5)/e.length*100}%`:"0%",width:t>=0?`${(r-t)/e.length*100}%`:`${(r+.5)/e.length*100}%`,background:"var(--state-active-bg)"}}),e.map(o=>{const a=o.state==="active",c=o.state==="complete"?"var(--state-stabilized-bg)":a?"var(--state-active-bg)":o.state==="failed"?"var(--state-blocked-bg)":"var(--state-queued-bg)",d=a?"var(--state-active-text)":"var(--text-muted)";return i.jsxs("div",{className:"flex-1 flex flex-col items-center relative z-10",children:[i.jsx("div",{className:`w-3 h-3 rounded-full${a?" station-active":""}${a&&o.needs_input?" station-needs-input":""}`,style:{background:c,boxShadow:a&&o.needs_input?"0 0 0 2px var(--state-active-bg)":void 0}}),i.jsx("span",{className:"text-[7px] mt-0.5",style:{color:a&&o.needs_input?"var(--state-active-text)":d,fontWeight:a?500:400},children:o.label})]},o.id)})]}),s&&i.jsx("div",{className:"text-center text-[8px] mt-1 font-medium",style:{color:"var(--state-active-text)"},children:s.name})]})}const Yb={light:{blocked:"#ef4444",in_progress:"#6366f1",ready:"#eab308",stabilized:"#10b981",active:"#6366f1",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},industrial:{blocked:"#ef4444",in_progress:"#f59e0b",ready:"#eab308",stabilized:"#10b981",active:"#f59e0b",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},blueprint:{blocked:"#ef4444",in_progress:"#fbbf24",ready:"#eab308",stabilized:"#10b981",active:"#fbbf24",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"}};function k8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const LE=(e,t)=>{var n;const r=k8(e);return((n=Yb[t])==null?void 0:n[r])||Yb.industrial.ready},Sr={WPS_PER_ROW:3,WP_WIDTH:220,WP_HEIGHT:85,WP_GAP_X:50,WP_GAP_Y:100,WP_OFFSET_X:80,WP_OFFSET_Y:80},hc={GAP:8},Pn=["industrial","light","blueprint"],N8=400,C8=560;function E8({question:e,value:t,onChange:r}){const n=e.answer_type||"text",s=e.choices||[];if(n==="single_choice"&&s.length>0)return i.jsx("div",{className:"space-y-1.5",children:s.map(o=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("input",{type:"radio",name:e.id,value:o.value,checked:t===o.value,onChange:()=>r(o.value),className:"w-3.5 h-3.5 accent-amber-500"}),i.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:o.label})]},o.value))});if(n==="multi_choice"&&s.length>0){const o=Array.isArray(t)?t:[];return i.jsx("div",{className:"space-y-1.5",children:s.map(a=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("input",{type:"checkbox",checked:o.includes(a.value),onChange:l=>{l.target.checked?r([...o,a.value]):r(o.filter(c=>c!==a.value))},className:"w-3.5 h-3.5 accent-amber-500"}),i.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:a.label})]},a.value))})}return n==="boolean"?i.jsx("div",{className:"flex gap-3",children:[{label:"Yes",value:!0},{label:"No",value:!1}].map(o=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("input",{type:"radio",name:e.id,checked:t===o.value,onChange:()=>r(o.value),className:"w-3.5 h-3.5 accent-amber-500"}),i.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:o.label})]},String(o.value)))}):n==="number"?i.jsx("input",{type:"number",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:o=>r(o.target.value?Number(o.target.value):"")}):n==="free_text"||n==="long_text"?i.jsx("textarea",{className:"w-full rounded px-2 py-1.5 text-xs border resize-none",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)",minHeight:60},value:t||"",onChange:o=>r(o.target.value)}):i.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:o=>r(o.target.value)})}function T8({priority:e}){if(!e)return null;const t={must:{bg:"bg-red-500/20",text:"text-red-400"},should:{bg:"bg-amber-500/20",text:"text-amber-400"},could:{bg:"bg-blue-500/20",text:"text-blue-400"}},r=t[e]||t.should;return i.jsx("span",{className:`${r.bg} ${r.text} text-[8px] px-1.5 py-0.5 rounded uppercase font-semibold`,children:e})}function R8({questions:e,nodeWidth:t,onSubmit:r,onClose:n}){const[s,o]=m.useState({}),[a,l]=m.useState(!1),[c,d]=m.useState(!1),u=e.filter(g=>g.required).every(g=>{const _=s[g.id];return Array.isArray(_)?_.length>0:_!==void 0&&_!==""}),f=a?C8:N8,p=(g,_)=>{o(x=>({...x,[g]:_}))},h=async()=>{d(!0);try{await r(s)}catch(g){console.error("Submit failed:",g),d(!1)}},v=g=>g.stopPropagation();return i.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:t+hc.GAP,width:f,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",transition:"width 0.2s ease",userSelect:"text"},onMouseDown:v,onPointerDown:v,onWheel:v,children:[i.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:hc.GAP}}),i.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),i.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[i.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:()=>l(!a),title:a?"Contract":"Expand",className:"hover:opacity-70 transition-opacity p-1",style:{color:"var(--text-sidecar-muted)"},children:a?i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),i.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]})]}),i.jsx("div",{className:`p-3 space-y-4 overflow-y-auto nowheel ${a?"max-h-[520px]":"max-h-[420px]"}`,children:e.map(g=>i.jsxs("div",{className:"pb-3",style:{borderBottom:"1px solid var(--border-input)"},children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[i.jsxs("label",{className:"block text-[11px] font-medium",style:{color:"var(--text-sidecar)"},children:[g.text," ",g.required&&i.jsx("span",{className:"text-amber-500",children:"*"})]}),i.jsx(T8,{priority:g.priority})]}),g.why_it_matters&&i.jsx("p",{className:"text-[9px] mb-2 italic",style:{color:"var(--text-sidecar-muted)"},children:g.why_it_matters}),i.jsx(E8,{question:g,value:s[g.id],onChange:_=>p(g.id,_)})]},g.id))}),i.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:i.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${u&&!c?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!u||c,onClick:h,children:c?"Submitting...":"Submit & Continue"})})]})}const Xb={DRAFT:{bg:"#e5e7eb",text:"#374151"},READY:{bg:"#fef3c7",text:"#92400e"},IN_PROGRESS:{bg:"#fde68a",text:"#78350f"},ACCEPTED:{bg:"#d1fae5",text:"#065f46"},REJECTED:{bg:"#fee2e2",text:"#991b1b"},BLOCKED:{bg:"#fecaca",text:"#991b1b"}},Qb={A:{bg:"#dbeafe",text:"#1e40af"},B:{bg:"#fef3c7",text:"#92400e"}};function A8(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString(void 0,{month:"short",day:"numeric"})+" "+t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}catch{return e}}function I8({workStatements:e,wpName:t,nodeWidth:r,onClose:n,onZoomComplete:s}){m.useEffect(()=>{if(s){const l=setTimeout(()=>s(),150);return()=>clearTimeout(l)}},[s]);const a=l=>l.stopPropagation();return i.jsxs("div",{className:"absolute top-0 border border-sky-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:r+hc.GAP,width:320,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",userSelect:"text"},onMouseDown:a,onPointerDown:a,onWheel:a,children:[i.jsx("div",{className:"absolute border-t-2 border-dashed border-sky-500/60",style:{top:14,right:"100%",width:hc.GAP}}),i.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-sky-500",style:{top:11,right:"100%",marginRight:-4}}),i.jsxs("div",{className:"bg-sky-500/10 border-b border-sky-500/30 px-3 py-2 flex justify-between items-center",children:[i.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Work Statements - ",t]}),i.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),i.jsxs("div",{className:"p-2 max-h-72 overflow-y-auto space-y-1.5",children:[e.map(l=>{const c=l.state||l.status||"DRAFT",d=Xb[c]||Xb.DRAFT,u=l.verification_mode||l.mode||"A",f=Qb[u]||Qb.A;return i.jsxs("div",{className:"px-2.5 py-2 rounded border",style:{borderColor:"var(--border-node)",background:"var(--bg-sidecar)"},children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[i.jsx("span",{className:"text-[10px] font-medium truncate flex-1",style:{color:"var(--text-sidecar)"},children:l.title||l.ws_id||l.id}),i.jsxs("span",{className:"text-[8px] font-bold px-1.5 py-0.5 rounded flex-shrink-0",style:{background:f.bg,color:f.text},children:["Mode ",u]})]}),i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{className:"text-[8px] font-semibold uppercase px-1.5 py-0.5 rounded",style:{background:d.bg,color:d.text},children:c}),l.updated_at&&i.jsx("span",{className:"text-[8px]",style:{color:"var(--text-sidecar-muted)"},children:A8(l.updated_at)})]})]},l.ws_id||l.id)}),e.length===0&&i.jsx("div",{className:"text-center py-4 text-[10px]",style:{color:"var(--text-sidecar-muted)"},children:"No work statements yet"})]}),i.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," work statement",e.length!==1?"s":""]})]})}const P8={blocked:{bg:"var(--state-blocked-bg)",text:"var(--state-blocked-text)"},in_progress:{bg:"var(--state-active-bg)",text:"var(--state-active-text)"},ready:{bg:"var(--state-ready-bg)",text:"var(--state-ready-text)"},stabilized:{bg:"var(--state-stabilized-bg)",text:"var(--state-stabilized-text)"}};function O8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const M8={blocked:"Blocked",in_progress:"In Progress",ready:"Ready",stabilized:"Stabilized"};function D8(e){return e?e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):""}function L8({data:e}){var A,T,D,$,E,P;const r=(e.level||1)===1,n=e.isExpanded,s=e.expandType,o=((A=e.questions)==null?void 0:A.length)>0,a=((T=e.workStatements)==null?void 0:T.length)>0,l=(D=e.stations)==null?void 0:D.some(R=>R.state==="active"&&R.needs_input),c=e.state||"ready_for_production",d=O8(c),u=d==="stabilized",f=d==="in_progress",p=d==="blocked",h=(($=e.stations)==null?void 0:$.length)>0,v=f?"node-active":"",g=r?"DOCUMENT":"WORK PACKAGE",_=r?"subway-node-header-doc":"subway-node-header-wp",x=P8[d],y=x.bg,b=x.text,j=x.bg,k=M8[d],N=e.ws_done??0,S=e.ws_total??0,C=e.mode_b_count??0,w=((E=e.dependencies)==null?void 0:E.length)??e.dep_count??0;return i.jsxs("div",{className:"relative",children:[i.jsx(yr,{type:"target",position:ce.Top,className:"!opacity-0",style:{left:"15%"}}),i.jsxs("div",{className:`subway-node rounded-lg border ${v} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:j},children:[i.jsxs("div",{className:`${_} border-b px-3 py-1.5 flex items-center justify-between`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-wp, var(--header-text-doc))"},children:g}),i.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&i.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:y}}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:b},children:k}),r&&e.desc&&i.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),!r&&i.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[i.jsxs("span",{className:"text-[8px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-badge, rgba(100,116,139,0.15))",color:"var(--text-muted)"},children:[N,"/",S," WS"]}),w>0&&i.jsxs("span",{className:"text-[8px] px-1.5 py-0.5 rounded",style:{background:"rgba(234,179,8,0.15)",color:"#a16207"},children:[w," dep",w!==1?"s":""]}),C>0&&i.jsxs("span",{className:"text-[8px] px-1.5 py-0.5 rounded",style:{background:"rgba(245,158,11,0.15)",color:"#b45309"},children:[C," Mode B"]})]}),h&&i.jsx(S8,{stations:e.stations}),i.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[u&&i.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-stabilized-bg)",color:"white"},onClick:R=>{var L;R.stopPropagation(),(L=e.onViewFullDocument)==null||L.call(e,e.instanceId?{docTypeId:e.docTypeId,instanceId:e.instanceId}:e.id)},children:"View Document"}),r&&d==="ready"&&i.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-ready-bg)",color:"white"},onClick:R=>{var L;R.stopPropagation(),(L=e.onStartProduction)==null||L.call(e,e.id)},children:"Start Production"}),l&&o&&!n&&i.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all amber-pulse",style:{backgroundColor:"var(--state-active-bg)",color:"white"},onClick:R=>{var L;R.stopPropagation(),(L=e.onExpand)==null||L.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&a&&(n&&s==="workStatements"?i.jsxs("span",{className:"text-[9px]",style:{color:"var(--text-muted)"},children:[e.workStatements.length," work statements expanded"]}):i.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:R=>{var L;R.stopPropagation(),(L=e.onExpand)==null||L.call(e,e.id,"workStatements")},children:[i.jsx("span",{style:{color:"var(--state-active-text, #f59e0b)"},children:e.workStatements.length}),i.jsx("span",{children:"work statements"}),i.jsx("span",{style:{color:"var(--state-active-text, #f59e0b)"},children:""})]}))]}),((P=e.blockedBy)==null?void 0:P.length)>0&&(p||d==="ready")&&i.jsxs("div",{className:"mt-2 pt-2 border-t text-[8px]",style:{borderColor:"var(--border-node)",color:"var(--text-muted)"},children:[i.jsx("span",{className:"font-medium",children:"Waiting for: "}),e.blockedBy.map(D8).join(", ")]})]})]}),n&&s==="questions"&&o&&i.jsx(R8,{questions:e.questions,nodeWidth:e.width,onSubmit:R=>{var L;return(L=e.onSubmitQuestions)==null?void 0:L.call(e,e.id,R)},onClose:()=>{var R;return(R=e.onCollapse)==null?void 0:R.call(e)}}),n&&s==="workStatements"&&a&&i.jsx(I8,{workStatements:e.workStatements,wpName:e.name,nodeWidth:e.width,onClose:()=>{var R;return(R=e.onCollapse)==null?void 0:R.call(e)},onZoomComplete:()=>{var R;return(R=e.onZoomToNode)==null?void 0:R.call(e,e.id)}}),i.jsx(yr,{type:"source",position:ce.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function z8(){return i.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[i.jsx(yr,{type:"target",position:ce.Top,style:{opacity:0}}),i.jsx(yr,{type:"source",position:ce.Bottom,style:{opacity:0}})]})}const dy="/api/v1";class F8 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function $8(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ce(e,t={}){const r=`${dy}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},s=await fetch(r,n);if(!s.ok){const o=await s.json().catch(()=>({}));throw new F8(o.detail||`Request failed: ${s.status}`,s.status,o)}return s.status===204?null:s.json()}const ze={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":$8()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return Ce(`/projects${r?"?"+r:""}`)},getProject:e=>Ce(`/projects/${e}`),getProjectTree:e=>Ce(`/projects/${e}/tree`),createProject:e=>Ce("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>Ce(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),saveFloorLayout:(e,t)=>Ce(`/projects/${e}`,{method:"PATCH",body:JSON.stringify({metadata:{floor_layout:t}})}),archiveProject:e=>Ce(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>Ce(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>Ce(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>Ce(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),Ce(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>Ce(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>Ce(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),getExecutions:()=>Ce("/executions"),getExecution:e=>Ce(`/executions/${e}`),getExecutionTranscript:e=>Ce(`/executions/${e}/transcript`),getExecutionQACoverage:e=>Ce(`/executions/${e}/qa-coverage`),getDocumentWorkflowExecutions:()=>Ce("/document-workflows/executions"),getDocumentWorkflowExecution:e=>Ce(`/document-workflows/executions/${e}`),startWorkflow:(e,t,r=null)=>Ce("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>Ce(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>Ce(`/document-workflows/executions/${e}`),getPgcAnswers:e=>Ce(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return Ce(`/projects/${e}/documents/${t}${n}`)},getDocumentRenderModel:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return Ce(`/projects/${e}/documents/${t}/render-model${n}`)},getDocumentPgc:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return Ce(`/projects/${e}/documents/${t}/pgc${n}`)},startIntake:()=>Ce("/intake/start",{method:"POST"}),getIntakeState:e=>Ce(`/intake/${e}`),submitIntakeMessage:(e,t)=>Ce(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>Ce(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>Ce(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>Ce(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>Ce(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>Ce(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>Ce(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>Ce(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>Ce(`/projects/${e}/workflow/complete`,{method:"POST"}),createIntent:(e,t)=>Ce("/intents",{method:"POST",body:JSON.stringify({project_id:e,...t})}),getIntent:e=>Ce(`/intents/${e}`)};function q8(e){const t=`${dy}/production/events?project_id=${e}`;return new EventSource(t)}function B8(e){const t=`${dy}/intake/${e}/events`;return new EventSource(t)}function W8(e){return`/auth/login/${e}`}function H8({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&i.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Zb({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const s=n==="numbered"?"decimal":"disc";return i.jsxs("div",{style:{marginBottom:12},children:[t.title&&i.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),i.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":s},children:r.map((o,a)=>i.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&i.jsx("span",{style:{color:"#10b981"},children:""}),typeof o=="string"?o:typeof o=="object"&&o!==null?i.jsx(U8,{item:o}):String(o)]},(o==null?void 0:o.id)||a))})]})}function U8({item:e}){const t=e.value||e.text||e.constraint||e.assumption||e.guardrail||e.recommendation||e.question||e.description||e.statement||e.name;return t?i.jsxs("span",{children:[e.id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af",marginRight:6},children:e.id}),t,e.constraint_type&&i.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.constraint_type}),e.confidence&&i.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:e.confidence==="high"?"#dcfce7":e.confidence==="medium"?"#fef3c7":"#fee2e2",color:e.confidence==="high"?"#166534":e.confidence==="medium"?"#92400e":"#991b1b"},children:e.confidence}),e.validation_approach&&i.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:[i.jsx("span",{style:{fontWeight:500},children:"Validation:"})," ",e.validation_approach]})]}):i.jsx("span",{children:Object.entries(e).map(([r,n],s)=>i.jsxs("span",{children:[s>0&&"  ",i.jsxs("span",{style:{fontWeight:500},children:[r,":"]})," ",typeof n=="string"?n:JSON.stringify(n)]},r))})}function V8({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,o={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&i.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),i.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:o.bg,color:o.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function zE({block:e}){const{data:t}=e,r=t.text||t.question||t.decision_area,{id:n,blocking:s,priority:o,tags:a,options:l}=t,c=t.why_it_matters||t.why_early,d=t.directed_to,u=t.recommendation_direction,f={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},p=f[o]||f.should;return i.jsx("div",{style:{padding:"12px 16px",background:s?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${s?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[i.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:n}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:r}),c&&i.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:c}),i.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[s&&i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),d&&i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:d.replace(/_/g," ")}),o&&i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:p.bg,color:p.text,textTransform:"uppercase"},children:o}),a==null?void 0:a.map((h,v)=>i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:h},v))]}),l&&l.length>0&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("span",{style:{fontSize:11,color:"#6b7280",fontWeight:500},children:"Options: "}),l.map((h,v)=>i.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:v>0?8:4},children:h},v))]}),u&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:"#059669"},children:["Recommendation: ",u]})]})]})})}function G8({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,s=t.blocking_count||r.filter(o=>o.blocking).length;return r.length===0?i.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[i.jsxs("span",{style:{color:"#6b7280"},children:[i.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),s>0&&i.jsxs("span",{style:{color:"#dc2626"},children:[i.jsx("strong",{children:s})," blocking"]})]}),r.map((o,a)=>i.jsx(zE,{block:{type:"schema:OpenQuestionV1",data:o}},o.id||a))]})}function Jb({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const s={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return i.jsxs("div",{style:{marginBottom:12},children:[n&&i.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,a)=>{const l=o.severity||o.impact||o.likelihood||"medium",c=s[l]||s.medium;return i.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[o.id&&i.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:o.id}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:o.risk||o.description||o.reason||JSON.stringify(o)}),o.impact&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",o.impact]}),o.impact_on_planning&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Planning impact: ",o.impact_on_planning]}),(o.mitigation||o.mitigation_direction)&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",o.mitigation||o.mitigation_direction]}),o.status&&i.jsxs("p",{style:{margin:"4px 0 0",fontSize:11,color:c.text,opacity:.7,textTransform:"capitalize"},children:["Status: ",o.status]})]}),i.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},o.id||a)})})]})}function K8({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition",refined_description:"Description",architectural_style:"Architectural Style",style:"Architectural Style"}).filter(([s])=>t[s]&&typeof t[s]=="string").map(([s,o])=>({title:o,content:t[s]}));return n.length===0&&!t.title?null:i.jsxs("div",{style:{marginBottom:12},children:[t.title&&i.jsx("h3",{style:{fontSize:16,fontWeight:600,color:"#1f2937",marginBottom:12},children:t.title}),n.map((s,o)=>i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:s.title}),i.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:i.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:s.content})})]},o))]})}function Y8({block:e}){const{data:t}=e,{story_id:r,title:n,intent:s,phase:o,risk_level:a,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[a]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[o]||u.mvp;return i.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&i.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),i.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),s&&i.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:s})]}),i.jsxs("div",{style:{display:"flex",gap:4},children:[o&&i.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:o}),d&&i.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:a})]})]})})}function X8({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=t.technology||(Array.isArray(t.technology_choices)?t.technology_choices.join(", "):null),n=t.interfaces||[],s=t.dependencies||t.depends_on_components||[],o=t.responsibilities||[],a=t.layer,l=t.mvp_phase,c={fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:2},d={fontSize:13,color:"#374151",lineHeight:1.5,margin:0},u=(f,p)=>({fontSize:12,padding:"2px 8px",background:f,color:p,borderRadius:4});return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[i.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),a&&i.jsx("span",{style:u("#f0fdf4","#166534"),children:a}),l&&i.jsx("span",{style:u("#eff6ff","#1e40af"),children:l})]}),t.purpose&&i.jsx("p",{style:{...d,marginBottom:10,color:"#475569"},children:t.purpose}),r&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:c,children:"Technology"}),i.jsx("p",{style:d,children:r})]}),Array.isArray(o)&&o.length>0&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:c,children:"Responsibilities"}),i.jsx("ul",{style:{margin:0,paddingLeft:18},children:o.map((f,p)=>i.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:f},p))})]}),Array.isArray(n)&&n.length>0&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:c,children:"Interfaces"}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:n.map((f,p)=>i.jsx("span",{style:u("#e0e7ff","#3730a3"),children:f},p))})]}),Array.isArray(s)&&s.length>0&&i.jsxs("div",{children:[i.jsx("div",{style:c,children:"Dependencies"}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:s.map((f,p)=>i.jsx("span",{style:u("#fef3c7","#92400e"),children:f},p))})]})]})}function fy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xd,e1;function Q8(){if(e1)return xd;e1=1;function e(){this.__data__=[],this.size=0}return xd=e,xd}var vd,t1;function Mo(){if(t1)return vd;t1=1;function e(t,r){return t===r||t!==t&&r!==r}return vd=e,vd}var yd,r1;function su(){if(r1)return yd;r1=1;var e=Mo();function t(r,n){for(var s=r.length;s--;)if(e(r[s][0],n))return s;return-1}return yd=t,yd}var bd,n1;function Z8(){if(n1)return bd;n1=1;var e=su(),t=Array.prototype,r=t.splice;function n(s){var o=this.__data__,a=e(o,s);if(a<0)return!1;var l=o.length-1;return a==l?o.pop():r.call(o,a,1),--this.size,!0}return bd=n,bd}var _d,s1;function J8(){if(s1)return _d;s1=1;var e=su();function t(r){var n=this.__data__,s=e(n,r);return s<0?void 0:n[s][1]}return _d=t,_d}var wd,o1;function eD(){if(o1)return wd;o1=1;var e=su();function t(r){return e(this.__data__,r)>-1}return wd=t,wd}var jd,i1;function tD(){if(i1)return jd;i1=1;var e=su();function t(r,n){var s=this.__data__,o=e(s,r);return o<0?(++this.size,s.push([r,n])):s[o][1]=n,this}return jd=t,jd}var Sd,a1;function ou(){if(a1)return Sd;a1=1;var e=Q8(),t=Z8(),r=J8(),n=eD(),s=tD();function o(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,Sd=o,Sd}var kd,l1;function rD(){if(l1)return kd;l1=1;var e=ou();function t(){this.__data__=new e,this.size=0}return kd=t,kd}var Nd,c1;function nD(){if(c1)return Nd;c1=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Nd=e,Nd}var Cd,u1;function sD(){if(u1)return Cd;u1=1;function e(t){return this.__data__.get(t)}return Cd=e,Cd}var Ed,d1;function oD(){if(d1)return Ed;d1=1;function e(t){return this.__data__.has(t)}return Ed=e,Ed}var Td,f1;function FE(){if(f1)return Td;f1=1;var e=typeof Ia=="object"&&Ia&&Ia.Object===Object&&Ia;return Td=e,Td}var Rd,p1;function Mr(){if(p1)return Rd;p1=1;var e=FE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Rd=r,Rd}var Ad,h1;function Do(){if(h1)return Ad;h1=1;var e=Mr(),t=e.Symbol;return Ad=t,Ad}var Id,m1;function iD(){if(m1)return Id;m1=1;var e=Do(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,s=e?e.toStringTag:void 0;function o(a){var l=r.call(a,s),c=a[s];try{a[s]=void 0;var d=!0}catch{}var u=n.call(a);return d&&(l?a[s]=c:delete a[s]),u}return Id=o,Id}var Pd,g1;function aD(){if(g1)return Pd;g1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Pd=r,Pd}var Od,x1;function Rs(){if(x1)return Od;x1=1;var e=Do(),t=iD(),r=aD(),n="[object Null]",s="[object Undefined]",o=e?e.toStringTag:void 0;function a(l){return l==null?l===void 0?s:n:o&&o in Object(l)?t(l):r(l)}return Od=a,Od}var Md,v1;function br(){if(v1)return Md;v1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Md=e,Md}var Dd,y1;function ja(){if(y1)return Dd;y1=1;var e=Rs(),t=br(),r="[object AsyncFunction]",n="[object Function]",s="[object GeneratorFunction]",o="[object Proxy]";function a(l){if(!t(l))return!1;var c=e(l);return c==n||c==s||c==r||c==o}return Dd=a,Dd}var Ld,b1;function lD(){if(b1)return Ld;b1=1;var e=Mr(),t=e["__core-js_shared__"];return Ld=t,Ld}var zd,_1;function cD(){if(_1)return zd;_1=1;var e=lD(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return zd=r,zd}var Fd,w1;function $E(){if(w1)return Fd;w1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Fd=r,Fd}var $d,j1;function uD(){if(j1)return $d;j1=1;var e=ja(),t=cD(),r=br(),n=$E(),s=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,a=Function.prototype,l=Object.prototype,c=a.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?u:o;return h.test(n(p))}return $d=f,$d}var qd,S1;function dD(){if(S1)return qd;S1=1;function e(t,r){return t==null?void 0:t[r]}return qd=e,qd}var Bd,k1;function As(){if(k1)return Bd;k1=1;var e=uD(),t=dD();function r(n,s){var o=t(n,s);return e(o)?o:void 0}return Bd=r,Bd}var Wd,N1;function py(){if(N1)return Wd;N1=1;var e=As(),t=Mr(),r=e(t,"Map");return Wd=r,Wd}var Hd,C1;function iu(){if(C1)return Hd;C1=1;var e=As(),t=e(Object,"create");return Hd=t,Hd}var Ud,E1;function fD(){if(E1)return Ud;E1=1;var e=iu();function t(){this.__data__=e?e(null):{},this.size=0}return Ud=t,Ud}var Vd,T1;function pD(){if(T1)return Vd;T1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Vd=e,Vd}var Gd,R1;function hD(){if(R1)return Gd;R1=1;var e=iu(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function s(o){var a=this.__data__;if(e){var l=a[o];return l===t?void 0:l}return n.call(a,o)?a[o]:void 0}return Gd=s,Gd}var Kd,A1;function mD(){if(A1)return Kd;A1=1;var e=iu(),t=Object.prototype,r=t.hasOwnProperty;function n(s){var o=this.__data__;return e?o[s]!==void 0:r.call(o,s)}return Kd=n,Kd}var Yd,I1;function gD(){if(I1)return Yd;I1=1;var e=iu(),t="__lodash_hash_undefined__";function r(n,s){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=e&&s===void 0?t:s,this}return Yd=r,Yd}var Xd,P1;function xD(){if(P1)return Xd;P1=1;var e=fD(),t=pD(),r=hD(),n=mD(),s=gD();function o(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,Xd=o,Xd}var Qd,O1;function vD(){if(O1)return Qd;O1=1;var e=xD(),t=ou(),r=py();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Qd=n,Qd}var Zd,M1;function yD(){if(M1)return Zd;M1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Zd=e,Zd}var Jd,D1;function au(){if(D1)return Jd;D1=1;var e=yD();function t(r,n){var s=r.__data__;return e(n)?s[typeof n=="string"?"string":"hash"]:s.map}return Jd=t,Jd}var ef,L1;function bD(){if(L1)return ef;L1=1;var e=au();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return ef=t,ef}var tf,z1;function _D(){if(z1)return tf;z1=1;var e=au();function t(r){return e(this,r).get(r)}return tf=t,tf}var rf,F1;function wD(){if(F1)return rf;F1=1;var e=au();function t(r){return e(this,r).has(r)}return rf=t,rf}var nf,$1;function jD(){if($1)return nf;$1=1;var e=au();function t(r,n){var s=e(this,r),o=s.size;return s.set(r,n),this.size+=s.size==o?0:1,this}return nf=t,nf}var sf,q1;function hy(){if(q1)return sf;q1=1;var e=vD(),t=bD(),r=_D(),n=wD(),s=jD();function o(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,sf=o,sf}var of,B1;function SD(){if(B1)return of;B1=1;var e=ou(),t=py(),r=hy(),n=200;function s(o,a){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([o,a]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(o,a),this.size=l.size,this}return of=s,of}var af,W1;function lu(){if(W1)return af;W1=1;var e=ou(),t=rD(),r=nD(),n=sD(),s=oD(),o=SD();function a(l){var c=this.__data__=new e(l);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=r,a.prototype.get=n,a.prototype.has=s,a.prototype.set=o,af=a,af}var lf,H1;function my(){if(H1)return lf;H1=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s&&r(t[n],n,t)!==!1;);return t}return lf=e,lf}var cf,U1;function qE(){if(U1)return cf;U1=1;var e=As(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return cf=t,cf}var uf,V1;function cu(){if(V1)return uf;V1=1;var e=qE();function t(r,n,s){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:s,writable:!0}):r[n]=s}return uf=t,uf}var df,G1;function uu(){if(G1)return df;G1=1;var e=cu(),t=Mo(),r=Object.prototype,n=r.hasOwnProperty;function s(o,a,l){var c=o[a];(!(n.call(o,a)&&t(c,l))||l===void 0&&!(a in o))&&e(o,a,l)}return df=s,df}var ff,K1;function Sa(){if(K1)return ff;K1=1;var e=uu(),t=cu();function r(n,s,o,a){var l=!o;o||(o={});for(var c=-1,d=s.length;++c<d;){var u=s[c],f=a?a(o[u],n[u],u,o,n):void 0;f===void 0&&(f=n[u]),l?t(o,u,f):e(o,u,f)}return o}return ff=r,ff}var pf,Y1;function kD(){if(Y1)return pf;Y1=1;function e(t,r){for(var n=-1,s=Array(t);++n<t;)s[n]=r(n);return s}return pf=e,pf}var hf,X1;function Xr(){if(X1)return hf;X1=1;function e(t){return t!=null&&typeof t=="object"}return hf=e,hf}var mf,Q1;function ND(){if(Q1)return mf;Q1=1;var e=Rs(),t=Xr(),r="[object Arguments]";function n(s){return t(s)&&e(s)==r}return mf=n,mf}var gf,Z1;function ka(){if(Z1)return gf;Z1=1;var e=ND(),t=Xr(),r=Object.prototype,n=r.hasOwnProperty,s=r.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(a){return t(a)&&n.call(a,"callee")&&!s.call(a,"callee")};return gf=o,gf}var xf,J1;function ft(){if(J1)return xf;J1=1;var e=Array.isArray;return xf=e,xf}var gi={exports:{}},vf,e_;function CD(){if(e_)return vf;e_=1;function e(){return!1}return vf=e,vf}gi.exports;var t_;function Lo(){return t_||(t_=1,function(e,t){var r=Mr(),n=CD(),s=t&&!t.nodeType&&t,o=s&&!0&&e&&!e.nodeType&&e,a=o&&o.exports===s,l=a?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d}(gi,gi.exports)),gi.exports}var yf,r_;function du(){if(r_)return yf;r_=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,s){var o=typeof n;return s=s??e,!!s&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<s}return yf=r,yf}var bf,n_;function gy(){if(n_)return bf;n_=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return bf=t,bf}var _f,s_;function ED(){if(s_)return _f;s_=1;var e=Rs(),t=gy(),r=Xr(),n="[object Arguments]",s="[object Array]",o="[object Boolean]",a="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",v="[object String]",g="[object WeakMap]",_="[object ArrayBuffer]",x="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",j="[object Int8Array]",k="[object Int16Array]",N="[object Int32Array]",S="[object Uint8Array]",C="[object Uint8ClampedArray]",w="[object Uint16Array]",A="[object Uint32Array]",T={};T[y]=T[b]=T[j]=T[k]=T[N]=T[S]=T[C]=T[w]=T[A]=!0,T[n]=T[s]=T[_]=T[o]=T[x]=T[a]=T[l]=T[c]=T[d]=T[u]=T[f]=T[p]=T[h]=T[v]=T[g]=!1;function D($){return r($)&&t($.length)&&!!T[e($)]}return _f=D,_f}var wf,o_;function fu(){if(o_)return wf;o_=1;function e(t){return function(r){return t(r)}}return wf=e,wf}var xi={exports:{}};xi.exports;var i_;function xy(){return i_||(i_=1,function(e,t){var r=FE(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,a=o&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=l}(xi,xi.exports)),xi.exports}var jf,a_;function Na(){if(a_)return jf;a_=1;var e=ED(),t=fu(),r=xy(),n=r&&r.isTypedArray,s=n?t(n):e;return jf=s,jf}var Sf,l_;function BE(){if(l_)return Sf;l_=1;var e=kD(),t=ka(),r=ft(),n=Lo(),s=du(),o=Na(),a=Object.prototype,l=a.hasOwnProperty;function c(d,u){var f=r(d),p=!f&&t(d),h=!f&&!p&&n(d),v=!f&&!p&&!h&&o(d),g=f||p||h||v,_=g?e(d.length,String):[],x=_.length;for(var y in d)(u||l.call(d,y))&&!(g&&(y=="length"||h&&(y=="offset"||y=="parent")||v&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||s(y,x)))&&_.push(y);return _}return Sf=c,Sf}var kf,c_;function pu(){if(c_)return kf;c_=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,s=typeof n=="function"&&n.prototype||e;return r===s}return kf=t,kf}var Nf,u_;function WE(){if(u_)return Nf;u_=1;function e(t,r){return function(n){return t(r(n))}}return Nf=e,Nf}var Cf,d_;function TD(){if(d_)return Cf;d_=1;var e=WE(),t=e(Object.keys,Object);return Cf=t,Cf}var Ef,f_;function vy(){if(f_)return Ef;f_=1;var e=pu(),t=TD(),r=Object.prototype,n=r.hasOwnProperty;function s(o){if(!e(o))return t(o);var a=[];for(var l in Object(o))n.call(o,l)&&l!="constructor"&&a.push(l);return a}return Ef=s,Ef}var Tf,p_;function bn(){if(p_)return Tf;p_=1;var e=ja(),t=gy();function r(n){return n!=null&&t(n.length)&&!e(n)}return Tf=r,Tf}var Rf,h_;function rs(){if(h_)return Rf;h_=1;var e=BE(),t=vy(),r=bn();function n(s){return r(s)?e(s):t(s)}return Rf=n,Rf}var Af,m_;function RD(){if(m_)return Af;m_=1;var e=Sa(),t=rs();function r(n,s){return n&&e(s,t(s),n)}return Af=r,Af}var If,g_;function AD(){if(g_)return If;g_=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return If=e,If}var Pf,x_;function ID(){if(x_)return Pf;x_=1;var e=br(),t=pu(),r=AD(),n=Object.prototype,s=n.hasOwnProperty;function o(a){if(!e(a))return r(a);var l=t(a),c=[];for(var d in a)d=="constructor"&&(l||!s.call(a,d))||c.push(d);return c}return Pf=o,Pf}var Of,v_;function Is(){if(v_)return Of;v_=1;var e=BE(),t=ID(),r=bn();function n(s){return r(s)?e(s,!0):t(s)}return Of=n,Of}var Mf,y_;function PD(){if(y_)return Mf;y_=1;var e=Sa(),t=Is();function r(n,s){return n&&e(s,t(s),n)}return Mf=r,Mf}var vi={exports:{}};vi.exports;var b_;function HE(){return b_||(b_=1,function(e,t){var r=Mr(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,a=o?r.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(vi,vi.exports)),vi.exports}var Df,__;function UE(){if(__)return Df;__=1;function e(t,r){var n=-1,s=t.length;for(r||(r=Array(s));++n<s;)r[n]=t[n];return r}return Df=e,Df}var Lf,w_;function VE(){if(w_)return Lf;w_=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=0,a=[];++n<s;){var l=t[n];r(l,n,t)&&(a[o++]=l)}return a}return Lf=e,Lf}var zf,j_;function GE(){if(j_)return zf;j_=1;function e(){return[]}return zf=e,zf}var Ff,S_;function yy(){if(S_)return Ff;S_=1;var e=VE(),t=GE(),r=Object.prototype,n=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,o=s?function(a){return a==null?[]:(a=Object(a),e(s(a),function(l){return n.call(a,l)}))}:t;return Ff=o,Ff}var $f,k_;function OD(){if(k_)return $f;k_=1;var e=Sa(),t=yy();function r(n,s){return e(n,t(n),s)}return $f=r,$f}var qf,N_;function by(){if(N_)return qf;N_=1;function e(t,r){for(var n=-1,s=r.length,o=t.length;++n<s;)t[o+n]=r[n];return t}return qf=e,qf}var Bf,C_;function hu(){if(C_)return Bf;C_=1;var e=WE(),t=e(Object.getPrototypeOf,Object);return Bf=t,Bf}var Wf,E_;function KE(){if(E_)return Wf;E_=1;var e=by(),t=hu(),r=yy(),n=GE(),s=Object.getOwnPropertySymbols,o=s?function(a){for(var l=[];a;)e(l,r(a)),a=t(a);return l}:n;return Wf=o,Wf}var Hf,T_;function MD(){if(T_)return Hf;T_=1;var e=Sa(),t=KE();function r(n,s){return e(n,t(n),s)}return Hf=r,Hf}var Uf,R_;function YE(){if(R_)return Uf;R_=1;var e=by(),t=ft();function r(n,s,o){var a=s(n);return t(n)?a:e(a,o(n))}return Uf=r,Uf}var Vf,A_;function XE(){if(A_)return Vf;A_=1;var e=YE(),t=yy(),r=rs();function n(s){return e(s,r,t)}return Vf=n,Vf}var Gf,I_;function DD(){if(I_)return Gf;I_=1;var e=YE(),t=KE(),r=Is();function n(s){return e(s,r,t)}return Gf=n,Gf}var Kf,P_;function LD(){if(P_)return Kf;P_=1;var e=As(),t=Mr(),r=e(t,"DataView");return Kf=r,Kf}var Yf,O_;function zD(){if(O_)return Yf;O_=1;var e=As(),t=Mr(),r=e(t,"Promise");return Yf=r,Yf}var Xf,M_;function QE(){if(M_)return Xf;M_=1;var e=As(),t=Mr(),r=e(t,"Set");return Xf=r,Xf}var Qf,D_;function FD(){if(D_)return Qf;D_=1;var e=As(),t=Mr(),r=e(t,"WeakMap");return Qf=r,Qf}var Zf,L_;function zo(){if(L_)return Zf;L_=1;var e=LD(),t=py(),r=zD(),n=QE(),s=FD(),o=Rs(),a=$E(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=a(e),v=a(t),g=a(r),_=a(n),x=a(s),y=o;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||r&&y(r.resolve())!=d||n&&y(new n)!=u||s&&y(new s)!=f)&&(y=function(b){var j=o(b),k=j==c?b.constructor:void 0,N=k?a(k):"";if(N)switch(N){case h:return p;case v:return l;case g:return d;case _:return u;case x:return f}return j}),Zf=y,Zf}var Jf,z_;function $D(){if(z_)return Jf;z_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var s=n.length,o=new n.constructor(s);return s&&typeof n[0]=="string"&&t.call(n,"index")&&(o.index=n.index,o.input=n.input),o}return Jf=r,Jf}var ep,F_;function ZE(){if(F_)return ep;F_=1;var e=Mr(),t=e.Uint8Array;return ep=t,ep}var tp,$_;function _y(){if($_)return tp;$_=1;var e=ZE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return tp=t,tp}var rp,q_;function qD(){if(q_)return rp;q_=1;var e=_y();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.byteLength)}return rp=t,rp}var np,B_;function BD(){if(B_)return np;B_=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return np=t,np}var sp,W_;function WD(){if(W_)return sp;W_=1;var e=Do(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(s){return r?Object(r.call(s)):{}}return sp=n,sp}var op,H_;function JE(){if(H_)return op;H_=1;var e=_y();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.length)}return op=t,op}var ip,U_;function HD(){if(U_)return ip;U_=1;var e=_y(),t=qD(),r=BD(),n=WD(),s=JE(),o="[object Boolean]",a="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",v="[object DataView]",g="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",j="[object Uint8Array]",k="[object Uint8ClampedArray]",N="[object Uint16Array]",S="[object Uint32Array]";function C(w,A,T){var D=w.constructor;switch(A){case h:return e(w);case o:case a:return new D(+w);case v:return t(w,T);case g:case _:case x:case y:case b:case j:case k:case N:case S:return s(w,T);case l:return new D;case c:case f:return new D(w);case d:return r(w);case u:return new D;case p:return n(w)}}return ip=C,ip}var ap,V_;function e4(){if(V_)return ap;V_=1;var e=br(),t=Object.create,r=function(){function n(){}return function(s){if(!e(s))return{};if(t)return t(s);n.prototype=s;var o=new n;return n.prototype=void 0,o}}();return ap=r,ap}var lp,G_;function t4(){if(G_)return lp;G_=1;var e=e4(),t=hu(),r=pu();function n(s){return typeof s.constructor=="function"&&!r(s)?e(t(s)):{}}return lp=n,lp}var cp,K_;function UD(){if(K_)return cp;K_=1;var e=zo(),t=Xr(),r="[object Map]";function n(s){return t(s)&&e(s)==r}return cp=n,cp}var up,Y_;function VD(){if(Y_)return up;Y_=1;var e=UD(),t=fu(),r=xy(),n=r&&r.isMap,s=n?t(n):e;return up=s,up}var dp,X_;function GD(){if(X_)return dp;X_=1;var e=zo(),t=Xr(),r="[object Set]";function n(s){return t(s)&&e(s)==r}return dp=n,dp}var fp,Q_;function KD(){if(Q_)return fp;Q_=1;var e=GD(),t=fu(),r=xy(),n=r&&r.isSet,s=n?t(n):e;return fp=s,fp}var pp,Z_;function r4(){if(Z_)return pp;Z_=1;var e=lu(),t=my(),r=uu(),n=RD(),s=PD(),o=HE(),a=UE(),l=OD(),c=MD(),d=XE(),u=DD(),f=zo(),p=$D(),h=HD(),v=t4(),g=ft(),_=Lo(),x=VD(),y=br(),b=KD(),j=rs(),k=Is(),N=1,S=2,C=4,w="[object Arguments]",A="[object Array]",T="[object Boolean]",D="[object Date]",$="[object Error]",E="[object Function]",P="[object GeneratorFunction]",R="[object Map]",L="[object Number]",M="[object Object]",I="[object RegExp]",O="[object Set]",F="[object String]",q="[object Symbol]",H="[object WeakMap]",V="[object ArrayBuffer]",Z="[object DataView]",B="[object Float32Array]",re="[object Float64Array]",oe="[object Int8Array]",X="[object Int16Array]",Q="[object Int32Array]",fe="[object Uint8Array]",ge="[object Uint8ClampedArray]",be="[object Uint16Array]",ye="[object Uint32Array]",ae={};ae[w]=ae[A]=ae[V]=ae[Z]=ae[T]=ae[D]=ae[B]=ae[re]=ae[oe]=ae[X]=ae[Q]=ae[R]=ae[L]=ae[M]=ae[I]=ae[O]=ae[F]=ae[q]=ae[fe]=ae[ge]=ae[be]=ae[ye]=!0,ae[$]=ae[E]=ae[H]=!1;function K(te,ee,ke,je,Te,Ne){var ne,Se=ee&N,Ve=ee&S,ct=ee&C;if(ke&&(ne=Te?ke(te,je,Te,Ne):ke(te)),ne!==void 0)return ne;if(!y(te))return te;var We=g(te);if(We){if(ne=p(te),!Se)return a(te,ne)}else{var Pe=f(te),ie=Pe==E||Pe==P;if(_(te))return o(te,Se);if(Pe==M||Pe==w||ie&&!Te){if(ne=Ve||ie?{}:v(te),!Se)return Ve?c(te,s(ne,te)):l(te,n(ne,te))}else{if(!ae[Pe])return Te?te:{};ne=h(te,Pe,Se)}}Ne||(Ne=new e);var xe=Ne.get(te);if(xe)return xe;Ne.set(te,ne),b(te)?te.forEach(function(ve){ne.add(K(ve,ee,ke,ve,te,Ne))}):x(te)&&te.forEach(function(ve,he){ne.set(he,K(ve,ee,ke,he,te,Ne))});var pe=ct?Ve?u:d:Ve?k:j,U=We?void 0:pe(te);return t(U||te,function(ve,he){U&&(he=ve,ve=te[he]),r(ne,he,K(ve,ee,ke,he,te,Ne))}),ne}return pp=K,pp}var hp,J_;function YD(){if(J_)return hp;J_=1;var e=r4(),t=4;function r(n){return e(n,t)}return hp=r,hp}var mp,ew;function wy(){if(ew)return mp;ew=1;function e(t){return function(){return t}}return mp=e,mp}var gp,tw;function XD(){if(tw)return gp;tw=1;function e(t){return function(r,n,s){for(var o=-1,a=Object(r),l=s(r),c=l.length;c--;){var d=l[t?c:++o];if(n(a[d],d,a)===!1)break}return r}}return gp=e,gp}var xp,rw;function jy(){if(rw)return xp;rw=1;var e=XD(),t=e();return xp=t,xp}var vp,nw;function Sy(){if(nw)return vp;nw=1;var e=jy(),t=rs();function r(n,s){return n&&e(n,s,t)}return vp=r,vp}var yp,sw;function QD(){if(sw)return yp;sw=1;var e=bn();function t(r,n){return function(s,o){if(s==null)return s;if(!e(s))return r(s,o);for(var a=s.length,l=n?a:-1,c=Object(s);(n?l--:++l<a)&&o(c[l],l,c)!==!1;);return s}}return yp=t,yp}var bp,ow;function mu(){if(ow)return bp;ow=1;var e=Sy(),t=QD(),r=t(e);return bp=r,bp}var _p,iw;function Ps(){if(iw)return _p;iw=1;function e(t){return t}return _p=e,_p}var wp,aw;function n4(){if(aw)return wp;aw=1;var e=Ps();function t(r){return typeof r=="function"?r:e}return wp=t,wp}var jp,lw;function s4(){if(lw)return jp;lw=1;var e=my(),t=mu(),r=n4(),n=ft();function s(o,a){var l=n(o)?e:t;return l(o,r(a))}return jp=s,jp}var Sp,cw;function o4(){return cw||(cw=1,Sp=s4()),Sp}var kp,uw;function ZD(){if(uw)return kp;uw=1;var e=mu();function t(r,n){var s=[];return e(r,function(o,a,l){n(o,a,l)&&s.push(o)}),s}return kp=t,kp}var Np,dw;function JD(){if(dw)return Np;dw=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Np=t,Np}var Cp,fw;function eL(){if(fw)return Cp;fw=1;function e(t){return this.__data__.has(t)}return Cp=e,Cp}var Ep,pw;function i4(){if(pw)return Ep;pw=1;var e=hy(),t=JD(),r=eL();function n(s){var o=-1,a=s==null?0:s.length;for(this.__data__=new e;++o<a;)this.add(s[o])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,Ep=n,Ep}var Tp,hw;function tL(){if(hw)return Tp;hw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s;)if(r(t[n],n,t))return!0;return!1}return Tp=e,Tp}var Rp,mw;function a4(){if(mw)return Rp;mw=1;function e(t,r){return t.has(r)}return Rp=e,Rp}var Ap,gw;function l4(){if(gw)return Ap;gw=1;var e=i4(),t=tL(),r=a4(),n=1,s=2;function o(a,l,c,d,u,f){var p=c&n,h=a.length,v=l.length;if(h!=v&&!(p&&v>h))return!1;var g=f.get(a),_=f.get(l);if(g&&_)return g==l&&_==a;var x=-1,y=!0,b=c&s?new e:void 0;for(f.set(a,l),f.set(l,a);++x<h;){var j=a[x],k=l[x];if(d)var N=p?d(k,j,x,l,a,f):d(j,k,x,a,l,f);if(N!==void 0){if(N)continue;y=!1;break}if(b){if(!t(l,function(S,C){if(!r(b,C)&&(j===S||u(j,S,c,d,f)))return b.push(C)})){y=!1;break}}else if(!(j===k||u(j,k,c,d,f))){y=!1;break}}return f.delete(a),f.delete(l),y}return Ap=o,Ap}var Ip,xw;function rL(){if(xw)return Ip;xw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s,o){n[++r]=[o,s]}),n}return Ip=e,Ip}var Pp,vw;function ky(){if(vw)return Pp;vw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s){n[++r]=s}),n}return Pp=e,Pp}var Op,yw;function nL(){if(yw)return Op;yw=1;var e=Do(),t=ZE(),r=Mo(),n=l4(),s=rL(),o=ky(),a=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",v="[object Set]",g="[object String]",_="[object Symbol]",x="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,j=b?b.valueOf:void 0;function k(N,S,C,w,A,T,D){switch(C){case y:if(N.byteLength!=S.byteLength||N.byteOffset!=S.byteOffset)return!1;N=N.buffer,S=S.buffer;case x:return!(N.byteLength!=S.byteLength||!T(new t(N),new t(S)));case c:case d:case p:return r(+N,+S);case u:return N.name==S.name&&N.message==S.message;case h:case g:return N==S+"";case f:var $=s;case v:var E=w&a;if($||($=o),N.size!=S.size&&!E)return!1;var P=D.get(N);if(P)return P==S;w|=l,D.set(N,S);var R=n($(N),$(S),w,A,T,D);return D.delete(N),R;case _:if(j)return j.call(N)==j.call(S)}return!1}return Op=k,Op}var Mp,bw;function sL(){if(bw)return Mp;bw=1;var e=XE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function s(o,a,l,c,d,u){var f=l&t,p=e(o),h=p.length,v=e(a),g=v.length;if(h!=g&&!f)return!1;for(var _=h;_--;){var x=p[_];if(!(f?x in a:n.call(a,x)))return!1}var y=u.get(o),b=u.get(a);if(y&&b)return y==a&&b==o;var j=!0;u.set(o,a),u.set(a,o);for(var k=f;++_<h;){x=p[_];var N=o[x],S=a[x];if(c)var C=f?c(S,N,x,a,o,u):c(N,S,x,o,a,u);if(!(C===void 0?N===S||d(N,S,l,c,u):C)){j=!1;break}k||(k=x=="constructor")}if(j&&!k){var w=o.constructor,A=a.constructor;w!=A&&"constructor"in o&&"constructor"in a&&!(typeof w=="function"&&w instanceof w&&typeof A=="function"&&A instanceof A)&&(j=!1)}return u.delete(o),u.delete(a),j}return Mp=s,Mp}var Dp,_w;function oL(){if(_w)return Dp;_w=1;var e=lu(),t=l4(),r=nL(),n=sL(),s=zo(),o=ft(),a=Lo(),l=Na(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function v(g,_,x,y,b,j){var k=o(g),N=o(_),S=k?u:s(g),C=N?u:s(_);S=S==d?f:S,C=C==d?f:C;var w=S==f,A=C==f,T=S==C;if(T&&a(g)){if(!a(_))return!1;k=!0,w=!1}if(T&&!w)return j||(j=new e),k||l(g)?t(g,_,x,y,b,j):r(g,_,S,x,y,b,j);if(!(x&c)){var D=w&&h.call(g,"__wrapped__"),$=A&&h.call(_,"__wrapped__");if(D||$){var E=D?g.value():g,P=$?_.value():_;return j||(j=new e),b(E,P,x,y,j)}}return T?(j||(j=new e),n(g,_,x,y,b,j)):!1}return Dp=v,Dp}var Lp,ww;function c4(){if(ww)return Lp;ww=1;var e=oL(),t=Xr();function r(n,s,o,a,l){return n===s?!0:n==null||s==null||!t(n)&&!t(s)?n!==n&&s!==s:e(n,s,o,a,r,l)}return Lp=r,Lp}var zp,jw;function iL(){if(jw)return zp;jw=1;var e=lu(),t=c4(),r=1,n=2;function s(o,a,l,c){var d=l.length,u=d,f=!c;if(o==null)return!u;for(o=Object(o);d--;){var p=l[d];if(f&&p[2]?p[1]!==o[p[0]]:!(p[0]in o))return!1}for(;++d<u;){p=l[d];var h=p[0],v=o[h],g=p[1];if(f&&p[2]){if(v===void 0&&!(h in o))return!1}else{var _=new e;if(c)var x=c(v,g,h,o,a,_);if(!(x===void 0?t(g,v,r|n,c,_):x))return!1}}return!0}return zp=s,zp}var Fp,Sw;function u4(){if(Sw)return Fp;Sw=1;var e=br();function t(r){return r===r&&!e(r)}return Fp=t,Fp}var $p,kw;function aL(){if(kw)return $p;kw=1;var e=u4(),t=rs();function r(n){for(var s=t(n),o=s.length;o--;){var a=s[o],l=n[a];s[o]=[a,l,e(l)]}return s}return $p=r,$p}var qp,Nw;function d4(){if(Nw)return qp;Nw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return qp=e,qp}var Bp,Cw;function lL(){if(Cw)return Bp;Cw=1;var e=iL(),t=aL(),r=d4();function n(s){var o=t(s);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(a){return a===s||e(a,s,o)}}return Bp=n,Bp}var Wp,Ew;function Fo(){if(Ew)return Wp;Ew=1;var e=Rs(),t=Xr(),r="[object Symbol]";function n(s){return typeof s=="symbol"||t(s)&&e(s)==r}return Wp=n,Wp}var Hp,Tw;function Ny(){if(Tw)return Hp;Tw=1;var e=ft(),t=Fo(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(o,a){if(e(o))return!1;var l=typeof o;return l=="number"||l=="symbol"||l=="boolean"||o==null||t(o)?!0:n.test(o)||!r.test(o)||a!=null&&o in Object(a)}return Hp=s,Hp}var Up,Rw;function cL(){if(Rw)return Up;Rw=1;var e=hy(),t="Expected a function";function r(n,s){if(typeof n!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var o=function(){var a=arguments,l=s?s.apply(this,a):a[0],c=o.cache;if(c.has(l))return c.get(l);var d=n.apply(this,a);return o.cache=c.set(l,d)||c,d};return o.cache=new(r.Cache||e),o}return r.Cache=e,Up=r,Up}var Vp,Aw;function uL(){if(Aw)return Vp;Aw=1;var e=cL(),t=500;function r(n){var s=e(n,function(a){return o.size===t&&o.clear(),a}),o=s.cache;return s}return Vp=r,Vp}var Gp,Iw;function dL(){if(Iw)return Gp;Iw=1;var e=uL(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(s){var o=[];return s.charCodeAt(0)===46&&o.push(""),s.replace(t,function(a,l,c,d){o.push(c?d.replace(r,"$1"):l||a)}),o});return Gp=n,Gp}var Kp,Pw;function gu(){if(Pw)return Kp;Pw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=Array(s);++n<s;)o[n]=r(t[n],n,t);return o}return Kp=e,Kp}var Yp,Ow;function fL(){if(Ow)return Yp;Ow=1;var e=Do(),t=gu(),r=ft(),n=Fo(),s=e?e.prototype:void 0,o=s?s.toString:void 0;function a(l){if(typeof l=="string")return l;if(r(l))return t(l,a)+"";if(n(l))return o?o.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Yp=a,Yp}var Xp,Mw;function f4(){if(Mw)return Xp;Mw=1;var e=fL();function t(r){return r==null?"":e(r)}return Xp=t,Xp}var Qp,Dw;function xu(){if(Dw)return Qp;Dw=1;var e=ft(),t=Ny(),r=dL(),n=f4();function s(o,a){return e(o)?o:t(o,a)?[o]:r(n(o))}return Qp=s,Qp}var Zp,Lw;function Ca(){if(Lw)return Zp;Lw=1;var e=Fo();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Zp=t,Zp}var Jp,zw;function vu(){if(zw)return Jp;zw=1;var e=xu(),t=Ca();function r(n,s){s=e(s,n);for(var o=0,a=s.length;n!=null&&o<a;)n=n[t(s[o++])];return o&&o==a?n:void 0}return Jp=r,Jp}var eh,Fw;function pL(){if(Fw)return eh;Fw=1;var e=vu();function t(r,n,s){var o=r==null?void 0:e(r,n);return o===void 0?s:o}return eh=t,eh}var th,$w;function hL(){if($w)return th;$w=1;function e(t,r){return t!=null&&r in Object(t)}return th=e,th}var rh,qw;function p4(){if(qw)return rh;qw=1;var e=xu(),t=ka(),r=ft(),n=du(),s=gy(),o=Ca();function a(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=o(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&s(f)&&n(h,f)&&(r(l)||t(l)))}return rh=a,rh}var nh,Bw;function h4(){if(Bw)return nh;Bw=1;var e=hL(),t=p4();function r(n,s){return n!=null&&t(n,s,e)}return nh=r,nh}var sh,Ww;function mL(){if(Ww)return sh;Ww=1;var e=c4(),t=pL(),r=h4(),n=Ny(),s=u4(),o=d4(),a=Ca(),l=1,c=2;function d(u,f){return n(u)&&s(f)?o(a(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?r(p,u):e(f,h,l|c)}}return sh=d,sh}var oh,Hw;function m4(){if(Hw)return oh;Hw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return oh=e,oh}var ih,Uw;function gL(){if(Uw)return ih;Uw=1;var e=vu();function t(r){return function(n){return e(n,r)}}return ih=t,ih}var ah,Vw;function xL(){if(Vw)return ah;Vw=1;var e=m4(),t=gL(),r=Ny(),n=Ca();function s(o){return r(o)?e(n(o)):t(o)}return ah=s,ah}var lh,Gw;function _n(){if(Gw)return lh;Gw=1;var e=lL(),t=mL(),r=Ps(),n=ft(),s=xL();function o(a){return typeof a=="function"?a:a==null?r:typeof a=="object"?n(a)?t(a[0],a[1]):e(a):s(a)}return lh=o,lh}var ch,Kw;function g4(){if(Kw)return ch;Kw=1;var e=VE(),t=ZD(),r=_n(),n=ft();function s(o,a){var l=n(o)?e:t;return l(o,r(a,3))}return ch=s,ch}var uh,Yw;function vL(){if(Yw)return uh;Yw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,s){return n!=null&&t.call(n,s)}return uh=r,uh}var dh,Xw;function x4(){if(Xw)return dh;Xw=1;var e=vL(),t=p4();function r(n,s){return n!=null&&t(n,s,e)}return dh=r,dh}var fh,Qw;function yL(){if(Qw)return fh;Qw=1;var e=vy(),t=zo(),r=ka(),n=ft(),s=bn(),o=Lo(),a=pu(),l=Na(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(s(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||l(h)||r(h)))return!h.length;var v=t(h);if(v==c||v==d)return!h.size;if(a(h))return!e(h).length;for(var g in h)if(f.call(h,g))return!1;return!0}return fh=p,fh}var ph,Zw;function v4(){if(Zw)return ph;Zw=1;function e(t){return t===void 0}return ph=e,ph}var hh,Jw;function y4(){if(Jw)return hh;Jw=1;var e=mu(),t=bn();function r(n,s){var o=-1,a=t(n)?Array(n.length):[];return e(n,function(l,c,d){a[++o]=s(l,c,d)}),a}return hh=r,hh}var mh,ej;function b4(){if(ej)return mh;ej=1;var e=gu(),t=_n(),r=y4(),n=ft();function s(o,a){var l=n(o)?e:r;return l(o,t(a,3))}return mh=s,mh}var gh,tj;function bL(){if(tj)return gh;tj=1;function e(t,r,n,s){var o=-1,a=t==null?0:t.length;for(s&&a&&(n=t[++o]);++o<a;)n=r(n,t[o],o,t);return n}return gh=e,gh}var xh,rj;function _L(){if(rj)return xh;rj=1;function e(t,r,n,s,o){return o(t,function(a,l,c){n=s?(s=!1,a):r(n,a,l,c)}),n}return xh=e,xh}var vh,nj;function _4(){if(nj)return vh;nj=1;var e=bL(),t=mu(),r=_n(),n=_L(),s=ft();function o(a,l,c){var d=s(a)?e:n,u=arguments.length<3;return d(a,r(l,4),c,u,t)}return vh=o,vh}var yh,sj;function wL(){if(sj)return yh;sj=1;var e=Rs(),t=ft(),r=Xr(),n="[object String]";function s(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==n}return yh=s,yh}var bh,oj;function jL(){if(oj)return bh;oj=1;var e=m4(),t=e("length");return bh=t,bh}var _h,ij;function SL(){if(ij)return _h;ij=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",a="\\u200d",l=RegExp("["+a+e+s+o+"]");function c(d){return l.test(d)}return _h=c,_h}var wh,aj;function kL(){if(aj)return wh;aj=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",a="["+e+"]",l="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",v=d+"?",g="["+o+"]?",_="(?:"+h+"(?:"+[u,f,p].join("|")+")"+g+v+")*",x=g+v+_,y="(?:"+[u+l+"?",l,f,p,a].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+x,"g");function j(k){for(var N=b.lastIndex=0;b.test(k);)++N;return N}return wh=j,wh}var jh,lj;function NL(){if(lj)return jh;lj=1;var e=jL(),t=SL(),r=kL();function n(s){return t(s)?r(s):e(s)}return jh=n,jh}var Sh,cj;function CL(){if(cj)return Sh;cj=1;var e=vy(),t=zo(),r=bn(),n=wL(),s=NL(),o="[object Map]",a="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?s(c):c.length;var d=t(c);return d==o||d==a?c.size:e(c).length}return Sh=l,Sh}var kh,uj;function EL(){if(uj)return kh;uj=1;var e=my(),t=e4(),r=Sy(),n=_n(),s=hu(),o=ft(),a=Lo(),l=ja(),c=br(),d=Na();function u(f,p,h){var v=o(f),g=v||a(f)||d(f);if(p=n(p,4),h==null){var _=f&&f.constructor;g?h=v?new _:[]:c(f)?h=l(_)?t(s(f)):{}:h={}}return(g?e:r)(f,function(x,y,b){return p(h,x,y,b)}),h}return kh=u,kh}var Nh,dj;function TL(){if(dj)return Nh;dj=1;var e=Do(),t=ka(),r=ft(),n=e?e.isConcatSpreadable:void 0;function s(o){return r(o)||t(o)||!!(n&&o&&o[n])}return Nh=s,Nh}var Ch,fj;function Cy(){if(fj)return Ch;fj=1;var e=by(),t=TL();function r(n,s,o,a,l){var c=-1,d=n.length;for(o||(o=t),l||(l=[]);++c<d;){var u=n[c];s>0&&o(u)?s>1?r(u,s-1,o,a,l):e(l,u):a||(l[l.length]=u)}return l}return Ch=r,Ch}var Eh,pj;function RL(){if(pj)return Eh;pj=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Eh=e,Eh}var Th,hj;function w4(){if(hj)return Th;hj=1;var e=RL(),t=Math.max;function r(n,s,o){return s=t(s===void 0?n.length-1:s,0),function(){for(var a=arguments,l=-1,c=t(a.length-s,0),d=Array(c);++l<c;)d[l]=a[s+l];l=-1;for(var u=Array(s+1);++l<s;)u[l]=a[l];return u[s]=o(d),e(n,this,u)}}return Th=r,Th}var Rh,mj;function AL(){if(mj)return Rh;mj=1;var e=wy(),t=qE(),r=Ps(),n=t?function(s,o){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return Rh=n,Rh}var Ah,gj;function IL(){if(gj)return Ah;gj=1;var e=800,t=16,r=Date.now;function n(s){var o=0,a=0;return function(){var l=r(),c=t-(l-a);if(a=l,c>0){if(++o>=e)return arguments[0]}else o=0;return s.apply(void 0,arguments)}}return Ah=n,Ah}var Ih,xj;function j4(){if(xj)return Ih;xj=1;var e=AL(),t=IL(),r=t(e);return Ih=r,Ih}var Ph,vj;function yu(){if(vj)return Ph;vj=1;var e=Ps(),t=w4(),r=j4();function n(s,o){return r(t(s,o,e),s+"")}return Ph=n,Ph}var Oh,yj;function S4(){if(yj)return Oh;yj=1;function e(t,r,n,s){for(var o=t.length,a=n+(s?1:-1);s?a--:++a<o;)if(r(t[a],a,t))return a;return-1}return Oh=e,Oh}var Mh,bj;function PL(){if(bj)return Mh;bj=1;function e(t){return t!==t}return Mh=e,Mh}var Dh,_j;function OL(){if(_j)return Dh;_j=1;function e(t,r,n){for(var s=n-1,o=t.length;++s<o;)if(t[s]===r)return s;return-1}return Dh=e,Dh}var Lh,wj;function ML(){if(wj)return Lh;wj=1;var e=S4(),t=PL(),r=OL();function n(s,o,a){return o===o?r(s,o,a):e(s,t,a)}return Lh=n,Lh}var zh,jj;function DL(){if(jj)return zh;jj=1;var e=ML();function t(r,n){var s=r==null?0:r.length;return!!s&&e(r,n,0)>-1}return zh=t,zh}var Fh,Sj;function LL(){if(Sj)return Fh;Sj=1;function e(t,r,n){for(var s=-1,o=t==null?0:t.length;++s<o;)if(n(r,t[s]))return!0;return!1}return Fh=e,Fh}var $h,kj;function zL(){if(kj)return $h;kj=1;function e(){}return $h=e,$h}var qh,Nj;function FL(){if(Nj)return qh;Nj=1;var e=QE(),t=zL(),r=ky(),n=1/0,s=e&&1/r(new e([,-0]))[1]==n?function(o){return new e(o)}:t;return qh=s,qh}var Bh,Cj;function $L(){if(Cj)return Bh;Cj=1;var e=i4(),t=DL(),r=LL(),n=a4(),s=FL(),o=ky(),a=200;function l(c,d,u){var f=-1,p=t,h=c.length,v=!0,g=[],_=g;if(u)v=!1,p=r;else if(h>=a){var x=d?null:s(c);if(x)return o(x);v=!1,p=n,_=new e}else _=d?[]:g;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,v&&b===b){for(var j=_.length;j--;)if(_[j]===b)continue e;d&&_.push(b),g.push(y)}else p(_,b,u)||(_!==g&&_.push(b),g.push(y))}return g}return Bh=l,Bh}var Wh,Ej;function k4(){if(Ej)return Wh;Ej=1;var e=bn(),t=Xr();function r(n){return t(n)&&e(n)}return Wh=r,Wh}var Hh,Tj;function qL(){if(Tj)return Hh;Tj=1;var e=Cy(),t=yu(),r=$L(),n=k4(),s=t(function(o){return r(e(o,1,n,!0))});return Hh=s,Hh}var Uh,Rj;function BL(){if(Rj)return Uh;Rj=1;var e=gu();function t(r,n){return e(n,function(s){return r[s]})}return Uh=t,Uh}var Vh,Aj;function N4(){if(Aj)return Vh;Aj=1;var e=BL(),t=rs();function r(n){return n==null?[]:e(n,t(n))}return Vh=r,Vh}var Gh,Ij;function _r(){if(Ij)return Gh;Ij=1;var e;if(typeof fy=="function")try{e={clone:YD(),constant:wy(),each:o4(),filter:g4(),has:x4(),isArray:ft(),isEmpty:yL(),isFunction:ja(),isUndefined:v4(),keys:rs(),map:b4(),reduce:_4(),size:CL(),transform:EL(),union:qL(),values:N4()}}catch{}return e||(e=window._),Gh=e,Gh}var Kh,Pj;function Ey(){if(Pj)return Kh;Pj=1;var e=_r();Kh=s;var t="\0",r="\0",n="";function s(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(u){return this._label=u,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},s.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},s.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(v){p.length>1?h.setNode(v,f):h.setNode(v)}),this},s.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=r,this._children[u]={},this._children[r][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},s.prototype.node=function(u){return this._nodes[u]},s.prototype.hasNode=function(u){return e.has(this._nodes,u)},s.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},s.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},s.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},s.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==r)return f}},s.prototype.children=function(u){if(e.isUndefined(u)&&(u=r),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===r)return this.nodes();if(this.hasNode(u))return[]}},s.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},s.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},s.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},s.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},s.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(g,_){u(_)&&f.setNode(_,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,p.edge(g))});var h={};function v(g){var _=p.parent(g);return _===void 0||f.hasNode(_)?(h[g]=_,_):_ in h?h[_]:v(_)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,v(g))}),f},s.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(v,g){return h.length>1?p.setEdge(v,g,f):p.setEdge(v,g),g}),this},s.prototype.setEdge=function(){var u,f,p,h,v=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(u=g.v,f=g.w,p=g.name,arguments.length===2&&(h=arguments[1],v=!0)):(u=g,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],v=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var _=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,_))return v&&(this._edgeLabels[_]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[_]=v?h:this._defaultEdgeLabelFn(u,f,p);var x=c(this._isDirected,u,f,p);return u=x.v,f=x.w,Object.freeze(x),this._edgeObjs[_]=x,o(this._preds[f],u),o(this._sucs[u],f),this._in[f][_]=x,this._out[u][_]=x,this._edgeCount++,this},s.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},s.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),v=this._edgeObjs[h];return v&&(u=v.v,f=v.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[f],u),a(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},s.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.v===f}):h}},s.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.w===f}):h}},s.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function o(u,f){u[f]?u[f]++:u[f]=1}function a(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var v=""+f,g=""+p;if(!u&&v>g){var _=v;v=g,g=_}return v+n+g+n+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var v=""+f,g=""+p;if(!u&&v>g){var _=v;v=g,g=_}var x={v,w:g};return h&&(x.name=h),x}function d(u,f){return l(u,f.v,f.w,f.name)}return Kh}var Yh,Oj;function WL(){return Oj||(Oj=1,Yh="2.1.8"),Yh}var Xh,Mj;function HL(){return Mj||(Mj=1,Xh={Graph:Ey(),version:WL()}),Xh}var Qh,Dj;function UL(){if(Dj)return Qh;Dj=1;var e=_r(),t=Ey();Qh={write:r,read:o};function r(a){var l={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:n(a),edges:s(a)};return e.isUndefined(a.graph())||(l.value=e.clone(a.graph())),l}function n(a){return e.map(a.nodes(),function(l){var c=a.node(l),d=a.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function s(a){return e.map(a.edges(),function(l){var c=a.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function o(a){var l=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(a.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Qh}var Zh,Lj;function VL(){if(Lj)return Zh;Lj=1;var e=_r();Zh=t;function t(r){var n={},s=[],o;function a(l){e.has(n,l)||(n[l]=!0,o.push(l),e.each(r.successors(l),a),e.each(r.predecessors(l),a))}return e.each(r.nodes(),function(l){o=[],a(l),o.length&&s.push(o)}),s}return Zh}var Jh,zj;function C4(){if(zj)return Jh;zj=1;var e=_r();Jh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var s=this._keyIndices;if(r=String(r),!e.has(s,r)){var o=this._arr,a=o.length;return s[r]=a,o.push({key:r,priority:n}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var s=this._keyIndices[r];if(n>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[s].priority+" New: "+n);this._arr[s].priority=n,this._decrease(s)},t.prototype._heapify=function(r){var n=this._arr,s=2*r,o=s+1,a=r;s<n.length&&(a=n[s].priority<n[a].priority?s:a,o<n.length&&(a=n[o].priority<n[a].priority?o:a),a!==r&&(this._swap(r,a),this._heapify(a)))},t.prototype._decrease=function(r){for(var n=this._arr,s=n[r].priority,o;r!==0&&(o=r>>1,!(n[o].priority<s));)this._swap(r,o),r=o},t.prototype._swap=function(r,n){var s=this._arr,o=this._keyIndices,a=s[r],l=s[n];s[r]=l,s[n]=a,o[l.key]=r,o[a.key]=n},Jh}var em,Fj;function E4(){if(Fj)return em;Fj=1;var e=_r(),t=C4();em=n;var r=e.constant(1);function n(o,a,l,c){return s(o,String(a),l||r,c||function(d){return o.outEdges(d)})}function s(o,a,l,c){var d={},u=new t,f,p,h=function(v){var g=v.v!==f?v.v:v.w,_=d[g],x=l(v),y=p.distance+x;if(x<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+x);y<_.distance&&(_.distance=y,_.predecessor=f,u.decrease(g,y))};for(o.nodes().forEach(function(v){var g=v===a?0:Number.POSITIVE_INFINITY;d[v]={distance:g},u.add(v,g)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return em}var tm,$j;function GL(){if($j)return tm;$j=1;var e=E4(),t=_r();tm=r;function r(n,s,o){return t.transform(n.nodes(),function(a,l){a[l]=e(n,l,s,o)},{})}return tm}var rm,qj;function T4(){if(qj)return rm;qj=1;var e=_r();rm=t;function t(r){var n=0,s=[],o={},a=[];function l(c){var d=o[c]={onStack:!0,lowlink:n,index:n++};if(s.push(c),r.successors(c).forEach(function(p){e.has(o,p)?o[p].onStack&&(d.lowlink=Math.min(d.lowlink,o[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,o[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=s.pop(),o[f].onStack=!1,u.push(f);while(c!==f);a.push(u)}}return r.nodes().forEach(function(c){e.has(o,c)||l(c)}),a}return rm}var nm,Bj;function KL(){if(Bj)return nm;Bj=1;var e=_r(),t=T4();nm=r;function r(n){return e.filter(t(n),function(s){return s.length>1||s.length===1&&n.hasEdge(s[0],s[0])})}return nm}var sm,Wj;function YL(){if(Wj)return sm;Wj=1;var e=_r();sm=r;var t=e.constant(1);function r(s,o,a){return n(s,o||t,a||function(l){return s.outEdges(l)})}function n(s,o,a){var l={},c=s.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),a(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=o(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var v=p[d],g=u[h],_=p[h],x=v.distance+g.distance;x<_.distance&&(_.distance=x,_.predecessor=g.predecessor)})})}),l}return sm}var om,Hj;function R4(){if(Hj)return om;Hj=1;var e=_r();om=t,t.CycleException=r;function t(n){var s={},o={},a=[];function l(c){if(e.has(o,c))throw new r;e.has(s,c)||(o[c]=!0,s[c]=!0,e.each(n.predecessors(c),l),delete o[c],a.push(c))}if(e.each(n.sinks(),l),e.size(s)!==n.nodeCount())throw new r;return a}function r(){}return r.prototype=new Error,om}var im,Uj;function XL(){if(Uj)return im;Uj=1;var e=R4();im=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return im}var am,Vj;function A4(){if(Vj)return am;Vj=1;var e=_r();am=t;function t(n,s,o){e.isArray(s)||(s=[s]);var a=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(s,function(d){if(!n.hasNode(d))throw new Error("Graph does not have node: "+d);r(n,d,o==="post",c,a,l)}),l}function r(n,s,o,a,l,c){e.has(a,s)||(a[s]=!0,o||c.push(s),e.each(l(s),function(d){r(n,d,o,a,l,c)}),o&&c.push(s))}return am}var lm,Gj;function QL(){if(Gj)return lm;Gj=1;var e=A4();lm=t;function t(r,n){return e(r,n,"post")}return lm}var cm,Kj;function ZL(){if(Kj)return cm;Kj=1;var e=A4();cm=t;function t(r,n){return e(r,n,"pre")}return cm}var um,Yj;function JL(){if(Yj)return um;Yj=1;var e=_r(),t=Ey(),r=C4();um=n;function n(s,o){var a=new t,l={},c=new r,d;function u(p){var h=p.v===d?p.w:p.v,v=c.priority(h);if(v!==void 0){var g=o(p);g<v&&(l[h]=d,c.decrease(h,g))}}if(s.nodeCount()===0)return a;e.each(s.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),a.setNode(p)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))a.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(d).forEach(u)}return a}return um}var dm,Xj;function ez(){return Xj||(Xj=1,dm={components:VL(),dijkstra:E4(),dijkstraAll:GL(),findCycles:KL(),floydWarshall:YL(),isAcyclic:XL(),postorder:QL(),preorder:ZL(),prim:JL(),tarjan:T4(),topsort:R4()}),dm}var fm,Qj;function tz(){if(Qj)return fm;Qj=1;var e=HL();return fm={Graph:e.Graph,json:UL(),alg:ez(),version:e.version},fm}var mc;if(typeof fy=="function")try{mc=tz()}catch{}mc||(mc=window.graphlib);var Dr=mc,pm,Zj;function rz(){if(Zj)return pm;Zj=1;var e=r4(),t=1,r=4;function n(s){return e(s,t|r)}return pm=n,pm}var hm,Jj;function bu(){if(Jj)return hm;Jj=1;var e=Mo(),t=bn(),r=du(),n=br();function s(o,a,l){if(!n(l))return!1;var c=typeof a;return(c=="number"?t(l)&&r(a,l.length):c=="string"&&a in l)?e(l[a],o):!1}return hm=s,hm}var mm,e2;function nz(){if(e2)return mm;e2=1;var e=yu(),t=Mo(),r=bu(),n=Is(),s=Object.prototype,o=s.hasOwnProperty,a=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=n(p),v=-1,g=h.length;++v<g;){var _=h[v],x=l[_];(x===void 0||t(x,s[_])&&!o.call(l,_))&&(l[_]=p[_])}return l});return mm=a,mm}var gm,t2;function sz(){if(t2)return gm;t2=1;var e=_n(),t=bn(),r=rs();function n(s){return function(o,a,l){var c=Object(o);if(!t(o)){var d=e(a,3);o=r(o),a=function(f){return d(c[f],f,c)}}var u=s(o,a,l);return u>-1?c[d?o[u]:u]:void 0}}return gm=n,gm}var xm,r2;function oz(){if(r2)return xm;r2=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return xm=t,xm}var vm,n2;function iz(){if(n2)return vm;n2=1;var e=oz(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return vm=r,vm}var ym,s2;function az(){if(s2)return ym;s2=1;var e=iz(),t=br(),r=Fo(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return n;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=o.test(d);return f||a.test(d)?l(d.slice(2),f?2:8):s.test(d)?n:+d}return ym=c,ym}var bm,o2;function I4(){if(o2)return bm;o2=1;var e=az(),t=1/0,r=17976931348623157e292;function n(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var o=s<0?-1:1;return o*r}return s===s?s:0}return bm=n,bm}var _m,i2;function lz(){if(i2)return _m;i2=1;var e=I4();function t(r){var n=e(r),s=n%1;return n===n?s?n-s:n:0}return _m=t,_m}var wm,a2;function cz(){if(a2)return wm;a2=1;var e=S4(),t=_n(),r=lz(),n=Math.max;function s(o,a,l){var c=o==null?0:o.length;if(!c)return-1;var d=l==null?0:r(l);return d<0&&(d=n(c+d,0)),e(o,t(a,3),d)}return wm=s,wm}var jm,l2;function uz(){if(l2)return jm;l2=1;var e=sz(),t=cz(),r=e(t);return jm=r,jm}var Sm,c2;function P4(){if(c2)return Sm;c2=1;var e=Cy();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return Sm=t,Sm}var km,u2;function dz(){if(u2)return km;u2=1;var e=jy(),t=n4(),r=Is();function n(s,o){return s==null?s:e(s,t(o),r)}return km=n,km}var Nm,d2;function fz(){if(d2)return Nm;d2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Nm=e,Nm}var Cm,f2;function pz(){if(f2)return Cm;f2=1;var e=cu(),t=Sy(),r=_n();function n(s,o){var a={};return o=r(o,3),t(s,function(l,c,d){e(a,c,o(l,c,d))}),a}return Cm=n,Cm}var Em,p2;function Ty(){if(p2)return Em;p2=1;var e=Fo();function t(r,n,s){for(var o=-1,a=r.length;++o<a;){var l=r[o],c=n(l);if(c!=null&&(d===void 0?c===c&&!e(c):s(c,d)))var d=c,u=l}return u}return Em=t,Em}var Tm,h2;function hz(){if(h2)return Tm;h2=1;function e(t,r){return t>r}return Tm=e,Tm}var Rm,m2;function mz(){if(m2)return Rm;m2=1;var e=Ty(),t=hz(),r=Ps();function n(s){return s&&s.length?e(s,r,t):void 0}return Rm=n,Rm}var Am,g2;function O4(){if(g2)return Am;g2=1;var e=cu(),t=Mo();function r(n,s,o){(o!==void 0&&!t(n[s],o)||o===void 0&&!(s in n))&&e(n,s,o)}return Am=r,Am}var Im,x2;function gz(){if(x2)return Im;x2=1;var e=Rs(),t=hu(),r=Xr(),n="[object Object]",s=Function.prototype,o=Object.prototype,a=s.toString,l=o.hasOwnProperty,c=a.call(Object);function d(u){if(!r(u)||e(u)!=n)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&a.call(p)==c}return Im=d,Im}var Pm,v2;function M4(){if(v2)return Pm;v2=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Pm=e,Pm}var Om,y2;function xz(){if(y2)return Om;y2=1;var e=Sa(),t=Is();function r(n){return e(n,t(n))}return Om=r,Om}var Mm,b2;function vz(){if(b2)return Mm;b2=1;var e=O4(),t=HE(),r=JE(),n=UE(),s=t4(),o=ka(),a=ft(),l=k4(),c=Lo(),d=ja(),u=br(),f=gz(),p=Na(),h=M4(),v=xz();function g(_,x,y,b,j,k,N){var S=h(_,y),C=h(x,y),w=N.get(C);if(w){e(_,y,w);return}var A=k?k(S,C,y+"",_,x,N):void 0,T=A===void 0;if(T){var D=a(C),$=!D&&c(C),E=!D&&!$&&p(C);A=C,D||$||E?a(S)?A=S:l(S)?A=n(S):$?(T=!1,A=t(C,!0)):E?(T=!1,A=r(C,!0)):A=[]:f(C)||o(C)?(A=S,o(S)?A=v(S):(!u(S)||d(S))&&(A=s(C))):T=!1}T&&(N.set(C,A),j(A,C,b,k,N),N.delete(C)),e(_,y,A)}return Mm=g,Mm}var Dm,_2;function yz(){if(_2)return Dm;_2=1;var e=lu(),t=O4(),r=jy(),n=vz(),s=br(),o=Is(),a=M4();function l(c,d,u,f,p){c!==d&&r(d,function(h,v){if(p||(p=new e),s(h))n(c,d,v,u,l,f,p);else{var g=f?f(a(c,v),h,v+"",c,d,p):void 0;g===void 0&&(g=h),t(c,v,g)}},o)}return Dm=l,Dm}var Lm,w2;function bz(){if(w2)return Lm;w2=1;var e=yu(),t=bu();function r(n){return e(function(s,o){var a=-1,l=o.length,c=l>1?o[l-1]:void 0,d=l>2?o[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(o[0],o[1],d)&&(c=l<3?void 0:c,l=1),s=Object(s);++a<l;){var u=o[a];u&&n(s,u,a,c)}return s})}return Lm=r,Lm}var zm,j2;function _z(){if(j2)return zm;j2=1;var e=yz(),t=bz(),r=t(function(n,s,o){e(n,s,o)});return zm=r,zm}var Fm,S2;function D4(){if(S2)return Fm;S2=1;function e(t,r){return t<r}return Fm=e,Fm}var $m,k2;function wz(){if(k2)return $m;k2=1;var e=Ty(),t=D4(),r=Ps();function n(s){return s&&s.length?e(s,r,t):void 0}return $m=n,$m}var qm,N2;function jz(){if(N2)return qm;N2=1;var e=Ty(),t=_n(),r=D4();function n(s,o){return s&&s.length?e(s,t(o,2),r):void 0}return qm=n,qm}var Bm,C2;function Sz(){if(C2)return Bm;C2=1;var e=Mr(),t=function(){return e.Date.now()};return Bm=t,Bm}var Wm,E2;function kz(){if(E2)return Wm;E2=1;var e=uu(),t=xu(),r=du(),n=br(),s=Ca();function o(a,l,c,d){if(!n(a))return a;l=t(l,a);for(var u=-1,f=l.length,p=f-1,h=a;h!=null&&++u<f;){var v=s(l[u]),g=c;if(v==="__proto__"||v==="constructor"||v==="prototype")return a;if(u!=p){var _=h[v];g=d?d(_,v,h):void 0,g===void 0&&(g=n(_)?_:r(l[u+1])?[]:{})}e(h,v,g),h=h[v]}return a}return Wm=o,Wm}var Hm,T2;function Nz(){if(T2)return Hm;T2=1;var e=vu(),t=kz(),r=xu();function n(s,o,a){for(var l=-1,c=o.length,d={};++l<c;){var u=o[l],f=e(s,u);a(f,u)&&t(d,r(u,s),f)}return d}return Hm=n,Hm}var Um,R2;function Cz(){if(R2)return Um;R2=1;var e=Nz(),t=h4();function r(n,s){return e(n,s,function(o,a){return t(n,a)})}return Um=r,Um}var Vm,A2;function Ez(){if(A2)return Vm;A2=1;var e=P4(),t=w4(),r=j4();function n(s){return r(t(s,void 0,e),s+"")}return Vm=n,Vm}var Gm,I2;function Tz(){if(I2)return Gm;I2=1;var e=Cz(),t=Ez(),r=t(function(n,s){return n==null?{}:e(n,s)});return Gm=r,Gm}var Km,P2;function Rz(){if(P2)return Km;P2=1;var e=Math.ceil,t=Math.max;function r(n,s,o,a){for(var l=-1,c=t(e((s-n)/(o||1)),0),d=Array(c);c--;)d[a?c:++l]=n,n+=o;return d}return Km=r,Km}var Ym,O2;function Az(){if(O2)return Ym;O2=1;var e=Rz(),t=bu(),r=I4();function n(s){return function(o,a,l){return l&&typeof l!="number"&&t(o,a,l)&&(a=l=void 0),o=r(o),a===void 0?(a=o,o=0):a=r(a),l=l===void 0?o<a?1:-1:r(l),e(o,a,l,s)}}return Ym=n,Ym}var Xm,M2;function Iz(){if(M2)return Xm;M2=1;var e=Az(),t=e();return Xm=t,Xm}var Qm,D2;function Pz(){if(D2)return Qm;D2=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Qm=e,Qm}var Zm,L2;function Oz(){if(L2)return Zm;L2=1;var e=Fo();function t(r,n){if(r!==n){var s=r!==void 0,o=r===null,a=r===r,l=e(r),c=n!==void 0,d=n===null,u=n===n,f=e(n);if(!d&&!f&&!l&&r>n||l&&c&&u&&!d&&!f||o&&c&&u||!s&&u||!a)return 1;if(!o&&!l&&!f&&r<n||f&&s&&a&&!o&&!l||d&&s&&a||!c&&a||!u)return-1}return 0}return Zm=t,Zm}var Jm,z2;function Mz(){if(z2)return Jm;z2=1;var e=Oz();function t(r,n,s){for(var o=-1,a=r.criteria,l=n.criteria,c=a.length,d=s.length;++o<c;){var u=e(a[o],l[o]);if(u){if(o>=d)return u;var f=s[o];return u*(f=="desc"?-1:1)}}return r.index-n.index}return Jm=t,Jm}var eg,F2;function Dz(){if(F2)return eg;F2=1;var e=gu(),t=vu(),r=_n(),n=y4(),s=Pz(),o=fu(),a=Mz(),l=Ps(),c=ft();function d(u,f,p){f.length?f=e(f,function(g){return c(g)?function(_){return t(_,g.length===1?g[0]:g)}:g}):f=[l];var h=-1;f=e(f,o(r));var v=n(u,function(g,_,x){var y=e(f,function(b){return b(g)});return{criteria:y,index:++h,value:g}});return s(v,function(g,_){return a(g,_,p)})}return eg=d,eg}var tg,$2;function Lz(){if($2)return tg;$2=1;var e=Cy(),t=Dz(),r=yu(),n=bu(),s=r(function(o,a){if(o==null)return[];var l=a.length;return l>1&&n(o,a[0],a[1])?a=[]:l>2&&n(a[0],a[1],a[2])&&(a=[a[0]]),t(o,e(a,1),[])});return tg=s,tg}var rg,q2;function zz(){if(q2)return rg;q2=1;var e=f4(),t=0;function r(n){var s=++t;return e(n)+s}return rg=r,rg}var ng,B2;function Fz(){if(B2)return ng;B2=1;function e(t,r,n){for(var s=-1,o=t.length,a=r.length,l={};++s<o;){var c=s<a?r[s]:void 0;n(l,t[s],c)}return l}return ng=e,ng}var sg,W2;function $z(){if(W2)return sg;W2=1;var e=uu(),t=Fz();function r(n,s){return t(n||[],s||[],e)}return sg=r,sg}var gc;if(typeof fy=="function")try{gc={cloneDeep:rz(),constant:wy(),defaults:nz(),each:o4(),filter:g4(),find:uz(),flatten:P4(),forEach:s4(),forIn:dz(),has:x4(),isUndefined:v4(),last:fz(),map:b4(),mapValues:pz(),max:mz(),merge:_z(),min:wz(),minBy:jz(),now:Sz(),pick:Tz(),range:Iz(),reduce:_4(),sortBy:Lz(),uniqueId:zz(),values:N4(),zipObject:$z()}}catch{}gc||(gc=window._);var et=gc,qz=_u;function _u(){var e={};e._next=e._prev=e,this._sentinel=e}_u.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return L4(t),t};_u.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&L4(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};_u.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,Bz)),r=r._prev;return"["+e.join(", ")+"]"};function L4(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Bz(e,t){if(e!=="_next"&&e!=="_prev")return t}var an=et,Wz=Dr.Graph,Hz=qz,Uz=Gz,Vz=an.constant(1);function Gz(e,t){if(e.nodeCount()<=1)return[];var r=Yz(e,t||Vz),n=Kz(r.graph,r.buckets,r.zeroIdx);return an.flatten(an.map(n,function(s){return e.outEdges(s.v,s.w)}),!0)}function Kz(e,t,r){for(var n=[],s=t[t.length-1],o=t[0],a;e.nodeCount();){for(;a=o.dequeue();)og(e,t,r,a);for(;a=s.dequeue();)og(e,t,r,a);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(a=t[l].dequeue(),a){n=n.concat(og(e,t,r,a,!0));break}}}return n}function og(e,t,r,n,s){var o=s?[]:void 0;return an.forEach(e.inEdges(n.v),function(a){var l=e.edge(a),c=e.node(a.v);s&&o.push({v:a.v,w:a.w}),c.out-=l,qx(t,r,c)}),an.forEach(e.outEdges(n.v),function(a){var l=e.edge(a),c=a.w,d=e.node(c);d.in-=l,qx(t,r,d)}),e.removeNode(n.v),o}function Yz(e,t){var r=new Wz,n=0,s=0;an.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),an.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,d=t(l),u=c+d;r.setEdge(l.v,l.w,u),s=Math.max(s,r.node(l.v).out+=d),n=Math.max(n,r.node(l.w).in+=d)});var o=an.range(s+n+3).map(function(){return new Hz}),a=n+1;return an.forEach(r.nodes(),function(l){qx(o,a,r.node(l))}),{graph:r,buckets:o,zeroIdx:a}}function qx(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var ms=et,Xz=Uz,Qz={run:Zz,undo:eF};function Zz(e){var t=e.graph().acyclicer==="greedy"?Xz(e,r(e)):Jz(e);ms.forEach(t,function(n){var s=e.edge(n);e.removeEdge(n),s.forwardName=n.name,s.reversed=!0,e.setEdge(n.w,n.v,s,ms.uniqueId("rev"))});function r(n){return function(s){return n.edge(s).weight}}}function Jz(e){var t=[],r={},n={};function s(o){ms.has(n,o)||(n[o]=!0,r[o]=!0,ms.forEach(e.outEdges(o),function(a){ms.has(r,a.w)?t.push(a):s(a.w)}),delete r[o])}return ms.forEach(e.nodes(),s),t}function eF(e){ms.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var Be=et,z4=Dr.Graph,Xt={addDummyNode:F4,simplify:tF,asNonCompoundGraph:rF,successorWeights:nF,predecessorWeights:sF,intersectRect:oF,buildLayerMatrix:iF,normalizeRanks:aF,removeEmptyRanks:lF,addBorderNode:cF,maxRank:$4,partition:uF,time:dF,notime:fF};function F4(e,t,r,n){var s;do s=Be.uniqueId(n);while(e.hasNode(s));return r.dummy=t,e.setNode(s,r),s}function tF(e){var t=new z4().setGraph(e.graph());return Be.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),Be.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},s=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+s.weight,minlen:Math.max(n.minlen,s.minlen)})}),t}function rF(e){var t=new z4({multigraph:e.isMultigraph()}).setGraph(e.graph());return Be.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),Be.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function nF(e){var t=Be.map(e.nodes(),function(r){var n={};return Be.forEach(e.outEdges(r),function(s){n[s.w]=(n[s.w]||0)+e.edge(s).weight}),n});return Be.zipObject(e.nodes(),t)}function sF(e){var t=Be.map(e.nodes(),function(r){var n={};return Be.forEach(e.inEdges(r),function(s){n[s.v]=(n[s.v]||0)+e.edge(s).weight}),n});return Be.zipObject(e.nodes(),t)}function oF(e,t){var r=e.x,n=e.y,s=t.x-r,o=t.y-n,a=e.width/2,l=e.height/2;if(!s&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(o)*a>Math.abs(s)*l?(o<0&&(l=-l),c=l*s/o,d=l):(s<0&&(a=-a),c=a,d=a*o/s),{x:r+c,y:n+d}}function iF(e){var t=Be.map(Be.range($4(e)+1),function(){return[]});return Be.forEach(e.nodes(),function(r){var n=e.node(r),s=n.rank;Be.isUndefined(s)||(t[s][n.order]=r)}),t}function aF(e){var t=Be.min(Be.map(e.nodes(),function(r){return e.node(r).rank}));Be.forEach(e.nodes(),function(r){var n=e.node(r);Be.has(n,"rank")&&(n.rank-=t)})}function lF(e){var t=Be.min(Be.map(e.nodes(),function(o){return e.node(o).rank})),r=[];Be.forEach(e.nodes(),function(o){var a=e.node(o).rank-t;r[a]||(r[a]=[]),r[a].push(o)});var n=0,s=e.graph().nodeRankFactor;Be.forEach(r,function(o,a){Be.isUndefined(o)&&a%s!==0?--n:n&&Be.forEach(o,function(l){e.node(l).rank+=n})})}function cF(e,t,r,n){var s={width:0,height:0};return arguments.length>=4&&(s.rank=r,s.order=n),F4(e,"border",s,t)}function $4(e){return Be.max(Be.map(e.nodes(),function(t){var r=e.node(t).rank;if(!Be.isUndefined(r))return r}))}function uF(e,t){var r={lhs:[],rhs:[]};return Be.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function dF(e,t){var r=Be.now();try{return t()}finally{console.log(e+" time: "+(Be.now()-r)+"ms")}}function fF(e,t){return t()}var q4=et,pF=Xt,hF={run:mF,undo:xF};function mF(e){e.graph().dummyChains=[],q4.forEach(e.edges(),function(t){gF(e,t)})}function gF(e,t){var r=t.v,n=e.node(r).rank,s=t.w,o=e.node(s).rank,a=t.name,l=e.edge(t),c=l.labelRank;if(o!==n+1){e.removeEdge(t);var d,u,f;for(f=0,++n;n<o;++f,++n)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},d=pF.addDummyNode(e,"edge",u,"_d"),n===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(r,d,{weight:l.weight},a),f===0&&e.graph().dummyChains.push(d),r=d;e.setEdge(r,s,{weight:l.weight},a)}}function xF(e){q4.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,s;for(e.setEdge(r.edgeObj,n);r.dummy;)s=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=s,r=e.node(t)})}var il=et,wu={longestPath:vF,slack:yF};function vF(e){var t={};function r(n){var s=e.node(n);if(il.has(t,n))return s.rank;t[n]=!0;var o=il.min(il.map(e.outEdges(n),function(a){return r(a.w)-e.edge(a).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),s.rank=o}il.forEach(e.sources(),r)}function yF(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var xc=et,bF=Dr.Graph,vc=wu.slack,B4=_F;function _F(e){var t=new bF({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var s,o;wF(t,e)<n;)s=jF(t,e),o=t.hasNode(s.v)?vc(e,s):-vc(e,s),SF(t,e,o);return t}function wF(e,t){function r(n){xc.forEach(t.nodeEdges(n),function(s){var o=s.v,a=n===o?s.w:o;!e.hasNode(a)&&!vc(t,s)&&(e.setNode(a,{}),e.setEdge(n,a,{}),r(a))})}return xc.forEach(e.nodes(),r),e.nodeCount()}function jF(e,t){return xc.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return vc(t,r)})}function SF(e,t,r){xc.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var xn=et,kF=B4,NF=wu.slack,CF=wu.longestPath,EF=Dr.alg.preorder,TF=Dr.alg.postorder,RF=Xt.simplify,AF=Os;Os.initLowLimValues=Ay;Os.initCutValues=Ry;Os.calcCutValue=W4;Os.leaveEdge=U4;Os.enterEdge=V4;Os.exchangeEdges=G4;function Os(e){e=RF(e),CF(e);var t=kF(e);Ay(t),Ry(t,e);for(var r,n;r=U4(t);)n=V4(t,e,r),G4(t,e,r,n)}function Ry(e,t){var r=TF(e,e.nodes());r=r.slice(0,r.length-1),xn.forEach(r,function(n){IF(e,t,n)})}function IF(e,t,r){var n=e.node(r),s=n.parent;e.edge(r,s).cutvalue=W4(e,t,r)}function W4(e,t,r){var n=e.node(r),s=n.parent,o=!0,a=t.edge(r,s),l=0;return a||(o=!1,a=t.edge(s,r)),l=a.weight,xn.forEach(t.nodeEdges(r),function(c){var d=c.v===r,u=d?c.w:c.v;if(u!==s){var f=d===o,p=t.edge(c).weight;if(l+=f?p:-p,OF(e,r,u)){var h=e.edge(r,u).cutvalue;l+=f?-h:h}}}),l}function Ay(e,t){arguments.length<2&&(t=e.nodes()[0]),H4(e,{},1,t)}function H4(e,t,r,n,s){var o=r,a=e.node(n);return t[n]=!0,xn.forEach(e.neighbors(n),function(l){xn.has(t,l)||(r=H4(e,t,r,l,n))}),a.low=o,a.lim=r++,s?a.parent=s:delete a.parent,r}function U4(e){return xn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function V4(e,t,r){var n=r.v,s=r.w;t.hasEdge(n,s)||(n=r.w,s=r.v);var o=e.node(n),a=e.node(s),l=o,c=!1;o.lim>a.lim&&(l=a,c=!0);var d=xn.filter(t.edges(),function(u){return c===H2(e,e.node(u.v),l)&&c!==H2(e,e.node(u.w),l)});return xn.minBy(d,function(u){return NF(t,u)})}function G4(e,t,r,n){var s=r.v,o=r.w;e.removeEdge(s,o),e.setEdge(n.v,n.w,{}),Ay(e),Ry(e,t),PF(e,t)}function PF(e,t){var r=xn.find(e.nodes(),function(s){return!t.node(s).parent}),n=EF(e,r);n=n.slice(1),xn.forEach(n,function(s){var o=e.node(s).parent,a=t.edge(s,o),l=!1;a||(a=t.edge(o,s),l=!0),t.node(s).rank=t.node(o).rank+(l?a.minlen:-a.minlen)})}function OF(e,t,r){return e.hasEdge(t,r)}function H2(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var MF=wu,K4=MF.longestPath,DF=B4,LF=AF,zF=FF;function FF(e){switch(e.graph().ranker){case"network-simplex":U2(e);break;case"tight-tree":qF(e);break;case"longest-path":$F(e);break;default:U2(e)}}var $F=K4;function qF(e){K4(e),DF(e)}function U2(e){LF(e)}var Bx=et,BF=WF;function WF(e){var t=UF(e);Bx.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),s=n.edgeObj,o=HF(e,t,s.v,s.w),a=o.path,l=o.lca,c=0,d=a[c],u=!0;r!==s.w;){if(n=e.node(r),u){for(;(d=a[c])!==l&&e.node(d).maxRank<n.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<a.length-1&&e.node(d=a[c+1]).minRank<=n.rank;)c++;d=a[c]}e.setParent(r,d),r=e.successors(r)[0]}})}function HF(e,t,r,n){var s=[],o=[],a=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,d;c=r;do c=e.parent(c),s.push(c);while(c&&(t[c].low>a||l>t[c].lim));for(d=c,c=n;(c=e.parent(c))!==d;)o.push(c);return{path:s.concat(o.reverse()),lca:d}}function UF(e){var t={},r=0;function n(s){var o=r;Bx.forEach(e.children(s),n),t[s]={low:o,lim:r++}}return Bx.forEach(e.children(),n),t}var ln=et,Wx=Xt,VF={run:GF,cleanup:XF};function GF(e){var t=Wx.addDummyNode(e,"root",{},"_root"),r=KF(e),n=ln.max(ln.values(r))-1,s=2*n+1;e.graph().nestingRoot=t,ln.forEach(e.edges(),function(a){e.edge(a).minlen*=s});var o=YF(e)+1;ln.forEach(e.children(),function(a){Y4(e,t,s,o,n,r,a)}),e.graph().nodeRankFactor=s}function Y4(e,t,r,n,s,o,a){var l=e.children(a);if(!l.length){a!==t&&e.setEdge(t,a,{weight:0,minlen:r});return}var c=Wx.addBorderNode(e,"_bt"),d=Wx.addBorderNode(e,"_bb"),u=e.node(a);e.setParent(c,a),u.borderTop=c,e.setParent(d,a),u.borderBottom=d,ln.forEach(l,function(f){Y4(e,t,r,n,s,o,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,v=p.borderBottom?p.borderBottom:f,g=p.borderTop?n:2*n,_=h!==v?1:s-o[a]+1;e.setEdge(c,h,{weight:g,minlen:_,nestingEdge:!0}),e.setEdge(v,d,{weight:g,minlen:_,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,c,{weight:0,minlen:s+o[a]})}function KF(e){var t={};function r(n,s){var o=e.children(n);o&&o.length&&ln.forEach(o,function(a){r(a,s+1)}),t[n]=s}return ln.forEach(e.children(),function(n){r(n,1)}),t}function YF(e){return ln.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function XF(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,ln.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var ig=et,QF=Xt,ZF=JF;function JF(e){function t(r){var n=e.children(r),s=e.node(r);if(n.length&&ig.forEach(n,t),ig.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var o=s.minRank,a=s.maxRank+1;o<a;++o)V2(e,"borderLeft","_bl",r,s,o),V2(e,"borderRight","_br",r,s,o)}}ig.forEach(e.children(),t)}function V2(e,t,r,n,s,o){var a={width:0,height:0,rank:o,borderType:t},l=s[t][o-1],c=QF.addDummyNode(e,"border",a,r);s[t][o]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var Wr=et,e$={adjust:t$,undo:r$};function t$(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&X4(e)}function r$(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&n$(e),(t==="lr"||t==="rl")&&(s$(e),X4(e))}function X4(e){Wr.forEach(e.nodes(),function(t){G2(e.node(t))}),Wr.forEach(e.edges(),function(t){G2(e.edge(t))})}function G2(e){var t=e.width;e.width=e.height,e.height=t}function n$(e){Wr.forEach(e.nodes(),function(t){ag(e.node(t))}),Wr.forEach(e.edges(),function(t){var r=e.edge(t);Wr.forEach(r.points,ag),Wr.has(r,"y")&&ag(r)})}function ag(e){e.y=-e.y}function s$(e){Wr.forEach(e.nodes(),function(t){lg(e.node(t))}),Wr.forEach(e.edges(),function(t){var r=e.edge(t);Wr.forEach(r.points,lg),Wr.has(r,"x")&&lg(r)})}function lg(e){var t=e.x;e.x=e.y,e.y=t}var Zr=et,o$=i$;function i$(e){var t={},r=Zr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Zr.max(Zr.map(r,function(l){return e.node(l).rank})),s=Zr.map(Zr.range(n+1),function(){return[]});function o(l){if(!Zr.has(t,l)){t[l]=!0;var c=e.node(l);s[c.rank].push(l),Zr.forEach(e.successors(l),o)}}var a=Zr.sortBy(r,function(l){return e.node(l).rank});return Zr.forEach(a,o),s}var Sn=et,a$=l$;function l$(e,t){for(var r=0,n=1;n<t.length;++n)r+=c$(e,t[n-1],t[n]);return r}function c$(e,t,r){for(var n=Sn.zipObject(r,Sn.map(r,function(d,u){return u})),s=Sn.flatten(Sn.map(t,function(d){return Sn.sortBy(Sn.map(e.outEdges(d),function(u){return{pos:n[u.w],weight:e.edge(u).weight}}),"pos")}),!0),o=1;o<r.length;)o<<=1;var a=2*o-1;o-=1;var l=Sn.map(new Array(a),function(){return 0}),c=0;return Sn.forEach(s.forEach(function(d){var u=d.pos+o;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var K2=et,u$=d$;function d$(e,t){return K2.map(t,function(r){var n=e.inEdges(r);if(n.length){var s=K2.reduce(n,function(o,a){var l=e.edge(a),c=e.node(a.v);return{sum:o.sum+l.weight*c.order,weight:o.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}var tr=et,f$=p$;function p$(e,t){var r={};tr.forEach(e,function(s,o){var a=r[s.v]={indegree:0,in:[],out:[],vs:[s.v],i:o};tr.isUndefined(s.barycenter)||(a.barycenter=s.barycenter,a.weight=s.weight)}),tr.forEach(t.edges(),function(s){var o=r[s.v],a=r[s.w];!tr.isUndefined(o)&&!tr.isUndefined(a)&&(a.indegree++,o.out.push(r[s.w]))});var n=tr.filter(r,function(s){return!s.indegree});return h$(n)}function h$(e){var t=[];function r(o){return function(a){a.merged||(tr.isUndefined(a.barycenter)||tr.isUndefined(o.barycenter)||a.barycenter>=o.barycenter)&&m$(o,a)}}function n(o){return function(a){a.in.push(o),--a.indegree===0&&e.push(a)}}for(;e.length;){var s=e.pop();t.push(s),tr.forEach(s.in.reverse(),r(s)),tr.forEach(s.out,n(s))}return tr.map(tr.filter(t,function(o){return!o.merged}),function(o){return tr.pick(o,["vs","i","barycenter","weight"])})}function m$(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var yi=et,g$=Xt,x$=v$;function v$(e,t){var r=g$.partition(e,function(u){return yi.has(u,"barycenter")}),n=r.lhs,s=yi.sortBy(r.rhs,function(u){return-u.i}),o=[],a=0,l=0,c=0;n.sort(y$(!!t)),c=Y2(o,s,c),yi.forEach(n,function(u){c+=u.vs.length,o.push(u.vs),a+=u.barycenter*u.weight,l+=u.weight,c=Y2(o,s,c)});var d={vs:yi.flatten(o,!0)};return l&&(d.barycenter=a/l,d.weight=l),d}function Y2(e,t,r){for(var n;t.length&&(n=yi.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function y$(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var On=et,b$=u$,_$=f$,w$=x$,j$=Q4;function Q4(e,t,r,n){var s=e.children(t),o=e.node(t),a=o?o.borderLeft:void 0,l=o?o.borderRight:void 0,c={};a&&(s=On.filter(s,function(v){return v!==a&&v!==l}));var d=b$(e,s);On.forEach(d,function(v){if(e.children(v.v).length){var g=Q4(e,v.v,r,n);c[v.v]=g,On.has(g,"barycenter")&&k$(v,g)}});var u=_$(d,r);S$(u,c);var f=w$(u,n);if(a&&(f.vs=On.flatten([a,f.vs,l],!0),e.predecessors(a).length)){var p=e.node(e.predecessors(a)[0]),h=e.node(e.predecessors(l)[0]);On.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function S$(e,t){On.forEach(e,function(r){r.vs=On.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function k$(e,t){On.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var bi=et,N$=Dr.Graph,C$=E$;function E$(e,t,r){var n=T$(e),s=new N$({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(o){return e.node(o)});return bi.forEach(e.nodes(),function(o){var a=e.node(o),l=e.parent(o);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(o),s.setParent(o,l||n),bi.forEach(e[r](o),function(c){var d=c.v===o?c.w:c.v,u=s.edge(d,o),f=bi.isUndefined(u)?0:u.weight;s.setEdge(d,o,{weight:e.edge(c).weight+f})}),bi.has(a,"minRank")&&s.setNode(o,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),s}function T$(e){for(var t;e.hasNode(t=bi.uniqueId("_root")););return t}var R$=et,A$=I$;function I$(e,t,r){var n={},s;R$.forEach(r,function(o){for(var a=e.parent(o),l,c;a;){if(l=e.parent(a),l?(c=n[l],n[l]=a):(c=s,s=a),c&&c!==a){t.setEdge(c,a);return}a=l}})}var Gn=et,P$=o$,O$=a$,M$=j$,D$=C$,L$=A$,z$=Dr.Graph,X2=Xt,F$=$$;function $$(e){var t=X2.maxRank(e),r=Q2(e,Gn.range(1,t+1),"inEdges"),n=Q2(e,Gn.range(t-1,-1,-1),"outEdges"),s=P$(e);Z2(e,s);for(var o=Number.POSITIVE_INFINITY,a,l=0,c=0;c<4;++l,++c){q$(l%2?r:n,l%4>=2),s=X2.buildLayerMatrix(e);var d=O$(e,s);d<o&&(c=0,a=Gn.cloneDeep(s),o=d)}Z2(e,a)}function Q2(e,t,r){return Gn.map(t,function(n){return D$(e,n,r)})}function q$(e,t){var r=new z$;Gn.forEach(e,function(n){var s=n.graph().root,o=M$(n,s,r,t);Gn.forEach(o.vs,function(a,l){n.node(a).order=l}),L$(n,r,o.vs)})}function Z2(e,t){Gn.forEach(t,function(r){Gn.forEach(r,function(n,s){e.node(n).order=s})})}var _e=et,B$=Dr.Graph,W$=Xt,H$={positionX:tq};function U$(e,t){var r={};function n(s,o){var a=0,l=0,c=s.length,d=_e.last(o);return _e.forEach(o,function(u,f){var p=G$(e,u),h=p?e.node(p).order:c;(p||u===d)&&(_e.forEach(o.slice(l,f+1),function(v){_e.forEach(e.predecessors(v),function(g){var _=e.node(g),x=_.order;(x<a||h<x)&&!(_.dummy&&e.node(v).dummy)&&Z4(r,g,v)})}),l=f+1,a=h)}),o}return _e.reduce(t,n),r}function V$(e,t){var r={};function n(o,a,l,c,d){var u;_e.forEach(_e.range(a,l),function(f){u=o[f],e.node(u).dummy&&_e.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&Z4(r,p,u)})})}function s(o,a){var l=-1,c,d=0;return _e.forEach(a,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,n(a,d,f,l,c),d=f,l=c)}n(a,d,a.length,c,o.length)}),a}return _e.reduce(t,s),r}function G$(e,t){if(e.node(t).dummy)return _e.find(e.predecessors(t),function(r){return e.node(r).dummy})}function Z4(e,t,r){if(t>r){var n=t;t=r,r=n}var s=e[t];s||(e[t]=s={}),s[r]=!0}function K$(e,t,r){if(t>r){var n=t;t=r,r=n}return _e.has(e[t],r)}function Y$(e,t,r,n){var s={},o={},a={};return _e.forEach(t,function(l){_e.forEach(l,function(c,d){s[c]=c,o[c]=c,a[c]=d})}),_e.forEach(t,function(l){var c=-1;_e.forEach(l,function(d){var u=n(d);if(u.length){u=_e.sortBy(u,function(g){return a[g]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var v=u[p];o[d]===d&&c<a[v]&&!K$(r,d,v)&&(o[v]=d,o[d]=s[d]=s[v],c=a[v])}}})}),{root:s,align:o}}function X$(e,t,r,n,s){var o={},a=Q$(e,t,r,s),l=s?"borderLeft":"borderRight";function c(f,p){for(var h=a.nodes(),v=h.pop(),g={};v;)g[v]?f(v):(g[v]=!0,h.push(v),h=h.concat(p(v))),v=h.pop()}function d(f){o[f]=a.inEdges(f).reduce(function(p,h){return Math.max(p,o[h.v]+a.edge(h))},0)}function u(f){var p=a.outEdges(f).reduce(function(v,g){return Math.min(v,o[g.w]-a.edge(g))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(o[f]=Math.max(o[f],p))}return c(d,a.predecessors.bind(a)),c(u,a.successors.bind(a)),_e.forEach(n,function(f){o[f]=o[r[f]]}),o}function Q$(e,t,r,n){var s=new B$,o=e.graph(),a=rq(o.nodesep,o.edgesep,n);return _e.forEach(t,function(l){var c;_e.forEach(l,function(d){var u=r[d];if(s.setNode(u),c){var f=r[c],p=s.edge(f,u);s.setEdge(f,u,Math.max(a(e,d,c),p||0))}c=d})}),s}function Z$(e,t){return _e.minBy(_e.values(t),function(r){var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return _e.forIn(r,function(o,a){var l=nq(e,a)/2;n=Math.max(o+l,n),s=Math.min(o-l,s)}),n-s})}function J$(e,t){var r=_e.values(t),n=_e.min(r),s=_e.max(r);_e.forEach(["u","d"],function(o){_e.forEach(["l","r"],function(a){var l=o+a,c=e[l],d;if(c!==t){var u=_e.values(c);d=a==="l"?n-_e.min(u):s-_e.max(u),d&&(e[l]=_e.mapValues(c,function(f){return f+d}))}})})}function eq(e,t){return _e.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var s=_e.sortBy(_e.map(e,n));return(s[1]+s[2])/2})}function tq(e){var t=W$.buildLayerMatrix(e),r=_e.merge(U$(e,t),V$(e,t)),n={},s;_e.forEach(["u","d"],function(a){s=a==="u"?t:_e.values(t).reverse(),_e.forEach(["l","r"],function(l){l==="r"&&(s=_e.map(s,function(f){return _e.values(f).reverse()}));var c=(a==="u"?e.predecessors:e.successors).bind(e),d=Y$(e,s,r,c),u=X$(e,s,d.root,d.align,l==="r");l==="r"&&(u=_e.mapValues(u,function(f){return-f})),n[a+l]=u})});var o=Z$(e,n);return J$(n,o),eq(n,e.graph().align)}function rq(e,t,r){return function(n,s,o){var a=n.node(s),l=n.node(o),c=0,d;if(c+=a.width/2,_e.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":d=-a.width/2;break;case"r":d=a.width/2;break}if(d&&(c+=r?d:-d),d=0,c+=(a.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,_e.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=r?d:-d),d=0,c}}function nq(e,t){return e.node(t).width}var _i=et,J4=Xt,sq=H$.positionX,oq=iq;function iq(e){e=J4.asNonCompoundGraph(e),aq(e),_i.forEach(sq(e),function(t,r){e.node(r).x=t})}function aq(e){var t=J4.buildLayerMatrix(e),r=e.graph().ranksep,n=0;_i.forEach(t,function(s){var o=_i.max(_i.map(s,function(a){return e.node(a).height}));_i.forEach(s,function(a){e.node(a).y=n+o/2}),n+=o+r})}var Ee=et,J2=Qz,eS=hF,lq=zF,cq=Xt.normalizeRanks,uq=BF,dq=Xt.removeEmptyRanks,tS=VF,fq=ZF,rS=e$,pq=F$,hq=oq,Qn=Xt,mq=Dr.Graph,gq=xq;function xq(e,t){var r=t&&t.debugTiming?Qn.time:Qn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return Eq(e)});r("  runLayout",function(){vq(n,r)}),r("  updateInputGraph",function(){yq(e,n)})})}function vq(e,t){t("    makeSpaceForEdgeLabels",function(){Tq(e)}),t("    removeSelfEdges",function(){zq(e)}),t("    acyclic",function(){J2.run(e)}),t("    nestingGraph.run",function(){tS.run(e)}),t("    rank",function(){lq(Qn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){Rq(e)}),t("    removeEmptyRanks",function(){dq(e)}),t("    nestingGraph.cleanup",function(){tS.cleanup(e)}),t("    normalizeRanks",function(){cq(e)}),t("    assignRankMinMax",function(){Aq(e)}),t("    removeEdgeLabelProxies",function(){Iq(e)}),t("    normalize.run",function(){eS.run(e)}),t("    parentDummyChains",function(){uq(e)}),t("    addBorderSegments",function(){fq(e)}),t("    order",function(){pq(e)}),t("    insertSelfEdges",function(){Fq(e)}),t("    adjustCoordinateSystem",function(){rS.adjust(e)}),t("    position",function(){hq(e)}),t("    positionSelfEdges",function(){$q(e)}),t("    removeBorderNodes",function(){Lq(e)}),t("    normalize.undo",function(){eS.undo(e)}),t("    fixupEdgeLabelCoords",function(){Mq(e)}),t("    undoCoordinateSystem",function(){rS.undo(e)}),t("    translateGraph",function(){Pq(e)}),t("    assignNodeIntersects",function(){Oq(e)}),t("    reversePoints",function(){Dq(e)}),t("    acyclic.undo",function(){J2.undo(e)})}function yq(e,t){Ee.forEach(e.nodes(),function(r){var n=e.node(r),s=t.node(r);n&&(n.x=s.x,n.y=s.y,t.children(r).length&&(n.width=s.width,n.height=s.height))}),Ee.forEach(e.edges(),function(r){var n=e.edge(r),s=t.edge(r);n.points=s.points,Ee.has(s,"x")&&(n.x=s.x,n.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var bq=["nodesep","edgesep","ranksep","marginx","marginy"],_q={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},wq=["acyclicer","ranker","rankdir","align"],jq=["width","height"],Sq={width:0,height:0},kq=["minlen","weight","width","height","labeloffset"],Nq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Cq=["labelpos"];function Eq(e){var t=new mq({multigraph:!0,compound:!0}),r=ug(e.graph());return t.setGraph(Ee.merge({},_q,cg(r,bq),Ee.pick(r,wq))),Ee.forEach(e.nodes(),function(n){var s=ug(e.node(n));t.setNode(n,Ee.defaults(cg(s,jq),Sq)),t.setParent(n,e.parent(n))}),Ee.forEach(e.edges(),function(n){var s=ug(e.edge(n));t.setEdge(n,Ee.merge({},Nq,cg(s,kq),Ee.pick(s,Cq)))}),t}function Tq(e){var t=e.graph();t.ranksep/=2,Ee.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function Rq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),s=e.node(t.w),o={rank:(s.rank-n.rank)/2+n.rank,e:t};Qn.addDummyNode(e,"edge-proxy",o,"_ep")}})}function Aq(e){var t=0;Ee.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=Ee.max(t,n.maxRank))}),e.graph().maxRank=t}function Iq(e){Ee.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function Pq(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,s=0,o=e.graph(),a=o.marginx||0,l=o.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),r=Math.max(r,u+p/2),n=Math.min(n,f-h/2),s=Math.max(s,f+h/2)}Ee.forEach(e.nodes(),function(d){c(e.node(d))}),Ee.forEach(e.edges(),function(d){var u=e.edge(d);Ee.has(u,"x")&&c(u)}),t-=a,n-=l,Ee.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=n}),Ee.forEach(e.edges(),function(d){var u=e.edge(d);Ee.forEach(u.points,function(f){f.x-=t,f.y-=n}),Ee.has(u,"x")&&(u.x-=t),Ee.has(u,"y")&&(u.y-=n)}),o.width=r-t+a,o.height=s-n+l}function Oq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),s=e.node(t.w),o,a;r.points?(o=r.points[0],a=r.points[r.points.length-1]):(r.points=[],o=s,a=n),r.points.unshift(Qn.intersectRect(n,o)),r.points.push(Qn.intersectRect(s,a))})}function Mq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t);if(Ee.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Dq(e){Ee.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function Lq(e){Ee.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),s=e.node(r.borderBottom),o=e.node(Ee.last(r.borderLeft)),a=e.node(Ee.last(r.borderRight));r.width=Math.abs(a.x-o.x),r.height=Math.abs(s.y-n.y),r.x=o.x+r.width/2,r.y=n.y+r.height/2}}),Ee.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function zq(e){Ee.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function Fq(e){var t=Qn.buildLayerMatrix(e);Ee.forEach(t,function(r){var n=0;Ee.forEach(r,function(s,o){var a=e.node(s);a.order=o+n,Ee.forEach(a.selfEdges,function(l){Qn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:a.rank,order:o+ ++n,e:l.e,label:l.label},"_se")}),delete a.selfEdges})})}function $q(e){Ee.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),s=n.x+n.width/2,o=n.y,a=r.x-s,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:s+2*a/3,y:o-l},{x:s+5*a/6,y:o-l},{x:s+a,y:o},{x:s+5*a/6,y:o+l},{x:s+2*a/3,y:o+l}],r.label.x=r.x,r.label.y=r.y}})}function cg(e,t){return Ee.mapValues(Ee.pick(e,t),Number)}function ug(e){var t={};return Ee.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var al=et,qq=Xt,Bq=Dr.Graph,Wq={debugOrdering:Hq};function Hq(e){var t=qq.buildLayerMatrix(e),r=new Bq({compound:!0,multigraph:!0}).setGraph({});return al.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),al.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),al.forEach(t,function(n,s){var o="layer"+s;r.setNode(o,{rank:"same"}),al.reduce(n,function(a,l){return r.setEdge(a,l,{style:"invis"}),l})}),r}var Uq="0.8.5",Vq={graphlib:Dr,layout:gq,debug:Wq,util:{time:Xt.time,notime:Xt.notime},version:Uq};const yc=tv(Vq),bc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},Gq={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},Kq=220,Yq=110;function nS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(s=>{const o=bc[s.type]||bc.task,l=s.type==="end"&&["blocked","abandoned"].includes(s.terminal_outcome)?Gq:o;return{id:s.node_id,type:"workflowNode",position:s._position||{x:0,y:0},data:{...s,config:l,isEntry:t.includes(s.node_id)}}}),n=(e.edges||[]).map(s=>{const o=s.non_advancing||!s.to_node_id,a=s.conditions&&s.conditions.length>0;let l=s.label||s.outcome;if(a){const c=s.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:s.edge_id,source:s.from_node_id,target:s.to_node_id||s.from_node_id,type:"smoothstep",animated:o,label:l,data:{...s},style:{stroke:o?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:o?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:s.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function Hx(e,t,r="TB",n=Kq,s=Yq){const o=new yc.graphlib.Graph;return o.setDefaultEdgeLabel(()=>({})),o.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(a=>{o.setNode(a.id,{width:n,height:s})}),t.forEach(a=>{a.target!==a.source&&o.setEdge(a.source,a.target)}),yc.layout(o),e.map(a=>{const l=o.node(a.id);return l?{...a,position:{x:l.x-n/2,y:l.y-s/2}}:a})}function Xq(e,t){const r=new Set(t.map(o=>o.id||o.node_id));let n=1,s=`${e}_${n}`;for(;r.has(s);)n++,s=`${e}_${n}`;return s}function Qq(e,t,r){const n=new Set(r.map(a=>a.id||a.edge_id));let s=1,o=`${e}_to_${t}`;for(;n.has(o);)s++,o=`${e}_to_${t}_${s}`;return o}function Zq(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const sS={action:{color:"#1d4ed8",bgColor:"#eff6ff",borderColor:"#3b82f6",label:"Action"},gate:{color:"#b45309",bgColor:"#fef3c7",borderColor:"#f59e0b",label:"Gate"},escalation:{color:"#b91c1c",bgColor:"#fee2e2",borderColor:"#ef4444",label:"Escalation"},parallel_fork:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Fork"},parallel_join:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Join"},start:{color:"#047857",bgColor:"#d1fae5",borderColor:"#10b981",label:"Start"},end:{color:"#374151",bgColor:"#f3f4f6",borderColor:"#6b7280",label:"End"}},oS={normal:{stroke:"#64748b",strokeWidth:2},error:{stroke:"#ef4444",strokeWidth:2,strokeDasharray:"6,3"},retry:{stroke:"#f97316",strokeWidth:2,strokeDasharray:"6,3",animated:!0},parallel:{stroke:"#8b5cf6",strokeWidth:2}},Jq=160,eB=80;function tB({data:e}){const{config:t,showLineage:r}=e,n=e.type==="end",s=e.type==="start",o=r&&(e.dcw_ref||e.task_ref||e.operation_ref||e.gate_profile),a=e.component,l=e.output,c=a||l;return i.jsxs("div",{style:{background:t.bgColor,border:`2px solid ${t.borderColor}`,borderRadius:8,padding:"10px 14px",minWidth:260,maxWidth:360,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[!s&&i.jsx(yr,{type:"target",position:ce.Top,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}}),i.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:t.color,letterSpacing:"0.05em",marginBottom:4},children:t.label}),i.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e293b",lineHeight:"18px",marginBottom:6},children:e.label}),e.actor&&i.jsx("div",{style:{fontSize:11,color:"#4f46e5",fontWeight:500,marginBottom:4},children:e.actor}),c&&i.jsxs("div",{style:{marginTop:6,paddingTop:6,borderTop:"1px solid #e2e8f0",display:"flex",flexDirection:"column",gap:4},children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[i.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Component"}),i.jsx("span",{style:{fontSize:11,color:"#0d9488",fontWeight:500,lineHeight:1.4},children:a})]}),l&&i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[i.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Output"}),i.jsx("span",{style:{fontSize:11,color:"#7c3aed",fontWeight:500,lineHeight:1.4},children:l})]})]}),o&&i.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px dashed #cbd5e1"},children:[e.dcw_ref&&i.jsx(dg,{label:"DCW",value:e.dcw_ref}),e.task_ref&&i.jsx(dg,{label:"Task",value:e.task_ref}),e.operation_ref&&i.jsx(dg,{label:"Op",value:e.operation_ref}),e.gate_profile&&i.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3},children:[i.jsx("span",{style:{fontWeight:600},children:"Gate:"})," ",Array.isArray(e.gate_profile)?e.gate_profile.join(" -> "):e.gate_profile]})]}),!n&&i.jsx(yr,{type:"source",position:ce.Bottom,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}})]})}function dg({label:e,value:t}){const r=t.length>30?"..."+t.slice(-27):t;return i.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3,fontFamily:"monospace"},title:t,children:[i.jsxs("span",{style:{fontWeight:600,fontFamily:"inherit"},children:[e,":"]})," ",r]})}const rB=m.memo(tB),nB={archWorkflowNode:rB};function sB(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const r=[...e].sort((s,o)=>(s.step||s.order||0)-(o.step||o.order||0)).map((s,o)=>({node_id:`step_${o+1}`,type:"action",label:s.action||`Step ${o+1}`,actor:s.actor,description:s.description,inputs:s.inputs,outputs:s.outputs,notes:s.notes})),n=[];for(let s=0;s<r.length-1;s++)n.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:r[s].node_id,to_node_id:r[s+1].node_id,type:"normal"});return{nodes:r,edges:n}}function oB(e,t){const r=e.map(o=>{const a=sS[o.type]||sS.action;return{id:o.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...o,config:a}}}),n=t.map(o=>{const a=o.type||"normal",l=oS[a]||oS.normal;return{id:o.edge_id,source:o.from_node_id,target:o.to_node_id,type:"smoothstep",animated:l.animated||!1,label:o.label,style:{stroke:l.stroke,strokeWidth:l.strokeWidth,strokeDasharray:l.strokeDasharray},labelStyle:{fontSize:9,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:l.stroke}}});return{nodes:Hx(r,n,"TB",Jq,eB),edges:n}}function iS({block:e}){const{data:t}=e;if(!t||!t.name)return null;const[r,n]=m.useState(!1),{graphNodes:s,graphEdges:o,isV1:a}=m.useMemo(()=>{const d=Array.isArray(t.nodes)&&t.nodes.length>0,u=Array.isArray(t.steps)&&t.steps.length>0;if(d)return{graphNodes:t.nodes,graphEdges:t.edges||[],isV1:!1};if(u){const{nodes:f,edges:p}=sB(t.steps);return{graphNodes:f,graphEdges:p,isV1:!0}}return{graphNodes:[],graphEdges:[],isV1:!1}},[t.nodes,t.edges,t.steps]),l=m.useMemo(()=>s.length===0?null:oB(s,o),[s,o]),c=r?600:350;return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.description&&i.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),t.trigger&&i.jsxs("p",{style:{margin:"0 0 8px",fontSize:13,color:"#6b7280",fontStyle:"italic"},children:["Trigger: ",t.trigger]}),l&&l.nodes.length>0?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{height:c,border:"1px solid #e5e7eb",borderRadius:6,background:"#ffffff",overflow:"hidden",transition:"height 0.2s ease"},children:i.jsx(wa,{children:i.jsx(nu,{nodes:l.nodes,edges:l.edges,nodeTypes:nB,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!1,fitView:!0,fitViewOptions:{padding:.2},proOptions:{hideAttribution:!0},minZoom:.3,maxZoom:1.5})})}),i.jsx("button",{onClick:()=>n(d=>!d),style:{marginTop:6,padding:"3px 10px",fontSize:11,color:"#6366f1",background:"none",border:"1px solid #e5e7eb",borderRadius:4,cursor:"pointer"},children:r?"Collapse":"Expand"})]}):i.jsx("p",{style:{margin:0,fontSize:13,color:"#9ca3af",fontStyle:"italic"},children:"No workflow steps defined."})]})}function iB({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.acceptance_criteria)?t.acceptance_criteria:[];return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.target&&i.jsx("p",{style:{margin:"0 0 6px",fontSize:13,color:"#475569"},children:t.target}),t.rationale&&i.jsx("p",{style:{margin:"0 0 8px",fontSize:12,color:"#6b7280",fontStyle:"italic"},children:t.rationale}),r.length>0&&i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Acceptance Criteria"}),i.jsx("ul",{style:{margin:0,paddingLeft:18},children:r.map((n,s)=>i.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:n},s))})]})]})}function aB({block:e}){const{data:t}=e,r=(t==null?void 0:t.name)||(t==null?void 0:t.entity_name);if(!t||!r)return null;const n=Array.isArray(t.fields)?t.fields:[],s=Array.isArray(t.primary_keys)?t.primary_keys:[],o=Array.isArray(t.relationships)?t.relationships:[];return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:r}),t.description&&i.jsx("p",{style:{margin:"0 0 10px",fontSize:13,color:"#475569"},children:t.description}),n.length>0&&i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"2px solid #e2e8f0"},children:[i.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Field"}),i.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Type"}),i.jsx("th",{style:{textAlign:"center",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Required"}),i.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Notes"})]})}),i.jsx("tbody",{children:n.map((a,l)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[i.jsxs("td",{style:{padding:"4px 8px",fontFamily:"monospace",color:"#1e293b",fontWeight:s.includes(a.name)?600:400},children:[a.name,s.includes(a.name)?" (PK)":""]}),i.jsx("td",{style:{padding:"4px 8px",color:"#6366f1",fontFamily:"monospace"},children:a.type}),i.jsx("td",{style:{padding:"4px 8px",textAlign:"center"},children:a.required?"Yes":"No"}),i.jsx("td",{style:{padding:"4px 8px",color:"#6b7280"},children:Array.isArray(a.notes)?a.notes.join("; "):a.notes||a.description||""})]},l))})]}),o.length>0&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Relationships"}),i.jsx("ul",{style:{margin:0,paddingLeft:18},children:o.map((a,l)=>i.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:typeof a=="string"?a:`${a.type||""} ${a.target||""} ${a.description||""}`.trim()},l))})]})]})}function lB({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.endpoints)?t.endpoints:[],n={GET:{bg:"#d1fae5",color:"#065f46"},POST:{bg:"#dbeafe",color:"#1e40af"},PUT:{bg:"#fef3c7",color:"#92400e"},PATCH:{bg:"#fef3c7",color:"#92400e"},DELETE:{bg:"#fee2e2",color:"#991b1b"}};return i.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[i.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.type&&i.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#f0fdf4",color:"#166534",borderRadius:4},children:t.type}),t.protocol&&i.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#eff6ff",color:"#1e40af",borderRadius:4},children:t.protocol})]}),t.description&&i.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),(t.authentication||t.authorization)&&i.jsxs("div",{style:{marginBottom:8,fontSize:12,color:"#6b7280"},children:[t.authentication&&i.jsxs("span",{children:["Auth: ",t.authentication]}),t.authentication&&t.authorization&&i.jsx("span",{children:" | "}),t.authorization&&i.jsxs("span",{children:["Authz: ",t.authorization]})]}),r.length>0&&i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.map((s,o)=>{const a=n[s.method]||{bg:"#f3f4f6",color:"#374151"};return i.jsxs("div",{style:{padding:"8px 10px",background:"#ffffff",borderRadius:6,border:"1px solid #e5e7eb"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 6px",borderRadius:3,background:a.bg,color:a.color,fontFamily:"monospace"},children:s.method}),i.jsx("code",{style:{fontSize:13,color:"#1e293b"},children:s.path})]}),s.description&&i.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:s.description})]},o)})})]})}function cB({block:e}){const{type:t,data:r}=e;return i.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[i.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),i.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function uB({block:e}){const{data:t}=e,r=t.items||[],[n,s]=m.useState({});if(r.length===0)return null;const o=a=>{s(l=>({...l,[a]:!l[a]}))};return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((a,l)=>{const c=n[l],d=a.why_it_matters||a.impact_if_unresolved;return i.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[i.jsxs("button",{onClick:()=>d&&o(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[i.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:a.question||a.value||a.text||"Unknown"}),d&&i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:i.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&i.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[a.why_it_matters&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),i.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.why_it_matters})]}),a.impact_if_unresolved&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),i.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.impact_if_unresolved})]})]})]},l)})})}function dB({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return i.jsxs("div",{style:{marginBottom:12},children:[r&&i.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&i.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function fB({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:s}=t;return i.jsxs("div",{style:{marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[i.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&i.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),s&&i.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s})]})}function pB({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,s=r&&r.length>0,o=n&&n.length>0;return!s&&!o?null:i.jsxs("div",{style:{marginBottom:12},children:[s&&i.jsxs("div",{style:{marginBottom:o?16:0},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((a,l)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#f59e0b"},children:""}),i.jsx("span",{children:a})]},l))})]}),o&&i.jsxs("div",{children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((a,l)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#3b82f6"},children:""}),i.jsx("span",{children:a})]},l))})]})]})}function hB({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:s=[]}=t,o=r&&r.length>0,a=n&&n.length>0,l=s&&s.length>0;return!o&&!a&&!l?null:i.jsxs("div",{style:{marginBottom:12},children:[o&&i.jsxs("div",{style:{marginBottom:a||l?16:0},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#3b82f6"},children:""}),i.jsx("span",{children:c})]},d))})]}),a&&i.jsxs("div",{style:{marginBottom:l?16:0},children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#f59e0b"},children:""}),i.jsx("span",{children:c})]},d))})]}),l&&i.jsxs("div",{children:[i.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),i.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:s.map((c,d)=>i.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[i.jsx("span",{style:{color:"#6b7280"},children:""}),i.jsx("span",{children:c})]},d))})]})]})}function mB({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:s}=t,a={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return i.jsxs("div",{style:{marginBottom:12},children:[r&&i.jsx("div",{style:{marginBottom:12},children:i.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:a.bg,color:a.text},children:r})}),n&&i.jsx("p",{style:{margin:0,marginBottom:s?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),s&&i.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:i.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",s]})})]})}const gB={"schema:ParagraphBlockV1":H8,"schema:StringListBlockV1":Zb,"schema:IndicatorBlockV1":V8,"schema:OpenQuestionV1":zE,"schema:OpenQuestionsBlockV1":G8,"schema:RisksBlockV1":Jb,"schema:DependenciesBlockV1":Jb,"schema:ArchComponentBlockV1":X8,"schema:WorkflowBlockV1":iS,"schema:WorkflowBlockV2":iS,"schema:QualityAttributeBlockV1":iB,"schema:DataModelBlockV1":aB,"schema:InterfaceBlockV1":lB,"schema:SummaryBlockV1":K8,"schema:StorySummaryBlockV1":Y8,"schema:StoriesBlockV1":Zb,"schema:UnknownsBlockV1":uB,"schema:IntakeSummaryBlockV1":dB,"schema:IntakeProjectTypeBlockV1":fB,"schema:IntakeConstraintsBlockV1":pB,"schema:IntakeOpenGapsBlockV1":hB,"schema:IntakeOutcomeBlockV1":mB};function xB(e){return gB[e]||cB}function vB(e,t){const r=xB(e.type);return i.jsx(r,{block:e},e.key||t)}function e3({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:s=""}){var _;const[o,a]=m.useState(new Set(((_=e==null?void 0:e.sections)==null?void 0:_.map(x=>x.section_id))||[]));if(!e)return i.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return i.jsx(jB,{title:l,content:e.raw_content,reason:u.reason});const f=x=>{a(y=>{const b=new Set(y);return b.has(x)?b.delete(x):b.add(x),b})},p=t==="compact"||t==="sidecar",v=t==="sidecar"?d.filter(x=>x.viewer_tab==="overview"||!x.viewer_tab):d,g=(()=>{if(!l)return"Document";const x=l.indexOf(": ");return x>-1?l.slice(x+2):l})();return i.jsxs("div",{className:s,children:[t==="full"&&!r&&i.jsxs("div",{style:{marginBottom:24},children:[i.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&i.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:v.map(x=>i.jsx(wB,{section:x,isExpanded:o.has(x.section_id),onToggle:()=>f(x.section_id),onClick:()=>n==null?void 0:n(x),variant:t},x.section_id))}),v.length===0&&i.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function yB(e){if(!e||!e.data)return"";const{type:t,data:r}=e;switch(t){case"schema:ParagraphBlockV1":return r.text||"";case"schema:StringListBlockV1":return(r.items||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.text||""}`).join(`
`);case"schema:IndicatorBlockV1":return`${r.label||""}: ${r.value||""}`;case"schema:OpenQuestionV1":return`Q: ${r.question||""}
A: ${r.answer||"No answer yet"}`;case"schema:OpenQuestionsBlockV1":return(r.questions||[]).map(n=>`Q: ${n.question||""}
A: ${n.answer||"No answer yet"}`).join(`

`);case"schema:RisksBlockV1":case"schema:DependenciesBlockV1":return(r.items||[]).map(n=>`- ${n.title||n.name||""}: ${n.description||""}`).join(`
`);case"schema:SummaryBlockV1":return r.summary||r.text||"";case"schema:EpicSummaryBlockV1":case"schema:StorySummaryBlockV1":return[r.title||"",r.description||r.summary||""].filter(Boolean).join(`

`);case"schema:UnknownsBlockV1":return(r.items||r.unknowns||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.description||n.text||""}`).join(`
`);case"schema:IntakeSummaryBlockV1":return r.summary||"";case"schema:IntakeProjectTypeBlockV1":return`Project Type: ${r.project_type||r.type||""}`;case"schema:IntakeConstraintsBlockV1":return(r.constraints||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOpenGapsBlockV1":return(r.gaps||r.open_gaps||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOutcomeBlockV1":return`Outcome: ${r.outcome||r.status||""}`;default:return r.text?r.text:r.content?r.content:r.summary?r.summary:r.items&&Array.isArray(r.items)?r.items.map(n=>typeof n=="string"?`- ${n}`:`- ${JSON.stringify(n)}`).join(`
`):""}}function bB({size:e=14}){return i.jsxs("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("rect",{x:"5",y:"5",width:"9",height:"9",rx:"1"}),i.jsx("path",{d:"M2 11V3a1 1 0 011-1h8"})]})}function _B({size:e=14}){return i.jsx("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("path",{d:"M3 8l4 4 6-7"})})}function wB({section:e,isExpanded:t,onToggle:r,onClick:n,variant:s}){const[o,a]=m.useState(!1),{section_id:l,title:c,description:d,blocks:u=[],sidecar_max_items:f}=e,p=s==="compact"||s==="sidecar",h=s==="sidecar";if(u.length===0)return null;const v=async x=>{x.stopPropagation();const y=u.map(yB).filter(Boolean).join(`

`);try{await navigator.clipboard.writeText(y),a(!0),setTimeout(()=>a(!1),2e3)}catch(b){console.error("Failed to copy:",b)}},g=h&&f&&u.length>f?u.slice(0,f):u,_=h&&f&&u.length>f;return i.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[i.jsxs("button",{onClick:r,style:{width:"100%",padding:p?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[i.jsxs("div",{children:[i.jsxs("h3",{style:{margin:0,fontSize:p?13:15,fontWeight:600,color:"#111827"},children:[c,_&&i.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",f," of ",u.length,")"]})]}),d&&!p&&i.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:d})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("button",{onClick:v,title:o?"Copied!":"Copy section",style:{padding:4,background:"none",border:"none",cursor:"pointer",color:o?"#10b981":"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,transition:"color 0.2s"},children:o?i.jsx(_B,{size:14}):i.jsx(bB,{size:14})}),i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:i.jsx("path",{d:"M4 6l4 4 4-4"})})]})]}),t&&i.jsxs("div",{style:{padding:p?12:18},children:[g.map((x,y)=>vB(x,y)),_&&i.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",u.length-f," more in full view"]})]})]})}function jB({title:e,content:t,reason:r}){return i.jsxs("div",{children:[i.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),i.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:i.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function ju(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function Iy({bind:e,data:t,label:r}){if(t==null)return i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"No data"});switch((e==null?void 0:e.render_as)||"paragraph"){case"paragraph":return i.jsx(_c,{data:t});case"list":return i.jsx(Py,{data:t});case"ordered-list":return i.jsx(SB,{data:t});case"table":return i.jsx(kB,{data:t,columns:e.columns});case"key-value-pairs":return i.jsx(t3,{data:t});case"card-list":return i.jsx(NB,{data:t,card:e.card});case"nested-object":return i.jsx(CB,{data:t,fields:e.fields});default:return i.jsx(_c,{data:t})}}function _c({data:e}){const t=typeof e=="string"?e:JSON.stringify(e);return i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6,whiteSpace:"pre-wrap"},children:t})}function Py({data:e}){return!Array.isArray(e)||e.length===0?i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"Empty list"}):i.jsx("ul",{style:{margin:0,paddingLeft:20},children:e.map((t,r)=>i.jsx("li",{style:{fontSize:14,color:"#374151",marginBottom:4},children:typeof t=="string"?t:JSON.stringify(t)},r))})}function SB({data:e}){return!Array.isArray(e)||e.length===0?i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"Empty list"}):i.jsx("ol",{style:{margin:0,paddingLeft:20},children:e.map((t,r)=>i.jsx("li",{style:{fontSize:14,color:"#374151",marginBottom:4},children:typeof t=="string"?t:JSON.stringify(t)},r))})}function kB({data:e,columns:t}){if(!Array.isArray(e)||e.length===0)return i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"No data"});if(!t||t.length===0){const r=e[0];if(typeof r=="object"&&r!==null)t=Object.keys(r).map(n=>({field:n,label:ju(n)}));else return i.jsx(Py,{data:e})}return i.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:i.jsxs("table",{className:"w-full text-sm",style:{borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsx("tr",{style:{background:"#f1f5f9"},children:t.map(r=>i.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b",borderBottom:"1px solid #e2e8f0"},children:r.label},r.field))})}),i.jsx("tbody",{children:e.map((r,n)=>i.jsx("tr",{style:{borderTop:n>0?"1px solid #e2e8f0":"none"},children:t.map(s=>{const o=r==null?void 0:r[s.field];return i.jsx("td",{className:"px-3 py-2",style:{color:"#1e293b",fontSize:13},children:o==null?"-":typeof o=="boolean"?o?"Yes":"No":typeof o=="object"?JSON.stringify(o):String(o)},s.field)})},n))})]})})}function t3({data:e}){return typeof e!="object"||e===null||Array.isArray(e)?i.jsx(_c,{data:e}):i.jsx("div",{className:"space-y-2",children:Object.entries(e).map(([t,r])=>i.jsxs("div",{style:{display:"flex",gap:12,fontSize:14},children:[i.jsx("span",{style:{fontWeight:600,color:"#6b7280",minWidth:120,flexShrink:0},children:ju(t)}),i.jsx("span",{style:{color:"#1f2937"},children:typeof r=="string"?r:JSON.stringify(r)})]},t))})}function NB({data:e,card:t}){if(!Array.isArray(e)||e.length===0)return i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"No items"});if(!t)return i.jsx(Py,{data:e.map(s=>typeof s=="string"?s:JSON.stringify(s))});const r=t.title||"name",n=t.fields||[];return i.jsx("div",{className:"space-y-4",children:e.map((s,o)=>{const a=s[r]||`Item ${o+1}`;return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,overflow:"hidden"},children:[i.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",background:"#f8fafc"},children:i.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:a})}),i.jsx("div",{style:{padding:16},className:"space-y-4",children:n.map(l=>{const c=s[l.path];return c==null?null:i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:6},children:l.label||ju(l.path)}),i.jsx(Iy,{bind:l,data:c})]},l.path)})})]},s.id||o)})})}function CB({data:e,fields:t}){return typeof e!="object"||e===null||Array.isArray(e)?i.jsx(_c,{data:e}):!t||t.length===0?i.jsx(t3,{data:e}):i.jsx("div",{className:"space-y-4",children:t.map(r=>{const n=e[r.path];return n==null?null:i.jsxs("div",{style:{borderLeft:"3px solid #e2e8f0",paddingLeft:12},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:6},children:r.label||ju(r.path)}),i.jsx(Iy,{bind:r,data:n})]},r.path)})})}function EB(e){return typeof e=="string"?{path:e}:e}function TB({renderModel:e,projectId:t,projectCode:r,docTypeId:n,executionId:s,docTypeName:o,onClose:a}){const[l,c]=m.useState(null),{tabDefs:d,tabSections:u,isRawContentMode:f}=m.useMemo(()=>{var $,E;const N=($=e==null?void 0:e.rendering_config)==null?void 0:$.detail_html,S=e==null?void 0:e.information_architecture,C=(e==null?void 0:e.sections)||[],w=e==null?void 0:e.raw_content;if(!(N!=null&&N.tabs)||!(S!=null&&S.sections))return{tabDefs:[{id:"overview",label:"Overview",sections:[]}],tabSections:{overview:C},isRawContentMode:!1};const A={};if(S.sections.forEach(P=>{A[P.id]={binds:(P.binds||[]).map(EB),label:P.label||P.id}}),w&&typeof w=="object"){const P=new Set;if(Object.values(A).forEach(M=>M.binds.forEach(I=>P.add(I.path))),[...P].some(M=>w[M]!==void 0&&w[M]!==null)){const M={};return N.tabs.forEach(I=>{const O=[];(I.sections||[]).forEach(F=>{const q=A[F];q&&q.binds.forEach(H=>{const V=w[H.path];V!=null&&O.push({fieldName:H.path,label:q.label,data:V,bind:H})})}),M[I.id]=O}),{tabDefs:N.tabs,tabSections:M,isRawContentMode:!0}}const L=w.raw===!0&&typeof w.content=="string"?w.content:null;if(L){const M=((E=N.tabs[0])==null?void 0:E.id)||"overview",I={};return N.tabs.forEach(O=>{I[O.id]=[]}),I[M]=[{fieldName:"_fallback",label:"Content",data:L,bind:{path:"_fallback"}}],{tabDefs:N.tabs,tabSections:I,isRawContentMode:!0}}}const T={};N.tabs.forEach(P=>{(P.sections||[]).forEach(R=>{const L=A[R];L&&L.binds.forEach(M=>{T[M.path]=P.id})})});const D={};return N.tabs.forEach(P=>{D[P.id]=[]}),C.forEach(P=>{const R=P.section_id,L=T[R]||"overview";D[L]?D[L].push(P):D.overview&&D.overview.push(P)}),{tabDefs:N.tabs,tabSections:D,isRawContentMode:!1}},[e]),p=l||(d.length>0?d[0].id:"overview"),h=m.useMemo(()=>d.map(N=>{var w,A;const S=u[N.id]||[];if(f)return{id:N.id,label:N.label,count:S.length||null,disabled:S.length===0};const C=((A=(w=S[0])==null?void 0:w.blocks)==null?void 0:A.length)||null;return{id:N.id,label:N.label,count:C,disabled:N.id!=="overview"&&!S.length}}),[d,u,f]),v=(e==null?void 0:e.metadata)||{},g=s?`/admin?execution=${s}`:"/admin",_=(()=>{const N=(e==null?void 0:e.title)||"Document",S=N.indexOf(": ");return S>-1?N.slice(S+2):N})(),x=N=>{if(!N)return null;try{return new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},y=x(v.created_at),b=x(v.updated_at),j=v.lifecycle_state,k=N=>{if(!e)return null;const S=u[N]||[];return{...e,sections:S}};return i.jsxs("div",{className:"flex flex-col h-full",style:{background:"#ffffff"},children:[i.jsxs("div",{className:"px-5 py-3 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:4},children:[r&&i.jsx("a",{href:g,target:"_blank",rel:"noopener noreferrer",title:s?`View execution ${s}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:r}),i.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:o||(n==null?void 0:n.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase()))||"Document"}),j&&i.jsx("span",{style:{padding:"2px 8px",background:j==="complete"?"#dcfce7":"#fef3c7",color:j==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:j})]}),i.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"#111827",lineHeight:1.3},children:_}),y&&i.jsxs("div",{style:{marginTop:2,fontSize:12,color:"#9ca3af"},children:["Generated ",y,b&&b!==y&&i.jsxs("span",{children:["  Updated ",b]})]})]}),i.jsx("div",{className:"flex items-center gap-1 px-4 border-b",style:{background:"#ffffff",borderColor:"#e2e8f0",minHeight:40},children:h.map(N=>{const S=p===N.id;return i.jsxs("button",{onClick:()=>!N.disabled&&c(N.id),disabled:N.disabled,className:"relative px-4 py-2 text-sm font-medium transition-colors",style:{color:S?"#4f46e5":N.disabled?"#9ca3af":"#64748b",background:"transparent",border:"none",cursor:N.disabled?"not-allowed":"pointer"},children:[N.label,N.count!==null&&i.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs rounded-full",style:{background:S?"#eef2ff":"#f1f5f9",color:S?"#4f46e5":"#64748b"},children:N.count}),S&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"#4f46e5"}})]},N.id)})}),i.jsx("div",{className:"flex-1 overflow-hidden",style:{minHeight:0},children:f?i.jsx(AB,{fields:u[p]||[]}):i.jsx(RB,{renderModel:k(p),sections:u[p]||[]})},p)]})}function RB({renderModel:e,sections:t}){return i.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:r=>r.stopPropagation(),children:e&&t.length>0?i.jsx(e3,{renderModel:e,variant:"full",hideHeader:!0}):i.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})})}function AB({fields:e}){return!e||e.length===0?i.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:t=>t.stopPropagation(),children:i.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})}):i.jsx("div",{className:"h-full overflow-y-auto p-6 space-y-6",onWheel:t=>t.stopPropagation(),children:e.map((t,r)=>{var n;return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[i.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:t.label||Oy(t.fieldName)}),Array.isArray(t.data)&&i.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t.data.length})]}),i.jsx("div",{style:{padding:16},children:(n=t.bind)!=null&&n.render_as?i.jsx(Iy,{bind:t.bind,data:t.data,label:t.label}):i.jsx(IB,{data:t.data,fieldName:t.fieldName})})]},t.fieldName||r)})})}function IB({data:e,fieldName:t}){return e==null?i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"No data"}):typeof e=="string"?i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6,whiteSpace:"pre-wrap"},children:e}):Array.isArray(e)?e.length===0?i.jsx("span",{style:{color:"#9ca3af",fontSize:13},children:"Empty list"}):i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((r,n)=>i.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"#374151"},children:[i.jsx("span",{style:{color:"#6b7280",marginTop:2,flexShrink:0,fontSize:12},children:""}),i.jsx("div",{style:{flex:1},children:typeof r=="string"?i.jsx("span",{children:r}):typeof r=="object"&&r!==null?i.jsx(PB,{item:r}):i.jsx("span",{children:String(r)})})]},typeof r=="object"&&(r==null?void 0:r.id)||n))}):typeof e=="object"?i.jsx("div",{className:"space-y-3",children:Object.entries(e).map(([r,n])=>i.jsxs("div",{style:{borderLeft:"3px solid #e2e8f0",paddingLeft:12},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:Oy(r)}),i.jsx("div",{style:{fontSize:14,color:"#1f2937"},children:typeof n=="string"?n:typeof n=="object"?JSON.stringify(n,null,2):String(n)})]},r))}):i.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",fontFamily:"monospace"},children:JSON.stringify(e,null,2)})}function PB({item:e}){const r=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title","problem_understanding","architectural_intent","proposed_system_shape"].find(h=>e[h]&&typeof e[h]=="string"),n=r?e[r]:null,s=e.id,o=e.confidence,a=e.likelihood,l=e.constraint_type,c=e.why_it_matters||e.why_early,d=e.impact_on_planning||e.impact_if_unresolved||e.impact,u=e.mitigation_direction,f=e.recommendation_direction,p=e.validation_approach;return n?i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:s}),i.jsx("span",{style:{fontWeight:500},children:n}),l&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:l}),o&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:o==="high"?"#dcfce7":o==="medium"?"#fef3c7":"#fee2e2",color:o==="high"?"#166534":o==="medium"?"#92400e":"#991b1b"},children:o}),a&&i.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[a,e.impact?`/${e.impact}`:""]})]}),p&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Validation: ",p]}),c&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Why: ",c]}),d&&typeof d=="string"&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Impact: ",d]}),u&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Mitigation: ",u]}),f&&i.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",f]})]}):i.jsx("span",{style:{fontSize:13,color:"#374151"},children:Object.entries(e).map(([h,v],g)=>i.jsxs("span",{children:[g>0&&"  ",i.jsxs("span",{style:{fontWeight:500},children:[Oy(h),":"]})," ",typeof v=="string"?v:JSON.stringify(v)]},h))})}function Oy(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function OB({projectId:e,projectCode:t,docTypeId:r,instanceId:n,onClose:s}){var S,C,w,A;const[o,a]=m.useState(null),[l,c]=m.useState(null),[d,u]=m.useState({}),[f,p]=m.useState(null),[h,v]=m.useState(null),[g,_]=m.useState(!0),[x,y]=m.useState(null);if(m.useEffect(()=>{async function T(){var D,$;try{_(!0),y(null),ze.getDocumentPgc(e,r,n).then(P=>{P!=null&&P.has_pgc&&v(P)}).catch(()=>{});try{const P=await ze.getDocumentRenderModel(e,r,n);if(P!=null&&P.metadata&&u(P.metadata),P!=null&&P.title&&p(P.title),(D=P==null?void 0:P.rendering_config)!=null&&D.detail_html){a(P),c(null);return}if(P&&P.sections&&P.sections.length>0){a(P),c(null);return}if(($=P==null?void 0:P.metadata)!=null&&$.fallback&&P.raw_content){a(null),c(P.raw_content);return}}catch(P){console.log("RenderModel not available, falling back to raw document:",P.message)}const E=await ze.getDocument(e,r,n);a(null),c((E==null?void 0:E.content)||null)}catch(E){y(E.message),console.error("Failed to fetch document:",E)}finally{_(!1)}}T()},[e,r,n]),m.useEffect(()=>{const T=D=>{D.key==="Escape"&&s()};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[s]),g)return i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:i.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})});const b=(o==null?void 0:o.metadata)||d,j=b.execution_id,k=j?`/admin?execution=${j}`:"/admin";return((S=o==null?void 0:o.rendering_config)==null?void 0:S.detail_html)&&o?i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:T=>T.target===T.currentTarget&&s(),children:i.jsxs("div",{className:"relative w-full max-w-6xl h-[90vh] overflow-hidden rounded-lg shadow-2xl flex flex-col",style:{background:"#ffffff"},children:[i.jsx("button",{onClick:s,className:"absolute top-2 right-3 z-10 p-1.5 rounded-lg hover:bg-gray-200 transition-colors",style:{background:"rgba(255,255,255,0.9)"},children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),i.jsx(TB,{renderModel:o,projectId:e,projectCode:t,docTypeId:r,executionId:j,docTypeName:b.document_type_name,onClose:s})]})}):i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:T=>T.target===T.currentTarget&&s(),children:i.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[i.jsx(MB,{title:(o==null?void 0:o.title)||f,projectCode:t,adminUrl:k,executionId:j,metadata:b,onClose:s}),((C=b==null?void 0:b.spawned_children)==null?void 0:C.count)>0&&i.jsx(DB,{children:b.spawned_children}),i.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:((w=b==null?void 0:b.spawned_children)==null?void 0:w.count)>0?"calc(90vh - 130px)":"calc(90vh - 80px)"},onWheel:T=>T.stopPropagation(),children:[x&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-red-500",children:x})}),o&&i.jsx(e3,{renderModel:o,variant:"full",hideHeader:!0}),l&&!o&&i.jsx(LB,{content:l,docTypeId:r}),!o&&!l&&!x&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"No content available"})}),h&&((A=h.clarifications)==null?void 0:A.length)>0&&i.jsx(qB,{pgcContext:h})]})]})})}function MB({title:e,projectCode:t,adminUrl:r,executionId:n,metadata:s,onClose:o}){const a=(()=>{if(!e)return"Document";const h=e.indexOf(": ");return h>-1?e.slice(h+2):e})(),l=(s==null?void 0:s.document_type_name)||(s!=null&&s.document_type?s.document_type.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase()):null),c=h=>{if(!h)return null;try{return new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},d=c(s==null?void 0:s.created_at),u=c(s==null?void 0:s.updated_at),f=s==null?void 0:s.version,p=s==null?void 0:s.lifecycle_state;return i.jsx("div",{className:"sticky top-0 px-6 py-4 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:6},children:[t&&i.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:n?`View execution ${n}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:t}),l&&i.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:l}),p&&i.jsx("span",{style:{padding:"2px 8px",background:p==="complete"?"#dcfce7":"#fef3c7",color:p==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:p}),f&&f>1&&i.jsxs("span",{style:{padding:"2px 8px",background:"#f3f4f6",color:"#6b7280",fontSize:11,fontWeight:600,borderRadius:4},children:["v",f]})]}),i.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#111827",lineHeight:1.3},children:a}),d&&i.jsxs("div",{style:{marginTop:4,fontSize:12,color:"#9ca3af"},children:["Generated ",d,u&&u!==d&&i.jsxs("span",{children:["  Updated ",u]})]})]}),i.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",style:{flexShrink:0,marginLeft:12},children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})})}function DB({children:e}){const{count:t,items:r}=e;return i.jsxs("div",{className:"flex items-center gap-3 flex-wrap px-6 py-3",style:{background:"#f0fdf4",borderBottom:"1px solid #bbf7d0"},children:[i.jsxs("span",{style:{fontSize:13,color:"#166534",fontWeight:600},children:["This plan produced ",t," Epic document",t!==1?"s":""]}),i.jsx("div",{className:"flex items-center gap-1.5 flex-wrap",children:r.map(n=>i.jsx("span",{title:n.title||n.name,style:{padding:"2px 8px",background:"#dcfce7",color:"#15803d",fontSize:11,fontWeight:500,borderRadius:4,whiteSpace:"nowrap"},children:n.name||n.epic_id},n.epic_id))})]})}function LB({content:e,docTypeId:t}){if(!e)return i.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n={preliminary_summary:{title:"Summary",icon:"S",color:"#7c3aed",render:"summary"},stakeholder_questions:{title:"Stakeholder Questions",icon:"?",color:"#dc2626",render:"questions"},unknowns:{title:"Unknowns to Resolve",icon:"?",color:"#d97706"},early_decision_points:{title:"Early Decision Points",icon:"D",color:"#7c3aed"},risks:{title:"Risks",icon:"!",color:"#dc2626"},known_constraints:{title:"Known Constraints",icon:"C",color:"#6b7280"},assumptions:{title:"Assumptions",icon:"A",color:"#d97706"},mvp_guardrails:{title:"MVP Guardrails",icon:"G",color:"#059669"},recommendations_for_pm:{title:"Recommendations for PM",icon:"R",color:"#2563eb"},pgc_clarifications:{title:"PGC Clarifications",icon:"Q",color:"#7c3aed",render:"clarifications"}},s=new Set(["project_name","title","name","meta","description","summary"]),o=Object.keys(e).filter(l=>!s.has(l)&&(Array.isArray(e[l])||typeof e[l]=="object"&&e[l]!==null));return o.length>0?i.jsxs("div",{className:"space-y-6",children:[r&&i.jsxs("div",{style:{borderBottom:"2px solid #7c3aed",paddingBottom:12},children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r}),i.jsx("span",{className:"text-xs font-mono text-gray-400",children:t})]}),Object.entries(n).map(([l,c])=>{const d=e[l];return d?c.render==="summary"&&typeof d=="object"&&!Array.isArray(d)?i.jsx(zB,{data:d,config:c},l):c.render==="questions"&&Array.isArray(d)?i.jsx(FB,{data:d,config:c},l):c.render==="clarifications"&&Array.isArray(d)?i.jsx($B,{data:d,config:c},l):Array.isArray(d)?i.jsx(cS,{data:d,config:c},l):null:null}),o.filter(l=>!n[l]).map(l=>{const c=e[l];return Array.isArray(c)?i.jsx(cS,{data:c,config:{title:ia(l),icon:"#",color:"#6b7280"}},l):typeof c=="object"&&c!==null?i.jsx(WB,{data:c,label:ia(l)},l):null}),i.jsxs("details",{style:{borderRadius:8,border:"1px solid #e2e8f0"},children:[i.jsx("summary",{style:{padding:"12px 16px",cursor:"pointer",fontSize:13,fontWeight:600,color:"#6b7280",background:"#f8fafc",borderRadius:8},children:"Raw Data (JSON)"}),i.jsx("div",{style:{padding:16,overflow:"auto"},children:i.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(e,null,2)})})]})]}):i.jsx(HB,{content:e,docTypeId:t,title:r})}function zB({data:e,config:t}){const r=[{key:"problem_understanding",label:"Problem Understanding"},{key:"architectural_intent",label:"Architectural Intent"},{key:"proposed_system_shape",label:"Proposed System Shape"}];return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Su,{config:t}),i.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.map(n=>e[n.key]?i.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:n.label}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:e[n.key]})]},n.key):null),Object.entries(e).filter(([n])=>!r.some(s=>s.key===n)).map(([n,s])=>typeof s=="string"?i.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:ia(n)}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:s})]},n):null)]})]})}function FB({data:e,config:t}){const r=e.filter(s=>s.blocking),n=e.filter(s=>!s.blocking);return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Su,{config:t,count:e.length}),i.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.length>0&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#dc2626",marginBottom:8,textTransform:"uppercase"},children:"Blocking"}),r.map((s,o)=>i.jsx(aS,{q:s,borderColor:"#dc2626"},s.id||o))]}),n.length>0&&i.jsxs("div",{children:[r.length>0&&i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,textTransform:"uppercase"},children:"Non-blocking"}),n.map((s,o)=>i.jsx(aS,{q:s,borderColor:"#d1d5db"},s.id||o))]})]})]})}function aS({q:e,borderColor:t}){return i.jsxs("div",{style:{borderLeft:`3px solid ${t}`,paddingLeft:12,marginBottom:8},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2},children:[e.id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.id}),e.directed_to&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.directed_to.replace(/_/g," ")})]}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,fontWeight:500},children:e.question||e.text||UB(e)}),e.notes&&i.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0 0"},children:e.notes})]})}function $B({data:e,config:t}){const r={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}};return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Su,{config:t,count:e.length}),i.jsx("div",{style:{padding:16},className:"space-y-3",children:e.map((n,s)=>{const o=r[n.constraint_kind]||r.selection;return i.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12,marginBottom:8},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[n.question_id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:n.question_id}),n.binding&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),n.constraint_kind&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:o.bg,color:o.color,borderRadius:4},children:n.constraint_kind}),n.binding_source&&i.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",n.binding_source]})]}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:n.question}),n.why_it_matters&&i.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:n.why_it_matters}),n.answer&&i.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[i.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),i.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:n.answer})]})]},n.question_id||s)})})]})}function qB({pgcContext:e}){const{clarifications:t}=e,r=t.filter(s=>s.binding),n=t.filter(s=>!s.binding);return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,marginTop:24},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[i.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:"#7c3aed15",color:"#7c3aed"},children:"Q"}),i.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:"Pre-Generation Clarifications"}),i.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t.length})]}),i.jsxs("div",{style:{padding:16},className:"space-y-4",children:[r.length>0&&i.jsxs("div",{children:[i.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#1e40af",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Binding Constraints (",r.length,")"]}),r.map((s,o)=>i.jsx(lS,{item:s},s.question_id||o))]}),n.length>0&&i.jsxs("div",{children:[r.length>0&&i.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,marginTop:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Informational (",n.length,")"]}),n.map((s,o)=>i.jsx(lS,{item:s},s.question_id||o))]})]})]})}function lS({item:e}){const t={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}},r=t[e.constraint_kind]||t.selection;return i.jsxs("div",{style:{borderLeft:`3px solid ${e.binding?"#3b82f6":"#d1d5db"}`,paddingLeft:12,marginBottom:12},children:[i.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[e.question_id&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.question_id}),e.binding&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),e.constraint_kind&&i.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:r.bg,color:r.color,borderRadius:4},children:e.constraint_kind}),e.binding_source&&i.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",e.binding_source]})]}),i.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:e.question}),e.why_it_matters&&i.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:e.why_it_matters}),e.answer&&i.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[i.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),i.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:e.answer})]})]})}function cS({data:e,config:t}){return!e||e.length===0?null:i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx(Su,{config:t,count:e.length}),i.jsx("div",{style:{padding:16},children:i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((r,n)=>i.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"#374151"},children:[i.jsx("span",{style:{color:t.color,marginTop:2,flexShrink:0,fontSize:12},children:t.icon==="!"?"":""}),i.jsx("div",{style:{flex:1},children:typeof r=="string"?i.jsx("span",{children:r}):typeof r=="object"&&r!==null?i.jsx(BB,{item:r}):i.jsx("span",{children:String(r)})})]},typeof r=="object"&&r.id||n))})})]})}function BB({item:e}){const r=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title"].find(h=>e[h]&&typeof e[h]=="string"),n=r?e[r]:null,s=e.id,o=e.confidence,a=e.constraint_type,l=e.validation_approach,c=e.impact_on_planning||e.impact_if_unresolved,d=e.mitigation_direction,u=e.likelihood,f=e.why_it_matters||e.why_early,p=e.recommendation_direction;return n?i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&i.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:s}),i.jsx("span",{style:{fontWeight:500},children:n}),a&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:a}),o&&i.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:o==="high"?"#dcfce7":o==="medium"?"#fef3c7":"#fee2e2",color:o==="high"?"#166534":o==="medium"?"#92400e":"#991b1b"},children:o}),u&&i.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[u,"/",e.impact||"?"]})]}),l&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Validation: ",l]}),f&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Why: ",f]}),c&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Impact: ",c]}),d&&i.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Mitigation: ",d]}),p&&i.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",p]})]}):i.jsx("span",{style:{fontSize:13,color:"#374151"},children:Object.entries(e).map(([h,v],g)=>i.jsxs("span",{children:[g>0&&"  ",i.jsxs("span",{style:{fontWeight:500},children:[ia(h),":"]})," ",typeof v=="string"?v:JSON.stringify(v)]},h))})}function WB({data:e,label:t}){return i.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[i.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontWeight:600,fontSize:14,color:"#1f2937"},children:t}),i.jsx("div",{style:{padding:16},children:Object.entries(e).map(([r,n])=>i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:ia(r)}),i.jsx("div",{style:{fontSize:14,color:"#1f2937"},children:typeof n=="string"?n:typeof n=="object"?JSON.stringify(n,null,2):String(n)})]},r))})]})}function Su({config:e,count:t}){return i.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[i.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:`${e.color}15`,color:e.color},children:e.icon}),i.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:e.title}),t!==void 0&&i.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t})]})}function HB({content:e,docTypeId:t,title:r}){return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",i.jsx("strong",{children:t})," - displaying raw content"]}),r&&i.jsx("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r})}),i.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:i.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}function UB(e){if(typeof e=="string")return e;if(typeof e!="object"||e===null)return String(e);for(const t of Object.values(e))if(typeof t=="string"&&t.length>10)return t;return JSON.stringify(e)}function ia(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}const VB="/api/v1/admin";class GB extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function KB(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ae(e,t={}){var o;const r=`${VB}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const a=KB();a&&(n.headers["X-CSRF-Token"]=a)}const s=await fetch(r,n);if(!s.ok){const a=await s.json().catch(()=>({})),l=((o=a.detail)==null?void 0:o.message)||a.detail||`Request failed: ${s.status}`;throw new GB(l,s.status,a.detail||a)}return s.status===204?null:s.json()}const we={getCurrentWorkspace:async()=>{try{return await Ae("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ae("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ae(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ae(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ae(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>Ae(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ae(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ae(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ae(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ae(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ae("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ae(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ae("/workbench/prompt-fragments"),getRoles:()=>Ae("/workbench/roles"),getTemplates:()=>Ae("/workbench/templates"),getSchemas:()=>Ae("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ae("/workbench/workflows"),getOrchestrationWorkflows:()=>Ae("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ae(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ae(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ae(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ae(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ae(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ae(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ae(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ae(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ae("/workbench/active-releases"),invalidateCache:()=>Ae("/workbench/invalidate-cache",{method:"POST"}),getMechanicalOpTypes:()=>Ae("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Ae(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Ae("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Ae("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ae(`/workbench/mechanical-ops/${e}${r}`)}};function YB({projectId:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,a]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,v]=m.useState(!1),[g,_]=m.useState(null),[x,y]=m.useState(!1),[b,j]=m.useState(!1),k=m.useCallback(async()=>{try{const E=((await we.getOrchestrationWorkflows()).workflows||[]).filter(R=>R.workflow_id!=="intake_and_route"),P=E.find(R=>R.workflow_id==="software_product_development")||E[0];if(P){const R=await ze.createWorkflowInstance(e,P.workflow_id,P.active_version);r(R)}}catch($){console.error("Failed to auto-assign workflow:",$)}},[e]),N=m.useCallback(async()=>{if(e){s(!0),a(null);try{const $=await ze.getWorkflowInstance(e);r($)}catch($){$.status===404?(r(null),await k()):a($.message)}finally{s(!1)}}},[e,k]);m.useEffect(()=>{N()},[N]);const S=async()=>{c(!0),p(!0);try{const E=((await we.getOrchestrationWorkflows()).workflows||[]).filter(P=>P.workflow_id!=="intake_and_route");u(E)}catch{u([])}finally{p(!1)}},C=async $=>{v(!0);try{const E=await ze.createWorkflowInstance(e,$.workflow_id,$.active_version);r(E),c(!1)}catch(E){a(E.message)}finally{v(!1)}},w=async()=>{if(t&&(j(!b),!g)){y(!0);try{const $=await ze.getWorkflowDrift(e);_($)}catch($){_({error:$.message})}finally{y(!1)}}};if(n)return i.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(o&&!t)return i.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:o});if(!t)return i.jsxs("div",{className:"p-4",children:[i.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?i.jsx(XB,{workflows:d,loading:f,assigning:h,onSelect:C,onCancel:()=>c(!1)}):i.jsx("button",{onClick:S,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const A=t.effective_workflow||{},T=A.steps||[],D=t.base_workflow_ref||{};return i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:A.name||D.workflow_id||"Workflow"}),i.jsx(QB,{status:t.status})]}),i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",D.workflow_id," v",D.version,D.pow_class?` (${D.pow_class})`:""]})]}),i.jsx("button",{onClick:w,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:x?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&i.jsx(ZB,{drift:g}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",T.length,")"]}),T.length===0?i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):i.jsx("div",{className:"space-y-1",children:T.map(($,E)=>i.jsx(JB,{step:$,index:E},$.step_id||E))})]}),o&&i.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:o})]})}function XB({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:s}){const o=e.filter(l=>(l.pow_class||"reference")==="reference"),a=e.filter(l=>l.pow_class==="template");return i.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):i.jsxs(i.Fragment,{children:[o.length>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),o.map(l=>i.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[i.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),i.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),a.length>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),a.map(l=>i.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[i.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),i.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),o.length===0&&a.length===0&&i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),i.jsx("button",{onClick:s,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function QB({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function ZB({drift:e}){return e.error?i.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):i.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[i.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[i.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),i.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&i.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&i.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&i.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&i.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&i.jsx("div",{children:"~ Metadata changed"})]})]})}function JB({step:e,index:t}){return i.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&i.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&i.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}const fg=(e,t,r=null)=>{const n=new yc.graphlib.Graph;return n.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),n.setDefaultEdgeLabel(()=>({})),e.forEach(s=>{n.setNode(s.id,{width:s.data.width??280,height:s.data.height??90})}),t.forEach(s=>{n.setEdge(s.source,s.target)}),yc.layout(n),{nodes:e.map(s=>{const o=n.node(s.id),a={x:o.x-(s.data.width??280)/2,y:o.y-(s.data.height??90)/2},l=r==null?void 0:r[s.id];return{...s,targetPosition:ce.Top,sourcePosition:ce.Bottom,position:l||a}}),edges:t}},pg=(e,t,r)=>{let n=[],s=[],o=null,a=null,l=[];const c=r.theme||"industrial";return e.forEach((d,u)=>{var v,g,_;if((d.level||1)!==1)return;const f=280;let p=95;((v=d.stations)==null?void 0:v.length)>0&&(p+=35);const h=t===d.id;if(n.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...r},connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),o){const x=(g=e[u-1])==null?void 0:g.state;s.push({id:"e-"+o+"-"+d.id,source:o,target:d.id,type:"smoothstep",animated:x==="active",style:{stroke:LE(x,c),strokeWidth:3}})}((_=d.children)==null?void 0:_.length)>0&&(a=d.id,l=d.children),o=d.id}),{nodes:n,edges:s,parentId:a,childNodes:l}},hg=(e,t,r,n,s)=>{const{nodes:o,edges:a}=e;if(!t||!r.length)return{nodes:o,edges:a};const l=o.find(b=>b.id===t);if(!l)return{nodes:o,edges:a};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=s.theme||"industrial",p=LE(u,f),h=u==="active",v=Sr.WP_HEIGHT+Sr.WP_GAP_Y,g=Math.ceil(r.length/Sr.WPS_PER_ROW),_=c+280*.15,x=50,y={};r.forEach((b,j)=>{const k=Math.floor(j/Sr.WPS_PER_ROW);y[k]||(y[k]=[]),y[k].push({child:b,idx:j})});for(let b=0;b<g;b++){const j=y[b]||[];if(j.length===0)continue;const k=d+Sr.WP_OFFSET_Y+b*v,N=`junction-row-${b}`;o.push({id:N,type:"waypoint",position:{x:_,y:k-x},draggable:!1,connectable:!1,selectable:!1}),b===0?a.push({id:`e-spine-drop-${b}`,source:t,target:N,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):a.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:N,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),j.forEach(({child:S,idx:C})=>{const w=C%Sr.WPS_PER_ROW,A=c+Sr.WP_OFFSET_X+w*(Sr.WP_WIDTH+Sr.WP_GAP_X),T=k,D=n===S.id;o.push({id:S.id,type:"documentNode",data:{...S,width:Sr.WP_WIDTH,height:Sr.WP_HEIGHT,isExpanded:D,...s},draggable:!1,connectable:!1,position:{x:A,y:T},targetPosition:ce.Top,sourcePosition:ce.Bottom,zIndex:D?1e3:0}),a.push({id:`e-branch-${S.id}`,source:N,target:S.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:o,edges:a}},e9={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"};function t9(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1,metadata:r.metadata||{}};return t}function r9(e,t=[]){const r=[],n=[],s={};for(const o of e.tracks){const a=n9(o,t);if((o.scope||"project")==="project")n.push({...a,mayOwn:o.may_own||[],childDocType:o.child_doc_type});else{const c=o.document_type;s[c]||(s[c]=[]),s[c].push({...a,sequence:o.sequence})}}for(const o of n)o.childDocType&&s[o.childDocType]&&(o.children=s[o.childDocType].sort((a,l)=>(a.sequence??999)-(l.sequence??999)).map(a=>({...a,level:2,docTypeId:a.docTypeId,instanceId:a.instanceId}))),r.push(o);return r}function n9(e,t=[]){var a,l,c,d,u,f,p;const r=e9[e.state]||"ready_for_production";e.state;const n=t.find(h=>h.document_type===e.document_type);let s=null;e.stations&&e.stations.length>0&&(s=s9(e.stations,e.state,e.station));let o=null;if(n){const h=n.questions||((l=(a=n.payload)==null?void 0:a.data)==null?void 0:l.questions)||(Array.isArray((c=n.payload)==null?void 0:c.data)?n.payload.data:null);h&&Array.isArray(h)&&(o=h.map((v,g)=>({id:v.id||`q${g+1}`,text:v.question||v.text||v,required:v.required!==!1,choices:v.choices||null,answer_type:v.answer_type||"text",why_it_matters:v.why_it_matters||null,priority:v.priority||null,blocking:v.blocking!==!1,default:v.default||null,constraint_kind:v.constraint_kind||null})))}return{id:e.identifier||e.document_type,docTypeId:e.document_type,instanceId:e.instance_id||null,name:e.document_name||o9(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:s,questions:o,interruptId:n==null?void 0:n.id,blockedBy:e.blocked_by||[],ws_done:e.ws_done??((d=e.metadata)==null?void 0:d.ws_done)??0,ws_total:e.ws_total??((u=e.metadata)==null?void 0:u.ws_total)??0,mode_b_count:e.mode_b_count??((f=e.metadata)==null?void 0:f.mode_b_count)??0,dependencies:e.dependencies||[],workStatements:e.work_statements||((p=e.metadata)==null?void 0:p.work_statements)||[]}}function s9(e,t,r){return!e||e.length===0?null:e.map(n=>({id:n.station,label:n.label||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function o9(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function i9({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,s]=m.useState(!0),[o,a]=m.useState(null),l=m.useCallback(async()=>{s(!0),a(null);try{const d=await ze.getProjects({includeArchived:e}),u=t9(d);r(u)}catch(d){a(d.message),console.error("Failed to fetch projects:",d)}finally{s(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await ze.createProject({name:d,description:""});return r(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw a(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:o,addProject:c,refresh:l}}function a9(e){const[t,r]=m.useState([]),[n,s]=m.useState("idle"),[o,a]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(null),g=m.useRef(null),_=m.useRef(null),x=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[S,C]=await Promise.all([ze.getProductionStatus(e),ze.getProjectInterrupts(e).catch(()=>[])]);a(C),s(S.line_state),r(r9(S,C))}catch(S){u(S.message),console.error("Failed to fetch production status:",S)}finally{c(!1)}},[e]),y=m.useCallback(()=>{if(!e)return;g.current&&g.current.close();const S=q8(e);g.current=S,S.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),S.addEventListener("station_transition",C=>{try{const w=JSON.parse(C.data);console.log("Station transition:",w),x()}catch(w){console.error("Failed to parse station_transition:",w)}}),S.addEventListener("line_stopped",C=>{try{const w=JSON.parse(C.data);console.log("Line stopped:",w),s("stopped"),x()}catch(w){console.error("Failed to parse line_stopped:",w)}}),S.addEventListener("production_complete",C=>{try{const w=JSON.parse(C.data);console.log("Production complete:",w),s("complete"),x()}catch(w){console.error("Failed to parse production_complete:",w)}}),S.addEventListener("interrupt_resolved",C=>{try{const w=JSON.parse(C.data);console.log("Interrupt resolved:",w),x()}catch(w){console.error("Failed to parse interrupt_resolved:",w)}}),S.addEventListener("track_started",C=>{try{const w=JSON.parse(C.data);console.log("Track started:",w),s("active"),x()}catch(w){console.error("Failed to parse track_started:",w)}}),S.addEventListener("track_stabilized",C=>{try{const w=JSON.parse(C.data);console.log("Track stabilized:",w),x()}catch(w){console.error("Failed to parse track_stabilized:",w)}}),S.addEventListener("children_updated",C=>{try{const w=JSON.parse(C.data);console.log("Children updated:",w),x()}catch(w){console.error("Failed to parse children_updated:",w)}}),S.addEventListener("stations_declared",C=>{try{const w=JSON.parse(C.data);console.log("Stations declared:",w);const{document_type:A,stations:T}=w;r(D=>{const $=D.some(P=>P.id===A);console.log("stations_declared raw stations:",T);const E=T.map(P=>({id:P.id,label:P.label,state:P.state,phases:P.phases||[],phase:null}));return console.log("stations_declared processed:",E),$?D.map(P=>P.id===A?{...P,state:"in_production",stations:E}:P):[...D,{id:A,name:A.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase()),state:"in_production",stations:E}]})}catch(w){console.error("Failed to parse stations_declared:",w)}}),S.addEventListener("station_changed",C=>{try{const w=JSON.parse(C.data);console.log("Station changed:",w);const{document_type:A,station_id:T,state:D}=w;r($=>$.map(E=>E.id!==A||!E.stations?E:{...E,stations:E.stations.map(P=>P.id===T?{...P,state:D}:P)}))}catch(w){console.error("Failed to parse station_changed:",w)}}),S.addEventListener("internal_step",C=>{try{const w=JSON.parse(C.data);console.log("Internal step:",w);const{document_type:A,station_id:T,step:D}=w;r($=>$.map(E=>E.id!==A||!E.stations?E:{...E,stations:E.stations.map(P=>P.id===T?{...P,currentStep:D}:P)}))}catch(w){console.error("Failed to parse internal_step:",w)}}),S.onerror=C=>{console.error("SSE error:",C),p(!1),u("Connection lost"),S.close(),_.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),y()},3e3)}},[e,x]),b=m.useCallback(()=>{_.current&&clearTimeout(_.current),g.current&&(g.current.close(),g.current=null),p(!1)},[]),j=m.useCallback(async(S,C)=>{try{await ze.resolveInterrupt(S,{answers:C})}catch(w){throw console.error("Failed to resolve interrupt:",w),w}},[]),k=m.useCallback(async(S=null)=>{var C;try{v(null),await ze.startProduction(e,S),s("active")}catch(w){console.error("Failed to start production:",w);const A=((C=w.data)==null?void 0:C.message)||w.message||"Failed to start production";throw v({type:"error",message:A}),S&&r(T=>T.map(D=>D.id===S?{...D,state:"ready_for_production",stations:null}:D)),s("idle"),x(),w}},[e,x]),N=m.useCallback(()=>{v(null)},[]);return m.useEffect(()=>(x(),y(),()=>b()),[x,y,b]),{data:t,lineState:n,interrupts:o,loading:l,error:d,connected:f,notification:h,dismissNotification:N,refresh:x,resolveInterrupt:j,startProduction:k}}const uS="combine-theme";function r3(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const o=localStorage.getItem(uS);return o&&Pn.includes(o)?o:e});m.useEffect(()=>{localStorage.setItem(uS,t)},[t]);const n=m.useCallback(o=>{Pn.includes(o)&&r(o)},[]),s=m.useCallback(()=>{r(o=>{const a=Pn.indexOf(o);return Pn[(a+1)%Pn.length]})},[]);return{theme:t,setTheme:n,cycleTheme:s}}function l9(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[s,o]=m.useState([]),[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[v,g]=m.useState([]),[_,x]=m.useState(!1),[y,b]=m.useState(null),[j,k]=m.useState(null),[N,S]=m.useState(null),[C,w]=m.useState(!1),[A,T]=m.useState(!1),[D,$]=m.useState(null),[E,P]=m.useState(null),[R,L]=m.useState(null),M=m.useRef(null),I=m.useRef(null),O=m.useRef(!0);m.useEffect(()=>(O.current=!0,()=>{O.current=!1,M.current&&M.current.close()}),[]);const F=m.useCallback(X=>{O.current&&(n(X.phase),o(X.messages||[]),l(X.pending_prompt),d(X.pending_choices),f(X.interpretation||{}),h(X.confidence||0),g(X.missing_fields||[]),x(X.can_initialize||!1),b(X.gate_outcome),k(X.project),$(X.intake_classification),P(X.intake_gate_phase),L(X.operational_error||null))},[]),q=m.useCallback(async()=>{S(null),w(!0);try{const X=await ze.startIntake();if(!O.current)return;t(X.execution_id),F(X)}catch(X){if(!O.current)return;S(X.message||"Failed to start intake")}finally{O.current&&w(!1)}},[]),H=m.useCallback(async X=>{if(!e||!X.trim())return;S(null),L(null),T(!0),I.current=X;const Q={role:"user",content:X};o(fe=>[...fe,Q]);try{const fe=await ze.submitIntakeMessage(e,X);if(!O.current)return;F(fe)}catch(fe){if(!O.current)return;o(ge=>ge.filter(be=>be!==Q)),S(fe.message||"Failed to submit message")}finally{O.current&&T(!1)}},[e,F]),V=m.useCallback(async()=>{I.current&&(L(null),await H(I.current))},[H]),Z=m.useCallback(async(X,Q)=>{if(e){S(null),f(fe=>({...fe,[X]:{value:Q,source:"user",locked:!0}}));try{const fe=await ze.updateIntakeField(e,X,Q);if(!O.current)return;F(fe)}catch(fe){if(!O.current)return;S(fe.message||"Failed to update field");const ge=await ze.getIntakeState(e);O.current&&F(ge)}}},[e,F]),B=m.useCallback(async()=>{if(!(!e||!_)){S(null),w(!0);try{const X=await ze.initializeIntake(e);if(!O.current)return;F(X),X.phase==="generating"&&re()}catch(X){if(!O.current)return;S(X.message||"Failed to initialize project"),w(!1)}}},[e,_,F]),re=m.useCallback(()=>{M.current&&M.current.close();const X=B8(e);M.current=X,X.addEventListener("started",Q=>{if(!O.current)return;const fe=JSON.parse(Q.data);console.log("Intake started:",fe)}),X.addEventListener("progress",Q=>{if(!O.current)return;const fe=JSON.parse(Q.data);console.log("Intake progress:",fe.current_node)}),X.addEventListener("complete",async Q=>{if(!O.current)return;const fe=JSON.parse(Q.data);console.log("Intake complete:",fe),X.close(),M.current=null,n("complete"),b(fe.gate_outcome),k(fe.project),w(!1)}),X.addEventListener("error",Q=>{if(O.current&&X.readyState!==EventSource.CLOSED){try{const fe=JSON.parse(Q.data);S(fe.message||"Generation failed")}catch{S("Connection lost during generation")}X.close(),M.current=null,w(!1)}}),X.onerror=()=>{O.current&&X.readyState===EventSource.CLOSED&&(M.current=null,w(!1))}},[e]),oe=m.useCallback(()=>{M.current&&(M.current.close(),M.current=null),t(null),n("idle"),o([]),l(null),d(null),f({}),h(0),g([]),x(!1),b(null),k(null),S(null),w(!1),T(!1),L(null),I.current=null},[]);return{executionId:e,phase:r,messages:s,pendingPrompt:a,pendingChoices:c,interpretation:u,confidence:p,missingFields:v,canInitialize:_,gateOutcome:y,project:j,error:N,loading:C,submitting:A,intakeClassification:D,intakeGatePhase:E,operationalError:R,startIntake:q,submitMessage:H,updateField:Z,lockAndGenerate:B,retryLastMessage:V,reset:oe}}const n3=m.createContext(null);function c9({children:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,a]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{s(!0),a(null);try{const f=await ze.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),a(f.message),r(null)}finally{s(!1)}},[]),c=m.useCallback(f=>{window.location.href=W8(f)},[]),d=m.useCallback(async()=>{try{await ze.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),u={user:t,loading:n,error:o,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return i.jsx(n3.Provider,{value:u,children:e})}function Ms(){const e=m.useContext(n3);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function u9(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[s,o]=m.useState(!0),[a,l]=m.useState(null),c=m.useCallback(async()=>{o(!0),l(null);try{let u=await we.getCurrentWorkspace();u||(u=await we.createWorkspace()),t(u.workspace_id),n(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{o(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await we.closeWorkspace(e,u),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:s,error:a,closeWorkspace:d,reinitialize:c}}function d9(e,t=1e4){var u,f;const[r,n]=m.useState(null),[s,o]=m.useState(!0),[a,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){n(null),o(!1);return}try{const p=await we.getWorkspaceState(e);n(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{o(!1)}},[e]);return m.useEffect(()=>{e&&(o(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:r,loading:s,error:a,refresh:d,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((u=r==null?void 0:r.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function f9(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getDocumentTypes();t(l.document_types||[])}catch(l){o(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{documentTypes:e,loading:r,error:s,refresh:a}}function p9(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getRoles();t(l.roles||[])}catch(l){o(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{roles:e,loading:r,error:s,refresh:a}}function Ea(e,t,{debounceMs:r=500,onSave:n}={}){const[s,o]=m.useState(""),[a,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,g]=m.useState(null),_=m.useRef(null),x=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){o(""),l(""),d(!1);return}d(!0),f(null);try{const C=await we.getArtifact(e,t);o(C.content),l(C.content)}catch(C){f(C.message),console.error("Failed to load artifact:",C)}finally{d(!1)}},[e,t]),b=m.useCallback(async C=>{if(!(!e||!t)){h(!0),f(null);try{const w=await we.writeArtifact(e,t,C);g(w),l(C),n&&n(w)}catch(w){f(w.message),console.error("Failed to save artifact:",w)}finally{h(!1)}}},[e,t,n]),j=m.useCallback(C=>{x.current=C,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{x.current!==null&&(b(x.current),x.current=null)},r)},[b,r]),k=m.useCallback(C=>{o(C),C!==a&&j(C)},[a,j]),N=m.useCallback(()=>{_.current&&clearTimeout(_.current),x.current=null,o(a)},[a]),S=m.useCallback(()=>{_.current&&clearTimeout(_.current),s!==a&&b(s)},[s,a,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{content:s,originalContent:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateContent:k,reset:N,saveNow:S,reload:y}}const h9={documentNode:L8,waypoint:z8},m9={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function g9({projectId:e,projectCode:t,projectName:r,isArchived:n,savedLayout:s,autoExpandNodeId:o,theme:a,onThemeChange:l,onProjectUpdate:c,onProjectArchive:d,onProjectUnarchive:u,onProjectDelete:f}){const{data:p,lineState:h,loading:v,error:g,connected:_,notification:x,dismissNotification:y,resolveInterrupt:b,startProduction:j}=a9(e),[k,N]=m.useState([]),[S,C]=m.useState(null),[w,A]=m.useState(null),[T,D]=m.useState(null),[$,E]=m.useState(!1),[P,R]=m.useState(""),[L,M]=m.useState(!1),[I,O]=m.useState(!1),[F,q]=m.useState(!1),H=ru(),V=m.useRef((s==null?void 0:s.node_positions)||null),Z=m.useRef((s==null?void 0:s.viewport)||null),B=m.useRef(null),re=m.useRef(!1);m.useEffect(()=>{p.length>0&&N(p)},[p]),m.useEffect(()=>{o&&k.length>0&&setTimeout(()=>{C(o),A("questions")},300)},[o,k.length]),m.useEffect(()=>{C(null),A(null)},[e]),m.useEffect(()=>()=>{B.current&&clearTimeout(B.current)},[]);const oe=m.useCallback(()=>{const ie=Pn.indexOf(a);l(Pn[(ie+1)%Pn.length])},[a,l]),X=m.useCallback(()=>{B.current&&clearTimeout(B.current),B.current=setTimeout(()=>{const ie={node_positions:V.current,viewport:Z.current};ze.saveFloorLayout(e,ie).catch(xe=>console.error("Failed to save floor layout:",xe))},800)},[e]),Q=m.useCallback((ie,xe)=>{const pe={...V.current||{}};pe[xe.id]=xe.position,V.current=pe,X()},[X]),fe=m.useCallback((ie,xe)=>{xe&&(Z.current=xe,X())},[X]),ge=m.useCallback(()=>{R(r||""),E(!0)},[r]),be=m.useCallback(async()=>{if(!P.trim()||P===r){E(!1);return}O(!0);try{await c(e,{name:P.trim()}),E(!1)}catch(ie){console.error("Failed to update name:",ie)}finally{O(!1)}},[P,r,e,c]),ye=m.useCallback(()=>{E(!1),R("")},[]),ae=m.useCallback(async()=>{O(!0);try{n?await u(e):await d(e)}catch(ie){console.error("Failed to toggle archive:",ie)}finally{O(!1)}},[e,n,d,u]),K=m.useCallback(async()=>{O(!0);try{await f(e),M(!1)}catch(ie){console.error("Failed to delete:",ie)}finally{O(!1)}},[e,f]),te=m.useCallback(ie=>{const xe=H.getNode(ie);if(xe){const U=window.innerWidth,ve=-xe.position.x*.9+U/2-400,he=-xe.position.y*.9+120;H.setViewport({x:ve,y:he,zoom:.9},{duration:800})}},[H]),ee=m.useMemo(()=>({onExpand:(ie,xe)=>{C(ie),A(xe)},onCollapse:()=>{C(null),A(null),setTimeout(()=>H.fitView({padding:.2,duration:300}),50)},onViewFullDocument:ie=>{D(ie)},onStartProduction:async ie=>{console.log("Starting production for:",ie),N(xe=>xe.map(pe=>pe.id===ie?{...pe,_prevState:pe.state,state:"in_production"}:pe));try{await j(ie)}catch{N(pe=>pe.map(U=>U.id===ie?{...U,state:U._prevState||"ready_for_production",stations:null}:U))}},onSubmitQuestions:async(ie,xe)=>{console.log("Submitted:",ie,xe),C(null),A(null),N(U=>{const ve=he=>he.map(Fe=>Fe.id===ie&&Fe.stations?{...Fe,state:"in_production",stations:Fe.stations.map(He=>He.id==="pgc"?{...He,state:"complete",needs_input:!1}:He.id==="asm"?{...He,state:"active"}:He)}:Fe.children?{...Fe,children:ve(Fe.children)}:Fe);return ve(U)});const pe=k.find(U=>U.id===ie);if(pe!=null&&pe.interruptId)try{await b(pe.interruptId,xe)}catch(U){console.error("Failed to submit answers:",U)}}}),[H,k,b,j]),{layoutNodes:ke,layoutEdges:je}=m.useMemo(()=>{if(k.length===0)return{layoutNodes:[],layoutEdges:[]};const ie={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:xe,edges:pe,parentId:U,childNodes:ve}=pg(k,S,ie),he=fg(xe,pe,V.current),{nodes:Fe,edges:He}=hg(he,U,ve,S,ie);return{layoutNodes:Fe.map(Ge=>({...Ge,data:{...Ge.data,expandType:Ge.id===S?w:null}})),layoutEdges:He}},[k,S,w,ee,a,te,e,t]),[Te,Ne,ne]=IE(ke),[Se,Ve,ct]=PE(je);m.useEffect(()=>{if(k.length===0)return;const ie={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:xe,edges:pe,parentId:U,childNodes:ve}=pg(k,S,ie),he=fg(xe,pe,V.current),{nodes:Fe,edges:He}=hg(he,U,ve,S,ie),st=Fe.map(Ge=>({...Ge,data:{...Ge.data,expandType:Ge.id===S?w:null}}));Ne(st),Ve(He)},[k,S,w,ee,Ne,Ve,a,te,e,t]),m.useEffect(()=>{!re.current&&Z.current&&Te.length>0&&(re.current=!0,setTimeout(()=>{H.setViewport(Z.current,{duration:0})},100))},[Te.length,H]);const We=m.useCallback(()=>{V.current=null,Z.current=null,ze.saveFloorLayout(e,null).catch(Ge=>console.error("Failed to clear floor layout:",Ge));const ie={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:xe,edges:pe,parentId:U,childNodes:ve}=pg(k,S,ie),he=fg(xe,pe,null),{nodes:Fe,edges:He}=hg(he,U,ve,S,ie),st=Fe.map(Ge=>({...Ge,data:{...Ge.data,expandType:Ge.id===S?w:null}}));Ne(st),Ve(He),setTimeout(()=>H.fitView({padding:.2,duration:300}),50)},[e,ee,w,a,te,t,k,S,Ne,Ve,H]),Pe=m.useCallback((ie,xe)=>{},[]);return v&&k.length===0?i.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):g&&k.length===0?i.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:i.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:i.jsx("p",{className:"text-red-500 mb-4",children:g})})}):i.jsxs("div",{className:"w-full h-full",children:[i.jsxs(nu,{nodes:Te,edges:Se,onNodesChange:ne,onEdgesChange:ct,onNodeClick:Pe,onNodeDragStop:Q,onMoveEnd:fe,nodeTypes:h9,nodesDraggable:!0,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,zoomOnScroll:!0,fitView:!Z.current,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[i.jsx(Un,{position:"top-left",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:i.jsxs("div",{className:"flex items-center justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),i.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[h==="active"&&i.jsx("span",{className:"text-amber-500",children:" Active"}),h==="stopped"&&i.jsx("span",{className:"text-red-500",children:" Stopped"}),h==="complete"&&i.jsx("span",{className:"text-emerald-500",children:" Complete"}),h==="idle"&&i.jsx("span",{children:" Idle"}),!_&&i.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("button",{onClick:We,className:"subway-button p-1.5 rounded-md transition-colors",title:"Reset layout",children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M3 12a9 9 0 019-9 9.75 9.75 0 016.74 2.74L21 8"}),i.jsx("path",{d:"M21 3v5h-5"}),i.jsx("path",{d:"M21 12a9 9 0 01-9 9 9.75 9.75 0 01-6.74-2.74L3 16"}),i.jsx("path",{d:"M3 21v-5h5"})]})}),i.jsx("button",{onClick:oe,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:m9[a]})]})]})}),i.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:i.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),$?i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("input",{type:"text",value:P,onChange:ie=>R(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"&&be(),ie.key==="Escape"&&ye()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:I}),i.jsx("button",{onClick:be,disabled:I,className:"p-1 rounded hover:bg-white/10",title:"Save",children:i.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M5 13l4 4L19 7"})})}),i.jsx("button",{onClick:ye,disabled:I,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:i.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):i.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!$&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:ge,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),i.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),i.jsx("button",{onClick:ae,disabled:I,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:i.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&i.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),i.jsx("button",{onClick:()=>M(!0),disabled:I||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:i.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),i.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[i.jsxs("button",{onClick:()=>q(!F),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[i.jsx("span",{children:"Workflow"}),i.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:F?"":""})]}),F&&i.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:i.jsx(YB,{projectId:e})})]})]})}),i.jsx(DE,{position:"top-right",nodeColor:ie=>{var ve;const xe=(ve=ie.data)==null?void 0:ve.state,pe=document.querySelector('[class*="theme-"]')||document.body,U=getComputedStyle(pe);return["produced","stabilized","ready","complete"].includes(xe)?U.getPropertyValue("--state-stabilized-bg").trim():["requirements_not_met","blocked","halted","failed"].includes(xe)?U.getPropertyValue("--state-blocked-bg").trim():["in_production","active","queued","awaiting_operator"].includes(xe)?U.getPropertyValue("--state-active-bg").trim():(["ready_for_production","waiting","pending_acceptance"].includes(xe),U.getPropertyValue("--state-ready-bg").trim())},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),i.jsx(Un,{position:"bottom-left",children:i.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[i.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"Stabilized"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-ready-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"In Progress"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-blocked-bg)"}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:"Blocked"})]})]})}),i.jsx(Un,{position:"bottom-right",children:i.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan | Drag nodes to rearrange"})})]}),x&&i.jsxs("div",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 px-5 py-3 rounded-lg shadow-lg border",style:{background:x.type==="error"?"#fef2f2":"#f0fdf4",borderColor:x.type==="error"?"#fecaca":"#bbf7d0",maxWidth:500,animation:"fadeIn 0.2s ease-out"},children:[i.jsx("span",{style:{fontSize:18,color:x.type==="error"?"#dc2626":"#16a34a",flexShrink:0},children:x.type==="error"?"":""}),i.jsx("span",{style:{fontSize:13,color:"#1f2937",lineHeight:1.4},children:x.message}),i.jsx("button",{onClick:y,style:{marginLeft:"auto",background:"none",border:"none",color:"#9ca3af",fontSize:18,cursor:"pointer",padding:"0 2px",lineHeight:1,flexShrink:0},children:""})]}),T&&i.jsx(OB,{projectId:e,projectCode:t,docTypeId:typeof T=="object"?T.docTypeId:T,instanceId:typeof T=="object"?T.instanceId:void 0,onClose:()=>D(null)}),L&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:i.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),i.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",i.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>M(!1),disabled:I,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),i.jsx("button",{onClick:K,disabled:I,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:I?"Deleting...":"Delete"})]})]})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function s3(e){return typeof e>"u"||e===null}function x9(e){return typeof e=="object"&&e!==null}function v9(e){return Array.isArray(e)?e:s3(e)?[]:[e]}function y9(e,t){var r,n,s,o;if(t)for(o=Object.keys(t),r=0,n=o.length;r<n;r+=1)s=o[r],e[s]=t[s];return e}function b9(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function _9(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var w9=s3,j9=x9,S9=v9,k9=b9,N9=_9,C9=y9,gt={isNothing:w9,isObject:j9,toArray:S9,repeat:k9,isNegativeZero:N9,extend:C9};function o3(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function aa(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=o3(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}aa.prototype=Object.create(Error.prototype);aa.prototype.constructor=aa;aa.prototype.toString=function(t){return this.name+": "+o3(this,t)};var zt=aa;function mg(e,t,r,n,s){var o="",a="",l=Math.floor(s/2)-1;return n-t>l&&(o=" ... ",t=n-l+o.length),r-n>l&&(a=" ...",r=n+l-a.length),{str:o+e.slice(t,r).replace(/\t/g,"")+a,pos:n-t+o.length}}function gg(e,t){return gt.repeat(" ",t-e.length)+e}function E9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],s=[],o,a=-1;o=r.exec(e.buffer);)s.push(o.index),n.push(o.index+o[0].length),e.position<=o.index&&a<0&&(a=n.length-2);a<0&&(a=n.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,s.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(a-c<0);c++)d=mg(e.buffer,n[a-c],s[a-c],e.position-(n[a]-n[a-c]),f),l=gt.repeat(" ",t.indent)+gg((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=mg(e.buffer,n[a],s[a],e.position,f),l+=gt.repeat(" ",t.indent)+gg((e.line+1).toString(),u)+" | "+d.str+`
`,l+=gt.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(a+c>=s.length);c++)d=mg(e.buffer,n[a+c],s[a+c],e.position-(n[a]-n[a+c]),f),l+=gt.repeat(" ",t.indent)+gg((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var T9=E9,R9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],A9=["scalar","sequence","mapping"];function I9(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function P9(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(R9.indexOf(r)===-1)throw new zt('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=I9(t.styleAliases||null),A9.indexOf(this.kind)===-1)throw new zt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Ct=P9;function dS(e,t){var r=[];return e[t].forEach(function(n){var s=r.length;r.forEach(function(o,a){o.tag===n.tag&&o.kind===n.kind&&o.multi===n.multi&&(s=a)}),r[s]=n}),r}function O9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Ux(e){return this.extend(e)}Ux.prototype.extend=function(t){var r=[],n=[];if(t instanceof Ct)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new zt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(o){if(!(o instanceof Ct))throw new zt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&o.loadKind!=="scalar")throw new zt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new zt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(o){if(!(o instanceof Ct))throw new zt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Ux.prototype);return s.implicit=(this.implicit||[]).concat(r),s.explicit=(this.explicit||[]).concat(n),s.compiledImplicit=dS(s,"implicit"),s.compiledExplicit=dS(s,"explicit"),s.compiledTypeMap=O9(s.compiledImplicit,s.compiledExplicit),s};var i3=Ux,a3=new Ct("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),l3=new Ct("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),c3=new Ct("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),u3=new i3({explicit:[a3,l3,c3]});function M9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function D9(){return null}function L9(e){return e===null}var d3=new Ct("tag:yaml.org,2002:null",{kind:"scalar",resolve:M9,construct:D9,predicate:L9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function z9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function F9(e){return e==="true"||e==="True"||e==="TRUE"}function $9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var f3=new Ct("tag:yaml.org,2002:bool",{kind:"scalar",resolve:z9,construct:F9,predicate:$9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function q9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function B9(e){return 48<=e&&e<=55}function W9(e){return 48<=e&&e<=57}function H9(e){if(e===null)return!1;var t=e.length,r=0,n=!1,s;if(!t)return!1;if(s=e[r],(s==="-"||s==="+")&&(s=e[++r]),s==="0"){if(r+1===t)return!0;if(s=e[++r],s==="b"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(s!=="0"&&s!=="1")return!1;n=!0}return n&&s!=="_"}if(s==="x"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!q9(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}if(s==="o"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!B9(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}}if(s==="_")return!1;for(;r<t;r++)if(s=e[r],s!=="_"){if(!W9(e.charCodeAt(r)))return!1;n=!0}return!(!n||s==="_")}function U9(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function V9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!gt.isNegativeZero(e)}var p3=new Ct("tag:yaml.org,2002:int",{kind:"scalar",resolve:H9,construct:U9,predicate:V9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),G9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function K9(e){return!(e===null||!G9.test(e)||e[e.length-1]==="_")}function Y9(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var X9=/^[-+]?[0-9]+e/;function Q9(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(gt.isNegativeZero(e))return"-0.0";return r=e.toString(10),X9.test(r)?r.replace("e",".e"):r}function Z9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||gt.isNegativeZero(e))}var h3=new Ct("tag:yaml.org,2002:float",{kind:"scalar",resolve:K9,construct:Y9,predicate:Z9,represent:Q9,defaultStyle:"lowercase"}),m3=u3.extend({implicit:[d3,f3,p3,h3]}),g3=m3,x3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),v3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function J9(e){return e===null?!1:x3.exec(e)!==null||v3.exec(e)!==null}function e7(e){var t,r,n,s,o,a,l,c=0,d=null,u,f,p;if(t=x3.exec(e),t===null&&(t=v3.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(r,n,s));if(o=+t[4],a=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(r,n,s,o,a,l,c)),d&&p.setTime(p.getTime()-d),p}function t7(e){return e.toISOString()}var y3=new Ct("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:J9,construct:e7,instanceOf:Date,represent:t7});function r7(e){return e==="<<"||e===null}var b3=new Ct("tag:yaml.org,2002:merge",{kind:"scalar",resolve:r7}),My=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function n7(e){if(e===null)return!1;var t,r,n=0,s=e.length,o=My;for(r=0;r<s;r++)if(t=o.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function s7(e){var t,r,n=e.replace(/[\r\n=]/g,""),s=n.length,o=My,a=0,l=[];for(t=0;t<s;t++)t%4===0&&t&&(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)),a=a<<6|o.indexOf(n.charAt(t));return r=s%4*6,r===0?(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)):r===18?(l.push(a>>10&255),l.push(a>>2&255)):r===12&&l.push(a>>4&255),new Uint8Array(l)}function o7(e){var t="",r=0,n,s,o=e.length,a=My;for(n=0;n<o;n++)n%3===0&&n&&(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]),r=(r<<8)+e[n];return s=o%3,s===0?(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]):s===2?(t+=a[r>>10&63],t+=a[r>>4&63],t+=a[r<<2&63],t+=a[64]):s===1&&(t+=a[r>>2&63],t+=a[r<<4&63],t+=a[64],t+=a[64]),t}function i7(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var _3=new Ct("tag:yaml.org,2002:binary",{kind:"scalar",resolve:n7,construct:s7,predicate:i7,represent:o7}),a7=Object.prototype.hasOwnProperty,l7=Object.prototype.toString;function c7(e){if(e===null)return!0;var t=[],r,n,s,o,a,l=e;for(r=0,n=l.length;r<n;r+=1){if(s=l[r],a=!1,l7.call(s)!=="[object Object]")return!1;for(o in s)if(a7.call(s,o))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(o)===-1)t.push(o);else return!1}return!0}function u7(e){return e!==null?e:[]}var w3=new Ct("tag:yaml.org,2002:omap",{kind:"sequence",resolve:c7,construct:u7}),d7=Object.prototype.toString;function f7(e){if(e===null)return!0;var t,r,n,s,o,a=e;for(o=new Array(a.length),t=0,r=a.length;t<r;t+=1){if(n=a[t],d7.call(n)!=="[object Object]"||(s=Object.keys(n),s.length!==1))return!1;o[t]=[s[0],n[s[0]]]}return!0}function p7(e){if(e===null)return[];var t,r,n,s,o,a=e;for(o=new Array(a.length),t=0,r=a.length;t<r;t+=1)n=a[t],s=Object.keys(n),o[t]=[s[0],n[s[0]]];return o}var j3=new Ct("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:f7,construct:p7}),h7=Object.prototype.hasOwnProperty;function m7(e){if(e===null)return!0;var t,r=e;for(t in r)if(h7.call(r,t)&&r[t]!==null)return!1;return!0}function g7(e){return e!==null?e:{}}var S3=new Ct("tag:yaml.org,2002:set",{kind:"mapping",resolve:m7,construct:g7}),Dy=g3.extend({implicit:[y3,b3],explicit:[_3,w3,j3,S3]}),Zn=Object.prototype.hasOwnProperty,wc=1,k3=2,N3=3,jc=4,xg=1,x7=2,fS=3,v7=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,y7=/[\x85\u2028\u2029]/,b7=/[,\[\]\{\}]/,C3=/^(?:!|!!|![a-z\-]+!)$/i,E3=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function pS(e){return Object.prototype.toString.call(e)}function Gr(e){return e===10||e===13}function bs(e){return e===9||e===32}function Vt(e){return e===9||e===32||e===10||e===13}function io(e){return e===44||e===91||e===93||e===123||e===125}function _7(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function w7(e){return e===120?2:e===117?4:e===85?8:0}function j7(e){return 48<=e&&e<=57?e-48:-1}function hS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function S7(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function T3(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var R3=new Array(256),A3=new Array(256);for(var qs=0;qs<256;qs++)R3[qs]=hS(qs)?1:0,A3[qs]=hS(qs);function k7(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Dy,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function I3(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=T9(r),new zt(t,r)}function me(e,t){throw I3(e,t)}function Sc(e,t){e.onWarning&&e.onWarning.call(null,I3(e,t))}var mS={YAML:function(t,r,n){var s,o,a;t.version!==null&&me(t,"duplication of %YAML directive"),n.length!==1&&me(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),s===null&&me(t,"ill-formed argument of the YAML directive"),o=parseInt(s[1],10),a=parseInt(s[2],10),o!==1&&me(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&Sc(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var s,o;n.length!==2&&me(t,"TAG directive accepts exactly two arguments"),s=n[0],o=n[1],C3.test(s)||me(t,"ill-formed tag handle (first argument) of the TAG directive"),Zn.call(t.tagMap,s)&&me(t,'there is a previously declared suffix for "'+s+'" tag handle'),E3.test(o)||me(t,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{me(t,"tag prefix is malformed: "+o)}t.tagMap[s]=o}};function Kn(e,t,r,n){var s,o,a,l;if(t<r){if(l=e.input.slice(t,r),n)for(s=0,o=l.length;s<o;s+=1)a=l.charCodeAt(s),a===9||32<=a&&a<=1114111||me(e,"expected valid JSON character");else v7.test(l)&&me(e,"the stream contains non-printable characters");e.result+=l}}function gS(e,t,r,n){var s,o,a,l;for(gt.isObject(r)||me(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(r),a=0,l=s.length;a<l;a+=1)o=s[a],Zn.call(t,o)||(T3(t,o,r[o]),n[o]=!0)}function ao(e,t,r,n,s,o,a,l,c){var d,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),d=0,u=s.length;d<u;d+=1)Array.isArray(s[d])&&me(e,"nested arrays are not supported inside keys"),typeof s=="object"&&pS(s[d])==="[object Object]"&&(s[d]="[object Object]");if(typeof s=="object"&&pS(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(o))for(d=0,u=o.length;d<u;d+=1)gS(e,t,o[d],r);else gS(e,t,o,r);else!e.json&&!Zn.call(r,s)&&Zn.call(t,s)&&(e.line=a||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,me(e,"duplicated mapping key")),T3(t,s,o),delete r[s];return t}function Ly(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):me(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function dt(e,t,r){for(var n=0,s=e.input.charCodeAt(e.position);s!==0;){for(;bs(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Gr(s))for(Ly(e),s=e.input.charCodeAt(e.position),n++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&Sc(e,"deficient indentation"),n}function ku(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Vt(r)))}function zy(e,t){t===1?e.result+=" ":t>1&&(e.result+=gt.repeat(`
`,t-1))}function N7(e,t,r){var n,s,o,a,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Vt(h)||io(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(s=e.input.charCodeAt(e.position+1),Vt(s)||r&&io(s)))return!1;for(e.kind="scalar",e.result="",o=a=e.position,l=!1;h!==0;){if(h===58){if(s=e.input.charCodeAt(e.position+1),Vt(s)||r&&io(s))break}else if(h===35){if(n=e.input.charCodeAt(e.position-1),Vt(n))break}else{if(e.position===e.lineStart&&ku(e)||r&&io(h))break;if(Gr(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,dt(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Kn(e,o,a,!1),zy(e,e.line-c),o=a=e.position,l=!1),bs(h)||(a=e.position+1),h=e.input.charCodeAt(++e.position)}return Kn(e,o,a,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function C7(e,t){var r,n,s;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=s=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Kn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,s=e.position;else return!0;else Gr(r)?(Kn(e,n,s,!0),zy(e,dt(e,!1,t)),n=s=e.position):e.position===e.lineStart&&ku(e)?me(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);me(e,"unexpected end of the stream within a single quoted scalar")}function E7(e,t){var r,n,s,o,a,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Kn(e,r,e.position,!0),e.position++,!0;if(l===92){if(Kn(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Gr(l))dt(e,!1,t);else if(l<256&&R3[l])e.result+=A3[l],e.position++;else if((a=w7(l))>0){for(s=a,o=0;s>0;s--)l=e.input.charCodeAt(++e.position),(a=_7(l))>=0?o=(o<<4)+a:me(e,"expected hexadecimal character");e.result+=S7(o),e.position++}else me(e,"unknown escape sequence");r=n=e.position}else Gr(l)?(Kn(e,r,n,!0),zy(e,dt(e,!1,t)),r=n=e.position):e.position===e.lineStart&&ku(e)?me(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}me(e,"unexpected end of the stream within a double quoted scalar")}function T7(e,t){var r=!0,n,s,o,a=e.tag,l,c=e.anchor,d,u,f,p,h,v=Object.create(null),g,_,x,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(dt(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=a,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;r?y===44&&me(e,"expected the node content, but found ','"):me(e,"missed comma between flow collection entries"),_=g=x=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Vt(d)&&(f=p=!0,e.position++,dt(e,!0,t))),n=e.line,s=e.lineStart,o=e.position,Ro(e,t,wc,!1,!0),_=e.tag,g=e.result,dt(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===n)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),dt(e,!0,t),Ro(e,t,wc,!1,!0),x=e.result),h?ao(e,l,v,_,g,x,n,s,o):f?l.push(ao(e,null,v,_,g,x,n,s,o)):l.push(g),dt(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}me(e,"unexpected end of the stream within a flow collection")}function R7(e,t){var r,n,s=xg,o=!1,a=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)xg===s?s=f===43?fS:x7:me(e,"repeat of a chomping mode identifier");else if((u=j7(f))>=0)u===0?me(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?me(e,"repeat of an indentation width identifier"):(l=t+u-1,a=!0);else break;if(bs(f)){do f=e.input.charCodeAt(++e.position);while(bs(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Gr(f)&&f!==0)}for(;f!==0;){for(Ly(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!a||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>l&&(l=e.lineIndent),Gr(f)){c++;continue}if(e.lineIndent<l){s===fS?e.result+=gt.repeat(`
`,o?1+c:c):s===xg&&o&&(e.result+=`
`);break}for(n?bs(f)?(d=!0,e.result+=gt.repeat(`
`,o?1+c:c)):d?(d=!1,e.result+=gt.repeat(`
`,c+1)):c===0?o&&(e.result+=" "):e.result+=gt.repeat(`
`,c):e.result+=gt.repeat(`
`,o?1+c:c),o=!0,a=!0,c=0,r=e.position;!Gr(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Kn(e,r,e.position,!1)}return!0}function xS(e,t){var r,n=e.tag,s=e.anchor,o=[],a,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,me(e,"tab characters must not be used in indentation")),!(c!==45||(a=e.input.charCodeAt(e.position+1),!Vt(a))));){if(l=!0,e.position++,dt(e,!0,-1)&&e.lineIndent<=t){o.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Ro(e,t,N3,!1,!0),o.push(e.result),dt(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)me(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=s,e.kind="sequence",e.result=o,!0):!1}function A7(e,t,r){var n,s,o,a,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,v=null,g=null,_=!1,x=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!_&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,me(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),o=e.line,(y===63||y===58)&&Vt(n))y===63?(_&&(ao(e,f,p,h,v,null,a,l,c),h=v=g=null),x=!0,_=!0,s=!0):_?(_=!1,s=!0):me(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=n;else{if(a=e.line,l=e.lineStart,c=e.position,!Ro(e,r,k3,!1,!0))break;if(e.line===o){for(y=e.input.charCodeAt(e.position);bs(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Vt(y)||me(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(ao(e,f,p,h,v,null,a,l,c),h=v=g=null),x=!0,_=!1,s=!1,h=e.tag,v=e.result;else if(x)me(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(x)me(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===o||e.lineIndent>t)&&(_&&(a=e.line,l=e.lineStart,c=e.position),Ro(e,t,jc,!0,s)&&(_?v=e.result:g=e.result),_||(ao(e,f,p,h,v,g,a,l,c),h=v=g=null),dt(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&y!==0)me(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&ao(e,f,p,h,v,null,a,l,c),x&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),x}function I7(e){var t,r=!1,n=!1,s,o,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&me(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(r=!0,a=e.input.charCodeAt(++e.position)):a===33?(n=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,r){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(o=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):me(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Vt(a);)a===33&&(n?me(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),C3.test(s)||me(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);o=e.input.slice(t,e.position),b7.test(o)&&me(e,"tag suffix cannot contain flow indicator characters")}o&&!E3.test(o)&&me(e,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{me(e,"tag name is malformed: "+o)}return r?e.tag=o:Zn.call(e.tagMap,s)?e.tag=e.tagMap[s]+o:s==="!"?e.tag="!"+o:s==="!!"?e.tag="tag:yaml.org,2002:"+o:me(e,'undeclared tag handle "'+s+'"'),!0}function P7(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&me(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Vt(r)&&!io(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&me(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function O7(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Vt(n)&&!io(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&me(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Zn.call(e.anchorMap,r)||me(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],dt(e,!0,-1),!0}function Ro(e,t,r,n,s){var o,a,l,c=1,d=!1,u=!1,f,p,h,v,g,_;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=a=l=jc===r||N3===r,n&&dt(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;I7(e)||P7(e);)dt(e,!0,-1)?(d=!0,l=o,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||s),(c===1||jc===r)&&(wc===r||k3===r?g=t:g=t+1,_=e.position-e.lineStart,c===1?l&&(xS(e,_)||A7(e,_,g))||T7(e,g)?u=!0:(a&&R7(e,g)||C7(e,g)||E7(e,g)?u=!0:O7(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&me(e,"alias node should not have any properties")):N7(e,g,wc===r)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&xS(e,_))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&me(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(v=e.implicitTypes[f],v.resolve(e.result)){e.result=v.construct(e.result),e.tag=v.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Zn.call(e.typeMap[e.kind||"fallback"],e.tag))v=e.typeMap[e.kind||"fallback"][e.tag];else for(v=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){v=h[f];break}v||me(e,"unknown tag !<"+e.tag+">"),e.result!==null&&v.kind!==e.kind&&me(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+v.kind+'", not "'+e.kind+'"'),v.resolve(e.result,e.tag)?(e.result=v.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):me(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function M7(e){var t=e.position,r,n,s,o=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(dt(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(o=!0,a=e.input.charCodeAt(++e.position),r=e.position;a!==0&&!Vt(a);)a=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),s=[],n.length<1&&me(e,"directive name must not be less than one character in length");a!==0;){for(;bs(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Gr(a));break}if(Gr(a))break;for(r=e.position;a!==0&&!Vt(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(r,e.position))}a!==0&&Ly(e),Zn.call(mS,n)?mS[n](e,n,s):Sc(e,'unknown document directive "'+n+'"')}if(dt(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,dt(e,!0,-1)):o&&me(e,"directives end mark is expected"),Ro(e,e.lineIndent-1,jc,!1,!0),dt(e,!0,-1),e.checkLineBreaks&&y7.test(e.input.slice(t,e.position))&&Sc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&ku(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,dt(e,!0,-1));return}if(e.position<e.length-1)me(e,"end of the stream or a document separator is expected");else return}function P3(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new k7(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,me(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)M7(r);return r.documents}function D7(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=P3(e,r);if(typeof t!="function")return n;for(var s=0,o=n.length;s<o;s+=1)t(n[s])}function L7(e,t){var r=P3(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new zt("expected a single document in the stream, but found more")}}var z7=D7,F7=L7,O3={loadAll:z7,load:F7},M3=Object.prototype.toString,D3=Object.prototype.hasOwnProperty,Fy=65279,$7=9,la=10,q7=13,B7=32,W7=33,H7=34,Vx=35,U7=37,V7=38,G7=39,K7=42,L3=44,Y7=45,kc=58,X7=61,Q7=62,Z7=63,J7=64,z3=91,F3=93,eW=96,$3=123,tW=124,q3=125,Mt={};Mt[0]="\\0";Mt[7]="\\a";Mt[8]="\\b";Mt[9]="\\t";Mt[10]="\\n";Mt[11]="\\v";Mt[12]="\\f";Mt[13]="\\r";Mt[27]="\\e";Mt[34]='\\"';Mt[92]="\\\\";Mt[133]="\\N";Mt[160]="\\_";Mt[8232]="\\L";Mt[8233]="\\P";var rW=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],nW=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function sW(e,t){var r,n,s,o,a,l,c;if(t===null)return{};for(r={},n=Object.keys(t),s=0,o=n.length;s<o;s+=1)a=n[s],l=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),c=e.compiledTypeMap.fallback[a],c&&D3.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[a]=l;return r}function oW(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new zt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+gt.repeat("0",n-t.length)+t}var iW=1,ca=2;function aW(e){this.schema=e.schema||Dy,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=gt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=sW(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?ca:iW,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function vS(e,t){for(var r=gt.repeat(" ",t),n=0,s=-1,o="",a,l=e.length;n<l;)s=e.indexOf(`
`,n),s===-1?(a=e.slice(n),n=l):(a=e.slice(n,s+1),n=s+1),a.length&&a!==`
`&&(o+=r),o+=a;return o}function Gx(e,t){return`
`+gt.repeat(" ",e.indent*t)}function lW(e,t){var r,n,s;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(s=e.implicitTypes[r],s.resolve(t))return!0;return!1}function Nc(e){return e===B7||e===$7}function ua(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Fy||65536<=e&&e<=1114111}function yS(e){return ua(e)&&e!==Fy&&e!==q7&&e!==la}function bS(e,t,r){var n=yS(e),s=n&&!Nc(e);return(r?n:n&&e!==L3&&e!==z3&&e!==F3&&e!==$3&&e!==q3)&&e!==Vx&&!(t===kc&&!s)||yS(t)&&!Nc(t)&&e===Vx||t===kc&&s}function cW(e){return ua(e)&&e!==Fy&&!Nc(e)&&e!==Y7&&e!==Z7&&e!==kc&&e!==L3&&e!==z3&&e!==F3&&e!==$3&&e!==q3&&e!==Vx&&e!==V7&&e!==K7&&e!==W7&&e!==tW&&e!==X7&&e!==Q7&&e!==G7&&e!==H7&&e!==U7&&e!==J7&&e!==eW}function uW(e){return!Nc(e)&&e!==kc}function wi(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function B3(e){var t=/^\n* /;return t.test(e)}var W3=1,Kx=2,H3=3,U3=4,Us=5;function dW(e,t,r,n,s,o,a,l){var c,d=0,u=null,f=!1,p=!1,h=n!==-1,v=-1,g=cW(wi(e,0))&&uW(wi(e,e.length-1));if(t||a)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wi(e,c),!ua(d))return Us;g=g&&bS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wi(e,c),d===la)f=!0,h&&(p=p||c-v-1>n&&e[v+1]!==" ",v=c);else if(!ua(d))return Us;g=g&&bS(d,u,l),u=d}p=p||h&&c-v-1>n&&e[v+1]!==" "}return!f&&!p?g&&!a&&!s(e)?W3:o===ca?Us:Kx:r>9&&B3(e)?Us:a?o===ca?Us:Kx:p?U3:H3}function fW(e,t,r,n,s){e.dump=function(){if(t.length===0)return e.quotingType===ca?'""':"''";if(!e.noCompatMode&&(rW.indexOf(t)!==-1||nW.test(t)))return e.quotingType===ca?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,r),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(d){return lW(e,d)}switch(dW(t,l,e.indent,a,c,e.quotingType,e.forceQuotes&&!n,s)){case W3:return t;case Kx:return"'"+t.replace(/'/g,"''")+"'";case H3:return"|"+_S(t,e.indent)+wS(vS(t,o));case U3:return">"+_S(t,e.indent)+wS(vS(pW(t,a),o));case Us:return'"'+hW(t)+'"';default:throw new zt("impossible error: invalid scalar style")}}()}function _S(e,t){var r=B3(e)?String(t):"",n=e[e.length-1]===`
`,s=n&&(e[e.length-2]===`
`||e===`
`),o=s?"+":n?"":"-";return r+o+`
`}function wS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function pW(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,r.lastIndex=d,jS(e.slice(0,d),t)}(),s=e[0]===`
`||e[0]===" ",o,a;a=r.exec(e);){var l=a[1],c=a[2];o=c[0]===" ",n+=l+(!s&&!o&&c!==""?`
`:"")+jS(c,t),s=o}return n}function jS(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,s=0,o,a=0,l=0,c="";n=r.exec(e);)l=n.index,l-s>t&&(o=a>s?a:l,c+=`
`+e.slice(s,o),s=o+1),a=l;return c+=`
`,e.length-s>t&&a>s?c+=e.slice(s,a)+`
`+e.slice(a+1):c+=e.slice(s),c.slice(1)}function hW(e){for(var t="",r=0,n,s=0;s<e.length;r>=65536?s+=2:s++)r=wi(e,s),n=Mt[r],!n&&ua(r)?(t+=e[s],r>=65536&&(t+=e[s+1])):t+=n||oW(r);return t}function mW(e,t,r){var n="",s=e.tag,o,a,l;for(o=0,a=r.length;o<a;o+=1)l=r[o],e.replacer&&(l=e.replacer.call(r,String(o),l)),(vn(e,t,l,!1,!1)||typeof l>"u"&&vn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=s,e.dump="["+n+"]"}function SS(e,t,r,n){var s="",o=e.tag,a,l,c;for(a=0,l=r.length;a<l;a+=1)c=r[a],e.replacer&&(c=e.replacer.call(r,String(a),c)),(vn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&vn(e,t+1,null,!0,!0,!1,!0))&&((!n||s!=="")&&(s+=Gx(e,t)),e.dump&&la===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=o,e.dump=s||"[]"}function gW(e,t,r){var n="",s=e.tag,o=Object.keys(r),a,l,c,d,u;for(a=0,l=o.length;a<l;a+=1)u="",n!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=o[a],d=r[c],e.replacer&&(d=e.replacer.call(r,c,d)),vn(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),vn(e,t,d,!1,!1)&&(u+=e.dump,n+=u));e.tag=s,e.dump="{"+n+"}"}function xW(e,t,r,n){var s="",o=e.tag,a=Object.keys(r),l,c,d,u,f,p;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new zt("sortKeys must be a boolean or a function");for(l=0,c=a.length;l<c;l+=1)p="",(!n||s!=="")&&(p+=Gx(e,t)),d=a[l],u=r[d],e.replacer&&(u=e.replacer.call(r,d,u)),vn(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&la===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Gx(e,t)),vn(e,t+1,u,!0,f)&&(e.dump&&la===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,s+=p));e.tag=o,e.dump=s||"{}"}function kS(e,t,r){var n,s,o,a,l,c;for(s=r?e.explicitTypes:e.implicitTypes,o=0,a=s.length;o<a;o+=1)if(l=s[o],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,M3.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(D3.call(l.represent,c))n=l.represent[c](t,c);else throw new zt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function vn(e,t,r,n,s,o,a){e.tag=null,e.dump=r,kS(e,r,!1)||kS(e,r,!0);var l=M3.call(e.dump),c=n,d;n&&(n=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(r),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(s=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(xW(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(gW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?SS(e,t-1,e.dump,s):SS(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(mW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&fW(e,e.dump,t,o,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new zt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function vW(e,t){var r=[],n=[],s,o;for(Yx(e,r,n),s=0,o=n.length;s<o;s+=1)t.duplicates.push(r[n[s]]);t.usedDuplicates=new Array(o)}function Yx(e,t,r){var n,s,o;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)r.indexOf(s)===-1&&r.push(s);else if(t.push(e),Array.isArray(e))for(s=0,o=e.length;s<o;s+=1)Yx(e[s],t,r);else for(n=Object.keys(e),s=0,o=n.length;s<o;s+=1)Yx(e[n[s]],t,r)}function yW(e,t){t=t||{};var r=new aW(t);r.noRefs||vW(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),vn(r,0,n,!0,!0)?r.dump+`
`:""}var bW=yW,_W={dump:bW};function $y(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var wW=Ct,jW=i3,SW=u3,kW=m3,NW=g3,CW=Dy,EW=O3.load,TW=O3.loadAll,RW=_W.dump,AW=zt,IW={binary:_3,float:h3,map:c3,null:d3,pairs:j3,set:S3,timestamp:y3,bool:f3,int:p3,merge:b3,omap:w3,seq:l3,str:a3},PW=$y("safeLoad","load"),OW=$y("safeLoadAll","loadAll"),MW=$y("safeDump","dump"),qy={Type:wW,Schema:jW,FAILSAFE_SCHEMA:SW,JSON_SCHEMA:kW,CORE_SCHEMA:NW,DEFAULT_SCHEMA:CW,load:EW,loadAll:TW,dump:RW,YAMLException:AW,types:IW,safeLoad:PW,safeLoadAll:OW,safeDump:MW};function NS({messages:e,pendingPrompt:t,introContent:r}){const n=m.useRef(null);return m.useEffect(()=>{var s;(s=n.current)==null||s.scrollIntoView({behavior:"smooth"})},[e,t]),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",onWheel:s=>s.stopPropagation(),children:[r,e.map((s,o)=>i.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${s.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:s.content})},o)),t&&i.jsx("div",{className:"flex justify-start",children:i.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),i.jsx("div",{ref:n})]})}function DW({onSubmit:e,disabled:t,placeholder:r}){const[n,s]=m.useState(""),o=m.useRef(null);m.useEffect(()=>{var c;t||(c=o.current)==null||c.focus()},[t]);const a=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),s("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),s(""))};return i.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("textarea",{ref:o,value:n,onChange:c=>s(c.target.value),onKeyDown:a,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),i.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),i.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const CS={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function LW({type:e,className:t}){switch(e){case"check":return i.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return i.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M12 9v4M12 17h.01"}),i.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return i.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return i.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),i.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function zW({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const s=CS[e]||CS.blocked,o=e==="qualified";return i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:`w-16 h-16 rounded-full ${s.iconBg} flex items-center justify-center mx-auto mb-4`,children:i.jsx(LW,{type:s.icon,className:`w-8 h-8 ${s.iconColor}`})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:s.title}),i.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:s.description}),o&&t&&i.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[i.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),i.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),i.jsxs("div",{className:"flex gap-2 justify-center",children:[o&&t&&i.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),i.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function FW({operation:e,context:t,onSubmit:r,onCancel:n}){var _;const[s,o]=m.useState("confirm"),[a,l]=m.useState(!1),[c,d]=m.useState((t==null?void 0:t.project_type)||""),[u,f]=m.useState(""),h=((e==null?void 0:e.config)||{}).entry_prompt||"Review the intake classification.",v=[{value:"greenfield",label:"Greenfield (New Project)"},{value:"enhancement",label:"Enhancement (Existing Project)"},{value:"migration",label:"Migration"},{value:"integration",label:"Integration"},{value:"unknown",label:"Unknown / Other"}],g=()=>{l(!0);const x={confirmed:s==="confirm",timestamp:new Date().toISOString()};s==="correct"&&(x.corrected_project_type=c),u.trim()&&(x.notes=u.trim()),r(x)};return i.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-green, #22c55e)",color:"#fff"},children:"Intake"}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Concierge Entry"}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirm or correct the intake classification"})]})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",onWheel:x=>x.stopPropagation(),children:i.jsxs("div",{className:"max-w-2xl space-y-6",children:[i.jsx("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:i.jsx("div",{className:"text-sm",style:{color:"var(--text-primary)"},children:h})}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirmation requested"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Classification Result"}),i.jsxs("div",{className:"p-4 rounded space-y-3",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Intent Classification"}),i.jsx("span",{className:"px-3 py-1 rounded font-semibold",style:{background:"var(--accent-primary, #3b82f6)",color:"#fff",fontSize:12},children:((_=t==null?void 0:t.project_type)==null?void 0:_.replace(/_/g," ").toUpperCase())||"Unknown"})]}),(t==null?void 0:t.artifact_type)&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Artifact Type"}),i.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.artifact_type.replace(/_/g," ")})]}),(t==null?void 0:t.audience)&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Audience"}),i.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.audience})]}),(t==null?void 0:t.intake_summary)&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Summary"}),i.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.intake_summary})]}),(t==null?void 0:t.classification_rationale)&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Rationale"}),i.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:t.classification_rationale})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Your Decision"}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>o("confirm"),className:"flex-1 p-4 rounded text-left",style:{background:s==="confirm"?"rgba(34, 197, 94, 0.1)":"var(--bg-panel)",border:s==="confirm"?"2px solid #22c55e":"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Confirm"}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"The classification is correct"})]}),i.jsxs("button",{onClick:()=>o("correct"),className:"flex-1 p-4 rounded text-left",style:{background:s==="correct"?"rgba(249, 115, 22, 0.1)":"var(--bg-panel)",border:s==="correct"?"2px solid #f97316":"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Correct"}),i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"I need to change the classification before proceeding"})]})]})]}),s==="correct"&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Correct Intent Classification"}),i.jsxs("select",{value:c,onChange:x=>d(x.target.value),className:"w-full p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[i.jsx("option",{value:"",children:"Select intent classification..."}),v.map(x=>i.jsx("option",{value:x.value,children:x.label},x.value))]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Notes (Optional)"}),i.jsx("textarea",{value:u,onChange:x=>f(x.target.value),placeholder:"Add any additional context or notes...",className:"w-full p-3 rounded text-sm",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:80,resize:"vertical"}})]})]})}),i.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[n&&i.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:"Cancel"}),i.jsxs("button",{onClick:g,disabled:a||s==="correct"&&!c,className:"px-4 py-2 rounded text-sm font-semibold flex items-center gap-2",style:{background:s==="confirm"?"#22c55e":"#f97316",color:"#fff",opacity:a||s==="correct"&&!c?.5:1},children:[a&&i.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="confirm"?"Confirm Classification":"Submit Correction"]})]})]})}function $W({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:s,gateOutcome:o,project:a,error:l,loading:c,submitting:d,intakeClassification:u,intakeGatePhase:f,operationalError:p,startIntake:h,submitMessage:v,retryLastMessage:g,reset:_}=l9(),[x,y]=m.useState(null);m.useEffect(()=>(h(),fetch("/content/concierge-intro.yaml").then(C=>C.text()).then(C=>y(qy.load(C))).catch(C=>console.error("Failed to load intro content:",C)),()=>_()),[]);const b=()=>{_(),e()},j=()=>{a&&t&&t(a),b()},k=C=>{v(JSON.stringify(C))},N=()=>{const C=[{id:"describe",label:"Describe"},{id:"confirm",label:"Confirm"},{id:"complete",label:"Done"}];let w=r;f==="awaiting_confirmation"&&(w="confirm"),(w==="review"||w==="generating")&&(w="complete");const A=C.findIndex(T=>T.id===w);return i.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:C.map((T,D)=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`px-2 py-0.5 rounded ${D===A?"bg-violet-500/30 text-violet-300":D<A?"text-emerald-400":"text-slate-500"}`,children:T.label}),D<C.length-1&&i.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},T.id))})},S=()=>{var C;if(c&&r==="idle")return i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});if(p)return i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-6 text-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-500/20 flex items-center justify-center",children:i.jsxs("svg",{className:"w-6 h-6 text-amber-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),i.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),i.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"The AI provider is temporarily unavailable."}),i.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"This is usually resolved within a few moments."})]}),i.jsx("button",{onClick:g,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors bg-violet-500/20 hover:bg-violet-500/30",style:{color:"var(--text-primary)"},children:"Retry"})]});if(f==="awaiting_confirmation"&&u)return i.jsx(FW,{operation:{config:{entry_prompt:s}},context:u,onSubmit:k,onCancel:b});switch(r){case"describe":const w=x?i.jsxs("div",{className:"mb-4 pb-4 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("h3",{className:"text-base font-semibold mb-3",style:{color:"var(--text-primary)"},children:x.title}),i.jsx("div",{className:"text-sm space-y-3",style:{color:"var(--text-secondary)"},children:(C=x.paragraphs)==null?void 0:C.map((A,T)=>i.jsx("p",{children:A},T))}),x.call_to_action&&i.jsx("p",{className:"text-sm font-medium mt-4",style:{color:"var(--text-primary)"},children:x.call_to_action})]}):null;return i.jsxs(i.Fragment,{children:[i.jsx(NS,{messages:n,pendingPrompt:s,introContent:w}),i.jsx(DW,{onSubmit:v,disabled:d,placeholder:"Describe what you want to build..."})]});case"complete":return i.jsxs(i.Fragment,{children:[i.jsx(NS,{messages:n}),i.jsx(zW,{gateOutcome:o,project:a,onViewProject:j,onClose:b})]});default:return null}};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:i.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},onWheel:C=>C.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:i.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),N()]})]}),i.jsx("button",{onClick:b,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l&&i.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:l}),S()]})})}function qW({onClose:e}){const{user:t,logout:r,isAdmin:n}=Ms(),[s,o]=m.useState(null),[a,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{s==="linked"&&p()},[s]);const p=async()=>{try{d(!0);const k=await fetch("/auth/accounts",{credentials:"include"});if(k.ok){const N=await k.json();l(N.identities||[])}}catch(k){console.error("Failed to load accounts:",k)}finally{d(!1)}},h=k=>{window.location.href=`/auth/accounts/link/${k}`},v=async k=>{var N;if(a.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${k} account?`))try{const S=(N=document.cookie.split("; ").find(w=>w.startsWith("csrf=")||w.startsWith("__Host-csrf=")))==null?void 0:N.split("=")[1],C=await fetch(`/auth/accounts/${k}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":S||""}});if(C.ok)f({type:"success",text:"Account unlinked"}),await p();else{const w=await C.json();throw new Error(w.detail||"Failed to unlink")}}catch(S){f({type:"error",text:S.message})}},g=async()=>{await r(),e()},_=k=>{o(s===k?null:k),f(null)},x={google:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[i.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),i.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),i.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),i.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[i.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),i.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),i.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),i.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=k=>{const N={user:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),i.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"9",cy:"7",r:"4"}),i.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),i.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),i.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"3"}),i.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return N[k]||N.user},j=k=>{switch(k){case"account":return i.jsxs("div",{className:"px-4 py-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),i.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),i.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return i.jsxs("div",{className:"px-4 py-3",children:[u&&i.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?i.jsx("div",{className:"flex items-center justify-center py-4",children:i.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"space-y-2 mb-4",children:a.map(N=>i.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[x[N.provider_id],i.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:N.provider_email})]}),i.jsx("button",{onClick:()=>v(N.provider_id),disabled:a.length<=1,className:`text-xs px-2 py-1 rounded ${a.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},N.provider_id))}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),i.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[x.google,"Google"]}),i.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[x.microsoft,"Microsoft"]})]})]})]});default:return i.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),i.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?i.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):i.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsxs("div",{className:"flex-1 overflow-hidden",children:[i.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),i.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),i.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&i.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),i.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[i.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),i.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),i.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),i.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[i.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),i.jsx("polyline",{points:"14 2 14 8 20 8"}),i.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),i.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),i.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),i.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(k=>i.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[i.jsxs("button",{onClick:()=>!k.future&&_(k.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${k.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:k.future,children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:b(k.icon)}),i.jsx("span",{className:"flex-1 text-sm text-left",children:k.label}),k.future?i.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):i.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:s===k.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),s===k.id&&!k.future&&i.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:j(k.id)})]},k.id))]}),i.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[i.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),i.jsx("polyline",{points:"16 17 21 12 16 7"}),i.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const De={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function BW(){return i.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:De.bg,borderColor:De.border},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:De.textPrimary},children:"THE COMBINE"}),i.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:De.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function WW(){return i.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:De.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),i.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:De.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),i.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:De.textMuted},onMouseOver:e=>e.currentTarget.style.color=De.textSecondary,onMouseOut:e=>e.currentTarget.style.color=De.textMuted,children:["Learn how The Combine works",i.jsx("span",{"aria-hidden":"true",children:""})]})]})}function HW(){const e=[{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:i.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return i.jsx("section",{className:"max-w-4xl mx-auto",children:i.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>i.jsxs("div",{className:"flex-1 text-center group",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:De.bgElevated,border:`1px solid ${De.border}`,color:De.textMuted},children:t.icon}),i.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:De.textPrimary},children:t.title}),i.jsx("p",{className:"text-xs",style:{color:De.textMuted},children:t.description}),r<e.length-1&&i.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:De.border}})]},r))})})}function UW(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return i.jsx("section",{className:"text-center",children:i.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>i.jsx("span",{className:"text-xs",style:{color:De.textMuted},children:t},r))})})}function VW({onLogin:e}){return i.jsxs("section",{className:"text-center",children:[i.jsx("p",{className:"text-sm font-medium mb-4",style:{color:De.textSecondary},children:"Ready?"}),i.jsxs("div",{className:"inline-flex flex-col gap-3",children:[i.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:De.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=De.accentHover,onMouseOut:t=>t.currentTarget.style.background=De.accent,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[i.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),i.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),i.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),i.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),i.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:De.bg,border:`1px solid ${De.border}`,color:De.textPrimary},onMouseOver:t=>t.currentTarget.style.background=De.bgElevated,onMouseOut:t=>t.currentTarget.style.background=De.bg,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[i.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),i.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),i.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),i.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function GW(){return i.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[i.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:De.textSubtle},onMouseOver:e=>e.currentTarget.style.color=De.textMuted,onMouseOut:e=>e.currentTarget.style.color=De.textSubtle,children:"Terms"}),i.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:De.textSubtle},onMouseOver:e=>e.currentTarget.style.color=De.textMuted,onMouseOut:e=>e.currentTarget.style.color=De.textSubtle,children:"Privacy"}),i.jsx("span",{className:"text-xs",style:{color:De.border},children:" 2026 The Combine"})]})}function KW(){const{login:e}=Ms();return i.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:De.bg},children:[i.jsx(BW,{}),i.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:i.jsxs("div",{className:"space-y-12",children:[i.jsx(WW,{}),i.jsx(HW,{}),i.jsx(UW,{}),i.jsx(VW,{onLogin:e})]})}),i.jsx(GW,{})]})}const Oe={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function YW(){return i.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Oe.bg,borderColor:Oe.border},children:[i.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Oe.textMuted},onMouseOver:e=>e.currentTarget.style.color=Oe.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Oe.textMuted,children:[i.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),i.jsx("span",{className:"text-sm",children:"Back"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),i.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Oe.textPrimary},children:"THE COMBINE"})]}),i.jsx("div",{className:"w-16"})," "]})}function os({title:e,children:t}){return i.jsxs("section",{className:"mb-16",children:[e&&i.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Oe.textPrimary},children:e}),t]})}function vt({children:e,className:t=""}){return i.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Oe.textSecondary},children:e})}function ni({children:e}){return i.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Oe.textPrimary,borderLeft:`2px solid ${Oe.border}`},children:e})}function ll({items:e}){return i.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>i.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Oe.textSecondary},children:[i.jsx("span",{style:{color:Oe.textMuted},children:"-"}),t]},r))})}function cl({number:e,title:t,children:r}){return i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[i.jsxs("span",{className:"text-sm font-mono",style:{color:Oe.textMuted},children:[e,"."]}),i.jsx("h3",{className:"text-base font-medium",style:{color:Oe.textPrimary},children:t})]}),i.jsx("div",{className:"pl-7",children:i.jsx(vt,{children:r})})]})}function ul({title:e,children:t}){return i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Oe.textPrimary},children:e}),i.jsx(vt,{className:"mb-0",children:t})]})}function XW({onLogin:e}){return i.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Oe.bgElevated,border:`1px solid ${Oe.border}`},children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Oe.textPrimary},children:"When You're Ready"}),i.jsx(vt,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),i.jsx(vt,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),i.jsx(vt,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),i.jsxs("div",{className:"inline-flex flex-col gap-3",children:[i.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Oe.accentHover,onMouseOut:t=>t.currentTarget.style.background=Oe.accent,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[i.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),i.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),i.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),i.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),i.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.bg,border:`1px solid ${Oe.border}`,color:Oe.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Oe.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Oe.bg,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[i.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),i.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),i.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),i.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function QW(){return i.jsxs("footer",{className:"py-8 text-center",children:[i.jsx("p",{className:"text-sm mb-6",style:{color:Oe.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),i.jsxs("div",{className:"flex items-center justify-center gap-6",children:[i.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Terms"}),i.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Privacy"}),i.jsx("span",{className:"text-xs",style:{color:Oe.border},children:" 2026 The Combine"})]})]})}function ZW(){const{login:e}=Ms();return i.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Oe.bg},children:[i.jsx(YW,{}),i.jsx("main",{className:"flex-1 px-6 py-12",children:i.jsxs("article",{className:"max-w-2xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Oe.textPrimary},children:"Learn More"}),i.jsxs(os,{title:"What The Combine Is",children:[i.jsx(vt,{children:"The Combine is an AI-assisted production system for knowledge work."}),i.jsx(vt,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),i.jsx(ni,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),i.jsx(ni,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),i.jsxs(os,{title:"Why It Exists",children:[i.jsx(vt,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),i.jsx(vt,{children:"It breaks down when the work must be:"}),i.jsx(ll,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),i.jsx(vt,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),i.jsxs(os,{title:'Why "The Combine"',children:[i.jsx(vt,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),i.jsx(vt,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),i.jsx(vt,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),i.jsx(vt,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),i.jsx(vt,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),i.jsx(ll,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),i.jsx(vt,{children:"This is not automation for speed. It is industrialization for reliability."}),i.jsx(ni,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),i.jsxs(os,{title:"How It Works",children:[i.jsx(cl,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),i.jsx(cl,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),i.jsx(cl,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),i.jsx(cl,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),i.jsxs(os,{title:"What Makes It Different",children:[i.jsx(ul,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),i.jsx(ul,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),i.jsx(ul,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),i.jsx(ul,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),i.jsxs(os,{title:"What The Combine Is Not",children:[i.jsx(ll,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),i.jsx(vt,{children:"If you want improvisation, there are better tools."}),i.jsx(ni,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),i.jsxs(os,{title:"Who It's For",children:[i.jsx(vt,{children:"The Combine is designed for people responsible for outcomes, including:"}),i.jsx(ll,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),i.jsx(ni,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),i.jsx(XW,{onLogin:e})]})}),i.jsx(QW,{})]})}function V3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getTemplates();t(l.templates||[])}catch(l){o(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{templates:e,loading:r,error:s,refresh:a}}function JW(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){o(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{workflows:e,loading:r,error:s,refresh:a}}function G3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),a=m.useCallback(async()=>{n(!0),o(null);try{const l=await we.getSchemas();t(l.schemas||[])}catch(l){o(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{schemas:e,loading:r,error:s,refresh:a}}function K3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){n(!0),o(null);try{const h=await we.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&o(h.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return p(),()=>{f=!1}},[]);const a=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:a.role.length,task:a.task.length,qa:a.qa.length,pgc:a.pgc.length,questions:a.questions.length,reflection:a.reflection.length}),[e,a]),c=m.useCallback(f=>!f||f==="all"?e:a[f]||[],[e,a]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{n(!0),o(null);try{const f=await we.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),o(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:s,fragmentsByKind:a,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const vg="doctype-browser-collapsed";function Y3(e,t){const[r,n]=m.useState(()=>{try{const o=JSON.parse(localStorage.getItem(vg)||"{}");return e in o?o[e]:t}catch{return t}}),s=m.useCallback(o=>{const a=typeof o=="function"?o(r):o;n(a);try{const l=JSON.parse(localStorage.getItem(vg)||"{}");l[e]=a,localStorage.setItem(vg,JSON.stringify(l))}catch{}},[e,r]);return[r,s]}function ES({title:e,defaultOpen:t=!0,children:r}){const[n,s]=Y3(`group:${e}`,t);return i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>s(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[i.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function TS({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:s}){const[o,a]=Y3(`sub:${e}`,r);return i.jsxs("div",{children:[i.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[i.jsxs("button",{onClick:()=>a(!o),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[i.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&i.jsx("span",{style:{color:n,fontSize:8},children:""}),i.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),o&&s]})}function RS({selected:e,onClick:t,label:r,sublabel:n,badge:s}){return i.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-medium truncate",children:r}),s&&i.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:s})]}),n&&i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function AS({loading:e,empty:t,emptyMessage:r="None found"}){return e?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function eH({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:s=[],promptFragmentKindOptions:o=[],schemas:a=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:v=null,selectedRole:g=null,selectedTemplate:_=null,selectedWorkflow:x=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:j,onSelectRole:k,onSelectTemplate:N,onSelectWorkflow:S,onSelectFragment:C,onSelectStandaloneSchema:w,onCreateWorkflow:A,onCreateDocType:T,onCreateFragment:D,onCreateTemplate:$,onCreateSchema:E,onSelectTask:P,onSelectSchema:R,workspaceState:L=null}){var Ne;const[M,I]=m.useState(null),[O,F]=m.useState(null),[q,H]=m.useState(""),[V,Z]=m.useState(!1),[B,re]=m.useState(!1),[oe,X]=m.useState(""),[Q,fe]=m.useState(!1),ge=[...e].sort((ne,Se)=>(ne.display_name||"").localeCompare(Se.display_name||"")),be=n.filter(ne=>(ne.pow_class||"reference")==="reference"),ye=ne=>{const Se=ne.pow_class||"reference";return Se==="reference"?"ref":Se==="template"?"tpl":"inst"},ae=e.filter(ne=>ne.active_version).length+n.filter(ne=>ne.active_version).length,K=((Ne=L==null?void 0:L.modified_artifacts)==null?void 0:Ne.length)??0,te=(L==null?void 0:L.is_dirty)??!1,ee=()=>{I(null),F(null),H("")},ke=()=>{re(!1),X("")},je=async()=>{const ne=oe.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){fe(!0);try{await(T==null?void 0:T({doc_type_id:ne})),ke()}catch{}finally{fe(!1)}}},Te=async()=>{const ne=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){Z(!0);try{const Se={workflow_id:ne,pow_class:"template"};O&&(Se.derived_from={workflow_id:O.workflow_id,version:O.active_version},Se.source_version=O.active_version),await(A==null?void 0:A(Se)),ee()}catch{}finally{Z(!1)}}};return i.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs(ES,{title:"Production Workflows",defaultOpen:!0,children:[i.jsxs(TS,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:A&&i.jsx("button",{onClick:()=>I(M?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[M==="choose"&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsxs("button",{onClick:()=>I("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:be.length===0,children:["From Reference",be.length===0?" (none available)":""]}),i.jsx("button",{onClick:()=>I("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),i.jsx("button",{onClick:ee,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),M==="from_reference"&&!O&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),be.map(ne=>i.jsxs("button",{onClick:()=>F(ne),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[i.jsx("div",{className:"font-medium",children:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,Se=>Se.toUpperCase())}),i.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",ne.active_version]})]},ne.workflow_id)),i.jsx("button",{onClick:()=>I("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(M==="blank"||M==="from_reference"&&O)&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[O&&i.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",O.name||O.workflow_id," v",O.active_version]}),i.jsx("input",{type:"text",value:q,onChange:ne=>H(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&Te(),ne.key==="Escape"&&ee()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:V,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:Te,disabled:V||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:V?"wait":"pointer",opacity:!q.trim()||V?.5:1},children:V?"Creating...":"Create"}),i.jsx("button",{onClick:ee,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(AS,{loading:u,empty:!u&&n.length===0,emptyMessage:"No workflows"}),!u&&n.length>0&&i.jsx("div",{className:"py-1",children:n.map(ne=>i.jsx(RS,{selected:(x==null?void 0:x.workflow_id)===ne.workflow_id,onClick:()=>S==null?void 0:S(ne),label:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,Se=>Se.toUpperCase()),sublabel:`v${ne.active_version}`,badge:ye(ne)},ne.workflow_id))})]}),i.jsxs(TS,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&i.jsx("button",{onClick:()=>re(!B),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[B&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("input",{type:"text",value:oe,onChange:ne=>X(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&je(),ne.key==="Escape"&&ke()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:Q,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:je,disabled:Q||!oe.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Q?"wait":"pointer",opacity:!oe.trim()||Q?.5:1},children:Q?"Creating...":"Create"}),i.jsx("button",{onClick:ke,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(AS,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&ge.length>0&&i.jsx("div",{className:"py-1",children:ge.map(ne=>i.jsx(RS,{selected:v==="docworkflow"&&(h==null?void 0:h.doc_type_id)===ne.doc_type_id,onClick:()=>j==null?void 0:j(ne),label:ne.display_name,badge:`v${ne.active_version}`},ne.doc_type_id))})]})]}),i.jsxs(ES,{title:"Governance",defaultOpen:!1,children:[i.jsx("div",{className:"px-4 py-3",children:i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),i.jsxs("div",{children:[ae," active ",ae===1?"release":"releases"]})]})}),L&&i.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),te&&i.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[K," dirty"]})]})]})]})})}function tH({kinds:e=[],selectedKind:t="all",onSelect:r}){return i.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:s,count:o})=>{const a=t===n;return i.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:a?"var(--action-primary)":"var(--bg-panel)",color:a?"#000":"var(--text-secondary)",border:a?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[s,o!==void 0&&i.jsxs("span",{style:{marginLeft:4,opacity:a?.7:.6},children:["(",o,")"]})]},n)})})}function dl({title:e,count:t,dotColor:r,defaultOpen:n=!1,action:s,children:o}){const[a,l]=m.useState(n);return i.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[i.jsxs("button",{onClick:()=>l(!a),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{style:{color:"var(--text-muted)",transform:a?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),i.jsx("span",{style:{color:r,fontSize:10},children:""}),i.jsx("span",{className:"font-semibold",children:e})]}),i.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),s&&i.jsx("div",{className:"pr-3",children:s})]}),a&&i.jsx("div",{style:{background:"var(--bg-panel)"},children:o})]})}function si({onClick:e,label:t,sublabel:r,badge:n,isSelected:s}){return i.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:s?"var(--bg-selected, rgba(99, 102, 241, 0.15))":"transparent",border:"none",borderLeft:s?"3px solid var(--action-primary)":"3px solid transparent",color:s?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer"},children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-medium truncate",children:t}),n&&i.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:n})]}),r&&i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function fl({loading:e,empty:t,emptyMessage:r="None found"}){return e?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?i.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function rH({isOpen:e,onClose:t,promptFragments:r=[],promptFragmentKindOptions:n=[],templates:s=[],schemas:o=[],documentTypes:a=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,selectedFragment:h=null,selectedTemplate:v=null,selectedSchema:g=null,selectedMechanicalOp:_=null,onSelectFragment:x,onSelectTemplate:y,onSelectSchema:b,onSelectStandaloneSchema:j,onSelectMechanicalOp:k,onCreateFragment:N,onCreateTemplate:S,onCreateSchema:C}){const[w,A]=m.useState("all"),[T,D]=m.useState(!1),[$,E]=m.useState("role"),[P,R]=m.useState(""),[L,M]=m.useState(!1),[I,O]=m.useState(!1),[F,q]=m.useState(""),[H,V]=m.useState(!1),[Z,B]=m.useState(!1),[re,oe]=m.useState(""),[X,Q]=m.useState(!1),fe=w==="all"?r:r.filter(K=>K.kind===w);m.useEffect(()=>{e||(D(!1),O(!1),B(!1),R(""),q(""),oe(""))},[e]);const ge=m.useCallback((K,te)=>{K==null||K(te)},[]),be=async()=>{const K=P.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){M(!0);try{await(N==null?void 0:N({role_id:K,kind:$})),D(!1),R("")}catch{}finally{M(!1)}}},ye=async()=>{const K=F.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){V(!0);try{await(S==null?void 0:S({template_id:K})),O(!1),q("")}catch{}finally{V(!1)}}},ae=async()=>{const K=re.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){Q(!0);try{await(C==null?void 0:C({schema_id:K})),B(!1),oe("")}catch{}finally{Q(!1)}}};return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),i.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[i.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),i.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs(dl,{title:"Prompt Fragments",count:r.length,dotColor:"#f59e0b",defaultOpen:!0,action:N&&i.jsx("button",{onClick:()=>D(!T),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[T&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),i.jsx("select",{value:$,onChange:K=>E(K.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:i.jsx("option",{value:"role",children:"Role"})})]}),i.jsx("input",{type:"text",value:P,onChange:K=>R(K.target.value),onKeyDown:K=>{K.key==="Enter"&&be(),K.key==="Escape"&&D(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:L,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:be,disabled:L||!P.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:L?"wait":"pointer",opacity:!P.trim()||L?.5:1},children:L?"Creating...":"Create"}),i.jsx("button",{onClick:()=>D(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.length>0&&i.jsx(tH,{kinds:n,selectedKind:w,onSelect:A}),i.jsx(fl,{loading:d,empty:!d&&fe.length===0,emptyMessage:w==="all"?"No prompt fragments":`No ${w} fragments`}),!d&&fe.length>0&&i.jsx("div",{className:"py-1",children:fe.map(K=>i.jsx(si,{onClick:()=>ge(x,K),label:K.name||K.fragment_id,sublabel:`${K.kind}  v${K.version}`,badge:K.kind,isSelected:(h==null?void 0:h.fragment_id)===K.fragment_id},K.fragment_id))})]}),i.jsxs(dl,{title:"Templates",count:s.length,dotColor:"var(--dot-green)",action:S&&i.jsx("button",{onClick:()=>O(!I),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[I&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("input",{type:"text",value:F,onChange:K=>q(K.target.value),onKeyDown:K=>{K.key==="Enter"&&ye(),K.key==="Escape"&&O(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:H,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:ye,disabled:H||!F.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:H?"wait":"pointer",opacity:!F.trim()||H?.5:1},children:H?"Creating...":"Create"}),i.jsx("button",{onClick:()=>O(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(fl,{loading:u,empty:!u&&s.length===0,emptyMessage:"No templates"}),!u&&s.length>0&&i.jsx("div",{className:"py-1",children:s.map(K=>i.jsx(si,{onClick:()=>ge(y,K),label:K.name||K.template_id.replace(/_/g," ").replace(/\b\w/g,te=>te.toUpperCase()),sublabel:`v${K.active_version}`,isSelected:(v==null?void 0:v.template_id)===K.template_id},K.template_id))})]}),i.jsxs(dl,{title:"Schemas",count:o.length||a.length,dotColor:"var(--dot-blue)",action:C&&i.jsx("button",{onClick:()=>B(!Z),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[Z&&i.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[i.jsx("input",{type:"text",value:re,onChange:K=>oe(K.target.value),onKeyDown:K=>{K.key==="Enter"&&ae(),K.key==="Escape"&&B(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:X,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:ae,disabled:X||!re.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:X?"wait":"pointer",opacity:!re.trim()||X?.5:1},children:X?"Creating...":"Create"}),i.jsx("button",{onClick:()=>B(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),i.jsx(fl,{loading:f,empty:!f&&o.length===0&&a.length===0,emptyMessage:"No schemas"}),!f&&o.length>0&&i.jsx("div",{className:"py-1",children:o.map(K=>i.jsx(si,{onClick:()=>ge(j,K),label:K.title||K.schema_id,sublabel:`v${K.active_version}`,isSelected:(g==null?void 0:g.schema_id)===K.schema_id},`standalone-${K.schema_id}`))}),o.length===0&&a.length>0&&i.jsx("div",{className:"py-1",children:a.map(K=>i.jsx(si,{onClick:()=>ge(b,{doc_type_id:K.doc_type_id,display_name:K.display_name,active_version:K.active_version}),label:K.display_name,sublabel:`from ${K.doc_type_id}`},`schema-${K.doc_type_id}`))})]}),i.jsxs(dl,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[i.jsx(fl,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&i.jsx("div",{className:"py-1",children:l.map(K=>{const te=c.filter(ee=>ee.type===K.type_id);return i.jsxs("div",{children:[i.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsx("span",{style:{fontSize:10},children:""}),i.jsx("span",{children:K.name}),i.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",te.length,")"]})]}),te.length>0?te.map(ee=>i.jsx(si,{onClick:()=>ge(k,ee),label:ee.name,sublabel:`v${ee.active_version}`,badge:ee.type,isSelected:(_==null?void 0:_.op_id)===ee.op_id},ee.op_id)):i.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},K.type_id)})}),!p&&l.length===0&&c.length===0&&i.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),i.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function rn({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:s=!1,error:o=null,readOnly:a=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[a&&i.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!a&&s&&i.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[c&&!a&&i.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&i.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&s&&i.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),o&&i.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",o]})]})]}),i.jsx("div",{className:"flex-1 relative",children:r?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):i.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:a,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function nH({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[s,o]=m.useState(!0),[a,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),o(!1);return}(async()=>{o(!0),l(null);try{const d=await we.getPreview(e,t);n(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{o(!1)}})()},[e,t]),i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),i.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&i.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&i.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&i.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&i.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),i.jsx("div",{className:"flex-1 relative overflow-auto",children:s?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):a?i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[i.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),i.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:a})]})}):i.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function sH({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[s,o]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,j,k;t&&(o({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((j=t.ui)==null?void 0:j.category)||"",ui_display_order:((k=t.ui)==null?void 0:k.display_order)||0}),h(!1),f(null))},[t]);const v=m.useCallback((b,j)=>{o(k=>({...k,[b]:j})),h(!0)},[]),g=m.useCallback((b,j)=>{const k=j.split(",").map(N=>N.trim()).filter(N=>N);o(N=>({...N,[b]:k})),h(!0)},[]),_=m.useCallback(b=>{if(!b)return"";const j=r.find(k=>k.role_id===b);return j?`prompt:role:${b}:${j.active_version}`:""},[r]),x=m.useCallback(b=>{if(!b)return"";const j=b.split(":");return j.length>=3&&j[0]==="prompt"&&j[1]==="role"?j[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!s)){d(!0),f(null);try{const b=t.version||t.active_version,j=`doctype:${t.doc_type_id}:${b}:manifest`,k=oH(t.doc_type_id,b,s),N=await we.writeArtifact(e,j,k);h(!1),n==null||n(j,N)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,s,n]);return!t||!s?i.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsx("div",{className:"flex items-center gap-2",children:p&&i.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[c&&i.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&i.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),i.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"max-w-2xl space-y-6",children:[i.jsxs(oi,{title:"Identity",children:[i.jsx(Jt,{label:"Display Name",children:i.jsx("input",{type:"text",value:s.display_name,onChange:b=>v("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Description",children:i.jsx("textarea",{value:s.description,onChange:b=>v("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),i.jsxs(oi,{title:"Classification",children:[i.jsx(Jt,{label:"Authority Level",children:i.jsxs("select",{value:s.authority_level,onChange:b=>v("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"descriptive",children:"Descriptive"}),i.jsx("option",{value:"prescriptive",children:"Prescriptive"}),i.jsx("option",{value:"constructive",children:"Constructive"}),i.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),i.jsx(Jt,{label:"Creation Mode",children:i.jsxs("select",{value:s.creation_mode,onChange:b=>v("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"llm_generated",children:"LLM Generated"}),i.jsx("option",{value:"constructed",children:"Constructed"}),i.jsx("option",{value:"extracted",children:"Extracted"})]})}),i.jsx(Jt,{label:"Scope",children:i.jsxs("select",{value:s.scope,onChange:b=>v("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"project",children:"Project"}),i.jsx("option",{value:"work_package",children:"Work Package"}),i.jsx("option",{value:"work_statement",children:"Work Statement"})]})})]}),i.jsx(oi,{title:"Shared References",children:i.jsxs(Jt,{label:"Role Prompt",children:[i.jsxs("select",{value:x(s.role_prompt_ref),onChange:b=>v("role_prompt_ref",_(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"",children:"None"}),r.map(b=>i.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())},b.role_id))]}),s.role_prompt_ref&&i.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:s.role_prompt_ref})]})}),i.jsxs(oi,{title:"Dependencies",children:[i.jsx(Jt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:i.jsx("input",{type:"text",value:s.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:i.jsx("input",{type:"text",value:s.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Parent Doc Type",children:i.jsx("input",{type:"text",value:s.parent_doc_type,onChange:b=>v("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:i.jsx("input",{type:"text",value:s.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),i.jsxs(oi,{title:"UI Configuration",children:[i.jsx(Jt,{label:"Icon",children:i.jsx("input",{type:"text",value:s.ui_icon,onChange:b=>v("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),i.jsx(Jt,{label:"Category",children:i.jsxs("select",{value:s.ui_category,onChange:b=>v("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"",children:"Select category..."}),i.jsx("option",{value:"intake",children:"Intake"}),i.jsx("option",{value:"architecture",children:"Architecture"}),i.jsx("option",{value:"planning",children:"Planning"}),i.jsx("option",{value:"execution",children:"Execution"})]})}),i.jsx(Jt,{label:"Display Order",children:i.jsx("input",{type:"number",value:s.ui_display_order,onChange:b=>v("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function oi({title:e,children:t}){return i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),i.jsx("div",{className:"space-y-4",children:t})]})}function Jt({label:e,hint:t,children:r}){return i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&i.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function oH(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(s=>`"${s}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(s=>`"${s}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(s=>`"${s}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function X3(e,t,{debounceMs:r=1e3,onSave:n}={}){const[s,o]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,g]=m.useState(null),_=m.useRef(null),x=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){o(null),l(null),d(!1);return}d(!0),f(null);try{const S=await we.getArtifact(e,t),C=JSON.parse(S.content);o(C),l(C)}catch(S){f(S.message),console.error("Failed to load workflow artifact:",S)}finally{d(!1)}},[e,t]),b=m.useCallback(async S=>{if(!(!e||!t)){h(!0),f(null);try{const C=JSON.stringify(S,null,2),w=await we.writeArtifact(e,t,C);g(w),l(S),n&&n(w)}catch(C){f(C.message),console.error("Failed to save workflow:",C)}finally{h(!1)}}},[e,t,n]),j=m.useCallback(S=>{x.current=S,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{x.current!==null&&(b(x.current),x.current=null)},r)},[b,r]),k=m.useCallback(S=>{o(S),j(S)},[j]),N=m.useCallback(()=>{_.current&&clearTimeout(_.current),s&&b(s)},[s,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{workflowJson:s,originalJson:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateWorkflow:k,saveNow:N,reload:y}}function iH({data:e,selected:t}){const{config:r,isEntry:n}=e,s=e.type==="end";return i.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[i.jsx(yr,{type:"target",position:ce.Top,style:{background:r.color,width:8,height:8,border:"none"}}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[i.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&i.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),i.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&i.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),i.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&i.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!s&&i.jsx(yr,{type:"source",position:ce.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const aH=m.memo(iH),lH={workflowNode:aH},cH=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function uH({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:s,onEdgeSelect:o}){const a=ru(),[l,c,d]=IE([]),[u,f,p]=PE([]),[h,v]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:w,edges:A}=nS(e);(!w.some(D=>D.position.x!==0||D.position.y!==0)||!g.current)&&(w=Hx(w,A),g.current=!0),c(w),f(A)},[e,c,f]),m.useEffect(()=>{c(w=>w.map(A=>({...A,selected:A.id===r})))},[r,c]);const _=m.useCallback(w=>{if(!e)return;const T={edge_id:Qq(w.source,w.target,e.edges||[]),from_node_id:w.source,to_node_id:w.target,outcome:"success",label:"",kind:"auto"},D={...e,edges:[...e.edges||[],T]};t(D)},[e,t]),x=m.useCallback((w,A)=>{if(!e)return;const T=e.nodes.map(D=>D.node_id===A.id?{...D,_position:A.position}:D);t({...e,nodes:T})},[e,t]),y=m.useCallback((w,A)=>{s==null||s(A.id)},[s]),b=m.useCallback((w,A)=>{o==null||o(A.id)},[o]),j=m.useCallback(()=>{s==null||s(null),o==null||o(null)},[s,o]),k=m.useCallback(w=>{if(w.key==="Delete"||w.key==="Backspace"){if(r&&e){const A={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(A),s==null||s(null)}else if(n&&e){const A={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(A),o==null||o(null)}}},[r,n,e,t,s,o]),N=m.useCallback(w=>{if(!e)return;const A=Xq(w,e.nodes||[]),T=Zq(w);T.node_id=A;const D=a.getViewport(),$=(-D.x+window.innerWidth/2)/D.zoom,E=(-D.y+window.innerHeight/2)/D.zoom;T._position={x:$-110,y:E-50};const P={...e,nodes:[...e.nodes||[],T]};t(P),v(!1),s==null||s(A)},[e,t,a,s]),S=m.useCallback(()=>{if(!e)return;let{nodes:w,edges:A}=nS(e);w=Hx(w,A);const T=e.nodes.map(D=>{const $=w.find(E=>E.id===D.node_id);return $?{...D,_position:$.position}:D});t({...e,nodes:T}),setTimeout(()=>{a.fitView({padding:.2,duration:300})},50)},[e,t,a]),C=m.useCallback(()=>{a.fitView({padding:.2,duration:300})},[a]);return i.jsx("div",{className:"flex-1 relative",onKeyDown:k,tabIndex:0,style:{outline:"none"},children:i.jsxs(nu,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:_,onNodeDragStop:x,onNodeClick:y,onEdgeClick:b,onPaneClick:j,nodeTypes:lH,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[i.jsx(Un,{position:"top-left",children:i.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>v(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&i.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:cH.map(w=>{const A=bc[w.value]||{};return i.jsxs("button",{onClick:()=>N(w.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[i.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:A.color}}),w.label]},w.value)})})]}),i.jsx("button",{onClick:S,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),i.jsx("button",{onClick:C,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),i.jsx(DE,{position:"bottom-right",nodeColor:w=>{var T;const A=(T=w.data)==null?void 0:T.config;return(A==null?void 0:A.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),i.jsx(Un,{position:"bottom-left",children:i.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(bc).map(([w,A])=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:A.color}}),i.jsx("span",{style:{color:"var(--text-muted)"},children:A.label})]},w))})}),i.jsx(Un,{position:"top-right",children:i.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const dH=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],IS=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],PS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"work_package",label:"Work Package Gate",produces:"pgc_clarifications.work_package"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],fH=["semantic","structural","hybrid"],pH=["stabilized","blocked","abandoned"],qe={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},St={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},hH={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function yg(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function bg(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function Bs(e){var s;if(!e)return"";const t=e.kind||"role",r=((s=e.fragment_id)==null?void 0:s.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function Ws(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function pl(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function hl(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function _g({title:e,defaultOpen:t=!1,isOpen:r,onToggle:n,children:s,badge:o}){const[a,l]=m.useState(t),c=r!==void 0,d=c?r:a,u=()=>{c&&n?n():l(!a)};return i.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:i.jsx("path",{d:"M9 18l6-6-6-6"})}),i.jsx("span",{style:{...St,marginBottom:0},children:e})]}),o&&i.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:o})]}),d&&i.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:s})]})}function wg(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function Hs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function mH({node:e,onChange:t,onDelete:r,templates:n=[],schemas:s=[],roleFragments:o=[],taskFragments:a=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var je,Te,Ne,ne,Se,Ve,ct,We,Pe,ie,xe,pe,U,ve,he,Fe,He,st,Ge;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const v=(z,W)=>{const G={...u,[z]:W};f(G),t(G)},g=(z,W)=>{const G={...u.includes,[z]:W},se={...u,includes:G};f(se),t(se)},_=z=>{const W={...u.includes};delete W[z];const G={...u,includes:W};f(G),t(G)},x=()=>{const z={...u.includes,NEW_KEY:""},W={...u,includes:z};f(W),t(W)},y=z=>{const W={...u,internals:z};f(W),t(W)},b=(z,W)=>{const G=u.internals||N(),se={...G.question_generation,[z]:W};y({...G,question_generation:se})},j=(z,W)=>{const G=u.internals||N(),se={...G.question_generation.includes,[z]:W},$e={...G.question_generation,includes:se};y({...G,question_generation:$e})},k=(z,W)=>{const G=u.internals||N(),se={...G.clarification_merge,[z]:W};y({...G,clarification_merge:se})},N=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const S=u.type==="pgc",C=bg(u.task_ref),w=u.includes||{},A=w.ROLE_PROMPT||"",T=w.TASK_PROMPT||"",D=w.OUTPUT_SCHEMA||"",$=w.PGC_CONTEXT||"",E=Ws(A),P=Ws(T),R=hl(D),L=Ws($),M=Object.entries(w).filter(([z])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(z)),I=u.internals||N(),O=bg((je=I.question_generation)==null?void 0:je.template_ref),F=Ws((Ne=(Te=I.question_generation)==null?void 0:Te.includes)==null?void 0:Ne.ROLE_PROMPT),q=Ws((Se=(ne=I.question_generation)==null?void 0:ne.includes)==null?void 0:Se.TASK_PROMPT),H=Ws((ct=(Ve=I.question_generation)==null?void 0:Ve.includes)==null?void 0:ct.PGC_CONTEXT),V=hl((We=I.question_generation)==null?void 0:We.output_schema_ref),Z=bg((Pe=I.clarification_merge)==null?void 0:Pe.template_ref),B=hl((ie=I.clarification_merge)==null?void 0:ie.output_schema_ref),re=z=>{const W=z.target.value;if(!W){v("task_ref","");return}const G=n.find(se=>se.template_id===W);G&&v("task_ref",yg(G))},oe=z=>{const W=z.target.value;if(!W){_("ROLE_PROMPT");return}const G=o.find(se=>se.fragment_id===`role:${W}`||se.id===W);G&&g("ROLE_PROMPT",Bs(G))},X=z=>{const W=z.target.value;if(!W){_("TASK_PROMPT");return}const G=a.find(se=>se.fragment_id===`task:${W}`||se.id===W);G&&g("TASK_PROMPT",Bs(G))},Q=z=>{const W=z.target.value;if(!W){_("OUTPUT_SCHEMA");return}const G=s.find(se=>se.schema_id===W);G&&g("OUTPUT_SCHEMA",pl(G))},fe=z=>{const W=z.target.value;if(!W){_("PGC_CONTEXT");return}const G=l.find(se=>se.fragment_id===`pgc:${W}`||se.id===W);G&&g("PGC_CONTEXT",Bs(G))},ge=z=>{const W=z.target.value,G=PS.find(pt=>pt.value===W),se=(G==null?void 0:G.produces)||`pgc_clarifications.${W}`,$e={...u,gate_kind:W,produces:se};f($e),t($e)},be=z=>{const W=z.target.value;if(!W){b("template_ref","");return}const G=n.find(se=>se.template_id===W);G&&b("template_ref",yg(G))},ye=z=>{const W=z.target.value;if(!W){j("ROLE_PROMPT","");return}const G=o.find(se=>se.fragment_id===`role:${W}`||se.id===W);G&&j("ROLE_PROMPT",Bs(G))},ae=z=>{const W=z.target.value;if(!W){j("TASK_PROMPT","");return}const G=a.find(se=>se.fragment_id===`task:${W}`||se.id===W);G&&j("TASK_PROMPT",Bs(G))},K=z=>{const W=z.target.value;if(!W){j("PGC_CONTEXT","");return}const G=l.find(se=>se.fragment_id===`pgc:${W}`||se.id===W);G&&j("PGC_CONTEXT",Bs(G))},te=z=>{const W=z.target.value;if(!W){b("output_schema_ref","");return}const G=s.find(se=>se.schema_id===W);G&&b("output_schema_ref",pl(G))},ee=z=>{const W=z.target.value;if(!W){k("template_ref","");return}const G=n.find(se=>se.template_id===W);G&&k("template_ref",yg(G))},ke=z=>{const W=z.target.value;if(!W){k("output_schema_ref","");return}const G=s.find(se=>se.schema_id===W);G&&k("output_schema_ref",pl(G))};return i.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[i.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:S?"PGC Gate Properties":"Node Properties"}),i.jsx("button",{onClick:()=>r(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Node ID"}),i.jsx("input",{type:"text",value:u.node_id||"",onChange:z=>v("node_id",z.target.value),style:qe})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Type"}),i.jsx("select",{value:u.type||"task",onChange:z=>v("type",z.target.value),style:qe,children:dH.map(z=>i.jsx("option",{value:z.value,children:z.label},z.value))})]}),S&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Gate Kind"}),i.jsx("select",{value:u.gate_kind||"discovery",onChange:ge,style:qe,children:PS.map(z=>i.jsx("option",{value:z.value,children:z.label},z.value))})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Description"}),i.jsx("textarea",{value:u.description||"",onChange:z=>v("description",z.target.value),rows:2,style:{...qe,resize:"vertical"}})]}),(S||["task","intake_gate"].includes(u.type))&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Produces"}),i.jsx("input",{type:"text",value:u.produces||"",onChange:z=>v("produces",z.target.value),placeholder:S?"pgc_clarifications.discovery":"document_type",style:qe})]}),S&&i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{style:hH,children:"Gate Internals"}),i.jsx(_g,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),i.jsxs("select",{value:O||"",onChange:be,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Template --"}),n.map(z=>i.jsx("option",{value:z.template_id,children:z.name||z.template_id.replace(/_/g," ")},z.template_id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),i.jsxs("select",{value:F||"",onChange:ye,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Role --"}),o.map(z=>{var G;const W=((G=z.fragment_id)==null?void 0:G.replace("role:",""))||z.id;return i.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),i.jsxs("select",{value:q||"",onChange:ae,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Task --"}),a.map(z=>{var G;const W=((G=z.fragment_id)==null?void 0:G.replace("task:",""))||z.id;return i.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),i.jsxs("select",{value:H||"",onChange:K,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(z=>{var G;const W=((G=z.fragment_id)==null?void 0:G.replace("pgc:",""))||z.id;return i.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:V||"",onChange:te,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>i.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]})}),i.jsx("div",{className:"mt-2",children:i.jsx(_g,{title:"Entry: Operator Answers",badge:"UI",children:i.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Renders:"}),i.jsx("span",{className:"font-mono",children:((xe=I.operator_entry)==null?void 0:xe.renders)||"question_set"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Captures:"}),i.jsx("span",{className:"font-mono",children:((pe=I.operator_entry)==null?void 0:pe.captures)||"pgc_answers"})]}),i.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),i.jsx("div",{className:"mt-2",children:i.jsx(_g,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((U=I.clarification_merge)==null?void 0:U.internal_type)||"LLM",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),i.jsxs("select",{value:((ve=I.clarification_merge)==null?void 0:ve.internal_type)||"LLM",onChange:z=>k("internal_type",z.target.value),style:{...qe,fontSize:11},children:[i.jsx("option",{value:"LLM",children:"LLM"}),i.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((he=I.clarification_merge)==null?void 0:he.internal_type)||"LLM")==="LLM"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),i.jsxs("select",{value:Z||"",onChange:ee,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Template --"}),n.map(z=>i.jsx("option",{value:z.template_id,children:z.name||z.template_id.replace(/_/g," ")},z.template_id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:B||"",onChange:ke,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>i.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]}),((Fe=I.clarification_merge)==null?void 0:Fe.internal_type)==="MECH"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),i.jsxs("select",{value:Hs((He=I.clarification_merge)==null?void 0:He.op_ref)||"",onChange:z=>{const W=z.target.value;if(!W){k("op_ref","");return}const G=d.find(se=>se.op_id===W);G&&k("op_ref",wg(G))},style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(z=>z.type==="merger").map(z=>i.jsx("option",{value:z.op_id,children:z.name},z.op_id))]})]}),((st=I.clarification_merge)==null?void 0:st.op_ref)&&(()=>{const z=Hs(I.clarification_merge.op_ref),W=d.find(G=>G.op_id===z);return W?i.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:W.type}),i.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&i.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:B||"",onChange:ke,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>i.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]}),i.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Internal Type"}),i.jsx("select",{value:u.internal_type||"LLM",onChange:z=>v("internal_type",z.target.value),style:qe,children:IS.map(z=>i.jsx("option",{value:z.value,children:z.label},z.value))}),i.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Ge=IS.find(z=>z.value===(u.internal_type||"LLM")))==null?void 0:Ge.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Interaction Template"}),i.jsxs("select",{value:C||"",onChange:re,style:qe,children:[i.jsx("option",{value:"",children:"-- Select Template --"}),n.map(z=>i.jsx("option",{value:z.template_id,children:z.name||z.template_id.replace(/_/g," ")},z.template_id))]}),u.task_ref&&i.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Mechanical Operation"}),i.jsxs("select",{value:Hs(u.op_ref)||"",onChange:z=>{const W=z.target.value;if(!W){v("op_ref","");return}const G=d.find(se=>se.op_id===W);G&&v("op_ref",wg(G))},style:qe,children:[i.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(z=>{const W=d.filter(G=>G.type===z.type_id);return W.length===0?null:i.jsx("optgroup",{label:z.name,children:W.map(G=>i.jsx("option",{value:G.op_id,children:G.name},G.op_id))},z.type_id)})]}),u.op_ref&&i.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const z=Hs(u.op_ref),W=d.find(se=>se.op_id===z),G=W?c.find(se=>se.type_id===W.type):null;return W?i.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(G==null?void 0:G.name)||W.type}),i.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&i.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Output Schema"}),i.jsxs("select",{value:hl(u.output_schema_ref)||"",onChange:z=>{const W=z.target.value;if(!W){v("output_schema_ref","");return}const G=s.find(se=>se.schema_id===W);G&&v("output_schema_ref",pl(G))},style:qe,children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>i.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Entry Operation"}),i.jsxs("select",{value:Hs(u.op_ref)||"",onChange:z=>{const W=z.target.value;if(!W){v("op_ref","");return}const G=d.find(se=>se.op_id===W);G&&v("op_ref",wg(G))},style:qe,children:[i.jsx("option",{value:"",children:"-- Select Entry Operation --"}),d.filter(z=>z.type==="entry").map(z=>i.jsx("option",{value:z.op_id,children:z.name},z.op_id))]}),u.op_ref&&i.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const z=Hs(u.op_ref),W=d.find(se=>se.op_id===z);if(!W)return null;const G=W.config||{};return i.jsxs("div",{className:"p-2 rounded text-xs space-y-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-orange, #f97316)",color:"#fff"},children:"Entry"}),i.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&i.jsx("div",{style:{color:"var(--text-muted)"},children:W.description}),i.jsxs("div",{className:"pt-2 border-t space-y-1",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Renders:"}),i.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:G.renders||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Captures:"}),i.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:G.captures||"-"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Layout:"}),i.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:G.layout||"form"})]})]}),G.entry_prompt&&i.jsxs("div",{className:"p-2 rounded mt-2",style:{background:"var(--bg-panel)"},children:[i.jsx("div",{className:"text-[10px] uppercase mb-1",style:{color:"var(--text-muted)"},children:"Entry Prompt"}),i.jsx("div",{style:{color:"var(--text-primary)"},children:G.entry_prompt})]})]})})(),!u.op_ref&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Select an Entry operation above, or define custom renders/captures below."}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Renders"}),i.jsx("input",{type:"text",value:u.renders||"",onChange:z=>v("renders",z.target.value),placeholder:"e.g., question_set",style:qe})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Captures"}),i.jsx("input",{type:"text",value:u.captures||"",onChange:z=>v("captures",z.target.value),placeholder:"e.g., user_answers",style:qe})]})]})]}),u.type==="qa"&&i.jsxs("div",{children:[i.jsx("label",{style:St,children:"QA Mode"}),i.jsx("select",{value:u.qa_mode||"semantic",onChange:z=>v("qa_mode",z.target.value),style:qe,children:fH.map(z=>i.jsx("option",{value:z,children:z},z))})]}),u.type==="end"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Terminal Outcome"}),i.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:z=>v("terminal_outcome",z.target.value),style:qe,children:pH.map(z=>i.jsx("option",{value:z,children:z},z))})]}),i.jsxs("div",{children:[i.jsx("label",{style:St,children:"Gate Outcome"}),i.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:z=>v("gate_outcome",z.target.value),placeholder:"e.g., complete, failed",style:qe})]})]}),i.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&i.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:z=>v("requires_qa",z.target.checked)}),"Requires QA"]}),i.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:z=>v("non_advancing",z.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&i.jsxs("div",{children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsx("label",{style:St,children:"Includes"})}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),i.jsxs("select",{value:E||"",onChange:oe,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Role --"}),o.map(z=>{var G;const W=((G=z.fragment_id)==null?void 0:G.replace("role:",""))||z.id;return i.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),i.jsxs("select",{value:P||"",onChange:X,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Task --"}),a.map(z=>{var G;const W=((G=z.fragment_id)==null?void 0:G.replace("task:",""))||z.id;return i.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),i.jsxs("select",{value:R||"",onChange:Q,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>i.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),i.jsxs("select",{value:L||"",onChange:fe,style:{...qe,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(z=>{var G;const W=((G=z.fragment_id)==null?void 0:G.replace("pgc:",""))||z.id;return i.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),M.length>0&&i.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[i.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),i.jsx("div",{className:"space-y-2",children:M.map(([z,W])=>i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{type:"text",value:z,onChange:G=>{const se={...u.includes};delete se[z],se[G.target.value]=W;const $e={...u,includes:se};f($e),t($e)},style:{...qe,width:"35%",fontSize:10},placeholder:"KEY"}),i.jsx("input",{type:"text",value:W,onChange:G=>g(z,G.target.value),style:{...qe,flex:1,fontSize:10},placeholder:"path/to/file"}),i.jsx("button",{onClick:()=>_(z),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},z))})]}),i.jsx("button",{onClick:x,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const gH=["auto","user_choice"],xH=["eq","ne","lt","lte","gt","gte"],Jr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},is={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function vH({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[s,o]=m.useState(e);m.useEffect(()=>{o(e)},[e]);const a=(u,f)=>{const p={...s,[u]:f};o(p),r(p)},l=()=>{const u=[...s.conditions||[],{type:"retry_count",operator:"lt",value:2}];a("conditions",u)},c=(u,f,p)=>{const h=[...s.conditions||[]];h[u]={...h[u],[f]:p},a("conditions",h)},d=u=>{const f=(s.conditions||[]).filter((p,h)=>h!==u);a("conditions",f)};return s?i.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[i.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),i.jsx("button",{onClick:()=>n(s.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Edge ID"}),i.jsx("input",{type:"text",value:s.edge_id||"",onChange:u=>a("edge_id",u.target.value),style:Jr})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"From Node"}),i.jsx("select",{value:s.from_node_id||"",onChange:u=>a("from_node_id",u.target.value),style:Jr,children:t.map(u=>i.jsx("option",{value:u,children:u},u))})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"To Node"}),i.jsxs("select",{value:s.to_node_id||"",onChange:u=>a("to_node_id",u.target.value||null),style:Jr,children:[i.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>i.jsx("option",{value:u,children:u},u))]})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Outcome"}),i.jsx("input",{type:"text",value:s.outcome||"",onChange:u=>a("outcome",u.target.value),placeholder:"success, failed, etc.",style:Jr})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Label"}),i.jsx("input",{type:"text",value:s.label||"",onChange:u=>a("label",u.target.value),placeholder:"Human-readable label",style:Jr})]}),i.jsxs("div",{children:[i.jsx("label",{style:is,children:"Kind"}),i.jsx("select",{value:s.kind||"auto",onChange:u=>a("kind",u.target.value),style:Jr,children:gH.map(u=>i.jsx("option",{value:u,children:u},u))})]}),i.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[i.jsx("input",{type:"checkbox",checked:s.non_advancing||!1,onChange:u=>a("non_advancing",u.target.checked)}),"Non-advancing"]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("label",{style:is,children:"Conditions"}),i.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),i.jsx("div",{className:"space-y-2",children:(s.conditions||[]).map((u,f)=>i.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:i.jsxs("div",{className:"flex gap-1 items-center",children:[i.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Jr,flex:1,fontSize:10}}),i.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Jr,width:"auto",fontSize:10},children:xH.map(p=>i.jsx("option",{value:p,children:p},p))}),i.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Jr,width:50,fontSize:10}}),i.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const yH={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function bH({workspaceId:e,artifactId:t,onArtifactSave:r,mechanicalOpTypes:n=[],mechanicalOps:s=[]}){var H,V,Z;const[o,a]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,v]=m.useState(null),{workflowJson:g,loading:_,error:x,saving:y,lastSaveResult:b,updateWorkflow:j}=X3(e,t,{onSave:B=>{r==null||r(t,B)}}),{templates:k}=V3(),{schemas:N}=G3(),{fragmentsByKind:S}=K3(),C=m.useMemo(()=>{var B;return!l||!g?null:((B=g.nodes)==null?void 0:B.find(re=>re.node_id===l))||null},[l,g]),w=m.useMemo(()=>{var B;return!d||!g?null:((B=g.edges)==null?void 0:B.find(re=>re.edge_id===d))||null},[d,g]),A=m.useMemo(()=>g!=null&&g.nodes?g.nodes.map(B=>B.node_id):[],[g]),T=m.useCallback(B=>{j(B)},[j]),D=m.useCallback(B=>{if(!g)return;const re=g.nodes.map(Q=>Q.node_id===l?B:Q);let oe=g.edges,X=g.entry_node_ids||[];B.node_id!==l&&(oe=g.edges.map(Q=>({...Q,from_node_id:Q.from_node_id===l?B.node_id:Q.from_node_id,to_node_id:Q.to_node_id===l?B.node_id:Q.to_node_id})),X=X.map(Q=>Q===l?B.node_id:Q),c(B.node_id)),j({...g,nodes:re,edges:oe,entry_node_ids:X})},[g,l,j]),$=m.useCallback(B=>{if(!g)return;const re=g.edges.map(oe=>oe.edge_id===d?B:oe);B.edge_id!==d&&u(B.edge_id),j({...g,edges:re})},[g,d,j]),E=m.useCallback(B=>{g&&(j({...g,nodes:g.nodes.filter(re=>re.node_id!==B),edges:g.edges.filter(re=>re.from_node_id!==B&&re.to_node_id!==B),entry_node_ids:(g.entry_node_ids||[]).filter(re=>re!==B)}),c(null))},[g,j]),P=m.useCallback(B=>{g&&(j({...g,edges:g.edges.filter(re=>re.edge_id!==B)}),u(null))},[g,j]),R=m.useCallback(B=>{c(B),B&&u(null)},[]),L=m.useCallback(B=>{u(B),B&&c(null)},[]),M=m.useCallback(B=>{B==="json"&&g&&(p(JSON.stringify(g,null,2)),v(null)),a(B)},[g]),I=m.useCallback(B=>{const re=B.target.value;p(re);try{const oe=JSON.parse(re);v(null),j(oe)}catch(oe){v(oe.message)}},[j]),O=((H=b==null?void 0:b.tier1_report)==null?void 0:H.results)||[],F=O.filter(B=>B.severity==="error").length,q=O.filter(B=>B.severity==="warning").length;return i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center gap-3",children:[y&&i.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),x&&i.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:x}),!y&&!x&&g&&i.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((V=g.nodes)==null?void 0:V.length)||0," nodes, ",((Z=g.edges)==null?void 0:Z.length)||0," edges"]})]})}),i.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>i.jsx("button",{onClick:()=>M(B.id),style:{...yH,color:o===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),_?i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o==="canvas"&&i.jsxs(i.Fragment,{children:[i.jsx(wa,{children:i.jsx(uH,{workflowJson:g,onWorkflowChange:T,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:R,onEdgeSelect:L})}),C&&i.jsx(mH,{node:C,onChange:D,onDelete:E,templates:k,schemas:N,roleFragments:S.role||[],taskFragments:S.task||[],pgcFragments:S.pgc||[],mechanicalOpTypes:n,mechanicalOps:s}),w&&i.jsx(vH,{edge:w,nodeIds:A,onChange:$,onDelete:P})]}),o==="json"&&i.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[i.jsx("textarea",{value:f,onChange:I,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&i.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),o==="metadata"&&i.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:g?i.jsx(_H,{workflow:g}):i.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),O.length>0&&i.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[F>0&&i.jsxs("span",{style:{color:"#ef4444"},children:[F," error",F!==1?"s":""]}),q>0&&i.jsxs("span",{style:{color:"#f59e0b"},children:[q," warning",q!==1?"s":""]}),F===0&&q===0&&i.jsx("span",{style:{color:"#10b981"},children:"Valid"}),i.jsx("span",{style:{color:"var(--text-muted)"},children:O.map(B=>B.message).join(" | ")})]})]})}function _H({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],s=e.thread_ownership||{},o=Object.entries(s),a=e.entry_node_ids||[];return i.jsxs("div",{className:"space-y-4 max-w-lg",children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>i.jsxs("div",{children:[i.jsx("label",{style:r,children:l.label}),i.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),i.jsxs("div",{children:[i.jsx("label",{style:r,children:"Entry Node IDs"}),i.jsx("div",{style:t,children:a.length>0?a.join(", "):"-"})]}),o.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),o.map(([l,c])=>i.jsxs("div",{children:[i.jsx("label",{style:r,children:l}),i.jsx("div",{style:t,children:c})]},l))]})]})}function jg({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:s}){const[o,a]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!o)return;const c=d=>{l.current&&!l.current.contains(d.target)&&a(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[o]),t.length===0?null:i.jsxs("div",{ref:l,style:{position:"relative"},children:[i.jsxs("button",{onClick:()=>a(!o),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:s?"var(--text-primary)":"var(--text-muted)",background:s?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:s?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,i.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),o&&i.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>i.jsxs("button",{onClick:()=>{n(c.id),a(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&i.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function Sg({label:e,isSelected:t,onClick:r}){return i.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function wH({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:s=[],onArtifactSave:o,onCreateDcwWorkflow:a,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var ie,xe,pe;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,v]=m.useState("source"),[g,_]=m.useState(null),[x,y]=m.useState(!1),[b,j]=m.useState(null),[k,N]=m.useState(null),[S,C]=m.useState(!1),[w,A]=m.useState(null),[T,D]=m.useState(null),[$,E]=m.useState(!1),[P,R]=m.useState(null),[L,M]=m.useState(null),[I,O]=m.useState(!1),[F,q]=m.useState(null),H=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const U=t.role_prompt_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="role"?null:{roleId:U[2],version:U[3]}},[t==null?void 0:t.role_prompt_ref]),V=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const U=t.template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.template_ref]),Z=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const U=t.qa_template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const U=t.pgc_template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!H){_(null);return}y(!0),j(null),we.getRole(H.roleId,H.version).then(U=>{_(U.content)}).catch(U=>{console.error("Failed to load role:",U),j(U.message)}).finally(()=>{y(!1)})},[H]),m.useEffect(()=>{if(!V){N(null);return}C(!0),A(null),we.getTemplate(V.templateId,V.version).then(U=>{N(U.content)}).catch(U=>{console.error("Failed to load template:",U),A(U.message)}).finally(()=>{C(!1)})},[V]),m.useEffect(()=>{if(!Z){D(null);return}E(!0),R(null),we.getTemplate(Z.templateId,Z.version).then(U=>{D(U.content)}).catch(U=>{console.error("Failed to load QA template:",U),R(U.message)}).finally(()=>{E(!1)})},[Z]),m.useEffect(()=>{if(!B){M(null);return}O(!0),q(null),we.getTemplate(B.templateId,B.version).then(U=>{M(U.content)}).catch(U=>{console.error("Failed to load PGC template:",U),q(U.message)}).finally(()=>{O(!1)})},[B]);const re=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const U=t.version||t.active_version;return`doctype:${t.doc_type_id}:${U}:${f}`},[t,f]),{content:oe,loading:X,error:Q,saving:fe,isDirty:ge,updateContent:be,lastSaveResult:ye}=Ea(e,re,{onSave:U=>{o==null||o(re,U)}}),ae=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],K=m.useMemo(()=>t?ae.filter(U=>U.id==="package"?!0:U.id==="role_prompt"?!!t.role_prompt_ref:U.id==="template"?!!t.template_ref:U.id==="qa_template"?!!t.qa_template_ref:U.id==="pgc_template"?!!t.pgc_template_ref:U.id==="workflow"?!0:t.artifacts?t.artifacts[U.id]!=null:!1):[],[t]),te=c==="task"||c==="schema";m.useEffect(()=>{te||K.length>0&&!K.find(U=>U.id===f)&&p(K[0].id)},[K,f,te]);const ee=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",ke=f==="package",je=f==="schema",Te=f==="workflow",Ne=!ee&&!ke&&!je&&!Te,ne=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:s.some(U=>U.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,s]),[Se,Ve]=m.useState(!1),ct=async()=>{if(!(!(t!=null&&t.doc_type_id)||!a)){Ve(!0);try{await a(t.doc_type_id)}finally{Ve(!1)}}};if(!t&&!r)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),i.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),i.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const We=c==="task"?"Interaction":c==="schema"?"Schema":null,Pe=!te&&(f==="task_prompt"||f==="schema");return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),i.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:te?We:i.jsxs(i.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),te&&i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!te&&i.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[K.find(U=>U.id==="package")&&i.jsx(Sg,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),v("source")}}),K.find(U=>U.id==="workflow")&&i.jsx(Sg,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),v("source")}}),(()=>{const U=["role_prompt","task_prompt","template"],ve=K.filter(he=>U.includes(he.id)).map(he=>({id:he.id,label:he.id==="role_prompt"?"Role":he.id==="task_prompt"?"Task":"Template",viewOnly:he.viewOnly}));return ve.length===0?null:i.jsx(jg,{label:"Generation",items:ve,selectedId:U.includes(f)?f:null,onSelect:he=>{p(he),v("source")},isGroupActive:U.includes(f)})})(),(()=>{const U=["qa_prompt","qa_template"],ve=K.filter(he=>U.includes(he.id)).map(he=>({id:he.id,label:he.id==="qa_prompt"?"Prompt":"Template",viewOnly:he.viewOnly}));return ve.length===0?null:i.jsx(jg,{label:"QA",items:ve,selectedId:U.includes(f)?f:null,onSelect:he=>{p(he),v("source")},isGroupActive:U.includes(f)})})(),(()=>{const U=["pgc_context","pgc_template"],ve=K.filter(he=>U.includes(he.id)).map(he=>({id:he.id,label:he.id==="pgc_context"?"Context":"Template",viewOnly:he.viewOnly}));return ve.length===0?null:i.jsx(jg,{label:"PGC",items:ve,selectedId:U.includes(f)?f:null,onSelect:he=>{p(he),v("source")},isGroupActive:U.includes(f)})})(),K.find(U=>U.id==="schema")&&i.jsx(Sg,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),v("source")}})]}),!te&&Ne&&!Pe&&i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>v("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),i.jsx("button",{onClick:()=>v("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((ie=t==null?void 0:t.artifacts)==null?void 0:ie[f])&&i.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),ee&&i.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&H&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[H.roleId.replace(/_/g," ")," v",H.version]}),f==="template"&&V&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[V.templateId.replace(/_/g," ")," v",V.version]}),f==="qa_template"&&Z&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[Z.templateId.replace(/_/g," ")," v",Z.version]}),f==="pgc_template"&&B&&i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Pe&&i.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),je&&((xe=t==null?void 0:t.artifacts)==null?void 0:xe.schema)&&i.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),i.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:Te?ne?i.jsx(bH,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:o,mechanicalOpTypes:d,mechanicalOps:u}):i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8 max-w-md",children:[i.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),i.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),a&&i.jsx("button",{onClick:ct,disabled:Se,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:Se?"wait":"pointer",opacity:Se?.7:1},children:Se?"Creating...":"Create Workflow"})]})}):f==="package"?i.jsx(sH,{workspaceId:e,docType:t,roles:n,onSave:o}):f==="role_prompt"?i.jsx(rn,{content:g||"",onChange:()=>{},loading:x,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?i.jsx(rn,{content:k||"",onChange:()=>{},loading:S,saving:!1,isDirty:!1,error:w,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?i.jsx(rn,{content:T||"",onChange:()=>{},loading:$,saving:!1,isDirty:!1,error:P,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?i.jsx(rn,{content:L||"",onChange:()=>{},loading:I,saving:!1,isDirty:!1,error:F,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||je?i.jsx(rn,{content:oe,onChange:Pe?()=>{}:be,loading:X,saving:Pe?!1:fe,isDirty:Pe?!1:ge,error:Q,readOnly:Pe,placeholder:`Enter ${((pe=K.find(U=>U.id===f))==null?void 0:pe.label)||"prompt"} content...`,isJson:je}):i.jsx(nH,{workspaceId:e,artifactId:re})}),Ne&&(ye==null?void 0:ye.tier1)&&!ye.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function jH({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:s,loading:o,error:a,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=Ea(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),i.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),i.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),i.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:s,onChange:d,loading:o,saving:l,isDirty:c,error:a,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const SH=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],kg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Ng={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function kH({workspaceId:e,template:t,onArtifactSave:r}){const[n,s]=m.useState("metadata"),[o,a]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:v,error:g,saving:_,isDirty:x,updateContent:y,lastSaveResult:b}=Ea(e,f,{onSave:w=>{r==null||r(f,w)}});m.useEffect(()=>{t&&(a({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const j=m.useCallback((w,A)=>{a(T=>({...T,[w]:A})),c(!0)},[]),k=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const w=qy.dump({name:o.name||null,purpose:o.purpose||null,use_case:o.use_case||null},{lineWidth:-1});await we.writeArtifact(e,p,w),c(!1),r==null||r(p,{success:!0})}catch(w){console.error("Failed to save metadata:",w),alert(`Failed to save metadata: ${w.message}`)}finally{u(!1)}}},[e,p,o,r]),N=m.useCallback(()=>{l&&k()},[l,k]);if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),i.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const S=o.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase()),C=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:S}),i.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsxs("span",{children:["v",t.active_version]}),i.jsx("span",{children:""}),i.jsx("span",{children:"Shared Template"}),o.purpose&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:o.purpose})]})]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:C.map(w=>i.jsxs("button",{onClick:()=>s(w.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===w.id?"var(--text-primary)":"var(--text-muted)",background:n===w.id?"var(--bg-canvas)":"transparent",borderBottom:n===w.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[w.label,w.id==="metadata"&&l&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),w.id==="template"&&x&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},w.id))}),n==="metadata"&&i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"max-w-xl space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{style:Ng,children:"Template Name"}),i.jsx("input",{type:"text",value:o.name,onChange:w=>j("name",w.target.value),onBlur:N,placeholder:"e.g., Document Generator",style:kg}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),i.jsxs("div",{children:[i.jsx("label",{style:Ng,children:"Template Purpose"}),i.jsx("select",{value:o.purpose,onChange:w=>{j("purpose",w.target.value),setTimeout(()=>k(),0)},style:kg,children:SH.map(w=>i.jsx("option",{value:w.value,children:w.label},w.value))}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),i.jsxs("div",{children:[i.jsx("label",{style:Ng,children:"Use Case"}),i.jsx("textarea",{value:o.use_case,onChange:w=>j("use_case",w.target.value),onBlur:N,placeholder:"Describe when and how this template should be used...",rows:4,style:{...kg,resize:"vertical"}}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:i.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:h,onChange:y,loading:v,saving:_,isDirty:x,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ii={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function NH({workspaceId:e,schema:t,onArtifactSave:r}){var x;const[n,s]=m.useState("content"),o=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:a,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=Ea(e,o,{onSave:y=>{r==null||r(o,y)}});if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),i.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((x=t.schema_id)==null?void 0:x.replace(/_/g," "))||"Schema",v=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],_=!e;return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,i.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),i.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsxs("span",{children:["v",v]}),_&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(y=>i.jsxs("button",{onClick:()=>s(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===y.id?"var(--text-primary)":"var(--text-muted)",background:n===y.id?"var(--bg-canvas)":"transparent",borderBottom:n===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),n==="content"&&i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:a,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:_,isJson:!0})}),n==="info"&&i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"max-w-xl space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{style:ii,children:"Schema ID"}),i.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),i.jsxs("div",{children:[i.jsx("label",{style:ii,children:"Version"}),i.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:v})]}),i.jsxs("div",{children:[i.jsx("label",{style:ii,children:"Title (from JSON)"}),i.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),i.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),i.jsxs("div",{children:[i.jsx("label",{style:ii,children:"File Path"}),i.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",v,"/schema.json"]})]}),i.jsxs("div",{children:[i.jsx("label",{style:ii,children:"Artifact ID"}),i.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",v]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const CH={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},EH={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},Cg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ai={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function TH({workspaceId:e,fragment:t,onArtifactSave:r}){var O;const[n,s]=m.useState("content"),[o,a]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,v]=((O=t==null?void 0:t.fragment_id)==null?void 0:O.split(":"))||[null,null],g=t?h==="role"?`fragment:role:${v}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,_=t&&h==="role"?`fragment:role:${v}:${t.version}:meta`:null,{content:x,loading:y,error:b,saving:j,isDirty:k,updateContent:N,lastSaveResult:S}=Ea(e,g,{onSave:F=>{r==null||r(g,F)}});m.useEffect(()=>{t&&(a({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const C=m.useCallback((F,q)=>{a(H=>({...H,[F]:q})),c(!0)},[]),w=m.useCallback(async()=>{if(!(!e||!_)){u(!0);try{const F=qy.dump({name:o.name||null,intent:o.intent||null,tags:o.tags.length>0?o.tags:null},{lineWidth:-1});await we.writeArtifact(e,_,F),c(!1),r==null||r(_,{success:!0})}catch(F){console.error("Failed to save metadata:",F),alert(`Failed to save metadata: ${F.message}`)}finally{u(!1)}}},[e,_,o,r]),A=m.useCallback(()=>{l&&_&&w()},[l,_,w]),T=m.useCallback(()=>{const F=f.trim().toLowerCase();F&&!o.tags.includes(F)&&(C("tags",[...o.tags,F]),p(""))},[f,o.tags,C]),D=m.useCallback(F=>{C("tags",o.tags.filter(q=>q!==F))},[o.tags,C]),$=m.useCallback(F=>{F.key==="Enter"&&(F.preventDefault(),T())},[T]);if(!t)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),i.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const E=o.name||t.name||t.fragment_id,P=CH[h]||h,R=EH[h]||"var(--text-muted)",L=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],M=!e,I=_&&!M;return i.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[E,i.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:R,color:"#fff"},children:P})]}),i.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[i.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsxs("span",{children:["from ",t.source_doc_type]})]}),M&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),i.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:L.map(F=>i.jsxs("button",{onClick:()=>s(F.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===F.id?"var(--text-primary)":"var(--text-muted)",background:n===F.id?"var(--bg-canvas)":"transparent",borderBottom:n===F.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[F.label,F.id==="content"&&k&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),F.id==="metadata"&&l&&i.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},F.id))}),n==="content"&&i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx(rn,{content:x,onChange:N,loading:y,saving:j,isDirty:k,error:b,placeholder:"Enter prompt content...",readOnly:M})}),n==="metadata"&&i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"max-w-xl space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Kind"}),i.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:R}}),i.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:P})]}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Name"}),i.jsx("input",{type:"text",value:o.name,onChange:F=>C("name",F.target.value),onBlur:A,placeholder:"e.g., Technical Architect Role",style:Cg,disabled:!I}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Intent"}),i.jsx("textarea",{value:o.intent,onChange:F=>C("intent",F.target.value),onBlur:A,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...Cg,resize:"vertical"},disabled:!I}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Tags"}),i.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:o.tags.map(F=>i.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[F,I&&i.jsx("button",{onClick:()=>D(F),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},F))}),I&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:f,onChange:F=>p(F.target.value),onKeyDown:$,placeholder:"Add tag...",style:{...Cg,flex:1}}),i.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&i.jsxs("div",{children:[i.jsx("label",{style:ai,children:"Source"}),i.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",i.jsx("strong",{children:t.source_doc_type})]}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!I&&!t.source_doc_type&&i.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(S==null?void 0:S.tier1)&&!S.tier1.passed&&i.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:i.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const li={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ci={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function RH({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[r,n]=m.useState(null),[s,o]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){n(null),o(null);return}(async()=>{l(!0),d(null);try{const g=await we.getMechanicalOp(e.op_id);n(g);const _=t.find(x=>x.type_id===g.type);if(_)o(_);else try{const x=await we.getMechanicalOpType(g.type);o(x)}catch{}}catch(g){console.error("Failed to load mechanical op details:",g),d(g.message),n(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),i.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=r||e;return i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(s==null?void 0:s.name)||u.type}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a&&i.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&i.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!a&&i.jsxs("div",{className:"space-y-6 max-w-2xl",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:ci,children:"Operation ID"}),i.jsx("div",{style:li,className:"font-mono",children:u.op_id})]}),i.jsxs("div",{children:[i.jsx("label",{style:ci,children:"Name"}),i.jsx("div",{style:li,children:u.name})]}),u.description&&i.jsxs("div",{children:[i.jsx("label",{style:ci,children:"Description"}),i.jsx("div",{style:{...li,whiteSpace:"pre-wrap"},children:u.description})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{style:ci,children:"Type"}),i.jsx("div",{style:li,children:u.type})]}),i.jsxs("div",{children:[i.jsx("label",{style:ci,children:"Version"}),i.jsx("div",{style:li,children:u.active_version||u.version})]})]})]})]}),s&&i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),i.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("span",{style:{fontSize:16},children:[s.icon==="git-merge"&&"",s.icon==="scissors"&&"",s.icon==="check-circle"&&"",s.icon==="shuffle"&&"",s.icon==="git-branch"&&""]}),i.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:s.name}),i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:s.category})]}),i.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=s.inputs)==null?void 0:f.length)>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),s.inputs.map((v,g)=>i.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},g))]}),((p=s.outputs)==null?void 0:p.length)>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),s.outputs.map((v,g)=>i.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},g))]})]})]})]}),u.config&&i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),i.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&i.jsxs("section",{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),i.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&i.jsxs("div",{className:"flex justify-between text-xs",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),i.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&i.jsxs("div",{className:"flex justify-between text-xs",children:[i.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),i.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&i.jsxs("div",{children:[i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),i.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(v=>i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:v},v))})]})]})]}),i.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[i.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",i.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function AH(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(s=>s(n))},t)}const Nu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function $o(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function By(e){return"nodeType"in e}function Zt(e){var t,r;return e?$o(e)?e:By(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Wy(e){const{Document:t}=Zt(e);return e instanceof t}function Ta(e){return $o(e)?!1:e instanceof Zt(e).HTMLElement}function Q3(e){return e instanceof Zt(e).SVGElement}function qo(e){return e?$o(e)?e.document:By(e)?Wy(e)?e:Ta(e)||Q3(e)?e.ownerDocument:document:document:document}const Kr=Nu?m.useLayoutEffect:m.useEffect;function Hy(e){const t=m.useRef(e);return Kr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function IH(){const e=m.useRef(null),t=m.useCallback((n,s)=>{e.current=setInterval(n,s)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function da(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Kr(()=>{r.current!==e&&(r.current=e)},t),r}function Ra(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function Cc(e){const t=Hy(e),r=m.useRef(null),n=m.useCallback(s=>{s!==r.current&&(t==null||t(s,r.current)),r.current=s},[]);return[r,n]}function Xx(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Eg={};function Aa(e,t){return m.useMemo(()=>{if(t)return t;const r=Eg[e]==null?0:Eg[e]+1;return Eg[e]=r,e+"-"+r},[e,t])}function Z3(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((o,a)=>{const l=Object.entries(a);for(const[c,d]of l){const u=o[c];u!=null&&(o[c]=u+e*d)}return o},{...t})}}const vo=Z3(1),fa=Z3(-1);function PH(e){return"clientX"in e&&"clientY"in e}function Uy(e){if(!e)return!1;const{KeyboardEvent:t}=Zt(e.target);return t&&e instanceof t}function OH(e){if(!e)return!1;const{TouchEvent:t}=Zt(e.target);return t&&e instanceof t}function Qx(e){if(OH(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return PH(e)?{x:e.clientX,y:e.clientY}:null}const Ao=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Ao.Translate.toString(e),Ao.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),OS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function MH(e){return e.matches(OS)?e:e.querySelector(OS)}const DH={display:"none"};function LH(e){let{id:t,value:r}=e;return Y.createElement("div",{id:t,style:DH},r)}function zH(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function FH(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const J3=m.createContext(null);function $H(e){const t=m.useContext(J3);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function qH(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:s,event:o}=n;e.forEach(a=>{var l;return(l=a[s])==null?void 0:l.call(a,o)})},[e]),t]}const BH={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},WH={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function HH(e){let{announcements:t=WH,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=BH}=e;const{announce:o,announcement:a}=FH(),l=Aa("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),$H(m.useMemo(()=>({onDragStart(f){let{active:p}=f;o(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&o(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;o(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;o(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;o(t.onDragCancel({active:p,over:h}))}}),[o,t])),!c)return null;const u=Y.createElement(Y.Fragment,null,Y.createElement(LH,{id:n,value:s.draggable}),Y.createElement(zH,{id:l,announcement:a}));return r?so.createPortal(u,r):u}var mt;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(mt||(mt={}));function Ec(){}function Tc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function eT(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Pr=Object.freeze({x:0,y:0});function tT(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function rT(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function UH(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function MS(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function nT(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function DS(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const sT=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=DS(t,t.left,t.top),o=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=tT(DS(c),s);o.push({id:l,data:{droppableContainer:a,value:d}})}}return o.sort(rT)},VH=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=MS(t),o=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=MS(c),u=s.reduce((p,h,v)=>p+tT(d[v],h),0),f=Number((u/4).toFixed(4));o.push({id:l,data:{droppableContainer:a,value:f}})}}return o.sort(rT)};function GH(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),a=s-n,l=o-r;if(n<s&&r<o){const c=t.width*t.height,d=e.width*e.height,u=a*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const KH=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const o of n){const{id:a}=o,l=r.get(a);if(l){const c=GH(l,t);c>0&&s.push({id:a,data:{droppableContainer:o,value:c}})}}return s.sort(UH)};function YH(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function oT(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Pr}function XH(e){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return s.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...r})}}const QH=XH(1);function ZH(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function JH(e,t,r){const n=ZH(t);if(!n)return e;const{scaleX:s,scaleY:o,x:a,y:l}=n,c=e.left-a-(1-s)*parseFloat(r),d=e.top-l-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),u=s?e.width/s:e.width,f=o?e.height/o:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const eU={ignoreTransform:!1};function Bo(e,t){t===void 0&&(t=eU);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Zt(e).getComputedStyle(e);d&&(r=JH(r,d,u))}const{top:n,left:s,width:o,height:a,bottom:l,right:c}=r;return{top:n,left:s,width:o,height:a,bottom:l,right:c}}function LS(e){return Bo(e,{ignoreTransform:!0})}function tU(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function rU(e,t){return t===void 0&&(t=Zt(e).getComputedStyle(e)),t.position==="fixed"}function nU(e,t){t===void 0&&(t=Zt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?r.test(o):!1})}function Cu(e,t){const r=[];function n(s){if(t!=null&&r.length>=t||!s)return r;if(Wy(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!Ta(s)||Q3(s)||r.includes(s))return r;const o=Zt(e).getComputedStyle(s);return s!==e&&nU(s,o)&&r.push(s),rU(s,o)?r:n(s.parentNode)}return e?n(e):r}function iT(e){const[t]=Cu(e,1);return t??null}function Tg(e){return!Nu||!e?null:$o(e)?e:By(e)?Wy(e)||e===qo(e).scrollingElement?window:Ta(e)?e:null:null}function aT(e){return $o(e)?e.scrollX:e.scrollLeft}function lT(e){return $o(e)?e.scrollY:e.scrollTop}function Zx(e){return{x:aT(e),y:lT(e)}}var bt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(bt||(bt={}));function cT(e){return!Nu||!e?!1:e===document.scrollingElement}function uT(e){const t={x:0,y:0},r=cT(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,a=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:s,isLeft:o,isBottom:a,isRight:l,maxScroll:n,minScroll:t}}const sU={x:.2,y:.2};function oU(e,t,r,n,s){let{top:o,left:a,right:l,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=sU);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=uT(e),h={x:0,y:0},v={x:0,y:0},g={height:t.height*s.y,width:t.width*s.x};return!d&&o<=t.top+g.height?(h.y=bt.Backward,v.y=n*Math.abs((t.top+g.height-o)/g.height)):!u&&c>=t.bottom-g.height&&(h.y=bt.Forward,v.y=n*Math.abs((t.bottom-g.height-c)/g.height)),!p&&l>=t.right-g.width?(h.x=bt.Forward,v.x=n*Math.abs((t.right-g.width-l)/g.width)):!f&&a<=t.left+g.width&&(h.x=bt.Backward,v.x=n*Math.abs((t.left+g.width-a)/g.width)),{direction:h,speed:v}}function iU(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:a}=window;return{top:0,left:0,right:o,bottom:a,width:o,height:a}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function dT(e){return e.reduce((t,r)=>vo(t,Zx(r)),Pr)}function aU(e){return e.reduce((t,r)=>t+aT(r),0)}function lU(e){return e.reduce((t,r)=>t+lT(r),0)}function cU(e,t){if(t===void 0&&(t=Bo),!e)return;const{top:r,left:n,bottom:s,right:o}=t(e);iT(e)&&(s<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const uU=[["x",["left","right"],aU],["y",["top","bottom"],lU]];class Vy{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Cu(r),s=dT(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,a,l]of uU)for(const c of a)Object.defineProperty(this,c,{get:()=>{const d=l(n),u=s[o]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ii{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var s;(s=this.target)==null||s.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function dU(e){const{EventTarget:t}=Zt(e);return e instanceof t?e:qo(e)}function Rg(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ur;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ur||(ur={}));function zS(e){e.preventDefault()}function fU(e){e.stopPropagation()}var Me;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Me||(Me={}));const fT={start:[Me.Space,Me.Enter],cancel:[Me.Esc],end:[Me.Space,Me.Enter,Me.Tab]},pU=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Me.Right:return{...r,x:r.x+25};case Me.Left:return{...r,x:r.x-25};case Me.Down:return{...r,y:r.y+25};case Me.Up:return{...r,y:r.y-25}}};class Eu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Ii(qo(r)),this.windowListeners=new Ii(Zt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ur.Resize,this.handleCancel),this.windowListeners.add(ur.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ur.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&cU(n),r(Pr)}handleKeyDown(t){if(Uy(t)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:o=fT,coordinateGetter:a=pU,scrollBehavior:l="smooth"}=s,{code:c}=t;if(o.end.includes(c)){this.handleEnd(t);return}if(o.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=n.current,u=d?{x:d.left,y:d.top}:Pr;this.referenceCoordinates||(this.referenceCoordinates=u);const f=a(t,{active:r,context:n.current,currentCoordinates:u});if(f){const p=fa(f,u),h={x:0,y:0},{scrollableAncestors:v}=n.current;for(const g of v){const _=t.code,{isTop:x,isRight:y,isLeft:b,isBottom:j,maxScroll:k,minScroll:N}=uT(g),S=iU(g),C={x:Math.min(_===Me.Right?S.right-S.width/2:S.right,Math.max(_===Me.Right?S.left:S.left+S.width/2,f.x)),y:Math.min(_===Me.Down?S.bottom-S.height/2:S.bottom,Math.max(_===Me.Down?S.top:S.top+S.height/2,f.y))},w=_===Me.Right&&!y||_===Me.Left&&!b,A=_===Me.Down&&!j||_===Me.Up&&!x;if(w&&C.x!==f.x){const T=g.scrollLeft+p.x,D=_===Me.Right&&T<=k.x||_===Me.Left&&T>=N.x;if(D&&!p.y){g.scrollTo({left:T,behavior:l});return}D?h.x=g.scrollLeft-T:h.x=_===Me.Right?g.scrollLeft-k.x:g.scrollLeft-N.x,h.x&&g.scrollBy({left:-h.x,behavior:l});break}else if(A&&C.y!==f.y){const T=g.scrollTop+p.y,D=_===Me.Down&&T<=k.y||_===Me.Up&&T>=N.y;if(D&&!p.x){g.scrollTo({top:T,behavior:l});return}D?h.y=g.scrollTop-T:h.y=_===Me.Down?g.scrollTop-k.y:g.scrollTop-N.y,h.y&&g.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,vo(fa(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Eu.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=fT,onActivation:s}=t,{active:o}=r;const{code:a}=e.nativeEvent;if(n.start.includes(a)){const l=o.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function FS(e){return!!(e&&"distance"in e)}function $S(e){return!!(e&&"delay"in e)}class Gy{constructor(t,r,n){var s;n===void 0&&(n=dU(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:a}=o;this.props=t,this.events=r,this.document=qo(a),this.documentListeners=new Ii(this.document),this.listeners=new Ii(n),this.windowListeners=new Ii(Zt(a)),this.initialCoordinates=(s=Qx(o))!=null?s:Pr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ur.Resize,this.handleCancel),this.windowListeners.add(ur.DragStart,zS),this.windowListeners.add(ur.VisibilityChange,this.handleCancel),this.windowListeners.add(ur.ContextMenu,zS),this.documentListeners.add(ur.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if($S(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(FS(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ur.Click,fU,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ur.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:s,props:o}=this,{onMove:a,options:{activationConstraint:l}}=o;if(!s)return;const c=(r=Qx(t))!=null?r:Pr,d=fa(s,c);if(!n&&l){if(FS(l)){if(l.tolerance!=null&&Rg(d,l.tolerance))return this.handleCancel();if(Rg(d,l.distance))return this.handleStart()}if($S(l)&&Rg(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),a(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Me.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const hU={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Tu extends Gy{constructor(t){const{event:r}=t,n=qo(r.target);super(t,hU,n)}}Tu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const mU={move:{name:"mousemove"},end:{name:"mouseup"}};var Jx;(function(e){e[e.RightClick=2]="RightClick"})(Jx||(Jx={}));class gU extends Gy{constructor(t){super(t,mU,qo(t.event.target))}}gU.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Jx.RightClick?!1:(n==null||n({event:r}),!0)}}];const Ag={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class xU extends Gy{constructor(t){super(t,Ag)}static setup(){return window.addEventListener(Ag.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Ag.move.name,t)};function t(){}}}xU.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var Pi;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Pi||(Pi={}));var Rc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Rc||(Rc={}));function vU(e){let{acceleration:t,activator:r=Pi.Pointer,canScroll:n,draggingRect:s,enabled:o,interval:a=5,order:l=Rc.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=bU({delta:f,disabled:!o}),[v,g]=IH(),_=m.useRef({x:0,y:0}),x=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(r){case Pi.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Pi.DraggableRect:return s}},[r,s,c]),b=m.useRef(null),j=m.useCallback(()=>{const N=b.current;if(!N)return;const S=_.current.x*x.current.x,C=_.current.y*x.current.y;N.scrollBy(S,C)},[]),k=m.useMemo(()=>l===Rc.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!o||!d.length||!y){g();return}for(const N of k){if((n==null?void 0:n(N))===!1)continue;const S=d.indexOf(N),C=u[S];if(!C)continue;const{direction:w,speed:A}=oU(N,C,y,t,p);for(const T of["x","y"])h[T][w[T]]||(A[T]=0,w[T]=0);if(A.x>0||A.y>0){g(),b.current=N,v(j,a),_.current=A,x.current=w;return}}_.current={x:0,y:0},x.current={x:0,y:0},g()},[t,j,n,g,o,a,JSON.stringify(y),JSON.stringify(h),v,d,k,u,JSON.stringify(p)])}const yU={x:{[bt.Backward]:!1,[bt.Forward]:!1},y:{[bt.Backward]:!1,[bt.Forward]:!1}};function bU(e){let{delta:t,disabled:r}=e;const n=Xx(t);return Ra(s=>{if(r||!n||!s)return yU;const o={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[bt.Backward]:s.x[bt.Backward]||o.x===-1,[bt.Forward]:s.x[bt.Forward]||o.x===1},y:{[bt.Backward]:s.y[bt.Backward]||o.y===-1,[bt.Forward]:s.y[bt.Forward]||o.y===1}}},[r,t,n])}function _U(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Ra(s=>{var o;return t==null?null:(o=n??s)!=null?o:null},[n,t])}function wU(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:s}=n,o=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,n)}));return[...r,...o]},[]),[e,t])}var pa;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(pa||(pa={}));var ev;(function(e){e.Optimized="optimized"})(ev||(ev={}));const qS=new Map;function jU(e,t){let{dragging:r,dependencies:n,config:s}=t;const[o,a]=m.useState(null),{frequency:l,measure:c,strategy:d}=s,u=m.useRef(e),f=_(),p=da(f),h=m.useCallback(function(x){x===void 0&&(x=[]),!p.current&&a(y=>y===null?x:y.concat(x.filter(b=>!y.includes(b))))},[p]),v=m.useRef(null),g=Ra(x=>{if(f&&!r)return qS;if(!x||x===qS||u.current!==e||o!=null){const y=new Map;for(let b of e){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const j=b.node.current,k=j?new Vy(c(j),j):null;b.rect.current=k,k&&y.set(b.id,k)}return y}return x},[e,o,r,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{o&&o.length>0&&a(null)},[JSON.stringify(o)]),m.useEffect(()=>{f||typeof l!="number"||v.current!==null||(v.current=setTimeout(()=>{h(),v.current=null},l))},[l,f,h,...n]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:o!=null};function _(){switch(d){case pa.Always:return!1;case pa.BeforeDragging:return r;default:return!r}}}function pT(e,t){return Ra(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function SU(e,t){return pT(e,t)}function kU(e){let{callback:t,disabled:r}=e;const n=Hy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Ru(e){let{callback:t,disabled:r}=e;const n=Hy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function NU(e){return new Vy(Bo(e),e)}function BS(e,t,r){t===void 0&&(t=NU);const[n,s]=m.useState(null);function o(){s(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??r)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const a=kU({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){o();break}}}}),l=Ru({callback:o});return Kr(()=>{o(),e?(l==null||l.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),a==null||a.disconnect())},[e]),n}function CU(e){const t=pT(e);return oT(e,t)}const WS=[];function EU(e){const t=m.useRef(e),r=Ra(n=>e?n&&n!==WS&&e&&t.current&&e.parentNode===t.current.parentNode?n:Cu(e):WS,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function TU(e){const[t,r]=m.useState(null),n=m.useRef(e),s=m.useCallback(o=>{const a=Tg(o.target);a&&r(l=>l?(l.set(a,Zx(a)),new Map(l)):null)},[]);return m.useEffect(()=>{const o=n.current;if(e!==o){a(o);const l=e.map(c=>{const d=Tg(c);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,Zx(d)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{a(e),a(o)};function a(l){l.forEach(c=>{const d=Tg(c);d==null||d.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,a)=>vo(o,a),Pr):dT(e):Pr,[e,t])}function HS(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Pr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?fa(e,r.current):Pr}function RU(e){m.useEffect(()=>{if(!Nu)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function AU(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:s,handler:o}=n;return r[s]=a=>{o(a,t)},r},{}),[e,t])}function hT(e){return m.useMemo(()=>e?tU(e):null,[e])}const US=[];function IU(e,t){t===void 0&&(t=Bo);const[r]=e,n=hT(r?Zt(r):null),[s,o]=m.useState(US);function a(){o(()=>e.length?e.map(c=>cT(c)?n:new Vy(t(c),c)):US)}const l=Ru({callback:a});return Kr(()=>{l==null||l.disconnect(),a(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),s}function PU(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ta(t)?t:e}function OU(e){let{measure:t}=e;const[r,n]=m.useState(null),s=m.useCallback(d=>{for(const{target:u}of d)if(Ta(u)){n(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),o=Ru({callback:s}),a=m.useCallback(d=>{const u=PU(d);o==null||o.disconnect(),u&&(o==null||o.observe(u)),n(u?t(u):null)},[t,o]),[l,c]=Cc(a);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const MU=[{sensor:Tu,options:{}},{sensor:Eu,options:{}}],DU={current:{}},Ol={draggable:{measure:LS},droppable:{measure:LS,strategy:pa.WhileDragging,frequency:ev.Optimized},dragOverlay:{measure:Bo}};class Oi extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const LU={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Oi,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ec},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ol,measureDroppableContainers:Ec,windowRect:null,measuringScheduled:!1},zU={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ec,draggableNodes:new Map,over:null,measureDroppableContainers:Ec},Au=m.createContext(zU),mT=m.createContext(LU);function FU(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Oi}}}function $U(e,t){switch(t.type){case mt.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case mt.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case mt.DragEnd:case mt.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case mt.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new Oi(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case mt.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;const a=new Oi(e.droppable.containers);return a.set(r,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case mt.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new Oi(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function qU(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:s}=m.useContext(Au),o=Xx(n),a=Xx(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&o&&a!=null){if(!Uy(o)||document.activeElement===o.target)return;const l=s.get(a);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=MH(u);if(f){f.focus();break}}})}},[n,t,s,a,o]),null}function BU(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...n}),r):r}function WU(e){return m.useMemo(()=>({draggable:{...Ol.draggable,...e==null?void 0:e.draggable},droppable:{...Ol.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Ol.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function HU(e){let{activeNode:t,measure:r,initialRect:n,config:s=!0}=e;const o=m.useRef(!1),{x:a,y:l}=typeof s=="boolean"?{x:s,y:s}:s;Kr(()=>{if(!a&&!l||!t){o.current=!1;return}if(o.current||!n)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=r(d),f=oT(u,n);if(a||(f.x=0),l||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=iT(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,a,l,n,r])}const gT=m.createContext({...Pr,scaleX:1,scaleY:1});var Tn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Tn||(Tn={}));const xT=m.memo(function(t){var r,n,s,o;let{id:a,accessibility:l,autoScroll:c=!0,children:d,sensors:u=MU,collisionDetection:f=KH,measuring:p,modifiers:h,...v}=t;const g=m.useReducer($U,void 0,FU),[_,x]=g,[y,b]=qH(),[j,k]=m.useState(Tn.Uninitialized),N=j===Tn.Initialized,{draggable:{active:S,nodes:C,translate:w},droppable:{containers:A}}=_,T=S!=null?C.get(S):null,D=m.useRef({initial:null,translated:null}),$=m.useMemo(()=>{var se;return S!=null?{id:S,data:(se=T==null?void 0:T.data)!=null?se:DU,rect:D}:null},[S,T]),E=m.useRef(null),[P,R]=m.useState(null),[L,M]=m.useState(null),I=da(v,Object.values(v)),O=Aa("DndDescribedBy",a),F=m.useMemo(()=>A.getEnabled(),[A]),q=WU(p),{droppableRects:H,measureDroppableContainers:V,measuringScheduled:Z}=jU(F,{dragging:N,dependencies:[w.x,w.y],config:q.droppable}),B=_U(C,S),re=m.useMemo(()=>L?Qx(L):null,[L]),oe=G(),X=SU(B,q.draggable.measure);HU({activeNode:S!=null?C.get(S):null,config:oe.layoutShiftCompensation,initialRect:X,measure:q.draggable.measure});const Q=BS(B,q.draggable.measure,X),fe=BS(B?B.parentElement:null),ge=m.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:H,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:A,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),be=A.getNodeFor((r=ge.current.over)==null?void 0:r.id),ye=OU({measure:q.dragOverlay.measure}),ae=(n=ye.nodeRef.current)!=null?n:B,K=N?(s=ye.rect)!=null?s:Q:null,te=!!(ye.nodeRef.current&&ye.rect),ee=CU(te?null:Q),ke=hT(ae?Zt(ae):null),je=EU(N?be??B:null),Te=IU(je),Ne=BU(h,{transform:{x:w.x-ee.x,y:w.y-ee.y,scaleX:1,scaleY:1},activatorEvent:L,active:$,activeNodeRect:Q,containerNodeRect:fe,draggingNodeRect:K,over:ge.current.over,overlayNodeRect:ye.rect,scrollableAncestors:je,scrollableAncestorRects:Te,windowRect:ke}),ne=re?vo(re,w):null,Se=TU(je),Ve=HS(Se),ct=HS(Se,[Q]),We=vo(Ne,Ve),Pe=K?QH(K,Ne):null,ie=$&&Pe?f({active:$,collisionRect:Pe,droppableRects:H,droppableContainers:F,pointerCoordinates:ne}):null,xe=nT(ie,"id"),[pe,U]=m.useState(null),ve=te?Ne:vo(Ne,ct),he=YH(ve,(o=pe==null?void 0:pe.rect)!=null?o:null,Q),Fe=m.useRef(null),He=m.useCallback((se,$e)=>{let{sensor:pt,options:lr}=$e;if(E.current==null)return;const Tt=C.get(E.current);if(!Tt)return;const jt=se.nativeEvent,Bt=new pt({active:E.current,activeNode:Tt,event:jt,options:lr,context:ge,onAbort(at){if(!C.get(at))return;const{onDragAbort:de}=I.current,Ye={id:at};de==null||de(Ye),y({type:"onDragAbort",event:Ye})},onPending(at,ue,de,Ye){if(!C.get(at))return;const{onDragPending:ns}=I.current,zr={id:at,constraint:ue,initialCoordinates:de,offset:Ye};ns==null||ns(zr),y({type:"onDragPending",event:zr})},onStart(at){const ue=E.current;if(ue==null)return;const de=C.get(ue);if(!de)return;const{onDragStart:Ye}=I.current,wr={activatorEvent:jt,active:{id:ue,data:de.data,rect:D}};so.unstable_batchedUpdates(()=>{Ye==null||Ye(wr),k(Tn.Initializing),x({type:mt.DragStart,initialCoordinates:at,active:ue}),y({type:"onDragStart",event:wr}),R(Fe.current),M(jt)})},onMove(at){x({type:mt.DragMove,coordinates:at})},onEnd:Lr(mt.DragEnd),onCancel:Lr(mt.DragCancel)});Fe.current=Bt;function Lr(at){return async function(){const{active:de,collisions:Ye,over:wr,scrollAdjustedTranslate:ns}=ge.current;let zr=null;if(de&&ns){const{cancelDrop:ss}=I.current;zr={activatorEvent:jt,active:de,collisions:Ye,delta:ns,over:wr},at===mt.DragEnd&&typeof ss=="function"&&await Promise.resolve(ss(zr))&&(at=mt.DragCancel)}E.current=null,so.unstable_batchedUpdates(()=>{x({type:at}),k(Tn.Uninitialized),U(null),R(null),M(null),Fe.current=null;const ss=at===mt.DragEnd?"onDragEnd":"onDragCancel";if(zr){const Wo=I.current[ss];Wo==null||Wo(zr),y({type:ss,event:zr})}})}}},[C]),st=m.useCallback((se,$e)=>(pt,lr)=>{const Tt=pt.nativeEvent,jt=C.get(lr);if(E.current!==null||!jt||Tt.dndKit||Tt.defaultPrevented)return;const Bt={active:jt};se(pt,$e.options,Bt)===!0&&(Tt.dndKit={capturedBy:$e.sensor},E.current=lr,He(pt,$e))},[C,He]),Ge=wU(u,st);RU(u),Kr(()=>{Q&&j===Tn.Initializing&&k(Tn.Initialized)},[Q,j]),m.useEffect(()=>{const{onDragMove:se}=I.current,{active:$e,activatorEvent:pt,collisions:lr,over:Tt}=ge.current;if(!$e||!pt)return;const jt={active:$e,activatorEvent:pt,collisions:lr,delta:{x:We.x,y:We.y},over:Tt};so.unstable_batchedUpdates(()=>{se==null||se(jt),y({type:"onDragMove",event:jt})})},[We.x,We.y]),m.useEffect(()=>{const{active:se,activatorEvent:$e,collisions:pt,droppableContainers:lr,scrollAdjustedTranslate:Tt}=ge.current;if(!se||E.current==null||!$e||!Tt)return;const{onDragOver:jt}=I.current,Bt=lr.get(xe),Lr=Bt&&Bt.rect.current?{id:Bt.id,rect:Bt.rect.current,data:Bt.data,disabled:Bt.disabled}:null,at={active:se,activatorEvent:$e,collisions:pt,delta:{x:Tt.x,y:Tt.y},over:Lr};so.unstable_batchedUpdates(()=>{U(Lr),jt==null||jt(at),y({type:"onDragOver",event:at})})},[xe]),Kr(()=>{ge.current={activatorEvent:L,active:$,activeNode:B,collisionRect:Pe,collisions:ie,droppableRects:H,draggableNodes:C,draggingNode:ae,draggingNodeRect:K,droppableContainers:A,over:pe,scrollableAncestors:je,scrollAdjustedTranslate:We},D.current={initial:K,translated:Pe}},[$,B,ie,Pe,C,ae,K,H,A,pe,je,We]),vU({...oe,delta:w,draggingRect:Pe,pointerCoordinates:ne,scrollableAncestors:je,scrollableAncestorRects:Te});const z=m.useMemo(()=>({active:$,activeNode:B,activeNodeRect:Q,activatorEvent:L,collisions:ie,containerNodeRect:fe,dragOverlay:ye,draggableNodes:C,droppableContainers:A,droppableRects:H,over:pe,measureDroppableContainers:V,scrollableAncestors:je,scrollableAncestorRects:Te,measuringConfiguration:q,measuringScheduled:Z,windowRect:ke}),[$,B,Q,L,ie,fe,ye,C,A,H,pe,V,je,Te,q,Z,ke]),W=m.useMemo(()=>({activatorEvent:L,activators:Ge,active:$,activeNodeRect:Q,ariaDescribedById:{draggable:O},dispatch:x,draggableNodes:C,over:pe,measureDroppableContainers:V}),[L,Ge,$,Q,x,O,C,pe,V]);return Y.createElement(J3.Provider,{value:b},Y.createElement(Au.Provider,{value:W},Y.createElement(mT.Provider,{value:z},Y.createElement(gT.Provider,{value:he},d)),Y.createElement(qU,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Y.createElement(HH,{...l,hiddenTextDescribedById:O}));function G(){const se=(P==null?void 0:P.autoScrollEnabled)===!1,$e=typeof c=="object"?c.enabled===!1:c===!1,pt=N&&!se&&!$e;return typeof c=="object"?{...c,enabled:pt}:{enabled:pt}}}),UU=m.createContext(null),VS="button",VU="Draggable";function GU(e){let{id:t,data:r,disabled:n=!1,attributes:s}=e;const o=Aa(VU),{activators:a,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(Au),{role:h=VS,roleDescription:v="draggable",tabIndex:g=0}=s??{},_=(c==null?void 0:c.id)===t,x=m.useContext(_?gT:UU),[y,b]=Cc(),[j,k]=Cc(),N=AU(a,t),S=da(r);Kr(()=>(f.set(t,{id:t,key:o,node:y,activatorNode:j,data:S}),()=>{const w=f.get(t);w&&w.key===o&&f.delete(t)}),[f,t]);const C=m.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":n,"aria-pressed":_&&h===VS?!0:void 0,"aria-roledescription":v,"aria-describedby":u.draggable}),[n,h,g,_,v,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:C,isDragging:_,listeners:n?void 0:N,node:y,over:p,setNodeRef:b,setActivatorNodeRef:k,transform:x}}function KU(){return m.useContext(mT)}const YU="Droppable",XU={timeout:25};function QU(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:s}=e;const o=Aa(YU),{active:a,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(Au),u=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:v,updateMeasurementsFor:g,timeout:_}={...XU,...s},x=da(g??n),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(x.current)?x.current:[x.current]),h.current=null},_)},[_]),b=Ru({callback:y,disabled:v||!a}),j=m.useCallback((C,w)=>{b&&(w&&(b.unobserve(w),f.current=!1),C&&b.observe(C))},[b]),[k,N]=Cc(j),S=da(t);return m.useEffect(()=>{!b||!k.current||(b.disconnect(),f.current=!1,b.observe(k.current))},[k,b]),m.useEffect(()=>(l({type:mt.RegisterDroppable,element:{id:n,key:o,disabled:r,node:k,rect:p,data:S}}),()=>l({type:mt.UnregisterDroppable,key:o,id:n})),[n]),m.useEffect(()=>{r!==u.current.disabled&&(l({type:mt.SetDroppableDisabled,id:n,key:o,disabled:r}),u.current.disabled=r)},[n,o,r,l]),{active:a,rect:p,isOver:(c==null?void 0:c.id)===n,node:k,over:c,setNodeRef:N}}function Iu(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function ZU(e,t){return e.reduce((r,n,s)=>{const o=t.get(n);return o&&(r[s]=o),r},Array(e.length))}function ml(e){return e!==null&&e>=0}function JU(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function eV(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const vT=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const o=Iu(t,n,r),a=t[s],l=o[s];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},gl={scaleX:1,scaleY:1},yT=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:o,overIndex:a}=e;const l=(t=o[r])!=null?t:n;if(!l)return null;if(s===r){const d=o[a];return d?{x:0,y:r<a?d.top+d.height-(l.top+l.height):d.top-l.top,...gl}:null}const c=tV(o,s,r);return s>r&&s<=a?{x:0,y:-l.height-c,...gl}:s<r&&s>=a?{x:0,y:l.height+c,...gl}:{x:0,y:0,...gl}};function tV(e,t,r){const n=e[t],s=e[t-1],o=e[t+1];return n?r<t?s?n.top-(s.top+s.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):s?n.top-(s.top+s.height):0:0}const bT="Sortable",_T=Y.createContext({activeIndex:-1,containerId:bT,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:vT,disabled:{draggable:!1,droppable:!1}});function wT(e){let{children:t,id:r,items:n,strategy:s=vT,disabled:o=!1}=e;const{active:a,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=KU(),f=Aa(bT,r),p=l.rect!==null,h=m.useMemo(()=>n.map(N=>typeof N=="object"&&"id"in N?N.id:N),[n]),v=a!=null,g=a?h.indexOf(a.id):-1,_=d?h.indexOf(d.id):-1,x=m.useRef(h),y=!JU(h,x.current),b=_!==-1&&g===-1||y,j=eV(o);Kr(()=>{y&&v&&u(h)},[y,h,v,u]),m.useEffect(()=>{x.current=h},[h]);const k=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:j,disableTransforms:b,items:h,overIndex:_,useDragOverlay:p,sortedRects:ZU(h,c),strategy:s}),[g,f,j.draggable,j.droppable,b,h,_,c,p,s]);return Y.createElement(_T.Provider,{value:k},t)}const rV=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return Iu(r,n,s).indexOf(t)},nV=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:o,newIndex:a,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!n||l!==o&&s===a?!1:r?!0:a!==s&&t===c},sV={duration:200,easing:"ease"},jT="transform",oV=Ao.Transition.toString({property:jT,duration:0,easing:"linear"}),iV={roleDescription:"sortable"};function aV(e){let{disabled:t,index:r,node:n,rect:s}=e;const[o,a]=m.useState(null),l=m.useRef(r);return Kr(()=>{if(!t&&r!==l.current&&n.current){const c=s.current;if(c){const d=Bo(n.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&a(u)}}r!==l.current&&(l.current=r)},[t,r,n,s]),m.useEffect(()=>{o&&a(null)},[o]),o}function ST(e){let{animateLayoutChanges:t=nV,attributes:r,disabled:n,data:s,getNewIndex:o=rV,id:a,strategy:l,resizeObserverConfig:c,transition:d=sV}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:v,sortedRects:g,overIndex:_,useDragOverlay:x,strategy:y}=m.useContext(_T),b=lV(n,h),j=u.indexOf(a),k=m.useMemo(()=>({sortable:{containerId:f,index:j,items:u},...s}),[f,s,j,u]),N=m.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:S,node:C,isOver:w,setNodeRef:A}=QU({id:a,data:k,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...c}}),{active:T,activatorEvent:D,activeNodeRect:$,attributes:E,setNodeRef:P,listeners:R,isDragging:L,over:M,setActivatorNodeRef:I,transform:O}=GU({id:a,data:k,attributes:{...iV,...r},disabled:b.draggable}),F=AH(A,P),q=!!T,H=q&&!v&&ml(p)&&ml(_),V=!x&&L,Z=V&&H?O:null,re=H?Z??(l??y)({rects:g,activeNodeRect:$,activeIndex:p,overIndex:_,index:j}):null,oe=ml(p)&&ml(_)?o({id:a,items:u,activeIndex:p,overIndex:_}):j,X=T==null?void 0:T.id,Q=m.useRef({activeId:X,items:u,newIndex:oe,containerId:f}),fe=u!==Q.current.items,ge=t({active:T,containerId:f,isDragging:L,isSorting:q,id:a,index:j,items:u,newIndex:Q.current.newIndex,previousItems:Q.current.items,previousContainerId:Q.current.containerId,transition:d,wasDragging:Q.current.activeId!=null}),be=aV({disabled:!ge,index:j,node:C,rect:S});return m.useEffect(()=>{q&&Q.current.newIndex!==oe&&(Q.current.newIndex=oe),f!==Q.current.containerId&&(Q.current.containerId=f),u!==Q.current.items&&(Q.current.items=u)},[q,oe,f,u]),m.useEffect(()=>{if(X===Q.current.activeId)return;if(X!=null&&Q.current.activeId==null){Q.current.activeId=X;return}const ae=setTimeout(()=>{Q.current.activeId=X},50);return()=>clearTimeout(ae)},[X]),{active:T,activeIndex:p,attributes:E,data:k,rect:S,index:j,newIndex:oe,items:u,isOver:w,isSorting:q,isDragging:L,listeners:R,node:C,overIndex:_,over:M,setNodeRef:F,setActivatorNodeRef:I,setDroppableNodeRef:A,setDraggableNodeRef:P,transform:be??re,transition:ye()};function ye(){if(be||fe&&Q.current.newIndex===j)return oV;if(!(V&&!Uy(D)||!d)&&(q||ge))return Ao.Transition.toString({...d,property:jT})}}function lV(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Ac(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const cV=[Me.Down,Me.Right,Me.Up,Me.Left],kT=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:o,over:a,scrollableAncestors:l}}=t;if(cV.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];o.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=s.get(f.id);if(p)switch(e.code){case Me.Down:n.top<p.top&&c.push(f);break;case Me.Up:n.top>p.top&&c.push(f);break;case Me.Left:n.left>p.left&&c.push(f);break;case Me.Right:n.left<p.left&&c.push(f);break}});const d=VH({collisionRect:n,droppableRects:s,droppableContainers:c});let u=nT(d,"id");if(u===(a==null?void 0:a.id)&&d.length>1&&(u=d[1].id),u!=null){const f=o.get(r.id),p=o.get(u),h=p?s.get(p.id):null,v=p==null?void 0:p.node.current;if(v&&h&&f&&p){const _=Cu(v).some((N,S)=>l[S]!==N),x=NT(f,p),y=uV(f,p),b=_||!x?{x:0,y:0}:{x:y?n.width-h.width:0,y:y?n.height-h.height:0},j={x:h.left,y:h.top};return b.x&&b.y?j:fa(j,b)}}}};function NT(e,t){return!Ac(e)||!Ac(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function uV(e,t){return!Ac(e)||!Ac(t)||!NT(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const dV={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},$r={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},cr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},CT={step_id:"new_step",produces:"",scope:"",inputs:[]},fV={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function pV({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:s,onNavigateToWorkflow:o}){const[a,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:v,error:g,saving:_,updateWorkflow:x}=X3(e,p,{onSave:w=>{n==null||n(p,w)}}),y=m.useCallback(w=>{w==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(w)},[h]),b=m.useCallback(w=>{const A=w.target.value;d(A);try{const T=JSON.parse(A);f(null),x(T)}catch(T){f(T.message)}},[x]),j=m.useCallback((w,A)=>{if(!h)return;const T=[...h.steps];T[w]=A,x({...h,steps:T})},[h,x]),k=m.useCallback(w=>{if(!h)return;const A=h.steps.filter((T,D)=>D!==w);x({...h,steps:A})},[h,x]),N=m.useCallback(w=>{var T,D;if(!h)return;const A=w==="iteration"?{...fV,step_id:`new_iteration_${(((T=h.steps)==null?void 0:T.length)||0)+1}`}:{...CT,step_id:`new_step_${(((D=h.steps)==null?void 0:D.length)||0)+1}`};x({...h,steps:[...h.steps||[],A]})},[h,x]),S=m.useCallback((w,A)=>{if(!h)return;const T=Iu(h.steps,w,A);x({...h,steps:T})},[h,x]),C=m.useCallback(()=>{!s||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&s(t.workflow_id)},[s,t]);return t?i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),i.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[_&&i.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&i.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),s&&i.jsx("button",{onClick:C,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),i.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(w=>i.jsx("button",{onClick:()=>y(w.id),style:{...dV,color:a===w.id?"var(--text-primary)":"var(--text-muted)",borderBottom:a===w.id?"2px solid var(--action-primary)":"2px solid transparent"},children:w.label},w.id))}),v?i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):i.jsxs("div",{className:"flex-1 overflow-hidden",children:[a==="steps"&&i.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[i.jsx(hV,{steps:(h==null?void 0:h.steps)||[],documentTypes:r,onStepChange:j,onStepDelete:k,onReorder:S}),i.jsxs("div",{className:"flex gap-2 mt-3",children:[i.jsx("button",{onClick:()=>N("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),i.jsx("button",{onClick:()=>N("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),a==="json"&&i.jsxs("div",{className:"h-full flex flex-col p-4",children:[i.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&i.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),a==="metadata"&&i.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?i.jsx(vV,{workflow:h,onUpdateWorkflow:x,onNavigateToWorkflow:o}):i.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):i.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[i.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),i.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function hV({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const o=eT(Tc(Tu,{activationConstraint:{distance:5}}),Tc(Eu,{coordinateGetter:kT})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?i.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):i.jsx(xT,{sensors:o,collisionDetection:sT,onDragEnd:l,children:i.jsx(wT,{items:a,strategy:yT,children:e.map((c,d)=>i.jsx(mV,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function mV({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=ST({id:e.step_id}),f={transform:Ao.Transform.toString(c),transition:d,opacity:u?.5:1};return i.jsx("div",{ref:l,style:f,children:i.jsx(ET,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...o,...a}})})}function ET({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s,dragHandleProps:o,depth:a=0}){var N,S,C;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(w,A)=>{const T={...l,[w]:A};c(T),n(t,T)},h=(w,A)=>{const T={...l.iterate_over,[w]:A},D={...l,iterate_over:T};c(D),n(t,D)},v=()=>{const w=[...l.inputs||[],{doc_type:"",scope:""}],A={...l,inputs:w};c(A),n(t,A)},g=(w,A,T)=>{const D=[...l.inputs||[]];D[w]={...D[w],[A]:T};const $={...l,inputs:D};c($),n(t,$)},_=w=>{const A=(l.inputs||[]).filter((D,$)=>$!==w),T={...l,inputs:A};c(T),n(t,T)},x=m.useCallback((w,A)=>{const T=[...l.steps||[]];T[w]=A;const D={...l,steps:T};c(D),n(t,D)},[l,t,n]),y=m.useCallback(w=>{const A=(l.steps||[]).filter((D,$)=>$!==w),T={...l,steps:A};c(T),n(t,T)},[l,t,n]),b=m.useCallback(()=>{var T;const w=[...l.steps||[],{...CT,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],A={...l,steps:w};c(A),n(t,A)},[l,t,n]),j=m.useCallback((w,A)=>{const T=Iu(l.steps||[],w,A),D={...l,steps:T};c(D),n(t,D)},[l,t,n]),k={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:a*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return i.jsxs("div",{style:k,children:[i.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[o&&i.jsx("span",{...o,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:i.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[i.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),i.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),i.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),i.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),i.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),i.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),i.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),i.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),i.jsx("span",{style:{flex:1}}),i.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?i.jsx("path",{d:"M18 15l-6-6-6 6"}):i.jsx("path",{d:"M6 9l6 6 6-6"})})}),i.jsx("button",{onClick:()=>s(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&i.jsxs("div",{className:"p-3 space-y-2",children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Step ID"}),i.jsx("input",{type:"text",value:l.step_id||"",onChange:w=>p("step_id",w.target.value),style:$r})]}),f?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Doc Type"}),i.jsxs("select",{value:((N=l.iterate_over)==null?void 0:N.doc_type)||"",onChange:w=>h("doc_type",w.target.value),style:$r,children:[i.jsx("option",{value:"",children:"-- Select --"}),r.map(w=>i.jsx("option",{value:w.doc_type_id,children:w.doc_type_id},w.doc_type_id))]})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Collection Field"}),i.jsx("input",{type:"text",value:((S=l.iterate_over)==null?void 0:S.collection_field)||"",onChange:w=>h("collection_field",w.target.value),style:$r})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Entity Type"}),i.jsx("input",{type:"text",value:((C=l.iterate_over)==null?void 0:C.entity_type)||"",onChange:w=>h("entity_type",w.target.value),style:$r})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Scope"}),i.jsx("input",{type:"text",value:l.scope||"",onChange:w=>p("scope",w.target.value),style:$r})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{style:cr,children:"Nested Steps"}),i.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),i.jsx(gV,{steps:l.steps||[],documentTypes:r,onStepChange:x,onStepDelete:y,onReorder:j})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Produces"}),i.jsxs("select",{value:l.produces||"",onChange:w=>p("produces",w.target.value),style:$r,children:[i.jsx("option",{value:"",children:"-- Select document type --"}),r.map(w=>i.jsx("option",{value:w.doc_type_id,children:w.doc_type_id},w.doc_type_id))]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Scope"}),i.jsx("input",{type:"text",value:l.scope||"",onChange:w=>p("scope",w.target.value),placeholder:"project",style:$r})]}),i.jsxs("div",{children:[i.jsx("label",{style:cr,children:"Creates Entities"}),i.jsx("input",{type:"text",value:l.creates_entities||"",onChange:w=>p("creates_entities",w.target.value||void 0),placeholder:"e.g., epic",style:$r})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("label",{style:cr,children:"Inputs"}),i.jsx("button",{onClick:v,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?i.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):i.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((w,A)=>i.jsxs("div",{className:"flex gap-1 items-end",children:[i.jsxs("div",{style:{flex:1},children:[A===0&&i.jsx("label",{style:{...cr,fontSize:9},children:"Doc/Entity Type"}),i.jsxs("select",{value:w.doc_type||w.entity_type||"",onChange:T=>{const D=T.target.value;w.entity_type!==void 0?g(A,"entity_type",D):g(A,"doc_type",D)},style:{...$r,fontSize:11},children:[i.jsx("option",{value:"",children:"-- Select --"}),r.map(T=>i.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),i.jsxs("div",{style:{width:"30%"},children:[A===0&&i.jsx("label",{style:{...cr,fontSize:9},children:"Scope"}),i.jsx("input",{type:"text",value:w.scope||"",onChange:T=>g(A,"scope",T.target.value),placeholder:"scope",style:{...$r,fontSize:11}})]}),i.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[i.jsx("input",{type:"checkbox",checked:w.context||!1,onChange:T=>g(A,"context",T.target.checked||void 0)}),"ctx"]}),i.jsx("button",{onClick:()=>_(A),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},A))})]})]})]})]})}function gV({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const o=eT(Tc(Tu,{activationConstraint:{distance:5}}),Tc(Eu,{coordinateGetter:kT})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?i.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):i.jsx(xT,{sensors:o,collisionDetection:sT,onDragEnd:l,children:i.jsx(wT,{items:a,strategy:yT,children:e.map((c,d)=>i.jsx(xV,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function xV({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=ST({id:e.step_id}),f={transform:Ao.Transform.toString(c),transition:d,opacity:u?.5:1};return i.jsx("div",{ref:l,style:f,children:i.jsx(ET,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...o,...a},depth:1})})}function vV({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,s]=m.useState(""),o={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},a={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,v=e.source_version,g=e.tags||[],_=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),s(""))},x=b=>{t==null||t({...e,tags:g.filter(j=>j!==b)})},y=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return i.jsxs("div",{className:"space-y-4 max-w-lg",children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),i.jsxs("div",{children:[i.jsx("label",{style:a,children:"POW Class"}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&i.jsxs("div",{children:[i.jsx("label",{style:a,children:"Derived From"}),i.jsx("div",{style:o,children:r?i.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):i.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),v&&i.jsxs("div",{children:[i.jsx("label",{style:a,children:"Source Version"}),i.jsx("div",{style:o,children:v})]}),i.jsxs("div",{children:[i.jsx("label",{style:a,children:"Tags"}),i.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>i.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&i.jsx("button",{onClick:()=>x(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{type:"text",value:n,onChange:b=>s(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),_())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),i.jsx("button",{onClick:_,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>i.jsxs("div",{children:[i.jsx("label",{style:a,children:b.label}),i.jsx("div",{style:o,children:e[b.key]||"-"})]},b.key)),d.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,j])=>i.jsxs("div",{children:[i.jsx("label",{style:a,children:b}),i.jsxs("div",{style:o,children:["parent: ",j.parent||"none"]})]},b))]}),f.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,j])=>i.jsxs("div",{children:[i.jsx("label",{style:a,children:b}),i.jsxs("div",{style:o,children:[j.name,j.scope&&` (${j.scope})`,j.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function GS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(s=>s.status==="fail"),n=e.filter(s=>s.status==="pass");return t?i.jsx("div",{className:"flex items-center gap-2",children:r.length>0?i.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):i.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):i.jsxs("div",{className:"space-y-2",children:[r.map((s,o)=>i.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[i.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[i.jsx("span",{className:"text-red-400",children:"FAIL"}),i.jsx("span",{className:"font-mono",children:s.rule_id})]}),s.message&&i.jsx("div",{className:"mt-1 opacity-80",children:s.message}),s.artifact_id&&i.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:s.artifact_id})]},o)),n.length>0&&r.length>0&&i.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function yV(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),s=[];let o=0,a=0;for(;o<r.length||a<n.length;)if(o>=r.length)s.push({type:"added",line:n[a],lineNum:a+1}),a++;else if(a>=n.length)s.push({type:"removed",line:r[o],lineNum:o+1}),o++;else if(r[o]===n[a])s.push({type:"same",line:r[o],oldLineNum:o+1,newLineNum:a+1}),o++,a++;else{let l=n.slice(a,a+5).indexOf(r[o]),c=r.slice(o,o+5).indexOf(n[a]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)s.push({type:"added",line:n[a+d],lineNum:a+d+1});a+=l}else if(c!==-1){for(let d=0;d<c;d++)s.push({type:"removed",line:r[o+d],lineNum:o+d+1});o+=c}else s.push({type:"removed",line:r[o],lineNum:o+1}),s.push({type:"added",line:n[a],lineNum:a+1}),o++,a++}return s}function bV({diff:e}){const[t,r]=m.useState(!0),n=yV(e.old_content,e.new_content),s={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return i.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:s[e.status]||s.M,children:e.status}),i.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),i.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&i.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:i.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((o,a)=>i.jsxs("div",{className:"flex",style:{background:o.type==="added"?"rgba(34, 197, 94, 0.1)":o.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:o.type==="added"?"3px solid #22c55e":o.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[i.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:o.type==="same"?o.oldLineNum:o.lineNum||""}),i.jsx("span",{className:"select-none px-1",style:{color:o.type==="added"?"#22c55e":o.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:o.type==="added"?"+":o.type==="removed"?"-":" "}),i.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:o.line})]},a))})})]})}function _V({workspaceId:e,artifactId:t=null,onClose:r}){const[n,s]=m.useState([]),[o,a]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(a(!0),c(null),we.getDiff(e,t).then(u=>{s(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{a(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(r==null||r())};return i.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(r==null?void 0:r()),onKeyDown:d,tabIndex:0,children:i.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),i.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o?i.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?i.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?i.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((u,f)=>i.jsx(bV,{diff:u},u.artifact_id||f))}),i.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function wV(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,s,o]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:s,kind:o,displayName:a,kindLabel:l,display:`${a} - ${l}`}}function jV(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=wV(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function SV({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:s=[],modifiedFiles:o=[]}){const[a,l]=m.useState(""),[c,d]=m.useState(!1),u=jV(s),f=s.length,p=v=>{v.preventDefault(),a.trim()&&!n&&t(a.trim())},h=v=>{v.key==="Escape"&&!n&&r()};return i.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:v=>v.target===v.currentTarget&&!n&&r(),onKeyDown:h,children:[i.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&i.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),i.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(v=>i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:v.label}),i.jsx("div",{className:"space-y-1",children:v.items.map((g,_)=>i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),i.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),i.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),i.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},_))})]},v.scope))}),i.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),i.jsxs("form",{onSubmit:p,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),i.jsx("textarea",{value:a,onChange:v=>l(v.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),i.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:!a.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:a.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:a.trim()&&!n?"#000":"var(--text-muted)",cursor:a.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&i.jsx(_V,{workspaceId:e,onClose:()=>d(!1)})]})}function kV(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,s,o]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:a,kind:o,kindLabel:l,version:s,display:`${a} - ${l}`}}function NV({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:s,onClose:o,onRefresh:a}){var w,A;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,v]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,_=(t==null?void 0:t.modified_artifacts)??[],x=((w=t==null?void 0:t.tier1)==null?void 0:w.passed)??!0,y=((A=t==null?void 0:t.tier1)==null?void 0:A.results)??[],b=(t==null?void 0:t.branch)??"",j=t!=null&&t.expires_at?new Date(t.expires_at):null,k=async T=>{u(!0),v(null);try{const D=await we.commit(e,T);c(!1),n==null||n(D),a==null||a()}catch(D){v(D.message)}finally{u(!1)}},N=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await we.discard(e),s==null||s(),a==null||a()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},S=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await we.closeWorkspace(e),o==null||o()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},C=T=>{if(!T)return null;const $=T-new Date;if($<=0)return"Expired";const E=Math.floor($/(1e3*60*60)),P=Math.floor($%(1e3*60*60)/(1e3*60));return E>0?`${E}h ${P}m remaining`:`${P}m remaining`};return i.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:i.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?i.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),i.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),j&&i.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:C(j)})]}),i.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),i.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),_.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",_.length,")"]}),i.jsx("div",{className:"space-y-1",children:_.map(T=>{const D=kV(T);return i.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[i.jsx("span",{style:{color:"var(--text-primary)"},children:D.displayName||T}),D.kindLabel&&i.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",D.kindLabel]})]},T)})})]})]}),i.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),i.jsx(GS,{results:y,compact:!0})]}),y.length>0&&!x&&i.jsx("div",{className:"mt-3",children:i.jsx(GS,{results:y})})]})]}),i.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[i.jsx("button",{onClick:()=>c(!0),disabled:!g||!x||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&x?"var(--action-success)":"var(--border-panel)",color:g&&x?"#000":"var(--text-muted)",cursor:g&&x&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!x&&g&&i.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&i.jsx("button",{onClick:N,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&i.jsx("button",{onClick:S,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&i.jsx(SV,{workspaceId:e,onCommit:k,onCancel:()=>{c(!1),v(null)},loading:d,modifiedArtifacts:_,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&i.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function CV(){const{isAdmin:e,loading:t}=Ms(),[r,n]=m.useState(null),[s,o]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[v,g]=m.useState(null),[_,x]=m.useState(null),[y,b]=m.useState(null),[j,k]=m.useState(null),[N,S]=m.useState(!1),{workspaceId:C,loading:w,error:A,reinitialize:T}=u9(),{state:D,loading:$,refresh:E}=d9(C),{documentTypes:P,loading:R,refresh:L}=f9(),{roles:M,loading:I,refresh:O}=p9(),{templates:F,loading:q,refresh:H}=V3(),{workflows:V,loading:Z,refresh:B}=JW(),{fragments:re,loading:oe,kindOptions:X,refresh:Q}=K3(),{schemas:fe,loading:ge,refresh:be}=G3(),[ye,ae]=m.useState([]),[K,te]=m.useState([]),[ee,ke]=m.useState(!1),[je,Te]=m.useState(null),Ne=m.useCallback(async()=>{ke(!0);try{const[ue,de]=await Promise.all([we.getMechanicalOpTypes(),we.getMechanicalOps()]);ae(ue.types||[]),te(de.operations||[])}catch(ue){console.error("Failed to load mechanical ops:",ue)}finally{ke(!1)}},[]);m.useEffect(()=>{Ne()},[Ne]);const ne=m.useCallback(async(ue,de=null,Ye="docworkflow")=>{if(n(ue),d(null),f(null),h(null),o(null),g(null),x(null),Te(null),b(de),k(Ye),!!ue){l(!0);try{const wr=await we.getDocumentType(ue.doc_type_id);o(wr)}catch(wr){console.error("Failed to load doc type details:",wr),o(ue)}finally{l(!1)}}},[]),Se=m.useCallback(ue=>{ne(ue,"task_prompt","task")},[ne]),Ve=m.useCallback(ue=>{ne(ue,"schema","schema")},[ne]),ct=m.useCallback(ue=>{d(ue),n(null),o(null),f(null),h(null),g(null),x(null),Te(null)},[]),We=m.useCallback(ue=>{f(ue),n(null),o(null),d(null),h(null),g(null),x(null),Te(null)},[]),Pe=m.useCallback(ue=>{h(ue),n(null),o(null),d(null),f(null),g(null),x(null),Te(null)},[]),ie=m.useCallback(ue=>{g(ue),n(null),o(null),d(null),f(null),h(null),x(null),Te(null)},[]),xe=m.useCallback(ue=>{x(ue),n(null),o(null),d(null),f(null),h(null),g(null),Te(null)},[]),pe=m.useCallback(ue=>{Te(ue),n(null),o(null),d(null),f(null),h(null),g(null),x(null)},[]),U=m.useCallback(ue=>{const de=V.find(Ye=>Ye.workflow_id===ue);de&&Pe(de)},[V,Pe]),ve=m.useCallback((ue,de)=>{E()},[E]),he=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),Fe=m.useCallback(()=>{n(null),o(null),d(null),f(null),h(null),g(null),x(null),Te(null)},[]),He=m.useCallback(async ue=>{if(C)try{const de=await we.createOrchestrationWorkflow(C,ue);await B(),E(),h({workflow_id:de.workflow_id,active_version:de.version,name:ue.name||de.workflow_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())}),n(null),o(null),d(null),f(null)}catch(de){console.error("Failed to create workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[C,B,E]),st=m.useCallback(async ue=>{if(C)try{await we.deleteOrchestrationWorkflow(C,ue),await B(),E(),h(null)}catch(de){console.error("Failed to delete workflow:",de),alert(`Failed to delete workflow: ${de.message}`)}},[C,B,E]),Ge=m.useCallback(async ue=>{if(C)try{const de=await we.createDocumentType(C,ue);await L(),E(),ne({doc_type_id:de.doc_type_id,display_name:ue.display_name||de.doc_type_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase()),active_version:de.version})}catch(de){console.error("Failed to create document type:",de),alert(`Failed to create document type: ${de.message}`)}},[C,L,E,ne]);m.useCallback(async ue=>{if(C)try{await we.deleteDocumentType(C,ue),await L(),E(),n(null),o(null)}catch(de){console.error("Failed to delete document type:",de),alert(`Failed to delete document type: ${de.message}`)}},[C,L,E]);const z=m.useCallback(async ue=>{if(C)try{await we.createDcwWorkflow(C,{doc_type_id:ue}),await B(),E()}catch(de){console.error("Failed to create DCW workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[C,B,E]),W=m.useCallback(async ue=>{if(C)try{const de=await we.createRolePrompt(C,ue);await Q(),await O(),E(),ie({fragment_id:`role:${de.role_id}`,kind:"role",version:de.version,name:ue.name||de.role_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create role prompt:",de),alert(`Failed to create role prompt: ${de.message}`)}},[C,Q,O,E,ie]),G=m.useCallback(async ue=>{if(C)try{const de=await we.createTemplate(C,ue);await H(),E(),We({template_id:de.template_id,active_version:de.version,name:ue.name||de.template_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create template:",de),alert(`Failed to create template: ${de.message}`)}},[C,H,E,We]),se=m.useCallback(async ue=>{if(C)try{const de=await we.createStandaloneSchema(C,ue);await be(),E(),xe({schema_id:de.schema_id,active_version:de.version,title:ue.title||de.schema_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create schema:",de),alert(`Failed to create schema: ${de.message}`)}},[C,be,E,xe]),$e=m.useCallback(()=>{T(),n(null),o(null),d(null),f(null),h(null),g(null),x(null),Te(null)},[T]),pt=m.useCallback(async()=>{try{await we.invalidateCache(),await Promise.all([L(),O(),H(),B(),Q(),be(),Ne(),E()])}catch(ue){console.error("Failed to reload config:",ue),alert(`Failed to reload config: ${ue.message}`)}},[L,O,H,B,Q,be,Ne,E]);if(t)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),i.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(w)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),i.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(A)return i.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),i.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:A}),i.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const lr=c&&!r&&!u&&!p&&!v&&!_&&!je,Tt=u&&!r&&!c&&!p&&!v&&!_&&!je,jt=p&&!r&&!c&&!u&&!v&&!_&&!je,Bt=v&&!r&&!c&&!u&&!p&&!_&&!je,Lr=_&&!r&&!c&&!u&&!p&&!v&&!je,at=je&&!r&&!c&&!u&&!p&&!v&&!_;return i.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{window.location.href="/"},title:"Return to Home"}),i.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:pt,className:"flex items-center gap-1 px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{background:"var(--bg-panel)",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:11},title:"Reload config from disk (invalidate cache)",children:[i.jsx("span",{style:{fontSize:12},children:""}),i.jsx("span",{children:"Reload"})]}),i.jsxs("button",{onClick:()=>S(!N),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:N?"var(--action-primary)":"var(--bg-panel)",color:N?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[i.jsx("span",{style:{fontSize:14},children:""}),i.jsx("span",{children:"Building Blocks"})]})]})]}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx(eH,{documentTypes:P,roles:M,templates:F,workflows:V,promptFragments:re,promptFragmentKindOptions:X,schemas:fe,loading:R,rolesLoading:I,templatesLoading:q,workflowsLoading:Z,promptFragmentsLoading:oe,schemasLoading:ge,selectedDocType:r,docTypeSource:j,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:v,selectedSchema:_,onSelectDocType:ne,onSelectRole:ct,onSelectTemplate:We,onSelectWorkflow:Pe,onSelectFragment:ie,onSelectStandaloneSchema:xe,onCreateWorkflow:He,onCreateDocType:Ge,onCreateFragment:W,onCreateTemplate:G,onCreateSchema:se,onSelectTask:Se,onSelectSchema:Ve,workspaceState:D}),lr?i.jsx(jH,{workspaceId:C,role:c,onArtifactSave:ve}):Tt?i.jsx(kH,{workspaceId:C,template:u,onArtifactSave:ve}):Bt?i.jsx(TH,{workspaceId:C,fragment:v,onArtifactSave:ve}):jt?i.jsx(pV,{workspaceId:C,workflow:p,documentTypes:P,onArtifactSave:ve,onDelete:st,onNavigateToWorkflow:U}):Lr?i.jsx(NH,{workspaceId:C,schema:_,onArtifactSave:ve}):at?i.jsx(RH,{mechanicalOp:je,mechanicalOpTypes:ye}):i.jsx(wH,{workspaceId:C,docType:s,loading:a,roles:M,workflows:V,onArtifactSave:ve,onCreateDcwWorkflow:z,initialTab:y,docTypeSource:j,mechanicalOpTypes:ye,mechanicalOps:K}),i.jsx(NV,{workspaceId:C,state:D,loading:$,onCommit:he,onDiscard:Fe,onClose:$e,onRefresh:E})]}),i.jsx(rH,{isOpen:N,onClose:()=>S(!1),promptFragments:re,promptFragmentKindOptions:X,templates:F,schemas:fe,documentTypes:P,promptFragmentsLoading:oe,templatesLoading:q,schemasLoading:ge,selectedFragment:v,selectedTemplate:u,selectedSchema:_,selectedMechanicalOp:je,onSelectFragment:ie,onSelectTemplate:We,onSelectSchema:Ve,onSelectStandaloneSchema:xe,onCreateFragment:W,onCreateTemplate:G,onCreateSchema:se,mechanicalOpTypes:ye,mechanicalOps:K,mechanicalOpsLoading:ee,onSelectMechanicalOp:pe})]})}function EV({onSelectExecution:e}){const[t,r]=m.useState([]),[n,s]=m.useState([]),[o,a]=m.useState({}),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState("all"),[h,v]=m.useState("all"),[g,_]=m.useState("all"),[x,y]=m.useState(""),[b,j]=m.useState("startedAt"),[k,N]=m.useState("desc");m.useEffect(()=>{S()},[]);async function S(){var R;c(!0),u(null);try{const[L,M,I]=await Promise.allSettled([ze.getExecutions(),ze.getDocumentWorkflowExecutions(),ze.getProjects()]);if(L.status==="fulfilled"&&r(L.value.executions||[]),M.status==="fulfilled"&&s(M.value||[]),I.status==="fulfilled"){const O=((R=I.value)==null?void 0:R.projects)||I.value||[],F={};for(const q of Array.isArray(O)?O:[]){const H=q.project_id||q.projectId;q.id&&H&&(F[q.id]=H)}a(F)}}catch(L){u(L.message)}finally{c(!1)}}const C=m.useMemo(()=>[...t.map(R=>({id:R.execution_id,type:"workflow",workflowId:R.workflow_id,projectId:R.project_id,projectCode:o[R.project_id]||"--",documentType:R.document_type||R.workflow_id||"--",status:R.status,startedAt:R.started_at,label:R.workflow_id})),...n.map(R=>({id:R.execution_id,type:"document",workflowId:R.workflow_id,projectId:R.project_id,projectCode:o[R.project_id]||"--",documentType:R.document_type||R.workflow_id||"--",status:R.status,startedAt:R.created_at||R.updated_at,label:R.document_type||R.workflow_id}))],[t,n,o]),w=m.useMemo(()=>[...new Set(C.map(R=>R.documentType).filter(Boolean).filter(R=>R!=="--"))].sort(),[C]),A=m.useMemo(()=>[...new Set(C.map(R=>{var L;return(L=R.status)==null?void 0:L.toLowerCase()}).filter(Boolean))],[C]),T=m.useMemo(()=>{const R=x.toLowerCase().trim();return C.filter(L=>{var M,I,O;if(f!=="all"&&((M=L.status)==null?void 0:M.toLowerCase())!==f||h!=="all"&&L.type!==h||g!=="all"&&L.documentType!==g)return!1;if(R){const F=(I=L.id)==null?void 0:I.toLowerCase().includes(R),q=(O=L.projectCode)==null?void 0:O.toLowerCase().includes(R);if(!F&&!q)return!1}return!0})},[C,f,h,g,x]),D=m.useMemo(()=>{const R=[...T];return R.sort((L,M)=>{let I=L[b],O=M[b];if(I==null&&O==null)return 0;if(I==null)return 1;if(O==null)return-1;if(b==="startedAt"&&(I=new Date(I).getTime(),O=new Date(O).getTime()),typeof I=="string"&&typeof O=="string"){const q=I.localeCompare(O);return k==="asc"?q:-q}const F=I<O?-1:I>O?1:0;return k==="asc"?F:-F}),R},[T,b,k]);function $(R){b===R?N(L=>L==="asc"?"desc":"asc"):(j(R),N("asc"))}function E({columnKey:R}){return b!==R?null:i.jsx("span",{className:"ml-1",children:k==="asc"?"":""})}if(l)return i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading executions..."})});const P=[{key:"id",label:"Execution ID",minWidth:"200px"},{key:"projectCode",label:"Project"},{key:"type",label:"Source"},{key:"documentType",label:"Document Type"},{key:"status",label:"Status"},{key:"startedAt",label:"Started"}];return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("div",{className:"flex items-center gap-4 p-4 border-b flex-shrink-0 flex-wrap",style:{borderColor:"var(--border-panel)"},children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("input",{type:"text",value:x,onChange:R=>y(R.target.value),placeholder:"Search by ID or project...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)",width:"200px"}})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status:"}),i.jsxs("select",{value:f,onChange:R=>p(R.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"all",children:"All"}),A.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Source:"}),i.jsxs("select",{value:h,onChange:R=>v(R.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"all",children:"All"}),i.jsx("option",{value:"workflow",children:"Workflows"}),i.jsx("option",{value:"document",children:"Documents"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Type:"}),i.jsxs("select",{value:g,onChange:R=>_(R.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[i.jsx("option",{value:"all",children:"All"}),w.map(R=>i.jsx("option",{value:R,children:R},R))]})]}),i.jsx("button",{onClick:S,className:"text-xs px-3 py-1 rounded hover:opacity-80 transition-opacity ml-auto",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Refresh"}),i.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[D.length," execution",D.length!==1?"s":""]})]}),d&&i.jsx("div",{className:"p-3 m-4 rounded text-sm",style:{background:"var(--bg-error, #fecaca)",color:"#991b1b"},children:d}),i.jsx("div",{className:"flex-1 overflow-auto",children:i.jsxs("table",{className:"w-full text-sm",style:{color:"var(--text-primary)"},children:[i.jsx("thead",{children:i.jsx("tr",{className:"border-b",style:{borderColor:"var(--border-panel)"},children:P.map(R=>i.jsxs("th",{onClick:()=>$(R.key),className:"text-left p-3 font-medium text-xs cursor-pointer hover:opacity-80 select-none",style:{color:"var(--text-muted)",minWidth:R.minWidth||void 0},children:[R.label,i.jsx(E,{columnKey:R.key})]},R.key))})}),i.jsxs("tbody",{children:[D.map(R=>i.jsxs("tr",{onClick:()=>e(R.id),className:"border-b cursor-pointer hover:bg-white/5 transition-colors",style:{borderColor:"var(--border-panel)"},children:[i.jsx("td",{className:"p-3 font-mono text-xs",style:{minWidth:"200px"},children:R.id}),i.jsx("td",{className:"p-3 font-mono text-xs",children:R.projectCode}),i.jsx("td",{className:"p-3",children:i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:R.type==="workflow"?"var(--accent-primary, #3b82f6)":"var(--accent-secondary, #8b5cf6)",color:"white",opacity:.8},children:R.type})}),i.jsx("td",{className:"p-3 text-xs",children:R.documentType}),i.jsx("td",{className:"p-3",children:i.jsx(TV,{status:R.status})}),i.jsx("td",{className:"p-3 text-xs",style:{color:"var(--text-muted)"},children:R.startedAt?RV(R.startedAt):"-"})]},R.id)),D.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:P.length,className:"p-8 text-center",style:{color:"var(--text-muted)"},children:"No executions found."})})]})]})})]})}function TV({status:e}){const t=(e||"").toLowerCase();let r="var(--text-muted)";return t.includes("complete")||t==="done"?r="var(--state-complete, #10b981)":t.includes("running")||t.includes("active")||t.includes("progress")?r="var(--state-active, #f59e0b)":t.includes("fail")||t.includes("error")?r="var(--state-error, #ef4444)":t.includes("wait")||t.includes("pending")?r="var(--state-pending, #6b7280)":t.includes("cancel")&&(r="var(--text-muted)"),i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:r,color:"white"},children:e||"unknown"})}function RV(e){try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric"})+" "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return e}}function AV({executionId:e,onBack:t}){const[r,n]=m.useState(null),[s,o]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState("overview");m.useEffect(()=>{p()},[e]);async function p(){d(!0);try{const[v,g,_,x]=await Promise.allSettled([ze.getExecution(e),ze.getDocumentWorkflowExecution(e),ze.getExecutionTranscript(e),ze.getExecutionQACoverage(e)]);if(g.status==="fulfilled"&&g.value){const y=g.value;n({execution_id:y.execution_id,workflow_id:y.workflow_id,project_id:y.project_id,status:y.status,current_step_id:y.current_node_id,document_type:y.document_type,started_at:y.created_at,completed_at:y.updated_at,produced_documents:y.produced_documents})}else v.status==="fulfilled"&&v.value&&n(v.value);_.status==="fulfilled"&&o(_.value),x.status==="fulfilled"&&l(x.value)}catch(v){console.error("Failed to load execution detail:",v)}finally{d(!1)}}if(c)return i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading execution..."})});const h=[{id:"overview",label:"Overview"},{id:"transcript",label:`Transcript${s?` (${s.total_runs||0})`:""}`},{id:"qa",label:"QA Coverage"}];return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("div",{className:"flex items-center gap-3 p-4 border-b flex-shrink-0",style:{borderColor:"var(--border-panel)"},children:[i.jsx("button",{onClick:t,className:"text-xs px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Back"}),i.jsx("span",{className:"font-mono text-sm",style:{color:"var(--text-primary)"},children:e}),(r==null?void 0:r.status)&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:TT(r.status),color:"white"},children:r.status})]}),i.jsx("div",{className:"flex border-b px-4 flex-shrink-0",style:{borderColor:"var(--border-panel)"},children:h.map(v=>i.jsxs("button",{onClick:()=>f(v.id),className:"px-3 py-2 text-xs transition-colors relative",style:{color:u===v.id?"var(--text-primary)":"var(--text-muted)",fontWeight:u===v.id?600:400},children:[v.label,u===v.id&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-primary)"}})]},v.id))}),i.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[u==="overview"&&i.jsx(IV,{execution:r,transcript:s}),u==="transcript"&&i.jsx(PV,{transcript:s}),u==="qa"&&i.jsx(OV,{qaCoverage:a})]})]})}function IV({execution:e,transcript:t}){var r;return e?i.jsxs("div",{className:"space-y-4 max-w-2xl",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(Dt,{label:"Execution ID",value:e.execution_id,mono:!0}),i.jsx(Dt,{label:"Workflow",value:e.workflow_id}),i.jsx(Dt,{label:"Project",value:e.project_id}),i.jsx(Dt,{label:"Status",value:e.status}),i.jsx(Dt,{label:"Started",value:YS(e.started_at)}),i.jsx(Dt,{label:"Completed",value:YS(e.completed_at)}),i.jsx(Dt,{label:"Current Step",value:e.current_step_id||"-"}),i.jsx(Dt,{label:"Completed Steps",value:((r=e.completed_steps)==null?void 0:r.length)||0})]}),t&&i.jsxs("div",{className:"mt-6 p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("h3",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:"Cost Summary"}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsx(Dt,{label:"Total Runs",value:t.total_runs||0}),i.jsx(Dt,{label:"Total Tokens",value:(t.total_tokens||0).toLocaleString()}),i.jsx(Dt,{label:"Total Cost",value:`$${(t.total_cost||0).toFixed(4)}`})]})]})]}):i.jsx("p",{style:{color:"var(--text-muted)"},children:"No execution data available."})}function PV({transcript:e}){var s;const[t,r]=m.useState({});if(!e||!((s=e.transcript)!=null&&s.length))return i.jsx("p",{style:{color:"var(--text-muted)"},children:"No transcript data available."});const n=o=>{r(a=>({...a,[o]:!a[o]}))};return i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"flex items-center gap-4 mb-4",children:i.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[e.total_runs," run",e.total_runs!==1?"s":""," |"," ",(e.total_tokens||0).toLocaleString()," tokens |"," ","$",(e.total_cost||0).toFixed(4)]})}),e.transcript.map((o,a)=>{var l,c,d,u,f;return i.jsxs("div",{className:"rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsxs("button",{onClick:()=>n(a),className:"w-full text-left p-3 hover:opacity-80 transition-opacity",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{style:{color:"var(--text-muted)",fontSize:"10px"},children:t[a]?"":""}),i.jsxs("span",{className:"font-mono font-medium",style:{color:"var(--text-primary)"},children:["#",o.run_number]}),i.jsx("span",{style:{color:"var(--text-muted)"},children:o.role}),o.node_id&&i.jsx("span",{className:"font-mono",style:{color:"var(--text-muted)"},children:o.node_id}),o.task_ref&&i.jsx("span",{className:"font-mono",style:{color:"var(--text-muted)",opacity:.7},children:o.task_ref}),i.jsx("span",{className:"ml-auto",style:{color:"var(--text-muted)"},children:o.model})]}),i.jsxs("div",{className:"flex items-center gap-4",style:{color:"var(--text-muted)"},children:[i.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:TT(o.status),color:"white"},children:o.status}),o.duration&&i.jsx("span",{children:o.duration}),i.jsxs("span",{children:[(typeof o.tokens=="number"?o.tokens:((l=o.tokens)==null?void 0:l.total)||0).toLocaleString()," tokens"]}),i.jsxs("span",{children:["$",(o.cost||0).toFixed(4)]})]})]}),t[a]&&i.jsxs("div",{className:"border-t px-3 pb-3",style:{borderColor:"var(--border-panel)"},children:[((c=o.inputs)==null?void 0:c.length)>0&&i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:["Inputs (",o.inputs.length,")"]}),o.inputs.map((p,h)=>i.jsx(KS,{label:p.kind,content:p.content,size:p.size},h))]}),((d=o.outputs)==null?void 0:d.length)>0&&i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:["Outputs (",o.outputs.length,")"]}),o.outputs.map((p,h)=>i.jsx(KS,{label:p.kind,content:p.content,size:p.size,parseStatus:p.parse_status,validationStatus:p.validation_status},h))]}),!((u=o.inputs)!=null&&u.length)&&!((f=o.outputs)!=null&&f.length)&&i.jsx("p",{className:"mt-3",style:{color:"var(--text-muted)"},children:"No input/output content recorded."})]})]},a)})]})}function KS({label:e,content:t,size:r,parseStatus:n,validationStatus:s}){const[o,a]=m.useState(!1),l=t&&t.length>0,c=l&&t.length>500;return i.jsxs("div",{className:"mb-2 rounded",style:{border:"1px solid var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5",style:{background:"var(--bg-canvas)"},children:[i.jsx("span",{className:"font-mono font-medium text-xs",style:{color:"var(--accent-primary)"},children:e||"content"}),r>0&&i.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:r>1024?`${(r/1024).toFixed(1)} KB`:`${r} B`}),n&&i.jsx("span",{className:"text-xs px-1 rounded",style:{background:n==="ok"?"var(--state-complete, #10b981)":"var(--state-error, #ef4444)",color:"white"},children:n}),s&&i.jsx("span",{className:"text-xs px-1 rounded",style:{background:s==="valid"?"var(--state-complete, #10b981)":"var(--state-error, #ef4444)",color:"white"},children:s}),c&&i.jsx("button",{onClick:()=>a(!o),className:"ml-auto text-xs hover:opacity-80",style:{color:"var(--accent-primary)"},children:o?"Expand":"Collapse"})]}),l&&i.jsx("pre",{className:"p-2 text-xs overflow-x-auto",style:{color:"var(--text-primary)",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:o?"200px":"none",overflow:o?"hidden":"visible",borderTop:"1px solid var(--border-panel)"},children:t}),!l&&i.jsx("p",{className:"px-2 py-1 text-xs",style:{color:"var(--text-muted)"},children:"(empty)"})]})}function OV({qaCoverage:e}){if(!e)return i.jsx("p",{style:{color:"var(--text-muted)"},children:"No QA coverage data available."});const t=e.summary||{},r=e.qa_nodes||[];return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[i.jsx(Dt,{label:"Passed",value:t.passed||0}),i.jsx(Dt,{label:"Failed",value:t.failed||0}),i.jsx(Dt,{label:"Errors",value:t.errors||0}),i.jsx(Dt,{label:"Warnings",value:t.warnings||0})]}),r.length>0&&i.jsxs("div",{className:"space-y-2 mt-4",children:[i.jsx("h3",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"QA Nodes"}),r.map((n,s)=>{var o;return i.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"font-mono font-medium mb-1",style:{color:"var(--text-primary)"},children:n.node_id||`Node ${s+1}`}),((o=n.findings)==null?void 0:o.length)>0&&i.jsx("ul",{className:"list-disc list-inside",style:{color:"var(--text-muted)"},children:n.findings.map((a,l)=>i.jsx("li",{children:typeof a=="string"?a:JSON.stringify(a)},l))})]},s)})]})]})}function Dt({label:e,value:t,mono:r}){return i.jsxs("div",{children:[i.jsx("div",{className:"text-xs mb-0.5",style:{color:"var(--text-muted)"},children:e}),i.jsx("div",{className:`text-sm ${r?"font-mono":""}`,style:{color:"var(--text-primary)"},children:t||"-"})]})}function TT(e){const t=(e||"").toLowerCase();return t.includes("complete")||t==="done"||t==="success"?"var(--state-complete, #10b981)":t.includes("running")||t.includes("active")||t.includes("progress")?"var(--state-active, #f59e0b)":t.includes("fail")||t.includes("error")?"var(--state-error, #ef4444)":"var(--state-pending, #6b7280)"}function YS(e){if(!e)return"-";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})+" "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return e}}const MV="/api/v1";function DV(){const[e,t]=m.useState(null),[r,n]=m.useState(!0),[s,o]=m.useState(null),[a,l]=m.useState(7);m.useEffect(()=>{c()},[a]);async function c(){n(!0),o(null);try{const f=await fetch(`${MV}/telemetry/costs?days=${a}`,{credentials:"same-origin"});if(!f.ok)throw new Error(`HTTP ${f.status}`);const p=await f.json();t(p)}catch(f){o(f.message)}finally{n(!1)}}if(r)return i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading cost data..."})});if(s)return i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"p-3 rounded text-sm",style:{background:"#fecaca",color:"#991b1b"},children:["Failed to load cost data: ",s]})});const d=(e==null?void 0:e.summary)||{},u=(e==null?void 0:e.daily_data)||[];return i.jsxs("div",{className:"h-full overflow-auto p-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:"Period:"}),[7,14,30].map(f=>i.jsxs("button",{onClick:()=>l(f),className:"text-xs px-3 py-1.5 rounded transition-opacity",style:{background:a===f?"var(--accent-primary)":"transparent",color:a===f?"white":"var(--text-muted)",border:a===f?"none":"1px solid var(--border-panel)"},children:[f," days"]},f)),i.jsx("button",{onClick:c,className:"text-xs px-3 py-1 rounded hover:opacity-80 transition-opacity ml-auto",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Refresh"})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[i.jsx(xl,{label:"Total Cost",value:`$${(d.total_cost||0).toFixed(2)}`}),i.jsx(xl,{label:"Total Tokens",value:(d.total_tokens||0).toLocaleString()}),i.jsx(xl,{label:"Total Calls",value:d.total_calls||0}),i.jsx(xl,{label:"Avg Cost/Day",value:`$${(d.avg_cost_per_day||0).toFixed(2)}`})]}),i.jsx("div",{className:"rounded",style:{border:"1px solid var(--border-panel)"},children:i.jsxs("table",{className:"w-full text-sm",style:{color:"var(--text-primary)"},children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[i.jsx("th",{className:"text-left p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Date"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Cost"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Tokens"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Calls"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Errors"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Workflow"}),i.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Document"})]})}),i.jsxs("tbody",{children:[u.map((f,p)=>i.jsxs("tr",{className:"border-b",style:{borderColor:"var(--border-panel)"},children:[i.jsx("td",{className:"p-3 text-xs",children:f.date_short||f.date}),i.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.cost||0).toFixed(4)]}),i.jsx("td",{className:"p-3 text-xs text-right font-mono",children:(f.tokens||0).toLocaleString()}),i.jsx("td",{className:"p-3 text-xs text-right",children:f.calls||0}),i.jsx("td",{className:"p-3 text-xs text-right",style:{color:f.errors>0?"var(--state-error, #ef4444)":"var(--text-muted)"},children:f.errors||0}),i.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.workflow_cost||0).toFixed(4)]}),i.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.document_cost||0).toFixed(4)]})]},p)),u.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-8 text-center",style:{color:"var(--text-muted)"},children:"No cost data for this period."})})]})]})})]})}function xl({label:e,value:t}){return i.jsxs("div",{className:"p-4 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[i.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:e}),i.jsx("div",{className:"text-lg font-medium font-mono",style:{color:"var(--text-primary)"},children:t})]})}function LV(){const{isAdmin:e,loading:t}=Ms(),[r,n]=m.useState("executions"),[s,o]=m.useState(null);if(m.useEffect(()=>{const c=new URLSearchParams(window.location.search).get("execution");if(c){o(c),n("executions");return}const d=window.location.pathname.match(/^\/admin\/executions\/(.+)$/);d&&(o(d[1]),n("executions"))},[]),t)return i.jsx("div",{className:"flex h-screen items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return i.jsx("div",{className:"flex h-screen items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[i.jsx("p",{style:{color:"var(--text-primary)"},children:"Admin access required."}),i.jsx("a",{href:"/",className:"text-sm mt-2 inline-block",style:{color:"var(--accent-primary)"},children:"Return to Production Floor"})]})});const a=[{id:"executions",label:"Executions"},{id:"costs",label:"Costs"}];return i.jsxs("div",{className:"flex flex-col h-screen",style:{background:"var(--bg-canvas)"},children:[i.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("a",{href:"/",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[i.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),i.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),i.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--accent-primary)",color:"white",opacity:.9},children:"ADMIN"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("a",{href:"/admin/workbench",className:"text-xs px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Workbench"}),i.jsx("a",{href:"/",className:"text-xs px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Production Floor"})]})]}),i.jsx("div",{className:"flex border-b px-4 flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:a.map(l=>i.jsxs("button",{onClick:()=>{n(l.id),l.id!=="executions"&&o(null)},className:"px-4 py-2 text-sm transition-colors relative",style:{color:r===l.id?"var(--text-primary)":"var(--text-muted)",fontWeight:r===l.id?600:400},children:[l.label,r===l.id&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-primary)"}})]},l.id))}),i.jsxs("div",{className:"flex-1 overflow-hidden",children:[r==="executions"&&(s?i.jsx(AV,{executionId:s,onBack:()=>o(null)}):i.jsx(EV,{onSelectExecution:o})),r==="costs"&&i.jsx(DV,{})]})]})}function zV({user:e,onClick:t}){return i.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:i.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?i.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[i.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),i.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function FV(){var T,D,$,E,P;const{user:e}=Ms(),[t,r]=m.useState(!1),{projects:n,loading:s,error:o,refresh:a}=i9({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(!1),{theme:g,setTheme:_}=r3(),x=Object.keys(n),y=l&&n[l]?l:x[0]||null;m.useEffect(()=>{if(y&&n[y]){const R=n[y];document.title=`${R.projectId} - The Combine`}else document.title="The Combine"},[y,n]);const b=R=>{c(R),u(null)},j=()=>{p(!0)},k=async R=>{await a(),R&&R.id&&(c(R.id),u("concierge_intake")),p(!1)},N=()=>{p(!1)},S=async(R,L)=>{try{await ze.updateProject(R,L),await a()}catch(M){throw console.error("Failed to update project:",M),M}},C=async R=>{try{if(await ze.archiveProject(R),!t){const L=Object.values(n).sort((O,F)=>{const q=(O.name||"").localeCompare(F.name||"");return q!==0?q:(O.projectId||"").localeCompare(F.projectId||"")}),M=L.findIndex(O=>O.id===R),I=L[M+1]||L[M-1]||null;c((I==null?void 0:I.id)||null)}await a()}catch(L){throw console.error("Failed to archive project:",L),L}},w=async R=>{try{await ze.unarchiveProject(R),await a()}catch(L){throw console.error("Failed to unarchive project:",L),L}},A=async R=>{try{await ze.deleteProject(R);const L=Object.values(n).sort((O,F)=>{const q=(O.name||"").localeCompare(F.name||"");return q!==0?q:(O.projectId||"").localeCompare(F.projectId||"")}),M=L.findIndex(O=>O.id===R),I=L[M+1]||L[M-1]||null;c((I==null?void 0:I.id)||null),await a()}catch(L){throw console.error("Failed to delete project:",L),L}};return s?i.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):o?i.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[i.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",o]}),i.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):i.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[i.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),i.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),i.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),i.jsx("path",{d:"M12 17h.01"})]})})]}),i.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[i.jsx(j8,{projects:n,selectedId:y,onSelectProject:b,onNewProject:j,showArchived:t,onToggleShowArchived:()=>r(R=>!R),userSection:i.jsx(zV,{user:e,onClick:()=>v(!0)})}),i.jsx("div",{className:"flex-1",children:y?i.jsx(wa,{children:i.jsx(g9,{projectId:y,projectCode:(T=n[y])==null?void 0:T.projectId,projectName:(D=n[y])==null?void 0:D.name,isArchived:($=n[y])==null?void 0:$.isArchived,savedLayout:(P=(E=n[y])==null?void 0:E.metadata)==null?void 0:P.floor_layout,autoExpandNodeId:d,theme:g,onThemeChange:_,onProjectUpdate:S,onProjectArchive:C,onProjectUnarchive:w,onProjectDelete:A})},y):i.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:i.jsx("div",{className:"text-center",children:i.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&i.jsx($W,{onClose:N,onComplete:k}),h&&i.jsx(qW,{onClose:()=>v(!1)})]})]})}function $V(){const{isAuthenticated:e,loading:t}=Ms(),{theme:r}=r3(),[n,s]=m.useState(window.location.pathname);return m.useEffect(()=>{const o=()=>s(window.location.pathname);return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),t?i.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),i.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?i.jsx("div",{className:`h-screen theme-${r}`,children:i.jsx(CV,{})}):n==="/admin"||n.startsWith("/admin/executions")?i.jsx("div",{className:`h-screen theme-${r}`,children:i.jsx(LV,{})}):i.jsx(FV,{}):n==="/learn"?i.jsx(ZW,{}):i.jsx(KW,{})}function qV(){return i.jsx(c9,{children:i.jsx($V,{})})}Ig.createRoot(document.getElementById("root")).render(i.jsx(Y.StrictMode,{children:i.jsx(qV,{})}));
//# sourceMappingURL=index-BuxjMouD.js.map
