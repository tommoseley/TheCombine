(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ES={exports:{}},_c={},TS={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var da=Symbol.for("react.element"),S4=Symbol.for("react.portal"),k4=Symbol.for("react.fragment"),C4=Symbol.for("react.strict_mode"),N4=Symbol.for("react.profiler"),E4=Symbol.for("react.provider"),T4=Symbol.for("react.context"),R4=Symbol.for("react.forward_ref"),A4=Symbol.for("react.suspense"),I4=Symbol.for("react.memo"),M4=Symbol.for("react.lazy"),Dy=Symbol.iterator;function P4(e){return e===null||typeof e!="object"?null:(e=Dy&&e[Dy]||e["@@iterator"],typeof e=="function"?e:null)}var RS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},AS=Object.assign,IS={};function Ts(e,t,r){this.props=e,this.context=t,this.refs=IS,this.updater=r||RS}Ts.prototype.isReactComponent={};Ts.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ts.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function MS(){}MS.prototype=Ts.prototype;function Hv(e,t,r){this.props=e,this.context=t,this.refs=IS,this.updater=r||RS}var Wv=Hv.prototype=new MS;Wv.constructor=Hv;AS(Wv,Ts.prototype);Wv.isPureReactComponent=!0;var Ly=Array.isArray,PS=Object.prototype.hasOwnProperty,Uv={current:null},OS={key:!0,ref:!0,__self:!0,__source:!0};function DS(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)PS.call(t,n)&&!OS.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:da,type:e,key:s,ref:o,props:i,_owner:Uv.current}}function O4(e,t){return{$$typeof:da,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Vv(e){return typeof e=="object"&&e!==null&&e.$$typeof===da}function D4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Fy=/\/+/g;function _u(e,t){return typeof e=="object"&&e!==null&&e.key!=null?D4(""+e.key):t.toString(36)}function ul(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case da:case S4:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+_u(o,0):n,Ly(i)?(r="",e!=null&&(r=e.replace(Fy,"$&/")+"/"),ul(i,t,r,"",function(u){return u})):i!=null&&(Vv(i)&&(i=O4(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Fy,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",Ly(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+_u(s,l);o+=ul(s,t,r,c,i)}else if(c=P4(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+_u(s,l++),o+=ul(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ta(e,t,r){if(e==null)return e;var n=[],i=0;return ul(e,n,"","",function(s){return t.call(r,s,i++)}),n}function L4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Lt={current:null},dl={transition:null},F4={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:dl,ReactCurrentOwner:Uv};function LS(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Ta,forEach:function(e,t,r){Ta(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ta(e,function(){t++}),t},toArray:function(e){return Ta(e,function(t){return t})||[]},only:function(e){if(!Vv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Ts;Ce.Fragment=k4;Ce.Profiler=N4;Ce.PureComponent=Hv;Ce.StrictMode=C4;Ce.Suspense=A4;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F4;Ce.act=LS;Ce.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=AS({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Uv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)PS.call(t,c)&&!OS.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:da,type:e.type,key:i,ref:s,props:n,_owner:o}};Ce.createContext=function(e){return e={$$typeof:T4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:E4,_context:e},e.Consumer=e};Ce.createElement=DS;Ce.createFactory=function(e){var t=DS.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:R4,render:e}};Ce.isValidElement=Vv;Ce.lazy=function(e){return{$$typeof:M4,_payload:{_status:-1,_result:e},_init:L4}};Ce.memo=function(e,t){return{$$typeof:I4,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=dl.transition;dl.transition={};try{e()}finally{dl.transition=t}};Ce.unstable_act=LS;Ce.useCallback=function(e,t){return Lt.current.useCallback(e,t)};Ce.useContext=function(e){return Lt.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Lt.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Lt.current.useEffect(e,t)};Ce.useId=function(){return Lt.current.useId()};Ce.useImperativeHandle=function(e,t,r){return Lt.current.useImperativeHandle(e,t,r)};Ce.useInsertionEffect=function(e,t){return Lt.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Lt.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Lt.current.useMemo(e,t)};Ce.useReducer=function(e,t,r){return Lt.current.useReducer(e,t,r)};Ce.useRef=function(e){return Lt.current.useRef(e)};Ce.useState=function(e){return Lt.current.useState(e)};Ce.useSyncExternalStore=function(e,t,r){return Lt.current.useSyncExternalStore(e,t,r)};Ce.useTransition=function(){return Lt.current.useTransition()};Ce.version="18.3.1";TS.exports=Ce;var m=TS.exports;const G=Bv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q4=m,z4=Symbol.for("react.element"),$4=Symbol.for("react.fragment"),B4=Object.prototype.hasOwnProperty,H4=q4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,W4={key:!0,ref:!0,__self:!0,__source:!0};function FS(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)B4.call(t,n)&&!W4.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:z4,type:e,key:s,ref:o,props:i,_owner:H4.current}}_c.Fragment=$4;_c.jsx=FS;_c.jsxs=FS;ES.exports=_c;var a=ES.exports,bg={},qS={exports:{}},ir={},zS={exports:{}},$S={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,A){var L=D.length;D.push(A);e:for(;0<L;){var M=L-1>>>1,$=D[M];if(0<i($,A))D[M]=A,D[L]=$,L=M;else break e}}function r(D){return D.length===0?null:D[0]}function n(D){if(D.length===0)return null;var A=D[0],L=D.pop();if(L!==A){D[0]=L;e:for(var M=0,$=D.length,W=$>>>1;M<W;){var B=2*(M+1)-1,Y=D[B],Z=B+1,ie=D[Z];if(0>i(Y,L))Z<$&&0>i(ie,Y)?(D[M]=ie,D[Z]=L,M=Z):(D[M]=Y,D[B]=L,M=B);else if(Z<$&&0>i(ie,L))D[M]=ie,D[Z]=L,M=Z;else break e}}return A}function i(D,A){var L=D.sortIndex-A.sortIndex;return L!==0?L:D.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,y=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(D){for(var A=r(u);A!==null;){if(A.callback===null)n(u);else if(A.startTime<=D)n(u),A.sortIndex=A.expirationTime,t(c,A);else break;A=r(u)}}function _(D){if(g=!1,b(D),!y)if(r(c)!==null)y=!0,O(j);else{var A=r(u);A!==null&&H(_,A.startTime-D)}}function j(D,A){y=!1,g&&(g=!1,v(E),E=-1),p=!0;var L=h;try{for(b(A),f=r(c);f!==null&&(!(f.expirationTime>A)||D&&!T());){var M=f.callback;if(typeof M=="function"){f.callback=null,h=f.priorityLevel;var $=M(f.expirationTime<=A);A=e.unstable_now(),typeof $=="function"?f.callback=$:f===r(c)&&n(c),b(A)}else n(c);f=r(c)}if(f!==null)var W=!0;else{var B=r(u);B!==null&&H(_,B.startTime-A),W=!1}return W}finally{f=null,h=L,p=!1}}var S=!1,C=null,E=-1,k=5,R=-1;function T(){return!(e.unstable_now()-R<k)}function I(){if(C!==null){var D=e.unstable_now();R=D;var A=!0;try{A=C(!0,D)}finally{A?F():(S=!1,C=null)}}else S=!1}var F;if(typeof x=="function")F=function(){x(I)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,P=N.port2;N.port1.onmessage=I,F=function(){P.postMessage(null)}}else F=function(){w(I,0)};function O(D){C=D,S||(S=!0,F())}function H(D,A){E=w(function(){D(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){y||p||(y=!0,O(j))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(D){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var L=h;h=A;try{return D()}finally{h=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,A){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var L=h;h=D;try{return A()}finally{h=L}},e.unstable_scheduleCallback=function(D,A,L){var M=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?M+L:M):L=M,D){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=L+$,D={id:d++,callback:A,priorityLevel:D,startTime:L,expirationTime:$,sortIndex:-1},L>M?(D.sortIndex=L,t(u,D),r(c)===null&&D===r(u)&&(g?(v(E),E=-1):g=!0,H(_,L-M))):(D.sortIndex=$,t(c,D),y||p||(y=!0,O(j))),D},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(D){var A=h;return function(){var L=h;h=A;try{return D.apply(this,arguments)}finally{h=L}}}})($S);zS.exports=$S;var U4=zS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V4=m,rr=U4;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var BS=new Set,Mo={};function Ni(e,t){gs(e,t),gs(e+"Capture",t)}function gs(e,t){for(Mo[e]=t,e=0;e<t.length;e++)BS.add(t[e])}var cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wg=Object.prototype.hasOwnProperty,G4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qy={},zy={};function K4(e){return wg.call(zy,e)?!0:wg.call(qy,e)?!1:G4.test(e)?zy[e]=!0:(qy[e]=!0,!1)}function Y4(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function X4(e,t,r,n){if(t===null||typeof t>"u"||Y4(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ft(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){St[e]=new Ft(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];St[t]=new Ft(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){St[e]=new Ft(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){St[e]=new Ft(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){St[e]=new Ft(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){St[e]=new Ft(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){St[e]=new Ft(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){St[e]=new Ft(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){St[e]=new Ft(e,5,!1,e.toLowerCase(),null,!1,!1)});var Gv=/[\-:]([a-z])/g;function Kv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Gv,Kv);St[t]=new Ft(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Gv,Kv);St[t]=new Ft(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Gv,Kv);St[t]=new Ft(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){St[e]=new Ft(e,1,!1,e.toLowerCase(),null,!1,!1)});St.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){St[e]=new Ft(e,1,!1,e.toLowerCase(),null,!0,!0)});function Yv(e,t,r,n){var i=St.hasOwnProperty(t)?St[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(X4(t,r,i,n)&&(r=null),n||i===null?K4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var vn=V4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ra=Symbol.for("react.element"),Wi=Symbol.for("react.portal"),Ui=Symbol.for("react.fragment"),Xv=Symbol.for("react.strict_mode"),_g=Symbol.for("react.profiler"),HS=Symbol.for("react.provider"),WS=Symbol.for("react.context"),Qv=Symbol.for("react.forward_ref"),jg=Symbol.for("react.suspense"),Sg=Symbol.for("react.suspense_list"),Zv=Symbol.for("react.memo"),jn=Symbol.for("react.lazy"),US=Symbol.for("react.offscreen"),$y=Symbol.iterator;function Bs(e){return e===null||typeof e!="object"?null:(e=$y&&e[$y]||e["@@iterator"],typeof e=="function"?e:null)}var Qe=Object.assign,ju;function oo(e){if(ju===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ju=t&&t[1]||""}return`
`+ju+e}var Su=!1;function ku(e,t){if(!e||Su)return"";Su=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Su=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?oo(e):""}function Q4(e){switch(e.tag){case 5:return oo(e.type);case 16:return oo("Lazy");case 13:return oo("Suspense");case 19:return oo("SuspenseList");case 0:case 2:case 15:return e=ku(e.type,!1),e;case 11:return e=ku(e.type.render,!1),e;case 1:return e=ku(e.type,!0),e;default:return""}}function kg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ui:return"Fragment";case Wi:return"Portal";case _g:return"Profiler";case Xv:return"StrictMode";case jg:return"Suspense";case Sg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case WS:return(e.displayName||"Context")+".Consumer";case HS:return(e._context.displayName||"Context")+".Provider";case Qv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Zv:return t=e.displayName||null,t!==null?t:kg(e.type)||"Memo";case jn:t=e._payload,e=e._init;try{return kg(e(t))}catch{}}return null}function Z4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kg(t);case 8:return t===Xv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function VS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function J4(e){var t=VS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Aa(e){e._valueTracker||(e._valueTracker=J4(e))}function GS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=VS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Nl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cg(e,t){var r=t.checked;return Qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function By(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Gn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function KS(e,t){t=t.checked,t!=null&&Yv(e,"checked",t,!1)}function Ng(e,t){KS(e,t);var r=Gn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Eg(e,t.type,r):t.hasOwnProperty("defaultValue")&&Eg(e,t.type,Gn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Hy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Eg(e,t,r){(t!=="number"||Nl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ao=Array.isArray;function os(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Gn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Tg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Q(92));if(ao(r)){if(1<r.length)throw Error(Q(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Gn(r)}}function YS(e,t){var r=Gn(t.value),n=Gn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Uy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function XS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?XS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ia,QS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ia=Ia||document.createElement("div"),Ia.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ia.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Po(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var bo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eA=["Webkit","ms","Moz","O"];Object.keys(bo).forEach(function(e){eA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bo[t]=bo[e]})});function ZS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||bo.hasOwnProperty(e)&&bo[e]?(""+t).trim():t+"px"}function JS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ZS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var tA=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ag(e,t){if(t){if(tA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function Ig(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mg=null;function Jv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pg=null,as=null,ls=null;function Vy(e){if(e=ha(e)){if(typeof Pg!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=Nc(t),Pg(e.stateNode,e.type,t))}}function ek(e){as?ls?ls.push(e):ls=[e]:as=e}function tk(){if(as){var e=as,t=ls;if(ls=as=null,Vy(e),t)for(e=0;e<t.length;e++)Vy(t[e])}}function rk(e,t){return e(t)}function nk(){}var Cu=!1;function ik(e,t,r){if(Cu)return e(t,r);Cu=!0;try{return rk(e,t,r)}finally{Cu=!1,(as!==null||ls!==null)&&(nk(),tk())}}function Oo(e,t){var r=e.stateNode;if(r===null)return null;var n=Nc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Q(231,t,typeof r));return r}var Og=!1;if(cn)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){Og=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{Og=!1}function rA(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var wo=!1,El=null,Tl=!1,Dg=null,nA={onError:function(e){wo=!0,El=e}};function iA(e,t,r,n,i,s,o,l,c){wo=!1,El=null,rA.apply(nA,arguments)}function sA(e,t,r,n,i,s,o,l,c){if(iA.apply(this,arguments),wo){if(wo){var u=El;wo=!1,El=null}else throw Error(Q(198));Tl||(Tl=!0,Dg=u)}}function Ei(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function sk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Gy(e){if(Ei(e)!==e)throw Error(Q(188))}function oA(e){var t=e.alternate;if(!t){if(t=Ei(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Gy(i),e;if(s===n)return Gy(i),t;s=s.sibling}throw Error(Q(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Q(189))}}if(r.alternate!==n)throw Error(Q(190))}if(r.tag!==3)throw Error(Q(188));return r.stateNode.current===r?e:t}function ok(e){return e=oA(e),e!==null?ak(e):null}function ak(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ak(e);if(t!==null)return t;e=e.sibling}return null}var lk=rr.unstable_scheduleCallback,Ky=rr.unstable_cancelCallback,aA=rr.unstable_shouldYield,lA=rr.unstable_requestPaint,it=rr.unstable_now,cA=rr.unstable_getCurrentPriorityLevel,ex=rr.unstable_ImmediatePriority,ck=rr.unstable_UserBlockingPriority,Rl=rr.unstable_NormalPriority,uA=rr.unstable_LowPriority,uk=rr.unstable_IdlePriority,jc=null,$r=null;function dA(e){if($r&&typeof $r.onCommitFiberRoot=="function")try{$r.onCommitFiberRoot(jc,e,void 0,(e.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:hA,fA=Math.log,pA=Math.LN2;function hA(e){return e>>>=0,e===0?32:31-(fA(e)/pA|0)|0}var Ma=64,Pa=4194304;function lo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Al(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=lo(l):(s&=o,s!==0&&(n=lo(s)))}else o=r&~i,o!==0?n=lo(o):s!==0&&(n=lo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Nr(t),i=1<<r,n|=e[r],t&=~i;return n}function mA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gA(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Nr(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=mA(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Lg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dk(){var e=Ma;return Ma<<=1,!(Ma&4194240)&&(Ma=64),e}function Nu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function fa(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nr(t),e[t]=r}function vA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Nr(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function tx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Nr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var De=0;function fk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var pk,rx,hk,mk,gk,Fg=!1,Oa=[],On=null,Dn=null,Ln=null,Do=new Map,Lo=new Map,En=[],xA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yy(e,t){switch(e){case"focusin":case"focusout":On=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":Do.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lo.delete(t.pointerId)}}function Ws(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=ha(t),t!==null&&rx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function yA(e,t,r,n,i){switch(t){case"focusin":return On=Ws(On,e,t,r,n,i),!0;case"dragenter":return Dn=Ws(Dn,e,t,r,n,i),!0;case"mouseover":return Ln=Ws(Ln,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Do.set(s,Ws(Do.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Lo.set(s,Ws(Lo.get(s)||null,e,t,r,n,i)),!0}return!1}function vk(e){var t=ci(e.target);if(t!==null){var r=Ei(t);if(r!==null){if(t=r.tag,t===13){if(t=sk(r),t!==null){e.blockedOn=t,gk(e.priority,function(){hk(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function fl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=qg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Mg=n,r.target.dispatchEvent(n),Mg=null}else return t=ha(r),t!==null&&rx(t),e.blockedOn=r,!1;t.shift()}return!0}function Xy(e,t,r){fl(e)&&r.delete(t)}function bA(){Fg=!1,On!==null&&fl(On)&&(On=null),Dn!==null&&fl(Dn)&&(Dn=null),Ln!==null&&fl(Ln)&&(Ln=null),Do.forEach(Xy),Lo.forEach(Xy)}function Us(e,t){e.blockedOn===t&&(e.blockedOn=null,Fg||(Fg=!0,rr.unstable_scheduleCallback(rr.unstable_NormalPriority,bA)))}function Fo(e){function t(i){return Us(i,e)}if(0<Oa.length){Us(Oa[0],e);for(var r=1;r<Oa.length;r++){var n=Oa[r];n.blockedOn===e&&(n.blockedOn=null)}}for(On!==null&&Us(On,e),Dn!==null&&Us(Dn,e),Ln!==null&&Us(Ln,e),Do.forEach(t),Lo.forEach(t),r=0;r<En.length;r++)n=En[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<En.length&&(r=En[0],r.blockedOn===null);)vk(r),r.blockedOn===null&&En.shift()}var cs=vn.ReactCurrentBatchConfig,Il=!0;function wA(e,t,r,n){var i=De,s=cs.transition;cs.transition=null;try{De=1,nx(e,t,r,n)}finally{De=i,cs.transition=s}}function _A(e,t,r,n){var i=De,s=cs.transition;cs.transition=null;try{De=4,nx(e,t,r,n)}finally{De=i,cs.transition=s}}function nx(e,t,r,n){if(Il){var i=qg(e,t,r,n);if(i===null)Lu(e,t,n,Ml,r),Yy(e,n);else if(yA(i,e,t,r,n))n.stopPropagation();else if(Yy(e,n),t&4&&-1<xA.indexOf(e)){for(;i!==null;){var s=ha(i);if(s!==null&&pk(s),s=qg(e,t,r,n),s===null&&Lu(e,t,n,Ml,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Lu(e,t,n,null,r)}}var Ml=null;function qg(e,t,r,n){if(Ml=null,e=Jv(n),e=ci(e),e!==null)if(t=Ei(e),t===null)e=null;else if(r=t.tag,r===13){if(e=sk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ml=e,null}function xk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cA()){case ex:return 1;case ck:return 4;case Rl:case uA:return 16;case uk:return 536870912;default:return 16}default:return 16}}var Mn=null,ix=null,pl=null;function yk(){if(pl)return pl;var e,t=ix,r=t.length,n,i="value"in Mn?Mn.value:Mn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return pl=i.slice(e,1<n?1-n:void 0)}function hl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Da(){return!0}function Qy(){return!1}function sr(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Da:Qy,this.isPropagationStopped=Qy,this}return Qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Da)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Da)},persist:function(){},isPersistent:Da}),t}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sx=sr(Rs),pa=Qe({},Rs,{view:0,detail:0}),jA=sr(pa),Eu,Tu,Vs,Sc=Qe({},pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ox,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vs&&(Vs&&e.type==="mousemove"?(Eu=e.screenX-Vs.screenX,Tu=e.screenY-Vs.screenY):Tu=Eu=0,Vs=e),Eu)},movementY:function(e){return"movementY"in e?e.movementY:Tu}}),Zy=sr(Sc),SA=Qe({},Sc,{dataTransfer:0}),kA=sr(SA),CA=Qe({},pa,{relatedTarget:0}),Ru=sr(CA),NA=Qe({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),EA=sr(NA),TA=Qe({},Rs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),RA=sr(TA),AA=Qe({},Rs,{data:0}),Jy=sr(AA),IA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=PA[e])?!!t[e]:!1}function ox(){return OA}var DA=Qe({},pa,{key:function(e){if(e.key){var t=IA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?MA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ox,charCode:function(e){return e.type==="keypress"?hl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),LA=sr(DA),FA=Qe({},Sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e0=sr(FA),qA=Qe({},pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ox}),zA=sr(qA),$A=Qe({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),BA=sr($A),HA=Qe({},Sc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),WA=sr(HA),UA=[9,13,27,32],ax=cn&&"CompositionEvent"in window,_o=null;cn&&"documentMode"in document&&(_o=document.documentMode);var VA=cn&&"TextEvent"in window&&!_o,bk=cn&&(!ax||_o&&8<_o&&11>=_o),t0=" ",r0=!1;function wk(e,t){switch(e){case"keyup":return UA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _k(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vi=!1;function GA(e,t){switch(e){case"compositionend":return _k(t);case"keypress":return t.which!==32?null:(r0=!0,t0);case"textInput":return e=t.data,e===t0&&r0?null:e;default:return null}}function KA(e,t){if(Vi)return e==="compositionend"||!ax&&wk(e,t)?(e=yk(),pl=ix=Mn=null,Vi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return bk&&t.locale!=="ko"?null:t.data;default:return null}}var YA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!YA[e.type]:t==="textarea"}function jk(e,t,r,n){ek(n),t=Pl(t,"onChange"),0<t.length&&(r=new sx("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var jo=null,qo=null;function XA(e){Pk(e,0)}function kc(e){var t=Yi(e);if(GS(t))return e}function QA(e,t){if(e==="change")return t}var Sk=!1;if(cn){var Au;if(cn){var Iu="oninput"in document;if(!Iu){var i0=document.createElement("div");i0.setAttribute("oninput","return;"),Iu=typeof i0.oninput=="function"}Au=Iu}else Au=!1;Sk=Au&&(!document.documentMode||9<document.documentMode)}function s0(){jo&&(jo.detachEvent("onpropertychange",kk),qo=jo=null)}function kk(e){if(e.propertyName==="value"&&kc(qo)){var t=[];jk(t,qo,e,Jv(e)),ik(XA,t)}}function ZA(e,t,r){e==="focusin"?(s0(),jo=t,qo=r,jo.attachEvent("onpropertychange",kk)):e==="focusout"&&s0()}function JA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kc(qo)}function e5(e,t){if(e==="click")return kc(t)}function t5(e,t){if(e==="input"||e==="change")return kc(t)}function r5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tr=typeof Object.is=="function"?Object.is:r5;function zo(e,t){if(Tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!wg.call(t,i)||!Tr(e[i],t[i]))return!1}return!0}function o0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function a0(e,t){var r=o0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=o0(r)}}function Ck(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ck(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Nk(){for(var e=window,t=Nl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Nl(e.document)}return t}function lx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function n5(e){var t=Nk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ck(r.ownerDocument.documentElement,r)){if(n!==null&&lx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=a0(r,s);var o=a0(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var i5=cn&&"documentMode"in document&&11>=document.documentMode,Gi=null,zg=null,So=null,$g=!1;function l0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$g||Gi==null||Gi!==Nl(n)||(n=Gi,"selectionStart"in n&&lx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),So&&zo(So,n)||(So=n,n=Pl(zg,"onSelect"),0<n.length&&(t=new sx("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gi)))}function La(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ki={animationend:La("Animation","AnimationEnd"),animationiteration:La("Animation","AnimationIteration"),animationstart:La("Animation","AnimationStart"),transitionend:La("Transition","TransitionEnd")},Mu={},Ek={};cn&&(Ek=document.createElement("div").style,"AnimationEvent"in window||(delete Ki.animationend.animation,delete Ki.animationiteration.animation,delete Ki.animationstart.animation),"TransitionEvent"in window||delete Ki.transitionend.transition);function Cc(e){if(Mu[e])return Mu[e];if(!Ki[e])return e;var t=Ki[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Ek)return Mu[e]=t[r];return e}var Tk=Cc("animationend"),Rk=Cc("animationiteration"),Ak=Cc("animationstart"),Ik=Cc("transitionend"),Mk=new Map,c0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qn(e,t){Mk.set(e,t),Ni(t,[e])}for(var Pu=0;Pu<c0.length;Pu++){var Ou=c0[Pu],s5=Ou.toLowerCase(),o5=Ou[0].toUpperCase()+Ou.slice(1);Qn(s5,"on"+o5)}Qn(Tk,"onAnimationEnd");Qn(Rk,"onAnimationIteration");Qn(Ak,"onAnimationStart");Qn("dblclick","onDoubleClick");Qn("focusin","onFocus");Qn("focusout","onBlur");Qn(Ik,"onTransitionEnd");gs("onMouseEnter",["mouseout","mouseover"]);gs("onMouseLeave",["mouseout","mouseover"]);gs("onPointerEnter",["pointerout","pointerover"]);gs("onPointerLeave",["pointerout","pointerover"]);Ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ni("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),a5=new Set("cancel close invalid load scroll toggle".split(" ").concat(co));function u0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,sA(n,t,void 0,e),e.currentTarget=null}function Pk(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;u0(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;u0(i,l,u),s=c}}}if(Tl)throw e=Dg,Tl=!1,Dg=null,e}function Be(e,t){var r=t[Vg];r===void 0&&(r=t[Vg]=new Set);var n=e+"__bubble";r.has(n)||(Ok(t,e,2,!1),r.add(n))}function Du(e,t,r){var n=0;t&&(n|=4),Ok(r,e,n,t)}var Fa="_reactListening"+Math.random().toString(36).slice(2);function $o(e){if(!e[Fa]){e[Fa]=!0,BS.forEach(function(r){r!=="selectionchange"&&(a5.has(r)||Du(r,!1,e),Du(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fa]||(t[Fa]=!0,Du("selectionchange",!1,t))}}function Ok(e,t,r,n){switch(xk(t)){case 1:var i=wA;break;case 4:i=_A;break;default:i=nx}r=i.bind(null,t,r,e),i=void 0,!Og||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Lu(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ci(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}ik(function(){var u=s,d=Jv(r),f=[];e:{var h=Mk.get(e);if(h!==void 0){var p=sx,y=e;switch(e){case"keypress":if(hl(r)===0)break e;case"keydown":case"keyup":p=LA;break;case"focusin":y="focus",p=Ru;break;case"focusout":y="blur",p=Ru;break;case"beforeblur":case"afterblur":p=Ru;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Zy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=kA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=zA;break;case Tk:case Rk:case Ak:p=EA;break;case Ik:p=BA;break;case"scroll":p=jA;break;case"wheel":p=WA;break;case"copy":case"cut":case"paste":p=RA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=e0}var g=(t&4)!==0,w=!g&&e==="scroll",v=g?h!==null?h+"Capture":null:h;g=[];for(var x=u,b;x!==null;){b=x;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,v!==null&&(_=Oo(x,v),_!=null&&g.push(Bo(x,_,b)))),w)break;x=x.return}0<g.length&&(h=new p(h,y,null,r,d),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Mg&&(y=r.relatedTarget||r.fromElement)&&(ci(y)||y[un]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(y=r.relatedTarget||r.toElement,p=u,y=y?ci(y):null,y!==null&&(w=Ei(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(g=Zy,_="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=e0,_="onPointerLeave",v="onPointerEnter",x="pointer"),w=p==null?h:Yi(p),b=y==null?h:Yi(y),h=new g(_,x+"leave",p,r,d),h.target=w,h.relatedTarget=b,_=null,ci(d)===u&&(g=new g(v,x+"enter",y,r,d),g.target=b,g.relatedTarget=w,_=g),w=_,p&&y)t:{for(g=p,v=y,x=0,b=g;b;b=Pi(b))x++;for(b=0,_=v;_;_=Pi(_))b++;for(;0<x-b;)g=Pi(g),x--;for(;0<b-x;)v=Pi(v),b--;for(;x--;){if(g===v||v!==null&&g===v.alternate)break t;g=Pi(g),v=Pi(v)}g=null}else g=null;p!==null&&d0(f,h,p,g,!1),y!==null&&w!==null&&d0(f,w,y,g,!0)}}e:{if(h=u?Yi(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var j=QA;else if(n0(h))if(Sk)j=t5;else{j=JA;var S=ZA}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=e5);if(j&&(j=j(e,u))){jk(f,j,r,d);break e}S&&S(e,h,u),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&Eg(h,"number",h.value)}switch(S=u?Yi(u):window,e){case"focusin":(n0(S)||S.contentEditable==="true")&&(Gi=S,zg=u,So=null);break;case"focusout":So=zg=Gi=null;break;case"mousedown":$g=!0;break;case"contextmenu":case"mouseup":case"dragend":$g=!1,l0(f,r,d);break;case"selectionchange":if(i5)break;case"keydown":case"keyup":l0(f,r,d)}var C;if(ax)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Vi?wk(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(bk&&r.locale!=="ko"&&(Vi||E!=="onCompositionStart"?E==="onCompositionEnd"&&Vi&&(C=yk()):(Mn=d,ix="value"in Mn?Mn.value:Mn.textContent,Vi=!0)),S=Pl(u,E),0<S.length&&(E=new Jy(E,e,null,r,d),f.push({event:E,listeners:S}),C?E.data=C:(C=_k(r),C!==null&&(E.data=C)))),(C=VA?GA(e,r):KA(e,r))&&(u=Pl(u,"onBeforeInput"),0<u.length&&(d=new Jy("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=C))}Pk(f,t)})}function Bo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Pl(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Oo(e,r),s!=null&&n.unshift(Bo(e,s,i)),s=Oo(e,t),s!=null&&n.push(Bo(e,s,i))),e=e.return}return n}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function d0(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=Oo(r,s),c!=null&&o.unshift(Bo(r,c,l))):i||(c=Oo(r,s),c!=null&&o.push(Bo(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var l5=/\r\n?/g,c5=/\u0000|\uFFFD/g;function f0(e){return(typeof e=="string"?e:""+e).replace(l5,`
`).replace(c5,"")}function qa(e,t,r){if(t=f0(t),f0(e)!==t&&r)throw Error(Q(425))}function Ol(){}var Bg=null,Hg=null;function Wg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ug=typeof setTimeout=="function"?setTimeout:void 0,u5=typeof clearTimeout=="function"?clearTimeout:void 0,p0=typeof Promise=="function"?Promise:void 0,d5=typeof queueMicrotask=="function"?queueMicrotask:typeof p0<"u"?function(e){return p0.resolve(null).then(e).catch(f5)}:Ug;function f5(e){setTimeout(function(){throw e})}function Fu(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Fo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Fo(t)}function Fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function h0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var As=Math.random().toString(36).slice(2),qr="__reactFiber$"+As,Ho="__reactProps$"+As,un="__reactContainer$"+As,Vg="__reactEvents$"+As,p5="__reactListeners$"+As,h5="__reactHandles$"+As;function ci(e){var t=e[qr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[un]||r[qr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=h0(e);e!==null;){if(r=e[qr])return r;e=h0(e)}return t}e=r,r=e.parentNode}return null}function ha(e){return e=e[qr]||e[un],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Yi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function Nc(e){return e[Ho]||null}var Gg=[],Xi=-1;function Zn(e){return{current:e}}function He(e){0>Xi||(e.current=Gg[Xi],Gg[Xi]=null,Xi--)}function qe(e,t){Xi++,Gg[Xi]=e.current,e.current=t}var Kn={},Tt=Zn(Kn),Wt=Zn(!1),bi=Kn;function vs(e,t){var r=e.type.contextTypes;if(!r)return Kn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ut(e){return e=e.childContextTypes,e!=null}function Dl(){He(Wt),He(Tt)}function m0(e,t,r){if(Tt.current!==Kn)throw Error(Q(168));qe(Tt,t),qe(Wt,r)}function Dk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Q(108,Z4(e)||"Unknown",i));return Qe({},r,n)}function Ll(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Kn,bi=Tt.current,qe(Tt,e),qe(Wt,Wt.current),!0}function g0(e,t,r){var n=e.stateNode;if(!n)throw Error(Q(169));r?(e=Dk(e,t,bi),n.__reactInternalMemoizedMergedChildContext=e,He(Wt),He(Tt),qe(Tt,e)):He(Wt),qe(Wt,r)}var Jr=null,Ec=!1,qu=!1;function Lk(e){Jr===null?Jr=[e]:Jr.push(e)}function m5(e){Ec=!0,Lk(e)}function Jn(){if(!qu&&Jr!==null){qu=!0;var e=0,t=De;try{var r=Jr;for(De=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jr=null,Ec=!1}catch(i){throw Jr!==null&&(Jr=Jr.slice(e+1)),lk(ex,Jn),i}finally{De=t,qu=!1}}return null}var Qi=[],Zi=0,Fl=null,ql=0,lr=[],cr=0,wi=null,tn=1,rn="";function oi(e,t){Qi[Zi++]=ql,Qi[Zi++]=Fl,Fl=e,ql=t}function Fk(e,t,r){lr[cr++]=tn,lr[cr++]=rn,lr[cr++]=wi,wi=e;var n=tn;e=rn;var i=32-Nr(n)-1;n&=~(1<<i),r+=1;var s=32-Nr(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,tn=1<<32-Nr(t)+i|r<<i|n,rn=s+e}else tn=1<<s|r<<i|n,rn=e}function cx(e){e.return!==null&&(oi(e,1),Fk(e,1,0))}function ux(e){for(;e===Fl;)Fl=Qi[--Zi],Qi[Zi]=null,ql=Qi[--Zi],Qi[Zi]=null;for(;e===wi;)wi=lr[--cr],lr[cr]=null,rn=lr[--cr],lr[cr]=null,tn=lr[--cr],lr[cr]=null}var tr=null,er=null,We=!1,kr=null;function qk(e,t){var r=dr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function v0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,tr=e,er=Fn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,tr=e,er=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=wi!==null?{id:tn,overflow:rn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=dr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,tr=e,er=null,!0):!1;default:return!1}}function Kg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yg(e){if(We){var t=er;if(t){var r=t;if(!v0(e,t)){if(Kg(e))throw Error(Q(418));t=Fn(r.nextSibling);var n=tr;t&&v0(e,t)?qk(n,r):(e.flags=e.flags&-4097|2,We=!1,tr=e)}}else{if(Kg(e))throw Error(Q(418));e.flags=e.flags&-4097|2,We=!1,tr=e}}}function x0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;tr=e}function za(e){if(e!==tr)return!1;if(!We)return x0(e),We=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Wg(e.type,e.memoizedProps)),t&&(t=er)){if(Kg(e))throw zk(),Error(Q(418));for(;t;)qk(e,t),t=Fn(t.nextSibling)}if(x0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){er=Fn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}er=null}}else er=tr?Fn(e.stateNode.nextSibling):null;return!0}function zk(){for(var e=er;e;)e=Fn(e.nextSibling)}function xs(){er=tr=null,We=!1}function dx(e){kr===null?kr=[e]:kr.push(e)}var g5=vn.ReactCurrentBatchConfig;function Gs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Q(309));var n=r.stateNode}if(!n)throw Error(Q(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Q(284));if(!r._owner)throw Error(Q(290,e))}return e}function $a(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function y0(e){var t=e._init;return t(e._payload)}function $k(e){function t(v,x){if(e){var b=v.deletions;b===null?(v.deletions=[x],v.flags|=16):b.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=Bn(v,x),v.index=0,v.sibling=null,v}function s(v,x,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<x?(v.flags|=2,x):b):(v.flags|=2,x)):(v.flags|=1048576,x)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,x,b,_){return x===null||x.tag!==6?(x=Vu(b,v.mode,_),x.return=v,x):(x=i(x,b),x.return=v,x)}function c(v,x,b,_){var j=b.type;return j===Ui?d(v,x,b.props.children,_,b.key):x!==null&&(x.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jn&&y0(j)===x.type)?(_=i(x,b.props),_.ref=Gs(v,x,b),_.return=v,_):(_=wl(b.type,b.key,b.props,null,v.mode,_),_.ref=Gs(v,x,b),_.return=v,_)}function u(v,x,b,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=Gu(b,v.mode,_),x.return=v,x):(x=i(x,b.children||[]),x.return=v,x)}function d(v,x,b,_,j){return x===null||x.tag!==7?(x=gi(b,v.mode,_,j),x.return=v,x):(x=i(x,b),x.return=v,x)}function f(v,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Vu(""+x,v.mode,b),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ra:return b=wl(x.type,x.key,x.props,null,v.mode,b),b.ref=Gs(v,null,x),b.return=v,b;case Wi:return x=Gu(x,v.mode,b),x.return=v,x;case jn:var _=x._init;return f(v,_(x._payload),b)}if(ao(x)||Bs(x))return x=gi(x,v.mode,b,null),x.return=v,x;$a(v,x)}return null}function h(v,x,b,_){var j=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ra:return b.key===j?c(v,x,b,_):null;case Wi:return b.key===j?u(v,x,b,_):null;case jn:return j=b._init,h(v,x,j(b._payload),_)}if(ao(b)||Bs(b))return j!==null?null:d(v,x,b,_,null);$a(v,b)}return null}function p(v,x,b,_,j){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(b)||null,l(x,v,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ra:return v=v.get(_.key===null?b:_.key)||null,c(x,v,_,j);case Wi:return v=v.get(_.key===null?b:_.key)||null,u(x,v,_,j);case jn:var S=_._init;return p(v,x,b,S(_._payload),j)}if(ao(_)||Bs(_))return v=v.get(b)||null,d(x,v,_,j,null);$a(x,_)}return null}function y(v,x,b,_){for(var j=null,S=null,C=x,E=x=0,k=null;C!==null&&E<b.length;E++){C.index>E?(k=C,C=null):k=C.sibling;var R=h(v,C,b[E],_);if(R===null){C===null&&(C=k);break}e&&C&&R.alternate===null&&t(v,C),x=s(R,x,E),S===null?j=R:S.sibling=R,S=R,C=k}if(E===b.length)return r(v,C),We&&oi(v,E),j;if(C===null){for(;E<b.length;E++)C=f(v,b[E],_),C!==null&&(x=s(C,x,E),S===null?j=C:S.sibling=C,S=C);return We&&oi(v,E),j}for(C=n(v,C);E<b.length;E++)k=p(C,v,E,b[E],_),k!==null&&(e&&k.alternate!==null&&C.delete(k.key===null?E:k.key),x=s(k,x,E),S===null?j=k:S.sibling=k,S=k);return e&&C.forEach(function(T){return t(v,T)}),We&&oi(v,E),j}function g(v,x,b,_){var j=Bs(b);if(typeof j!="function")throw Error(Q(150));if(b=j.call(b),b==null)throw Error(Q(151));for(var S=j=null,C=x,E=x=0,k=null,R=b.next();C!==null&&!R.done;E++,R=b.next()){C.index>E?(k=C,C=null):k=C.sibling;var T=h(v,C,R.value,_);if(T===null){C===null&&(C=k);break}e&&C&&T.alternate===null&&t(v,C),x=s(T,x,E),S===null?j=T:S.sibling=T,S=T,C=k}if(R.done)return r(v,C),We&&oi(v,E),j;if(C===null){for(;!R.done;E++,R=b.next())R=f(v,R.value,_),R!==null&&(x=s(R,x,E),S===null?j=R:S.sibling=R,S=R);return We&&oi(v,E),j}for(C=n(v,C);!R.done;E++,R=b.next())R=p(C,v,E,R.value,_),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?E:R.key),x=s(R,x,E),S===null?j=R:S.sibling=R,S=R);return e&&C.forEach(function(I){return t(v,I)}),We&&oi(v,E),j}function w(v,x,b,_){if(typeof b=="object"&&b!==null&&b.type===Ui&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ra:e:{for(var j=b.key,S=x;S!==null;){if(S.key===j){if(j=b.type,j===Ui){if(S.tag===7){r(v,S.sibling),x=i(S,b.props.children),x.return=v,v=x;break e}}else if(S.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jn&&y0(j)===S.type){r(v,S.sibling),x=i(S,b.props),x.ref=Gs(v,S,b),x.return=v,v=x;break e}r(v,S);break}else t(v,S);S=S.sibling}b.type===Ui?(x=gi(b.props.children,v.mode,_,b.key),x.return=v,v=x):(_=wl(b.type,b.key,b.props,null,v.mode,_),_.ref=Gs(v,x,b),_.return=v,v=_)}return o(v);case Wi:e:{for(S=b.key;x!==null;){if(x.key===S)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){r(v,x.sibling),x=i(x,b.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=Gu(b,v.mode,_),x.return=v,v=x}return o(v);case jn:return S=b._init,w(v,x,S(b._payload),_)}if(ao(b))return y(v,x,b,_);if(Bs(b))return g(v,x,b,_);$a(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,b),x.return=v,v=x):(r(v,x),x=Vu(b,v.mode,_),x.return=v,v=x),o(v)):r(v,x)}return w}var ys=$k(!0),Bk=$k(!1),zl=Zn(null),$l=null,Ji=null,fx=null;function px(){fx=Ji=$l=null}function hx(e){var t=zl.current;He(zl),e._currentValue=t}function Xg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function us(e,t){$l=e,fx=Ji=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($t=!0),e.firstContext=null)}function hr(e){var t=e._currentValue;if(fx!==e)if(e={context:e,memoizedValue:t,next:null},Ji===null){if($l===null)throw Error(Q(308));Ji=e,$l.dependencies={lanes:0,firstContext:e}}else Ji=Ji.next=e;return t}var ui=null;function mx(e){ui===null?ui=[e]:ui.push(e)}function Hk(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,mx(t)):(r.next=i.next,i.next=r),t.interleaved=r,dn(e,n)}function dn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Sn=!1;function gx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function an(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ie&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,dn(e,r)}return i=n.interleaved,i===null?(t.next=t,mx(n)):(t.next=i.next,i.next=t),n.interleaved=t,dn(e,r)}function ml(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tx(e,r)}}function b0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Bl(e,t,r,n){var i=e.updateQueue;Sn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,d=u=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,g=l;switch(h=t,p=r,g.tag){case 1:if(y=g.payload,typeof y=="function"){f=y.call(p,f,h);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,h=typeof y=="function"?y.call(p,f,h):y,h==null)break e;f=Qe({},f,h);break e;case 2:Sn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ji|=o,e.lanes=o,e.memoizedState=f}}function w0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Q(191,i));i.call(n)}}}var ma={},Br=Zn(ma),Wo=Zn(ma),Uo=Zn(ma);function di(e){if(e===ma)throw Error(Q(174));return e}function vx(e,t){switch(qe(Uo,t),qe(Wo,e),qe(Br,ma),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Rg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Rg(t,e)}He(Br),qe(Br,t)}function bs(){He(Br),He(Wo),He(Uo)}function Uk(e){di(Uo.current);var t=di(Br.current),r=Rg(t,e.type);t!==r&&(qe(Wo,e),qe(Br,r))}function xx(e){Wo.current===e&&(He(Br),He(Wo))}var Ye=Zn(0);function Hl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zu=[];function yx(){for(var e=0;e<zu.length;e++)zu[e]._workInProgressVersionPrimary=null;zu.length=0}var gl=vn.ReactCurrentDispatcher,$u=vn.ReactCurrentBatchConfig,_i=0,Xe=null,ct=null,mt=null,Wl=!1,ko=!1,Vo=0,v5=0;function Ct(){throw Error(Q(321))}function bx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Tr(e[r],t[r]))return!1;return!0}function wx(e,t,r,n,i,s){if(_i=s,Xe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,gl.current=e===null||e.memoizedState===null?w5:_5,e=r(n,i),ko){s=0;do{if(ko=!1,Vo=0,25<=s)throw Error(Q(301));s+=1,mt=ct=null,t.updateQueue=null,gl.current=j5,e=r(n,i)}while(ko)}if(gl.current=Ul,t=ct!==null&&ct.next!==null,_i=0,mt=ct=Xe=null,Wl=!1,t)throw Error(Q(300));return e}function _x(){var e=Vo!==0;return Vo=0,e}function Fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Xe.memoizedState=mt=e:mt=mt.next=e,mt}function mr(){if(ct===null){var e=Xe.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=mt===null?Xe.memoizedState:mt.next;if(t!==null)mt=t,ct=e;else{if(e===null)throw Error(Q(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},mt===null?Xe.memoizedState=mt=e:mt=mt.next=e}return mt}function Go(e,t){return typeof t=="function"?t(e):t}function Bu(e){var t=mr(),r=t.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=e;var n=ct,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((_i&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Xe.lanes|=d,ji|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,Tr(n,t.memoizedState)||($t=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Xe.lanes|=s,ji|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Hu(e){var t=mr(),r=t.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Tr(s,t.memoizedState)||($t=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Vk(){}function Gk(e,t){var r=Xe,n=mr(),i=t(),s=!Tr(n.memoizedState,i);if(s&&(n.memoizedState=i,$t=!0),n=n.queue,jx(Xk.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||mt!==null&&mt.memoizedState.tag&1){if(r.flags|=2048,Ko(9,Yk.bind(null,r,n,i,t),void 0,null),vt===null)throw Error(Q(349));_i&30||Kk(r,t,i)}return i}function Kk(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Yk(e,t,r,n){t.value=r,t.getSnapshot=n,Qk(t)&&Zk(e)}function Xk(e,t,r){return r(function(){Qk(t)&&Zk(e)})}function Qk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Tr(e,r)}catch{return!0}}function Zk(e){var t=dn(e,1);t!==null&&Er(t,e,1,-1)}function _0(e){var t=Fr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:e},t.queue=e,e=e.dispatch=b5.bind(null,Xe,e),[t.memoizedState,e]}function Ko(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Jk(){return mr().memoizedState}function vl(e,t,r,n){var i=Fr();Xe.flags|=e,i.memoizedState=Ko(1|t,r,void 0,n===void 0?null:n)}function Tc(e,t,r,n){var i=mr();n=n===void 0?null:n;var s=void 0;if(ct!==null){var o=ct.memoizedState;if(s=o.destroy,n!==null&&bx(n,o.deps)){i.memoizedState=Ko(t,r,s,n);return}}Xe.flags|=e,i.memoizedState=Ko(1|t,r,s,n)}function j0(e,t){return vl(8390656,8,e,t)}function jx(e,t){return Tc(2048,8,e,t)}function eC(e,t){return Tc(4,2,e,t)}function tC(e,t){return Tc(4,4,e,t)}function rC(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nC(e,t,r){return r=r!=null?r.concat([e]):null,Tc(4,4,rC.bind(null,t,e),r)}function Sx(){}function iC(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&bx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function sC(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&bx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function oC(e,t,r){return _i&21?(Tr(r,t)||(r=dk(),Xe.lanes|=r,ji|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$t=!0),e.memoizedState=r)}function x5(e,t){var r=De;De=r!==0&&4>r?r:4,e(!0);var n=$u.transition;$u.transition={};try{e(!1),t()}finally{De=r,$u.transition=n}}function aC(){return mr().memoizedState}function y5(e,t,r){var n=$n(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},lC(e))cC(t,r);else if(r=Hk(e,t,r,n),r!==null){var i=Dt();Er(r,e,n,i),uC(r,t,n)}}function b5(e,t,r){var n=$n(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(lC(e))cC(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,Tr(l,o)){var c=t.interleaved;c===null?(i.next=i,mx(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=Hk(e,t,i,n),r!==null&&(i=Dt(),Er(r,e,n,i),uC(r,t,n))}}function lC(e){var t=e.alternate;return e===Xe||t!==null&&t===Xe}function cC(e,t){ko=Wl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function uC(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tx(e,r)}}var Ul={readContext:hr,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},w5={readContext:hr,useCallback:function(e,t){return Fr().memoizedState=[e,t===void 0?null:t],e},useContext:hr,useEffect:j0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,vl(4194308,4,rC.bind(null,t,e),r)},useLayoutEffect:function(e,t){return vl(4194308,4,e,t)},useInsertionEffect:function(e,t){return vl(4,2,e,t)},useMemo:function(e,t){var r=Fr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Fr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=y5.bind(null,Xe,e),[n.memoizedState,e]},useRef:function(e){var t=Fr();return e={current:e},t.memoizedState=e},useState:_0,useDebugValue:Sx,useDeferredValue:function(e){return Fr().memoizedState=e},useTransition:function(){var e=_0(!1),t=e[0];return e=x5.bind(null,e[1]),Fr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Xe,i=Fr();if(We){if(r===void 0)throw Error(Q(407));r=r()}else{if(r=t(),vt===null)throw Error(Q(349));_i&30||Kk(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,j0(Xk.bind(null,n,s,e),[e]),n.flags|=2048,Ko(9,Yk.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Fr(),t=vt.identifierPrefix;if(We){var r=rn,n=tn;r=(n&~(1<<32-Nr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Vo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=v5++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_5={readContext:hr,useCallback:iC,useContext:hr,useEffect:jx,useImperativeHandle:nC,useInsertionEffect:eC,useLayoutEffect:tC,useMemo:sC,useReducer:Bu,useRef:Jk,useState:function(){return Bu(Go)},useDebugValue:Sx,useDeferredValue:function(e){var t=mr();return oC(t,ct.memoizedState,e)},useTransition:function(){var e=Bu(Go)[0],t=mr().memoizedState;return[e,t]},useMutableSource:Vk,useSyncExternalStore:Gk,useId:aC,unstable_isNewReconciler:!1},j5={readContext:hr,useCallback:iC,useContext:hr,useEffect:jx,useImperativeHandle:nC,useInsertionEffect:eC,useLayoutEffect:tC,useMemo:sC,useReducer:Hu,useRef:Jk,useState:function(){return Hu(Go)},useDebugValue:Sx,useDeferredValue:function(e){var t=mr();return ct===null?t.memoizedState=e:oC(t,ct.memoizedState,e)},useTransition:function(){var e=Hu(Go)[0],t=mr().memoizedState;return[e,t]},useMutableSource:Vk,useSyncExternalStore:Gk,useId:aC,unstable_isNewReconciler:!1};function _r(e,t){if(e&&e.defaultProps){t=Qe({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Qg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Qe({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Rc={isMounted:function(e){return(e=e._reactInternals)?Ei(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Dt(),i=$n(e),s=an(n,i);s.payload=t,r!=null&&(s.callback=r),t=qn(e,s,i),t!==null&&(Er(t,e,i,n),ml(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Dt(),i=$n(e),s=an(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=qn(e,s,i),t!==null&&(Er(t,e,i,n),ml(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Dt(),n=$n(e),i=an(r,n);i.tag=2,t!=null&&(i.callback=t),t=qn(e,i,n),t!==null&&(Er(t,e,n,r),ml(t,e,n))}};function S0(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!zo(r,n)||!zo(i,s):!0}function dC(e,t,r){var n=!1,i=Kn,s=t.contextType;return typeof s=="object"&&s!==null?s=hr(s):(i=Ut(t)?bi:Tt.current,n=t.contextTypes,s=(n=n!=null)?vs(e,i):Kn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Rc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function k0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Rc.enqueueReplaceState(t,t.state,null)}function Zg(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},gx(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=hr(s):(s=Ut(t)?bi:Tt.current,i.context=vs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Qg(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Rc.enqueueReplaceState(i,i.state,null),Bl(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ws(e,t){try{var r="",n=t;do r+=Q4(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Wu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Jg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var S5=typeof WeakMap=="function"?WeakMap:Map;function fC(e,t,r){r=an(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gl||(Gl=!0,cv=n),Jg(e,t)},r}function pC(e,t,r){r=an(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Jg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Jg(e,t),typeof n!="function"&&(zn===null?zn=new Set([this]):zn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function C0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new S5;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=F5.bind(null,e,t,r),t.then(e,e))}function N0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function E0(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=an(-1,1),t.tag=2,qn(r,t,1))),r.lanes|=1),e)}var k5=vn.ReactCurrentOwner,$t=!1;function Pt(e,t,r,n){t.child=e===null?Bk(t,null,r,n):ys(t,e.child,r,n)}function T0(e,t,r,n,i){r=r.render;var s=t.ref;return us(t,i),n=wx(e,t,r,n,s,i),r=_x(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fn(e,t,i)):(We&&r&&cx(t),t.flags|=1,Pt(e,t,n,i),t.child)}function R0(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Ix(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,hC(e,t,s,n,i)):(e=wl(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:zo,r(o,n)&&e.ref===t.ref)return fn(e,t,i)}return t.flags|=1,e=Bn(s,n),e.ref=t.ref,e.return=t,t.child=e}function hC(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(zo(s,n)&&e.ref===t.ref)if($t=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&($t=!0);else return t.lanes=e.lanes,fn(e,t,i)}return ev(e,t,r,n,i)}function mC(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(ts,Zt),Zt|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,qe(ts,Zt),Zt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,qe(ts,Zt),Zt|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,qe(ts,Zt),Zt|=n;return Pt(e,t,i,r),t.child}function gC(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ev(e,t,r,n,i){var s=Ut(r)?bi:Tt.current;return s=vs(t,s),us(t,i),r=wx(e,t,r,n,s,i),n=_x(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fn(e,t,i)):(We&&n&&cx(t),t.flags|=1,Pt(e,t,r,i),t.child)}function A0(e,t,r,n,i){if(Ut(r)){var s=!0;Ll(t)}else s=!1;if(us(t,i),t.stateNode===null)xl(e,t),dC(t,r,n),Zg(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=hr(u):(u=Ut(r)?bi:Tt.current,u=vs(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&k0(t,o,n,u),Sn=!1;var h=t.memoizedState;o.state=h,Bl(t,n,o,i),c=t.memoizedState,l!==n||h!==c||Wt.current||Sn?(typeof d=="function"&&(Qg(t,r,d,n),c=t.memoizedState),(l=Sn||S0(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Wk(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:_r(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=hr(c):(c=Ut(r)?bi:Tt.current,c=vs(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&k0(t,o,n,c),Sn=!1,h=t.memoizedState,o.state=h,Bl(t,n,o,i);var y=t.memoizedState;l!==f||h!==y||Wt.current||Sn?(typeof p=="function"&&(Qg(t,r,p,n),y=t.memoizedState),(u=Sn||S0(t,r,u,n,h,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return tv(e,t,r,n,s,i)}function tv(e,t,r,n,i,s){gC(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&g0(t,r,!1),fn(e,t,s);n=t.stateNode,k5.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ys(t,e.child,null,s),t.child=ys(t,null,l,s)):Pt(e,t,l,s),t.memoizedState=n.state,i&&g0(t,r,!0),t.child}function vC(e){var t=e.stateNode;t.pendingContext?m0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&m0(e,t.context,!1),vx(e,t.containerInfo)}function I0(e,t,r,n,i){return xs(),dx(i),t.flags|=256,Pt(e,t,r,n),t.child}var rv={dehydrated:null,treeContext:null,retryLane:0};function nv(e){return{baseLanes:e,cachePool:null,transitions:null}}function xC(e,t,r){var n=t.pendingProps,i=Ye.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),qe(Ye,i&1),e===null)return Yg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Mc(o,n,0,null),e=gi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=nv(r),t.memoizedState=rv,e):kx(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return C5(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bn(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Bn(l,s):(s=gi(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?nv(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=rv,n}return s=e.child,e=s.sibling,n=Bn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function kx(e,t){return t=Mc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ba(e,t,r,n){return n!==null&&dx(n),ys(t,e.child,null,r),e=kx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function C5(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Wu(Error(Q(422))),Ba(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Mc({mode:"visible",children:n.children},i,0,null),s=gi(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ys(t,e.child,null,o),t.child.memoizedState=nv(o),t.memoizedState=rv,s);if(!(t.mode&1))return Ba(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Q(419)),n=Wu(s,n,void 0),Ba(e,t,o,n)}if(l=(o&e.childLanes)!==0,$t||l){if(n=vt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,dn(e,i),Er(n,e,i,-1))}return Ax(),n=Wu(Error(Q(421))),Ba(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=q5.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,er=Fn(i.nextSibling),tr=t,We=!0,kr=null,e!==null&&(lr[cr++]=tn,lr[cr++]=rn,lr[cr++]=wi,tn=e.id,rn=e.overflow,wi=t),t=kx(t,n.children),t.flags|=4096,t)}function M0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Xg(e.return,t,r)}function Uu(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function yC(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Pt(e,t,n.children,r),n=Ye.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&M0(e,r,t);else if(e.tag===19)M0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(qe(Ye,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Hl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Uu(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Hl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Uu(t,!0,r,null,s);break;case"together":Uu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ji|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,r=Bn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function N5(e,t,r){switch(t.tag){case 3:vC(t),xs();break;case 5:Uk(t);break;case 1:Ut(t.type)&&Ll(t);break;case 4:vx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;qe(zl,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(qe(Ye,Ye.current&1),t.flags|=128,null):r&t.child.childLanes?xC(e,t,r):(qe(Ye,Ye.current&1),e=fn(e,t,r),e!==null?e.sibling:null);qe(Ye,Ye.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return yC(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),qe(Ye,Ye.current),n)break;return null;case 22:case 23:return t.lanes=0,mC(e,t,r)}return fn(e,t,r)}var bC,iv,wC,_C;bC=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};iv=function(){};wC=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,di(Br.current);var s=null;switch(r){case"input":i=Cg(e,i),n=Cg(e,n),s=[];break;case"select":i=Qe({},i,{value:void 0}),n=Qe({},n,{value:void 0}),s=[];break;case"textarea":i=Tg(e,i),n=Tg(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ol)}Ag(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Mo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Mo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Be("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};_C=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ks(e,t){if(!We)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function E5(e,t,r){var n=t.pendingProps;switch(ux(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(t),null;case 1:return Ut(t.type)&&Dl(),Nt(t),null;case 3:return n=t.stateNode,bs(),He(Wt),He(Tt),yx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(za(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,kr!==null&&(fv(kr),kr=null))),iv(e,t),Nt(t),null;case 5:xx(t);var i=di(Uo.current);if(r=t.type,e!==null&&t.stateNode!=null)wC(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Q(166));return Nt(t),null}if(e=di(Br.current),za(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[qr]=t,n[Ho]=s,e=(t.mode&1)!==0,r){case"dialog":Be("cancel",n),Be("close",n);break;case"iframe":case"object":case"embed":Be("load",n);break;case"video":case"audio":for(i=0;i<co.length;i++)Be(co[i],n);break;case"source":Be("error",n);break;case"img":case"image":case"link":Be("error",n),Be("load",n);break;case"details":Be("toggle",n);break;case"input":By(n,s),Be("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Be("invalid",n);break;case"textarea":Wy(n,s),Be("invalid",n)}Ag(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&qa(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&qa(n.textContent,l,e),i=["children",""+l]):Mo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Be("scroll",n)}switch(r){case"input":Aa(n),Hy(n,s,!0);break;case"textarea":Aa(n),Uy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ol)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=XS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[qr]=t,e[Ho]=n,bC(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ig(r,n),r){case"dialog":Be("cancel",e),Be("close",e),i=n;break;case"iframe":case"object":case"embed":Be("load",e),i=n;break;case"video":case"audio":for(i=0;i<co.length;i++)Be(co[i],e);i=n;break;case"source":Be("error",e),i=n;break;case"img":case"image":case"link":Be("error",e),Be("load",e),i=n;break;case"details":Be("toggle",e),i=n;break;case"input":By(e,n),i=Cg(e,n),Be("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Qe({},n,{value:void 0}),Be("invalid",e);break;case"textarea":Wy(e,n),i=Tg(e,n),Be("invalid",e);break;default:i=n}Ag(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?JS(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&QS(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Po(e,c):typeof c=="number"&&Po(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Mo.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Be("scroll",e):c!=null&&Yv(e,s,c,o))}switch(r){case"input":Aa(e),Hy(e,n,!1);break;case"textarea":Aa(e),Uy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Gn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?os(e,!!n.multiple,s,!1):n.defaultValue!=null&&os(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Ol)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nt(t),null;case 6:if(e&&t.stateNode!=null)_C(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Q(166));if(r=di(Uo.current),di(Br.current),za(t)){if(n=t.stateNode,r=t.memoizedProps,n[qr]=t,(s=n.nodeValue!==r)&&(e=tr,e!==null))switch(e.tag){case 3:qa(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qa(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[qr]=t,t.stateNode=n}return Nt(t),null;case 13:if(He(Ye),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(We&&er!==null&&t.mode&1&&!(t.flags&128))zk(),xs(),t.flags|=98560,s=!1;else if(s=za(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Q(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[qr]=t}else xs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nt(t),s=!1}else kr!==null&&(fv(kr),kr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ye.current&1?ft===0&&(ft=3):Ax())),t.updateQueue!==null&&(t.flags|=4),Nt(t),null);case 4:return bs(),iv(e,t),e===null&&$o(t.stateNode.containerInfo),Nt(t),null;case 10:return hx(t.type._context),Nt(t),null;case 17:return Ut(t.type)&&Dl(),Nt(t),null;case 19:if(He(Ye),s=t.memoizedState,s===null)return Nt(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Ks(s,!1);else{if(ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Hl(e),o!==null){for(t.flags|=128,Ks(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return qe(Ye,Ye.current&1|2),t.child}e=e.sibling}s.tail!==null&&it()>_s&&(t.flags|=128,n=!0,Ks(s,!1),t.lanes=4194304)}else{if(!n)if(e=Hl(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ks(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!We)return Nt(t),null}else 2*it()-s.renderingStartTime>_s&&r!==1073741824&&(t.flags|=128,n=!0,Ks(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=it(),t.sibling=null,r=Ye.current,qe(Ye,n?r&1|2:r&1),t):(Nt(t),null);case 22:case 23:return Rx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Zt&1073741824&&(Nt(t),t.subtreeFlags&6&&(t.flags|=8192)):Nt(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function T5(e,t){switch(ux(t),t.tag){case 1:return Ut(t.type)&&Dl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bs(),He(Wt),He(Tt),yx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return xx(t),null;case 13:if(He(Ye),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));xs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return He(Ye),null;case 4:return bs(),null;case 10:return hx(t.type._context),null;case 22:case 23:return Rx(),null;case 24:return null;default:return null}}var Ha=!1,Et=!1,R5=typeof WeakSet=="function"?WeakSet:Set,ne=null;function es(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function sv(e,t,r){try{r()}catch(n){tt(e,t,n)}}var P0=!1;function A5(e,t){if(Bg=Il,e=Nk(),lx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===i&&(l=o),h===s&&++d===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hg={focusedElem:e,selectionRange:r},Il=!1,ne=t;ne!==null;)if(t=ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ne=e;else for(;ne!==null;){t=ne;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,w=y.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:_r(t.type,g),w);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(_){tt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,ne=e;break}ne=t.return}return y=P0,P0=!1,y}function Co(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&sv(t,r,s)}i=i.next}while(i!==n)}}function Ac(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ov(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function jC(e){var t=e.alternate;t!==null&&(e.alternate=null,jC(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qr],delete t[Ho],delete t[Vg],delete t[p5],delete t[h5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function SC(e){return e.tag===5||e.tag===3||e.tag===4}function O0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||SC(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function av(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ol));else if(n!==4&&(e=e.child,e!==null))for(av(e,t,r),e=e.sibling;e!==null;)av(e,t,r),e=e.sibling}function lv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(lv(e,t,r),e=e.sibling;e!==null;)lv(e,t,r),e=e.sibling}var wt=null,jr=!1;function bn(e,t,r){for(r=r.child;r!==null;)kC(e,t,r),r=r.sibling}function kC(e,t,r){if($r&&typeof $r.onCommitFiberUnmount=="function")try{$r.onCommitFiberUnmount(jc,r)}catch{}switch(r.tag){case 5:Et||es(r,t);case 6:var n=wt,i=jr;wt=null,bn(e,t,r),wt=n,jr=i,wt!==null&&(jr?(e=wt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):wt.removeChild(r.stateNode));break;case 18:wt!==null&&(jr?(e=wt,r=r.stateNode,e.nodeType===8?Fu(e.parentNode,r):e.nodeType===1&&Fu(e,r),Fo(e)):Fu(wt,r.stateNode));break;case 4:n=wt,i=jr,wt=r.stateNode.containerInfo,jr=!0,bn(e,t,r),wt=n,jr=i;break;case 0:case 11:case 14:case 15:if(!Et&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&sv(r,t,o),i=i.next}while(i!==n)}bn(e,t,r);break;case 1:if(!Et&&(es(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){tt(r,t,l)}bn(e,t,r);break;case 21:bn(e,t,r);break;case 22:r.mode&1?(Et=(n=Et)||r.memoizedState!==null,bn(e,t,r),Et=n):bn(e,t,r);break;default:bn(e,t,r)}}function D0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new R5),t.forEach(function(n){var i=z5.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function yr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:wt=l.stateNode,jr=!1;break e;case 3:wt=l.stateNode.containerInfo,jr=!0;break e;case 4:wt=l.stateNode.containerInfo,jr=!0;break e}l=l.return}if(wt===null)throw Error(Q(160));kC(s,o,i),wt=null,jr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){tt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)CC(t,e),t=t.sibling}function CC(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yr(t,e),Dr(e),n&4){try{Co(3,e,e.return),Ac(3,e)}catch(g){tt(e,e.return,g)}try{Co(5,e,e.return)}catch(g){tt(e,e.return,g)}}break;case 1:yr(t,e),Dr(e),n&512&&r!==null&&es(r,r.return);break;case 5:if(yr(t,e),Dr(e),n&512&&r!==null&&es(r,r.return),e.flags&32){var i=e.stateNode;try{Po(i,"")}catch(g){tt(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&KS(i,s),Ig(l,o);var u=Ig(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?JS(i,f):d==="dangerouslySetInnerHTML"?QS(i,f):d==="children"?Po(i,f):Yv(i,d,f,u)}switch(l){case"input":Ng(i,s);break;case"textarea":YS(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?os(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?os(i,!!s.multiple,s.defaultValue,!0):os(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ho]=s}catch(g){tt(e,e.return,g)}}break;case 6:if(yr(t,e),Dr(e),n&4){if(e.stateNode===null)throw Error(Q(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){tt(e,e.return,g)}}break;case 3:if(yr(t,e),Dr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Fo(t.containerInfo)}catch(g){tt(e,e.return,g)}break;case 4:yr(t,e),Dr(e);break;case 13:yr(t,e),Dr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ex=it())),n&4&&D0(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Et=(u=Et)||d,yr(t,e),Et=u):yr(t,e),Dr(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ne=e,d=e.child;d!==null;){for(f=ne=d;ne!==null;){switch(h=ne,p=h.child,h.tag){case 0:case 11:case 14:case 15:Co(4,h,h.return);break;case 1:es(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(g){tt(n,r,g)}}break;case 5:es(h,h.return);break;case 22:if(h.memoizedState!==null){F0(f);continue}}p!==null?(p.return=h,ne=p):F0(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ZS("display",o))}catch(g){tt(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){tt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:yr(t,e),Dr(e),n&4&&D0(e);break;case 21:break;default:yr(t,e),Dr(e)}}function Dr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(SC(r)){var n=r;break e}r=r.return}throw Error(Q(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Po(i,""),n.flags&=-33);var s=O0(e);lv(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=O0(e);av(e,l,o);break;default:throw Error(Q(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function I5(e,t,r){ne=e,NC(e)}function NC(e,t,r){for(var n=(e.mode&1)!==0;ne!==null;){var i=ne,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Ha;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Et;l=Ha;var u=Et;if(Ha=o,(Et=c)&&!u)for(ne=i;ne!==null;)o=ne,c=o.child,o.tag===22&&o.memoizedState!==null?q0(i):c!==null?(c.return=o,ne=c):q0(i);for(;s!==null;)ne=s,NC(s),s=s.sibling;ne=i,Ha=l,Et=u}L0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ne=s):L0(e)}}function L0(e){for(;ne!==null;){var t=ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Et||Ac(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Et)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:_r(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&w0(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}w0(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Fo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}Et||t.flags&512&&ov(t)}catch(h){tt(t,t.return,h)}}if(t===e){ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,ne=r;break}ne=t.return}}function F0(e){for(;ne!==null;){var t=ne;if(t===e){ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ne=r;break}ne=t.return}}function q0(e){for(;ne!==null;){var t=ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ac(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){tt(t,i,c)}}var s=t.return;try{ov(t)}catch(c){tt(t,s,c)}break;case 5:var o=t.return;try{ov(t)}catch(c){tt(t,o,c)}}}catch(c){tt(t,t.return,c)}if(t===e){ne=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ne=l;break}ne=t.return}}var M5=Math.ceil,Vl=vn.ReactCurrentDispatcher,Cx=vn.ReactCurrentOwner,pr=vn.ReactCurrentBatchConfig,Ie=0,vt=null,st=null,_t=0,Zt=0,ts=Zn(0),ft=0,Yo=null,ji=0,Ic=0,Nx=0,No=null,zt=null,Ex=0,_s=1/0,Zr=null,Gl=!1,cv=null,zn=null,Wa=!1,Pn=null,Kl=0,Eo=0,uv=null,yl=-1,bl=0;function Dt(){return Ie&6?it():yl!==-1?yl:yl=it()}function $n(e){return e.mode&1?Ie&2&&_t!==0?_t&-_t:g5.transition!==null?(bl===0&&(bl=dk()),bl):(e=De,e!==0||(e=window.event,e=e===void 0?16:xk(e.type)),e):1}function Er(e,t,r,n){if(50<Eo)throw Eo=0,uv=null,Error(Q(185));fa(e,r,n),(!(Ie&2)||e!==vt)&&(e===vt&&(!(Ie&2)&&(Ic|=r),ft===4&&Tn(e,_t)),Vt(e,n),r===1&&Ie===0&&!(t.mode&1)&&(_s=it()+500,Ec&&Jn()))}function Vt(e,t){var r=e.callbackNode;gA(e,t);var n=Al(e,e===vt?_t:0);if(n===0)r!==null&&Ky(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ky(r),t===1)e.tag===0?m5(z0.bind(null,e)):Lk(z0.bind(null,e)),d5(function(){!(Ie&6)&&Jn()}),r=null;else{switch(fk(n)){case 1:r=ex;break;case 4:r=ck;break;case 16:r=Rl;break;case 536870912:r=uk;break;default:r=Rl}r=OC(r,EC.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function EC(e,t){if(yl=-1,bl=0,Ie&6)throw Error(Q(327));var r=e.callbackNode;if(ds()&&e.callbackNode!==r)return null;var n=Al(e,e===vt?_t:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Yl(e,n);else{t=n;var i=Ie;Ie|=2;var s=RC();(vt!==e||_t!==t)&&(Zr=null,_s=it()+500,mi(e,t));do try{D5();break}catch(l){TC(e,l)}while(!0);px(),Vl.current=s,Ie=i,st!==null?t=0:(vt=null,_t=0,t=ft)}if(t!==0){if(t===2&&(i=Lg(e),i!==0&&(n=i,t=dv(e,i))),t===1)throw r=Yo,mi(e,0),Tn(e,n),Vt(e,it()),r;if(t===6)Tn(e,n);else{if(i=e.current.alternate,!(n&30)&&!P5(i)&&(t=Yl(e,n),t===2&&(s=Lg(e),s!==0&&(n=s,t=dv(e,s))),t===1))throw r=Yo,mi(e,0),Tn(e,n),Vt(e,it()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Q(345));case 2:ai(e,zt,Zr);break;case 3:if(Tn(e,n),(n&130023424)===n&&(t=Ex+500-it(),10<t)){if(Al(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Dt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ug(ai.bind(null,e,zt,Zr),t);break}ai(e,zt,Zr);break;case 4:if(Tn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Nr(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=it()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*M5(n/1960))-n,10<n){e.timeoutHandle=Ug(ai.bind(null,e,zt,Zr),n);break}ai(e,zt,Zr);break;case 5:ai(e,zt,Zr);break;default:throw Error(Q(329))}}}return Vt(e,it()),e.callbackNode===r?EC.bind(null,e):null}function dv(e,t){var r=No;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=Yl(e,t),e!==2&&(t=zt,zt=r,t!==null&&fv(t)),e}function fv(e){zt===null?zt=e:zt.push.apply(zt,e)}function P5(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Tr(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tn(e,t){for(t&=~Nx,t&=~Ic,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Nr(t),n=1<<r;e[r]=-1,t&=~n}}function z0(e){if(Ie&6)throw Error(Q(327));ds();var t=Al(e,0);if(!(t&1))return Vt(e,it()),null;var r=Yl(e,t);if(e.tag!==0&&r===2){var n=Lg(e);n!==0&&(t=n,r=dv(e,n))}if(r===1)throw r=Yo,mi(e,0),Tn(e,t),Vt(e,it()),r;if(r===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ai(e,zt,Zr),Vt(e,it()),null}function Tx(e,t){var r=Ie;Ie|=1;try{return e(t)}finally{Ie=r,Ie===0&&(_s=it()+500,Ec&&Jn())}}function Si(e){Pn!==null&&Pn.tag===0&&!(Ie&6)&&ds();var t=Ie;Ie|=1;var r=pr.transition,n=De;try{if(pr.transition=null,De=1,e)return e()}finally{De=n,pr.transition=r,Ie=t,!(Ie&6)&&Jn()}}function Rx(){Zt=ts.current,He(ts)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,u5(r)),st!==null)for(r=st.return;r!==null;){var n=r;switch(ux(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Dl();break;case 3:bs(),He(Wt),He(Tt),yx();break;case 5:xx(n);break;case 4:bs();break;case 13:He(Ye);break;case 19:He(Ye);break;case 10:hx(n.type._context);break;case 22:case 23:Rx()}r=r.return}if(vt=e,st=e=Bn(e.current,null),_t=Zt=t,ft=0,Yo=null,Nx=Ic=ji=0,zt=No=null,ui!==null){for(t=0;t<ui.length;t++)if(r=ui[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}ui=null}return e}function TC(e,t){do{var r=st;try{if(px(),gl.current=Ul,Wl){for(var n=Xe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Wl=!1}if(_i=0,mt=ct=Xe=null,ko=!1,Vo=0,Cx.current=null,r===null||r.return===null){ft=1,Yo=t,st=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=_t,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=N0(o);if(p!==null){p.flags&=-257,E0(p,o,l,s,t),p.mode&1&&C0(s,u,t),t=p,c=u;var y=t.updateQueue;if(y===null){var g=new Set;g.add(c),t.updateQueue=g}else y.add(c);break e}else{if(!(t&1)){C0(s,u,t),Ax();break e}c=Error(Q(426))}}else if(We&&l.mode&1){var w=N0(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),E0(w,o,l,s,t),dx(ws(c,l));break e}}s=c=ws(c,l),ft!==4&&(ft=2),No===null?No=[s]:No.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=fC(s,c,t);b0(s,v);break e;case 1:l=c;var x=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(zn===null||!zn.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=pC(s,l,t);b0(s,_);break e}}s=s.return}while(s!==null)}IC(r)}catch(j){t=j,st===r&&r!==null&&(st=r=r.return);continue}break}while(!0)}function RC(){var e=Vl.current;return Vl.current=Ul,e===null?Ul:e}function Ax(){(ft===0||ft===3||ft===2)&&(ft=4),vt===null||!(ji&268435455)&&!(Ic&268435455)||Tn(vt,_t)}function Yl(e,t){var r=Ie;Ie|=2;var n=RC();(vt!==e||_t!==t)&&(Zr=null,mi(e,t));do try{O5();break}catch(i){TC(e,i)}while(!0);if(px(),Ie=r,Vl.current=n,st!==null)throw Error(Q(261));return vt=null,_t=0,ft}function O5(){for(;st!==null;)AC(st)}function D5(){for(;st!==null&&!aA();)AC(st)}function AC(e){var t=PC(e.alternate,e,Zt);e.memoizedProps=e.pendingProps,t===null?IC(e):st=t,Cx.current=null}function IC(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=T5(r,t),r!==null){r.flags&=32767,st=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ft=6,st=null;return}}else if(r=E5(r,t,Zt),r!==null){st=r;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ft===0&&(ft=5)}function ai(e,t,r){var n=De,i=pr.transition;try{pr.transition=null,De=1,L5(e,t,r,n)}finally{pr.transition=i,De=n}return null}function L5(e,t,r,n){do ds();while(Pn!==null);if(Ie&6)throw Error(Q(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(vA(e,s),e===vt&&(st=vt=null,_t=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Wa||(Wa=!0,OC(Rl,function(){return ds(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=pr.transition,pr.transition=null;var o=De;De=1;var l=Ie;Ie|=4,Cx.current=null,A5(e,r),CC(r,e),n5(Hg),Il=!!Bg,Hg=Bg=null,e.current=r,I5(r),lA(),Ie=l,De=o,pr.transition=s}else e.current=r;if(Wa&&(Wa=!1,Pn=e,Kl=i),s=e.pendingLanes,s===0&&(zn=null),dA(r.stateNode),Vt(e,it()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Gl)throw Gl=!1,e=cv,cv=null,e;return Kl&1&&e.tag!==0&&ds(),s=e.pendingLanes,s&1?e===uv?Eo++:(Eo=0,uv=e):Eo=0,Jn(),null}function ds(){if(Pn!==null){var e=fk(Kl),t=pr.transition,r=De;try{if(pr.transition=null,De=16>e?16:e,Pn===null)var n=!1;else{if(e=Pn,Pn=null,Kl=0,Ie&6)throw Error(Q(331));var i=Ie;for(Ie|=4,ne=e.current;ne!==null;){var s=ne,o=s.child;if(ne.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ne=u;ne!==null;){var d=ne;switch(d.tag){case 0:case 11:case 15:Co(8,d,s)}var f=d.child;if(f!==null)f.return=d,ne=f;else for(;ne!==null;){d=ne;var h=d.sibling,p=d.return;if(jC(d),d===u){ne=null;break}if(h!==null){h.return=p,ne=h;break}ne=p}}}var y=s.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}ne=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ne=o;else e:for(;ne!==null;){if(s=ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Co(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ne=v;break e}ne=s.return}}var x=e.current;for(ne=x;ne!==null;){o=ne;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ne=b;else e:for(o=x;ne!==null;){if(l=ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ac(9,l)}}catch(j){tt(l,l.return,j)}if(l===o){ne=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,ne=_;break e}ne=l.return}}if(Ie=i,Jn(),$r&&typeof $r.onPostCommitFiberRoot=="function")try{$r.onPostCommitFiberRoot(jc,e)}catch{}n=!0}return n}finally{De=r,pr.transition=t}}return!1}function $0(e,t,r){t=ws(r,t),t=fC(e,t,1),e=qn(e,t,1),t=Dt(),e!==null&&(fa(e,1,t),Vt(e,t))}function tt(e,t,r){if(e.tag===3)$0(e,e,r);else for(;t!==null;){if(t.tag===3){$0(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(zn===null||!zn.has(n))){e=ws(r,e),e=pC(t,e,1),t=qn(t,e,1),e=Dt(),t!==null&&(fa(t,1,e),Vt(t,e));break}}t=t.return}}function F5(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Dt(),e.pingedLanes|=e.suspendedLanes&r,vt===e&&(_t&r)===r&&(ft===4||ft===3&&(_t&130023424)===_t&&500>it()-Ex?mi(e,0):Nx|=r),Vt(e,t)}function MC(e,t){t===0&&(e.mode&1?(t=Pa,Pa<<=1,!(Pa&130023424)&&(Pa=4194304)):t=1);var r=Dt();e=dn(e,t),e!==null&&(fa(e,t,r),Vt(e,r))}function q5(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),MC(e,r)}function z5(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Q(314))}n!==null&&n.delete(t),MC(e,r)}var PC;PC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wt.current)$t=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return $t=!1,N5(e,t,r);$t=!!(e.flags&131072)}else $t=!1,We&&t.flags&1048576&&Fk(t,ql,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;xl(e,t),e=t.pendingProps;var i=vs(t,Tt.current);us(t,r),i=wx(null,t,n,e,i,r);var s=_x();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ut(n)?(s=!0,Ll(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,gx(t),i.updater=Rc,t.stateNode=i,i._reactInternals=t,Zg(t,n,e,r),t=tv(null,t,n,!0,s,r)):(t.tag=0,We&&s&&cx(t),Pt(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(xl(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=B5(n),e=_r(n,e),i){case 0:t=ev(null,t,n,e,r);break e;case 1:t=A0(null,t,n,e,r);break e;case 11:t=T0(null,t,n,e,r);break e;case 14:t=R0(null,t,n,_r(n.type,e),r);break e}throw Error(Q(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:_r(n,i),ev(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:_r(n,i),A0(e,t,n,i,r);case 3:e:{if(vC(t),e===null)throw Error(Q(387));n=t.pendingProps,s=t.memoizedState,i=s.element,Wk(e,t),Bl(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=ws(Error(Q(423)),t),t=I0(e,t,n,r,i);break e}else if(n!==i){i=ws(Error(Q(424)),t),t=I0(e,t,n,r,i);break e}else for(er=Fn(t.stateNode.containerInfo.firstChild),tr=t,We=!0,kr=null,r=Bk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(xs(),n===i){t=fn(e,t,r);break e}Pt(e,t,n,r)}t=t.child}return t;case 5:return Uk(t),e===null&&Yg(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Wg(n,i)?o=null:s!==null&&Wg(n,s)&&(t.flags|=32),gC(e,t),Pt(e,t,o,r),t.child;case 6:return e===null&&Yg(t),null;case 13:return xC(e,t,r);case 4:return vx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ys(t,null,n,r):Pt(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:_r(n,i),T0(e,t,n,i,r);case 7:return Pt(e,t,t.pendingProps,r),t.child;case 8:return Pt(e,t,t.pendingProps.children,r),t.child;case 12:return Pt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,qe(zl,n._currentValue),n._currentValue=o,s!==null)if(Tr(s.value,o)){if(s.children===i.children&&!Wt.current){t=fn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=an(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Xg(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Q(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Xg(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Pt(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,us(t,r),i=hr(i),n=n(i),t.flags|=1,Pt(e,t,n,r),t.child;case 14:return n=t.type,i=_r(n,t.pendingProps),i=_r(n.type,i),R0(e,t,n,i,r);case 15:return hC(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:_r(n,i),xl(e,t),t.tag=1,Ut(n)?(e=!0,Ll(t)):e=!1,us(t,r),dC(t,n,i),Zg(t,n,i,r),tv(null,t,n,!0,e,r);case 19:return yC(e,t,r);case 22:return mC(e,t,r)}throw Error(Q(156,t.tag))};function OC(e,t){return lk(e,t)}function $5(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dr(e,t,r,n){return new $5(e,t,r,n)}function Ix(e){return e=e.prototype,!(!e||!e.isReactComponent)}function B5(e){if(typeof e=="function")return Ix(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qv)return 11;if(e===Zv)return 14}return 2}function Bn(e,t){var r=e.alternate;return r===null?(r=dr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function wl(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")Ix(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ui:return gi(r.children,i,s,t);case Xv:o=8,i|=8;break;case _g:return e=dr(12,r,t,i|2),e.elementType=_g,e.lanes=s,e;case jg:return e=dr(13,r,t,i),e.elementType=jg,e.lanes=s,e;case Sg:return e=dr(19,r,t,i),e.elementType=Sg,e.lanes=s,e;case US:return Mc(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case HS:o=10;break e;case WS:o=9;break e;case Qv:o=11;break e;case Zv:o=14;break e;case jn:o=16,n=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=dr(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function gi(e,t,r,n){return e=dr(7,e,n,t),e.lanes=r,e}function Mc(e,t,r,n){return e=dr(22,e,n,t),e.elementType=US,e.lanes=r,e.stateNode={isHidden:!1},e}function Vu(e,t,r){return e=dr(6,e,null,t),e.lanes=r,e}function Gu(e,t,r){return t=dr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function H5(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nu(0),this.expirationTimes=Nu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Mx(e,t,r,n,i,s,o,l,c){return e=new H5(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=dr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},gx(s),e}function W5(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function DC(e){if(!e)return Kn;e=e._reactInternals;e:{if(Ei(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ut(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var r=e.type;if(Ut(r))return Dk(e,r,t)}return t}function LC(e,t,r,n,i,s,o,l,c){return e=Mx(r,n,!0,e,i,s,o,l,c),e.context=DC(null),r=e.current,n=Dt(),i=$n(r),s=an(n,i),s.callback=t??null,qn(r,s,i),e.current.lanes=i,fa(e,i,n),Vt(e,n),e}function Pc(e,t,r,n){var i=t.current,s=Dt(),o=$n(i);return r=DC(r),t.context===null?t.context=r:t.pendingContext=r,t=an(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=qn(i,t,o),e!==null&&(Er(e,i,o,s),ml(e,i,o)),o}function Xl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function B0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Px(e,t){B0(e,t),(e=e.alternate)&&B0(e,t)}function U5(){return null}var FC=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ox(e){this._internalRoot=e}Oc.prototype.render=Ox.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));Pc(e,t,null,null)};Oc.prototype.unmount=Ox.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Si(function(){Pc(null,e,null,null)}),t[un]=null}};function Oc(e){this._internalRoot=e}Oc.prototype.unstable_scheduleHydration=function(e){if(e){var t=mk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<En.length&&t!==0&&t<En[r].priority;r++);En.splice(r,0,e),r===0&&vk(e)}};function Dx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Dc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function H0(){}function V5(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Xl(o);s.call(u)}}var o=LC(t,n,e,0,null,!1,!1,"",H0);return e._reactRootContainer=o,e[un]=o.current,$o(e.nodeType===8?e.parentNode:e),Si(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=Xl(c);l.call(u)}}var c=Mx(e,0,!1,null,null,!1,!1,"",H0);return e._reactRootContainer=c,e[un]=c.current,$o(e.nodeType===8?e.parentNode:e),Si(function(){Pc(t,c,r,n)}),c}function Lc(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Xl(o);l.call(c)}}Pc(t,o,e,i)}else o=V5(r,t,e,i,n);return Xl(o)}pk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=lo(t.pendingLanes);r!==0&&(tx(t,r|1),Vt(t,it()),!(Ie&6)&&(_s=it()+500,Jn()))}break;case 13:Si(function(){var n=dn(e,1);if(n!==null){var i=Dt();Er(n,e,1,i)}}),Px(e,1)}};rx=function(e){if(e.tag===13){var t=dn(e,134217728);if(t!==null){var r=Dt();Er(t,e,134217728,r)}Px(e,134217728)}};hk=function(e){if(e.tag===13){var t=$n(e),r=dn(e,t);if(r!==null){var n=Dt();Er(r,e,t,n)}Px(e,t)}};mk=function(){return De};gk=function(e,t){var r=De;try{return De=e,t()}finally{De=r}};Pg=function(e,t,r){switch(t){case"input":if(Ng(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Nc(n);if(!i)throw Error(Q(90));GS(n),Ng(n,i)}}}break;case"textarea":YS(e,r);break;case"select":t=r.value,t!=null&&os(e,!!r.multiple,t,!1)}};rk=Tx;nk=Si;var G5={usingClientEntryPoint:!1,Events:[ha,Yi,Nc,ek,tk,Tx]},Ys={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},K5={bundleType:Ys.bundleType,version:Ys.version,rendererPackageName:Ys.rendererPackageName,rendererConfig:Ys.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ok(e),e===null?null:e.stateNode},findFiberByHostInstance:Ys.findFiberByHostInstance||U5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ua=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ua.isDisabled&&Ua.supportsFiber)try{jc=Ua.inject(K5),$r=Ua}catch{}}ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G5;ir.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dx(t))throw Error(Q(200));return W5(e,t,null,r)};ir.createRoot=function(e,t){if(!Dx(e))throw Error(Q(299));var r=!1,n="",i=FC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Mx(e,1,!1,null,null,r,!1,n,i),e[un]=t.current,$o(e.nodeType===8?e.parentNode:e),new Ox(t)};ir.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=ok(t),e=e===null?null:e.stateNode,e};ir.flushSync=function(e){return Si(e)};ir.hydrate=function(e,t,r){if(!Dc(t))throw Error(Q(200));return Lc(null,e,t,!0,r)};ir.hydrateRoot=function(e,t,r){if(!Dx(e))throw Error(Q(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=FC;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=LC(t,null,e,1,r??null,i,!1,s,o),e[un]=t.current,$o(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Oc(t)};ir.render=function(e,t,r){if(!Dc(t))throw Error(Q(200));return Lc(null,e,t,!1,r)};ir.unmountComponentAtNode=function(e){if(!Dc(e))throw Error(Q(40));return e._reactRootContainer?(Si(function(){Lc(null,null,e,!1,function(){e._reactRootContainer=null,e[un]=null})}),!0):!1};ir.unstable_batchedUpdates=Tx;ir.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Dc(r))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return Lc(e,t,r,!1,n)};ir.version="18.3.1-next-f1338f8080-20240426";function qC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qC)}catch(e){console.error(e)}}qC(),qS.exports=ir;var rs=qS.exports,W0=rs;bg.createRoot=W0.createRoot,bg.hydrateRoot=W0.hydrateRoot;function Kt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Kt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var zC={exports:{}},$C={},BC={exports:{}},HC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var js=m;function Y5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var X5=typeof Object.is=="function"?Object.is:Y5,Q5=js.useState,Z5=js.useEffect,J5=js.useLayoutEffect,e3=js.useDebugValue;function t3(e,t){var r=t(),n=Q5({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return J5(function(){i.value=r,i.getSnapshot=t,Ku(i)&&s({inst:i})},[e,r,t]),Z5(function(){return Ku(i)&&s({inst:i}),e(function(){Ku(i)&&s({inst:i})})},[e]),e3(r),r}function Ku(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!X5(e,r)}catch{return!0}}function r3(e,t){return t()}var n3=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?r3:t3;HC.useSyncExternalStore=js.useSyncExternalStore!==void 0?js.useSyncExternalStore:n3;BC.exports=HC;var i3=BC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fc=m,s3=i3;function o3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var a3=typeof Object.is=="function"?Object.is:o3,l3=s3.useSyncExternalStore,c3=Fc.useRef,u3=Fc.useEffect,d3=Fc.useMemo,f3=Fc.useDebugValue;$C.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=c3(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=d3(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var y=o.value;if(i(y,p))return f=y}return f=p}if(y=f,a3(d,p))return y;var g=n(p);return i!==void 0&&i(y,g)?(d=p,y):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=l3(e,s[0],s[1]);return u3(function(){o.hasValue=!0,o.value=l},[l]),f3(l),l};zC.exports=$C;var p3=zC.exports;const h3=Bv(p3),m3={},U0=e=>{let t;const r=new Set,n=(d,f)=>{const h=typeof d=="function"?d(t):d;if(!Object.is(h,t)){const p=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(y=>y(t,p))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(m3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,i,c);return c},g3=e=>e?U0(e):U0,{useDebugValue:v3}=G,{useSyncExternalStoreWithSelector:x3}=h3,y3=e=>e;function WC(e,t=y3,r){const n=x3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return v3(n),n}const V0=(e,t)=>{const r=g3(e),n=(i,s=t)=>WC(r,i,s);return Object.assign(n,r),n},b3=(e,t)=>e?V0(e,t):V0;function Rt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var w3={value:()=>{}};function qc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new _l(r)}function _l(e){this._=e}function _3(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}_l.prototype=qc.prototype={constructor:_l,on:function(e,t){var r=this._,n=_3(e+"",r),i,s=-1,o=n.length;if(arguments.length<2){for(;++s<o;)if((i=(e=n[s]).type)&&(i=j3(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=n[s]).type)r[i]=G0(r[i],e.name,t);else if(t==null)for(i in r)r[i]=G0(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new _l(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,s;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],n=0,i=s.length;n<i;++n)s[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,s=n.length;i<s;++i)n[i].value.apply(t,r)}};function j3(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function G0(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=w3,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var pv="http://www.w3.org/1999/xhtml";const K0={svg:"http://www.w3.org/2000/svg",xhtml:pv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),K0.hasOwnProperty(t)?{space:K0[t],local:e}:e}function S3(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===pv&&t.documentElement.namespaceURI===pv?t.createElement(e):t.createElementNS(r,e)}}function k3(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function UC(e){var t=zc(e);return(t.local?k3:S3)(t)}function C3(){}function Lx(e){return e==null?C3:function(){return this.querySelector(e)}}function N3(e){typeof e!="function"&&(e=Lx(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=new Array(o),c,u,d=0;d<o;++d)(c=s[d])&&(u=e.call(c,c.__data__,d,s))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u);return new nr(n,this._parents)}function E3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function T3(){return[]}function VC(e){return e==null?T3:function(){return this.querySelectorAll(e)}}function R3(e){return function(){return E3(e.apply(this,arguments))}}function A3(e){typeof e=="function"?e=R3(e):e=VC(e);for(var t=this._groups,r=t.length,n=[],i=[],s=0;s<r;++s)for(var o=t[s],l=o.length,c,u=0;u<l;++u)(c=o[u])&&(n.push(e.call(c,c.__data__,u,o)),i.push(c));return new nr(n,i)}function GC(e){return function(){return this.matches(e)}}function KC(e){return function(t){return t.matches(e)}}var I3=Array.prototype.find;function M3(e){return function(){return I3.call(this.children,e)}}function P3(){return this.firstElementChild}function O3(e){return this.select(e==null?P3:M3(typeof e=="function"?e:KC(e)))}var D3=Array.prototype.filter;function L3(){return Array.from(this.children)}function F3(e){return function(){return D3.call(this.children,e)}}function q3(e){return this.selectAll(e==null?L3:F3(typeof e=="function"?e:KC(e)))}function z3(e){typeof e!="function"&&(e=GC(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&l.push(c);return new nr(n,this._parents)}function YC(e){return new Array(e.length)}function $3(){return new nr(this._enter||this._groups.map(YC),this._parents)}function Ql(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ql.prototype={constructor:Ql,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function B3(e){return function(){return e}}function H3(e,t,r,n,i,s){for(var o=0,l,c=t.length,u=s.length;o<u;++o)(l=t[o])?(l.__data__=s[o],n[o]=l):r[o]=new Ql(e,s[o]);for(;o<c;++o)(l=t[o])&&(i[o]=l)}function W3(e,t,r,n,i,s,o){var l,c,u=new Map,d=t.length,f=s.length,h=new Array(d),p;for(l=0;l<d;++l)(c=t[l])&&(h[l]=p=o.call(c,c.__data__,l,t)+"",u.has(p)?i[l]=c:u.set(p,c));for(l=0;l<f;++l)p=o.call(e,s[l],l,s)+"",(c=u.get(p))?(n[l]=c,c.__data__=s[l],u.delete(p)):r[l]=new Ql(e,s[l]);for(l=0;l<d;++l)(c=t[l])&&u.get(h[l])===c&&(i[l]=c)}function U3(e){return e.__data__}function V3(e,t){if(!arguments.length)return Array.from(this,U3);var r=t?W3:H3,n=this._parents,i=this._groups;typeof e!="function"&&(e=B3(e));for(var s=i.length,o=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var d=n[u],f=i[u],h=f.length,p=G3(e.call(d,d&&d.__data__,u,n)),y=p.length,g=l[u]=new Array(y),w=o[u]=new Array(y),v=c[u]=new Array(h);r(d,f,g,w,v,p,t);for(var x=0,b=0,_,j;x<y;++x)if(_=g[x]){for(x>=b&&(b=x+1);!(j=w[b])&&++b<y;);_._next=j||null}}return o=new nr(o,n),o._enter=l,o._exit=c,o}function G3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function K3(){return new nr(this._exit||this._groups.map(YC),this._parents)}function Y3(e,t,r){var n=this.enter(),i=this,s=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?s.remove():r(s),n&&i?n.merge(i).order():i}function X3(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,s=n.length,o=Math.min(i,s),l=new Array(i),c=0;c<o;++c)for(var u=r[c],d=n[c],f=u.length,h=l[c]=new Array(f),p,y=0;y<f;++y)(p=u[y]||d[y])&&(h[y]=p);for(;c<i;++c)l[c]=r[c];return new nr(l,this._parents)}function Q3(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,s=n[i],o;--i>=0;)(o=n[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Z3(e){e||(e=J3);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var r=this._groups,n=r.length,i=new Array(n),s=0;s<n;++s){for(var o=r[s],l=o.length,c=i[s]=new Array(l),u,d=0;d<l;++d)(u=o[d])&&(c[d]=u);c.sort(t)}return new nr(i,this._parents).order()}function J3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function eI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function tI(){return Array.from(this)}function rI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null}function nI(){let e=0;for(const t of this)++e;return e}function iI(){return!this.node()}function sI(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],s=0,o=i.length,l;s<o;++s)(l=i[s])&&e.call(l,l.__data__,s,i);return this}function oI(e){return function(){this.removeAttribute(e)}}function aI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function lI(e,t){return function(){this.setAttribute(e,t)}}function cI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function uI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function dI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function fI(e,t){var r=zc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?aI:oI:typeof t=="function"?r.local?dI:uI:r.local?cI:lI)(r,t))}function XC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function pI(e){return function(){this.style.removeProperty(e)}}function hI(e,t,r){return function(){this.style.setProperty(e,t,r)}}function mI(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function gI(e,t,r){return arguments.length>1?this.each((t==null?pI:typeof t=="function"?mI:hI)(e,t,r??"")):Ss(this.node(),e)}function Ss(e,t){return e.style.getPropertyValue(t)||XC(e).getComputedStyle(e,null).getPropertyValue(t)}function vI(e){return function(){delete this[e]}}function xI(e,t){return function(){this[e]=t}}function yI(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function bI(e,t){return arguments.length>1?this.each((t==null?vI:typeof t=="function"?yI:xI)(e,t)):this.node()[e]}function QC(e){return e.trim().split(/^|\s+/)}function Fx(e){return e.classList||new ZC(e)}function ZC(e){this._node=e,this._names=QC(e.getAttribute("class")||"")}ZC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function JC(e,t){for(var r=Fx(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function eN(e,t){for(var r=Fx(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function wI(e){return function(){JC(this,e)}}function _I(e){return function(){eN(this,e)}}function jI(e,t){return function(){(t.apply(this,arguments)?JC:eN)(this,e)}}function SI(e,t){var r=QC(e+"");if(arguments.length<2){for(var n=Fx(this.node()),i=-1,s=r.length;++i<s;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?jI:t?wI:_I)(r,t))}function kI(){this.textContent=""}function CI(e){return function(){this.textContent=e}}function NI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function EI(e){return arguments.length?this.each(e==null?kI:(typeof e=="function"?NI:CI)(e)):this.node().textContent}function TI(){this.innerHTML=""}function RI(e){return function(){this.innerHTML=e}}function AI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function II(e){return arguments.length?this.each(e==null?TI:(typeof e=="function"?AI:RI)(e)):this.node().innerHTML}function MI(){this.nextSibling&&this.parentNode.appendChild(this)}function PI(){return this.each(MI)}function OI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function DI(){return this.each(OI)}function LI(e){var t=typeof e=="function"?e:UC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function FI(){return null}function qI(e,t){var r=typeof e=="function"?e:UC(e),n=t==null?FI:typeof t=="function"?t:Lx(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function zI(){var e=this.parentNode;e&&e.removeChild(this)}function $I(){return this.each(zI)}function BI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function HI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function WI(e){return this.select(e?HI:BI)}function UI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function VI(e){return function(t){e.call(this,t,this.__data__)}}function GI(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function KI(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,s;r<i;++r)s=t[r],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++n]=s;++n?t.length=n:delete this.__on}}}function YI(e,t,r){return function(){var n=this.__on,i,s=VI(t);if(n){for(var o=0,l=n.length;o<l;++o)if((i=n[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=r),i.value=t;return}}this.addEventListener(e.type,s,r),i={type:e.type,name:e.name,value:t,listener:s,options:r},n?n.push(i):this.__on=[i]}}function XI(e,t,r){var n=GI(e+""),i,s=n.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,d;c<u;++c)for(i=0,d=l[c];i<s;++i)if((o=n[i]).type===d.type&&o.name===d.name)return d.value}return}for(l=t?YI:KI,i=0;i<s;++i)this.each(l(n[i],t,r));return this}function tN(e,t,r){var n=XC(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function QI(e,t){return function(){return tN(this,e,t)}}function ZI(e,t){return function(){return tN(this,e,t.apply(this,arguments))}}function JI(e,t){return this.each((typeof t=="function"?ZI:QI)(e,t))}function*eM(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length,o;i<s;++i)(o=n[i])&&(yield o)}var rN=[null];function nr(e,t){this._groups=e,this._parents=t}function ga(){return new nr([[document.documentElement]],rN)}function tM(){return this}nr.prototype=ga.prototype={constructor:nr,select:N3,selectAll:A3,selectChild:O3,selectChildren:q3,filter:z3,data:V3,enter:$3,exit:K3,join:Y3,merge:X3,selection:tM,order:Q3,sort:Z3,call:eI,nodes:tI,node:rI,size:nI,empty:iI,each:sI,attr:fI,style:gI,property:bI,classed:SI,text:EI,html:II,raise:PI,lower:DI,append:LI,insert:qI,remove:$I,clone:WI,datum:UI,on:XI,dispatch:JI,[Symbol.iterator]:eM};function ur(e){return typeof e=="string"?new nr([[document.querySelector(e)]],[document.documentElement]):new nr([[e]],rN)}function rM(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Sr(e,t){if(e=rM(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const nM={passive:!1},Xo={capture:!0,passive:!1};function Yu(e){e.stopImmediatePropagation()}function fs(e){e.preventDefault(),e.stopImmediatePropagation()}function nN(e){var t=e.document.documentElement,r=ur(e).on("dragstart.drag",fs,Xo);"onselectstart"in t?r.on("selectstart.drag",fs,Xo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function iN(e,t){var r=e.document.documentElement,n=ur(e).on("dragstart.drag",null);t&&(n.on("click.drag",fs,Xo),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Va=e=>()=>e;function hv(e,{sourceEvent:t,subject:r,target:n,identifier:i,active:s,x:o,y:l,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}hv.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function iM(e){return!e.ctrlKey&&!e.button}function sM(){return this.parentNode}function oM(e,t){return t??{x:e.x,y:e.y}}function aM(){return navigator.maxTouchPoints||"ontouchstart"in this}function lM(){var e=iM,t=sM,r=oM,n=aM,i={},s=qc("start","drag","end"),o=0,l,c,u,d,f=0;function h(_){_.on("mousedown.drag",p).filter(n).on("touchstart.drag",w).on("touchmove.drag",v,nM).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(_,j){if(!(d||!e.call(this,_,j))){var S=b(this,t.call(this,_,j),_,j,"mouse");S&&(ur(_.view).on("mousemove.drag",y,Xo).on("mouseup.drag",g,Xo),nN(_.view),Yu(_),u=!1,l=_.clientX,c=_.clientY,S("start",_))}}function y(_){if(fs(_),!u){var j=_.clientX-l,S=_.clientY-c;u=j*j+S*S>f}i.mouse("drag",_)}function g(_){ur(_.view).on("mousemove.drag mouseup.drag",null),iN(_.view,u),fs(_),i.mouse("end",_)}function w(_,j){if(e.call(this,_,j)){var S=_.changedTouches,C=t.call(this,_,j),E=S.length,k,R;for(k=0;k<E;++k)(R=b(this,C,_,j,S[k].identifier,S[k]))&&(Yu(_),R("start",_,S[k]))}}function v(_){var j=_.changedTouches,S=j.length,C,E;for(C=0;C<S;++C)(E=i[j[C].identifier])&&(fs(_),E("drag",_,j[C]))}function x(_){var j=_.changedTouches,S=j.length,C,E;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),C=0;C<S;++C)(E=i[j[C].identifier])&&(Yu(_),E("end",_,j[C]))}function b(_,j,S,C,E,k){var R=s.copy(),T=Sr(k||S,j),I,F,N;if((N=r.call(_,new hv("beforestart",{sourceEvent:S,target:h,identifier:E,active:o,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),C))!=null)return I=N.x-T[0]||0,F=N.y-T[1]||0,function P(O,H,D){var A=T,L;switch(O){case"start":i[E]=P,L=o++;break;case"end":delete i[E],--o;case"drag":T=Sr(D||H,j),L=o;break}R.call(O,_,new hv(O,{sourceEvent:H,subject:N,target:h,identifier:E,active:L,x:T[0]+I,y:T[1]+F,dx:T[0]-A[0],dy:T[1]-A[1],dispatch:R}),C)}}return h.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Va(!!_),h):e},h.container=function(_){return arguments.length?(t=typeof _=="function"?_:Va(_),h):t},h.subject=function(_){return arguments.length?(r=typeof _=="function"?_:Va(_),h):r},h.touchable=function(_){return arguments.length?(n=typeof _=="function"?_:Va(!!_),h):n},h.on=function(){var _=s.on.apply(s,arguments);return _===s?h:_},h.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,h):Math.sqrt(f)},h}function qx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function sN(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function va(){}var Qo=.7,Zl=1/Qo,ps="\\s*([+-]?\\d+)\\s*",Zo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cM=/^#([0-9a-f]{3,8})$/,uM=new RegExp(`^rgb\\(${ps},${ps},${ps}\\)$`),dM=new RegExp(`^rgb\\(${Hr},${Hr},${Hr}\\)$`),fM=new RegExp(`^rgba\\(${ps},${ps},${ps},${Zo}\\)$`),pM=new RegExp(`^rgba\\(${Hr},${Hr},${Hr},${Zo}\\)$`),hM=new RegExp(`^hsl\\(${Zo},${Hr},${Hr}\\)$`),mM=new RegExp(`^hsla\\(${Zo},${Hr},${Hr},${Zo}\\)$`),Y0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qx(va,Jo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:X0,formatHex:X0,formatHex8:gM,formatHsl:vM,formatRgb:Q0,toString:Q0});function X0(){return this.rgb().formatHex()}function gM(){return this.rgb().formatHex8()}function vM(){return oN(this).formatHsl()}function Q0(){return this.rgb().formatRgb()}function Jo(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=cM.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Z0(t):r===3?new Bt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ga(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ga(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=uM.exec(e))?new Bt(t[1],t[2],t[3],1):(t=dM.exec(e))?new Bt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fM.exec(e))?Ga(t[1],t[2],t[3],t[4]):(t=pM.exec(e))?Ga(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=hM.exec(e))?tb(t[1],t[2]/100,t[3]/100,1):(t=mM.exec(e))?tb(t[1],t[2]/100,t[3]/100,t[4]):Y0.hasOwnProperty(e)?Z0(Y0[e]):e==="transparent"?new Bt(NaN,NaN,NaN,0):null}function Z0(e){return new Bt(e>>16&255,e>>8&255,e&255,1)}function Ga(e,t,r,n){return n<=0&&(e=t=r=NaN),new Bt(e,t,r,n)}function xM(e){return e instanceof va||(e=Jo(e)),e?(e=e.rgb(),new Bt(e.r,e.g,e.b,e.opacity)):new Bt}function mv(e,t,r,n){return arguments.length===1?xM(e):new Bt(e,t,r,n??1)}function Bt(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}qx(Bt,mv,sN(va,{brighter(e){return e=e==null?Zl:Math.pow(Zl,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Qo:Math.pow(Qo,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bt(vi(this.r),vi(this.g),vi(this.b),Jl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:J0,formatHex:J0,formatHex8:yM,formatRgb:eb,toString:eb}));function J0(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function yM(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi((isNaN(this.opacity)?1:this.opacity)*255)}`}function eb(){const e=Jl(this.opacity);return`${e===1?"rgb(":"rgba("}${vi(this.r)}, ${vi(this.g)}, ${vi(this.b)}${e===1?")":`, ${e})`}`}function Jl(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fi(e){return e=vi(e),(e<16?"0":"")+e.toString(16)}function tb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Cr(e,t,r,n)}function oN(e){if(e instanceof Cr)return new Cr(e.h,e.s,e.l,e.opacity);if(e instanceof va||(e=Jo(e)),!e)return new Cr;if(e instanceof Cr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new Cr(o,l,c,e.opacity)}function bM(e,t,r,n){return arguments.length===1?oN(e):new Cr(e,t,r,n??1)}function Cr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}qx(Cr,bM,sN(va,{brighter(e){return e=e==null?Zl:Math.pow(Zl,e),new Cr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qo:Math.pow(Qo,e),new Cr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Bt(Xu(e>=240?e-240:e+120,i,n),Xu(e,i,n),Xu(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Cr(rb(this.h),Ka(this.s),Ka(this.l),Jl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Jl(this.opacity);return`${e===1?"hsl(":"hsla("}${rb(this.h)}, ${Ka(this.s)*100}%, ${Ka(this.l)*100}%${e===1?")":`, ${e})`}`}}));function rb(e){return e=(e||0)%360,e<0?e+360:e}function Ka(e){return Math.max(0,Math.min(1,e||0))}function Xu(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const aN=e=>()=>e;function wM(e,t){return function(r){return e+r*t}}function _M(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function jM(e){return(e=+e)==1?lN:function(t,r){return r-t?_M(t,r,e):aN(isNaN(t)?r:t)}}function lN(e,t){var r=t-e;return r?wM(e,r):aN(isNaN(e)?t:e)}const nb=function e(t){var r=jM(t);function n(i,s){var o=r((i=mv(i)).r,(s=mv(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),u=lN(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=l(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function kn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var gv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qu=new RegExp(gv.source,"g");function SM(e){return function(){return e}}function kM(e){return function(t){return e(t)+""}}function CM(e,t){var r=gv.lastIndex=Qu.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=gv.exec(e))&&(i=Qu.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:kn(n,i)})),r=Qu.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?kM(c[0].x):SM(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}var ib=180/Math.PI,vv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cN(e,t,r,n,i,s){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*ib,skewX:Math.atan(c)*ib,scaleX:o,scaleY:l}}var Ya;function NM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vv:cN(t.a,t.b,t.c,t.d,t.e,t.f)}function EM(e){return e==null||(Ya||(Ya=document.createElementNS("http://www.w3.org/2000/svg","g")),Ya.setAttribute("transform",e),!(e=Ya.transform.baseVal.consolidate()))?vv:(e=e.matrix,cN(e.a,e.b,e.c,e.d,e.e,e.f))}function uN(e,t,r,n){function i(u){return u.length?u.pop()+" ":""}function s(u,d,f,h,p,y){if(u!==f||d!==h){var g=p.push("translate(",null,t,null,r);y.push({i:g-4,x:kn(u,f)},{i:g-2,x:kn(d,h)})}else(f||h)&&p.push("translate("+f+t+h+r)}function o(u,d,f,h){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,n)-2,x:kn(u,d)})):d&&f.push(i(f)+"rotate("+d+n)}function l(u,d,f,h){u!==d?h.push({i:f.push(i(f)+"skewX(",null,n)-2,x:kn(u,d)}):d&&f.push(i(f)+"skewX("+d+n)}function c(u,d,f,h,p,y){if(u!==f||d!==h){var g=p.push(i(p)+"scale(",null,",",null,")");y.push({i:g-4,x:kn(u,f)},{i:g-2,x:kn(d,h)})}else(f!==1||h!==1)&&p.push(i(p)+"scale("+f+","+h+")")}return function(u,d){var f=[],h=[];return u=e(u),d=e(d),s(u.translateX,u.translateY,d.translateX,d.translateY,f,h),o(u.rotate,d.rotate,f,h),l(u.skewX,d.skewX,f,h),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,h),u=d=null,function(p){for(var y=-1,g=h.length,w;++y<g;)f[(w=h[y]).i]=w.x(p);return f.join("")}}}var TM=uN(NM,"px, ","px)","deg)"),RM=uN(EM,", ",")",")"),AM=1e-12;function sb(e){return((e=Math.exp(e))+1/e)/2}function IM(e){return((e=Math.exp(e))-1/e)/2}function MM(e){return((e=Math.exp(2*e))-1)/(e+1)}const PM=function e(t,r,n){function i(s,o){var l=s[0],c=s[1],u=s[2],d=o[0],f=o[1],h=o[2],p=d-l,y=f-c,g=p*p+y*y,w,v;if(g<AM)v=Math.log(h/u)/t,w=function(C){return[l+C*p,c+C*y,u*Math.exp(t*C*v)]};else{var x=Math.sqrt(g),b=(h*h-u*u+n*g)/(2*u*r*x),_=(h*h-u*u-n*g)/(2*h*r*x),j=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(_*_+1)-_);v=(S-j)/t,w=function(C){var E=C*v,k=sb(j),R=u/(r*x)*(k*MM(t*E+j)-IM(j));return[l+R*p,c+R*y,u*k/sb(t*E+j)]}}return w.duration=v*1e3*t/Math.SQRT2,w}return i.rho=function(s){var o=Math.max(.001,+s),l=o*o,c=l*l;return e(o,l,c)},i}(Math.SQRT2,2,4);var ks=0,uo=0,Xs=0,dN=1e3,ec,fo,tc=0,ki=0,$c=0,ea=typeof performance=="object"&&performance.now?performance:Date,fN=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function zx(){return ki||(fN(OM),ki=ea.now()+$c)}function OM(){ki=0}function rc(){this._call=this._time=this._next=null}rc.prototype=pN.prototype={constructor:rc,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?zx():+r)+(t==null?0:+t),!this._next&&fo!==this&&(fo?fo._next=this:ec=this,fo=this),this._call=e,this._time=r,xv()},stop:function(){this._call&&(this._call=null,this._time=1/0,xv())}};function pN(e,t,r){var n=new rc;return n.restart(e,t,r),n}function DM(){zx(),++ks;for(var e=ec,t;e;)(t=ki-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ks}function ob(){ki=(tc=ea.now())+$c,ks=uo=0;try{DM()}finally{ks=0,FM(),ki=0}}function LM(){var e=ea.now(),t=e-tc;t>dN&&($c-=t,tc=e)}function FM(){for(var e,t=ec,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:ec=r);fo=e,xv(n)}function xv(e){if(!ks){uo&&(uo=clearTimeout(uo));var t=e-ki;t>24?(e<1/0&&(uo=setTimeout(ob,e-ea.now()-$c)),Xs&&(Xs=clearInterval(Xs))):(Xs||(tc=ea.now(),Xs=setInterval(LM,dN)),ks=1,fN(ob))}}function ab(e,t,r){var n=new rc;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var qM=qc("start","end","cancel","interrupt"),zM=[],hN=0,lb=1,yv=2,jl=3,cb=4,bv=5,Sl=6;function Bc(e,t,r,n,i,s){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;$M(e,r,{name:t,index:n,group:i,on:qM,tween:zM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:hN})}function $x(e,t){var r=Ar(e,t);if(r.state>hN)throw new Error("too late; already scheduled");return r}function Gr(e,t){var r=Ar(e,t);if(r.state>jl)throw new Error("too late; already running");return r}function Ar(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function $M(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=pN(s,0,r.time);function s(u){r.state=lb,r.timer.restart(o,r.delay,r.time),r.delay<=u&&o(u-r.delay)}function o(u){var d,f,h,p;if(r.state!==lb)return c();for(d in n)if(p=n[d],p.name===r.name){if(p.state===jl)return ab(o);p.state===cb?(p.state=Sl,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete n[d]):+d<t&&(p.state=Sl,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete n[d])}if(ab(function(){r.state===jl&&(r.state=cb,r.timer.restart(l,r.delay,r.time),l(u))}),r.state=yv,r.on.call("start",e,e.__data__,r.index,r.group),r.state===yv){for(r.state=jl,i=new Array(h=r.tween.length),d=0,f=-1;d<h;++d)(p=r.tween[d].value.call(e,e.__data__,r.index,r.group))&&(i[++f]=p);i.length=f+1}}function l(u){for(var d=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=bv,1),f=-1,h=i.length;++f<h;)i[f].call(e,d);r.state===bv&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Sl,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function kl(e,t){var r=e.__transition,n,i,s=!0,o;if(r){t=t==null?null:t+"";for(o in r){if((n=r[o]).name!==t){s=!1;continue}i=n.state>yv&&n.state<bv,n.state=Sl,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[o]}s&&delete e.__transition}}function BM(e){return this.each(function(){kl(this,e)})}function HM(e,t){var r,n;return function(){var i=Gr(this,e),s=i.tween;if(s!==r){n=r=s;for(var o=0,l=n.length;o<l;++o)if(n[o].name===t){n=n.slice(),n.splice(o,1);break}}i.tween=n}}function WM(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var s=Gr(this,e),o=s.tween;if(o!==n){i=(n=o).slice();for(var l={name:t,value:r},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=l;break}c===u&&i.push(l)}s.tween=i}}function UM(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Ar(this.node(),r).tween,i=0,s=n.length,o;i<s;++i)if((o=n[i]).name===e)return o.value;return null}return this.each((t==null?HM:WM)(r,e,t))}function Bx(e,t,r){var n=e._id;return e.each(function(){var i=Gr(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return Ar(i,n).value[t]}}function mN(e,t){var r;return(typeof t=="number"?kn:t instanceof Jo?nb:(r=Jo(t))?(t=r,nb):CM)(e,t)}function VM(e){return function(){this.removeAttribute(e)}}function GM(e){return function(){this.removeAttributeNS(e.space,e.local)}}function KM(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===n?s:s=t(n=o,r)}}function YM(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===n?s:s=t(n=o,r)}}function XM(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function QM(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function ZM(e,t){var r=zc(e),n=r==="transform"?RM:mN;return this.attrTween(e,typeof t=="function"?(r.local?QM:XM)(r,n,Bx(this,"attr."+e,t)):t==null?(r.local?GM:VM)(r):(r.local?YM:KM)(r,n,t))}function JM(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function eP(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function tP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&eP(e,s)),r}return i._value=t,i}function rP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&JM(e,s)),r}return i._value=t,i}function nP(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=zc(e);return this.tween(r,(n.local?tP:rP)(n,t))}function iP(e,t){return function(){$x(this,e).delay=+t.apply(this,arguments)}}function sP(e,t){return t=+t,function(){$x(this,e).delay=t}}function oP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?iP:sP)(t,e)):Ar(this.node(),t).delay}function aP(e,t){return function(){Gr(this,e).duration=+t.apply(this,arguments)}}function lP(e,t){return t=+t,function(){Gr(this,e).duration=t}}function cP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?aP:lP)(t,e)):Ar(this.node(),t).duration}function uP(e,t){if(typeof t!="function")throw new Error;return function(){Gr(this,e).ease=t}}function dP(e){var t=this._id;return arguments.length?this.each(uP(t,e)):Ar(this.node(),t).ease}function fP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Gr(this,e).ease=r}}function pP(e){if(typeof e!="function")throw new Error;return this.each(fP(this._id,e))}function hP(e){typeof e!="function"&&(e=GC(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&l.push(c);return new pn(n,this._parents,this._name,this._id)}function mP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,s=Math.min(n,i),o=new Array(n),l=0;l<s;++l)for(var c=t[l],u=r[l],d=c.length,f=o[l]=new Array(d),h,p=0;p<d;++p)(h=c[p]||u[p])&&(f[p]=h);for(;l<n;++l)o[l]=t[l];return new pn(o,this._parents,this._name,this._id)}function gP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function vP(e,t,r){var n,i,s=gP(t)?$x:Gr;return function(){var o=s(this,e),l=o.on;l!==n&&(i=(n=l).copy()).on(t,r),o.on=i}}function xP(e,t){var r=this._id;return arguments.length<2?Ar(this.node(),r).on.on(e):this.each(vP(r,e,t))}function yP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function bP(){return this.on("end.remove",yP(this._id))}function wP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Lx(e));for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o)for(var l=n[o],c=l.length,u=s[o]=new Array(c),d,f,h=0;h<c;++h)(d=l[h])&&(f=e.call(d,d.__data__,h,l))&&("__data__"in d&&(f.__data__=d.__data__),u[h]=f,Bc(u[h],t,r,h,u,Ar(d,r)));return new pn(s,this._parents,t,r)}function _P(e){var t=this._name,r=this._id;typeof e!="function"&&(e=VC(e));for(var n=this._groups,i=n.length,s=[],o=[],l=0;l<i;++l)for(var c=n[l],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var h=e.call(d,d.__data__,f,c),p,y=Ar(d,r),g=0,w=h.length;g<w;++g)(p=h[g])&&Bc(p,t,r,g,h,y);s.push(h),o.push(d)}return new pn(s,o,t,r)}var jP=ga.prototype.constructor;function SP(){return new jP(this._groups,this._parents)}function kP(e,t){var r,n,i;return function(){var s=Ss(this,e),o=(this.style.removeProperty(e),Ss(this,e));return s===o?null:s===r&&o===n?i:i=t(r=s,n=o)}}function gN(e){return function(){this.style.removeProperty(e)}}function CP(e,t,r){var n,i=r+"",s;return function(){var o=Ss(this,e);return o===i?null:o===n?s:s=t(n=o,r)}}function NP(e,t,r){var n,i,s;return function(){var o=Ss(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Ss(this,e))),o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l))}}function EP(e,t){var r,n,i,s="style."+t,o="end."+s,l;return function(){var c=Gr(this,e),u=c.on,d=c.value[s]==null?l||(l=gN(t)):void 0;(u!==r||i!==d)&&(n=(r=u).copy()).on(o,i=d),c.on=n}}function TP(e,t,r){var n=(e+="")=="transform"?TM:mN;return t==null?this.styleTween(e,kP(e,n)).on("end.style."+e,gN(e)):typeof t=="function"?this.styleTween(e,NP(e,n,Bx(this,"style."+e,t))).each(EP(this._id,e)):this.styleTween(e,CP(e,n,t),r).on("end.style."+e,null)}function RP(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function AP(e,t,r){var n,i;function s(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&RP(e,o,r)),n}return s._value=t,s}function IP(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,AP(e,t,r??""))}function MP(e){return function(){this.textContent=e}}function PP(e){return function(){var t=e(this);this.textContent=t??""}}function OP(e){return this.tween("text",typeof e=="function"?PP(Bx(this,"text",e)):MP(e==null?"":e+""))}function DP(e){return function(t){this.textContent=e.call(this,t)}}function LP(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&DP(i)),t}return n._value=e,n}function FP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,LP(e))}function qP(){for(var e=this._name,t=this._id,r=vN(),n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,u=0;u<l;++u)if(c=o[u]){var d=Ar(c,t);Bc(c,e,r,u,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new pn(n,this._parents,e,r)}function zP(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(s,o){var l={value:o},c={value:function(){--i===0&&s()}};r.each(function(){var u=Gr(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),u.on=t}),i===0&&s()})}var $P=0;function pn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function vN(){return++$P}var Yr=ga.prototype;pn.prototype={constructor:pn,select:wP,selectAll:_P,selectChild:Yr.selectChild,selectChildren:Yr.selectChildren,filter:hP,merge:mP,selection:SP,transition:qP,call:Yr.call,nodes:Yr.nodes,node:Yr.node,size:Yr.size,empty:Yr.empty,each:Yr.each,on:xP,attr:ZM,attrTween:nP,style:TP,styleTween:IP,text:OP,textTween:FP,remove:bP,tween:UM,delay:oP,duration:cP,ease:dP,easeVarying:pP,end:zP,[Symbol.iterator]:Yr[Symbol.iterator]};function BP(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var HP={time:null,delay:0,duration:250,ease:BP};function WP(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function UP(e){var t,r;e instanceof pn?(t=e._id,e=e._name):(t=vN(),(r=HP).time=zx(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,u=0;u<l;++u)(c=o[u])&&Bc(c,e,t,u,o,r||WP(c,t));return new pn(n,this._parents,e,t)}ga.prototype.interrupt=BM;ga.prototype.transition=UP;const Xa=e=>()=>e;function VP(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function nn(e,t,r){this.k=e,this.x=t,this.y=r}nn.prototype={constructor:nn,scale:function(e){return e===1?this:new nn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new nn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ln=new nn(1,0,0);nn.prototype;function Zu(e){e.stopImmediatePropagation()}function Qs(e){e.preventDefault(),e.stopImmediatePropagation()}function GP(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function KP(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ub(){return this.__zoom||ln}function YP(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function XP(){return navigator.maxTouchPoints||"ontouchstart"in this}function QP(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],s=e.invertY(t[0][1])-r[0][1],o=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function xN(){var e=GP,t=KP,r=QP,n=YP,i=XP,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=PM,u=qc("start","zoom","end"),d,f,h,p=500,y=150,g=0,w=10;function v(N){N.property("__zoom",ub).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",R).filter(i).on("touchstart.zoom",T).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(N,P,O,H){var D=N.selection?N.selection():N;D.property("__zoom",ub),N!==D?j(N,P,O,H):D.interrupt().each(function(){S(this,arguments).event(H).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},v.scaleBy=function(N,P,O,H){v.scaleTo(N,function(){var D=this.__zoom.k,A=typeof P=="function"?P.apply(this,arguments):P;return D*A},O,H)},v.scaleTo=function(N,P,O,H){v.transform(N,function(){var D=t.apply(this,arguments),A=this.__zoom,L=O==null?_(D):typeof O=="function"?O.apply(this,arguments):O,M=A.invert(L),$=typeof P=="function"?P.apply(this,arguments):P;return r(b(x(A,$),L,M),D,o)},O,H)},v.translateBy=function(N,P,O,H){v.transform(N,function(){return r(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof O=="function"?O.apply(this,arguments):O),t.apply(this,arguments),o)},null,H)},v.translateTo=function(N,P,O,H,D){v.transform(N,function(){var A=t.apply(this,arguments),L=this.__zoom,M=H==null?_(A):typeof H=="function"?H.apply(this,arguments):H;return r(ln.translate(M[0],M[1]).scale(L.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof O=="function"?-O.apply(this,arguments):-O),A,o)},H,D)};function x(N,P){return P=Math.max(s[0],Math.min(s[1],P)),P===N.k?N:new nn(P,N.x,N.y)}function b(N,P,O){var H=P[0]-O[0]*N.k,D=P[1]-O[1]*N.k;return H===N.x&&D===N.y?N:new nn(N.k,H,D)}function _(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function j(N,P,O,H){N.on("start.zoom",function(){S(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(H).end()}).tween("zoom",function(){var D=this,A=arguments,L=S(D,A).event(H),M=t.apply(D,A),$=O==null?_(M):typeof O=="function"?O.apply(D,A):O,W=Math.max(M[1][0]-M[0][0],M[1][1]-M[0][1]),B=D.__zoom,Y=typeof P=="function"?P.apply(D,A):P,Z=c(B.invert($).concat(W/B.k),Y.invert($).concat(W/Y.k));return function(ie){if(ie===1)ie=Y;else{var re=Z(ie),de=W/re[2];ie=new nn(de,$[0]-re[0]*de,$[1]-re[1]*de)}L.zoom(null,ie)}})}function S(N,P,O){return!O&&N.__zooming||new C(N,P)}function C(N,P){this.that=N,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(N,P),this.taps=0}C.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,P){return this.mouse&&N!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var P=ur(this.that).datum();u.call(N,this.that,new VP(N,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:u}),P)}};function E(N,...P){if(!e.apply(this,arguments))return;var O=S(this,P).event(N),H=this.__zoom,D=Math.max(s[0],Math.min(s[1],H.k*Math.pow(2,n.apply(this,arguments)))),A=Sr(N);if(O.wheel)(O.mouse[0][0]!==A[0]||O.mouse[0][1]!==A[1])&&(O.mouse[1]=H.invert(O.mouse[0]=A)),clearTimeout(O.wheel);else{if(H.k===D)return;O.mouse=[A,H.invert(A)],kl(this),O.start()}Qs(N),O.wheel=setTimeout(L,y),O.zoom("mouse",r(b(x(H,D),O.mouse[0],O.mouse[1]),O.extent,o));function L(){O.wheel=null,O.end()}}function k(N,...P){if(h||!e.apply(this,arguments))return;var O=N.currentTarget,H=S(this,P,!0).event(N),D=ur(N.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",W,!0),A=Sr(N,O),L=N.clientX,M=N.clientY;nN(N.view),Zu(N),H.mouse=[A,this.__zoom.invert(A)],kl(this),H.start();function $(B){if(Qs(B),!H.moved){var Y=B.clientX-L,Z=B.clientY-M;H.moved=Y*Y+Z*Z>g}H.event(B).zoom("mouse",r(b(H.that.__zoom,H.mouse[0]=Sr(B,O),H.mouse[1]),H.extent,o))}function W(B){D.on("mousemove.zoom mouseup.zoom",null),iN(B.view,H.moved),Qs(B),H.event(B).end()}}function R(N,...P){if(e.apply(this,arguments)){var O=this.__zoom,H=Sr(N.changedTouches?N.changedTouches[0]:N,this),D=O.invert(H),A=O.k*(N.shiftKey?.5:2),L=r(b(x(O,A),H,D),t.apply(this,P),o);Qs(N),l>0?ur(this).transition().duration(l).call(j,L,H,N):ur(this).call(v.transform,L,H,N)}}function T(N,...P){if(e.apply(this,arguments)){var O=N.touches,H=O.length,D=S(this,P,N.changedTouches.length===H).event(N),A,L,M,$;for(Zu(N),L=0;L<H;++L)M=O[L],$=Sr(M,this),$=[$,this.__zoom.invert($),M.identifier],D.touch0?!D.touch1&&D.touch0[2]!==$[2]&&(D.touch1=$,D.taps=0):(D.touch0=$,A=!0,D.taps=1+!!d);d&&(d=clearTimeout(d)),A&&(D.taps<2&&(f=$[0],d=setTimeout(function(){d=null},p)),kl(this),D.start())}}function I(N,...P){if(this.__zooming){var O=S(this,P).event(N),H=N.changedTouches,D=H.length,A,L,M,$;for(Qs(N),A=0;A<D;++A)L=H[A],M=Sr(L,this),O.touch0&&O.touch0[2]===L.identifier?O.touch0[0]=M:O.touch1&&O.touch1[2]===L.identifier&&(O.touch1[0]=M);if(L=O.that.__zoom,O.touch1){var W=O.touch0[0],B=O.touch0[1],Y=O.touch1[0],Z=O.touch1[1],ie=(ie=Y[0]-W[0])*ie+(ie=Y[1]-W[1])*ie,re=(re=Z[0]-B[0])*re+(re=Z[1]-B[1])*re;L=x(L,Math.sqrt(ie/re)),M=[(W[0]+Y[0])/2,(W[1]+Y[1])/2],$=[(B[0]+Z[0])/2,(B[1]+Z[1])/2]}else if(O.touch0)M=O.touch0[0],$=O.touch0[1];else return;O.zoom("touch",r(b(L,M,$),O.extent,o))}}function F(N,...P){if(this.__zooming){var O=S(this,P).event(N),H=N.changedTouches,D=H.length,A,L;for(Zu(N),h&&clearTimeout(h),h=setTimeout(function(){h=null},p),A=0;A<D;++A)L=H[A],O.touch0&&O.touch0[2]===L.identifier?delete O.touch0:O.touch1&&O.touch1[2]===L.identifier&&delete O.touch1;if(O.touch1&&!O.touch0&&(O.touch0=O.touch1,delete O.touch1),O.touch0)O.touch0[1]=this.__zoom.invert(O.touch0[0]);else if(O.end(),O.taps===2&&(L=Sr(L,this),Math.hypot(f[0]-L[0],f[1]-L[1])<w)){var M=ur(this).on("dblclick.zoom");M&&M.apply(this,arguments)}}}return v.wheelDelta=function(N){return arguments.length?(n=typeof N=="function"?N:Xa(+N),v):n},v.filter=function(N){return arguments.length?(e=typeof N=="function"?N:Xa(!!N),v):e},v.touchable=function(N){return arguments.length?(i=typeof N=="function"?N:Xa(!!N),v):i},v.extent=function(N){return arguments.length?(t=typeof N=="function"?N:Xa([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),v):t},v.scaleExtent=function(N){return arguments.length?(s[0]=+N[0],s[1]=+N[1],v):[s[0],s[1]]},v.translateExtent=function(N){return arguments.length?(o[0][0]=+N[0][0],o[1][0]=+N[1][0],o[0][1]=+N[0][1],o[1][1]=+N[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(N){return arguments.length?(r=N,v):r},v.duration=function(N){return arguments.length?(l=+N,v):l},v.interpolate=function(N){return arguments.length?(c=N,v):c},v.on=function(){var N=u.on.apply(u,arguments);return N===u?v:N},v.clickDistance=function(N){return arguments.length?(g=(N=+N)*N,v):Math.sqrt(g)},v.tapDistance=function(N){return arguments.length?(w=+N,v):w},v}const Hc=m.createContext(null),ZP=Hc.Provider,hn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},yN=hn.error001();function Ve(e,t){const r=m.useContext(Hc);if(r===null)throw new Error(yN);return WC(r,e,t)}const xt=()=>{const e=m.useContext(Hc);if(e===null)throw new Error(yN);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},JP=e=>e.userSelectionActive?"none":"all";function Hn({position:e,children:t,className:r,style:n,...i}){const s=Ve(JP),o=`${e}`.split("-");return G.createElement("div",{className:Kt(["react-flow__panel",r,...o]),style:{...n,pointerEvents:s},...i},t)}function eO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:G.createElement(Hn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},G.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const tO=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:c,className:u,...d})=>{const f=m.useRef(null),[h,p]=m.useState({x:0,y:0,width:0,height:0}),y=Kt(["react-flow__edge-textwrapper",u]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();p({x:g.x,y:g.y,width:g.width,height:g.height})}},[r]),typeof r>"u"||!r?null:G.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:y,visibility:h.width?"visible":"hidden",...d},i&&G.createElement("rect",{width:h.width+2*o[0],x:-o[0],y:-o[1],height:h.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),G.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:f,style:n},r),c)};var rO=m.memo(tO);const Hx=e=>({width:e.offsetWidth,height:e.offsetHeight}),Cs=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Wx=(e={x:0,y:0},t)=>({x:Cs(e.x,t[0][0],t[1][0]),y:Cs(e.y,t[0][1],t[1][1])}),db=(e,t,r)=>e<t?Cs(Math.abs(e-t),1,50)/50:e>r?-Cs(Math.abs(e-r),1,50)/50:0,bN=(e,t)=>{const r=db(e.x,35,t.width-35)*20,n=db(e.y,35,t.height-35)*20;return[r,n]},wN=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},_N=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ta=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),jN=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),fb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),nO=(e,t)=>jN(_N(ta(e),ta(t))),wv=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},iO=e=>fr(e.width)&&fr(e.height)&&fr(e.x)&&fr(e.y),fr=e=>!isNaN(e)&&isFinite(e),rt=Symbol.for("internals"),SN=["Enter"," ","Escape"],sO=(e,t)=>{},oO=e=>"nativeEvent"in e;function _v(e){var i,s;const t=oO(e)?e.nativeEvent:e,r=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const kN=e=>"clientX"in e,Wn=(e,t)=>{var s,o;const r=kN(e),n=r?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=r?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},nc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},xa=({id:e,path:t,labelX:r,labelY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p=20})=>G.createElement(G.Fragment,null,G.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:h}),p&&G.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),i&&fr(r)&&fr(n)?G.createElement(rO,{x:r,y:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u}):null);xa.displayName="BaseEdge";function Zs(e,t,r){return r===void 0?r:n=>{const i=t().edges.find(s=>s.id===e);i&&r(n,{...i})}}function CN({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,s=r<e?r+i:r-i,o=Math.abs(n-t)/2,l=n<t?n+o:n-o;return[s,l,i,o]}function NN({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:l}){const c=e*.125+i*.375+o*.375+r*.125,u=t*.125+s*.375+l*.375+n*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}var Ci;(function(e){e.Strict="strict",e.Loose="loose"})(Ci||(Ci={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var ra;(function(e){e.Partial="partial",e.Full="full"})(ra||(ra={}));var Rn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Rn||(Rn={}));var ic;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ic||(ic={}));var se;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(se||(se={}));function pb({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===se.Left||e===se.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function EN({sourceX:e,sourceY:t,sourcePosition:r=se.Bottom,targetX:n,targetY:i,targetPosition:s=se.Top}){const[o,l]=pb({pos:r,x1:e,y1:t,x2:n,y2:i}),[c,u]=pb({pos:s,x1:n,y1:i,x2:e,y2:t}),[d,f,h,p]=NN({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${o},${l} ${c},${u} ${n},${i}`,d,f,h,p]}const Ux=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=se.Bottom,targetPosition:s=se.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:g})=>{const[w,v,x]=EN({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s});return G.createElement(xa,{path:w,labelX:v,labelY:x,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:g})});Ux.displayName="SimpleBezierEdge";const hb={[se.Left]:{x:-1,y:0},[se.Right]:{x:1,y:0},[se.Top]:{x:0,y:-1},[se.Bottom]:{x:0,y:1}},aO=({source:e,sourcePosition:t=se.Bottom,target:r})=>t===se.Left||t===se.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},mb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function lO({source:e,sourcePosition:t=se.Bottom,target:r,targetPosition:n=se.Top,center:i,offset:s}){const o=hb[t],l=hb[n],c={x:e.x+o.x*s,y:e.y+o.y*s},u={x:r.x+l.x*s,y:r.y+l.y*s},d=aO({source:c,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",h=d[f];let p=[],y,g;const w={x:0,y:0},v={x:0,y:0},[x,b,_,j]=CN({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(o[f]*l[f]===-1){y=i.x??x,g=i.y??b;const C=[{x:y,y:c.y},{x:y,y:u.y}],E=[{x:c.x,y:g},{x:u.x,y:g}];o[f]===h?p=f==="x"?C:E:p=f==="x"?E:C}else{const C=[{x:c.x,y:u.y}],E=[{x:u.x,y:c.y}];if(f==="x"?p=o.x===h?E:C:p=o.y===h?C:E,t===n){const F=Math.abs(e[f]-r[f]);if(F<=s){const N=Math.min(s-1,s-F);o[f]===h?w[f]=(c[f]>e[f]?-1:1)*N:v[f]=(u[f]>r[f]?-1:1)*N}}if(t!==n){const F=f==="x"?"y":"x",N=o[f]===l[F],P=c[F]>u[F],O=c[F]<u[F];(o[f]===1&&(!N&&P||N&&O)||o[f]!==1&&(!N&&O||N&&P))&&(p=f==="x"?C:E)}const k={x:c.x+w.x,y:c.y+w.y},R={x:u.x+v.x,y:u.y+v.y},T=Math.max(Math.abs(k.x-p[0].x),Math.abs(R.x-p[0].x)),I=Math.max(Math.abs(k.y-p[0].y),Math.abs(R.y-p[0].y));T>=I?(y=(k.x+R.x)/2,g=p[0].y):(y=p[0].x,g=(k.y+R.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...p,{x:u.x+v.x,y:u.y+v.y},r],y,g,_,j]}function cO(e,t,r,n){const i=Math.min(mb(e,t)/2,mb(t,r)/2,n),{x:s,y:o}=t;if(e.x===s&&s===r.x||e.y===o&&o===r.y)return`L${s} ${o}`;if(e.y===o){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${s+i*u},${o}Q ${s},${o} ${s},${o+i*d}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*l},${o}`}function jv({sourceX:e,sourceY:t,sourcePosition:r=se.Bottom,targetX:n,targetY:i,targetPosition:s=se.Top,borderRadius:o=5,centerX:l,centerY:c,offset:u=20}){const[d,f,h,p,y]=lO({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:s,center:{x:l,y:c},offset:u});return[d.reduce((w,v,x)=>{let b="";return x>0&&x<d.length-1?b=cO(d[x-1],v,d[x+1],o):b=`${x===0?"M":"L"}${v.x} ${v.y}`,w+=b,w},""),f,h,p,y]}const Wc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,sourcePosition:f=se.Bottom,targetPosition:h=se.Top,markerEnd:p,markerStart:y,pathOptions:g,interactionWidth:w})=>{const[v,x,b]=jv({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:h,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return G.createElement(xa,{path:v,labelX:x,labelY:b,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:p,markerStart:y,interactionWidth:w})});Wc.displayName="SmoothStepEdge";const Vx=m.memo(e=>{var t;return G.createElement(Wc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Vx.displayName="StepEdge";function uO({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,s,o,l]=CN({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,s,o,l]}const Gx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p})=>{const[y,g,w]=uO({sourceX:e,sourceY:t,targetX:r,targetY:n});return G.createElement(xa,{path:y,labelX:g,labelY:w,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p})});Gx.displayName="StraightEdge";function Qa(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function gb({pos:e,x1:t,y1:r,x2:n,y2:i,c:s}){switch(e){case se.Left:return[t-Qa(t-n,s),r];case se.Right:return[t+Qa(n-t,s),r];case se.Top:return[t,r-Qa(r-i,s)];case se.Bottom:return[t,r+Qa(i-r,s)]}}function TN({sourceX:e,sourceY:t,sourcePosition:r=se.Bottom,targetX:n,targetY:i,targetPosition:s=se.Top,curvature:o=.25}){const[l,c]=gb({pos:r,x1:e,y1:t,x2:n,y2:i,c:o}),[u,d]=gb({pos:s,x1:n,y1:i,x2:e,y2:t,c:o}),[f,h,p,y]=NN({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${l},${c} ${u},${d} ${n},${i}`,f,h,p,y]}const sc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=se.Bottom,targetPosition:s=se.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,pathOptions:g,interactionWidth:w})=>{const[v,x,b]=TN({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s,curvature:g==null?void 0:g.curvature});return G.createElement(xa,{path:v,labelX:x,labelY:b,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:w})});sc.displayName="BezierEdge";const Kx=m.createContext(null),dO=Kx.Provider;Kx.Consumer;const fO=()=>m.useContext(Kx),pO=e=>"id"in e&&"source"in e&&"target"in e,hO=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Sv=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,mO=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),gO=(e,t)=>{if(!e.source||!e.target)return t;let r;return pO(e)?r={...e}:r={...e,id:hO(e)},mO(r,t)?t:t.concat(r)},kv=({x:e,y:t},[r,n,i],s,[o,l])=>{const c={x:(e-r)/i,y:(t-n)/i};return s?{x:o*Math.round(c.x/o),y:l*Math.round(c.y/l)}:c},RN=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n}),xi=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],i={x:e.position.x-r,y:e.position.y-n};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:i}},Uc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const{x:s,y:o}=xi(i,t).positionAbsolute;return _N(n,ta({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return jN(r)},AN=(e,t,[r,n,i]=[0,0,1],s=!1,o=!1,l=[0,0])=>{const c={x:(t.x-r)/i,y:(t.y-n)/i,width:t.width/i,height:t.height/i},u=[];return e.forEach(d=>{const{width:f,height:h,selectable:p=!0,hidden:y=!1}=d;if(o&&!p||y)return!1;const{positionAbsolute:g}=xi(d,l),w={x:g.x,y:g.y,width:f||0,height:h||0},v=wv(c,w),x=typeof f>"u"||typeof h>"u"||f===null||h===null,b=s&&v>0,_=(f||0)*(h||0);(x||b||v>=_||d.dragging)&&u.push(d)}),u},IN=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},MN=(e,t,r,n,i,s=.1)=>{const o=t/(e.width*(1+s)),l=r/(e.height*(1+s)),c=Math.min(o,l),u=Cs(c,n,i),d=e.x+e.width/2,f=e.y+e.height/2,h=t/2-d*u,p=r/2-f*u;return{x:h,y:p,zoom:u}},li=(e,t=0)=>e.transition().duration(t);function vb(e,t,r,n){return(t[r]||[]).reduce((i,s)=>{var o,l;return`${e.id}-${s.id}-${r}`!==n&&i.push({id:s.id||null,type:r,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+s.y+s.height/2}),i},[])}function vO(e,t,r,n,i,s){const{x:o,y:l}=Wn(e),u=t.elementsFromPoint(o,l).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const g=Yx(void 0,u),w=u.getAttribute("data-handleid"),v=s({nodeId:y,id:w,type:g});if(v){const x=i.find(b=>b.nodeId===y&&b.type===g&&b.id===w);return{handle:{id:w,type:g,nodeId:y,x:(x==null?void 0:x.x)||r.x,y:(x==null?void 0:x.y)||r.y},validHandleResult:v}}}}let d=[],f=1/0;if(i.forEach(y=>{const g=Math.sqrt((y.x-r.x)**2+(y.y-r.y)**2);if(g<=n){const w=s(y);g<=f&&(g<f?d=[{handle:y,validHandleResult:w}]:g===f&&d.push({handle:y,validHandleResult:w}),f=g)}}),!d.length)return{handle:null,validHandleResult:PN()};if(d.length===1)return d[0];const h=d.some(({validHandleResult:y})=>y.isValid),p=d.some(({handle:y})=>y.type==="target");return d.find(({handle:y,validHandleResult:g})=>p?y.type==="target":h?g.isValid:!0)||d[0]}const xO={source:null,target:null,sourceHandle:null,targetHandle:null},PN=()=>({handleDomNode:null,isValid:!1,connection:xO,endHandle:null});function ON(e,t,r,n,i,s,o){const l=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...PN(),handleDomNode:c};if(c){const d=Yx(void 0,c),f=c.getAttribute("data-nodeid"),h=c.getAttribute("data-handleid"),p=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),g={source:l?f:r,sourceHandle:l?h:n,target:l?r:f,targetHandle:l?n:h};u.connection=g,p&&y&&(t===Ci.Strict?l&&d==="source"||!l&&d==="target":f!==r||h!==n)&&(u.endHandle={nodeId:f,handleId:h,type:d},u.isValid=s(g))}return u}function yO({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((i,s)=>{if(s[rt]){const{handleBounds:o}=s[rt];let l=[],c=[];o&&(l=vb(s,o,"source",`${t}-${r}-${n}`),c=vb(s,o,"target",`${t}-${r}-${n}`)),i.push(...l,...c)}return i},[])}function Yx(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Ju(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function bO(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function DN({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:i,getState:s,setState:o,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:u}){const d=wN(e.target),{connectionMode:f,domNode:h,autoPanOnConnect:p,connectionRadius:y,onConnectStart:g,panBy:w,getNodes:v,cancelConnection:x}=s();let b=0,_;const{x:j,y:S}=Wn(e),C=d==null?void 0:d.elementFromPoint(j,S),E=Yx(c,C),k=h==null?void 0:h.getBoundingClientRect();if(!k||!E)return;let R,T=Wn(e,k),I=!1,F=null,N=!1,P=null;const O=yO({nodes:v(),nodeId:r,handleId:t,handleType:E}),H=()=>{if(!p)return;const[L,M]=bN(T,k);w({x:L,y:M}),b=requestAnimationFrame(H)};o({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:r,handleId:t,type:E},connectionEndHandle:null}),g==null||g(e,{nodeId:r,handleId:t,handleType:E});function D(L){const{transform:M}=s();T=Wn(L,k);const{handle:$,validHandleResult:W}=vO(L,d,kv(T,M,!1,[1,1]),y,O,B=>ON(B,f,r,t,i?"target":"source",l,d));if(_=$,I||(H(),I=!0),P=W.handleDomNode,F=W.connection,N=W.isValid,o({connectionPosition:_&&N?RN({x:_.x,y:_.y},M):T,connectionStatus:bO(!!_,N),connectionEndHandle:W.endHandle}),!_&&!N&&!P)return Ju(R);F.source!==F.target&&P&&(Ju(R),R=P,P.classList.add("connecting","react-flow__handle-connecting"),P.classList.toggle("valid",N),P.classList.toggle("react-flow__handle-valid",N))}function A(L){var M,$;(_||P)&&F&&N&&(n==null||n(F)),($=(M=s()).onConnectEnd)==null||$.call(M,L),c&&(u==null||u(L)),Ju(R),x(),cancelAnimationFrame(b),I=!1,N=!1,F=null,P=null,d.removeEventListener("mousemove",D),d.removeEventListener("mouseup",A),d.removeEventListener("touchmove",D),d.removeEventListener("touchend",A)}d.addEventListener("mousemove",D),d.addEventListener("mouseup",A),d.addEventListener("touchmove",D),d.addEventListener("touchend",A)}const xb=()=>!0,wO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),_O=(e,t,r)=>n=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=n;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r}},LN=m.forwardRef(({type:e="source",position:t=se.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:l,children:c,className:u,onMouseDown:d,onTouchStart:f,...h},p)=>{var k,R;const y=o||null,g=e==="target",w=xt(),v=fO(),{connectOnClick:x,noPanClassName:b}=Ve(wO,Rt),{connecting:_,clickConnecting:j}=Ve(_O(v,y,e),Rt);v||(R=(k=w.getState()).onError)==null||R.call(k,"010",hn.error010());const S=T=>{const{defaultEdgeOptions:I,onConnect:F,hasDefaultEdges:N}=w.getState(),P={...I,...T};if(N){const{edges:O,setEdges:H}=w.getState();H(gO(P,O))}F==null||F(P),l==null||l(P)},C=T=>{if(!v)return;const I=kN(T);i&&(I&&T.button===0||!I)&&DN({event:T,handleId:y,nodeId:v,onConnect:S,isTarget:g,getState:w.getState,setState:w.setState,isValidConnection:r||w.getState().isValidConnection||xb}),I?d==null||d(T):f==null||f(T)},E=T=>{const{onClickConnectStart:I,onClickConnectEnd:F,connectionClickStartHandle:N,connectionMode:P,isValidConnection:O}=w.getState();if(!v||!N&&!i)return;if(!N){I==null||I(T,{nodeId:v,handleId:y,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:y}});return}const H=wN(T.target),D=r||O||xb,{connection:A,isValid:L}=ON({nodeId:v,id:y,type:e},P,N.nodeId,N.handleId||null,N.type,D,H);L&&S(A),F==null||F(T),w.setState({connectionClickStartHandle:null})};return G.createElement("div",{"data-handleid":y,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${y}-${e}`,className:Kt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,u,{source:!g,target:g,connectable:n,connectablestart:i,connectableend:s,connecting:j,connectionindicator:n&&(i&&!_||s&&_)}]),onMouseDown:C,onTouchStart:C,onClick:x?E:void 0,ref:p,...h},c)});LN.displayName="Handle";var Ur=m.memo(LN);const FN=({data:e,isConnectable:t,targetPosition:r=se.Top,sourcePosition:n=se.Bottom})=>G.createElement(G.Fragment,null,G.createElement(Ur,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,G.createElement(Ur,{type:"source",position:n,isConnectable:t}));FN.displayName="DefaultNode";var Cv=m.memo(FN);const qN=({data:e,isConnectable:t,sourcePosition:r=se.Bottom})=>G.createElement(G.Fragment,null,e==null?void 0:e.label,G.createElement(Ur,{type:"source",position:r,isConnectable:t}));qN.displayName="InputNode";var zN=m.memo(qN);const $N=({data:e,isConnectable:t,targetPosition:r=se.Top})=>G.createElement(G.Fragment,null,G.createElement(Ur,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);$N.displayName="OutputNode";var BN=m.memo($N);const Xx=()=>null;Xx.displayName="GroupNode";const jO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Za=e=>e.id;function SO(e,t){return Rt(e.selectedNodes.map(Za),t.selectedNodes.map(Za))&&Rt(e.selectedEdges.map(Za),t.selectedEdges.map(Za))}const HN=m.memo(({onSelectionChange:e})=>{const t=xt(),{selectedNodes:r,selectedEdges:n}=Ve(jO,SO);return m.useEffect(()=>{const i={nodes:r,edges:n};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[r,n,e]),null});HN.displayName="SelectionListener";const kO=e=>!!e.onSelectionChange;function CO({onSelectionChange:e}){const t=Ve(kO);return e||t?G.createElement(HN,{onSelectionChange:e}):null}const NO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oi(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function je(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const EO=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:d,nodesFocusable:f,edgesFocusable:h,edgesUpdatable:p,elevateNodesOnSelect:y,minZoom:g,maxZoom:w,nodeExtent:v,onNodesChange:x,onEdgesChange:b,elementsSelectable:_,connectionMode:j,snapGrid:S,snapToGrid:C,translateExtent:E,connectOnClick:k,defaultEdgeOptions:R,fitView:T,fitViewOptions:I,onNodesDelete:F,onEdgesDelete:N,onNodeDrag:P,onNodeDragStart:O,onNodeDragStop:H,onSelectionDrag:D,onSelectionDragStart:A,onSelectionDragStop:L,noPanClassName:M,nodeOrigin:$,rfId:W,autoPanOnConnect:B,autoPanOnNodeDrag:Y,onError:Z,connectionRadius:ie,isValidConnection:re,nodeDragThreshold:de})=>{const{setNodes:ee,setEdges:_e,setDefaultNodesAndEdges:ue,setMinZoom:Te,setMaxZoom:pe,setTranslateExtent:te,setNodeExtent:xe,reset:K}=Ve(NO,Rt),X=xt();return m.useEffect(()=>{const fe=n==null?void 0:n.map(me=>({...me,...R}));return ue(r,fe),()=>{K()}},[]),je("defaultEdgeOptions",R,X.setState),je("connectionMode",j,X.setState),je("onConnect",i,X.setState),je("onConnectStart",s,X.setState),je("onConnectEnd",o,X.setState),je("onClickConnectStart",l,X.setState),je("onClickConnectEnd",c,X.setState),je("nodesDraggable",u,X.setState),je("nodesConnectable",d,X.setState),je("nodesFocusable",f,X.setState),je("edgesFocusable",h,X.setState),je("edgesUpdatable",p,X.setState),je("elementsSelectable",_,X.setState),je("elevateNodesOnSelect",y,X.setState),je("snapToGrid",C,X.setState),je("snapGrid",S,X.setState),je("onNodesChange",x,X.setState),je("onEdgesChange",b,X.setState),je("connectOnClick",k,X.setState),je("fitViewOnInit",T,X.setState),je("fitViewOnInitOptions",I,X.setState),je("onNodesDelete",F,X.setState),je("onEdgesDelete",N,X.setState),je("onNodeDrag",P,X.setState),je("onNodeDragStart",O,X.setState),je("onNodeDragStop",H,X.setState),je("onSelectionDrag",D,X.setState),je("onSelectionDragStart",A,X.setState),je("onSelectionDragStop",L,X.setState),je("noPanClassName",M,X.setState),je("nodeOrigin",$,X.setState),je("rfId",W,X.setState),je("autoPanOnConnect",B,X.setState),je("autoPanOnNodeDrag",Y,X.setState),je("onError",Z,X.setState),je("connectionRadius",ie,X.setState),je("isValidConnection",re,X.setState),je("nodeDragThreshold",de,X.setState),Oi(e,ee),Oi(t,_e),Oi(g,Te),Oi(w,pe),Oi(E,te),Oi(v,xe),null},yb={display:"none"},TO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},WN="react-flow__node-desc",UN="react-flow__edge-desc",RO="react-flow__aria-live",AO=e=>e.ariaLiveMessage;function IO({rfId:e}){const t=Ve(AO);return G.createElement("div",{id:`${RO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:TO},t)}function MO({rfId:e,disableKeyboardA11y:t}){return G.createElement(G.Fragment,null,G.createElement("div",{id:`${WN}-${e}`,style:yb},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),G.createElement("div",{id:`${UN}-${e}`,style:yb},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&G.createElement(IO,{rfId:e}))}var na=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),i=m.useRef(!1),s=m.useRef(new Set([])),[o,l]=m.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),d=u.reduce((f,h)=>f.concat(...h),[]);return[u,d]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const d=p=>{if(i.current=p.ctrlKey||p.metaKey||p.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&_v(p))return!1;const g=wb(p.code,l);s.current.add(p[g]),bb(o,s.current,!1)&&(p.preventDefault(),n(!0))},f=p=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&_v(p))return!1;const g=wb(p.code,l);bb(o,s.current,!0)?(n(!1),s.current.clear()):s.current.delete(p[g]),p.key==="Meta"&&s.current.clear(),i.current=!1},h=()=>{s.current.clear(),n(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",h),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",h)}}},[e,n]),r};function bb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function wb(e,t){return t.includes(e)?"code":"key"}function VN(e,t,r,n){var l,c;const i=e.parentNode||e.parentId;if(!i)return r;const s=t.get(i),o=xi(s,n);return VN(s,t,{x:(r.x??0)+o.x,y:(r.y??0)+o.y,z:(((l=s[rt])==null?void 0:l.z)??0)>(r.z??0)?((c=s[rt])==null?void 0:c.z)??0:r.z??0},n)}function GN(e,t,r){e.forEach(n=>{var s;const i=n.parentNode||n.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||r!=null&&r[n.id]){const{x:o,y:l,z:c}=VN(n,e,{...n.position,z:((s=n[rt])==null?void 0:s.z)??0},t);n.positionAbsolute={x:o,y:l},n[rt].z=c,r!=null&&r[n.id]&&(n[rt].isParent=!0)}})}function ed(e,t,r,n){const i=new Map,s={},o=n?1e3:0;return e.forEach(l=>{var p;const c=(fr(l.zIndex)?l.zIndex:0)+(l.selected?o:0),u=t.get(l.id),d={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(s[f]=!0);const h=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==l.type;Object.defineProperty(d,rt,{enumerable:!1,value:{handleBounds:h||(p=u==null?void 0:u[rt])==null?void 0:p.handleBounds,z:c}}),i.set(l.id,d)}),GN(i,r,s),i}function KN(e,t={}){const{getNodes:r,width:n,height:i,minZoom:s,maxZoom:o,d3Zoom:l,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:d,nodeOrigin:f}=e(),h=t.initial&&!u&&d;if(l&&c&&(h||!t.initial)){const y=r().filter(w=>{var x;const v=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(x=t.nodes)!=null&&x.length?v&&t.nodes.some(b=>b.id===w.id):v}),g=y.every(w=>w.width&&w.height);if(y.length>0&&g){const w=Uc(y,f),{x:v,y:x,zoom:b}=MN(w,n,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),_=ln.translate(v,x).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(li(c,t.duration),_):l.transform(c,_),!0}}return!1}function PO(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[rt]:n[rt],selected:r.selected})}),new Map(t)}function OO(e,t){return t.map(r=>{const n=e.find(i=>i.id===r.id);return n&&(r.selected=n.selected),r})}function Ja({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:u}=r();e!=null&&e.length&&(c&&n({nodeInternals:PO(e,i)}),o==null||o(e)),t!=null&&t.length&&(u&&n({edges:OO(t,s)}),l==null||l(t))}const Di=()=>{},DO={zoomIn:Di,zoomOut:Di,zoomTo:Di,getZoom:()=>1,setViewport:Di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Di,fitBounds:Di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},LO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),FO=()=>{const e=xt(),{d3Zoom:t,d3Selection:r}=Ve(LO,Rt);return m.useMemo(()=>r&&t?{zoomIn:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(li(r,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,l,c]=e.getState().transform,u=ln.translate(i.x??o,i.y??l).scale(i.zoom??c);t.transform(li(r,s==null?void 0:s.duration),u)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>KN(e.getState,i),setCenter:(i,s,o)=>{const{width:l,height:c,maxZoom:u}=e.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:u,f=l/2-i*d,h=c/2-s*d,p=ln.translate(f,h).scale(d);t.transform(li(r,o==null?void 0:o.duration),p)},fitBounds:(i,s)=>{const{width:o,height:l,minZoom:c,maxZoom:u}=e.getState(),{x:d,y:f,zoom:h}=MN(i,o,l,c,u,(s==null?void 0:s.padding)??.1),p=ln.translate(d,f).scale(h);t.transform(li(r,s==null?void 0:s.duration),p)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),kv(i,s,o,l)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:l,domNode:c}=e.getState();if(!c)return i;const{x:u,y:d}=c.getBoundingClientRect(),f={x:i.x-u,y:i.y-d};return kv(f,s,o,l)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:l,y:c}=o.getBoundingClientRect(),u=RN(i,s);return{x:u.x+l,y:u.y+c}},viewportInitialized:!0}:DO,[t,r])};function Vc(){const e=FO(),t=xt(),r=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),n=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),i=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(w=>({...w}))},[]),s=m.useCallback(g=>{const{edges:w=[]}=t.getState();return w.find(v=>v.id===g)},[]),o=m.useCallback(g=>{const{getNodes:w,setNodes:v,hasDefaultNodes:x,onNodesChange:b}=t.getState(),_=w(),j=typeof g=="function"?g(_):g;if(x)v(j);else if(b){const S=j.length===0?_.map(C=>({type:"remove",id:C.id})):j.map(C=>({item:C,type:"reset"}));b(S)}},[]),l=m.useCallback(g=>{const{edges:w=[],setEdges:v,hasDefaultEdges:x,onEdgesChange:b}=t.getState(),_=typeof g=="function"?g(w):g;if(x)v(_);else if(b){const j=_.length===0?w.map(S=>({type:"remove",id:S.id})):_.map(S=>({item:S,type:"reset"}));b(j)}},[]),c=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{getNodes:v,setNodes:x,hasDefaultNodes:b,onNodesChange:_}=t.getState();if(b){const S=[...v(),...w];x(S)}else if(_){const j=w.map(S=>({item:S,type:"add"}));_(j)}},[]),u=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{edges:v=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:_}=t.getState();if(b)x([...v,...w]);else if(_){const j=w.map(S=>({item:S,type:"add"}));_(j)}},[]),d=m.useCallback(()=>{const{getNodes:g,edges:w=[],transform:v}=t.getState(),[x,b,_]=v;return{nodes:g().map(j=>({...j})),edges:w.map(j=>({...j})),viewport:{x,y:b,zoom:_}}},[]),f=m.useCallback(({nodes:g,edges:w})=>{const{nodeInternals:v,getNodes:x,edges:b,hasDefaultNodes:_,hasDefaultEdges:j,onNodesDelete:S,onEdgesDelete:C,onNodesChange:E,onEdgesChange:k}=t.getState(),R=(g||[]).map(P=>P.id),T=(w||[]).map(P=>P.id),I=x().reduce((P,O)=>{const H=O.parentNode||O.parentId,D=!R.includes(O.id)&&H&&P.find(L=>L.id===H);return(typeof O.deletable=="boolean"?O.deletable:!0)&&(R.includes(O.id)||D)&&P.push(O),P},[]),F=b.filter(P=>typeof P.deletable=="boolean"?P.deletable:!0),N=F.filter(P=>T.includes(P.id));if(I||N){const P=IN(I,F),O=[...N,...P],H=O.reduce((D,A)=>(D.includes(A.id)||D.push(A.id),D),[]);if((j||_)&&(j&&t.setState({edges:b.filter(D=>!H.includes(D.id))}),_&&(I.forEach(D=>{v.delete(D.id)}),t.setState({nodeInternals:new Map(v)}))),H.length>0&&(C==null||C(O),k&&k(H.map(D=>({id:D,type:"remove"})))),I.length>0&&(S==null||S(I),E)){const D=I.map(A=>({id:A.id,type:"remove"}));E(D)}}},[]),h=m.useCallback(g=>{const w=iO(g),v=w?null:t.getState().nodeInternals.get(g.id);return!w&&!v?[null,null,w]:[w?g:fb(v),v,w]},[]),p=m.useCallback((g,w=!0,v)=>{const[x,b,_]=h(g);return x?(v||t.getState().getNodes()).filter(j=>{if(!_&&(j.id===b.id||!j.positionAbsolute))return!1;const S=fb(j),C=wv(S,x);return w&&C>0||C>=x.width*x.height}):[]},[]),y=m.useCallback((g,w,v=!0)=>{const[x]=h(g);if(!x)return!1;const b=wv(x,w);return v&&b>0||b>=x.width*x.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:i,getEdge:s,setNodes:o,setEdges:l,addNodes:c,addEdges:u,toObject:d,deleteElements:f,getIntersectingNodes:p,isNodeIntersecting:y}),[e,r,n,i,s,o,l,c,u,d,f,p,y])}const qO={actInsideInputWithModifier:!1};var zO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=xt(),{deleteElements:n}=Vc(),i=na(e,qO),s=na(t);m.useEffect(()=>{if(i){const{edges:o,getNodes:l}=r.getState(),c=l().filter(d=>d.selected),u=o.filter(d=>d.selected);n({nodes:c,edges:u}),r.setState({nodesSelectionActive:!1})}},[i]),m.useEffect(()=>{r.setState({multiSelectionActive:s})},[s])};function $O(e){const t=xt();m.useEffect(()=>{let r;const n=()=>{var s,o;if(!e.current)return;const i=Hx(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",hn.error004())),t.setState({width:i.width||500,height:i.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const Qx={position:"absolute",width:"100%",height:"100%",top:0,left:0},BO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,el=e=>({x:e.x,y:e.y,zoom:e.k}),Li=(e,t)=>e.target.closest(`.${t}`),_b=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),jb=e=>{const t=e.ctrlKey&&nc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},HO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),WO=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=pi.Free,zoomOnDoubleClick:u=!0,elementsSelectable:d,panOnDrag:f=!0,defaultViewport:h,translateExtent:p,minZoom:y,maxZoom:g,zoomActivationKeyCode:w,preventScrolling:v=!0,children:x,noWheelClassName:b,noPanClassName:_})=>{const j=m.useRef(),S=xt(),C=m.useRef(!1),E=m.useRef(!1),k=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:I,d3ZoomHandler:F,userSelectionActive:N}=Ve(HO,Rt),P=na(w),O=m.useRef(0),H=m.useRef(!1),D=m.useRef();return $O(k),m.useEffect(()=>{if(k.current){const A=k.current.getBoundingClientRect(),L=xN().scaleExtent([y,g]).translateExtent(p),M=ur(k.current).call(L),$=ln.translate(h.x,h.y).scale(Cs(h.zoom,y,g)),W=[[0,0],[A.width,A.height]],B=L.constrain()($,W,p);L.transform(M,B),L.wheelDelta(jb),S.setState({d3Zoom:L,d3Selection:M,d3ZoomHandler:M.on("wheel.zoom"),transform:[B.x,B.y,B.k],domNode:k.current.closest(".react-flow")})}},[]),m.useEffect(()=>{I&&T&&(o&&!P&&!N?I.on("wheel.zoom",A=>{if(Li(A,b))return!1;A.preventDefault(),A.stopImmediatePropagation();const L=I.property("__zoom").k||1;if(A.ctrlKey&&s){const re=Sr(A),de=jb(A),ee=L*Math.pow(2,de);T.scaleTo(I,ee,re,A);return}const M=A.deltaMode===1?20:1;let $=c===pi.Vertical?0:A.deltaX*M,W=c===pi.Horizontal?0:A.deltaY*M;!nc()&&A.shiftKey&&c!==pi.Vertical&&($=A.deltaY*M,W=0),T.translateBy(I,-($/L)*l,-(W/L)*l,{internal:!0});const B=el(I.property("__zoom")),{onViewportChangeStart:Y,onViewportChange:Z,onViewportChangeEnd:ie}=S.getState();clearTimeout(D.current),H.current||(H.current=!0,t==null||t(A,B),Y==null||Y(B)),H.current&&(e==null||e(A,B),Z==null||Z(B),D.current=setTimeout(()=>{r==null||r(A,B),ie==null||ie(B),H.current=!1},150))},{passive:!1}):typeof F<"u"&&I.on("wheel.zoom",function(A,L){if(!v&&A.type==="wheel"&&!A.ctrlKey||Li(A,b))return null;A.preventDefault(),F.call(this,A,L)},{passive:!1}))},[N,o,c,I,T,F,P,s,v,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",A=>{var $,W;if(!A.sourceEvent||A.sourceEvent.internal)return null;O.current=($=A.sourceEvent)==null?void 0:$.button;const{onViewportChangeStart:L}=S.getState(),M=el(A.transform);C.current=!0,R.current=M,((W=A.sourceEvent)==null?void 0:W.type)==="mousedown"&&S.setState({paneDragging:!0}),L==null||L(M),t==null||t(A.sourceEvent,M)})},[T,t]),m.useEffect(()=>{T&&(N&&!C.current?T.on("zoom",null):N||T.on("zoom",A=>{var M;const{onViewportChange:L}=S.getState();if(S.setState({transform:[A.transform.x,A.transform.y,A.transform.k]}),E.current=!!(n&&_b(f,O.current??0)),(e||L)&&!((M=A.sourceEvent)!=null&&M.internal)){const $=el(A.transform);L==null||L($),e==null||e(A.sourceEvent,$)}}))},[N,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",A=>{if(!A.sourceEvent||A.sourceEvent.internal)return null;const{onViewportChangeEnd:L}=S.getState();if(C.current=!1,S.setState({paneDragging:!1}),n&&_b(f,O.current??0)&&!E.current&&n(A.sourceEvent),E.current=!1,(r||L)&&BO(R.current,A.transform)){const M=el(A.transform);R.current=M,clearTimeout(j.current),j.current=setTimeout(()=>{L==null||L(M),r==null||r(A.sourceEvent,M)},o?150:0)}})},[T,o,f,r,n]),m.useEffect(()=>{T&&T.filter(A=>{const L=P||i,M=s&&A.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&A.button===1&&A.type==="mousedown"&&(Li(A,"react-flow__node")||Li(A,"react-flow__edge")))return!0;if(!f&&!L&&!o&&!u&&!s||N||!u&&A.type==="dblclick"||Li(A,b)&&A.type==="wheel"||Li(A,_)&&(A.type!=="wheel"||o&&A.type==="wheel"&&!P)||!s&&A.ctrlKey&&A.type==="wheel"||!L&&!o&&!M&&A.type==="wheel"||!f&&(A.type==="mousedown"||A.type==="touchstart")||Array.isArray(f)&&!f.includes(A.button)&&A.type==="mousedown")return!1;const $=Array.isArray(f)&&f.includes(A.button)||!A.button||A.button<=1;return(!A.ctrlKey||A.type==="wheel")&&$})},[N,T,i,s,o,u,f,d,P]),G.createElement("div",{className:"react-flow__renderer",ref:k,style:Qx},x)},UO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function VO(){const{userSelectionActive:e,userSelectionRect:t}=Ve(UO,Rt);return e&&t?G.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Sb(e,t){const r=t.parentNode||t.parentId,n=e.find(i=>i.id===r);if(n){const i=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,i>0&&(n.style.width+=i),s>0&&(n.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);n.position.x=n.position.x-o,n.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);n.position.y=n.position.y-o,n.style.height+=o,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function YN(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,i)=>{const s=e.filter(l=>l.id===i.id);if(s.length===0)return n.push(i),n;const o={...i};for(const l of s)if(l)switch(l.type){case"select":{o.selected=l.selected;break}case"position":{typeof l.position<"u"&&(o.position=l.position),typeof l.positionAbsolute<"u"&&(o.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(o.dragging=l.dragging),o.expandParent&&Sb(n,o);break}case"dimensions":{typeof l.dimensions<"u"&&(o.width=l.dimensions.width,o.height=l.dimensions.height),typeof l.updateStyle<"u"&&(o.style={...o.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(o.resizing=l.resizing),o.expandParent&&Sb(n,o);break}case"remove":return n}return n.push(o),n},r)}function XN(e,t){return YN(e,t)}function GO(e,t){return YN(e,t)}const Cn=(e,t)=>({id:e,type:"select",selected:t});function ns(e,t){return e.reduce((r,n)=>{const i=t.includes(n.id);return!n.selected&&i?(n.selected=!0,r.push(Cn(n.id,!0))):n.selected&&!i&&(n.selected=!1,r.push(Cn(n.id,!1))),r},[])}const td=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},KO=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),QN=m.memo(({isSelecting:e,selectionMode:t=ra.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:d,children:f})=>{const h=m.useRef(null),p=xt(),y=m.useRef(0),g=m.useRef(0),w=m.useRef(),{userSelectionActive:v,elementsSelectable:x,dragging:b}=Ve(KO,Rt),_=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,g.current=0},j=F=>{s==null||s(F),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},S=F=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){F.preventDefault();return}o==null||o(F)},C=l?F=>l(F):void 0,E=F=>{const{resetSelectedElements:N,domNode:P}=p.getState();if(w.current=P==null?void 0:P.getBoundingClientRect(),!x||!e||F.button!==0||F.target!==h.current||!w.current)return;const{x:O,y:H}=Wn(F,w.current);N(),p.setState({userSelectionRect:{width:0,height:0,startX:O,startY:H,x:O,y:H}}),n==null||n(F)},k=F=>{const{userSelectionRect:N,nodeInternals:P,edges:O,transform:H,onNodesChange:D,onEdgesChange:A,nodeOrigin:L,getNodes:M}=p.getState();if(!e||!w.current||!N)return;p.setState({userSelectionActive:!0,nodesSelectionActive:!1});const $=Wn(F,w.current),W=N.startX??0,B=N.startY??0,Y={...N,x:$.x<W?$.x:W,y:$.y<B?$.y:B,width:Math.abs($.x-W),height:Math.abs($.y-B)},Z=M(),ie=AN(P,Y,H,t===ra.Partial,!0,L),re=IN(ie,O).map(ee=>ee.id),de=ie.map(ee=>ee.id);if(y.current!==de.length){y.current=de.length;const ee=ns(Z,de);ee.length&&(D==null||D(ee))}if(g.current!==re.length){g.current=re.length;const ee=ns(O,re);ee.length&&(A==null||A(ee))}p.setState({userSelectionRect:Y})},R=F=>{if(F.button!==0)return;const{userSelectionRect:N}=p.getState();!v&&N&&F.target===h.current&&(j==null||j(F)),p.setState({nodesSelectionActive:y.current>0}),_(),i==null||i(F)},T=F=>{v&&(p.setState({nodesSelectionActive:y.current>0}),i==null||i(F)),_()},I=x&&(e||v);return G.createElement("div",{className:Kt(["react-flow__pane",{dragging:b,selection:e}]),onClick:I?void 0:td(j,h),onContextMenu:td(S,h),onWheel:td(C,h),onMouseEnter:I?void 0:c,onMouseDown:I?E:void 0,onMouseMove:I?k:u,onMouseUp:I?R:void 0,onMouseLeave:I?T:d,ref:h,style:Qx},f,G.createElement(VO,null))});QN.displayName="Pane";function ZN(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:ZN(n,t):!1}function kb(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function YO(e,t,r,n){return Array.from(e.values()).filter(i=>(i.selected||i.id===n)&&(!i.parentNode||i.parentId||!ZN(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:r.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function XO(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function JN(e,t,r,n,i=[0,0],s){const o=XO(e,e.extent||n);let l=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:h,y:p}=xi(f,i).positionAbsolute;l=f&&fr(h)&&fr(p)&&fr(f.width)&&fr(f.height)?[[h+e.width*i[0],p+e.height*i[1]],[h+f.width-e.width+e.width*i[0],p+f.height-e.height+e.height*i[1]]]:l}else s==null||s("005",hn.error005()),l=o;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:h,y:p}=xi(f,i).positionAbsolute;l=[[e.extent[0][0]+h,e.extent[0][1]+p],[e.extent[1][0]+h,e.extent[1][1]+p]]}let u={x:0,y:0};if(c){const f=r.get(c);u=xi(f,i).positionAbsolute}const d=l&&l!=="parent"?Wx(t,l):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function rd({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(i=>({...r.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?n.find(i=>i.id===e):n[0],n]}const Cb=(e,t,r,n)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),l={x:o.width*n[0],y:o.height*n[1]};return s.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-o.left-l.x)/r,y:(u.top-o.top-l.y)/r,...Hx(c)}})};function Js(e,t,r){return r===void 0?r:n=>{const i=t().nodeInternals.get(e);i&&r(n,{...i})}}function Nv({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:l,onError:c}=t.getState(),u=l.get(e);if(!u){c==null||c("012",hn.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&o)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=n==null?void 0:n.current)==null?void 0:d.blur()})):i([e])}function QO(){const e=xt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:i,snapToGrid:s}=e.getState(),o=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(o-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function nd(e){return(t,r,n)=>e==null?void 0:e(t,n)}function eE({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const l=xt(),[c,u]=m.useState(!1),d=m.useRef([]),f=m.useRef({x:null,y:null}),h=m.useRef(0),p=m.useRef(null),y=m.useRef({x:0,y:0}),g=m.useRef(null),w=m.useRef(!1),v=m.useRef(!1),x=m.useRef(!1),b=QO();return m.useEffect(()=>{if(e!=null&&e.current){const _=ur(e.current),j=({x:E,y:k})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:I,updateNodePositions:F,nodeExtent:N,snapGrid:P,snapToGrid:O,nodeOrigin:H,onError:D}=l.getState();f.current={x:E,y:k};let A=!1,L={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&N){const $=Uc(d.current,H);L=ta($)}if(d.current=d.current.map($=>{const W={x:E-$.distance.x,y:k-$.distance.y};O&&(W.x=P[0]*Math.round(W.x/P[0]),W.y=P[1]*Math.round(W.y/P[1]));const B=[[N[0][0],N[0][1]],[N[1][0],N[1][1]]];d.current.length>1&&N&&!$.extent&&(B[0][0]=$.positionAbsolute.x-L.x+N[0][0],B[1][0]=$.positionAbsolute.x+($.width??0)-L.x2+N[1][0],B[0][1]=$.positionAbsolute.y-L.y+N[0][1],B[1][1]=$.positionAbsolute.y+($.height??0)-L.y2+N[1][1]);const Y=JN($,W,R,B,H,D);return A=A||$.position.x!==Y.position.x||$.position.y!==Y.position.y,$.position=Y.position,$.positionAbsolute=Y.positionAbsolute,$}),!A)return;F(d.current,!0,!0),u(!0);const M=i?T:nd(I);if(M&&g.current){const[$,W]=rd({nodeId:i,dragItems:d.current,nodeInternals:R});M(g.current,$,W)}},S=()=>{if(!p.current)return;const[E,k]=bN(y.current,p.current);if(E!==0||k!==0){const{transform:R,panBy:T}=l.getState();f.current.x=(f.current.x??0)-E/R[2],f.current.y=(f.current.y??0)-k/R[2],T({x:E,y:k})&&j(f.current)}h.current=requestAnimationFrame(S)},C=E=>{var H;const{nodeInternals:k,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:I,onNodeDragStart:F,onSelectionDragStart:N}=l.getState();v.current=!0;const P=i?F:nd(N);(!o||!s)&&!R&&i&&((H=k.get(i))!=null&&H.selected||I()),i&&s&&o&&Nv({id:i,store:l,nodeRef:e});const O=b(E);if(f.current=O,d.current=YO(k,T,O,i),P&&d.current){const[D,A]=rd({nodeId:i,dragItems:d.current,nodeInternals:k});P(E.sourceEvent,D,A)}};if(t)_.on(".drag",null);else{const E=lM().on("start",k=>{const{domNode:R,nodeDragThreshold:T}=l.getState();T===0&&C(k),x.current=!1;const I=b(k);f.current=I,p.current=(R==null?void 0:R.getBoundingClientRect())||null,y.current=Wn(k.sourceEvent,p.current)}).on("drag",k=>{var F,N;const R=b(k),{autoPanOnNodeDrag:T,nodeDragThreshold:I}=l.getState();if(k.sourceEvent.type==="touchmove"&&k.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!w.current&&v.current&&T&&(w.current=!0,S()),!v.current){const P=R.xSnapped-(((F=f==null?void 0:f.current)==null?void 0:F.x)??0),O=R.ySnapped-(((N=f==null?void 0:f.current)==null?void 0:N.y)??0);Math.sqrt(P*P+O*O)>I&&C(k)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&d.current&&v.current&&(g.current=k.sourceEvent,y.current=Wn(k.sourceEvent,p.current),j(R))}}).on("end",k=>{if(!(!v.current||x.current)&&(u(!1),w.current=!1,v.current=!1,cancelAnimationFrame(h.current),d.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:I,onSelectionDragStop:F}=l.getState(),N=i?I:nd(F);if(R(d.current,!1,!1),N){const[P,O]=rd({nodeId:i,dragItems:d.current,nodeInternals:T});N(k.sourceEvent,P,O)}}}).filter(k=>{const R=k.target;return!k.button&&(!r||!kb(R,`.${r}`,e))&&(!n||kb(R,n,e))});return _.call(E),()=>{_.on(".drag",null)}}}},[e,t,r,n,s,l,i,o,b]),c}function tE(){const e=xt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:l,snapGrid:c,onError:u,nodesDraggable:d}=e.getState(),f=o().filter(x=>x.selected&&(x.draggable||d&&typeof x.draggable>"u")),h=l?c[0]:5,p=l?c[1]:5,y=r.isShiftPressed?4:1,g=r.x*h*y,w=r.y*p*y,v=f.map(x=>{if(x.positionAbsolute){const b={x:x.positionAbsolute.x+g,y:x.positionAbsolute.y+w};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:_,position:j}=JN(x,b,n,i,void 0,u);x.position=j,x.positionAbsolute=_}return x});s(v,!0,!1)},[])}const hs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var eo=e=>{const t=({id:r,type:n,data:i,xPos:s,yPos:o,xPosOrigin:l,yPosOrigin:c,selected:u,onClick:d,onMouseEnter:f,onMouseMove:h,onMouseLeave:p,onContextMenu:y,onDoubleClick:g,style:w,className:v,isDraggable:x,isSelectable:b,isConnectable:_,isFocusable:j,selectNodesOnDrag:S,sourcePosition:C,targetPosition:E,hidden:k,resizeObserver:R,dragHandle:T,zIndex:I,isParent:F,noDragClassName:N,noPanClassName:P,initialized:O,disableKeyboardA11y:H,ariaLabel:D,rfId:A,hasHandleBounds:L})=>{const M=xt(),$=m.useRef(null),W=m.useRef(null),B=m.useRef(C),Y=m.useRef(E),Z=m.useRef(n),ie=b||x||d||f||h||p,re=tE(),de=Js(r,M.getState,f),ee=Js(r,M.getState,h),_e=Js(r,M.getState,p),ue=Js(r,M.getState,y),Te=Js(r,M.getState,g),pe=K=>{const{nodeDragThreshold:X}=M.getState();if(b&&(!S||!x||X>0)&&Nv({id:r,store:M,nodeRef:$}),d){const fe=M.getState().nodeInternals.get(r);fe&&d(K,{...fe})}},te=K=>{if(!_v(K)&&!H)if(SN.includes(K.key)&&b){const X=K.key==="Escape";Nv({id:r,store:M,unselect:X,nodeRef:$})}else x&&u&&Object.prototype.hasOwnProperty.call(hs,K.key)&&(M.setState({ariaLiveMessage:`Moved selected node ${K.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),re({x:hs[K.key].x,y:hs[K.key].y,isShiftPressed:K.shiftKey}))};m.useEffect(()=>()=>{W.current&&(R==null||R.unobserve(W.current),W.current=null)},[]),m.useEffect(()=>{if($.current&&!k){const K=$.current;(!O||!L||W.current!==K)&&(W.current&&(R==null||R.unobserve(W.current)),R==null||R.observe(K),W.current=K)}},[k,O,L]),m.useEffect(()=>{const K=Z.current!==n,X=B.current!==C,fe=Y.current!==E;$.current&&(K||X||fe)&&(K&&(Z.current=n),X&&(B.current=C),fe&&(Y.current=E),M.getState().updateNodeDimensions([{id:r,nodeElement:$.current,forceUpdate:!0}]))},[r,n,C,E]);const xe=eE({nodeRef:$,disabled:k||!x,noDragClassName:N,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:S});return k?null:G.createElement("div",{className:Kt(["react-flow__node",`react-flow__node-${n}`,{[P]:x},v,{selected:u,selectable:b,parent:F,dragging:xe}]),ref:$,style:{zIndex:I,transform:`translate(${l}px,${c}px)`,pointerEvents:ie?"all":"none",visibility:O?"visible":"hidden",...w},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:de,onMouseMove:ee,onMouseLeave:_e,onContextMenu:ue,onClick:pe,onDoubleClick:Te,onKeyDown:j?te:void 0,tabIndex:j?0:void 0,role:j?"button":void 0,"aria-describedby":H?void 0:`${WN}-${A}`,"aria-label":D},G.createElement(dO,{value:r},G.createElement(e,{id:r,data:i,type:n,xPos:s,yPos:o,selected:u,isConnectable:_,sourcePosition:C,targetPosition:E,dragging:xe,dragHandle:T,zIndex:I})))};return t.displayName="NodeWrapper",m.memo(t)};const ZO=e=>{const t=e.getNodes().filter(r=>r.selected);return{...Uc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function JO({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=xt(),{width:i,height:s,x:o,y:l,transformString:c,userSelectionActive:u}=Ve(ZO,Rt),d=tE(),f=m.useRef(null);if(m.useEffect(()=>{var y;r||(y=f.current)==null||y.focus({preventScroll:!0})},[r]),eE({nodeRef:f}),u||!i||!s)return null;const h=e?y=>{const g=n.getState().getNodes().filter(w=>w.selected);e(y,g)}:void 0,p=y=>{Object.prototype.hasOwnProperty.call(hs,y.key)&&d({x:hs[y.key].x,y:hs[y.key].y,isShiftPressed:y.shiftKey})};return G.createElement("div",{className:Kt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},G.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:r?void 0:-1,onKeyDown:r?void 0:p,style:{width:i,height:s,top:l,left:o}}))}var eD=m.memo(JO);const tD=e=>e.nodesSelectionActive,rE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:l,onMove:c,onMoveStart:u,onMoveEnd:d,selectionKeyCode:f,selectionOnDrag:h,selectionMode:p,onSelectionStart:y,onSelectionEnd:g,multiSelectionKeyCode:w,panActivationKeyCode:v,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:S,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:k,panOnDrag:R,defaultViewport:T,translateExtent:I,minZoom:F,maxZoom:N,preventScrolling:P,onSelectionContextMenu:O,noWheelClassName:H,noPanClassName:D,disableKeyboardA11y:A})=>{const L=Ve(tD),M=na(f),$=na(v),W=$||R,B=$||S,Y=M||h&&W!==!0;return zO({deleteKeyCode:l,multiSelectionKeyCode:w}),G.createElement(WO,{onMove:c,onMoveStart:u,onMoveEnd:d,onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:B,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:k,panOnDrag:!M&&W,defaultViewport:T,translateExtent:I,minZoom:F,maxZoom:N,zoomActivationKeyCode:x,preventScrolling:P,noWheelClassName:H,noPanClassName:D},G.createElement(QN,{onSelectionStart:y,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:W,isSelecting:!!Y,selectionMode:p},e,L&&G.createElement(eD,{onSelectionContextMenu:O,noPanClassName:D,disableKeyboardA11y:A})))};rE.displayName="FlowRenderer";var rD=m.memo(rE);function nD(e){return Ve(m.useCallback(r=>e?AN(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function iD(e){const t={input:eo(e.input||zN),default:eo(e.default||Cv),output:eo(e.output||BN),group:eo(e.group||Xx)},r={},n=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=eo(e[s]||Cv),i),r);return{...t,...n}}const sD=({x:e,y:t,width:r,height:n,origin:i})=>!r||!n?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-r*i[0],y:t-n*i[1]},oD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),nE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Ve(oD,Rt),l=nD(e.onlyRenderVisibleElements),c=m.useRef(),u=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(f=>{const h=f.map(p=>({id:p.target.getAttribute("data-id"),nodeElement:p.target,forceUpdate:!0}));s(h)});return c.current=d,d},[]);return m.useEffect(()=>()=>{var d;(d=c==null?void 0:c.current)==null||d.disconnect()},[]),G.createElement("div",{className:"react-flow__nodes",style:Qx},l.map(d=>{var j,S,C;let f=d.type||"default";e.nodeTypes[f]||(o==null||o("003",hn.error003(f)),f="default");const h=e.nodeTypes[f]||e.nodeTypes.default,p=!!(d.draggable||t&&typeof d.draggable>"u"),y=!!(d.selectable||i&&typeof d.selectable>"u"),g=!!(d.connectable||r&&typeof d.connectable>"u"),w=!!(d.focusable||n&&typeof d.focusable>"u"),v=e.nodeExtent?Wx(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,x=(v==null?void 0:v.x)??0,b=(v==null?void 0:v.y)??0,_=sD({x,y:b,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return G.createElement(h,{key:d.id,id:d.id,className:d.className,style:d.style,type:f,data:d.data,sourcePosition:d.sourcePosition||se.Bottom,targetPosition:d.targetPosition||se.Top,hidden:d.hidden,xPos:x,yPos:b,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:p,isSelectable:y,isConnectable:g,isFocusable:w,resizeObserver:u,dragHandle:d.dragHandle,zIndex:((j=d[rt])==null?void 0:j.z)??0,isParent:!!((S=d[rt])!=null&&S.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((C=d[rt])!=null&&C.handleBounds)})}))};nE.displayName="NodeRenderer";var aD=m.memo(nE);const lD=(e,t,r)=>r===se.Left?e-t:r===se.Right?e+t:e,cD=(e,t,r)=>r===se.Top?e-t:r===se.Bottom?e+t:e,Nb="react-flow__edgeupdater",Eb=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:l})=>G.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Kt([Nb,`${Nb}-${l}`]),cx:lD(t,n,e),cy:cD(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),uD=()=>!0;var Fi=e=>{const t=({id:r,className:n,type:i,data:s,onClick:o,onEdgeDoubleClick:l,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:g,style:w,source:v,target:x,sourceX:b,sourceY:_,targetX:j,targetY:S,sourcePosition:C,targetPosition:E,elementsSelectable:k,hidden:R,sourceHandleId:T,targetHandleId:I,onContextMenu:F,onMouseEnter:N,onMouseMove:P,onMouseLeave:O,reconnectRadius:H,onReconnect:D,onReconnectStart:A,onReconnectEnd:L,markerEnd:M,markerStart:$,rfId:W,ariaLabel:B,isFocusable:Y,isReconnectable:Z,pathOptions:ie,interactionWidth:re,disableKeyboardA11y:de})=>{const ee=m.useRef(null),[_e,ue]=m.useState(!1),[Te,pe]=m.useState(!1),te=xt(),xe=m.useMemo(()=>`url('#${Sv($,W)}')`,[$,W]),K=m.useMemo(()=>`url('#${Sv(M,W)}')`,[M,W]);if(R)return null;const X=J=>{var oe;const{edges:le,addSelectedEdges:ze,unselectNodesAndEdges:Ze,multiSelectionActive:yt}=te.getState(),kt=le.find(ae=>ae.id===r);kt&&(k&&(te.setState({nodesSelectionActive:!1}),kt.selected&&yt?(Ze({nodes:[],edges:[kt]}),(oe=ee.current)==null||oe.blur()):ze([r])),o&&o(J,kt))},fe=Zs(r,te.getState,l),me=Zs(r,te.getState,F),ye=Zs(r,te.getState,N),ve=Zs(r,te.getState,P),he=Zs(r,te.getState,O),be=(J,le)=>{if(J.button!==0)return;const{edges:ze,isValidConnection:Ze}=te.getState(),yt=le?x:v,kt=(le?I:T)||null,oe=le?"target":"source",ae=Ze||uD,nt=le,It=ze.find($e=>$e.id===r);pe(!0),A==null||A(J,It,oe);const Pr=$e=>{pe(!1),L==null||L($e,It,oe)};DN({event:J,handleId:kt,nodeId:yt,onConnect:$e=>D==null?void 0:D(It,$e),isTarget:nt,getState:te.getState,setState:te.setState,isValidConnection:ae,edgeUpdaterType:oe,onReconnectEnd:Pr})},Fe=J=>be(J,!0),Se=J=>be(J,!1),Le=()=>ue(!0),q=()=>ue(!1),V=!k&&!o,z=J=>{var le;if(!de&&SN.includes(J.key)&&k){const{unselectNodesAndEdges:ze,addSelectedEdges:Ze,edges:yt}=te.getState();J.key==="Escape"?((le=ee.current)==null||le.blur(),ze({edges:[yt.find(oe=>oe.id===r)]})):Ze([r])}};return G.createElement("g",{className:Kt(["react-flow__edge",`react-flow__edge-${i}`,n,{selected:c,animated:u,inactive:V,updating:_e}]),onClick:X,onDoubleClick:fe,onContextMenu:me,onMouseEnter:ye,onMouseMove:ve,onMouseLeave:he,onKeyDown:Y?z:void 0,tabIndex:Y?0:void 0,role:Y?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":B===null?void 0:B||`Edge from ${v} to ${x}`,"aria-describedby":Y?`${UN}-${W}`:void 0,ref:ee},!Te&&G.createElement(e,{id:r,source:v,target:x,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:g,data:s,style:w,sourceX:b,sourceY:_,targetX:j,targetY:S,sourcePosition:C,targetPosition:E,sourceHandleId:T,targetHandleId:I,markerStart:xe,markerEnd:K,pathOptions:ie,interactionWidth:re}),Z&&G.createElement(G.Fragment,null,(Z==="source"||Z===!0)&&G.createElement(Eb,{position:C,centerX:b,centerY:_,radius:H,onMouseDown:Fe,onMouseEnter:Le,onMouseOut:q,type:"source"}),(Z==="target"||Z===!0)&&G.createElement(Eb,{position:E,centerX:j,centerY:S,radius:H,onMouseDown:Se,onMouseEnter:Le,onMouseOut:q,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function dD(e){const t={default:Fi(e.default||sc),straight:Fi(e.bezier||Gx),step:Fi(e.step||Vx),smoothstep:Fi(e.step||Wc),simplebezier:Fi(e.simplebezier||Ux)},r={},n=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Fi(e[s]||sc),i),r);return{...t,...n}}function Tb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,i=((r==null?void 0:r.y)||0)+t.y,s=(r==null?void 0:r.width)||t.width,o=(r==null?void 0:r.height)||t.height;switch(e){case se.Top:return{x:n+s/2,y:i};case se.Right:return{x:n+s,y:i+o/2};case se.Bottom:return{x:n+s/2,y:i+o};case se.Left:return{x:n,y:i+o/2}}}function Rb(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const fD=(e,t,r,n,i,s)=>{const o=Tb(r,e,t),l=Tb(s,n,i);return{sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y}};function pD({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:i,targetHeight:s,width:o,height:l,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+i),y2:Math.max(e.y+n,t.y+s)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=ta({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:l/c[2]}),f=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),h=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(f*h)>0}function Ab(e){var n,i,s,o,l;const t=((n=e==null?void 0:e[rt])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const hD=[{level:0,isMaxLevel:!0,edges:[]}];function mD(e,t,r=!1){let n=-1;const i=e.reduce((o,l)=>{var d,f;const c=fr(l.zIndex);let u=c?l.zIndex:0;if(r){const h=t.get(l.target),p=t.get(l.source),y=l.selected||(h==null?void 0:h.selected)||(p==null?void 0:p.selected),g=Math.max(((d=p==null?void 0:p[rt])==null?void 0:d.z)||0,((f=h==null?void 0:h[rt])==null?void 0:f.z)||0,1e3);u=(c?l.zIndex:0)+(y?g:0)}return o[u]?o[u].push(l):o[u]=[l],n=u>n?u:n,o},{}),s=Object.entries(i).map(([o,l])=>{const c=+o;return{edges:l,level:c,isMaxLevel:c===n}});return s.length===0?hD:s}function gD(e,t,r){const n=Ve(m.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),l=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&pD({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:l.width,targetHeight:l.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return mD(n,t,r)}const vD=({color:e="none",strokeWidth:t=1})=>G.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),xD=({color:e="none",strokeWidth:t=1})=>G.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Ib={[ic.Arrow]:vD,[ic.ArrowClosed]:xD};function yD(e){const t=xt();return m.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Ib,e)?Ib[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",hn.error009(e)),null)},[e])}const bD=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const c=yD(t);return c?G.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0"},G.createElement(c,{color:r,strokeWidth:o})):null},wD=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const l=Sv(o,t);n.includes(l)||(i.push({id:l,color:o.color||e,...o}),n.push(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},iE=({defaultColor:e,rfId:t})=>{const r=Ve(m.useCallback(wD({defaultColor:e,rfId:t}),[e,t]),(n,i)=>!(n.length!==i.length||n.some((s,o)=>s.id!==i[o].id)));return G.createElement("defs",null,r.map(n=>G.createElement(bD,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};iE.displayName="MarkerDefinitions";var _D=m.memo(iE);const jD=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),sE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:g,children:w,disableKeyboardA11y:v})=>{const{edgesFocusable:x,edgesUpdatable:b,elementsSelectable:_,width:j,height:S,connectionMode:C,nodeInternals:E,onError:k}=Ve(jD,Rt),R=gD(t,E,r);return j?G.createElement(G.Fragment,null,R.map(({level:T,edges:I,isMaxLevel:F})=>G.createElement("svg",{key:T,style:{zIndex:T},width:j,height:S,className:"react-flow__edges react-flow__container"},F&&G.createElement(_D,{defaultColor:e,rfId:n}),G.createElement("g",null,I.map(N=>{const[P,O,H]=Ab(E.get(N.source)),[D,A,L]=Ab(E.get(N.target));if(!H||!L)return null;let M=N.type||"default";i[M]||(k==null||k("011",hn.error011(M)),M="default");const $=i[M]||i.default,W=C===Ci.Strict?A.target:(A.target??[]).concat(A.source??[]),B=Rb(O.source,N.sourceHandle),Y=Rb(W,N.targetHandle),Z=(B==null?void 0:B.position)||se.Bottom,ie=(Y==null?void 0:Y.position)||se.Top,re=!!(N.focusable||x&&typeof N.focusable>"u"),de=N.reconnectable||N.updatable,ee=typeof h<"u"&&(de||b&&typeof de>"u");if(!B||!Y)return k==null||k("008",hn.error008(B,N)),null;const{sourceX:_e,sourceY:ue,targetX:Te,targetY:pe}=fD(P,B,Z,D,Y,ie);return G.createElement($,{key:N.id,id:N.id,className:Kt([N.className,s]),type:M,data:N.data,selected:!!N.selected,animated:!!N.animated,hidden:!!N.hidden,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,style:N.style,source:N.source,target:N.target,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerEnd:N.markerEnd,markerStart:N.markerStart,sourceX:_e,sourceY:ue,targetX:Te,targetY:pe,sourcePosition:Z,targetPosition:ie,elementsSelectable:_,onContextMenu:o,onMouseEnter:l,onMouseMove:c,onMouseLeave:u,onClick:d,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:g,rfId:n,ariaLabel:N.ariaLabel,isFocusable:re,isReconnectable:ee,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth,disableKeyboardA11y:v})})))),w):null};sE.displayName="EdgeRenderer";var SD=m.memo(sE);const kD=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function CD({children:e}){const t=Ve(kD);return G.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function ND(e){const t=Vc(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const ED={[se.Left]:se.Right,[se.Right]:se.Left,[se.Top]:se.Bottom,[se.Bottom]:se.Top},oE=({nodeId:e,handleType:t,style:r,type:n=Rn.Bezier,CustomComponent:i,connectionStatus:s})=>{var S,C,E;const{fromNode:o,handleId:l,toX:c,toY:u,connectionMode:d}=Ve(m.useCallback(k=>({fromNode:k.nodeInternals.get(e),handleId:k.connectionHandleId,toX:(k.connectionPosition.x-k.transform[0])/k.transform[2],toY:(k.connectionPosition.y-k.transform[1])/k.transform[2],connectionMode:k.connectionMode}),[e]),Rt),f=(S=o==null?void 0:o[rt])==null?void 0:S.handleBounds;let h=f==null?void 0:f[t];if(d===Ci.Loose&&(h=h||(f==null?void 0:f[t==="source"?"target":"source"])),!o||!h)return null;const p=l?h.find(k=>k.id===l):h[0],y=p?p.x+p.width/2:(o.width??0)/2,g=p?p.y+p.height/2:o.height??0,w=(((C=o.positionAbsolute)==null?void 0:C.x)??0)+y,v=(((E=o.positionAbsolute)==null?void 0:E.y)??0)+g,x=p==null?void 0:p.position,b=x?ED[x]:null;if(!x||!b)return null;if(i)return G.createElement(i,{connectionLineType:n,connectionLineStyle:r,fromNode:o,fromHandle:p,fromX:w,fromY:v,toX:c,toY:u,fromPosition:x,toPosition:b,connectionStatus:s});let _="";const j={sourceX:w,sourceY:v,sourcePosition:x,targetX:c,targetY:u,targetPosition:b};return n===Rn.Bezier?[_]=TN(j):n===Rn.Step?[_]=jv({...j,borderRadius:0}):n===Rn.SmoothStep?[_]=jv(j):n===Rn.SimpleBezier?[_]=EN(j):_=`M${w},${v} ${c},${u}`,G.createElement("path",{d:_,fill:"none",className:"react-flow__connection-path",style:r})};oE.displayName="ConnectionLine";const TD=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function RD({containerStyle:e,style:t,type:r,component:n}){const{nodeId:i,handleType:s,nodesConnectable:o,width:l,height:c,connectionStatus:u}=Ve(TD,Rt);return!(i&&s&&l&&o)?null:G.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},G.createElement("g",{className:Kt(["react-flow__connection",u])},G.createElement(oE,{nodeId:i,handleType:s,style:t,type:r,CustomComponent:n,connectionStatus:u})))}function Mb(e,t){return m.useRef(null),xt(),m.useMemo(()=>t(e),[e])}const aE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,onSelectionContextMenu:y,onSelectionStart:g,onSelectionEnd:w,connectionLineType:v,connectionLineStyle:x,connectionLineComponent:b,connectionLineContainerStyle:_,selectionKeyCode:j,selectionOnDrag:S,selectionMode:C,multiSelectionKeyCode:E,panActivationKeyCode:k,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:I,elementsSelectable:F,selectNodesOnDrag:N,defaultViewport:P,translateExtent:O,minZoom:H,maxZoom:D,preventScrolling:A,defaultMarkerColor:L,zoomOnScroll:M,zoomOnPinch:$,panOnScroll:W,panOnScrollSpeed:B,panOnScrollMode:Y,zoomOnDoubleClick:Z,panOnDrag:ie,onPaneClick:re,onPaneMouseEnter:de,onPaneMouseMove:ee,onPaneMouseLeave:_e,onPaneScroll:ue,onPaneContextMenu:Te,onEdgeContextMenu:pe,onEdgeMouseEnter:te,onEdgeMouseMove:xe,onEdgeMouseLeave:K,onReconnect:X,onReconnectStart:fe,onReconnectEnd:me,reconnectRadius:ye,noDragClassName:ve,noWheelClassName:he,noPanClassName:be,elevateEdgesOnSelect:Fe,disableKeyboardA11y:Se,nodeOrigin:Le,nodeExtent:q,rfId:V})=>{const z=Mb(e,iD),J=Mb(t,dD);return ND(s),G.createElement(rD,{onPaneClick:re,onPaneMouseEnter:de,onPaneMouseMove:ee,onPaneMouseLeave:_e,onPaneContextMenu:Te,onPaneScroll:ue,deleteKeyCode:T,selectionKeyCode:j,selectionOnDrag:S,selectionMode:C,onSelectionStart:g,onSelectionEnd:w,multiSelectionKeyCode:E,panActivationKeyCode:k,zoomActivationKeyCode:R,elementsSelectable:F,onMove:r,onMoveStart:n,onMoveEnd:i,zoomOnScroll:M,zoomOnPinch:$,zoomOnDoubleClick:Z,panOnScroll:W,panOnScrollSpeed:B,panOnScrollMode:Y,panOnDrag:ie,defaultViewport:P,translateExtent:O,minZoom:H,maxZoom:D,onSelectionContextMenu:y,preventScrolling:A,noDragClassName:ve,noWheelClassName:he,noPanClassName:be,disableKeyboardA11y:Se},G.createElement(CD,null,G.createElement(SD,{edgeTypes:J,onEdgeClick:l,onEdgeDoubleClick:u,onlyRenderVisibleElements:I,onEdgeContextMenu:pe,onEdgeMouseEnter:te,onEdgeMouseMove:xe,onEdgeMouseLeave:K,onReconnect:X,onReconnectStart:fe,onReconnectEnd:me,reconnectRadius:ye,defaultMarkerColor:L,noPanClassName:be,elevateEdgesOnSelect:!!Fe,disableKeyboardA11y:Se,rfId:V},G.createElement(RD,{style:x,type:v,component:b,containerStyle:_})),G.createElement("div",{className:"react-flow__edgelabel-renderer"}),G.createElement(aD,{nodeTypes:z,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,selectNodesOnDrag:N,onlyRenderVisibleElements:I,noPanClassName:be,noDragClassName:ve,disableKeyboardA11y:Se,nodeOrigin:Le,nodeExtent:q,rfId:V})))};aE.displayName="GraphView";var AD=m.memo(aE);const Ev=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Ev,nodeExtent:Ev,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ci.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:sO,isValidConnection:void 0},ID=()=>b3((e,t)=>({...wn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:ed(r,n,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(i=>({...n,...i}))})},setDefaultNodesAndEdges:(r,n)=>{const i=typeof r<"u",s=typeof n<"u",o=i?ed(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?n:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:l,domNode:c,nodeOrigin:u}=t(),d=c==null?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const f=window.getComputedStyle(d),{m22:h}=new window.DOMMatrixReadOnly(f.transform),p=r.reduce((g,w)=>{const v=i.get(w.id);if(v!=null&&v.hidden)i.set(v.id,{...v,[rt]:{...v[rt],handleBounds:void 0}});else if(v){const x=Hx(w.nodeElement);!!(x.width&&x.height&&(v.width!==x.width||v.height!==x.height||w.forceUpdate))&&(i.set(v.id,{...v,[rt]:{...v[rt],handleBounds:{source:Cb(".source",w.nodeElement,h,u),target:Cb(".target",w.nodeElement,h,u)}},...x}),g.push({id:v.id,type:"dimensions",dimensions:x}))}return g},[]);GN(i,u);const y=o||s&&!o&&KN(t,{initial:!0,...l});e({nodeInternals:new Map(i),fitViewOnInitDone:y}),(p==null?void 0:p.length)>0&&(n==null||n(p))},updateNodePositions:(r,n=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=r.map(l=>{const c={id:l.id,type:"position",dragging:i};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});s(o)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(s){const u=XN(r,l()),d=ed(u,i,o,c);e({nodeInternals:d})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Cn(c,!0)):(o=ns(s(),r),l=ns(i,[])),Ja({changedNodes:o,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Cn(c,!0)):(o=ns(i,r),l=ns(s(),[])),Ja({changedNodes:l,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:i,getNodes:s}=t(),o=r||s(),l=n||i,c=o.map(d=>(d.selected=!1,Cn(d.id,!1))),u=l.map(d=>Cn(d.id,!1));Ja({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:i}=t();n==null||n.scaleExtent([r,i]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:i}=t();n==null||n.scaleExtent([i,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),s=n().filter(l=>l.selected).map(l=>Cn(l.id,!1)),o=r.filter(l=>l.selected).map(l=>Cn(l.id,!1));Ja({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(i=>{i.positionAbsolute=Wx(i.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:i,height:s,d3Zoom:o,d3Selection:l,translateExtent:c}=t();if(!o||!l||!r.x&&!r.y)return!1;const u=ln.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),d=[[0,0],[i,s]],f=o==null?void 0:o.constrain()(u,d,c);return o.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wn.connectionNodeId,connectionHandleId:wn.connectionHandleId,connectionHandleType:wn.connectionHandleType,connectionStatus:wn.connectionStatus,connectionStartHandle:wn.connectionStartHandle,connectionEndHandle:wn.connectionEndHandle}),reset:()=>e({...wn})}),Object.is),Gc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=ID()),G.createElement(ZP,{value:t.current},e)};Gc.displayName="ReactFlowProvider";const lE=({children:e})=>m.useContext(Hc)?G.createElement(G.Fragment,null,e):G.createElement(Gc,null,e);lE.displayName="ReactFlowWrapper";const MD={input:zN,default:Cv,output:BN,group:Xx},PD={default:sc,straight:Gx,step:Vx,smoothstep:Wc,simplebezier:Ux},OD=[0,0],DD=[15,15],LD={x:0,y:0,zoom:1},FD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Zx=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:s=MD,edgeTypes:o=PD,onNodeClick:l,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:h,onConnect:p,onConnectStart:y,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:S,onNodeDragStart:C,onNodeDrag:E,onNodeDragStop:k,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:I,onSelectionDragStart:F,onSelectionDrag:N,onSelectionDragStop:P,onSelectionContextMenu:O,onSelectionStart:H,onSelectionEnd:D,connectionMode:A=Ci.Strict,connectionLineType:L=Rn.Bezier,connectionLineStyle:M,connectionLineComponent:$,connectionLineContainerStyle:W,deleteKeyCode:B="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:Z=!1,selectionMode:ie=ra.Full,panActivationKeyCode:re="Space",multiSelectionKeyCode:de=nc()?"Meta":"Control",zoomActivationKeyCode:ee=nc()?"Meta":"Control",snapToGrid:_e=!1,snapGrid:ue=DD,onlyRenderVisibleElements:Te=!1,selectNodesOnDrag:pe=!0,nodesDraggable:te,nodesConnectable:xe,nodesFocusable:K,nodeOrigin:X=OD,edgesFocusable:fe,edgesUpdatable:me,elementsSelectable:ye,defaultViewport:ve=LD,minZoom:he=.5,maxZoom:be=2,translateExtent:Fe=Ev,preventScrolling:Se=!0,nodeExtent:Le,defaultMarkerColor:q="#b1b1b7",zoomOnScroll:V=!0,zoomOnPinch:z=!0,panOnScroll:J=!1,panOnScrollSpeed:le=.5,panOnScrollMode:ze=pi.Free,zoomOnDoubleClick:Ze=!0,panOnDrag:yt=!0,onPaneClick:kt,onPaneMouseEnter:oe,onPaneMouseMove:ae,onPaneMouseLeave:nt,onPaneScroll:It,onPaneContextMenu:Pr,children:Ke,onEdgeContextMenu:$e,onEdgeDoubleClick:lt,onEdgeMouseEnter:qt,onEdgeMouseMove:bt,onEdgeMouseLeave:pt,onEdgeUpdate:Mt,onEdgeUpdateStart:xr,onEdgeUpdateEnd:Je,onReconnect:Xt,onReconnectStart:U,onReconnectEnd:Pe,reconnectRadius:ti=10,edgeUpdaterRadius:ri=10,onNodesChange:Or,onEdgesChange:ni,noDragClassName:$s="nodrag",noWheelClassName:o4="nowheel",noPanClassName:My="nopan",fitView:a4=!1,fitViewOptions:l4,connectOnClick:c4=!0,attributionPosition:u4,proOptions:d4,defaultEdgeOptions:f4,elevateNodesOnSelect:p4=!0,elevateEdgesOnSelect:h4=!1,disableKeyboardA11y:Py=!1,autoPanOnConnect:m4=!0,autoPanOnNodeDrag:g4=!0,connectionRadius:v4=20,isValidConnection:x4,onError:y4,style:b4,id:Oy,nodeDragThreshold:w4,..._4},j4)=>{const wu=Oy||"1";return G.createElement("div",{..._4,style:{...b4,...FD},ref:j4,className:Kt(["react-flow",i]),"data-testid":"rf__wrapper",id:Oy},G.createElement(lE,null,G.createElement(AD,{onInit:u,onMove:d,onMoveStart:f,onMoveEnd:h,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:S,nodeTypes:s,edgeTypes:o,connectionLineType:L,connectionLineStyle:M,connectionLineComponent:$,connectionLineContainerStyle:W,selectionKeyCode:Y,selectionOnDrag:Z,selectionMode:ie,deleteKeyCode:B,multiSelectionKeyCode:de,panActivationKeyCode:re,zoomActivationKeyCode:ee,onlyRenderVisibleElements:Te,selectNodesOnDrag:pe,defaultViewport:ve,translateExtent:Fe,minZoom:he,maxZoom:be,preventScrolling:Se,zoomOnScroll:V,zoomOnPinch:z,zoomOnDoubleClick:Ze,panOnScroll:J,panOnScrollSpeed:le,panOnScrollMode:ze,panOnDrag:yt,onPaneClick:kt,onPaneMouseEnter:oe,onPaneMouseMove:ae,onPaneMouseLeave:nt,onPaneScroll:It,onPaneContextMenu:Pr,onSelectionContextMenu:O,onSelectionStart:H,onSelectionEnd:D,onEdgeContextMenu:$e,onEdgeDoubleClick:lt,onEdgeMouseEnter:qt,onEdgeMouseMove:bt,onEdgeMouseLeave:pt,onReconnect:Xt??Mt,onReconnectStart:U??xr,onReconnectEnd:Pe??Je,reconnectRadius:ti??ri,defaultMarkerColor:q,noDragClassName:$s,noWheelClassName:o4,noPanClassName:My,elevateEdgesOnSelect:h4,rfId:wu,disableKeyboardA11y:Py,nodeOrigin:X,nodeExtent:Le}),G.createElement(EO,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:p,onConnectStart:y,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,nodesDraggable:te,nodesConnectable:xe,nodesFocusable:K,edgesFocusable:fe,edgesUpdatable:me,elementsSelectable:ye,elevateNodesOnSelect:p4,minZoom:he,maxZoom:be,nodeExtent:Le,onNodesChange:Or,onEdgesChange:ni,snapToGrid:_e,snapGrid:ue,connectionMode:A,translateExtent:Fe,connectOnClick:c4,defaultEdgeOptions:f4,fitView:a4,fitViewOptions:l4,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:C,onNodeDrag:E,onNodeDragStop:k,onSelectionDrag:N,onSelectionDragStart:F,onSelectionDragStop:P,noPanClassName:My,nodeOrigin:X,rfId:wu,autoPanOnConnect:m4,autoPanOnNodeDrag:g4,onError:y4,connectionRadius:v4,isValidConnection:x4,nodeDragThreshold:w4}),G.createElement(CO,{onSelectionChange:I}),Ke,G.createElement(eO,{proOptions:d4,position:u4}),G.createElement(MO,{rfId:wu,disableKeyboardA11y:Py})))});Zx.displayName="ReactFlow";function cE(e){return t=>{const[r,n]=m.useState(t),i=m.useCallback(s=>n(o=>e(s,o)),[]);return[r,n,i]}}const uE=cE(XN),dE=cE(GO),fE=({id:e,x:t,y:r,width:n,height:i,style:s,color:o,strokeColor:l,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,onClick:h,selected:p})=>{const{background:y,backgroundColor:g}=s||{},w=o||y||g;return G.createElement("rect",{className:Kt(["react-flow__minimap-node",{selected:p},u]),x:t,y:r,rx:d,ry:d,width:n,height:i,fill:w,stroke:l,strokeWidth:c,shapeRendering:f,onClick:h?v=>h(v,e):void 0})};fE.displayName="MiniMapNode";var qD=m.memo(fE);const zD=e=>e.nodeOrigin,$D=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),id=e=>e instanceof Function?e:()=>e;function BD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i=2,nodeComponent:s=qD,onClick:o}){const l=Ve($D,Rt),c=Ve(zD),u=id(t),d=id(e),f=id(r),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return G.createElement(G.Fragment,null,l.map(p=>{const{x:y,y:g}=xi(p,c).positionAbsolute;return G.createElement(s,{key:p.id,x:y,y:g,width:p.width,height:p.height,style:p.style,selected:p.selected,className:f(p),color:u(p),borderRadius:n,strokeColor:d(p),strokeWidth:i,shapeRendering:h,onClick:o,id:p.id})}))}var HD=m.memo(BD);const WD=200,UD=150,VD=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?nO(Uc(t,e.nodeOrigin),r):r,rfId:e.rfId}},GD="react-flow__minimap-desc";function pE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:d=1,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:y=!1,zoomable:g=!1,ariaLabel:w="React Flow mini map",inversePan:v=!1,zoomStep:x=10,offsetScale:b=5}){const _=xt(),j=m.useRef(null),{boundingRect:S,viewBB:C,rfId:E}=Ve(VD,Rt),k=(e==null?void 0:e.width)??WD,R=(e==null?void 0:e.height)??UD,T=S.width/k,I=S.height/R,F=Math.max(T,I),N=F*k,P=F*R,O=b*F,H=S.x-(N-S.width)/2-O,D=S.y-(P-S.height)/2-O,A=N+O*2,L=P+O*2,M=`${GD}-${E}`,$=m.useRef(0);$.current=F,m.useEffect(()=>{if(j.current){const Y=ur(j.current),Z=de=>{const{transform:ee,d3Selection:_e,d3Zoom:ue}=_.getState();if(de.sourceEvent.type!=="wheel"||!_e||!ue)return;const Te=-de.sourceEvent.deltaY*(de.sourceEvent.deltaMode===1?.05:de.sourceEvent.deltaMode?1:.002)*x,pe=ee[2]*Math.pow(2,Te);ue.scaleTo(_e,pe)},ie=de=>{const{transform:ee,d3Selection:_e,d3Zoom:ue,translateExtent:Te,width:pe,height:te}=_.getState();if(de.sourceEvent.type!=="mousemove"||!_e||!ue)return;const xe=$.current*Math.max(1,ee[2])*(v?-1:1),K={x:ee[0]-de.sourceEvent.movementX*xe,y:ee[1]-de.sourceEvent.movementY*xe},X=[[0,0],[pe,te]],fe=ln.translate(K.x,K.y).scale(ee[2]),me=ue.constrain()(fe,X,Te);ue.transform(_e,me)},re=xN().on("zoom",y?ie:null).on("zoom.wheel",g?Z:null);return Y.call(re),()=>{Y.on("zoom",null)}}},[y,g,v,x]);const W=h?Y=>{const Z=Sr(Y);h(Y,{x:Z[0],y:Z[1]})}:void 0,B=p?(Y,Z)=>{const ie=_.getState().nodeInternals.get(Z);p(Y,ie)}:void 0;return G.createElement(Hn,{position:f,style:e,className:Kt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},G.createElement("svg",{width:k,height:R,viewBox:`${H} ${D} ${A} ${L}`,role:"img","aria-labelledby":M,ref:j,onClick:W},w&&G.createElement("title",{id:M},w),G.createElement(HD,{onClick:B,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:l}),G.createElement("path",{className:"react-flow__minimap-mask",d:`M${H-O},${D-O}h${A+O*2}v${L+O*2}h${-A-O*2}z
        M${C.x},${C.y}h${C.width}v${C.height}h${-C.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:d,pointerEvents:"none"})))}pE.displayName="MiniMap";var hE=m.memo(pE);const tl={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},KD=180,YD=400,XD=260,QD=48;function ZD(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function JD({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:i,onToggleShowArchived:s,userSection:o}){const[l,c]=m.useState(!1),[u,d]=m.useState(XD),[f,h]=m.useState(!1),p=m.useRef(null),y=m.useRef(null);m.useEffect(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((j,S)=>{const C=(j.name||"").localeCompare(S.name||"");return C!==0?C:(j.projectId||"").localeCompare(S.projectId||"")}),[e]),w=()=>{n()},v=m.useCallback(j=>{j.preventDefault(),h(!0)},[]),x=m.useCallback(j=>{if(!f)return;const S=Math.min(YD,Math.max(KD,j.clientX));d(S)},[f]),b=m.useCallback(()=>{h(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",x),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,x,b]);const _=l?QD:u;return a.jsxs("div",{ref:p,className:"h-full flex flex-col relative",style:{width:_,minWidth:_,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[a.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),a.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:i?"#f59e0b":"var(--text-muted)"},title:i?"Hide archived":"Show archived",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),a.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:a.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(j=>{const S=t===j.id;return a.jsxs("div",{ref:S?y:null,onClick:()=>r(j.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:S?"var(--state-active-bg)":"transparent",border:S?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:S?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:S?"#ffffff":tl[j.status]||tl.queued}}),a.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:S?"#ffffff":"var(--text-primary)"},children:j.name}),j.isArchived&&a.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:S?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[a.jsx("span",{className:"text-[10px] font-mono",style:{color:S?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:j.projectId}),a.jsx("span",{className:"text-[10px]",style:{color:S?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:ZD(j.createdAt)})]})]},j.id)})}),l&&a.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(j=>a.jsx("div",{onClick:()=>r(j.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:j.name,children:a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:tl[j.status]||tl.queued,boxShadow:t===j.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},j.id))}),!l&&a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:w,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),a.jsx("span",{children:"New Project"})]})}),l&&a.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:w,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),o,!l&&a.jsx("div",{onMouseDown:v,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function e6({stations:e}){return e!=null&&e.length?a.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,r)=>{const n=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",i=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",s=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return a.jsxs(G.Fragment,{children:[r>0&&a.jsx("div",{className:"w-4 h-0.5",style:{background:i}}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:n}}),a.jsx("span",{className:"text-[7px] mt-0.5",style:{color:s,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const Pb={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},mE=(e,t)=>{var r;return((r=Pb[t])==null?void 0:r[e])||Pb.industrial.queued},br={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},To={GAP:8,WIDTH:280},sd=["pgc","asm","draft","qa","done"],An=["industrial","light","blueprint"];function t6({questions:e,nodeWidth:t,onSubmit:r,onClose:n,onZoomComplete:i}){const[s,o]=m.useState({}),l=e.filter(c=>c.required).every(c=>s[c.id]);return m.useEffect(()=>{if(i){const c=setTimeout(()=>i(),150);return()=>clearTimeout(c)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+To.GAP,width:To.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:To.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&a.jsx("span",{className:"text-amber-600",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:s[c.id]||"",onChange:u=>o(d=>({...d,[c.id]:u.target.value}))})]},c.id))}),a.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:a.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${l?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!l,onClick:()=>r(s),children:"Submit & Continue"})})]})}function r6({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:i}){const s=e.length>6,o=s?240:320;return m.useEffect(()=>{if(i){const l=setTimeout(()=>i(),150);return()=>clearTimeout(l)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:r+To.GAP,width:o,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:To.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${s?"":"grid grid-cols-2 gap-2"}`,children:e.map(l=>{const c=l.state==="complete"?"var(--state-stabilized-bg)":l.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return a.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${s?"mb-1":""}`,children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),a.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:l.name})]},l.id)})}),a.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const Jx="/api/v1";class n6 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function i6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Oe(e,t={}){const r=`${Jx}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},i=await fetch(r,n);if(!i.ok){const s=await i.json().catch(()=>({}));throw new n6(s.detail||`Request failed: ${i.status}`,i.status,s)}return i.status===204?null:i.json()}const Ue={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":i6()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return Oe(`/projects${r?"?"+r:""}`)},getProject:e=>Oe(`/projects/${e}`),getProjectTree:e=>Oe(`/projects/${e}/tree`),createProject:e=>Oe("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>Oe(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>Oe(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>Oe(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>Oe(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>Oe(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),Oe(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>Oe(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>Oe(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>Oe("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>Oe(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>Oe(`/document-workflows/executions/${e}`),getPgcAnswers:e=>Oe(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>Oe(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>Oe(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>Oe("/intake/start",{method:"POST"}),getIntakeState:e=>Oe(`/intake/${e}`),submitIntakeMessage:(e,t)=>Oe(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>Oe(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>Oe(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>Oe(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>Oe(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>Oe(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>Oe(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>Oe(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>Oe(`/projects/${e}/workflow/complete`,{method:"POST"})};function s6(e){const t=`${Jx}/production/events?project_id=${e}`;return new EventSource(t)}function o6(e){const t=`${Jx}/intake/${e}/events`;return new EventSource(t)}function a6(e){return`/auth/login/${e}`}function l6({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Ob({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const i=n==="numbered"?"decimal":"disc";return a.jsxs("div",{style:{marginBottom:12},children:[t.title&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),a.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":i},children:r.map((s,o)=>a.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&a.jsx("span",{style:{color:"#10b981"},children:""}),typeof s=="string"?s:(s==null?void 0:s.value)||(s==null?void 0:s.text)||(s==null?void 0:s.question)||(s==null?void 0:s.description)||JSON.stringify(s)]},o))})]})}function c6({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,s={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&a.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),a.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:s.bg,color:s.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function gE({block:e}){const{data:t}=e,{id:r,text:n,blocking:i,why_it_matters:s,priority:o,tags:l,options:c}=t,u={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},d=u[o]||u.should;return a.jsx("div",{style:{padding:"12px 16px",background:i?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${i?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),s&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:s}),a.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[i&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),o&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:d.bg,color:d.text,textTransform:"uppercase"},children:o}),l==null?void 0:l.map((f,h)=>a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},h))]}),c&&c.length>0&&a.jsxs("div",{style:{marginTop:8},children:[a.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,h)=>a.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:h>0?8:4},children:f},h))]})]})]})})}function u6({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,i=t.blocking_count||r.filter(s=>s.blocking).length;return r.length===0?a.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),i>0&&a.jsxs("span",{style:{color:"#dc2626"},children:[a.jsx("strong",{children:i})," blocking"]})]}),r.map((s,o)=>a.jsx(gE,{block:{type:"schema:OpenQuestionV1",data:s}},s.id||o))]})}function Db({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const i={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((s,o)=>{const l=s.severity||s.likelihood||"medium",c=i[l]||i.medium;return a.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[s.id&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:s.id}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:s.description||s.reason||JSON.stringify(s)}),s.impact&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",s.impact]}),s.mitigation&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",s.mitigation]})]}),a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},s.id||o)})})]})}function d6({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([i])=>t[i]&&typeof t[i]=="string").map(([i,s])=>({title:s,content:t[i]}));return n.length===0?null:a.jsx("div",{style:{marginBottom:12},children:n.map((i,s)=>a.jsxs("div",{style:{marginBottom:s<n.length-1?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:i.title}),a.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:i.content})})]},s))})}function Lb({block:e}){const{data:t}=e,{epic_id:r,title:n,name:i,intent:s,phase:o,mvp_phase:l,risk_level:c,stories:u,detail_ref:d}=t,f=o||l,h=n||i,p={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},y=p[c]||p.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},w=g[f]||g.mvp;return a.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),a.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:h})]}),s&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s}),u&&u.length>0&&a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[u.length," stories"]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:w.bg,color:w.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&a.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:y.bg,color:y.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),d&&a.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function f6({block:e}){const{data:t}=e,{story_id:r,title:n,intent:i,phase:s,risk_level:o,detail_ref:l}=t,u={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[o]||null,d={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=d[s]||d.mvp;return a.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),i&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:i})]}),a.jsxs("div",{style:{display:"flex",gap:4},children:[s&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:s}),u&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:u.bg,color:u.text,textTransform:"uppercase",fontWeight:500},children:o})]})]})})}function p6({block:e}){const{type:t,data:r}=e;return a.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[a.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),a.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function h6({block:e}){const{data:t}=e,r=t.items||[],[n,i]=m.useState({});if(r.length===0)return null;const s=o=>{i(l=>({...l,[o]:!l[o]}))};return a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,l)=>{const c=n[l],u=o.why_it_matters||o.impact_if_unresolved;return a.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[a.jsxs("button",{onClick:()=>u&&s(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:u?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:o.question||o.value||o.text||"Unknown"}),u&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:a.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&u&&a.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[o.why_it_matters&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.why_it_matters})]}),o.impact_if_unresolved&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.impact_if_unresolved})]})]})]},l)})})}function m6({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&a.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function g6({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:i}=t;return a.jsxs("div",{style:{marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&a.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),i&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i})]})}function v6({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,i=r&&r.length>0,s=n&&n.length>0;return!i&&!s?null:a.jsxs("div",{style:{marginBottom:12},children:[i&&a.jsxs("div",{style:{marginBottom:s?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:o})]},l))})]}),s&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:o})]},l))})]})]})}function x6({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:i=[]}=t,s=r&&r.length>0,o=n&&n.length>0,l=i&&i.length>0;return!s&&!o&&!l?null:a.jsxs("div",{style:{marginBottom:12},children:[s&&a.jsxs("div",{style:{marginBottom:o||l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,u)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:c})]},u))})]}),o&&a.jsxs("div",{style:{marginBottom:l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,u)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:c})]},u))})]}),l&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:i.map((c,u)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#6b7280"},children:""}),a.jsx("span",{children:c})]},u))})]})]})}function y6({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:i}=t,o={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{marginBottom:12},children:a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:o.bg,color:o.text},children:r})}),n&&a.jsx("p",{style:{margin:0,marginBottom:i?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),i&&a.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:a.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",i]})})]})}const b6={"schema:ParagraphBlockV1":l6,"schema:StringListBlockV1":Ob,"schema:IndicatorBlockV1":c6,"schema:OpenQuestionV1":gE,"schema:OpenQuestionsBlockV1":u6,"schema:RisksBlockV1":Db,"schema:DependenciesBlockV1":Db,"schema:SummaryBlockV1":d6,"schema:EpicSummaryBlockV1":Lb,"schema:StorySummaryBlockV1":f6,"schema:EpicStoriesCardBlockV1":Lb,"schema:StoriesBlockV1":Ob,"schema:UnknownsBlockV1":h6,"schema:IntakeSummaryBlockV1":m6,"schema:IntakeProjectTypeBlockV1":g6,"schema:IntakeConstraintsBlockV1":v6,"schema:IntakeOpenGapsBlockV1":x6,"schema:IntakeOutcomeBlockV1":y6};function w6(e){return b6[e]||p6}function _6(e,t){const r=w6(e.type);return a.jsx(r,{block:e},e.key||t)}function vE({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:i=""}){var w;const[s,o]=m.useState(new Set(((w=e==null?void 0:e.sections)==null?void 0:w.map(v=>v.section_id))||[]));if(!e)return a.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:u=[],metadata:d}=e;if(d!=null&&d.fallback&&e.raw_content)return a.jsx(S6,{title:l,content:e.raw_content,reason:d.reason});const f=v=>{o(x=>{const b=new Set(x);return b.has(v)?b.delete(v):b.add(v),b})},h=t==="compact"||t==="sidecar",y=t==="sidecar"?u.filter(v=>v.viewer_tab==="overview"||!v.viewer_tab):u,g=(()=>{if(!l)return"Document";const v=l.indexOf(": ");return v>-1?l.slice(v+2):l})();return a.jsxs("div",{className:i,children:[t==="full"&&!r&&a.jsxs("div",{style:{marginBottom:24},children:[a.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&a.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:h?12:20},children:y.map(v=>a.jsx(j6,{section:v,isExpanded:s.has(v.section_id),onToggle:()=>f(v.section_id),onClick:()=>n==null?void 0:n(v),variant:t},v.section_id))}),y.length===0&&a.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function j6({section:e,isExpanded:t,onToggle:r,onClick:n,variant:i}){const{section_id:s,title:o,description:l,blocks:c=[],sidecar_max_items:u}=e,d=i==="compact"||i==="sidecar",f=i==="sidecar";if(c.length===0)return null;const h=f&&u&&c.length>u?c.slice(0,u):c,p=f&&u&&c.length>u;return a.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[a.jsxs("button",{onClick:r,style:{width:"100%",padding:d?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,fontSize:d?13:15,fontWeight:600,color:"#111827"},children:[o,p&&a.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",u," of ",c.length,")"]})]}),l&&!d&&a.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:l})]}),a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:a.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&a.jsxs("div",{style:{padding:d?12:18},children:[h.map((y,g)=>_6(y,g)),p&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-u," more in full view"]})]})]})}function S6({title:e,content:t,reason:r}){return a.jsxs("div",{children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function k6({renderModel:e,projectCode:t,documentName:r,isExpanded:n,onToggleExpand:i,onClose:s,onViewFull:o,nodeWidth:l=280}){const h=n?900:520,p=n?900:600,y=`${t||"DOC"} - ${r||"Document"}`,g=w=>{w.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:l+30,width:h,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:p,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const w=(e==null?void 0:e.title)||"DOCUMENT",v=w.indexOf(": ");return(v>-1?w.slice(v+2):w).toUpperCase()})()}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:i,title:n?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:n?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:s,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:n?600:400},children:a.jsx(vE,{renderModel:e,variant:"sidecar"})}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:o,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function C6({document:e,projectId:t,projectCode:r,nodeWidth:n,onClose:i,onZoomComplete:s,onViewFull:o}){const[l,c]=m.useState(null),[u,d]=m.useState(null),[f,h]=m.useState(!0),[p,y]=m.useState(!1);return m.useEffect(()=>{if(s){const g=setTimeout(()=>s(),150);return()=>clearTimeout(g)}},[s]),m.useEffect(()=>{async function g(){var w;if(!t||!e.id){h(!1);return}try{h(!0);try{const x=await Ue.getDocumentRenderModel(t,e.id);if(x&&x.sections&&x.sections.length>0){c(x),d(null);return}if((w=x==null?void 0:x.metadata)!=null&&w.fallback&&x.raw_content){c(null),d(x.raw_content);return}}catch(x){console.log("RenderModel not available, falling back to raw document:",x.message)}const v=await Ue.getDocument(t,e.id);c(null),d((v==null?void 0:v.content)||null)}catch(v){console.error("Failed to fetch document for sidecar:",v)}finally{h(!1)}}g()},[t,e.id]),f?null:l?a.jsx(k6,{renderModel:l,projectCode:r,documentName:e.name,isExpanded:p,onToggleExpand:()=>y(!p),onClose:i,onViewFull:()=>o==null?void 0:o(e.id),nodeWidth:n}):a.jsx(N6,{document:e,projectCode:r,rawContent:u,nodeWidth:n,isExpanded:p,onToggleExpand:()=>y(!p),onClose:i,onViewFull:()=>o==null?void 0:o(e.id)})}function N6({document:e,projectCode:t,rawContent:r,nodeWidth:n,isExpanded:i,onToggleExpand:s,onClose:o,onViewFull:l}){var w;const h=i?900:520,p=i?900:600,y=`${t||"DOC"} - ${e.name||"Document"}`,g=v=>{v.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:n+30,width:h,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:p,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((w=e.name)==null?void 0:w.toUpperCase())||"DOCUMENT"}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:s,title:i?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:i?600:400},children:[a.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:l,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const E6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function T6({data:e}){var _,j,S;const r=(e.level||1)===1,n=e.isExpanded,i=e.expandType,s=((_=e.questions)==null?void 0:_.length)>0,o=((j=e.features)==null?void 0:j.length)>0,l=(S=e.stations)==null?void 0:S.some(C=>C.needs_input),c=e.state||"ready_for_production",u=["produced","stabilized","ready"].includes(c),d=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),h=d&&e.stations,p=d?"node-active":"",y=r?"DOCUMENT":"EPIC",g=r?"subway-node-header-doc":"subway-node-header-epic",w=u?"var(--state-produced-bg, var(--state-stabilized-bg))":d?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",v=u?"var(--state-produced-text, var(--state-stabilized-text))":d?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",x=d?"var(--state-in-production-bg, var(--state-active-bg))":u?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=E6[c]||c;return a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{type:"target",position:se.Top,className:"!opacity-0",style:{left:"15%"}}),a.jsxs("div",{className:`subway-node rounded-lg border ${p} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:x},children:[a.jsxs("div",{className:`${g} border-b px-3 py-1.5 flex items-center justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:y}),a.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&a.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:w}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:v},children:b}),r&&e.desc&&a.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),h&&a.jsx(e6,{stations:e.stations}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&u&&a.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:C=>{var E;C.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"document")},children:"View Document"}),l&&s&&!n&&a.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:C=>{var E;C.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&o&&(n&&i==="features"?a.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):a.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:C=>{var E;C.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"features")},children:[a.jsx("span",{className:"text-indigo-400",children:e.features.length}),a.jsx("span",{children:"features"}),a.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),n&&i==="questions"&&s&&a.jsx(t6,{questions:e.questions,nodeWidth:e.width,onSubmit:C=>{var E;return(E=e.onSubmitQuestions)==null?void 0:E.call(e,e.id,C)},onClose:()=>{var C;return(C=e.onCollapse)==null?void 0:C.call(e)},onZoomComplete:()=>{var C;return(C=e.onZoomToNode)==null?void 0:C.call(e,e.id)}}),n&&i==="features"&&o&&a.jsx(r6,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var C;return(C=e.onCollapse)==null?void 0:C.call(e)},onZoomComplete:()=>{var C;return(C=e.onZoomToNode)==null?void 0:C.call(e,e.id)}}),n&&i==="document"&&r&&u&&a.jsx(C6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var C;return(C=e.onCollapse)==null?void 0:C.call(e)},onZoomComplete:()=>{var C;return(C=e.onZoomToNode)==null?void 0:C.call(e,e.id)},onViewFull:C=>{var E;return(E=e.onViewFullDocument)==null?void 0:E.call(e,C)}}),a.jsx(Ur,{type:"source",position:se.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function R6(){return a.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[a.jsx(Ur,{type:"target",position:se.Top,style:{opacity:0}}),a.jsx(Ur,{type:"source",position:se.Bottom,style:{opacity:0}})]})}function A6({projectId:e,projectCode:t,docTypeId:r,onClose:n}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null);return m.useEffect(()=>{async function h(){var p;try{u(!0),f(null);try{const g=await Ue.getDocumentRenderModel(e,r);if(g&&g.sections&&g.sections.length>0){s(g),l(null);return}if((p=g==null?void 0:g.metadata)!=null&&p.fallback&&g.raw_content){s(null),l(g.raw_content);return}}catch(g){console.log("RenderModel not available, falling back to raw document:",g.message)}const y=await Ue.getDocument(e,r);s(null),l((y==null?void 0:y.content)||null)}catch(y){f(y.message),console.error("Failed to fetch document:",y)}finally{u(!1)}}h()},[e,r]),m.useEffect(()=>{const h=p=>{p.key==="Escape"&&n()};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[n]),c?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:a.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:h=>h.target===h.currentTarget&&n(),children:a.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[a.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsx("div",{children:t&&a.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),a.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[d&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-red-500",children:d})}),i&&a.jsx(vE,{renderModel:i,variant:"full"}),o&&!i&&a.jsx(I6,{content:o,docTypeId:r}),!i&&!o&&!d&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function I6({content:e,docTypeId:t}){if(!e)return a.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n=e.description||e.summary||e.preliminary_summary;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",a.jsx("strong",{children:t})," - displaying raw content"]}),(r||n)&&a.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[r&&a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),n&&a.jsx("p",{className:"text-gray-700 text-sm",children:n})]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const M6="/api/v1/admin";class P6 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function O6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Re(e,t={}){var s;const r=`${M6}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const o=O6();o&&(n.headers["X-CSRF-Token"]=o)}const i=await fetch(r,n);if(!i.ok){const o=await i.json().catch(()=>({})),l=((s=o.detail)==null?void 0:s.message)||o.detail||`Request failed: ${i.status}`;throw new P6(l,i.status,o.detail||o)}return i.status===204?null:i.json()}const ke={getCurrentWorkspace:async()=>{try{return await Re("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Re("/workspaces",{method:"POST"}),getWorkspaceState:e=>Re(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Re(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Re(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>Re(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Re(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Re(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Re(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Re(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Re("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Re(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Re("/workbench/prompt-fragments"),getRoles:()=>Re("/workbench/roles"),getTemplates:()=>Re("/workbench/templates"),getSchemas:()=>Re("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Re("/workbench/workflows"),getOrchestrationWorkflows:()=>Re("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Re(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Re(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Re(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Re(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Re(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Re(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Re(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Re(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Re("/workbench/active-releases"),invalidateCache:()=>Re("/workbench/cache/invalidate",{method:"POST"})};function D6({projectId:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null),[l,c]=m.useState(!1),[u,d]=m.useState([]),[f,h]=m.useState(!1),[p,y]=m.useState(!1),[g,w]=m.useState(null),[v,x]=m.useState(!1),[b,_]=m.useState(!1),j=m.useCallback(async()=>{if(e){i(!0),o(null);try{const I=await Ue.getWorkflowInstance(e);r(I)}catch(I){I.status===404?r(null):o(I.message)}finally{i(!1)}}},[e]);m.useEffect(()=>{j()},[j]);const S=async()=>{c(!0),h(!0);try{const I=await ke.getOrchestrationWorkflows();d(I.workflows||[])}catch{d([])}finally{h(!1)}},C=async I=>{y(!0);try{const F=await Ue.createWorkflowInstance(e,I.workflow_id,I.active_version);r(F),c(!1)}catch(F){o(F.message)}finally{y(!1)}},E=async()=>{if(t&&(_(!b),!g)){x(!0);try{const I=await Ue.getWorkflowDrift(e);w(I)}catch(I){w({error:I.message})}finally{x(!1)}}};if(n)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(s&&!t)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:s});if(!t)return a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?a.jsx(L6,{workflows:u,loading:f,assigning:p,onSelect:C,onCancel:()=>c(!1)}):a.jsx("button",{onClick:S,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const k=t.effective_workflow||{},R=k.steps||[],T=t.base_workflow_ref||{};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:k.name||T.workflow_id||"Workflow"}),a.jsx(F6,{status:t.status})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",T.workflow_id," v",T.version,T.pow_class?` (${T.pow_class})`:""]})]}),a.jsx("button",{onClick:E,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:v?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&a.jsx(q6,{drift:g}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",R.length,")"]}),R.length===0?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):a.jsx("div",{className:"space-y-1",children:R.map((I,F)=>a.jsx(z6,{step:I,index:F},I.step_id||F))})]}),s&&a.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:s})]})}function L6({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:i}){const s=e.filter(l=>(l.pow_class||"reference")==="reference"),o=e.filter(l=>l.pow_class==="template");return a.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs(a.Fragment,{children:[s.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),s.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),o.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),o.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),s.length===0&&o.length===0&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),a.jsx("button",{onClick:i,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function F6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function q6({drift:e}){return e.error?a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):a.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[a.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[a.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),a.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&a.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&a.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&a.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&a.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&a.jsx("div",{children:"~ Metadata changed"})]})]})}function z6({step:e,index:t}){return a.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&a.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&a.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function ey(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var od,Fb;function $6(){if(Fb)return od;Fb=1;function e(){this.__data__=[],this.size=0}return od=e,od}var ad,qb;function Is(){if(qb)return ad;qb=1;function e(t,r){return t===r||t!==t&&r!==r}return ad=e,ad}var ld,zb;function Kc(){if(zb)return ld;zb=1;var e=Is();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return ld=t,ld}var cd,$b;function B6(){if($b)return cd;$b=1;var e=Kc(),t=Array.prototype,r=t.splice;function n(i){var s=this.__data__,o=e(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return cd=n,cd}var ud,Bb;function H6(){if(Bb)return ud;Bb=1;var e=Kc();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return ud=t,ud}var dd,Hb;function W6(){if(Hb)return dd;Hb=1;var e=Kc();function t(r){return e(this.__data__,r)>-1}return dd=t,dd}var fd,Wb;function U6(){if(Wb)return fd;Wb=1;var e=Kc();function t(r,n){var i=this.__data__,s=e(i,r);return s<0?(++this.size,i.push([r,n])):i[s][1]=n,this}return fd=t,fd}var pd,Ub;function Yc(){if(Ub)return pd;Ub=1;var e=$6(),t=B6(),r=H6(),n=W6(),i=U6();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,pd=s,pd}var hd,Vb;function V6(){if(Vb)return hd;Vb=1;var e=Yc();function t(){this.__data__=new e,this.size=0}return hd=t,hd}var md,Gb;function G6(){if(Gb)return md;Gb=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return md=e,md}var gd,Kb;function K6(){if(Kb)return gd;Kb=1;function e(t){return this.__data__.get(t)}return gd=e,gd}var vd,Yb;function Y6(){if(Yb)return vd;Yb=1;function e(t){return this.__data__.has(t)}return vd=e,vd}var xd,Xb;function xE(){if(Xb)return xd;Xb=1;var e=typeof Ea=="object"&&Ea&&Ea.Object===Object&&Ea;return xd=e,xd}var yd,Qb;function Ir(){if(Qb)return yd;Qb=1;var e=xE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return yd=r,yd}var bd,Zb;function Ms(){if(Zb)return bd;Zb=1;var e=Ir(),t=e.Symbol;return bd=t,bd}var wd,Jb;function X6(){if(Jb)return wd;Jb=1;var e=Ms(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function s(o){var l=r.call(o,i),c=o[i];try{o[i]=void 0;var u=!0}catch{}var d=n.call(o);return u&&(l?o[i]=c:delete o[i]),d}return wd=s,wd}var _d,e1;function Q6(){if(e1)return _d;e1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return _d=r,_d}var jd,t1;function Ti(){if(t1)return jd;t1=1;var e=Ms(),t=X6(),r=Q6(),n="[object Null]",i="[object Undefined]",s=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?t(l):r(l)}return jd=o,jd}var Sd,r1;function gr(){if(r1)return Sd;r1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Sd=e,Sd}var kd,n1;function ya(){if(n1)return kd;n1=1;var e=Ti(),t=gr(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==n||c==i||c==r||c==s}return kd=o,kd}var Cd,i1;function Z6(){if(i1)return Cd;i1=1;var e=Ir(),t=e["__core-js_shared__"];return Cd=t,Cd}var Nd,s1;function J6(){if(s1)return Nd;s1=1;var e=Z6(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Nd=r,Nd}var Ed,o1;function yE(){if(o1)return Ed;o1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Ed=r,Ed}var Td,a1;function eL(){if(a1)return Td;a1=1;var e=ya(),t=J6(),r=gr(),n=yE(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,u=l.hasOwnProperty,d=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(h){if(!r(h)||t(h))return!1;var p=e(h)?d:s;return p.test(n(h))}return Td=f,Td}var Rd,l1;function tL(){if(l1)return Rd;l1=1;function e(t,r){return t==null?void 0:t[r]}return Rd=e,Rd}var Ad,c1;function Ri(){if(c1)return Ad;c1=1;var e=eL(),t=tL();function r(n,i){var s=t(n,i);return e(s)?s:void 0}return Ad=r,Ad}var Id,u1;function ty(){if(u1)return Id;u1=1;var e=Ri(),t=Ir(),r=e(t,"Map");return Id=r,Id}var Md,d1;function Xc(){if(d1)return Md;d1=1;var e=Ri(),t=e(Object,"create");return Md=t,Md}var Pd,f1;function rL(){if(f1)return Pd;f1=1;var e=Xc();function t(){this.__data__=e?e(null):{},this.size=0}return Pd=t,Pd}var Od,p1;function nL(){if(p1)return Od;p1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Od=e,Od}var Dd,h1;function iL(){if(h1)return Dd;h1=1;var e=Xc(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(s){var o=this.__data__;if(e){var l=o[s];return l===t?void 0:l}return n.call(o,s)?o[s]:void 0}return Dd=i,Dd}var Ld,m1;function sL(){if(m1)return Ld;m1=1;var e=Xc(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var s=this.__data__;return e?s[i]!==void 0:r.call(s,i)}return Ld=n,Ld}var Fd,g1;function oL(){if(g1)return Fd;g1=1;var e=Xc(),t="__lodash_hash_undefined__";function r(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=e&&i===void 0?t:i,this}return Fd=r,Fd}var qd,v1;function aL(){if(v1)return qd;v1=1;var e=rL(),t=nL(),r=iL(),n=sL(),i=oL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,qd=s,qd}var zd,x1;function lL(){if(x1)return zd;x1=1;var e=aL(),t=Yc(),r=ty();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return zd=n,zd}var $d,y1;function cL(){if(y1)return $d;y1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return $d=e,$d}var Bd,b1;function Qc(){if(b1)return Bd;b1=1;var e=cL();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Bd=t,Bd}var Hd,w1;function uL(){if(w1)return Hd;w1=1;var e=Qc();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Hd=t,Hd}var Wd,_1;function dL(){if(_1)return Wd;_1=1;var e=Qc();function t(r){return e(this,r).get(r)}return Wd=t,Wd}var Ud,j1;function fL(){if(j1)return Ud;j1=1;var e=Qc();function t(r){return e(this,r).has(r)}return Ud=t,Ud}var Vd,S1;function pL(){if(S1)return Vd;S1=1;var e=Qc();function t(r,n){var i=e(this,r),s=i.size;return i.set(r,n),this.size+=i.size==s?0:1,this}return Vd=t,Vd}var Gd,k1;function ry(){if(k1)return Gd;k1=1;var e=lL(),t=uL(),r=dL(),n=fL(),i=pL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,Gd=s,Gd}var Kd,C1;function hL(){if(C1)return Kd;C1=1;var e=Yc(),t=ty(),r=ry(),n=200;function i(s,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([s,o]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(s,o),this.size=l.size,this}return Kd=i,Kd}var Yd,N1;function Zc(){if(N1)return Yd;N1=1;var e=Yc(),t=V6(),r=G6(),n=K6(),i=Y6(),s=hL();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=i,o.prototype.set=s,Yd=o,Yd}var Xd,E1;function ny(){if(E1)return Xd;E1=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return Xd=e,Xd}var Qd,T1;function bE(){if(T1)return Qd;T1=1;var e=Ri(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return Qd=t,Qd}var Zd,R1;function Jc(){if(R1)return Zd;R1=1;var e=bE();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return Zd=t,Zd}var Jd,A1;function eu(){if(A1)return Jd;A1=1;var e=Jc(),t=Is(),r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l){var c=s[o];(!(n.call(s,o)&&t(c,l))||l===void 0&&!(o in s))&&e(s,o,l)}return Jd=i,Jd}var ef,I1;function ba(){if(I1)return ef;I1=1;var e=eu(),t=Jc();function r(n,i,s,o){var l=!s;s||(s={});for(var c=-1,u=i.length;++c<u;){var d=i[c],f=o?o(s[d],n[d],d,s,n):void 0;f===void 0&&(f=n[d]),l?t(s,d,f):e(s,d,f)}return s}return ef=r,ef}var tf,M1;function mL(){if(M1)return tf;M1=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return tf=e,tf}var rf,P1;function Kr(){if(P1)return rf;P1=1;function e(t){return t!=null&&typeof t=="object"}return rf=e,rf}var nf,O1;function gL(){if(O1)return nf;O1=1;var e=Ti(),t=Kr(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return nf=n,nf}var sf,D1;function wa(){if(D1)return sf;D1=1;var e=gL(),t=Kr(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,s=e(function(){return arguments}())?e:function(o){return t(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return sf=s,sf}var of,L1;function at(){if(L1)return of;L1=1;var e=Array.isArray;return of=e,of}var po={exports:{}},af,F1;function vL(){if(F1)return af;F1=1;function e(){return!1}return af=e,af}po.exports;var q1;function Ps(){return q1||(q1=1,function(e,t){var r=Ir(),n=vL(),i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===i,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u}(po,po.exports)),po.exports}var lf,z1;function tu(){if(z1)return lf;z1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var s=typeof n;return i=i??e,!!i&&(s=="number"||s!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return lf=r,lf}var cf,$1;function iy(){if($1)return cf;$1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return cf=t,cf}var uf,B1;function xL(){if(B1)return uf;B1=1;var e=Ti(),t=iy(),r=Kr(),n="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",f="[object Object]",h="[object RegExp]",p="[object Set]",y="[object String]",g="[object WeakMap]",w="[object ArrayBuffer]",v="[object DataView]",x="[object Float32Array]",b="[object Float64Array]",_="[object Int8Array]",j="[object Int16Array]",S="[object Int32Array]",C="[object Uint8Array]",E="[object Uint8ClampedArray]",k="[object Uint16Array]",R="[object Uint32Array]",T={};T[x]=T[b]=T[_]=T[j]=T[S]=T[C]=T[E]=T[k]=T[R]=!0,T[n]=T[i]=T[w]=T[s]=T[v]=T[o]=T[l]=T[c]=T[u]=T[d]=T[f]=T[h]=T[p]=T[y]=T[g]=!1;function I(F){return r(F)&&t(F.length)&&!!T[e(F)]}return uf=I,uf}var df,H1;function ru(){if(H1)return df;H1=1;function e(t){return function(r){return t(r)}}return df=e,df}var ho={exports:{}};ho.exports;var W1;function sy(){return W1||(W1=1,function(e,t){var r=xE(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l}(ho,ho.exports)),ho.exports}var ff,U1;function _a(){if(U1)return ff;U1=1;var e=xL(),t=ru(),r=sy(),n=r&&r.isTypedArray,i=n?t(n):e;return ff=i,ff}var pf,V1;function wE(){if(V1)return pf;V1=1;var e=mL(),t=wa(),r=at(),n=Ps(),i=tu(),s=_a(),o=Object.prototype,l=o.hasOwnProperty;function c(u,d){var f=r(u),h=!f&&t(u),p=!f&&!h&&n(u),y=!f&&!h&&!p&&s(u),g=f||h||p||y,w=g?e(u.length,String):[],v=w.length;for(var x in u)(d||l.call(u,x))&&!(g&&(x=="length"||p&&(x=="offset"||x=="parent")||y&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||i(x,v)))&&w.push(x);return w}return pf=c,pf}var hf,G1;function nu(){if(G1)return hf;G1=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return hf=t,hf}var mf,K1;function _E(){if(K1)return mf;K1=1;function e(t,r){return function(n){return t(r(n))}}return mf=e,mf}var gf,Y1;function yL(){if(Y1)return gf;Y1=1;var e=_E(),t=e(Object.keys,Object);return gf=t,gf}var vf,X1;function oy(){if(X1)return vf;X1=1;var e=nu(),t=yL(),r=Object.prototype,n=r.hasOwnProperty;function i(s){if(!e(s))return t(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return vf=i,vf}var xf,Q1;function xn(){if(Q1)return xf;Q1=1;var e=ya(),t=iy();function r(n){return n!=null&&t(n.length)&&!e(n)}return xf=r,xf}var yf,Z1;function ei(){if(Z1)return yf;Z1=1;var e=wE(),t=oy(),r=xn();function n(i){return r(i)?e(i):t(i)}return yf=n,yf}var bf,J1;function bL(){if(J1)return bf;J1=1;var e=ba(),t=ei();function r(n,i){return n&&e(i,t(i),n)}return bf=r,bf}var wf,ew;function wL(){if(ew)return wf;ew=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return wf=e,wf}var _f,tw;function _L(){if(tw)return _f;tw=1;var e=gr(),t=nu(),r=wL(),n=Object.prototype,i=n.hasOwnProperty;function s(o){if(!e(o))return r(o);var l=t(o),c=[];for(var u in o)u=="constructor"&&(l||!i.call(o,u))||c.push(u);return c}return _f=s,_f}var jf,rw;function Ai(){if(rw)return jf;rw=1;var e=wE(),t=_L(),r=xn();function n(i){return r(i)?e(i,!0):t(i)}return jf=n,jf}var Sf,nw;function jL(){if(nw)return Sf;nw=1;var e=ba(),t=Ai();function r(n,i){return n&&e(i,t(i),n)}return Sf=r,Sf}var mo={exports:{}};mo.exports;var iw;function jE(){return iw||(iw=1,function(e,t){var r=Ir(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s?r.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var f=u.length,h=l?l(f):new u.constructor(f);return u.copy(h),h}e.exports=c}(mo,mo.exports)),mo.exports}var kf,sw;function SE(){if(sw)return kf;sw=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return kf=e,kf}var Cf,ow;function kE(){if(ow)return Cf;ow=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=0,o=[];++n<i;){var l=t[n];r(l,n,t)&&(o[s++]=l)}return o}return Cf=e,Cf}var Nf,aw;function CE(){if(aw)return Nf;aw=1;function e(){return[]}return Nf=e,Nf}var Ef,lw;function ay(){if(lw)return Ef;lw=1;var e=kE(),t=CE(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),e(i(o),function(l){return n.call(o,l)}))}:t;return Ef=s,Ef}var Tf,cw;function SL(){if(cw)return Tf;cw=1;var e=ba(),t=ay();function r(n,i){return e(n,t(n),i)}return Tf=r,Tf}var Rf,uw;function ly(){if(uw)return Rf;uw=1;function e(t,r){for(var n=-1,i=r.length,s=t.length;++n<i;)t[s+n]=r[n];return t}return Rf=e,Rf}var Af,dw;function iu(){if(dw)return Af;dw=1;var e=_E(),t=e(Object.getPrototypeOf,Object);return Af=t,Af}var If,fw;function NE(){if(fw)return If;fw=1;var e=ly(),t=iu(),r=ay(),n=CE(),i=Object.getOwnPropertySymbols,s=i?function(o){for(var l=[];o;)e(l,r(o)),o=t(o);return l}:n;return If=s,If}var Mf,pw;function kL(){if(pw)return Mf;pw=1;var e=ba(),t=NE();function r(n,i){return e(n,t(n),i)}return Mf=r,Mf}var Pf,hw;function EE(){if(hw)return Pf;hw=1;var e=ly(),t=at();function r(n,i,s){var o=i(n);return t(n)?o:e(o,s(n))}return Pf=r,Pf}var Of,mw;function TE(){if(mw)return Of;mw=1;var e=EE(),t=ay(),r=ei();function n(i){return e(i,r,t)}return Of=n,Of}var Df,gw;function CL(){if(gw)return Df;gw=1;var e=EE(),t=NE(),r=Ai();function n(i){return e(i,r,t)}return Df=n,Df}var Lf,vw;function NL(){if(vw)return Lf;vw=1;var e=Ri(),t=Ir(),r=e(t,"DataView");return Lf=r,Lf}var Ff,xw;function EL(){if(xw)return Ff;xw=1;var e=Ri(),t=Ir(),r=e(t,"Promise");return Ff=r,Ff}var qf,yw;function RE(){if(yw)return qf;yw=1;var e=Ri(),t=Ir(),r=e(t,"Set");return qf=r,qf}var zf,bw;function TL(){if(bw)return zf;bw=1;var e=Ri(),t=Ir(),r=e(t,"WeakMap");return zf=r,zf}var $f,ww;function Os(){if(ww)return $f;ww=1;var e=NL(),t=ty(),r=EL(),n=RE(),i=TL(),s=Ti(),o=yE(),l="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",f="[object WeakMap]",h="[object DataView]",p=o(e),y=o(t),g=o(r),w=o(n),v=o(i),x=s;return(e&&x(new e(new ArrayBuffer(1)))!=h||t&&x(new t)!=l||r&&x(r.resolve())!=u||n&&x(new n)!=d||i&&x(new i)!=f)&&(x=function(b){var _=s(b),j=_==c?b.constructor:void 0,S=j?o(j):"";if(S)switch(S){case p:return h;case y:return l;case g:return u;case w:return d;case v:return f}return _}),$f=x,$f}var Bf,_w;function RL(){if(_w)return Bf;_w=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,s=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(s.index=n.index,s.input=n.input),s}return Bf=r,Bf}var Hf,jw;function AE(){if(jw)return Hf;jw=1;var e=Ir(),t=e.Uint8Array;return Hf=t,Hf}var Wf,Sw;function cy(){if(Sw)return Wf;Sw=1;var e=AE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return Wf=t,Wf}var Uf,kw;function AL(){if(kw)return Uf;kw=1;var e=cy();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return Uf=t,Uf}var Vf,Cw;function IL(){if(Cw)return Vf;Cw=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return Vf=t,Vf}var Gf,Nw;function ML(){if(Nw)return Gf;Nw=1;var e=Ms(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return Gf=n,Gf}var Kf,Ew;function IE(){if(Ew)return Kf;Ew=1;var e=cy();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return Kf=t,Kf}var Yf,Tw;function PL(){if(Tw)return Yf;Tw=1;var e=cy(),t=AL(),r=IL(),n=ML(),i=IE(),s="[object Boolean]",o="[object Date]",l="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",f="[object String]",h="[object Symbol]",p="[object ArrayBuffer]",y="[object DataView]",g="[object Float32Array]",w="[object Float64Array]",v="[object Int8Array]",x="[object Int16Array]",b="[object Int32Array]",_="[object Uint8Array]",j="[object Uint8ClampedArray]",S="[object Uint16Array]",C="[object Uint32Array]";function E(k,R,T){var I=k.constructor;switch(R){case p:return e(k);case s:case o:return new I(+k);case y:return t(k,T);case g:case w:case v:case x:case b:case _:case j:case S:case C:return i(k,T);case l:return new I;case c:case f:return new I(k);case u:return r(k);case d:return new I;case h:return n(k)}}return Yf=E,Yf}var Xf,Rw;function ME(){if(Rw)return Xf;Rw=1;var e=gr(),t=Object.create,r=function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var s=new n;return n.prototype=void 0,s}}();return Xf=r,Xf}var Qf,Aw;function PE(){if(Aw)return Qf;Aw=1;var e=ME(),t=iu(),r=nu();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return Qf=n,Qf}var Zf,Iw;function OL(){if(Iw)return Zf;Iw=1;var e=Os(),t=Kr(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return Zf=n,Zf}var Jf,Mw;function DL(){if(Mw)return Jf;Mw=1;var e=OL(),t=ru(),r=sy(),n=r&&r.isMap,i=n?t(n):e;return Jf=i,Jf}var ep,Pw;function LL(){if(Pw)return ep;Pw=1;var e=Os(),t=Kr(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return ep=n,ep}var tp,Ow;function FL(){if(Ow)return tp;Ow=1;var e=LL(),t=ru(),r=sy(),n=r&&r.isSet,i=n?t(n):e;return tp=i,tp}var rp,Dw;function OE(){if(Dw)return rp;Dw=1;var e=Zc(),t=ny(),r=eu(),n=bL(),i=jL(),s=jE(),o=SE(),l=SL(),c=kL(),u=TE(),d=CL(),f=Os(),h=RL(),p=PL(),y=PE(),g=at(),w=Ps(),v=DL(),x=gr(),b=FL(),_=ei(),j=Ai(),S=1,C=2,E=4,k="[object Arguments]",R="[object Array]",T="[object Boolean]",I="[object Date]",F="[object Error]",N="[object Function]",P="[object GeneratorFunction]",O="[object Map]",H="[object Number]",D="[object Object]",A="[object RegExp]",L="[object Set]",M="[object String]",$="[object Symbol]",W="[object WeakMap]",B="[object ArrayBuffer]",Y="[object DataView]",Z="[object Float32Array]",ie="[object Float64Array]",re="[object Int8Array]",de="[object Int16Array]",ee="[object Int32Array]",_e="[object Uint8Array]",ue="[object Uint8ClampedArray]",Te="[object Uint16Array]",pe="[object Uint32Array]",te={};te[k]=te[R]=te[B]=te[Y]=te[T]=te[I]=te[Z]=te[ie]=te[re]=te[de]=te[ee]=te[O]=te[H]=te[D]=te[A]=te[L]=te[M]=te[$]=te[_e]=te[ue]=te[Te]=te[pe]=!0,te[F]=te[N]=te[W]=!1;function xe(K,X,fe,me,ye,ve){var he,be=X&S,Fe=X&C,Se=X&E;if(fe&&(he=ye?fe(K,me,ye,ve):fe(K)),he!==void 0)return he;if(!x(K))return K;var Le=g(K);if(Le){if(he=h(K),!be)return o(K,he)}else{var q=f(K),V=q==N||q==P;if(w(K))return s(K,be);if(q==D||q==k||V&&!ye){if(he=Fe||V?{}:y(K),!be)return Fe?c(K,i(he,K)):l(K,n(he,K))}else{if(!te[q])return ye?K:{};he=p(K,q,be)}}ve||(ve=new e);var z=ve.get(K);if(z)return z;ve.set(K,he),b(K)?K.forEach(function(ze){he.add(xe(ze,X,fe,ze,K,ve))}):v(K)&&K.forEach(function(ze,Ze){he.set(Ze,xe(ze,X,fe,Ze,K,ve))});var J=Se?Fe?d:u:Fe?j:_,le=Le?void 0:J(K);return t(le||K,function(ze,Ze){le&&(Ze=ze,ze=K[Ze]),r(he,Ze,xe(ze,X,fe,Ze,K,ve))}),he}return rp=xe,rp}var np,Lw;function qL(){if(Lw)return np;Lw=1;var e=OE(),t=4;function r(n){return e(n,t)}return np=r,np}var ip,Fw;function uy(){if(Fw)return ip;Fw=1;function e(t){return function(){return t}}return ip=e,ip}var sp,qw;function zL(){if(qw)return sp;qw=1;function e(t){return function(r,n,i){for(var s=-1,o=Object(r),l=i(r),c=l.length;c--;){var u=l[t?c:++s];if(n(o[u],u,o)===!1)break}return r}}return sp=e,sp}var op,zw;function dy(){if(zw)return op;zw=1;var e=zL(),t=e();return op=t,op}var ap,$w;function fy(){if($w)return ap;$w=1;var e=dy(),t=ei();function r(n,i){return n&&e(n,i,t)}return ap=r,ap}var lp,Bw;function $L(){if(Bw)return lp;Bw=1;var e=xn();function t(r,n){return function(i,s){if(i==null)return i;if(!e(i))return r(i,s);for(var o=i.length,l=n?o:-1,c=Object(i);(n?l--:++l<o)&&s(c[l],l,c)!==!1;);return i}}return lp=t,lp}var cp,Hw;function su(){if(Hw)return cp;Hw=1;var e=fy(),t=$L(),r=t(e);return cp=r,cp}var up,Ww;function Ii(){if(Ww)return up;Ww=1;function e(t){return t}return up=e,up}var dp,Uw;function DE(){if(Uw)return dp;Uw=1;var e=Ii();function t(r){return typeof r=="function"?r:e}return dp=t,dp}var fp,Vw;function LE(){if(Vw)return fp;Vw=1;var e=ny(),t=su(),r=DE(),n=at();function i(s,o){var l=n(s)?e:t;return l(s,r(o))}return fp=i,fp}var pp,Gw;function FE(){return Gw||(Gw=1,pp=LE()),pp}var hp,Kw;function BL(){if(Kw)return hp;Kw=1;var e=su();function t(r,n){var i=[];return e(r,function(s,o,l){n(s,o,l)&&i.push(s)}),i}return hp=t,hp}var mp,Yw;function HL(){if(Yw)return mp;Yw=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return mp=t,mp}var gp,Xw;function WL(){if(Xw)return gp;Xw=1;function e(t){return this.__data__.has(t)}return gp=e,gp}var vp,Qw;function qE(){if(Qw)return vp;Qw=1;var e=ry(),t=HL(),r=WL();function n(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new e;++s<o;)this.add(i[s])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,vp=n,vp}var xp,Zw;function UL(){if(Zw)return xp;Zw=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return xp=e,xp}var yp,Jw;function zE(){if(Jw)return yp;Jw=1;function e(t,r){return t.has(r)}return yp=e,yp}var bp,e_;function $E(){if(e_)return bp;e_=1;var e=qE(),t=UL(),r=zE(),n=1,i=2;function s(o,l,c,u,d,f){var h=c&n,p=o.length,y=l.length;if(p!=y&&!(h&&y>p))return!1;var g=f.get(o),w=f.get(l);if(g&&w)return g==l&&w==o;var v=-1,x=!0,b=c&i?new e:void 0;for(f.set(o,l),f.set(l,o);++v<p;){var _=o[v],j=l[v];if(u)var S=h?u(j,_,v,l,o,f):u(_,j,v,o,l,f);if(S!==void 0){if(S)continue;x=!1;break}if(b){if(!t(l,function(C,E){if(!r(b,E)&&(_===C||d(_,C,c,u,f)))return b.push(E)})){x=!1;break}}else if(!(_===j||d(_,j,c,u,f))){x=!1;break}}return f.delete(o),f.delete(l),x}return bp=s,bp}var wp,t_;function VL(){if(t_)return wp;t_=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,s){n[++r]=[s,i]}),n}return wp=e,wp}var _p,r_;function py(){if(r_)return _p;r_=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return _p=e,_p}var jp,n_;function GL(){if(n_)return jp;n_=1;var e=Ms(),t=AE(),r=Is(),n=$E(),i=VL(),s=py(),o=1,l=2,c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Map]",h="[object Number]",p="[object RegExp]",y="[object Set]",g="[object String]",w="[object Symbol]",v="[object ArrayBuffer]",x="[object DataView]",b=e?e.prototype:void 0,_=b?b.valueOf:void 0;function j(S,C,E,k,R,T,I){switch(E){case x:if(S.byteLength!=C.byteLength||S.byteOffset!=C.byteOffset)return!1;S=S.buffer,C=C.buffer;case v:return!(S.byteLength!=C.byteLength||!T(new t(S),new t(C)));case c:case u:case h:return r(+S,+C);case d:return S.name==C.name&&S.message==C.message;case p:case g:return S==C+"";case f:var F=i;case y:var N=k&o;if(F||(F=s),S.size!=C.size&&!N)return!1;var P=I.get(S);if(P)return P==C;k|=l,I.set(S,C);var O=n(F(S),F(C),k,R,T,I);return I.delete(S),O;case w:if(_)return _.call(S)==_.call(C)}return!1}return jp=j,jp}var Sp,i_;function KL(){if(i_)return Sp;i_=1;var e=TE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l,c,u,d){var f=l&t,h=e(s),p=h.length,y=e(o),g=y.length;if(p!=g&&!f)return!1;for(var w=p;w--;){var v=h[w];if(!(f?v in o:n.call(o,v)))return!1}var x=d.get(s),b=d.get(o);if(x&&b)return x==o&&b==s;var _=!0;d.set(s,o),d.set(o,s);for(var j=f;++w<p;){v=h[w];var S=s[v],C=o[v];if(c)var E=f?c(C,S,v,o,s,d):c(S,C,v,s,o,d);if(!(E===void 0?S===C||u(S,C,l,c,d):E)){_=!1;break}j||(j=v=="constructor")}if(_&&!j){var k=s.constructor,R=o.constructor;k!=R&&"constructor"in s&&"constructor"in o&&!(typeof k=="function"&&k instanceof k&&typeof R=="function"&&R instanceof R)&&(_=!1)}return d.delete(s),d.delete(o),_}return Sp=i,Sp}var kp,s_;function YL(){if(s_)return kp;s_=1;var e=Zc(),t=$E(),r=GL(),n=KL(),i=Os(),s=at(),o=Ps(),l=_a(),c=1,u="[object Arguments]",d="[object Array]",f="[object Object]",h=Object.prototype,p=h.hasOwnProperty;function y(g,w,v,x,b,_){var j=s(g),S=s(w),C=j?d:i(g),E=S?d:i(w);C=C==u?f:C,E=E==u?f:E;var k=C==f,R=E==f,T=C==E;if(T&&o(g)){if(!o(w))return!1;j=!0,k=!1}if(T&&!k)return _||(_=new e),j||l(g)?t(g,w,v,x,b,_):r(g,w,C,v,x,b,_);if(!(v&c)){var I=k&&p.call(g,"__wrapped__"),F=R&&p.call(w,"__wrapped__");if(I||F){var N=I?g.value():g,P=F?w.value():w;return _||(_=new e),b(N,P,v,x,_)}}return T?(_||(_=new e),n(g,w,v,x,b,_)):!1}return kp=y,kp}var Cp,o_;function BE(){if(o_)return Cp;o_=1;var e=YL(),t=Kr();function r(n,i,s,o,l){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,s,o,r,l)}return Cp=r,Cp}var Np,a_;function XL(){if(a_)return Np;a_=1;var e=Zc(),t=BE(),r=1,n=2;function i(s,o,l,c){var u=l.length,d=u,f=!c;if(s==null)return!d;for(s=Object(s);u--;){var h=l[u];if(f&&h[2]?h[1]!==s[h[0]]:!(h[0]in s))return!1}for(;++u<d;){h=l[u];var p=h[0],y=s[p],g=h[1];if(f&&h[2]){if(y===void 0&&!(p in s))return!1}else{var w=new e;if(c)var v=c(y,g,p,s,o,w);if(!(v===void 0?t(g,y,r|n,c,w):v))return!1}}return!0}return Np=i,Np}var Ep,l_;function HE(){if(l_)return Ep;l_=1;var e=gr();function t(r){return r===r&&!e(r)}return Ep=t,Ep}var Tp,c_;function QL(){if(c_)return Tp;c_=1;var e=HE(),t=ei();function r(n){for(var i=t(n),s=i.length;s--;){var o=i[s],l=n[o];i[s]=[o,l,e(l)]}return i}return Tp=r,Tp}var Rp,u_;function WE(){if(u_)return Rp;u_=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Rp=e,Rp}var Ap,d_;function ZL(){if(d_)return Ap;d_=1;var e=XL(),t=QL(),r=WE();function n(i){var s=t(i);return s.length==1&&s[0][2]?r(s[0][0],s[0][1]):function(o){return o===i||e(o,i,s)}}return Ap=n,Ap}var Ip,f_;function Ds(){if(f_)return Ip;f_=1;var e=Ti(),t=Kr(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Ip=n,Ip}var Mp,p_;function hy(){if(p_)return Mp;p_=1;var e=at(),t=Ds(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){if(e(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return Mp=i,Mp}var Pp,h_;function JL(){if(h_)return Pp;h_=1;var e=ry(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var u=n.apply(this,o);return s.cache=c.set(l,u)||c,u};return s.cache=new(r.Cache||e),s}return r.Cache=e,Pp=r,Pp}var Op,m_;function e8(){if(m_)return Op;m_=1;var e=JL(),t=500;function r(n){var i=e(n,function(o){return s.size===t&&s.clear(),o}),s=i.cache;return i}return Op=r,Op}var Dp,g_;function t8(){if(g_)return Dp;g_=1;var e=e8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(t,function(o,l,c,u){s.push(c?u.replace(r,"$1"):l||o)}),s});return Dp=n,Dp}var Lp,v_;function ou(){if(v_)return Lp;v_=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=Array(i);++n<i;)s[n]=r(t[n],n,t);return s}return Lp=e,Lp}var Fp,x_;function r8(){if(x_)return Fp;x_=1;var e=Ms(),t=ou(),r=at(),n=Ds(),i=e?e.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return t(l,o)+"";if(n(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Fp=o,Fp}var qp,y_;function UE(){if(y_)return qp;y_=1;var e=r8();function t(r){return r==null?"":e(r)}return qp=t,qp}var zp,b_;function au(){if(b_)return zp;b_=1;var e=at(),t=hy(),r=t8(),n=UE();function i(s,o){return e(s)?s:t(s,o)?[s]:r(n(s))}return zp=i,zp}var $p,w_;function ja(){if(w_)return $p;w_=1;var e=Ds();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return $p=t,$p}var Bp,__;function lu(){if(__)return Bp;__=1;var e=au(),t=ja();function r(n,i){i=e(i,n);for(var s=0,o=i.length;n!=null&&s<o;)n=n[t(i[s++])];return s&&s==o?n:void 0}return Bp=r,Bp}var Hp,j_;function n8(){if(j_)return Hp;j_=1;var e=lu();function t(r,n,i){var s=r==null?void 0:e(r,n);return s===void 0?i:s}return Hp=t,Hp}var Wp,S_;function i8(){if(S_)return Wp;S_=1;function e(t,r){return t!=null&&r in Object(t)}return Wp=e,Wp}var Up,k_;function VE(){if(k_)return Up;k_=1;var e=au(),t=wa(),r=at(),n=tu(),i=iy(),s=ja();function o(l,c,u){c=e(c,l);for(var d=-1,f=c.length,h=!1;++d<f;){var p=s(c[d]);if(!(h=l!=null&&u(l,p)))break;l=l[p]}return h||++d!=f?h:(f=l==null?0:l.length,!!f&&i(f)&&n(p,f)&&(r(l)||t(l)))}return Up=o,Up}var Vp,C_;function GE(){if(C_)return Vp;C_=1;var e=i8(),t=VE();function r(n,i){return n!=null&&t(n,i,e)}return Vp=r,Vp}var Gp,N_;function s8(){if(N_)return Gp;N_=1;var e=BE(),t=n8(),r=GE(),n=hy(),i=HE(),s=WE(),o=ja(),l=1,c=2;function u(d,f){return n(d)&&i(f)?s(o(d),f):function(h){var p=t(h,d);return p===void 0&&p===f?r(h,d):e(f,p,l|c)}}return Gp=u,Gp}var Kp,E_;function KE(){if(E_)return Kp;E_=1;function e(t){return function(r){return r==null?void 0:r[t]}}return Kp=e,Kp}var Yp,T_;function o8(){if(T_)return Yp;T_=1;var e=lu();function t(r){return function(n){return e(n,r)}}return Yp=t,Yp}var Xp,R_;function a8(){if(R_)return Xp;R_=1;var e=KE(),t=o8(),r=hy(),n=ja();function i(s){return r(s)?e(n(s)):t(s)}return Xp=i,Xp}var Qp,A_;function yn(){if(A_)return Qp;A_=1;var e=ZL(),t=s8(),r=Ii(),n=at(),i=a8();function s(o){return typeof o=="function"?o:o==null?r:typeof o=="object"?n(o)?t(o[0],o[1]):e(o):i(o)}return Qp=s,Qp}var Zp,I_;function YE(){if(I_)return Zp;I_=1;var e=kE(),t=BL(),r=yn(),n=at();function i(s,o){var l=n(s)?e:t;return l(s,r(o,3))}return Zp=i,Zp}var Jp,M_;function l8(){if(M_)return Jp;M_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return Jp=r,Jp}var eh,P_;function XE(){if(P_)return eh;P_=1;var e=l8(),t=VE();function r(n,i){return n!=null&&t(n,i,e)}return eh=r,eh}var th,O_;function c8(){if(O_)return th;O_=1;var e=oy(),t=Os(),r=wa(),n=at(),i=xn(),s=Ps(),o=nu(),l=_a(),c="[object Map]",u="[object Set]",d=Object.prototype,f=d.hasOwnProperty;function h(p){if(p==null)return!0;if(i(p)&&(n(p)||typeof p=="string"||typeof p.splice=="function"||s(p)||l(p)||r(p)))return!p.length;var y=t(p);if(y==c||y==u)return!p.size;if(o(p))return!e(p).length;for(var g in p)if(f.call(p,g))return!1;return!0}return th=h,th}var rh,D_;function QE(){if(D_)return rh;D_=1;function e(t){return t===void 0}return rh=e,rh}var nh,L_;function ZE(){if(L_)return nh;L_=1;var e=su(),t=xn();function r(n,i){var s=-1,o=t(n)?Array(n.length):[];return e(n,function(l,c,u){o[++s]=i(l,c,u)}),o}return nh=r,nh}var ih,F_;function JE(){if(F_)return ih;F_=1;var e=ou(),t=yn(),r=ZE(),n=at();function i(s,o){var l=n(s)?e:r;return l(s,t(o,3))}return ih=i,ih}var sh,q_;function u8(){if(q_)return sh;q_=1;function e(t,r,n,i){var s=-1,o=t==null?0:t.length;for(i&&o&&(n=t[++s]);++s<o;)n=r(n,t[s],s,t);return n}return sh=e,sh}var oh,z_;function d8(){if(z_)return oh;z_=1;function e(t,r,n,i,s){return s(t,function(o,l,c){n=i?(i=!1,o):r(n,o,l,c)}),n}return oh=e,oh}var ah,$_;function eT(){if($_)return ah;$_=1;var e=u8(),t=su(),r=yn(),n=d8(),i=at();function s(o,l,c){var u=i(o)?e:n,d=arguments.length<3;return u(o,r(l,4),c,d,t)}return ah=s,ah}var lh,B_;function f8(){if(B_)return lh;B_=1;var e=Ti(),t=at(),r=Kr(),n="[object String]";function i(s){return typeof s=="string"||!t(s)&&r(s)&&e(s)==n}return lh=i,lh}var ch,H_;function p8(){if(H_)return ch;H_=1;var e=KE(),t=e("length");return ch=t,ch}var uh,W_;function h8(){if(W_)return uh;W_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="\\u200d",l=RegExp("["+o+e+i+s+"]");function c(u){return l.test(u)}return uh=c,uh}var dh,U_;function m8(){if(U_)return dh;U_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="["+e+"]",l="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+l+"|"+c+")",d="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",y=u+"?",g="["+s+"]?",w="(?:"+p+"(?:"+[d,f,h].join("|")+")"+g+y+")*",v=g+y+w,x="(?:"+[d+l+"?",l,f,h,o].join("|")+")",b=RegExp(c+"(?="+c+")|"+x+v,"g");function _(j){for(var S=b.lastIndex=0;b.test(j);)++S;return S}return dh=_,dh}var fh,V_;function g8(){if(V_)return fh;V_=1;var e=p8(),t=h8(),r=m8();function n(i){return t(i)?r(i):e(i)}return fh=n,fh}var ph,G_;function v8(){if(G_)return ph;G_=1;var e=oy(),t=Os(),r=xn(),n=f8(),i=g8(),s="[object Map]",o="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?i(c):c.length;var u=t(c);return u==s||u==o?c.size:e(c).length}return ph=l,ph}var hh,K_;function x8(){if(K_)return hh;K_=1;var e=ny(),t=ME(),r=fy(),n=yn(),i=iu(),s=at(),o=Ps(),l=ya(),c=gr(),u=_a();function d(f,h,p){var y=s(f),g=y||o(f)||u(f);if(h=n(h,4),p==null){var w=f&&f.constructor;g?p=y?new w:[]:c(f)?p=l(w)?t(i(f)):{}:p={}}return(g?e:r)(f,function(v,x,b){return h(p,v,x,b)}),p}return hh=d,hh}var mh,Y_;function y8(){if(Y_)return mh;Y_=1;var e=Ms(),t=wa(),r=at(),n=e?e.isConcatSpreadable:void 0;function i(s){return r(s)||t(s)||!!(n&&s&&s[n])}return mh=i,mh}var gh,X_;function my(){if(X_)return gh;X_=1;var e=ly(),t=y8();function r(n,i,s,o,l){var c=-1,u=n.length;for(s||(s=t),l||(l=[]);++c<u;){var d=n[c];i>0&&s(d)?i>1?r(d,i-1,s,o,l):e(l,d):o||(l[l.length]=d)}return l}return gh=r,gh}var vh,Q_;function b8(){if(Q_)return vh;Q_=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return vh=e,vh}var xh,Z_;function tT(){if(Z_)return xh;Z_=1;var e=b8(),t=Math.max;function r(n,i,s){return i=t(i===void 0?n.length-1:i,0),function(){for(var o=arguments,l=-1,c=t(o.length-i,0),u=Array(c);++l<c;)u[l]=o[i+l];l=-1;for(var d=Array(i+1);++l<i;)d[l]=o[l];return d[i]=s(u),e(n,this,d)}}return xh=r,xh}var yh,J_;function w8(){if(J_)return yh;J_=1;var e=uy(),t=bE(),r=Ii(),n=t?function(i,s){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(s),writable:!0})}:r;return yh=n,yh}var bh,e2;function _8(){if(e2)return bh;e2=1;var e=800,t=16,r=Date.now;function n(i){var s=0,o=0;return function(){var l=r(),c=t-(l-o);if(o=l,c>0){if(++s>=e)return arguments[0]}else s=0;return i.apply(void 0,arguments)}}return bh=n,bh}var wh,t2;function rT(){if(t2)return wh;t2=1;var e=w8(),t=_8(),r=t(e);return wh=r,wh}var _h,r2;function cu(){if(r2)return _h;r2=1;var e=Ii(),t=tT(),r=rT();function n(i,s){return r(t(i,s,e),i+"")}return _h=n,_h}var jh,n2;function nT(){if(n2)return jh;n2=1;function e(t,r,n,i){for(var s=t.length,o=n+(i?1:-1);i?o--:++o<s;)if(r(t[o],o,t))return o;return-1}return jh=e,jh}var Sh,i2;function j8(){if(i2)return Sh;i2=1;function e(t){return t!==t}return Sh=e,Sh}var kh,s2;function S8(){if(s2)return kh;s2=1;function e(t,r,n){for(var i=n-1,s=t.length;++i<s;)if(t[i]===r)return i;return-1}return kh=e,kh}var Ch,o2;function k8(){if(o2)return Ch;o2=1;var e=nT(),t=j8(),r=S8();function n(i,s,o){return s===s?r(i,s,o):e(i,t,o)}return Ch=n,Ch}var Nh,a2;function C8(){if(a2)return Nh;a2=1;var e=k8();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return Nh=t,Nh}var Eh,l2;function N8(){if(l2)return Eh;l2=1;function e(t,r,n){for(var i=-1,s=t==null?0:t.length;++i<s;)if(n(r,t[i]))return!0;return!1}return Eh=e,Eh}var Th,c2;function E8(){if(c2)return Th;c2=1;function e(){}return Th=e,Th}var Rh,u2;function T8(){if(u2)return Rh;u2=1;var e=RE(),t=E8(),r=py(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(s){return new e(s)}:t;return Rh=i,Rh}var Ah,d2;function R8(){if(d2)return Ah;d2=1;var e=qE(),t=C8(),r=N8(),n=zE(),i=T8(),s=py(),o=200;function l(c,u,d){var f=-1,h=t,p=c.length,y=!0,g=[],w=g;if(d)y=!1,h=r;else if(p>=o){var v=u?null:i(c);if(v)return s(v);y=!1,h=n,w=new e}else w=u?[]:g;e:for(;++f<p;){var x=c[f],b=u?u(x):x;if(x=d||x!==0?x:0,y&&b===b){for(var _=w.length;_--;)if(w[_]===b)continue e;u&&w.push(b),g.push(x)}else h(w,b,d)||(w!==g&&w.push(b),g.push(x))}return g}return Ah=l,Ah}var Ih,f2;function iT(){if(f2)return Ih;f2=1;var e=xn(),t=Kr();function r(n){return t(n)&&e(n)}return Ih=r,Ih}var Mh,p2;function A8(){if(p2)return Mh;p2=1;var e=my(),t=cu(),r=R8(),n=iT(),i=t(function(s){return r(e(s,1,n,!0))});return Mh=i,Mh}var Ph,h2;function I8(){if(h2)return Ph;h2=1;var e=ou();function t(r,n){return e(n,function(i){return r[i]})}return Ph=t,Ph}var Oh,m2;function sT(){if(m2)return Oh;m2=1;var e=I8(),t=ei();function r(n){return n==null?[]:e(n,t(n))}return Oh=r,Oh}var Dh,g2;function vr(){if(g2)return Dh;g2=1;var e;if(typeof ey=="function")try{e={clone:qL(),constant:uy(),each:FE(),filter:YE(),has:XE(),isArray:at(),isEmpty:c8(),isFunction:ya(),isUndefined:QE(),keys:ei(),map:JE(),reduce:eT(),size:v8(),transform:x8(),union:A8(),values:sT()}}catch{}return e||(e=window._),Dh=e,Dh}var Lh,v2;function gy(){if(v2)return Lh;v2=1;var e=vr();Lh=i;var t="\0",r="\0",n="";function i(d){this._isDirected=e.has(d,"directed")?d.directed:!0,this._isMultigraph=e.has(d,"multigraph")?d.multigraph:!1,this._isCompound=e.has(d,"compound")?d.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(d){return this._label=d,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultNodeLabelFn=d,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._in[f])})},i.prototype.sinks=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._out[f])})},i.prototype.setNodes=function(d,f){var h=arguments,p=this;return e.each(d,function(y){h.length>1?p.setNode(y,f):p.setNode(y)}),this},i.prototype.setNode=function(d,f){return e.has(this._nodes,d)?(arguments.length>1&&(this._nodes[d]=f),this):(this._nodes[d]=arguments.length>1?f:this._defaultNodeLabelFn(d),this._isCompound&&(this._parent[d]=r,this._children[d]={},this._children[r][d]=!0),this._in[d]={},this._preds[d]={},this._out[d]={},this._sucs[d]={},++this._nodeCount,this)},i.prototype.node=function(d){return this._nodes[d]},i.prototype.hasNode=function(d){return e.has(this._nodes,d)},i.prototype.removeNode=function(d){var f=this;if(e.has(this._nodes,d)){var h=function(p){f.removeEdge(f._edgeObjs[p])};delete this._nodes[d],this._isCompound&&(this._removeFromParentsChildList(d),delete this._parent[d],e.each(this.children(d),function(p){f.setParent(p)}),delete this._children[d]),e.each(e.keys(this._in[d]),h),delete this._in[d],delete this._preds[d],e.each(e.keys(this._out[d]),h),delete this._out[d],delete this._sucs[d],--this._nodeCount}return this},i.prototype.setParent=function(d,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var h=f;!e.isUndefined(h);h=this.parent(h))if(h===d)throw new Error("Setting "+f+" as parent of "+d+" would create a cycle");this.setNode(f)}return this.setNode(d),this._removeFromParentsChildList(d),this._parent[d]=f,this._children[f][d]=!0,this},i.prototype._removeFromParentsChildList=function(d){delete this._children[this._parent[d]][d]},i.prototype.parent=function(d){if(this._isCompound){var f=this._parent[d];if(f!==r)return f}},i.prototype.children=function(d){if(e.isUndefined(d)&&(d=r),this._isCompound){var f=this._children[d];if(f)return e.keys(f)}else{if(d===r)return this.nodes();if(this.hasNode(d))return[]}},i.prototype.predecessors=function(d){var f=this._preds[d];if(f)return e.keys(f)},i.prototype.successors=function(d){var f=this._sucs[d];if(f)return e.keys(f)},i.prototype.neighbors=function(d){var f=this.predecessors(d);if(f)return e.union(f,this.successors(d))},i.prototype.isLeaf=function(d){var f;return this.isDirected()?f=this.successors(d):f=this.neighbors(d),f.length===0},i.prototype.filterNodes=function(d){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var h=this;e.each(this._nodes,function(g,w){d(w)&&f.setNode(w,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,h.edge(g))});var p={};function y(g){var w=h.parent(g);return w===void 0||f.hasNode(w)?(p[g]=w,w):w in p?p[w]:y(w)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,y(g))}),f},i.prototype.setDefaultEdgeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultEdgeLabelFn=d,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(d,f){var h=this,p=arguments;return e.reduce(d,function(y,g){return p.length>1?h.setEdge(y,g,f):h.setEdge(y,g),g}),this},i.prototype.setEdge=function(){var d,f,h,p,y=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(d=g.v,f=g.w,h=g.name,arguments.length===2&&(p=arguments[1],y=!0)):(d=g,f=arguments[1],h=arguments[3],arguments.length>2&&(p=arguments[2],y=!0)),d=""+d,f=""+f,e.isUndefined(h)||(h=""+h);var w=l(this._isDirected,d,f,h);if(e.has(this._edgeLabels,w))return y&&(this._edgeLabels[w]=p),this;if(!e.isUndefined(h)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(f),this._edgeLabels[w]=y?p:this._defaultEdgeLabelFn(d,f,h);var v=c(this._isDirected,d,f,h);return d=v.v,f=v.w,Object.freeze(v),this._edgeObjs[w]=v,s(this._preds[f],d),s(this._sucs[d],f),this._in[f][w]=v,this._out[d][w]=v,this._edgeCount++,this},i.prototype.edge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):l(this._isDirected,d,f,h);return this._edgeLabels[p]},i.prototype.hasEdge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):l(this._isDirected,d,f,h);return e.has(this._edgeLabels,p)},i.prototype.removeEdge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):l(this._isDirected,d,f,h),y=this._edgeObjs[p];return y&&(d=y.v,f=y.w,delete this._edgeLabels[p],delete this._edgeObjs[p],o(this._preds[f],d),o(this._sucs[d],f),delete this._in[f][p],delete this._out[d][p],this._edgeCount--),this},i.prototype.inEdges=function(d,f){var h=this._in[d];if(h){var p=e.values(h);return f?e.filter(p,function(y){return y.v===f}):p}},i.prototype.outEdges=function(d,f){var h=this._out[d];if(h){var p=e.values(h);return f?e.filter(p,function(y){return y.w===f}):p}},i.prototype.nodeEdges=function(d,f){var h=this.inEdges(d,f);if(h)return h.concat(this.outEdges(d,f))};function s(d,f){d[f]?d[f]++:d[f]=1}function o(d,f){--d[f]||delete d[f]}function l(d,f,h,p){var y=""+f,g=""+h;if(!d&&y>g){var w=y;y=g,g=w}return y+n+g+n+(e.isUndefined(p)?t:p)}function c(d,f,h,p){var y=""+f,g=""+h;if(!d&&y>g){var w=y;y=g,g=w}var v={v:y,w:g};return p&&(v.name=p),v}function u(d,f){return l(d,f.v,f.w,f.name)}return Lh}var Fh,x2;function M8(){return x2||(x2=1,Fh="2.1.8"),Fh}var qh,y2;function P8(){return y2||(y2=1,qh={Graph:gy(),version:M8()}),qh}var zh,b2;function O8(){if(b2)return zh;b2=1;var e=vr(),t=gy();zh={write:r,read:s};function r(o){var l={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:n(o),edges:i(o)};return e.isUndefined(o.graph())||(l.value=e.clone(o.graph())),l}function n(o){return e.map(o.nodes(),function(l){var c=o.node(l),u=o.parent(l),d={v:l};return e.isUndefined(c)||(d.value=c),e.isUndefined(u)||(d.parent=u),d})}function i(o){return e.map(o.edges(),function(l){var c=o.edge(l),u={v:l.v,w:l.w};return e.isUndefined(l.name)||(u.name=l.name),e.isUndefined(c)||(u.value=c),u})}function s(o){var l=new t(o.options).setGraph(o.value);return e.each(o.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(o.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return zh}var $h,w2;function D8(){if(w2)return $h;w2=1;var e=vr();$h=t;function t(r){var n={},i=[],s;function o(l){e.has(n,l)||(n[l]=!0,s.push(l),e.each(r.successors(l),o),e.each(r.predecessors(l),o))}return e.each(r.nodes(),function(l){s=[],o(l),s.length&&i.push(s)}),i}return $h}var Bh,_2;function oT(){if(_2)return Bh;_2=1;var e=vr();Bh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var s=this._arr,o=s.length;return i[r]=o,s.push({key:r,priority:n}),this._decrease(o),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,s=i+1,o=r;i<n.length&&(o=n[i].priority<n[o].priority?i:o,s<n.length&&(o=n[s].priority<n[o].priority?s:o),o!==r&&(this._swap(r,o),this._heapify(o)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,s;r!==0&&(s=r>>1,!(n[s].priority<i));)this._swap(r,s),r=s},t.prototype._swap=function(r,n){var i=this._arr,s=this._keyIndices,o=i[r],l=i[n];i[r]=l,i[n]=o,s[l.key]=r,s[o.key]=n},Bh}var Hh,j2;function aT(){if(j2)return Hh;j2=1;var e=vr(),t=oT();Hh=n;var r=e.constant(1);function n(s,o,l,c){return i(s,String(o),l||r,c||function(u){return s.outEdges(u)})}function i(s,o,l,c){var u={},d=new t,f,h,p=function(y){var g=y.v!==f?y.v:y.w,w=u[g],v=l(y),x=h.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+y+" Weight: "+v);x<w.distance&&(w.distance=x,w.predecessor=f,d.decrease(g,x))};for(s.nodes().forEach(function(y){var g=y===o?0:Number.POSITIVE_INFINITY;u[y]={distance:g},d.add(y,g)});d.size()>0&&(f=d.removeMin(),h=u[f],h.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(p);return u}return Hh}var Wh,S2;function L8(){if(S2)return Wh;S2=1;var e=aT(),t=vr();Wh=r;function r(n,i,s){return t.transform(n.nodes(),function(o,l){o[l]=e(n,l,i,s)},{})}return Wh}var Uh,k2;function lT(){if(k2)return Uh;k2=1;var e=vr();Uh=t;function t(r){var n=0,i=[],s={},o=[];function l(c){var u=s[c]={onStack:!0,lowlink:n,index:n++};if(i.push(c),r.successors(c).forEach(function(h){e.has(s,h)?s[h].onStack&&(u.lowlink=Math.min(u.lowlink,s[h].index)):(l(h),u.lowlink=Math.min(u.lowlink,s[h].lowlink))}),u.lowlink===u.index){var d=[],f;do f=i.pop(),s[f].onStack=!1,d.push(f);while(c!==f);o.push(d)}}return r.nodes().forEach(function(c){e.has(s,c)||l(c)}),o}return Uh}var Vh,C2;function F8(){if(C2)return Vh;C2=1;var e=vr(),t=lT();Vh=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Vh}var Gh,N2;function q8(){if(N2)return Gh;N2=1;var e=vr();Gh=r;var t=e.constant(1);function r(i,s,o){return n(i,s||t,o||function(l){return i.outEdges(l)})}function n(i,s,o){var l={},c=i.nodes();return c.forEach(function(u){l[u]={},l[u][u]={distance:0},c.forEach(function(d){u!==d&&(l[u][d]={distance:Number.POSITIVE_INFINITY})}),o(u).forEach(function(d){var f=d.v===u?d.w:d.v,h=s(d);l[u][f]={distance:h,predecessor:u}})}),c.forEach(function(u){var d=l[u];c.forEach(function(f){var h=l[f];c.forEach(function(p){var y=h[u],g=d[p],w=h[p],v=y.distance+g.distance;v<w.distance&&(w.distance=v,w.predecessor=g.predecessor)})})}),l}return Gh}var Kh,E2;function cT(){if(E2)return Kh;E2=1;var e=vr();Kh=t,t.CycleException=r;function t(n){var i={},s={},o=[];function l(c){if(e.has(s,c))throw new r;e.has(i,c)||(s[c]=!0,i[c]=!0,e.each(n.predecessors(c),l),delete s[c],o.push(c))}if(e.each(n.sinks(),l),e.size(i)!==n.nodeCount())throw new r;return o}function r(){}return r.prototype=new Error,Kh}var Yh,T2;function z8(){if(T2)return Yh;T2=1;var e=cT();Yh=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return Yh}var Xh,R2;function uT(){if(R2)return Xh;R2=1;var e=vr();Xh=t;function t(n,i,s){e.isArray(i)||(i=[i]);var o=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(i,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);r(n,u,s==="post",c,o,l)}),l}function r(n,i,s,o,l,c){e.has(o,i)||(o[i]=!0,s||c.push(i),e.each(l(i),function(u){r(n,u,s,o,l,c)}),s&&c.push(i))}return Xh}var Qh,A2;function $8(){if(A2)return Qh;A2=1;var e=uT();Qh=t;function t(r,n){return e(r,n,"post")}return Qh}var Zh,I2;function B8(){if(I2)return Zh;I2=1;var e=uT();Zh=t;function t(r,n){return e(r,n,"pre")}return Zh}var Jh,M2;function H8(){if(M2)return Jh;M2=1;var e=vr(),t=gy(),r=oT();Jh=n;function n(i,s){var o=new t,l={},c=new r,u;function d(h){var p=h.v===u?h.w:h.v,y=c.priority(p);if(y!==void 0){var g=s(h);g<y&&(l[p]=u,c.decrease(p,g))}}if(i.nodeCount()===0)return o;e.each(i.nodes(),function(h){c.add(h,Number.POSITIVE_INFINITY),o.setNode(h)}),c.decrease(i.nodes()[0],0);for(var f=!1;c.size()>0;){if(u=c.removeMin(),e.has(l,u))o.setEdge(u,l[u]);else{if(f)throw new Error("Input graph is not connected: "+i);f=!0}i.nodeEdges(u).forEach(d)}return o}return Jh}var em,P2;function W8(){return P2||(P2=1,em={components:D8(),dijkstra:aT(),dijkstraAll:L8(),findCycles:F8(),floydWarshall:q8(),isAcyclic:z8(),postorder:$8(),preorder:B8(),prim:H8(),tarjan:lT(),topsort:cT()}),em}var tm,O2;function U8(){if(O2)return tm;O2=1;var e=P8();return tm={Graph:e.Graph,json:O8(),alg:W8(),version:e.version},tm}var oc;if(typeof ey=="function")try{oc=U8()}catch{}oc||(oc=window.graphlib);var Mr=oc,rm,D2;function V8(){if(D2)return rm;D2=1;var e=OE(),t=1,r=4;function n(i){return e(i,t|r)}return rm=n,rm}var nm,L2;function uu(){if(L2)return nm;L2=1;var e=Is(),t=xn(),r=tu(),n=gr();function i(s,o,l){if(!n(l))return!1;var c=typeof o;return(c=="number"?t(l)&&r(o,l.length):c=="string"&&o in l)?e(l[o],s):!1}return nm=i,nm}var im,F2;function G8(){if(F2)return im;F2=1;var e=cu(),t=Is(),r=uu(),n=Ai(),i=Object.prototype,s=i.hasOwnProperty,o=e(function(l,c){l=Object(l);var u=-1,d=c.length,f=d>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(d=1);++u<d;)for(var h=c[u],p=n(h),y=-1,g=p.length;++y<g;){var w=p[y],v=l[w];(v===void 0||t(v,i[w])&&!s.call(l,w))&&(l[w]=h[w])}return l});return im=o,im}var sm,q2;function K8(){if(q2)return sm;q2=1;var e=yn(),t=xn(),r=ei();function n(i){return function(s,o,l){var c=Object(s);if(!t(s)){var u=e(o,3);s=r(s),o=function(f){return u(c[f],f,c)}}var d=i(s,o,l);return d>-1?c[u?s[d]:d]:void 0}}return sm=n,sm}var om,z2;function Y8(){if(z2)return om;z2=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return om=t,om}var am,$2;function X8(){if($2)return am;$2=1;var e=Y8(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return am=r,am}var lm,B2;function Q8(){if(B2)return lm;B2=1;var e=X8(),t=gr(),r=Ds(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var f=s.test(u);return f||o.test(u)?l(u.slice(2),f?2:8):i.test(u)?n:+u}return lm=c,lm}var cm,H2;function dT(){if(H2)return cm;H2=1;var e=Q8(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var s=i<0?-1:1;return s*r}return i===i?i:0}return cm=n,cm}var um,W2;function Z8(){if(W2)return um;W2=1;var e=dT();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return um=t,um}var dm,U2;function J8(){if(U2)return dm;U2=1;var e=nT(),t=yn(),r=Z8(),n=Math.max;function i(s,o,l){var c=s==null?0:s.length;if(!c)return-1;var u=l==null?0:r(l);return u<0&&(u=n(c+u,0)),e(s,t(o,3),u)}return dm=i,dm}var fm,V2;function eF(){if(V2)return fm;V2=1;var e=K8(),t=J8(),r=e(t);return fm=r,fm}var pm,G2;function fT(){if(G2)return pm;G2=1;var e=my();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return pm=t,pm}var hm,K2;function tF(){if(K2)return hm;K2=1;var e=dy(),t=DE(),r=Ai();function n(i,s){return i==null?i:e(i,t(s),r)}return hm=n,hm}var mm,Y2;function rF(){if(Y2)return mm;Y2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return mm=e,mm}var gm,X2;function nF(){if(X2)return gm;X2=1;var e=Jc(),t=fy(),r=yn();function n(i,s){var o={};return s=r(s,3),t(i,function(l,c,u){e(o,c,s(l,c,u))}),o}return gm=n,gm}var vm,Q2;function vy(){if(Q2)return vm;Q2=1;var e=Ds();function t(r,n,i){for(var s=-1,o=r.length;++s<o;){var l=r[s],c=n(l);if(c!=null&&(u===void 0?c===c&&!e(c):i(c,u)))var u=c,d=l}return d}return vm=t,vm}var xm,Z2;function iF(){if(Z2)return xm;Z2=1;function e(t,r){return t>r}return xm=e,xm}var ym,J2;function sF(){if(J2)return ym;J2=1;var e=vy(),t=iF(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return ym=n,ym}var bm,ej;function pT(){if(ej)return bm;ej=1;var e=Jc(),t=Is();function r(n,i,s){(s!==void 0&&!t(n[i],s)||s===void 0&&!(i in n))&&e(n,i,s)}return bm=r,bm}var wm,tj;function oF(){if(tj)return wm;tj=1;var e=Ti(),t=iu(),r=Kr(),n="[object Object]",i=Function.prototype,s=Object.prototype,o=i.toString,l=s.hasOwnProperty,c=o.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var f=t(d);if(f===null)return!0;var h=l.call(f,"constructor")&&f.constructor;return typeof h=="function"&&h instanceof h&&o.call(h)==c}return wm=u,wm}var _m,rj;function hT(){if(rj)return _m;rj=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return _m=e,_m}var jm,nj;function aF(){if(nj)return jm;nj=1;var e=ba(),t=Ai();function r(n){return e(n,t(n))}return jm=r,jm}var Sm,ij;function lF(){if(ij)return Sm;ij=1;var e=pT(),t=jE(),r=IE(),n=SE(),i=PE(),s=wa(),o=at(),l=iT(),c=Ps(),u=ya(),d=gr(),f=oF(),h=_a(),p=hT(),y=aF();function g(w,v,x,b,_,j,S){var C=p(w,x),E=p(v,x),k=S.get(E);if(k){e(w,x,k);return}var R=j?j(C,E,x+"",w,v,S):void 0,T=R===void 0;if(T){var I=o(E),F=!I&&c(E),N=!I&&!F&&h(E);R=E,I||F||N?o(C)?R=C:l(C)?R=n(C):F?(T=!1,R=t(E,!0)):N?(T=!1,R=r(E,!0)):R=[]:f(E)||s(E)?(R=C,s(C)?R=y(C):(!d(C)||u(C))&&(R=i(E))):T=!1}T&&(S.set(E,R),_(R,E,b,j,S),S.delete(E)),e(w,x,R)}return Sm=g,Sm}var km,sj;function cF(){if(sj)return km;sj=1;var e=Zc(),t=pT(),r=dy(),n=lF(),i=gr(),s=Ai(),o=hT();function l(c,u,d,f,h){c!==u&&r(u,function(p,y){if(h||(h=new e),i(p))n(c,u,y,d,l,f,h);else{var g=f?f(o(c,y),p,y+"",c,u,h):void 0;g===void 0&&(g=p),t(c,y,g)}},s)}return km=l,km}var Cm,oj;function uF(){if(oj)return Cm;oj=1;var e=cu(),t=uu();function r(n){return e(function(i,s){var o=-1,l=s.length,c=l>1?s[l-1]:void 0,u=l>2?s[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,u&&t(s[0],s[1],u)&&(c=l<3?void 0:c,l=1),i=Object(i);++o<l;){var d=s[o];d&&n(i,d,o,c)}return i})}return Cm=r,Cm}var Nm,aj;function dF(){if(aj)return Nm;aj=1;var e=cF(),t=uF(),r=t(function(n,i,s){e(n,i,s)});return Nm=r,Nm}var Em,lj;function mT(){if(lj)return Em;lj=1;function e(t,r){return t<r}return Em=e,Em}var Tm,cj;function fF(){if(cj)return Tm;cj=1;var e=vy(),t=mT(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return Tm=n,Tm}var Rm,uj;function pF(){if(uj)return Rm;uj=1;var e=vy(),t=yn(),r=mT();function n(i,s){return i&&i.length?e(i,t(s,2),r):void 0}return Rm=n,Rm}var Am,dj;function hF(){if(dj)return Am;dj=1;var e=Ir(),t=function(){return e.Date.now()};return Am=t,Am}var Im,fj;function mF(){if(fj)return Im;fj=1;var e=eu(),t=au(),r=tu(),n=gr(),i=ja();function s(o,l,c,u){if(!n(o))return o;l=t(l,o);for(var d=-1,f=l.length,h=f-1,p=o;p!=null&&++d<f;){var y=i(l[d]),g=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return o;if(d!=h){var w=p[y];g=u?u(w,y,p):void 0,g===void 0&&(g=n(w)?w:r(l[d+1])?[]:{})}e(p,y,g),p=p[y]}return o}return Im=s,Im}var Mm,pj;function gF(){if(pj)return Mm;pj=1;var e=lu(),t=mF(),r=au();function n(i,s,o){for(var l=-1,c=s.length,u={};++l<c;){var d=s[l],f=e(i,d);o(f,d)&&t(u,r(d,i),f)}return u}return Mm=n,Mm}var Pm,hj;function vF(){if(hj)return Pm;hj=1;var e=gF(),t=GE();function r(n,i){return e(n,i,function(s,o){return t(n,o)})}return Pm=r,Pm}var Om,mj;function xF(){if(mj)return Om;mj=1;var e=fT(),t=tT(),r=rT();function n(i){return r(t(i,void 0,e),i+"")}return Om=n,Om}var Dm,gj;function yF(){if(gj)return Dm;gj=1;var e=vF(),t=xF(),r=t(function(n,i){return n==null?{}:e(n,i)});return Dm=r,Dm}var Lm,vj;function bF(){if(vj)return Lm;vj=1;var e=Math.ceil,t=Math.max;function r(n,i,s,o){for(var l=-1,c=t(e((i-n)/(s||1)),0),u=Array(c);c--;)u[o?c:++l]=n,n+=s;return u}return Lm=r,Lm}var Fm,xj;function wF(){if(xj)return Fm;xj=1;var e=bF(),t=uu(),r=dT();function n(i){return function(s,o,l){return l&&typeof l!="number"&&t(s,o,l)&&(o=l=void 0),s=r(s),o===void 0?(o=s,s=0):o=r(o),l=l===void 0?s<o?1:-1:r(l),e(s,o,l,i)}}return Fm=n,Fm}var qm,yj;function _F(){if(yj)return qm;yj=1;var e=wF(),t=e();return qm=t,qm}var zm,bj;function jF(){if(bj)return zm;bj=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return zm=e,zm}var $m,wj;function SF(){if(wj)return $m;wj=1;var e=Ds();function t(r,n){if(r!==n){var i=r!==void 0,s=r===null,o=r===r,l=e(r),c=n!==void 0,u=n===null,d=n===n,f=e(n);if(!u&&!f&&!l&&r>n||l&&c&&d&&!u&&!f||s&&c&&d||!i&&d||!o)return 1;if(!s&&!l&&!f&&r<n||f&&i&&o&&!s&&!l||u&&i&&o||!c&&o||!d)return-1}return 0}return $m=t,$m}var Bm,_j;function kF(){if(_j)return Bm;_j=1;var e=SF();function t(r,n,i){for(var s=-1,o=r.criteria,l=n.criteria,c=o.length,u=i.length;++s<c;){var d=e(o[s],l[s]);if(d){if(s>=u)return d;var f=i[s];return d*(f=="desc"?-1:1)}}return r.index-n.index}return Bm=t,Bm}var Hm,jj;function CF(){if(jj)return Hm;jj=1;var e=ou(),t=lu(),r=yn(),n=ZE(),i=jF(),s=ru(),o=kF(),l=Ii(),c=at();function u(d,f,h){f.length?f=e(f,function(g){return c(g)?function(w){return t(w,g.length===1?g[0]:g)}:g}):f=[l];var p=-1;f=e(f,s(r));var y=n(d,function(g,w,v){var x=e(f,function(b){return b(g)});return{criteria:x,index:++p,value:g}});return i(y,function(g,w){return o(g,w,h)})}return Hm=u,Hm}var Wm,Sj;function NF(){if(Sj)return Wm;Sj=1;var e=my(),t=CF(),r=cu(),n=uu(),i=r(function(s,o){if(s==null)return[];var l=o.length;return l>1&&n(s,o[0],o[1])?o=[]:l>2&&n(o[0],o[1],o[2])&&(o=[o[0]]),t(s,e(o,1),[])});return Wm=i,Wm}var Um,kj;function EF(){if(kj)return Um;kj=1;var e=UE(),t=0;function r(n){var i=++t;return e(n)+i}return Um=r,Um}var Vm,Cj;function TF(){if(Cj)return Vm;Cj=1;function e(t,r,n){for(var i=-1,s=t.length,o=r.length,l={};++i<s;){var c=i<o?r[i]:void 0;n(l,t[i],c)}return l}return Vm=e,Vm}var Gm,Nj;function RF(){if(Nj)return Gm;Nj=1;var e=eu(),t=TF();function r(n,i){return t(n||[],i||[],e)}return Gm=r,Gm}var ac;if(typeof ey=="function")try{ac={cloneDeep:V8(),constant:uy(),defaults:G8(),each:FE(),filter:YE(),find:eF(),flatten:fT(),forEach:LE(),forIn:tF(),has:XE(),isUndefined:QE(),last:rF(),map:JE(),mapValues:nF(),max:sF(),merge:dF(),min:fF(),minBy:pF(),now:hF(),pick:yF(),range:_F(),reduce:eT(),sortBy:NF(),uniqueId:EF(),values:sT(),zipObject:RF()}}catch{}ac||(ac=window._);var Ge=ac,AF=du;function du(){var e={};e._next=e._prev=e,this._sentinel=e}du.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return gT(t),t};du.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&gT(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};du.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,IF)),r=r._prev;return"["+e.join(", ")+"]"};function gT(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function IF(e,t){if(e!=="_next"&&e!=="_prev")return t}var sn=Ge,MF=Mr.Graph,PF=AF,OF=LF,DF=sn.constant(1);function LF(e,t){if(e.nodeCount()<=1)return[];var r=qF(e,t||DF),n=FF(r.graph,r.buckets,r.zeroIdx);return sn.flatten(sn.map(n,function(i){return e.outEdges(i.v,i.w)}),!0)}function FF(e,t,r){for(var n=[],i=t[t.length-1],s=t[0],o;e.nodeCount();){for(;o=s.dequeue();)Km(e,t,r,o);for(;o=i.dequeue();)Km(e,t,r,o);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(o=t[l].dequeue(),o){n=n.concat(Km(e,t,r,o,!0));break}}}return n}function Km(e,t,r,n,i){var s=i?[]:void 0;return sn.forEach(e.inEdges(n.v),function(o){var l=e.edge(o),c=e.node(o.v);i&&s.push({v:o.v,w:o.w}),c.out-=l,Tv(t,r,c)}),sn.forEach(e.outEdges(n.v),function(o){var l=e.edge(o),c=o.w,u=e.node(c);u.in-=l,Tv(t,r,u)}),e.removeNode(n.v),s}function qF(e,t){var r=new MF,n=0,i=0;sn.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),sn.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,u=t(l),d=c+u;r.setEdge(l.v,l.w,d),i=Math.max(i,r.node(l.v).out+=u),n=Math.max(n,r.node(l.w).in+=u)});var s=sn.range(i+n+3).map(function(){return new PF}),o=n+1;return sn.forEach(r.nodes(),function(l){Tv(s,o,r.node(l))}),{graph:r,buckets:s,zeroIdx:o}}function Tv(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var hi=Ge,zF=OF,$F={run:BF,undo:WF};function BF(e){var t=e.graph().acyclicer==="greedy"?zF(e,r(e)):HF(e);hi.forEach(t,function(n){var i=e.edge(n);e.removeEdge(n),i.forwardName=n.name,i.reversed=!0,e.setEdge(n.w,n.v,i,hi.uniqueId("rev"))});function r(n){return function(i){return n.edge(i).weight}}}function HF(e){var t=[],r={},n={};function i(s){hi.has(n,s)||(n[s]=!0,r[s]=!0,hi.forEach(e.outEdges(s),function(o){hi.has(r,o.w)?t.push(o):i(o.w)}),delete r[s])}return hi.forEach(e.nodes(),i),t}function WF(e){hi.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var Me=Ge,vT=Mr.Graph,Gt={addDummyNode:xT,simplify:UF,asNonCompoundGraph:VF,successorWeights:GF,predecessorWeights:KF,intersectRect:YF,buildLayerMatrix:XF,normalizeRanks:QF,removeEmptyRanks:ZF,addBorderNode:JF,maxRank:yT,partition:eq,time:tq,notime:rq};function xT(e,t,r,n){var i;do i=Me.uniqueId(n);while(e.hasNode(i));return r.dummy=t,e.setNode(i,r),i}function UF(e){var t=new vT().setGraph(e.graph());return Me.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),Me.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},i=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),t}function VF(e){var t=new vT({multigraph:e.isMultigraph()}).setGraph(e.graph());return Me.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),Me.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function GF(e){var t=Me.map(e.nodes(),function(r){var n={};return Me.forEach(e.outEdges(r),function(i){n[i.w]=(n[i.w]||0)+e.edge(i).weight}),n});return Me.zipObject(e.nodes(),t)}function KF(e){var t=Me.map(e.nodes(),function(r){var n={};return Me.forEach(e.inEdges(r),function(i){n[i.v]=(n[i.v]||0)+e.edge(i).weight}),n});return Me.zipObject(e.nodes(),t)}function YF(e,t){var r=e.x,n=e.y,i=t.x-r,s=t.y-n,o=e.width/2,l=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var c,u;return Math.abs(s)*o>Math.abs(i)*l?(s<0&&(l=-l),c=l*i/s,u=l):(i<0&&(o=-o),c=o,u=o*s/i),{x:r+c,y:n+u}}function XF(e){var t=Me.map(Me.range(yT(e)+1),function(){return[]});return Me.forEach(e.nodes(),function(r){var n=e.node(r),i=n.rank;Me.isUndefined(i)||(t[i][n.order]=r)}),t}function QF(e){var t=Me.min(Me.map(e.nodes(),function(r){return e.node(r).rank}));Me.forEach(e.nodes(),function(r){var n=e.node(r);Me.has(n,"rank")&&(n.rank-=t)})}function ZF(e){var t=Me.min(Me.map(e.nodes(),function(s){return e.node(s).rank})),r=[];Me.forEach(e.nodes(),function(s){var o=e.node(s).rank-t;r[o]||(r[o]=[]),r[o].push(s)});var n=0,i=e.graph().nodeRankFactor;Me.forEach(r,function(s,o){Me.isUndefined(s)&&o%i!==0?--n:n&&Me.forEach(s,function(l){e.node(l).rank+=n})})}function JF(e,t,r,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=r,i.order=n),xT(e,"border",i,t)}function yT(e){return Me.max(Me.map(e.nodes(),function(t){var r=e.node(t).rank;if(!Me.isUndefined(r))return r}))}function eq(e,t){var r={lhs:[],rhs:[]};return Me.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function tq(e,t){var r=Me.now();try{return t()}finally{console.log(e+" time: "+(Me.now()-r)+"ms")}}function rq(e,t){return t()}var bT=Ge,nq=Gt,iq={run:sq,undo:aq};function sq(e){e.graph().dummyChains=[],bT.forEach(e.edges(),function(t){oq(e,t)})}function oq(e,t){var r=t.v,n=e.node(r).rank,i=t.w,s=e.node(i).rank,o=t.name,l=e.edge(t),c=l.labelRank;if(s!==n+1){e.removeEdge(t);var u,d,f;for(f=0,++n;n<s;++f,++n)l.points=[],d={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},u=nq.addDummyNode(e,"edge",d,"_d"),n===c&&(d.width=l.width,d.height=l.height,d.dummy="edge-label",d.labelpos=l.labelpos),e.setEdge(r,u,{weight:l.weight},o),f===0&&e.graph().dummyChains.push(u),r=u;e.setEdge(r,i,{weight:l.weight},o)}}function aq(e){bT.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,i;for(e.setEdge(r.edgeObj,n);r.dummy;)i=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=i,r=e.node(t)})}var rl=Ge,fu={longestPath:lq,slack:cq};function lq(e){var t={};function r(n){var i=e.node(n);if(rl.has(t,n))return i.rank;t[n]=!0;var s=rl.min(rl.map(e.outEdges(n),function(o){return r(o.w)-e.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}rl.forEach(e.sources(),r)}function cq(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var lc=Ge,uq=Mr.Graph,cc=fu.slack,wT=dq;function dq(e){var t=new uq({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var i,s;fq(t,e)<n;)i=pq(t,e),s=t.hasNode(i.v)?cc(e,i):-cc(e,i),hq(t,e,s);return t}function fq(e,t){function r(n){lc.forEach(t.nodeEdges(n),function(i){var s=i.v,o=n===s?i.w:s;!e.hasNode(o)&&!cc(t,i)&&(e.setNode(o,{}),e.setEdge(n,o,{}),r(o))})}return lc.forEach(e.nodes(),r),e.nodeCount()}function pq(e,t){return lc.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return cc(t,r)})}function hq(e,t,r){lc.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var mn=Ge,mq=wT,gq=fu.slack,vq=fu.longestPath,xq=Mr.alg.preorder,yq=Mr.alg.postorder,bq=Gt.simplify,wq=Mi;Mi.initLowLimValues=yy;Mi.initCutValues=xy;Mi.calcCutValue=_T;Mi.leaveEdge=ST;Mi.enterEdge=kT;Mi.exchangeEdges=CT;function Mi(e){e=bq(e),vq(e);var t=mq(e);yy(t),xy(t,e);for(var r,n;r=ST(t);)n=kT(t,e,r),CT(t,e,r,n)}function xy(e,t){var r=yq(e,e.nodes());r=r.slice(0,r.length-1),mn.forEach(r,function(n){_q(e,t,n)})}function _q(e,t,r){var n=e.node(r),i=n.parent;e.edge(r,i).cutvalue=_T(e,t,r)}function _T(e,t,r){var n=e.node(r),i=n.parent,s=!0,o=t.edge(r,i),l=0;return o||(s=!1,o=t.edge(i,r)),l=o.weight,mn.forEach(t.nodeEdges(r),function(c){var u=c.v===r,d=u?c.w:c.v;if(d!==i){var f=u===s,h=t.edge(c).weight;if(l+=f?h:-h,Sq(e,r,d)){var p=e.edge(r,d).cutvalue;l+=f?-p:p}}}),l}function yy(e,t){arguments.length<2&&(t=e.nodes()[0]),jT(e,{},1,t)}function jT(e,t,r,n,i){var s=r,o=e.node(n);return t[n]=!0,mn.forEach(e.neighbors(n),function(l){mn.has(t,l)||(r=jT(e,t,r,l,n))}),o.low=s,o.lim=r++,i?o.parent=i:delete o.parent,r}function ST(e){return mn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function kT(e,t,r){var n=r.v,i=r.w;t.hasEdge(n,i)||(n=r.w,i=r.v);var s=e.node(n),o=e.node(i),l=s,c=!1;s.lim>o.lim&&(l=o,c=!0);var u=mn.filter(t.edges(),function(d){return c===Ej(e,e.node(d.v),l)&&c!==Ej(e,e.node(d.w),l)});return mn.minBy(u,function(d){return gq(t,d)})}function CT(e,t,r,n){var i=r.v,s=r.w;e.removeEdge(i,s),e.setEdge(n.v,n.w,{}),yy(e),xy(e,t),jq(e,t)}function jq(e,t){var r=mn.find(e.nodes(),function(i){return!t.node(i).parent}),n=xq(e,r);n=n.slice(1),mn.forEach(n,function(i){var s=e.node(i).parent,o=t.edge(i,s),l=!1;o||(o=t.edge(s,i),l=!0),t.node(i).rank=t.node(s).rank+(l?o.minlen:-o.minlen)})}function Sq(e,t,r){return e.hasEdge(t,r)}function Ej(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var kq=fu,NT=kq.longestPath,Cq=wT,Nq=wq,Eq=Tq;function Tq(e){switch(e.graph().ranker){case"network-simplex":Tj(e);break;case"tight-tree":Aq(e);break;case"longest-path":Rq(e);break;default:Tj(e)}}var Rq=NT;function Aq(e){NT(e),Cq(e)}function Tj(e){Nq(e)}var Rv=Ge,Iq=Mq;function Mq(e){var t=Oq(e);Rv.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),i=n.edgeObj,s=Pq(e,t,i.v,i.w),o=s.path,l=s.lca,c=0,u=o[c],d=!0;r!==i.w;){if(n=e.node(r),d){for(;(u=o[c])!==l&&e.node(u).maxRank<n.rank;)c++;u===l&&(d=!1)}if(!d){for(;c<o.length-1&&e.node(u=o[c+1]).minRank<=n.rank;)c++;u=o[c]}e.setParent(r,u),r=e.successors(r)[0]}})}function Pq(e,t,r,n){var i=[],s=[],o=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,u;c=r;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||l>t[c].lim));for(u=c,c=n;(c=e.parent(c))!==u;)s.push(c);return{path:i.concat(s.reverse()),lca:u}}function Oq(e){var t={},r=0;function n(i){var s=r;Rv.forEach(e.children(i),n),t[i]={low:s,lim:r++}}return Rv.forEach(e.children(),n),t}var on=Ge,Av=Gt,Dq={run:Lq,cleanup:zq};function Lq(e){var t=Av.addDummyNode(e,"root",{},"_root"),r=Fq(e),n=on.max(on.values(r))-1,i=2*n+1;e.graph().nestingRoot=t,on.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var s=qq(e)+1;on.forEach(e.children(),function(o){ET(e,t,i,s,n,r,o)}),e.graph().nodeRankFactor=i}function ET(e,t,r,n,i,s,o){var l=e.children(o);if(!l.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:r});return}var c=Av.addBorderNode(e,"_bt"),u=Av.addBorderNode(e,"_bb"),d=e.node(o);e.setParent(c,o),d.borderTop=c,e.setParent(u,o),d.borderBottom=u,on.forEach(l,function(f){ET(e,t,r,n,i,s,f);var h=e.node(f),p=h.borderTop?h.borderTop:f,y=h.borderBottom?h.borderBottom:f,g=h.borderTop?n:2*n,w=p!==y?1:i-s[o]+1;e.setEdge(c,p,{weight:g,minlen:w,nestingEdge:!0}),e.setEdge(y,u,{weight:g,minlen:w,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+s[o]})}function Fq(e){var t={};function r(n,i){var s=e.children(n);s&&s.length&&on.forEach(s,function(o){r(o,i+1)}),t[n]=i}return on.forEach(e.children(),function(n){r(n,1)}),t}function qq(e){return on.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function zq(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,on.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var Ym=Ge,$q=Gt,Bq=Hq;function Hq(e){function t(r){var n=e.children(r),i=e.node(r);if(n.length&&Ym.forEach(n,t),Ym.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,o=i.maxRank+1;s<o;++s)Rj(e,"borderLeft","_bl",r,i,s),Rj(e,"borderRight","_br",r,i,s)}}Ym.forEach(e.children(),t)}function Rj(e,t,r,n,i,s){var o={width:0,height:0,rank:s,borderType:t},l=i[t][s-1],c=$q.addDummyNode(e,"border",o,r);i[t][s]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var zr=Ge,Wq={adjust:Uq,undo:Vq};function Uq(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&TT(e)}function Vq(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Gq(e),(t==="lr"||t==="rl")&&(Kq(e),TT(e))}function TT(e){zr.forEach(e.nodes(),function(t){Aj(e.node(t))}),zr.forEach(e.edges(),function(t){Aj(e.edge(t))})}function Aj(e){var t=e.width;e.width=e.height,e.height=t}function Gq(e){zr.forEach(e.nodes(),function(t){Xm(e.node(t))}),zr.forEach(e.edges(),function(t){var r=e.edge(t);zr.forEach(r.points,Xm),zr.has(r,"y")&&Xm(r)})}function Xm(e){e.y=-e.y}function Kq(e){zr.forEach(e.nodes(),function(t){Qm(e.node(t))}),zr.forEach(e.edges(),function(t){var r=e.edge(t);zr.forEach(r.points,Qm),zr.has(r,"x")&&Qm(r)})}function Qm(e){var t=e.x;e.x=e.y,e.y=t}var Xr=Ge,Yq=Xq;function Xq(e){var t={},r=Xr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Xr.max(Xr.map(r,function(l){return e.node(l).rank})),i=Xr.map(Xr.range(n+1),function(){return[]});function s(l){if(!Xr.has(t,l)){t[l]=!0;var c=e.node(l);i[c.rank].push(l),Xr.forEach(e.successors(l),s)}}var o=Xr.sortBy(r,function(l){return e.node(l).rank});return Xr.forEach(o,s),i}var _n=Ge,Qq=Zq;function Zq(e,t){for(var r=0,n=1;n<t.length;++n)r+=Jq(e,t[n-1],t[n]);return r}function Jq(e,t,r){for(var n=_n.zipObject(r,_n.map(r,function(u,d){return d})),i=_n.flatten(_n.map(t,function(u){return _n.sortBy(_n.map(e.outEdges(u),function(d){return{pos:n[d.w],weight:e.edge(d).weight}}),"pos")}),!0),s=1;s<r.length;)s<<=1;var o=2*s-1;s-=1;var l=_n.map(new Array(o),function(){return 0}),c=0;return _n.forEach(i.forEach(function(u){var d=u.pos+s;l[d]+=u.weight;for(var f=0;d>0;)d%2&&(f+=l[d+1]),d=d-1>>1,l[d]+=u.weight;c+=u.weight*f})),c}var Ij=Ge,ez=tz;function tz(e,t){return Ij.map(t,function(r){var n=e.inEdges(r);if(n.length){var i=Ij.reduce(n,function(s,o){var l=e.edge(o),c=e.node(o.v);return{sum:s.sum+l.weight*c.order,weight:s.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:r}})}var Jt=Ge,rz=nz;function nz(e,t){var r={};Jt.forEach(e,function(i,s){var o=r[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};Jt.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),Jt.forEach(t.edges(),function(i){var s=r[i.v],o=r[i.w];!Jt.isUndefined(s)&&!Jt.isUndefined(o)&&(o.indegree++,s.out.push(r[i.w]))});var n=Jt.filter(r,function(i){return!i.indegree});return iz(n)}function iz(e){var t=[];function r(s){return function(o){o.merged||(Jt.isUndefined(o.barycenter)||Jt.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&sz(s,o)}}function n(s){return function(o){o.in.push(s),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),Jt.forEach(i.in.reverse(),r(i)),Jt.forEach(i.out,n(i))}return Jt.map(Jt.filter(t,function(s){return!s.merged}),function(s){return Jt.pick(s,["vs","i","barycenter","weight"])})}function sz(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var go=Ge,oz=Gt,az=lz;function lz(e,t){var r=oz.partition(e,function(d){return go.has(d,"barycenter")}),n=r.lhs,i=go.sortBy(r.rhs,function(d){return-d.i}),s=[],o=0,l=0,c=0;n.sort(cz(!!t)),c=Mj(s,i,c),go.forEach(n,function(d){c+=d.vs.length,s.push(d.vs),o+=d.barycenter*d.weight,l+=d.weight,c=Mj(s,i,c)});var u={vs:go.flatten(s,!0)};return l&&(u.barycenter=o/l,u.weight=l),u}function Mj(e,t,r){for(var n;t.length&&(n=go.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function cz(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var In=Ge,uz=ez,dz=rz,fz=az,pz=RT;function RT(e,t,r,n){var i=e.children(t),s=e.node(t),o=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,c={};o&&(i=In.filter(i,function(y){return y!==o&&y!==l}));var u=uz(e,i);In.forEach(u,function(y){if(e.children(y.v).length){var g=RT(e,y.v,r,n);c[y.v]=g,In.has(g,"barycenter")&&mz(y,g)}});var d=dz(u,r);hz(d,c);var f=fz(d,n);if(o&&(f.vs=In.flatten([o,f.vs,l],!0),e.predecessors(o).length)){var h=e.node(e.predecessors(o)[0]),p=e.node(e.predecessors(l)[0]);In.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+h.order+p.order)/(f.weight+2),f.weight+=2}return f}function hz(e,t){In.forEach(e,function(r){r.vs=In.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function mz(e,t){In.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var vo=Ge,gz=Mr.Graph,vz=xz;function xz(e,t,r){var n=yz(e),i=new gz({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(s){return e.node(s)});return vo.forEach(e.nodes(),function(s){var o=e.node(s),l=e.parent(s);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(s),i.setParent(s,l||n),vo.forEach(e[r](s),function(c){var u=c.v===s?c.w:c.v,d=i.edge(u,s),f=vo.isUndefined(d)?0:d.weight;i.setEdge(u,s,{weight:e.edge(c).weight+f})}),vo.has(o,"minRank")&&i.setNode(s,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function yz(e){for(var t;e.hasNode(t=vo.uniqueId("_root")););return t}var bz=Ge,wz=_z;function _z(e,t,r){var n={},i;bz.forEach(r,function(s){for(var o=e.parent(s),l,c;o;){if(l=e.parent(o),l?(c=n[l],n[l]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=l}})}var Un=Ge,jz=Yq,Sz=Qq,kz=pz,Cz=vz,Nz=wz,Ez=Mr.Graph,Pj=Gt,Tz=Rz;function Rz(e){var t=Pj.maxRank(e),r=Oj(e,Un.range(1,t+1),"inEdges"),n=Oj(e,Un.range(t-1,-1,-1),"outEdges"),i=jz(e);Dj(e,i);for(var s=Number.POSITIVE_INFINITY,o,l=0,c=0;c<4;++l,++c){Az(l%2?r:n,l%4>=2),i=Pj.buildLayerMatrix(e);var u=Sz(e,i);u<s&&(c=0,o=Un.cloneDeep(i),s=u)}Dj(e,o)}function Oj(e,t,r){return Un.map(t,function(n){return Cz(e,n,r)})}function Az(e,t){var r=new Ez;Un.forEach(e,function(n){var i=n.graph().root,s=kz(n,i,r,t);Un.forEach(s.vs,function(o,l){n.node(o).order=l}),Nz(n,r,s.vs)})}function Dj(e,t){Un.forEach(t,function(r){Un.forEach(r,function(n,i){e.node(n).order=i})})}var ge=Ge,Iz=Mr.Graph,Mz=Gt,Pz={positionX:Uz};function Oz(e,t){var r={};function n(i,s){var o=0,l=0,c=i.length,u=ge.last(s);return ge.forEach(s,function(d,f){var h=Lz(e,d),p=h?e.node(h).order:c;(h||d===u)&&(ge.forEach(s.slice(l,f+1),function(y){ge.forEach(e.predecessors(y),function(g){var w=e.node(g),v=w.order;(v<o||p<v)&&!(w.dummy&&e.node(y).dummy)&&AT(r,g,y)})}),l=f+1,o=p)}),s}return ge.reduce(t,n),r}function Dz(e,t){var r={};function n(s,o,l,c,u){var d;ge.forEach(ge.range(o,l),function(f){d=s[f],e.node(d).dummy&&ge.forEach(e.predecessors(d),function(h){var p=e.node(h);p.dummy&&(p.order<c||p.order>u)&&AT(r,h,d)})})}function i(s,o){var l=-1,c,u=0;return ge.forEach(o,function(d,f){if(e.node(d).dummy==="border"){var h=e.predecessors(d);h.length&&(c=e.node(h[0]).order,n(o,u,f,l,c),u=f,l=c)}n(o,u,o.length,c,s.length)}),o}return ge.reduce(t,i),r}function Lz(e,t){if(e.node(t).dummy)return ge.find(e.predecessors(t),function(r){return e.node(r).dummy})}function AT(e,t,r){if(t>r){var n=t;t=r,r=n}var i=e[t];i||(e[t]=i={}),i[r]=!0}function Fz(e,t,r){if(t>r){var n=t;t=r,r=n}return ge.has(e[t],r)}function qz(e,t,r,n){var i={},s={},o={};return ge.forEach(t,function(l){ge.forEach(l,function(c,u){i[c]=c,s[c]=c,o[c]=u})}),ge.forEach(t,function(l){var c=-1;ge.forEach(l,function(u){var d=n(u);if(d.length){d=ge.sortBy(d,function(g){return o[g]});for(var f=(d.length-1)/2,h=Math.floor(f),p=Math.ceil(f);h<=p;++h){var y=d[h];s[u]===u&&c<o[y]&&!Fz(r,u,y)&&(s[y]=u,s[u]=i[u]=i[y],c=o[y])}}})}),{root:i,align:s}}function zz(e,t,r,n,i){var s={},o=$z(e,t,r,i),l=i?"borderLeft":"borderRight";function c(f,h){for(var p=o.nodes(),y=p.pop(),g={};y;)g[y]?f(y):(g[y]=!0,p.push(y),p=p.concat(h(y))),y=p.pop()}function u(f){s[f]=o.inEdges(f).reduce(function(h,p){return Math.max(h,s[p.v]+o.edge(p))},0)}function d(f){var h=o.outEdges(f).reduce(function(y,g){return Math.min(y,s[g.w]-o.edge(g))},Number.POSITIVE_INFINITY),p=e.node(f);h!==Number.POSITIVE_INFINITY&&p.borderType!==l&&(s[f]=Math.max(s[f],h))}return c(u,o.predecessors.bind(o)),c(d,o.successors.bind(o)),ge.forEach(n,function(f){s[f]=s[r[f]]}),s}function $z(e,t,r,n){var i=new Iz,s=e.graph(),o=Vz(s.nodesep,s.edgesep,n);return ge.forEach(t,function(l){var c;ge.forEach(l,function(u){var d=r[u];if(i.setNode(d),c){var f=r[c],h=i.edge(f,d);i.setEdge(f,d,Math.max(o(e,u,c),h||0))}c=u})}),i}function Bz(e,t){return ge.minBy(ge.values(t),function(r){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return ge.forIn(r,function(s,o){var l=Gz(e,o)/2;n=Math.max(s+l,n),i=Math.min(s-l,i)}),n-i})}function Hz(e,t){var r=ge.values(t),n=ge.min(r),i=ge.max(r);ge.forEach(["u","d"],function(s){ge.forEach(["l","r"],function(o){var l=s+o,c=e[l],u;if(c!==t){var d=ge.values(c);u=o==="l"?n-ge.min(d):i-ge.max(d),u&&(e[l]=ge.mapValues(c,function(f){return f+u}))}})})}function Wz(e,t){return ge.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var i=ge.sortBy(ge.map(e,n));return(i[1]+i[2])/2})}function Uz(e){var t=Mz.buildLayerMatrix(e),r=ge.merge(Oz(e,t),Dz(e,t)),n={},i;ge.forEach(["u","d"],function(o){i=o==="u"?t:ge.values(t).reverse(),ge.forEach(["l","r"],function(l){l==="r"&&(i=ge.map(i,function(f){return ge.values(f).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),u=qz(e,i,r,c),d=zz(e,i,u.root,u.align,l==="r");l==="r"&&(d=ge.mapValues(d,function(f){return-f})),n[o+l]=d})});var s=Bz(e,n);return Hz(n,s),Wz(n,e.graph().align)}function Vz(e,t,r){return function(n,i,s){var o=n.node(i),l=n.node(s),c=0,u;if(c+=o.width/2,ge.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":u=-o.width/2;break;case"r":u=o.width/2;break}if(u&&(c+=r?u:-u),u=0,c+=(o.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,ge.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":u=l.width/2;break;case"r":u=-l.width/2;break}return u&&(c+=r?u:-u),u=0,c}}function Gz(e,t){return e.node(t).width}var xo=Ge,IT=Gt,Kz=Pz.positionX,Yz=Xz;function Xz(e){e=IT.asNonCompoundGraph(e),Qz(e),xo.forEach(Kz(e),function(t,r){e.node(r).x=t})}function Qz(e){var t=IT.buildLayerMatrix(e),r=e.graph().ranksep,n=0;xo.forEach(t,function(i){var s=xo.max(xo.map(i,function(o){return e.node(o).height}));xo.forEach(i,function(o){e.node(o).y=n+s/2}),n+=s+r})}var we=Ge,Lj=$F,Fj=iq,Zz=Eq,Jz=Gt.normalizeRanks,e$=Iq,t$=Gt.removeEmptyRanks,qj=Dq,r$=Bq,zj=Wq,n$=Tz,i$=Yz,Yn=Gt,s$=Mr.Graph,o$=a$;function a$(e,t){var r=t&&t.debugTiming?Yn.time:Yn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return x$(e)});r("  runLayout",function(){l$(n,r)}),r("  updateInputGraph",function(){c$(e,n)})})}function l$(e,t){t("    makeSpaceForEdgeLabels",function(){y$(e)}),t("    removeSelfEdges",function(){E$(e)}),t("    acyclic",function(){Lj.run(e)}),t("    nestingGraph.run",function(){qj.run(e)}),t("    rank",function(){Zz(Yn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){b$(e)}),t("    removeEmptyRanks",function(){t$(e)}),t("    nestingGraph.cleanup",function(){qj.cleanup(e)}),t("    normalizeRanks",function(){Jz(e)}),t("    assignRankMinMax",function(){w$(e)}),t("    removeEdgeLabelProxies",function(){_$(e)}),t("    normalize.run",function(){Fj.run(e)}),t("    parentDummyChains",function(){e$(e)}),t("    addBorderSegments",function(){r$(e)}),t("    order",function(){n$(e)}),t("    insertSelfEdges",function(){T$(e)}),t("    adjustCoordinateSystem",function(){zj.adjust(e)}),t("    position",function(){i$(e)}),t("    positionSelfEdges",function(){R$(e)}),t("    removeBorderNodes",function(){N$(e)}),t("    normalize.undo",function(){Fj.undo(e)}),t("    fixupEdgeLabelCoords",function(){k$(e)}),t("    undoCoordinateSystem",function(){zj.undo(e)}),t("    translateGraph",function(){j$(e)}),t("    assignNodeIntersects",function(){S$(e)}),t("    reversePoints",function(){C$(e)}),t("    acyclic.undo",function(){Lj.undo(e)})}function c$(e,t){we.forEach(e.nodes(),function(r){var n=e.node(r),i=t.node(r);n&&(n.x=i.x,n.y=i.y,t.children(r).length&&(n.width=i.width,n.height=i.height))}),we.forEach(e.edges(),function(r){var n=e.edge(r),i=t.edge(r);n.points=i.points,we.has(i,"x")&&(n.x=i.x,n.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var u$=["nodesep","edgesep","ranksep","marginx","marginy"],d$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},f$=["acyclicer","ranker","rankdir","align"],p$=["width","height"],h$={width:0,height:0},m$=["minlen","weight","width","height","labeloffset"],g$={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},v$=["labelpos"];function x$(e){var t=new s$({multigraph:!0,compound:!0}),r=Jm(e.graph());return t.setGraph(we.merge({},d$,Zm(r,u$),we.pick(r,f$))),we.forEach(e.nodes(),function(n){var i=Jm(e.node(n));t.setNode(n,we.defaults(Zm(i,p$),h$)),t.setParent(n,e.parent(n))}),we.forEach(e.edges(),function(n){var i=Jm(e.edge(n));t.setEdge(n,we.merge({},g$,Zm(i,m$),we.pick(i,v$)))}),t}function y$(e){var t=e.graph();t.ranksep/=2,we.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function b$(e){we.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-n.rank)/2+n.rank,e:t};Yn.addDummyNode(e,"edge-proxy",s,"_ep")}})}function w$(e){var t=0;we.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=we.max(t,n.maxRank))}),e.graph().maxRank=t}function _$(e){we.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function j$(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,i=0,s=e.graph(),o=s.marginx||0,l=s.marginy||0;function c(u){var d=u.x,f=u.y,h=u.width,p=u.height;t=Math.min(t,d-h/2),r=Math.max(r,d+h/2),n=Math.min(n,f-p/2),i=Math.max(i,f+p/2)}we.forEach(e.nodes(),function(u){c(e.node(u))}),we.forEach(e.edges(),function(u){var d=e.edge(u);we.has(d,"x")&&c(d)}),t-=o,n-=l,we.forEach(e.nodes(),function(u){var d=e.node(u);d.x-=t,d.y-=n}),we.forEach(e.edges(),function(u){var d=e.edge(u);we.forEach(d.points,function(f){f.x-=t,f.y-=n}),we.has(d,"x")&&(d.x-=t),we.has(d,"y")&&(d.y-=n)}),s.width=r-t+o,s.height=i-n+l}function S$(e){we.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),i=e.node(t.w),s,o;r.points?(s=r.points[0],o=r.points[r.points.length-1]):(r.points=[],s=i,o=n),r.points.unshift(Yn.intersectRect(n,s)),r.points.push(Yn.intersectRect(i,o))})}function k$(e){we.forEach(e.edges(),function(t){var r=e.edge(t);if(we.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function C$(e){we.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function N$(e){we.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),i=e.node(r.borderBottom),s=e.node(we.last(r.borderLeft)),o=e.node(we.last(r.borderRight));r.width=Math.abs(o.x-s.x),r.height=Math.abs(i.y-n.y),r.x=s.x+r.width/2,r.y=n.y+r.height/2}}),we.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function E$(e){we.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function T$(e){var t=Yn.buildLayerMatrix(e);we.forEach(t,function(r){var n=0;we.forEach(r,function(i,s){var o=e.node(i);o.order=s+n,we.forEach(o.selfEdges,function(l){Yn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:o.rank,order:s+ ++n,e:l.e,label:l.label},"_se")}),delete o.selfEdges})})}function R$(e){we.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),i=n.x+n.width/2,s=n.y,o=r.x-i,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:i+2*o/3,y:s-l},{x:i+5*o/6,y:s-l},{x:i+o,y:s},{x:i+5*o/6,y:s+l},{x:i+2*o/3,y:s+l}],r.label.x=r.x,r.label.y=r.y}})}function Zm(e,t){return we.mapValues(we.pick(e,t),Number)}function Jm(e){var t={};return we.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var nl=Ge,A$=Gt,I$=Mr.Graph,M$={debugOrdering:P$};function P$(e){var t=A$.buildLayerMatrix(e),r=new I$({compound:!0,multigraph:!0}).setGraph({});return nl.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),nl.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),nl.forEach(t,function(n,i){var s="layer"+i;r.setNode(s,{rank:"same"}),nl.reduce(n,function(o,l){return r.setEdge(o,l,{style:"invis"}),l})}),r}var O$="0.8.5",D$={graphlib:Mr,layout:o$,debug:M$,util:{time:Gt.time,notime:Gt.notime},version:O$};const uc=Bv(D$),$j=(e,t)=>{const r=new uc.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),uc.layout(r),{nodes:e.map(n=>{const i=r.node(n.id);return{...n,targetPosition:se.Top,sourcePosition:se.Bottom,position:{x:i.x-(n.data.width??280)/2,y:i.y-(n.data.height??90)/2}}}),edges:t}},Bj=(e,t,r)=>{let n=[],i=[],s=null,o=null,l=[];const c=r.theme||"industrial";return e.forEach((u,d)=>{var y,g;if((u.level||1)!==1)return;const f=280;let h=95;u.state==="active"&&u.stations&&(h+=35);const p=t===u.id;if(n.push({id:u.id,type:"documentNode",data:{...u,width:f,height:h,isExpanded:p,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:p?1e3:0}),s){const w=(y=e[d-1])==null?void 0:y.state;i.push({id:"e-"+s+"-"+u.id,source:s,target:u.id,type:"smoothstep",animated:w==="active",style:{stroke:mE(w,c),strokeWidth:3}})}((g=u.children)==null?void 0:g.length)>0&&(o=u.id,l=u.children),s=u.id}),{nodes:n,edges:i,epicBacklogId:o,epicChildren:l}},Hj=(e,t,r,n,i)=>{const{nodes:s,edges:o}=e;if(!t||!r.length)return{nodes:s,edges:o};const l=s.find(b=>b.id===t);if(!l)return{nodes:s,edges:o};const c=l.position.x,u=l.position.y+(l.data.height||95),d=l.data.state,f=i.theme||"industrial",h=mE(d,f),p=d==="active",y=br.EPIC_HEIGHT+br.EPIC_GAP_Y,g=Math.ceil(r.length/br.EPICS_PER_ROW),w=c+280*.15,v=50,x={};r.forEach((b,_)=>{const j=Math.floor(_/br.EPICS_PER_ROW);x[j]||(x[j]=[]),x[j].push({epic:b,idx:_})});for(let b=0;b<g;b++){const _=x[b]||[];if(_.length===0)continue;const j=u+br.EPIC_OFFSET_Y+b*y,S=`junction-row-${b}`;s.push({id:S,type:"waypoint",position:{x:w,y:j-v},draggable:!1,connectable:!1,selectable:!1}),b===0?o.push({id:`e-spine-drop-${b}`,source:t,target:S,type:"straight",animated:p,style:{stroke:h,strokeWidth:2}}):o.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:S,type:"straight",animated:p,style:{stroke:h,strokeWidth:2}}),_.forEach(({epic:C,idx:E})=>{const k=E%br.EPICS_PER_ROW,R=c+br.EPIC_OFFSET_X+k*(br.EPIC_WIDTH+br.EPIC_GAP_X),T=j,I=n===C.id;s.push({id:C.id,type:"documentNode",data:{...C,width:br.EPIC_WIDTH,height:br.EPIC_HEIGHT,isExpanded:I,...i},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:se.Top,sourcePosition:se.Bottom,zIndex:I?1e3:0}),o.push({id:`e-branch-${C.id}`,source:S,target:C.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:p,style:{stroke:h,strokeWidth:2}})})}return{nodes:s,edges:o}},L$={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},Wj={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function F$(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function q$(e,t=[]){const r=[],n=[],i={};for(const s of e.tracks){const o=z$(s,t);if((s.scope||"project")==="project")n.push({...o,mayOwn:s.may_own||[],childDocType:s.child_doc_type});else{const c=s.document_type;i[c]||(i[c]=[]),i[c].push(o)}}for(const s of n)s.childDocType&&i[s.childDocType]&&(s.children=i[s.childDocType].map(o=>({...o,level:2}))),r.push(s);return r}function z$(e,t=[]){const r=L$[e.state]||"ready_for_production",n=e.state==="awaiting_operator",i=t.find(l=>l.document_type===e.document_type);let s=null;(r==="in_production"||n)&&(s=$$(e.stations,e.state,e.station));let o=null;return i&&i.questions&&(o=i.questions.map((l,c)=>({id:l.id||`q${c+1}`,text:l.question||l.text||l,required:l.required!==!1}))),{id:e.document_type,name:e.document_name||B$(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:s,questions:o,interruptId:i==null?void 0:i.id,blockedBy:e.blocked_by||[]}}function $$(e,t,r){if(!e||e.length===0){const n=r||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return sd.map(i=>({id:i,label:Wj[i]||i.toUpperCase(),state:n===i?"active":sd.indexOf(i)<sd.indexOf(n)?"complete":"pending",needs_input:i==="pgc"&&t==="awaiting_operator"}))}return e.map(n=>({id:n.station,label:Wj[n.station]||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function B$(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function H$({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,i]=m.useState(!0),[s,o]=m.useState(null),l=m.useCallback(async()=>{i(!0),o(null);try{const u=await Ue.getProjects({includeArchived:e}),d=F$(u);r(d)}catch(u){o(u.message),console.error("Failed to fetch projects:",u)}finally{i(!1)}},[e]),c=m.useCallback(async u=>{try{const d=await Ue.createProject({name:u,description:""});return r(f=>({...f,[d.id]:{id:d.id,projectId:d.project_id,name:d.name,description:d.description||"",status:"active",icon:d.icon,createdAt:d.created_at}})),d}catch(d){throw o(d.message),console.error("Failed to create project:",d),d}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:s,addProject:c,refresh:l}}function W$(e){const[t,r]=m.useState([]),[n,i]=m.useState("idle"),[s,o]=m.useState([]),[l,c]=m.useState(!0),[u,d]=m.useState(null),[f,h]=m.useState(!1),p=m.useRef(null),y=m.useRef(null),g=m.useCallback(async()=>{if(e)try{c(!0),d(null);const[_,j]=await Promise.all([Ue.getProductionStatus(e),Ue.getProjectInterrupts(e).catch(()=>[])]);o(j),i(_.line_state),r(q$(_,j))}catch(_){d(_.message),console.error("Failed to fetch production status:",_)}finally{c(!1)}},[e]),w=m.useCallback(()=>{if(!e)return;p.current&&p.current.close();const _=s6(e);p.current=_,_.addEventListener("connected",()=>{h(!0),d(null),console.log(`SSE connected for project ${e}`)}),_.addEventListener("station_transition",j=>{try{const S=JSON.parse(j.data);console.log("Station transition:",S),g()}catch(S){console.error("Failed to parse station_transition:",S)}}),_.addEventListener("line_stopped",j=>{try{const S=JSON.parse(j.data);console.log("Line stopped:",S),i("stopped"),g()}catch(S){console.error("Failed to parse line_stopped:",S)}}),_.addEventListener("production_complete",j=>{try{const S=JSON.parse(j.data);console.log("Production complete:",S),i("complete"),g()}catch(S){console.error("Failed to parse production_complete:",S)}}),_.addEventListener("interrupt_resolved",j=>{try{const S=JSON.parse(j.data);console.log("Interrupt resolved:",S),g()}catch(S){console.error("Failed to parse interrupt_resolved:",S)}}),_.addEventListener("track_started",j=>{try{const S=JSON.parse(j.data);console.log("Track started:",S),i("active"),g()}catch(S){console.error("Failed to parse track_started:",S)}}),_.onerror=j=>{console.error("SSE error:",j),h(!1),d("Connection lost"),_.close(),y.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),w()},3e3)}},[e,g]),v=m.useCallback(()=>{y.current&&clearTimeout(y.current),p.current&&(p.current.close(),p.current=null),h(!1)},[]),x=m.useCallback(async(_,j)=>{try{await Ue.resolveInterrupt(_,{answers:j}),await g()}catch(S){throw console.error("Failed to resolve interrupt:",S),S}},[g]),b=m.useCallback(async(_=null)=>{try{await Ue.startProduction(e,_),i("active"),await g()}catch(j){throw console.error("Failed to start production:",j),j}},[e,g]);return m.useEffect(()=>(g(),w(),()=>v()),[g,w,v]),{data:t,lineState:n,interrupts:s,loading:l,error:u,connected:f,refresh:g,resolveInterrupt:x,startProduction:b}}const Uj="combine-theme";function MT(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const s=localStorage.getItem(Uj);return s&&An.includes(s)?s:e});m.useEffect(()=>{localStorage.setItem(Uj,t)},[t]);const n=m.useCallback(s=>{An.includes(s)&&r(s)},[]),i=m.useCallback(()=>{r(s=>{const o=An.indexOf(s);return An[(o+1)%An.length]})},[]);return{theme:t,setTheme:n,cycleTheme:i}}function U$(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[i,s]=m.useState([]),[o,l]=m.useState(null),[c,u]=m.useState(null),[d,f]=m.useState({}),[h,p]=m.useState(0),[y,g]=m.useState([]),[w,v]=m.useState(!1),[x,b]=m.useState(null),[_,j]=m.useState(null),[S,C]=m.useState(null),[E,k]=m.useState(!1),[R,T]=m.useState(!1),I=m.useRef(null),F=m.useRef(!0);m.useEffect(()=>(F.current=!0,()=>{F.current=!1,I.current&&I.current.close()}),[]);const N=m.useCallback(M=>{F.current&&(n(M.phase),s(M.messages||[]),l(M.pending_prompt),u(M.pending_choices),f(M.interpretation||{}),p(M.confidence||0),g(M.missing_fields||[]),v(M.can_initialize||!1),b(M.gate_outcome),j(M.project))},[]),P=m.useCallback(async()=>{C(null),k(!0);try{const M=await Ue.startIntake();if(!F.current)return;t(M.execution_id),n(M.phase||"describe"),l(M.pending_prompt),s([]),f({}),j(null),b(null)}catch(M){if(!F.current)return;C(M.message||"Failed to start intake")}finally{F.current&&k(!1)}},[]),O=m.useCallback(async M=>{if(!e||!M.trim())return;C(null),T(!0);const $={role:"user",content:M};s(W=>[...W,$]);try{const W=await Ue.submitIntakeMessage(e,M);if(!F.current)return;N(W)}catch(W){if(!F.current)return;s(B=>B.filter(Y=>Y!==$)),C(W.message||"Failed to submit message")}finally{F.current&&T(!1)}},[e,N]),H=m.useCallback(async(M,$)=>{if(e){C(null),f(W=>({...W,[M]:{value:$,source:"user",locked:!0}}));try{const W=await Ue.updateIntakeField(e,M,$);if(!F.current)return;N(W)}catch(W){if(!F.current)return;C(W.message||"Failed to update field");const B=await Ue.getIntakeState(e);F.current&&N(B)}}},[e,N]),D=m.useCallback(async()=>{if(!(!e||!w)){C(null),k(!0);try{const M=await Ue.initializeIntake(e);if(!F.current)return;N(M),M.phase==="generating"&&A()}catch(M){if(!F.current)return;C(M.message||"Failed to initialize project"),k(!1)}}},[e,w,N]),A=m.useCallback(()=>{I.current&&I.current.close();const M=o6(e);I.current=M,M.addEventListener("started",$=>{if(!F.current)return;const W=JSON.parse($.data);console.log("Intake started:",W)}),M.addEventListener("progress",$=>{if(!F.current)return;const W=JSON.parse($.data);console.log("Intake progress:",W.current_node)}),M.addEventListener("complete",async $=>{if(!F.current)return;const W=JSON.parse($.data);console.log("Intake complete:",W),M.close(),I.current=null,n("complete"),b(W.gate_outcome),j(W.project),k(!1)}),M.addEventListener("error",$=>{if(F.current&&M.readyState!==EventSource.CLOSED){try{const W=JSON.parse($.data);C(W.message||"Generation failed")}catch{C("Connection lost during generation")}M.close(),I.current=null,k(!1)}}),M.onerror=()=>{F.current&&M.readyState===EventSource.CLOSED&&(I.current=null,k(!1))}},[e]),L=m.useCallback(()=>{I.current&&(I.current.close(),I.current=null),t(null),n("idle"),s([]),l(null),u(null),f({}),p(0),g([]),v(!1),b(null),j(null),C(null),k(!1),T(!1)},[]);return{executionId:e,phase:r,messages:i,pendingPrompt:o,pendingChoices:c,interpretation:d,confidence:h,missingFields:y,canInitialize:w,gateOutcome:x,project:_,error:S,loading:E,submitting:R,startIntake:P,submitMessage:O,updateField:H,lockAndGenerate:D,reset:L}}const PT=m.createContext(null);function V$({children:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{i(!0),o(null);try{const f=await Ue.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),o(f.message),r(null)}finally{i(!1)}},[]),c=m.useCallback(f=>{window.location.href=a6(f)},[]),u=m.useCallback(async()=>{try{await Ue.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),d={user:t,loading:n,error:s,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:u,checkAuth:l};return a.jsx(PT.Provider,{value:d,children:e})}function Ls(){const e=m.useContext(PT);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function G$(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useCallback(async()=>{s(!0),l(null);try{let d=await ke.getCurrentWorkspace();d||(d=await ke.createWorkspace()),t(d.workspace_id),n(d.branch)}catch(d){l(d.message),console.error("Failed to initialize workspace:",d)}finally{s(!1)}},[]),u=m.useCallback(async(d=!1)=>{if(e)try{await ke.closeWorkspace(e,d),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:i,error:o,closeWorkspace:u,reinitialize:c}}function K$(e,t=1e4){var d,f;const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useRef(null),u=m.useCallback(async()=>{if(!e){n(null),s(!1);return}try{const h=await ke.getWorkspaceState(e);n(h),l(null)}catch(h){l(h.message),console.error("Failed to fetch workspace state:",h)}finally{s(!1)}},[e]);return m.useEffect(()=>{e&&(s(!0),u())},[e,u]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(u,t),()=>{c.current&&clearInterval(c.current)}},[e,t,u]),{state:r,loading:i,error:o,refresh:u,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((d=r==null?void 0:r.tier1)==null?void 0:d.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function Y$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await ke.getDocumentTypes();t(l.document_types||[])}catch(l){s(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{documentTypes:e,loading:r,error:i,refresh:o}}function X$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await ke.getRoles();t(l.roles||[])}catch(l){s(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{roles:e,loading:r,error:i,refresh:o}}function Sa(e,t,{debounceMs:r=500,onSave:n}={}){const[i,s]=m.useState(""),[o,l]=m.useState(""),[c,u]=m.useState(!0),[d,f]=m.useState(null),[h,p]=m.useState(!1),[y,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){s(""),l(""),u(!1);return}u(!0),f(null);try{const E=await ke.getArtifact(e,t);s(E.content),l(E.content)}catch(E){f(E.message),console.error("Failed to load artifact:",E)}finally{u(!1)}},[e,t]),b=m.useCallback(async E=>{if(!(!e||!t)){p(!0),f(null);try{const k=await ke.writeArtifact(e,t,E);g(k),l(E),n&&n(k)}catch(k){f(k.message),console.error("Failed to save artifact:",k)}finally{p(!1)}}},[e,t,n]),_=m.useCallback(E=>{v.current=E,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),j=m.useCallback(E=>{s(E),E!==o&&_(E)},[o,_]),S=m.useCallback(()=>{w.current&&clearTimeout(w.current),v.current=null,s(o)},[o]),C=m.useCallback(()=>{w.current&&clearTimeout(w.current),i!==o&&b(i)},[i,o,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{content:i,originalContent:o,loading:c,error:d,saving:h,lastSaveResult:y,isDirty:i!==o,updateContent:j,reset:S,saveNow:C,reload:x}}const Q$={documentNode:T6,waypoint:R6},Z$={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function J$({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:i,theme:s,onThemeChange:o,onProjectUpdate:l,onProjectArchive:c,onProjectUnarchive:u,onProjectDelete:d}){const{data:f,lineState:h,loading:p,error:y,connected:g,resolveInterrupt:w}=W$(e),[v,x]=m.useState([]),[b,_]=m.useState(null),[j,S]=m.useState(null),[C,E]=m.useState(null),[k,R]=m.useState(!1),[T,I]=m.useState(""),[F,N]=m.useState(!1),[P,O]=m.useState(!1),[H,D]=m.useState(!1),A=Vc();m.useEffect(()=>{f.length>0&&x(f)},[f]),m.useEffect(()=>{i&&v.length>0&&setTimeout(()=>{_(i),S("questions")},300)},[i,v.length]),m.useEffect(()=>{_(null),S(null)},[e]);const L=m.useCallback(()=>{const K=An.indexOf(s);o(An[(K+1)%An.length])},[s,o]),M=m.useCallback(()=>{I(r||""),R(!0)},[r]),$=m.useCallback(async()=>{if(!T.trim()||T===r){R(!1);return}O(!0);try{await l(e,{name:T.trim()}),R(!1)}catch(K){console.error("Failed to update name:",K)}finally{O(!1)}},[T,r,e,l]),W=m.useCallback(()=>{R(!1),I("")},[]),B=m.useCallback(async()=>{O(!0);try{n?await u(e):await c(e)}catch(K){console.error("Failed to toggle archive:",K)}finally{O(!1)}},[e,n,c,u]),Y=m.useCallback(async()=>{O(!0);try{await d(e),N(!1)}catch(K){console.error("Failed to delete:",K)}finally{O(!1)}},[e,d]),Z=m.useCallback(K=>{const X=A.getNode(K);if(X){const me=window.innerWidth,ye=-X.position.x*.9+me/2-400,ve=-X.position.y*.9+120;A.setViewport({x:ye,y:ve,zoom:.9},{duration:800})}},[A]),ie=m.useMemo(()=>({onExpand:(K,X)=>{_(K),S(X)},onCollapse:()=>{_(null),S(null),setTimeout(()=>A.fitView({padding:.2,duration:300}),50)},onViewFullDocument:K=>{E(K)},onSubmitQuestions:async(K,X)=>{console.log("Submitted:",K,X);const fe=v.find(me=>me.id===K);if(fe!=null&&fe.interruptId)try{await w(fe.interruptId,X)}catch(me){console.error("Failed to submit answers:",me)}_(null),S(null),x(me=>{const ye=ve=>ve.map(he=>he.id===K&&he.stations?{...he,stations:he.stations.map(be=>be.id==="pgc"?{...be,state:"complete",needs_input:!1}:be.id==="asm"?{...be,state:"active"}:be)}:he.children?{...he,children:ye(he.children)}:he);return ye(me)})}}),[A,v,w]),{layoutNodes:re,layoutEdges:de}=m.useMemo(()=>{if(v.length===0)return{layoutNodes:[],layoutEdges:[]};const K={...ie,expandType:j,theme:s,onZoomToNode:Z,projectId:e,projectCode:t},{nodes:X,edges:fe,epicBacklogId:me,epicChildren:ye}=Bj(v,b,K),ve=$j(X,fe),{nodes:he,edges:be}=Hj(ve,me,ye,b,K);return{layoutNodes:he.map(Se=>({...Se,data:{...Se.data,expandType:Se.id===b?j:null}})),layoutEdges:be}},[v,b,j,ie,s,Z,e,t]),[ee,_e,ue]=uE(re),[Te,pe,te]=dE(de);m.useEffect(()=>{if(v.length===0)return;const K={...ie,expandType:j,theme:s,onZoomToNode:Z,projectId:e,projectCode:t},{nodes:X,edges:fe,epicBacklogId:me,epicChildren:ye}=Bj(v,b,K),ve=$j(X,fe),{nodes:he,edges:be}=Hj(ve,me,ye,b,K),Fe=he.map(Se=>({...Se,data:{...Se.data,expandType:Se.id===b?j:null}}));_e(Fe),pe(be)},[v,b,j,ie,_e,pe,s,Z,e,t]);const xe=m.useCallback((K,X)=>{},[]);return p&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):y&&v.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:a.jsx("p",{className:"text-red-500 mb-4",children:y})})}):a.jsxs("div",{className:"w-full h-full",children:[a.jsxs(Zx,{nodes:ee,edges:Te,onNodesChange:ue,onEdgesChange:te,onNodeClick:xe,nodeTypes:Q$,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[a.jsx(Hn,{position:"top-left",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),a.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[h==="active"&&a.jsx("span",{className:"text-amber-500",children:" Active"}),h==="stopped"&&a.jsx("span",{className:"text-red-500",children:" Stopped"}),h==="complete"&&a.jsx("span",{className:"text-emerald-500",children:" Complete"}),h==="idle"&&a.jsx("span",{children:" Idle"}),!g&&a.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),a.jsx("button",{onClick:L,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:Z$[s]})]})}),a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:a.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),k?a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("input",{type:"text",value:T,onChange:K=>I(K.target.value),onKeyDown:K=>{K.key==="Enter"&&$(),K.key==="Escape"&&W()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:P}),a.jsx("button",{onClick:$,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Save",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{onClick:W,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:a.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!k&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:M,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{onClick:B,disabled:P,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:a.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&a.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),a.jsx("button",{onClick:()=>N(!0),disabled:P||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[a.jsxs("button",{onClick:()=>D(!H),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[a.jsx("span",{children:"Workflow"}),a.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:H?"":""})]}),H&&a.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:a.jsx(D6,{projectId:e})})]})]})}),a.jsx(hE,{position:"top-right",nodeColor:K=>{var fe;const X=(fe=K.data)==null?void 0:fe.state;return["produced","stabilized","ready"].includes(X)?"#10b981":["in_production","active"].includes(X)?"#f59e0b":["requirements_not_met","blocked"].includes(X)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hn,{position:"bottom-left",children:a.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[a.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),a.jsx(Hn,{position:"bottom-right",children:a.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),C&&a.jsx(A6,{projectId:e,projectCode:t,docTypeId:C,onClose:()=>E(null)}),F&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:a.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),a.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",a.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>N(!1),disabled:P,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{onClick:Y,disabled:P,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:P?"Deleting...":"Delete"})]})]})})]})}function il({messages:e,pendingPrompt:t}){const r=m.useRef(null);return m.useEffect(()=>{var n;(n=r.current)==null||n.scrollIntoView({behavior:"smooth"})},[e,t]),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.map((n,i)=>a.jsx("div",{className:`flex ${n.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${n.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:n.content})},i)),t&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),a.jsx("div",{ref:r})]})}function eB({onSubmit:e,disabled:t,placeholder:r}){const[n,i]=m.useState(""),s=m.useRef(null);m.useEffect(()=>{var c;t||(c=s.current)==null||c.focus()},[t]);const o=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),i("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),i(""))};return a.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("textarea",{ref:s,value:n,onChange:c=>i(c.target.value),onKeyDown:o,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),a.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const tB={project_name:"Project Name",problem_statement:"Problem Statement",project_type:"Project Type"},rB=["project_name","problem_statement","project_type"];function nB({interpretation:e,missingFields:t,canInitialize:r,onUpdateField:n,onInitialize:i,loading:s}){const[o,l]=m.useState(null),[c,u]=m.useState(""),d=(p,y)=>{l(p),u(y)},f=async()=>{o&&c.trim()&&(await n(o,c.trim()),l(null),u(""))},h=()=>{l(null),u("")};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Review & Lock"}),t.length>0&&a.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded bg-amber-500/20 text-amber-400",children:[t.length," missing"]})]}),rB.map(p=>{const y=e[p];if(!y)return null;const g=y.locked,w=t.includes(p),v=o===p;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("label",{className:"text-[10px] font-medium",style:{color:"var(--text-muted)"},children:[tB[p]||p,w&&a.jsx("span",{className:"text-amber-400 ml-1",children:"*"})]}),g&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"locked"})]}),v?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:c,onChange:x=>u(x.target.value),onKeyDown:x=>{x.key==="Enter"&&f(),x.key==="Escape"&&h()},autoFocus:!0,className:"flex-1 rounded px-2 py-1.5 text-xs",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:f,className:"px-2 py-1 rounded text-xs bg-emerald-500 text-white",children:"Save"}),a.jsx("button",{onClick:h,className:"px-2 py-1 rounded text-xs",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Cancel"})]}):a.jsx("div",{onClick:()=>!g&&d(p,y.value),className:`rounded px-2 py-1.5 text-xs ${g?"cursor-default":"cursor-pointer hover:bg-white/5"} ${w?"border border-amber-500/50":""}`,style:{background:"var(--bg-input)",color:y.value?"var(--text-primary)":"var(--text-muted)"},children:y.value||"Click to edit..."})]},p)}),a.jsx("button",{onClick:i,disabled:!r||s,className:`w-full py-2.5 rounded-lg text-sm font-medium transition-colors ${r&&!s?"bg-violet-500 text-white hover:bg-violet-400":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:s?"Initializing...":"Lock & Initialize Project"}),!r&&a.jsx("p",{className:"text-[10px] text-center",style:{color:"var(--text-muted)"},children:"Fill all required fields to continue"})]})}function iB(){return a.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[a.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-violet-500/20"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent animate-spin"}),a.jsx("div",{className:"absolute inset-3 rounded-full bg-violet-500/20 animate-pulse"})]}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"Generating Project"}),a.jsx("p",{className:"text-xs text-center max-w-[200px]",style:{color:"var(--text-muted)"},children:"Creating intake document and running quality checks..."}),a.jsxs("div",{className:"flex gap-1 mt-4",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"300ms"}})]})]})}const Vj={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function sB({type:e,className:t}){switch(e){case"check":return a.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 9v4M12 17h.01"}),a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function oB({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const i=Vj[e]||Vj.blocked,s=e==="qualified";return a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:`w-16 h-16 rounded-full ${i.iconBg} flex items-center justify-center mx-auto mb-4`,children:a.jsx(sB,{type:i.icon,className:`w-8 h-8 ${i.iconColor}`})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:i.title}),a.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:i.description}),s&&t&&a.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[a.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),a.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[s&&t&&a.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),a.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function aB({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:i,interpretation:s,missingFields:o,canInitialize:l,gateOutcome:c,project:u,error:d,loading:f,submitting:h,startIntake:p,submitMessage:y,updateField:g,lockAndGenerate:w,reset:v}=U$();m.useEffect(()=>(p(),()=>v()),[]);const x=()=>{v(),e()},b=()=>{u&&t&&t(u),x()},_=()=>{const S=[{id:"describe",label:"Describe"},{id:"review",label:"Review"},{id:"generating",label:"Generate"},{id:"complete",label:"Done"}],C=S.findIndex(E=>E.id===r);return a.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:S.map((E,k)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 py-0.5 rounded ${k===C?"bg-violet-500/30 text-violet-300":k<C?"text-emerald-400":"text-slate-500"}`,children:E.label}),k<S.length-1&&a.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},E.id))})},j=()=>{if(f&&r==="idle")return a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});switch(r){case"describe":return a.jsxs(a.Fragment,{children:[a.jsx(il,{messages:n,pendingPrompt:i}),a.jsx(eB,{onSubmit:y,disabled:h,placeholder:"Describe what you want to build..."})]});case"review":return a.jsxs(a.Fragment,{children:[a.jsx(il,{messages:n}),a.jsx("div",{className:"border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx(nB,{interpretation:s,missingFields:o,canInitialize:l,onUpdateField:g,onInitialize:w,loading:f})})]});case"generating":return a.jsxs(a.Fragment,{children:[a.jsx(il,{messages:n}),a.jsx(iB,{})]});case"complete":return a.jsxs(a.Fragment,{children:[a.jsx(il,{messages:n}),a.jsx(oB,{gateOutcome:c,project:u,onViewProject:b,onClose:x})]});default:return null}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:a.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),_()]})]}),a.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),d&&a.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:d}),j()]})})}function lB({onClose:e}){const{user:t,logout:r,isAdmin:n}=Ls(),[i,s]=m.useState(null),[o,l]=m.useState([]),[c,u]=m.useState(!1),[d,f]=m.useState(null);m.useEffect(()=>{i==="linked"&&h()},[i]);const h=async()=>{try{u(!0);const j=await fetch("/auth/accounts",{credentials:"include"});if(j.ok){const S=await j.json();l(S.identities||[])}}catch(j){console.error("Failed to load accounts:",j)}finally{u(!1)}},p=j=>{window.location.href=`/auth/accounts/link/${j}`},y=async j=>{var S;if(o.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${j} account?`))try{const C=(S=document.cookie.split("; ").find(k=>k.startsWith("csrf=")||k.startsWith("__Host-csrf=")))==null?void 0:S.split("=")[1],E=await fetch(`/auth/accounts/${j}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":C||""}});if(E.ok)f({type:"success",text:"Account unlinked"}),await h();else{const k=await E.json();throw new Error(k.detail||"Failed to unlink")}}catch(C){f({type:"error",text:C.message})}},g=async()=>{await r(),e()},w=j=>{s(i===j?null:j),f(null)},v={google:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},x=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=j=>{const S={user:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),a.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return S[j]||S.user},_=j=>{switch(j){case"account":return a.jsxs("div",{className:"px-4 py-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return a.jsxs("div",{className:"px-4 py-3",children:[d&&a.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${d.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:d.text}),c?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-2 mb-4",children:o.map(S=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[v[S.provider_id],a.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:S.provider_email})]}),a.jsx("button",{onClick:()=>y(S.provider_id),disabled:o.length<=1,className:`text-xs px-2 py-1 rounded ${o.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},S.provider_id))}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),a.jsxs("button",{onClick:()=>p("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.google,"Google"]}),a.jsxs("button",{onClick:()=>p("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.microsoft,"Microsoft"]})]})]})]});default:return a.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),a.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?a.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),a.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),a.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),a.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),a.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),a.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),x.map(j=>a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("button",{onClick:()=>!j.future&&w(j.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${j.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:j.future,children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:b(j.icon)}),a.jsx("span",{className:"flex-1 text-sm text-left",children:j.label}),j.future?a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):a.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:i===j.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),i===j.id&&!j.future&&a.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:_(j.id)})]},j.id))]}),a.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Ae={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function cB(){return a.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Ae.bg,borderColor:Ae.border},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Ae.textPrimary},children:"THE COMBINE"}),a.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Ae.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function uB(){return a.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Ae.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),a.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Ae.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),a.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Ae.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ae.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ae.textMuted,children:["Learn how The Combine works",a.jsx("span",{"aria-hidden":"true",children:""})]})]})}function dB(){const e=[{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return a.jsx("section",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>a.jsxs("div",{className:"flex-1 text-center group",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Ae.bgElevated,border:`1px solid ${Ae.border}`,color:Ae.textMuted},children:t.icon}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Ae.textPrimary},children:t.title}),a.jsx("p",{className:"text-xs",style:{color:Ae.textMuted},children:t.description}),r<e.length-1&&a.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Ae.border}})]},r))})})}function fB(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return a.jsx("section",{className:"text-center",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>a.jsx("span",{className:"text-xs",style:{color:Ae.textMuted},children:t},r))})})}function pB({onLogin:e}){return a.jsxs("section",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Ae.textSecondary},children:"Ready?"}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ae.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ae.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ae.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ae.bg,border:`1px solid ${Ae.border}`,color:Ae.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ae.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ae.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function hB(){return a.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ae.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ae.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ae.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ae.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ae.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ae.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ae.border},children:" 2026 The Combine"})]})}function mB(){const{login:e}=Ls();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ae.bg},children:[a.jsx(cB,{}),a.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:a.jsxs("div",{className:"space-y-12",children:[a.jsx(uB,{}),a.jsx(dB,{}),a.jsx(fB,{}),a.jsx(pB,{onLogin:e})]})}),a.jsx(hB,{})]})}const Ne={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function gB(){return a.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Ne.bg,borderColor:Ne.border},children:[a.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Ne.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ne.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ne.textMuted,children:[a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),a.jsx("span",{className:"text-sm",children:"Back"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),a.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Ne.textPrimary},children:"THE COMBINE"})]}),a.jsx("div",{className:"w-16"})," "]})}function ii({title:e,children:t}){return a.jsxs("section",{className:"mb-16",children:[e&&a.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Ne.textPrimary},children:e}),t]})}function ht({children:e,className:t=""}){return a.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Ne.textSecondary},children:e})}function to({children:e}){return a.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Ne.textPrimary,borderLeft:`2px solid ${Ne.border}`},children:e})}function sl({items:e}){return a.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>a.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Ne.textSecondary},children:[a.jsx("span",{style:{color:Ne.textMuted},children:"-"}),t]},r))})}function ol({number:e,title:t,children:r}){return a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[a.jsxs("span",{className:"text-sm font-mono",style:{color:Ne.textMuted},children:[e,"."]}),a.jsx("h3",{className:"text-base font-medium",style:{color:Ne.textPrimary},children:t})]}),a.jsx("div",{className:"pl-7",children:a.jsx(ht,{children:r})})]})}function al({title:e,children:t}){return a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Ne.textPrimary},children:e}),a.jsx(ht,{className:"mb-0",children:t})]})}function vB({onLogin:e}){return a.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Ne.bgElevated,border:`1px solid ${Ne.border}`},children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Ne.textPrimary},children:"When You're Ready"}),a.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),a.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),a.jsx(ht,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ne.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ne.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ne.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ne.bg,border:`1px solid ${Ne.border}`,color:Ne.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ne.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ne.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function xB(){return a.jsxs("footer",{className:"py-8 text-center",children:[a.jsx("p",{className:"text-sm mb-6",style:{color:Ne.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ne.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ne.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ne.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ne.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ne.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ne.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ne.border},children:" 2026 The Combine"})]})]})}function yB(){const{login:e}=Ls();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ne.bg},children:[a.jsx(gB,{}),a.jsx("main",{className:"flex-1 px-6 py-12",children:a.jsxs("article",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Ne.textPrimary},children:"Learn More"}),a.jsxs(ii,{title:"What The Combine Is",children:[a.jsx(ht,{children:"The Combine is an AI-assisted production system for knowledge work."}),a.jsx(ht,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),a.jsx(to,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),a.jsx(to,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),a.jsxs(ii,{title:"Why It Exists",children:[a.jsx(ht,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),a.jsx(ht,{children:"It breaks down when the work must be:"}),a.jsx(sl,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),a.jsx(ht,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),a.jsxs(ii,{title:'Why "The Combine"',children:[a.jsx(ht,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),a.jsx(ht,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),a.jsx(ht,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),a.jsx(ht,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),a.jsx(ht,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),a.jsx(sl,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),a.jsx(ht,{children:"This is not automation for speed. It is industrialization for reliability."}),a.jsx(to,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),a.jsxs(ii,{title:"How It Works",children:[a.jsx(ol,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),a.jsx(ol,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),a.jsx(ol,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),a.jsx(ol,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),a.jsxs(ii,{title:"What Makes It Different",children:[a.jsx(al,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),a.jsx(al,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),a.jsx(al,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),a.jsx(al,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),a.jsxs(ii,{title:"What The Combine Is Not",children:[a.jsx(sl,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),a.jsx(ht,{children:"If you want improvisation, there are better tools."}),a.jsx(to,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),a.jsxs(ii,{title:"Who It's For",children:[a.jsx(ht,{children:"The Combine is designed for people responsible for outcomes, including:"}),a.jsx(sl,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),a.jsx(to,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),a.jsx(vB,{onLogin:e})]})}),a.jsx(xB,{})]})}function OT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await ke.getTemplates();t(l.templates||[])}catch(l){s(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{templates:e,loading:r,error:i,refresh:o}}function bB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await ke.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){s(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{workflows:e,loading:r,error:i,refresh:o}}function DT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await ke.getSchemas();t(l.schemas||[])}catch(l){s(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{schemas:e,loading:r,error:i,refresh:o}}function LT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null);m.useEffect(()=>{let f=!0;async function h(){n(!0),s(null);try{const p=await ke.getPromptFragments();f&&t(p.fragments||[])}catch(p){console.error("Failed to fetch prompt fragments:",p),f&&s(p.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return h(),()=>{f=!1}},[]);const o=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const h of e){const p=h.kind;f[p]&&f[p].push(h)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:o.role.length,task:o.task.length,qa:o.qa.length,pgc:o.pgc.length,questions:o.questions.length,reflection:o.reflection.length}),[e,o]),c=m.useCallback(f=>!f||f==="all"?e:o[f]||[],[e,o]),u=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),d=m.useCallback(async()=>{n(!0),s(null);try{const f=await ke.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),s(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:i,fragmentsByKind:o,kindCounts:l,kindOptions:u,filterByKind:c,refresh:d}}function wB({kinds:e=[],selectedKind:t="all",onSelect:r}){return a.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:i,count:s})=>{const o=t===n;return a.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:o?"var(--action-primary)":"var(--bg-panel)",color:o?"#000":"var(--text-secondary)",border:o?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[i,s!==void 0&&a.jsxs("span",{style:{marginLeft:4,opacity:o?.7:.6},children:["(",s,")"]})]},n)})})}const eg="doctype-browser-collapsed";function by(e,t){const[r,n]=m.useState(()=>{try{const s=JSON.parse(localStorage.getItem(eg)||"{}");return e in s?s[e]:t}catch{return t}}),i=m.useCallback(s=>{const o=typeof s=="function"?s(r):s;n(o);try{const l=JSON.parse(localStorage.getItem(eg)||"{}");l[e]=o,localStorage.setItem(eg,JSON.stringify(l))}catch{}},[e,r]);return[r,i]}function tg({title:e,defaultOpen:t=!0,children:r}){const[n,i]=by(`group:${e}`,t);return a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function Gj({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:i}){const[s,o]=by(`sub:${e}`,r);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:s?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&a.jsx("span",{style:{color:n,fontSize:8},children:""}),a.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),s&&i]})}function qi({selected:e,onClick:t,label:r,sublabel:n,badge:i}){return a.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:r}),i&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:i})]}),n&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function rg({label:e,count:t,dotColor:r,active:n,defaultOpen:i=!1,action:s,children:o}){const[l,c]=by(`bb:${e}`,i);return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center",style:{background:n?"var(--bg-selected)":"transparent",borderLeft:n?"2px solid var(--action-primary)":"2px solid transparent"},children:[a.jsxs("button",{onClick:()=>c(!l),className:"flex-1 px-4 py-2 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:n?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{style:{color:r,fontSize:10},children:""}),a.jsx("span",{className:"font-medium",children:e})]}),a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t}),a.jsx("span",{style:{color:"var(--text-muted)",transform:l?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""})]})]}),s&&a.jsx("div",{className:"pr-2",children:s})]}),l&&o]})}function ro({loading:e,empty:t,emptyMessage:r="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function _B({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:i=[],promptFragmentKindOptions:s=[],schemas:o=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:u=!1,workflowsLoading:d=!1,promptFragmentsLoading:f=!1,schemasLoading:h=!1,selectedDocType:p=null,docTypeSource:y=null,selectedRole:g=null,selectedTemplate:w=null,selectedWorkflow:v=null,selectedFragment:x=null,selectedSchema:b=null,onSelectDocType:_,onSelectRole:j,onSelectTemplate:S,onSelectWorkflow:C,onSelectFragment:E,onSelectStandaloneSchema:k,onCreateWorkflow:R,onCreateDocType:T,onCreateFragment:I,onCreateTemplate:F,onCreateSchema:N,onSelectTask:P,onSelectSchema:O,workspaceState:H=null}){var Xt;const[D,A]=m.useState(null),[L,M]=m.useState(null),[$,W]=m.useState(""),[B,Y]=m.useState(!1),[Z,ie]=m.useState(!1),[re,de]=m.useState(""),[ee,_e]=m.useState(!1),[ue,Te]=m.useState("all"),[pe,te]=m.useState(!1),[xe,K]=m.useState("role"),[X,fe]=m.useState(""),[me,ye]=m.useState(!1),[ve,he]=m.useState(!1),[be,Fe]=m.useState(""),[Se,Le]=m.useState(!1),[q,V]=m.useState(!1),[z,J]=m.useState(""),[le,ze]=m.useState(!1),Ze=[...e].sort((U,Pe)=>(U.display_name||"").localeCompare(Pe.display_name||"")),yt=n.filter(U=>(U.pow_class||"reference")==="reference"),kt=U=>{const Pe=U.pow_class||"reference";return Pe==="reference"?"ref":Pe==="template"?"tpl":"inst"},oe=e.filter(U=>U.active_version).length+n.filter(U=>U.active_version).length,ae=((Xt=H==null?void 0:H.modified_artifacts)==null?void 0:Xt.length)??0,nt=(H==null?void 0:H.is_dirty)??!1,It=ue==="all"?i:i.filter(U=>U.kind===ue),Pr=()=>{A(null),M(null),W("")},Ke=()=>{ie(!1),de("")},$e=()=>{te(!1),K("role"),fe("")},lt=()=>{he(!1),Fe("")},qt=()=>{V(!1),J("")},bt=async()=>{const U=re.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){_e(!0);try{await(T==null?void 0:T({doc_type_id:U})),Ke()}catch{}finally{_e(!1)}}},pt=async()=>{const U=X.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){ye(!0);try{await(I==null?void 0:I({role_id:U,kind:xe})),$e()}catch{}finally{ye(!1)}}},Mt=async()=>{const U=be.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){Le(!0);try{await(F==null?void 0:F({template_id:U})),lt()}catch{}finally{Le(!1)}}},xr=async()=>{const U=z.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){ze(!0);try{await(N==null?void 0:N({schema_id:U})),qt()}catch{}finally{ze(!1)}}},Je=async()=>{const U=$.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){Y(!0);try{const Pe={workflow_id:U,pow_class:"template"};L&&(Pe.derived_from={workflow_id:L.workflow_id,version:L.active_version},Pe.source_version=L.active_version),await(R==null?void 0:R(Pe)),Pr()}catch{}finally{Y(!1)}}};return a.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(tg,{title:"Production Workflows",defaultOpen:!0,children:[a.jsxs(Gj,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&a.jsx("button",{onClick:()=>A(D?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[D==="choose"&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("button",{onClick:()=>A("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:yt.length===0,children:["From Reference",yt.length===0?" (none available)":""]}),a.jsx("button",{onClick:()=>A("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),a.jsx("button",{onClick:Pr,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),D==="from_reference"&&!L&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),yt.map(U=>a.jsxs("button",{onClick:()=>M(U),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("div",{className:"font-medium",children:U.name||U.workflow_id.replace(/_/g," ").replace(/\b\w/g,Pe=>Pe.toUpperCase())}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",U.active_version]})]},U.workflow_id)),a.jsx("button",{onClick:()=>A("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(D==="blank"||D==="from_reference"&&L)&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[L&&a.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",L.name||L.workflow_id," v",L.active_version]}),a.jsx("input",{type:"text",value:$,onChange:U=>W(U.target.value),onKeyDown:U=>{U.key==="Enter"&&Je(),U.key==="Escape"&&Pr()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:B,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:Je,disabled:B||!$.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:B?"wait":"pointer",opacity:!$.trim()||B?.5:1},children:B?"Creating...":"Create"}),a.jsx("button",{onClick:Pr,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ro,{loading:d,empty:!d&&n.length===0,emptyMessage:"No workflows"}),!d&&n.length>0&&a.jsx("div",{className:"py-1",children:n.map(U=>a.jsx(qi,{selected:(v==null?void 0:v.workflow_id)===U.workflow_id,onClick:()=>C==null?void 0:C(U),label:U.name||U.workflow_id.replace(/_/g," ").replace(/\b\w/g,Pe=>Pe.toUpperCase()),sublabel:`v${U.active_version}`,badge:kt(U)},U.workflow_id))})]}),a.jsxs(Gj,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&a.jsx("button",{onClick:()=>ie(!Z),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[Z&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:re,onChange:U=>de(U.target.value),onKeyDown:U=>{U.key==="Enter"&&bt(),U.key==="Escape"&&Ke()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:ee,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:bt,disabled:ee||!re.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:ee?"wait":"pointer",opacity:!re.trim()||ee?.5:1},children:ee?"Creating...":"Create"}),a.jsx("button",{onClick:Ke,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ro,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&Ze.length>0&&a.jsx("div",{className:"py-1",children:Ze.map(U=>a.jsx(qi,{selected:y==="docworkflow"&&(p==null?void 0:p.doc_type_id)===U.doc_type_id,onClick:()=>_==null?void 0:_(U),label:U.display_name,badge:`v${U.active_version}`},U.doc_type_id))})]})]}),a.jsxs(tg,{title:"Building Blocks",defaultOpen:!0,children:[a.jsxs(rg,{label:"Prompt Fragments",count:i.length,dotColor:"#f59e0b",active:!!x,defaultOpen:!0,action:I&&a.jsx("button",{onClick:()=>te(!pe),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[pe&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),a.jsx("select",{value:xe,onChange:U=>K(U.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:a.jsx("option",{value:"role",children:"Role"})})]}),a.jsx("input",{type:"text",value:X,onChange:U=>fe(U.target.value),onKeyDown:U=>{U.key==="Enter"&&pt(),U.key==="Escape"&&$e()},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:me,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:pt,disabled:me||!X.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:me?"wait":"pointer",opacity:!X.trim()||me?.5:1},children:me?"Creating...":"Create"}),a.jsx("button",{onClick:$e,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),s.length>0&&a.jsx(wB,{kinds:s,selectedKind:ue,onSelect:Te}),a.jsx(ro,{loading:f,empty:!f&&It.length===0,emptyMessage:ue==="all"?"No prompt fragments":`No ${ue} fragments`}),!f&&It.length>0&&a.jsx("div",{className:"py-1",children:It.map(U=>a.jsx(qi,{selected:(x==null?void 0:x.fragment_id)===U.fragment_id,onClick:()=>E==null?void 0:E(U),label:U.name||U.fragment_id,sublabel:`${U.kind}  v${U.version}`,badge:U.kind},U.fragment_id))})]}),a.jsxs(rg,{label:"Templates",count:r.length,dotColor:"var(--dot-green)",active:!!w,action:F&&a.jsx("button",{onClick:()=>he(!ve),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[ve&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:be,onChange:U=>Fe(U.target.value),onKeyDown:U=>{U.key==="Enter"&&Mt(),U.key==="Escape"&&lt()},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:Se,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:Mt,disabled:Se||!be.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Se?"wait":"pointer",opacity:!be.trim()||Se?.5:1},children:Se?"Creating...":"Create"}),a.jsx("button",{onClick:lt,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ro,{loading:u,empty:!u&&r.length===0,emptyMessage:"No templates"}),!u&&r.length>0&&a.jsx("div",{className:"py-1",children:r.map(U=>a.jsx(qi,{selected:(w==null?void 0:w.template_id)===U.template_id,onClick:()=>S==null?void 0:S(U),label:U.name||U.template_id.replace(/_/g," ").replace(/\b\w/g,Pe=>Pe.toUpperCase()),sublabel:`v${U.active_version}`},U.template_id))})]}),a.jsxs(rg,{label:"Schemas",count:o.length||e.length,dotColor:"var(--dot-blue)",active:y==="schema"||!!b,action:N&&a.jsx("button",{onClick:()=>V(!q),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[q&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:z,onChange:U=>J(U.target.value),onKeyDown:U=>{U.key==="Enter"&&xr(),U.key==="Escape"&&qt()},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:le,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:xr,disabled:le||!z.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:le?"wait":"pointer",opacity:!z.trim()||le?.5:1},children:le?"Creating...":"Create"}),a.jsx("button",{onClick:qt,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ro,{loading:h||l,empty:!h&&!l&&o.length===0&&e.length===0,emptyMessage:"No schemas"}),!h&&o.length>0&&a.jsx("div",{className:"py-1",children:o.map(U=>a.jsx(qi,{selected:(b==null?void 0:b.schema_id)===U.schema_id,onClick:()=>k==null?void 0:k(U),label:U.title||U.schema_id,sublabel:`v${U.active_version}`},`standalone-${U.schema_id}`))}),!l&&o.length===0&&e.length>0&&a.jsx("div",{className:"py-1",children:e.map(U=>a.jsx(qi,{selected:y==="schema"&&(p==null?void 0:p.doc_type_id)===U.doc_type_id,onClick:()=>{var Pe;return(Pe=O||_)==null?void 0:Pe({doc_type_id:U.doc_type_id,display_name:U.display_name,active_version:U.active_version})},label:U.display_name,sublabel:`from ${U.doc_type_id}`},`schema-${U.doc_type_id}`))})]})]}),a.jsxs(tg,{title:"Governance",defaultOpen:!1,children:[a.jsx("div",{className:"px-4 py-3",children:a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),a.jsxs("div",{children:[oe," active ",oe===1?"release":"releases"]})]})}),H&&a.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),nt&&a.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[ae," dirty"]})]})]})]})})}function en({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:i=!1,error:s=null,readOnly:o=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const u=m.useCallback(()=>{if(!(!e||!c))try{const d=JSON.parse(e),f=JSON.stringify(d,null,2);t==null||t(f)}catch(d){console.warn("Invalid JSON, cannot format:",d.message)}},[e,c,t]);return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o&&a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!o&&i&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&!o&&a.jsx("button",{onClick:u,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&i&&a.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),s&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",s]})]})]}),a.jsx("div",{className:"flex-1 relative",children:r?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):a.jsx("textarea",{value:e,onChange:d=>t==null?void 0:t(d.target.value),placeholder:l,readOnly:o,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function jB({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),s(!1);return}(async()=>{s(!0),l(null);try{const u=await ke.getPreview(e,t);n(u)}catch(u){l(u.message),console.error("Failed to load preview:",u)}finally{s(!1)}})()},[e,t]),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&a.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&a.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&a.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&a.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),a.jsx("div",{className:"flex-1 relative overflow-auto",children:i?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):o?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[a.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:o})]})}):a.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function SB({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,u]=m.useState(!1),[d,f]=m.useState(null),[h,p]=m.useState(!1);m.useEffect(()=>{var b,_,j;t&&(s({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((_=t.ui)==null?void 0:_.category)||"",ui_display_order:((j=t.ui)==null?void 0:j.display_order)||0}),p(!1),f(null))},[t]);const y=m.useCallback((b,_)=>{s(j=>({...j,[b]:_})),p(!0)},[]),g=m.useCallback((b,_)=>{const j=_.split(",").map(S=>S.trim()).filter(S=>S);s(S=>({...S,[b]:j})),p(!0)},[]),w=m.useCallback(b=>{if(!b)return"";const _=r.find(j=>j.role_id===b);return _?`prompt:role:${b}:${_.active_version}`:""},[r]),v=m.useCallback(b=>{if(!b)return"";const _=b.split(":");return _.length>=3&&_[0]==="prompt"&&_[1]==="role"?_[2]:""},[]),x=m.useCallback(async()=>{if(!(!e||!t||!i)){u(!0),f(null);try{const b=t.version||t.active_version,_=`doctype:${t.doc_type_id}:${b}:manifest`,j=kB(t.doc_type_id,b,i),S=await ke.writeArtifact(e,_,j);p(!1),n==null||n(_,S)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{u(!1)}}},[e,t,i,n]);return!t||!i?a.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"flex items-center gap-2",children:h&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),d&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",d]}),a.jsx("button",{onClick:x,disabled:!h||c,className:"px-3 py-1 rounded text-xs",style:{background:h?"var(--action-primary)":"var(--bg-panel)",color:h?"#000":"var(--text-muted)",opacity:h&&!c?1:.5},children:"Save Package"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsxs(no,{title:"Identity",children:[a.jsx(Qt,{label:"Display Name",children:a.jsx("input",{type:"text",value:i.display_name,onChange:b=>y("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Description",children:a.jsx("textarea",{value:i.description,onChange:b=>y("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"Classification",children:[a.jsx(Qt,{label:"Authority Level",children:a.jsxs("select",{value:i.authority_level,onChange:b=>y("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"descriptive",children:"Descriptive"}),a.jsx("option",{value:"prescriptive",children:"Prescriptive"}),a.jsx("option",{value:"constructive",children:"Constructive"}),a.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),a.jsx(Qt,{label:"Creation Mode",children:a.jsxs("select",{value:i.creation_mode,onChange:b=>y("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"llm_generated",children:"LLM Generated"}),a.jsx("option",{value:"constructed",children:"Constructed"}),a.jsx("option",{value:"extracted",children:"Extracted"})]})}),a.jsx(Qt,{label:"Scope",children:a.jsxs("select",{value:i.scope,onChange:b=>y("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"epic",children:"Epic"}),a.jsx("option",{value:"feature",children:"Feature"})]})})]}),a.jsx(no,{title:"Shared References",children:a.jsxs(Qt,{label:"Role Prompt",children:[a.jsxs("select",{value:v(i.role_prompt_ref),onChange:b=>y("role_prompt_ref",w(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"None"}),r.map(b=>a.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())},b.role_id))]}),i.role_prompt_ref&&a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:i.role_prompt_ref})]})}),a.jsxs(no,{title:"Dependencies",children:[a.jsx(Qt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Parent Doc Type",children:a.jsx("input",{type:"text",value:i.parent_doc_type,onChange:b=>y("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"UI Configuration",children:[a.jsx(Qt,{label:"Icon",children:a.jsx("input",{type:"text",value:i.ui_icon,onChange:b=>y("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Qt,{label:"Category",children:a.jsxs("select",{value:i.ui_category,onChange:b=>y("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"Select category..."}),a.jsx("option",{value:"intake",children:"Intake"}),a.jsx("option",{value:"architecture",children:"Architecture"}),a.jsx("option",{value:"planning",children:"Planning"}),a.jsx("option",{value:"execution",children:"Execution"})]})}),a.jsx(Qt,{label:"Display Order",children:a.jsx("input",{type:"number",value:i.ui_display_order,onChange:b=>y("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function no({title:e,children:t}){return a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),a.jsx("div",{className:"space-y-4",children:t})]})}function Qt({label:e,hint:t,children:r}){return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&a.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function kB(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(i=>`"${i}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(i=>`"${i}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(i=>`"${i}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function FT(e,t,{debounceMs:r=1e3,onSave:n}={}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null),[h,p]=m.useState(!1),[y,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){s(null),l(null),u(!1);return}u(!0),f(null);try{const C=await ke.getArtifact(e,t),E=JSON.parse(C.content);s(E),l(E)}catch(C){f(C.message),console.error("Failed to load workflow artifact:",C)}finally{u(!1)}},[e,t]),b=m.useCallback(async C=>{if(!(!e||!t)){p(!0),f(null);try{const E=JSON.stringify(C,null,2),k=await ke.writeArtifact(e,t,E);g(k),l(C),n&&n(k)}catch(E){f(E.message),console.error("Failed to save workflow:",E)}finally{p(!1)}}},[e,t,n]),_=m.useCallback(C=>{v.current=C,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),j=m.useCallback(C=>{s(C),_(C)},[_]),S=m.useCallback(()=>{w.current&&clearTimeout(w.current),i&&b(i)},[i,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{workflowJson:i,originalJson:o,loading:c,error:d,saving:h,lastSaveResult:y,isDirty:i!==o,updateWorkflow:j,saveNow:S,reload:x}}function CB({data:e,selected:t}){const{config:r,isEntry:n}=e,i=e.type==="end";return a.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[a.jsx(Ur,{type:"target",position:se.Top,style:{background:r.color,width:8,height:8,border:"none"}}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[a.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&a.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),a.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&a.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),a.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!i&&a.jsx(Ur,{type:"source",position:se.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const NB=m.memo(CB),dc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},EB={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},Kj=220,Yj=110;function Xj(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(i=>{const s=dc[i.type]||dc.task,l=i.type==="end"&&["blocked","abandoned"].includes(i.terminal_outcome)?EB:s;return{id:i.node_id,type:"workflowNode",position:i._position||{x:0,y:0},data:{...i,config:l,isEntry:t.includes(i.node_id)}}}),n=(e.edges||[]).map(i=>{const s=i.non_advancing||!i.to_node_id,o=i.conditions&&i.conditions.length>0;let l=i.label||i.outcome;if(o){const c=i.conditions[0],u={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${u} ${c.value})`}return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id||i.from_node_id,type:"smoothstep",animated:s,label:l,data:{...i},style:{stroke:s?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:s?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:i.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function Qj(e,t,r="TB"){const n=new uc.graphlib.Graph;return n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(i=>{n.setNode(i.id,{width:Kj,height:Yj})}),t.forEach(i=>{i.target!==i.source&&n.setEdge(i.source,i.target)}),uc.layout(n),e.map(i=>{const s=n.node(i.id);return s?{...i,position:{x:s.x-Kj/2,y:s.y-Yj/2}}:i})}function TB(e,t){const r=new Set(t.map(s=>s.id||s.node_id));let n=1,i=`${e}_${n}`;for(;r.has(i);)n++,i=`${e}_${n}`;return i}function RB(e,t,r){const n=new Set(r.map(o=>o.id||o.edge_id));let i=1,s=`${e}_to_${t}`;for(;n.has(s);)i++,s=`${e}_to_${t}_${i}`;return s}function AB(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const IB={workflowNode:NB},MB=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function PB({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:i,onEdgeSelect:s}){const o=Vc(),[l,c,u]=uE([]),[d,f,h]=dE([]),[p,y]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:k,edges:R}=Xj(e);(!k.some(I=>I.position.x!==0||I.position.y!==0)||!g.current)&&(k=Qj(k,R),g.current=!0),c(k),f(R)},[e,c,f]),m.useEffect(()=>{c(k=>k.map(R=>({...R,selected:R.id===r})))},[r,c]);const w=m.useCallback(k=>{if(!e)return;const T={edge_id:RB(k.source,k.target,e.edges||[]),from_node_id:k.source,to_node_id:k.target,outcome:"success",label:"",kind:"auto"},I={...e,edges:[...e.edges||[],T]};t(I)},[e,t]),v=m.useCallback((k,R)=>{if(!e)return;const T=e.nodes.map(I=>I.node_id===R.id?{...I,_position:R.position}:I);t({...e,nodes:T})},[e,t]),x=m.useCallback((k,R)=>{i==null||i(R.id)},[i]),b=m.useCallback((k,R)=>{s==null||s(R.id)},[s]),_=m.useCallback(()=>{i==null||i(null),s==null||s(null)},[i,s]),j=m.useCallback(k=>{if(k.key==="Delete"||k.key==="Backspace"){if(r&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(R),i==null||i(null)}else if(n&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(R),s==null||s(null)}}},[r,n,e,t,i,s]),S=m.useCallback(k=>{if(!e)return;const R=TB(k,e.nodes||[]),T=AB(k);T.node_id=R;const I=o.getViewport(),F=(-I.x+window.innerWidth/2)/I.zoom,N=(-I.y+window.innerHeight/2)/I.zoom;T._position={x:F-110,y:N-50};const P={...e,nodes:[...e.nodes||[],T]};t(P),y(!1),i==null||i(R)},[e,t,o,i]),C=m.useCallback(()=>{if(!e)return;let{nodes:k,edges:R}=Xj(e);k=Qj(k,R);const T=e.nodes.map(I=>{const F=k.find(N=>N.id===I.node_id);return F?{...I,_position:F.position}:I});t({...e,nodes:T}),setTimeout(()=>{o.fitView({padding:.2,duration:300})},50)},[e,t,o]),E=m.useCallback(()=>{o.fitView({padding:.2,duration:300})},[o]);return a.jsx("div",{className:"flex-1 relative",onKeyDown:j,tabIndex:0,style:{outline:"none"},children:a.jsxs(Zx,{nodes:l,edges:d,onNodesChange:u,onEdgesChange:h,onConnect:w,onNodeDragStop:v,onNodeClick:x,onEdgeClick:b,onPaneClick:_,nodeTypes:IB,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[a.jsx(Hn,{position:"top-left",children:a.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>y(!p),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),p&&a.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:MB.map(k=>{const R=dc[k.value]||{};return a.jsxs("button",{onClick:()=>S(k.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),k.label]},k.value)})})]}),a.jsx("button",{onClick:C,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),a.jsx("button",{onClick:E,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),a.jsx(hE,{position:"bottom-right",nodeColor:k=>{var T;const R=(T=k.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hn,{position:"bottom-left",children:a.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(dc).map(([k,R])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},k))})}),a.jsx(Hn,{position:"top-right",children:a.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const OB=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],Zj=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],DB=["semantic","structural","hybrid"],LB=["stabilized","blocked","abandoned"],et={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},wr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},FB={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function ng(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function ig(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function zi(e){var i;if(!e)return"";const t=e.kind||"role",r=((i=e.fragment_id)==null?void 0:i.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function $i(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function sg(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function og(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function ag({title:e,defaultOpen:t=!1,children:r,badge:n}){const[i,s]=m.useState(t);return a.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("button",{onClick:()=>s(!i),className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:i?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:a.jsx("path",{d:"M9 18l6-6-6-6"})}),a.jsx("span",{style:{...wr,marginBottom:0},children:e})]}),n&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:n})]}),i&&a.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:r})]})}function qB({node:e,onChange:t,onDelete:r,templates:n=[],schemas:i=[],roleFragments:s=[],taskFragments:o=[],pgcFragments:l=[]}){var xe,K,X,fe,me,ye,ve,he,be,Fe,Se,Le;const[c,u]=m.useState(e);m.useEffect(()=>{u(e)},[e]);const d=(q,V)=>{const z={...c,[q]:V};u(z),t(z)},f=(q,V)=>{const z={...c.includes,[q]:V},J={...c,includes:z};u(J),t(J)},h=q=>{const V={...c.includes};delete V[q];const z={...c,includes:V};u(z),t(z)},p=()=>{const q={...c.includes,NEW_KEY:""},V={...c,includes:q};u(V),t(V)},y=q=>{const V={...c,internals:q};u(V),t(V)},g=(q,V)=>{const z=c.internals||x(),J={...z.question_generation,[q]:V};y({...z,question_generation:J})},w=(q,V)=>{const z=c.internals||x(),J={...z.question_generation.includes,[q]:V},le={...z.question_generation,includes:J};y({...z,question_generation:le})},v=(q,V)=>{const z=c.internals||x(),J={...z.clarification_merge,[q]:V};y({...z,clarification_merge:J})},x=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!c)return null;const b=c.type==="pgc",_=ig(c.task_ref),j=c.includes||{},S=j.ROLE_PROMPT||"",C=j.TASK_PROMPT||"",E=j.OUTPUT_SCHEMA||"",k=j.PGC_CONTEXT||"",R=$i(S),T=$i(C),I=og(E),F=$i(k),N=Object.entries(j).filter(([q])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(q)),P=c.internals||x(),O=ig((xe=P.question_generation)==null?void 0:xe.template_ref),H=$i((X=(K=P.question_generation)==null?void 0:K.includes)==null?void 0:X.ROLE_PROMPT),D=$i((me=(fe=P.question_generation)==null?void 0:fe.includes)==null?void 0:me.TASK_PROMPT),A=$i((ve=(ye=P.question_generation)==null?void 0:ye.includes)==null?void 0:ve.PGC_CONTEXT),L=og((he=P.question_generation)==null?void 0:he.output_schema_ref),M=ig((be=P.clarification_merge)==null?void 0:be.template_ref),$=og((Fe=P.clarification_merge)==null?void 0:Fe.output_schema_ref),W=q=>{const V=q.target.value;if(!V){d("task_ref","");return}const z=n.find(J=>J.template_id===V);z&&d("task_ref",ng(z))},B=q=>{const V=q.target.value;if(!V){h("ROLE_PROMPT");return}const z=s.find(J=>J.fragment_id===`role:${V}`||J.id===V);z&&f("ROLE_PROMPT",zi(z))},Y=q=>{const V=q.target.value;if(!V){h("TASK_PROMPT");return}const z=o.find(J=>J.fragment_id===`task:${V}`||J.id===V);z&&f("TASK_PROMPT",zi(z))},Z=q=>{const V=q.target.value;if(!V){h("OUTPUT_SCHEMA");return}const z=i.find(J=>J.schema_id===V);z&&f("OUTPUT_SCHEMA",sg(z))},ie=q=>{const V=q.target.value;if(!V){h("PGC_CONTEXT");return}const z=l.find(J=>J.fragment_id===`pgc:${V}`||J.id===V);z&&f("PGC_CONTEXT",zi(z))},re=q=>{const V=q.target.value,z=Zj.find(ze=>ze.value===V),J=(z==null?void 0:z.produces)||`pgc_clarifications.${V}`,le={...c,gate_kind:V,produces:J};u(le),t(le)},de=q=>{const V=q.target.value;if(!V){g("template_ref","");return}const z=n.find(J=>J.template_id===V);z&&g("template_ref",ng(z))},ee=q=>{const V=q.target.value;if(!V){w("ROLE_PROMPT","");return}const z=s.find(J=>J.fragment_id===`role:${V}`||J.id===V);z&&w("ROLE_PROMPT",zi(z))},_e=q=>{const V=q.target.value;if(!V){w("TASK_PROMPT","");return}const z=o.find(J=>J.fragment_id===`task:${V}`||J.id===V);z&&w("TASK_PROMPT",zi(z))},ue=q=>{const V=q.target.value;if(!V){w("PGC_CONTEXT","");return}const z=l.find(J=>J.fragment_id===`pgc:${V}`||J.id===V);z&&w("PGC_CONTEXT",zi(z))},Te=q=>{const V=q.target.value;if(!V){g("output_schema_ref","");return}const z=i.find(J=>J.schema_id===V);z&&g("output_schema_ref",sg(z))},pe=q=>{const V=q.target.value;if(!V){v("template_ref","");return}const z=n.find(J=>J.template_id===V);z&&v("template_ref",ng(z))},te=q=>{const V=q.target.value;if(!V){v("output_schema_ref","");return}const z=i.find(J=>J.schema_id===V);z&&v("output_schema_ref",sg(z))};return a.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:b?"PGC Gate Properties":"Node Properties"}),a.jsx("button",{onClick:()=>r(c.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Node ID"}),a.jsx("input",{type:"text",value:c.node_id||"",onChange:q=>d("node_id",q.target.value),style:et})]}),a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Type"}),a.jsx("select",{value:c.type||"task",onChange:q=>d("type",q.target.value),style:et,children:OB.map(q=>a.jsx("option",{value:q.value,children:q.label},q.value))})]}),b&&a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Gate Kind"}),a.jsx("select",{value:c.gate_kind||"discovery",onChange:re,style:et,children:Zj.map(q=>a.jsx("option",{value:q.value,children:q.label},q.value))})]}),a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Description"}),a.jsx("textarea",{value:c.description||"",onChange:q=>d("description",q.target.value),rows:2,style:{...et,resize:"vertical"}})]}),(b||["task","intake_gate"].includes(c.type))&&a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Produces"}),a.jsx("input",{type:"text",value:c.produces||"",onChange:q=>d("produces",q.target.value),placeholder:b?"pgc_clarifications.discovery":"document_type",style:et})]}),b&&a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{style:FB,children:"Gate Internals"}),a.jsx(ag,{title:"Pass A: Question Generation",defaultOpen:!0,badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:O||"",onChange:de,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(q=>a.jsx("option",{value:q.template_id,children:q.name||q.template_id.replace(/_/g," ")},q.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:H||"",onChange:ee,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(q=>{var z;const V=((z=q.fragment_id)==null?void 0:z.replace("role:",""))||q.id;return a.jsx("option",{value:V,children:q.name||(V==null?void 0:V.replace(/_/g," "))},q.fragment_id||q.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:D||"",onChange:_e,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(q=>{var z;const V=((z=q.fragment_id)==null?void 0:z.replace("task:",""))||q.id;return a.jsx("option",{value:V,children:q.name||(V==null?void 0:V.replace(/_/g," "))},q.fragment_id||q.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:A||"",onChange:ue,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(q=>{var z;const V=((z=q.fragment_id)==null?void 0:z.replace("pgc:",""))||q.id;return a.jsx("option",{value:V,children:q.name||(V==null?void 0:V.replace(/_/g," "))},q.fragment_id||q.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:L||"",onChange:Te,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(q=>a.jsx("option",{value:q.schema_id,children:q.title||q.schema_id.replace(/_/g," ")},q.schema_id))]})]})]})}),a.jsx("div",{className:"mt-2",children:a.jsx(ag,{title:"Entry: Operator Answers",badge:"UI",children:a.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Renders:"}),a.jsx("span",{className:"font-mono",children:((Se=P.operator_entry)==null?void 0:Se.renders)||"question_set"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Captures:"}),a.jsx("span",{className:"font-mono",children:((Le=P.operator_entry)==null?void 0:Le.captures)||"pgc_answers"})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),a.jsx("div",{className:"mt-2",children:a.jsx(ag,{title:"Pass B: Clarification Merge",badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:M||"",onChange:pe,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(q=>a.jsx("option",{value:q.template_id,children:q.name||q.template_id.replace(/_/g," ")},q.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:$||"",onChange:te,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(q=>a.jsx("option",{value:q.schema_id,children:q.title||q.schema_id.replace(/_/g," ")},q.schema_id))]})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),["task","qa","intake_gate"].includes(c.type)&&a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Interaction Template"}),a.jsxs("select",{value:_||"",onChange:W,style:et,children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(q=>a.jsx("option",{value:q.template_id,children:q.name||q.template_id.replace(/_/g," ")},q.template_id))]}),c.task_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:c.task_ref,children:c.task_ref})]}),c.type==="qa"&&a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"QA Mode"}),a.jsx("select",{value:c.qa_mode||"semantic",onChange:q=>d("qa_mode",q.target.value),style:et,children:DB.map(q=>a.jsx("option",{value:q,children:q},q))})]}),c.type==="end"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Terminal Outcome"}),a.jsx("select",{value:c.terminal_outcome||"stabilized",onChange:q=>d("terminal_outcome",q.target.value),style:et,children:LB.map(q=>a.jsx("option",{value:q,children:q},q))})]}),a.jsxs("div",{children:[a.jsx("label",{style:wr,children:"Gate Outcome"}),a.jsx("input",{type:"text",value:c.gate_outcome||"",onChange:q=>d("gate_outcome",q.target.value),placeholder:"e.g., complete, failed",style:et})]})]}),a.jsxs("div",{className:"flex gap-4",children:[c.type==="qa"&&a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:c.requires_qa||!1,onChange:q=>d("requires_qa",q.target.checked)}),"Requires QA"]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:c.non_advancing||!1,onChange:q=>d("non_advancing",q.target.checked)}),"Non-advancing"]})]}),c.type==="task"&&a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("label",{style:wr,children:"Includes"})}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:R||"",onChange:B,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(q=>{var z;const V=((z=q.fragment_id)==null?void 0:z.replace("role:",""))||q.id;return a.jsx("option",{value:V,children:q.name||(V==null?void 0:V.replace(/_/g," "))},q.fragment_id||q.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:T||"",onChange:Y,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(q=>{var z;const V=((z=q.fragment_id)==null?void 0:z.replace("task:",""))||q.id;return a.jsx("option",{value:V,children:q.name||(V==null?void 0:V.replace(/_/g," "))},q.fragment_id||q.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:I||"",onChange:Z,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(q=>a.jsx("option",{value:q.schema_id,children:q.title||q.schema_id.replace(/_/g," ")},q.schema_id))]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:F||"",onChange:ie,style:{...et,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(q=>{var z;const V=((z=q.fragment_id)==null?void 0:z.replace("pgc:",""))||q.id;return a.jsx("option",{value:V,children:q.name||(V==null?void 0:V.replace(/_/g," "))},q.fragment_id||q.id)})]})]}),N.length>0&&a.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),a.jsx("div",{className:"space-y-2",children:N.map(([q,V])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:q,onChange:z=>{const J={...c.includes};delete J[q],J[z.target.value]=V;const le={...c,includes:J};u(le),t(le)},style:{...et,width:"35%",fontSize:10},placeholder:"KEY"}),a.jsx("input",{type:"text",value:V,onChange:z=>f(q,z.target.value),style:{...et,flex:1,fontSize:10},placeholder:"path/to/file"}),a.jsx("button",{onClick:()=>h(q),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},q))})]}),a.jsx("button",{onClick:p,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const zB=["auto","user_choice"],$B=["eq","ne","lt","lte","gt","gte"],Qr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},si={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function BB({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[i,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(d,f)=>{const h={...i,[d]:f};s(h),r(h)},l=()=>{const d=[...i.conditions||[],{type:"retry_count",operator:"lt",value:2}];o("conditions",d)},c=(d,f,h)=>{const p=[...i.conditions||[]];p[d]={...p[d],[f]:h},o("conditions",p)},u=d=>{const f=(i.conditions||[]).filter((h,p)=>p!==d);o("conditions",f)};return i?a.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),a.jsx("button",{onClick:()=>n(i.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Edge ID"}),a.jsx("input",{type:"text",value:i.edge_id||"",onChange:d=>o("edge_id",d.target.value),style:Qr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"From Node"}),a.jsx("select",{value:i.from_node_id||"",onChange:d=>o("from_node_id",d.target.value),style:Qr,children:t.map(d=>a.jsx("option",{value:d,children:d},d))})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"To Node"}),a.jsxs("select",{value:i.to_node_id||"",onChange:d=>o("to_node_id",d.target.value||null),style:Qr,children:[a.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(d=>a.jsx("option",{value:d,children:d},d))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Outcome"}),a.jsx("input",{type:"text",value:i.outcome||"",onChange:d=>o("outcome",d.target.value),placeholder:"success, failed, etc.",style:Qr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Label"}),a.jsx("input",{type:"text",value:i.label||"",onChange:d=>o("label",d.target.value),placeholder:"Human-readable label",style:Qr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Kind"}),a.jsx("select",{value:i.kind||"auto",onChange:d=>o("kind",d.target.value),style:Qr,children:zB.map(d=>a.jsx("option",{value:d,children:d},d))})]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:i.non_advancing||!1,onChange:d=>o("non_advancing",d.target.checked)}),"Non-advancing"]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:si,children:"Conditions"}),a.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),a.jsx("div",{className:"space-y-2",children:(i.conditions||[]).map((d,f)=>a.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"text",value:d.type||"",onChange:h=>c(f,"type",h.target.value),placeholder:"retry_count",style:{...Qr,flex:1,fontSize:10}}),a.jsx("select",{value:d.operator||"lt",onChange:h=>c(f,"operator",h.target.value),style:{...Qr,width:"auto",fontSize:10},children:$B.map(h=>a.jsx("option",{value:h,children:h},h))}),a.jsx("input",{type:"text",value:d.value??"",onChange:h=>{const p=isNaN(h.target.value)?h.target.value:Number(h.target.value);c(f,"value",p)},placeholder:"value",style:{...Qr,width:50,fontSize:10}}),a.jsx("button",{onClick:()=>u(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const HB={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function WB({workspaceId:e,artifactId:t,onArtifactSave:r}){var M,$,W;const[n,i]=m.useState("canvas"),[s,o]=m.useState(null),[l,c]=m.useState(null),[u,d]=m.useState(""),[f,h]=m.useState(null),{workflowJson:p,loading:y,error:g,saving:w,lastSaveResult:v,updateWorkflow:x}=FT(e,t,{onSave:B=>{r==null||r(t,B)}}),{templates:b}=OT(),{schemas:_}=DT(),{fragmentsByKind:j}=LT(),S=m.useMemo(()=>{var B;return!s||!p?null:((B=p.nodes)==null?void 0:B.find(Y=>Y.node_id===s))||null},[s,p]),C=m.useMemo(()=>{var B;return!l||!p?null:((B=p.edges)==null?void 0:B.find(Y=>Y.edge_id===l))||null},[l,p]),E=m.useMemo(()=>p!=null&&p.nodes?p.nodes.map(B=>B.node_id):[],[p]),k=m.useCallback(B=>{x(B)},[x]),R=m.useCallback(B=>{if(!p)return;const Y=p.nodes.map(re=>re.node_id===s?B:re);let Z=p.edges,ie=p.entry_node_ids||[];B.node_id!==s&&(Z=p.edges.map(re=>({...re,from_node_id:re.from_node_id===s?B.node_id:re.from_node_id,to_node_id:re.to_node_id===s?B.node_id:re.to_node_id})),ie=ie.map(re=>re===s?B.node_id:re),o(B.node_id)),x({...p,nodes:Y,edges:Z,entry_node_ids:ie})},[p,s,x]),T=m.useCallback(B=>{if(!p)return;const Y=p.edges.map(Z=>Z.edge_id===l?B:Z);B.edge_id!==l&&c(B.edge_id),x({...p,edges:Y})},[p,l,x]),I=m.useCallback(B=>{p&&(x({...p,nodes:p.nodes.filter(Y=>Y.node_id!==B),edges:p.edges.filter(Y=>Y.from_node_id!==B&&Y.to_node_id!==B),entry_node_ids:(p.entry_node_ids||[]).filter(Y=>Y!==B)}),o(null))},[p,x]),F=m.useCallback(B=>{p&&(x({...p,edges:p.edges.filter(Y=>Y.edge_id!==B)}),c(null))},[p,x]),N=m.useCallback(B=>{o(B),B&&c(null)},[]),P=m.useCallback(B=>{c(B),B&&o(null)},[]),O=m.useCallback(B=>{B==="json"&&p&&(d(JSON.stringify(p,null,2)),h(null)),i(B)},[p]),H=m.useCallback(B=>{const Y=B.target.value;d(Y);try{const Z=JSON.parse(Y);h(null),x(Z)}catch(Z){h(Z.message)}},[x]),D=((M=v==null?void 0:v.tier1_report)==null?void 0:M.results)||[],A=D.filter(B=>B.severity==="error").length,L=D.filter(B=>B.severity==="warning").length;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[w&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),!w&&!g&&p&&a.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[(($=p.nodes)==null?void 0:$.length)||0," nodes, ",((W=p.edges)==null?void 0:W.length)||0," edges"]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>a.jsx("button",{onClick:()=>O(B.id),style:{...HB,color:n===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:n===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),y?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[n==="canvas"&&a.jsxs(a.Fragment,{children:[a.jsx(Gc,{children:a.jsx(PB,{workflowJson:p,onWorkflowChange:k,selectedNodeId:s,selectedEdgeId:l,onNodeSelect:N,onEdgeSelect:P})}),S&&a.jsx(qB,{node:S,onChange:R,onDelete:I,templates:b,schemas:_,roleFragments:j.role||[],taskFragments:j.task||[],pgcFragments:j.pgc||[]}),C&&a.jsx(BB,{edge:C,nodeIds:E,onChange:T,onDelete:F})]}),n==="json"&&a.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[a.jsx("textarea",{value:u,onChange:H,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:f?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),f&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",f]})]}),n==="metadata"&&a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:p?a.jsx(UB,{workflow:p}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),D.length>0&&a.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[A>0&&a.jsxs("span",{style:{color:"#ef4444"},children:[A," error",A!==1?"s":""]}),L>0&&a.jsxs("span",{style:{color:"#f59e0b"},children:[L," warning",L!==1?"s":""]}),A===0&&L===0&&a.jsx("span",{style:{color:"#10b981"},children:"Valid"}),a.jsx("span",{style:{color:"var(--text-muted)"},children:D.map(B=>B.message).join(" | ")})]})]})}function UB({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],i=e.thread_ownership||{},s=Object.entries(i),o=e.entry_node_ids||[];return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l.label}),a.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),a.jsxs("div",{children:[a.jsx("label",{style:r,children:"Entry Node IDs"}),a.jsx("div",{style:t,children:o.length>0?o.join(", "):"-"})]}),s.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),s.map(([l,c])=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l}),a.jsx("div",{style:t,children:c})]},l))]})]})}function lg({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:i}){const[s,o]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!s)return;const c=u=>{l.current&&!l.current.contains(u.target)&&o(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),t.length===0?null:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:i?"var(--text-primary)":"var(--text-muted)",background:i?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:i?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,a.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),s&&a.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>a.jsxs("button",{onClick:()=>{n(c.id),o(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&a.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function cg({label:e,isSelected:t,onClick:r}){return a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function VB({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:i=[],onArtifactSave:s,onCreateDcwWorkflow:o,initialTab:l=null,docTypeSource:c=null}){var Le,q,V;const[u,d]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&d(l)},[l]);const[f,h]=m.useState("source"),[p,y]=m.useState(null),[g,w]=m.useState(!1),[v,x]=m.useState(null),[b,_]=m.useState(null),[j,S]=m.useState(!1),[C,E]=m.useState(null),[k,R]=m.useState(null),[T,I]=m.useState(!1),[F,N]=m.useState(null),[P,O]=m.useState(null),[H,D]=m.useState(!1),[A,L]=m.useState(null),M=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const z=t.role_prompt_ref.split(":");return z.length!==4||z[0]!=="prompt"||z[1]!=="role"?null:{roleId:z[2],version:z[3]}},[t==null?void 0:t.role_prompt_ref]),$=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const z=t.template_ref.split(":");return z.length!==4||z[0]!=="prompt"||z[1]!=="template"?null:{templateId:z[2],version:z[3]}},[t==null?void 0:t.template_ref]),W=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const z=t.qa_template_ref.split(":");return z.length!==4||z[0]!=="prompt"||z[1]!=="template"?null:{templateId:z[2],version:z[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const z=t.pgc_template_ref.split(":");return z.length!==4||z[0]!=="prompt"||z[1]!=="template"?null:{templateId:z[2],version:z[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!M){y(null);return}w(!0),x(null),ke.getRole(M.roleId,M.version).then(z=>{y(z.content)}).catch(z=>{console.error("Failed to load role:",z),x(z.message)}).finally(()=>{w(!1)})},[M]),m.useEffect(()=>{if(!$){_(null);return}S(!0),E(null),ke.getTemplate($.templateId,$.version).then(z=>{_(z.content)}).catch(z=>{console.error("Failed to load template:",z),E(z.message)}).finally(()=>{S(!1)})},[$]),m.useEffect(()=>{if(!W){R(null);return}I(!0),N(null),ke.getTemplate(W.templateId,W.version).then(z=>{R(z.content)}).catch(z=>{console.error("Failed to load QA template:",z),N(z.message)}).finally(()=>{I(!1)})},[W]),m.useEffect(()=>{if(!B){O(null);return}D(!0),L(null),ke.getTemplate(B.templateId,B.version).then(z=>{O(z.content)}).catch(z=>{console.error("Failed to load PGC template:",z),L(z.message)}).finally(()=>{D(!1)})},[B]);const Y=m.useMemo(()=>{if(!t||u==="role_prompt")return null;const z=t.version||t.active_version;return`doctype:${t.doc_type_id}:${z}:${u}`},[t,u]),{content:Z,loading:ie,error:re,saving:de,isDirty:ee,updateContent:_e,lastSaveResult:ue}=Sa(e,Y,{onSave:z=>{s==null||s(Y,z)}}),Te=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],pe=m.useMemo(()=>t?Te.filter(z=>z.id==="package"?!0:z.id==="role_prompt"?!!t.role_prompt_ref:z.id==="template"?!!t.template_ref:z.id==="qa_template"?!!t.qa_template_ref:z.id==="pgc_template"?!!t.pgc_template_ref:z.id==="workflow"?!0:t.artifacts?t.artifacts[z.id]!=null:!1):[],[t]),te=c==="task"||c==="schema";m.useEffect(()=>{te||pe.length>0&&!pe.find(z=>z.id===u)&&d(pe[0].id)},[pe,u,te]);const xe=u==="role_prompt"||u==="template"||u==="qa_template"||u==="pgc_template",K=u==="package",X=u==="schema",fe=u==="workflow",me=!xe&&!K&&!X&&!fe,ye=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:i.some(z=>z.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,i]),[ve,he]=m.useState(!1),be=async()=>{if(!(!(t!=null&&t.doc_type_id)||!o)){he(!0);try{await o(t.doc_type_id)}finally{he(!1)}}};if(!t&&!r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),a.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),a.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const Fe=c==="task"?"Interaction":c==="schema"?"Schema":null,Se=!te&&(u==="task_prompt"||u==="schema");return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),a.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:te?Fe:a.jsxs(a.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),te&&a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!te&&a.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[pe.find(z=>z.id==="package")&&a.jsx(cg,{label:"Package",isSelected:u==="package",onClick:()=>{d("package"),h("source")}}),pe.find(z=>z.id==="workflow")&&a.jsx(cg,{label:"Workflow",isSelected:u==="workflow",onClick:()=>{d("workflow"),h("source")}}),(()=>{const z=["role_prompt","task_prompt","template"],J=pe.filter(le=>z.includes(le.id)).map(le=>({id:le.id,label:le.id==="role_prompt"?"Role":le.id==="task_prompt"?"Task":"Template",viewOnly:le.viewOnly}));return J.length===0?null:a.jsx(lg,{label:"Generation",items:J,selectedId:z.includes(u)?u:null,onSelect:le=>{d(le),h("source")},isGroupActive:z.includes(u)})})(),(()=>{const z=["qa_prompt","qa_template"],J=pe.filter(le=>z.includes(le.id)).map(le=>({id:le.id,label:le.id==="qa_prompt"?"Prompt":"Template",viewOnly:le.viewOnly}));return J.length===0?null:a.jsx(lg,{label:"QA",items:J,selectedId:z.includes(u)?u:null,onSelect:le=>{d(le),h("source")},isGroupActive:z.includes(u)})})(),(()=>{const z=["pgc_context","pgc_template"],J=pe.filter(le=>z.includes(le.id)).map(le=>({id:le.id,label:le.id==="pgc_context"?"Context":"Template",viewOnly:le.viewOnly}));return J.length===0?null:a.jsx(lg,{label:"PGC",items:J,selectedId:z.includes(u)?u:null,onSelect:le=>{d(le),h("source")},isGroupActive:z.includes(u)})})(),pe.find(z=>z.id==="schema")&&a.jsx(cg,{label:"Schema",isSelected:u==="schema",onClick:()=>{d("schema"),h("source")}})]}),!te&&me&&!Se&&a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>h("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:f==="source"?"var(--action-primary)":"transparent",color:f==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),a.jsx("button",{onClick:()=>h("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:f==="resolved"?"var(--action-primary)":"transparent",color:f==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),f==="source"&&((Le=t==null?void 0:t.artifacts)==null?void 0:Le[u])&&a.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[u]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[u]]})]}),xe&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:u==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),u==="role_prompt"&&M&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[M.roleId.replace(/_/g," ")," v",M.version]}),u==="template"&&$&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[$.templateId.replace(/_/g," ")," v",$.version]}),u==="qa_template"&&W&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[W.templateId.replace(/_/g," ")," v",W.version]}),u==="pgc_template"&&B&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Se&&a.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:u==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),X&&((q=t==null?void 0:t.artifacts)==null?void 0:q.schema)&&a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:fe?ye?a.jsx(WB,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 max-w-md",children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),a.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),o&&a.jsx("button",{onClick:be,disabled:ve,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:ve?"wait":"pointer",opacity:ve?.7:1},children:ve?"Creating...":"Create Workflow"})]})}):u==="package"?a.jsx(SB,{workspaceId:e,docType:t,roles:n,onSave:s}):u==="role_prompt"?a.jsx(en,{content:p||"",onChange:()=>{},loading:g,saving:!1,isDirty:!1,error:v,readOnly:!0,placeholder:"No role prompt configured for this document type"}):u==="template"?a.jsx(en,{content:b||"",onChange:()=>{},loading:j,saving:!1,isDirty:!1,error:C,readOnly:!0,placeholder:"No template configured for this document type"}):u==="qa_template"?a.jsx(en,{content:k||"",onChange:()=>{},loading:T,saving:!1,isDirty:!1,error:F,readOnly:!0,placeholder:"No QA template configured for this document type"}):u==="pgc_template"?a.jsx(en,{content:P||"",onChange:()=>{},loading:H,saving:!1,isDirty:!1,error:A,readOnly:!0,placeholder:"No PGC template configured for this document type"}):f==="source"||X?a.jsx(en,{content:Z,onChange:Se?()=>{}:_e,loading:ie,saving:Se?!1:de,isDirty:Se?!1:ee,error:re,readOnly:Se,placeholder:`Enter ${((V=pe.find(z=>z.id===u))==null?void 0:V.label)||"prompt"} content...`,isJson:X}):a.jsx(jB,{workspaceId:e,artifactId:Y})}),me&&(ue==null?void 0:ue.tier1)&&!ue.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function GB({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:i,loading:s,error:o,saving:l,isDirty:c,updateContent:u,lastSaveResult:d}=Sa(e,n,{onSave:h=>{r==null||r(n,h)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),a.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase());return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),a.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:i,onChange:u,loading:s,saving:l,isDirty:c,error:o,placeholder:"Enter role prompt content..."})}),(d==null?void 0:d.tier1)&&!d.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function qT(e){return typeof e>"u"||e===null}function KB(e){return typeof e=="object"&&e!==null}function YB(e){return Array.isArray(e)?e:qT(e)?[]:[e]}function XB(e,t){var r,n,i,s;if(t)for(s=Object.keys(t),r=0,n=s.length;r<n;r+=1)i=s[r],e[i]=t[i];return e}function QB(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function ZB(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var JB=qT,e9=KB,t9=YB,r9=QB,n9=ZB,i9=XB,dt={isNothing:JB,isObject:e9,toArray:t9,repeat:r9,isNegativeZero:n9,extend:i9};function zT(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function ia(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=zT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ia.prototype=Object.create(Error.prototype);ia.prototype.constructor=ia;ia.prototype.toString=function(t){return this.name+": "+zT(this,t)};var Ot=ia;function ug(e,t,r,n,i){var s="",o="",l=Math.floor(i/2)-1;return n-t>l&&(s=" ... ",t=n-l+s.length),r-n>l&&(o=" ...",r=n+l-o.length),{str:s+e.slice(t,r).replace(/\t/g,"")+o,pos:n-t+s.length}}function dg(e,t){return dt.repeat(" ",t-e.length)+e}function s9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],s,o=-1;s=r.exec(e.buffer);)i.push(s.index),n.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=n.length-2);o<0&&(o=n.length-1);var l="",c,u,d=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+d+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)u=ug(e.buffer,n[o-c],i[o-c],e.position-(n[o]-n[o-c]),f),l=dt.repeat(" ",t.indent)+dg((e.line-c+1).toString(),d)+" | "+u.str+`
`+l;for(u=ug(e.buffer,n[o],i[o],e.position,f),l+=dt.repeat(" ",t.indent)+dg((e.line+1).toString(),d)+" | "+u.str+`
`,l+=dt.repeat("-",t.indent+d+3+u.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)u=ug(e.buffer,n[o+c],i[o+c],e.position-(n[o]-n[o+c]),f),l+=dt.repeat(" ",t.indent)+dg((e.line+c+1).toString(),d)+" | "+u.str+`
`;return l.replace(/\n$/,"")}var o9=s9,a9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],l9=["scalar","sequence","mapping"];function c9(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function u9(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(a9.indexOf(r)===-1)throw new Ot('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=c9(t.styleAliases||null),l9.indexOf(this.kind)===-1)throw new Ot('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var jt=u9;function Jj(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(s,o){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(i=o)}),r[i]=n}),r}function d9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Iv(e){return this.extend(e)}Iv.prototype.extend=function(t){var r=[],n=[];if(t instanceof jt)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new Ot("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof jt))throw new Ot("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new Ot("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Ot("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof jt))throw new Ot("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Iv.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=Jj(i,"implicit"),i.compiledExplicit=Jj(i,"explicit"),i.compiledTypeMap=d9(i.compiledImplicit,i.compiledExplicit),i};var $T=Iv,BT=new jt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),HT=new jt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),WT=new jt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),UT=new $T({explicit:[BT,HT,WT]});function f9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function p9(){return null}function h9(e){return e===null}var VT=new jt("tag:yaml.org,2002:null",{kind:"scalar",resolve:f9,construct:p9,predicate:h9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function m9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function g9(e){return e==="true"||e==="True"||e==="TRUE"}function v9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var GT=new jt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:m9,construct:g9,predicate:v9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function x9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function y9(e){return 48<=e&&e<=55}function b9(e){return 48<=e&&e<=57}function w9(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!x9(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!y9(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!b9(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function _9(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function j9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!dt.isNegativeZero(e)}var KT=new jt("tag:yaml.org,2002:int",{kind:"scalar",resolve:w9,construct:_9,predicate:j9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),S9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function k9(e){return!(e===null||!S9.test(e)||e[e.length-1]==="_")}function C9(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var N9=/^[-+]?[0-9]+e/;function E9(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(dt.isNegativeZero(e))return"-0.0";return r=e.toString(10),N9.test(r)?r.replace("e",".e"):r}function T9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||dt.isNegativeZero(e))}var YT=new jt("tag:yaml.org,2002:float",{kind:"scalar",resolve:k9,construct:C9,predicate:T9,represent:E9,defaultStyle:"lowercase"}),XT=UT.extend({implicit:[VT,GT,KT,YT]}),QT=XT,ZT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),JT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function R9(e){return e===null?!1:ZT.exec(e)!==null||JT.exec(e)!==null}function A9(e){var t,r,n,i,s,o,l,c=0,u=null,d,f,h;if(t=ZT.exec(e),t===null&&(t=JT.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(s=+t[4],o=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(d=+t[10],f=+(t[11]||0),u=(d*60+f)*6e4,t[9]==="-"&&(u=-u)),h=new Date(Date.UTC(r,n,i,s,o,l,c)),u&&h.setTime(h.getTime()-u),h}function I9(e){return e.toISOString()}var eR=new jt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:R9,construct:A9,instanceOf:Date,represent:I9});function M9(e){return e==="<<"||e===null}var tR=new jt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:M9}),wy=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function P9(e){if(e===null)return!1;var t,r,n=0,i=e.length,s=wy;for(r=0;r<i;r++)if(t=s.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function O9(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,s=wy,o=0,l=[];for(t=0;t<i;t++)t%4===0&&t&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|s.indexOf(n.charAt(t));return r=i%4*6,r===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):r===18?(l.push(o>>10&255),l.push(o>>2&255)):r===12&&l.push(o>>4&255),new Uint8Array(l)}function D9(e){var t="",r=0,n,i,s=e.length,o=wy;for(n=0;n<s;n++)n%3===0&&n&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[n];return i=s%3,i===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):i===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):i===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function L9(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var rR=new jt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:P9,construct:O9,predicate:L9,represent:D9}),F9=Object.prototype.hasOwnProperty,q9=Object.prototype.toString;function z9(e){if(e===null)return!0;var t=[],r,n,i,s,o,l=e;for(r=0,n=l.length;r<n;r+=1){if(i=l[r],o=!1,q9.call(i)!=="[object Object]")return!1;for(s in i)if(F9.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function $9(e){return e!==null?e:[]}var nR=new jt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:z9,construct:$9}),B9=Object.prototype.toString;function H9(e){if(e===null)return!0;var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(n=o[t],B9.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;s[t]=[i[0],n[i[0]]]}return!0}function W9(e){if(e===null)return[];var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1)n=o[t],i=Object.keys(n),s[t]=[i[0],n[i[0]]];return s}var iR=new jt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:H9,construct:W9}),U9=Object.prototype.hasOwnProperty;function V9(e){if(e===null)return!0;var t,r=e;for(t in r)if(U9.call(r,t)&&r[t]!==null)return!1;return!0}function G9(e){return e!==null?e:{}}var sR=new jt("tag:yaml.org,2002:set",{kind:"mapping",resolve:V9,construct:G9}),_y=QT.extend({implicit:[eR,tR],explicit:[rR,nR,iR,sR]}),Xn=Object.prototype.hasOwnProperty,fc=1,oR=2,aR=3,pc=4,fg=1,K9=2,eS=3,Y9=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,X9=/[\x85\u2028\u2029]/,Q9=/[,\[\]\{\}]/,lR=/^(?:!|!!|![a-z\-]+!)$/i,cR=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function tS(e){return Object.prototype.toString.call(e)}function Wr(e){return e===10||e===13}function yi(e){return e===9||e===32}function Ht(e){return e===9||e===32||e===10||e===13}function is(e){return e===44||e===91||e===93||e===123||e===125}function Z9(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function J9(e){return e===120?2:e===117?4:e===85?8:0}function eH(e){return 48<=e&&e<=57?e-48:-1}function rS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function tH(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function uR(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var dR=new Array(256),fR=new Array(256);for(var Bi=0;Bi<256;Bi++)dR[Bi]=rS(Bi)?1:0,fR[Bi]=rS(Bi);function rH(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||_y,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function pR(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=o9(r),new Ot(t,r)}function ce(e,t){throw pR(e,t)}function hc(e,t){e.onWarning&&e.onWarning.call(null,pR(e,t))}var nS={YAML:function(t,r,n){var i,s,o;t.version!==null&&ce(t,"duplication of %YAML directive"),n.length!==1&&ce(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&ce(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&ce(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&hc(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,s;n.length!==2&&ce(t,"TAG directive accepts exactly two arguments"),i=n[0],s=n[1],lR.test(i)||ce(t,"ill-formed tag handle (first argument) of the TAG directive"),Xn.call(t.tagMap,i)&&ce(t,'there is a previously declared suffix for "'+i+'" tag handle'),cR.test(s)||ce(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{ce(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function Vn(e,t,r,n){var i,s,o,l;if(t<r){if(l=e.input.slice(t,r),n)for(i=0,s=l.length;i<s;i+=1)o=l.charCodeAt(i),o===9||32<=o&&o<=1114111||ce(e,"expected valid JSON character");else Y9.test(l)&&ce(e,"the stream contains non-printable characters");e.result+=l}}function iS(e,t,r,n){var i,s,o,l;for(dt.isObject(r)||ce(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),o=0,l=i.length;o<l;o+=1)s=i[o],Xn.call(t,s)||(uR(t,s,r[s]),n[s]=!0)}function ss(e,t,r,n,i,s,o,l,c){var u,d;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),u=0,d=i.length;u<d;u+=1)Array.isArray(i[u])&&ce(e,"nested arrays are not supported inside keys"),typeof i=="object"&&tS(i[u])==="[object Object]"&&(i[u]="[object Object]");if(typeof i=="object"&&tS(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(u=0,d=s.length;u<d;u+=1)iS(e,t,s[u],r);else iS(e,t,s,r);else!e.json&&!Xn.call(r,i)&&Xn.call(t,i)&&(e.line=o||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,ce(e,"duplicated mapping key")),uR(t,i,s),delete r[i];return t}function jy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):ce(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ot(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;yi(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Wr(i))for(jy(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&hc(e,"deficient indentation"),n}function pu(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Ht(r)))}function Sy(e,t){t===1?e.result+=" ":t>1&&(e.result+=dt.repeat(`
`,t-1))}function nH(e,t,r){var n,i,s,o,l,c,u,d,f=e.kind,h=e.result,p;if(p=e.input.charCodeAt(e.position),Ht(p)||is(p)||p===35||p===38||p===42||p===33||p===124||p===62||p===39||p===34||p===37||p===64||p===96||(p===63||p===45)&&(i=e.input.charCodeAt(e.position+1),Ht(i)||r&&is(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,l=!1;p!==0;){if(p===58){if(i=e.input.charCodeAt(e.position+1),Ht(i)||r&&is(i))break}else if(p===35){if(n=e.input.charCodeAt(e.position-1),Ht(n))break}else{if(e.position===e.lineStart&&pu(e)||r&&is(p))break;if(Wr(p))if(c=e.line,u=e.lineStart,d=e.lineIndent,ot(e,!1,-1),e.lineIndent>=t){l=!0,p=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=u,e.lineIndent=d;break}}l&&(Vn(e,s,o,!1),Sy(e,e.line-c),s=o=e.position,l=!1),yi(p)||(o=e.position+1),p=e.input.charCodeAt(++e.position)}return Vn(e,s,o,!1),e.result?!0:(e.kind=f,e.result=h,!1)}function iH(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Vn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else Wr(r)?(Vn(e,n,i,!0),Sy(e,ot(e,!1,t)),n=i=e.position):e.position===e.lineStart&&pu(e)?ce(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);ce(e,"unexpected end of the stream within a single quoted scalar")}function sH(e,t){var r,n,i,s,o,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Vn(e,r,e.position,!0),e.position++,!0;if(l===92){if(Vn(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Wr(l))ot(e,!1,t);else if(l<256&&dR[l])e.result+=fR[l],e.position++;else if((o=J9(l))>0){for(i=o,s=0;i>0;i--)l=e.input.charCodeAt(++e.position),(o=Z9(l))>=0?s=(s<<4)+o:ce(e,"expected hexadecimal character");e.result+=tH(s),e.position++}else ce(e,"unknown escape sequence");r=n=e.position}else Wr(l)?(Vn(e,r,n,!0),Sy(e,ot(e,!1,t)),r=n=e.position):e.position===e.lineStart&&pu(e)?ce(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}ce(e,"unexpected end of the stream within a double quoted scalar")}function oH(e,t){var r=!0,n,i,s,o=e.tag,l,c=e.anchor,u,d,f,h,p,y=Object.create(null),g,w,v,x;if(x=e.input.charCodeAt(e.position),x===91)d=93,p=!1,l=[];else if(x===123)d=125,p=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),x=e.input.charCodeAt(++e.position);x!==0;){if(ot(e,!0,t),x=e.input.charCodeAt(e.position),x===d)return e.position++,e.tag=o,e.anchor=c,e.kind=p?"mapping":"sequence",e.result=l,!0;r?x===44&&ce(e,"expected the node content, but found ','"):ce(e,"missed comma between flow collection entries"),w=g=v=null,f=h=!1,x===63&&(u=e.input.charCodeAt(e.position+1),Ht(u)&&(f=h=!0,e.position++,ot(e,!0,t))),n=e.line,i=e.lineStart,s=e.position,Ns(e,t,fc,!1,!0),w=e.tag,g=e.result,ot(e,!0,t),x=e.input.charCodeAt(e.position),(h||e.line===n)&&x===58&&(f=!0,x=e.input.charCodeAt(++e.position),ot(e,!0,t),Ns(e,t,fc,!1,!0),v=e.result),p?ss(e,l,y,w,g,v,n,i,s):f?l.push(ss(e,null,y,w,g,v,n,i,s)):l.push(g),ot(e,!0,t),x=e.input.charCodeAt(e.position),x===44?(r=!0,x=e.input.charCodeAt(++e.position)):r=!1}ce(e,"unexpected end of the stream within a flow collection")}function aH(e,t){var r,n,i=fg,s=!1,o=!1,l=t,c=0,u=!1,d,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)fg===i?i=f===43?eS:K9:ce(e,"repeat of a chomping mode identifier");else if((d=eH(f))>=0)d===0?ce(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?ce(e,"repeat of an indentation width identifier"):(l=t+d-1,o=!0);else break;if(yi(f)){do f=e.input.charCodeAt(++e.position);while(yi(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Wr(f)&&f!==0)}for(;f!==0;){for(jy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>l&&(l=e.lineIndent),Wr(f)){c++;continue}if(e.lineIndent<l){i===eS?e.result+=dt.repeat(`
`,s?1+c:c):i===fg&&s&&(e.result+=`
`);break}for(n?yi(f)?(u=!0,e.result+=dt.repeat(`
`,s?1+c:c)):u?(u=!1,e.result+=dt.repeat(`
`,c+1)):c===0?s&&(e.result+=" "):e.result+=dt.repeat(`
`,c):e.result+=dt.repeat(`
`,s?1+c:c),s=!0,o=!0,c=0,r=e.position;!Wr(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Vn(e,r,e.position,!1)}return!0}function sS(e,t){var r,n=e.tag,i=e.anchor,s=[],o,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,ce(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!Ht(o))));){if(l=!0,e.position++,ot(e,!0,-1)&&e.lineIndent<=t){s.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Ns(e,t,aR,!1,!0),s.push(e.result),ot(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)ce(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function lH(e,t,r){var n,i,s,o,l,c,u=e.tag,d=e.anchor,f={},h=Object.create(null),p=null,y=null,g=null,w=!1,v=!1,x;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),x=e.input.charCodeAt(e.position);x!==0;){if(!w&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,ce(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),s=e.line,(x===63||x===58)&&Ht(n))x===63?(w&&(ss(e,f,h,p,y,null,o,l,c),p=y=g=null),v=!0,w=!0,i=!0):w?(w=!1,i=!0):ce(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,x=n;else{if(o=e.line,l=e.lineStart,c=e.position,!Ns(e,r,oR,!1,!0))break;if(e.line===s){for(x=e.input.charCodeAt(e.position);yi(x);)x=e.input.charCodeAt(++e.position);if(x===58)x=e.input.charCodeAt(++e.position),Ht(x)||ce(e,"a whitespace character is expected after the key-value separator within a block mapping"),w&&(ss(e,f,h,p,y,null,o,l,c),p=y=g=null),v=!0,w=!1,i=!1,p=e.tag,y=e.result;else if(v)ce(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=u,e.anchor=d,!0}else if(v)ce(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=u,e.anchor=d,!0}if((e.line===s||e.lineIndent>t)&&(w&&(o=e.line,l=e.lineStart,c=e.position),Ns(e,t,pc,!0,i)&&(w?y=e.result:g=e.result),w||(ss(e,f,h,p,y,g,o,l,c),p=y=g=null),ot(e,!0,-1),x=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&x!==0)ce(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return w&&ss(e,f,h,p,y,null,o,l,c),v&&(e.tag=u,e.anchor=d,e.kind="mapping",e.result=f),v}function cH(e){var t,r=!1,n=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&ce(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(n=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):ce(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Ht(o);)o===33&&(n?ce(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),lR.test(i)||ce(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),Q9.test(s)&&ce(e,"tag suffix cannot contain flow indicator characters")}s&&!cR.test(s)&&ce(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{ce(e,"tag name is malformed: "+s)}return r?e.tag=s:Xn.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:ce(e,'undeclared tag handle "'+i+'"'),!0}function uH(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&ce(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ht(r)&&!is(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&ce(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function dH(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ht(n)&&!is(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&ce(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Xn.call(e.anchorMap,r)||ce(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],ot(e,!0,-1),!0}function Ns(e,t,r,n,i){var s,o,l,c=1,u=!1,d=!1,f,h,p,y,g,w;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=l=pc===r||aR===r,n&&ot(e,!0,-1)&&(u=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;cH(e)||uH(e);)ot(e,!0,-1)?(u=!0,l=s,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=u||i),(c===1||pc===r)&&(fc===r||oR===r?g=t:g=t+1,w=e.position-e.lineStart,c===1?l&&(sS(e,w)||lH(e,w,g))||oH(e,g)?d=!0:(o&&aH(e,g)||iH(e,g)||sH(e,g)?d=!0:dH(e)?(d=!0,(e.tag!==null||e.anchor!==null)&&ce(e,"alias node should not have any properties")):nH(e,g,fc===r)&&(d=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(d=l&&sS(e,w))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&ce(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,h=e.implicitTypes.length;f<h;f+=1)if(y=e.implicitTypes[f],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xn.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,p=e.typeMap.multi[e.kind||"fallback"],f=0,h=p.length;f<h;f+=1)if(e.tag.slice(0,p[f].tag.length)===p[f].tag){y=p[f];break}y||ce(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&ce(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):ce(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||d}function fH(e){var t=e.position,r,n,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(ot(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!Ht(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&ce(e,"directive name must not be less than one character in length");o!==0;){for(;yi(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Wr(o));break}if(Wr(o))break;for(r=e.position;o!==0&&!Ht(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}o!==0&&jy(e),Xn.call(nS,n)?nS[n](e,n,i):hc(e,'unknown document directive "'+n+'"')}if(ot(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,ot(e,!0,-1)):s&&ce(e,"directives end mark is expected"),Ns(e,e.lineIndent-1,pc,!1,!0),ot(e,!0,-1),e.checkLineBreaks&&X9.test(e.input.slice(t,e.position))&&hc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&pu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,ot(e,!0,-1));return}if(e.position<e.length-1)ce(e,"end of the stream or a document separator is expected");else return}function hR(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new rH(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,ce(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)fH(r);return r.documents}function pH(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=hR(e,r);if(typeof t!="function")return n;for(var i=0,s=n.length;i<s;i+=1)t(n[i])}function hH(e,t){var r=hR(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new Ot("expected a single document in the stream, but found more")}}var mH=pH,gH=hH,mR={loadAll:mH,load:gH},gR=Object.prototype.toString,vR=Object.prototype.hasOwnProperty,ky=65279,vH=9,sa=10,xH=13,yH=32,bH=33,wH=34,Mv=35,_H=37,jH=38,SH=39,kH=42,xR=44,CH=45,mc=58,NH=61,EH=62,TH=63,RH=64,yR=91,bR=93,AH=96,wR=123,IH=124,_R=125,At={};At[0]="\\0";At[7]="\\a";At[8]="\\b";At[9]="\\t";At[10]="\\n";At[11]="\\v";At[12]="\\f";At[13]="\\r";At[27]="\\e";At[34]='\\"';At[92]="\\\\";At[133]="\\N";At[160]="\\_";At[8232]="\\L";At[8233]="\\P";var MH=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],PH=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function OH(e,t){var r,n,i,s,o,l,c;if(t===null)return{};for(r={},n=Object.keys(t),i=0,s=n.length;i<s;i+=1)o=n[i],l=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&vR.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[o]=l;return r}function DH(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new Ot("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+dt.repeat("0",n-t.length)+t}var LH=1,oa=2;function FH(e){this.schema=e.schema||_y,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=dt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=OH(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?oa:LH,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function oS(e,t){for(var r=dt.repeat(" ",t),n=0,i=-1,s="",o,l=e.length;n<l;)i=e.indexOf(`
`,n),i===-1?(o=e.slice(n),n=l):(o=e.slice(n,i+1),n=i+1),o.length&&o!==`
`&&(s+=r),s+=o;return s}function Pv(e,t){return`
`+dt.repeat(" ",e.indent*t)}function qH(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function gc(e){return e===yH||e===vH}function aa(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==ky||65536<=e&&e<=1114111}function aS(e){return aa(e)&&e!==ky&&e!==xH&&e!==sa}function lS(e,t,r){var n=aS(e),i=n&&!gc(e);return(r?n:n&&e!==xR&&e!==yR&&e!==bR&&e!==wR&&e!==_R)&&e!==Mv&&!(t===mc&&!i)||aS(t)&&!gc(t)&&e===Mv||t===mc&&i}function zH(e){return aa(e)&&e!==ky&&!gc(e)&&e!==CH&&e!==TH&&e!==mc&&e!==xR&&e!==yR&&e!==bR&&e!==wR&&e!==_R&&e!==Mv&&e!==jH&&e!==kH&&e!==bH&&e!==IH&&e!==NH&&e!==EH&&e!==SH&&e!==wH&&e!==_H&&e!==RH&&e!==AH}function $H(e){return!gc(e)&&e!==mc}function yo(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function jR(e){var t=/^\n* /;return t.test(e)}var SR=1,Ov=2,kR=3,CR=4,Hi=5;function BH(e,t,r,n,i,s,o,l){var c,u=0,d=null,f=!1,h=!1,p=n!==-1,y=-1,g=zH(yo(e,0))&&$H(yo(e,e.length-1));if(t||o)for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=yo(e,c),!aa(u))return Hi;g=g&&lS(u,d,l),d=u}else{for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=yo(e,c),u===sa)f=!0,p&&(h=h||c-y-1>n&&e[y+1]!==" ",y=c);else if(!aa(u))return Hi;g=g&&lS(u,d,l),d=u}h=h||p&&c-y-1>n&&e[y+1]!==" "}return!f&&!h?g&&!o&&!i(e)?SR:s===oa?Hi:Ov:r>9&&jR(e)?Hi:o?s===oa?Hi:Ov:h?CR:kR}function HH(e,t,r,n,i){e.dump=function(){if(t.length===0)return e.quotingType===oa?'""':"''";if(!e.noCompatMode&&(MH.indexOf(t)!==-1||PH.test(t)))return e.quotingType===oa?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(u){return qH(e,u)}switch(BH(t,l,e.indent,o,c,e.quotingType,e.forceQuotes&&!n,i)){case SR:return t;case Ov:return"'"+t.replace(/'/g,"''")+"'";case kR:return"|"+cS(t,e.indent)+uS(oS(t,s));case CR:return">"+cS(t,e.indent)+uS(oS(WH(t,o),s));case Hi:return'"'+UH(t)+'"';default:throw new Ot("impossible error: invalid scalar style")}}()}function cS(e,t){var r=jR(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),s=i?"+":n?"":"-";return r+s+`
`}function uS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function WH(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var u=e.indexOf(`
`);return u=u!==-1?u:e.length,r.lastIndex=u,dS(e.slice(0,u),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=r.exec(e);){var l=o[1],c=o[2];s=c[0]===" ",n+=l+(!i&&!s&&c!==""?`
`:"")+dS(c,t),i=s}return n}function dS(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,s,o=0,l=0,c="";n=r.exec(e);)l=n.index,l-i>t&&(s=o>i?o:l,c+=`
`+e.slice(i,s),i=s+1),o=l;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function UH(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=yo(e,i),n=At[r],!n&&aa(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||DH(r);return t}function VH(e,t,r){var n="",i=e.tag,s,o,l;for(s=0,o=r.length;s<o;s+=1)l=r[s],e.replacer&&(l=e.replacer.call(r,String(s),l)),(gn(e,t,l,!1,!1)||typeof l>"u"&&gn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function fS(e,t,r,n){var i="",s=e.tag,o,l,c;for(o=0,l=r.length;o<l;o+=1)c=r[o],e.replacer&&(c=e.replacer.call(r,String(o),c)),(gn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&gn(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Pv(e,t)),e.dump&&sa===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function GH(e,t,r){var n="",i=e.tag,s=Object.keys(r),o,l,c,u,d;for(o=0,l=s.length;o<l;o+=1)d="",n!==""&&(d+=", "),e.condenseFlow&&(d+='"'),c=s[o],u=r[c],e.replacer&&(u=e.replacer.call(r,c,u)),gn(e,t,c,!1,!1)&&(e.dump.length>1024&&(d+="? "),d+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),gn(e,t,u,!1,!1)&&(d+=e.dump,n+=d));e.tag=i,e.dump="{"+n+"}"}function KH(e,t,r,n){var i="",s=e.tag,o=Object.keys(r),l,c,u,d,f,h;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new Ot("sortKeys must be a boolean or a function");for(l=0,c=o.length;l<c;l+=1)h="",(!n||i!=="")&&(h+=Pv(e,t)),u=o[l],d=r[u],e.replacer&&(d=e.replacer.call(r,u,d)),gn(e,t+1,u,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&sa===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,f&&(h+=Pv(e,t)),gn(e,t+1,d,!0,f)&&(e.dump&&sa===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,i+=h));e.tag=s,e.dump=i||"{}"}function pS(e,t,r){var n,i,s,o,l,c;for(i=r?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(l=i[s],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,gR.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(vR.call(l.represent,c))n=l.represent[c](t,c);else throw new Ot("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function gn(e,t,r,n,i,s,o){e.tag=null,e.dump=r,pS(e,r,!1)||pS(e,r,!0);var l=gR.call(e.dump),c=n,u;n&&(n=e.flowLevel<0||e.flowLevel>t);var d=l==="[object Object]"||l==="[object Array]",f,h;if(d&&(f=e.duplicates.indexOf(r),h=f!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(i=!1),h&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(d&&h&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(KH(e,t,e.dump,i),h&&(e.dump="&ref_"+f+e.dump)):(GH(e,t,e.dump),h&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?fS(e,t-1,e.dump,i):fS(e,t,e.dump,i),h&&(e.dump="&ref_"+f+e.dump)):(VH(e,t,e.dump),h&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&HH(e,e.dump,t,s,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Ot("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(u=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",e.dump=u+" "+e.dump)}return!0}function YH(e,t){var r=[],n=[],i,s;for(Dv(e,r,n),i=0,s=n.length;i<s;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(s)}function Dv(e,t,r){var n,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Dv(e[i],t,r);else for(n=Object.keys(e),i=0,s=n.length;i<s;i+=1)Dv(e[n[i]],t,r)}function XH(e,t){t=t||{};var r=new FH(t);r.noRefs||YH(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),gn(r,0,n,!0,!0)?r.dump+`
`:""}var QH=XH,ZH={dump:QH};function Cy(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var JH=jt,e7=$T,t7=UT,r7=XT,n7=QT,i7=_y,s7=mR.load,o7=mR.loadAll,a7=ZH.dump,l7=Ot,c7={binary:rR,float:YT,map:WT,null:VT,pairs:iR,set:sR,timestamp:eR,bool:GT,int:KT,merge:tR,omap:nR,seq:HT,str:BT},u7=Cy("safeLoad","load"),d7=Cy("safeLoadAll","loadAll"),f7=Cy("safeDump","dump"),NR={Type:JH,Schema:e7,FAILSAFE_SCHEMA:t7,JSON_SCHEMA:r7,CORE_SCHEMA:n7,DEFAULT_SCHEMA:i7,load:s7,loadAll:o7,dump:a7,YAMLException:l7,types:c7,safeLoad:u7,safeLoadAll:d7,safeDump:f7};const p7=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],pg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},hg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function h7({workspaceId:e,template:t,onArtifactSave:r}){const[n,i]=m.useState("metadata"),[s,o]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[u,d]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,h=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:p,loading:y,error:g,saving:w,isDirty:v,updateContent:x,lastSaveResult:b}=Sa(e,f,{onSave:k=>{r==null||r(f,k)}});m.useEffect(()=>{t&&(o({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const _=m.useCallback((k,R)=>{o(T=>({...T,[k]:R})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!h)){d(!0);try{const k=NR.dump({name:s.name||null,purpose:s.purpose||null,use_case:s.use_case||null},{lineWidth:-1});await ke.writeArtifact(e,h,k),c(!1),r==null||r(h,{success:!0})}catch(k){console.error("Failed to save metadata:",k),alert(`Failed to save metadata: ${k.message}`)}finally{d(!1)}}},[e,h,s,r]),S=m.useCallback(()=>{l&&j()},[l,j]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),a.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const C=s.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,k=>k.toUpperCase()),E=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:C}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.active_version]}),a.jsx("span",{children:""}),a.jsx("span",{children:"Shared Template"}),s.purpose&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:s.purpose})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:E.map(k=>a.jsxs("button",{onClick:()=>i(k.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===k.id?"var(--text-primary)":"var(--text-muted)",background:n===k.id?"var(--bg-canvas)":"transparent",borderBottom:n===k.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[k.label,k.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),k.id==="template"&&v&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},k.id))}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:hg,children:"Template Name"}),a.jsx("input",{type:"text",value:s.name,onChange:k=>_("name",k.target.value),onBlur:S,placeholder:"e.g., Document Generator",style:pg}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),a.jsxs("div",{children:[a.jsx("label",{style:hg,children:"Template Purpose"}),a.jsx("select",{value:s.purpose,onChange:k=>{_("purpose",k.target.value),setTimeout(()=>j(),0)},style:pg,children:p7.map(k=>a.jsx("option",{value:k.value,children:k.label},k.value))}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),a.jsxs("div",{children:[a.jsx("label",{style:hg,children:"Use Case"}),a.jsx("textarea",{value:s.use_case,onChange:k=>_("use_case",k.target.value),onBlur:S,placeholder:"Describe when and how this template should be used...",rows:4,style:{...pg,resize:"vertical"}}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),u&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:p,onChange:x,loading:y,saving:w,isDirty:v,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function m7({workspaceId:e,schema:t,onArtifactSave:r}){var v;const[n,i]=m.useState("content"),s=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:o,loading:l,error:c,saving:u,isDirty:d,updateContent:f,lastSaveResult:h}=Sa(e,s,{onSave:x=>{r==null||r(s,x)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),a.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const p=t.title||((v=t.schema_id)==null?void 0:v.replace(/_/g," "))||"Schema",y=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],w=!e;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[p,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",y]}),w&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(x=>a.jsxs("button",{onClick:()=>i(x.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===x.id?"var(--text-primary)":"var(--text-muted)",background:n===x.id?"var(--bg-canvas)":"transparent",borderBottom:n===x.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[x.label,x.id==="content"&&d&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},x.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:o,onChange:f,loading:l,saving:u,isDirty:d,error:c,placeholder:"Enter JSON schema...",readOnly:w,isJson:!0})}),n==="info"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Schema ID"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Version"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:y})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Title (from JSON)"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),a.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"File Path"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",y,"/schema.json"]})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Artifact ID"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",y]})]})]})}),(h==null?void 0:h.tier1)&&!h.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const g7={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},v7={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},mg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},so={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function x7({workspaceId:e,fragment:t,onArtifactSave:r}){var L;const[n,i]=m.useState("content"),[s,o]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[u,d]=m.useState(!1),[f,h]=m.useState(""),[p,y]=((L=t==null?void 0:t.fragment_id)==null?void 0:L.split(":"))||[null,null],g=t?p==="role"?`fragment:role:${y}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${p}_prompt`:null,w=t&&p==="role"?`fragment:role:${y}:${t.version}:meta`:null,{content:v,loading:x,error:b,saving:_,isDirty:j,updateContent:S,lastSaveResult:C}=Sa(e,g,{onSave:M=>{r==null||r(g,M)}});m.useEffect(()=>{t&&(o({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const E=m.useCallback((M,$)=>{o(W=>({...W,[M]:$})),c(!0)},[]),k=m.useCallback(async()=>{if(!(!e||!w)){d(!0);try{const M=NR.dump({name:s.name||null,intent:s.intent||null,tags:s.tags.length>0?s.tags:null},{lineWidth:-1});await ke.writeArtifact(e,w,M),c(!1),r==null||r(w,{success:!0})}catch(M){console.error("Failed to save metadata:",M),alert(`Failed to save metadata: ${M.message}`)}finally{d(!1)}}},[e,w,s,r]),R=m.useCallback(()=>{l&&w&&k()},[l,w,k]),T=m.useCallback(()=>{const M=f.trim().toLowerCase();M&&!s.tags.includes(M)&&(E("tags",[...s.tags,M]),h(""))},[f,s.tags,E]),I=m.useCallback(M=>{E("tags",s.tags.filter($=>$!==M))},[s.tags,E]),F=m.useCallback(M=>{M.key==="Enter"&&(M.preventDefault(),T())},[T]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),a.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const N=s.name||t.name||t.fragment_id,P=g7[p]||p,O=v7[p]||"var(--text-muted)",H=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],D=!e,A=w&&!D;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[N,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:O,color:"#fff"},children:P})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsxs("span",{children:["from ",t.source_doc_type]})]}),D&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:H.map(M=>a.jsxs("button",{onClick:()=>i(M.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===M.id?"var(--text-primary)":"var(--text-muted)",background:n===M.id?"var(--bg-canvas)":"transparent",borderBottom:n===M.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[M.label,M.id==="content"&&j&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),M.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},M.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:v,onChange:S,loading:x,saving:_,isDirty:j,error:b,placeholder:"Enter prompt content...",readOnly:D})}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Kind"}),a.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:O}}),a.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:P})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Name"}),a.jsx("input",{type:"text",value:s.name,onChange:M=>E("name",M.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:mg,disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Intent"}),a.jsx("textarea",{value:s.intent,onChange:M=>E("intent",M.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...mg,resize:"vertical"},disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:s.tags.map(M=>a.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[M,A&&a.jsx("button",{onClick:()=>I(M),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},M))}),A&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:f,onChange:M=>h(M.target.value),onKeyDown:F,placeholder:"Add tag...",style:{...mg,flex:1}}),a.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Source"}),a.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",a.jsx("strong",{children:t.source_doc_type})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),u&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!A&&!t.source_doc_type&&a.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(C==null?void 0:C.tier1)&&!C.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function y7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(i=>i(n))},t)}const hu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Fs(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ny(e){return"nodeType"in e}function Yt(e){var t,r;return e?Fs(e)?e:Ny(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Ey(e){const{Document:t}=Yt(e);return e instanceof t}function ka(e){return Fs(e)?!1:e instanceof Yt(e).HTMLElement}function ER(e){return e instanceof Yt(e).SVGElement}function qs(e){return e?Fs(e)?e.document:Ny(e)?Ey(e)?e:ka(e)||ER(e)?e.ownerDocument:document:document:document}const Vr=hu?m.useLayoutEffect:m.useEffect;function Ty(e){const t=m.useRef(e);return Vr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function b7(){const e=m.useRef(null),t=m.useCallback((n,i)=>{e.current=setInterval(n,i)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function la(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Vr(()=>{r.current!==e&&(r.current=e)},t),r}function Ca(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function vc(e){const t=Ty(e),r=m.useRef(null),n=m.useCallback(i=>{i!==r.current&&(t==null||t(i,r.current)),r.current=i},[]);return[r,n]}function Lv(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let gg={};function Na(e,t){return m.useMemo(()=>{if(t)return t;const r=gg[e]==null?0:gg[e]+1;return gg[e]=r,e+"-"+r},[e,t])}function TR(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((s,o)=>{const l=Object.entries(o);for(const[c,u]of l){const d=s[c];d!=null&&(s[c]=d+e*u)}return s},{...t})}}const ms=TR(1),ca=TR(-1);function w7(e){return"clientX"in e&&"clientY"in e}function Ry(e){if(!e)return!1;const{KeyboardEvent:t}=Yt(e.target);return t&&e instanceof t}function _7(e){if(!e)return!1;const{TouchEvent:t}=Yt(e.target);return t&&e instanceof t}function Fv(e){if(_7(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return w7(e)?{x:e.clientX,y:e.clientY}:null}const Es=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Es.Translate.toString(e),Es.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),hS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function j7(e){return e.matches(hS)?e:e.querySelector(hS)}const S7={display:"none"};function k7(e){let{id:t,value:r}=e;return G.createElement("div",{id:t,style:S7},r)}function C7(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return G.createElement("div",{id:t,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function N7(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const RR=m.createContext(null);function E7(e){const t=m.useContext(RR);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function T7(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:i,event:s}=n;e.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[e]),t]}const R7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},A7={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function I7(e){let{announcements:t=A7,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=R7}=e;const{announce:s,announcement:o}=N7(),l=Na("DndLiveRegion"),[c,u]=m.useState(!1);if(m.useEffect(()=>{u(!0)},[]),E7(m.useMemo(()=>({onDragStart(f){let{active:h}=f;s(t.onDragStart({active:h}))},onDragMove(f){let{active:h,over:p}=f;t.onDragMove&&s(t.onDragMove({active:h,over:p}))},onDragOver(f){let{active:h,over:p}=f;s(t.onDragOver({active:h,over:p}))},onDragEnd(f){let{active:h,over:p}=f;s(t.onDragEnd({active:h,over:p}))},onDragCancel(f){let{active:h,over:p}=f;s(t.onDragCancel({active:h,over:p}))}}),[s,t])),!c)return null;const d=G.createElement(G.Fragment,null,G.createElement(k7,{id:n,value:i.draggable}),G.createElement(C7,{id:l,announcement:o}));return r?rs.createPortal(d,r):d}var ut;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ut||(ut={}));function xc(){}function yc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function AR(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Rr=Object.freeze({x:0,y:0});function IR(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function MR(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function M7(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function mS(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function PR(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function gS(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const OR=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=gS(t,t.left,t.top),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=IR(gS(c),i);s.push({id:l,data:{droppableContainer:o,value:u}})}}return s.sort(MR)},P7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=mS(t),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const u=mS(c),d=i.reduce((h,p,y)=>h+IR(u[y],p),0),f=Number((d/4).toFixed(4));s.push({id:l,data:{droppableContainer:o,value:f}})}}return s.sort(MR)};function O7(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),o=i-n,l=s-r;if(n<i&&r<s){const c=t.width*t.height,u=e.width*e.height,d=o*l,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const D7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=[];for(const s of n){const{id:o}=s,l=r.get(o);if(l){const c=O7(l,t);c>0&&i.push({id:o,data:{droppableContainer:s,value:c}})}}return i.sort(M7)};function L7(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function DR(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Rr}function F7(e){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...r})}}const q7=F7(1);function z7(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function $7(e,t,r){const n=z7(t);if(!n)return e;const{scaleX:i,scaleY:s,x:o,y:l}=n,c=e.left-o-(1-i)*parseFloat(r),u=e.top-l-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?e.width/i:e.width,f=s?e.height/s:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const B7={ignoreTransform:!1};function zs(e,t){t===void 0&&(t=B7);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Yt(e).getComputedStyle(e);u&&(r=$7(r,u,d))}const{top:n,left:i,width:s,height:o,bottom:l,right:c}=r;return{top:n,left:i,width:s,height:o,bottom:l,right:c}}function vS(e){return zs(e,{ignoreTransform:!0})}function H7(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function W7(e,t){return t===void 0&&(t=Yt(e).getComputedStyle(e)),t.position==="fixed"}function U7(e,t){t===void 0&&(t=Yt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?r.test(s):!1})}function mu(e,t){const r=[];function n(i){if(t!=null&&r.length>=t||!i)return r;if(Ey(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!ka(i)||ER(i)||r.includes(i))return r;const s=Yt(e).getComputedStyle(i);return i!==e&&U7(i,s)&&r.push(i),W7(i,s)?r:n(i.parentNode)}return e?n(e):r}function LR(e){const[t]=mu(e,1);return t??null}function vg(e){return!hu||!e?null:Fs(e)?e:Ny(e)?Ey(e)||e===qs(e).scrollingElement?window:ka(e)?e:null:null}function FR(e){return Fs(e)?e.scrollX:e.scrollLeft}function qR(e){return Fs(e)?e.scrollY:e.scrollTop}function qv(e){return{x:FR(e),y:qR(e)}}var gt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(gt||(gt={}));function zR(e){return!hu||!e?!1:e===document.scrollingElement}function $R(e){const t={x:0,y:0},r=zR(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,o=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:n,minScroll:t}}const V7={x:.2,y:.2};function G7(e,t,r,n,i){let{top:s,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=V7);const{isTop:u,isBottom:d,isLeft:f,isRight:h}=$R(e),p={x:0,y:0},y={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!u&&s<=t.top+g.height?(p.y=gt.Backward,y.y=n*Math.abs((t.top+g.height-s)/g.height)):!d&&c>=t.bottom-g.height&&(p.y=gt.Forward,y.y=n*Math.abs((t.bottom-g.height-c)/g.height)),!h&&l>=t.right-g.width?(p.x=gt.Forward,y.x=n*Math.abs((t.right-g.width-l)/g.width)):!f&&o<=t.left+g.width&&(p.x=gt.Backward,y.x=n*Math.abs((t.left+g.width-o)/g.width)),{direction:p,speed:y}}function K7(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function BR(e){return e.reduce((t,r)=>ms(t,qv(r)),Rr)}function Y7(e){return e.reduce((t,r)=>t+FR(r),0)}function X7(e){return e.reduce((t,r)=>t+qR(r),0)}function Q7(e,t){if(t===void 0&&(t=zs),!e)return;const{top:r,left:n,bottom:i,right:s}=t(e);LR(e)&&(i<=0||s<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Z7=[["x",["left","right"],Y7],["y",["top","bottom"],X7]];class Ay{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=mu(r),i=BR(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,o,l]of Z7)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(n),d=i[s]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ro{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var i;(i=this.target)==null||i.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function J7(e){const{EventTarget:t}=Yt(e);return e instanceof t?e:qs(e)}function xg(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ar;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ar||(ar={}));function xS(e){e.preventDefault()}function eW(e){e.stopPropagation()}var Ee;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ee||(Ee={}));const HR={start:[Ee.Space,Ee.Enter],cancel:[Ee.Esc],end:[Ee.Space,Ee.Enter,Ee.Tab]},tW=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Ee.Right:return{...r,x:r.x+25};case Ee.Left:return{...r,x:r.x-25};case Ee.Down:return{...r,y:r.y+25};case Ee.Up:return{...r,y:r.y-25}}};class gu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Ro(qs(r)),this.windowListeners=new Ro(Yt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ar.Resize,this.handleCancel),this.windowListeners.add(ar.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ar.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&Q7(n),r(Rr)}handleKeyDown(t){if(Ry(t)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:s=HR,coordinateGetter:o=tW,scrollBehavior:l="smooth"}=i,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:Rr;this.referenceCoordinates||(this.referenceCoordinates=d);const f=o(t,{active:r,context:n.current,currentCoordinates:d});if(f){const h=ca(f,d),p={x:0,y:0},{scrollableAncestors:y}=n.current;for(const g of y){const w=t.code,{isTop:v,isRight:x,isLeft:b,isBottom:_,maxScroll:j,minScroll:S}=$R(g),C=K7(g),E={x:Math.min(w===Ee.Right?C.right-C.width/2:C.right,Math.max(w===Ee.Right?C.left:C.left+C.width/2,f.x)),y:Math.min(w===Ee.Down?C.bottom-C.height/2:C.bottom,Math.max(w===Ee.Down?C.top:C.top+C.height/2,f.y))},k=w===Ee.Right&&!x||w===Ee.Left&&!b,R=w===Ee.Down&&!_||w===Ee.Up&&!v;if(k&&E.x!==f.x){const T=g.scrollLeft+h.x,I=w===Ee.Right&&T<=j.x||w===Ee.Left&&T>=S.x;if(I&&!h.y){g.scrollTo({left:T,behavior:l});return}I?p.x=g.scrollLeft-T:p.x=w===Ee.Right?g.scrollLeft-j.x:g.scrollLeft-S.x,p.x&&g.scrollBy({left:-p.x,behavior:l});break}else if(R&&E.y!==f.y){const T=g.scrollTop+h.y,I=w===Ee.Down&&T<=j.y||w===Ee.Up&&T>=S.y;if(I&&!h.x){g.scrollTo({top:T,behavior:l});return}I?p.y=g.scrollTop-T:p.y=w===Ee.Down?g.scrollTop-j.y:g.scrollTop-S.y,p.y&&g.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,ms(ca(f,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}gu.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=HR,onActivation:i}=t,{active:s}=r;const{code:o}=e.nativeEvent;if(n.start.includes(o)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function yS(e){return!!(e&&"distance"in e)}function bS(e){return!!(e&&"delay"in e)}class Iy{constructor(t,r,n){var i;n===void 0&&(n=J7(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:s}=t,{target:o}=s;this.props=t,this.events=r,this.document=qs(o),this.documentListeners=new Ro(this.document),this.listeners=new Ro(n),this.windowListeners=new Ro(Yt(o)),this.initialCoordinates=(i=Fv(s))!=null?i:Rr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ar.Resize,this.handleCancel),this.windowListeners.add(ar.DragStart,xS),this.windowListeners.add(ar.VisibilityChange,this.handleCancel),this.windowListeners.add(ar.ContextMenu,xS),this.documentListeners.add(ar.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(bS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(yS(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:i}=this.props;i(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ar.Click,eW,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ar.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const c=(r=Fv(t))!=null?r:Rr,u=ca(i,c);if(!n&&l){if(yS(l)){if(l.tolerance!=null&&xg(u,l.tolerance))return this.handleCancel();if(xg(u,l.distance))return this.handleStart()}if(bS(l)&&xg(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Ee.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const rW={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class vu extends Iy{constructor(t){const{event:r}=t,n=qs(r.target);super(t,rW,n)}}vu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const nW={move:{name:"mousemove"},end:{name:"mouseup"}};var zv;(function(e){e[e.RightClick=2]="RightClick"})(zv||(zv={}));class iW extends Iy{constructor(t){super(t,nW,qs(t.event.target))}}iW.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===zv.RightClick?!1:(n==null||n({event:r}),!0)}}];const yg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class sW extends Iy{constructor(t){super(t,yg)}static setup(){return window.addEventListener(yg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(yg.move.name,t)};function t(){}}}sW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];var Ao;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ao||(Ao={}));var bc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(bc||(bc={}));function oW(e){let{acceleration:t,activator:r=Ao.Pointer,canScroll:n,draggingRect:i,enabled:s,interval:o=5,order:l=bc.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:h}=e;const p=lW({delta:f,disabled:!s}),[y,g]=b7(),w=m.useRef({x:0,y:0}),v=m.useRef({x:0,y:0}),x=m.useMemo(()=>{switch(r){case Ao.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Ao.DraggableRect:return i}},[r,i,c]),b=m.useRef(null),_=m.useCallback(()=>{const S=b.current;if(!S)return;const C=w.current.x*v.current.x,E=w.current.y*v.current.y;S.scrollBy(C,E)},[]),j=m.useMemo(()=>l===bc.TreeOrder?[...u].reverse():u,[l,u]);m.useEffect(()=>{if(!s||!u.length||!x){g();return}for(const S of j){if((n==null?void 0:n(S))===!1)continue;const C=u.indexOf(S),E=d[C];if(!E)continue;const{direction:k,speed:R}=G7(S,E,x,t,h);for(const T of["x","y"])p[T][k[T]]||(R[T]=0,k[T]=0);if(R.x>0||R.y>0){g(),b.current=S,y(_,o),w.current=R,v.current=k;return}}w.current={x:0,y:0},v.current={x:0,y:0},g()},[t,_,n,g,s,o,JSON.stringify(x),JSON.stringify(p),y,u,j,d,JSON.stringify(h)])}const aW={x:{[gt.Backward]:!1,[gt.Forward]:!1},y:{[gt.Backward]:!1,[gt.Forward]:!1}};function lW(e){let{delta:t,disabled:r}=e;const n=Lv(t);return Ca(i=>{if(r||!n||!i)return aW;const s={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[gt.Backward]:i.x[gt.Backward]||s.x===-1,[gt.Forward]:i.x[gt.Forward]||s.x===1},y:{[gt.Backward]:i.y[gt.Backward]||s.y===-1,[gt.Forward]:i.y[gt.Forward]||s.y===1}}},[r,t,n])}function cW(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Ca(i=>{var s;return t==null?null:(s=n??i)!=null?s:null},[n,t])}function uW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:i}=n,s=i.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,n)}));return[...r,...s]},[]),[e,t])}var ua;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(ua||(ua={}));var $v;(function(e){e.Optimized="optimized"})($v||($v={}));const wS=new Map;function dW(e,t){let{dragging:r,dependencies:n,config:i}=t;const[s,o]=m.useState(null),{frequency:l,measure:c,strategy:u}=i,d=m.useRef(e),f=w(),h=la(f),p=m.useCallback(function(v){v===void 0&&(v=[]),!h.current&&o(x=>x===null?v:x.concat(v.filter(b=>!x.includes(b))))},[h]),y=m.useRef(null),g=Ca(v=>{if(f&&!r)return wS;if(!v||v===wS||d.current!==e||s!=null){const x=new Map;for(let b of e){if(!b)continue;if(s&&s.length>0&&!s.includes(b.id)&&b.rect.current){x.set(b.id,b.rect.current);continue}const _=b.node.current,j=_?new Ay(c(_),_):null;b.rect.current=j,j&&x.set(b.id,j)}return x}return v},[e,s,r,f,c]);return m.useEffect(()=>{d.current=e},[e]),m.useEffect(()=>{f||p()},[r,f]),m.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),m.useEffect(()=>{f||typeof l!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},l))},[l,f,p,...n]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:s!=null};function w(){switch(u){case ua.Always:return!1;case ua.BeforeDragging:return r;default:return!r}}}function WR(e,t){return Ca(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function fW(e,t){return WR(e,t)}function pW(e){let{callback:t,disabled:r}=e;const n=Ty(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(n)},[n,r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function xu(e){let{callback:t,disabled:r}=e;const n=Ty(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(n)},[r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function hW(e){return new Ay(zs(e),e)}function _S(e,t,r){t===void 0&&(t=hW);const[n,i]=m.useState(null);function s(){i(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=pW({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=xu({callback:s});return Vr(()=>{s(),e?(l==null||l.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[e]),n}function mW(e){const t=WR(e);return DR(e,t)}const jS=[];function gW(e){const t=m.useRef(e),r=Ca(n=>e?n&&n!==jS&&e&&t.current&&e.parentNode===t.current.parentNode?n:mu(e):jS,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function vW(e){const[t,r]=m.useState(null),n=m.useRef(e),i=m.useCallback(s=>{const o=vg(s.target);o&&r(l=>l?(l.set(o,qv(o)),new Map(l)):null)},[]);return m.useEffect(()=>{const s=n.current;if(e!==s){o(s);const l=e.map(c=>{const u=vg(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,qv(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{o(e),o(s)};function o(l){l.forEach(c=>{const u=vg(c);u==null||u.removeEventListener("scroll",i)})}},[i,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,o)=>ms(s,o),Rr):BR(e):Rr,[e,t])}function SS(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Rr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?ca(e,r.current):Rr}function xW(e){m.useEffect(()=>{if(!hu)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function yW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:i,handler:s}=n;return r[i]=o=>{s(o,t)},r},{}),[e,t])}function UR(e){return m.useMemo(()=>e?H7(e):null,[e])}const kS=[];function bW(e,t){t===void 0&&(t=zs);const[r]=e,n=UR(r?Yt(r):null),[i,s]=m.useState(kS);function o(){s(()=>e.length?e.map(c=>zR(c)?n:new Ay(t(c),c)):kS)}const l=xu({callback:o});return Vr(()=>{l==null||l.disconnect(),o(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),i}function wW(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return ka(t)?t:e}function _W(e){let{measure:t}=e;const[r,n]=m.useState(null),i=m.useCallback(u=>{for(const{target:d}of u)if(ka(d)){n(f=>{const h=t(d);return f?{...f,width:h.width,height:h.height}:h});break}},[t]),s=xu({callback:i}),o=m.useCallback(u=>{const d=wW(u);s==null||s.disconnect(),d&&(s==null||s.observe(d)),n(d?t(d):null)},[t,s]),[l,c]=vc(o);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const jW=[{sensor:vu,options:{}},{sensor:gu,options:{}}],SW={current:{}},Cl={draggable:{measure:vS},droppable:{measure:vS,strategy:ua.WhileDragging,frequency:$v.Optimized},dragOverlay:{measure:zs}};class Io extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const kW={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Io,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:xc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Cl,measureDroppableContainers:xc,windowRect:null,measuringScheduled:!1},CW={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:xc,draggableNodes:new Map,over:null,measureDroppableContainers:xc},yu=m.createContext(CW),VR=m.createContext(kW);function NW(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Io}}}function EW(e,t){switch(t.type){case ut.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ut.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ut.DragEnd:case ut.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ut.RegisterDroppable:{const{element:r}=t,{id:n}=r,i=new Io(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case ut.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new Io(e.droppable.containers);return o.set(r,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case ut.UnregisterDroppable:{const{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const s=new Io(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function TW(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:i}=m.useContext(yu),s=Lv(n),o=Lv(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&s&&o!=null){if(!Ry(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=j7(d);if(f){f.focus();break}}})}},[n,t,i,o,s]),null}function RW(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...n}),r):r}function AW(e){return m.useMemo(()=>({draggable:{...Cl.draggable,...e==null?void 0:e.draggable},droppable:{...Cl.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Cl.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function IW(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e;const s=m.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Vr(()=>{if(!o&&!l||!t){s.current=!1;return}if(s.current||!n)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=DR(d,n);if(o||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const h=LR(u);h&&h.scrollBy({top:f.y,left:f.x})}},[t,o,l,n,r])}const GR=m.createContext({...Rr,scaleX:1,scaleY:1});var Nn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Nn||(Nn={}));const KR=m.memo(function(t){var r,n,i,s;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:d=jW,collisionDetection:f=D7,measuring:h,modifiers:p,...y}=t;const g=m.useReducer(EW,void 0,NW),[w,v]=g,[x,b]=T7(),[_,j]=m.useState(Nn.Uninitialized),S=_===Nn.Initialized,{draggable:{active:C,nodes:E,translate:k},droppable:{containers:R}}=w,T=C!=null?E.get(C):null,I=m.useRef({initial:null,translated:null}),F=m.useMemo(()=>{var Ke;return C!=null?{id:C,data:(Ke=T==null?void 0:T.data)!=null?Ke:SW,rect:I}:null},[C,T]),N=m.useRef(null),[P,O]=m.useState(null),[H,D]=m.useState(null),A=la(y,Object.values(y)),L=Na("DndDescribedBy",o),M=m.useMemo(()=>R.getEnabled(),[R]),$=AW(h),{droppableRects:W,measureDroppableContainers:B,measuringScheduled:Y}=dW(M,{dragging:S,dependencies:[k.x,k.y],config:$.droppable}),Z=cW(E,C),ie=m.useMemo(()=>H?Fv(H):null,[H]),re=Pr(),de=fW(Z,$.draggable.measure);IW({activeNode:C!=null?E.get(C):null,config:re.layoutShiftCompensation,initialRect:de,measure:$.draggable.measure});const ee=_S(Z,$.draggable.measure,de),_e=_S(Z?Z.parentElement:null),ue=m.useRef({activatorEvent:null,active:null,activeNode:Z,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Te=R.getNodeFor((r=ue.current.over)==null?void 0:r.id),pe=_W({measure:$.dragOverlay.measure}),te=(n=pe.nodeRef.current)!=null?n:Z,xe=S?(i=pe.rect)!=null?i:ee:null,K=!!(pe.nodeRef.current&&pe.rect),X=mW(K?null:ee),fe=UR(te?Yt(te):null),me=gW(S?Te??Z:null),ye=bW(me),ve=RW(p,{transform:{x:k.x-X.x,y:k.y-X.y,scaleX:1,scaleY:1},activatorEvent:H,active:F,activeNodeRect:ee,containerNodeRect:_e,draggingNodeRect:xe,over:ue.current.over,overlayNodeRect:pe.rect,scrollableAncestors:me,scrollableAncestorRects:ye,windowRect:fe}),he=ie?ms(ie,k):null,be=vW(me),Fe=SS(be),Se=SS(be,[ee]),Le=ms(ve,Fe),q=xe?q7(xe,ve):null,V=F&&q?f({active:F,collisionRect:q,droppableRects:W,droppableContainers:M,pointerCoordinates:he}):null,z=PR(V,"id"),[J,le]=m.useState(null),ze=K?ve:ms(ve,Se),Ze=L7(ze,(s=J==null?void 0:J.rect)!=null?s:null,ee),yt=m.useRef(null),kt=m.useCallback((Ke,$e)=>{let{sensor:lt,options:qt}=$e;if(N.current==null)return;const bt=E.get(N.current);if(!bt)return;const pt=Ke.nativeEvent,Mt=new lt({active:N.current,activeNode:bt,event:pt,options:qt,context:ue,onAbort(Je){if(!E.get(Je))return;const{onDragAbort:U}=A.current,Pe={id:Je};U==null||U(Pe),x({type:"onDragAbort",event:Pe})},onPending(Je,Xt,U,Pe){if(!E.get(Je))return;const{onDragPending:ri}=A.current,Or={id:Je,constraint:Xt,initialCoordinates:U,offset:Pe};ri==null||ri(Or),x({type:"onDragPending",event:Or})},onStart(Je){const Xt=N.current;if(Xt==null)return;const U=E.get(Xt);if(!U)return;const{onDragStart:Pe}=A.current,ti={activatorEvent:pt,active:{id:Xt,data:U.data,rect:I}};rs.unstable_batchedUpdates(()=>{Pe==null||Pe(ti),j(Nn.Initializing),v({type:ut.DragStart,initialCoordinates:Je,active:Xt}),x({type:"onDragStart",event:ti}),O(yt.current),D(pt)})},onMove(Je){v({type:ut.DragMove,coordinates:Je})},onEnd:xr(ut.DragEnd),onCancel:xr(ut.DragCancel)});yt.current=Mt;function xr(Je){return async function(){const{active:U,collisions:Pe,over:ti,scrollAdjustedTranslate:ri}=ue.current;let Or=null;if(U&&ri){const{cancelDrop:ni}=A.current;Or={activatorEvent:pt,active:U,collisions:Pe,delta:ri,over:ti},Je===ut.DragEnd&&typeof ni=="function"&&await Promise.resolve(ni(Or))&&(Je=ut.DragCancel)}N.current=null,rs.unstable_batchedUpdates(()=>{v({type:Je}),j(Nn.Uninitialized),le(null),O(null),D(null),yt.current=null;const ni=Je===ut.DragEnd?"onDragEnd":"onDragCancel";if(Or){const $s=A.current[ni];$s==null||$s(Or),x({type:ni,event:Or})}})}}},[E]),oe=m.useCallback((Ke,$e)=>(lt,qt)=>{const bt=lt.nativeEvent,pt=E.get(qt);if(N.current!==null||!pt||bt.dndKit||bt.defaultPrevented)return;const Mt={active:pt};Ke(lt,$e.options,Mt)===!0&&(bt.dndKit={capturedBy:$e.sensor},N.current=qt,kt(lt,$e))},[E,kt]),ae=uW(d,oe);xW(d),Vr(()=>{ee&&_===Nn.Initializing&&j(Nn.Initialized)},[ee,_]),m.useEffect(()=>{const{onDragMove:Ke}=A.current,{active:$e,activatorEvent:lt,collisions:qt,over:bt}=ue.current;if(!$e||!lt)return;const pt={active:$e,activatorEvent:lt,collisions:qt,delta:{x:Le.x,y:Le.y},over:bt};rs.unstable_batchedUpdates(()=>{Ke==null||Ke(pt),x({type:"onDragMove",event:pt})})},[Le.x,Le.y]),m.useEffect(()=>{const{active:Ke,activatorEvent:$e,collisions:lt,droppableContainers:qt,scrollAdjustedTranslate:bt}=ue.current;if(!Ke||N.current==null||!$e||!bt)return;const{onDragOver:pt}=A.current,Mt=qt.get(z),xr=Mt&&Mt.rect.current?{id:Mt.id,rect:Mt.rect.current,data:Mt.data,disabled:Mt.disabled}:null,Je={active:Ke,activatorEvent:$e,collisions:lt,delta:{x:bt.x,y:bt.y},over:xr};rs.unstable_batchedUpdates(()=>{le(xr),pt==null||pt(Je),x({type:"onDragOver",event:Je})})},[z]),Vr(()=>{ue.current={activatorEvent:H,active:F,activeNode:Z,collisionRect:q,collisions:V,droppableRects:W,draggableNodes:E,draggingNode:te,draggingNodeRect:xe,droppableContainers:R,over:J,scrollableAncestors:me,scrollAdjustedTranslate:Le},I.current={initial:xe,translated:q}},[F,Z,V,q,E,te,xe,W,R,J,me,Le]),oW({...re,delta:k,draggingRect:q,pointerCoordinates:he,scrollableAncestors:me,scrollableAncestorRects:ye});const nt=m.useMemo(()=>({active:F,activeNode:Z,activeNodeRect:ee,activatorEvent:H,collisions:V,containerNodeRect:_e,dragOverlay:pe,draggableNodes:E,droppableContainers:R,droppableRects:W,over:J,measureDroppableContainers:B,scrollableAncestors:me,scrollableAncestorRects:ye,measuringConfiguration:$,measuringScheduled:Y,windowRect:fe}),[F,Z,ee,H,V,_e,pe,E,R,W,J,B,me,ye,$,Y,fe]),It=m.useMemo(()=>({activatorEvent:H,activators:ae,active:F,activeNodeRect:ee,ariaDescribedById:{draggable:L},dispatch:v,draggableNodes:E,over:J,measureDroppableContainers:B}),[H,ae,F,ee,v,L,E,J,B]);return G.createElement(RR.Provider,{value:b},G.createElement(yu.Provider,{value:It},G.createElement(VR.Provider,{value:nt},G.createElement(GR.Provider,{value:Ze},u)),G.createElement(TW,{disabled:(l==null?void 0:l.restoreFocus)===!1})),G.createElement(I7,{...l,hiddenTextDescribedById:L}));function Pr(){const Ke=(P==null?void 0:P.autoScrollEnabled)===!1,$e=typeof c=="object"?c.enabled===!1:c===!1,lt=S&&!Ke&&!$e;return typeof c=="object"?{...c,enabled:lt}:{enabled:lt}}}),MW=m.createContext(null),CS="button",PW="Draggable";function OW(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e;const s=Na(PW),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:h}=m.useContext(yu),{role:p=CS,roleDescription:y="draggable",tabIndex:g=0}=i??{},w=(c==null?void 0:c.id)===t,v=m.useContext(w?GR:MW),[x,b]=vc(),[_,j]=vc(),S=yW(o,t),C=la(r);Vr(()=>(f.set(t,{id:t,key:s,node:x,activatorNode:_,data:C}),()=>{const k=f.get(t);k&&k.key===s&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:p,tabIndex:g,"aria-disabled":n,"aria-pressed":w&&p===CS?!0:void 0,"aria-roledescription":y,"aria-describedby":d.draggable}),[n,p,g,w,y,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:E,isDragging:w,listeners:n?void 0:S,node:x,over:h,setNodeRef:b,setActivatorNodeRef:j,transform:v}}function DW(){return m.useContext(VR)}const LW="Droppable",FW={timeout:25};function qW(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e;const s=Na(LW),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=m.useContext(yu),d=m.useRef({disabled:r}),f=m.useRef(!1),h=m.useRef(null),p=m.useRef(null),{disabled:y,updateMeasurementsFor:g,timeout:w}={...FW,...i},v=la(g??n),x=m.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(v.current)?v.current:[v.current]),p.current=null},w)},[w]),b=xu({callback:x,disabled:y||!o}),_=m.useCallback((E,k)=>{b&&(k&&(b.unobserve(k),f.current=!1),E&&b.observe(E))},[b]),[j,S]=vc(_),C=la(t);return m.useEffect(()=>{!b||!j.current||(b.disconnect(),f.current=!1,b.observe(j.current))},[j,b]),m.useEffect(()=>(l({type:ut.RegisterDroppable,element:{id:n,key:s,disabled:r,node:j,rect:h,data:C}}),()=>l({type:ut.UnregisterDroppable,key:s,id:n})),[n]),m.useEffect(()=>{r!==d.current.disabled&&(l({type:ut.SetDroppableDisabled,id:n,key:s,disabled:r}),d.current.disabled=r)},[n,s,r,l]),{active:o,rect:h,isOver:(c==null?void 0:c.id)===n,node:j,over:c,setNodeRef:S}}function bu(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function zW(e,t){return e.reduce((r,n,i)=>{const s=t.get(n);return s&&(r[i]=s),r},Array(e.length))}function ll(e){return e!==null&&e>=0}function $W(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function BW(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const YR=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e;const s=bu(t,n,r),o=t[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},cl={scaleX:1,scaleY:1},XR=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:s,overIndex:o}=e;const l=(t=s[r])!=null?t:n;if(!l)return null;if(i===r){const u=s[o];return u?{x:0,y:r<o?u.top+u.height-(l.top+l.height):u.top-l.top,...cl}:null}const c=HW(s,i,r);return i>r&&i<=o?{x:0,y:-l.height-c,...cl}:i<r&&i>=o?{x:0,y:l.height+c,...cl}:{x:0,y:0,...cl}};function HW(e,t,r){const n=e[t],i=e[t-1],s=e[t+1];return n?r<t?i?n.top-(i.top+i.height):s?s.top-(n.top+n.height):0:s?s.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const QR="Sortable",ZR=G.createContext({activeIndex:-1,containerId:QR,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:YR,disabled:{draggable:!1,droppable:!1}});function JR(e){let{children:t,id:r,items:n,strategy:i=YR,disabled:s=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=DW(),f=Na(QR,r),h=l.rect!==null,p=m.useMemo(()=>n.map(S=>typeof S=="object"&&"id"in S?S.id:S),[n]),y=o!=null,g=o?p.indexOf(o.id):-1,w=u?p.indexOf(u.id):-1,v=m.useRef(p),x=!$W(p,v.current),b=w!==-1&&g===-1||x,_=BW(s);Vr(()=>{x&&y&&d(p)},[x,p,y,d]),m.useEffect(()=>{v.current=p},[p]);const j=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:_,disableTransforms:b,items:p,overIndex:w,useDragOverlay:h,sortedRects:zW(p,c),strategy:i}),[g,f,_.draggable,_.droppable,b,p,w,c,h,i]);return G.createElement(ZR.Provider,{value:j},t)}const WW=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return bu(r,n,i).indexOf(t)},UW=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!n||l!==s&&i===o?!1:r?!0:o!==i&&t===c},VW={duration:200,easing:"ease"},e4="transform",GW=Es.Transition.toString({property:e4,duration:0,easing:"linear"}),KW={roleDescription:"sortable"};function YW(e){let{disabled:t,index:r,node:n,rect:i}=e;const[s,o]=m.useState(null),l=m.useRef(r);return Vr(()=>{if(!t&&r!==l.current&&n.current){const c=i.current;if(c){const u=zs(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&o(d)}}r!==l.current&&(l.current=r)},[t,r,n,i]),m.useEffect(()=>{s&&o(null)},[s]),s}function t4(e){let{animateLayoutChanges:t=UW,attributes:r,disabled:n,data:i,getNewIndex:s=WW,id:o,strategy:l,resizeObserverConfig:c,transition:u=VW}=e;const{items:d,containerId:f,activeIndex:h,disabled:p,disableTransforms:y,sortedRects:g,overIndex:w,useDragOverlay:v,strategy:x}=m.useContext(ZR),b=XW(n,p),_=d.indexOf(o),j=m.useMemo(()=>({sortable:{containerId:f,index:_,items:d},...i}),[f,i,_,d]),S=m.useMemo(()=>d.slice(d.indexOf(o)),[d,o]),{rect:C,node:E,isOver:k,setNodeRef:R}=qW({id:o,data:j,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...c}}),{active:T,activatorEvent:I,activeNodeRect:F,attributes:N,setNodeRef:P,listeners:O,isDragging:H,over:D,setActivatorNodeRef:A,transform:L}=OW({id:o,data:j,attributes:{...KW,...r},disabled:b.draggable}),M=y7(R,P),$=!!T,W=$&&!y&&ll(h)&&ll(w),B=!v&&H,Y=B&&W?L:null,ie=W?Y??(l??x)({rects:g,activeNodeRect:F,activeIndex:h,overIndex:w,index:_}):null,re=ll(h)&&ll(w)?s({id:o,items:d,activeIndex:h,overIndex:w}):_,de=T==null?void 0:T.id,ee=m.useRef({activeId:de,items:d,newIndex:re,containerId:f}),_e=d!==ee.current.items,ue=t({active:T,containerId:f,isDragging:H,isSorting:$,id:o,index:_,items:d,newIndex:ee.current.newIndex,previousItems:ee.current.items,previousContainerId:ee.current.containerId,transition:u,wasDragging:ee.current.activeId!=null}),Te=YW({disabled:!ue,index:_,node:E,rect:C});return m.useEffect(()=>{$&&ee.current.newIndex!==re&&(ee.current.newIndex=re),f!==ee.current.containerId&&(ee.current.containerId=f),d!==ee.current.items&&(ee.current.items=d)},[$,re,f,d]),m.useEffect(()=>{if(de===ee.current.activeId)return;if(de!=null&&ee.current.activeId==null){ee.current.activeId=de;return}const te=setTimeout(()=>{ee.current.activeId=de},50);return()=>clearTimeout(te)},[de]),{active:T,activeIndex:h,attributes:N,data:j,rect:C,index:_,newIndex:re,items:d,isOver:k,isSorting:$,isDragging:H,listeners:O,node:E,overIndex:w,over:D,setNodeRef:M,setActivatorNodeRef:A,setDroppableNodeRef:R,setDraggableNodeRef:P,transform:Te??ie,transition:pe()};function pe(){if(Te||_e&&ee.current.newIndex===_)return GW;if(!(B&&!Ry(I)||!u)&&($||ue))return Es.Transition.toString({...u,property:e4})}}function XW(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function wc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const QW=[Ee.Down,Ee.Right,Ee.Up,Ee.Left],r4=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:l}}=t;if(QW.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const h=i.get(f.id);if(h)switch(e.code){case Ee.Down:n.top<h.top&&c.push(f);break;case Ee.Up:n.top>h.top&&c.push(f);break;case Ee.Left:n.left>h.left&&c.push(f);break;case Ee.Right:n.left<h.left&&c.push(f);break}});const u=P7({collisionRect:n,droppableRects:i,droppableContainers:c});let d=PR(u,"id");if(d===(o==null?void 0:o.id)&&u.length>1&&(d=u[1].id),d!=null){const f=s.get(r.id),h=s.get(d),p=h?i.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&p&&f&&h){const w=mu(y).some((S,C)=>l[C]!==S),v=n4(f,h),x=ZW(f,h),b=w||!v?{x:0,y:0}:{x:x?n.width-p.width:0,y:x?n.height-p.height:0},_={x:p.left,y:p.top};return b.x&&b.y?_:ca(_,b)}}}};function n4(e,t){return!wc(e)||!wc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function ZW(e,t){return!wc(e)||!wc(t)||!n4(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const JW={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Lr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},or={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},i4={step_id:"new_step",produces:"",scope:"",inputs:[]},eU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function tU({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:i,onNavigateToWorkflow:s}){const[o,l]=m.useState("steps"),[c,u]=m.useState(""),[d,f]=m.useState(null),h=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:p,loading:y,error:g,saving:w,updateWorkflow:v}=FT(e,h,{onSave:k=>{n==null||n(h,k)}}),x=m.useCallback(k=>{k==="json"&&p&&(u(JSON.stringify(p,null,2)),f(null)),l(k)},[p]),b=m.useCallback(k=>{const R=k.target.value;u(R);try{const T=JSON.parse(R);f(null),v(T)}catch(T){f(T.message)}},[v]),_=m.useCallback((k,R)=>{if(!p)return;const T=[...p.steps];T[k]=R,v({...p,steps:T})},[p,v]),j=m.useCallback(k=>{if(!p)return;const R=p.steps.filter((T,I)=>I!==k);v({...p,steps:R})},[p,v]),S=m.useCallback(k=>{var T,I;if(!p)return;const R=k==="iteration"?{...eU,step_id:`new_iteration_${(((T=p.steps)==null?void 0:T.length)||0)+1}`}:{...i4,step_id:`new_step_${(((I=p.steps)==null?void 0:I.length)||0)+1}`};v({...p,steps:[...p.steps||[],R]})},[p,v]),C=m.useCallback((k,R)=>{if(!p)return;const T=bu(p.steps,k,R);v({...p,steps:T})},[p,v]),E=m.useCallback(()=>{!i||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&i(t.workflow_id)},[i,t]);return t?a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(p==null?void 0:p.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,k=>k.toUpperCase())}),((p==null?void 0:p.pow_class)||t.pow_class)&&a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(p==null?void 0:p.pow_class)||t.pow_class})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(p==null?void 0:p.description)&&`  ${p.description}`]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[w&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),i&&a.jsx("button",{onClick:E,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(k=>a.jsx("button",{onClick:()=>x(k.id),style:{...JW,color:o===k.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===k.id?"2px solid var(--action-primary)":"2px solid transparent"},children:k.label},k.id))}),y?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&a.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[a.jsx(rU,{steps:(p==null?void 0:p.steps)||[],documentTypes:r,onStepChange:_,onStepDelete:j,onReorder:C}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>S("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),a.jsx("button",{onClick:()=>S("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&a.jsxs("div",{className:"h-full flex flex-col p-4",children:[a.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:d?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),d&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",d]})]}),o==="metadata"&&a.jsx("div",{className:"h-full overflow-y-auto p-4",children:p?a.jsx(oU,{workflow:p,onUpdateWorkflow:v,onNavigateToWorkflow:s}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),a.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function rU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=AR(yc(vu,{activationConstraint:{distance:5}}),yc(gu,{coordinateGetter:r4})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:u,over:d}=c;if(!d||u.id===d.id)return;const f=e.findIndex(p=>p.step_id===u.id),h=e.findIndex(p=>p.step_id===d.id);f!==-1&&h!==-1&&i(f,h)},[e,i]);return e.length===0?a.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):a.jsx(KR,{sensors:s,collisionDetection:OR,onDragEnd:l,children:a.jsx(JR,{items:o,strategy:XR,children:e.map((c,u)=>a.jsx(nU,{step:c,index:u,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function nU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:u,isDragging:d}=t4({id:e.step_id}),f={transform:Es.Transform.toString(c),transition:u,opacity:d?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(s4,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o}})})}function s4({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i,dragHandleProps:s,depth:o=0}){var S,C,E;const[l,c]=m.useState(e),[u,d]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,h=(k,R)=>{const T={...l,[k]:R};c(T),n(t,T)},p=(k,R)=>{const T={...l.iterate_over,[k]:R},I={...l,iterate_over:T};c(I),n(t,I)},y=()=>{const k=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:k};c(R),n(t,R)},g=(k,R,T)=>{const I=[...l.inputs||[]];I[k]={...I[k],[R]:T};const F={...l,inputs:I};c(F),n(t,F)},w=k=>{const R=(l.inputs||[]).filter((I,F)=>F!==k),T={...l,inputs:R};c(T),n(t,T)},v=m.useCallback((k,R)=>{const T=[...l.steps||[]];T[k]=R;const I={...l,steps:T};c(I),n(t,I)},[l,t,n]),x=m.useCallback(k=>{const R=(l.steps||[]).filter((I,F)=>F!==k),T={...l,steps:R};c(T),n(t,T)},[l,t,n]),b=m.useCallback(()=>{var T;const k=[...l.steps||[],{...i4,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],R={...l,steps:k};c(R),n(t,R)},[l,t,n]),_=m.useCallback((k,R)=>{const T=bu(l.steps||[],k,R),I={...l,steps:T};c(I),n(t,I)},[l,t,n]),j={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return a.jsxs("div",{style:j,children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:u?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:u?"6px 6px 0 0":6},children:[s&&a.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[a.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),a.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),a.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),a.jsx("span",{style:{flex:1}}),a.jsx("button",{onClick:()=>d(!u),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:u?"Collapse":"Expand",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u?a.jsx("path",{d:"M18 15l-6-6-6 6"}):a.jsx("path",{d:"M6 9l6 6 6-6"})})}),a.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),u&&a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Step ID"}),a.jsx("input",{type:"text",value:l.step_id||"",onChange:k=>h("step_id",k.target.value),style:Lr})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Doc Type"}),a.jsxs("select",{value:((S=l.iterate_over)==null?void 0:S.doc_type)||"",onChange:k=>p("doc_type",k.target.value),style:Lr,children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(k=>a.jsx("option",{value:k.doc_type_id,children:k.doc_type_id},k.doc_type_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Collection Field"}),a.jsx("input",{type:"text",value:((C=l.iterate_over)==null?void 0:C.collection_field)||"",onChange:k=>p("collection_field",k.target.value),style:Lr})]}),a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Entity Type"}),a.jsx("input",{type:"text",value:((E=l.iterate_over)==null?void 0:E.entity_type)||"",onChange:k=>p("entity_type",k.target.value),style:Lr})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:k=>h("scope",k.target.value),style:Lr})]}),a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{style:or,children:"Nested Steps"}),a.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),a.jsx(iU,{steps:l.steps||[],documentTypes:r,onStepChange:v,onStepDelete:x,onReorder:_})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Produces"}),a.jsxs("select",{value:l.produces||"",onChange:k=>h("produces",k.target.value),style:Lr,children:[a.jsx("option",{value:"",children:"-- Select document type --"}),r.map(k=>a.jsx("option",{value:k.doc_type_id,children:k.doc_type_id},k.doc_type_id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:k=>h("scope",k.target.value),placeholder:"project",style:Lr})]}),a.jsxs("div",{children:[a.jsx("label",{style:or,children:"Creates Entities"}),a.jsx("input",{type:"text",value:l.creates_entities||"",onChange:k=>h("creates_entities",k.target.value||void 0),placeholder:"e.g., epic",style:Lr})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:or,children:"Inputs"}),a.jsx("button",{onClick:y,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):a.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((k,R)=>a.jsxs("div",{className:"flex gap-1 items-end",children:[a.jsxs("div",{style:{flex:1},children:[R===0&&a.jsx("label",{style:{...or,fontSize:9},children:"Doc/Entity Type"}),a.jsxs("select",{value:k.doc_type||k.entity_type||"",onChange:T=>{const I=T.target.value;k.entity_type!==void 0?g(R,"entity_type",I):g(R,"doc_type",I)},style:{...Lr,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(T=>a.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),a.jsxs("div",{style:{width:"30%"},children:[R===0&&a.jsx("label",{style:{...or,fontSize:9},children:"Scope"}),a.jsx("input",{type:"text",value:k.scope||"",onChange:T=>g(R,"scope",T.target.value),placeholder:"scope",style:{...Lr,fontSize:11}})]}),a.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[a.jsx("input",{type:"checkbox",checked:k.context||!1,onChange:T=>g(R,"context",T.target.checked||void 0)}),"ctx"]}),a.jsx("button",{onClick:()=>w(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function iU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=AR(yc(vu,{activationConstraint:{distance:5}}),yc(gu,{coordinateGetter:r4})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:u,over:d}=c;if(!d||u.id===d.id)return;const f=e.findIndex(p=>p.step_id===u.id),h=e.findIndex(p=>p.step_id===d.id);f!==-1&&h!==-1&&i(f,h)},[e,i]);return e.length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):a.jsx(KR,{sensors:s,collisionDetection:OR,onDragEnd:l,children:a.jsx(JR,{items:o,strategy:XR,children:e.map((c,u)=>a.jsx(sU,{step:c,index:u,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function sU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:u,isDragging:d}=t4({id:e.step_id}),f={transform:Es.Transform.toString(c),transition:u,opacity:d?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(s4,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o},depth:1})})}function oU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,i]=m.useState(""),s={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},o={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},u=Object.entries(c),d=e.document_types||{},f=Object.entries(d),h=e.pow_class||"reference",p=e.derived_from,y=e.source_version,g=e.tags||[],w=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),i(""))},v=b=>{t==null||t({...e,tags:g.filter(_=>_!==b)})},x=()=>{p!=null&&p.workflow_id&&r&&r(p.workflow_id)};return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"POW Class"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:h==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:h==="reference"?"#000":"var(--text-primary)"},children:h})})]}),p&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Derived From"}),a.jsx("div",{style:s,children:r?a.jsxs("button",{onClick:x,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[p.workflow_id," v",p.version]}):a.jsxs("span",{children:[p.workflow_id," v",p.version]})})]}),y&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Source Version"}),a.jsx("div",{style:s,children:y})]}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Tags"}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>a.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&a.jsx("button",{onClick:()=>v(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:n,onChange:b=>i(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),w())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),a.jsx("button",{onClick:w,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b.label}),a.jsx("div",{style:s,children:e[b.key]||"-"})]},b.key)),u.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),u.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:["parent: ",_.parent||"none"]})]},b))]}),f.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,_])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:[_.name,_.scope&&` (${_.scope})`,_.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function NS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(i=>i.status==="fail"),n=e.filter(i=>i.status==="pass");return t?a.jsx("div",{className:"flex items-center gap-2",children:r.length>0?a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):a.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):a.jsxs("div",{className:"space-y-2",children:[r.map((i,s)=>a.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx("span",{className:"text-red-400",children:"FAIL"}),a.jsx("span",{className:"font-mono",children:i.rule_id})]}),i.message&&a.jsx("div",{className:"mt-1 opacity-80",children:i.message}),i.artifact_id&&a.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:i.artifact_id})]},s)),n.length>0&&r.length>0&&a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function aU(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),i=[];let s=0,o=0;for(;s<r.length||o<n.length;)if(s>=r.length)i.push({type:"added",line:n[o],lineNum:o+1}),o++;else if(o>=n.length)i.push({type:"removed",line:r[s],lineNum:s+1}),s++;else if(r[s]===n[o])i.push({type:"same",line:r[s],oldLineNum:s+1,newLineNum:o+1}),s++,o++;else{let l=n.slice(o,o+5).indexOf(r[s]),c=r.slice(s,s+5).indexOf(n[o]);if(l!==-1&&(c===-1||l<=c)){for(let u=0;u<l;u++)i.push({type:"added",line:n[o+u],lineNum:o+u+1});o+=l}else if(c!==-1){for(let u=0;u<c;u++)i.push({type:"removed",line:r[s+u],lineNum:s+u+1});s+=c}else i.push({type:"removed",line:r[s],lineNum:s+1}),i.push({type:"added",line:n[o],lineNum:o+1}),s++,o++}return i}function lU({diff:e}){const[t,r]=m.useState(!0),n=aU(e.old_content,e.new_content),i={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return a.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:i[e.status]||i.M,children:e.status}),a.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),a.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&a.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:a.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((s,o)=>a.jsxs("div",{className:"flex",style:{background:s.type==="added"?"rgba(34, 197, 94, 0.1)":s.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:s.type==="added"?"3px solid #22c55e":s.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[a.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:s.type==="same"?s.oldLineNum:s.lineNum||""}),a.jsx("span",{className:"select-none px-1",style:{color:s.type==="added"?"#22c55e":s.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:s.type==="added"?"+":s.type==="removed"?"-":" "}),a.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:s.line})]},o))})})]})}function cU({workspaceId:e,artifactId:t=null,onClose:r}){const[n,i]=m.useState([]),[s,o]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(o(!0),c(null),ke.getDiff(e,t).then(d=>{i(d.diffs||[])}).catch(d=>{c(d.message)}).finally(()=>{o(!1)}))},[e,t]);const u=d=>{d.key==="Escape"&&(r==null||r())};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:d=>d.target===d.currentTarget&&(r==null?void 0:r()),onKeyDown:u,tabIndex:0,children:a.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),a.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?a.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((d,f)=>a.jsx(lU,{diff:d},d.artifact_id||f))}),a.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function uU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:i,kind:s,displayName:o,kindLabel:l,display:`${o} - ${l}`}}function dU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=uU(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function fU({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:i=[],modifiedFiles:s=[]}){const[o,l]=m.useState(""),[c,u]=m.useState(!1),d=dU(i),f=i.length,h=y=>{y.preventDefault(),o.trim()&&!n&&t(o.trim())},p=y=>{y.key==="Escape"&&!n&&r()};return a.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:y=>y.target===y.currentTarget&&!n&&r(),onKeyDown:p,children:[a.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&a.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),a.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:d.map(y=>a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:y.label}),a.jsx("div",{className:"space-y-1",children:y.items.map((g,w)=>a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),a.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),a.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),a.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},w))})]},y.scope))}),a.jsx("button",{type:"button",onClick:()=>u(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),a.jsxs("form",{onSubmit:h,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),a.jsx("textarea",{value:o,onChange:y=>l(y.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!o.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:o.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:o.trim()&&!n?"#000":"var(--text-muted)",cursor:o.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&a.jsx(cU,{workspaceId:e,onClose:()=>u(!1)})]})}function pU(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:o,kind:s,kindLabel:l,version:i,display:`${o} - ${l}`}}function hU({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:i,onClose:s,onRefresh:o}){var k,R;const[l,c]=m.useState(!1),[u,d]=m.useState(!1),[f,h]=m.useState(!1),[p,y]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,w=(t==null?void 0:t.modified_artifacts)??[],v=((k=t==null?void 0:t.tier1)==null?void 0:k.passed)??!0,x=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",_=t!=null&&t.expires_at?new Date(t.expires_at):null,j=async T=>{d(!0),y(null);try{const I=await ke.commit(e,T);c(!1),n==null||n(I),o==null||o()}catch(I){y(I.message)}finally{d(!1)}},S=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){h(!0);try{await ke.discard(e),i==null||i(),o==null||o()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{h(!1)}}},C=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await ke.closeWorkspace(e),s==null||s()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},E=T=>{if(!T)return null;const F=T-new Date;if(F<=0)return"Expired";const N=Math.floor(F/(1e3*60*60)),P=Math.floor(F%(1e3*60*60)/(1e3*60));return N>0?`${N}h ${P}m remaining`:`${P}m remaining`};return a.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:a.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),a.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),_&&a.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:E(_)})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),a.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),w.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",w.length,")"]}),a.jsx("div",{className:"space-y-1",children:w.map(T=>{const I=pU(T);return a.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[a.jsx("span",{style:{color:"var(--text-primary)"},children:I.displayName||T}),I.kindLabel&&a.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",I.kindLabel]})]},T)})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),a.jsx(NS,{results:x,compact:!0})]}),x.length>0&&!v&&a.jsx("div",{className:"mt-3",children:a.jsx(NS,{results:x})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[a.jsx("button",{onClick:()=>c(!0),disabled:!g||!v||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&v?"var(--action-success)":"var(--border-panel)",color:g&&v?"#000":"var(--text-muted)",cursor:g&&v&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!v&&g&&a.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&a.jsx("button",{onClick:S,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&a.jsx("button",{onClick:C,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&a.jsx(fU,{workspaceId:e,onCommit:j,onCancel:()=>{c(!1),y(null)},loading:u,modifiedArtifacts:w,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),p&&a.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:p})]})}function mU(){const{isAdmin:e,loading:t}=Ls(),[r,n]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,u]=m.useState(null),[d,f]=m.useState(null),[h,p]=m.useState(null),[y,g]=m.useState(null),[w,v]=m.useState(null),[x,b]=m.useState(null),[_,j]=m.useState(null),{workspaceId:S,loading:C,error:E,reinitialize:k}=G$(),{state:R,loading:T,refresh:I}=K$(S),{documentTypes:F,loading:N,refresh:P}=Y$(),{roles:O,loading:H,refresh:D}=X$(),{templates:A,loading:L,refresh:M}=OT(),{workflows:$,loading:W,refresh:B}=bB(),{fragments:Y,loading:Z,kindOptions:ie,refresh:re}=LT(),{schemas:de,loading:ee,refresh:_e}=DT(),ue=m.useCallback(async(oe,ae=null,nt="docworkflow")=>{if(n(oe),u(null),f(null),p(null),s(null),b(ae),j(nt),!!oe){l(!0);try{const It=await ke.getDocumentType(oe.doc_type_id);s(It)}catch(It){console.error("Failed to load doc type details:",It),s(oe)}finally{l(!1)}}},[]),Te=m.useCallback(oe=>{ue(oe,"task_prompt","task")},[ue]),pe=m.useCallback(oe=>{ue(oe,"schema","schema")},[ue]),te=m.useCallback(oe=>{u(oe),n(null),s(null),f(null),p(null),g(null),v(null)},[]),xe=m.useCallback(oe=>{f(oe),n(null),s(null),u(null),p(null),g(null),v(null)},[]),K=m.useCallback(oe=>{p(oe),n(null),s(null),u(null),f(null),g(null),v(null)},[]),X=m.useCallback(oe=>{g(oe),n(null),s(null),u(null),f(null),p(null),v(null)},[]),fe=m.useCallback(oe=>{v(oe),n(null),s(null),u(null),f(null),p(null),g(null)},[]),me=m.useCallback(oe=>{const ae=$.find(nt=>nt.workflow_id===oe);ae&&K(ae)},[$,K]),ye=m.useCallback((oe,ae)=>{I()},[I]),ve=m.useCallback(oe=>{console.log("Committed:",oe.commit_hash)},[]),he=m.useCallback(()=>{n(null),s(null),u(null),f(null),p(null)},[]),be=m.useCallback(async oe=>{if(S)try{const ae=await ke.createOrchestrationWorkflow(S,oe);await B(),I(),p({workflow_id:ae.workflow_id,active_version:ae.version,name:oe.name||ae.workflow_id.replace(/_/g," ").replace(/\b\w/g,nt=>nt.toUpperCase())}),n(null),s(null),u(null),f(null)}catch(ae){console.error("Failed to create workflow:",ae),alert(`Failed to create workflow: ${ae.message}`)}},[S,B,I]),Fe=m.useCallback(async oe=>{if(S)try{await ke.deleteOrchestrationWorkflow(S,oe),await B(),I(),p(null)}catch(ae){console.error("Failed to delete workflow:",ae),alert(`Failed to delete workflow: ${ae.message}`)}},[S,B,I]),Se=m.useCallback(async oe=>{if(S)try{const ae=await ke.createDocumentType(S,oe);await P(),I(),ue({doc_type_id:ae.doc_type_id,display_name:oe.display_name||ae.doc_type_id.replace(/_/g," ").replace(/\b\w/g,nt=>nt.toUpperCase()),active_version:ae.version})}catch(ae){console.error("Failed to create document type:",ae),alert(`Failed to create document type: ${ae.message}`)}},[S,P,I,ue]);m.useCallback(async oe=>{if(S)try{await ke.deleteDocumentType(S,oe),await P(),I(),n(null),s(null)}catch(ae){console.error("Failed to delete document type:",ae),alert(`Failed to delete document type: ${ae.message}`)}},[S,P,I]);const Le=m.useCallback(async oe=>{if(S)try{await ke.createDcwWorkflow(S,{doc_type_id:oe}),await B(),I()}catch(ae){console.error("Failed to create DCW workflow:",ae),alert(`Failed to create workflow: ${ae.message}`)}},[S,B,I]),q=m.useCallback(async oe=>{if(S)try{const ae=await ke.createRolePrompt(S,oe);await re(),await D(),I(),X({fragment_id:`role:${ae.role_id}`,kind:"role",version:ae.version,name:oe.name||ae.role_id.replace(/_/g," ").replace(/\b\w/g,nt=>nt.toUpperCase())})}catch(ae){console.error("Failed to create role prompt:",ae),alert(`Failed to create role prompt: ${ae.message}`)}},[S,re,D,I,X]),V=m.useCallback(async oe=>{if(S)try{const ae=await ke.createTemplate(S,oe);await M(),I(),xe({template_id:ae.template_id,active_version:ae.version,name:oe.name||ae.template_id.replace(/_/g," ").replace(/\b\w/g,nt=>nt.toUpperCase())})}catch(ae){console.error("Failed to create template:",ae),alert(`Failed to create template: ${ae.message}`)}},[S,M,I,xe]),z=m.useCallback(async oe=>{if(S)try{const ae=await ke.createStandaloneSchema(S,oe);await _e(),I(),fe({schema_id:ae.schema_id,active_version:ae.version,title:oe.title||ae.schema_id.replace(/_/g," ").replace(/\b\w/g,nt=>nt.toUpperCase())})}catch(ae){console.error("Failed to create schema:",ae),alert(`Failed to create schema: ${ae.message}`)}},[S,_e,I,fe]),J=m.useCallback(()=>{k(),n(null),s(null),u(null),f(null),p(null)},[k]);if(t)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(C)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(E)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),a.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:E}),a.jsx("button",{onClick:k,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const le=c&&!r&&!d&&!h&&!y&&!w,ze=d&&!r&&!c&&!h&&!y&&!w,Ze=h&&!r&&!c&&!d&&!y&&!w,yt=y&&!r&&!c&&!d&&!h&&!w,kt=w&&!r&&!c&&!d&&!h&&!y;return a.jsxs("div",{className:"flex h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx(_B,{documentTypes:F,roles:O,templates:A,workflows:$,promptFragments:Y,promptFragmentKindOptions:ie,schemas:de,loading:N,rolesLoading:H,templatesLoading:L,workflowsLoading:W,promptFragmentsLoading:Z,schemasLoading:ee,selectedDocType:r,docTypeSource:_,selectedRole:c,selectedTemplate:d,selectedWorkflow:h,selectedFragment:y,selectedSchema:w,onSelectDocType:ue,onSelectRole:te,onSelectTemplate:xe,onSelectWorkflow:K,onSelectFragment:X,onSelectStandaloneSchema:fe,onCreateWorkflow:be,onCreateDocType:Se,onCreateFragment:q,onCreateTemplate:V,onCreateSchema:z,onSelectTask:Te,onSelectSchema:pe,workspaceState:R}),le?a.jsx(GB,{workspaceId:S,role:c,onArtifactSave:ye}):ze?a.jsx(h7,{workspaceId:S,template:d,onArtifactSave:ye}):yt?a.jsx(x7,{workspaceId:S,fragment:y,onArtifactSave:ye}):Ze?a.jsx(tU,{workspaceId:S,workflow:h,documentTypes:F,onArtifactSave:ye,onDelete:Fe,onNavigateToWorkflow:me}):kt?a.jsx(m7,{workspaceId:S,schema:w,onArtifactSave:ye}):a.jsx(VB,{workspaceId:S,docType:i,loading:o,roles:O,workflows:$,onArtifactSave:ye,onCreateDcwWorkflow:Le,initialTab:x,docTypeSource:_}),a.jsx(hU,{workspaceId:S,state:R,loading:T,onCommit:ve,onDiscard:he,onClose:J,onRefresh:I})]})}function gU({user:e,onClick:t}){return a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function vU(){var T,I,F;const{user:e}=Ls(),[t,r]=m.useState(!1),{projects:n,loading:i,error:s,refresh:o}=H$({includeArchived:t}),[l,c]=m.useState(null),[u,d]=m.useState(null),[f,h]=m.useState(!1),[p,y]=m.useState(!1),{theme:g,setTheme:w}=MT(),v=Object.keys(n),x=l&&n[l]?l:v[0]||null;m.useEffect(()=>{if(x&&n[x]){const N=n[x];document.title=`${N.projectId} - The Combine`}else document.title="The Combine"},[x,n]);const b=N=>{c(N),d(null)},_=()=>{h(!0)},j=async N=>{await o(),N&&N.id&&(c(N.id),d("concierge_intake")),h(!1)},S=()=>{h(!1)},C=async(N,P)=>{try{await Ue.updateProject(N,P),await o()}catch(O){throw console.error("Failed to update project:",O),O}},E=async N=>{try{if(await Ue.archiveProject(N),!t){const P=Object.values(n).sort((D,A)=>{const L=(D.name||"").localeCompare(A.name||"");return L!==0?L:(D.projectId||"").localeCompare(A.projectId||"")}),O=P.findIndex(D=>D.id===N),H=P[O+1]||P[O-1]||null;c((H==null?void 0:H.id)||null)}await o()}catch(P){throw console.error("Failed to archive project:",P),P}},k=async N=>{try{await Ue.unarchiveProject(N),await o()}catch(P){throw console.error("Failed to unarchive project:",P),P}},R=async N=>{try{await Ue.deleteProject(N);const P=Object.values(n).sort((D,A)=>{const L=(D.name||"").localeCompare(A.name||"");return L!==0?L:(D.projectId||"").localeCompare(A.projectId||"")}),O=P.findIndex(D=>D.id===N),H=P[O+1]||P[O-1]||null;c((H==null?void 0:H.id)||null),await o()}catch(P){throw console.error("Failed to delete project:",P),P}};return i?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):s?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[a.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",s]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):a.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[a.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),a.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),a.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("path",{d:"M12 17h.01"})]})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(JD,{projects:n,selectedId:x,onSelectProject:b,onNewProject:_,showArchived:t,onToggleShowArchived:()=>r(N=>!N),userSection:a.jsx(gU,{user:e,onClick:()=>y(!0)})}),a.jsx("div",{className:"flex-1",children:x?a.jsx(Gc,{children:a.jsx(J$,{projectId:x,projectCode:(T=n[x])==null?void 0:T.projectId,projectName:(I=n[x])==null?void 0:I.name,isArchived:(F=n[x])==null?void 0:F.isArchived,autoExpandNodeId:u,theme:g,onThemeChange:w,onProjectUpdate:C,onProjectArchive:E,onProjectUnarchive:k,onProjectDelete:R})},x):a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center",children:a.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&a.jsx(aB,{onClose:S,onComplete:j}),p&&a.jsx(lB,{onClose:()=>y(!1)})]})]})}function xU(){const{isAuthenticated:e,loading:t}=Ls(),{theme:r}=MT(),[n,i]=m.useState(window.location.pathname);return m.useEffect(()=>{const s=()=>i(window.location.pathname);return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]),t?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?a.jsx("div",{className:`h-screen theme-${r}`,children:a.jsx(mU,{})}):a.jsx(vU,{}):n==="/learn"?a.jsx(yB,{}):a.jsx(mB,{})}function yU(){return a.jsx(V$,{children:a.jsx(xU,{})})}bg.createRoot(document.getElementById("root")).render(a.jsx(G.StrictMode,{children:a.jsx(yU,{})}));
//# sourceMappingURL=index-C1UWwT6s.js.map
