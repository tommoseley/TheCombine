(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var MS={exports:{}},Cc={},PS={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fa=Symbol.for("react.element"),TR=Symbol.for("react.portal"),RR=Symbol.for("react.fragment"),AR=Symbol.for("react.strict_mode"),IR=Symbol.for("react.profiler"),MR=Symbol.for("react.provider"),PR=Symbol.for("react.context"),OR=Symbol.for("react.forward_ref"),DR=Symbol.for("react.suspense"),LR=Symbol.for("react.memo"),FR=Symbol.for("react.lazy"),Ly=Symbol.iterator;function zR(e){return e===null||typeof e!="object"?null:(e=Ly&&e[Ly]||e["@@iterator"],typeof e=="function"?e:null)}var OS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},DS=Object.assign,LS={};function Ts(e,t,r){this.props=e,this.context=t,this.refs=LS,this.updater=r||OS}Ts.prototype.isReactComponent={};Ts.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ts.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function FS(){}FS.prototype=Ts.prototype;function Wv(e,t,r){this.props=e,this.context=t,this.refs=LS,this.updater=r||OS}var Uv=Wv.prototype=new FS;Uv.constructor=Wv;DS(Uv,Ts.prototype);Uv.isPureReactComponent=!0;var Fy=Array.isArray,zS=Object.prototype.hasOwnProperty,Vv={current:null},$S={key:!0,ref:!0,__self:!0,__source:!0};function qS(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)zS.call(t,n)&&!$S.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:fa,type:e,key:s,ref:o,props:i,_owner:Vv.current}}function $R(e,t){return{$$typeof:fa,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Gv(e){return typeof e=="object"&&e!==null&&e.$$typeof===fa}function qR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var zy=/\/+/g;function Cu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?qR(""+e.key):t.toString(36)}function hl(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case fa:case TR:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+Cu(o,0):n,Fy(i)?(r="",e!=null&&(r=e.replace(zy,"$&/")+"/"),hl(i,t,r,"",function(d){return d})):i!=null&&(Gv(i)&&(i=$R(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(zy,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",Fy(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+Cu(s,l);o+=hl(s,t,r,c,i)}else if(c=zR(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+Cu(s,l++),o+=hl(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ra(e,t,r){if(e==null)return e;var n=[],i=0;return hl(e,n,"","",function(s){return t.call(r,s,i++)}),n}function BR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ft={current:null},ml={transition:null},HR={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:ml,ReactCurrentOwner:Vv};function BS(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:Ra,forEach:function(e,t,r){Ra(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ra(e,function(){t++}),t},toArray:function(e){return Ra(e,function(t){return t})||[]},only:function(e){if(!Gv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ee.Component=Ts;Ee.Fragment=RR;Ee.Profiler=IR;Ee.PureComponent=Wv;Ee.StrictMode=AR;Ee.Suspense=DR;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HR;Ee.act=BS;Ee.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=DS({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Vv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)zS.call(t,c)&&!$S.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:fa,type:e.type,key:i,ref:s,props:n,_owner:o}};Ee.createContext=function(e){return e={$$typeof:PR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:MR,_context:e},e.Consumer=e};Ee.createElement=qS;Ee.createFactory=function(e){var t=qS.bind(null,e);return t.type=e,t};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(e){return{$$typeof:OR,render:e}};Ee.isValidElement=Gv;Ee.lazy=function(e){return{$$typeof:FR,_payload:{_status:-1,_result:e},_init:BR}};Ee.memo=function(e,t){return{$$typeof:LR,type:e,compare:t===void 0?null:t}};Ee.startTransition=function(e){var t=ml.transition;ml.transition={};try{e()}finally{ml.transition=t}};Ee.unstable_act=BS;Ee.useCallback=function(e,t){return Ft.current.useCallback(e,t)};Ee.useContext=function(e){return Ft.current.useContext(e)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(e){return Ft.current.useDeferredValue(e)};Ee.useEffect=function(e,t){return Ft.current.useEffect(e,t)};Ee.useId=function(){return Ft.current.useId()};Ee.useImperativeHandle=function(e,t,r){return Ft.current.useImperativeHandle(e,t,r)};Ee.useInsertionEffect=function(e,t){return Ft.current.useInsertionEffect(e,t)};Ee.useLayoutEffect=function(e,t){return Ft.current.useLayoutEffect(e,t)};Ee.useMemo=function(e,t){return Ft.current.useMemo(e,t)};Ee.useReducer=function(e,t,r){return Ft.current.useReducer(e,t,r)};Ee.useRef=function(e){return Ft.current.useRef(e)};Ee.useState=function(e){return Ft.current.useState(e)};Ee.useSyncExternalStore=function(e,t,r){return Ft.current.useSyncExternalStore(e,t,r)};Ee.useTransition=function(){return Ft.current.useTransition()};Ee.version="18.3.1";PS.exports=Ee;var m=PS.exports;const Y=Hv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WR=m,UR=Symbol.for("react.element"),VR=Symbol.for("react.fragment"),GR=Object.prototype.hasOwnProperty,KR=WR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YR={key:!0,ref:!0,__self:!0,__source:!0};function HS(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)GR.call(t,n)&&!YR.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:UR,type:e,key:s,ref:o,props:i,_owner:KR.current}}Cc.Fragment=VR;Cc.jsx=HS;Cc.jsxs=HS;MS.exports=Cc;var a=MS.exports,_g={},WS={exports:{}},sr={},US={exports:{}},VS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,A){var L=P.length;P.push(A);e:for(;0<L;){var z=L-1>>>1,B=P[z];if(0<i(B,A))P[z]=A,P[L]=B,L=z;else break e}}function r(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var A=P[0],L=P.pop();if(L!==A){P[0]=L;e:for(var z=0,B=P.length,X=B>>>1;z<X;){var G=2*(z+1)-1,W=P[G],q=G+1,Q=P[q];if(0>i(W,L))q<B&&0>i(Q,W)?(P[z]=Q,P[q]=L,z=q):(P[z]=W,P[G]=L,z=G);else if(q<B&&0>i(Q,L))P[z]=Q,P[q]=L,z=q;else break e}}return A}function i(P,A){var L=P.sortIndex-A.sortIndex;return L!==0?L:P.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,x=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(P){for(var A=r(d);A!==null;){if(A.callback===null)n(d);else if(A.startTime<=P)n(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=r(d)}}function w(P){if(g=!1,b(P),!x)if(r(c)!==null)x=!0,I(k);else{var A=r(d);A!==null&&F(w,A.startTime-P)}}function k(P,A){x=!1,g&&(g=!1,v(T),T=-1),h=!0;var L=p;try{for(b(A),f=r(c);f!==null&&(!(f.expirationTime>A)||P&&!E());){var z=f.callback;if(typeof z=="function"){f.callback=null,p=f.priorityLevel;var B=z(f.expirationTime<=A);A=e.unstable_now(),typeof B=="function"?f.callback=B:f===r(c)&&n(c),b(A)}else n(c);f=r(c)}if(f!==null)var X=!0;else{var G=r(d);G!==null&&F(w,G.startTime-A),X=!1}return X}finally{f=null,p=L,h=!1}}var S=!1,C=null,T=-1,j=5,R=-1;function E(){return!(e.unstable_now()-R<j)}function M(){if(C!==null){var P=e.unstable_now();R=P;var A=!0;try{A=C(!0,P)}finally{A?$():(S=!1,C=null)}}else S=!1}var $;if(typeof y=="function")$=function(){y(M)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,D=N.port2;N.port1.onmessage=M,$=function(){D.postMessage(null)}}else $=function(){_(M,0)};function I(P){C=P,S||(S=!0,$())}function F(P,A){T=_(function(){P(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){x||h||(x=!0,I(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(P){switch(p){case 1:case 2:case 3:var A=3;break;default:A=p}var L=p;p=A;try{return P()}finally{p=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,A){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var L=p;p=P;try{return A()}finally{p=L}},e.unstable_scheduleCallback=function(P,A,L){var z=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?z+L:z):L=z,P){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=L+B,P={id:u++,callback:A,priorityLevel:P,startTime:L,expirationTime:B,sortIndex:-1},L>z?(P.sortIndex=L,t(d,P),r(c)===null&&P===r(d)&&(g?(v(T),T=-1):g=!0,F(w,L-z))):(P.sortIndex=B,t(c,P),x||h||(x=!0,I(k))),P},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(P){var A=p;return function(){var L=p;p=A;try{return P.apply(this,arguments)}finally{p=L}}}})(VS);US.exports=VS;var XR=US.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QR=m,nr=XR;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GS=new Set,Po={};function Ci(e,t){gs(e,t),gs(e+"Capture",t)}function gs(e,t){for(Po[e]=t,e=0;e<t.length;e++)GS.add(t[e])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wg=Object.prototype.hasOwnProperty,ZR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$y={},qy={};function JR(e){return wg.call(qy,e)?!0:wg.call($y,e)?!1:ZR.test(e)?qy[e]=!0:($y[e]=!0,!1)}function e3(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function t3(e,t,r,n){if(t===null||typeof t>"u"||e3(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zt(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Nt[e]=new zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Nt[t]=new zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Nt[e]=new zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Nt[e]=new zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Nt[e]=new zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Nt[e]=new zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Nt[e]=new zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Nt[e]=new zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Nt[e]=new zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Kv=/[\-:]([a-z])/g;function Yv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Kv,Yv);Nt[t]=new zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Kv,Yv);Nt[t]=new zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Kv,Yv);Nt[t]=new zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Nt[e]=new zt(e,1,!1,e.toLowerCase(),null,!1,!1)});Nt.xlinkHref=new zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Nt[e]=new zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Xv(e,t,r,n){var i=Nt.hasOwnProperty(t)?Nt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(t3(t,r,i,n)&&(r=null),n||i===null?JR(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var xn=QR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Aa=Symbol.for("react.element"),Wi=Symbol.for("react.portal"),Ui=Symbol.for("react.fragment"),Qv=Symbol.for("react.strict_mode"),jg=Symbol.for("react.profiler"),KS=Symbol.for("react.provider"),YS=Symbol.for("react.context"),Zv=Symbol.for("react.forward_ref"),Sg=Symbol.for("react.suspense"),kg=Symbol.for("react.suspense_list"),Jv=Symbol.for("react.memo"),Sn=Symbol.for("react.lazy"),XS=Symbol.for("react.offscreen"),By=Symbol.iterator;function Bs(e){return e===null||typeof e!="object"?null:(e=By&&e[By]||e["@@iterator"],typeof e=="function"?e:null)}var Je=Object.assign,Eu;function lo(e){if(Eu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Eu=t&&t[1]||""}return`
`+Eu+e}var Tu=!1;function Ru(e,t){if(!e||Tu)return"";Tu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Tu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?lo(e):""}function r3(e){switch(e.tag){case 5:return lo(e.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return e=Ru(e.type,!1),e;case 11:return e=Ru(e.type.render,!1),e;case 1:return e=Ru(e.type,!0),e;default:return""}}function Ng(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ui:return"Fragment";case Wi:return"Portal";case jg:return"Profiler";case Qv:return"StrictMode";case Sg:return"Suspense";case kg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case YS:return(e.displayName||"Context")+".Consumer";case KS:return(e._context.displayName||"Context")+".Provider";case Zv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Jv:return t=e.displayName||null,t!==null?t:Ng(e.type)||"Memo";case Sn:t=e._payload,e=e._init;try{return Ng(e(t))}catch{}}return null}function n3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ng(t);case 8:return t===Qv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Kn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function QS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function i3(e){var t=QS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ia(e){e._valueTracker||(e._valueTracker=i3(e))}function ZS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=QS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Al(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cg(e,t){var r=t.checked;return Je({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Hy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Kn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function JS(e,t){t=t.checked,t!=null&&Xv(e,"checked",t,!1)}function Eg(e,t){JS(e,t);var r=Kn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Tg(e,t.type,r):t.hasOwnProperty("defaultValue")&&Tg(e,t.type,Kn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Tg(e,t,r){(t!=="number"||Al(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var co=Array.isArray;function os(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Kn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Rg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return Je({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Uy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(te(92));if(co(r)){if(1<r.length)throw Error(te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Kn(r)}}function ek(e,t){var r=Kn(t.value),n=Kn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Vy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function tk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ag(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?tk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ma,rk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ma=Ma||document.createElement("div"),Ma.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ma.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Oo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var wo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},s3=["Webkit","ms","Moz","O"];Object.keys(wo).forEach(function(e){s3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),wo[t]=wo[e]})});function nk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||wo.hasOwnProperty(e)&&wo[e]?(""+t).trim():t+"px"}function ik(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=nk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var o3=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ig(e,t){if(t){if(o3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function Mg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pg=null;function ex(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Og=null,as=null,ls=null;function Gy(e){if(e=ma(e)){if(typeof Og!="function")throw Error(te(280));var t=e.stateNode;t&&(t=Ic(t),Og(e.stateNode,e.type,t))}}function sk(e){as?ls?ls.push(e):ls=[e]:as=e}function ok(){if(as){var e=as,t=ls;if(ls=as=null,Gy(e),t)for(e=0;e<t.length;e++)Gy(t[e])}}function ak(e,t){return e(t)}function lk(){}var Au=!1;function ck(e,t,r){if(Au)return e(t,r);Au=!0;try{return ak(e,t,r)}finally{Au=!1,(as!==null||ls!==null)&&(lk(),ok())}}function Do(e,t){var r=e.stateNode;if(r===null)return null;var n=Ic(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,t,typeof r));return r}var Dg=!1;if(un)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){Dg=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{Dg=!1}function a3(e,t,r,n,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var jo=!1,Il=null,Ml=!1,Lg=null,l3={onError:function(e){jo=!0,Il=e}};function c3(e,t,r,n,i,s,o,l,c){jo=!1,Il=null,a3.apply(l3,arguments)}function u3(e,t,r,n,i,s,o,l,c){if(c3.apply(this,arguments),jo){if(jo){var d=Il;jo=!1,Il=null}else throw Error(te(198));Ml||(Ml=!0,Lg=d)}}function Ei(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function uk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ky(e){if(Ei(e)!==e)throw Error(te(188))}function d3(e){var t=e.alternate;if(!t){if(t=Ei(e),t===null)throw Error(te(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ky(i),e;if(s===n)return Ky(i),t;s=s.sibling}throw Error(te(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(te(189))}}if(r.alternate!==n)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:t}function dk(e){return e=d3(e),e!==null?fk(e):null}function fk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=fk(e);if(t!==null)return t;e=e.sibling}return null}var pk=nr.unstable_scheduleCallback,Yy=nr.unstable_cancelCallback,f3=nr.unstable_shouldYield,p3=nr.unstable_requestPaint,st=nr.unstable_now,h3=nr.unstable_getCurrentPriorityLevel,tx=nr.unstable_ImmediatePriority,hk=nr.unstable_UserBlockingPriority,Pl=nr.unstable_NormalPriority,m3=nr.unstable_LowPriority,mk=nr.unstable_IdlePriority,Ec=null,Br=null;function g3(e){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Ec,e,void 0,(e.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:y3,v3=Math.log,x3=Math.LN2;function y3(e){return e>>>=0,e===0?32:31-(v3(e)/x3|0)|0}var Pa=64,Oa=4194304;function uo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ol(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=uo(l):(s&=o,s!==0&&(n=uo(s)))}else o=r&~i,o!==0?n=uo(o):s!==0&&(n=uo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Er(t),i=1<<r,n|=e[r],t&=~i;return n}function b3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _3(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Er(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=b3(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Fg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gk(){var e=Pa;return Pa<<=1,!(Pa&4194240)&&(Pa=64),e}function Iu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function pa(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Er(t),e[t]=r}function w3(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Er(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function rx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Er(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var qe=0;function vk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xk,nx,yk,bk,_k,zg=!1,Da=[],Dn=null,Ln=null,Fn=null,Lo=new Map,Fo=new Map,Tn=[],j3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xy(e,t){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":Ln=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Lo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(t.pointerId)}}function Ws(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=ma(t),t!==null&&nx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function S3(e,t,r,n,i){switch(t){case"focusin":return Dn=Ws(Dn,e,t,r,n,i),!0;case"dragenter":return Ln=Ws(Ln,e,t,r,n,i),!0;case"mouseover":return Fn=Ws(Fn,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Lo.set(s,Ws(Lo.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Fo.set(s,Ws(Fo.get(s)||null,e,t,r,n,i)),!0}return!1}function wk(e){var t=ci(e.target);if(t!==null){var r=Ei(t);if(r!==null){if(t=r.tag,t===13){if(t=uk(r),t!==null){e.blockedOn=t,_k(e.priority,function(){yk(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=$g(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Pg=n,r.target.dispatchEvent(n),Pg=null}else return t=ma(r),t!==null&&nx(t),e.blockedOn=r,!1;t.shift()}return!0}function Qy(e,t,r){gl(e)&&r.delete(t)}function k3(){zg=!1,Dn!==null&&gl(Dn)&&(Dn=null),Ln!==null&&gl(Ln)&&(Ln=null),Fn!==null&&gl(Fn)&&(Fn=null),Lo.forEach(Qy),Fo.forEach(Qy)}function Us(e,t){e.blockedOn===t&&(e.blockedOn=null,zg||(zg=!0,nr.unstable_scheduleCallback(nr.unstable_NormalPriority,k3)))}function zo(e){function t(i){return Us(i,e)}if(0<Da.length){Us(Da[0],e);for(var r=1;r<Da.length;r++){var n=Da[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Dn!==null&&Us(Dn,e),Ln!==null&&Us(Ln,e),Fn!==null&&Us(Fn,e),Lo.forEach(t),Fo.forEach(t),r=0;r<Tn.length;r++)n=Tn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Tn.length&&(r=Tn[0],r.blockedOn===null);)wk(r),r.blockedOn===null&&Tn.shift()}var cs=xn.ReactCurrentBatchConfig,Dl=!0;function N3(e,t,r,n){var i=qe,s=cs.transition;cs.transition=null;try{qe=1,ix(e,t,r,n)}finally{qe=i,cs.transition=s}}function C3(e,t,r,n){var i=qe,s=cs.transition;cs.transition=null;try{qe=4,ix(e,t,r,n)}finally{qe=i,cs.transition=s}}function ix(e,t,r,n){if(Dl){var i=$g(e,t,r,n);if(i===null)Bu(e,t,n,Ll,r),Xy(e,n);else if(S3(i,e,t,r,n))n.stopPropagation();else if(Xy(e,n),t&4&&-1<j3.indexOf(e)){for(;i!==null;){var s=ma(i);if(s!==null&&xk(s),s=$g(e,t,r,n),s===null&&Bu(e,t,n,Ll,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Bu(e,t,n,null,r)}}var Ll=null;function $g(e,t,r,n){if(Ll=null,e=ex(n),e=ci(e),e!==null)if(t=Ei(e),t===null)e=null;else if(r=t.tag,r===13){if(e=uk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ll=e,null}function jk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(h3()){case tx:return 1;case hk:return 4;case Pl:case m3:return 16;case mk:return 536870912;default:return 16}default:return 16}}var Pn=null,sx=null,vl=null;function Sk(){if(vl)return vl;var e,t=sx,r=t.length,n,i="value"in Pn?Pn.value:Pn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return vl=i.slice(e,1<n?1-n:void 0)}function xl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function La(){return!0}function Zy(){return!1}function or(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?La:Zy,this.isPropagationStopped=Zy,this}return Je(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=La)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=La)},persist:function(){},isPersistent:La}),t}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ox=or(Rs),ha=Je({},Rs,{view:0,detail:0}),E3=or(ha),Mu,Pu,Vs,Tc=Je({},ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ax,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vs&&(Vs&&e.type==="mousemove"?(Mu=e.screenX-Vs.screenX,Pu=e.screenY-Vs.screenY):Pu=Mu=0,Vs=e),Mu)},movementY:function(e){return"movementY"in e?e.movementY:Pu}}),Jy=or(Tc),T3=Je({},Tc,{dataTransfer:0}),R3=or(T3),A3=Je({},ha,{relatedTarget:0}),Ou=or(A3),I3=Je({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),M3=or(I3),P3=Je({},Rs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),O3=or(P3),D3=Je({},Rs,{data:0}),e0=or(D3),L3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $3(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=z3[e])?!!t[e]:!1}function ax(){return $3}var q3=Je({},ha,{key:function(e){if(e.key){var t=L3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?F3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ax,charCode:function(e){return e.type==="keypress"?xl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),B3=or(q3),H3=Je({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t0=or(H3),W3=Je({},ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ax}),U3=or(W3),V3=Je({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),G3=or(V3),K3=Je({},Tc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Y3=or(K3),X3=[9,13,27,32],lx=un&&"CompositionEvent"in window,So=null;un&&"documentMode"in document&&(So=document.documentMode);var Q3=un&&"TextEvent"in window&&!So,kk=un&&(!lx||So&&8<So&&11>=So),r0=" ",n0=!1;function Nk(e,t){switch(e){case"keyup":return X3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ck(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vi=!1;function Z3(e,t){switch(e){case"compositionend":return Ck(t);case"keypress":return t.which!==32?null:(n0=!0,r0);case"textInput":return e=t.data,e===r0&&n0?null:e;default:return null}}function J3(e,t){if(Vi)return e==="compositionend"||!lx&&Nk(e,t)?(e=Sk(),vl=sx=Pn=null,Vi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return kk&&t.locale!=="ko"?null:t.data;default:return null}}var eA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!eA[e.type]:t==="textarea"}function Ek(e,t,r,n){sk(n),t=Fl(t,"onChange"),0<t.length&&(r=new ox("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ko=null,$o=null;function tA(e){zk(e,0)}function Rc(e){var t=Yi(e);if(ZS(t))return e}function rA(e,t){if(e==="change")return t}var Tk=!1;if(un){var Du;if(un){var Lu="oninput"in document;if(!Lu){var s0=document.createElement("div");s0.setAttribute("oninput","return;"),Lu=typeof s0.oninput=="function"}Du=Lu}else Du=!1;Tk=Du&&(!document.documentMode||9<document.documentMode)}function o0(){ko&&(ko.detachEvent("onpropertychange",Rk),$o=ko=null)}function Rk(e){if(e.propertyName==="value"&&Rc($o)){var t=[];Ek(t,$o,e,ex(e)),ck(tA,t)}}function nA(e,t,r){e==="focusin"?(o0(),ko=t,$o=r,ko.attachEvent("onpropertychange",Rk)):e==="focusout"&&o0()}function iA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Rc($o)}function sA(e,t){if(e==="click")return Rc(t)}function oA(e,t){if(e==="input"||e==="change")return Rc(t)}function aA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rr=typeof Object.is=="function"?Object.is:aA;function qo(e,t){if(Rr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!wg.call(t,i)||!Rr(e[i],t[i]))return!1}return!0}function a0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function l0(e,t){var r=a0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=a0(r)}}function Ak(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ak(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ik(){for(var e=window,t=Al();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Al(e.document)}return t}function cx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function lA(e){var t=Ik(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ak(r.ownerDocument.documentElement,r)){if(n!==null&&cx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=l0(r,s);var o=l0(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cA=un&&"documentMode"in document&&11>=document.documentMode,Gi=null,qg=null,No=null,Bg=!1;function c0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Bg||Gi==null||Gi!==Al(n)||(n=Gi,"selectionStart"in n&&cx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),No&&qo(No,n)||(No=n,n=Fl(qg,"onSelect"),0<n.length&&(t=new ox("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gi)))}function Fa(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ki={animationend:Fa("Animation","AnimationEnd"),animationiteration:Fa("Animation","AnimationIteration"),animationstart:Fa("Animation","AnimationStart"),transitionend:Fa("Transition","TransitionEnd")},Fu={},Mk={};un&&(Mk=document.createElement("div").style,"AnimationEvent"in window||(delete Ki.animationend.animation,delete Ki.animationiteration.animation,delete Ki.animationstart.animation),"TransitionEvent"in window||delete Ki.transitionend.transition);function Ac(e){if(Fu[e])return Fu[e];if(!Ki[e])return e;var t=Ki[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Mk)return Fu[e]=t[r];return e}var Pk=Ac("animationend"),Ok=Ac("animationiteration"),Dk=Ac("animationstart"),Lk=Ac("transitionend"),Fk=new Map,u0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zn(e,t){Fk.set(e,t),Ci(t,[e])}for(var zu=0;zu<u0.length;zu++){var $u=u0[zu],uA=$u.toLowerCase(),dA=$u[0].toUpperCase()+$u.slice(1);Zn(uA,"on"+dA)}Zn(Pk,"onAnimationEnd");Zn(Ok,"onAnimationIteration");Zn(Dk,"onAnimationStart");Zn("dblclick","onDoubleClick");Zn("focusin","onFocus");Zn("focusout","onBlur");Zn(Lk,"onTransitionEnd");gs("onMouseEnter",["mouseout","mouseover"]);gs("onMouseLeave",["mouseout","mouseover"]);gs("onPointerEnter",["pointerout","pointerover"]);gs("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fA=new Set("cancel close invalid load scroll toggle".split(" ").concat(fo));function d0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,u3(n,t,void 0,e),e.currentTarget=null}function zk(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;d0(i,l,d),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;d0(i,l,d),s=c}}}if(Ml)throw e=Lg,Ml=!1,Lg=null,e}function Ue(e,t){var r=t[Gg];r===void 0&&(r=t[Gg]=new Set);var n=e+"__bubble";r.has(n)||($k(t,e,2,!1),r.add(n))}function qu(e,t,r){var n=0;t&&(n|=4),$k(r,e,n,t)}var za="_reactListening"+Math.random().toString(36).slice(2);function Bo(e){if(!e[za]){e[za]=!0,GS.forEach(function(r){r!=="selectionchange"&&(fA.has(r)||qu(r,!1,e),qu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[za]||(t[za]=!0,qu("selectionchange",!1,t))}}function $k(e,t,r,n){switch(jk(t)){case 1:var i=N3;break;case 4:i=C3;break;default:i=ix}r=i.bind(null,t,r,e),i=void 0,!Dg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Bu(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ci(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}ck(function(){var d=s,u=ex(r),f=[];e:{var p=Fk.get(e);if(p!==void 0){var h=ox,x=e;switch(e){case"keypress":if(xl(r)===0)break e;case"keydown":case"keyup":h=B3;break;case"focusin":x="focus",h=Ou;break;case"focusout":x="blur",h=Ou;break;case"beforeblur":case"afterblur":h=Ou;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Jy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=R3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=U3;break;case Pk:case Ok:case Dk:h=M3;break;case Lk:h=G3;break;case"scroll":h=E3;break;case"wheel":h=Y3;break;case"copy":case"cut":case"paste":h=O3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=t0}var g=(t&4)!==0,_=!g&&e==="scroll",v=g?p!==null?p+"Capture":null:p;g=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Do(y,v),w!=null&&g.push(Ho(y,w,b)))),_)break;y=y.return}0<g.length&&(p=new h(p,x,null,r,u),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Pg&&(x=r.relatedTarget||r.fromElement)&&(ci(x)||x[dn]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(x=r.relatedTarget||r.toElement,h=d,x=x?ci(x):null,x!==null&&(_=Ei(x),x!==_||x.tag!==5&&x.tag!==6)&&(x=null)):(h=null,x=d),h!==x)){if(g=Jy,w="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=t0,w="onPointerLeave",v="onPointerEnter",y="pointer"),_=h==null?p:Yi(h),b=x==null?p:Yi(x),p=new g(w,y+"leave",h,r,u),p.target=_,p.relatedTarget=b,w=null,ci(u)===d&&(g=new g(v,y+"enter",x,r,u),g.target=b,g.relatedTarget=_,w=g),_=w,h&&x)t:{for(g=h,v=x,y=0,b=g;b;b=Pi(b))y++;for(b=0,w=v;w;w=Pi(w))b++;for(;0<y-b;)g=Pi(g),y--;for(;0<b-y;)v=Pi(v),b--;for(;y--;){if(g===v||v!==null&&g===v.alternate)break t;g=Pi(g),v=Pi(v)}g=null}else g=null;h!==null&&f0(f,p,h,g,!1),x!==null&&_!==null&&f0(f,_,x,g,!0)}}e:{if(p=d?Yi(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var k=rA;else if(i0(p))if(Tk)k=oA;else{k=iA;var S=nA}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=sA);if(k&&(k=k(e,d))){Ek(f,k,r,u);break e}S&&S(e,p,d),e==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&Tg(p,"number",p.value)}switch(S=d?Yi(d):window,e){case"focusin":(i0(S)||S.contentEditable==="true")&&(Gi=S,qg=d,No=null);break;case"focusout":No=qg=Gi=null;break;case"mousedown":Bg=!0;break;case"contextmenu":case"mouseup":case"dragend":Bg=!1,c0(f,r,u);break;case"selectionchange":if(cA)break;case"keydown":case"keyup":c0(f,r,u)}var C;if(lx)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Vi?Nk(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(kk&&r.locale!=="ko"&&(Vi||T!=="onCompositionStart"?T==="onCompositionEnd"&&Vi&&(C=Sk()):(Pn=u,sx="value"in Pn?Pn.value:Pn.textContent,Vi=!0)),S=Fl(d,T),0<S.length&&(T=new e0(T,e,null,r,u),f.push({event:T,listeners:S}),C?T.data=C:(C=Ck(r),C!==null&&(T.data=C)))),(C=Q3?Z3(e,r):J3(e,r))&&(d=Fl(d,"onBeforeInput"),0<d.length&&(u=new e0("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=C))}zk(f,t)})}function Ho(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Fl(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Do(e,r),s!=null&&n.unshift(Ho(e,s,i)),s=Do(e,t),s!=null&&n.push(Ho(e,s,i))),e=e.return}return n}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function f0(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,i?(c=Do(r,s),c!=null&&o.unshift(Ho(r,c,l))):i||(c=Do(r,s),c!=null&&o.push(Ho(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var pA=/\r\n?/g,hA=/\u0000|\uFFFD/g;function p0(e){return(typeof e=="string"?e:""+e).replace(pA,`
`).replace(hA,"")}function $a(e,t,r){if(t=p0(t),p0(e)!==t&&r)throw Error(te(425))}function zl(){}var Hg=null,Wg=null;function Ug(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Vg=typeof setTimeout=="function"?setTimeout:void 0,mA=typeof clearTimeout=="function"?clearTimeout:void 0,h0=typeof Promise=="function"?Promise:void 0,gA=typeof queueMicrotask=="function"?queueMicrotask:typeof h0<"u"?function(e){return h0.resolve(null).then(e).catch(vA)}:Vg;function vA(e){setTimeout(function(){throw e})}function Hu(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),zo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);zo(t)}function zn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function m0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var As=Math.random().toString(36).slice(2),$r="__reactFiber$"+As,Wo="__reactProps$"+As,dn="__reactContainer$"+As,Gg="__reactEvents$"+As,xA="__reactListeners$"+As,yA="__reactHandles$"+As;function ci(e){var t=e[$r];if(t)return t;for(var r=e.parentNode;r;){if(t=r[dn]||r[$r]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=m0(e);e!==null;){if(r=e[$r])return r;e=m0(e)}return t}e=r,r=e.parentNode}return null}function ma(e){return e=e[$r]||e[dn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Yi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function Ic(e){return e[Wo]||null}var Kg=[],Xi=-1;function Jn(e){return{current:e}}function Ge(e){0>Xi||(e.current=Kg[Xi],Kg[Xi]=null,Xi--)}function He(e,t){Xi++,Kg[Xi]=e.current,e.current=t}var Yn={},It=Jn(Yn),Ut=Jn(!1),bi=Yn;function vs(e,t){var r=e.type.contextTypes;if(!r)return Yn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Vt(e){return e=e.childContextTypes,e!=null}function $l(){Ge(Ut),Ge(It)}function g0(e,t,r){if(It.current!==Yn)throw Error(te(168));He(It,t),He(Ut,r)}function qk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(te(108,n3(e)||"Unknown",i));return Je({},r,n)}function ql(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Yn,bi=It.current,He(It,e),He(Ut,Ut.current),!0}function v0(e,t,r){var n=e.stateNode;if(!n)throw Error(te(169));r?(e=qk(e,t,bi),n.__reactInternalMemoizedMergedChildContext=e,Ge(Ut),Ge(It),He(It,e)):Ge(Ut),He(Ut,r)}var en=null,Mc=!1,Wu=!1;function Bk(e){en===null?en=[e]:en.push(e)}function bA(e){Mc=!0,Bk(e)}function ei(){if(!Wu&&en!==null){Wu=!0;var e=0,t=qe;try{var r=en;for(qe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}en=null,Mc=!1}catch(i){throw en!==null&&(en=en.slice(e+1)),pk(tx,ei),i}finally{qe=t,Wu=!1}}return null}var Qi=[],Zi=0,Bl=null,Hl=0,ur=[],dr=0,_i=null,rn=1,nn="";function oi(e,t){Qi[Zi++]=Hl,Qi[Zi++]=Bl,Bl=e,Hl=t}function Hk(e,t,r){ur[dr++]=rn,ur[dr++]=nn,ur[dr++]=_i,_i=e;var n=rn;e=nn;var i=32-Er(n)-1;n&=~(1<<i),r+=1;var s=32-Er(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,rn=1<<32-Er(t)+i|r<<i|n,nn=s+e}else rn=1<<s|r<<i|n,nn=e}function ux(e){e.return!==null&&(oi(e,1),Hk(e,1,0))}function dx(e){for(;e===Bl;)Bl=Qi[--Zi],Qi[Zi]=null,Hl=Qi[--Zi],Qi[Zi]=null;for(;e===_i;)_i=ur[--dr],ur[dr]=null,nn=ur[--dr],ur[dr]=null,rn=ur[--dr],ur[dr]=null}var rr=null,tr=null,Ke=!1,Nr=null;function Wk(e,t){var r=pr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function x0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rr=e,tr=zn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rr=e,tr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_i!==null?{id:rn,overflow:nn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=pr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,rr=e,tr=null,!0):!1;default:return!1}}function Yg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xg(e){if(Ke){var t=tr;if(t){var r=t;if(!x0(e,t)){if(Yg(e))throw Error(te(418));t=zn(r.nextSibling);var n=rr;t&&x0(e,t)?Wk(n,r):(e.flags=e.flags&-4097|2,Ke=!1,rr=e)}}else{if(Yg(e))throw Error(te(418));e.flags=e.flags&-4097|2,Ke=!1,rr=e}}}function y0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rr=e}function qa(e){if(e!==rr)return!1;if(!Ke)return y0(e),Ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ug(e.type,e.memoizedProps)),t&&(t=tr)){if(Yg(e))throw Uk(),Error(te(418));for(;t;)Wk(e,t),t=zn(t.nextSibling)}if(y0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){tr=zn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}tr=null}}else tr=rr?zn(e.stateNode.nextSibling):null;return!0}function Uk(){for(var e=tr;e;)e=zn(e.nextSibling)}function xs(){tr=rr=null,Ke=!1}function fx(e){Nr===null?Nr=[e]:Nr.push(e)}var _A=xn.ReactCurrentBatchConfig;function Gs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var n=r.stateNode}if(!n)throw Error(te(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function Ba(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function b0(e){var t=e._init;return t(e._payload)}function Vk(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=Hn(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=Qu(b,v.mode,w),y.return=v,y):(y=i(y,b),y.return=v,y)}function c(v,y,b,w){var k=b.type;return k===Ui?u(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Sn&&b0(k)===y.type)?(w=i(y,b.props),w.ref=Gs(v,y,b),w.return=v,w):(w=kl(b.type,b.key,b.props,null,v.mode,w),w.ref=Gs(v,y,b),w.return=v,w)}function d(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Zu(b,v.mode,w),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function u(v,y,b,w,k){return y===null||y.tag!==7?(y=gi(b,v.mode,w,k),y.return=v,y):(y=i(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Qu(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Aa:return b=kl(y.type,y.key,y.props,null,v.mode,b),b.ref=Gs(v,null,y),b.return=v,b;case Wi:return y=Zu(y,v.mode,b),y.return=v,y;case Sn:var w=y._init;return f(v,w(y._payload),b)}if(co(y)||Bs(y))return y=gi(y,v.mode,b,null),y.return=v,y;Ba(v,y)}return null}function p(v,y,b,w){var k=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Aa:return b.key===k?c(v,y,b,w):null;case Wi:return b.key===k?d(v,y,b,w):null;case Sn:return k=b._init,p(v,y,k(b._payload),w)}if(co(b)||Bs(b))return k!==null?null:u(v,y,b,w,null);Ba(v,b)}return null}function h(v,y,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Aa:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,k);case Wi:return v=v.get(w.key===null?b:w.key)||null,d(y,v,w,k);case Sn:var S=w._init;return h(v,y,b,S(w._payload),k)}if(co(w)||Bs(w))return v=v.get(b)||null,u(y,v,w,k,null);Ba(y,w)}return null}function x(v,y,b,w){for(var k=null,S=null,C=y,T=y=0,j=null;C!==null&&T<b.length;T++){C.index>T?(j=C,C=null):j=C.sibling;var R=p(v,C,b[T],w);if(R===null){C===null&&(C=j);break}e&&C&&R.alternate===null&&t(v,C),y=s(R,y,T),S===null?k=R:S.sibling=R,S=R,C=j}if(T===b.length)return r(v,C),Ke&&oi(v,T),k;if(C===null){for(;T<b.length;T++)C=f(v,b[T],w),C!==null&&(y=s(C,y,T),S===null?k=C:S.sibling=C,S=C);return Ke&&oi(v,T),k}for(C=n(v,C);T<b.length;T++)j=h(C,v,T,b[T],w),j!==null&&(e&&j.alternate!==null&&C.delete(j.key===null?T:j.key),y=s(j,y,T),S===null?k=j:S.sibling=j,S=j);return e&&C.forEach(function(E){return t(v,E)}),Ke&&oi(v,T),k}function g(v,y,b,w){var k=Bs(b);if(typeof k!="function")throw Error(te(150));if(b=k.call(b),b==null)throw Error(te(151));for(var S=k=null,C=y,T=y=0,j=null,R=b.next();C!==null&&!R.done;T++,R=b.next()){C.index>T?(j=C,C=null):j=C.sibling;var E=p(v,C,R.value,w);if(E===null){C===null&&(C=j);break}e&&C&&E.alternate===null&&t(v,C),y=s(E,y,T),S===null?k=E:S.sibling=E,S=E,C=j}if(R.done)return r(v,C),Ke&&oi(v,T),k;if(C===null){for(;!R.done;T++,R=b.next())R=f(v,R.value,w),R!==null&&(y=s(R,y,T),S===null?k=R:S.sibling=R,S=R);return Ke&&oi(v,T),k}for(C=n(v,C);!R.done;T++,R=b.next())R=h(C,v,T,R.value,w),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?T:R.key),y=s(R,y,T),S===null?k=R:S.sibling=R,S=R);return e&&C.forEach(function(M){return t(v,M)}),Ke&&oi(v,T),k}function _(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Ui&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Aa:e:{for(var k=b.key,S=y;S!==null;){if(S.key===k){if(k=b.type,k===Ui){if(S.tag===7){r(v,S.sibling),y=i(S,b.props.children),y.return=v,v=y;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Sn&&b0(k)===S.type){r(v,S.sibling),y=i(S,b.props),y.ref=Gs(v,S,b),y.return=v,v=y;break e}r(v,S);break}else t(v,S);S=S.sibling}b.type===Ui?(y=gi(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=kl(b.type,b.key,b.props,null,v.mode,w),w.ref=Gs(v,y,b),w.return=v,v=w)}return o(v);case Wi:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=Zu(b,v.mode,w),y.return=v,v=y}return o(v);case Sn:return S=b._init,_(v,y,S(b._payload),w)}if(co(b))return x(v,y,b,w);if(Bs(b))return g(v,y,b,w);Ba(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=i(y,b),y.return=v,v=y):(r(v,y),y=Qu(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return _}var ys=Vk(!0),Gk=Vk(!1),Wl=Jn(null),Ul=null,Ji=null,px=null;function hx(){px=Ji=Ul=null}function mx(e){var t=Wl.current;Ge(Wl),e._currentValue=t}function Qg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function us(e,t){Ul=e,px=Ji=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bt=!0),e.firstContext=null)}function gr(e){var t=e._currentValue;if(px!==e)if(e={context:e,memoizedValue:t,next:null},Ji===null){if(Ul===null)throw Error(te(308));Ji=e,Ul.dependencies={lanes:0,firstContext:e}}else Ji=Ji.next=e;return t}var ui=null;function gx(e){ui===null?ui=[e]:ui.push(e)}function Kk(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,gx(t)):(r.next=i.next,i.next=r),t.interleaved=r,fn(e,n)}function fn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var kn=!1;function vx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ln(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $n(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Oe&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,fn(e,r)}return i=n.interleaved,i===null?(t.next=t,gx(n)):(t.next=i.next,i.next=t),n.interleaved=t,fn(e,r)}function yl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,rx(e,r)}}function _0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vl(e,t,r,n){var i=e.updateQueue;kn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,u=d=c=null,l=s;do{var p=l.lane,h=l.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,g=l;switch(p=t,h=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){f=x.call(h,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,p=typeof x=="function"?x.call(h,f,p):x,p==null)break e;f=Je({},f,p);break e;case 2:kn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,o|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ji|=o,e.lanes=o,e.memoizedState=f}}function w0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(te(191,i));i.call(n)}}}var ga={},Hr=Jn(ga),Uo=Jn(ga),Vo=Jn(ga);function di(e){if(e===ga)throw Error(te(174));return e}function xx(e,t){switch(He(Vo,t),He(Uo,e),He(Hr,ga),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ag(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ag(t,e)}Ge(Hr),He(Hr,t)}function bs(){Ge(Hr),Ge(Uo),Ge(Vo)}function Xk(e){di(Vo.current);var t=di(Hr.current),r=Ag(t,e.type);t!==r&&(He(Uo,e),He(Hr,r))}function yx(e){Uo.current===e&&(Ge(Hr),Ge(Uo))}var Qe=Jn(0);function Gl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Uu=[];function bx(){for(var e=0;e<Uu.length;e++)Uu[e]._workInProgressVersionPrimary=null;Uu.length=0}var bl=xn.ReactCurrentDispatcher,Vu=xn.ReactCurrentBatchConfig,wi=0,Ze=null,ut=null,mt=null,Kl=!1,Co=!1,Go=0,wA=0;function Tt(){throw Error(te(321))}function _x(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Rr(e[r],t[r]))return!1;return!0}function wx(e,t,r,n,i,s){if(wi=s,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bl.current=e===null||e.memoizedState===null?NA:CA,e=r(n,i),Co){s=0;do{if(Co=!1,Go=0,25<=s)throw Error(te(301));s+=1,mt=ut=null,t.updateQueue=null,bl.current=EA,e=r(n,i)}while(Co)}if(bl.current=Yl,t=ut!==null&&ut.next!==null,wi=0,mt=ut=Ze=null,Kl=!1,t)throw Error(te(300));return e}function jx(){var e=Go!==0;return Go=0,e}function zr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Ze.memoizedState=mt=e:mt=mt.next=e,mt}function vr(){if(ut===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var t=mt===null?Ze.memoizedState:mt.next;if(t!==null)mt=t,ut=e;else{if(e===null)throw Error(te(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},mt===null?Ze.memoizedState=mt=e:mt=mt.next=e}return mt}function Ko(e,t){return typeof t=="function"?t(e):t}function Gu(e){var t=vr(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=ut,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((wi&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ze.lanes|=u,ji|=u}d=d.next}while(d!==null&&d!==s);c===null?o=n:c.next=l,Rr(n,t.memoizedState)||(Bt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ze.lanes|=s,ji|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ku(e){var t=vr(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Rr(s,t.memoizedState)||(Bt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Qk(){}function Zk(e,t){var r=Ze,n=vr(),i=t(),s=!Rr(n.memoizedState,i);if(s&&(n.memoizedState=i,Bt=!0),n=n.queue,Sx(tN.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||mt!==null&&mt.memoizedState.tag&1){if(r.flags|=2048,Yo(9,eN.bind(null,r,n,i,t),void 0,null),vt===null)throw Error(te(349));wi&30||Jk(r,t,i)}return i}function Jk(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function eN(e,t,r,n){t.value=r,t.getSnapshot=n,rN(t)&&nN(e)}function tN(e,t,r){return r(function(){rN(t)&&nN(e)})}function rN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Rr(e,r)}catch{return!0}}function nN(e){var t=fn(e,1);t!==null&&Tr(t,e,1,-1)}function j0(e){var t=zr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ko,lastRenderedState:e},t.queue=e,e=e.dispatch=kA.bind(null,Ze,e),[t.memoizedState,e]}function Yo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function iN(){return vr().memoizedState}function _l(e,t,r,n){var i=zr();Ze.flags|=e,i.memoizedState=Yo(1|t,r,void 0,n===void 0?null:n)}function Pc(e,t,r,n){var i=vr();n=n===void 0?null:n;var s=void 0;if(ut!==null){var o=ut.memoizedState;if(s=o.destroy,n!==null&&_x(n,o.deps)){i.memoizedState=Yo(t,r,s,n);return}}Ze.flags|=e,i.memoizedState=Yo(1|t,r,s,n)}function S0(e,t){return _l(8390656,8,e,t)}function Sx(e,t){return Pc(2048,8,e,t)}function sN(e,t){return Pc(4,2,e,t)}function oN(e,t){return Pc(4,4,e,t)}function aN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lN(e,t,r){return r=r!=null?r.concat([e]):null,Pc(4,4,aN.bind(null,t,e),r)}function kx(){}function cN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&_x(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function uN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&_x(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function dN(e,t,r){return wi&21?(Rr(r,t)||(r=gk(),Ze.lanes|=r,ji|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bt=!0),e.memoizedState=r)}function jA(e,t){var r=qe;qe=r!==0&&4>r?r:4,e(!0);var n=Vu.transition;Vu.transition={};try{e(!1),t()}finally{qe=r,Vu.transition=n}}function fN(){return vr().memoizedState}function SA(e,t,r){var n=Bn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},pN(e))hN(t,r);else if(r=Kk(e,t,r,n),r!==null){var i=Lt();Tr(r,e,n,i),mN(r,t,n)}}function kA(e,t,r){var n=Bn(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(pN(e))hN(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,Rr(l,o)){var c=t.interleaved;c===null?(i.next=i,gx(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=Kk(e,t,i,n),r!==null&&(i=Lt(),Tr(r,e,n,i),mN(r,t,n))}}function pN(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function hN(e,t){Co=Kl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function mN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,rx(e,r)}}var Yl={readContext:gr,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},NA={readContext:gr,useCallback:function(e,t){return zr().memoizedState=[e,t===void 0?null:t],e},useContext:gr,useEffect:S0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,_l(4194308,4,aN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return _l(4194308,4,e,t)},useInsertionEffect:function(e,t){return _l(4,2,e,t)},useMemo:function(e,t){var r=zr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=zr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=SA.bind(null,Ze,e),[n.memoizedState,e]},useRef:function(e){var t=zr();return e={current:e},t.memoizedState=e},useState:j0,useDebugValue:kx,useDeferredValue:function(e){return zr().memoizedState=e},useTransition:function(){var e=j0(!1),t=e[0];return e=jA.bind(null,e[1]),zr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ze,i=zr();if(Ke){if(r===void 0)throw Error(te(407));r=r()}else{if(r=t(),vt===null)throw Error(te(349));wi&30||Jk(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,S0(tN.bind(null,n,s,e),[e]),n.flags|=2048,Yo(9,eN.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=zr(),t=vt.identifierPrefix;if(Ke){var r=nn,n=rn;r=(n&~(1<<32-Er(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Go++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=wA++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},CA={readContext:gr,useCallback:cN,useContext:gr,useEffect:Sx,useImperativeHandle:lN,useInsertionEffect:sN,useLayoutEffect:oN,useMemo:uN,useReducer:Gu,useRef:iN,useState:function(){return Gu(Ko)},useDebugValue:kx,useDeferredValue:function(e){var t=vr();return dN(t,ut.memoizedState,e)},useTransition:function(){var e=Gu(Ko)[0],t=vr().memoizedState;return[e,t]},useMutableSource:Qk,useSyncExternalStore:Zk,useId:fN,unstable_isNewReconciler:!1},EA={readContext:gr,useCallback:cN,useContext:gr,useEffect:Sx,useImperativeHandle:lN,useInsertionEffect:sN,useLayoutEffect:oN,useMemo:uN,useReducer:Ku,useRef:iN,useState:function(){return Ku(Ko)},useDebugValue:kx,useDeferredValue:function(e){var t=vr();return ut===null?t.memoizedState=e:dN(t,ut.memoizedState,e)},useTransition:function(){var e=Ku(Ko)[0],t=vr().memoizedState;return[e,t]},useMutableSource:Qk,useSyncExternalStore:Zk,useId:fN,unstable_isNewReconciler:!1};function jr(e,t){if(e&&e.defaultProps){t=Je({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Zg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Je({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Oc={isMounted:function(e){return(e=e._reactInternals)?Ei(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Lt(),i=Bn(e),s=ln(n,i);s.payload=t,r!=null&&(s.callback=r),t=$n(e,s,i),t!==null&&(Tr(t,e,i,n),yl(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Lt(),i=Bn(e),s=ln(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=$n(e,s,i),t!==null&&(Tr(t,e,i,n),yl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Lt(),n=Bn(e),i=ln(r,n);i.tag=2,t!=null&&(i.callback=t),t=$n(e,i,n),t!==null&&(Tr(t,e,n,r),yl(t,e,n))}};function k0(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!qo(r,n)||!qo(i,s):!0}function gN(e,t,r){var n=!1,i=Yn,s=t.contextType;return typeof s=="object"&&s!==null?s=gr(s):(i=Vt(t)?bi:It.current,n=t.contextTypes,s=(n=n!=null)?vs(e,i):Yn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Oc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function N0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Oc.enqueueReplaceState(t,t.state,null)}function Jg(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},vx(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=gr(s):(s=Vt(t)?bi:It.current,i.context=vs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Zg(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Oc.enqueueReplaceState(i,i.state,null),Vl(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function _s(e,t){try{var r="",n=t;do r+=r3(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Yu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ev(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var TA=typeof WeakMap=="function"?WeakMap:Map;function vN(e,t,r){r=ln(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ql||(Ql=!0,uv=n),ev(e,t)},r}function xN(e,t,r){r=ln(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){ev(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){ev(e,t),typeof n!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function C0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new TA;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=HA.bind(null,e,t,r),t.then(e,e))}function E0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function T0(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ln(-1,1),t.tag=2,$n(r,t,1))),r.lanes|=1),e)}var RA=xn.ReactCurrentOwner,Bt=!1;function Ot(e,t,r,n){t.child=e===null?Gk(t,null,r,n):ys(t,e.child,r,n)}function R0(e,t,r,n,i){r=r.render;var s=t.ref;return us(t,i),n=wx(e,t,r,n,s,i),r=jx(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,pn(e,t,i)):(Ke&&r&&ux(t),t.flags|=1,Ot(e,t,n,i),t.child)}function A0(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Mx(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,yN(e,t,s,n,i)):(e=kl(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:qo,r(o,n)&&e.ref===t.ref)return pn(e,t,i)}return t.flags|=1,e=Hn(s,n),e.ref=t.ref,e.return=t,t.child=e}function yN(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(qo(s,n)&&e.ref===t.ref)if(Bt=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Bt=!0);else return t.lanes=e.lanes,pn(e,t,i)}return tv(e,t,r,n,i)}function bN(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(ts,Jt),Jt|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,He(ts,Jt),Jt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,He(ts,Jt),Jt|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,He(ts,Jt),Jt|=n;return Ot(e,t,i,r),t.child}function _N(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function tv(e,t,r,n,i){var s=Vt(r)?bi:It.current;return s=vs(t,s),us(t,i),r=wx(e,t,r,n,s,i),n=jx(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,pn(e,t,i)):(Ke&&n&&ux(t),t.flags|=1,Ot(e,t,r,i),t.child)}function I0(e,t,r,n,i){if(Vt(r)){var s=!0;ql(t)}else s=!1;if(us(t,i),t.stateNode===null)wl(e,t),gN(t,r,n),Jg(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=gr(d):(d=Vt(r)?bi:It.current,d=vs(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&N0(t,o,n,d),kn=!1;var p=t.memoizedState;o.state=p,Vl(t,n,o,i),c=t.memoizedState,l!==n||p!==c||Ut.current||kn?(typeof u=="function"&&(Zg(t,r,u,n),c=t.memoizedState),(l=kn||k0(t,r,l,n,p,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Yk(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:jr(t.type,l),o.props=d,f=t.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=gr(c):(c=Vt(r)?bi:It.current,c=vs(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&N0(t,o,n,c),kn=!1,p=t.memoizedState,o.state=p,Vl(t,n,o,i);var x=t.memoizedState;l!==f||p!==x||Ut.current||kn?(typeof h=="function"&&(Zg(t,r,h,n),x=t.memoizedState),(d=kn||k0(t,r,d,n,p,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return rv(e,t,r,n,s,i)}function rv(e,t,r,n,i,s){_N(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&v0(t,r,!1),pn(e,t,s);n=t.stateNode,RA.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ys(t,e.child,null,s),t.child=ys(t,null,l,s)):Ot(e,t,l,s),t.memoizedState=n.state,i&&v0(t,r,!0),t.child}function wN(e){var t=e.stateNode;t.pendingContext?g0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&g0(e,t.context,!1),xx(e,t.containerInfo)}function M0(e,t,r,n,i){return xs(),fx(i),t.flags|=256,Ot(e,t,r,n),t.child}var nv={dehydrated:null,treeContext:null,retryLane:0};function iv(e){return{baseLanes:e,cachePool:null,transitions:null}}function jN(e,t,r){var n=t.pendingProps,i=Qe.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),He(Qe,i&1),e===null)return Xg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Fc(o,n,0,null),e=gi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=iv(r),t.memoizedState=nv,e):Nx(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return AA(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Hn(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Hn(l,s):(s=gi(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?iv(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=nv,n}return s=e.child,e=s.sibling,n=Hn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Nx(e,t){return t=Fc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ha(e,t,r,n){return n!==null&&fx(n),ys(t,e.child,null,r),e=Nx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function AA(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Yu(Error(te(422))),Ha(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Fc({mode:"visible",children:n.children},i,0,null),s=gi(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ys(t,e.child,null,o),t.child.memoizedState=iv(o),t.memoizedState=nv,s);if(!(t.mode&1))return Ha(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(te(419)),n=Yu(s,n,void 0),Ha(e,t,o,n)}if(l=(o&e.childLanes)!==0,Bt||l){if(n=vt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fn(e,i),Tr(n,e,i,-1))}return Ix(),n=Yu(Error(te(421))),Ha(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=WA.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,tr=zn(i.nextSibling),rr=t,Ke=!0,Nr=null,e!==null&&(ur[dr++]=rn,ur[dr++]=nn,ur[dr++]=_i,rn=e.id,nn=e.overflow,_i=t),t=Nx(t,n.children),t.flags|=4096,t)}function P0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Qg(e.return,t,r)}function Xu(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function SN(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Ot(e,t,n.children,r),n=Qe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&P0(e,r,t);else if(e.tag===19)P0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(He(Qe,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Gl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Xu(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Gl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Xu(t,!0,r,null,s);break;case"together":Xu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function pn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ji|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,r=Hn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Hn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function IA(e,t,r){switch(t.tag){case 3:wN(t),xs();break;case 5:Xk(t);break;case 1:Vt(t.type)&&ql(t);break;case 4:xx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;He(Wl,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(He(Qe,Qe.current&1),t.flags|=128,null):r&t.child.childLanes?jN(e,t,r):(He(Qe,Qe.current&1),e=pn(e,t,r),e!==null?e.sibling:null);He(Qe,Qe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return SN(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),He(Qe,Qe.current),n)break;return null;case 22:case 23:return t.lanes=0,bN(e,t,r)}return pn(e,t,r)}var kN,sv,NN,CN;kN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};sv=function(){};NN=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,di(Hr.current);var s=null;switch(r){case"input":i=Cg(e,i),n=Cg(e,n),s=[];break;case"select":i=Je({},i,{value:void 0}),n=Je({},n,{value:void 0}),s=[];break;case"textarea":i=Rg(e,i),n=Rg(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=zl)}Ig(r,n);var o;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Po.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var c=n[d];if(l=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Po.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ue("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}r&&(s=s||[]).push("style",r);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};CN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ks(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function MA(e,t,r){var n=t.pendingProps;switch(dx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(t),null;case 1:return Vt(t.type)&&$l(),Rt(t),null;case 3:return n=t.stateNode,bs(),Ge(Ut),Ge(It),bx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(qa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nr!==null&&(pv(Nr),Nr=null))),sv(e,t),Rt(t),null;case 5:yx(t);var i=di(Vo.current);if(r=t.type,e!==null&&t.stateNode!=null)NN(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(te(166));return Rt(t),null}if(e=di(Hr.current),qa(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[$r]=t,n[Wo]=s,e=(t.mode&1)!==0,r){case"dialog":Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":case"embed":Ue("load",n);break;case"video":case"audio":for(i=0;i<fo.length;i++)Ue(fo[i],n);break;case"source":Ue("error",n);break;case"img":case"image":case"link":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"input":Hy(n,s),Ue("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ue("invalid",n);break;case"textarea":Uy(n,s),Ue("invalid",n)}Ig(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&$a(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&$a(n.textContent,l,e),i=["children",""+l]):Po.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ue("scroll",n)}switch(r){case"input":Ia(n),Wy(n,s,!0);break;case"textarea":Ia(n),Vy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=zl)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=tk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[$r]=t,e[Wo]=n,kN(e,t,!1,!1),t.stateNode=e;e:{switch(o=Mg(r,n),r){case"dialog":Ue("cancel",e),Ue("close",e),i=n;break;case"iframe":case"object":case"embed":Ue("load",e),i=n;break;case"video":case"audio":for(i=0;i<fo.length;i++)Ue(fo[i],e);i=n;break;case"source":Ue("error",e),i=n;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),i=n;break;case"details":Ue("toggle",e),i=n;break;case"input":Hy(e,n),i=Cg(e,n),Ue("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Je({},n,{value:void 0}),Ue("invalid",e);break;case"textarea":Uy(e,n),i=Rg(e,n),Ue("invalid",e);break;default:i=n}Ig(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?ik(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rk(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Oo(e,c):typeof c=="number"&&Oo(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Po.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ue("scroll",e):c!=null&&Xv(e,s,c,o))}switch(r){case"input":Ia(e),Wy(e,n,!1);break;case"textarea":Ia(e),Vy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Kn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?os(e,!!n.multiple,s,!1):n.defaultValue!=null&&os(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=zl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Rt(t),null;case 6:if(e&&t.stateNode!=null)CN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(te(166));if(r=di(Vo.current),di(Hr.current),qa(t)){if(n=t.stateNode,r=t.memoizedProps,n[$r]=t,(s=n.nodeValue!==r)&&(e=rr,e!==null))switch(e.tag){case 3:$a(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$a(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$r]=t,t.stateNode=n}return Rt(t),null;case 13:if(Ge(Qe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ke&&tr!==null&&t.mode&1&&!(t.flags&128))Uk(),xs(),t.flags|=98560,s=!1;else if(s=qa(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(te(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[$r]=t}else xs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Rt(t),s=!1}else Nr!==null&&(pv(Nr),Nr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qe.current&1?pt===0&&(pt=3):Ix())),t.updateQueue!==null&&(t.flags|=4),Rt(t),null);case 4:return bs(),sv(e,t),e===null&&Bo(t.stateNode.containerInfo),Rt(t),null;case 10:return mx(t.type._context),Rt(t),null;case 17:return Vt(t.type)&&$l(),Rt(t),null;case 19:if(Ge(Qe),s=t.memoizedState,s===null)return Rt(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Ks(s,!1);else{if(pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Gl(e),o!==null){for(t.flags|=128,Ks(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return He(Qe,Qe.current&1|2),t.child}e=e.sibling}s.tail!==null&&st()>ws&&(t.flags|=128,n=!0,Ks(s,!1),t.lanes=4194304)}else{if(!n)if(e=Gl(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ks(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ke)return Rt(t),null}else 2*st()-s.renderingStartTime>ws&&r!==1073741824&&(t.flags|=128,n=!0,Ks(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=st(),t.sibling=null,r=Qe.current,He(Qe,n?r&1|2:r&1),t):(Rt(t),null);case 22:case 23:return Ax(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Jt&1073741824&&(Rt(t),t.subtreeFlags&6&&(t.flags|=8192)):Rt(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function PA(e,t){switch(dx(t),t.tag){case 1:return Vt(t.type)&&$l(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bs(),Ge(Ut),Ge(It),bx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return yx(t),null;case 13:if(Ge(Qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));xs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ge(Qe),null;case 4:return bs(),null;case 10:return mx(t.type._context),null;case 22:case 23:return Ax(),null;case 24:return null;default:return null}}var Wa=!1,At=!1,OA=typeof WeakSet=="function"?WeakSet:Set,ae=null;function es(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function ov(e,t,r){try{r()}catch(n){tt(e,t,n)}}var O0=!1;function DA(e,t){if(Hg=Dl,e=Ik(),cx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++d===i&&(l=o),p===s&&++u===n&&(c=o),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Wg={focusedElem:e,selectionRange:r},Dl=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,_=x.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:jr(t.type,g),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(w){tt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return x=O0,O0=!1,x}function Eo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&ov(t,r,s)}i=i.next}while(i!==n)}}function Dc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function av(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function EN(e){var t=e.alternate;t!==null&&(e.alternate=null,EN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$r],delete t[Wo],delete t[Gg],delete t[xA],delete t[yA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function TN(e){return e.tag===5||e.tag===3||e.tag===4}function D0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||TN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function lv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=zl));else if(n!==4&&(e=e.child,e!==null))for(lv(e,t,r),e=e.sibling;e!==null;)lv(e,t,r),e=e.sibling}function cv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(cv(e,t,r),e=e.sibling;e!==null;)cv(e,t,r),e=e.sibling}var jt=null,Sr=!1;function _n(e,t,r){for(r=r.child;r!==null;)RN(e,t,r),r=r.sibling}function RN(e,t,r){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Ec,r)}catch{}switch(r.tag){case 5:At||es(r,t);case 6:var n=jt,i=Sr;jt=null,_n(e,t,r),jt=n,Sr=i,jt!==null&&(Sr?(e=jt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):jt.removeChild(r.stateNode));break;case 18:jt!==null&&(Sr?(e=jt,r=r.stateNode,e.nodeType===8?Hu(e.parentNode,r):e.nodeType===1&&Hu(e,r),zo(e)):Hu(jt,r.stateNode));break;case 4:n=jt,i=Sr,jt=r.stateNode.containerInfo,Sr=!0,_n(e,t,r),jt=n,Sr=i;break;case 0:case 11:case 14:case 15:if(!At&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ov(r,t,o),i=i.next}while(i!==n)}_n(e,t,r);break;case 1:if(!At&&(es(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){tt(r,t,l)}_n(e,t,r);break;case 21:_n(e,t,r);break;case 22:r.mode&1?(At=(n=At)||r.memoizedState!==null,_n(e,t,r),At=n):_n(e,t,r);break;default:_n(e,t,r)}}function L0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new OA),t.forEach(function(n){var i=UA.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function _r(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:jt=l.stateNode,Sr=!1;break e;case 3:jt=l.stateNode.containerInfo,Sr=!0;break e;case 4:jt=l.stateNode.containerInfo,Sr=!0;break e}l=l.return}if(jt===null)throw Error(te(160));RN(s,o,i),jt=null,Sr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){tt(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)AN(t,e),t=t.sibling}function AN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_r(t,e),Lr(e),n&4){try{Eo(3,e,e.return),Dc(3,e)}catch(g){tt(e,e.return,g)}try{Eo(5,e,e.return)}catch(g){tt(e,e.return,g)}}break;case 1:_r(t,e),Lr(e),n&512&&r!==null&&es(r,r.return);break;case 5:if(_r(t,e),Lr(e),n&512&&r!==null&&es(r,r.return),e.flags&32){var i=e.stateNode;try{Oo(i,"")}catch(g){tt(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&JS(i,s),Mg(l,o);var d=Mg(l,s);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?ik(i,f):u==="dangerouslySetInnerHTML"?rk(i,f):u==="children"?Oo(i,f):Xv(i,u,f,d)}switch(l){case"input":Eg(i,s);break;case"textarea":ek(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?os(i,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?os(i,!!s.multiple,s.defaultValue,!0):os(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wo]=s}catch(g){tt(e,e.return,g)}}break;case 6:if(_r(t,e),Lr(e),n&4){if(e.stateNode===null)throw Error(te(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){tt(e,e.return,g)}}break;case 3:if(_r(t,e),Lr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{zo(t.containerInfo)}catch(g){tt(e,e.return,g)}break;case 4:_r(t,e),Lr(e);break;case 13:_r(t,e),Lr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Tx=st())),n&4&&L0(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(At=(d=At)||u,_r(t,e),At=d):_r(t,e),Lr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(ae=e,u=e.child;u!==null;){for(f=ae=u;ae!==null;){switch(p=ae,h=p.child,p.tag){case 0:case 11:case 14:case 15:Eo(4,p,p.return);break;case 1:es(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){tt(n,r,g)}}break;case 5:es(p,p.return);break;case 22:if(p.memoizedState!==null){z0(f);continue}}h!==null?(h.return=p,ae=h):z0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=nk("display",o))}catch(g){tt(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){tt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:_r(t,e),Lr(e),n&4&&L0(e);break;case 21:break;default:_r(t,e),Lr(e)}}function Lr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(TN(r)){var n=r;break e}r=r.return}throw Error(te(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Oo(i,""),n.flags&=-33);var s=D0(e);cv(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=D0(e);lv(e,l,o);break;default:throw Error(te(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function LA(e,t,r){ae=e,IN(e)}function IN(e,t,r){for(var n=(e.mode&1)!==0;ae!==null;){var i=ae,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Wa;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||At;l=Wa;var d=At;if(Wa=o,(At=c)&&!d)for(ae=i;ae!==null;)o=ae,c=o.child,o.tag===22&&o.memoizedState!==null?$0(i):c!==null?(c.return=o,ae=c):$0(i);for(;s!==null;)ae=s,IN(s),s=s.sibling;ae=i,Wa=l,At=d}F0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ae=s):F0(e)}}function F0(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:At||Dc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!At)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:jr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&w0(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}w0(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&zo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}At||t.flags&512&&av(t)}catch(p){tt(t,t.return,p)}}if(t===e){ae=null;break}if(r=t.sibling,r!==null){r.return=t.return,ae=r;break}ae=t.return}}function z0(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ae=r;break}ae=t.return}}function $0(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Dc(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){tt(t,i,c)}}var s=t.return;try{av(t)}catch(c){tt(t,s,c)}break;case 5:var o=t.return;try{av(t)}catch(c){tt(t,o,c)}}}catch(c){tt(t,t.return,c)}if(t===e){ae=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ae=l;break}ae=t.return}}var FA=Math.ceil,Xl=xn.ReactCurrentDispatcher,Cx=xn.ReactCurrentOwner,mr=xn.ReactCurrentBatchConfig,Oe=0,vt=null,ot=null,St=0,Jt=0,ts=Jn(0),pt=0,Xo=null,ji=0,Lc=0,Ex=0,To=null,qt=null,Tx=0,ws=1/0,Jr=null,Ql=!1,uv=null,qn=null,Ua=!1,On=null,Zl=0,Ro=0,dv=null,jl=-1,Sl=0;function Lt(){return Oe&6?st():jl!==-1?jl:jl=st()}function Bn(e){return e.mode&1?Oe&2&&St!==0?St&-St:_A.transition!==null?(Sl===0&&(Sl=gk()),Sl):(e=qe,e!==0||(e=window.event,e=e===void 0?16:jk(e.type)),e):1}function Tr(e,t,r,n){if(50<Ro)throw Ro=0,dv=null,Error(te(185));pa(e,r,n),(!(Oe&2)||e!==vt)&&(e===vt&&(!(Oe&2)&&(Lc|=r),pt===4&&Rn(e,St)),Gt(e,n),r===1&&Oe===0&&!(t.mode&1)&&(ws=st()+500,Mc&&ei()))}function Gt(e,t){var r=e.callbackNode;_3(e,t);var n=Ol(e,e===vt?St:0);if(n===0)r!==null&&Yy(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Yy(r),t===1)e.tag===0?bA(q0.bind(null,e)):Bk(q0.bind(null,e)),gA(function(){!(Oe&6)&&ei()}),r=null;else{switch(vk(n)){case 1:r=tx;break;case 4:r=hk;break;case 16:r=Pl;break;case 536870912:r=mk;break;default:r=Pl}r=$N(r,MN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function MN(e,t){if(jl=-1,Sl=0,Oe&6)throw Error(te(327));var r=e.callbackNode;if(ds()&&e.callbackNode!==r)return null;var n=Ol(e,e===vt?St:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Jl(e,n);else{t=n;var i=Oe;Oe|=2;var s=ON();(vt!==e||St!==t)&&(Jr=null,ws=st()+500,mi(e,t));do try{qA();break}catch(l){PN(e,l)}while(!0);hx(),Xl.current=s,Oe=i,ot!==null?t=0:(vt=null,St=0,t=pt)}if(t!==0){if(t===2&&(i=Fg(e),i!==0&&(n=i,t=fv(e,i))),t===1)throw r=Xo,mi(e,0),Rn(e,n),Gt(e,st()),r;if(t===6)Rn(e,n);else{if(i=e.current.alternate,!(n&30)&&!zA(i)&&(t=Jl(e,n),t===2&&(s=Fg(e),s!==0&&(n=s,t=fv(e,s))),t===1))throw r=Xo,mi(e,0),Rn(e,n),Gt(e,st()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(te(345));case 2:ai(e,qt,Jr);break;case 3:if(Rn(e,n),(n&130023424)===n&&(t=Tx+500-st(),10<t)){if(Ol(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Lt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Vg(ai.bind(null,e,qt,Jr),t);break}ai(e,qt,Jr);break;case 4:if(Rn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Er(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=st()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*FA(n/1960))-n,10<n){e.timeoutHandle=Vg(ai.bind(null,e,qt,Jr),n);break}ai(e,qt,Jr);break;case 5:ai(e,qt,Jr);break;default:throw Error(te(329))}}}return Gt(e,st()),e.callbackNode===r?MN.bind(null,e):null}function fv(e,t){var r=To;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=Jl(e,t),e!==2&&(t=qt,qt=r,t!==null&&pv(t)),e}function pv(e){qt===null?qt=e:qt.push.apply(qt,e)}function zA(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Rr(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rn(e,t){for(t&=~Ex,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Er(t),n=1<<r;e[r]=-1,t&=~n}}function q0(e){if(Oe&6)throw Error(te(327));ds();var t=Ol(e,0);if(!(t&1))return Gt(e,st()),null;var r=Jl(e,t);if(e.tag!==0&&r===2){var n=Fg(e);n!==0&&(t=n,r=fv(e,n))}if(r===1)throw r=Xo,mi(e,0),Rn(e,t),Gt(e,st()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ai(e,qt,Jr),Gt(e,st()),null}function Rx(e,t){var r=Oe;Oe|=1;try{return e(t)}finally{Oe=r,Oe===0&&(ws=st()+500,Mc&&ei())}}function Si(e){On!==null&&On.tag===0&&!(Oe&6)&&ds();var t=Oe;Oe|=1;var r=mr.transition,n=qe;try{if(mr.transition=null,qe=1,e)return e()}finally{qe=n,mr.transition=r,Oe=t,!(Oe&6)&&ei()}}function Ax(){Jt=ts.current,Ge(ts)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,mA(r)),ot!==null)for(r=ot.return;r!==null;){var n=r;switch(dx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&$l();break;case 3:bs(),Ge(Ut),Ge(It),bx();break;case 5:yx(n);break;case 4:bs();break;case 13:Ge(Qe);break;case 19:Ge(Qe);break;case 10:mx(n.type._context);break;case 22:case 23:Ax()}r=r.return}if(vt=e,ot=e=Hn(e.current,null),St=Jt=t,pt=0,Xo=null,Ex=Lc=ji=0,qt=To=null,ui!==null){for(t=0;t<ui.length;t++)if(r=ui[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}ui=null}return e}function PN(e,t){do{var r=ot;try{if(hx(),bl.current=Yl,Kl){for(var n=Ze.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Kl=!1}if(wi=0,mt=ut=Ze=null,Co=!1,Go=0,Cx.current=null,r===null||r.return===null){pt=1,Xo=t,ot=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=St,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=E0(o);if(h!==null){h.flags&=-257,T0(h,o,l,s,t),h.mode&1&&C0(s,d,t),t=h,c=d;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){C0(s,d,t),Ix();break e}c=Error(te(426))}}else if(Ke&&l.mode&1){var _=E0(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),T0(_,o,l,s,t),fx(_s(c,l));break e}}s=c=_s(c,l),pt!==4&&(pt=2),To===null?To=[s]:To.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=vN(s,c,t);_0(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qn===null||!qn.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=xN(s,l,t);_0(s,w);break e}}s=s.return}while(s!==null)}LN(r)}catch(k){t=k,ot===r&&r!==null&&(ot=r=r.return);continue}break}while(!0)}function ON(){var e=Xl.current;return Xl.current=Yl,e===null?Yl:e}function Ix(){(pt===0||pt===3||pt===2)&&(pt=4),vt===null||!(ji&268435455)&&!(Lc&268435455)||Rn(vt,St)}function Jl(e,t){var r=Oe;Oe|=2;var n=ON();(vt!==e||St!==t)&&(Jr=null,mi(e,t));do try{$A();break}catch(i){PN(e,i)}while(!0);if(hx(),Oe=r,Xl.current=n,ot!==null)throw Error(te(261));return vt=null,St=0,pt}function $A(){for(;ot!==null;)DN(ot)}function qA(){for(;ot!==null&&!f3();)DN(ot)}function DN(e){var t=zN(e.alternate,e,Jt);e.memoizedProps=e.pendingProps,t===null?LN(e):ot=t,Cx.current=null}function LN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=PA(r,t),r!==null){r.flags&=32767,ot=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,ot=null;return}}else if(r=MA(r,t,Jt),r!==null){ot=r;return}if(t=t.sibling,t!==null){ot=t;return}ot=t=e}while(t!==null);pt===0&&(pt=5)}function ai(e,t,r){var n=qe,i=mr.transition;try{mr.transition=null,qe=1,BA(e,t,r,n)}finally{mr.transition=i,qe=n}return null}function BA(e,t,r,n){do ds();while(On!==null);if(Oe&6)throw Error(te(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(w3(e,s),e===vt&&(ot=vt=null,St=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ua||(Ua=!0,$N(Pl,function(){return ds(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=mr.transition,mr.transition=null;var o=qe;qe=1;var l=Oe;Oe|=4,Cx.current=null,DA(e,r),AN(r,e),lA(Wg),Dl=!!Hg,Wg=Hg=null,e.current=r,LA(r),p3(),Oe=l,qe=o,mr.transition=s}else e.current=r;if(Ua&&(Ua=!1,On=e,Zl=i),s=e.pendingLanes,s===0&&(qn=null),g3(r.stateNode),Gt(e,st()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ql)throw Ql=!1,e=uv,uv=null,e;return Zl&1&&e.tag!==0&&ds(),s=e.pendingLanes,s&1?e===dv?Ro++:(Ro=0,dv=e):Ro=0,ei(),null}function ds(){if(On!==null){var e=vk(Zl),t=mr.transition,r=qe;try{if(mr.transition=null,qe=16>e?16:e,On===null)var n=!1;else{if(e=On,On=null,Zl=0,Oe&6)throw Error(te(331));var i=Oe;for(Oe|=4,ae=e.current;ae!==null;){var s=ae,o=s.child;if(ae.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ae=d;ae!==null;){var u=ae;switch(u.tag){case 0:case 11:case 15:Eo(8,u,s)}var f=u.child;if(f!==null)f.return=u,ae=f;else for(;ae!==null;){u=ae;var p=u.sibling,h=u.return;if(EN(u),u===d){ae=null;break}if(p!==null){p.return=h,ae=p;break}ae=h}}}var x=s.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(g!==null)}}ae=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ae=o;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Eo(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ae=v;break e}ae=s.return}}var y=e.current;for(ae=y;ae!==null;){o=ae;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ae=b;else e:for(o=y;ae!==null;){if(l=ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Dc(9,l)}}catch(k){tt(l,l.return,k)}if(l===o){ae=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ae=w;break e}ae=l.return}}if(Oe=i,ei(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Ec,e)}catch{}n=!0}return n}finally{qe=r,mr.transition=t}}return!1}function B0(e,t,r){t=_s(r,t),t=vN(e,t,1),e=$n(e,t,1),t=Lt(),e!==null&&(pa(e,1,t),Gt(e,t))}function tt(e,t,r){if(e.tag===3)B0(e,e,r);else for(;t!==null;){if(t.tag===3){B0(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qn===null||!qn.has(n))){e=_s(r,e),e=xN(t,e,1),t=$n(t,e,1),e=Lt(),t!==null&&(pa(t,1,e),Gt(t,e));break}}t=t.return}}function HA(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Lt(),e.pingedLanes|=e.suspendedLanes&r,vt===e&&(St&r)===r&&(pt===4||pt===3&&(St&130023424)===St&&500>st()-Tx?mi(e,0):Ex|=r),Gt(e,t)}function FN(e,t){t===0&&(e.mode&1?(t=Oa,Oa<<=1,!(Oa&130023424)&&(Oa=4194304)):t=1);var r=Lt();e=fn(e,t),e!==null&&(pa(e,t,r),Gt(e,r))}function WA(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),FN(e,r)}function UA(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(te(314))}n!==null&&n.delete(t),FN(e,r)}var zN;zN=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ut.current)Bt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Bt=!1,IA(e,t,r);Bt=!!(e.flags&131072)}else Bt=!1,Ke&&t.flags&1048576&&Hk(t,Hl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;wl(e,t),e=t.pendingProps;var i=vs(t,It.current);us(t,r),i=wx(null,t,n,e,i,r);var s=jx();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vt(n)?(s=!0,ql(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,vx(t),i.updater=Oc,t.stateNode=i,i._reactInternals=t,Jg(t,n,e,r),t=rv(null,t,n,!0,s,r)):(t.tag=0,Ke&&s&&ux(t),Ot(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(wl(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=GA(n),e=jr(n,e),i){case 0:t=tv(null,t,n,e,r);break e;case 1:t=I0(null,t,n,e,r);break e;case 11:t=R0(null,t,n,e,r);break e;case 14:t=A0(null,t,n,jr(n.type,e),r);break e}throw Error(te(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),tv(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),I0(e,t,n,i,r);case 3:e:{if(wN(t),e===null)throw Error(te(387));n=t.pendingProps,s=t.memoizedState,i=s.element,Yk(e,t),Vl(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=_s(Error(te(423)),t),t=M0(e,t,n,r,i);break e}else if(n!==i){i=_s(Error(te(424)),t),t=M0(e,t,n,r,i);break e}else for(tr=zn(t.stateNode.containerInfo.firstChild),rr=t,Ke=!0,Nr=null,r=Gk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(xs(),n===i){t=pn(e,t,r);break e}Ot(e,t,n,r)}t=t.child}return t;case 5:return Xk(t),e===null&&Xg(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Ug(n,i)?o=null:s!==null&&Ug(n,s)&&(t.flags|=32),_N(e,t),Ot(e,t,o,r),t.child;case 6:return e===null&&Xg(t),null;case 13:return jN(e,t,r);case 4:return xx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ys(t,null,n,r):Ot(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),R0(e,t,n,i,r);case 7:return Ot(e,t,t.pendingProps,r),t.child;case 8:return Ot(e,t,t.pendingProps.children,r),t.child;case 12:return Ot(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,He(Wl,n._currentValue),n._currentValue=o,s!==null)if(Rr(s.value,o)){if(s.children===i.children&&!Ut.current){t=pn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=ln(-1,r&-r),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Qg(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(te(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Qg(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ot(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,us(t,r),i=gr(i),n=n(i),t.flags|=1,Ot(e,t,n,r),t.child;case 14:return n=t.type,i=jr(n,t.pendingProps),i=jr(n.type,i),A0(e,t,n,i,r);case 15:return yN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),wl(e,t),t.tag=1,Vt(n)?(e=!0,ql(t)):e=!1,us(t,r),gN(t,n,i),Jg(t,n,i,r),rv(null,t,n,!0,e,r);case 19:return SN(e,t,r);case 22:return bN(e,t,r)}throw Error(te(156,t.tag))};function $N(e,t){return pk(e,t)}function VA(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(e,t,r,n){return new VA(e,t,r,n)}function Mx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function GA(e){if(typeof e=="function")return Mx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Zv)return 11;if(e===Jv)return 14}return 2}function Hn(e,t){var r=e.alternate;return r===null?(r=pr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function kl(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")Mx(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ui:return gi(r.children,i,s,t);case Qv:o=8,i|=8;break;case jg:return e=pr(12,r,t,i|2),e.elementType=jg,e.lanes=s,e;case Sg:return e=pr(13,r,t,i),e.elementType=Sg,e.lanes=s,e;case kg:return e=pr(19,r,t,i),e.elementType=kg,e.lanes=s,e;case XS:return Fc(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case KS:o=10;break e;case YS:o=9;break e;case Zv:o=11;break e;case Jv:o=14;break e;case Sn:o=16,n=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=pr(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function gi(e,t,r,n){return e=pr(7,e,n,t),e.lanes=r,e}function Fc(e,t,r,n){return e=pr(22,e,n,t),e.elementType=XS,e.lanes=r,e.stateNode={isHidden:!1},e}function Qu(e,t,r){return e=pr(6,e,null,t),e.lanes=r,e}function Zu(e,t,r){return t=pr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function KA(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Iu(0),this.expirationTimes=Iu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Iu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Px(e,t,r,n,i,s,o,l,c){return e=new KA(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=pr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},vx(s),e}function YA(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function qN(e){if(!e)return Yn;e=e._reactInternals;e:{if(Ei(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(Vt(r))return qk(e,r,t)}return t}function BN(e,t,r,n,i,s,o,l,c){return e=Px(r,n,!0,e,i,s,o,l,c),e.context=qN(null),r=e.current,n=Lt(),i=Bn(r),s=ln(n,i),s.callback=t??null,$n(r,s,i),e.current.lanes=i,pa(e,i,n),Gt(e,n),e}function zc(e,t,r,n){var i=t.current,s=Lt(),o=Bn(i);return r=qN(r),t.context===null?t.context=r:t.pendingContext=r,t=ln(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=$n(i,t,o),e!==null&&(Tr(e,i,o,s),yl(e,i,o)),o}function ec(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function H0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ox(e,t){H0(e,t),(e=e.alternate)&&H0(e,t)}function XA(){return null}var HN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Dx(e){this._internalRoot=e}$c.prototype.render=Dx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));zc(e,t,null,null)};$c.prototype.unmount=Dx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Si(function(){zc(null,e,null,null)}),t[dn]=null}};function $c(e){this._internalRoot=e}$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=bk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Tn.length&&t!==0&&t<Tn[r].priority;r++);Tn.splice(r,0,e),r===0&&wk(e)}};function Lx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function W0(){}function QA(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var d=ec(o);s.call(d)}}var o=BN(t,n,e,0,null,!1,!1,"",W0);return e._reactRootContainer=o,e[dn]=o.current,Bo(e.nodeType===8?e.parentNode:e),Si(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var d=ec(c);l.call(d)}}var c=Px(e,0,!1,null,null,!1,!1,"",W0);return e._reactRootContainer=c,e[dn]=c.current,Bo(e.nodeType===8?e.parentNode:e),Si(function(){zc(t,c,r,n)}),c}function Bc(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=ec(o);l.call(c)}}zc(t,o,e,i)}else o=QA(r,t,e,i,n);return ec(o)}xk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=uo(t.pendingLanes);r!==0&&(rx(t,r|1),Gt(t,st()),!(Oe&6)&&(ws=st()+500,ei()))}break;case 13:Si(function(){var n=fn(e,1);if(n!==null){var i=Lt();Tr(n,e,1,i)}}),Ox(e,1)}};nx=function(e){if(e.tag===13){var t=fn(e,134217728);if(t!==null){var r=Lt();Tr(t,e,134217728,r)}Ox(e,134217728)}};yk=function(e){if(e.tag===13){var t=Bn(e),r=fn(e,t);if(r!==null){var n=Lt();Tr(r,e,t,n)}Ox(e,t)}};bk=function(){return qe};_k=function(e,t){var r=qe;try{return qe=e,t()}finally{qe=r}};Og=function(e,t,r){switch(t){case"input":if(Eg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Ic(n);if(!i)throw Error(te(90));ZS(n),Eg(n,i)}}}break;case"textarea":ek(e,r);break;case"select":t=r.value,t!=null&&os(e,!!r.multiple,t,!1)}};ak=Rx;lk=Si;var ZA={usingClientEntryPoint:!1,Events:[ma,Yi,Ic,sk,ok,Rx]},Ys={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JA={bundleType:Ys.bundleType,version:Ys.version,rendererPackageName:Ys.rendererPackageName,rendererConfig:Ys.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dk(e),e===null?null:e.stateNode},findFiberByHostInstance:Ys.findFiberByHostInstance||XA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Va=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Va.isDisabled&&Va.supportsFiber)try{Ec=Va.inject(JA),Br=Va}catch{}}sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZA;sr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lx(t))throw Error(te(200));return YA(e,t,null,r)};sr.createRoot=function(e,t){if(!Lx(e))throw Error(te(299));var r=!1,n="",i=HN;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Px(e,1,!1,null,null,r,!1,n,i),e[dn]=t.current,Bo(e.nodeType===8?e.parentNode:e),new Dx(t)};sr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=dk(t),e=e===null?null:e.stateNode,e};sr.flushSync=function(e){return Si(e)};sr.hydrate=function(e,t,r){if(!qc(t))throw Error(te(200));return Bc(null,e,t,!0,r)};sr.hydrateRoot=function(e,t,r){if(!Lx(e))throw Error(te(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=HN;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=BN(t,null,e,1,r??null,i,!1,s,o),e[dn]=t.current,Bo(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new $c(t)};sr.render=function(e,t,r){if(!qc(t))throw Error(te(200));return Bc(null,e,t,!1,r)};sr.unmountComponentAtNode=function(e){if(!qc(e))throw Error(te(40));return e._reactRootContainer?(Si(function(){Bc(null,null,e,!1,function(){e._reactRootContainer=null,e[dn]=null})}),!0):!1};sr.unstable_batchedUpdates=Rx;sr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!qc(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return Bc(e,t,r,!1,n)};sr.version="18.3.1-next-f1338f8080-20240426";function WN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WN)}catch(e){console.error(e)}}WN(),WS.exports=sr;var rs=WS.exports,U0=rs;_g.createRoot=U0.createRoot,_g.hydrateRoot=U0.hydrateRoot;function Yt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Yt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var UN={exports:{}},VN={},GN={exports:{}},KN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var js=m;function e5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var t5=typeof Object.is=="function"?Object.is:e5,r5=js.useState,n5=js.useEffect,i5=js.useLayoutEffect,s5=js.useDebugValue;function o5(e,t){var r=t(),n=r5({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return i5(function(){i.value=r,i.getSnapshot=t,Ju(i)&&s({inst:i})},[e,r,t]),n5(function(){return Ju(i)&&s({inst:i}),e(function(){Ju(i)&&s({inst:i})})},[e]),s5(r),r}function Ju(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!t5(e,r)}catch{return!0}}function a5(e,t){return t()}var l5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?a5:o5;KN.useSyncExternalStore=js.useSyncExternalStore!==void 0?js.useSyncExternalStore:l5;GN.exports=KN;var c5=GN.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hc=m,u5=c5;function d5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var f5=typeof Object.is=="function"?Object.is:d5,p5=u5.useSyncExternalStore,h5=Hc.useRef,m5=Hc.useEffect,g5=Hc.useMemo,v5=Hc.useDebugValue;VN.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=h5(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=g5(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),i!==void 0&&o.hasValue){var x=o.value;if(i(x,h))return f=x}return f=h}if(x=f,f5(u,h))return x;var g=n(h);return i!==void 0&&i(x,g)?(u=h,x):(u=h,f=g)}var d=!1,u,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,i]);var l=p5(e,s[0],s[1]);return m5(function(){o.hasValue=!0,o.value=l},[l]),v5(l),l};UN.exports=VN;var x5=UN.exports;const y5=Hv(x5),b5={},V0=e=>{let t;const r=new Set,n=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(x=>x(t,h))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>d,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(b5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,i,c);return c},_5=e=>e?V0(e):V0,{useDebugValue:w5}=Y,{useSyncExternalStoreWithSelector:j5}=y5,S5=e=>e;function YN(e,t=S5,r){const n=j5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return w5(n),n}const G0=(e,t)=>{const r=_5(e),n=(i,s=t)=>YN(r,i,s);return Object.assign(n,r),n},k5=(e,t)=>e?G0(e,t):G0;function Mt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var N5={value:()=>{}};function Wc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Nl(r)}function Nl(e){this._=e}function C5(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Nl.prototype=Wc.prototype={constructor:Nl,on:function(e,t){var r=this._,n=C5(e+"",r),i,s=-1,o=n.length;if(arguments.length<2){for(;++s<o;)if((i=(e=n[s]).type)&&(i=E5(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=n[s]).type)r[i]=K0(r[i],e.name,t);else if(t==null)for(i in r)r[i]=K0(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Nl(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,s;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],n=0,i=s.length;n<i;++n)s[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,s=n.length;i<s;++i)n[i].value.apply(t,r)}};function E5(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function K0(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=N5,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var hv="http://www.w3.org/1999/xhtml";const Y0={svg:"http://www.w3.org/2000/svg",xhtml:hv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Uc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Y0.hasOwnProperty(t)?{space:Y0[t],local:e}:e}function T5(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===hv&&t.documentElement.namespaceURI===hv?t.createElement(e):t.createElementNS(r,e)}}function R5(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function XN(e){var t=Uc(e);return(t.local?R5:T5)(t)}function A5(){}function Fx(e){return e==null?A5:function(){return this.querySelector(e)}}function I5(e){typeof e!="function"&&(e=Fx(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=new Array(o),c,d,u=0;u<o;++u)(c=s[u])&&(d=e.call(c,c.__data__,u,s))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new ir(n,this._parents)}function M5(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function P5(){return[]}function QN(e){return e==null?P5:function(){return this.querySelectorAll(e)}}function O5(e){return function(){return M5(e.apply(this,arguments))}}function D5(e){typeof e=="function"?e=O5(e):e=QN(e);for(var t=this._groups,r=t.length,n=[],i=[],s=0;s<r;++s)for(var o=t[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&(n.push(e.call(c,c.__data__,d,o)),i.push(c));return new ir(n,i)}function ZN(e){return function(){return this.matches(e)}}function JN(e){return function(t){return t.matches(e)}}var L5=Array.prototype.find;function F5(e){return function(){return L5.call(this.children,e)}}function z5(){return this.firstElementChild}function $5(e){return this.select(e==null?z5:F5(typeof e=="function"?e:JN(e)))}var q5=Array.prototype.filter;function B5(){return Array.from(this.children)}function H5(e){return function(){return q5.call(this.children,e)}}function W5(e){return this.selectAll(e==null?B5:H5(typeof e=="function"?e:JN(e)))}function U5(e){typeof e!="function"&&(e=ZN(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new ir(n,this._parents)}function eC(e){return new Array(e.length)}function V5(){return new ir(this._enter||this._groups.map(eC),this._parents)}function tc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}tc.prototype={constructor:tc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function G5(e){return function(){return e}}function K5(e,t,r,n,i,s){for(var o=0,l,c=t.length,d=s.length;o<d;++o)(l=t[o])?(l.__data__=s[o],n[o]=l):r[o]=new tc(e,s[o]);for(;o<c;++o)(l=t[o])&&(i[o]=l)}function Y5(e,t,r,n,i,s,o){var l,c,d=new Map,u=t.length,f=s.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=o.call(c,c.__data__,l,t)+"",d.has(h)?i[l]=c:d.set(h,c));for(l=0;l<f;++l)h=o.call(e,s[l],l,s)+"",(c=d.get(h))?(n[l]=c,c.__data__=s[l],d.delete(h)):r[l]=new tc(e,s[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(i[l]=c)}function X5(e){return e.__data__}function Q5(e,t){if(!arguments.length)return Array.from(this,X5);var r=t?Y5:K5,n=this._parents,i=this._groups;typeof e!="function"&&(e=G5(e));for(var s=i.length,o=new Array(s),l=new Array(s),c=new Array(s),d=0;d<s;++d){var u=n[d],f=i[d],p=f.length,h=Z5(e.call(u,u&&u.__data__,d,n)),x=h.length,g=l[d]=new Array(x),_=o[d]=new Array(x),v=c[d]=new Array(p);r(u,f,g,_,v,h,t);for(var y=0,b=0,w,k;y<x;++y)if(w=g[y]){for(y>=b&&(b=y+1);!(k=_[b])&&++b<x;);w._next=k||null}}return o=new ir(o,n),o._enter=l,o._exit=c,o}function Z5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function J5(){return new ir(this._exit||this._groups.map(eC),this._parents)}function eI(e,t,r){var n=this.enter(),i=this,s=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?s.remove():r(s),n&&i?n.merge(i).order():i}function tI(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,s=n.length,o=Math.min(i,s),l=new Array(i),c=0;c<o;++c)for(var d=r[c],u=n[c],f=d.length,p=l[c]=new Array(f),h,x=0;x<f;++x)(h=d[x]||u[x])&&(p[x]=h);for(;c<i;++c)l[c]=r[c];return new ir(l,this._parents)}function rI(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,s=n[i],o;--i>=0;)(o=n[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function nI(e){e||(e=iI);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,i=new Array(n),s=0;s<n;++s){for(var o=r[s],l=o.length,c=i[s]=new Array(l),d,u=0;u<l;++u)(d=o[u])&&(c[u]=d);c.sort(t)}return new ir(i,this._parents).order()}function iI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function sI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function oI(){return Array.from(this)}function aI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null}function lI(){let e=0;for(const t of this)++e;return e}function cI(){return!this.node()}function uI(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],s=0,o=i.length,l;s<o;++s)(l=i[s])&&e.call(l,l.__data__,s,i);return this}function dI(e){return function(){this.removeAttribute(e)}}function fI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pI(e,t){return function(){this.setAttribute(e,t)}}function hI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function mI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function gI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function vI(e,t){var r=Uc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?fI:dI:typeof t=="function"?r.local?gI:mI:r.local?hI:pI)(r,t))}function tC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function xI(e){return function(){this.style.removeProperty(e)}}function yI(e,t,r){return function(){this.style.setProperty(e,t,r)}}function bI(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function _I(e,t,r){return arguments.length>1?this.each((t==null?xI:typeof t=="function"?bI:yI)(e,t,r??"")):Ss(this.node(),e)}function Ss(e,t){return e.style.getPropertyValue(t)||tC(e).getComputedStyle(e,null).getPropertyValue(t)}function wI(e){return function(){delete this[e]}}function jI(e,t){return function(){this[e]=t}}function SI(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function kI(e,t){return arguments.length>1?this.each((t==null?wI:typeof t=="function"?SI:jI)(e,t)):this.node()[e]}function rC(e){return e.trim().split(/^|\s+/)}function zx(e){return e.classList||new nC(e)}function nC(e){this._node=e,this._names=rC(e.getAttribute("class")||"")}nC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function iC(e,t){for(var r=zx(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function sC(e,t){for(var r=zx(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function NI(e){return function(){iC(this,e)}}function CI(e){return function(){sC(this,e)}}function EI(e,t){return function(){(t.apply(this,arguments)?iC:sC)(this,e)}}function TI(e,t){var r=rC(e+"");if(arguments.length<2){for(var n=zx(this.node()),i=-1,s=r.length;++i<s;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?EI:t?NI:CI)(r,t))}function RI(){this.textContent=""}function AI(e){return function(){this.textContent=e}}function II(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function MI(e){return arguments.length?this.each(e==null?RI:(typeof e=="function"?II:AI)(e)):this.node().textContent}function PI(){this.innerHTML=""}function OI(e){return function(){this.innerHTML=e}}function DI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function LI(e){return arguments.length?this.each(e==null?PI:(typeof e=="function"?DI:OI)(e)):this.node().innerHTML}function FI(){this.nextSibling&&this.parentNode.appendChild(this)}function zI(){return this.each(FI)}function $I(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qI(){return this.each($I)}function BI(e){var t=typeof e=="function"?e:XN(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function HI(){return null}function WI(e,t){var r=typeof e=="function"?e:XN(e),n=t==null?HI:typeof t=="function"?t:Fx(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function UI(){var e=this.parentNode;e&&e.removeChild(this)}function VI(){return this.each(UI)}function GI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function KI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function YI(e){return this.select(e?KI:GI)}function XI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function QI(e){return function(t){e.call(this,t,this.__data__)}}function ZI(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function JI(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,s;r<i;++r)s=t[r],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++n]=s;++n?t.length=n:delete this.__on}}}function eM(e,t,r){return function(){var n=this.__on,i,s=QI(t);if(n){for(var o=0,l=n.length;o<l;++o)if((i=n[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=r),i.value=t;return}}this.addEventListener(e.type,s,r),i={type:e.type,name:e.name,value:t,listener:s,options:r},n?n.push(i):this.__on=[i]}}function tM(e,t,r){var n=ZI(e+""),i,s=n.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(i=0,u=l[c];i<s;++i)if((o=n[i]).type===u.type&&o.name===u.name)return u.value}return}for(l=t?eM:JI,i=0;i<s;++i)this.each(l(n[i],t,r));return this}function oC(e,t,r){var n=tC(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function rM(e,t){return function(){return oC(this,e,t)}}function nM(e,t){return function(){return oC(this,e,t.apply(this,arguments))}}function iM(e,t){return this.each((typeof t=="function"?nM:rM)(e,t))}function*sM(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length,o;i<s;++i)(o=n[i])&&(yield o)}var aC=[null];function ir(e,t){this._groups=e,this._parents=t}function va(){return new ir([[document.documentElement]],aC)}function oM(){return this}ir.prototype=va.prototype={constructor:ir,select:I5,selectAll:D5,selectChild:$5,selectChildren:W5,filter:U5,data:Q5,enter:V5,exit:J5,join:eI,merge:tI,selection:oM,order:rI,sort:nI,call:sI,nodes:oI,node:aI,size:lI,empty:cI,each:uI,attr:vI,style:_I,property:kI,classed:TI,text:MI,html:LI,raise:zI,lower:qI,append:BI,insert:WI,remove:VI,clone:YI,datum:XI,on:tM,dispatch:iM,[Symbol.iterator]:sM};function fr(e){return typeof e=="string"?new ir([[document.querySelector(e)]],[document.documentElement]):new ir([[e]],aC)}function aM(e){let t;for(;t=e.sourceEvent;)e=t;return e}function kr(e,t){if(e=aM(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const lM={passive:!1},Qo={capture:!0,passive:!1};function ed(e){e.stopImmediatePropagation()}function fs(e){e.preventDefault(),e.stopImmediatePropagation()}function lC(e){var t=e.document.documentElement,r=fr(e).on("dragstart.drag",fs,Qo);"onselectstart"in t?r.on("selectstart.drag",fs,Qo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function cC(e,t){var r=e.document.documentElement,n=fr(e).on("dragstart.drag",null);t&&(n.on("click.drag",fs,Qo),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Ga=e=>()=>e;function mv(e,{sourceEvent:t,subject:r,target:n,identifier:i,active:s,x:o,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}mv.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function cM(e){return!e.ctrlKey&&!e.button}function uM(){return this.parentNode}function dM(e,t){return t??{x:e.x,y:e.y}}function fM(){return navigator.maxTouchPoints||"ontouchstart"in this}function pM(){var e=cM,t=uM,r=dM,n=fM,i={},s=Wc("start","drag","end"),o=0,l,c,d,u,f=0;function p(w){w.on("mousedown.drag",h).filter(n).on("touchstart.drag",_).on("touchmove.drag",v,lM).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,k){if(!(u||!e.call(this,w,k))){var S=b(this,t.call(this,w,k),w,k,"mouse");S&&(fr(w.view).on("mousemove.drag",x,Qo).on("mouseup.drag",g,Qo),lC(w.view),ed(w),d=!1,l=w.clientX,c=w.clientY,S("start",w))}}function x(w){if(fs(w),!d){var k=w.clientX-l,S=w.clientY-c;d=k*k+S*S>f}i.mouse("drag",w)}function g(w){fr(w.view).on("mousemove.drag mouseup.drag",null),cC(w.view,d),fs(w),i.mouse("end",w)}function _(w,k){if(e.call(this,w,k)){var S=w.changedTouches,C=t.call(this,w,k),T=S.length,j,R;for(j=0;j<T;++j)(R=b(this,C,w,k,S[j].identifier,S[j]))&&(ed(w),R("start",w,S[j]))}}function v(w){var k=w.changedTouches,S=k.length,C,T;for(C=0;C<S;++C)(T=i[k[C].identifier])&&(fs(w),T("drag",w,k[C]))}function y(w){var k=w.changedTouches,S=k.length,C,T;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),C=0;C<S;++C)(T=i[k[C].identifier])&&(ed(w),T("end",w,k[C]))}function b(w,k,S,C,T,j){var R=s.copy(),E=kr(j||S,k),M,$,N;if((N=r.call(w,new mv("beforestart",{sourceEvent:S,target:p,identifier:T,active:o,x:E[0],y:E[1],dx:0,dy:0,dispatch:R}),C))!=null)return M=N.x-E[0]||0,$=N.y-E[1]||0,function D(I,F,P){var A=E,L;switch(I){case"start":i[T]=D,L=o++;break;case"end":delete i[T],--o;case"drag":E=kr(P||F,k),L=o;break}R.call(I,w,new mv(I,{sourceEvent:F,subject:N,target:p,identifier:T,active:L,x:E[0]+M,y:E[1]+$,dx:E[0]-A[0],dy:E[1]-A[1],dispatch:R}),C)}}return p.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Ga(!!w),p):e},p.container=function(w){return arguments.length?(t=typeof w=="function"?w:Ga(w),p):t},p.subject=function(w){return arguments.length?(r=typeof w=="function"?w:Ga(w),p):r},p.touchable=function(w){return arguments.length?(n=typeof w=="function"?w:Ga(!!w),p):n},p.on=function(){var w=s.on.apply(s,arguments);return w===s?p:w},p.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,p):Math.sqrt(f)},p}function $x(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function uC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function xa(){}var Zo=.7,rc=1/Zo,ps="\\s*([+-]?\\d+)\\s*",Jo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hM=/^#([0-9a-f]{3,8})$/,mM=new RegExp(`^rgb\\(${ps},${ps},${ps}\\)$`),gM=new RegExp(`^rgb\\(${Wr},${Wr},${Wr}\\)$`),vM=new RegExp(`^rgba\\(${ps},${ps},${ps},${Jo}\\)$`),xM=new RegExp(`^rgba\\(${Wr},${Wr},${Wr},${Jo}\\)$`),yM=new RegExp(`^hsl\\(${Jo},${Wr},${Wr}\\)$`),bM=new RegExp(`^hsla\\(${Jo},${Wr},${Wr},${Jo}\\)$`),X0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$x(xa,ea,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Q0,formatHex:Q0,formatHex8:_M,formatHsl:wM,formatRgb:Z0,toString:Z0});function Q0(){return this.rgb().formatHex()}function _M(){return this.rgb().formatHex8()}function wM(){return dC(this).formatHsl()}function Z0(){return this.rgb().formatRgb()}function ea(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=hM.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?J0(t):r===3?new Ht(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ka(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ka(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mM.exec(e))?new Ht(t[1],t[2],t[3],1):(t=gM.exec(e))?new Ht(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vM.exec(e))?Ka(t[1],t[2],t[3],t[4]):(t=xM.exec(e))?Ka(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=yM.exec(e))?rb(t[1],t[2]/100,t[3]/100,1):(t=bM.exec(e))?rb(t[1],t[2]/100,t[3]/100,t[4]):X0.hasOwnProperty(e)?J0(X0[e]):e==="transparent"?new Ht(NaN,NaN,NaN,0):null}function J0(e){return new Ht(e>>16&255,e>>8&255,e&255,1)}function Ka(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ht(e,t,r,n)}function jM(e){return e instanceof xa||(e=ea(e)),e?(e=e.rgb(),new Ht(e.r,e.g,e.b,e.opacity)):new Ht}function gv(e,t,r,n){return arguments.length===1?jM(e):new Ht(e,t,r,n??1)}function Ht(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}$x(Ht,gv,uC(xa,{brighter(e){return e=e==null?rc:Math.pow(rc,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zo:Math.pow(Zo,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ht(vi(this.r),vi(this.g),vi(this.b),nc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:eb,formatHex:eb,formatHex8:SM,formatRgb:tb,toString:tb}));function eb(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function SM(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi((isNaN(this.opacity)?1:this.opacity)*255)}`}function tb(){const e=nc(this.opacity);return`${e===1?"rgb(":"rgba("}${vi(this.r)}, ${vi(this.g)}, ${vi(this.b)}${e===1?")":`, ${e})`}`}function nc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fi(e){return e=vi(e),(e<16?"0":"")+e.toString(16)}function rb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Cr(e,t,r,n)}function dC(e){if(e instanceof Cr)return new Cr(e.h,e.s,e.l,e.opacity);if(e instanceof xa||(e=ea(e)),!e)return new Cr;if(e instanceof Cr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new Cr(o,l,c,e.opacity)}function kM(e,t,r,n){return arguments.length===1?dC(e):new Cr(e,t,r,n??1)}function Cr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}$x(Cr,kM,uC(xa,{brighter(e){return e=e==null?rc:Math.pow(rc,e),new Cr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zo:Math.pow(Zo,e),new Cr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Ht(td(e>=240?e-240:e+120,i,n),td(e,i,n),td(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Cr(nb(this.h),Ya(this.s),Ya(this.l),nc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=nc(this.opacity);return`${e===1?"hsl(":"hsla("}${nb(this.h)}, ${Ya(this.s)*100}%, ${Ya(this.l)*100}%${e===1?")":`, ${e})`}`}}));function nb(e){return e=(e||0)%360,e<0?e+360:e}function Ya(e){return Math.max(0,Math.min(1,e||0))}function td(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const fC=e=>()=>e;function NM(e,t){return function(r){return e+r*t}}function CM(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function EM(e){return(e=+e)==1?pC:function(t,r){return r-t?CM(t,r,e):fC(isNaN(t)?r:t)}}function pC(e,t){var r=t-e;return r?NM(e,r):fC(isNaN(e)?t:e)}const ib=function e(t){var r=EM(t);function n(i,s){var o=r((i=gv(i)).r,(s=gv(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),d=pC(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=c(u),i.opacity=d(u),i+""}}return n.gamma=e,n}(1);function Nn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var vv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rd=new RegExp(vv.source,"g");function TM(e){return function(){return e}}function RM(e){return function(t){return e(t)+""}}function AM(e,t){var r=vv.lastIndex=rd.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=vv.exec(e))&&(i=rd.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:Nn(n,i)})),r=rd.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?RM(c[0].x):TM(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var sb=180/Math.PI,xv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hC(e,t,r,n,i,s){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*sb,skewX:Math.atan(c)*sb,scaleX:o,scaleY:l}}var Xa;function IM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?xv:hC(t.a,t.b,t.c,t.d,t.e,t.f)}function MM(e){return e==null||(Xa||(Xa=document.createElementNS("http://www.w3.org/2000/svg","g")),Xa.setAttribute("transform",e),!(e=Xa.transform.baseVal.consolidate()))?xv:(e=e.matrix,hC(e.a,e.b,e.c,e.d,e.e,e.f))}function mC(e,t,r,n){function i(d){return d.length?d.pop()+" ":""}function s(d,u,f,p,h,x){if(d!==f||u!==p){var g=h.push("translate(",null,t,null,r);x.push({i:g-4,x:Nn(d,f)},{i:g-2,x:Nn(u,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function o(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(i(f)+"rotate(",null,n)-2,x:Nn(d,u)})):u&&f.push(i(f)+"rotate("+u+n)}function l(d,u,f,p){d!==u?p.push({i:f.push(i(f)+"skewX(",null,n)-2,x:Nn(d,u)}):u&&f.push(i(f)+"skewX("+u+n)}function c(d,u,f,p,h,x){if(d!==f||u!==p){var g=h.push(i(h)+"scale(",null,",",null,")");x.push({i:g-4,x:Nn(d,f)},{i:g-2,x:Nn(u,p)})}else(f!==1||p!==1)&&h.push(i(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),s(d.translateX,d.translateY,u.translateX,u.translateY,f,p),o(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var x=-1,g=p.length,_;++x<g;)f[(_=p[x]).i]=_.x(h);return f.join("")}}}var PM=mC(IM,"px, ","px)","deg)"),OM=mC(MM,", ",")",")"),DM=1e-12;function ob(e){return((e=Math.exp(e))+1/e)/2}function LM(e){return((e=Math.exp(e))-1/e)/2}function FM(e){return((e=Math.exp(2*e))-1)/(e+1)}const zM=function e(t,r,n){function i(s,o){var l=s[0],c=s[1],d=s[2],u=o[0],f=o[1],p=o[2],h=u-l,x=f-c,g=h*h+x*x,_,v;if(g<DM)v=Math.log(p/d)/t,_=function(C){return[l+C*h,c+C*x,d*Math.exp(t*C*v)]};else{var y=Math.sqrt(g),b=(p*p-d*d+n*g)/(2*d*r*y),w=(p*p-d*d-n*g)/(2*p*r*y),k=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(w*w+1)-w);v=(S-k)/t,_=function(C){var T=C*v,j=ob(k),R=d/(r*y)*(j*FM(t*T+k)-LM(k));return[l+R*h,c+R*x,d*j/ob(t*T+k)]}}return _.duration=v*1e3*t/Math.SQRT2,_}return i.rho=function(s){var o=Math.max(.001,+s),l=o*o,c=l*l;return e(o,l,c)},i}(Math.SQRT2,2,4);var ks=0,po=0,Xs=0,gC=1e3,ic,ho,sc=0,ki=0,Vc=0,ta=typeof performance=="object"&&performance.now?performance:Date,vC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function qx(){return ki||(vC($M),ki=ta.now()+Vc)}function $M(){ki=0}function oc(){this._call=this._time=this._next=null}oc.prototype=xC.prototype={constructor:oc,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?qx():+r)+(t==null?0:+t),!this._next&&ho!==this&&(ho?ho._next=this:ic=this,ho=this),this._call=e,this._time=r,yv()},stop:function(){this._call&&(this._call=null,this._time=1/0,yv())}};function xC(e,t,r){var n=new oc;return n.restart(e,t,r),n}function qM(){qx(),++ks;for(var e=ic,t;e;)(t=ki-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ks}function ab(){ki=(sc=ta.now())+Vc,ks=po=0;try{qM()}finally{ks=0,HM(),ki=0}}function BM(){var e=ta.now(),t=e-sc;t>gC&&(Vc-=t,sc=e)}function HM(){for(var e,t=ic,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:ic=r);ho=e,yv(n)}function yv(e){if(!ks){po&&(po=clearTimeout(po));var t=e-ki;t>24?(e<1/0&&(po=setTimeout(ab,e-ta.now()-Vc)),Xs&&(Xs=clearInterval(Xs))):(Xs||(sc=ta.now(),Xs=setInterval(BM,gC)),ks=1,vC(ab))}}function lb(e,t,r){var n=new oc;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var WM=Wc("start","end","cancel","interrupt"),UM=[],yC=0,cb=1,bv=2,Cl=3,ub=4,_v=5,El=6;function Gc(e,t,r,n,i,s){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;VM(e,r,{name:t,index:n,group:i,on:WM,tween:UM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:yC})}function Bx(e,t){var r=Ir(e,t);if(r.state>yC)throw new Error("too late; already scheduled");return r}function Kr(e,t){var r=Ir(e,t);if(r.state>Cl)throw new Error("too late; already running");return r}function Ir(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function VM(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=xC(s,0,r.time);function s(d){r.state=cb,r.timer.restart(o,r.delay,r.time),r.delay<=d&&o(d-r.delay)}function o(d){var u,f,p,h;if(r.state!==cb)return c();for(u in n)if(h=n[u],h.name===r.name){if(h.state===Cl)return lb(o);h.state===ub?(h.state=El,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[u]):+u<t&&(h.state=El,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[u])}if(lb(function(){r.state===Cl&&(r.state=ub,r.timer.restart(l,r.delay,r.time),l(d))}),r.state=bv,r.on.call("start",e,e.__data__,r.index,r.group),r.state===bv){for(r.state=Cl,i=new Array(p=r.tween.length),u=0,f=-1;u<p;++u)(h=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(i[++f]=h);i.length=f+1}}function l(d){for(var u=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(c),r.state=_v,1),f=-1,p=i.length;++f<p;)i[f].call(e,u);r.state===_v&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=El,r.timer.stop(),delete n[t];for(var d in n)return;delete e.__transition}}function Tl(e,t){var r=e.__transition,n,i,s=!0,o;if(r){t=t==null?null:t+"";for(o in r){if((n=r[o]).name!==t){s=!1;continue}i=n.state>bv&&n.state<_v,n.state=El,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[o]}s&&delete e.__transition}}function GM(e){return this.each(function(){Tl(this,e)})}function KM(e,t){var r,n;return function(){var i=Kr(this,e),s=i.tween;if(s!==r){n=r=s;for(var o=0,l=n.length;o<l;++o)if(n[o].name===t){n=n.slice(),n.splice(o,1);break}}i.tween=n}}function YM(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var s=Kr(this,e),o=s.tween;if(o!==n){i=(n=o).slice();for(var l={name:t,value:r},c=0,d=i.length;c<d;++c)if(i[c].name===t){i[c]=l;break}c===d&&i.push(l)}s.tween=i}}function XM(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Ir(this.node(),r).tween,i=0,s=n.length,o;i<s;++i)if((o=n[i]).name===e)return o.value;return null}return this.each((t==null?KM:YM)(r,e,t))}function Hx(e,t,r){var n=e._id;return e.each(function(){var i=Kr(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return Ir(i,n).value[t]}}function bC(e,t){var r;return(typeof t=="number"?Nn:t instanceof ea?ib:(r=ea(t))?(t=r,ib):AM)(e,t)}function QM(e){return function(){this.removeAttribute(e)}}function ZM(e){return function(){this.removeAttributeNS(e.space,e.local)}}function JM(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===n?s:s=t(n=o,r)}}function eP(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===n?s:s=t(n=o,r)}}function tP(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function rP(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function nP(e,t){var r=Uc(e),n=r==="transform"?OM:bC;return this.attrTween(e,typeof t=="function"?(r.local?rP:tP)(r,n,Hx(this,"attr."+e,t)):t==null?(r.local?ZM:QM)(r):(r.local?eP:JM)(r,n,t))}function iP(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function sP(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function oP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&sP(e,s)),r}return i._value=t,i}function aP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&iP(e,s)),r}return i._value=t,i}function lP(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Uc(e);return this.tween(r,(n.local?oP:aP)(n,t))}function cP(e,t){return function(){Bx(this,e).delay=+t.apply(this,arguments)}}function uP(e,t){return t=+t,function(){Bx(this,e).delay=t}}function dP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?cP:uP)(t,e)):Ir(this.node(),t).delay}function fP(e,t){return function(){Kr(this,e).duration=+t.apply(this,arguments)}}function pP(e,t){return t=+t,function(){Kr(this,e).duration=t}}function hP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fP:pP)(t,e)):Ir(this.node(),t).duration}function mP(e,t){if(typeof t!="function")throw new Error;return function(){Kr(this,e).ease=t}}function gP(e){var t=this._id;return arguments.length?this.each(mP(t,e)):Ir(this.node(),t).ease}function vP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Kr(this,e).ease=r}}function xP(e){if(typeof e!="function")throw new Error;return this.each(vP(this._id,e))}function yP(e){typeof e!="function"&&(e=ZN(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new hn(n,this._parents,this._name,this._id)}function bP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,s=Math.min(n,i),o=new Array(n),l=0;l<s;++l)for(var c=t[l],d=r[l],u=c.length,f=o[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<n;++l)o[l]=t[l];return new hn(o,this._parents,this._name,this._id)}function _P(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function wP(e,t,r){var n,i,s=_P(t)?Bx:Kr;return function(){var o=s(this,e),l=o.on;l!==n&&(i=(n=l).copy()).on(t,r),o.on=i}}function jP(e,t){var r=this._id;return arguments.length<2?Ir(this.node(),r).on.on(e):this.each(wP(r,e,t))}function SP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function kP(){return this.on("end.remove",SP(this._id))}function NP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Fx(e));for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o)for(var l=n[o],c=l.length,d=s[o]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,Gc(d[p],t,r,p,d,Ir(u,r)));return new hn(s,this._parents,t,r)}function CP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=QN(e));for(var n=this._groups,i=n.length,s=[],o=[],l=0;l<i;++l)for(var c=n[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,x=Ir(u,r),g=0,_=p.length;g<_;++g)(h=p[g])&&Gc(h,t,r,g,p,x);s.push(p),o.push(u)}return new hn(s,o,t,r)}var EP=va.prototype.constructor;function TP(){return new EP(this._groups,this._parents)}function RP(e,t){var r,n,i;return function(){var s=Ss(this,e),o=(this.style.removeProperty(e),Ss(this,e));return s===o?null:s===r&&o===n?i:i=t(r=s,n=o)}}function _C(e){return function(){this.style.removeProperty(e)}}function AP(e,t,r){var n,i=r+"",s;return function(){var o=Ss(this,e);return o===i?null:o===n?s:s=t(n=o,r)}}function IP(e,t,r){var n,i,s;return function(){var o=Ss(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Ss(this,e))),o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l))}}function MP(e,t){var r,n,i,s="style."+t,o="end."+s,l;return function(){var c=Kr(this,e),d=c.on,u=c.value[s]==null?l||(l=_C(t)):void 0;(d!==r||i!==u)&&(n=(r=d).copy()).on(o,i=u),c.on=n}}function PP(e,t,r){var n=(e+="")=="transform"?PM:bC;return t==null?this.styleTween(e,RP(e,n)).on("end.style."+e,_C(e)):typeof t=="function"?this.styleTween(e,IP(e,n,Hx(this,"style."+e,t))).each(MP(this._id,e)):this.styleTween(e,AP(e,n,t),r).on("end.style."+e,null)}function OP(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function DP(e,t,r){var n,i;function s(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&OP(e,o,r)),n}return s._value=t,s}function LP(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,DP(e,t,r??""))}function FP(e){return function(){this.textContent=e}}function zP(e){return function(){var t=e(this);this.textContent=t??""}}function $P(e){return this.tween("text",typeof e=="function"?zP(Hx(this,"text",e)):FP(e==null?"":e+""))}function qP(e){return function(t){this.textContent=e.call(this,t)}}function BP(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&qP(i)),t}return n._value=e,n}function HP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,BP(e))}function WP(){for(var e=this._name,t=this._id,r=wC(),n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,d=0;d<l;++d)if(c=o[d]){var u=Ir(c,t);Gc(c,e,r,d,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new hn(n,this._parents,e,r)}function UP(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(s,o){var l={value:o},c={value:function(){--i===0&&s()}};r.each(function(){var d=Kr(this,n),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),i===0&&s()})}var VP=0;function hn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function wC(){return++VP}var Xr=va.prototype;hn.prototype={constructor:hn,select:NP,selectAll:CP,selectChild:Xr.selectChild,selectChildren:Xr.selectChildren,filter:yP,merge:bP,selection:TP,transition:WP,call:Xr.call,nodes:Xr.nodes,node:Xr.node,size:Xr.size,empty:Xr.empty,each:Xr.each,on:jP,attr:nP,attrTween:lP,style:PP,styleTween:LP,text:$P,textTween:HP,remove:kP,tween:XM,delay:dP,duration:hP,ease:gP,easeVarying:xP,end:UP,[Symbol.iterator]:Xr[Symbol.iterator]};function GP(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var KP={time:null,delay:0,duration:250,ease:GP};function YP(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function XP(e){var t,r;e instanceof hn?(t=e._id,e=e._name):(t=wC(),(r=KP).time=qx(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&Gc(c,e,t,d,o,r||YP(c,t));return new hn(n,this._parents,e,t)}va.prototype.interrupt=GM;va.prototype.transition=XP;const Qa=e=>()=>e;function QP(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function sn(e,t,r){this.k=e,this.x=t,this.y=r}sn.prototype={constructor:sn,scale:function(e){return e===1?this:new sn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new sn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var cn=new sn(1,0,0);sn.prototype;function nd(e){e.stopImmediatePropagation()}function Qs(e){e.preventDefault(),e.stopImmediatePropagation()}function ZP(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function JP(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function db(){return this.__zoom||cn}function eO(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function tO(){return navigator.maxTouchPoints||"ontouchstart"in this}function rO(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],s=e.invertY(t[0][1])-r[0][1],o=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function jC(){var e=ZP,t=JP,r=rO,n=eO,i=tO,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=zM,d=Wc("start","zoom","end"),u,f,p,h=500,x=150,g=0,_=10;function v(N){N.property("__zoom",db).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",R).filter(i).on("touchstart.zoom",E).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",$).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(N,D,I,F){var P=N.selection?N.selection():N;P.property("__zoom",db),N!==P?k(N,D,I,F):P.interrupt().each(function(){S(this,arguments).event(F).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},v.scaleBy=function(N,D,I,F){v.scaleTo(N,function(){var P=this.__zoom.k,A=typeof D=="function"?D.apply(this,arguments):D;return P*A},I,F)},v.scaleTo=function(N,D,I,F){v.transform(N,function(){var P=t.apply(this,arguments),A=this.__zoom,L=I==null?w(P):typeof I=="function"?I.apply(this,arguments):I,z=A.invert(L),B=typeof D=="function"?D.apply(this,arguments):D;return r(b(y(A,B),L,z),P,o)},I,F)},v.translateBy=function(N,D,I,F){v.transform(N,function(){return r(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),o)},null,F)},v.translateTo=function(N,D,I,F,P){v.transform(N,function(){var A=t.apply(this,arguments),L=this.__zoom,z=F==null?w(A):typeof F=="function"?F.apply(this,arguments):F;return r(cn.translate(z[0],z[1]).scale(L.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof I=="function"?-I.apply(this,arguments):-I),A,o)},F,P)};function y(N,D){return D=Math.max(s[0],Math.min(s[1],D)),D===N.k?N:new sn(D,N.x,N.y)}function b(N,D,I){var F=D[0]-I[0]*N.k,P=D[1]-I[1]*N.k;return F===N.x&&P===N.y?N:new sn(N.k,F,P)}function w(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function k(N,D,I,F){N.on("start.zoom",function(){S(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(F).end()}).tween("zoom",function(){var P=this,A=arguments,L=S(P,A).event(F),z=t.apply(P,A),B=I==null?w(z):typeof I=="function"?I.apply(P,A):I,X=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),G=P.__zoom,W=typeof D=="function"?D.apply(P,A):D,q=c(G.invert(B).concat(X/G.k),W.invert(B).concat(X/W.k));return function(Q){if(Q===1)Q=W;else{var ie=q(Q),oe=X/ie[2];Q=new sn(oe,B[0]-ie[0]*oe,B[1]-ie[1]*oe)}L.zoom(null,Q)}})}function S(N,D,I){return!I&&N.__zooming||new C(N,D)}function C(N,D){this.that=N,this.args=D,this.active=0,this.sourceEvent=null,this.extent=t.apply(N,D),this.taps=0}C.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,D){return this.mouse&&N!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var D=fr(this.that).datum();d.call(N,this.that,new QP(N,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:d}),D)}};function T(N,...D){if(!e.apply(this,arguments))return;var I=S(this,D).event(N),F=this.__zoom,P=Math.max(s[0],Math.min(s[1],F.k*Math.pow(2,n.apply(this,arguments)))),A=kr(N);if(I.wheel)(I.mouse[0][0]!==A[0]||I.mouse[0][1]!==A[1])&&(I.mouse[1]=F.invert(I.mouse[0]=A)),clearTimeout(I.wheel);else{if(F.k===P)return;I.mouse=[A,F.invert(A)],Tl(this),I.start()}Qs(N),I.wheel=setTimeout(L,x),I.zoom("mouse",r(b(y(F,P),I.mouse[0],I.mouse[1]),I.extent,o));function L(){I.wheel=null,I.end()}}function j(N,...D){if(p||!e.apply(this,arguments))return;var I=N.currentTarget,F=S(this,D,!0).event(N),P=fr(N.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",X,!0),A=kr(N,I),L=N.clientX,z=N.clientY;lC(N.view),nd(N),F.mouse=[A,this.__zoom.invert(A)],Tl(this),F.start();function B(G){if(Qs(G),!F.moved){var W=G.clientX-L,q=G.clientY-z;F.moved=W*W+q*q>g}F.event(G).zoom("mouse",r(b(F.that.__zoom,F.mouse[0]=kr(G,I),F.mouse[1]),F.extent,o))}function X(G){P.on("mousemove.zoom mouseup.zoom",null),cC(G.view,F.moved),Qs(G),F.event(G).end()}}function R(N,...D){if(e.apply(this,arguments)){var I=this.__zoom,F=kr(N.changedTouches?N.changedTouches[0]:N,this),P=I.invert(F),A=I.k*(N.shiftKey?.5:2),L=r(b(y(I,A),F,P),t.apply(this,D),o);Qs(N),l>0?fr(this).transition().duration(l).call(k,L,F,N):fr(this).call(v.transform,L,F,N)}}function E(N,...D){if(e.apply(this,arguments)){var I=N.touches,F=I.length,P=S(this,D,N.changedTouches.length===F).event(N),A,L,z,B;for(nd(N),L=0;L<F;++L)z=I[L],B=kr(z,this),B=[B,this.__zoom.invert(B),z.identifier],P.touch0?!P.touch1&&P.touch0[2]!==B[2]&&(P.touch1=B,P.taps=0):(P.touch0=B,A=!0,P.taps=1+!!u);u&&(u=clearTimeout(u)),A&&(P.taps<2&&(f=B[0],u=setTimeout(function(){u=null},h)),Tl(this),P.start())}}function M(N,...D){if(this.__zooming){var I=S(this,D).event(N),F=N.changedTouches,P=F.length,A,L,z,B;for(Qs(N),A=0;A<P;++A)L=F[A],z=kr(L,this),I.touch0&&I.touch0[2]===L.identifier?I.touch0[0]=z:I.touch1&&I.touch1[2]===L.identifier&&(I.touch1[0]=z);if(L=I.that.__zoom,I.touch1){var X=I.touch0[0],G=I.touch0[1],W=I.touch1[0],q=I.touch1[1],Q=(Q=W[0]-X[0])*Q+(Q=W[1]-X[1])*Q,ie=(ie=q[0]-G[0])*ie+(ie=q[1]-G[1])*ie;L=y(L,Math.sqrt(Q/ie)),z=[(X[0]+W[0])/2,(X[1]+W[1])/2],B=[(G[0]+q[0])/2,(G[1]+q[1])/2]}else if(I.touch0)z=I.touch0[0],B=I.touch0[1];else return;I.zoom("touch",r(b(L,z,B),I.extent,o))}}function $(N,...D){if(this.__zooming){var I=S(this,D).event(N),F=N.changedTouches,P=F.length,A,L;for(nd(N),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),A=0;A<P;++A)L=F[A],I.touch0&&I.touch0[2]===L.identifier?delete I.touch0:I.touch1&&I.touch1[2]===L.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(L=kr(L,this),Math.hypot(f[0]-L[0],f[1]-L[1])<_)){var z=fr(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return v.wheelDelta=function(N){return arguments.length?(n=typeof N=="function"?N:Qa(+N),v):n},v.filter=function(N){return arguments.length?(e=typeof N=="function"?N:Qa(!!N),v):e},v.touchable=function(N){return arguments.length?(i=typeof N=="function"?N:Qa(!!N),v):i},v.extent=function(N){return arguments.length?(t=typeof N=="function"?N:Qa([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),v):t},v.scaleExtent=function(N){return arguments.length?(s[0]=+N[0],s[1]=+N[1],v):[s[0],s[1]]},v.translateExtent=function(N){return arguments.length?(o[0][0]=+N[0][0],o[1][0]=+N[1][0],o[0][1]=+N[0][1],o[1][1]=+N[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(N){return arguments.length?(r=N,v):r},v.duration=function(N){return arguments.length?(l=+N,v):l},v.interpolate=function(N){return arguments.length?(c=N,v):c},v.on=function(){var N=d.on.apply(d,arguments);return N===d?v:N},v.clickDistance=function(N){return arguments.length?(g=(N=+N)*N,v):Math.sqrt(g)},v.tapDistance=function(N){return arguments.length?(_=+N,v):_},v}const Kc=m.createContext(null),nO=Kc.Provider,mn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},SC=mn.error001();function Ye(e,t){const r=m.useContext(Kc);if(r===null)throw new Error(SC);return YN(r,e,t)}const xt=()=>{const e=m.useContext(Kc);if(e===null)throw new Error(SC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},iO=e=>e.userSelectionActive?"none":"all";function Wn({position:e,children:t,className:r,style:n,...i}){const s=Ye(iO),o=`${e}`.split("-");return Y.createElement("div",{className:Yt(["react-flow__panel",r,...o]),style:{...n,pointerEvents:s},...i},t)}function sO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:Y.createElement(Wn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},Y.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const oO=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),x=Yt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();h({x:g.x,y:g.y,width:g.width,height:g.height})}},[r]),typeof r>"u"||!r?null:Y.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:x,visibility:p.width?"visible":"hidden",...u},i&&Y.createElement("rect",{width:p.width+2*o[0],x:-o[0],y:-o[1],height:p.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),Y.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var aO=m.memo(oO);const Wx=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ns=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Ux=(e={x:0,y:0},t)=>({x:Ns(e.x,t[0][0],t[1][0]),y:Ns(e.y,t[0][1],t[1][1])}),fb=(e,t,r)=>e<t?Ns(Math.abs(e-t),1,50)/50:e>r?-Ns(Math.abs(e-r),1,50)/50:0,kC=(e,t)=>{const r=fb(e.x,35,t.width-35)*20,n=fb(e.y,35,t.height-35)*20;return[r,n]},NC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},CC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ra=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),EC=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),pb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),lO=(e,t)=>EC(CC(ra(e),ra(t))),wv=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},cO=e=>hr(e.width)&&hr(e.height)&&hr(e.x)&&hr(e.y),hr=e=>!isNaN(e)&&isFinite(e),rt=Symbol.for("internals"),TC=["Enter"," ","Escape"],uO=(e,t)=>{},dO=e=>"nativeEvent"in e;function jv(e){var i,s;const t=dO(e)?e.nativeEvent:e,r=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const RC=e=>"clientX"in e,Un=(e,t)=>{var s,o;const r=RC(e),n=r?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=r?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},ac=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},ya=({id:e,path:t,labelX:r,labelY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>Y.createElement(Y.Fragment,null,Y.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&Y.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&hr(r)&&hr(n)?Y.createElement(aO,{x:r,y:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);ya.displayName="BaseEdge";function Zs(e,t,r){return r===void 0?r:n=>{const i=t().edges.find(s=>s.id===e);i&&r(n,{...i})}}function AC({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,s=r<e?r+i:r-i,o=Math.abs(n-t)/2,l=n<t?n+o:n-o;return[s,l,i,o]}function IC({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:l}){const c=e*.125+i*.375+o*.375+r*.125,d=t*.125+s*.375+l*.375+n*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Ni;(function(e){e.Strict="strict",e.Loose="loose"})(Ni||(Ni={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var na;(function(e){e.Partial="partial",e.Full="full"})(na||(na={}));var An;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(An||(An={}));var lc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(lc||(lc={}));var ue;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ue||(ue={}));function hb({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===ue.Left||e===ue.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function MC({sourceX:e,sourceY:t,sourcePosition:r=ue.Bottom,targetX:n,targetY:i,targetPosition:s=ue.Top}){const[o,l]=hb({pos:r,x1:e,y1:t,x2:n,y2:i}),[c,d]=hb({pos:s,x1:n,y1:i,x2:e,y2:t}),[u,f,p,h]=IC({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${o},${l} ${c},${d} ${n},${i}`,u,f,p,h]}const Vx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=ue.Bottom,targetPosition:s=ue.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:g})=>{const[_,v,y]=MC({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s});return Y.createElement(ya,{path:_,labelX:v,labelY:y,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:g})});Vx.displayName="SimpleBezierEdge";const mb={[ue.Left]:{x:-1,y:0},[ue.Right]:{x:1,y:0},[ue.Top]:{x:0,y:-1},[ue.Bottom]:{x:0,y:1}},fO=({source:e,sourcePosition:t=ue.Bottom,target:r})=>t===ue.Left||t===ue.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},gb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function pO({source:e,sourcePosition:t=ue.Bottom,target:r,targetPosition:n=ue.Top,center:i,offset:s}){const o=mb[t],l=mb[n],c={x:e.x+o.x*s,y:e.y+o.y*s},d={x:r.x+l.x*s,y:r.y+l.y*s},u=fO({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],x,g;const _={x:0,y:0},v={x:0,y:0},[y,b,w,k]=AC({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(o[f]*l[f]===-1){x=i.x??y,g=i.y??b;const C=[{x,y:c.y},{x,y:d.y}],T=[{x:c.x,y:g},{x:d.x,y:g}];o[f]===p?h=f==="x"?C:T:h=f==="x"?T:C}else{const C=[{x:c.x,y:d.y}],T=[{x:d.x,y:c.y}];if(f==="x"?h=o.x===p?T:C:h=o.y===p?C:T,t===n){const $=Math.abs(e[f]-r[f]);if($<=s){const N=Math.min(s-1,s-$);o[f]===p?_[f]=(c[f]>e[f]?-1:1)*N:v[f]=(d[f]>r[f]?-1:1)*N}}if(t!==n){const $=f==="x"?"y":"x",N=o[f]===l[$],D=c[$]>d[$],I=c[$]<d[$];(o[f]===1&&(!N&&D||N&&I)||o[f]!==1&&(!N&&I||N&&D))&&(h=f==="x"?C:T)}const j={x:c.x+_.x,y:c.y+_.y},R={x:d.x+v.x,y:d.y+v.y},E=Math.max(Math.abs(j.x-h[0].x),Math.abs(R.x-h[0].x)),M=Math.max(Math.abs(j.y-h[0].y),Math.abs(R.y-h[0].y));E>=M?(x=(j.x+R.x)/2,g=h[0].y):(x=h[0].x,g=(j.y+R.y)/2)}return[[e,{x:c.x+_.x,y:c.y+_.y},...h,{x:d.x+v.x,y:d.y+v.y},r],x,g,w,k]}function hO(e,t,r,n){const i=Math.min(gb(e,t)/2,gb(t,r)/2,n),{x:s,y:o}=t;if(e.x===s&&s===r.x||e.y===o&&o===r.y)return`L${s} ${o}`;if(e.y===o){const d=e.x<r.x?-1:1,u=e.y<r.y?1:-1;return`L ${s+i*d},${o}Q ${s},${o} ${s},${o+i*u}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*l},${o}`}function Sv({sourceX:e,sourceY:t,sourcePosition:r=ue.Bottom,targetX:n,targetY:i,targetPosition:s=ue.Top,borderRadius:o=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,x]=pO({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:s,center:{x:l,y:c},offset:d});return[u.reduce((_,v,y)=>{let b="";return y>0&&y<u.length-1?b=hO(u[y-1],v,u[y+1],o):b=`${y===0?"M":"L"}${v.x} ${v.y}`,_+=b,_},""),f,p,h,x]}const Yc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=ue.Bottom,targetPosition:p=ue.Top,markerEnd:h,markerStart:x,pathOptions:g,interactionWidth:_})=>{const[v,y,b]=Sv({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return Y.createElement(ya,{path:v,labelX:y,labelY:b,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:x,interactionWidth:_})});Yc.displayName="SmoothStepEdge";const Gx=m.memo(e=>{var t;return Y.createElement(Yc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Gx.displayName="StepEdge";function mO({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,s,o,l]=AC({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,s,o,l]}const Kx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[x,g,_]=mO({sourceX:e,sourceY:t,targetX:r,targetY:n});return Y.createElement(ya,{path:x,labelX:g,labelY:_,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});Kx.displayName="StraightEdge";function Za(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function vb({pos:e,x1:t,y1:r,x2:n,y2:i,c:s}){switch(e){case ue.Left:return[t-Za(t-n,s),r];case ue.Right:return[t+Za(n-t,s),r];case ue.Top:return[t,r-Za(r-i,s)];case ue.Bottom:return[t,r+Za(i-r,s)]}}function PC({sourceX:e,sourceY:t,sourcePosition:r=ue.Bottom,targetX:n,targetY:i,targetPosition:s=ue.Top,curvature:o=.25}){const[l,c]=vb({pos:r,x1:e,y1:t,x2:n,y2:i,c:o}),[d,u]=vb({pos:s,x1:n,y1:i,x2:e,y2:t,c:o}),[f,p,h,x]=IC({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${n},${i}`,f,p,h,x]}const cc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=ue.Bottom,targetPosition:s=ue.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,pathOptions:g,interactionWidth:_})=>{const[v,y,b]=PC({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s,curvature:g==null?void 0:g.curvature});return Y.createElement(ya,{path:v,labelX:y,labelY:b,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:_})});cc.displayName="BezierEdge";const Yx=m.createContext(null),gO=Yx.Provider;Yx.Consumer;const vO=()=>m.useContext(Yx),xO=e=>"id"in e&&"source"in e&&"target"in e,yO=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,kv=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,bO=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),_O=(e,t)=>{if(!e.source||!e.target)return t;let r;return xO(e)?r={...e}:r={...e,id:yO(e)},bO(r,t)?t:t.concat(r)},Nv=({x:e,y:t},[r,n,i],s,[o,l])=>{const c={x:(e-r)/i,y:(t-n)/i};return s?{x:o*Math.round(c.x/o),y:l*Math.round(c.y/l)}:c},OC=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n}),xi=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],i={x:e.position.x-r,y:e.position.y-n};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:i}},Xc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const{x:s,y:o}=xi(i,t).positionAbsolute;return CC(n,ra({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return EC(r)},DC=(e,t,[r,n,i]=[0,0,1],s=!1,o=!1,l=[0,0])=>{const c={x:(t.x-r)/i,y:(t.y-n)/i,width:t.width/i,height:t.height/i},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:x=!1}=u;if(o&&!h||x)return!1;const{positionAbsolute:g}=xi(u,l),_={x:g.x,y:g.y,width:f||0,height:p||0},v=wv(c,_),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=s&&v>0,w=(f||0)*(p||0);(y||b||v>=w||u.dragging)&&d.push(u)}),d},LC=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},FC=(e,t,r,n,i,s=.1)=>{const o=t/(e.width*(1+s)),l=r/(e.height*(1+s)),c=Math.min(o,l),d=Ns(c,n,i),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=r/2-f*d;return{x:p,y:h,zoom:d}},li=(e,t=0)=>e.transition().duration(t);function xb(e,t,r,n){return(t[r]||[]).reduce((i,s)=>{var o,l;return`${e.id}-${s.id}-${r}`!==n&&i.push({id:s.id||null,type:r,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+s.y+s.height/2}),i},[])}function wO(e,t,r,n,i,s){const{x:o,y:l}=Un(e),d=t.elementsFromPoint(o,l).find(x=>x.classList.contains("react-flow__handle"));if(d){const x=d.getAttribute("data-nodeid");if(x){const g=Xx(void 0,d),_=d.getAttribute("data-handleid"),v=s({nodeId:x,id:_,type:g});if(v){const y=i.find(b=>b.nodeId===x&&b.type===g&&b.id===_);return{handle:{id:_,type:g,nodeId:x,x:(y==null?void 0:y.x)||r.x,y:(y==null?void 0:y.y)||r.y},validHandleResult:v}}}}let u=[],f=1/0;if(i.forEach(x=>{const g=Math.sqrt((x.x-r.x)**2+(x.y-r.y)**2);if(g<=n){const _=s(x);g<=f&&(g<f?u=[{handle:x,validHandleResult:_}]:g===f&&u.push({handle:x,validHandleResult:_}),f=g)}}),!u.length)return{handle:null,validHandleResult:zC()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:x})=>x.isValid),h=u.some(({handle:x})=>x.type==="target");return u.find(({handle:x,validHandleResult:g})=>h?x.type==="target":p?g.isValid:!0)||u[0]}const jO={source:null,target:null,sourceHandle:null,targetHandle:null},zC=()=>({handleDomNode:null,isValid:!1,connection:jO,endHandle:null});function $C(e,t,r,n,i,s,o){const l=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...zC(),handleDomNode:c};if(c){const u=Xx(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),x=c.classList.contains("connectableend"),g={source:l?f:r,sourceHandle:l?p:n,target:l?r:f,targetHandle:l?n:p};d.connection=g,h&&x&&(t===Ni.Strict?l&&u==="source"||!l&&u==="target":f!==r||p!==n)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=s(g))}return d}function SO({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((i,s)=>{if(s[rt]){const{handleBounds:o}=s[rt];let l=[],c=[];o&&(l=xb(s,o,"source",`${t}-${r}-${n}`),c=xb(s,o,"target",`${t}-${r}-${n}`)),i.push(...l,...c)}return i},[])}function Xx(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function id(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function kO(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function qC({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:i,getState:s,setState:o,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=NC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:x,onConnectStart:g,panBy:_,getNodes:v,cancelConnection:y}=s();let b=0,w;const{x:k,y:S}=Un(e),C=u==null?void 0:u.elementFromPoint(k,S),T=Xx(c,C),j=p==null?void 0:p.getBoundingClientRect();if(!j||!T)return;let R,E=Un(e,j),M=!1,$=null,N=!1,D=null;const I=SO({nodes:v(),nodeId:r,handleId:t,handleType:T}),F=()=>{if(!h)return;const[L,z]=kC(E,j);_({x:L,y:z}),b=requestAnimationFrame(F)};o({connectionPosition:E,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:T,connectionStartHandle:{nodeId:r,handleId:t,type:T},connectionEndHandle:null}),g==null||g(e,{nodeId:r,handleId:t,handleType:T});function P(L){const{transform:z}=s();E=Un(L,j);const{handle:B,validHandleResult:X}=wO(L,u,Nv(E,z,!1,[1,1]),x,I,G=>$C(G,f,r,t,i?"target":"source",l,u));if(w=B,M||(F(),M=!0),D=X.handleDomNode,$=X.connection,N=X.isValid,o({connectionPosition:w&&N?OC({x:w.x,y:w.y},z):E,connectionStatus:kO(!!w,N),connectionEndHandle:X.endHandle}),!w&&!N&&!D)return id(R);$.source!==$.target&&D&&(id(R),R=D,D.classList.add("connecting","react-flow__handle-connecting"),D.classList.toggle("valid",N),D.classList.toggle("react-flow__handle-valid",N))}function A(L){var z,B;(w||D)&&$&&N&&(n==null||n($)),(B=(z=s()).onConnectEnd)==null||B.call(z,L),c&&(d==null||d(L)),id(R),y(),cancelAnimationFrame(b),M=!1,N=!1,$=null,D=null,u.removeEventListener("mousemove",P),u.removeEventListener("mouseup",A),u.removeEventListener("touchmove",P),u.removeEventListener("touchend",A)}u.addEventListener("mousemove",P),u.addEventListener("mouseup",A),u.addEventListener("touchmove",P),u.addEventListener("touchend",A)}const yb=()=>!0,NO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),CO=(e,t,r)=>n=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=n;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r}},BC=m.forwardRef(({type:e="source",position:t=ue.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var j,R;const x=o||null,g=e==="target",_=xt(),v=vO(),{connectOnClick:y,noPanClassName:b}=Ye(NO,Mt),{connecting:w,clickConnecting:k}=Ye(CO(v,x,e),Mt);v||(R=(j=_.getState()).onError)==null||R.call(j,"010",mn.error010());const S=E=>{const{defaultEdgeOptions:M,onConnect:$,hasDefaultEdges:N}=_.getState(),D={...M,...E};if(N){const{edges:I,setEdges:F}=_.getState();F(_O(D,I))}$==null||$(D),l==null||l(D)},C=E=>{if(!v)return;const M=RC(E);i&&(M&&E.button===0||!M)&&qC({event:E,handleId:x,nodeId:v,onConnect:S,isTarget:g,getState:_.getState,setState:_.setState,isValidConnection:r||_.getState().isValidConnection||yb}),M?u==null||u(E):f==null||f(E)},T=E=>{const{onClickConnectStart:M,onClickConnectEnd:$,connectionClickStartHandle:N,connectionMode:D,isValidConnection:I}=_.getState();if(!v||!N&&!i)return;if(!N){M==null||M(E,{nodeId:v,handleId:x,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:x}});return}const F=NC(E.target),P=r||I||yb,{connection:A,isValid:L}=$C({nodeId:v,id:x,type:e},D,N.nodeId,N.handleId||null,N.type,P,F);L&&S(A),$==null||$(E),_.setState({connectionClickStartHandle:null})};return Y.createElement("div",{"data-handleid":x,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${x}-${e}`,className:Yt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!g,target:g,connectable:n,connectablestart:i,connectableend:s,connecting:k,connectionindicator:n&&(i&&!w||s&&w)}]),onMouseDown:C,onTouchStart:C,onClick:y?T:void 0,ref:h,...p},c)});BC.displayName="Handle";var Vr=m.memo(BC);const HC=({data:e,isConnectable:t,targetPosition:r=ue.Top,sourcePosition:n=ue.Bottom})=>Y.createElement(Y.Fragment,null,Y.createElement(Vr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,Y.createElement(Vr,{type:"source",position:n,isConnectable:t}));HC.displayName="DefaultNode";var Cv=m.memo(HC);const WC=({data:e,isConnectable:t,sourcePosition:r=ue.Bottom})=>Y.createElement(Y.Fragment,null,e==null?void 0:e.label,Y.createElement(Vr,{type:"source",position:r,isConnectable:t}));WC.displayName="InputNode";var UC=m.memo(WC);const VC=({data:e,isConnectable:t,targetPosition:r=ue.Top})=>Y.createElement(Y.Fragment,null,Y.createElement(Vr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);VC.displayName="OutputNode";var GC=m.memo(VC);const Qx=()=>null;Qx.displayName="GroupNode";const EO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Ja=e=>e.id;function TO(e,t){return Mt(e.selectedNodes.map(Ja),t.selectedNodes.map(Ja))&&Mt(e.selectedEdges.map(Ja),t.selectedEdges.map(Ja))}const KC=m.memo(({onSelectionChange:e})=>{const t=xt(),{selectedNodes:r,selectedEdges:n}=Ye(EO,TO);return m.useEffect(()=>{const i={nodes:r,edges:n};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[r,n,e]),null});KC.displayName="SelectionListener";const RO=e=>!!e.onSelectionChange;function AO({onSelectionChange:e}){const t=Ye(RO);return e||t?Y.createElement(KC,{onSelectionChange:e}):null}const IO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oi(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ke(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const MO=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:x,minZoom:g,maxZoom:_,nodeExtent:v,onNodesChange:y,onEdgesChange:b,elementsSelectable:w,connectionMode:k,snapGrid:S,snapToGrid:C,translateExtent:T,connectOnClick:j,defaultEdgeOptions:R,fitView:E,fitViewOptions:M,onNodesDelete:$,onEdgesDelete:N,onNodeDrag:D,onNodeDragStart:I,onNodeDragStop:F,onSelectionDrag:P,onSelectionDragStart:A,onSelectionDragStop:L,noPanClassName:z,nodeOrigin:B,rfId:X,autoPanOnConnect:G,autoPanOnNodeDrag:W,onError:q,connectionRadius:Q,isValidConnection:ie,nodeDragThreshold:oe})=>{const{setNodes:J,setEdges:je,setDefaultNodesAndEdges:ge,setMinZoom:we,setMaxZoom:xe,setTranslateExtent:se,setNodeExtent:K,reset:re}=Ye(IO,Mt),U=xt();return m.useEffect(()=>{const de=n==null?void 0:n.map(fe=>({...fe,...R}));return ge(r,de),()=>{re()}},[]),ke("defaultEdgeOptions",R,U.setState),ke("connectionMode",k,U.setState),ke("onConnect",i,U.setState),ke("onConnectStart",s,U.setState),ke("onConnectEnd",o,U.setState),ke("onClickConnectStart",l,U.setState),ke("onClickConnectEnd",c,U.setState),ke("nodesDraggable",d,U.setState),ke("nodesConnectable",u,U.setState),ke("nodesFocusable",f,U.setState),ke("edgesFocusable",p,U.setState),ke("edgesUpdatable",h,U.setState),ke("elementsSelectable",w,U.setState),ke("elevateNodesOnSelect",x,U.setState),ke("snapToGrid",C,U.setState),ke("snapGrid",S,U.setState),ke("onNodesChange",y,U.setState),ke("onEdgesChange",b,U.setState),ke("connectOnClick",j,U.setState),ke("fitViewOnInit",E,U.setState),ke("fitViewOnInitOptions",M,U.setState),ke("onNodesDelete",$,U.setState),ke("onEdgesDelete",N,U.setState),ke("onNodeDrag",D,U.setState),ke("onNodeDragStart",I,U.setState),ke("onNodeDragStop",F,U.setState),ke("onSelectionDrag",P,U.setState),ke("onSelectionDragStart",A,U.setState),ke("onSelectionDragStop",L,U.setState),ke("noPanClassName",z,U.setState),ke("nodeOrigin",B,U.setState),ke("rfId",X,U.setState),ke("autoPanOnConnect",G,U.setState),ke("autoPanOnNodeDrag",W,U.setState),ke("onError",q,U.setState),ke("connectionRadius",Q,U.setState),ke("isValidConnection",ie,U.setState),ke("nodeDragThreshold",oe,U.setState),Oi(e,J),Oi(t,je),Oi(g,we),Oi(_,xe),Oi(T,se),Oi(v,K),null},bb={display:"none"},PO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},YC="react-flow__node-desc",XC="react-flow__edge-desc",OO="react-flow__aria-live",DO=e=>e.ariaLiveMessage;function LO({rfId:e}){const t=Ye(DO);return Y.createElement("div",{id:`${OO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:PO},t)}function FO({rfId:e,disableKeyboardA11y:t}){return Y.createElement(Y.Fragment,null,Y.createElement("div",{id:`${YC}-${e}`,style:bb},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),Y.createElement("div",{id:`${XC}-${e}`,style:bb},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&Y.createElement(LO,{rfId:e}))}var ia=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),i=m.useRef(!1),s=m.useRef(new Set([])),[o,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&jv(h))return!1;const g=wb(h.code,l);s.current.add(h[g]),_b(o,s.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&jv(h))return!1;const g=wb(h.code,l);_b(o,s.current,!0)?(n(!1),s.current.clear()):s.current.delete(h[g]),h.key==="Meta"&&s.current.clear(),i.current=!1},p=()=>{s.current.clear(),n(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function _b(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function wb(e,t){return t.includes(e)?"code":"key"}function QC(e,t,r,n){var l,c;const i=e.parentNode||e.parentId;if(!i)return r;const s=t.get(i),o=xi(s,n);return QC(s,t,{x:(r.x??0)+o.x,y:(r.y??0)+o.y,z:(((l=s[rt])==null?void 0:l.z)??0)>(r.z??0)?((c=s[rt])==null?void 0:c.z)??0:r.z??0},n)}function ZC(e,t,r){e.forEach(n=>{var s;const i=n.parentNode||n.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||r!=null&&r[n.id]){const{x:o,y:l,z:c}=QC(n,e,{...n.position,z:((s=n[rt])==null?void 0:s.z)??0},t);n.positionAbsolute={x:o,y:l},n[rt].z=c,r!=null&&r[n.id]&&(n[rt].isParent=!0)}})}function sd(e,t,r,n){const i=new Map,s={},o=n?1e3:0;return e.forEach(l=>{var h;const c=(hr(l.zIndex)?l.zIndex:0)+(l.selected?o:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(s[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,rt,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[rt])==null?void 0:h.handleBounds,z:c}}),i.set(l.id,u)}),ZC(i,r,s),i}function JC(e,t={}){const{getNodes:r,width:n,height:i,minZoom:s,maxZoom:o,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const x=r().filter(_=>{var y;const v=t.includeHiddenNodes?_.width&&_.height:!_.hidden;return(y=t.nodes)!=null&&y.length?v&&t.nodes.some(b=>b.id===_.id):v}),g=x.every(_=>_.width&&_.height);if(x.length>0&&g){const _=Xc(x,f),{x:v,y,zoom:b}=FC(_,n,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),w=cn.translate(v,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(li(c,t.duration),w):l.transform(c,w),!0}}return!1}function zO(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[rt]:n[rt],selected:r.selected})}),new Map(t)}function $O(e,t){return t.map(r=>{const n=e.find(i=>i.id===r.id);return n&&(r.selected=n.selected),r})}function el({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=r();e!=null&&e.length&&(c&&n({nodeInternals:zO(e,i)}),o==null||o(e)),t!=null&&t.length&&(d&&n({edges:$O(t,s)}),l==null||l(t))}const Di=()=>{},qO={zoomIn:Di,zoomOut:Di,zoomTo:Di,getZoom:()=>1,setViewport:Di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Di,fitBounds:Di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},BO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),HO=()=>{const e=xt(),{d3Zoom:t,d3Selection:r}=Ye(BO,Mt);return m.useMemo(()=>r&&t?{zoomIn:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(li(r,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,l,c]=e.getState().transform,d=cn.translate(i.x??o,i.y??l).scale(i.zoom??c);t.transform(li(r,s==null?void 0:s.duration),d)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>JC(e.getState,i),setCenter:(i,s,o)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:d,f=l/2-i*u,p=c/2-s*u,h=cn.translate(f,p).scale(u);t.transform(li(r,o==null?void 0:o.duration),h)},fitBounds:(i,s)=>{const{width:o,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=FC(i,o,l,c,d,(s==null?void 0:s.padding)??.1),h=cn.translate(u,f).scale(p);t.transform(li(r,s==null?void 0:s.duration),h)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Nv(i,s,o,l)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:l,domNode:c}=e.getState();if(!c)return i;const{x:d,y:u}=c.getBoundingClientRect(),f={x:i.x-d,y:i.y-u};return Nv(f,s,o,l)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:l,y:c}=o.getBoundingClientRect(),d=OC(i,s);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:qO,[t,r])};function Qc(){const e=HO(),t=xt(),r=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),n=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),i=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(_=>({..._}))},[]),s=m.useCallback(g=>{const{edges:_=[]}=t.getState();return _.find(v=>v.id===g)},[]),o=m.useCallback(g=>{const{getNodes:_,setNodes:v,hasDefaultNodes:y,onNodesChange:b}=t.getState(),w=_(),k=typeof g=="function"?g(w):g;if(y)v(k);else if(b){const S=k.length===0?w.map(C=>({type:"remove",id:C.id})):k.map(C=>({item:C,type:"reset"}));b(S)}},[]),l=m.useCallback(g=>{const{edges:_=[],setEdges:v,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),w=typeof g=="function"?g(_):g;if(y)v(w);else if(b){const k=w.length===0?_.map(S=>({type:"remove",id:S.id})):w.map(S=>({item:S,type:"reset"}));b(k)}},[]),c=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{getNodes:v,setNodes:y,hasDefaultNodes:b,onNodesChange:w}=t.getState();if(b){const S=[...v(),..._];y(S)}else if(w){const k=_.map(S=>({item:S,type:"add"}));w(k)}},[]),d=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{edges:v=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:w}=t.getState();if(b)y([...v,..._]);else if(w){const k=_.map(S=>({item:S,type:"add"}));w(k)}},[]),u=m.useCallback(()=>{const{getNodes:g,edges:_=[],transform:v}=t.getState(),[y,b,w]=v;return{nodes:g().map(k=>({...k})),edges:_.map(k=>({...k})),viewport:{x:y,y:b,zoom:w}}},[]),f=m.useCallback(({nodes:g,edges:_})=>{const{nodeInternals:v,getNodes:y,edges:b,hasDefaultNodes:w,hasDefaultEdges:k,onNodesDelete:S,onEdgesDelete:C,onNodesChange:T,onEdgesChange:j}=t.getState(),R=(g||[]).map(D=>D.id),E=(_||[]).map(D=>D.id),M=y().reduce((D,I)=>{const F=I.parentNode||I.parentId,P=!R.includes(I.id)&&F&&D.find(L=>L.id===F);return(typeof I.deletable=="boolean"?I.deletable:!0)&&(R.includes(I.id)||P)&&D.push(I),D},[]),$=b.filter(D=>typeof D.deletable=="boolean"?D.deletable:!0),N=$.filter(D=>E.includes(D.id));if(M||N){const D=LC(M,$),I=[...N,...D],F=I.reduce((P,A)=>(P.includes(A.id)||P.push(A.id),P),[]);if((k||w)&&(k&&t.setState({edges:b.filter(P=>!F.includes(P.id))}),w&&(M.forEach(P=>{v.delete(P.id)}),t.setState({nodeInternals:new Map(v)}))),F.length>0&&(C==null||C(I),j&&j(F.map(P=>({id:P,type:"remove"})))),M.length>0&&(S==null||S(M),T)){const P=M.map(A=>({id:A.id,type:"remove"}));T(P)}}},[]),p=m.useCallback(g=>{const _=cO(g),v=_?null:t.getState().nodeInternals.get(g.id);return!_&&!v?[null,null,_]:[_?g:pb(v),v,_]},[]),h=m.useCallback((g,_=!0,v)=>{const[y,b,w]=p(g);return y?(v||t.getState().getNodes()).filter(k=>{if(!w&&(k.id===b.id||!k.positionAbsolute))return!1;const S=pb(k),C=wv(S,y);return _&&C>0||C>=y.width*y.height}):[]},[]),x=m.useCallback((g,_,v=!0)=>{const[y]=p(g);if(!y)return!1;const b=wv(y,_);return v&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:i,getEdge:s,setNodes:o,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:x}),[e,r,n,i,s,o,l,c,d,u,f,h,x])}const WO={actInsideInputWithModifier:!1};var UO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=xt(),{deleteElements:n}=Qc(),i=ia(e,WO),s=ia(t);m.useEffect(()=>{if(i){const{edges:o,getNodes:l}=r.getState(),c=l().filter(u=>u.selected),d=o.filter(u=>u.selected);n({nodes:c,edges:d}),r.setState({nodesSelectionActive:!1})}},[i]),m.useEffect(()=>{r.setState({multiSelectionActive:s})},[s])};function VO(e){const t=xt();m.useEffect(()=>{let r;const n=()=>{var s,o;if(!e.current)return;const i=Wx(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",mn.error004())),t.setState({width:i.width||500,height:i.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const Zx={position:"absolute",width:"100%",height:"100%",top:0,left:0},GO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,tl=e=>({x:e.x,y:e.y,zoom:e.k}),Li=(e,t)=>e.target.closest(`.${t}`),jb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Sb=e=>{const t=e.ctrlKey&&ac()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},KO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),YO=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=pi.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:x,maxZoom:g,zoomActivationKeyCode:_,preventScrolling:v=!0,children:y,noWheelClassName:b,noPanClassName:w})=>{const k=m.useRef(),S=xt(),C=m.useRef(!1),T=m.useRef(!1),j=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:E,d3Selection:M,d3ZoomHandler:$,userSelectionActive:N}=Ye(KO,Mt),D=ia(_),I=m.useRef(0),F=m.useRef(!1),P=m.useRef();return VO(j),m.useEffect(()=>{if(j.current){const A=j.current.getBoundingClientRect(),L=jC().scaleExtent([x,g]).translateExtent(h),z=fr(j.current).call(L),B=cn.translate(p.x,p.y).scale(Ns(p.zoom,x,g)),X=[[0,0],[A.width,A.height]],G=L.constrain()(B,X,h);L.transform(z,G),L.wheelDelta(Sb),S.setState({d3Zoom:L,d3Selection:z,d3ZoomHandler:z.on("wheel.zoom"),transform:[G.x,G.y,G.k],domNode:j.current.closest(".react-flow")})}},[]),m.useEffect(()=>{M&&E&&(o&&!D&&!N?M.on("wheel.zoom",A=>{if(Li(A,b))return!1;A.preventDefault(),A.stopImmediatePropagation();const L=M.property("__zoom").k||1;if(A.ctrlKey&&s){const ie=kr(A),oe=Sb(A),J=L*Math.pow(2,oe);E.scaleTo(M,J,ie,A);return}const z=A.deltaMode===1?20:1;let B=c===pi.Vertical?0:A.deltaX*z,X=c===pi.Horizontal?0:A.deltaY*z;!ac()&&A.shiftKey&&c!==pi.Vertical&&(B=A.deltaY*z,X=0),E.translateBy(M,-(B/L)*l,-(X/L)*l,{internal:!0});const G=tl(M.property("__zoom")),{onViewportChangeStart:W,onViewportChange:q,onViewportChangeEnd:Q}=S.getState();clearTimeout(P.current),F.current||(F.current=!0,t==null||t(A,G),W==null||W(G)),F.current&&(e==null||e(A,G),q==null||q(G),P.current=setTimeout(()=>{r==null||r(A,G),Q==null||Q(G),F.current=!1},150))},{passive:!1}):typeof $<"u"&&M.on("wheel.zoom",function(A,L){if(!v&&A.type==="wheel"&&!A.ctrlKey||Li(A,b))return null;A.preventDefault(),$.call(this,A,L)},{passive:!1}))},[N,o,c,M,E,$,D,s,v,b,t,e,r]),m.useEffect(()=>{E&&E.on("start",A=>{var B,X;if(!A.sourceEvent||A.sourceEvent.internal)return null;I.current=(B=A.sourceEvent)==null?void 0:B.button;const{onViewportChangeStart:L}=S.getState(),z=tl(A.transform);C.current=!0,R.current=z,((X=A.sourceEvent)==null?void 0:X.type)==="mousedown"&&S.setState({paneDragging:!0}),L==null||L(z),t==null||t(A.sourceEvent,z)})},[E,t]),m.useEffect(()=>{E&&(N&&!C.current?E.on("zoom",null):N||E.on("zoom",A=>{var z;const{onViewportChange:L}=S.getState();if(S.setState({transform:[A.transform.x,A.transform.y,A.transform.k]}),T.current=!!(n&&jb(f,I.current??0)),(e||L)&&!((z=A.sourceEvent)!=null&&z.internal)){const B=tl(A.transform);L==null||L(B),e==null||e(A.sourceEvent,B)}}))},[N,E,e,f,n]),m.useEffect(()=>{E&&E.on("end",A=>{if(!A.sourceEvent||A.sourceEvent.internal)return null;const{onViewportChangeEnd:L}=S.getState();if(C.current=!1,S.setState({paneDragging:!1}),n&&jb(f,I.current??0)&&!T.current&&n(A.sourceEvent),T.current=!1,(r||L)&&GO(R.current,A.transform)){const z=tl(A.transform);R.current=z,clearTimeout(k.current),k.current=setTimeout(()=>{L==null||L(z),r==null||r(A.sourceEvent,z)},o?150:0)}})},[E,o,f,r,n]),m.useEffect(()=>{E&&E.filter(A=>{const L=D||i,z=s&&A.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&A.button===1&&A.type==="mousedown"&&(Li(A,"react-flow__node")||Li(A,"react-flow__edge")))return!0;if(!f&&!L&&!o&&!d&&!s||N||!d&&A.type==="dblclick"||Li(A,b)&&A.type==="wheel"||Li(A,w)&&(A.type!=="wheel"||o&&A.type==="wheel"&&!D)||!s&&A.ctrlKey&&A.type==="wheel"||!L&&!o&&!z&&A.type==="wheel"||!f&&(A.type==="mousedown"||A.type==="touchstart")||Array.isArray(f)&&!f.includes(A.button)&&A.type==="mousedown")return!1;const B=Array.isArray(f)&&f.includes(A.button)||!A.button||A.button<=1;return(!A.ctrlKey||A.type==="wheel")&&B})},[N,E,i,s,o,d,f,u,D]),Y.createElement("div",{className:"react-flow__renderer",ref:j,style:Zx},y)},XO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function QO(){const{userSelectionActive:e,userSelectionRect:t}=Ye(XO,Mt);return e&&t?Y.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function kb(e,t){const r=t.parentNode||t.parentId,n=e.find(i=>i.id===r);if(n){const i=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,i>0&&(n.style.width+=i),s>0&&(n.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);n.position.x=n.position.x-o,n.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);n.position.y=n.position.y-o,n.style.height+=o,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function eE(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,i)=>{const s=e.filter(l=>l.id===i.id);if(s.length===0)return n.push(i),n;const o={...i};for(const l of s)if(l)switch(l.type){case"select":{o.selected=l.selected;break}case"position":{typeof l.position<"u"&&(o.position=l.position),typeof l.positionAbsolute<"u"&&(o.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(o.dragging=l.dragging),o.expandParent&&kb(n,o);break}case"dimensions":{typeof l.dimensions<"u"&&(o.width=l.dimensions.width,o.height=l.dimensions.height),typeof l.updateStyle<"u"&&(o.style={...o.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(o.resizing=l.resizing),o.expandParent&&kb(n,o);break}case"remove":return n}return n.push(o),n},r)}function tE(e,t){return eE(e,t)}function ZO(e,t){return eE(e,t)}const Cn=(e,t)=>({id:e,type:"select",selected:t});function ns(e,t){return e.reduce((r,n)=>{const i=t.includes(n.id);return!n.selected&&i?(n.selected=!0,r.push(Cn(n.id,!0))):n.selected&&!i&&(n.selected=!1,r.push(Cn(n.id,!1))),r},[])}const od=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},JO=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),rE=m.memo(({isSelecting:e,selectionMode:t=na.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=xt(),x=m.useRef(0),g=m.useRef(0),_=m.useRef(),{userSelectionActive:v,elementsSelectable:y,dragging:b}=Ye(JO,Mt),w=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,g.current=0},k=$=>{s==null||s($),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},S=$=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){$.preventDefault();return}o==null||o($)},C=l?$=>l($):void 0,T=$=>{const{resetSelectedElements:N,domNode:D}=h.getState();if(_.current=D==null?void 0:D.getBoundingClientRect(),!y||!e||$.button!==0||$.target!==p.current||!_.current)return;const{x:I,y:F}=Un($,_.current);N(),h.setState({userSelectionRect:{width:0,height:0,startX:I,startY:F,x:I,y:F}}),n==null||n($)},j=$=>{const{userSelectionRect:N,nodeInternals:D,edges:I,transform:F,onNodesChange:P,onEdgesChange:A,nodeOrigin:L,getNodes:z}=h.getState();if(!e||!_.current||!N)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const B=Un($,_.current),X=N.startX??0,G=N.startY??0,W={...N,x:B.x<X?B.x:X,y:B.y<G?B.y:G,width:Math.abs(B.x-X),height:Math.abs(B.y-G)},q=z(),Q=DC(D,W,F,t===na.Partial,!0,L),ie=LC(Q,I).map(J=>J.id),oe=Q.map(J=>J.id);if(x.current!==oe.length){x.current=oe.length;const J=ns(q,oe);J.length&&(P==null||P(J))}if(g.current!==ie.length){g.current=ie.length;const J=ns(I,ie);J.length&&(A==null||A(J))}h.setState({userSelectionRect:W})},R=$=>{if($.button!==0)return;const{userSelectionRect:N}=h.getState();!v&&N&&$.target===p.current&&(k==null||k($)),h.setState({nodesSelectionActive:x.current>0}),w(),i==null||i($)},E=$=>{v&&(h.setState({nodesSelectionActive:x.current>0}),i==null||i($)),w()},M=y&&(e||v);return Y.createElement("div",{className:Yt(["react-flow__pane",{dragging:b,selection:e}]),onClick:M?void 0:od(k,p),onContextMenu:od(S,p),onWheel:od(C,p),onMouseEnter:M?void 0:c,onMouseDown:M?T:void 0,onMouseMove:M?j:d,onMouseUp:M?R:void 0,onMouseLeave:M?E:u,ref:p,style:Zx},f,Y.createElement(QO,null))});rE.displayName="Pane";function nE(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:nE(n,t):!1}function Nb(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function eD(e,t,r,n){return Array.from(e.values()).filter(i=>(i.selected||i.id===n)&&(!i.parentNode||i.parentId||!nE(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:r.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function tD(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function iE(e,t,r,n,i=[0,0],s){const o=tD(e,e.extent||n);let l=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=f&&hr(p)&&hr(h)&&hr(f.width)&&hr(f.height)?[[p+e.width*i[0],h+e.height*i[1]],[p+f.width-e.width+e.width*i[0],h+f.height-e.height+e.height*i[1]]]:l}else s==null||s("005",mn.error005()),l=o;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=r.get(c);d=xi(f,i).positionAbsolute}const u=l&&l!=="parent"?Ux(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function ad({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(i=>({...r.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?n.find(i=>i.id===e):n[0],n]}const Cb=(e,t,r,n)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),l={x:o.width*n[0],y:o.height*n[1]};return s.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-o.left-l.x)/r,y:(d.top-o.top-l.y)/r,...Wx(c)}})};function Js(e,t,r){return r===void 0?r:n=>{const i=t().nodeInternals.get(e);i&&r(n,{...i})}}function Ev({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",mn.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(r||d.selected&&o)&&(s({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=n==null?void 0:n.current)==null?void 0:u.blur()})):i([e])}function rD(){const e=xt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:i,snapToGrid:s}=e.getState(),o=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(o-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function ld(e){return(t,r,n)=>e==null?void 0:e(t,n)}function sE({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const l=xt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),x=m.useRef({x:0,y:0}),g=m.useRef(null),_=m.useRef(!1),v=m.useRef(!1),y=m.useRef(!1),b=rD();return m.useEffect(()=>{if(e!=null&&e.current){const w=fr(e.current),k=({x:T,y:j})=>{const{nodeInternals:R,onNodeDrag:E,onSelectionDrag:M,updateNodePositions:$,nodeExtent:N,snapGrid:D,snapToGrid:I,nodeOrigin:F,onError:P}=l.getState();f.current={x:T,y:j};let A=!1,L={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&N){const B=Xc(u.current,F);L=ra(B)}if(u.current=u.current.map(B=>{const X={x:T-B.distance.x,y:j-B.distance.y};I&&(X.x=D[0]*Math.round(X.x/D[0]),X.y=D[1]*Math.round(X.y/D[1]));const G=[[N[0][0],N[0][1]],[N[1][0],N[1][1]]];u.current.length>1&&N&&!B.extent&&(G[0][0]=B.positionAbsolute.x-L.x+N[0][0],G[1][0]=B.positionAbsolute.x+(B.width??0)-L.x2+N[1][0],G[0][1]=B.positionAbsolute.y-L.y+N[0][1],G[1][1]=B.positionAbsolute.y+(B.height??0)-L.y2+N[1][1]);const W=iE(B,X,R,G,F,P);return A=A||B.position.x!==W.position.x||B.position.y!==W.position.y,B.position=W.position,B.positionAbsolute=W.positionAbsolute,B}),!A)return;$(u.current,!0,!0),d(!0);const z=i?E:ld(M);if(z&&g.current){const[B,X]=ad({nodeId:i,dragItems:u.current,nodeInternals:R});z(g.current,B,X)}},S=()=>{if(!h.current)return;const[T,j]=kC(x.current,h.current);if(T!==0||j!==0){const{transform:R,panBy:E}=l.getState();f.current.x=(f.current.x??0)-T/R[2],f.current.y=(f.current.y??0)-j/R[2],E({x:T,y:j})&&k(f.current)}p.current=requestAnimationFrame(S)},C=T=>{var F;const{nodeInternals:j,multiSelectionActive:R,nodesDraggable:E,unselectNodesAndEdges:M,onNodeDragStart:$,onSelectionDragStart:N}=l.getState();v.current=!0;const D=i?$:ld(N);(!o||!s)&&!R&&i&&((F=j.get(i))!=null&&F.selected||M()),i&&s&&o&&Ev({id:i,store:l,nodeRef:e});const I=b(T);if(f.current=I,u.current=eD(j,E,I,i),D&&u.current){const[P,A]=ad({nodeId:i,dragItems:u.current,nodeInternals:j});D(T.sourceEvent,P,A)}};if(t)w.on(".drag",null);else{const T=pM().on("start",j=>{const{domNode:R,nodeDragThreshold:E}=l.getState();E===0&&C(j),y.current=!1;const M=b(j);f.current=M,h.current=(R==null?void 0:R.getBoundingClientRect())||null,x.current=Un(j.sourceEvent,h.current)}).on("drag",j=>{var $,N;const R=b(j),{autoPanOnNodeDrag:E,nodeDragThreshold:M}=l.getState();if(j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!_.current&&v.current&&E&&(_.current=!0,S()),!v.current){const D=R.xSnapped-((($=f==null?void 0:f.current)==null?void 0:$.x)??0),I=R.ySnapped-(((N=f==null?void 0:f.current)==null?void 0:N.y)??0);Math.sqrt(D*D+I*I)>M&&C(j)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&u.current&&v.current&&(g.current=j.sourceEvent,x.current=Un(j.sourceEvent,h.current),k(R))}}).on("end",j=>{if(!(!v.current||y.current)&&(d(!1),_.current=!1,v.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:R,nodeInternals:E,onNodeDragStop:M,onSelectionDragStop:$}=l.getState(),N=i?M:ld($);if(R(u.current,!1,!1),N){const[D,I]=ad({nodeId:i,dragItems:u.current,nodeInternals:E});N(j.sourceEvent,D,I)}}}).filter(j=>{const R=j.target;return!j.button&&(!r||!Nb(R,`.${r}`,e))&&(!n||Nb(R,n,e))});return w.call(T),()=>{w.on(".drag",null)}}}},[e,t,r,n,s,l,i,o,b]),c}function oE(){const e=xt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=o().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,x=r.isShiftPressed?4:1,g=r.x*p*x,_=r.y*h*x,v=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+g,y:y.positionAbsolute.y+_};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:w,position:k}=iE(y,b,n,i,void 0,d);y.position=k,y.positionAbsolute=w}return y});s(v,!0,!1)},[])}const hs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var eo=e=>{const t=({id:r,type:n,data:i,xPos:s,yPos:o,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:x,onDoubleClick:g,style:_,className:v,isDraggable:y,isSelectable:b,isConnectable:w,isFocusable:k,selectNodesOnDrag:S,sourcePosition:C,targetPosition:T,hidden:j,resizeObserver:R,dragHandle:E,zIndex:M,isParent:$,noDragClassName:N,noPanClassName:D,initialized:I,disableKeyboardA11y:F,ariaLabel:P,rfId:A,hasHandleBounds:L})=>{const z=xt(),B=m.useRef(null),X=m.useRef(null),G=m.useRef(C),W=m.useRef(T),q=m.useRef(n),Q=b||y||u||f||p||h,ie=oE(),oe=Js(r,z.getState,f),J=Js(r,z.getState,p),je=Js(r,z.getState,h),ge=Js(r,z.getState,x),we=Js(r,z.getState,g),xe=re=>{const{nodeDragThreshold:U}=z.getState();if(b&&(!S||!y||U>0)&&Ev({id:r,store:z,nodeRef:B}),u){const de=z.getState().nodeInternals.get(r);de&&u(re,{...de})}},se=re=>{if(!jv(re)&&!F)if(TC.includes(re.key)&&b){const U=re.key==="Escape";Ev({id:r,store:z,unselect:U,nodeRef:B})}else y&&d&&Object.prototype.hasOwnProperty.call(hs,re.key)&&(z.setState({ariaLiveMessage:`Moved selected node ${re.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),ie({x:hs[re.key].x,y:hs[re.key].y,isShiftPressed:re.shiftKey}))};m.useEffect(()=>()=>{X.current&&(R==null||R.unobserve(X.current),X.current=null)},[]),m.useEffect(()=>{if(B.current&&!j){const re=B.current;(!I||!L||X.current!==re)&&(X.current&&(R==null||R.unobserve(X.current)),R==null||R.observe(re),X.current=re)}},[j,I,L]),m.useEffect(()=>{const re=q.current!==n,U=G.current!==C,de=W.current!==T;B.current&&(re||U||de)&&(re&&(q.current=n),U&&(G.current=C),de&&(W.current=T),z.getState().updateNodeDimensions([{id:r,nodeElement:B.current,forceUpdate:!0}]))},[r,n,C,T]);const K=sE({nodeRef:B,disabled:j||!y,noDragClassName:N,handleSelector:E,nodeId:r,isSelectable:b,selectNodesOnDrag:S});return j?null:Y.createElement("div",{className:Yt(["react-flow__node",`react-flow__node-${n}`,{[D]:y},v,{selected:d,selectable:b,parent:$,dragging:K}]),ref:B,style:{zIndex:M,transform:`translate(${l}px,${c}px)`,pointerEvents:Q?"all":"none",visibility:I?"visible":"hidden",..._},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:oe,onMouseMove:J,onMouseLeave:je,onContextMenu:ge,onClick:xe,onDoubleClick:we,onKeyDown:k?se:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":F?void 0:`${YC}-${A}`,"aria-label":P},Y.createElement(gO,{value:r},Y.createElement(e,{id:r,data:i,type:n,xPos:s,yPos:o,selected:d,isConnectable:w,sourcePosition:C,targetPosition:T,dragging:K,dragHandle:E,zIndex:M})))};return t.displayName="NodeWrapper",m.memo(t)};const nD=e=>{const t=e.getNodes().filter(r=>r.selected);return{...Xc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function iD({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=xt(),{width:i,height:s,x:o,y:l,transformString:c,userSelectionActive:d}=Ye(nD,Mt),u=oE(),f=m.useRef(null);if(m.useEffect(()=>{var x;r||(x=f.current)==null||x.focus({preventScroll:!0})},[r]),sE({nodeRef:f}),d||!i||!s)return null;const p=e?x=>{const g=n.getState().getNodes().filter(_=>_.selected);e(x,g)}:void 0,h=x=>{Object.prototype.hasOwnProperty.call(hs,x.key)&&u({x:hs[x.key].x,y:hs[x.key].y,isShiftPressed:x.shiftKey})};return Y.createElement("div",{className:Yt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},Y.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:i,height:s,top:l,left:o}}))}var sD=m.memo(iD);const oD=e=>e.nodesSelectionActive,aE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:x,onSelectionEnd:g,multiSelectionKeyCode:_,panActivationKeyCode:v,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:k,panOnScroll:S,panOnScrollSpeed:C,panOnScrollMode:T,zoomOnDoubleClick:j,panOnDrag:R,defaultViewport:E,translateExtent:M,minZoom:$,maxZoom:N,preventScrolling:D,onSelectionContextMenu:I,noWheelClassName:F,noPanClassName:P,disableKeyboardA11y:A})=>{const L=Ye(oD),z=ia(f),B=ia(v),X=B||R,G=B||S,W=z||p&&X!==!0;return UO({deleteKeyCode:l,multiSelectionKeyCode:_}),Y.createElement(YO,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:k,panOnScroll:G,panOnScrollSpeed:C,panOnScrollMode:T,zoomOnDoubleClick:j,panOnDrag:!z&&X,defaultViewport:E,translateExtent:M,minZoom:$,maxZoom:N,zoomActivationKeyCode:y,preventScrolling:D,noWheelClassName:F,noPanClassName:P},Y.createElement(rE,{onSelectionStart:x,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:X,isSelecting:!!W,selectionMode:h},e,L&&Y.createElement(sD,{onSelectionContextMenu:I,noPanClassName:P,disableKeyboardA11y:A})))};aE.displayName="FlowRenderer";var aD=m.memo(aE);function lD(e){return Ye(m.useCallback(r=>e?DC(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function cD(e){const t={input:eo(e.input||UC),default:eo(e.default||Cv),output:eo(e.output||GC),group:eo(e.group||Qx)},r={},n=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=eo(e[s]||Cv),i),r);return{...t,...n}}const uD=({x:e,y:t,width:r,height:n,origin:i})=>!r||!n?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-r*i[0],y:t-n*i[1]},dD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),lE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Ye(dD,Mt),l=lD(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));s(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),Y.createElement("div",{className:"react-flow__nodes",style:Zx},l.map(u=>{var k,S,C;let f=u.type||"default";e.nodeTypes[f]||(o==null||o("003",mn.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),x=!!(u.selectable||i&&typeof u.selectable>"u"),g=!!(u.connectable||r&&typeof u.connectable>"u"),_=!!(u.focusable||n&&typeof u.focusable>"u"),v=e.nodeExtent?Ux(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(v==null?void 0:v.x)??0,b=(v==null?void 0:v.y)??0,w=uD({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return Y.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||ue.Bottom,targetPosition:u.targetPosition||ue.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:w.x,yPosOrigin:w.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:x,isConnectable:g,isFocusable:_,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((k=u[rt])==null?void 0:k.z)??0,isParent:!!((S=u[rt])!=null&&S.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((C=u[rt])!=null&&C.handleBounds)})}))};lE.displayName="NodeRenderer";var fD=m.memo(lE);const pD=(e,t,r)=>r===ue.Left?e-t:r===ue.Right?e+t:e,hD=(e,t,r)=>r===ue.Top?e-t:r===ue.Bottom?e+t:e,Eb="react-flow__edgeupdater",Tb=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:l})=>Y.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Yt([Eb,`${Eb}-${l}`]),cx:pD(t,n,e),cy:hD(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),mD=()=>!0;var Fi=e=>{const t=({id:r,className:n,type:i,data:s,onClick:o,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:g,style:_,source:v,target:y,sourceX:b,sourceY:w,targetX:k,targetY:S,sourcePosition:C,targetPosition:T,elementsSelectable:j,hidden:R,sourceHandleId:E,targetHandleId:M,onContextMenu:$,onMouseEnter:N,onMouseMove:D,onMouseLeave:I,reconnectRadius:F,onReconnect:P,onReconnectStart:A,onReconnectEnd:L,markerEnd:z,markerStart:B,rfId:X,ariaLabel:G,isFocusable:W,isReconnectable:q,pathOptions:Q,interactionWidth:ie,disableKeyboardA11y:oe})=>{const J=m.useRef(null),[je,ge]=m.useState(!1),[we,xe]=m.useState(!1),se=xt(),K=m.useMemo(()=>`url('#${kv(B,X)}')`,[B,X]),re=m.useMemo(()=>`url('#${kv(z,X)}')`,[z,X]);if(R)return null;const U=Ae=>{var bt;const{edges:Z,addSelectedEdges:Ce,unselectNodesAndEdges:ve,multiSelectionActive:Ct}=se.getState(),yt=Z.find(Qt=>Qt.id===r);yt&&(j&&(se.setState({nodesSelectionActive:!1}),yt.selected&&Ct?(ve({nodes:[],edges:[yt]}),(bt=J.current)==null||bt.blur()):Ce([r])),o&&o(Ae,yt))},de=Zs(r,se.getState,l),fe=Zs(r,se.getState,$),me=Zs(r,se.getState,N),ye=Zs(r,se.getState,D),ee=Zs(r,se.getState,I),he=(Ae,Z)=>{if(Ae.button!==0)return;const{edges:Ce,isValidConnection:ve}=se.getState(),Ct=Z?y:v,yt=(Z?M:E)||null,bt=Z?"target":"source",Qt=ve||mD,O=Z,H=Ce.find(Le=>Le.id===r);xe(!0),A==null||A(Ae,H,bt);const V=Le=>{xe(!1),L==null||L(Le,H,bt)};qC({event:Ae,handleId:yt,nodeId:Ct,onConnect:Le=>P==null?void 0:P(H,Le),isTarget:O,getState:se.getState,setState:se.setState,isValidConnection:Qt,edgeUpdaterType:bt,onReconnectEnd:V})},De=Ae=>he(Ae,!0),nt=Ae=>he(Ae,!1),Re=()=>ge(!0),Me=()=>ge(!1),Be=!j&&!o,et=Ae=>{var Z;if(!oe&&TC.includes(Ae.key)&&j){const{unselectNodesAndEdges:Ce,addSelectedEdges:ve,edges:Ct}=se.getState();Ae.key==="Escape"?((Z=J.current)==null||Z.blur(),Ce({edges:[Ct.find(bt=>bt.id===r)]})):ve([r])}};return Y.createElement("g",{className:Yt(["react-flow__edge",`react-flow__edge-${i}`,n,{selected:c,animated:d,inactive:Be,updating:je}]),onClick:U,onDoubleClick:de,onContextMenu:fe,onMouseEnter:me,onMouseMove:ye,onMouseLeave:ee,onKeyDown:W?et:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":G===null?void 0:G||`Edge from ${v} to ${y}`,"aria-describedby":W?`${XC}-${X}`:void 0,ref:J},!we&&Y.createElement(e,{id:r,source:v,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:g,data:s,style:_,sourceX:b,sourceY:w,targetX:k,targetY:S,sourcePosition:C,targetPosition:T,sourceHandleId:E,targetHandleId:M,markerStart:K,markerEnd:re,pathOptions:Q,interactionWidth:ie}),q&&Y.createElement(Y.Fragment,null,(q==="source"||q===!0)&&Y.createElement(Tb,{position:C,centerX:b,centerY:w,radius:F,onMouseDown:De,onMouseEnter:Re,onMouseOut:Me,type:"source"}),(q==="target"||q===!0)&&Y.createElement(Tb,{position:T,centerX:k,centerY:S,radius:F,onMouseDown:nt,onMouseEnter:Re,onMouseOut:Me,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function gD(e){const t={default:Fi(e.default||cc),straight:Fi(e.bezier||Kx),step:Fi(e.step||Gx),smoothstep:Fi(e.step||Yc),simplebezier:Fi(e.simplebezier||Vx)},r={},n=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Fi(e[s]||cc),i),r);return{...t,...n}}function Rb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,i=((r==null?void 0:r.y)||0)+t.y,s=(r==null?void 0:r.width)||t.width,o=(r==null?void 0:r.height)||t.height;switch(e){case ue.Top:return{x:n+s/2,y:i};case ue.Right:return{x:n+s,y:i+o/2};case ue.Bottom:return{x:n+s/2,y:i+o};case ue.Left:return{x:n,y:i+o/2}}}function Ab(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const vD=(e,t,r,n,i,s)=>{const o=Rb(r,e,t),l=Rb(s,n,i);return{sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y}};function xD({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:i,targetHeight:s,width:o,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+i),y2:Math.max(e.y+n,t.y+s)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=ra({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Ib(e){var n,i,s,o,l;const t=((n=e==null?void 0:e[rt])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const yD=[{level:0,isMaxLevel:!0,edges:[]}];function bD(e,t,r=!1){let n=-1;const i=e.reduce((o,l)=>{var u,f;const c=hr(l.zIndex);let d=c?l.zIndex:0;if(r){const p=t.get(l.target),h=t.get(l.source),x=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),g=Math.max(((u=h==null?void 0:h[rt])==null?void 0:u.z)||0,((f=p==null?void 0:p[rt])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(x?g:0)}return o[d]?o[d].push(l):o[d]=[l],n=d>n?d:n,o},{}),s=Object.entries(i).map(([o,l])=>{const c=+o;return{edges:l,level:c,isMaxLevel:c===n}});return s.length===0?yD:s}function _D(e,t,r){const n=Ye(m.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),l=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&xD({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:l.width,targetHeight:l.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return bD(n,t,r)}const wD=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),jD=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Mb={[lc.Arrow]:wD,[lc.ArrowClosed]:jD};function SD(e){const t=xt();return m.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Mb,e)?Mb[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",mn.error009(e)),null)},[e])}const kD=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const c=SD(t);return c?Y.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0"},Y.createElement(c,{color:r,strokeWidth:o})):null},ND=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const l=kv(o,t);n.includes(l)||(i.push({id:l,color:o.color||e,...o}),n.push(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},cE=({defaultColor:e,rfId:t})=>{const r=Ye(m.useCallback(ND({defaultColor:e,rfId:t}),[e,t]),(n,i)=>!(n.length!==i.length||n.some((s,o)=>s.id!==i[o].id)));return Y.createElement("defs",null,r.map(n=>Y.createElement(kD,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};cE.displayName="MarkerDefinitions";var CD=m.memo(cE);const ED=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),uE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:g,children:_,disableKeyboardA11y:v})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:w,width:k,height:S,connectionMode:C,nodeInternals:T,onError:j}=Ye(ED,Mt),R=_D(t,T,r);return k?Y.createElement(Y.Fragment,null,R.map(({level:E,edges:M,isMaxLevel:$})=>Y.createElement("svg",{key:E,style:{zIndex:E},width:k,height:S,className:"react-flow__edges react-flow__container"},$&&Y.createElement(CD,{defaultColor:e,rfId:n}),Y.createElement("g",null,M.map(N=>{const[D,I,F]=Ib(T.get(N.source)),[P,A,L]=Ib(T.get(N.target));if(!F||!L)return null;let z=N.type||"default";i[z]||(j==null||j("011",mn.error011(z)),z="default");const B=i[z]||i.default,X=C===Ni.Strict?A.target:(A.target??[]).concat(A.source??[]),G=Ab(I.source,N.sourceHandle),W=Ab(X,N.targetHandle),q=(G==null?void 0:G.position)||ue.Bottom,Q=(W==null?void 0:W.position)||ue.Top,ie=!!(N.focusable||y&&typeof N.focusable>"u"),oe=N.reconnectable||N.updatable,J=typeof p<"u"&&(oe||b&&typeof oe>"u");if(!G||!W)return j==null||j("008",mn.error008(G,N)),null;const{sourceX:je,sourceY:ge,targetX:we,targetY:xe}=vD(D,G,q,P,W,Q);return Y.createElement(B,{key:N.id,id:N.id,className:Yt([N.className,s]),type:z,data:N.data,selected:!!N.selected,animated:!!N.animated,hidden:!!N.hidden,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,style:N.style,source:N.source,target:N.target,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerEnd:N.markerEnd,markerStart:N.markerStart,sourceX:je,sourceY:ge,targetX:we,targetY:xe,sourcePosition:q,targetPosition:Q,elementsSelectable:w,onContextMenu:o,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:g,rfId:n,ariaLabel:N.ariaLabel,isFocusable:ie,isReconnectable:J,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth,disableKeyboardA11y:v})})))),_):null};uE.displayName="EdgeRenderer";var TD=m.memo(uE);const RD=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function AD({children:e}){const t=Ye(RD);return Y.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function ID(e){const t=Qc(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const MD={[ue.Left]:ue.Right,[ue.Right]:ue.Left,[ue.Top]:ue.Bottom,[ue.Bottom]:ue.Top},dE=({nodeId:e,handleType:t,style:r,type:n=An.Bezier,CustomComponent:i,connectionStatus:s})=>{var S,C,T;const{fromNode:o,handleId:l,toX:c,toY:d,connectionMode:u}=Ye(m.useCallback(j=>({fromNode:j.nodeInternals.get(e),handleId:j.connectionHandleId,toX:(j.connectionPosition.x-j.transform[0])/j.transform[2],toY:(j.connectionPosition.y-j.transform[1])/j.transform[2],connectionMode:j.connectionMode}),[e]),Mt),f=(S=o==null?void 0:o[rt])==null?void 0:S.handleBounds;let p=f==null?void 0:f[t];if(u===Ni.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!o||!p)return null;const h=l?p.find(j=>j.id===l):p[0],x=h?h.x+h.width/2:(o.width??0)/2,g=h?h.y+h.height/2:o.height??0,_=(((C=o.positionAbsolute)==null?void 0:C.x)??0)+x,v=(((T=o.positionAbsolute)==null?void 0:T.y)??0)+g,y=h==null?void 0:h.position,b=y?MD[y]:null;if(!y||!b)return null;if(i)return Y.createElement(i,{connectionLineType:n,connectionLineStyle:r,fromNode:o,fromHandle:h,fromX:_,fromY:v,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:s});let w="";const k={sourceX:_,sourceY:v,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return n===An.Bezier?[w]=PC(k):n===An.Step?[w]=Sv({...k,borderRadius:0}):n===An.SmoothStep?[w]=Sv(k):n===An.SimpleBezier?[w]=MC(k):w=`M${_},${v} ${c},${d}`,Y.createElement("path",{d:w,fill:"none",className:"react-flow__connection-path",style:r})};dE.displayName="ConnectionLine";const PD=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function OD({containerStyle:e,style:t,type:r,component:n}){const{nodeId:i,handleType:s,nodesConnectable:o,width:l,height:c,connectionStatus:d}=Ye(PD,Mt);return!(i&&s&&l&&o)?null:Y.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},Y.createElement("g",{className:Yt(["react-flow__connection",d])},Y.createElement(dE,{nodeId:i,handleType:s,style:t,type:r,CustomComponent:n,connectionStatus:d})))}function Pb(e,t){return m.useRef(null),xt(),m.useMemo(()=>t(e),[e])}const fE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:x,onSelectionStart:g,onSelectionEnd:_,connectionLineType:v,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:w,selectionKeyCode:k,selectionOnDrag:S,selectionMode:C,multiSelectionKeyCode:T,panActivationKeyCode:j,zoomActivationKeyCode:R,deleteKeyCode:E,onlyRenderVisibleElements:M,elementsSelectable:$,selectNodesOnDrag:N,defaultViewport:D,translateExtent:I,minZoom:F,maxZoom:P,preventScrolling:A,defaultMarkerColor:L,zoomOnScroll:z,zoomOnPinch:B,panOnScroll:X,panOnScrollSpeed:G,panOnScrollMode:W,zoomOnDoubleClick:q,panOnDrag:Q,onPaneClick:ie,onPaneMouseEnter:oe,onPaneMouseMove:J,onPaneMouseLeave:je,onPaneScroll:ge,onPaneContextMenu:we,onEdgeContextMenu:xe,onEdgeMouseEnter:se,onEdgeMouseMove:K,onEdgeMouseLeave:re,onReconnect:U,onReconnectStart:de,onReconnectEnd:fe,reconnectRadius:me,noDragClassName:ye,noWheelClassName:ee,noPanClassName:he,elevateEdgesOnSelect:De,disableKeyboardA11y:nt,nodeOrigin:Re,nodeExtent:Me,rfId:Be})=>{const et=Pb(e,cD),Ae=Pb(t,gD);return ID(s),Y.createElement(aD,{onPaneClick:ie,onPaneMouseEnter:oe,onPaneMouseMove:J,onPaneMouseLeave:je,onPaneContextMenu:we,onPaneScroll:ge,deleteKeyCode:E,selectionKeyCode:k,selectionOnDrag:S,selectionMode:C,onSelectionStart:g,onSelectionEnd:_,multiSelectionKeyCode:T,panActivationKeyCode:j,zoomActivationKeyCode:R,elementsSelectable:$,onMove:r,onMoveStart:n,onMoveEnd:i,zoomOnScroll:z,zoomOnPinch:B,zoomOnDoubleClick:q,panOnScroll:X,panOnScrollSpeed:G,panOnScrollMode:W,panOnDrag:Q,defaultViewport:D,translateExtent:I,minZoom:F,maxZoom:P,onSelectionContextMenu:x,preventScrolling:A,noDragClassName:ye,noWheelClassName:ee,noPanClassName:he,disableKeyboardA11y:nt},Y.createElement(AD,null,Y.createElement(TD,{edgeTypes:Ae,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:M,onEdgeContextMenu:xe,onEdgeMouseEnter:se,onEdgeMouseMove:K,onEdgeMouseLeave:re,onReconnect:U,onReconnectStart:de,onReconnectEnd:fe,reconnectRadius:me,defaultMarkerColor:L,noPanClassName:he,elevateEdgesOnSelect:!!De,disableKeyboardA11y:nt,rfId:Be},Y.createElement(OD,{style:y,type:v,component:b,containerStyle:w})),Y.createElement("div",{className:"react-flow__edgelabel-renderer"}),Y.createElement(fD,{nodeTypes:et,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:N,onlyRenderVisibleElements:M,noPanClassName:he,noDragClassName:ye,disableKeyboardA11y:nt,nodeOrigin:Re,nodeExtent:Me,rfId:Be})))};fE.displayName="GraphView";var DD=m.memo(fE);const Tv=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Tv,nodeExtent:Tv,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ni.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:uO,isValidConnection:void 0},LD=()=>k5((e,t)=>({...wn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:sd(r,n,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(i=>({...n,...i}))})},setDefaultNodesAndEdges:(r,n)=>{const i=typeof r<"u",s=typeof n<"u",o=i?sd(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?n:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((g,_)=>{const v=i.get(_.id);if(v!=null&&v.hidden)i.set(v.id,{...v,[rt]:{...v[rt],handleBounds:void 0}});else if(v){const y=Wx(_.nodeElement);!!(y.width&&y.height&&(v.width!==y.width||v.height!==y.height||_.forceUpdate))&&(i.set(v.id,{...v,[rt]:{...v[rt],handleBounds:{source:Cb(".source",_.nodeElement,p,d),target:Cb(".target",_.nodeElement,p,d)}},...y}),g.push({id:v.id,type:"dimensions",dimensions:y}))}return g},[]);ZC(i,d);const x=o||s&&!o&&JC(t,{initial:!0,...l});e({nodeInternals:new Map(i),fitViewOnInitDone:x}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=r.map(l=>{const c={id:l.id,type:"position",dragging:i};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});s(o)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(s){const d=tE(r,l()),u=sd(d,i,o,c);e({nodeInternals:u})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Cn(c,!0)):(o=ns(s(),r),l=ns(i,[])),el({changedNodes:o,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Cn(c,!0)):(o=ns(i,r),l=ns(s(),[])),el({changedNodes:l,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:i,getNodes:s}=t(),o=r||s(),l=n||i,c=o.map(u=>(u.selected=!1,Cn(u.id,!1))),d=l.map(u=>Cn(u.id,!1));el({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:i}=t();n==null||n.scaleExtent([r,i]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:i}=t();n==null||n.scaleExtent([i,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),s=n().filter(l=>l.selected).map(l=>Cn(l.id,!1)),o=r.filter(l=>l.selected).map(l=>Cn(l.id,!1));el({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(i=>{i.positionAbsolute=Ux(i.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:i,height:s,d3Zoom:o,d3Selection:l,translateExtent:c}=t();if(!o||!l||!r.x&&!r.y)return!1;const d=cn.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),u=[[0,0],[i,s]],f=o==null?void 0:o.constrain()(d,u,c);return o.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wn.connectionNodeId,connectionHandleId:wn.connectionHandleId,connectionHandleType:wn.connectionHandleType,connectionStatus:wn.connectionStatus,connectionStartHandle:wn.connectionStartHandle,connectionEndHandle:wn.connectionEndHandle}),reset:()=>e({...wn})}),Object.is),Zc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=LD()),Y.createElement(nO,{value:t.current},e)};Zc.displayName="ReactFlowProvider";const pE=({children:e})=>m.useContext(Kc)?Y.createElement(Y.Fragment,null,e):Y.createElement(Zc,null,e);pE.displayName="ReactFlowWrapper";const FD={input:UC,default:Cv,output:GC,group:Qx},zD={default:cc,straight:Kx,step:Gx,smoothstep:Yc,simplebezier:Vx},$D=[0,0],qD=[15,15],BD={x:0,y:0,zoom:1},HD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Jx=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:s=FD,edgeTypes:o=zD,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:x,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:v,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:S,onNodeDragStart:C,onNodeDrag:T,onNodeDragStop:j,onNodesDelete:R,onEdgesDelete:E,onSelectionChange:M,onSelectionDragStart:$,onSelectionDrag:N,onSelectionDragStop:D,onSelectionContextMenu:I,onSelectionStart:F,onSelectionEnd:P,connectionMode:A=Ni.Strict,connectionLineType:L=An.Bezier,connectionLineStyle:z,connectionLineComponent:B,connectionLineContainerStyle:X,deleteKeyCode:G="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:q=!1,selectionMode:Q=na.Full,panActivationKeyCode:ie="Space",multiSelectionKeyCode:oe=ac()?"Meta":"Control",zoomActivationKeyCode:J=ac()?"Meta":"Control",snapToGrid:je=!1,snapGrid:ge=qD,onlyRenderVisibleElements:we=!1,selectNodesOnDrag:xe=!0,nodesDraggable:se,nodesConnectable:K,nodesFocusable:re,nodeOrigin:U=$D,edgesFocusable:de,edgesUpdatable:fe,elementsSelectable:me,defaultViewport:ye=BD,minZoom:ee=.5,maxZoom:he=2,translateExtent:De=Tv,preventScrolling:nt=!0,nodeExtent:Re,defaultMarkerColor:Me="#b1b1b7",zoomOnScroll:Be=!0,zoomOnPinch:et=!0,panOnScroll:Ae=!1,panOnScrollSpeed:Z=.5,panOnScrollMode:Ce=pi.Free,zoomOnDoubleClick:ve=!0,panOnDrag:Ct=!0,onPaneClick:yt,onPaneMouseEnter:bt,onPaneMouseMove:Qt,onPaneMouseLeave:O,onPaneScroll:H,onPaneContextMenu:V,children:ne,onEdgeContextMenu:Le,onEdgeDoubleClick:ct,onEdgeMouseEnter:ar,onEdgeMouseMove:Et,onEdgeMouseLeave:_t,onEdgeUpdate:$t,onEdgeUpdateStart:Or,onEdgeUpdateEnd:it,onReconnect:le,onReconnectStart:ce,onReconnectEnd:We,reconnectRadius:br=10,edgeUpdaterRadius:ri=10,onNodesChange:Dr,onEdgesChange:ni,noDragClassName:qs="nodrag",noWheelClassName:dR="nowheel",noPanClassName:Py="nopan",fitView:fR=!1,fitViewOptions:pR,connectOnClick:hR=!0,attributionPosition:mR,proOptions:gR,defaultEdgeOptions:vR,elevateNodesOnSelect:xR=!0,elevateEdgesOnSelect:yR=!1,disableKeyboardA11y:Oy=!1,autoPanOnConnect:bR=!0,autoPanOnNodeDrag:_R=!0,connectionRadius:wR=20,isValidConnection:jR,onError:SR,style:kR,id:Dy,nodeDragThreshold:NR,...CR},ER)=>{const Nu=Dy||"1";return Y.createElement("div",{...CR,style:{...kR,...HD},ref:ER,className:Yt(["react-flow",i]),"data-testid":"rf__wrapper",id:Dy},Y.createElement(pE,null,Y.createElement(DD,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:S,nodeTypes:s,edgeTypes:o,connectionLineType:L,connectionLineStyle:z,connectionLineComponent:B,connectionLineContainerStyle:X,selectionKeyCode:W,selectionOnDrag:q,selectionMode:Q,deleteKeyCode:G,multiSelectionKeyCode:oe,panActivationKeyCode:ie,zoomActivationKeyCode:J,onlyRenderVisibleElements:we,selectNodesOnDrag:xe,defaultViewport:ye,translateExtent:De,minZoom:ee,maxZoom:he,preventScrolling:nt,zoomOnScroll:Be,zoomOnPinch:et,zoomOnDoubleClick:ve,panOnScroll:Ae,panOnScrollSpeed:Z,panOnScrollMode:Ce,panOnDrag:Ct,onPaneClick:yt,onPaneMouseEnter:bt,onPaneMouseMove:Qt,onPaneMouseLeave:O,onPaneScroll:H,onPaneContextMenu:V,onSelectionContextMenu:I,onSelectionStart:F,onSelectionEnd:P,onEdgeContextMenu:Le,onEdgeDoubleClick:ct,onEdgeMouseEnter:ar,onEdgeMouseMove:Et,onEdgeMouseLeave:_t,onReconnect:le??$t,onReconnectStart:ce??Or,onReconnectEnd:We??it,reconnectRadius:br??ri,defaultMarkerColor:Me,noDragClassName:qs,noWheelClassName:dR,noPanClassName:Py,elevateEdgesOnSelect:yR,rfId:Nu,disableKeyboardA11y:Oy,nodeOrigin:U,nodeExtent:Re}),Y.createElement(MO,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:x,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:v,nodesDraggable:se,nodesConnectable:K,nodesFocusable:re,edgesFocusable:de,edgesUpdatable:fe,elementsSelectable:me,elevateNodesOnSelect:xR,minZoom:ee,maxZoom:he,nodeExtent:Re,onNodesChange:Dr,onEdgesChange:ni,snapToGrid:je,snapGrid:ge,connectionMode:A,translateExtent:De,connectOnClick:hR,defaultEdgeOptions:vR,fitView:fR,fitViewOptions:pR,onNodesDelete:R,onEdgesDelete:E,onNodeDragStart:C,onNodeDrag:T,onNodeDragStop:j,onSelectionDrag:N,onSelectionDragStart:$,onSelectionDragStop:D,noPanClassName:Py,nodeOrigin:U,rfId:Nu,autoPanOnConnect:bR,autoPanOnNodeDrag:_R,onError:SR,connectionRadius:wR,isValidConnection:jR,nodeDragThreshold:NR}),Y.createElement(AO,{onSelectionChange:M}),ne,Y.createElement(sO,{proOptions:gR,position:mR}),Y.createElement(FO,{rfId:Nu,disableKeyboardA11y:Oy})))});Jx.displayName="ReactFlow";function hE(e){return t=>{const[r,n]=m.useState(t),i=m.useCallback(s=>n(o=>e(s,o)),[]);return[r,n,i]}}const mE=hE(tE),gE=hE(ZO),vE=({id:e,x:t,y:r,width:n,height:i,style:s,color:o,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:x,backgroundColor:g}=s||{},_=o||x||g;return Y.createElement("rect",{className:Yt(["react-flow__minimap-node",{selected:h},d]),x:t,y:r,rx:u,ry:u,width:n,height:i,fill:_,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?v=>p(v,e):void 0})};vE.displayName="MiniMapNode";var WD=m.memo(vE);const UD=e=>e.nodeOrigin,VD=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),cd=e=>e instanceof Function?e:()=>e;function GD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i=2,nodeComponent:s=WD,onClick:o}){const l=Ye(VD,Mt),c=Ye(UD),d=cd(t),u=cd(e),f=cd(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Y.createElement(Y.Fragment,null,l.map(h=>{const{x,y:g}=xi(h,c).positionAbsolute;return Y.createElement(s,{key:h.id,x,y:g,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:n,strokeColor:u(h),strokeWidth:i,shapeRendering:p,onClick:o,id:h.id})}))}var KD=m.memo(GD);const YD=200,XD=150,QD=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?lO(Xc(t,e.nodeOrigin),r):r,rfId:e.rfId}},ZD="react-flow__minimap-desc";function xE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:x=!1,zoomable:g=!1,ariaLabel:_="React Flow mini map",inversePan:v=!1,zoomStep:y=10,offsetScale:b=5}){const w=xt(),k=m.useRef(null),{boundingRect:S,viewBB:C,rfId:T}=Ye(QD,Mt),j=(e==null?void 0:e.width)??YD,R=(e==null?void 0:e.height)??XD,E=S.width/j,M=S.height/R,$=Math.max(E,M),N=$*j,D=$*R,I=b*$,F=S.x-(N-S.width)/2-I,P=S.y-(D-S.height)/2-I,A=N+I*2,L=D+I*2,z=`${ZD}-${T}`,B=m.useRef(0);B.current=$,m.useEffect(()=>{if(k.current){const W=fr(k.current),q=oe=>{const{transform:J,d3Selection:je,d3Zoom:ge}=w.getState();if(oe.sourceEvent.type!=="wheel"||!je||!ge)return;const we=-oe.sourceEvent.deltaY*(oe.sourceEvent.deltaMode===1?.05:oe.sourceEvent.deltaMode?1:.002)*y,xe=J[2]*Math.pow(2,we);ge.scaleTo(je,xe)},Q=oe=>{const{transform:J,d3Selection:je,d3Zoom:ge,translateExtent:we,width:xe,height:se}=w.getState();if(oe.sourceEvent.type!=="mousemove"||!je||!ge)return;const K=B.current*Math.max(1,J[2])*(v?-1:1),re={x:J[0]-oe.sourceEvent.movementX*K,y:J[1]-oe.sourceEvent.movementY*K},U=[[0,0],[xe,se]],de=cn.translate(re.x,re.y).scale(J[2]),fe=ge.constrain()(de,U,we);ge.transform(je,fe)},ie=jC().on("zoom",x?Q:null).on("zoom.wheel",g?q:null);return W.call(ie),()=>{W.on("zoom",null)}}},[x,g,v,y]);const X=p?W=>{const q=kr(W);p(W,{x:q[0],y:q[1]})}:void 0,G=h?(W,q)=>{const Q=w.getState().nodeInternals.get(q);h(W,Q)}:void 0;return Y.createElement(Wn,{position:f,style:e,className:Yt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},Y.createElement("svg",{width:j,height:R,viewBox:`${F} ${P} ${A} ${L}`,role:"img","aria-labelledby":z,ref:k,onClick:X},_&&Y.createElement("title",{id:z},_),Y.createElement(KD,{onClick:G,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:l}),Y.createElement("path",{className:"react-flow__minimap-mask",d:`M${F-I},${P-I}h${A+I*2}v${L+I*2}h${-A-I*2}z
        M${C.x},${C.y}h${C.width}v${C.height}h${-C.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}xE.displayName="MiniMap";var yE=m.memo(xE);const rl={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},JD=180,e6=400,t6=260,r6=48;function n6(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function i6({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:i,onToggleShowArchived:s,userSection:o}){const[l,c]=m.useState(!1),[d,u]=m.useState(t6),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null);m.useEffect(()=>{x.current&&x.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((k,S)=>{const C=(k.name||"").localeCompare(S.name||"");return C!==0?C:(k.projectId||"").localeCompare(S.projectId||"")}),[e]),_=()=>{n()},v=m.useCallback(k=>{k.preventDefault(),p(!0)},[]),y=m.useCallback(k=>{if(!f)return;const S=Math.min(e6,Math.max(JD,k.clientX));u(S)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const w=l?r6:d;return a.jsxs("div",{ref:h,className:"h-full flex flex-col relative",onWheel:k=>k.stopPropagation(),style:{width:w,minWidth:w,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[a.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),a.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:i?"#f59e0b":"var(--text-muted)"},title:i?"Hide archived":"Show archived",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),a.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:a.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(k=>{const S=t===k.id;return a.jsxs("div",{ref:S?x:null,onClick:()=>r(k.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:S?"var(--state-active-bg)":"transparent",border:S?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:S?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:S?"#ffffff":rl[k.status]||rl.queued}}),a.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:S?"#ffffff":"var(--text-primary)"},children:k.name}),k.isArchived&&a.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:S?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[a.jsx("span",{className:"text-[10px] font-mono",style:{color:S?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:k.projectId}),a.jsx("span",{className:"text-[10px]",style:{color:S?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:n6(k.createdAt)})]})]},k.id)})}),l&&a.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(k=>a.jsx("div",{onClick:()=>r(k.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:k.name,children:a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:rl[k.status]||rl.queued,boxShadow:t===k.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},k.id))}),!l&&a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:_,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),a.jsx("span",{children:"New Project"})]})}),l&&a.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:_,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),o,!l&&a.jsx("div",{onMouseDown:v,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function s6({stations:e}){if(!(e!=null&&e.length))return null;const t=e.reduce((s,o,l)=>o.state==="complete"?l:s,-1),r=e.findIndex(s=>s.state==="active"),n=e.find(s=>s.state==="active"),i=n==null?void 0:n.currentStep;return a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"relative flex items-start",children:[a.jsx("div",{className:"absolute h-0.5 left-0 right-0",style:{top:5,background:"var(--state-queued-bg)"}}),t>=0&&a.jsx("div",{className:"absolute h-0.5 left-0",style:{top:5,width:`${(t+.5)/e.length*100}%`,background:"var(--state-stabilized-bg)"}}),r>=0&&a.jsx("div",{className:"absolute h-0.5",style:{top:5,left:t>=0?`${(t+.5)/e.length*100}%`:"0%",width:t>=0?`${(r-t)/e.length*100}%`:`${(r+.5)/e.length*100}%`,background:"var(--state-active-bg)"}}),e.map(s=>{const o=s.state==="active",c=s.state==="complete"?"var(--state-stabilized-bg)":o?"var(--state-active-bg)":s.state==="failed"?"var(--state-blocked-bg)":"var(--state-queued-bg)",d=o?"var(--state-active-text)":"var(--text-muted)";return a.jsxs("div",{className:"flex-1 flex flex-col items-center relative z-10",children:[a.jsx("div",{className:`w-3 h-3 rounded-full${o?" station-active":""}${o&&s.needs_input?" station-needs-input":""}`,style:{background:c,boxShadow:o&&s.needs_input?"0 0 0 2px var(--state-active-bg)":void 0}}),a.jsx("span",{className:"text-[7px] mt-0.5",style:{color:o&&s.needs_input?"var(--state-active-text)":d,fontWeight:o?500:400},children:s.label})]},s.id)})]}),i&&a.jsx("div",{className:"text-center text-[8px] mt-1 font-medium",style:{color:"var(--state-active-text)"},children:i.name})]})}const Ob={light:{blocked:"#ef4444",in_progress:"#6366f1",ready:"#eab308",stabilized:"#10b981",active:"#6366f1",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},industrial:{blocked:"#ef4444",in_progress:"#f59e0b",ready:"#eab308",stabilized:"#10b981",active:"#f59e0b",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},blueprint:{blocked:"#ef4444",in_progress:"#fbbf24",ready:"#eab308",stabilized:"#10b981",active:"#fbbf24",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"}};function o6(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const bE=(e,t)=>{var n;const r=o6(e);return((n=Ob[t])==null?void 0:n[r])||Ob.industrial.ready},wr={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},uc={GAP:8},In=["industrial","light","blueprint"],a6=400,l6=560;function c6({question:e,value:t,onChange:r}){const n=e.answer_type||"text",i=e.choices||[];if(n==="single_choice"&&i.length>0)return a.jsx("div",{className:"space-y-1.5",children:i.map(s=>a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[a.jsx("input",{type:"radio",name:e.id,value:s.value,checked:t===s.value,onChange:()=>r(s.value),className:"w-3.5 h-3.5 accent-amber-500"}),a.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:s.label})]},s.value))});if(n==="multi_choice"&&i.length>0){const s=Array.isArray(t)?t:[];return a.jsx("div",{className:"space-y-1.5",children:i.map(o=>a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[a.jsx("input",{type:"checkbox",checked:s.includes(o.value),onChange:l=>{l.target.checked?r([...s,o.value]):r(s.filter(c=>c!==o.value))},className:"w-3.5 h-3.5 accent-amber-500"}),a.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:o.label})]},o.value))})}return n==="boolean"?a.jsx("div",{className:"flex gap-3",children:[{label:"Yes",value:!0},{label:"No",value:!1}].map(s=>a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[a.jsx("input",{type:"radio",name:e.id,checked:t===s.value,onChange:()=>r(s.value),className:"w-3.5 h-3.5 accent-amber-500"}),a.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:s.label})]},String(s.value)))}):n==="number"?a.jsx("input",{type:"number",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:s=>r(s.target.value?Number(s.target.value):"")}):n==="free_text"||n==="long_text"?a.jsx("textarea",{className:"w-full rounded px-2 py-1.5 text-xs border resize-none",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)",minHeight:60},value:t||"",onChange:s=>r(s.target.value)}):a.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:s=>r(s.target.value)})}function u6({priority:e}){if(!e)return null;const t={must:{bg:"bg-red-500/20",text:"text-red-400"},should:{bg:"bg-amber-500/20",text:"text-amber-400"},could:{bg:"bg-blue-500/20",text:"text-blue-400"}},r=t[e]||t.should;return a.jsx("span",{className:`${r.bg} ${r.text} text-[8px] px-1.5 py-0.5 rounded uppercase font-semibold`,children:e})}function d6({questions:e,nodeWidth:t,onSubmit:r,onClose:n}){const[i,s]=m.useState({}),[o,l]=m.useState(!1),[c,d]=m.useState(!1),u=e.filter(g=>g.required).every(g=>{const _=i[g.id];return Array.isArray(_)?_.length>0:_!==void 0&&_!==""}),f=o?l6:a6,p=(g,_)=>{s(v=>({...v,[g]:_}))},h=async()=>{d(!0);try{await r(i)}catch(g){console.error("Submit failed:",g),d(!1)}},x=g=>g.stopPropagation();return a.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+uc.GAP,width:f,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",transition:"width 0.2s ease"},onMouseDown:x,onPointerDown:x,onWheel:x,children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:uc.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>l(!o),title:o?"Contract":"Expand",className:"hover:opacity-70 transition-opacity p-1",style:{color:"var(--text-sidecar-muted)"},children:o?a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]})]}),a.jsx("div",{className:`p-3 space-y-4 overflow-y-auto ${o?"max-h-[520px]":"max-h-[420px]"}`,children:e.map(g=>a.jsxs("div",{className:"pb-3",style:{borderBottom:"1px solid var(--border-input)"},children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[a.jsxs("label",{className:"block text-[11px] font-medium",style:{color:"var(--text-sidecar)"},children:[g.text," ",g.required&&a.jsx("span",{className:"text-amber-500",children:"*"})]}),a.jsx(u6,{priority:g.priority})]}),g.why_it_matters&&a.jsx("p",{className:"text-[9px] mb-2 italic",style:{color:"var(--text-sidecar-muted)"},children:g.why_it_matters}),a.jsx(c6,{question:g,value:i[g.id],onChange:_=>p(g.id,_)})]},g.id))}),a.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:a.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${u&&!c?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!u||c,onClick:h,children:c?"Submitting...":"Submit & Continue"})})]})}function f6({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:i}){const s=e.length>6,o=s?240:320;m.useEffect(()=>{if(i){const c=setTimeout(()=>i(),150);return()=>clearTimeout(c)}},[i]);const l=c=>c.stopPropagation();return a.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:r+uc.GAP,width:o,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},onMouseDown:l,onPointerDown:l,onWheel:l,children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:uc.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${s?"":"grid grid-cols-2 gap-2"}`,children:e.map(c=>{const d=c.state==="complete"?"var(--state-stabilized-bg)":c.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return a.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${s?"mb-1":""}`,children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:d}}),a.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:c.name})]},c.id)})}),a.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const ey="/api/v1";class p6 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function h6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function $e(e,t={}){const r=`${ey}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},i=await fetch(r,n);if(!i.ok){const s=await i.json().catch(()=>({}));throw new p6(s.detail||`Request failed: ${i.status}`,i.status,s)}return i.status===204?null:i.json()}const Ve={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":h6()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return $e(`/projects${r?"?"+r:""}`)},getProject:e=>$e(`/projects/${e}`),getProjectTree:e=>$e(`/projects/${e}/tree`),createProject:e=>$e("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>$e(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>$e(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>$e(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>$e(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>$e(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),$e(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>$e(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>$e(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>$e("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>$e(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>$e(`/document-workflows/executions/${e}`),getPgcAnswers:e=>$e(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>$e(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>$e(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>$e("/intake/start",{method:"POST"}),getIntakeState:e=>$e(`/intake/${e}`),submitIntakeMessage:(e,t)=>$e(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>$e(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>$e(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>$e(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>$e(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>$e(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>$e(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>$e(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>$e(`/projects/${e}/workflow/complete`,{method:"POST"})};function m6(e){const t=`${ey}/production/events?project_id=${e}`;return new EventSource(t)}function g6(e){const t=`${ey}/intake/${e}/events`;return new EventSource(t)}function v6(e){return`/auth/login/${e}`}function x6({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Db({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const i=n==="numbered"?"decimal":"disc";return a.jsxs("div",{style:{marginBottom:12},children:[t.title&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),a.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":i},children:r.map((s,o)=>a.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&a.jsx("span",{style:{color:"#10b981"},children:""}),typeof s=="string"?s:(s==null?void 0:s.value)||(s==null?void 0:s.text)||(s==null?void 0:s.question)||(s==null?void 0:s.description)||JSON.stringify(s)]},o))})]})}function y6({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,s={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&a.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),a.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:s.bg,color:s.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function _E({block:e}){const{data:t}=e,{id:r,text:n,blocking:i,why_it_matters:s,priority:o,tags:l,options:c}=t,d={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},u=d[o]||d.should;return a.jsx("div",{style:{padding:"12px 16px",background:i?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${i?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),s&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:s}),a.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[i&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),o&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:u.bg,color:u.text,textTransform:"uppercase"},children:o}),l==null?void 0:l.map((f,p)=>a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},p))]}),c&&c.length>0&&a.jsxs("div",{style:{marginTop:8},children:[a.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,p)=>a.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:p>0?8:4},children:f},p))]})]})]})})}function b6({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,i=t.blocking_count||r.filter(s=>s.blocking).length;return r.length===0?a.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),i>0&&a.jsxs("span",{style:{color:"#dc2626"},children:[a.jsx("strong",{children:i})," blocking"]})]}),r.map((s,o)=>a.jsx(_E,{block:{type:"schema:OpenQuestionV1",data:s}},s.id||o))]})}function Lb({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const i={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((s,o)=>{const l=s.severity||s.likelihood||"medium",c=i[l]||i.medium;return a.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[s.id&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:s.id}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:s.description||s.reason||JSON.stringify(s)}),s.impact&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",s.impact]}),s.mitigation&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",s.mitigation]})]}),a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},s.id||o)})})]})}function _6({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([i])=>t[i]&&typeof t[i]=="string").map(([i,s])=>({title:s,content:t[i]}));return n.length===0?null:a.jsx("div",{style:{marginBottom:12},children:n.map((i,s)=>a.jsxs("div",{style:{marginBottom:s<n.length-1?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:i.title}),a.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:i.content})})]},s))})}function Fb({block:e}){const{data:t}=e,{epic_id:r,title:n,name:i,intent:s,phase:o,mvp_phase:l,risk_level:c,stories:d,detail_ref:u}=t,f=o||l,p=n||i,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},x=h[c]||h.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},_=g[f]||g.mvp;return a.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),a.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),s&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s}),d&&d.length>0&&a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[d.length," stories"]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:_.bg,color:_.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&a.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:x.bg,color:x.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),u&&a.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function w6({block:e}){const{data:t}=e,{story_id:r,title:n,intent:i,phase:s,risk_level:o,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[o]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[s]||u.mvp;return a.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),i&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:i})]}),a.jsxs("div",{style:{display:"flex",gap:4},children:[s&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:s}),d&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:o})]})]})})}function j6({block:e}){const{type:t,data:r}=e;return a.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[a.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),a.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function S6({block:e}){const{data:t}=e,r=t.items||[],[n,i]=m.useState({});if(r.length===0)return null;const s=o=>{i(l=>({...l,[o]:!l[o]}))};return a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,l)=>{const c=n[l],d=o.why_it_matters||o.impact_if_unresolved;return a.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[a.jsxs("button",{onClick:()=>d&&s(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:o.question||o.value||o.text||"Unknown"}),d&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:a.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&a.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[o.why_it_matters&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.why_it_matters})]}),o.impact_if_unresolved&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.impact_if_unresolved})]})]})]},l)})})}function k6({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&a.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function N6({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:i}=t;return a.jsxs("div",{style:{marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&a.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),i&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i})]})}function C6({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,i=r&&r.length>0,s=n&&n.length>0;return!i&&!s?null:a.jsxs("div",{style:{marginBottom:12},children:[i&&a.jsxs("div",{style:{marginBottom:s?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:o})]},l))})]}),s&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:o})]},l))})]})]})}function E6({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:i=[]}=t,s=r&&r.length>0,o=n&&n.length>0,l=i&&i.length>0;return!s&&!o&&!l?null:a.jsxs("div",{style:{marginBottom:12},children:[s&&a.jsxs("div",{style:{marginBottom:o||l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:c})]},d))})]}),o&&a.jsxs("div",{style:{marginBottom:l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:c})]},d))})]}),l&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:i.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#6b7280"},children:""}),a.jsx("span",{children:c})]},d))})]})]})}function T6({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:i}=t,o={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{marginBottom:12},children:a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:o.bg,color:o.text},children:r})}),n&&a.jsx("p",{style:{margin:0,marginBottom:i?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),i&&a.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:a.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",i]})})]})}const R6={"schema:ParagraphBlockV1":x6,"schema:StringListBlockV1":Db,"schema:IndicatorBlockV1":y6,"schema:OpenQuestionV1":_E,"schema:OpenQuestionsBlockV1":b6,"schema:RisksBlockV1":Lb,"schema:DependenciesBlockV1":Lb,"schema:SummaryBlockV1":_6,"schema:EpicSummaryBlockV1":Fb,"schema:StorySummaryBlockV1":w6,"schema:EpicStoriesCardBlockV1":Fb,"schema:StoriesBlockV1":Db,"schema:UnknownsBlockV1":S6,"schema:IntakeSummaryBlockV1":k6,"schema:IntakeProjectTypeBlockV1":N6,"schema:IntakeConstraintsBlockV1":C6,"schema:IntakeOpenGapsBlockV1":E6,"schema:IntakeOutcomeBlockV1":T6};function A6(e){return R6[e]||j6}function I6(e,t){const r=A6(e.type);return a.jsx(r,{block:e},e.key||t)}function wE({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:i=""}){var _;const[s,o]=m.useState(new Set(((_=e==null?void 0:e.sections)==null?void 0:_.map(v=>v.section_id))||[]));if(!e)return a.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return a.jsx(L6,{title:l,content:e.raw_content,reason:u.reason});const f=v=>{o(y=>{const b=new Set(y);return b.has(v)?b.delete(v):b.add(v),b})},p=t==="compact"||t==="sidecar",x=t==="sidecar"?d.filter(v=>v.viewer_tab==="overview"||!v.viewer_tab):d,g=(()=>{if(!l)return"Document";const v=l.indexOf(": ");return v>-1?l.slice(v+2):l})();return a.jsxs("div",{className:i,children:[t==="full"&&!r&&a.jsxs("div",{style:{marginBottom:24},children:[a.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&a.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:x.map(v=>a.jsx(D6,{section:v,isExpanded:s.has(v.section_id),onToggle:()=>f(v.section_id),onClick:()=>n==null?void 0:n(v),variant:t},v.section_id))}),x.length===0&&a.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function M6(e){if(!e||!e.data)return"";const{type:t,data:r}=e;switch(t){case"schema:ParagraphBlockV1":return r.text||"";case"schema:StringListBlockV1":return(r.items||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.text||""}`).join(`
`);case"schema:IndicatorBlockV1":return`${r.label||""}: ${r.value||""}`;case"schema:OpenQuestionV1":return`Q: ${r.question||""}
A: ${r.answer||"No answer yet"}`;case"schema:OpenQuestionsBlockV1":return(r.questions||[]).map(n=>`Q: ${n.question||""}
A: ${n.answer||"No answer yet"}`).join(`

`);case"schema:RisksBlockV1":case"schema:DependenciesBlockV1":return(r.items||[]).map(n=>`- ${n.title||n.name||""}: ${n.description||""}`).join(`
`);case"schema:SummaryBlockV1":return r.summary||r.text||"";case"schema:EpicSummaryBlockV1":case"schema:StorySummaryBlockV1":return[r.title||"",r.description||r.summary||""].filter(Boolean).join(`

`);case"schema:UnknownsBlockV1":return(r.items||r.unknowns||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.description||n.text||""}`).join(`
`);case"schema:IntakeSummaryBlockV1":return r.summary||"";case"schema:IntakeProjectTypeBlockV1":return`Project Type: ${r.project_type||r.type||""}`;case"schema:IntakeConstraintsBlockV1":return(r.constraints||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOpenGapsBlockV1":return(r.gaps||r.open_gaps||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOutcomeBlockV1":return`Outcome: ${r.outcome||r.status||""}`;default:return r.text?r.text:r.content?r.content:r.summary?r.summary:r.items&&Array.isArray(r.items)?r.items.map(n=>typeof n=="string"?`- ${n}`:`- ${JSON.stringify(n)}`).join(`
`):""}}function P6({size:e=14}){return a.jsxs("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"5",y:"5",width:"9",height:"9",rx:"1"}),a.jsx("path",{d:"M2 11V3a1 1 0 011-1h8"})]})}function O6({size:e=14}){return a.jsx("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M3 8l4 4 6-7"})})}function D6({section:e,isExpanded:t,onToggle:r,onClick:n,variant:i}){const[s,o]=m.useState(!1),{section_id:l,title:c,description:d,blocks:u=[],sidecar_max_items:f}=e,p=i==="compact"||i==="sidecar",h=i==="sidecar";if(u.length===0)return null;const x=async v=>{v.stopPropagation();const y=u.map(M6).filter(Boolean).join(`

`);try{await navigator.clipboard.writeText(y),o(!0),setTimeout(()=>o(!1),2e3)}catch(b){console.error("Failed to copy:",b)}},g=h&&f&&u.length>f?u.slice(0,f):u,_=h&&f&&u.length>f;return a.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[a.jsxs("button",{onClick:r,style:{width:"100%",padding:p?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,fontSize:p?13:15,fontWeight:600,color:"#111827"},children:[c,_&&a.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",f," of ",u.length,")"]})]}),d&&!p&&a.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:d})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[a.jsx("button",{onClick:x,title:s?"Copied!":"Copy section",style:{padding:4,background:"none",border:"none",cursor:"pointer",color:s?"#10b981":"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,transition:"color 0.2s"},children:s?a.jsx(O6,{size:14}):a.jsx(P6,{size:14})}),a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:a.jsx("path",{d:"M4 6l4 4 4-4"})})]})]}),t&&a.jsxs("div",{style:{padding:p?12:18},children:[g.map((v,y)=>I6(v,y)),_&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",u.length-f," more in full view"]})]})]})}function L6({title:e,content:t,reason:r}){return a.jsxs("div",{children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function F6({renderModel:e,projectCode:t,documentName:r,isExpanded:n,onToggleExpand:i,onClose:s,onViewFull:o,nodeWidth:l=280}){const p=n?900:520,h=n?900:600,x=`${t||"DOC"} - ${r||"Document"}`,g=_=>{_.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:l+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,onWheel:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const _=(e==null?void 0:e.title)||"DOCUMENT",v=_.indexOf(": ");return(v>-1?_.slice(v+2):_).toUpperCase()})()}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:i,title:n?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:n?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:s,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:n?600:400},onWheel:_=>_.stopPropagation(),children:a.jsx(wE,{renderModel:e,variant:"sidecar"})}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:o,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function z6({document:e,projectId:t,projectCode:r,nodeWidth:n,onClose:i,onZoomComplete:s,onViewFull:o}){const[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!0),[h,x]=m.useState(!1);return m.useEffect(()=>{if(s){const g=setTimeout(()=>s(),150);return()=>clearTimeout(g)}},[s]),m.useEffect(()=>{async function g(){var _;if(!t||!e.id){p(!1);return}try{p(!0);try{const y=await Ve.getDocumentRenderModel(t,e.id);if(y&&y.sections&&y.sections.length>0){c(y),u(null);return}if((_=y==null?void 0:y.metadata)!=null&&_.fallback&&y.raw_content){c(null),u(y.raw_content);return}}catch(y){console.log("RenderModel not available, falling back to raw document:",y.message)}const v=await Ve.getDocument(t,e.id);c(null),u((v==null?void 0:v.content)||null)}catch(v){console.error("Failed to fetch document for sidecar:",v)}finally{p(!1)}}g()},[t,e.id]),f?null:l?a.jsx(F6,{renderModel:l,projectCode:r,documentName:e.name,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id),nodeWidth:n}):a.jsx($6,{document:e,projectCode:r,rawContent:d,nodeWidth:n,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id)})}function $6({document:e,projectCode:t,rawContent:r,nodeWidth:n,isExpanded:i,onToggleExpand:s,onClose:o,onViewFull:l}){var _;const p=i?900:520,h=i?900:600,x=`${t||"DOC"} - ${e.name||"Document"}`,g=v=>{v.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:n+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,onWheel:g,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((_=e.name)==null?void 0:_.toUpperCase())||"DOCUMENT"}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:s,title:i?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:i?600:400},onWheel:v=>v.stopPropagation(),children:[a.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:v=>v.stopPropagation(),children:a.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:l,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const q6={blocked:{bg:"var(--state-blocked-bg)",text:"var(--state-blocked-text)"},in_progress:{bg:"var(--state-active-bg)",text:"var(--state-active-text)"},ready:{bg:"var(--state-ready-bg)",text:"var(--state-ready-text)"},stabilized:{bg:"var(--state-stabilized-bg)",text:"var(--state-stabilized-text)"}};function B6(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const H6={blocked:"Blocked",in_progress:"In Progress",ready:"Ready",stabilized:"Stabilized"};function W6(e){return e?e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):""}function U6({data:e}){var S,C,T,j;const r=(e.level||1)===1,n=e.isExpanded,i=e.expandType,s=((S=e.questions)==null?void 0:S.length)>0,o=((C=e.features)==null?void 0:C.length)>0,l=(T=e.stations)==null?void 0:T.some(R=>R.state==="active"&&R.needs_input),c=e.state||"ready_for_production",d=B6(c),u=d==="stabilized",f=d==="in_progress",p=d==="blocked",h=f&&e.stations,x=f?"node-active":"",g=r?"DOCUMENT":"EPIC",_=r?"subway-node-header-doc":"subway-node-header-epic",v=q6[d],y=v.bg,b=v.text,w=v.bg,k=H6[d];return a.jsxs("div",{className:"relative",children:[a.jsx(Vr,{type:"target",position:ue.Top,className:"!opacity-0",style:{left:"15%"}}),a.jsxs("div",{className:`subway-node rounded-lg border ${x} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:w},children:[a.jsxs("div",{className:`${_} border-b px-3 py-1.5 flex items-center justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:g}),a.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&a.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:y}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:b},children:k}),r&&e.desc&&a.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),h&&a.jsx(s6,{stations:e.stations}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&u&&a.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-stabilized-bg)",color:"white"},onClick:R=>{var E;R.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"document")},children:"View Document"}),r&&d==="ready"&&a.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-ready-bg)",color:"white"},onClick:R=>{var E;R.stopPropagation(),(E=e.onStartProduction)==null||E.call(e,e.id)},children:"Start Production"}),l&&s&&!n&&a.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all amber-pulse",style:{backgroundColor:"var(--state-active-bg)",color:"white"},onClick:R=>{var E;R.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&o&&(n&&i==="features"?a.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):a.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:R=>{var E;R.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"features")},children:[a.jsx("span",{className:"text-indigo-400",children:e.features.length}),a.jsx("span",{children:"features"}),a.jsx("span",{className:"text-indigo-400",children:""})]}))]}),((j=e.blockedBy)==null?void 0:j.length)>0&&(p||d==="ready")&&a.jsxs("div",{className:"mt-2 pt-2 border-t text-[8px]",style:{borderColor:"var(--border-node)",color:"var(--text-muted)"},children:[a.jsx("span",{className:"font-medium",children:"Waiting for: "}),e.blockedBy.map(W6).join(", ")]})]})]}),n&&i==="questions"&&s&&a.jsx(d6,{questions:e.questions,nodeWidth:e.width,onSubmit:R=>{var E;return(E=e.onSubmitQuestions)==null?void 0:E.call(e,e.id,R)},onClose:()=>{var R;return(R=e.onCollapse)==null?void 0:R.call(e)}}),n&&i==="features"&&o&&a.jsx(f6,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var R;return(R=e.onCollapse)==null?void 0:R.call(e)},onZoomComplete:()=>{var R;return(R=e.onZoomToNode)==null?void 0:R.call(e,e.id)}}),n&&i==="document"&&r&&u&&a.jsx(z6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var R;return(R=e.onCollapse)==null?void 0:R.call(e)},onZoomComplete:()=>{var R;return(R=e.onZoomToNode)==null?void 0:R.call(e,e.id)},onViewFull:R=>{var E;return(E=e.onViewFullDocument)==null?void 0:E.call(e,R)}}),a.jsx(Vr,{type:"source",position:ue.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function V6(){return a.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[a.jsx(Vr,{type:"target",position:ue.Top,style:{opacity:0}}),a.jsx(Vr,{type:"source",position:ue.Bottom,style:{opacity:0}})]})}function G6({projectId:e,projectCode:t,docTypeId:r,onClose:n}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null);return m.useEffect(()=>{async function p(){var h;try{d(!0),f(null);try{const g=await Ve.getDocumentRenderModel(e,r);if(g&&g.sections&&g.sections.length>0){s(g),l(null);return}if((h=g==null?void 0:g.metadata)!=null&&h.fallback&&g.raw_content){s(null),l(g.raw_content);return}}catch(g){console.log("RenderModel not available, falling back to raw document:",g.message)}const x=await Ve.getDocument(e,r);s(null),l((x==null?void 0:x.content)||null)}catch(x){f(x.message),console.error("Failed to fetch document:",x)}finally{d(!1)}}p()},[e,r]),m.useEffect(()=>{const p=h=>{h.key==="Escape"&&n()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[n]),c?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:a.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:p=>p.target===p.currentTarget&&n(),children:a.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[a.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsx("div",{children:t&&a.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),a.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},onWheel:p=>p.stopPropagation(),children:[u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-red-500",children:u})}),i&&a.jsx(wE,{renderModel:i,variant:"full"}),o&&!i&&a.jsx(K6,{content:o,docTypeId:r}),!i&&!o&&!u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function K6({content:e,docTypeId:t}){if(!e)return a.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n=e.description||e.summary||e.preliminary_summary;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",a.jsx("strong",{children:t})," - displaying raw content"]}),(r||n)&&a.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[r&&a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),n&&a.jsx("p",{className:"text-gray-700 text-sm",children:n})]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:i=>i.stopPropagation(),children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const Y6="/api/v1/admin";class X6 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function Q6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ne(e,t={}){var s;const r=`${Y6}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const o=Q6();o&&(n.headers["X-CSRF-Token"]=o)}const i=await fetch(r,n);if(!i.ok){const o=await i.json().catch(()=>({})),l=((s=o.detail)==null?void 0:s.message)||o.detail||`Request failed: ${i.status}`;throw new X6(l,i.status,o.detail||o)}return i.status===204?null:i.json()}const _e={getCurrentWorkspace:async()=>{try{return await Ne("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ne("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ne(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ne(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ne(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ne(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ne(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ne(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ne("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ne(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ne("/workbench/prompt-fragments"),getRoles:()=>Ne("/workbench/roles"),getTemplates:()=>Ne("/workbench/templates"),getSchemas:()=>Ne("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ne("/workbench/workflows"),getOrchestrationWorkflows:()=>Ne("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ne(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ne(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ne(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ne(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ne("/workbench/active-releases"),invalidateCache:()=>Ne("/workbench/invalidate-cache",{method:"POST"}),getMechanicalOpTypes:()=>Ne("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Ne(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Ne("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Ne("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/mechanical-ops/${e}${r}`)}};function Z6({projectId:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,x]=m.useState(!1),[g,_]=m.useState(null),[v,y]=m.useState(!1),[b,w]=m.useState(!1),k=m.useCallback(async()=>{try{const N=((await _e.getOrchestrationWorkflows()).workflows||[]).filter(I=>I.workflow_id!=="intake_and_route"),D=N.find(I=>I.workflow_id==="software_product_development")||N[0];if(D){const I=await Ve.createWorkflowInstance(e,D.workflow_id,D.active_version);r(I)}}catch($){console.error("Failed to auto-assign workflow:",$)}},[e]),S=m.useCallback(async()=>{if(e){i(!0),o(null);try{const $=await Ve.getWorkflowInstance(e);r($)}catch($){$.status===404?(r(null),await k()):o($.message)}finally{i(!1)}}},[e,k]);m.useEffect(()=>{S()},[S]);const C=async()=>{c(!0),p(!0);try{const N=((await _e.getOrchestrationWorkflows()).workflows||[]).filter(D=>D.workflow_id!=="intake_and_route");u(N)}catch{u([])}finally{p(!1)}},T=async $=>{x(!0);try{const N=await Ve.createWorkflowInstance(e,$.workflow_id,$.active_version);r(N),c(!1)}catch(N){o(N.message)}finally{x(!1)}},j=async()=>{if(t&&(w(!b),!g)){y(!0);try{const $=await Ve.getWorkflowDrift(e);_($)}catch($){_({error:$.message})}finally{y(!1)}}};if(n)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(s&&!t)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:s});if(!t)return a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?a.jsx(J6,{workflows:d,loading:f,assigning:h,onSelect:T,onCancel:()=>c(!1)}):a.jsx("button",{onClick:C,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const R=t.effective_workflow||{},E=R.steps||[],M=t.base_workflow_ref||{};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:R.name||M.workflow_id||"Workflow"}),a.jsx(eL,{status:t.status})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",M.workflow_id," v",M.version,M.pow_class?` (${M.pow_class})`:""]})]}),a.jsx("button",{onClick:j,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:v?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&a.jsx(tL,{drift:g}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",E.length,")"]}),E.length===0?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):a.jsx("div",{className:"space-y-1",children:E.map(($,N)=>a.jsx(rL,{step:$,index:N},$.step_id||N))})]}),s&&a.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:s})]})}function J6({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:i}){const s=e.filter(l=>(l.pow_class||"reference")==="reference"),o=e.filter(l=>l.pow_class==="template");return a.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs(a.Fragment,{children:[s.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),s.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),o.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),o.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),s.length===0&&o.length===0&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),a.jsx("button",{onClick:i,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function eL({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function tL({drift:e}){return e.error?a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):a.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[a.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[a.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),a.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&a.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&a.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&a.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&a.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&a.jsx("div",{children:"~ Metadata changed"})]})]})}function rL({step:e,index:t}){return a.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&a.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&a.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function ty(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ud,zb;function nL(){if(zb)return ud;zb=1;function e(){this.__data__=[],this.size=0}return ud=e,ud}var dd,$b;function Is(){if($b)return dd;$b=1;function e(t,r){return t===r||t!==t&&r!==r}return dd=e,dd}var fd,qb;function Jc(){if(qb)return fd;qb=1;var e=Is();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return fd=t,fd}var pd,Bb;function iL(){if(Bb)return pd;Bb=1;var e=Jc(),t=Array.prototype,r=t.splice;function n(i){var s=this.__data__,o=e(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return pd=n,pd}var hd,Hb;function sL(){if(Hb)return hd;Hb=1;var e=Jc();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return hd=t,hd}var md,Wb;function oL(){if(Wb)return md;Wb=1;var e=Jc();function t(r){return e(this.__data__,r)>-1}return md=t,md}var gd,Ub;function aL(){if(Ub)return gd;Ub=1;var e=Jc();function t(r,n){var i=this.__data__,s=e(i,r);return s<0?(++this.size,i.push([r,n])):i[s][1]=n,this}return gd=t,gd}var vd,Vb;function eu(){if(Vb)return vd;Vb=1;var e=nL(),t=iL(),r=sL(),n=oL(),i=aL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,vd=s,vd}var xd,Gb;function lL(){if(Gb)return xd;Gb=1;var e=eu();function t(){this.__data__=new e,this.size=0}return xd=t,xd}var yd,Kb;function cL(){if(Kb)return yd;Kb=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return yd=e,yd}var bd,Yb;function uL(){if(Yb)return bd;Yb=1;function e(t){return this.__data__.get(t)}return bd=e,bd}var _d,Xb;function dL(){if(Xb)return _d;Xb=1;function e(t){return this.__data__.has(t)}return _d=e,_d}var wd,Qb;function jE(){if(Qb)return wd;Qb=1;var e=typeof Ta=="object"&&Ta&&Ta.Object===Object&&Ta;return wd=e,wd}var jd,Zb;function Mr(){if(Zb)return jd;Zb=1;var e=jE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return jd=r,jd}var Sd,Jb;function Ms(){if(Jb)return Sd;Jb=1;var e=Mr(),t=e.Symbol;return Sd=t,Sd}var kd,e1;function fL(){if(e1)return kd;e1=1;var e=Ms(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function s(o){var l=r.call(o,i),c=o[i];try{o[i]=void 0;var d=!0}catch{}var u=n.call(o);return d&&(l?o[i]=c:delete o[i]),u}return kd=s,kd}var Nd,t1;function pL(){if(t1)return Nd;t1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Nd=r,Nd}var Cd,r1;function Ti(){if(r1)return Cd;r1=1;var e=Ms(),t=fL(),r=pL(),n="[object Null]",i="[object Undefined]",s=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?t(l):r(l)}return Cd=o,Cd}var Ed,n1;function xr(){if(n1)return Ed;n1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Ed=e,Ed}var Td,i1;function ba(){if(i1)return Td;i1=1;var e=Ti(),t=xr(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==n||c==i||c==r||c==s}return Td=o,Td}var Rd,s1;function hL(){if(s1)return Rd;s1=1;var e=Mr(),t=e["__core-js_shared__"];return Rd=t,Rd}var Ad,o1;function mL(){if(o1)return Ad;o1=1;var e=hL(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Ad=r,Ad}var Id,a1;function SE(){if(a1)return Id;a1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Id=r,Id}var Md,l1;function gL(){if(l1)return Md;l1=1;var e=ba(),t=mL(),r=xr(),n=SE(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?u:s;return h.test(n(p))}return Md=f,Md}var Pd,c1;function vL(){if(c1)return Pd;c1=1;function e(t,r){return t==null?void 0:t[r]}return Pd=e,Pd}var Od,u1;function Ri(){if(u1)return Od;u1=1;var e=gL(),t=vL();function r(n,i){var s=t(n,i);return e(s)?s:void 0}return Od=r,Od}var Dd,d1;function ry(){if(d1)return Dd;d1=1;var e=Ri(),t=Mr(),r=e(t,"Map");return Dd=r,Dd}var Ld,f1;function tu(){if(f1)return Ld;f1=1;var e=Ri(),t=e(Object,"create");return Ld=t,Ld}var Fd,p1;function xL(){if(p1)return Fd;p1=1;var e=tu();function t(){this.__data__=e?e(null):{},this.size=0}return Fd=t,Fd}var zd,h1;function yL(){if(h1)return zd;h1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return zd=e,zd}var $d,m1;function bL(){if(m1)return $d;m1=1;var e=tu(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(s){var o=this.__data__;if(e){var l=o[s];return l===t?void 0:l}return n.call(o,s)?o[s]:void 0}return $d=i,$d}var qd,g1;function _L(){if(g1)return qd;g1=1;var e=tu(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var s=this.__data__;return e?s[i]!==void 0:r.call(s,i)}return qd=n,qd}var Bd,v1;function wL(){if(v1)return Bd;v1=1;var e=tu(),t="__lodash_hash_undefined__";function r(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=e&&i===void 0?t:i,this}return Bd=r,Bd}var Hd,x1;function jL(){if(x1)return Hd;x1=1;var e=xL(),t=yL(),r=bL(),n=_L(),i=wL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,Hd=s,Hd}var Wd,y1;function SL(){if(y1)return Wd;y1=1;var e=jL(),t=eu(),r=ry();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Wd=n,Wd}var Ud,b1;function kL(){if(b1)return Ud;b1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Ud=e,Ud}var Vd,_1;function ru(){if(_1)return Vd;_1=1;var e=kL();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Vd=t,Vd}var Gd,w1;function NL(){if(w1)return Gd;w1=1;var e=ru();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Gd=t,Gd}var Kd,j1;function CL(){if(j1)return Kd;j1=1;var e=ru();function t(r){return e(this,r).get(r)}return Kd=t,Kd}var Yd,S1;function EL(){if(S1)return Yd;S1=1;var e=ru();function t(r){return e(this,r).has(r)}return Yd=t,Yd}var Xd,k1;function TL(){if(k1)return Xd;k1=1;var e=ru();function t(r,n){var i=e(this,r),s=i.size;return i.set(r,n),this.size+=i.size==s?0:1,this}return Xd=t,Xd}var Qd,N1;function ny(){if(N1)return Qd;N1=1;var e=SL(),t=NL(),r=CL(),n=EL(),i=TL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,Qd=s,Qd}var Zd,C1;function RL(){if(C1)return Zd;C1=1;var e=eu(),t=ry(),r=ny(),n=200;function i(s,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([s,o]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(s,o),this.size=l.size,this}return Zd=i,Zd}var Jd,E1;function nu(){if(E1)return Jd;E1=1;var e=eu(),t=lL(),r=cL(),n=uL(),i=dL(),s=RL();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=i,o.prototype.set=s,Jd=o,Jd}var ef,T1;function iy(){if(T1)return ef;T1=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return ef=e,ef}var tf,R1;function kE(){if(R1)return tf;R1=1;var e=Ri(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return tf=t,tf}var rf,A1;function iu(){if(A1)return rf;A1=1;var e=kE();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return rf=t,rf}var nf,I1;function su(){if(I1)return nf;I1=1;var e=iu(),t=Is(),r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l){var c=s[o];(!(n.call(s,o)&&t(c,l))||l===void 0&&!(o in s))&&e(s,o,l)}return nf=i,nf}var sf,M1;function _a(){if(M1)return sf;M1=1;var e=su(),t=iu();function r(n,i,s,o){var l=!s;s||(s={});for(var c=-1,d=i.length;++c<d;){var u=i[c],f=o?o(s[u],n[u],u,s,n):void 0;f===void 0&&(f=n[u]),l?t(s,u,f):e(s,u,f)}return s}return sf=r,sf}var of,P1;function AL(){if(P1)return of;P1=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return of=e,of}var af,O1;function Yr(){if(O1)return af;O1=1;function e(t){return t!=null&&typeof t=="object"}return af=e,af}var lf,D1;function IL(){if(D1)return lf;D1=1;var e=Ti(),t=Yr(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return lf=n,lf}var cf,L1;function wa(){if(L1)return cf;L1=1;var e=IL(),t=Yr(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,s=e(function(){return arguments}())?e:function(o){return t(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return cf=s,cf}var uf,F1;function lt(){if(F1)return uf;F1=1;var e=Array.isArray;return uf=e,uf}var mo={exports:{}},df,z1;function ML(){if(z1)return df;z1=1;function e(){return!1}return df=e,df}mo.exports;var $1;function Ps(){return $1||($1=1,function(e,t){var r=Mr(),n=ML(),i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===i,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d}(mo,mo.exports)),mo.exports}var ff,q1;function ou(){if(q1)return ff;q1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var s=typeof n;return i=i??e,!!i&&(s=="number"||s!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return ff=r,ff}var pf,B1;function sy(){if(B1)return pf;B1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return pf=t,pf}var hf,H1;function PL(){if(H1)return hf;H1=1;var e=Ti(),t=sy(),r=Yr(),n="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",x="[object String]",g="[object WeakMap]",_="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",w="[object Int8Array]",k="[object Int16Array]",S="[object Int32Array]",C="[object Uint8Array]",T="[object Uint8ClampedArray]",j="[object Uint16Array]",R="[object Uint32Array]",E={};E[y]=E[b]=E[w]=E[k]=E[S]=E[C]=E[T]=E[j]=E[R]=!0,E[n]=E[i]=E[_]=E[s]=E[v]=E[o]=E[l]=E[c]=E[d]=E[u]=E[f]=E[p]=E[h]=E[x]=E[g]=!1;function M($){return r($)&&t($.length)&&!!E[e($)]}return hf=M,hf}var mf,W1;function au(){if(W1)return mf;W1=1;function e(t){return function(r){return t(r)}}return mf=e,mf}var go={exports:{}};go.exports;var U1;function oy(){return U1||(U1=1,function(e,t){var r=jE(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l}(go,go.exports)),go.exports}var gf,V1;function ja(){if(V1)return gf;V1=1;var e=PL(),t=au(),r=oy(),n=r&&r.isTypedArray,i=n?t(n):e;return gf=i,gf}var vf,G1;function NE(){if(G1)return vf;G1=1;var e=AL(),t=wa(),r=lt(),n=Ps(),i=ou(),s=ja(),o=Object.prototype,l=o.hasOwnProperty;function c(d,u){var f=r(d),p=!f&&t(d),h=!f&&!p&&n(d),x=!f&&!p&&!h&&s(d),g=f||p||h||x,_=g?e(d.length,String):[],v=_.length;for(var y in d)(u||l.call(d,y))&&!(g&&(y=="length"||h&&(y=="offset"||y=="parent")||x&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||i(y,v)))&&_.push(y);return _}return vf=c,vf}var xf,K1;function lu(){if(K1)return xf;K1=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return xf=t,xf}var yf,Y1;function CE(){if(Y1)return yf;Y1=1;function e(t,r){return function(n){return t(r(n))}}return yf=e,yf}var bf,X1;function OL(){if(X1)return bf;X1=1;var e=CE(),t=e(Object.keys,Object);return bf=t,bf}var _f,Q1;function ay(){if(Q1)return _f;Q1=1;var e=lu(),t=OL(),r=Object.prototype,n=r.hasOwnProperty;function i(s){if(!e(s))return t(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return _f=i,_f}var wf,Z1;function yn(){if(Z1)return wf;Z1=1;var e=ba(),t=sy();function r(n){return n!=null&&t(n.length)&&!e(n)}return wf=r,wf}var jf,J1;function ti(){if(J1)return jf;J1=1;var e=NE(),t=ay(),r=yn();function n(i){return r(i)?e(i):t(i)}return jf=n,jf}var Sf,e_;function DL(){if(e_)return Sf;e_=1;var e=_a(),t=ti();function r(n,i){return n&&e(i,t(i),n)}return Sf=r,Sf}var kf,t_;function LL(){if(t_)return kf;t_=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return kf=e,kf}var Nf,r_;function FL(){if(r_)return Nf;r_=1;var e=xr(),t=lu(),r=LL(),n=Object.prototype,i=n.hasOwnProperty;function s(o){if(!e(o))return r(o);var l=t(o),c=[];for(var d in o)d=="constructor"&&(l||!i.call(o,d))||c.push(d);return c}return Nf=s,Nf}var Cf,n_;function Ai(){if(n_)return Cf;n_=1;var e=NE(),t=FL(),r=yn();function n(i){return r(i)?e(i,!0):t(i)}return Cf=n,Cf}var Ef,i_;function zL(){if(i_)return Ef;i_=1;var e=_a(),t=Ai();function r(n,i){return n&&e(i,t(i),n)}return Ef=r,Ef}var vo={exports:{}};vo.exports;var s_;function EE(){return s_||(s_=1,function(e,t){var r=Mr(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s?r.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(vo,vo.exports)),vo.exports}var Tf,o_;function TE(){if(o_)return Tf;o_=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return Tf=e,Tf}var Rf,a_;function RE(){if(a_)return Rf;a_=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=0,o=[];++n<i;){var l=t[n];r(l,n,t)&&(o[s++]=l)}return o}return Rf=e,Rf}var Af,l_;function AE(){if(l_)return Af;l_=1;function e(){return[]}return Af=e,Af}var If,c_;function ly(){if(c_)return If;c_=1;var e=RE(),t=AE(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),e(i(o),function(l){return n.call(o,l)}))}:t;return If=s,If}var Mf,u_;function $L(){if(u_)return Mf;u_=1;var e=_a(),t=ly();function r(n,i){return e(n,t(n),i)}return Mf=r,Mf}var Pf,d_;function cy(){if(d_)return Pf;d_=1;function e(t,r){for(var n=-1,i=r.length,s=t.length;++n<i;)t[s+n]=r[n];return t}return Pf=e,Pf}var Of,f_;function cu(){if(f_)return Of;f_=1;var e=CE(),t=e(Object.getPrototypeOf,Object);return Of=t,Of}var Df,p_;function IE(){if(p_)return Df;p_=1;var e=cy(),t=cu(),r=ly(),n=AE(),i=Object.getOwnPropertySymbols,s=i?function(o){for(var l=[];o;)e(l,r(o)),o=t(o);return l}:n;return Df=s,Df}var Lf,h_;function qL(){if(h_)return Lf;h_=1;var e=_a(),t=IE();function r(n,i){return e(n,t(n),i)}return Lf=r,Lf}var Ff,m_;function ME(){if(m_)return Ff;m_=1;var e=cy(),t=lt();function r(n,i,s){var o=i(n);return t(n)?o:e(o,s(n))}return Ff=r,Ff}var zf,g_;function PE(){if(g_)return zf;g_=1;var e=ME(),t=ly(),r=ti();function n(i){return e(i,r,t)}return zf=n,zf}var $f,v_;function BL(){if(v_)return $f;v_=1;var e=ME(),t=IE(),r=Ai();function n(i){return e(i,r,t)}return $f=n,$f}var qf,x_;function HL(){if(x_)return qf;x_=1;var e=Ri(),t=Mr(),r=e(t,"DataView");return qf=r,qf}var Bf,y_;function WL(){if(y_)return Bf;y_=1;var e=Ri(),t=Mr(),r=e(t,"Promise");return Bf=r,Bf}var Hf,b_;function OE(){if(b_)return Hf;b_=1;var e=Ri(),t=Mr(),r=e(t,"Set");return Hf=r,Hf}var Wf,__;function UL(){if(__)return Wf;__=1;var e=Ri(),t=Mr(),r=e(t,"WeakMap");return Wf=r,Wf}var Uf,w_;function Os(){if(w_)return Uf;w_=1;var e=HL(),t=ry(),r=WL(),n=OE(),i=UL(),s=Ti(),o=SE(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=o(e),x=o(t),g=o(r),_=o(n),v=o(i),y=s;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||r&&y(r.resolve())!=d||n&&y(new n)!=u||i&&y(new i)!=f)&&(y=function(b){var w=s(b),k=w==c?b.constructor:void 0,S=k?o(k):"";if(S)switch(S){case h:return p;case x:return l;case g:return d;case _:return u;case v:return f}return w}),Uf=y,Uf}var Vf,j_;function VL(){if(j_)return Vf;j_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,s=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(s.index=n.index,s.input=n.input),s}return Vf=r,Vf}var Gf,S_;function DE(){if(S_)return Gf;S_=1;var e=Mr(),t=e.Uint8Array;return Gf=t,Gf}var Kf,k_;function uy(){if(k_)return Kf;k_=1;var e=DE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return Kf=t,Kf}var Yf,N_;function GL(){if(N_)return Yf;N_=1;var e=uy();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return Yf=t,Yf}var Xf,C_;function KL(){if(C_)return Xf;C_=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return Xf=t,Xf}var Qf,E_;function YL(){if(E_)return Qf;E_=1;var e=Ms(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return Qf=n,Qf}var Zf,T_;function LE(){if(T_)return Zf;T_=1;var e=uy();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return Zf=t,Zf}var Jf,R_;function XL(){if(R_)return Jf;R_=1;var e=uy(),t=GL(),r=KL(),n=YL(),i=LE(),s="[object Boolean]",o="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",x="[object DataView]",g="[object Float32Array]",_="[object Float64Array]",v="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",w="[object Uint8Array]",k="[object Uint8ClampedArray]",S="[object Uint16Array]",C="[object Uint32Array]";function T(j,R,E){var M=j.constructor;switch(R){case h:return e(j);case s:case o:return new M(+j);case x:return t(j,E);case g:case _:case v:case y:case b:case w:case k:case S:case C:return i(j,E);case l:return new M;case c:case f:return new M(j);case d:return r(j);case u:return new M;case p:return n(j)}}return Jf=T,Jf}var ep,A_;function FE(){if(A_)return ep;A_=1;var e=xr(),t=Object.create,r=function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var s=new n;return n.prototype=void 0,s}}();return ep=r,ep}var tp,I_;function zE(){if(I_)return tp;I_=1;var e=FE(),t=cu(),r=lu();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return tp=n,tp}var rp,M_;function QL(){if(M_)return rp;M_=1;var e=Os(),t=Yr(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return rp=n,rp}var np,P_;function ZL(){if(P_)return np;P_=1;var e=QL(),t=au(),r=oy(),n=r&&r.isMap,i=n?t(n):e;return np=i,np}var ip,O_;function JL(){if(O_)return ip;O_=1;var e=Os(),t=Yr(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return ip=n,ip}var sp,D_;function e8(){if(D_)return sp;D_=1;var e=JL(),t=au(),r=oy(),n=r&&r.isSet,i=n?t(n):e;return sp=i,sp}var op,L_;function $E(){if(L_)return op;L_=1;var e=nu(),t=iy(),r=su(),n=DL(),i=zL(),s=EE(),o=TE(),l=$L(),c=qL(),d=PE(),u=BL(),f=Os(),p=VL(),h=XL(),x=zE(),g=lt(),_=Ps(),v=ZL(),y=xr(),b=e8(),w=ti(),k=Ai(),S=1,C=2,T=4,j="[object Arguments]",R="[object Array]",E="[object Boolean]",M="[object Date]",$="[object Error]",N="[object Function]",D="[object GeneratorFunction]",I="[object Map]",F="[object Number]",P="[object Object]",A="[object RegExp]",L="[object Set]",z="[object String]",B="[object Symbol]",X="[object WeakMap]",G="[object ArrayBuffer]",W="[object DataView]",q="[object Float32Array]",Q="[object Float64Array]",ie="[object Int8Array]",oe="[object Int16Array]",J="[object Int32Array]",je="[object Uint8Array]",ge="[object Uint8ClampedArray]",we="[object Uint16Array]",xe="[object Uint32Array]",se={};se[j]=se[R]=se[G]=se[W]=se[E]=se[M]=se[q]=se[Q]=se[ie]=se[oe]=se[J]=se[I]=se[F]=se[P]=se[A]=se[L]=se[z]=se[B]=se[je]=se[ge]=se[we]=se[xe]=!0,se[$]=se[N]=se[X]=!1;function K(re,U,de,fe,me,ye){var ee,he=U&S,De=U&C,nt=U&T;if(de&&(ee=me?de(re,fe,me,ye):de(re)),ee!==void 0)return ee;if(!y(re))return re;var Re=g(re);if(Re){if(ee=p(re),!he)return o(re,ee)}else{var Me=f(re),Be=Me==N||Me==D;if(_(re))return s(re,he);if(Me==P||Me==j||Be&&!me){if(ee=De||Be?{}:x(re),!he)return De?c(re,i(ee,re)):l(re,n(ee,re))}else{if(!se[Me])return me?re:{};ee=h(re,Me,he)}}ye||(ye=new e);var et=ye.get(re);if(et)return et;ye.set(re,ee),b(re)?re.forEach(function(Ce){ee.add(K(Ce,U,de,Ce,re,ye))}):v(re)&&re.forEach(function(Ce,ve){ee.set(ve,K(Ce,U,de,ve,re,ye))});var Ae=nt?De?u:d:De?k:w,Z=Re?void 0:Ae(re);return t(Z||re,function(Ce,ve){Z&&(ve=Ce,Ce=re[ve]),r(ee,ve,K(Ce,U,de,ve,re,ye))}),ee}return op=K,op}var ap,F_;function t8(){if(F_)return ap;F_=1;var e=$E(),t=4;function r(n){return e(n,t)}return ap=r,ap}var lp,z_;function dy(){if(z_)return lp;z_=1;function e(t){return function(){return t}}return lp=e,lp}var cp,$_;function r8(){if($_)return cp;$_=1;function e(t){return function(r,n,i){for(var s=-1,o=Object(r),l=i(r),c=l.length;c--;){var d=l[t?c:++s];if(n(o[d],d,o)===!1)break}return r}}return cp=e,cp}var up,q_;function fy(){if(q_)return up;q_=1;var e=r8(),t=e();return up=t,up}var dp,B_;function py(){if(B_)return dp;B_=1;var e=fy(),t=ti();function r(n,i){return n&&e(n,i,t)}return dp=r,dp}var fp,H_;function n8(){if(H_)return fp;H_=1;var e=yn();function t(r,n){return function(i,s){if(i==null)return i;if(!e(i))return r(i,s);for(var o=i.length,l=n?o:-1,c=Object(i);(n?l--:++l<o)&&s(c[l],l,c)!==!1;);return i}}return fp=t,fp}var pp,W_;function uu(){if(W_)return pp;W_=1;var e=py(),t=n8(),r=t(e);return pp=r,pp}var hp,U_;function Ii(){if(U_)return hp;U_=1;function e(t){return t}return hp=e,hp}var mp,V_;function qE(){if(V_)return mp;V_=1;var e=Ii();function t(r){return typeof r=="function"?r:e}return mp=t,mp}var gp,G_;function BE(){if(G_)return gp;G_=1;var e=iy(),t=uu(),r=qE(),n=lt();function i(s,o){var l=n(s)?e:t;return l(s,r(o))}return gp=i,gp}var vp,K_;function HE(){return K_||(K_=1,vp=BE()),vp}var xp,Y_;function i8(){if(Y_)return xp;Y_=1;var e=uu();function t(r,n){var i=[];return e(r,function(s,o,l){n(s,o,l)&&i.push(s)}),i}return xp=t,xp}var yp,X_;function s8(){if(X_)return yp;X_=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return yp=t,yp}var bp,Q_;function o8(){if(Q_)return bp;Q_=1;function e(t){return this.__data__.has(t)}return bp=e,bp}var _p,Z_;function WE(){if(Z_)return _p;Z_=1;var e=ny(),t=s8(),r=o8();function n(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new e;++s<o;)this.add(i[s])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,_p=n,_p}var wp,J_;function a8(){if(J_)return wp;J_=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return wp=e,wp}var jp,ew;function UE(){if(ew)return jp;ew=1;function e(t,r){return t.has(r)}return jp=e,jp}var Sp,tw;function VE(){if(tw)return Sp;tw=1;var e=WE(),t=a8(),r=UE(),n=1,i=2;function s(o,l,c,d,u,f){var p=c&n,h=o.length,x=l.length;if(h!=x&&!(p&&x>h))return!1;var g=f.get(o),_=f.get(l);if(g&&_)return g==l&&_==o;var v=-1,y=!0,b=c&i?new e:void 0;for(f.set(o,l),f.set(l,o);++v<h;){var w=o[v],k=l[v];if(d)var S=p?d(k,w,v,l,o,f):d(w,k,v,o,l,f);if(S!==void 0){if(S)continue;y=!1;break}if(b){if(!t(l,function(C,T){if(!r(b,T)&&(w===C||u(w,C,c,d,f)))return b.push(T)})){y=!1;break}}else if(!(w===k||u(w,k,c,d,f))){y=!1;break}}return f.delete(o),f.delete(l),y}return Sp=s,Sp}var kp,rw;function l8(){if(rw)return kp;rw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,s){n[++r]=[s,i]}),n}return kp=e,kp}var Np,nw;function hy(){if(nw)return Np;nw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return Np=e,Np}var Cp,iw;function c8(){if(iw)return Cp;iw=1;var e=Ms(),t=DE(),r=Is(),n=VE(),i=l8(),s=hy(),o=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",x="[object Set]",g="[object String]",_="[object Symbol]",v="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,w=b?b.valueOf:void 0;function k(S,C,T,j,R,E,M){switch(T){case y:if(S.byteLength!=C.byteLength||S.byteOffset!=C.byteOffset)return!1;S=S.buffer,C=C.buffer;case v:return!(S.byteLength!=C.byteLength||!E(new t(S),new t(C)));case c:case d:case p:return r(+S,+C);case u:return S.name==C.name&&S.message==C.message;case h:case g:return S==C+"";case f:var $=i;case x:var N=j&o;if($||($=s),S.size!=C.size&&!N)return!1;var D=M.get(S);if(D)return D==C;j|=l,M.set(S,C);var I=n($(S),$(C),j,R,E,M);return M.delete(S),I;case _:if(w)return w.call(S)==w.call(C)}return!1}return Cp=k,Cp}var Ep,sw;function u8(){if(sw)return Ep;sw=1;var e=PE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l,c,d,u){var f=l&t,p=e(s),h=p.length,x=e(o),g=x.length;if(h!=g&&!f)return!1;for(var _=h;_--;){var v=p[_];if(!(f?v in o:n.call(o,v)))return!1}var y=u.get(s),b=u.get(o);if(y&&b)return y==o&&b==s;var w=!0;u.set(s,o),u.set(o,s);for(var k=f;++_<h;){v=p[_];var S=s[v],C=o[v];if(c)var T=f?c(C,S,v,o,s,u):c(S,C,v,s,o,u);if(!(T===void 0?S===C||d(S,C,l,c,u):T)){w=!1;break}k||(k=v=="constructor")}if(w&&!k){var j=s.constructor,R=o.constructor;j!=R&&"constructor"in s&&"constructor"in o&&!(typeof j=="function"&&j instanceof j&&typeof R=="function"&&R instanceof R)&&(w=!1)}return u.delete(s),u.delete(o),w}return Ep=i,Ep}var Tp,ow;function d8(){if(ow)return Tp;ow=1;var e=nu(),t=VE(),r=c8(),n=u8(),i=Os(),s=lt(),o=Ps(),l=ja(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function x(g,_,v,y,b,w){var k=s(g),S=s(_),C=k?u:i(g),T=S?u:i(_);C=C==d?f:C,T=T==d?f:T;var j=C==f,R=T==f,E=C==T;if(E&&o(g)){if(!o(_))return!1;k=!0,j=!1}if(E&&!j)return w||(w=new e),k||l(g)?t(g,_,v,y,b,w):r(g,_,C,v,y,b,w);if(!(v&c)){var M=j&&h.call(g,"__wrapped__"),$=R&&h.call(_,"__wrapped__");if(M||$){var N=M?g.value():g,D=$?_.value():_;return w||(w=new e),b(N,D,v,y,w)}}return E?(w||(w=new e),n(g,_,v,y,b,w)):!1}return Tp=x,Tp}var Rp,aw;function GE(){if(aw)return Rp;aw=1;var e=d8(),t=Yr();function r(n,i,s,o,l){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,s,o,r,l)}return Rp=r,Rp}var Ap,lw;function f8(){if(lw)return Ap;lw=1;var e=nu(),t=GE(),r=1,n=2;function i(s,o,l,c){var d=l.length,u=d,f=!c;if(s==null)return!u;for(s=Object(s);d--;){var p=l[d];if(f&&p[2]?p[1]!==s[p[0]]:!(p[0]in s))return!1}for(;++d<u;){p=l[d];var h=p[0],x=s[h],g=p[1];if(f&&p[2]){if(x===void 0&&!(h in s))return!1}else{var _=new e;if(c)var v=c(x,g,h,s,o,_);if(!(v===void 0?t(g,x,r|n,c,_):v))return!1}}return!0}return Ap=i,Ap}var Ip,cw;function KE(){if(cw)return Ip;cw=1;var e=xr();function t(r){return r===r&&!e(r)}return Ip=t,Ip}var Mp,uw;function p8(){if(uw)return Mp;uw=1;var e=KE(),t=ti();function r(n){for(var i=t(n),s=i.length;s--;){var o=i[s],l=n[o];i[s]=[o,l,e(l)]}return i}return Mp=r,Mp}var Pp,dw;function YE(){if(dw)return Pp;dw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Pp=e,Pp}var Op,fw;function h8(){if(fw)return Op;fw=1;var e=f8(),t=p8(),r=YE();function n(i){var s=t(i);return s.length==1&&s[0][2]?r(s[0][0],s[0][1]):function(o){return o===i||e(o,i,s)}}return Op=n,Op}var Dp,pw;function Ds(){if(pw)return Dp;pw=1;var e=Ti(),t=Yr(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Dp=n,Dp}var Lp,hw;function my(){if(hw)return Lp;hw=1;var e=lt(),t=Ds(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){if(e(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return Lp=i,Lp}var Fp,mw;function m8(){if(mw)return Fp;mw=1;var e=ny(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var d=n.apply(this,o);return s.cache=c.set(l,d)||c,d};return s.cache=new(r.Cache||e),s}return r.Cache=e,Fp=r,Fp}var zp,gw;function g8(){if(gw)return zp;gw=1;var e=m8(),t=500;function r(n){var i=e(n,function(o){return s.size===t&&s.clear(),o}),s=i.cache;return i}return zp=r,zp}var $p,vw;function v8(){if(vw)return $p;vw=1;var e=g8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(t,function(o,l,c,d){s.push(c?d.replace(r,"$1"):l||o)}),s});return $p=n,$p}var qp,xw;function du(){if(xw)return qp;xw=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=Array(i);++n<i;)s[n]=r(t[n],n,t);return s}return qp=e,qp}var Bp,yw;function x8(){if(yw)return Bp;yw=1;var e=Ms(),t=du(),r=lt(),n=Ds(),i=e?e.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return t(l,o)+"";if(n(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Bp=o,Bp}var Hp,bw;function XE(){if(bw)return Hp;bw=1;var e=x8();function t(r){return r==null?"":e(r)}return Hp=t,Hp}var Wp,_w;function fu(){if(_w)return Wp;_w=1;var e=lt(),t=my(),r=v8(),n=XE();function i(s,o){return e(s)?s:t(s,o)?[s]:r(n(s))}return Wp=i,Wp}var Up,ww;function Sa(){if(ww)return Up;ww=1;var e=Ds();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Up=t,Up}var Vp,jw;function pu(){if(jw)return Vp;jw=1;var e=fu(),t=Sa();function r(n,i){i=e(i,n);for(var s=0,o=i.length;n!=null&&s<o;)n=n[t(i[s++])];return s&&s==o?n:void 0}return Vp=r,Vp}var Gp,Sw;function y8(){if(Sw)return Gp;Sw=1;var e=pu();function t(r,n,i){var s=r==null?void 0:e(r,n);return s===void 0?i:s}return Gp=t,Gp}var Kp,kw;function b8(){if(kw)return Kp;kw=1;function e(t,r){return t!=null&&r in Object(t)}return Kp=e,Kp}var Yp,Nw;function QE(){if(Nw)return Yp;Nw=1;var e=fu(),t=wa(),r=lt(),n=ou(),i=sy(),s=Sa();function o(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=s(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&i(f)&&n(h,f)&&(r(l)||t(l)))}return Yp=o,Yp}var Xp,Cw;function ZE(){if(Cw)return Xp;Cw=1;var e=b8(),t=QE();function r(n,i){return n!=null&&t(n,i,e)}return Xp=r,Xp}var Qp,Ew;function _8(){if(Ew)return Qp;Ew=1;var e=GE(),t=y8(),r=ZE(),n=my(),i=KE(),s=YE(),o=Sa(),l=1,c=2;function d(u,f){return n(u)&&i(f)?s(o(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?r(p,u):e(f,h,l|c)}}return Qp=d,Qp}var Zp,Tw;function JE(){if(Tw)return Zp;Tw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return Zp=e,Zp}var Jp,Rw;function w8(){if(Rw)return Jp;Rw=1;var e=pu();function t(r){return function(n){return e(n,r)}}return Jp=t,Jp}var eh,Aw;function j8(){if(Aw)return eh;Aw=1;var e=JE(),t=w8(),r=my(),n=Sa();function i(s){return r(s)?e(n(s)):t(s)}return eh=i,eh}var th,Iw;function bn(){if(Iw)return th;Iw=1;var e=h8(),t=_8(),r=Ii(),n=lt(),i=j8();function s(o){return typeof o=="function"?o:o==null?r:typeof o=="object"?n(o)?t(o[0],o[1]):e(o):i(o)}return th=s,th}var rh,Mw;function e4(){if(Mw)return rh;Mw=1;var e=RE(),t=i8(),r=bn(),n=lt();function i(s,o){var l=n(s)?e:t;return l(s,r(o,3))}return rh=i,rh}var nh,Pw;function S8(){if(Pw)return nh;Pw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return nh=r,nh}var ih,Ow;function t4(){if(Ow)return ih;Ow=1;var e=S8(),t=QE();function r(n,i){return n!=null&&t(n,i,e)}return ih=r,ih}var sh,Dw;function k8(){if(Dw)return sh;Dw=1;var e=ay(),t=Os(),r=wa(),n=lt(),i=yn(),s=Ps(),o=lu(),l=ja(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(i(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||s(h)||l(h)||r(h)))return!h.length;var x=t(h);if(x==c||x==d)return!h.size;if(o(h))return!e(h).length;for(var g in h)if(f.call(h,g))return!1;return!0}return sh=p,sh}var oh,Lw;function r4(){if(Lw)return oh;Lw=1;function e(t){return t===void 0}return oh=e,oh}var ah,Fw;function n4(){if(Fw)return ah;Fw=1;var e=uu(),t=yn();function r(n,i){var s=-1,o=t(n)?Array(n.length):[];return e(n,function(l,c,d){o[++s]=i(l,c,d)}),o}return ah=r,ah}var lh,zw;function i4(){if(zw)return lh;zw=1;var e=du(),t=bn(),r=n4(),n=lt();function i(s,o){var l=n(s)?e:r;return l(s,t(o,3))}return lh=i,lh}var ch,$w;function N8(){if($w)return ch;$w=1;function e(t,r,n,i){var s=-1,o=t==null?0:t.length;for(i&&o&&(n=t[++s]);++s<o;)n=r(n,t[s],s,t);return n}return ch=e,ch}var uh,qw;function C8(){if(qw)return uh;qw=1;function e(t,r,n,i,s){return s(t,function(o,l,c){n=i?(i=!1,o):r(n,o,l,c)}),n}return uh=e,uh}var dh,Bw;function s4(){if(Bw)return dh;Bw=1;var e=N8(),t=uu(),r=bn(),n=C8(),i=lt();function s(o,l,c){var d=i(o)?e:n,u=arguments.length<3;return d(o,r(l,4),c,u,t)}return dh=s,dh}var fh,Hw;function E8(){if(Hw)return fh;Hw=1;var e=Ti(),t=lt(),r=Yr(),n="[object String]";function i(s){return typeof s=="string"||!t(s)&&r(s)&&e(s)==n}return fh=i,fh}var ph,Ww;function T8(){if(Ww)return ph;Ww=1;var e=JE(),t=e("length");return ph=t,ph}var hh,Uw;function R8(){if(Uw)return hh;Uw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="\\u200d",l=RegExp("["+o+e+i+s+"]");function c(d){return l.test(d)}return hh=c,hh}var mh,Vw;function A8(){if(Vw)return mh;Vw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="["+e+"]",l="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",x=d+"?",g="["+s+"]?",_="(?:"+h+"(?:"+[u,f,p].join("|")+")"+g+x+")*",v=g+x+_,y="(?:"+[u+l+"?",l,f,p,o].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+v,"g");function w(k){for(var S=b.lastIndex=0;b.test(k);)++S;return S}return mh=w,mh}var gh,Gw;function I8(){if(Gw)return gh;Gw=1;var e=T8(),t=R8(),r=A8();function n(i){return t(i)?r(i):e(i)}return gh=n,gh}var vh,Kw;function M8(){if(Kw)return vh;Kw=1;var e=ay(),t=Os(),r=yn(),n=E8(),i=I8(),s="[object Map]",o="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?i(c):c.length;var d=t(c);return d==s||d==o?c.size:e(c).length}return vh=l,vh}var xh,Yw;function P8(){if(Yw)return xh;Yw=1;var e=iy(),t=FE(),r=py(),n=bn(),i=cu(),s=lt(),o=Ps(),l=ba(),c=xr(),d=ja();function u(f,p,h){var x=s(f),g=x||o(f)||d(f);if(p=n(p,4),h==null){var _=f&&f.constructor;g?h=x?new _:[]:c(f)?h=l(_)?t(i(f)):{}:h={}}return(g?e:r)(f,function(v,y,b){return p(h,v,y,b)}),h}return xh=u,xh}var yh,Xw;function O8(){if(Xw)return yh;Xw=1;var e=Ms(),t=wa(),r=lt(),n=e?e.isConcatSpreadable:void 0;function i(s){return r(s)||t(s)||!!(n&&s&&s[n])}return yh=i,yh}var bh,Qw;function gy(){if(Qw)return bh;Qw=1;var e=cy(),t=O8();function r(n,i,s,o,l){var c=-1,d=n.length;for(s||(s=t),l||(l=[]);++c<d;){var u=n[c];i>0&&s(u)?i>1?r(u,i-1,s,o,l):e(l,u):o||(l[l.length]=u)}return l}return bh=r,bh}var _h,Zw;function D8(){if(Zw)return _h;Zw=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return _h=e,_h}var wh,Jw;function o4(){if(Jw)return wh;Jw=1;var e=D8(),t=Math.max;function r(n,i,s){return i=t(i===void 0?n.length-1:i,0),function(){for(var o=arguments,l=-1,c=t(o.length-i,0),d=Array(c);++l<c;)d[l]=o[i+l];l=-1;for(var u=Array(i+1);++l<i;)u[l]=o[l];return u[i]=s(d),e(n,this,u)}}return wh=r,wh}var jh,ej;function L8(){if(ej)return jh;ej=1;var e=dy(),t=kE(),r=Ii(),n=t?function(i,s){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(s),writable:!0})}:r;return jh=n,jh}var Sh,tj;function F8(){if(tj)return Sh;tj=1;var e=800,t=16,r=Date.now;function n(i){var s=0,o=0;return function(){var l=r(),c=t-(l-o);if(o=l,c>0){if(++s>=e)return arguments[0]}else s=0;return i.apply(void 0,arguments)}}return Sh=n,Sh}var kh,rj;function a4(){if(rj)return kh;rj=1;var e=L8(),t=F8(),r=t(e);return kh=r,kh}var Nh,nj;function hu(){if(nj)return Nh;nj=1;var e=Ii(),t=o4(),r=a4();function n(i,s){return r(t(i,s,e),i+"")}return Nh=n,Nh}var Ch,ij;function l4(){if(ij)return Ch;ij=1;function e(t,r,n,i){for(var s=t.length,o=n+(i?1:-1);i?o--:++o<s;)if(r(t[o],o,t))return o;return-1}return Ch=e,Ch}var Eh,sj;function z8(){if(sj)return Eh;sj=1;function e(t){return t!==t}return Eh=e,Eh}var Th,oj;function $8(){if(oj)return Th;oj=1;function e(t,r,n){for(var i=n-1,s=t.length;++i<s;)if(t[i]===r)return i;return-1}return Th=e,Th}var Rh,aj;function q8(){if(aj)return Rh;aj=1;var e=l4(),t=z8(),r=$8();function n(i,s,o){return s===s?r(i,s,o):e(i,t,o)}return Rh=n,Rh}var Ah,lj;function B8(){if(lj)return Ah;lj=1;var e=q8();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return Ah=t,Ah}var Ih,cj;function H8(){if(cj)return Ih;cj=1;function e(t,r,n){for(var i=-1,s=t==null?0:t.length;++i<s;)if(n(r,t[i]))return!0;return!1}return Ih=e,Ih}var Mh,uj;function W8(){if(uj)return Mh;uj=1;function e(){}return Mh=e,Mh}var Ph,dj;function U8(){if(dj)return Ph;dj=1;var e=OE(),t=W8(),r=hy(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(s){return new e(s)}:t;return Ph=i,Ph}var Oh,fj;function V8(){if(fj)return Oh;fj=1;var e=WE(),t=B8(),r=H8(),n=UE(),i=U8(),s=hy(),o=200;function l(c,d,u){var f=-1,p=t,h=c.length,x=!0,g=[],_=g;if(u)x=!1,p=r;else if(h>=o){var v=d?null:i(c);if(v)return s(v);x=!1,p=n,_=new e}else _=d?[]:g;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,x&&b===b){for(var w=_.length;w--;)if(_[w]===b)continue e;d&&_.push(b),g.push(y)}else p(_,b,u)||(_!==g&&_.push(b),g.push(y))}return g}return Oh=l,Oh}var Dh,pj;function c4(){if(pj)return Dh;pj=1;var e=yn(),t=Yr();function r(n){return t(n)&&e(n)}return Dh=r,Dh}var Lh,hj;function G8(){if(hj)return Lh;hj=1;var e=gy(),t=hu(),r=V8(),n=c4(),i=t(function(s){return r(e(s,1,n,!0))});return Lh=i,Lh}var Fh,mj;function K8(){if(mj)return Fh;mj=1;var e=du();function t(r,n){return e(n,function(i){return r[i]})}return Fh=t,Fh}var zh,gj;function u4(){if(gj)return zh;gj=1;var e=K8(),t=ti();function r(n){return n==null?[]:e(n,t(n))}return zh=r,zh}var $h,vj;function yr(){if(vj)return $h;vj=1;var e;if(typeof ty=="function")try{e={clone:t8(),constant:dy(),each:HE(),filter:e4(),has:t4(),isArray:lt(),isEmpty:k8(),isFunction:ba(),isUndefined:r4(),keys:ti(),map:i4(),reduce:s4(),size:M8(),transform:P8(),union:G8(),values:u4()}}catch{}return e||(e=window._),$h=e,$h}var qh,xj;function vy(){if(xj)return qh;xj=1;var e=yr();qh=i;var t="\0",r="\0",n="";function i(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},i.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},i.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(x){p.length>1?h.setNode(x,f):h.setNode(x)}),this},i.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=r,this._children[u]={},this._children[r][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return e.has(this._nodes,u)},i.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==r)return f}},i.prototype.children=function(u){if(e.isUndefined(u)&&(u=r),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===r)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},i.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},i.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},i.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},i.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(g,_){u(_)&&f.setNode(_,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,p.edge(g))});var h={};function x(g){var _=p.parent(g);return _===void 0||f.hasNode(_)?(h[g]=_,_):_ in h?h[_]:x(_)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,x(g))}),f},i.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(x,g){return h.length>1?p.setEdge(x,g,f):p.setEdge(x,g),g}),this},i.prototype.setEdge=function(){var u,f,p,h,x=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(u=g.v,f=g.w,p=g.name,arguments.length===2&&(h=arguments[1],x=!0)):(u=g,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],x=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var _=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,_))return x&&(this._edgeLabels[_]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[_]=x?h:this._defaultEdgeLabelFn(u,f,p);var v=c(this._isDirected,u,f,p);return u=v.v,f=v.w,Object.freeze(v),this._edgeObjs[_]=v,s(this._preds[f],u),s(this._sucs[u],f),this._in[f][_]=v,this._out[u][_]=v,this._edgeCount++,this},i.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},i.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),x=this._edgeObjs[h];return x&&(u=x.v,f=x.w,delete this._edgeLabels[h],delete this._edgeObjs[h],o(this._preds[f],u),o(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},i.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.v===f}):h}},i.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.w===f}):h}},i.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function s(u,f){u[f]?u[f]++:u[f]=1}function o(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var x=""+f,g=""+p;if(!u&&x>g){var _=x;x=g,g=_}return x+n+g+n+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var x=""+f,g=""+p;if(!u&&x>g){var _=x;x=g,g=_}var v={v:x,w:g};return h&&(v.name=h),v}function d(u,f){return l(u,f.v,f.w,f.name)}return qh}var Bh,yj;function Y8(){return yj||(yj=1,Bh="2.1.8"),Bh}var Hh,bj;function X8(){return bj||(bj=1,Hh={Graph:vy(),version:Y8()}),Hh}var Wh,_j;function Q8(){if(_j)return Wh;_j=1;var e=yr(),t=vy();Wh={write:r,read:s};function r(o){var l={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:n(o),edges:i(o)};return e.isUndefined(o.graph())||(l.value=e.clone(o.graph())),l}function n(o){return e.map(o.nodes(),function(l){var c=o.node(l),d=o.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function i(o){return e.map(o.edges(),function(l){var c=o.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function s(o){var l=new t(o.options).setGraph(o.value);return e.each(o.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(o.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Wh}var Uh,wj;function Z8(){if(wj)return Uh;wj=1;var e=yr();Uh=t;function t(r){var n={},i=[],s;function o(l){e.has(n,l)||(n[l]=!0,s.push(l),e.each(r.successors(l),o),e.each(r.predecessors(l),o))}return e.each(r.nodes(),function(l){s=[],o(l),s.length&&i.push(s)}),i}return Uh}var Vh,jj;function d4(){if(jj)return Vh;jj=1;var e=yr();Vh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var s=this._arr,o=s.length;return i[r]=o,s.push({key:r,priority:n}),this._decrease(o),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,s=i+1,o=r;i<n.length&&(o=n[i].priority<n[o].priority?i:o,s<n.length&&(o=n[s].priority<n[o].priority?s:o),o!==r&&(this._swap(r,o),this._heapify(o)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,s;r!==0&&(s=r>>1,!(n[s].priority<i));)this._swap(r,s),r=s},t.prototype._swap=function(r,n){var i=this._arr,s=this._keyIndices,o=i[r],l=i[n];i[r]=l,i[n]=o,s[l.key]=r,s[o.key]=n},Vh}var Gh,Sj;function f4(){if(Sj)return Gh;Sj=1;var e=yr(),t=d4();Gh=n;var r=e.constant(1);function n(s,o,l,c){return i(s,String(o),l||r,c||function(d){return s.outEdges(d)})}function i(s,o,l,c){var d={},u=new t,f,p,h=function(x){var g=x.v!==f?x.v:x.w,_=d[g],v=l(x),y=p.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+x+" Weight: "+v);y<_.distance&&(_.distance=y,_.predecessor=f,u.decrease(g,y))};for(s.nodes().forEach(function(x){var g=x===o?0:Number.POSITIVE_INFINITY;d[x]={distance:g},u.add(x,g)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return Gh}var Kh,kj;function J8(){if(kj)return Kh;kj=1;var e=f4(),t=yr();Kh=r;function r(n,i,s){return t.transform(n.nodes(),function(o,l){o[l]=e(n,l,i,s)},{})}return Kh}var Yh,Nj;function p4(){if(Nj)return Yh;Nj=1;var e=yr();Yh=t;function t(r){var n=0,i=[],s={},o=[];function l(c){var d=s[c]={onStack:!0,lowlink:n,index:n++};if(i.push(c),r.successors(c).forEach(function(p){e.has(s,p)?s[p].onStack&&(d.lowlink=Math.min(d.lowlink,s[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,s[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=i.pop(),s[f].onStack=!1,u.push(f);while(c!==f);o.push(u)}}return r.nodes().forEach(function(c){e.has(s,c)||l(c)}),o}return Yh}var Xh,Cj;function eF(){if(Cj)return Xh;Cj=1;var e=yr(),t=p4();Xh=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Xh}var Qh,Ej;function tF(){if(Ej)return Qh;Ej=1;var e=yr();Qh=r;var t=e.constant(1);function r(i,s,o){return n(i,s||t,o||function(l){return i.outEdges(l)})}function n(i,s,o){var l={},c=i.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),o(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=s(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var x=p[d],g=u[h],_=p[h],v=x.distance+g.distance;v<_.distance&&(_.distance=v,_.predecessor=g.predecessor)})})}),l}return Qh}var Zh,Tj;function h4(){if(Tj)return Zh;Tj=1;var e=yr();Zh=t,t.CycleException=r;function t(n){var i={},s={},o=[];function l(c){if(e.has(s,c))throw new r;e.has(i,c)||(s[c]=!0,i[c]=!0,e.each(n.predecessors(c),l),delete s[c],o.push(c))}if(e.each(n.sinks(),l),e.size(i)!==n.nodeCount())throw new r;return o}function r(){}return r.prototype=new Error,Zh}var Jh,Rj;function rF(){if(Rj)return Jh;Rj=1;var e=h4();Jh=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return Jh}var em,Aj;function m4(){if(Aj)return em;Aj=1;var e=yr();em=t;function t(n,i,s){e.isArray(i)||(i=[i]);var o=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(i,function(d){if(!n.hasNode(d))throw new Error("Graph does not have node: "+d);r(n,d,s==="post",c,o,l)}),l}function r(n,i,s,o,l,c){e.has(o,i)||(o[i]=!0,s||c.push(i),e.each(l(i),function(d){r(n,d,s,o,l,c)}),s&&c.push(i))}return em}var tm,Ij;function nF(){if(Ij)return tm;Ij=1;var e=m4();tm=t;function t(r,n){return e(r,n,"post")}return tm}var rm,Mj;function iF(){if(Mj)return rm;Mj=1;var e=m4();rm=t;function t(r,n){return e(r,n,"pre")}return rm}var nm,Pj;function sF(){if(Pj)return nm;Pj=1;var e=yr(),t=vy(),r=d4();nm=n;function n(i,s){var o=new t,l={},c=new r,d;function u(p){var h=p.v===d?p.w:p.v,x=c.priority(h);if(x!==void 0){var g=s(p);g<x&&(l[h]=d,c.decrease(h,g))}}if(i.nodeCount()===0)return o;e.each(i.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),o.setNode(p)}),c.decrease(i.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))o.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+i);f=!0}i.nodeEdges(d).forEach(u)}return o}return nm}var im,Oj;function oF(){return Oj||(Oj=1,im={components:Z8(),dijkstra:f4(),dijkstraAll:J8(),findCycles:eF(),floydWarshall:tF(),isAcyclic:rF(),postorder:nF(),preorder:iF(),prim:sF(),tarjan:p4(),topsort:h4()}),im}var sm,Dj;function aF(){if(Dj)return sm;Dj=1;var e=X8();return sm={Graph:e.Graph,json:Q8(),alg:oF(),version:e.version},sm}var dc;if(typeof ty=="function")try{dc=aF()}catch{}dc||(dc=window.graphlib);var Pr=dc,om,Lj;function lF(){if(Lj)return om;Lj=1;var e=$E(),t=1,r=4;function n(i){return e(i,t|r)}return om=n,om}var am,Fj;function mu(){if(Fj)return am;Fj=1;var e=Is(),t=yn(),r=ou(),n=xr();function i(s,o,l){if(!n(l))return!1;var c=typeof o;return(c=="number"?t(l)&&r(o,l.length):c=="string"&&o in l)?e(l[o],s):!1}return am=i,am}var lm,zj;function cF(){if(zj)return lm;zj=1;var e=hu(),t=Is(),r=mu(),n=Ai(),i=Object.prototype,s=i.hasOwnProperty,o=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=n(p),x=-1,g=h.length;++x<g;){var _=h[x],v=l[_];(v===void 0||t(v,i[_])&&!s.call(l,_))&&(l[_]=p[_])}return l});return lm=o,lm}var cm,$j;function uF(){if($j)return cm;$j=1;var e=bn(),t=yn(),r=ti();function n(i){return function(s,o,l){var c=Object(s);if(!t(s)){var d=e(o,3);s=r(s),o=function(f){return d(c[f],f,c)}}var u=i(s,o,l);return u>-1?c[d?s[u]:u]:void 0}}return cm=n,cm}var um,qj;function dF(){if(qj)return um;qj=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return um=t,um}var dm,Bj;function fF(){if(Bj)return dm;Bj=1;var e=dF(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return dm=r,dm}var fm,Hj;function pF(){if(Hj)return fm;Hj=1;var e=fF(),t=xr(),r=Ds(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return n;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=s.test(d);return f||o.test(d)?l(d.slice(2),f?2:8):i.test(d)?n:+d}return fm=c,fm}var pm,Wj;function g4(){if(Wj)return pm;Wj=1;var e=pF(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var s=i<0?-1:1;return s*r}return i===i?i:0}return pm=n,pm}var hm,Uj;function hF(){if(Uj)return hm;Uj=1;var e=g4();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return hm=t,hm}var mm,Vj;function mF(){if(Vj)return mm;Vj=1;var e=l4(),t=bn(),r=hF(),n=Math.max;function i(s,o,l){var c=s==null?0:s.length;if(!c)return-1;var d=l==null?0:r(l);return d<0&&(d=n(c+d,0)),e(s,t(o,3),d)}return mm=i,mm}var gm,Gj;function gF(){if(Gj)return gm;Gj=1;var e=uF(),t=mF(),r=e(t);return gm=r,gm}var vm,Kj;function v4(){if(Kj)return vm;Kj=1;var e=gy();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return vm=t,vm}var xm,Yj;function vF(){if(Yj)return xm;Yj=1;var e=fy(),t=qE(),r=Ai();function n(i,s){return i==null?i:e(i,t(s),r)}return xm=n,xm}var ym,Xj;function xF(){if(Xj)return ym;Xj=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return ym=e,ym}var bm,Qj;function yF(){if(Qj)return bm;Qj=1;var e=iu(),t=py(),r=bn();function n(i,s){var o={};return s=r(s,3),t(i,function(l,c,d){e(o,c,s(l,c,d))}),o}return bm=n,bm}var _m,Zj;function xy(){if(Zj)return _m;Zj=1;var e=Ds();function t(r,n,i){for(var s=-1,o=r.length;++s<o;){var l=r[s],c=n(l);if(c!=null&&(d===void 0?c===c&&!e(c):i(c,d)))var d=c,u=l}return u}return _m=t,_m}var wm,Jj;function bF(){if(Jj)return wm;Jj=1;function e(t,r){return t>r}return wm=e,wm}var jm,e2;function _F(){if(e2)return jm;e2=1;var e=xy(),t=bF(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return jm=n,jm}var Sm,t2;function x4(){if(t2)return Sm;t2=1;var e=iu(),t=Is();function r(n,i,s){(s!==void 0&&!t(n[i],s)||s===void 0&&!(i in n))&&e(n,i,s)}return Sm=r,Sm}var km,r2;function wF(){if(r2)return km;r2=1;var e=Ti(),t=cu(),r=Yr(),n="[object Object]",i=Function.prototype,s=Object.prototype,o=i.toString,l=s.hasOwnProperty,c=o.call(Object);function d(u){if(!r(u)||e(u)!=n)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&o.call(p)==c}return km=d,km}var Nm,n2;function y4(){if(n2)return Nm;n2=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Nm=e,Nm}var Cm,i2;function jF(){if(i2)return Cm;i2=1;var e=_a(),t=Ai();function r(n){return e(n,t(n))}return Cm=r,Cm}var Em,s2;function SF(){if(s2)return Em;s2=1;var e=x4(),t=EE(),r=LE(),n=TE(),i=zE(),s=wa(),o=lt(),l=c4(),c=Ps(),d=ba(),u=xr(),f=wF(),p=ja(),h=y4(),x=jF();function g(_,v,y,b,w,k,S){var C=h(_,y),T=h(v,y),j=S.get(T);if(j){e(_,y,j);return}var R=k?k(C,T,y+"",_,v,S):void 0,E=R===void 0;if(E){var M=o(T),$=!M&&c(T),N=!M&&!$&&p(T);R=T,M||$||N?o(C)?R=C:l(C)?R=n(C):$?(E=!1,R=t(T,!0)):N?(E=!1,R=r(T,!0)):R=[]:f(T)||s(T)?(R=C,s(C)?R=x(C):(!u(C)||d(C))&&(R=i(T))):E=!1}E&&(S.set(T,R),w(R,T,b,k,S),S.delete(T)),e(_,y,R)}return Em=g,Em}var Tm,o2;function kF(){if(o2)return Tm;o2=1;var e=nu(),t=x4(),r=fy(),n=SF(),i=xr(),s=Ai(),o=y4();function l(c,d,u,f,p){c!==d&&r(d,function(h,x){if(p||(p=new e),i(h))n(c,d,x,u,l,f,p);else{var g=f?f(o(c,x),h,x+"",c,d,p):void 0;g===void 0&&(g=h),t(c,x,g)}},s)}return Tm=l,Tm}var Rm,a2;function NF(){if(a2)return Rm;a2=1;var e=hu(),t=mu();function r(n){return e(function(i,s){var o=-1,l=s.length,c=l>1?s[l-1]:void 0,d=l>2?s[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(s[0],s[1],d)&&(c=l<3?void 0:c,l=1),i=Object(i);++o<l;){var u=s[o];u&&n(i,u,o,c)}return i})}return Rm=r,Rm}var Am,l2;function CF(){if(l2)return Am;l2=1;var e=kF(),t=NF(),r=t(function(n,i,s){e(n,i,s)});return Am=r,Am}var Im,c2;function b4(){if(c2)return Im;c2=1;function e(t,r){return t<r}return Im=e,Im}var Mm,u2;function EF(){if(u2)return Mm;u2=1;var e=xy(),t=b4(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return Mm=n,Mm}var Pm,d2;function TF(){if(d2)return Pm;d2=1;var e=xy(),t=bn(),r=b4();function n(i,s){return i&&i.length?e(i,t(s,2),r):void 0}return Pm=n,Pm}var Om,f2;function RF(){if(f2)return Om;f2=1;var e=Mr(),t=function(){return e.Date.now()};return Om=t,Om}var Dm,p2;function AF(){if(p2)return Dm;p2=1;var e=su(),t=fu(),r=ou(),n=xr(),i=Sa();function s(o,l,c,d){if(!n(o))return o;l=t(l,o);for(var u=-1,f=l.length,p=f-1,h=o;h!=null&&++u<f;){var x=i(l[u]),g=c;if(x==="__proto__"||x==="constructor"||x==="prototype")return o;if(u!=p){var _=h[x];g=d?d(_,x,h):void 0,g===void 0&&(g=n(_)?_:r(l[u+1])?[]:{})}e(h,x,g),h=h[x]}return o}return Dm=s,Dm}var Lm,h2;function IF(){if(h2)return Lm;h2=1;var e=pu(),t=AF(),r=fu();function n(i,s,o){for(var l=-1,c=s.length,d={};++l<c;){var u=s[l],f=e(i,u);o(f,u)&&t(d,r(u,i),f)}return d}return Lm=n,Lm}var Fm,m2;function MF(){if(m2)return Fm;m2=1;var e=IF(),t=ZE();function r(n,i){return e(n,i,function(s,o){return t(n,o)})}return Fm=r,Fm}var zm,g2;function PF(){if(g2)return zm;g2=1;var e=v4(),t=o4(),r=a4();function n(i){return r(t(i,void 0,e),i+"")}return zm=n,zm}var $m,v2;function OF(){if(v2)return $m;v2=1;var e=MF(),t=PF(),r=t(function(n,i){return n==null?{}:e(n,i)});return $m=r,$m}var qm,x2;function DF(){if(x2)return qm;x2=1;var e=Math.ceil,t=Math.max;function r(n,i,s,o){for(var l=-1,c=t(e((i-n)/(s||1)),0),d=Array(c);c--;)d[o?c:++l]=n,n+=s;return d}return qm=r,qm}var Bm,y2;function LF(){if(y2)return Bm;y2=1;var e=DF(),t=mu(),r=g4();function n(i){return function(s,o,l){return l&&typeof l!="number"&&t(s,o,l)&&(o=l=void 0),s=r(s),o===void 0?(o=s,s=0):o=r(o),l=l===void 0?s<o?1:-1:r(l),e(s,o,l,i)}}return Bm=n,Bm}var Hm,b2;function FF(){if(b2)return Hm;b2=1;var e=LF(),t=e();return Hm=t,Hm}var Wm,_2;function zF(){if(_2)return Wm;_2=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Wm=e,Wm}var Um,w2;function $F(){if(w2)return Um;w2=1;var e=Ds();function t(r,n){if(r!==n){var i=r!==void 0,s=r===null,o=r===r,l=e(r),c=n!==void 0,d=n===null,u=n===n,f=e(n);if(!d&&!f&&!l&&r>n||l&&c&&u&&!d&&!f||s&&c&&u||!i&&u||!o)return 1;if(!s&&!l&&!f&&r<n||f&&i&&o&&!s&&!l||d&&i&&o||!c&&o||!u)return-1}return 0}return Um=t,Um}var Vm,j2;function qF(){if(j2)return Vm;j2=1;var e=$F();function t(r,n,i){for(var s=-1,o=r.criteria,l=n.criteria,c=o.length,d=i.length;++s<c;){var u=e(o[s],l[s]);if(u){if(s>=d)return u;var f=i[s];return u*(f=="desc"?-1:1)}}return r.index-n.index}return Vm=t,Vm}var Gm,S2;function BF(){if(S2)return Gm;S2=1;var e=du(),t=pu(),r=bn(),n=n4(),i=zF(),s=au(),o=qF(),l=Ii(),c=lt();function d(u,f,p){f.length?f=e(f,function(g){return c(g)?function(_){return t(_,g.length===1?g[0]:g)}:g}):f=[l];var h=-1;f=e(f,s(r));var x=n(u,function(g,_,v){var y=e(f,function(b){return b(g)});return{criteria:y,index:++h,value:g}});return i(x,function(g,_){return o(g,_,p)})}return Gm=d,Gm}var Km,k2;function HF(){if(k2)return Km;k2=1;var e=gy(),t=BF(),r=hu(),n=mu(),i=r(function(s,o){if(s==null)return[];var l=o.length;return l>1&&n(s,o[0],o[1])?o=[]:l>2&&n(o[0],o[1],o[2])&&(o=[o[0]]),t(s,e(o,1),[])});return Km=i,Km}var Ym,N2;function WF(){if(N2)return Ym;N2=1;var e=XE(),t=0;function r(n){var i=++t;return e(n)+i}return Ym=r,Ym}var Xm,C2;function UF(){if(C2)return Xm;C2=1;function e(t,r,n){for(var i=-1,s=t.length,o=r.length,l={};++i<s;){var c=i<o?r[i]:void 0;n(l,t[i],c)}return l}return Xm=e,Xm}var Qm,E2;function VF(){if(E2)return Qm;E2=1;var e=su(),t=UF();function r(n,i){return t(n||[],i||[],e)}return Qm=r,Qm}var fc;if(typeof ty=="function")try{fc={cloneDeep:lF(),constant:dy(),defaults:cF(),each:HE(),filter:e4(),find:gF(),flatten:v4(),forEach:BE(),forIn:vF(),has:t4(),isUndefined:r4(),last:xF(),map:i4(),mapValues:yF(),max:_F(),merge:CF(),min:EF(),minBy:TF(),now:RF(),pick:OF(),range:FF(),reduce:s4(),sortBy:HF(),uniqueId:WF(),values:u4(),zipObject:VF()}}catch{}fc||(fc=window._);var Xe=fc,GF=gu;function gu(){var e={};e._next=e._prev=e,this._sentinel=e}gu.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return _4(t),t};gu.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&_4(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};gu.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,KF)),r=r._prev;return"["+e.join(", ")+"]"};function _4(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function KF(e,t){if(e!=="_next"&&e!=="_prev")return t}var on=Xe,YF=Pr.Graph,XF=GF,QF=JF,ZF=on.constant(1);function JF(e,t){if(e.nodeCount()<=1)return[];var r=tz(e,t||ZF),n=ez(r.graph,r.buckets,r.zeroIdx);return on.flatten(on.map(n,function(i){return e.outEdges(i.v,i.w)}),!0)}function ez(e,t,r){for(var n=[],i=t[t.length-1],s=t[0],o;e.nodeCount();){for(;o=s.dequeue();)Zm(e,t,r,o);for(;o=i.dequeue();)Zm(e,t,r,o);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(o=t[l].dequeue(),o){n=n.concat(Zm(e,t,r,o,!0));break}}}return n}function Zm(e,t,r,n,i){var s=i?[]:void 0;return on.forEach(e.inEdges(n.v),function(o){var l=e.edge(o),c=e.node(o.v);i&&s.push({v:o.v,w:o.w}),c.out-=l,Rv(t,r,c)}),on.forEach(e.outEdges(n.v),function(o){var l=e.edge(o),c=o.w,d=e.node(c);d.in-=l,Rv(t,r,d)}),e.removeNode(n.v),s}function tz(e,t){var r=new YF,n=0,i=0;on.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),on.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,d=t(l),u=c+d;r.setEdge(l.v,l.w,u),i=Math.max(i,r.node(l.v).out+=d),n=Math.max(n,r.node(l.w).in+=d)});var s=on.range(i+n+3).map(function(){return new XF}),o=n+1;return on.forEach(r.nodes(),function(l){Rv(s,o,r.node(l))}),{graph:r,buckets:s,zeroIdx:o}}function Rv(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var hi=Xe,rz=QF,nz={run:iz,undo:oz};function iz(e){var t=e.graph().acyclicer==="greedy"?rz(e,r(e)):sz(e);hi.forEach(t,function(n){var i=e.edge(n);e.removeEdge(n),i.forwardName=n.name,i.reversed=!0,e.setEdge(n.w,n.v,i,hi.uniqueId("rev"))});function r(n){return function(i){return n.edge(i).weight}}}function sz(e){var t=[],r={},n={};function i(s){hi.has(n,s)||(n[s]=!0,r[s]=!0,hi.forEach(e.outEdges(s),function(o){hi.has(r,o.w)?t.push(o):i(o.w)}),delete r[s])}return hi.forEach(e.nodes(),i),t}function oz(e){hi.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var ze=Xe,w4=Pr.Graph,Kt={addDummyNode:j4,simplify:az,asNonCompoundGraph:lz,successorWeights:cz,predecessorWeights:uz,intersectRect:dz,buildLayerMatrix:fz,normalizeRanks:pz,removeEmptyRanks:hz,addBorderNode:mz,maxRank:S4,partition:gz,time:vz,notime:xz};function j4(e,t,r,n){var i;do i=ze.uniqueId(n);while(e.hasNode(i));return r.dummy=t,e.setNode(i,r),i}function az(e){var t=new w4().setGraph(e.graph());return ze.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),ze.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},i=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),t}function lz(e){var t=new w4({multigraph:e.isMultigraph()}).setGraph(e.graph());return ze.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),ze.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function cz(e){var t=ze.map(e.nodes(),function(r){var n={};return ze.forEach(e.outEdges(r),function(i){n[i.w]=(n[i.w]||0)+e.edge(i).weight}),n});return ze.zipObject(e.nodes(),t)}function uz(e){var t=ze.map(e.nodes(),function(r){var n={};return ze.forEach(e.inEdges(r),function(i){n[i.v]=(n[i.v]||0)+e.edge(i).weight}),n});return ze.zipObject(e.nodes(),t)}function dz(e,t){var r=e.x,n=e.y,i=t.x-r,s=t.y-n,o=e.width/2,l=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(s)*o>Math.abs(i)*l?(s<0&&(l=-l),c=l*i/s,d=l):(i<0&&(o=-o),c=o,d=o*s/i),{x:r+c,y:n+d}}function fz(e){var t=ze.map(ze.range(S4(e)+1),function(){return[]});return ze.forEach(e.nodes(),function(r){var n=e.node(r),i=n.rank;ze.isUndefined(i)||(t[i][n.order]=r)}),t}function pz(e){var t=ze.min(ze.map(e.nodes(),function(r){return e.node(r).rank}));ze.forEach(e.nodes(),function(r){var n=e.node(r);ze.has(n,"rank")&&(n.rank-=t)})}function hz(e){var t=ze.min(ze.map(e.nodes(),function(s){return e.node(s).rank})),r=[];ze.forEach(e.nodes(),function(s){var o=e.node(s).rank-t;r[o]||(r[o]=[]),r[o].push(s)});var n=0,i=e.graph().nodeRankFactor;ze.forEach(r,function(s,o){ze.isUndefined(s)&&o%i!==0?--n:n&&ze.forEach(s,function(l){e.node(l).rank+=n})})}function mz(e,t,r,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=r,i.order=n),j4(e,"border",i,t)}function S4(e){return ze.max(ze.map(e.nodes(),function(t){var r=e.node(t).rank;if(!ze.isUndefined(r))return r}))}function gz(e,t){var r={lhs:[],rhs:[]};return ze.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function vz(e,t){var r=ze.now();try{return t()}finally{console.log(e+" time: "+(ze.now()-r)+"ms")}}function xz(e,t){return t()}var k4=Xe,yz=Kt,bz={run:_z,undo:jz};function _z(e){e.graph().dummyChains=[],k4.forEach(e.edges(),function(t){wz(e,t)})}function wz(e,t){var r=t.v,n=e.node(r).rank,i=t.w,s=e.node(i).rank,o=t.name,l=e.edge(t),c=l.labelRank;if(s!==n+1){e.removeEdge(t);var d,u,f;for(f=0,++n;n<s;++f,++n)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},d=yz.addDummyNode(e,"edge",u,"_d"),n===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(r,d,{weight:l.weight},o),f===0&&e.graph().dummyChains.push(d),r=d;e.setEdge(r,i,{weight:l.weight},o)}}function jz(e){k4.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,i;for(e.setEdge(r.edgeObj,n);r.dummy;)i=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=i,r=e.node(t)})}var nl=Xe,vu={longestPath:Sz,slack:kz};function Sz(e){var t={};function r(n){var i=e.node(n);if(nl.has(t,n))return i.rank;t[n]=!0;var s=nl.min(nl.map(e.outEdges(n),function(o){return r(o.w)-e.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}nl.forEach(e.sources(),r)}function kz(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var pc=Xe,Nz=Pr.Graph,hc=vu.slack,N4=Cz;function Cz(e){var t=new Nz({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var i,s;Ez(t,e)<n;)i=Tz(t,e),s=t.hasNode(i.v)?hc(e,i):-hc(e,i),Rz(t,e,s);return t}function Ez(e,t){function r(n){pc.forEach(t.nodeEdges(n),function(i){var s=i.v,o=n===s?i.w:s;!e.hasNode(o)&&!hc(t,i)&&(e.setNode(o,{}),e.setEdge(n,o,{}),r(o))})}return pc.forEach(e.nodes(),r),e.nodeCount()}function Tz(e,t){return pc.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return hc(t,r)})}function Rz(e,t,r){pc.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var gn=Xe,Az=N4,Iz=vu.slack,Mz=vu.longestPath,Pz=Pr.alg.preorder,Oz=Pr.alg.postorder,Dz=Kt.simplify,Lz=Mi;Mi.initLowLimValues=by;Mi.initCutValues=yy;Mi.calcCutValue=C4;Mi.leaveEdge=T4;Mi.enterEdge=R4;Mi.exchangeEdges=A4;function Mi(e){e=Dz(e),Mz(e);var t=Az(e);by(t),yy(t,e);for(var r,n;r=T4(t);)n=R4(t,e,r),A4(t,e,r,n)}function yy(e,t){var r=Oz(e,e.nodes());r=r.slice(0,r.length-1),gn.forEach(r,function(n){Fz(e,t,n)})}function Fz(e,t,r){var n=e.node(r),i=n.parent;e.edge(r,i).cutvalue=C4(e,t,r)}function C4(e,t,r){var n=e.node(r),i=n.parent,s=!0,o=t.edge(r,i),l=0;return o||(s=!1,o=t.edge(i,r)),l=o.weight,gn.forEach(t.nodeEdges(r),function(c){var d=c.v===r,u=d?c.w:c.v;if(u!==i){var f=d===s,p=t.edge(c).weight;if(l+=f?p:-p,$z(e,r,u)){var h=e.edge(r,u).cutvalue;l+=f?-h:h}}}),l}function by(e,t){arguments.length<2&&(t=e.nodes()[0]),E4(e,{},1,t)}function E4(e,t,r,n,i){var s=r,o=e.node(n);return t[n]=!0,gn.forEach(e.neighbors(n),function(l){gn.has(t,l)||(r=E4(e,t,r,l,n))}),o.low=s,o.lim=r++,i?o.parent=i:delete o.parent,r}function T4(e){return gn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function R4(e,t,r){var n=r.v,i=r.w;t.hasEdge(n,i)||(n=r.w,i=r.v);var s=e.node(n),o=e.node(i),l=s,c=!1;s.lim>o.lim&&(l=o,c=!0);var d=gn.filter(t.edges(),function(u){return c===T2(e,e.node(u.v),l)&&c!==T2(e,e.node(u.w),l)});return gn.minBy(d,function(u){return Iz(t,u)})}function A4(e,t,r,n){var i=r.v,s=r.w;e.removeEdge(i,s),e.setEdge(n.v,n.w,{}),by(e),yy(e,t),zz(e,t)}function zz(e,t){var r=gn.find(e.nodes(),function(i){return!t.node(i).parent}),n=Pz(e,r);n=n.slice(1),gn.forEach(n,function(i){var s=e.node(i).parent,o=t.edge(i,s),l=!1;o||(o=t.edge(s,i),l=!0),t.node(i).rank=t.node(s).rank+(l?o.minlen:-o.minlen)})}function $z(e,t,r){return e.hasEdge(t,r)}function T2(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var qz=vu,I4=qz.longestPath,Bz=N4,Hz=Lz,Wz=Uz;function Uz(e){switch(e.graph().ranker){case"network-simplex":R2(e);break;case"tight-tree":Gz(e);break;case"longest-path":Vz(e);break;default:R2(e)}}var Vz=I4;function Gz(e){I4(e),Bz(e)}function R2(e){Hz(e)}var Av=Xe,Kz=Yz;function Yz(e){var t=Qz(e);Av.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),i=n.edgeObj,s=Xz(e,t,i.v,i.w),o=s.path,l=s.lca,c=0,d=o[c],u=!0;r!==i.w;){if(n=e.node(r),u){for(;(d=o[c])!==l&&e.node(d).maxRank<n.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(d=o[c+1]).minRank<=n.rank;)c++;d=o[c]}e.setParent(r,d),r=e.successors(r)[0]}})}function Xz(e,t,r,n){var i=[],s=[],o=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,d;c=r;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||l>t[c].lim));for(d=c,c=n;(c=e.parent(c))!==d;)s.push(c);return{path:i.concat(s.reverse()),lca:d}}function Qz(e){var t={},r=0;function n(i){var s=r;Av.forEach(e.children(i),n),t[i]={low:s,lim:r++}}return Av.forEach(e.children(),n),t}var an=Xe,Iv=Kt,Zz={run:Jz,cleanup:r$};function Jz(e){var t=Iv.addDummyNode(e,"root",{},"_root"),r=e$(e),n=an.max(an.values(r))-1,i=2*n+1;e.graph().nestingRoot=t,an.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var s=t$(e)+1;an.forEach(e.children(),function(o){M4(e,t,i,s,n,r,o)}),e.graph().nodeRankFactor=i}function M4(e,t,r,n,i,s,o){var l=e.children(o);if(!l.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:r});return}var c=Iv.addBorderNode(e,"_bt"),d=Iv.addBorderNode(e,"_bb"),u=e.node(o);e.setParent(c,o),u.borderTop=c,e.setParent(d,o),u.borderBottom=d,an.forEach(l,function(f){M4(e,t,r,n,i,s,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,x=p.borderBottom?p.borderBottom:f,g=p.borderTop?n:2*n,_=h!==x?1:i-s[o]+1;e.setEdge(c,h,{weight:g,minlen:_,nestingEdge:!0}),e.setEdge(x,d,{weight:g,minlen:_,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+s[o]})}function e$(e){var t={};function r(n,i){var s=e.children(n);s&&s.length&&an.forEach(s,function(o){r(o,i+1)}),t[n]=i}return an.forEach(e.children(),function(n){r(n,1)}),t}function t$(e){return an.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function r$(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,an.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var Jm=Xe,n$=Kt,i$=s$;function s$(e){function t(r){var n=e.children(r),i=e.node(r);if(n.length&&Jm.forEach(n,t),Jm.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,o=i.maxRank+1;s<o;++s)A2(e,"borderLeft","_bl",r,i,s),A2(e,"borderRight","_br",r,i,s)}}Jm.forEach(e.children(),t)}function A2(e,t,r,n,i,s){var o={width:0,height:0,rank:s,borderType:t},l=i[t][s-1],c=n$.addDummyNode(e,"border",o,r);i[t][s]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var qr=Xe,o$={adjust:a$,undo:l$};function a$(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&P4(e)}function l$(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&c$(e),(t==="lr"||t==="rl")&&(u$(e),P4(e))}function P4(e){qr.forEach(e.nodes(),function(t){I2(e.node(t))}),qr.forEach(e.edges(),function(t){I2(e.edge(t))})}function I2(e){var t=e.width;e.width=e.height,e.height=t}function c$(e){qr.forEach(e.nodes(),function(t){eg(e.node(t))}),qr.forEach(e.edges(),function(t){var r=e.edge(t);qr.forEach(r.points,eg),qr.has(r,"y")&&eg(r)})}function eg(e){e.y=-e.y}function u$(e){qr.forEach(e.nodes(),function(t){tg(e.node(t))}),qr.forEach(e.edges(),function(t){var r=e.edge(t);qr.forEach(r.points,tg),qr.has(r,"x")&&tg(r)})}function tg(e){var t=e.x;e.x=e.y,e.y=t}var Qr=Xe,d$=f$;function f$(e){var t={},r=Qr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Qr.max(Qr.map(r,function(l){return e.node(l).rank})),i=Qr.map(Qr.range(n+1),function(){return[]});function s(l){if(!Qr.has(t,l)){t[l]=!0;var c=e.node(l);i[c.rank].push(l),Qr.forEach(e.successors(l),s)}}var o=Qr.sortBy(r,function(l){return e.node(l).rank});return Qr.forEach(o,s),i}var jn=Xe,p$=h$;function h$(e,t){for(var r=0,n=1;n<t.length;++n)r+=m$(e,t[n-1],t[n]);return r}function m$(e,t,r){for(var n=jn.zipObject(r,jn.map(r,function(d,u){return u})),i=jn.flatten(jn.map(t,function(d){return jn.sortBy(jn.map(e.outEdges(d),function(u){return{pos:n[u.w],weight:e.edge(u).weight}}),"pos")}),!0),s=1;s<r.length;)s<<=1;var o=2*s-1;s-=1;var l=jn.map(new Array(o),function(){return 0}),c=0;return jn.forEach(i.forEach(function(d){var u=d.pos+s;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var M2=Xe,g$=v$;function v$(e,t){return M2.map(t,function(r){var n=e.inEdges(r);if(n.length){var i=M2.reduce(n,function(s,o){var l=e.edge(o),c=e.node(o.v);return{sum:s.sum+l.weight*c.order,weight:s.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:r}})}var er=Xe,x$=y$;function y$(e,t){var r={};er.forEach(e,function(i,s){var o=r[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};er.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),er.forEach(t.edges(),function(i){var s=r[i.v],o=r[i.w];!er.isUndefined(s)&&!er.isUndefined(o)&&(o.indegree++,s.out.push(r[i.w]))});var n=er.filter(r,function(i){return!i.indegree});return b$(n)}function b$(e){var t=[];function r(s){return function(o){o.merged||(er.isUndefined(o.barycenter)||er.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&_$(s,o)}}function n(s){return function(o){o.in.push(s),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),er.forEach(i.in.reverse(),r(i)),er.forEach(i.out,n(i))}return er.map(er.filter(t,function(s){return!s.merged}),function(s){return er.pick(s,["vs","i","barycenter","weight"])})}function _$(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var xo=Xe,w$=Kt,j$=S$;function S$(e,t){var r=w$.partition(e,function(u){return xo.has(u,"barycenter")}),n=r.lhs,i=xo.sortBy(r.rhs,function(u){return-u.i}),s=[],o=0,l=0,c=0;n.sort(k$(!!t)),c=P2(s,i,c),xo.forEach(n,function(u){c+=u.vs.length,s.push(u.vs),o+=u.barycenter*u.weight,l+=u.weight,c=P2(s,i,c)});var d={vs:xo.flatten(s,!0)};return l&&(d.barycenter=o/l,d.weight=l),d}function P2(e,t,r){for(var n;t.length&&(n=xo.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function k$(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var Mn=Xe,N$=g$,C$=x$,E$=j$,T$=O4;function O4(e,t,r,n){var i=e.children(t),s=e.node(t),o=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,c={};o&&(i=Mn.filter(i,function(x){return x!==o&&x!==l}));var d=N$(e,i);Mn.forEach(d,function(x){if(e.children(x.v).length){var g=O4(e,x.v,r,n);c[x.v]=g,Mn.has(g,"barycenter")&&A$(x,g)}});var u=C$(d,r);R$(u,c);var f=E$(u,n);if(o&&(f.vs=Mn.flatten([o,f.vs,l],!0),e.predecessors(o).length)){var p=e.node(e.predecessors(o)[0]),h=e.node(e.predecessors(l)[0]);Mn.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function R$(e,t){Mn.forEach(e,function(r){r.vs=Mn.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function A$(e,t){Mn.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var yo=Xe,I$=Pr.Graph,M$=P$;function P$(e,t,r){var n=O$(e),i=new I$({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(s){return e.node(s)});return yo.forEach(e.nodes(),function(s){var o=e.node(s),l=e.parent(s);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(s),i.setParent(s,l||n),yo.forEach(e[r](s),function(c){var d=c.v===s?c.w:c.v,u=i.edge(d,s),f=yo.isUndefined(u)?0:u.weight;i.setEdge(d,s,{weight:e.edge(c).weight+f})}),yo.has(o,"minRank")&&i.setNode(s,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function O$(e){for(var t;e.hasNode(t=yo.uniqueId("_root")););return t}var D$=Xe,L$=F$;function F$(e,t,r){var n={},i;D$.forEach(r,function(s){for(var o=e.parent(s),l,c;o;){if(l=e.parent(o),l?(c=n[l],n[l]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=l}})}var Vn=Xe,z$=d$,$$=p$,q$=T$,B$=M$,H$=L$,W$=Pr.Graph,O2=Kt,U$=V$;function V$(e){var t=O2.maxRank(e),r=D2(e,Vn.range(1,t+1),"inEdges"),n=D2(e,Vn.range(t-1,-1,-1),"outEdges"),i=z$(e);L2(e,i);for(var s=Number.POSITIVE_INFINITY,o,l=0,c=0;c<4;++l,++c){G$(l%2?r:n,l%4>=2),i=O2.buildLayerMatrix(e);var d=$$(e,i);d<s&&(c=0,o=Vn.cloneDeep(i),s=d)}L2(e,o)}function D2(e,t,r){return Vn.map(t,function(n){return B$(e,n,r)})}function G$(e,t){var r=new W$;Vn.forEach(e,function(n){var i=n.graph().root,s=q$(n,i,r,t);Vn.forEach(s.vs,function(o,l){n.node(o).order=l}),H$(n,r,s.vs)})}function L2(e,t){Vn.forEach(t,function(r){Vn.forEach(r,function(n,i){e.node(n).order=i})})}var be=Xe,K$=Pr.Graph,Y$=Kt,X$={positionX:aq};function Q$(e,t){var r={};function n(i,s){var o=0,l=0,c=i.length,d=be.last(s);return be.forEach(s,function(u,f){var p=J$(e,u),h=p?e.node(p).order:c;(p||u===d)&&(be.forEach(s.slice(l,f+1),function(x){be.forEach(e.predecessors(x),function(g){var _=e.node(g),v=_.order;(v<o||h<v)&&!(_.dummy&&e.node(x).dummy)&&D4(r,g,x)})}),l=f+1,o=h)}),s}return be.reduce(t,n),r}function Z$(e,t){var r={};function n(s,o,l,c,d){var u;be.forEach(be.range(o,l),function(f){u=s[f],e.node(u).dummy&&be.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&D4(r,p,u)})})}function i(s,o){var l=-1,c,d=0;return be.forEach(o,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,n(o,d,f,l,c),d=f,l=c)}n(o,d,o.length,c,s.length)}),o}return be.reduce(t,i),r}function J$(e,t){if(e.node(t).dummy)return be.find(e.predecessors(t),function(r){return e.node(r).dummy})}function D4(e,t,r){if(t>r){var n=t;t=r,r=n}var i=e[t];i||(e[t]=i={}),i[r]=!0}function eq(e,t,r){if(t>r){var n=t;t=r,r=n}return be.has(e[t],r)}function tq(e,t,r,n){var i={},s={},o={};return be.forEach(t,function(l){be.forEach(l,function(c,d){i[c]=c,s[c]=c,o[c]=d})}),be.forEach(t,function(l){var c=-1;be.forEach(l,function(d){var u=n(d);if(u.length){u=be.sortBy(u,function(g){return o[g]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var x=u[p];s[d]===d&&c<o[x]&&!eq(r,d,x)&&(s[x]=d,s[d]=i[d]=i[x],c=o[x])}}})}),{root:i,align:s}}function rq(e,t,r,n,i){var s={},o=nq(e,t,r,i),l=i?"borderLeft":"borderRight";function c(f,p){for(var h=o.nodes(),x=h.pop(),g={};x;)g[x]?f(x):(g[x]=!0,h.push(x),h=h.concat(p(x))),x=h.pop()}function d(f){s[f]=o.inEdges(f).reduce(function(p,h){return Math.max(p,s[h.v]+o.edge(h))},0)}function u(f){var p=o.outEdges(f).reduce(function(x,g){return Math.min(x,s[g.w]-o.edge(g))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(s[f]=Math.max(s[f],p))}return c(d,o.predecessors.bind(o)),c(u,o.successors.bind(o)),be.forEach(n,function(f){s[f]=s[r[f]]}),s}function nq(e,t,r,n){var i=new K$,s=e.graph(),o=lq(s.nodesep,s.edgesep,n);return be.forEach(t,function(l){var c;be.forEach(l,function(d){var u=r[d];if(i.setNode(u),c){var f=r[c],p=i.edge(f,u);i.setEdge(f,u,Math.max(o(e,d,c),p||0))}c=d})}),i}function iq(e,t){return be.minBy(be.values(t),function(r){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return be.forIn(r,function(s,o){var l=cq(e,o)/2;n=Math.max(s+l,n),i=Math.min(s-l,i)}),n-i})}function sq(e,t){var r=be.values(t),n=be.min(r),i=be.max(r);be.forEach(["u","d"],function(s){be.forEach(["l","r"],function(o){var l=s+o,c=e[l],d;if(c!==t){var u=be.values(c);d=o==="l"?n-be.min(u):i-be.max(u),d&&(e[l]=be.mapValues(c,function(f){return f+d}))}})})}function oq(e,t){return be.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var i=be.sortBy(be.map(e,n));return(i[1]+i[2])/2})}function aq(e){var t=Y$.buildLayerMatrix(e),r=be.merge(Q$(e,t),Z$(e,t)),n={},i;be.forEach(["u","d"],function(o){i=o==="u"?t:be.values(t).reverse(),be.forEach(["l","r"],function(l){l==="r"&&(i=be.map(i,function(f){return be.values(f).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),d=tq(e,i,r,c),u=rq(e,i,d.root,d.align,l==="r");l==="r"&&(u=be.mapValues(u,function(f){return-f})),n[o+l]=u})});var s=iq(e,n);return sq(n,s),oq(n,e.graph().align)}function lq(e,t,r){return function(n,i,s){var o=n.node(i),l=n.node(s),c=0,d;if(c+=o.width/2,be.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":d=-o.width/2;break;case"r":d=o.width/2;break}if(d&&(c+=r?d:-d),d=0,c+=(o.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,be.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=r?d:-d),d=0,c}}function cq(e,t){return e.node(t).width}var bo=Xe,L4=Kt,uq=X$.positionX,dq=fq;function fq(e){e=L4.asNonCompoundGraph(e),pq(e),bo.forEach(uq(e),function(t,r){e.node(r).x=t})}function pq(e){var t=L4.buildLayerMatrix(e),r=e.graph().ranksep,n=0;bo.forEach(t,function(i){var s=bo.max(bo.map(i,function(o){return e.node(o).height}));bo.forEach(i,function(o){e.node(o).y=n+s/2}),n+=s+r})}var Se=Xe,F2=nz,z2=bz,hq=Wz,mq=Kt.normalizeRanks,gq=Kz,vq=Kt.removeEmptyRanks,$2=Zz,xq=i$,q2=o$,yq=U$,bq=dq,Xn=Kt,_q=Pr.Graph,wq=jq;function jq(e,t){var r=t&&t.debugTiming?Xn.time:Xn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return Pq(e)});r("  runLayout",function(){Sq(n,r)}),r("  updateInputGraph",function(){kq(e,n)})})}function Sq(e,t){t("    makeSpaceForEdgeLabels",function(){Oq(e)}),t("    removeSelfEdges",function(){Wq(e)}),t("    acyclic",function(){F2.run(e)}),t("    nestingGraph.run",function(){$2.run(e)}),t("    rank",function(){hq(Xn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){Dq(e)}),t("    removeEmptyRanks",function(){vq(e)}),t("    nestingGraph.cleanup",function(){$2.cleanup(e)}),t("    normalizeRanks",function(){mq(e)}),t("    assignRankMinMax",function(){Lq(e)}),t("    removeEdgeLabelProxies",function(){Fq(e)}),t("    normalize.run",function(){z2.run(e)}),t("    parentDummyChains",function(){gq(e)}),t("    addBorderSegments",function(){xq(e)}),t("    order",function(){yq(e)}),t("    insertSelfEdges",function(){Uq(e)}),t("    adjustCoordinateSystem",function(){q2.adjust(e)}),t("    position",function(){bq(e)}),t("    positionSelfEdges",function(){Vq(e)}),t("    removeBorderNodes",function(){Hq(e)}),t("    normalize.undo",function(){z2.undo(e)}),t("    fixupEdgeLabelCoords",function(){qq(e)}),t("    undoCoordinateSystem",function(){q2.undo(e)}),t("    translateGraph",function(){zq(e)}),t("    assignNodeIntersects",function(){$q(e)}),t("    reversePoints",function(){Bq(e)}),t("    acyclic.undo",function(){F2.undo(e)})}function kq(e,t){Se.forEach(e.nodes(),function(r){var n=e.node(r),i=t.node(r);n&&(n.x=i.x,n.y=i.y,t.children(r).length&&(n.width=i.width,n.height=i.height))}),Se.forEach(e.edges(),function(r){var n=e.edge(r),i=t.edge(r);n.points=i.points,Se.has(i,"x")&&(n.x=i.x,n.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var Nq=["nodesep","edgesep","ranksep","marginx","marginy"],Cq={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Eq=["acyclicer","ranker","rankdir","align"],Tq=["width","height"],Rq={width:0,height:0},Aq=["minlen","weight","width","height","labeloffset"],Iq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Mq=["labelpos"];function Pq(e){var t=new _q({multigraph:!0,compound:!0}),r=ng(e.graph());return t.setGraph(Se.merge({},Cq,rg(r,Nq),Se.pick(r,Eq))),Se.forEach(e.nodes(),function(n){var i=ng(e.node(n));t.setNode(n,Se.defaults(rg(i,Tq),Rq)),t.setParent(n,e.parent(n))}),Se.forEach(e.edges(),function(n){var i=ng(e.edge(n));t.setEdge(n,Se.merge({},Iq,rg(i,Aq),Se.pick(i,Mq)))}),t}function Oq(e){var t=e.graph();t.ranksep/=2,Se.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function Dq(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-n.rank)/2+n.rank,e:t};Xn.addDummyNode(e,"edge-proxy",s,"_ep")}})}function Lq(e){var t=0;Se.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=Se.max(t,n.maxRank))}),e.graph().maxRank=t}function Fq(e){Se.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function zq(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,i=0,s=e.graph(),o=s.marginx||0,l=s.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),r=Math.max(r,u+p/2),n=Math.min(n,f-h/2),i=Math.max(i,f+h/2)}Se.forEach(e.nodes(),function(d){c(e.node(d))}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.has(u,"x")&&c(u)}),t-=o,n-=l,Se.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=n}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.forEach(u.points,function(f){f.x-=t,f.y-=n}),Se.has(u,"x")&&(u.x-=t),Se.has(u,"y")&&(u.y-=n)}),s.width=r-t+o,s.height=i-n+l}function $q(e){Se.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),i=e.node(t.w),s,o;r.points?(s=r.points[0],o=r.points[r.points.length-1]):(r.points=[],s=i,o=n),r.points.unshift(Xn.intersectRect(n,s)),r.points.push(Xn.intersectRect(i,o))})}function qq(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);if(Se.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Bq(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function Hq(e){Se.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),i=e.node(r.borderBottom),s=e.node(Se.last(r.borderLeft)),o=e.node(Se.last(r.borderRight));r.width=Math.abs(o.x-s.x),r.height=Math.abs(i.y-n.y),r.x=s.x+r.width/2,r.y=n.y+r.height/2}}),Se.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function Wq(e){Se.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function Uq(e){var t=Xn.buildLayerMatrix(e);Se.forEach(t,function(r){var n=0;Se.forEach(r,function(i,s){var o=e.node(i);o.order=s+n,Se.forEach(o.selfEdges,function(l){Xn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:o.rank,order:s+ ++n,e:l.e,label:l.label},"_se")}),delete o.selfEdges})})}function Vq(e){Se.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),i=n.x+n.width/2,s=n.y,o=r.x-i,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:i+2*o/3,y:s-l},{x:i+5*o/6,y:s-l},{x:i+o,y:s},{x:i+5*o/6,y:s+l},{x:i+2*o/3,y:s+l}],r.label.x=r.x,r.label.y=r.y}})}function rg(e,t){return Se.mapValues(Se.pick(e,t),Number)}function ng(e){var t={};return Se.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var il=Xe,Gq=Kt,Kq=Pr.Graph,Yq={debugOrdering:Xq};function Xq(e){var t=Gq.buildLayerMatrix(e),r=new Kq({compound:!0,multigraph:!0}).setGraph({});return il.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),il.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),il.forEach(t,function(n,i){var s="layer"+i;r.setNode(s,{rank:"same"}),il.reduce(n,function(o,l){return r.setEdge(o,l,{style:"invis"}),l})}),r}var Qq="0.8.5",Zq={graphlib:Pr,layout:wq,debug:Yq,util:{time:Kt.time,notime:Kt.notime},version:Qq};const mc=Hv(Zq),B2=(e,t)=>{const r=new mc.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),mc.layout(r),{nodes:e.map(n=>{const i=r.node(n.id);return{...n,targetPosition:ue.Top,sourcePosition:ue.Bottom,position:{x:i.x-(n.data.width??280)/2,y:i.y-(n.data.height??90)/2}}}),edges:t}},H2=(e,t,r)=>{let n=[],i=[],s=null,o=null,l=[];const c=r.theme||"industrial";return e.forEach((d,u)=>{var x,g;if((d.level||1)!==1)return;const f=280;let p=95;d.state==="active"&&d.stations&&(p+=35);const h=t===d.id;if(n.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),s){const _=(x=e[u-1])==null?void 0:x.state;i.push({id:"e-"+s+"-"+d.id,source:s,target:d.id,type:"smoothstep",animated:_==="active",style:{stroke:bE(_,c),strokeWidth:3}})}((g=d.children)==null?void 0:g.length)>0&&(o=d.id,l=d.children),s=d.id}),{nodes:n,edges:i,epicBacklogId:o,epicChildren:l}},W2=(e,t,r,n,i)=>{const{nodes:s,edges:o}=e;if(!t||!r.length)return{nodes:s,edges:o};const l=s.find(b=>b.id===t);if(!l)return{nodes:s,edges:o};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=i.theme||"industrial",p=bE(u,f),h=u==="active",x=wr.EPIC_HEIGHT+wr.EPIC_GAP_Y,g=Math.ceil(r.length/wr.EPICS_PER_ROW),_=c+280*.15,v=50,y={};r.forEach((b,w)=>{const k=Math.floor(w/wr.EPICS_PER_ROW);y[k]||(y[k]=[]),y[k].push({epic:b,idx:w})});for(let b=0;b<g;b++){const w=y[b]||[];if(w.length===0)continue;const k=d+wr.EPIC_OFFSET_Y+b*x,S=`junction-row-${b}`;s.push({id:S,type:"waypoint",position:{x:_,y:k-v},draggable:!1,connectable:!1,selectable:!1}),b===0?o.push({id:`e-spine-drop-${b}`,source:t,target:S,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):o.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:S,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),w.forEach(({epic:C,idx:T})=>{const j=T%wr.EPICS_PER_ROW,R=c+wr.EPIC_OFFSET_X+j*(wr.EPIC_WIDTH+wr.EPIC_GAP_X),E=k,M=n===C.id;s.push({id:C.id,type:"documentNode",data:{...C,width:wr.EPIC_WIDTH,height:wr.EPIC_HEIGHT,isExpanded:M,...i},draggable:!1,connectable:!1,position:{x:R,y:E},targetPosition:ue.Top,sourcePosition:ue.Bottom,zIndex:M?1e3:0}),o.push({id:`e-branch-${C.id}`,source:S,target:C.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:s,edges:o}},Jq={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"};function eB(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function tB(e,t=[]){const r=[],n=[],i={};for(const s of e.tracks){const o=rB(s,t);if((s.scope||"project")==="project")n.push({...o,mayOwn:s.may_own||[],childDocType:s.child_doc_type});else{const c=s.document_type;i[c]||(i[c]=[]),i[c].push(o)}}for(const s of n)s.childDocType&&i[s.childDocType]&&(s.children=i[s.childDocType].map(o=>({...o,level:2}))),r.push(s);return r}function rB(e,t=[]){var l,c,d;const r=Jq[e.state]||"ready_for_production",n=e.state==="awaiting_operator",i=t.find(u=>u.document_type===e.document_type);let s=null;(r==="in_production"||n)&&(s=nB(e.stations,e.state,e.station));let o=null;if(i){const u=i.questions||((c=(l=i.payload)==null?void 0:l.data)==null?void 0:c.questions)||(Array.isArray((d=i.payload)==null?void 0:d.data)?i.payload.data:null);u&&Array.isArray(u)&&(o=u.map((f,p)=>({id:f.id||`q${p+1}`,text:f.question||f.text||f,required:f.required!==!1,choices:f.choices||null,answer_type:f.answer_type||"text",why_it_matters:f.why_it_matters||null,priority:f.priority||null,blocking:f.blocking!==!1,default:f.default||null,constraint_kind:f.constraint_kind||null})))}return{id:e.document_type,name:e.document_name||iB(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:s,questions:o,interruptId:i==null?void 0:i.id,blockedBy:e.blocked_by||[]}}function nB(e,t,r){return!e||e.length===0?null:e.map(n=>({id:n.station,label:n.label||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function iB(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function sB({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,i]=m.useState(!0),[s,o]=m.useState(null),l=m.useCallback(async()=>{i(!0),o(null);try{const d=await Ve.getProjects({includeArchived:e}),u=eB(d);r(u)}catch(d){o(d.message),console.error("Failed to fetch projects:",d)}finally{i(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await Ve.createProject({name:d,description:""});return r(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw o(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:s,addProject:c,refresh:l}}function oB(e){const[t,r]=m.useState([]),[n,i]=m.useState("idle"),[s,o]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null),g=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[w,k]=await Promise.all([Ve.getProductionStatus(e),Ve.getProjectInterrupts(e).catch(()=>[])]);o(k),i(w.line_state),r(tB(w,k))}catch(w){u(w.message),console.error("Failed to fetch production status:",w)}finally{c(!1)}},[e]),_=m.useCallback(()=>{if(!e)return;h.current&&h.current.close();const w=m6(e);h.current=w,w.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),w.addEventListener("station_transition",k=>{try{const S=JSON.parse(k.data);console.log("Station transition:",S),g()}catch(S){console.error("Failed to parse station_transition:",S)}}),w.addEventListener("line_stopped",k=>{try{const S=JSON.parse(k.data);console.log("Line stopped:",S),i("stopped"),g()}catch(S){console.error("Failed to parse line_stopped:",S)}}),w.addEventListener("production_complete",k=>{try{const S=JSON.parse(k.data);console.log("Production complete:",S),i("complete"),g()}catch(S){console.error("Failed to parse production_complete:",S)}}),w.addEventListener("interrupt_resolved",k=>{try{const S=JSON.parse(k.data);console.log("Interrupt resolved:",S),g()}catch(S){console.error("Failed to parse interrupt_resolved:",S)}}),w.addEventListener("track_started",k=>{try{const S=JSON.parse(k.data);console.log("Track started:",S),i("active"),g()}catch(S){console.error("Failed to parse track_started:",S)}}),w.addEventListener("track_stabilized",k=>{try{const S=JSON.parse(k.data);console.log("Track stabilized:",S),g()}catch(S){console.error("Failed to parse track_stabilized:",S)}}),w.addEventListener("stations_declared",k=>{try{const S=JSON.parse(k.data);console.log("Stations declared:",S);const{document_type:C,stations:T}=S;r(j=>{const R=j.some(M=>M.id===C);console.log("stations_declared raw stations:",T);const E=T.map(M=>({id:M.id,label:M.label,state:M.state,phases:M.phases||[],phase:null}));return console.log("stations_declared processed:",E),R?j.map(M=>M.id===C?{...M,state:"in_production",stations:E}:M):[...j,{id:C,name:C.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase()),state:"in_production",stations:E}]})}catch(S){console.error("Failed to parse stations_declared:",S)}}),w.addEventListener("station_changed",k=>{try{const S=JSON.parse(k.data);console.log("Station changed:",S);const{document_type:C,station_id:T,state:j}=S;r(R=>R.map(E=>E.id!==C||!E.stations?E:{...E,stations:E.stations.map(M=>M.id===T?{...M,state:j}:M)}))}catch(S){console.error("Failed to parse station_changed:",S)}}),w.addEventListener("internal_step",k=>{try{const S=JSON.parse(k.data);console.log("Internal step:",S);const{document_type:C,station_id:T,step:j}=S;r(R=>R.map(E=>E.id!==C||!E.stations?E:{...E,stations:E.stations.map(M=>M.id===T?{...M,currentStep:j}:M)}))}catch(S){console.error("Failed to parse internal_step:",S)}}),w.onerror=k=>{console.error("SSE error:",k),p(!1),u("Connection lost"),w.close(),x.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),_()},3e3)}},[e,g]),v=m.useCallback(()=>{x.current&&clearTimeout(x.current),h.current&&(h.current.close(),h.current=null),p(!1)},[]),y=m.useCallback(async(w,k)=>{try{await Ve.resolveInterrupt(w,{answers:k})}catch(S){throw console.error("Failed to resolve interrupt:",S),S}},[]),b=m.useCallback(async(w=null)=>{try{await Ve.startProduction(e,w),i("active")}catch(k){throw console.error("Failed to start production:",k),k}},[e]);return m.useEffect(()=>(g(),_(),()=>v()),[g,_,v]),{data:t,lineState:n,interrupts:s,loading:l,error:d,connected:f,refresh:g,resolveInterrupt:y,startProduction:b}}const U2="combine-theme";function F4(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const s=localStorage.getItem(U2);return s&&In.includes(s)?s:e});m.useEffect(()=>{localStorage.setItem(U2,t)},[t]);const n=m.useCallback(s=>{In.includes(s)&&r(s)},[]),i=m.useCallback(()=>{r(s=>{const o=In.indexOf(s);return In[(o+1)%In.length]})},[]);return{theme:t,setTheme:n,cycleTheme:i}}function aB(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[i,s]=m.useState([]),[o,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[x,g]=m.useState([]),[_,v]=m.useState(!1),[y,b]=m.useState(null),[w,k]=m.useState(null),[S,C]=m.useState(null),[T,j]=m.useState(!1),[R,E]=m.useState(!1),[M,$]=m.useState(null),[N,D]=m.useState(null),I=m.useRef(null),F=m.useRef(!0);m.useEffect(()=>(F.current=!0,()=>{F.current=!1,I.current&&I.current.close()}),[]);const P=m.useCallback(W=>{F.current&&(n(W.phase),s(W.messages||[]),l(W.pending_prompt),d(W.pending_choices),f(W.interpretation||{}),h(W.confidence||0),g(W.missing_fields||[]),v(W.can_initialize||!1),b(W.gate_outcome),k(W.project),$(W.intake_classification),D(W.intake_gate_phase))},[]),A=m.useCallback(async()=>{C(null),j(!0);try{const W=await Ve.startIntake();if(!F.current)return;t(W.execution_id),P(W)}catch(W){if(!F.current)return;C(W.message||"Failed to start intake")}finally{F.current&&j(!1)}},[]),L=m.useCallback(async W=>{if(!e||!W.trim())return;C(null),E(!0);const q={role:"user",content:W};s(Q=>[...Q,q]);try{const Q=await Ve.submitIntakeMessage(e,W);if(!F.current)return;P(Q)}catch(Q){if(!F.current)return;s(ie=>ie.filter(oe=>oe!==q)),C(Q.message||"Failed to submit message")}finally{F.current&&E(!1)}},[e,P]),z=m.useCallback(async(W,q)=>{if(e){C(null),f(Q=>({...Q,[W]:{value:q,source:"user",locked:!0}}));try{const Q=await Ve.updateIntakeField(e,W,q);if(!F.current)return;P(Q)}catch(Q){if(!F.current)return;C(Q.message||"Failed to update field");const ie=await Ve.getIntakeState(e);F.current&&P(ie)}}},[e,P]),B=m.useCallback(async()=>{if(!(!e||!_)){C(null),j(!0);try{const W=await Ve.initializeIntake(e);if(!F.current)return;P(W),W.phase==="generating"&&X()}catch(W){if(!F.current)return;C(W.message||"Failed to initialize project"),j(!1)}}},[e,_,P]),X=m.useCallback(()=>{I.current&&I.current.close();const W=g6(e);I.current=W,W.addEventListener("started",q=>{if(!F.current)return;const Q=JSON.parse(q.data);console.log("Intake started:",Q)}),W.addEventListener("progress",q=>{if(!F.current)return;const Q=JSON.parse(q.data);console.log("Intake progress:",Q.current_node)}),W.addEventListener("complete",async q=>{if(!F.current)return;const Q=JSON.parse(q.data);console.log("Intake complete:",Q),W.close(),I.current=null,n("complete"),b(Q.gate_outcome),k(Q.project),j(!1)}),W.addEventListener("error",q=>{if(F.current&&W.readyState!==EventSource.CLOSED){try{const Q=JSON.parse(q.data);C(Q.message||"Generation failed")}catch{C("Connection lost during generation")}W.close(),I.current=null,j(!1)}}),W.onerror=()=>{F.current&&W.readyState===EventSource.CLOSED&&(I.current=null,j(!1))}},[e]),G=m.useCallback(()=>{I.current&&(I.current.close(),I.current=null),t(null),n("idle"),s([]),l(null),d(null),f({}),h(0),g([]),v(!1),b(null),k(null),C(null),j(!1),E(!1)},[]);return{executionId:e,phase:r,messages:i,pendingPrompt:o,pendingChoices:c,interpretation:u,confidence:p,missingFields:x,canInitialize:_,gateOutcome:y,project:w,error:S,loading:T,submitting:R,intakeClassification:M,intakeGatePhase:N,startIntake:A,submitMessage:L,updateField:z,lockAndGenerate:B,reset:G}}const z4=m.createContext(null);function lB({children:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{i(!0),o(null);try{const f=await Ve.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),o(f.message),r(null)}finally{i(!1)}},[]),c=m.useCallback(f=>{window.location.href=v6(f)},[]),d=m.useCallback(async()=>{try{await Ve.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),u={user:t,loading:n,error:s,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return a.jsx(z4.Provider,{value:u,children:e})}function Ls(){const e=m.useContext(z4);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function cB(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useCallback(async()=>{s(!0),l(null);try{let u=await _e.getCurrentWorkspace();u||(u=await _e.createWorkspace()),t(u.workspace_id),n(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{s(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await _e.closeWorkspace(e,u),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:i,error:o,closeWorkspace:d,reinitialize:c}}function uB(e,t=1e4){var u,f;const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){n(null),s(!1);return}try{const p=await _e.getWorkspaceState(e);n(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{s(!1)}},[e]);return m.useEffect(()=>{e&&(s(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:r,loading:i,error:o,refresh:d,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((u=r==null?void 0:r.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function dB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await _e.getDocumentTypes();t(l.document_types||[])}catch(l){s(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{documentTypes:e,loading:r,error:i,refresh:o}}function fB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await _e.getRoles();t(l.roles||[])}catch(l){s(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{roles:e,loading:r,error:i,refresh:o}}function ka(e,t,{debounceMs:r=500,onSave:n}={}){const[i,s]=m.useState(""),[o,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,g]=m.useState(null),_=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(""),l(""),d(!1);return}d(!0),f(null);try{const T=await _e.getArtifact(e,t);s(T.content),l(T.content)}catch(T){f(T.message),console.error("Failed to load artifact:",T)}finally{d(!1)}},[e,t]),b=m.useCallback(async T=>{if(!(!e||!t)){h(!0),f(null);try{const j=await _e.writeArtifact(e,t,T);g(j),l(T),n&&n(j)}catch(j){f(j.message),console.error("Failed to save artifact:",j)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(T=>{v.current=T,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),k=m.useCallback(T=>{s(T),T!==o&&w(T)},[o,w]),S=m.useCallback(()=>{_.current&&clearTimeout(_.current),v.current=null,s(o)},[o]),C=m.useCallback(()=>{_.current&&clearTimeout(_.current),i!==o&&b(i)},[i,o,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{content:i,originalContent:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateContent:k,reset:S,saveNow:C,reload:y}}const pB={documentNode:U6,waypoint:V6},hB={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function mB({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:i,theme:s,onThemeChange:o,onProjectUpdate:l,onProjectArchive:c,onProjectUnarchive:d,onProjectDelete:u}){const{data:f,lineState:p,loading:h,error:x,connected:g,resolveInterrupt:_,startProduction:v}=oB(e),[y,b]=m.useState([]),[w,k]=m.useState(null),[S,C]=m.useState(null),[T,j]=m.useState(null),[R,E]=m.useState(!1),[M,$]=m.useState(""),[N,D]=m.useState(!1),[I,F]=m.useState(!1),[P,A]=m.useState(!1),L=Qc();m.useEffect(()=>{f.length>0&&b(f)},[f]),m.useEffect(()=>{i&&y.length>0&&setTimeout(()=>{k(i),C("questions")},300)},[i,y.length]),m.useEffect(()=>{k(null),C(null)},[e]);const z=m.useCallback(()=>{const U=In.indexOf(s);o(In[(U+1)%In.length])},[s,o]),B=m.useCallback(()=>{$(r||""),E(!0)},[r]),X=m.useCallback(async()=>{if(!M.trim()||M===r){E(!1);return}F(!0);try{await l(e,{name:M.trim()}),E(!1)}catch(U){console.error("Failed to update name:",U)}finally{F(!1)}},[M,r,e,l]),G=m.useCallback(()=>{E(!1),$("")},[]),W=m.useCallback(async()=>{F(!0);try{n?await d(e):await c(e)}catch(U){console.error("Failed to toggle archive:",U)}finally{F(!1)}},[e,n,c,d]),q=m.useCallback(async()=>{F(!0);try{await u(e),D(!1)}catch(U){console.error("Failed to delete:",U)}finally{F(!1)}},[e,u]),Q=m.useCallback(U=>{const de=L.getNode(U);if(de){const me=window.innerWidth,ye=-de.position.x*.9+me/2-400,ee=-de.position.y*.9+120;L.setViewport({x:ye,y:ee,zoom:.9},{duration:800})}},[L]),ie=m.useMemo(()=>({onExpand:(U,de)=>{k(U),C(de)},onCollapse:()=>{k(null),C(null),setTimeout(()=>L.fitView({padding:.2,duration:300}),50)},onViewFullDocument:U=>{j(U)},onStartProduction:async U=>{console.log("Starting production for:",U),b(de=>de.map(fe=>fe.id===U?{...fe,state:"in_production"}:fe));try{await v(U)}catch(de){console.error("Failed to start production:",de)}},onSubmitQuestions:async(U,de)=>{console.log("Submitted:",U,de),k(null),C(null),b(me=>{const ye=ee=>ee.map(he=>he.id===U&&he.stations?{...he,state:"in_production",stations:he.stations.map(De=>De.id==="pgc"?{...De,state:"complete",needs_input:!1}:De.id==="asm"?{...De,state:"active"}:De)}:he.children?{...he,children:ye(he.children)}:he);return ye(me)});const fe=y.find(me=>me.id===U);if(fe!=null&&fe.interruptId)try{await _(fe.interruptId,de)}catch(me){console.error("Failed to submit answers:",me)}}}),[L,y,_,v]),{layoutNodes:oe,layoutEdges:J}=m.useMemo(()=>{if(y.length===0)return{layoutNodes:[],layoutEdges:[]};const U={...ie,expandType:S,theme:s,onZoomToNode:Q,projectId:e,projectCode:t},{nodes:de,edges:fe,epicBacklogId:me,epicChildren:ye}=H2(y,w,U),ee=B2(de,fe),{nodes:he,edges:De}=W2(ee,me,ye,w,U);return{layoutNodes:he.map(Re=>({...Re,data:{...Re.data,expandType:Re.id===w?S:null}})),layoutEdges:De}},[y,w,S,ie,s,Q,e,t]),[je,ge,we]=mE(oe),[xe,se,K]=gE(J);m.useEffect(()=>{if(y.length===0)return;const U={...ie,expandType:S,theme:s,onZoomToNode:Q,projectId:e,projectCode:t},{nodes:de,edges:fe,epicBacklogId:me,epicChildren:ye}=H2(y,w,U),ee=B2(de,fe),{nodes:he,edges:De}=W2(ee,me,ye,w,U),nt=he.map(Re=>({...Re,data:{...Re.data,expandType:Re.id===w?S:null}}));ge(nt),se(De)},[y,w,S,ie,ge,se,s,Q,e,t]);const re=m.useCallback((U,de)=>{},[]);return h&&y.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):x&&y.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:a.jsx("p",{className:"text-red-500 mb-4",children:x})})}):a.jsxs("div",{className:"w-full h-full",children:[a.jsxs(Jx,{nodes:je,edges:xe,onNodesChange:we,onEdgesChange:K,onNodeClick:re,nodeTypes:pB,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,zoomOnScroll:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[a.jsx(Wn,{position:"top-left",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),a.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[p==="active"&&a.jsx("span",{className:"text-amber-500",children:" Active"}),p==="stopped"&&a.jsx("span",{className:"text-red-500",children:" Stopped"}),p==="complete"&&a.jsx("span",{className:"text-emerald-500",children:" Complete"}),p==="idle"&&a.jsx("span",{children:" Idle"}),!g&&a.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),a.jsx("button",{onClick:z,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:hB[s]})]})}),a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:a.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),R?a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("input",{type:"text",value:M,onChange:U=>$(U.target.value),onKeyDown:U=>{U.key==="Enter"&&X(),U.key==="Escape"&&G()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:I}),a.jsx("button",{onClick:X,disabled:I,className:"p-1 rounded hover:bg-white/10",title:"Save",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{onClick:G,disabled:I,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:a.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!R&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:B,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{onClick:W,disabled:I,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:a.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&a.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),a.jsx("button",{onClick:()=>D(!0),disabled:I||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[a.jsxs("button",{onClick:()=>A(!P),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[a.jsx("span",{children:"Workflow"}),a.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:P?"":""})]}),P&&a.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:a.jsx(Z6,{projectId:e})})]})]})}),a.jsx(yE,{position:"top-right",nodeColor:U=>{var ye;const de=(ye=U.data)==null?void 0:ye.state,fe=document.querySelector('[class*="theme-"]')||document.body,me=getComputedStyle(fe);return["produced","stabilized","ready","complete"].includes(de)?me.getPropertyValue("--state-stabilized-bg").trim():["requirements_not_met","blocked","halted","failed"].includes(de)?me.getPropertyValue("--state-blocked-bg").trim():["in_production","active","queued","awaiting_operator"].includes(de)?me.getPropertyValue("--state-active-bg").trim():(["ready_for_production","waiting","pending_acceptance"].includes(de),me.getPropertyValue("--state-ready-bg").trim())},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Wn,{position:"bottom-left",children:a.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[a.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Stabilized"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-ready-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"In Progress"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-blocked-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Blocked"})]})]})}),a.jsx(Wn,{position:"bottom-right",children:a.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Pinch to zoom | Drag to pan"})})]}),T&&a.jsx(G6,{projectId:e,projectCode:t,docTypeId:T,onClose:()=>j(null)}),N&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:a.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),a.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",a.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>D(!1),disabled:I,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{onClick:q,disabled:I,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:I?"Deleting...":"Delete"})]})]})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function $4(e){return typeof e>"u"||e===null}function gB(e){return typeof e=="object"&&e!==null}function vB(e){return Array.isArray(e)?e:$4(e)?[]:[e]}function xB(e,t){var r,n,i,s;if(t)for(s=Object.keys(t),r=0,n=s.length;r<n;r+=1)i=s[r],e[i]=t[i];return e}function yB(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function bB(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var _B=$4,wB=gB,jB=vB,SB=yB,kB=bB,NB=xB,ft={isNothing:_B,isObject:wB,toArray:jB,repeat:SB,isNegativeZero:kB,extend:NB};function q4(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function sa(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=q4(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}sa.prototype=Object.create(Error.prototype);sa.prototype.constructor=sa;sa.prototype.toString=function(t){return this.name+": "+q4(this,t)};var Dt=sa;function ig(e,t,r,n,i){var s="",o="",l=Math.floor(i/2)-1;return n-t>l&&(s=" ... ",t=n-l+s.length),r-n>l&&(o=" ...",r=n+l-o.length),{str:s+e.slice(t,r).replace(/\t/g,"")+o,pos:n-t+s.length}}function sg(e,t){return ft.repeat(" ",t-e.length)+e}function CB(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],s,o=-1;s=r.exec(e.buffer);)i.push(s.index),n.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=n.length-2);o<0&&(o=n.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)d=ig(e.buffer,n[o-c],i[o-c],e.position-(n[o]-n[o-c]),f),l=ft.repeat(" ",t.indent)+sg((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=ig(e.buffer,n[o],i[o],e.position,f),l+=ft.repeat(" ",t.indent)+sg((e.line+1).toString(),u)+" | "+d.str+`
`,l+=ft.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)d=ig(e.buffer,n[o+c],i[o+c],e.position-(n[o]-n[o+c]),f),l+=ft.repeat(" ",t.indent)+sg((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var EB=CB,TB=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],RB=["scalar","sequence","mapping"];function AB(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function IB(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(TB.indexOf(r)===-1)throw new Dt('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=AB(t.styleAliases||null),RB.indexOf(this.kind)===-1)throw new Dt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var kt=IB;function V2(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(s,o){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(i=o)}),r[i]=n}),r}function MB(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Mv(e){return this.extend(e)}Mv.prototype.extend=function(t){var r=[],n=[];if(t instanceof kt)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new Dt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof kt))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new Dt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Dt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof kt))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Mv.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=V2(i,"implicit"),i.compiledExplicit=V2(i,"explicit"),i.compiledTypeMap=MB(i.compiledImplicit,i.compiledExplicit),i};var B4=Mv,H4=new kt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),W4=new kt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),U4=new kt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),V4=new B4({explicit:[H4,W4,U4]});function PB(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function OB(){return null}function DB(e){return e===null}var G4=new kt("tag:yaml.org,2002:null",{kind:"scalar",resolve:PB,construct:OB,predicate:DB,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function LB(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function FB(e){return e==="true"||e==="True"||e==="TRUE"}function zB(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var K4=new kt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:LB,construct:FB,predicate:zB,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function $B(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function qB(e){return 48<=e&&e<=55}function BB(e){return 48<=e&&e<=57}function HB(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!$B(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!qB(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!BB(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function WB(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function UB(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!ft.isNegativeZero(e)}var Y4=new kt("tag:yaml.org,2002:int",{kind:"scalar",resolve:HB,construct:WB,predicate:UB,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),VB=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function GB(e){return!(e===null||!VB.test(e)||e[e.length-1]==="_")}function KB(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var YB=/^[-+]?[0-9]+e/;function XB(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(ft.isNegativeZero(e))return"-0.0";return r=e.toString(10),YB.test(r)?r.replace("e",".e"):r}function QB(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||ft.isNegativeZero(e))}var X4=new kt("tag:yaml.org,2002:float",{kind:"scalar",resolve:GB,construct:KB,predicate:QB,represent:XB,defaultStyle:"lowercase"}),Q4=V4.extend({implicit:[G4,K4,Y4,X4]}),Z4=Q4,J4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),eT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function ZB(e){return e===null?!1:J4.exec(e)!==null||eT.exec(e)!==null}function JB(e){var t,r,n,i,s,o,l,c=0,d=null,u,f,p;if(t=J4.exec(e),t===null&&(t=eT.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(s=+t[4],o=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(r,n,i,s,o,l,c)),d&&p.setTime(p.getTime()-d),p}function e9(e){return e.toISOString()}var tT=new kt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:ZB,construct:JB,instanceOf:Date,represent:e9});function t9(e){return e==="<<"||e===null}var rT=new kt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:t9}),_y=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function r9(e){if(e===null)return!1;var t,r,n=0,i=e.length,s=_y;for(r=0;r<i;r++)if(t=s.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function n9(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,s=_y,o=0,l=[];for(t=0;t<i;t++)t%4===0&&t&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|s.indexOf(n.charAt(t));return r=i%4*6,r===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):r===18?(l.push(o>>10&255),l.push(o>>2&255)):r===12&&l.push(o>>4&255),new Uint8Array(l)}function i9(e){var t="",r=0,n,i,s=e.length,o=_y;for(n=0;n<s;n++)n%3===0&&n&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[n];return i=s%3,i===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):i===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):i===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function s9(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var nT=new kt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:r9,construct:n9,predicate:s9,represent:i9}),o9=Object.prototype.hasOwnProperty,a9=Object.prototype.toString;function l9(e){if(e===null)return!0;var t=[],r,n,i,s,o,l=e;for(r=0,n=l.length;r<n;r+=1){if(i=l[r],o=!1,a9.call(i)!=="[object Object]")return!1;for(s in i)if(o9.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function c9(e){return e!==null?e:[]}var iT=new kt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:l9,construct:c9}),u9=Object.prototype.toString;function d9(e){if(e===null)return!0;var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(n=o[t],u9.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;s[t]=[i[0],n[i[0]]]}return!0}function f9(e){if(e===null)return[];var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1)n=o[t],i=Object.keys(n),s[t]=[i[0],n[i[0]]];return s}var sT=new kt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:d9,construct:f9}),p9=Object.prototype.hasOwnProperty;function h9(e){if(e===null)return!0;var t,r=e;for(t in r)if(p9.call(r,t)&&r[t]!==null)return!1;return!0}function m9(e){return e!==null?e:{}}var oT=new kt("tag:yaml.org,2002:set",{kind:"mapping",resolve:h9,construct:m9}),wy=Z4.extend({implicit:[tT,rT],explicit:[nT,iT,sT,oT]}),Qn=Object.prototype.hasOwnProperty,gc=1,aT=2,lT=3,vc=4,og=1,g9=2,G2=3,v9=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,x9=/[\x85\u2028\u2029]/,y9=/[,\[\]\{\}]/,cT=/^(?:!|!!|![a-z\-]+!)$/i,uT=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function K2(e){return Object.prototype.toString.call(e)}function Ur(e){return e===10||e===13}function yi(e){return e===9||e===32}function Wt(e){return e===9||e===32||e===10||e===13}function is(e){return e===44||e===91||e===93||e===123||e===125}function b9(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function _9(e){return e===120?2:e===117?4:e===85?8:0}function w9(e){return 48<=e&&e<=57?e-48:-1}function Y2(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function j9(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function dT(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var fT=new Array(256),pT=new Array(256);for(var zi=0;zi<256;zi++)fT[zi]=Y2(zi)?1:0,pT[zi]=Y2(zi);function S9(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||wy,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function hT(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=EB(r),new Dt(t,r)}function pe(e,t){throw hT(e,t)}function xc(e,t){e.onWarning&&e.onWarning.call(null,hT(e,t))}var X2={YAML:function(t,r,n){var i,s,o;t.version!==null&&pe(t,"duplication of %YAML directive"),n.length!==1&&pe(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&pe(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&pe(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&xc(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,s;n.length!==2&&pe(t,"TAG directive accepts exactly two arguments"),i=n[0],s=n[1],cT.test(i)||pe(t,"ill-formed tag handle (first argument) of the TAG directive"),Qn.call(t.tagMap,i)&&pe(t,'there is a previously declared suffix for "'+i+'" tag handle'),uT.test(s)||pe(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{pe(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function Gn(e,t,r,n){var i,s,o,l;if(t<r){if(l=e.input.slice(t,r),n)for(i=0,s=l.length;i<s;i+=1)o=l.charCodeAt(i),o===9||32<=o&&o<=1114111||pe(e,"expected valid JSON character");else v9.test(l)&&pe(e,"the stream contains non-printable characters");e.result+=l}}function Q2(e,t,r,n){var i,s,o,l;for(ft.isObject(r)||pe(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),o=0,l=i.length;o<l;o+=1)s=i[o],Qn.call(t,s)||(dT(t,s,r[s]),n[s]=!0)}function ss(e,t,r,n,i,s,o,l,c){var d,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),d=0,u=i.length;d<u;d+=1)Array.isArray(i[d])&&pe(e,"nested arrays are not supported inside keys"),typeof i=="object"&&K2(i[d])==="[object Object]"&&(i[d]="[object Object]");if(typeof i=="object"&&K2(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(d=0,u=s.length;d<u;d+=1)Q2(e,t,s[d],r);else Q2(e,t,s,r);else!e.json&&!Qn.call(r,i)&&Qn.call(t,i)&&(e.line=o||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,pe(e,"duplicated mapping key")),dT(t,i,s),delete r[i];return t}function jy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):pe(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function at(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;yi(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Ur(i))for(jy(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&xc(e,"deficient indentation"),n}function xu(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Wt(r)))}function Sy(e,t){t===1?e.result+=" ":t>1&&(e.result+=ft.repeat(`
`,t-1))}function k9(e,t,r){var n,i,s,o,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Wt(h)||is(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(i=e.input.charCodeAt(e.position+1),Wt(i)||r&&is(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,l=!1;h!==0;){if(h===58){if(i=e.input.charCodeAt(e.position+1),Wt(i)||r&&is(i))break}else if(h===35){if(n=e.input.charCodeAt(e.position-1),Wt(n))break}else{if(e.position===e.lineStart&&xu(e)||r&&is(h))break;if(Ur(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,at(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Gn(e,s,o,!1),Sy(e,e.line-c),s=o=e.position,l=!1),yi(h)||(o=e.position+1),h=e.input.charCodeAt(++e.position)}return Gn(e,s,o,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function N9(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Gn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else Ur(r)?(Gn(e,n,i,!0),Sy(e,at(e,!1,t)),n=i=e.position):e.position===e.lineStart&&xu(e)?pe(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);pe(e,"unexpected end of the stream within a single quoted scalar")}function C9(e,t){var r,n,i,s,o,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Gn(e,r,e.position,!0),e.position++,!0;if(l===92){if(Gn(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Ur(l))at(e,!1,t);else if(l<256&&fT[l])e.result+=pT[l],e.position++;else if((o=_9(l))>0){for(i=o,s=0;i>0;i--)l=e.input.charCodeAt(++e.position),(o=b9(l))>=0?s=(s<<4)+o:pe(e,"expected hexadecimal character");e.result+=j9(s),e.position++}else pe(e,"unknown escape sequence");r=n=e.position}else Ur(l)?(Gn(e,r,n,!0),Sy(e,at(e,!1,t)),r=n=e.position):e.position===e.lineStart&&xu(e)?pe(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}pe(e,"unexpected end of the stream within a double quoted scalar")}function E9(e,t){var r=!0,n,i,s,o=e.tag,l,c=e.anchor,d,u,f,p,h,x=Object.create(null),g,_,v,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(at(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=o,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;r?y===44&&pe(e,"expected the node content, but found ','"):pe(e,"missed comma between flow collection entries"),_=g=v=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Wt(d)&&(f=p=!0,e.position++,at(e,!0,t))),n=e.line,i=e.lineStart,s=e.position,Cs(e,t,gc,!1,!0),_=e.tag,g=e.result,at(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===n)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),at(e,!0,t),Cs(e,t,gc,!1,!0),v=e.result),h?ss(e,l,x,_,g,v,n,i,s):f?l.push(ss(e,null,x,_,g,v,n,i,s)):l.push(g),at(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}pe(e,"unexpected end of the stream within a flow collection")}function T9(e,t){var r,n,i=og,s=!1,o=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)og===i?i=f===43?G2:g9:pe(e,"repeat of a chomping mode identifier");else if((u=w9(f))>=0)u===0?pe(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?pe(e,"repeat of an indentation width identifier"):(l=t+u-1,o=!0);else break;if(yi(f)){do f=e.input.charCodeAt(++e.position);while(yi(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Ur(f)&&f!==0)}for(;f!==0;){for(jy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>l&&(l=e.lineIndent),Ur(f)){c++;continue}if(e.lineIndent<l){i===G2?e.result+=ft.repeat(`
`,s?1+c:c):i===og&&s&&(e.result+=`
`);break}for(n?yi(f)?(d=!0,e.result+=ft.repeat(`
`,s?1+c:c)):d?(d=!1,e.result+=ft.repeat(`
`,c+1)):c===0?s&&(e.result+=" "):e.result+=ft.repeat(`
`,c):e.result+=ft.repeat(`
`,s?1+c:c),s=!0,o=!0,c=0,r=e.position;!Ur(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Gn(e,r,e.position,!1)}return!0}function Z2(e,t){var r,n=e.tag,i=e.anchor,s=[],o,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,pe(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!Wt(o))));){if(l=!0,e.position++,at(e,!0,-1)&&e.lineIndent<=t){s.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Cs(e,t,lT,!1,!0),s.push(e.result),at(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)pe(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function R9(e,t,r){var n,i,s,o,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,x=null,g=null,_=!1,v=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!_&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,pe(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),s=e.line,(y===63||y===58)&&Wt(n))y===63?(_&&(ss(e,f,p,h,x,null,o,l,c),h=x=g=null),v=!0,_=!0,i=!0):_?(_=!1,i=!0):pe(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=n;else{if(o=e.line,l=e.lineStart,c=e.position,!Cs(e,r,aT,!1,!0))break;if(e.line===s){for(y=e.input.charCodeAt(e.position);yi(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Wt(y)||pe(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(ss(e,f,p,h,x,null,o,l,c),h=x=g=null),v=!0,_=!1,i=!1,h=e.tag,x=e.result;else if(v)pe(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(v)pe(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===s||e.lineIndent>t)&&(_&&(o=e.line,l=e.lineStart,c=e.position),Cs(e,t,vc,!0,i)&&(_?x=e.result:g=e.result),_||(ss(e,f,p,h,x,g,o,l,c),h=x=g=null),at(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&y!==0)pe(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&ss(e,f,p,h,x,null,o,l,c),v&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),v}function A9(e){var t,r=!1,n=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&pe(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(n=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):pe(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Wt(o);)o===33&&(n?pe(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),cT.test(i)||pe(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),y9.test(s)&&pe(e,"tag suffix cannot contain flow indicator characters")}s&&!uT.test(s)&&pe(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{pe(e,"tag name is malformed: "+s)}return r?e.tag=s:Qn.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:pe(e,'undeclared tag handle "'+i+'"'),!0}function I9(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&pe(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Wt(r)&&!is(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&pe(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function M9(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Wt(n)&&!is(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&pe(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Qn.call(e.anchorMap,r)||pe(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],at(e,!0,-1),!0}function Cs(e,t,r,n,i){var s,o,l,c=1,d=!1,u=!1,f,p,h,x,g,_;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=l=vc===r||lT===r,n&&at(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;A9(e)||I9(e);)at(e,!0,-1)?(d=!0,l=s,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||i),(c===1||vc===r)&&(gc===r||aT===r?g=t:g=t+1,_=e.position-e.lineStart,c===1?l&&(Z2(e,_)||R9(e,_,g))||E9(e,g)?u=!0:(o&&T9(e,g)||N9(e,g)||C9(e,g)?u=!0:M9(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&pe(e,"alias node should not have any properties")):k9(e,g,gc===r)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&Z2(e,_))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&pe(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(x=e.implicitTypes[f],x.resolve(e.result)){e.result=x.construct(e.result),e.tag=x.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Qn.call(e.typeMap[e.kind||"fallback"],e.tag))x=e.typeMap[e.kind||"fallback"][e.tag];else for(x=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){x=h[f];break}x||pe(e,"unknown tag !<"+e.tag+">"),e.result!==null&&x.kind!==e.kind&&pe(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+x.kind+'", not "'+e.kind+'"'),x.resolve(e.result,e.tag)?(e.result=x.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):pe(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function P9(e){var t=e.position,r,n,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(at(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!Wt(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&pe(e,"directive name must not be less than one character in length");o!==0;){for(;yi(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Ur(o));break}if(Ur(o))break;for(r=e.position;o!==0&&!Wt(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}o!==0&&jy(e),Qn.call(X2,n)?X2[n](e,n,i):xc(e,'unknown document directive "'+n+'"')}if(at(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,at(e,!0,-1)):s&&pe(e,"directives end mark is expected"),Cs(e,e.lineIndent-1,vc,!1,!0),at(e,!0,-1),e.checkLineBreaks&&x9.test(e.input.slice(t,e.position))&&xc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&xu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,at(e,!0,-1));return}if(e.position<e.length-1)pe(e,"end of the stream or a document separator is expected");else return}function mT(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new S9(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,pe(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)P9(r);return r.documents}function O9(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=mT(e,r);if(typeof t!="function")return n;for(var i=0,s=n.length;i<s;i+=1)t(n[i])}function D9(e,t){var r=mT(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new Dt("expected a single document in the stream, but found more")}}var L9=O9,F9=D9,gT={loadAll:L9,load:F9},vT=Object.prototype.toString,xT=Object.prototype.hasOwnProperty,ky=65279,z9=9,oa=10,$9=13,q9=32,B9=33,H9=34,Pv=35,W9=37,U9=38,V9=39,G9=42,yT=44,K9=45,yc=58,Y9=61,X9=62,Q9=63,Z9=64,bT=91,_T=93,J9=96,wT=123,eH=124,jT=125,Pt={};Pt[0]="\\0";Pt[7]="\\a";Pt[8]="\\b";Pt[9]="\\t";Pt[10]="\\n";Pt[11]="\\v";Pt[12]="\\f";Pt[13]="\\r";Pt[27]="\\e";Pt[34]='\\"';Pt[92]="\\\\";Pt[133]="\\N";Pt[160]="\\_";Pt[8232]="\\L";Pt[8233]="\\P";var tH=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],rH=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function nH(e,t){var r,n,i,s,o,l,c;if(t===null)return{};for(r={},n=Object.keys(t),i=0,s=n.length;i<s;i+=1)o=n[i],l=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&xT.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[o]=l;return r}function iH(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new Dt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+ft.repeat("0",n-t.length)+t}var sH=1,aa=2;function oH(e){this.schema=e.schema||wy,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=ft.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=nH(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?aa:sH,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function J2(e,t){for(var r=ft.repeat(" ",t),n=0,i=-1,s="",o,l=e.length;n<l;)i=e.indexOf(`
`,n),i===-1?(o=e.slice(n),n=l):(o=e.slice(n,i+1),n=i+1),o.length&&o!==`
`&&(s+=r),s+=o;return s}function Ov(e,t){return`
`+ft.repeat(" ",e.indent*t)}function aH(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function bc(e){return e===q9||e===z9}function la(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==ky||65536<=e&&e<=1114111}function eS(e){return la(e)&&e!==ky&&e!==$9&&e!==oa}function tS(e,t,r){var n=eS(e),i=n&&!bc(e);return(r?n:n&&e!==yT&&e!==bT&&e!==_T&&e!==wT&&e!==jT)&&e!==Pv&&!(t===yc&&!i)||eS(t)&&!bc(t)&&e===Pv||t===yc&&i}function lH(e){return la(e)&&e!==ky&&!bc(e)&&e!==K9&&e!==Q9&&e!==yc&&e!==yT&&e!==bT&&e!==_T&&e!==wT&&e!==jT&&e!==Pv&&e!==U9&&e!==G9&&e!==B9&&e!==eH&&e!==Y9&&e!==X9&&e!==V9&&e!==H9&&e!==W9&&e!==Z9&&e!==J9}function cH(e){return!bc(e)&&e!==yc}function _o(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function ST(e){var t=/^\n* /;return t.test(e)}var kT=1,Dv=2,NT=3,CT=4,Hi=5;function uH(e,t,r,n,i,s,o,l){var c,d=0,u=null,f=!1,p=!1,h=n!==-1,x=-1,g=lH(_o(e,0))&&cH(_o(e,e.length-1));if(t||o)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=_o(e,c),!la(d))return Hi;g=g&&tS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=_o(e,c),d===oa)f=!0,h&&(p=p||c-x-1>n&&e[x+1]!==" ",x=c);else if(!la(d))return Hi;g=g&&tS(d,u,l),u=d}p=p||h&&c-x-1>n&&e[x+1]!==" "}return!f&&!p?g&&!o&&!i(e)?kT:s===aa?Hi:Dv:r>9&&ST(e)?Hi:o?s===aa?Hi:Dv:p?CT:NT}function dH(e,t,r,n,i){e.dump=function(){if(t.length===0)return e.quotingType===aa?'""':"''";if(!e.noCompatMode&&(tH.indexOf(t)!==-1||rH.test(t)))return e.quotingType===aa?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(d){return aH(e,d)}switch(uH(t,l,e.indent,o,c,e.quotingType,e.forceQuotes&&!n,i)){case kT:return t;case Dv:return"'"+t.replace(/'/g,"''")+"'";case NT:return"|"+rS(t,e.indent)+nS(J2(t,s));case CT:return">"+rS(t,e.indent)+nS(J2(fH(t,o),s));case Hi:return'"'+pH(t)+'"';default:throw new Dt("impossible error: invalid scalar style")}}()}function rS(e,t){var r=ST(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),s=i?"+":n?"":"-";return r+s+`
`}function nS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function fH(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,r.lastIndex=d,iS(e.slice(0,d),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=r.exec(e);){var l=o[1],c=o[2];s=c[0]===" ",n+=l+(!i&&!s&&c!==""?`
`:"")+iS(c,t),i=s}return n}function iS(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,s,o=0,l=0,c="";n=r.exec(e);)l=n.index,l-i>t&&(s=o>i?o:l,c+=`
`+e.slice(i,s),i=s+1),o=l;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function pH(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=_o(e,i),n=Pt[r],!n&&la(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||iH(r);return t}function hH(e,t,r){var n="",i=e.tag,s,o,l;for(s=0,o=r.length;s<o;s+=1)l=r[s],e.replacer&&(l=e.replacer.call(r,String(s),l)),(vn(e,t,l,!1,!1)||typeof l>"u"&&vn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function sS(e,t,r,n){var i="",s=e.tag,o,l,c;for(o=0,l=r.length;o<l;o+=1)c=r[o],e.replacer&&(c=e.replacer.call(r,String(o),c)),(vn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&vn(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Ov(e,t)),e.dump&&oa===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function mH(e,t,r){var n="",i=e.tag,s=Object.keys(r),o,l,c,d,u;for(o=0,l=s.length;o<l;o+=1)u="",n!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=s[o],d=r[c],e.replacer&&(d=e.replacer.call(r,c,d)),vn(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),vn(e,t,d,!1,!1)&&(u+=e.dump,n+=u));e.tag=i,e.dump="{"+n+"}"}function gH(e,t,r,n){var i="",s=e.tag,o=Object.keys(r),l,c,d,u,f,p;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new Dt("sortKeys must be a boolean or a function");for(l=0,c=o.length;l<c;l+=1)p="",(!n||i!=="")&&(p+=Ov(e,t)),d=o[l],u=r[d],e.replacer&&(u=e.replacer.call(r,d,u)),vn(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&oa===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Ov(e,t)),vn(e,t+1,u,!0,f)&&(e.dump&&oa===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,i+=p));e.tag=s,e.dump=i||"{}"}function oS(e,t,r){var n,i,s,o,l,c;for(i=r?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(l=i[s],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,vT.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(xT.call(l.represent,c))n=l.represent[c](t,c);else throw new Dt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function vn(e,t,r,n,i,s,o){e.tag=null,e.dump=r,oS(e,r,!1)||oS(e,r,!0);var l=vT.call(e.dump),c=n,d;n&&(n=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(r),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(i=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(gH(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(mH(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?sS(e,t-1,e.dump,i):sS(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(hH(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&dH(e,e.dump,t,s,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Dt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function vH(e,t){var r=[],n=[],i,s;for(Lv(e,r,n),i=0,s=n.length;i<s;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(s)}function Lv(e,t,r){var n,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Lv(e[i],t,r);else for(n=Object.keys(e),i=0,s=n.length;i<s;i+=1)Lv(e[n[i]],t,r)}function xH(e,t){t=t||{};var r=new oH(t);r.noRefs||vH(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),vn(r,0,n,!0,!0)?r.dump+`
`:""}var yH=xH,bH={dump:yH};function Ny(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var _H=kt,wH=B4,jH=V4,SH=Q4,kH=Z4,NH=wy,CH=gT.load,EH=gT.loadAll,TH=bH.dump,RH=Dt,AH={binary:nT,float:X4,map:U4,null:G4,pairs:sT,set:oT,timestamp:tT,bool:K4,int:Y4,merge:rT,omap:iT,seq:W4,str:H4},IH=Ny("safeLoad","load"),MH=Ny("safeLoadAll","loadAll"),PH=Ny("safeDump","dump"),Cy={Type:_H,Schema:wH,FAILSAFE_SCHEMA:jH,JSON_SCHEMA:SH,CORE_SCHEMA:kH,DEFAULT_SCHEMA:NH,load:CH,loadAll:EH,dump:TH,YAMLException:RH,types:AH,safeLoad:IH,safeLoadAll:MH,safeDump:PH};function aS({messages:e,pendingPrompt:t,introContent:r}){const n=m.useRef(null);return m.useEffect(()=>{var i;(i=n.current)==null||i.scrollIntoView({behavior:"smooth"})},[e,t]),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",onWheel:i=>i.stopPropagation(),children:[r,e.map((i,s)=>a.jsx("div",{className:`flex ${i.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${i.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:i.content})},s)),t&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),a.jsx("div",{ref:n})]})}function OH({onSubmit:e,disabled:t,placeholder:r}){const[n,i]=m.useState(""),s=m.useRef(null);m.useEffect(()=>{var c;t||(c=s.current)==null||c.focus()},[t]);const o=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),i("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),i(""))};return a.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("textarea",{ref:s,value:n,onChange:c=>i(c.target.value),onKeyDown:o,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),a.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const lS={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function DH({type:e,className:t}){switch(e){case"check":return a.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 9v4M12 17h.01"}),a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function LH({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const i=lS[e]||lS.blocked,s=e==="qualified";return a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:`w-16 h-16 rounded-full ${i.iconBg} flex items-center justify-center mx-auto mb-4`,children:a.jsx(DH,{type:i.icon,className:`w-8 h-8 ${i.iconColor}`})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:i.title}),a.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:i.description}),s&&t&&a.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[a.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),a.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[s&&t&&a.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),a.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function FH({operation:e,context:t,onSubmit:r,onCancel:n}){var _;const[i,s]=m.useState("confirm"),[o,l]=m.useState(!1),[c,d]=m.useState((t==null?void 0:t.project_type)||""),[u,f]=m.useState(""),h=((e==null?void 0:e.config)||{}).entry_prompt||"Review the intake classification.",x=[{value:"greenfield",label:"Greenfield (New Project)"},{value:"enhancement",label:"Enhancement (Existing Project)"},{value:"migration",label:"Migration"},{value:"integration",label:"Integration"},{value:"unknown",label:"Unknown / Other"}],g=()=>{l(!0);const v={confirmed:i==="confirm",timestamp:new Date().toISOString()};i==="correct"&&(v.corrected_project_type=c),u.trim()&&(v.notes=u.trim()),r(v)};return a.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-green, #22c55e)",color:"#fff"},children:"Intake"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Concierge Entry"}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirm or correct the intake classification"})]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",onWheel:v=>v.stopPropagation(),children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsx("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:a.jsx("div",{className:"text-sm",style:{color:"var(--text-primary)"},children:h})}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirmation requested"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Classification Result"}),a.jsxs("div",{className:"p-4 rounded space-y-3",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Intent Classification"}),a.jsx("span",{className:"px-3 py-1 rounded font-semibold",style:{background:"var(--accent-primary, #3b82f6)",color:"#fff",fontSize:12},children:((_=t==null?void 0:t.project_type)==null?void 0:_.replace(/_/g," ").toUpperCase())||"Unknown"})]}),(t==null?void 0:t.artifact_type)&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Artifact Type"}),a.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.artifact_type.replace(/_/g," ")})]}),(t==null?void 0:t.audience)&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Audience"}),a.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.audience})]}),(t==null?void 0:t.intake_summary)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Summary"}),a.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.intake_summary})]}),(t==null?void 0:t.classification_rationale)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Rationale"}),a.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:t.classification_rationale})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Your Decision"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>s("confirm"),className:"flex-1 p-4 rounded text-left",style:{background:i==="confirm"?"rgba(34, 197, 94, 0.1)":"var(--bg-panel)",border:i==="confirm"?"2px solid #22c55e":"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Confirm"}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"The classification is correct"})]}),a.jsxs("button",{onClick:()=>s("correct"),className:"flex-1 p-4 rounded text-left",style:{background:i==="correct"?"rgba(249, 115, 22, 0.1)":"var(--bg-panel)",border:i==="correct"?"2px solid #f97316":"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Correct"}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"I need to change the classification before proceeding"})]})]})]}),i==="correct"&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Correct Intent Classification"}),a.jsxs("select",{value:c,onChange:v=>d(v.target.value),className:"w-full p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[a.jsx("option",{value:"",children:"Select intent classification..."}),x.map(v=>a.jsx("option",{value:v.value,children:v.label},v.value))]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Notes (Optional)"}),a.jsx("textarea",{value:u,onChange:v=>f(v.target.value),placeholder:"Add any additional context or notes...",className:"w-full p-3 rounded text-sm",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:80,resize:"vertical"}})]})]})}),a.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[n&&a.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:"Cancel"}),a.jsxs("button",{onClick:g,disabled:o||i==="correct"&&!c,className:"px-4 py-2 rounded text-sm font-semibold flex items-center gap-2",style:{background:i==="confirm"?"#22c55e":"#f97316",color:"#fff",opacity:o||i==="correct"&&!c?.5:1},children:[o&&a.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i==="confirm"?"Confirm Classification":"Submit Correction"]})]})]})}function zH({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:i,gateOutcome:s,project:o,error:l,loading:c,submitting:d,intakeClassification:u,intakeGatePhase:f,startIntake:p,submitMessage:h,reset:x}=aB(),[g,_]=m.useState(null);m.useEffect(()=>(p(),fetch("/content/concierge-intro.yaml").then(S=>S.text()).then(S=>_(Cy.load(S))).catch(S=>console.error("Failed to load intro content:",S)),()=>x()),[]);const v=()=>{x(),e()},y=()=>{o&&t&&t(o),v()},b=S=>{h(JSON.stringify(S))},w=()=>{const S=[{id:"describe",label:"Describe"},{id:"confirm",label:"Confirm"},{id:"complete",label:"Done"}];let C=r;f==="awaiting_confirmation"&&(C="confirm"),(C==="review"||C==="generating")&&(C="complete");const T=S.findIndex(j=>j.id===C);return a.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:S.map((j,R)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 py-0.5 rounded ${R===T?"bg-violet-500/30 text-violet-300":R<T?"text-emerald-400":"text-slate-500"}`,children:j.label}),R<S.length-1&&a.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},j.id))})},k=()=>{var S;if(c&&r==="idle")return a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});if(f==="awaiting_confirmation"&&u)return a.jsx(FH,{operation:{config:{entry_prompt:i}},context:u,onSubmit:b,onCancel:v});switch(r){case"describe":const C=g?a.jsxs("div",{className:"mb-4 pb-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h3",{className:"text-base font-semibold mb-3",style:{color:"var(--text-primary)"},children:g.title}),a.jsx("div",{className:"text-sm space-y-3",style:{color:"var(--text-secondary)"},children:(S=g.paragraphs)==null?void 0:S.map((T,j)=>a.jsx("p",{children:T},j))}),g.call_to_action&&a.jsx("p",{className:"text-sm font-medium mt-4",style:{color:"var(--text-primary)"},children:g.call_to_action})]}):null;return a.jsxs(a.Fragment,{children:[a.jsx(aS,{messages:n,pendingPrompt:i,introContent:C}),a.jsx(OH,{onSubmit:h,disabled:d,placeholder:"Describe what you want to build..."})]});case"complete":return a.jsxs(a.Fragment,{children:[a.jsx(aS,{messages:n}),a.jsx(LH,{gateOutcome:s,project:o,onViewProject:y,onClose:v})]});default:return null}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:a.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},onWheel:S=>S.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),w()]})]}),a.jsx("button",{onClick:v,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l&&a.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:l}),k()]})})}function $H({onClose:e}){const{user:t,logout:r,isAdmin:n}=Ls(),[i,s]=m.useState(null),[o,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{i==="linked"&&p()},[i]);const p=async()=>{try{d(!0);const k=await fetch("/auth/accounts",{credentials:"include"});if(k.ok){const S=await k.json();l(S.identities||[])}}catch(k){console.error("Failed to load accounts:",k)}finally{d(!1)}},h=k=>{window.location.href=`/auth/accounts/link/${k}`},x=async k=>{var S;if(o.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${k} account?`))try{const C=(S=document.cookie.split("; ").find(j=>j.startsWith("csrf=")||j.startsWith("__Host-csrf=")))==null?void 0:S.split("=")[1],T=await fetch(`/auth/accounts/${k}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":C||""}});if(T.ok)f({type:"success",text:"Account unlinked"}),await p();else{const j=await T.json();throw new Error(j.detail||"Failed to unlink")}}catch(C){f({type:"error",text:C.message})}},g=async()=>{await r(),e()},_=k=>{s(i===k?null:k),f(null)},v={google:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=k=>{const S={user:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),a.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return S[k]||S.user},w=k=>{switch(k){case"account":return a.jsxs("div",{className:"px-4 py-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return a.jsxs("div",{className:"px-4 py-3",children:[u&&a.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-2 mb-4",children:o.map(S=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[v[S.provider_id],a.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:S.provider_email})]}),a.jsx("button",{onClick:()=>x(S.provider_id),disabled:o.length<=1,className:`text-xs px-2 py-1 rounded ${o.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},S.provider_id))}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),a.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.google,"Google"]}),a.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.microsoft,"Microsoft"]})]})]})]});default:return a.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),a.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?a.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),a.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),a.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),a.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),a.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),a.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(k=>a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("button",{onClick:()=>!k.future&&_(k.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${k.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:k.future,children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:b(k.icon)}),a.jsx("span",{className:"flex-1 text-sm text-left",children:k.label}),k.future?a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):a.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:i===k.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),i===k.id&&!k.future&&a.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:w(k.id)})]},k.id))]}),a.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Pe={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function qH(){return a.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Pe.bg,borderColor:Pe.border},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Pe.textPrimary},children:"THE COMBINE"}),a.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Pe.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function BH(){return a.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Pe.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),a.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Pe.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),a.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Pe.textMuted},onMouseOver:e=>e.currentTarget.style.color=Pe.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Pe.textMuted,children:["Learn how The Combine works",a.jsx("span",{"aria-hidden":"true",children:""})]})]})}function HH(){const e=[{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return a.jsx("section",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>a.jsxs("div",{className:"flex-1 text-center group",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Pe.bgElevated,border:`1px solid ${Pe.border}`,color:Pe.textMuted},children:t.icon}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Pe.textPrimary},children:t.title}),a.jsx("p",{className:"text-xs",style:{color:Pe.textMuted},children:t.description}),r<e.length-1&&a.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Pe.border}})]},r))})})}function WH(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return a.jsx("section",{className:"text-center",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>a.jsx("span",{className:"text-xs",style:{color:Pe.textMuted},children:t},r))})})}function UH({onLogin:e}){return a.jsxs("section",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Pe.textSecondary},children:"Ready?"}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Pe.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Pe.accentHover,onMouseOut:t=>t.currentTarget.style.background=Pe.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Pe.bg,border:`1px solid ${Pe.border}`,color:Pe.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Pe.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Pe.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function VH(){return a.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Pe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Pe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Pe.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Pe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Pe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Pe.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Pe.border},children:" 2026 The Combine"})]})}function GH(){const{login:e}=Ls();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Pe.bg},children:[a.jsx(qH,{}),a.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:a.jsxs("div",{className:"space-y-12",children:[a.jsx(BH,{}),a.jsx(HH,{}),a.jsx(WH,{}),a.jsx(UH,{onLogin:e})]})}),a.jsx(VH,{})]})}const Te={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function KH(){return a.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Te.bg,borderColor:Te.border},children:[a.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Te.textMuted},onMouseOver:e=>e.currentTarget.style.color=Te.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Te.textMuted,children:[a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),a.jsx("span",{className:"text-sm",children:"Back"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),a.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Te.textPrimary},children:"THE COMBINE"})]}),a.jsx("div",{className:"w-16"})," "]})}function ii({title:e,children:t}){return a.jsxs("section",{className:"mb-16",children:[e&&a.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Te.textPrimary},children:e}),t]})}function ht({children:e,className:t=""}){return a.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Te.textSecondary},children:e})}function to({children:e}){return a.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Te.textPrimary,borderLeft:`2px solid ${Te.border}`},children:e})}function sl({items:e}){return a.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>a.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Te.textSecondary},children:[a.jsx("span",{style:{color:Te.textMuted},children:"-"}),t]},r))})}function ol({number:e,title:t,children:r}){return a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[a.jsxs("span",{className:"text-sm font-mono",style:{color:Te.textMuted},children:[e,"."]}),a.jsx("h3",{className:"text-base font-medium",style:{color:Te.textPrimary},children:t})]}),a.jsx("div",{className:"pl-7",children:a.jsx(ht,{children:r})})]})}function al({title:e,children:t}){return a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Te.textPrimary},children:e}),a.jsx(ht,{className:"mb-0",children:t})]})}function YH({onLogin:e}){return a.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Te.bgElevated,border:`1px solid ${Te.border}`},children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Te.textPrimary},children:"When You're Ready"}),a.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),a.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),a.jsx(ht,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Te.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Te.accentHover,onMouseOut:t=>t.currentTarget.style.background=Te.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Te.bg,border:`1px solid ${Te.border}`,color:Te.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Te.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Te.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function XH(){return a.jsxs("footer",{className:"py-8 text-center",children:[a.jsx("p",{className:"text-sm mb-6",style:{color:Te.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Te.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Te.textMuted,onMouseOut:e=>e.currentTarget.style.color=Te.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Te.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Te.textMuted,onMouseOut:e=>e.currentTarget.style.color=Te.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Te.border},children:" 2026 The Combine"})]})]})}function QH(){const{login:e}=Ls();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Te.bg},children:[a.jsx(KH,{}),a.jsx("main",{className:"flex-1 px-6 py-12",children:a.jsxs("article",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Te.textPrimary},children:"Learn More"}),a.jsxs(ii,{title:"What The Combine Is",children:[a.jsx(ht,{children:"The Combine is an AI-assisted production system for knowledge work."}),a.jsx(ht,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),a.jsx(to,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),a.jsx(to,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),a.jsxs(ii,{title:"Why It Exists",children:[a.jsx(ht,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),a.jsx(ht,{children:"It breaks down when the work must be:"}),a.jsx(sl,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),a.jsx(ht,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),a.jsxs(ii,{title:'Why "The Combine"',children:[a.jsx(ht,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),a.jsx(ht,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),a.jsx(ht,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),a.jsx(ht,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),a.jsx(ht,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),a.jsx(sl,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),a.jsx(ht,{children:"This is not automation for speed. It is industrialization for reliability."}),a.jsx(to,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),a.jsxs(ii,{title:"How It Works",children:[a.jsx(ol,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),a.jsx(ol,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),a.jsx(ol,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),a.jsx(ol,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),a.jsxs(ii,{title:"What Makes It Different",children:[a.jsx(al,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),a.jsx(al,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),a.jsx(al,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),a.jsx(al,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),a.jsxs(ii,{title:"What The Combine Is Not",children:[a.jsx(sl,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),a.jsx(ht,{children:"If you want improvisation, there are better tools."}),a.jsx(to,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),a.jsxs(ii,{title:"Who It's For",children:[a.jsx(ht,{children:"The Combine is designed for people responsible for outcomes, including:"}),a.jsx(sl,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),a.jsx(to,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),a.jsx(YH,{onLogin:e})]})}),a.jsx(XH,{})]})}function ET(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await _e.getTemplates();t(l.templates||[])}catch(l){s(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{templates:e,loading:r,error:i,refresh:o}}function ZH(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await _e.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){s(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{workflows:e,loading:r,error:i,refresh:o}}function TT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await _e.getSchemas();t(l.schemas||[])}catch(l){s(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{schemas:e,loading:r,error:i,refresh:o}}function RT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){n(!0),s(null);try{const h=await _e.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&s(h.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return p(),()=>{f=!1}},[]);const o=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:o.role.length,task:o.task.length,qa:o.qa.length,pgc:o.pgc.length,questions:o.questions.length,reflection:o.reflection.length}),[e,o]),c=m.useCallback(f=>!f||f==="all"?e:o[f]||[],[e,o]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{n(!0),s(null);try{const f=await _e.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),s(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:i,fragmentsByKind:o,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const ag="doctype-browser-collapsed";function AT(e,t){const[r,n]=m.useState(()=>{try{const s=JSON.parse(localStorage.getItem(ag)||"{}");return e in s?s[e]:t}catch{return t}}),i=m.useCallback(s=>{const o=typeof s=="function"?s(r):s;n(o);try{const l=JSON.parse(localStorage.getItem(ag)||"{}");l[e]=o,localStorage.setItem(ag,JSON.stringify(l))}catch{}},[e,r]);return[r,i]}function cS({title:e,defaultOpen:t=!0,children:r}){const[n,i]=AT(`group:${e}`,t);return a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function uS({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:i}){const[s,o]=AT(`sub:${e}`,r);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:s?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&a.jsx("span",{style:{color:n,fontSize:8},children:""}),a.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),s&&i]})}function dS({selected:e,onClick:t,label:r,sublabel:n,badge:i}){return a.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:r}),i&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:i})]}),n&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function fS({loading:e,empty:t,emptyMessage:r="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function JH({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:i=[],promptFragmentKindOptions:s=[],schemas:o=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:x=null,selectedRole:g=null,selectedTemplate:_=null,selectedWorkflow:v=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:w,onSelectRole:k,onSelectTemplate:S,onSelectWorkflow:C,onSelectFragment:T,onSelectStandaloneSchema:j,onCreateWorkflow:R,onCreateDocType:E,onCreateFragment:M,onCreateTemplate:$,onCreateSchema:N,onSelectTask:D,onSelectSchema:I,workspaceState:F=null}){var ye;const[P,A]=m.useState(null),[L,z]=m.useState(null),[B,X]=m.useState(""),[G,W]=m.useState(!1),[q,Q]=m.useState(!1),[ie,oe]=m.useState(""),[J,je]=m.useState(!1),ge=[...e].sort((ee,he)=>(ee.display_name||"").localeCompare(he.display_name||"")),we=n.filter(ee=>(ee.pow_class||"reference")==="reference"),xe=ee=>{const he=ee.pow_class||"reference";return he==="reference"?"ref":he==="template"?"tpl":"inst"},se=e.filter(ee=>ee.active_version).length+n.filter(ee=>ee.active_version).length,K=((ye=F==null?void 0:F.modified_artifacts)==null?void 0:ye.length)??0,re=(F==null?void 0:F.is_dirty)??!1,U=()=>{A(null),z(null),X("")},de=()=>{Q(!1),oe("")},fe=async()=>{const ee=ie.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ee||!/^[a-z][a-z0-9_]*$/.test(ee))){je(!0);try{await(E==null?void 0:E({doc_type_id:ee})),de()}catch{}finally{je(!1)}}},me=async()=>{const ee=B.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ee||!/^[a-z][a-z0-9_]*$/.test(ee))){W(!0);try{const he={workflow_id:ee,pow_class:"template"};L&&(he.derived_from={workflow_id:L.workflow_id,version:L.active_version},he.source_version=L.active_version),await(R==null?void 0:R(he)),U()}catch{}finally{W(!1)}}};return a.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(cS,{title:"Production Workflows",defaultOpen:!0,children:[a.jsxs(uS,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&a.jsx("button",{onClick:()=>A(P?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[P==="choose"&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("button",{onClick:()=>A("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:we.length===0,children:["From Reference",we.length===0?" (none available)":""]}),a.jsx("button",{onClick:()=>A("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),a.jsx("button",{onClick:U,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),P==="from_reference"&&!L&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),we.map(ee=>a.jsxs("button",{onClick:()=>z(ee),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("div",{className:"font-medium",children:ee.name||ee.workflow_id.replace(/_/g," ").replace(/\b\w/g,he=>he.toUpperCase())}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",ee.active_version]})]},ee.workflow_id)),a.jsx("button",{onClick:()=>A("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(P==="blank"||P==="from_reference"&&L)&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[L&&a.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",L.name||L.workflow_id," v",L.active_version]}),a.jsx("input",{type:"text",value:B,onChange:ee=>X(ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&me(),ee.key==="Escape"&&U()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:G,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:me,disabled:G||!B.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:G?"wait":"pointer",opacity:!B.trim()||G?.5:1},children:G?"Creating...":"Create"}),a.jsx("button",{onClick:U,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(fS,{loading:u,empty:!u&&n.length===0,emptyMessage:"No workflows"}),!u&&n.length>0&&a.jsx("div",{className:"py-1",children:n.map(ee=>a.jsx(dS,{selected:(v==null?void 0:v.workflow_id)===ee.workflow_id,onClick:()=>C==null?void 0:C(ee),label:ee.name||ee.workflow_id.replace(/_/g," ").replace(/\b\w/g,he=>he.toUpperCase()),sublabel:`v${ee.active_version}`,badge:xe(ee)},ee.workflow_id))})]}),a.jsxs(uS,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:E&&a.jsx("button",{onClick:()=>Q(!q),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[q&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:ie,onChange:ee=>oe(ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&fe(),ee.key==="Escape"&&de()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:J,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:fe,disabled:J||!ie.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:J?"wait":"pointer",opacity:!ie.trim()||J?.5:1},children:J?"Creating...":"Create"}),a.jsx("button",{onClick:de,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(fS,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&ge.length>0&&a.jsx("div",{className:"py-1",children:ge.map(ee=>a.jsx(dS,{selected:x==="docworkflow"&&(h==null?void 0:h.doc_type_id)===ee.doc_type_id,onClick:()=>w==null?void 0:w(ee),label:ee.display_name,badge:`v${ee.active_version}`},ee.doc_type_id))})]})]}),a.jsxs(cS,{title:"Governance",defaultOpen:!1,children:[a.jsx("div",{className:"px-4 py-3",children:a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),a.jsxs("div",{children:[se," active ",se===1?"release":"releases"]})]})}),F&&a.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),re&&a.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[K," dirty"]})]})]})]})})}function e7({kinds:e=[],selectedKind:t="all",onSelect:r}){return a.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:i,count:s})=>{const o=t===n;return a.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:o?"var(--action-primary)":"var(--bg-panel)",color:o?"#000":"var(--text-secondary)",border:o?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[i,s!==void 0&&a.jsxs("span",{style:{marginLeft:4,opacity:o?.7:.6},children:["(",s,")"]})]},n)})})}function ll({title:e,count:t,dotColor:r,defaultOpen:n=!1,action:i,children:s}){const[o,l]=m.useState(n);return a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[a.jsxs("button",{onClick:()=>l(!o),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),a.jsx("span",{style:{color:r,fontSize:10},children:""}),a.jsx("span",{className:"font-semibold",children:e})]}),a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),i&&a.jsx("div",{className:"pr-3",children:i})]}),o&&a.jsx("div",{style:{background:"var(--bg-panel)"},children:s})]})}function ro({onClick:e,label:t,sublabel:r,badge:n,isSelected:i}){return a.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:i?"var(--bg-selected, rgba(99, 102, 241, 0.15))":"transparent",border:"none",borderLeft:i?"3px solid var(--action-primary)":"3px solid transparent",color:i?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:t}),n&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:n})]}),r&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function cl({loading:e,empty:t,emptyMessage:r="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function t7({isOpen:e,onClose:t,promptFragments:r=[],promptFragmentKindOptions:n=[],templates:i=[],schemas:s=[],documentTypes:o=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,selectedFragment:h=null,selectedTemplate:x=null,selectedSchema:g=null,selectedMechanicalOp:_=null,onSelectFragment:v,onSelectTemplate:y,onSelectSchema:b,onSelectStandaloneSchema:w,onSelectMechanicalOp:k,onCreateFragment:S,onCreateTemplate:C,onCreateSchema:T}){const[j,R]=m.useState("all"),[E,M]=m.useState(!1),[$,N]=m.useState("role"),[D,I]=m.useState(""),[F,P]=m.useState(!1),[A,L]=m.useState(!1),[z,B]=m.useState(""),[X,G]=m.useState(!1),[W,q]=m.useState(!1),[Q,ie]=m.useState(""),[oe,J]=m.useState(!1),je=j==="all"?r:r.filter(K=>K.kind===j);m.useEffect(()=>{e||(M(!1),L(!1),q(!1),I(""),B(""),ie(""))},[e]);const ge=m.useCallback((K,re)=>{K==null||K(re)},[]),we=async()=>{const K=D.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){P(!0);try{await(S==null?void 0:S({role_id:K,kind:$})),M(!1),I("")}catch{}finally{P(!1)}}},xe=async()=>{const K=z.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){G(!0);try{await(C==null?void 0:C({template_id:K})),L(!1),B("")}catch{}finally{G(!1)}}},se=async()=>{const K=Q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!K||!/^[a-z][a-z0-9_]*$/.test(K))){J(!0);try{await(T==null?void 0:T({schema_id:K})),q(!1),ie("")}catch{}finally{J(!1)}}};return e?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),a.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),a.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(ll,{title:"Prompt Fragments",count:r.length,dotColor:"#f59e0b",defaultOpen:!0,action:S&&a.jsx("button",{onClick:()=>M(!E),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[E&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),a.jsx("select",{value:$,onChange:K=>N(K.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:a.jsx("option",{value:"role",children:"Role"})})]}),a.jsx("input",{type:"text",value:D,onChange:K=>I(K.target.value),onKeyDown:K=>{K.key==="Enter"&&we(),K.key==="Escape"&&M(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:F,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:we,disabled:F||!D.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:F?"wait":"pointer",opacity:!D.trim()||F?.5:1},children:F?"Creating...":"Create"}),a.jsx("button",{onClick:()=>M(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.length>0&&a.jsx(e7,{kinds:n,selectedKind:j,onSelect:R}),a.jsx(cl,{loading:d,empty:!d&&je.length===0,emptyMessage:j==="all"?"No prompt fragments":`No ${j} fragments`}),!d&&je.length>0&&a.jsx("div",{className:"py-1",children:je.map(K=>a.jsx(ro,{onClick:()=>ge(v,K),label:K.name||K.fragment_id,sublabel:`${K.kind}  v${K.version}`,badge:K.kind,isSelected:(h==null?void 0:h.fragment_id)===K.fragment_id},K.fragment_id))})]}),a.jsxs(ll,{title:"Templates",count:i.length,dotColor:"var(--dot-green)",action:C&&a.jsx("button",{onClick:()=>L(!A),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[A&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:z,onChange:K=>B(K.target.value),onKeyDown:K=>{K.key==="Enter"&&xe(),K.key==="Escape"&&L(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:X,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:xe,disabled:X||!z.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:X?"wait":"pointer",opacity:!z.trim()||X?.5:1},children:X?"Creating...":"Create"}),a.jsx("button",{onClick:()=>L(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(cl,{loading:u,empty:!u&&i.length===0,emptyMessage:"No templates"}),!u&&i.length>0&&a.jsx("div",{className:"py-1",children:i.map(K=>a.jsx(ro,{onClick:()=>ge(y,K),label:K.name||K.template_id.replace(/_/g," ").replace(/\b\w/g,re=>re.toUpperCase()),sublabel:`v${K.active_version}`,isSelected:(x==null?void 0:x.template_id)===K.template_id},K.template_id))})]}),a.jsxs(ll,{title:"Schemas",count:s.length||o.length,dotColor:"var(--dot-blue)",action:T&&a.jsx("button",{onClick:()=>q(!W),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[W&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:Q,onChange:K=>ie(K.target.value),onKeyDown:K=>{K.key==="Enter"&&se(),K.key==="Escape"&&q(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:oe,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:se,disabled:oe||!Q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:oe?"wait":"pointer",opacity:!Q.trim()||oe?.5:1},children:oe?"Creating...":"Create"}),a.jsx("button",{onClick:()=>q(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(cl,{loading:f,empty:!f&&s.length===0&&o.length===0,emptyMessage:"No schemas"}),!f&&s.length>0&&a.jsx("div",{className:"py-1",children:s.map(K=>a.jsx(ro,{onClick:()=>ge(w,K),label:K.title||K.schema_id,sublabel:`v${K.active_version}`,isSelected:(g==null?void 0:g.schema_id)===K.schema_id},`standalone-${K.schema_id}`))}),s.length===0&&o.length>0&&a.jsx("div",{className:"py-1",children:o.map(K=>a.jsx(ro,{onClick:()=>ge(b,{doc_type_id:K.doc_type_id,display_name:K.display_name,active_version:K.active_version}),label:K.display_name,sublabel:`from ${K.doc_type_id}`},`schema-${K.doc_type_id}`))})]}),a.jsxs(ll,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[a.jsx(cl,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&a.jsx("div",{className:"py-1",children:l.map(K=>{const re=c.filter(U=>U.type===K.type_id);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsx("span",{style:{fontSize:10},children:""}),a.jsx("span",{children:K.name}),a.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",re.length,")"]})]}),re.length>0?re.map(U=>a.jsx(ro,{onClick:()=>ge(k,U),label:U.name,sublabel:`v${U.active_version}`,badge:U.type,isSelected:(_==null?void 0:_.op_id)===U.op_id},U.op_id)):a.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},K.type_id)})}),!p&&l.length===0&&c.length===0&&a.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),a.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function tn({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:i=!1,error:s=null,readOnly:o=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o&&a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!o&&i&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&!o&&a.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&i&&a.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),s&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",s]})]})]}),a.jsx("div",{className:"flex-1 relative",children:r?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):a.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:o,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function r7({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),s(!1);return}(async()=>{s(!0),l(null);try{const d=await _e.getPreview(e,t);n(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{s(!1)}})()},[e,t]),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&a.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&a.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&a.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&a.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),a.jsx("div",{className:"flex-1 relative overflow-auto",children:i?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):o?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[a.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:o})]})}):a.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function n7({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,w,k;t&&(s({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((w=t.ui)==null?void 0:w.category)||"",ui_display_order:((k=t.ui)==null?void 0:k.display_order)||0}),h(!1),f(null))},[t]);const x=m.useCallback((b,w)=>{s(k=>({...k,[b]:w})),h(!0)},[]),g=m.useCallback((b,w)=>{const k=w.split(",").map(S=>S.trim()).filter(S=>S);s(S=>({...S,[b]:k})),h(!0)},[]),_=m.useCallback(b=>{if(!b)return"";const w=r.find(k=>k.role_id===b);return w?`prompt:role:${b}:${w.active_version}`:""},[r]),v=m.useCallback(b=>{if(!b)return"";const w=b.split(":");return w.length>=3&&w[0]==="prompt"&&w[1]==="role"?w[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!i)){d(!0),f(null);try{const b=t.version||t.active_version,w=`doctype:${t.doc_type_id}:${b}:manifest`,k=i7(t.doc_type_id,b,i),S=await _e.writeArtifact(e,w,k);h(!1),n==null||n(w,S)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,i,n]);return!t||!i?a.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"flex items-center gap-2",children:p&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),a.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsxs(no,{title:"Identity",children:[a.jsx(Zt,{label:"Display Name",children:a.jsx("input",{type:"text",value:i.display_name,onChange:b=>x("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Description",children:a.jsx("textarea",{value:i.description,onChange:b=>x("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"Classification",children:[a.jsx(Zt,{label:"Authority Level",children:a.jsxs("select",{value:i.authority_level,onChange:b=>x("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"descriptive",children:"Descriptive"}),a.jsx("option",{value:"prescriptive",children:"Prescriptive"}),a.jsx("option",{value:"constructive",children:"Constructive"}),a.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),a.jsx(Zt,{label:"Creation Mode",children:a.jsxs("select",{value:i.creation_mode,onChange:b=>x("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"llm_generated",children:"LLM Generated"}),a.jsx("option",{value:"constructed",children:"Constructed"}),a.jsx("option",{value:"extracted",children:"Extracted"})]})}),a.jsx(Zt,{label:"Scope",children:a.jsxs("select",{value:i.scope,onChange:b=>x("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"epic",children:"Epic"}),a.jsx("option",{value:"feature",children:"Feature"})]})})]}),a.jsx(no,{title:"Shared References",children:a.jsxs(Zt,{label:"Role Prompt",children:[a.jsxs("select",{value:v(i.role_prompt_ref),onChange:b=>x("role_prompt_ref",_(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"None"}),r.map(b=>a.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())},b.role_id))]}),i.role_prompt_ref&&a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:i.role_prompt_ref})]})}),a.jsxs(no,{title:"Dependencies",children:[a.jsx(Zt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Parent Doc Type",children:a.jsx("input",{type:"text",value:i.parent_doc_type,onChange:b=>x("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"UI Configuration",children:[a.jsx(Zt,{label:"Icon",children:a.jsx("input",{type:"text",value:i.ui_icon,onChange:b=>x("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Category",children:a.jsxs("select",{value:i.ui_category,onChange:b=>x("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"Select category..."}),a.jsx("option",{value:"intake",children:"Intake"}),a.jsx("option",{value:"architecture",children:"Architecture"}),a.jsx("option",{value:"planning",children:"Planning"}),a.jsx("option",{value:"execution",children:"Execution"})]})}),a.jsx(Zt,{label:"Display Order",children:a.jsx("input",{type:"number",value:i.ui_display_order,onChange:b=>x("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function no({title:e,children:t}){return a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),a.jsx("div",{className:"space-y-4",children:t})]})}function Zt({label:e,hint:t,children:r}){return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&a.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function i7(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(i=>`"${i}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(i=>`"${i}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(i=>`"${i}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function IT(e,t,{debounceMs:r=1e3,onSave:n}={}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,g]=m.useState(null),_=m.useRef(null),v=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(null),l(null),d(!1);return}d(!0),f(null);try{const C=await _e.getArtifact(e,t),T=JSON.parse(C.content);s(T),l(T)}catch(C){f(C.message),console.error("Failed to load workflow artifact:",C)}finally{d(!1)}},[e,t]),b=m.useCallback(async C=>{if(!(!e||!t)){h(!0),f(null);try{const T=JSON.stringify(C,null,2),j=await _e.writeArtifact(e,t,T);g(j),l(C),n&&n(j)}catch(T){f(T.message),console.error("Failed to save workflow:",T)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(C=>{v.current=C,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),k=m.useCallback(C=>{s(C),w(C)},[w]),S=m.useCallback(()=>{_.current&&clearTimeout(_.current),i&&b(i)},[i,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{workflowJson:i,originalJson:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateWorkflow:k,saveNow:S,reload:y}}function s7({data:e,selected:t}){const{config:r,isEntry:n}=e,i=e.type==="end";return a.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[a.jsx(Vr,{type:"target",position:ue.Top,style:{background:r.color,width:8,height:8,border:"none"}}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[a.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&a.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),a.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&a.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),a.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!i&&a.jsx(Vr,{type:"source",position:ue.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const o7=m.memo(s7),_c={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},a7={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},pS=220,hS=110;function mS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(i=>{const s=_c[i.type]||_c.task,l=i.type==="end"&&["blocked","abandoned"].includes(i.terminal_outcome)?a7:s;return{id:i.node_id,type:"workflowNode",position:i._position||{x:0,y:0},data:{...i,config:l,isEntry:t.includes(i.node_id)}}}),n=(e.edges||[]).map(i=>{const s=i.non_advancing||!i.to_node_id,o=i.conditions&&i.conditions.length>0;let l=i.label||i.outcome;if(o){const c=i.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id||i.from_node_id,type:"smoothstep",animated:s,label:l,data:{...i},style:{stroke:s?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:s?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:i.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function gS(e,t,r="TB"){const n=new mc.graphlib.Graph;return n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(i=>{n.setNode(i.id,{width:pS,height:hS})}),t.forEach(i=>{i.target!==i.source&&n.setEdge(i.source,i.target)}),mc.layout(n),e.map(i=>{const s=n.node(i.id);return s?{...i,position:{x:s.x-pS/2,y:s.y-hS/2}}:i})}function l7(e,t){const r=new Set(t.map(s=>s.id||s.node_id));let n=1,i=`${e}_${n}`;for(;r.has(i);)n++,i=`${e}_${n}`;return i}function c7(e,t,r){const n=new Set(r.map(o=>o.id||o.edge_id));let i=1,s=`${e}_to_${t}`;for(;n.has(s);)i++,s=`${e}_to_${t}_${i}`;return s}function u7(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const d7={workflowNode:o7},f7=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function p7({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:i,onEdgeSelect:s}){const o=Qc(),[l,c,d]=mE([]),[u,f,p]=gE([]),[h,x]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:j,edges:R}=mS(e);(!j.some(M=>M.position.x!==0||M.position.y!==0)||!g.current)&&(j=gS(j,R),g.current=!0),c(j),f(R)},[e,c,f]),m.useEffect(()=>{c(j=>j.map(R=>({...R,selected:R.id===r})))},[r,c]);const _=m.useCallback(j=>{if(!e)return;const E={edge_id:c7(j.source,j.target,e.edges||[]),from_node_id:j.source,to_node_id:j.target,outcome:"success",label:"",kind:"auto"},M={...e,edges:[...e.edges||[],E]};t(M)},[e,t]),v=m.useCallback((j,R)=>{if(!e)return;const E=e.nodes.map(M=>M.node_id===R.id?{...M,_position:R.position}:M);t({...e,nodes:E})},[e,t]),y=m.useCallback((j,R)=>{i==null||i(R.id)},[i]),b=m.useCallback((j,R)=>{s==null||s(R.id)},[s]),w=m.useCallback(()=>{i==null||i(null),s==null||s(null)},[i,s]),k=m.useCallback(j=>{if(j.key==="Delete"||j.key==="Backspace"){if(r&&e){const R={...e,nodes:e.nodes.filter(E=>E.node_id!==r),edges:e.edges.filter(E=>E.from_node_id!==r&&E.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(E=>E!==r)};t(R),i==null||i(null)}else if(n&&e){const R={...e,edges:e.edges.filter(E=>E.edge_id!==n)};t(R),s==null||s(null)}}},[r,n,e,t,i,s]),S=m.useCallback(j=>{if(!e)return;const R=l7(j,e.nodes||[]),E=u7(j);E.node_id=R;const M=o.getViewport(),$=(-M.x+window.innerWidth/2)/M.zoom,N=(-M.y+window.innerHeight/2)/M.zoom;E._position={x:$-110,y:N-50};const D={...e,nodes:[...e.nodes||[],E]};t(D),x(!1),i==null||i(R)},[e,t,o,i]),C=m.useCallback(()=>{if(!e)return;let{nodes:j,edges:R}=mS(e);j=gS(j,R);const E=e.nodes.map(M=>{const $=j.find(N=>N.id===M.node_id);return $?{...M,_position:$.position}:M});t({...e,nodes:E}),setTimeout(()=>{o.fitView({padding:.2,duration:300})},50)},[e,t,o]),T=m.useCallback(()=>{o.fitView({padding:.2,duration:300})},[o]);return a.jsx("div",{className:"flex-1 relative",onKeyDown:k,tabIndex:0,style:{outline:"none"},children:a.jsxs(Jx,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:_,onNodeDragStop:v,onNodeClick:y,onEdgeClick:b,onPaneClick:w,nodeTypes:d7,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[a.jsx(Wn,{position:"top-left",children:a.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>x(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&a.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:f7.map(j=>{const R=_c[j.value]||{};return a.jsxs("button",{onClick:()=>S(j.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),j.label]},j.value)})})]}),a.jsx("button",{onClick:C,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),a.jsx("button",{onClick:T,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),a.jsx(yE,{position:"bottom-right",nodeColor:j=>{var E;const R=(E=j.data)==null?void 0:E.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Wn,{position:"bottom-left",children:a.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(_c).map(([j,R])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},j))})}),a.jsx(Wn,{position:"top-right",children:a.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const h7=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],vS=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],xS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],m7=["semantic","structural","hybrid"],g7=["stabilized","blocked","abandoned"],Fe={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},wt={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},v7={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function lg(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function cg(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function $i(e){var i;if(!e)return"";const t=e.kind||"role",r=((i=e.fragment_id)==null?void 0:i.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function qi(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function ul(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function dl(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function ug({title:e,defaultOpen:t=!1,isOpen:r,onToggle:n,children:i,badge:s}){const[o,l]=m.useState(t),c=r!==void 0,d=c?r:o,u=()=>{c&&n?n():l(!o)};return a.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:a.jsx("path",{d:"M9 18l6-6-6-6"})}),a.jsx("span",{style:{...wt,marginBottom:0},children:e})]}),s&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:s})]}),d&&a.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:i})]})}function dg(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function Bi(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function x7({node:e,onChange:t,onDelete:r,templates:n=[],schemas:i=[],roleFragments:s=[],taskFragments:o=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var fe,me,ye,ee,he,De,nt,Re,Me,Be,et,Ae,Z,Ce,ve,Ct,yt,bt,Qt;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const x=(O,H)=>{const V={...u,[O]:H};f(V),t(V)},g=(O,H)=>{const V={...u.includes,[O]:H},ne={...u,includes:V};f(ne),t(ne)},_=O=>{const H={...u.includes};delete H[O];const V={...u,includes:H};f(V),t(V)},v=()=>{const O={...u.includes,NEW_KEY:""},H={...u,includes:O};f(H),t(H)},y=O=>{const H={...u,internals:O};f(H),t(H)},b=(O,H)=>{const V=u.internals||S(),ne={...V.question_generation,[O]:H};y({...V,question_generation:ne})},w=(O,H)=>{const V=u.internals||S(),ne={...V.question_generation.includes,[O]:H},Le={...V.question_generation,includes:ne};y({...V,question_generation:Le})},k=(O,H)=>{const V=u.internals||S(),ne={...V.clarification_merge,[O]:H};y({...V,clarification_merge:ne})},S=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const C=u.type==="pgc",T=cg(u.task_ref),j=u.includes||{},R=j.ROLE_PROMPT||"",E=j.TASK_PROMPT||"",M=j.OUTPUT_SCHEMA||"",$=j.PGC_CONTEXT||"",N=qi(R),D=qi(E),I=dl(M),F=qi($),P=Object.entries(j).filter(([O])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(O)),A=u.internals||S(),L=cg((fe=A.question_generation)==null?void 0:fe.template_ref),z=qi((ye=(me=A.question_generation)==null?void 0:me.includes)==null?void 0:ye.ROLE_PROMPT),B=qi((he=(ee=A.question_generation)==null?void 0:ee.includes)==null?void 0:he.TASK_PROMPT),X=qi((nt=(De=A.question_generation)==null?void 0:De.includes)==null?void 0:nt.PGC_CONTEXT),G=dl((Re=A.question_generation)==null?void 0:Re.output_schema_ref),W=cg((Me=A.clarification_merge)==null?void 0:Me.template_ref),q=dl((Be=A.clarification_merge)==null?void 0:Be.output_schema_ref),Q=O=>{const H=O.target.value;if(!H){x("task_ref","");return}const V=n.find(ne=>ne.template_id===H);V&&x("task_ref",lg(V))},ie=O=>{const H=O.target.value;if(!H){_("ROLE_PROMPT");return}const V=s.find(ne=>ne.fragment_id===`role:${H}`||ne.id===H);V&&g("ROLE_PROMPT",$i(V))},oe=O=>{const H=O.target.value;if(!H){_("TASK_PROMPT");return}const V=o.find(ne=>ne.fragment_id===`task:${H}`||ne.id===H);V&&g("TASK_PROMPT",$i(V))},J=O=>{const H=O.target.value;if(!H){_("OUTPUT_SCHEMA");return}const V=i.find(ne=>ne.schema_id===H);V&&g("OUTPUT_SCHEMA",ul(V))},je=O=>{const H=O.target.value;if(!H){_("PGC_CONTEXT");return}const V=l.find(ne=>ne.fragment_id===`pgc:${H}`||ne.id===H);V&&g("PGC_CONTEXT",$i(V))},ge=O=>{const H=O.target.value,V=xS.find(ct=>ct.value===H),ne=(V==null?void 0:V.produces)||`pgc_clarifications.${H}`,Le={...u,gate_kind:H,produces:ne};f(Le),t(Le)},we=O=>{const H=O.target.value;if(!H){b("template_ref","");return}const V=n.find(ne=>ne.template_id===H);V&&b("template_ref",lg(V))},xe=O=>{const H=O.target.value;if(!H){w("ROLE_PROMPT","");return}const V=s.find(ne=>ne.fragment_id===`role:${H}`||ne.id===H);V&&w("ROLE_PROMPT",$i(V))},se=O=>{const H=O.target.value;if(!H){w("TASK_PROMPT","");return}const V=o.find(ne=>ne.fragment_id===`task:${H}`||ne.id===H);V&&w("TASK_PROMPT",$i(V))},K=O=>{const H=O.target.value;if(!H){w("PGC_CONTEXT","");return}const V=l.find(ne=>ne.fragment_id===`pgc:${H}`||ne.id===H);V&&w("PGC_CONTEXT",$i(V))},re=O=>{const H=O.target.value;if(!H){b("output_schema_ref","");return}const V=i.find(ne=>ne.schema_id===H);V&&b("output_schema_ref",ul(V))},U=O=>{const H=O.target.value;if(!H){k("template_ref","");return}const V=n.find(ne=>ne.template_id===H);V&&k("template_ref",lg(V))},de=O=>{const H=O.target.value;if(!H){k("output_schema_ref","");return}const V=i.find(ne=>ne.schema_id===H);V&&k("output_schema_ref",ul(V))};return a.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:C?"PGC Gate Properties":"Node Properties"}),a.jsx("button",{onClick:()=>r(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Node ID"}),a.jsx("input",{type:"text",value:u.node_id||"",onChange:O=>x("node_id",O.target.value),style:Fe})]}),a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Type"}),a.jsx("select",{value:u.type||"task",onChange:O=>x("type",O.target.value),style:Fe,children:h7.map(O=>a.jsx("option",{value:O.value,children:O.label},O.value))})]}),C&&a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Gate Kind"}),a.jsx("select",{value:u.gate_kind||"discovery",onChange:ge,style:Fe,children:xS.map(O=>a.jsx("option",{value:O.value,children:O.label},O.value))})]}),a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Description"}),a.jsx("textarea",{value:u.description||"",onChange:O=>x("description",O.target.value),rows:2,style:{...Fe,resize:"vertical"}})]}),(C||["task","intake_gate"].includes(u.type))&&a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Produces"}),a.jsx("input",{type:"text",value:u.produces||"",onChange:O=>x("produces",O.target.value),placeholder:C?"pgc_clarifications.discovery":"document_type",style:Fe})]}),C&&a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{style:v7,children:"Gate Internals"}),a.jsx(ug,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:L||"",onChange:we,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(O=>a.jsx("option",{value:O.template_id,children:O.name||O.template_id.replace(/_/g," ")},O.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:z||"",onChange:xe,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(O=>{var V;const H=((V=O.fragment_id)==null?void 0:V.replace("role:",""))||O.id;return a.jsx("option",{value:H,children:O.name||(H==null?void 0:H.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:B||"",onChange:se,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(O=>{var V;const H=((V=O.fragment_id)==null?void 0:V.replace("task:",""))||O.id;return a.jsx("option",{value:H,children:O.name||(H==null?void 0:H.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:X||"",onChange:K,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(O=>{var V;const H=((V=O.fragment_id)==null?void 0:V.replace("pgc:",""))||O.id;return a.jsx("option",{value:H,children:O.name||(H==null?void 0:H.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:G||"",onChange:re,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(O=>a.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]})}),a.jsx("div",{className:"mt-2",children:a.jsx(ug,{title:"Entry: Operator Answers",badge:"UI",children:a.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Renders:"}),a.jsx("span",{className:"font-mono",children:((et=A.operator_entry)==null?void 0:et.renders)||"question_set"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Captures:"}),a.jsx("span",{className:"font-mono",children:((Ae=A.operator_entry)==null?void 0:Ae.captures)||"pgc_answers"})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),a.jsx("div",{className:"mt-2",children:a.jsx(ug,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((Z=A.clarification_merge)==null?void 0:Z.internal_type)||"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),a.jsxs("select",{value:((Ce=A.clarification_merge)==null?void 0:Ce.internal_type)||"LLM",onChange:O=>k("internal_type",O.target.value),style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"LLM",children:"LLM"}),a.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((ve=A.clarification_merge)==null?void 0:ve.internal_type)||"LLM")==="LLM"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:W||"",onChange:U,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(O=>a.jsx("option",{value:O.template_id,children:O.name||O.template_id.replace(/_/g," ")},O.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:q||"",onChange:de,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(O=>a.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]}),((Ct=A.clarification_merge)==null?void 0:Ct.internal_type)==="MECH"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),a.jsxs("select",{value:Bi((yt=A.clarification_merge)==null?void 0:yt.op_ref)||"",onChange:O=>{const H=O.target.value;if(!H){k("op_ref","");return}const V=d.find(ne=>ne.op_id===H);V&&k("op_ref",dg(V))},style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(O=>O.type==="merger").map(O=>a.jsx("option",{value:O.op_id,children:O.name},O.op_id))]})]}),((bt=A.clarification_merge)==null?void 0:bt.op_ref)&&(()=>{const O=Bi(A.clarification_merge.op_ref),H=d.find(V=>V.op_id===O);return H?a.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:q||"",onChange:de,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(O=>a.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Internal Type"}),a.jsx("select",{value:u.internal_type||"LLM",onChange:O=>x("internal_type",O.target.value),style:Fe,children:vS.map(O=>a.jsx("option",{value:O.value,children:O.label},O.value))}),a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Qt=vS.find(O=>O.value===(u.internal_type||"LLM")))==null?void 0:Qt.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Interaction Template"}),a.jsxs("select",{value:T||"",onChange:Q,style:Fe,children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(O=>a.jsx("option",{value:O.template_id,children:O.name||O.template_id.replace(/_/g," ")},O.template_id))]}),u.task_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Mechanical Operation"}),a.jsxs("select",{value:Bi(u.op_ref)||"",onChange:O=>{const H=O.target.value;if(!H){x("op_ref","");return}const V=d.find(ne=>ne.op_id===H);V&&x("op_ref",dg(V))},style:Fe,children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(O=>{const H=d.filter(V=>V.type===O.type_id);return H.length===0?null:a.jsx("optgroup",{label:O.name,children:H.map(V=>a.jsx("option",{value:V.op_id,children:V.name},V.op_id))},O.type_id)})]}),u.op_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const O=Bi(u.op_ref),H=d.find(ne=>ne.op_id===O),V=H?c.find(ne=>ne.type_id===H.type):null;return H?a.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(V==null?void 0:V.name)||H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Output Schema"}),a.jsxs("select",{value:dl(u.output_schema_ref)||"",onChange:O=>{const H=O.target.value;if(!H){x("output_schema_ref","");return}const V=i.find(ne=>ne.schema_id===H);V&&x("output_schema_ref",ul(V))},style:Fe,children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(O=>a.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Entry Operation"}),a.jsxs("select",{value:Bi(u.op_ref)||"",onChange:O=>{const H=O.target.value;if(!H){x("op_ref","");return}const V=d.find(ne=>ne.op_id===H);V&&x("op_ref",dg(V))},style:Fe,children:[a.jsx("option",{value:"",children:"-- Select Entry Operation --"}),d.filter(O=>O.type==="entry").map(O=>a.jsx("option",{value:O.op_id,children:O.name},O.op_id))]}),u.op_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const O=Bi(u.op_ref),H=d.find(ne=>ne.op_id===O);if(!H)return null;const V=H.config||{};return a.jsxs("div",{className:"p-2 rounded text-xs space-y-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-orange, #f97316)",color:"#fff"},children:"Entry"}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description}),a.jsxs("div",{className:"pt-2 border-t space-y-1",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Renders:"}),a.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:V.renders||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Captures:"}),a.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:V.captures||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Layout:"}),a.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:V.layout||"form"})]})]}),V.entry_prompt&&a.jsxs("div",{className:"p-2 rounded mt-2",style:{background:"var(--bg-panel)"},children:[a.jsx("div",{className:"text-[10px] uppercase mb-1",style:{color:"var(--text-muted)"},children:"Entry Prompt"}),a.jsx("div",{style:{color:"var(--text-primary)"},children:V.entry_prompt})]})]})})(),!u.op_ref&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Select an Entry operation above, or define custom renders/captures below."}),a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Renders"}),a.jsx("input",{type:"text",value:u.renders||"",onChange:O=>x("renders",O.target.value),placeholder:"e.g., question_set",style:Fe})]}),a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Captures"}),a.jsx("input",{type:"text",value:u.captures||"",onChange:O=>x("captures",O.target.value),placeholder:"e.g., user_answers",style:Fe})]})]})]}),u.type==="qa"&&a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"QA Mode"}),a.jsx("select",{value:u.qa_mode||"semantic",onChange:O=>x("qa_mode",O.target.value),style:Fe,children:m7.map(O=>a.jsx("option",{value:O,children:O},O))})]}),u.type==="end"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Terminal Outcome"}),a.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:O=>x("terminal_outcome",O.target.value),style:Fe,children:g7.map(O=>a.jsx("option",{value:O,children:O},O))})]}),a.jsxs("div",{children:[a.jsx("label",{style:wt,children:"Gate Outcome"}),a.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:O=>x("gate_outcome",O.target.value),placeholder:"e.g., complete, failed",style:Fe})]})]}),a.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:O=>x("requires_qa",O.target.checked)}),"Requires QA"]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:O=>x("non_advancing",O.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("label",{style:wt,children:"Includes"})}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:N||"",onChange:ie,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(O=>{var V;const H=((V=O.fragment_id)==null?void 0:V.replace("role:",""))||O.id;return a.jsx("option",{value:H,children:O.name||(H==null?void 0:H.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:D||"",onChange:oe,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(O=>{var V;const H=((V=O.fragment_id)==null?void 0:V.replace("task:",""))||O.id;return a.jsx("option",{value:H,children:O.name||(H==null?void 0:H.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:I||"",onChange:J,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(O=>a.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:F||"",onChange:je,style:{...Fe,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(O=>{var V;const H=((V=O.fragment_id)==null?void 0:V.replace("pgc:",""))||O.id;return a.jsx("option",{value:H,children:O.name||(H==null?void 0:H.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),P.length>0&&a.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),a.jsx("div",{className:"space-y-2",children:P.map(([O,H])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:O,onChange:V=>{const ne={...u.includes};delete ne[O],ne[V.target.value]=H;const Le={...u,includes:ne};f(Le),t(Le)},style:{...Fe,width:"35%",fontSize:10},placeholder:"KEY"}),a.jsx("input",{type:"text",value:H,onChange:V=>g(O,V.target.value),style:{...Fe,flex:1,fontSize:10},placeholder:"path/to/file"}),a.jsx("button",{onClick:()=>_(O),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},O))})]}),a.jsx("button",{onClick:v,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const y7=["auto","user_choice"],b7=["eq","ne","lt","lte","gt","gte"],Zr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},si={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function _7({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[i,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(u,f)=>{const p={...i,[u]:f};s(p),r(p)},l=()=>{const u=[...i.conditions||[],{type:"retry_count",operator:"lt",value:2}];o("conditions",u)},c=(u,f,p)=>{const h=[...i.conditions||[]];h[u]={...h[u],[f]:p},o("conditions",h)},d=u=>{const f=(i.conditions||[]).filter((p,h)=>h!==u);o("conditions",f)};return i?a.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),a.jsx("button",{onClick:()=>n(i.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Edge ID"}),a.jsx("input",{type:"text",value:i.edge_id||"",onChange:u=>o("edge_id",u.target.value),style:Zr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"From Node"}),a.jsx("select",{value:i.from_node_id||"",onChange:u=>o("from_node_id",u.target.value),style:Zr,children:t.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"To Node"}),a.jsxs("select",{value:i.to_node_id||"",onChange:u=>o("to_node_id",u.target.value||null),style:Zr,children:[a.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>a.jsx("option",{value:u,children:u},u))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Outcome"}),a.jsx("input",{type:"text",value:i.outcome||"",onChange:u=>o("outcome",u.target.value),placeholder:"success, failed, etc.",style:Zr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Label"}),a.jsx("input",{type:"text",value:i.label||"",onChange:u=>o("label",u.target.value),placeholder:"Human-readable label",style:Zr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Kind"}),a.jsx("select",{value:i.kind||"auto",onChange:u=>o("kind",u.target.value),style:Zr,children:y7.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:i.non_advancing||!1,onChange:u=>o("non_advancing",u.target.checked)}),"Non-advancing"]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:si,children:"Conditions"}),a.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),a.jsx("div",{className:"space-y-2",children:(i.conditions||[]).map((u,f)=>a.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Zr,flex:1,fontSize:10}}),a.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Zr,width:"auto",fontSize:10},children:b7.map(p=>a.jsx("option",{value:p,children:p},p))}),a.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Zr,width:50,fontSize:10}}),a.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const w7={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function j7({workspaceId:e,artifactId:t,onArtifactSave:r,mechanicalOpTypes:n=[],mechanicalOps:i=[]}){var X,G,W;const[s,o]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,x]=m.useState(null),{workflowJson:g,loading:_,error:v,saving:y,lastSaveResult:b,updateWorkflow:w}=IT(e,t,{onSave:q=>{r==null||r(t,q)}}),{templates:k}=ET(),{schemas:S}=TT(),{fragmentsByKind:C}=RT(),T=m.useMemo(()=>{var q;return!l||!g?null:((q=g.nodes)==null?void 0:q.find(Q=>Q.node_id===l))||null},[l,g]),j=m.useMemo(()=>{var q;return!d||!g?null:((q=g.edges)==null?void 0:q.find(Q=>Q.edge_id===d))||null},[d,g]),R=m.useMemo(()=>g!=null&&g.nodes?g.nodes.map(q=>q.node_id):[],[g]),E=m.useCallback(q=>{w(q)},[w]),M=m.useCallback(q=>{if(!g)return;const Q=g.nodes.map(J=>J.node_id===l?q:J);let ie=g.edges,oe=g.entry_node_ids||[];q.node_id!==l&&(ie=g.edges.map(J=>({...J,from_node_id:J.from_node_id===l?q.node_id:J.from_node_id,to_node_id:J.to_node_id===l?q.node_id:J.to_node_id})),oe=oe.map(J=>J===l?q.node_id:J),c(q.node_id)),w({...g,nodes:Q,edges:ie,entry_node_ids:oe})},[g,l,w]),$=m.useCallback(q=>{if(!g)return;const Q=g.edges.map(ie=>ie.edge_id===d?q:ie);q.edge_id!==d&&u(q.edge_id),w({...g,edges:Q})},[g,d,w]),N=m.useCallback(q=>{g&&(w({...g,nodes:g.nodes.filter(Q=>Q.node_id!==q),edges:g.edges.filter(Q=>Q.from_node_id!==q&&Q.to_node_id!==q),entry_node_ids:(g.entry_node_ids||[]).filter(Q=>Q!==q)}),c(null))},[g,w]),D=m.useCallback(q=>{g&&(w({...g,edges:g.edges.filter(Q=>Q.edge_id!==q)}),u(null))},[g,w]),I=m.useCallback(q=>{c(q),q&&u(null)},[]),F=m.useCallback(q=>{u(q),q&&c(null)},[]),P=m.useCallback(q=>{q==="json"&&g&&(p(JSON.stringify(g,null,2)),x(null)),o(q)},[g]),A=m.useCallback(q=>{const Q=q.target.value;p(Q);try{const ie=JSON.parse(Q);x(null),w(ie)}catch(ie){x(ie.message)}},[w]),L=((X=b==null?void 0:b.tier1_report)==null?void 0:X.results)||[],z=L.filter(q=>q.severity==="error").length,B=L.filter(q=>q.severity==="warning").length;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[y&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),v&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:v}),!y&&!v&&g&&a.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((G=g.nodes)==null?void 0:G.length)||0," nodes, ",((W=g.edges)==null?void 0:W.length)||0," edges"]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(q=>a.jsx("button",{onClick:()=>P(q.id),style:{...w7,color:s===q.id?"var(--text-primary)":"var(--text-muted)",borderBottom:s===q.id?"2px solid var(--action-primary)":"2px solid transparent"},children:q.label},q.id))}),_?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s==="canvas"&&a.jsxs(a.Fragment,{children:[a.jsx(Zc,{children:a.jsx(p7,{workflowJson:g,onWorkflowChange:E,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:I,onEdgeSelect:F})}),T&&a.jsx(x7,{node:T,onChange:M,onDelete:N,templates:k,schemas:S,roleFragments:C.role||[],taskFragments:C.task||[],pgcFragments:C.pgc||[],mechanicalOpTypes:n,mechanicalOps:i}),j&&a.jsx(_7,{edge:j,nodeIds:R,onChange:$,onDelete:D})]}),s==="json"&&a.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[a.jsx("textarea",{value:f,onChange:A,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),s==="metadata"&&a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:g?a.jsx(S7,{workflow:g}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),L.length>0&&a.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[z>0&&a.jsxs("span",{style:{color:"#ef4444"},children:[z," error",z!==1?"s":""]}),B>0&&a.jsxs("span",{style:{color:"#f59e0b"},children:[B," warning",B!==1?"s":""]}),z===0&&B===0&&a.jsx("span",{style:{color:"#10b981"},children:"Valid"}),a.jsx("span",{style:{color:"var(--text-muted)"},children:L.map(q=>q.message).join(" | ")})]})]})}function S7({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],i=e.thread_ownership||{},s=Object.entries(i),o=e.entry_node_ids||[];return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l.label}),a.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),a.jsxs("div",{children:[a.jsx("label",{style:r,children:"Entry Node IDs"}),a.jsx("div",{style:t,children:o.length>0?o.join(", "):"-"})]}),s.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),s.map(([l,c])=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l}),a.jsx("div",{style:t,children:c})]},l))]})]})}function fg({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:i}){const[s,o]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!s)return;const c=d=>{l.current&&!l.current.contains(d.target)&&o(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),t.length===0?null:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:i?"var(--text-primary)":"var(--text-muted)",background:i?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:i?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,a.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),s&&a.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>a.jsxs("button",{onClick:()=>{n(c.id),o(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&a.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function pg({label:e,isSelected:t,onClick:r}){return a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function k7({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:i=[],onArtifactSave:s,onCreateDcwWorkflow:o,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var Be,et,Ae;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,x]=m.useState("source"),[g,_]=m.useState(null),[v,y]=m.useState(!1),[b,w]=m.useState(null),[k,S]=m.useState(null),[C,T]=m.useState(!1),[j,R]=m.useState(null),[E,M]=m.useState(null),[$,N]=m.useState(!1),[D,I]=m.useState(null),[F,P]=m.useState(null),[A,L]=m.useState(!1),[z,B]=m.useState(null),X=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const Z=t.role_prompt_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="role"?null:{roleId:Z[2],version:Z[3]}},[t==null?void 0:t.role_prompt_ref]),G=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const Z=t.template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.template_ref]),W=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const Z=t.qa_template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.qa_template_ref]),q=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const Z=t.pgc_template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!X){_(null);return}y(!0),w(null),_e.getRole(X.roleId,X.version).then(Z=>{_(Z.content)}).catch(Z=>{console.error("Failed to load role:",Z),w(Z.message)}).finally(()=>{y(!1)})},[X]),m.useEffect(()=>{if(!G){S(null);return}T(!0),R(null),_e.getTemplate(G.templateId,G.version).then(Z=>{S(Z.content)}).catch(Z=>{console.error("Failed to load template:",Z),R(Z.message)}).finally(()=>{T(!1)})},[G]),m.useEffect(()=>{if(!W){M(null);return}N(!0),I(null),_e.getTemplate(W.templateId,W.version).then(Z=>{M(Z.content)}).catch(Z=>{console.error("Failed to load QA template:",Z),I(Z.message)}).finally(()=>{N(!1)})},[W]),m.useEffect(()=>{if(!q){P(null);return}L(!0),B(null),_e.getTemplate(q.templateId,q.version).then(Z=>{P(Z.content)}).catch(Z=>{console.error("Failed to load PGC template:",Z),B(Z.message)}).finally(()=>{L(!1)})},[q]);const Q=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const Z=t.version||t.active_version;return`doctype:${t.doc_type_id}:${Z}:${f}`},[t,f]),{content:ie,loading:oe,error:J,saving:je,isDirty:ge,updateContent:we,lastSaveResult:xe}=ka(e,Q,{onSave:Z=>{s==null||s(Q,Z)}}),se=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],K=m.useMemo(()=>t?se.filter(Z=>Z.id==="package"?!0:Z.id==="role_prompt"?!!t.role_prompt_ref:Z.id==="template"?!!t.template_ref:Z.id==="qa_template"?!!t.qa_template_ref:Z.id==="pgc_template"?!!t.pgc_template_ref:Z.id==="workflow"?!0:t.artifacts?t.artifacts[Z.id]!=null:!1):[],[t]),re=c==="task"||c==="schema";m.useEffect(()=>{re||K.length>0&&!K.find(Z=>Z.id===f)&&p(K[0].id)},[K,f,re]);const U=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",de=f==="package",fe=f==="schema",me=f==="workflow",ye=!U&&!de&&!fe&&!me,ee=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:i.some(Z=>Z.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,i]),[he,De]=m.useState(!1),nt=async()=>{if(!(!(t!=null&&t.doc_type_id)||!o)){De(!0);try{await o(t.doc_type_id)}finally{De(!1)}}};if(!t&&!r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),a.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),a.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const Re=c==="task"?"Interaction":c==="schema"?"Schema":null,Me=!re&&(f==="task_prompt"||f==="schema");return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),a.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:re?Re:a.jsxs(a.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),re&&a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!re&&a.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[K.find(Z=>Z.id==="package")&&a.jsx(pg,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),x("source")}}),K.find(Z=>Z.id==="workflow")&&a.jsx(pg,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),x("source")}}),(()=>{const Z=["role_prompt","task_prompt","template"],Ce=K.filter(ve=>Z.includes(ve.id)).map(ve=>({id:ve.id,label:ve.id==="role_prompt"?"Role":ve.id==="task_prompt"?"Task":"Template",viewOnly:ve.viewOnly}));return Ce.length===0?null:a.jsx(fg,{label:"Generation",items:Ce,selectedId:Z.includes(f)?f:null,onSelect:ve=>{p(ve),x("source")},isGroupActive:Z.includes(f)})})(),(()=>{const Z=["qa_prompt","qa_template"],Ce=K.filter(ve=>Z.includes(ve.id)).map(ve=>({id:ve.id,label:ve.id==="qa_prompt"?"Prompt":"Template",viewOnly:ve.viewOnly}));return Ce.length===0?null:a.jsx(fg,{label:"QA",items:Ce,selectedId:Z.includes(f)?f:null,onSelect:ve=>{p(ve),x("source")},isGroupActive:Z.includes(f)})})(),(()=>{const Z=["pgc_context","pgc_template"],Ce=K.filter(ve=>Z.includes(ve.id)).map(ve=>({id:ve.id,label:ve.id==="pgc_context"?"Context":"Template",viewOnly:ve.viewOnly}));return Ce.length===0?null:a.jsx(fg,{label:"PGC",items:Ce,selectedId:Z.includes(f)?f:null,onSelect:ve=>{p(ve),x("source")},isGroupActive:Z.includes(f)})})(),K.find(Z=>Z.id==="schema")&&a.jsx(pg,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),x("source")}})]}),!re&&ye&&!Me&&a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>x("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),a.jsx("button",{onClick:()=>x("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((Be=t==null?void 0:t.artifacts)==null?void 0:Be[f])&&a.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),U&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&X&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[X.roleId.replace(/_/g," ")," v",X.version]}),f==="template"&&G&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[G.templateId.replace(/_/g," ")," v",G.version]}),f==="qa_template"&&W&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[W.templateId.replace(/_/g," ")," v",W.version]}),f==="pgc_template"&&q&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[q.templateId.replace(/_/g," ")," v",q.version]})]}),Me&&a.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),fe&&((et=t==null?void 0:t.artifacts)==null?void 0:et.schema)&&a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:me?ee?a.jsx(j7,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s,mechanicalOpTypes:d,mechanicalOps:u}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 max-w-md",children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),a.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),o&&a.jsx("button",{onClick:nt,disabled:he,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:he?"wait":"pointer",opacity:he?.7:1},children:he?"Creating...":"Create Workflow"})]})}):f==="package"?a.jsx(n7,{workspaceId:e,docType:t,roles:n,onSave:s}):f==="role_prompt"?a.jsx(tn,{content:g||"",onChange:()=>{},loading:v,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?a.jsx(tn,{content:k||"",onChange:()=>{},loading:C,saving:!1,isDirty:!1,error:j,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?a.jsx(tn,{content:E||"",onChange:()=>{},loading:$,saving:!1,isDirty:!1,error:D,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?a.jsx(tn,{content:F||"",onChange:()=>{},loading:A,saving:!1,isDirty:!1,error:z,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||fe?a.jsx(tn,{content:ie,onChange:Me?()=>{}:we,loading:oe,saving:Me?!1:je,isDirty:Me?!1:ge,error:J,readOnly:Me,placeholder:`Enter ${((Ae=K.find(Z=>Z.id===f))==null?void 0:Ae.label)||"prompt"} content...`,isJson:fe}):a.jsx(r7,{workspaceId:e,artifactId:Q})}),ye&&(xe==null?void 0:xe.tier1)&&!xe.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function N7({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:i,loading:s,error:o,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=ka(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),a.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),a.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tn,{content:i,onChange:d,loading:s,saving:l,isDirty:c,error:o,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const C7=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],hg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},mg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function E7({workspaceId:e,template:t,onArtifactSave:r}){const[n,i]=m.useState("metadata"),[s,o]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:x,error:g,saving:_,isDirty:v,updateContent:y,lastSaveResult:b}=ka(e,f,{onSave:j=>{r==null||r(f,j)}});m.useEffect(()=>{t&&(o({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const w=m.useCallback((j,R)=>{o(E=>({...E,[j]:R})),c(!0)},[]),k=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const j=Cy.dump({name:s.name||null,purpose:s.purpose||null,use_case:s.use_case||null},{lineWidth:-1});await _e.writeArtifact(e,p,j),c(!1),r==null||r(p,{success:!0})}catch(j){console.error("Failed to save metadata:",j),alert(`Failed to save metadata: ${j.message}`)}finally{u(!1)}}},[e,p,s,r]),S=m.useCallback(()=>{l&&k()},[l,k]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),a.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const C=s.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase()),T=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:C}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.active_version]}),a.jsx("span",{children:""}),a.jsx("span",{children:"Shared Template"}),s.purpose&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:s.purpose})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:T.map(j=>a.jsxs("button",{onClick:()=>i(j.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===j.id?"var(--text-primary)":"var(--text-muted)",background:n===j.id?"var(--bg-canvas)":"transparent",borderBottom:n===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[j.label,j.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),j.id==="template"&&v&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},j.id))}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:mg,children:"Template Name"}),a.jsx("input",{type:"text",value:s.name,onChange:j=>w("name",j.target.value),onBlur:S,placeholder:"e.g., Document Generator",style:hg}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),a.jsxs("div",{children:[a.jsx("label",{style:mg,children:"Template Purpose"}),a.jsx("select",{value:s.purpose,onChange:j=>{w("purpose",j.target.value),setTimeout(()=>k(),0)},style:hg,children:C7.map(j=>a.jsx("option",{value:j.value,children:j.label},j.value))}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),a.jsxs("div",{children:[a.jsx("label",{style:mg,children:"Use Case"}),a.jsx("textarea",{value:s.use_case,onChange:j=>w("use_case",j.target.value),onBlur:S,placeholder:"Describe when and how this template should be used...",rows:4,style:{...hg,resize:"vertical"}}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tn,{content:h,onChange:y,loading:x,saving:_,isDirty:v,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function T7({workspaceId:e,schema:t,onArtifactSave:r}){var v;const[n,i]=m.useState("content"),s=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:o,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=ka(e,s,{onSave:y=>{r==null||r(s,y)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),a.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((v=t.schema_id)==null?void 0:v.replace(/_/g," "))||"Schema",x=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],_=!e;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",x]}),_&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(y=>a.jsxs("button",{onClick:()=>i(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===y.id?"var(--text-primary)":"var(--text-muted)",background:n===y.id?"var(--bg-canvas)":"transparent",borderBottom:n===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tn,{content:o,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:_,isJson:!0})}),n==="info"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Schema ID"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Version"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Title (from JSON)"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),a.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"File Path"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",x,"/schema.json"]})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Artifact ID"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",x]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const R7={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},A7={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},gg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},so={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function I7({workspaceId:e,fragment:t,onArtifactSave:r}){var L;const[n,i]=m.useState("content"),[s,o]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,x]=((L=t==null?void 0:t.fragment_id)==null?void 0:L.split(":"))||[null,null],g=t?h==="role"?`fragment:role:${x}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,_=t&&h==="role"?`fragment:role:${x}:${t.version}:meta`:null,{content:v,loading:y,error:b,saving:w,isDirty:k,updateContent:S,lastSaveResult:C}=ka(e,g,{onSave:z=>{r==null||r(g,z)}});m.useEffect(()=>{t&&(o({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const T=m.useCallback((z,B)=>{o(X=>({...X,[z]:B})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!_)){u(!0);try{const z=Cy.dump({name:s.name||null,intent:s.intent||null,tags:s.tags.length>0?s.tags:null},{lineWidth:-1});await _e.writeArtifact(e,_,z),c(!1),r==null||r(_,{success:!0})}catch(z){console.error("Failed to save metadata:",z),alert(`Failed to save metadata: ${z.message}`)}finally{u(!1)}}},[e,_,s,r]),R=m.useCallback(()=>{l&&_&&j()},[l,_,j]),E=m.useCallback(()=>{const z=f.trim().toLowerCase();z&&!s.tags.includes(z)&&(T("tags",[...s.tags,z]),p(""))},[f,s.tags,T]),M=m.useCallback(z=>{T("tags",s.tags.filter(B=>B!==z))},[s.tags,T]),$=m.useCallback(z=>{z.key==="Enter"&&(z.preventDefault(),E())},[E]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),a.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const N=s.name||t.name||t.fragment_id,D=R7[h]||h,I=A7[h]||"var(--text-muted)",F=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],P=!e,A=_&&!P;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[N,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:I,color:"#fff"},children:D})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsxs("span",{children:["from ",t.source_doc_type]})]}),P&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:F.map(z=>a.jsxs("button",{onClick:()=>i(z.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===z.id?"var(--text-primary)":"var(--text-muted)",background:n===z.id?"var(--bg-canvas)":"transparent",borderBottom:n===z.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[z.label,z.id==="content"&&k&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),z.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},z.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(tn,{content:v,onChange:S,loading:y,saving:w,isDirty:k,error:b,placeholder:"Enter prompt content...",readOnly:P})}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Kind"}),a.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:I}}),a.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:D})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Name"}),a.jsx("input",{type:"text",value:s.name,onChange:z=>T("name",z.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:gg,disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Intent"}),a.jsx("textarea",{value:s.intent,onChange:z=>T("intent",z.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...gg,resize:"vertical"},disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:s.tags.map(z=>a.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[z,A&&a.jsx("button",{onClick:()=>M(z),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},z))}),A&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:f,onChange:z=>p(z.target.value),onKeyDown:$,placeholder:"Add tag...",style:{...gg,flex:1}}),a.jsx("button",{onClick:E,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Source"}),a.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",a.jsx("strong",{children:t.source_doc_type})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!A&&!t.source_doc_type&&a.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(C==null?void 0:C.tier1)&&!C.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const oo={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ao={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function M7({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[r,n]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){n(null),s(null);return}(async()=>{l(!0),d(null);try{const g=await _e.getMechanicalOp(e.op_id);n(g);const _=t.find(v=>v.type_id===g.type);if(_)s(_);else try{const v=await _e.getMechanicalOpType(g.type);s(v)}catch{}}catch(g){console.error("Failed to load mechanical op details:",g),d(g.message),n(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),a.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=r||e;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(i==null?void 0:i.name)||u.type}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o&&a.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&a.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!o&&a.jsxs("div",{className:"space-y-6 max-w-2xl",children:[a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Operation ID"}),a.jsx("div",{style:oo,className:"font-mono",children:u.op_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Name"}),a.jsx("div",{style:oo,children:u.name})]}),u.description&&a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Description"}),a.jsx("div",{style:{...oo,whiteSpace:"pre-wrap"},children:u.description})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Type"}),a.jsx("div",{style:oo,children:u.type})]}),a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Version"}),a.jsx("div",{style:oo,children:u.active_version||u.version})]})]})]})]}),i&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),a.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("span",{style:{fontSize:16},children:[i.icon==="git-merge"&&"",i.icon==="scissors"&&"",i.icon==="check-circle"&&"",i.icon==="shuffle"&&"",i.icon==="git-branch"&&""]}),a.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:i.name}),a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:i.category})]}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:i.description}),a.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=i.inputs)==null?void 0:f.length)>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),i.inputs.map((x,g)=>a.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[x.name,": ",x.type]},g))]}),((p=i.outputs)==null?void 0:p.length)>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),i.outputs.map((x,g)=>a.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[x.name,": ",x.type]},g))]})]})]})]}),u.config&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),a.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),a.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),a.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),a.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),a.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(x=>a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:x},x))})]})]})]}),a.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[a.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",a.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function P7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(i=>i(n))},t)}const yu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Fs(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ey(e){return"nodeType"in e}function Xt(e){var t,r;return e?Fs(e)?e:Ey(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Ty(e){const{Document:t}=Xt(e);return e instanceof t}function Na(e){return Fs(e)?!1:e instanceof Xt(e).HTMLElement}function MT(e){return e instanceof Xt(e).SVGElement}function zs(e){return e?Fs(e)?e.document:Ey(e)?Ty(e)?e:Na(e)||MT(e)?e.ownerDocument:document:document:document}const Gr=yu?m.useLayoutEffect:m.useEffect;function Ry(e){const t=m.useRef(e);return Gr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function O7(){const e=m.useRef(null),t=m.useCallback((n,i)=>{e.current=setInterval(n,i)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function ca(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Gr(()=>{r.current!==e&&(r.current=e)},t),r}function Ca(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function wc(e){const t=Ry(e),r=m.useRef(null),n=m.useCallback(i=>{i!==r.current&&(t==null||t(i,r.current)),r.current=i},[]);return[r,n]}function Fv(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let vg={};function Ea(e,t){return m.useMemo(()=>{if(t)return t;const r=vg[e]==null?0:vg[e]+1;return vg[e]=r,e+"-"+r},[e,t])}function PT(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((s,o)=>{const l=Object.entries(o);for(const[c,d]of l){const u=s[c];u!=null&&(s[c]=u+e*d)}return s},{...t})}}const ms=PT(1),ua=PT(-1);function D7(e){return"clientX"in e&&"clientY"in e}function Ay(e){if(!e)return!1;const{KeyboardEvent:t}=Xt(e.target);return t&&e instanceof t}function L7(e){if(!e)return!1;const{TouchEvent:t}=Xt(e.target);return t&&e instanceof t}function zv(e){if(L7(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return D7(e)?{x:e.clientX,y:e.clientY}:null}const Es=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Es.Translate.toString(e),Es.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),yS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function F7(e){return e.matches(yS)?e:e.querySelector(yS)}const z7={display:"none"};function $7(e){let{id:t,value:r}=e;return Y.createElement("div",{id:t,style:z7},r)}function q7(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:t,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function B7(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const OT=m.createContext(null);function H7(e){const t=m.useContext(OT);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function W7(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:i,event:s}=n;e.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[e]),t]}const U7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},V7={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function G7(e){let{announcements:t=V7,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=U7}=e;const{announce:s,announcement:o}=B7(),l=Ea("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),H7(m.useMemo(()=>({onDragStart(f){let{active:p}=f;s(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&s(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;s(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;s(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;s(t.onDragCancel({active:p,over:h}))}}),[s,t])),!c)return null;const u=Y.createElement(Y.Fragment,null,Y.createElement($7,{id:n,value:i.draggable}),Y.createElement(q7,{id:l,announcement:o}));return r?rs.createPortal(u,r):u}var dt;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(dt||(dt={}));function jc(){}function Sc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function DT(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Ar=Object.freeze({x:0,y:0});function LT(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function FT(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function K7(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function bS(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function zT(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function _S(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const $T=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=_S(t,t.left,t.top),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const d=LT(_S(c),i);s.push({id:l,data:{droppableContainer:o,value:d}})}}return s.sort(FT)},Y7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=bS(t),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const d=bS(c),u=i.reduce((p,h,x)=>p+LT(d[x],h),0),f=Number((u/4).toFixed(4));s.push({id:l,data:{droppableContainer:o,value:f}})}}return s.sort(FT)};function X7(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),o=i-n,l=s-r;if(n<i&&r<s){const c=t.width*t.height,d=e.width*e.height,u=o*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const Q7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=[];for(const s of n){const{id:o}=s,l=r.get(o);if(l){const c=X7(l,t);c>0&&i.push({id:o,data:{droppableContainer:s,value:c}})}}return i.sort(K7)};function Z7(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function qT(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ar}function J7(e){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...r})}}const eW=J7(1);function tW(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function rW(e,t,r){const n=tW(t);if(!n)return e;const{scaleX:i,scaleY:s,x:o,y:l}=n,c=e.left-o-(1-i)*parseFloat(r),d=e.top-l-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),u=i?e.width/i:e.width,f=s?e.height/s:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const nW={ignoreTransform:!1};function $s(e,t){t===void 0&&(t=nW);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Xt(e).getComputedStyle(e);d&&(r=rW(r,d,u))}const{top:n,left:i,width:s,height:o,bottom:l,right:c}=r;return{top:n,left:i,width:s,height:o,bottom:l,right:c}}function wS(e){return $s(e,{ignoreTransform:!0})}function iW(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function sW(e,t){return t===void 0&&(t=Xt(e).getComputedStyle(e)),t.position==="fixed"}function oW(e,t){t===void 0&&(t=Xt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?r.test(s):!1})}function bu(e,t){const r=[];function n(i){if(t!=null&&r.length>=t||!i)return r;if(Ty(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Na(i)||MT(i)||r.includes(i))return r;const s=Xt(e).getComputedStyle(i);return i!==e&&oW(i,s)&&r.push(i),sW(i,s)?r:n(i.parentNode)}return e?n(e):r}function BT(e){const[t]=bu(e,1);return t??null}function xg(e){return!yu||!e?null:Fs(e)?e:Ey(e)?Ty(e)||e===zs(e).scrollingElement?window:Na(e)?e:null:null}function HT(e){return Fs(e)?e.scrollX:e.scrollLeft}function WT(e){return Fs(e)?e.scrollY:e.scrollTop}function $v(e){return{x:HT(e),y:WT(e)}}var gt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(gt||(gt={}));function UT(e){return!yu||!e?!1:e===document.scrollingElement}function VT(e){const t={x:0,y:0},r=UT(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,o=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:n,minScroll:t}}const aW={x:.2,y:.2};function lW(e,t,r,n,i){let{top:s,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=aW);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=VT(e),h={x:0,y:0},x={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!d&&s<=t.top+g.height?(h.y=gt.Backward,x.y=n*Math.abs((t.top+g.height-s)/g.height)):!u&&c>=t.bottom-g.height&&(h.y=gt.Forward,x.y=n*Math.abs((t.bottom-g.height-c)/g.height)),!p&&l>=t.right-g.width?(h.x=gt.Forward,x.x=n*Math.abs((t.right-g.width-l)/g.width)):!f&&o<=t.left+g.width&&(h.x=gt.Backward,x.x=n*Math.abs((t.left+g.width-o)/g.width)),{direction:h,speed:x}}function cW(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function GT(e){return e.reduce((t,r)=>ms(t,$v(r)),Ar)}function uW(e){return e.reduce((t,r)=>t+HT(r),0)}function dW(e){return e.reduce((t,r)=>t+WT(r),0)}function fW(e,t){if(t===void 0&&(t=$s),!e)return;const{top:r,left:n,bottom:i,right:s}=t(e);BT(e)&&(i<=0||s<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const pW=[["x",["left","right"],uW],["y",["top","bottom"],dW]];class Iy{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=bu(r),i=GT(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,o,l]of pW)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(n),u=i[s]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ao{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var i;(i=this.target)==null||i.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function hW(e){const{EventTarget:t}=Xt(e);return e instanceof t?e:zs(e)}function yg(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var cr;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(cr||(cr={}));function jS(e){e.preventDefault()}function mW(e){e.stopPropagation()}var Ie;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ie||(Ie={}));const KT={start:[Ie.Space,Ie.Enter],cancel:[Ie.Esc],end:[Ie.Space,Ie.Enter,Ie.Tab]},gW=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Ie.Right:return{...r,x:r.x+25};case Ie.Left:return{...r,x:r.x-25};case Ie.Down:return{...r,y:r.y+25};case Ie.Up:return{...r,y:r.y-25}}};class _u{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Ao(zs(r)),this.windowListeners=new Ao(Xt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(cr.Resize,this.handleCancel),this.windowListeners.add(cr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(cr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&fW(n),r(Ar)}handleKeyDown(t){if(Ay(t)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:s=KT,coordinateGetter:o=gW,scrollBehavior:l="smooth"}=i,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=n.current,u=d?{x:d.left,y:d.top}:Ar;this.referenceCoordinates||(this.referenceCoordinates=u);const f=o(t,{active:r,context:n.current,currentCoordinates:u});if(f){const p=ua(f,u),h={x:0,y:0},{scrollableAncestors:x}=n.current;for(const g of x){const _=t.code,{isTop:v,isRight:y,isLeft:b,isBottom:w,maxScroll:k,minScroll:S}=VT(g),C=cW(g),T={x:Math.min(_===Ie.Right?C.right-C.width/2:C.right,Math.max(_===Ie.Right?C.left:C.left+C.width/2,f.x)),y:Math.min(_===Ie.Down?C.bottom-C.height/2:C.bottom,Math.max(_===Ie.Down?C.top:C.top+C.height/2,f.y))},j=_===Ie.Right&&!y||_===Ie.Left&&!b,R=_===Ie.Down&&!w||_===Ie.Up&&!v;if(j&&T.x!==f.x){const E=g.scrollLeft+p.x,M=_===Ie.Right&&E<=k.x||_===Ie.Left&&E>=S.x;if(M&&!p.y){g.scrollTo({left:E,behavior:l});return}M?h.x=g.scrollLeft-E:h.x=_===Ie.Right?g.scrollLeft-k.x:g.scrollLeft-S.x,h.x&&g.scrollBy({left:-h.x,behavior:l});break}else if(R&&T.y!==f.y){const E=g.scrollTop+p.y,M=_===Ie.Down&&E<=k.y||_===Ie.Up&&E>=S.y;if(M&&!p.x){g.scrollTo({top:E,behavior:l});return}M?h.y=g.scrollTop-E:h.y=_===Ie.Down?g.scrollTop-k.y:g.scrollTop-S.y,h.y&&g.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,ms(ua(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}_u.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=KT,onActivation:i}=t,{active:s}=r;const{code:o}=e.nativeEvent;if(n.start.includes(o)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function SS(e){return!!(e&&"distance"in e)}function kS(e){return!!(e&&"delay"in e)}class My{constructor(t,r,n){var i;n===void 0&&(n=hW(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:s}=t,{target:o}=s;this.props=t,this.events=r,this.document=zs(o),this.documentListeners=new Ao(this.document),this.listeners=new Ao(n),this.windowListeners=new Ao(Xt(o)),this.initialCoordinates=(i=zv(s))!=null?i:Ar,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(cr.Resize,this.handleCancel),this.windowListeners.add(cr.DragStart,jS),this.windowListeners.add(cr.VisibilityChange,this.handleCancel),this.windowListeners.add(cr.ContextMenu,jS),this.documentListeners.add(cr.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(kS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(SS(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:i}=this.props;i(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(cr.Click,mW,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(cr.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const c=(r=zv(t))!=null?r:Ar,d=ua(i,c);if(!n&&l){if(SS(l)){if(l.tolerance!=null&&yg(d,l.tolerance))return this.handleCancel();if(yg(d,l.distance))return this.handleStart()}if(kS(l)&&yg(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Ie.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const vW={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class wu extends My{constructor(t){const{event:r}=t,n=zs(r.target);super(t,vW,n)}}wu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const xW={move:{name:"mousemove"},end:{name:"mouseup"}};var qv;(function(e){e[e.RightClick=2]="RightClick"})(qv||(qv={}));class yW extends My{constructor(t){super(t,xW,zs(t.event.target))}}yW.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===qv.RightClick?!1:(n==null||n({event:r}),!0)}}];const bg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class bW extends My{constructor(t){super(t,bg)}static setup(){return window.addEventListener(bg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(bg.move.name,t)};function t(){}}}bW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];var Io;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Io||(Io={}));var kc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(kc||(kc={}));function _W(e){let{acceleration:t,activator:r=Io.Pointer,canScroll:n,draggingRect:i,enabled:s,interval:o=5,order:l=kc.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=jW({delta:f,disabled:!s}),[x,g]=O7(),_=m.useRef({x:0,y:0}),v=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(r){case Io.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Io.DraggableRect:return i}},[r,i,c]),b=m.useRef(null),w=m.useCallback(()=>{const S=b.current;if(!S)return;const C=_.current.x*v.current.x,T=_.current.y*v.current.y;S.scrollBy(C,T)},[]),k=m.useMemo(()=>l===kc.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!s||!d.length||!y){g();return}for(const S of k){if((n==null?void 0:n(S))===!1)continue;const C=d.indexOf(S),T=u[C];if(!T)continue;const{direction:j,speed:R}=lW(S,T,y,t,p);for(const E of["x","y"])h[E][j[E]]||(R[E]=0,j[E]=0);if(R.x>0||R.y>0){g(),b.current=S,x(w,o),_.current=R,v.current=j;return}}_.current={x:0,y:0},v.current={x:0,y:0},g()},[t,w,n,g,s,o,JSON.stringify(y),JSON.stringify(h),x,d,k,u,JSON.stringify(p)])}const wW={x:{[gt.Backward]:!1,[gt.Forward]:!1},y:{[gt.Backward]:!1,[gt.Forward]:!1}};function jW(e){let{delta:t,disabled:r}=e;const n=Fv(t);return Ca(i=>{if(r||!n||!i)return wW;const s={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[gt.Backward]:i.x[gt.Backward]||s.x===-1,[gt.Forward]:i.x[gt.Forward]||s.x===1},y:{[gt.Backward]:i.y[gt.Backward]||s.y===-1,[gt.Forward]:i.y[gt.Forward]||s.y===1}}},[r,t,n])}function SW(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Ca(i=>{var s;return t==null?null:(s=n??i)!=null?s:null},[n,t])}function kW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:i}=n,s=i.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,n)}));return[...r,...s]},[]),[e,t])}var da;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(da||(da={}));var Bv;(function(e){e.Optimized="optimized"})(Bv||(Bv={}));const NS=new Map;function NW(e,t){let{dragging:r,dependencies:n,config:i}=t;const[s,o]=m.useState(null),{frequency:l,measure:c,strategy:d}=i,u=m.useRef(e),f=_(),p=ca(f),h=m.useCallback(function(v){v===void 0&&(v=[]),!p.current&&o(y=>y===null?v:y.concat(v.filter(b=>!y.includes(b))))},[p]),x=m.useRef(null),g=Ca(v=>{if(f&&!r)return NS;if(!v||v===NS||u.current!==e||s!=null){const y=new Map;for(let b of e){if(!b)continue;if(s&&s.length>0&&!s.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const w=b.node.current,k=w?new Iy(c(w),w):null;b.rect.current=k,k&&y.set(b.id,k)}return y}return v},[e,s,r,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),m.useEffect(()=>{f||typeof l!="number"||x.current!==null||(x.current=setTimeout(()=>{h(),x.current=null},l))},[l,f,h,...n]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:s!=null};function _(){switch(d){case da.Always:return!1;case da.BeforeDragging:return r;default:return!r}}}function YT(e,t){return Ca(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function CW(e,t){return YT(e,t)}function EW(e){let{callback:t,disabled:r}=e;const n=Ry(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(n)},[n,r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function ju(e){let{callback:t,disabled:r}=e;const n=Ry(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(n)},[r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function TW(e){return new Iy($s(e),e)}function CS(e,t,r){t===void 0&&(t=TW);const[n,i]=m.useState(null);function s(){i(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??r)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const o=EW({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=ju({callback:s});return Gr(()=>{s(),e?(l==null||l.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[e]),n}function RW(e){const t=YT(e);return qT(e,t)}const ES=[];function AW(e){const t=m.useRef(e),r=Ca(n=>e?n&&n!==ES&&e&&t.current&&e.parentNode===t.current.parentNode?n:bu(e):ES,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function IW(e){const[t,r]=m.useState(null),n=m.useRef(e),i=m.useCallback(s=>{const o=xg(s.target);o&&r(l=>l?(l.set(o,$v(o)),new Map(l)):null)},[]);return m.useEffect(()=>{const s=n.current;if(e!==s){o(s);const l=e.map(c=>{const d=xg(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,$v(d)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{o(e),o(s)};function o(l){l.forEach(c=>{const d=xg(c);d==null||d.removeEventListener("scroll",i)})}},[i,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,o)=>ms(s,o),Ar):GT(e):Ar,[e,t])}function TS(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Ar;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?ua(e,r.current):Ar}function MW(e){m.useEffect(()=>{if(!yu)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function PW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:i,handler:s}=n;return r[i]=o=>{s(o,t)},r},{}),[e,t])}function XT(e){return m.useMemo(()=>e?iW(e):null,[e])}const RS=[];function OW(e,t){t===void 0&&(t=$s);const[r]=e,n=XT(r?Xt(r):null),[i,s]=m.useState(RS);function o(){s(()=>e.length?e.map(c=>UT(c)?n:new Iy(t(c),c)):RS)}const l=ju({callback:o});return Gr(()=>{l==null||l.disconnect(),o(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),i}function DW(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Na(t)?t:e}function LW(e){let{measure:t}=e;const[r,n]=m.useState(null),i=m.useCallback(d=>{for(const{target:u}of d)if(Na(u)){n(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),s=ju({callback:i}),o=m.useCallback(d=>{const u=DW(d);s==null||s.disconnect(),u&&(s==null||s.observe(u)),n(u?t(u):null)},[t,s]),[l,c]=wc(o);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const FW=[{sensor:wu,options:{}},{sensor:_u,options:{}}],zW={current:{}},Rl={draggable:{measure:wS},droppable:{measure:wS,strategy:da.WhileDragging,frequency:Bv.Optimized},dragOverlay:{measure:$s}};class Mo extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const $W={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Mo,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:jc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Rl,measureDroppableContainers:jc,windowRect:null,measuringScheduled:!1},qW={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:jc,draggableNodes:new Map,over:null,measureDroppableContainers:jc},Su=m.createContext(qW),QT=m.createContext($W);function BW(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Mo}}}function HW(e,t){switch(t.type){case dt.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case dt.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case dt.DragEnd:case dt.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case dt.RegisterDroppable:{const{element:r}=t,{id:n}=r,i=new Mo(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case dt.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new Mo(e.droppable.containers);return o.set(r,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case dt.UnregisterDroppable:{const{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const s=new Mo(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function WW(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:i}=m.useContext(Su),s=Fv(n),o=Fv(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&s&&o!=null){if(!Ay(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=F7(u);if(f){f.focus();break}}})}},[n,t,i,o,s]),null}function UW(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...n}),r):r}function VW(e){return m.useMemo(()=>({draggable:{...Rl.draggable,...e==null?void 0:e.draggable},droppable:{...Rl.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Rl.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function GW(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e;const s=m.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Gr(()=>{if(!o&&!l||!t){s.current=!1;return}if(s.current||!n)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=r(d),f=qT(u,n);if(o||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=BT(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,o,l,n,r])}const ZT=m.createContext({...Ar,scaleX:1,scaleY:1});var En;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(En||(En={}));const JT=m.memo(function(t){var r,n,i,s;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:u=FW,collisionDetection:f=Q7,measuring:p,modifiers:h,...x}=t;const g=m.useReducer(HW,void 0,BW),[_,v]=g,[y,b]=W7(),[w,k]=m.useState(En.Uninitialized),S=w===En.Initialized,{draggable:{active:C,nodes:T,translate:j},droppable:{containers:R}}=_,E=C!=null?T.get(C):null,M=m.useRef({initial:null,translated:null}),$=m.useMemo(()=>{var ne;return C!=null?{id:C,data:(ne=E==null?void 0:E.data)!=null?ne:zW,rect:M}:null},[C,E]),N=m.useRef(null),[D,I]=m.useState(null),[F,P]=m.useState(null),A=ca(x,Object.values(x)),L=Ea("DndDescribedBy",o),z=m.useMemo(()=>R.getEnabled(),[R]),B=VW(p),{droppableRects:X,measureDroppableContainers:G,measuringScheduled:W}=NW(z,{dragging:S,dependencies:[j.x,j.y],config:B.droppable}),q=SW(T,C),Q=m.useMemo(()=>F?zv(F):null,[F]),ie=V(),oe=CW(q,B.draggable.measure);GW({activeNode:C!=null?T.get(C):null,config:ie.layoutShiftCompensation,initialRect:oe,measure:B.draggable.measure});const J=CS(q,B.draggable.measure,oe),je=CS(q?q.parentElement:null),ge=m.useRef({activatorEvent:null,active:null,activeNode:q,collisionRect:null,collisions:null,droppableRects:X,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),we=R.getNodeFor((r=ge.current.over)==null?void 0:r.id),xe=LW({measure:B.dragOverlay.measure}),se=(n=xe.nodeRef.current)!=null?n:q,K=S?(i=xe.rect)!=null?i:J:null,re=!!(xe.nodeRef.current&&xe.rect),U=RW(re?null:J),de=XT(se?Xt(se):null),fe=AW(S?we??q:null),me=OW(fe),ye=UW(h,{transform:{x:j.x-U.x,y:j.y-U.y,scaleX:1,scaleY:1},activatorEvent:F,active:$,activeNodeRect:J,containerNodeRect:je,draggingNodeRect:K,over:ge.current.over,overlayNodeRect:xe.rect,scrollableAncestors:fe,scrollableAncestorRects:me,windowRect:de}),ee=Q?ms(Q,j):null,he=IW(fe),De=TS(he),nt=TS(he,[J]),Re=ms(ye,De),Me=K?eW(K,ye):null,Be=$&&Me?f({active:$,collisionRect:Me,droppableRects:X,droppableContainers:z,pointerCoordinates:ee}):null,et=zT(Be,"id"),[Ae,Z]=m.useState(null),Ce=re?ye:ms(ye,nt),ve=Z7(Ce,(s=Ae==null?void 0:Ae.rect)!=null?s:null,J),Ct=m.useRef(null),yt=m.useCallback((ne,Le)=>{let{sensor:ct,options:ar}=Le;if(N.current==null)return;const Et=T.get(N.current);if(!Et)return;const _t=ne.nativeEvent,$t=new ct({active:N.current,activeNode:Et,event:_t,options:ar,context:ge,onAbort(it){if(!T.get(it))return;const{onDragAbort:ce}=A.current,We={id:it};ce==null||ce(We),y({type:"onDragAbort",event:We})},onPending(it,le,ce,We){if(!T.get(it))return;const{onDragPending:ri}=A.current,Dr={id:it,constraint:le,initialCoordinates:ce,offset:We};ri==null||ri(Dr),y({type:"onDragPending",event:Dr})},onStart(it){const le=N.current;if(le==null)return;const ce=T.get(le);if(!ce)return;const{onDragStart:We}=A.current,br={activatorEvent:_t,active:{id:le,data:ce.data,rect:M}};rs.unstable_batchedUpdates(()=>{We==null||We(br),k(En.Initializing),v({type:dt.DragStart,initialCoordinates:it,active:le}),y({type:"onDragStart",event:br}),I(Ct.current),P(_t)})},onMove(it){v({type:dt.DragMove,coordinates:it})},onEnd:Or(dt.DragEnd),onCancel:Or(dt.DragCancel)});Ct.current=$t;function Or(it){return async function(){const{active:ce,collisions:We,over:br,scrollAdjustedTranslate:ri}=ge.current;let Dr=null;if(ce&&ri){const{cancelDrop:ni}=A.current;Dr={activatorEvent:_t,active:ce,collisions:We,delta:ri,over:br},it===dt.DragEnd&&typeof ni=="function"&&await Promise.resolve(ni(Dr))&&(it=dt.DragCancel)}N.current=null,rs.unstable_batchedUpdates(()=>{v({type:it}),k(En.Uninitialized),Z(null),I(null),P(null),Ct.current=null;const ni=it===dt.DragEnd?"onDragEnd":"onDragCancel";if(Dr){const qs=A.current[ni];qs==null||qs(Dr),y({type:ni,event:Dr})}})}}},[T]),bt=m.useCallback((ne,Le)=>(ct,ar)=>{const Et=ct.nativeEvent,_t=T.get(ar);if(N.current!==null||!_t||Et.dndKit||Et.defaultPrevented)return;const $t={active:_t};ne(ct,Le.options,$t)===!0&&(Et.dndKit={capturedBy:Le.sensor},N.current=ar,yt(ct,Le))},[T,yt]),Qt=kW(u,bt);MW(u),Gr(()=>{J&&w===En.Initializing&&k(En.Initialized)},[J,w]),m.useEffect(()=>{const{onDragMove:ne}=A.current,{active:Le,activatorEvent:ct,collisions:ar,over:Et}=ge.current;if(!Le||!ct)return;const _t={active:Le,activatorEvent:ct,collisions:ar,delta:{x:Re.x,y:Re.y},over:Et};rs.unstable_batchedUpdates(()=>{ne==null||ne(_t),y({type:"onDragMove",event:_t})})},[Re.x,Re.y]),m.useEffect(()=>{const{active:ne,activatorEvent:Le,collisions:ct,droppableContainers:ar,scrollAdjustedTranslate:Et}=ge.current;if(!ne||N.current==null||!Le||!Et)return;const{onDragOver:_t}=A.current,$t=ar.get(et),Or=$t&&$t.rect.current?{id:$t.id,rect:$t.rect.current,data:$t.data,disabled:$t.disabled}:null,it={active:ne,activatorEvent:Le,collisions:ct,delta:{x:Et.x,y:Et.y},over:Or};rs.unstable_batchedUpdates(()=>{Z(Or),_t==null||_t(it),y({type:"onDragOver",event:it})})},[et]),Gr(()=>{ge.current={activatorEvent:F,active:$,activeNode:q,collisionRect:Me,collisions:Be,droppableRects:X,draggableNodes:T,draggingNode:se,draggingNodeRect:K,droppableContainers:R,over:Ae,scrollableAncestors:fe,scrollAdjustedTranslate:Re},M.current={initial:K,translated:Me}},[$,q,Be,Me,T,se,K,X,R,Ae,fe,Re]),_W({...ie,delta:j,draggingRect:Me,pointerCoordinates:ee,scrollableAncestors:fe,scrollableAncestorRects:me});const O=m.useMemo(()=>({active:$,activeNode:q,activeNodeRect:J,activatorEvent:F,collisions:Be,containerNodeRect:je,dragOverlay:xe,draggableNodes:T,droppableContainers:R,droppableRects:X,over:Ae,measureDroppableContainers:G,scrollableAncestors:fe,scrollableAncestorRects:me,measuringConfiguration:B,measuringScheduled:W,windowRect:de}),[$,q,J,F,Be,je,xe,T,R,X,Ae,G,fe,me,B,W,de]),H=m.useMemo(()=>({activatorEvent:F,activators:Qt,active:$,activeNodeRect:J,ariaDescribedById:{draggable:L},dispatch:v,draggableNodes:T,over:Ae,measureDroppableContainers:G}),[F,Qt,$,J,v,L,T,Ae,G]);return Y.createElement(OT.Provider,{value:b},Y.createElement(Su.Provider,{value:H},Y.createElement(QT.Provider,{value:O},Y.createElement(ZT.Provider,{value:ve},d)),Y.createElement(WW,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Y.createElement(G7,{...l,hiddenTextDescribedById:L}));function V(){const ne=(D==null?void 0:D.autoScrollEnabled)===!1,Le=typeof c=="object"?c.enabled===!1:c===!1,ct=S&&!ne&&!Le;return typeof c=="object"?{...c,enabled:ct}:{enabled:ct}}}),KW=m.createContext(null),AS="button",YW="Draggable";function XW(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e;const s=Ea(YW),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(Su),{role:h=AS,roleDescription:x="draggable",tabIndex:g=0}=i??{},_=(c==null?void 0:c.id)===t,v=m.useContext(_?ZT:KW),[y,b]=wc(),[w,k]=wc(),S=PW(o,t),C=ca(r);Gr(()=>(f.set(t,{id:t,key:s,node:y,activatorNode:w,data:C}),()=>{const j=f.get(t);j&&j.key===s&&f.delete(t)}),[f,t]);const T=m.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":n,"aria-pressed":_&&h===AS?!0:void 0,"aria-roledescription":x,"aria-describedby":u.draggable}),[n,h,g,_,x,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:T,isDragging:_,listeners:n?void 0:S,node:y,over:p,setNodeRef:b,setActivatorNodeRef:k,transform:v}}function QW(){return m.useContext(QT)}const ZW="Droppable",JW={timeout:25};function eU(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e;const s=Ea(ZW),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(Su),u=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:x,updateMeasurementsFor:g,timeout:_}={...JW,...i},v=ca(g??n),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(v.current)?v.current:[v.current]),h.current=null},_)},[_]),b=ju({callback:y,disabled:x||!o}),w=m.useCallback((T,j)=>{b&&(j&&(b.unobserve(j),f.current=!1),T&&b.observe(T))},[b]),[k,S]=wc(w),C=ca(t);return m.useEffect(()=>{!b||!k.current||(b.disconnect(),f.current=!1,b.observe(k.current))},[k,b]),m.useEffect(()=>(l({type:dt.RegisterDroppable,element:{id:n,key:s,disabled:r,node:k,rect:p,data:C}}),()=>l({type:dt.UnregisterDroppable,key:s,id:n})),[n]),m.useEffect(()=>{r!==u.current.disabled&&(l({type:dt.SetDroppableDisabled,id:n,key:s,disabled:r}),u.current.disabled=r)},[n,s,r,l]),{active:o,rect:p,isOver:(c==null?void 0:c.id)===n,node:k,over:c,setNodeRef:S}}function ku(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function tU(e,t){return e.reduce((r,n,i)=>{const s=t.get(n);return s&&(r[i]=s),r},Array(e.length))}function fl(e){return e!==null&&e>=0}function rU(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function nU(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const eR=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e;const s=ku(t,n,r),o=t[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},pl={scaleX:1,scaleY:1},tR=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:s,overIndex:o}=e;const l=(t=s[r])!=null?t:n;if(!l)return null;if(i===r){const d=s[o];return d?{x:0,y:r<o?d.top+d.height-(l.top+l.height):d.top-l.top,...pl}:null}const c=iU(s,i,r);return i>r&&i<=o?{x:0,y:-l.height-c,...pl}:i<r&&i>=o?{x:0,y:l.height+c,...pl}:{x:0,y:0,...pl}};function iU(e,t,r){const n=e[t],i=e[t-1],s=e[t+1];return n?r<t?i?n.top-(i.top+i.height):s?s.top-(n.top+n.height):0:s?s.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const rR="Sortable",nR=Y.createContext({activeIndex:-1,containerId:rR,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:eR,disabled:{draggable:!1,droppable:!1}});function iR(e){let{children:t,id:r,items:n,strategy:i=eR,disabled:s=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=QW(),f=Ea(rR,r),p=l.rect!==null,h=m.useMemo(()=>n.map(S=>typeof S=="object"&&"id"in S?S.id:S),[n]),x=o!=null,g=o?h.indexOf(o.id):-1,_=d?h.indexOf(d.id):-1,v=m.useRef(h),y=!rU(h,v.current),b=_!==-1&&g===-1||y,w=nU(s);Gr(()=>{y&&x&&u(h)},[y,h,x,u]),m.useEffect(()=>{v.current=h},[h]);const k=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:w,disableTransforms:b,items:h,overIndex:_,useDragOverlay:p,sortedRects:tU(h,c),strategy:i}),[g,f,w.draggable,w.droppable,b,h,_,c,p,i]);return Y.createElement(nR.Provider,{value:k},t)}const sU=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return ku(r,n,i).indexOf(t)},oU=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!n||l!==s&&i===o?!1:r?!0:o!==i&&t===c},aU={duration:200,easing:"ease"},sR="transform",lU=Es.Transition.toString({property:sR,duration:0,easing:"linear"}),cU={roleDescription:"sortable"};function uU(e){let{disabled:t,index:r,node:n,rect:i}=e;const[s,o]=m.useState(null),l=m.useRef(r);return Gr(()=>{if(!t&&r!==l.current&&n.current){const c=i.current;if(c){const d=$s(n.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&o(u)}}r!==l.current&&(l.current=r)},[t,r,n,i]),m.useEffect(()=>{s&&o(null)},[s]),s}function oR(e){let{animateLayoutChanges:t=oU,attributes:r,disabled:n,data:i,getNewIndex:s=sU,id:o,strategy:l,resizeObserverConfig:c,transition:d=aU}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:x,sortedRects:g,overIndex:_,useDragOverlay:v,strategy:y}=m.useContext(nR),b=dU(n,h),w=u.indexOf(o),k=m.useMemo(()=>({sortable:{containerId:f,index:w,items:u},...i}),[f,i,w,u]),S=m.useMemo(()=>u.slice(u.indexOf(o)),[u,o]),{rect:C,node:T,isOver:j,setNodeRef:R}=eU({id:o,data:k,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...c}}),{active:E,activatorEvent:M,activeNodeRect:$,attributes:N,setNodeRef:D,listeners:I,isDragging:F,over:P,setActivatorNodeRef:A,transform:L}=XW({id:o,data:k,attributes:{...cU,...r},disabled:b.draggable}),z=P7(R,D),B=!!E,X=B&&!x&&fl(p)&&fl(_),G=!v&&F,W=G&&X?L:null,Q=X?W??(l??y)({rects:g,activeNodeRect:$,activeIndex:p,overIndex:_,index:w}):null,ie=fl(p)&&fl(_)?s({id:o,items:u,activeIndex:p,overIndex:_}):w,oe=E==null?void 0:E.id,J=m.useRef({activeId:oe,items:u,newIndex:ie,containerId:f}),je=u!==J.current.items,ge=t({active:E,containerId:f,isDragging:F,isSorting:B,id:o,index:w,items:u,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:d,wasDragging:J.current.activeId!=null}),we=uU({disabled:!ge,index:w,node:T,rect:C});return m.useEffect(()=>{B&&J.current.newIndex!==ie&&(J.current.newIndex=ie),f!==J.current.containerId&&(J.current.containerId=f),u!==J.current.items&&(J.current.items=u)},[B,ie,f,u]),m.useEffect(()=>{if(oe===J.current.activeId)return;if(oe!=null&&J.current.activeId==null){J.current.activeId=oe;return}const se=setTimeout(()=>{J.current.activeId=oe},50);return()=>clearTimeout(se)},[oe]),{active:E,activeIndex:p,attributes:N,data:k,rect:C,index:w,newIndex:ie,items:u,isOver:j,isSorting:B,isDragging:F,listeners:I,node:T,overIndex:_,over:P,setNodeRef:z,setActivatorNodeRef:A,setDroppableNodeRef:R,setDraggableNodeRef:D,transform:we??Q,transition:xe()};function xe(){if(we||je&&J.current.newIndex===w)return lU;if(!(G&&!Ay(M)||!d)&&(B||ge))return Es.Transition.toString({...d,property:sR})}}function dU(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Nc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const fU=[Ie.Down,Ie.Right,Ie.Up,Ie.Left],aR=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:l}}=t;if(fU.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=i.get(f.id);if(p)switch(e.code){case Ie.Down:n.top<p.top&&c.push(f);break;case Ie.Up:n.top>p.top&&c.push(f);break;case Ie.Left:n.left>p.left&&c.push(f);break;case Ie.Right:n.left<p.left&&c.push(f);break}});const d=Y7({collisionRect:n,droppableRects:i,droppableContainers:c});let u=zT(d,"id");if(u===(o==null?void 0:o.id)&&d.length>1&&(u=d[1].id),u!=null){const f=s.get(r.id),p=s.get(u),h=p?i.get(p.id):null,x=p==null?void 0:p.node.current;if(x&&h&&f&&p){const _=bu(x).some((S,C)=>l[C]!==S),v=lR(f,p),y=pU(f,p),b=_||!v?{x:0,y:0}:{x:y?n.width-h.width:0,y:y?n.height-h.height:0},w={x:h.left,y:h.top};return b.x&&b.y?w:ua(w,b)}}}};function lR(e,t){return!Nc(e)||!Nc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function pU(e,t){return!Nc(e)||!Nc(t)||!lR(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const hU={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Fr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},lr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},cR={step_id:"new_step",produces:"",scope:"",inputs:[]},mU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function gU({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:i,onNavigateToWorkflow:s}){const[o,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:x,error:g,saving:_,updateWorkflow:v}=IT(e,p,{onSave:j=>{n==null||n(p,j)}}),y=m.useCallback(j=>{j==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(j)},[h]),b=m.useCallback(j=>{const R=j.target.value;d(R);try{const E=JSON.parse(R);f(null),v(E)}catch(E){f(E.message)}},[v]),w=m.useCallback((j,R)=>{if(!h)return;const E=[...h.steps];E[j]=R,v({...h,steps:E})},[h,v]),k=m.useCallback(j=>{if(!h)return;const R=h.steps.filter((E,M)=>M!==j);v({...h,steps:R})},[h,v]),S=m.useCallback(j=>{var E,M;if(!h)return;const R=j==="iteration"?{...mU,step_id:`new_iteration_${(((E=h.steps)==null?void 0:E.length)||0)+1}`}:{...cR,step_id:`new_step_${(((M=h.steps)==null?void 0:M.length)||0)+1}`};v({...h,steps:[...h.steps||[],R]})},[h,v]),C=m.useCallback((j,R)=>{if(!h)return;const E=ku(h.steps,j,R);v({...h,steps:E})},[h,v]),T=m.useCallback(()=>{!i||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&i(t.workflow_id)},[i,t]);return t?a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[_&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),i&&a.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(j=>a.jsx("button",{onClick:()=>y(j.id),style:{...hU,color:o===j.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:j.label},j.id))}),x?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&a.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[a.jsx(vU,{steps:(h==null?void 0:h.steps)||[],documentTypes:r,onStepChange:w,onStepDelete:k,onReorder:C}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>S("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),a.jsx("button",{onClick:()=>S("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&a.jsxs("div",{className:"h-full flex flex-col p-4",children:[a.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),o==="metadata"&&a.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?a.jsx(_U,{workflow:h,onUpdateWorkflow:v,onNavigateToWorkflow:s}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),a.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function vU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=DT(Sc(wu,{activationConstraint:{distance:5}}),Sc(_u,{coordinateGetter:aR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):a.jsx(JT,{sensors:s,collisionDetection:$T,onDragEnd:l,children:a.jsx(iR,{items:o,strategy:tR,children:e.map((c,d)=>a.jsx(xU,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function xU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=oR({id:e.step_id}),f={transform:Es.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(uR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o}})})}function uR({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i,dragHandleProps:s,depth:o=0}){var S,C,T;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(j,R)=>{const E={...l,[j]:R};c(E),n(t,E)},h=(j,R)=>{const E={...l.iterate_over,[j]:R},M={...l,iterate_over:E};c(M),n(t,M)},x=()=>{const j=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:j};c(R),n(t,R)},g=(j,R,E)=>{const M=[...l.inputs||[]];M[j]={...M[j],[R]:E};const $={...l,inputs:M};c($),n(t,$)},_=j=>{const R=(l.inputs||[]).filter((M,$)=>$!==j),E={...l,inputs:R};c(E),n(t,E)},v=m.useCallback((j,R)=>{const E=[...l.steps||[]];E[j]=R;const M={...l,steps:E};c(M),n(t,M)},[l,t,n]),y=m.useCallback(j=>{const R=(l.steps||[]).filter((M,$)=>$!==j),E={...l,steps:R};c(E),n(t,E)},[l,t,n]),b=m.useCallback(()=>{var E;const j=[...l.steps||[],{...cR,step_id:`nested_step_${(((E=l.steps)==null?void 0:E.length)||0)+1}`}],R={...l,steps:j};c(R),n(t,R)},[l,t,n]),w=m.useCallback((j,R)=>{const E=ku(l.steps||[],j,R),M={...l,steps:E};c(M),n(t,M)},[l,t,n]),k={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return a.jsxs("div",{style:k,children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[s&&a.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[a.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),a.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),a.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),a.jsx("span",{style:{flex:1}}),a.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?a.jsx("path",{d:"M18 15l-6-6-6 6"}):a.jsx("path",{d:"M6 9l6 6 6-6"})})}),a.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Step ID"}),a.jsx("input",{type:"text",value:l.step_id||"",onChange:j=>p("step_id",j.target.value),style:Fr})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Doc Type"}),a.jsxs("select",{value:((S=l.iterate_over)==null?void 0:S.doc_type)||"",onChange:j=>h("doc_type",j.target.value),style:Fr,children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(j=>a.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Collection Field"}),a.jsx("input",{type:"text",value:((C=l.iterate_over)==null?void 0:C.collection_field)||"",onChange:j=>h("collection_field",j.target.value),style:Fr})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Entity Type"}),a.jsx("input",{type:"text",value:((T=l.iterate_over)==null?void 0:T.entity_type)||"",onChange:j=>h("entity_type",j.target.value),style:Fr})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:j=>p("scope",j.target.value),style:Fr})]}),a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{style:lr,children:"Nested Steps"}),a.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),a.jsx(yU,{steps:l.steps||[],documentTypes:r,onStepChange:v,onStepDelete:y,onReorder:w})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Produces"}),a.jsxs("select",{value:l.produces||"",onChange:j=>p("produces",j.target.value),style:Fr,children:[a.jsx("option",{value:"",children:"-- Select document type --"}),r.map(j=>a.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:j=>p("scope",j.target.value),placeholder:"project",style:Fr})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Creates Entities"}),a.jsx("input",{type:"text",value:l.creates_entities||"",onChange:j=>p("creates_entities",j.target.value||void 0),placeholder:"e.g., epic",style:Fr})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:lr,children:"Inputs"}),a.jsx("button",{onClick:x,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):a.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((j,R)=>a.jsxs("div",{className:"flex gap-1 items-end",children:[a.jsxs("div",{style:{flex:1},children:[R===0&&a.jsx("label",{style:{...lr,fontSize:9},children:"Doc/Entity Type"}),a.jsxs("select",{value:j.doc_type||j.entity_type||"",onChange:E=>{const M=E.target.value;j.entity_type!==void 0?g(R,"entity_type",M):g(R,"doc_type",M)},style:{...Fr,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(E=>a.jsx("option",{value:E.doc_type_id,children:E.doc_type_id},E.doc_type_id))]})]}),a.jsxs("div",{style:{width:"30%"},children:[R===0&&a.jsx("label",{style:{...lr,fontSize:9},children:"Scope"}),a.jsx("input",{type:"text",value:j.scope||"",onChange:E=>g(R,"scope",E.target.value),placeholder:"scope",style:{...Fr,fontSize:11}})]}),a.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[a.jsx("input",{type:"checkbox",checked:j.context||!1,onChange:E=>g(R,"context",E.target.checked||void 0)}),"ctx"]}),a.jsx("button",{onClick:()=>_(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function yU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=DT(Sc(wu,{activationConstraint:{distance:5}}),Sc(_u,{coordinateGetter:aR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):a.jsx(JT,{sensors:s,collisionDetection:$T,onDragEnd:l,children:a.jsx(iR,{items:o,strategy:tR,children:e.map((c,d)=>a.jsx(bU,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function bU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=oR({id:e.step_id}),f={transform:Es.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(uR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o},depth:1})})}function _U({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,i]=m.useState(""),s={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},o={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,x=e.source_version,g=e.tags||[],_=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),i(""))},v=b=>{t==null||t({...e,tags:g.filter(w=>w!==b)})},y=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"POW Class"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Derived From"}),a.jsx("div",{style:s,children:r?a.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):a.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),x&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Source Version"}),a.jsx("div",{style:s,children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Tags"}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>a.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&a.jsx("button",{onClick:()=>v(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:n,onChange:b=>i(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),_())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),a.jsx("button",{onClick:_,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b.label}),a.jsx("div",{style:s,children:e[b.key]||"-"})]},b.key)),d.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,w])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:["parent: ",w.parent||"none"]})]},b))]}),f.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,w])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:[w.name,w.scope&&` (${w.scope})`,w.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function IS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(i=>i.status==="fail"),n=e.filter(i=>i.status==="pass");return t?a.jsx("div",{className:"flex items-center gap-2",children:r.length>0?a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):a.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):a.jsxs("div",{className:"space-y-2",children:[r.map((i,s)=>a.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx("span",{className:"text-red-400",children:"FAIL"}),a.jsx("span",{className:"font-mono",children:i.rule_id})]}),i.message&&a.jsx("div",{className:"mt-1 opacity-80",children:i.message}),i.artifact_id&&a.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:i.artifact_id})]},s)),n.length>0&&r.length>0&&a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function wU(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),i=[];let s=0,o=0;for(;s<r.length||o<n.length;)if(s>=r.length)i.push({type:"added",line:n[o],lineNum:o+1}),o++;else if(o>=n.length)i.push({type:"removed",line:r[s],lineNum:s+1}),s++;else if(r[s]===n[o])i.push({type:"same",line:r[s],oldLineNum:s+1,newLineNum:o+1}),s++,o++;else{let l=n.slice(o,o+5).indexOf(r[s]),c=r.slice(s,s+5).indexOf(n[o]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)i.push({type:"added",line:n[o+d],lineNum:o+d+1});o+=l}else if(c!==-1){for(let d=0;d<c;d++)i.push({type:"removed",line:r[s+d],lineNum:s+d+1});s+=c}else i.push({type:"removed",line:r[s],lineNum:s+1}),i.push({type:"added",line:n[o],lineNum:o+1}),s++,o++}return i}function jU({diff:e}){const[t,r]=m.useState(!0),n=wU(e.old_content,e.new_content),i={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return a.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:i[e.status]||i.M,children:e.status}),a.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),a.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&a.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:a.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((s,o)=>a.jsxs("div",{className:"flex",style:{background:s.type==="added"?"rgba(34, 197, 94, 0.1)":s.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:s.type==="added"?"3px solid #22c55e":s.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[a.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:s.type==="same"?s.oldLineNum:s.lineNum||""}),a.jsx("span",{className:"select-none px-1",style:{color:s.type==="added"?"#22c55e":s.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:s.type==="added"?"+":s.type==="removed"?"-":" "}),a.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:s.line})]},o))})})]})}function SU({workspaceId:e,artifactId:t=null,onClose:r}){const[n,i]=m.useState([]),[s,o]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(o(!0),c(null),_e.getDiff(e,t).then(u=>{i(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{o(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(r==null||r())};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(r==null?void 0:r()),onKeyDown:d,tabIndex:0,children:a.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),a.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?a.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((u,f)=>a.jsx(jU,{diff:u},u.artifact_id||f))}),a.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function kU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:i,kind:s,displayName:o,kindLabel:l,display:`${o} - ${l}`}}function NU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=kU(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function CU({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:i=[],modifiedFiles:s=[]}){const[o,l]=m.useState(""),[c,d]=m.useState(!1),u=NU(i),f=i.length,p=x=>{x.preventDefault(),o.trim()&&!n&&t(o.trim())},h=x=>{x.key==="Escape"&&!n&&r()};return a.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:x=>x.target===x.currentTarget&&!n&&r(),onKeyDown:h,children:[a.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&a.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),a.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(x=>a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:x.label}),a.jsx("div",{className:"space-y-1",children:x.items.map((g,_)=>a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),a.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),a.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),a.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},_))})]},x.scope))}),a.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),a.jsxs("form",{onSubmit:p,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),a.jsx("textarea",{value:o,onChange:x=>l(x.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!o.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:o.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:o.trim()&&!n?"#000":"var(--text-muted)",cursor:o.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&a.jsx(SU,{workspaceId:e,onClose:()=>d(!1)})]})}function EU(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:o,kind:s,kindLabel:l,version:i,display:`${o} - ${l}`}}function TU({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:i,onClose:s,onRefresh:o}){var j,R;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,x]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,_=(t==null?void 0:t.modified_artifacts)??[],v=((j=t==null?void 0:t.tier1)==null?void 0:j.passed)??!0,y=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",w=t!=null&&t.expires_at?new Date(t.expires_at):null,k=async E=>{u(!0),x(null);try{const M=await _e.commit(e,E);c(!1),n==null||n(M),o==null||o()}catch(M){x(M.message)}finally{u(!1)}},S=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await _e.discard(e),i==null||i(),o==null||o()}catch(E){console.error("Discard failed:",E),alert("Failed to discard changes: "+E.message)}finally{p(!1)}}},C=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await _e.closeWorkspace(e),s==null||s()}catch(E){console.error("Close failed:",E),alert("Failed to close workspace: "+E.message)}},T=E=>{if(!E)return null;const $=E-new Date;if($<=0)return"Expired";const N=Math.floor($/(1e3*60*60)),D=Math.floor($%(1e3*60*60)/(1e3*60));return N>0?`${N}h ${D}m remaining`:`${D}m remaining`};return a.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:a.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),a.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),w&&a.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:T(w)})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),a.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),_.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",_.length,")"]}),a.jsx("div",{className:"space-y-1",children:_.map(E=>{const M=EU(E);return a.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:E,children:[a.jsx("span",{style:{color:"var(--text-primary)"},children:M.displayName||E}),M.kindLabel&&a.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",M.kindLabel]})]},E)})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),a.jsx(IS,{results:y,compact:!0})]}),y.length>0&&!v&&a.jsx("div",{className:"mt-3",children:a.jsx(IS,{results:y})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[a.jsx("button",{onClick:()=>c(!0),disabled:!g||!v||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&v?"var(--action-success)":"var(--border-panel)",color:g&&v?"#000":"var(--text-muted)",cursor:g&&v&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!v&&g&&a.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&a.jsx("button",{onClick:S,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&a.jsx("button",{onClick:C,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&a.jsx(CU,{workspaceId:e,onCommit:k,onCancel:()=>{c(!1),x(null)},loading:d,modifiedArtifacts:_,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&a.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function RU(){const{isAdmin:e,loading:t}=Ls(),[r,n]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[x,g]=m.useState(null),[_,v]=m.useState(null),[y,b]=m.useState(null),[w,k]=m.useState(null),[S,C]=m.useState(!1),{workspaceId:T,loading:j,error:R,reinitialize:E}=cB(),{state:M,loading:$,refresh:N}=uB(T),{documentTypes:D,loading:I,refresh:F}=dB(),{roles:P,loading:A,refresh:L}=fB(),{templates:z,loading:B,refresh:X}=ET(),{workflows:G,loading:W,refresh:q}=ZH(),{fragments:Q,loading:ie,kindOptions:oe,refresh:J}=RT(),{schemas:je,loading:ge,refresh:we}=TT(),[xe,se]=m.useState([]),[K,re]=m.useState([]),[U,de]=m.useState(!1),[fe,me]=m.useState(null),ye=m.useCallback(async()=>{de(!0);try{const[le,ce]=await Promise.all([_e.getMechanicalOpTypes(),_e.getMechanicalOps()]);se(le.types||[]),re(ce.operations||[])}catch(le){console.error("Failed to load mechanical ops:",le)}finally{de(!1)}},[]);m.useEffect(()=>{ye()},[ye]);const ee=m.useCallback(async(le,ce=null,We="docworkflow")=>{if(n(le),d(null),f(null),h(null),s(null),g(null),v(null),me(null),b(ce),k(We),!!le){l(!0);try{const br=await _e.getDocumentType(le.doc_type_id);s(br)}catch(br){console.error("Failed to load doc type details:",br),s(le)}finally{l(!1)}}},[]),he=m.useCallback(le=>{ee(le,"task_prompt","task")},[ee]),De=m.useCallback(le=>{ee(le,"schema","schema")},[ee]),nt=m.useCallback(le=>{d(le),n(null),s(null),f(null),h(null),g(null),v(null),me(null)},[]),Re=m.useCallback(le=>{f(le),n(null),s(null),d(null),h(null),g(null),v(null),me(null)},[]),Me=m.useCallback(le=>{h(le),n(null),s(null),d(null),f(null),g(null),v(null),me(null)},[]),Be=m.useCallback(le=>{g(le),n(null),s(null),d(null),f(null),h(null),v(null),me(null)},[]),et=m.useCallback(le=>{v(le),n(null),s(null),d(null),f(null),h(null),g(null),me(null)},[]),Ae=m.useCallback(le=>{me(le),n(null),s(null),d(null),f(null),h(null),g(null),v(null)},[]),Z=m.useCallback(le=>{const ce=G.find(We=>We.workflow_id===le);ce&&Me(ce)},[G,Me]),Ce=m.useCallback((le,ce)=>{N()},[N]),ve=m.useCallback(le=>{console.log("Committed:",le.commit_hash)},[]),Ct=m.useCallback(()=>{n(null),s(null),d(null),f(null),h(null),g(null),v(null),me(null)},[]),yt=m.useCallback(async le=>{if(T)try{const ce=await _e.createOrchestrationWorkflow(T,le);await q(),N(),h({workflow_id:ce.workflow_id,active_version:ce.version,name:le.name||ce.workflow_id.replace(/_/g," ").replace(/\b\w/g,We=>We.toUpperCase())}),n(null),s(null),d(null),f(null)}catch(ce){console.error("Failed to create workflow:",ce),alert(`Failed to create workflow: ${ce.message}`)}},[T,q,N]),bt=m.useCallback(async le=>{if(T)try{await _e.deleteOrchestrationWorkflow(T,le),await q(),N(),h(null)}catch(ce){console.error("Failed to delete workflow:",ce),alert(`Failed to delete workflow: ${ce.message}`)}},[T,q,N]),Qt=m.useCallback(async le=>{if(T)try{const ce=await _e.createDocumentType(T,le);await F(),N(),ee({doc_type_id:ce.doc_type_id,display_name:le.display_name||ce.doc_type_id.replace(/_/g," ").replace(/\b\w/g,We=>We.toUpperCase()),active_version:ce.version})}catch(ce){console.error("Failed to create document type:",ce),alert(`Failed to create document type: ${ce.message}`)}},[T,F,N,ee]);m.useCallback(async le=>{if(T)try{await _e.deleteDocumentType(T,le),await F(),N(),n(null),s(null)}catch(ce){console.error("Failed to delete document type:",ce),alert(`Failed to delete document type: ${ce.message}`)}},[T,F,N]);const O=m.useCallback(async le=>{if(T)try{await _e.createDcwWorkflow(T,{doc_type_id:le}),await q(),N()}catch(ce){console.error("Failed to create DCW workflow:",ce),alert(`Failed to create workflow: ${ce.message}`)}},[T,q,N]),H=m.useCallback(async le=>{if(T)try{const ce=await _e.createRolePrompt(T,le);await J(),await L(),N(),Be({fragment_id:`role:${ce.role_id}`,kind:"role",version:ce.version,name:le.name||ce.role_id.replace(/_/g," ").replace(/\b\w/g,We=>We.toUpperCase())})}catch(ce){console.error("Failed to create role prompt:",ce),alert(`Failed to create role prompt: ${ce.message}`)}},[T,J,L,N,Be]),V=m.useCallback(async le=>{if(T)try{const ce=await _e.createTemplate(T,le);await X(),N(),Re({template_id:ce.template_id,active_version:ce.version,name:le.name||ce.template_id.replace(/_/g," ").replace(/\b\w/g,We=>We.toUpperCase())})}catch(ce){console.error("Failed to create template:",ce),alert(`Failed to create template: ${ce.message}`)}},[T,X,N,Re]),ne=m.useCallback(async le=>{if(T)try{const ce=await _e.createStandaloneSchema(T,le);await we(),N(),et({schema_id:ce.schema_id,active_version:ce.version,title:le.title||ce.schema_id.replace(/_/g," ").replace(/\b\w/g,We=>We.toUpperCase())})}catch(ce){console.error("Failed to create schema:",ce),alert(`Failed to create schema: ${ce.message}`)}},[T,we,N,et]),Le=m.useCallback(()=>{E(),n(null),s(null),d(null),f(null),h(null),g(null),v(null),me(null)},[E]),ct=m.useCallback(async()=>{try{await _e.invalidateCache(),await Promise.all([F(),L(),X(),q(),J(),we(),ye(),N()])}catch(le){console.error("Failed to reload config:",le),alert(`Failed to reload config: ${le.message}`)}},[F,L,X,q,J,we,ye,N]);if(t)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(j)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(R)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),a.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:R}),a.jsx("button",{onClick:E,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const ar=c&&!r&&!u&&!p&&!x&&!_&&!fe,Et=u&&!r&&!c&&!p&&!x&&!_&&!fe,_t=p&&!r&&!c&&!u&&!x&&!_&&!fe,$t=x&&!r&&!c&&!u&&!p&&!_&&!fe,Or=_&&!r&&!c&&!u&&!p&&!x&&!fe,it=fe&&!r&&!c&&!u&&!p&&!x&&!_;return a.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{window.location.href="/"},title:"Return to Home"}),a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:ct,className:"flex items-center gap-1 px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{background:"var(--bg-panel)",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:11},title:"Reload config from disk (invalidate cache)",children:[a.jsx("span",{style:{fontSize:12},children:""}),a.jsx("span",{children:"Reload"})]}),a.jsxs("button",{onClick:()=>C(!S),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:S?"var(--action-primary)":"var(--bg-panel)",color:S?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[a.jsx("span",{style:{fontSize:14},children:""}),a.jsx("span",{children:"Building Blocks"})]})]})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(JH,{documentTypes:D,roles:P,templates:z,workflows:G,promptFragments:Q,promptFragmentKindOptions:oe,schemas:je,loading:I,rolesLoading:A,templatesLoading:B,workflowsLoading:W,promptFragmentsLoading:ie,schemasLoading:ge,selectedDocType:r,docTypeSource:w,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:x,selectedSchema:_,onSelectDocType:ee,onSelectRole:nt,onSelectTemplate:Re,onSelectWorkflow:Me,onSelectFragment:Be,onSelectStandaloneSchema:et,onCreateWorkflow:yt,onCreateDocType:Qt,onCreateFragment:H,onCreateTemplate:V,onCreateSchema:ne,onSelectTask:he,onSelectSchema:De,workspaceState:M}),ar?a.jsx(N7,{workspaceId:T,role:c,onArtifactSave:Ce}):Et?a.jsx(E7,{workspaceId:T,template:u,onArtifactSave:Ce}):$t?a.jsx(I7,{workspaceId:T,fragment:x,onArtifactSave:Ce}):_t?a.jsx(gU,{workspaceId:T,workflow:p,documentTypes:D,onArtifactSave:Ce,onDelete:bt,onNavigateToWorkflow:Z}):Or?a.jsx(T7,{workspaceId:T,schema:_,onArtifactSave:Ce}):it?a.jsx(M7,{mechanicalOp:fe,mechanicalOpTypes:xe}):a.jsx(k7,{workspaceId:T,docType:i,loading:o,roles:P,workflows:G,onArtifactSave:Ce,onCreateDcwWorkflow:O,initialTab:y,docTypeSource:w,mechanicalOpTypes:xe,mechanicalOps:K}),a.jsx(TU,{workspaceId:T,state:M,loading:$,onCommit:ve,onDiscard:Ct,onClose:Le,onRefresh:N})]}),a.jsx(t7,{isOpen:S,onClose:()=>C(!1),promptFragments:Q,promptFragmentKindOptions:oe,templates:z,schemas:je,documentTypes:D,promptFragmentsLoading:ie,templatesLoading:B,schemasLoading:ge,selectedFragment:x,selectedTemplate:u,selectedSchema:_,selectedMechanicalOp:fe,onSelectFragment:Be,onSelectTemplate:Re,onSelectSchema:De,onSelectStandaloneSchema:et,onCreateFragment:H,onCreateTemplate:V,onCreateSchema:ne,mechanicalOpTypes:xe,mechanicalOps:K,mechanicalOpsLoading:U,onSelectMechanicalOp:Ae})]})}function AU({user:e,onClick:t}){return a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function IU(){var E,M,$;const{user:e}=Ls(),[t,r]=m.useState(!1),{projects:n,loading:i,error:s,refresh:o}=sB({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,x]=m.useState(!1),{theme:g,setTheme:_}=F4(),v=Object.keys(n),y=l&&n[l]?l:v[0]||null;m.useEffect(()=>{if(y&&n[y]){const N=n[y];document.title=`${N.projectId} - The Combine`}else document.title="The Combine"},[y,n]);const b=N=>{c(N),u(null)},w=()=>{p(!0)},k=async N=>{await o(),N&&N.id&&(c(N.id),u("concierge_intake")),p(!1)},S=()=>{p(!1)},C=async(N,D)=>{try{await Ve.updateProject(N,D),await o()}catch(I){throw console.error("Failed to update project:",I),I}},T=async N=>{try{if(await Ve.archiveProject(N),!t){const D=Object.values(n).sort((P,A)=>{const L=(P.name||"").localeCompare(A.name||"");return L!==0?L:(P.projectId||"").localeCompare(A.projectId||"")}),I=D.findIndex(P=>P.id===N),F=D[I+1]||D[I-1]||null;c((F==null?void 0:F.id)||null)}await o()}catch(D){throw console.error("Failed to archive project:",D),D}},j=async N=>{try{await Ve.unarchiveProject(N),await o()}catch(D){throw console.error("Failed to unarchive project:",D),D}},R=async N=>{try{await Ve.deleteProject(N);const D=Object.values(n).sort((P,A)=>{const L=(P.name||"").localeCompare(A.name||"");return L!==0?L:(P.projectId||"").localeCompare(A.projectId||"")}),I=D.findIndex(P=>P.id===N),F=D[I+1]||D[I-1]||null;c((F==null?void 0:F.id)||null),await o()}catch(D){throw console.error("Failed to delete project:",D),D}};return i?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):s?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[a.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",s]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):a.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[a.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),a.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),a.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("path",{d:"M12 17h.01"})]})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(i6,{projects:n,selectedId:y,onSelectProject:b,onNewProject:w,showArchived:t,onToggleShowArchived:()=>r(N=>!N),userSection:a.jsx(AU,{user:e,onClick:()=>x(!0)})}),a.jsx("div",{className:"flex-1",children:y?a.jsx(Zc,{children:a.jsx(mB,{projectId:y,projectCode:(E=n[y])==null?void 0:E.projectId,projectName:(M=n[y])==null?void 0:M.name,isArchived:($=n[y])==null?void 0:$.isArchived,autoExpandNodeId:d,theme:g,onThemeChange:_,onProjectUpdate:C,onProjectArchive:T,onProjectUnarchive:j,onProjectDelete:R})},y):a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center",children:a.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&a.jsx(zH,{onClose:S,onComplete:k}),h&&a.jsx($H,{onClose:()=>x(!1)})]})]})}function MU(){const{isAuthenticated:e,loading:t}=Ls(),{theme:r}=F4(),[n,i]=m.useState(window.location.pathname);return m.useEffect(()=>{const s=()=>i(window.location.pathname);return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]),t?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?a.jsx("div",{className:`h-screen theme-${r}`,children:a.jsx(RU,{})}):a.jsx(IU,{}):n==="/learn"?a.jsx(QH,{}):a.jsx(GH,{})}function PU(){return a.jsx(lB,{children:a.jsx(MU,{})})}_g.createRoot(document.getElementById("root")).render(a.jsx(Y.StrictMode,{children:a.jsx(PU,{})}));
//# sourceMappingURL=index-C2hWqfj1.js.map
