(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fj={exports:{}},Vl={},pj={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qi=Symbol.for("react.element"),g4=Symbol.for("react.portal"),v4=Symbol.for("react.fragment"),x4=Symbol.for("react.strict_mode"),y4=Symbol.for("react.profiler"),b4=Symbol.for("react.provider"),w4=Symbol.for("react.context"),_4=Symbol.for("react.forward_ref"),j4=Symbol.for("react.suspense"),S4=Symbol.for("react.memo"),k4=Symbol.for("react.lazy"),Ox=Symbol.iterator;function N4(e){return e===null||typeof e!="object"?null:(e=Ox&&e[Ox]||e["@@iterator"],typeof e=="function"?e:null)}var hj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mj=Object.assign,gj={};function co(e,t,r){this.props=e,this.context=t,this.refs=gj,this.updater=r||hj}co.prototype.isReactComponent={};co.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};co.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vj(){}vj.prototype=co.prototype;function Kg(e,t,r){this.props=e,this.context=t,this.refs=gj,this.updater=r||hj}var Yg=Kg.prototype=new vj;Yg.constructor=Kg;mj(Yg,co.prototype);Yg.isPureReactComponent=!0;var Lx=Array.isArray,xj=Object.prototype.hasOwnProperty,Xg={current:null},yj={key:!0,ref:!0,__self:!0,__source:!0};function bj(e,t,r){var n,s={},o=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)xj.call(t,n)&&!yj.hasOwnProperty(n)&&(s[n]=t[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:qi,type:e,key:o,ref:i,props:s,_owner:Xg.current}}function E4(e,t){return{$$typeof:qi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Qg(e){return typeof e=="object"&&e!==null&&e.$$typeof===qi}function C4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var zx=/\/+/g;function Wc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?C4(""+e.key):t.toString(36)}function za(e,t,r,n,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case qi:case g4:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+Wc(i,0):n,Lx(s)?(r="",e!=null&&(r=e.replace(zx,"$&/")+"/"),za(s,t,r,"",function(u){return u})):s!=null&&(Qg(s)&&(s=E4(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(zx,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Lx(e))for(var a=0;a<e.length;a++){o=e[a];var c=n+Wc(o,a);i+=za(o,t,r,c,s)}else if(c=N4(e),typeof c=="function")for(e=c.call(e),a=0;!(o=e.next()).done;)o=o.value,c=n+Wc(o,a++),i+=za(o,t,r,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function ra(e,t,r){if(e==null)return e;var n=[],s=0;return za(e,n,"","",function(o){return t.call(r,o,s++)}),n}function R4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var yt={current:null},qa={transition:null},T4={ReactCurrentDispatcher:yt,ReactCurrentBatchConfig:qa,ReactCurrentOwner:Xg};function wj(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:ra,forEach:function(e,t,r){ra(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ra(e,function(){t++}),t},toArray:function(e){return ra(e,function(t){return t})||[]},only:function(e){if(!Qg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};fe.Component=co;fe.Fragment=v4;fe.Profiler=y4;fe.PureComponent=Kg;fe.StrictMode=x4;fe.Suspense=j4;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T4;fe.act=wj;fe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=mj({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Xg.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)xj.call(t,c)&&!yj.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:qi,type:e.type,key:s,ref:o,props:n,_owner:i}};fe.createContext=function(e){return e={$$typeof:w4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:b4,_context:e},e.Consumer=e};fe.createElement=bj;fe.createFactory=function(e){var t=bj.bind(null,e);return t.type=e,t};fe.createRef=function(){return{current:null}};fe.forwardRef=function(e){return{$$typeof:_4,render:e}};fe.isValidElement=Qg;fe.lazy=function(e){return{$$typeof:k4,_payload:{_status:-1,_result:e},_init:R4}};fe.memo=function(e,t){return{$$typeof:S4,type:e,compare:t===void 0?null:t}};fe.startTransition=function(e){var t=qa.transition;qa.transition={};try{e()}finally{qa.transition=t}};fe.unstable_act=wj;fe.useCallback=function(e,t){return yt.current.useCallback(e,t)};fe.useContext=function(e){return yt.current.useContext(e)};fe.useDebugValue=function(){};fe.useDeferredValue=function(e){return yt.current.useDeferredValue(e)};fe.useEffect=function(e,t){return yt.current.useEffect(e,t)};fe.useId=function(){return yt.current.useId()};fe.useImperativeHandle=function(e,t,r){return yt.current.useImperativeHandle(e,t,r)};fe.useInsertionEffect=function(e,t){return yt.current.useInsertionEffect(e,t)};fe.useLayoutEffect=function(e,t){return yt.current.useLayoutEffect(e,t)};fe.useMemo=function(e,t){return yt.current.useMemo(e,t)};fe.useReducer=function(e,t,r){return yt.current.useReducer(e,t,r)};fe.useRef=function(e){return yt.current.useRef(e)};fe.useState=function(e){return yt.current.useState(e)};fe.useSyncExternalStore=function(e,t,r){return yt.current.useSyncExternalStore(e,t,r)};fe.useTransition=function(){return yt.current.useTransition()};fe.version="18.3.1";pj.exports=fe;var m=pj.exports;const B=Gg(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I4=m,M4=Symbol.for("react.element"),P4=Symbol.for("react.fragment"),A4=Object.prototype.hasOwnProperty,D4=I4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,O4={key:!0,ref:!0,__self:!0,__source:!0};function _j(e,t,r){var n,s={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)A4.call(t,n)&&!O4.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:M4,type:e,key:o,ref:i,props:s,_owner:D4.current}}Vl.Fragment=P4;Vl.jsx=_j;Vl.jsxs=_j;fj.exports=Vl;var l=fj.exports,Tm={},jj={exports:{}},zt={},Sj={exports:{}},kj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,M){var z=O.length;O.push(M);e:for(;0<z;){var P=z-1>>>1,I=O[P];if(0<s(I,M))O[P]=M,O[z]=I,z=P;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var M=O[0],z=O.pop();if(z!==M){O[0]=z;e:for(var P=0,I=O.length,F=I>>>1;P<F;){var V=2*(P+1)-1,G=O[V],X=V+1,te=O[X];if(0>s(G,z))X<I&&0>s(te,G)?(O[P]=te,O[X]=z,P=X):(O[P]=G,O[V]=z,P=V);else if(X<I&&0>s(te,z))O[P]=te,O[X]=z,P=X;else break e}}return M}function s(O,M){var z=O.sortIndex-M.sortIndex;return z!==0?z:O.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var c=[],u=[],d=1,f=null,p=3,h=!1,y=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var M=r(u);M!==null;){if(M.callback===null)n(u);else if(M.startTime<=O)n(u),M.sortIndex=M.expirationTime,t(c,M);else break;M=r(u)}}function w(O){if(v=!1,b(O),!y)if(r(c)!==null)y=!0,A(j);else{var M=r(u);M!==null&&$(w,M.startTime-O)}}function j(O,M){y=!1,v&&(v=!1,g(S),S=-1),h=!0;var z=p;try{for(b(M),f=r(c);f!==null&&(!(f.expirationTime>M)||O&&!T());){var P=f.callback;if(typeof P=="function"){f.callback=null,p=f.priorityLevel;var I=P(f.expirationTime<=M);M=e.unstable_now(),typeof I=="function"?f.callback=I:f===r(c)&&n(c),b(M)}else n(c);f=r(c)}if(f!==null)var F=!0;else{var V=r(u);V!==null&&$(w,V.startTime-M),F=!1}return F}finally{f=null,p=z,h=!1}}var k=!1,N=null,S=-1,C=5,R=-1;function T(){return!(e.unstable_now()-R<C)}function L(){if(N!==null){var O=e.unstable_now();R=O;var M=!0;try{M=N(!0,O)}finally{M?q():(k=!1,N=null)}}else k=!1}var q;if(typeof x=="function")q=function(){x(L)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,D=E.port2;E.port1.onmessage=L,q=function(){D.postMessage(null)}}else q=function(){_(L,0)};function A(O){N=O,k||(k=!0,q())}function $(O,M){S=_(function(){O(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,A(j))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var M=3;break;default:M=p}var z=p;p=M;try{return O()}finally{p=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,M){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var z=p;p=O;try{return M()}finally{p=z}},e.unstable_scheduleCallback=function(O,M,z){var P=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?P+z:P):z=P,O){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=z+I,O={id:d++,callback:M,priorityLevel:O,startTime:z,expirationTime:I,sortIndex:-1},z>P?(O.sortIndex=z,t(u,O),r(c)===null&&O===r(u)&&(v?(g(S),S=-1):v=!0,$(w,z-P))):(O.sortIndex=I,t(c,O),y||h||(y=!0,A(j))),O},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(O){var M=p;return function(){var z=p;p=M;try{return O.apply(this,arguments)}finally{p=z}}}})(kj);Sj.exports=kj;var L4=Sj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z4=m,Ot=L4;function U(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nj=new Set,di={};function ps(e,t){Qs(e,t),Qs(e+"Capture",t)}function Qs(e,t){for(di[e]=t,e=0;e<t.length;e++)Nj.add(t[e])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Im=Object.prototype.hasOwnProperty,q4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qx={},$x={};function $4(e){return Im.call($x,e)?!0:Im.call(qx,e)?!1:q4.test(e)?$x[e]=!0:(qx[e]=!0,!1)}function F4(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function B4(e,t,r,n){if(t===null||typeof t>"u"||F4(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function bt(e,t,r,n,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){lt[e]=new bt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];lt[t]=new bt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){lt[e]=new bt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){lt[e]=new bt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){lt[e]=new bt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){lt[e]=new bt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){lt[e]=new bt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){lt[e]=new bt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){lt[e]=new bt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zg=/[\-:]([a-z])/g;function Jg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zg,Jg);lt[t]=new bt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zg,Jg);lt[t]=new bt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zg,Jg);lt[t]=new bt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){lt[e]=new bt(e,1,!1,e.toLowerCase(),null,!1,!1)});lt.xlinkHref=new bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){lt[e]=new bt(e,1,!1,e.toLowerCase(),null,!0,!0)});function ev(e,t,r,n){var s=lt.hasOwnProperty(t)?lt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(B4(t,r,s,n)&&(r=null),n||s===null?$4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var tn=z4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,na=Symbol.for("react.element"),Es=Symbol.for("react.portal"),Cs=Symbol.for("react.fragment"),tv=Symbol.for("react.strict_mode"),Mm=Symbol.for("react.profiler"),Ej=Symbol.for("react.provider"),Cj=Symbol.for("react.context"),rv=Symbol.for("react.forward_ref"),Pm=Symbol.for("react.suspense"),Am=Symbol.for("react.suspense_list"),nv=Symbol.for("react.memo"),un=Symbol.for("react.lazy"),Rj=Symbol.for("react.offscreen"),Fx=Symbol.iterator;function ko(e){return e===null||typeof e!="object"?null:(e=Fx&&e[Fx]||e["@@iterator"],typeof e=="function"?e:null)}var ze=Object.assign,Vc;function $o(e){if(Vc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Vc=t&&t[1]||""}return`
`+Vc+e}var Uc=!1;function Gc(e,t){if(!e||Uc)return"";Uc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=n.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=a);break}}}finally{Uc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?$o(e):""}function H4(e){switch(e.tag){case 5:return $o(e.type);case 16:return $o("Lazy");case 13:return $o("Suspense");case 19:return $o("SuspenseList");case 0:case 2:case 15:return e=Gc(e.type,!1),e;case 11:return e=Gc(e.type.render,!1),e;case 1:return e=Gc(e.type,!0),e;default:return""}}function Dm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Cs:return"Fragment";case Es:return"Portal";case Mm:return"Profiler";case tv:return"StrictMode";case Pm:return"Suspense";case Am:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Cj:return(e.displayName||"Context")+".Consumer";case Ej:return(e._context.displayName||"Context")+".Provider";case rv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case nv:return t=e.displayName||null,t!==null?t:Dm(e.type)||"Memo";case un:t=e._payload,e=e._init;try{return Dm(e(t))}catch{}}return null}function W4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dm(t);case 8:return t===tv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Pn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Tj(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function V4(e){var t=Tj(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sa(e){e._valueTracker||(e._valueTracker=V4(e))}function Ij(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Tj(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function tl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Om(e,t){var r=t.checked;return ze({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Bx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Pn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Mj(e,t){t=t.checked,t!=null&&ev(e,"checked",t,!1)}function Lm(e,t){Mj(e,t);var r=Pn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?zm(e,t.type,r):t.hasOwnProperty("defaultValue")&&zm(e,t.type,Pn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Hx(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function zm(e,t,r){(t!=="number"||tl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Fo=Array.isArray;function Fs(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Pn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function qm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(U(91));return ze({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(U(92));if(Fo(r)){if(1<r.length)throw Error(U(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Pn(r)}}function Pj(e,t){var r=Pn(t.value),n=Pn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Vx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Aj(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $m(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Aj(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var oa,Dj=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(oa=oa||document.createElement("div"),oa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=oa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U4=["Webkit","ms","Moz","O"];Object.keys(Zo).forEach(function(e){U4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zo[t]=Zo[e]})});function Oj(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Zo.hasOwnProperty(e)&&Zo[e]?(""+t).trim():t+"px"}function Lj(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Oj(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var G4=ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fm(e,t){if(t){if(G4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(U(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(U(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(U(61))}if(t.style!=null&&typeof t.style!="object")throw Error(U(62))}}function Bm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hm=null;function sv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Wm=null,Bs=null,Hs=null;function Ux(e){if(e=Bi(e)){if(typeof Wm!="function")throw Error(U(280));var t=e.stateNode;t&&(t=Xl(t),Wm(e.stateNode,e.type,t))}}function zj(e){Bs?Hs?Hs.push(e):Hs=[e]:Bs=e}function qj(){if(Bs){var e=Bs,t=Hs;if(Hs=Bs=null,Ux(e),t)for(e=0;e<t.length;e++)Ux(t[e])}}function $j(e,t){return e(t)}function Fj(){}var Kc=!1;function Bj(e,t,r){if(Kc)return e(t,r);Kc=!0;try{return $j(e,t,r)}finally{Kc=!1,(Bs!==null||Hs!==null)&&(Fj(),qj())}}function pi(e,t){var r=e.stateNode;if(r===null)return null;var n=Xl(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(U(231,t,typeof r));return r}var Vm=!1;if(Kr)try{var No={};Object.defineProperty(No,"passive",{get:function(){Vm=!0}}),window.addEventListener("test",No,No),window.removeEventListener("test",No,No)}catch{Vm=!1}function K4(e,t,r,n,s,o,i,a,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Jo=!1,rl=null,nl=!1,Um=null,Y4={onError:function(e){Jo=!0,rl=e}};function X4(e,t,r,n,s,o,i,a,c){Jo=!1,rl=null,K4.apply(Y4,arguments)}function Q4(e,t,r,n,s,o,i,a,c){if(X4.apply(this,arguments),Jo){if(Jo){var u=rl;Jo=!1,rl=null}else throw Error(U(198));nl||(nl=!0,Um=u)}}function hs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Hj(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Gx(e){if(hs(e)!==e)throw Error(U(188))}function Z4(e){var t=e.alternate;if(!t){if(t=hs(e),t===null)throw Error(U(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return Gx(s),e;if(o===n)return Gx(s),t;o=o.sibling}throw Error(U(188))}if(r.return!==n.return)r=s,n=o;else{for(var i=!1,a=s.child;a;){if(a===r){i=!0,r=s,n=o;break}if(a===n){i=!0,n=s,r=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===r){i=!0,r=o,n=s;break}if(a===n){i=!0,n=o,r=s;break}a=a.sibling}if(!i)throw Error(U(189))}}if(r.alternate!==n)throw Error(U(190))}if(r.tag!==3)throw Error(U(188));return r.stateNode.current===r?e:t}function Wj(e){return e=Z4(e),e!==null?Vj(e):null}function Vj(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Vj(e);if(t!==null)return t;e=e.sibling}return null}var Uj=Ot.unstable_scheduleCallback,Kx=Ot.unstable_cancelCallback,J4=Ot.unstable_shouldYield,e5=Ot.unstable_requestPaint,Be=Ot.unstable_now,t5=Ot.unstable_getCurrentPriorityLevel,ov=Ot.unstable_ImmediatePriority,Gj=Ot.unstable_UserBlockingPriority,sl=Ot.unstable_NormalPriority,r5=Ot.unstable_LowPriority,Kj=Ot.unstable_IdlePriority,Ul=null,Cr=null;function n5(e){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Ul,e,void 0,(e.current.flags&128)===128)}catch{}}var fr=Math.clz32?Math.clz32:i5,s5=Math.log,o5=Math.LN2;function i5(e){return e>>>=0,e===0?32:31-(s5(e)/o5|0)|0}var ia=64,aa=4194304;function Bo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ol(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,o=e.pingedLanes,i=r&268435455;if(i!==0){var a=i&~s;a!==0?n=Bo(a):(o&=i,o!==0&&(n=Bo(o)))}else i=r&~s,i!==0?n=Bo(i):o!==0&&(n=Bo(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-fr(t),s=1<<r,n|=e[r],t&=~s;return n}function a5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l5(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-fr(o),a=1<<i,c=s[i];c===-1?(!(a&r)||a&n)&&(s[i]=a5(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}function Gm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yj(){var e=ia;return ia<<=1,!(ia&4194240)&&(ia=64),e}function Yc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $i(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-fr(t),e[t]=r}function c5(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-fr(r),o=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~o}}function iv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-fr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var je=0;function Xj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Qj,av,Zj,Jj,eS,Km=!1,la=[],_n=null,jn=null,Sn=null,hi=new Map,mi=new Map,mn=[],u5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yx(e,t){switch(e){case"focusin":case"focusout":_n=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Sn=null;break;case"pointerover":case"pointerout":hi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mi.delete(t.pointerId)}}function Eo(e,t,r,n,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},t!==null&&(t=Bi(t),t!==null&&av(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function d5(e,t,r,n,s){switch(t){case"focusin":return _n=Eo(_n,e,t,r,n,s),!0;case"dragenter":return jn=Eo(jn,e,t,r,n,s),!0;case"mouseover":return Sn=Eo(Sn,e,t,r,n,s),!0;case"pointerover":var o=s.pointerId;return hi.set(o,Eo(hi.get(o)||null,e,t,r,n,s)),!0;case"gotpointercapture":return o=s.pointerId,mi.set(o,Eo(mi.get(o)||null,e,t,r,n,s)),!0}return!1}function tS(e){var t=Xn(e.target);if(t!==null){var r=hs(t);if(r!==null){if(t=r.tag,t===13){if(t=Hj(r),t!==null){e.blockedOn=t,eS(e.priority,function(){Zj(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $a(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ym(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Hm=n,r.target.dispatchEvent(n),Hm=null}else return t=Bi(r),t!==null&&av(t),e.blockedOn=r,!1;t.shift()}return!0}function Xx(e,t,r){$a(e)&&r.delete(t)}function f5(){Km=!1,_n!==null&&$a(_n)&&(_n=null),jn!==null&&$a(jn)&&(jn=null),Sn!==null&&$a(Sn)&&(Sn=null),hi.forEach(Xx),mi.forEach(Xx)}function Co(e,t){e.blockedOn===t&&(e.blockedOn=null,Km||(Km=!0,Ot.unstable_scheduleCallback(Ot.unstable_NormalPriority,f5)))}function gi(e){function t(s){return Co(s,e)}if(0<la.length){Co(la[0],e);for(var r=1;r<la.length;r++){var n=la[r];n.blockedOn===e&&(n.blockedOn=null)}}for(_n!==null&&Co(_n,e),jn!==null&&Co(jn,e),Sn!==null&&Co(Sn,e),hi.forEach(t),mi.forEach(t),r=0;r<mn.length;r++)n=mn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<mn.length&&(r=mn[0],r.blockedOn===null);)tS(r),r.blockedOn===null&&mn.shift()}var Ws=tn.ReactCurrentBatchConfig,il=!0;function p5(e,t,r,n){var s=je,o=Ws.transition;Ws.transition=null;try{je=1,lv(e,t,r,n)}finally{je=s,Ws.transition=o}}function h5(e,t,r,n){var s=je,o=Ws.transition;Ws.transition=null;try{je=4,lv(e,t,r,n)}finally{je=s,Ws.transition=o}}function lv(e,t,r,n){if(il){var s=Ym(e,t,r,n);if(s===null)ou(e,t,n,al,r),Yx(e,n);else if(d5(s,e,t,r,n))n.stopPropagation();else if(Yx(e,n),t&4&&-1<u5.indexOf(e)){for(;s!==null;){var o=Bi(s);if(o!==null&&Qj(o),o=Ym(e,t,r,n),o===null&&ou(e,t,n,al,r),o===s)break;s=o}s!==null&&n.stopPropagation()}else ou(e,t,n,null,r)}}var al=null;function Ym(e,t,r,n){if(al=null,e=sv(n),e=Xn(e),e!==null)if(t=hs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Hj(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return al=e,null}function rS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t5()){case ov:return 1;case Gj:return 4;case sl:case r5:return 16;case Kj:return 536870912;default:return 16}default:return 16}}var bn=null,cv=null,Fa=null;function nS(){if(Fa)return Fa;var e,t=cv,r=t.length,n,s="value"in bn?bn.value:bn.textContent,o=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[o-n];n++);return Fa=s.slice(e,1<n?1-n:void 0)}function Ba(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ca(){return!0}function Qx(){return!1}function qt(e){function t(r,n,s,o,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ca:Qx,this.isPropagationStopped=Qx,this}return ze(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ca)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ca)},persist:function(){},isPersistent:ca}),t}var uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uv=qt(uo),Fi=ze({},uo,{view:0,detail:0}),m5=qt(Fi),Xc,Qc,Ro,Gl=ze({},Fi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ro&&(Ro&&e.type==="mousemove"?(Xc=e.screenX-Ro.screenX,Qc=e.screenY-Ro.screenY):Qc=Xc=0,Ro=e),Xc)},movementY:function(e){return"movementY"in e?e.movementY:Qc}}),Zx=qt(Gl),g5=ze({},Gl,{dataTransfer:0}),v5=qt(g5),x5=ze({},Fi,{relatedTarget:0}),Zc=qt(x5),y5=ze({},uo,{animationName:0,elapsedTime:0,pseudoElement:0}),b5=qt(y5),w5=ze({},uo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_5=qt(w5),j5=ze({},uo,{data:0}),Jx=qt(j5),S5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},k5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function E5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=N5[e])?!!t[e]:!1}function dv(){return E5}var C5=ze({},Fi,{key:function(e){if(e.key){var t=S5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ba(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?k5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dv,charCode:function(e){return e.type==="keypress"?Ba(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ba(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),R5=qt(C5),T5=ze({},Gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ey=qt(T5),I5=ze({},Fi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dv}),M5=qt(I5),P5=ze({},uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),A5=qt(P5),D5=ze({},Gl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),O5=qt(D5),L5=[9,13,27,32],fv=Kr&&"CompositionEvent"in window,ei=null;Kr&&"documentMode"in document&&(ei=document.documentMode);var z5=Kr&&"TextEvent"in window&&!ei,sS=Kr&&(!fv||ei&&8<ei&&11>=ei),ty=" ",ry=!1;function oS(e,t){switch(e){case"keyup":return L5.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Rs=!1;function q5(e,t){switch(e){case"compositionend":return iS(t);case"keypress":return t.which!==32?null:(ry=!0,ty);case"textInput":return e=t.data,e===ty&&ry?null:e;default:return null}}function $5(e,t){if(Rs)return e==="compositionend"||!fv&&oS(e,t)?(e=nS(),Fa=cv=bn=null,Rs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sS&&t.locale!=="ko"?null:t.data;default:return null}}var F5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ny(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!F5[e.type]:t==="textarea"}function aS(e,t,r,n){zj(n),t=ll(t,"onChange"),0<t.length&&(r=new uv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ti=null,vi=null;function B5(e){xS(e,0)}function Kl(e){var t=Ms(e);if(Ij(t))return e}function H5(e,t){if(e==="change")return t}var lS=!1;if(Kr){var Jc;if(Kr){var eu="oninput"in document;if(!eu){var sy=document.createElement("div");sy.setAttribute("oninput","return;"),eu=typeof sy.oninput=="function"}Jc=eu}else Jc=!1;lS=Jc&&(!document.documentMode||9<document.documentMode)}function oy(){ti&&(ti.detachEvent("onpropertychange",cS),vi=ti=null)}function cS(e){if(e.propertyName==="value"&&Kl(vi)){var t=[];aS(t,vi,e,sv(e)),Bj(B5,t)}}function W5(e,t,r){e==="focusin"?(oy(),ti=t,vi=r,ti.attachEvent("onpropertychange",cS)):e==="focusout"&&oy()}function V5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kl(vi)}function U5(e,t){if(e==="click")return Kl(t)}function G5(e,t){if(e==="input"||e==="change")return Kl(t)}function K5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hr=typeof Object.is=="function"?Object.is:K5;function xi(e,t){if(hr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Im.call(t,s)||!hr(e[s],t[s]))return!1}return!0}function iy(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ay(e,t){var r=iy(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=iy(r)}}function uS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?uS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function dS(){for(var e=window,t=tl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=tl(e.document)}return t}function pv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Y5(e){var t=dS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&uS(r.ownerDocument.documentElement,r)){if(n!==null&&pv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,o=Math.min(n.start,s);n=n.end===void 0?o:Math.min(n.end,s),!e.extend&&o>n&&(s=n,n=o,o=s),s=ay(r,o);var i=ay(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var X5=Kr&&"documentMode"in document&&11>=document.documentMode,Ts=null,Xm=null,ri=null,Qm=!1;function ly(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Qm||Ts==null||Ts!==tl(n)||(n=Ts,"selectionStart"in n&&pv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ri&&xi(ri,n)||(ri=n,n=ll(Xm,"onSelect"),0<n.length&&(t=new uv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ts)))}function ua(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Is={animationend:ua("Animation","AnimationEnd"),animationiteration:ua("Animation","AnimationIteration"),animationstart:ua("Animation","AnimationStart"),transitionend:ua("Transition","TransitionEnd")},tu={},fS={};Kr&&(fS=document.createElement("div").style,"AnimationEvent"in window||(delete Is.animationend.animation,delete Is.animationiteration.animation,delete Is.animationstart.animation),"TransitionEvent"in window||delete Is.transitionend.transition);function Yl(e){if(tu[e])return tu[e];if(!Is[e])return e;var t=Is[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in fS)return tu[e]=t[r];return e}var pS=Yl("animationend"),hS=Yl("animationiteration"),mS=Yl("animationstart"),gS=Yl("transitionend"),vS=new Map,cy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function On(e,t){vS.set(e,t),ps(t,[e])}for(var ru=0;ru<cy.length;ru++){var nu=cy[ru],Q5=nu.toLowerCase(),Z5=nu[0].toUpperCase()+nu.slice(1);On(Q5,"on"+Z5)}On(pS,"onAnimationEnd");On(hS,"onAnimationIteration");On(mS,"onAnimationStart");On("dblclick","onDoubleClick");On("focusin","onFocus");On("focusout","onBlur");On(gS,"onTransitionEnd");Qs("onMouseEnter",["mouseout","mouseover"]);Qs("onMouseLeave",["mouseout","mouseover"]);Qs("onPointerEnter",["pointerout","pointerover"]);Qs("onPointerLeave",["pointerout","pointerover"]);ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),J5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ho));function uy(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Q4(n,t,void 0,e),e.currentTarget=null}function xS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var i=n.length-1;0<=i;i--){var a=n[i],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==o&&s.isPropagationStopped())break e;uy(s,a,u),o=c}else for(i=0;i<n.length;i++){if(a=n[i],c=a.instance,u=a.currentTarget,a=a.listener,c!==o&&s.isPropagationStopped())break e;uy(s,a,u),o=c}}}if(nl)throw e=Um,nl=!1,Um=null,e}function Re(e,t){var r=t[rg];r===void 0&&(r=t[rg]=new Set);var n=e+"__bubble";r.has(n)||(yS(t,e,2,!1),r.add(n))}function su(e,t,r){var n=0;t&&(n|=4),yS(r,e,n,t)}var da="_reactListening"+Math.random().toString(36).slice(2);function yi(e){if(!e[da]){e[da]=!0,Nj.forEach(function(r){r!=="selectionchange"&&(J5.has(r)||su(r,!1,e),su(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[da]||(t[da]=!0,su("selectionchange",!1,t))}}function yS(e,t,r,n){switch(rS(t)){case 1:var s=p5;break;case 4:s=h5;break;default:s=lv}r=s.bind(null,t,r,e),s=void 0,!Vm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function ou(e,t,r,n,s){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;a!==null;){if(i=Xn(a),i===null)return;if(c=i.tag,c===5||c===6){n=o=i;continue e}a=a.parentNode}}n=n.return}Bj(function(){var u=o,d=sv(r),f=[];e:{var p=vS.get(e);if(p!==void 0){var h=uv,y=e;switch(e){case"keypress":if(Ba(r)===0)break e;case"keydown":case"keyup":h=R5;break;case"focusin":y="focus",h=Zc;break;case"focusout":y="blur",h=Zc;break;case"beforeblur":case"afterblur":h=Zc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Zx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=v5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=M5;break;case pS:case hS:case mS:h=b5;break;case gS:h=A5;break;case"scroll":h=m5;break;case"wheel":h=O5;break;case"copy":case"cut":case"paste":h=_5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=ey}var v=(t&4)!==0,_=!v&&e==="scroll",g=v?p!==null?p+"Capture":null:p;v=[];for(var x=u,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,g!==null&&(w=pi(x,g),w!=null&&v.push(bi(x,w,b)))),_)break;x=x.return}0<v.length&&(p=new h(p,y,null,r,d),f.push({event:p,listeners:v}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Hm&&(y=r.relatedTarget||r.fromElement)&&(Xn(y)||y[Yr]))break e;if((h||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,h?(y=r.relatedTarget||r.toElement,h=u,y=y?Xn(y):null,y!==null&&(_=hs(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=u),h!==y)){if(v=Zx,w="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(v=ey,w="onPointerLeave",g="onPointerEnter",x="pointer"),_=h==null?p:Ms(h),b=y==null?p:Ms(y),p=new v(w,x+"leave",h,r,d),p.target=_,p.relatedTarget=b,w=null,Xn(d)===u&&(v=new v(g,x+"enter",y,r,d),v.target=b,v.relatedTarget=_,w=v),_=w,h&&y)t:{for(v=h,g=y,x=0,b=v;b;b=bs(b))x++;for(b=0,w=g;w;w=bs(w))b++;for(;0<x-b;)v=bs(v),x--;for(;0<b-x;)g=bs(g),b--;for(;x--;){if(v===g||g!==null&&v===g.alternate)break t;v=bs(v),g=bs(g)}v=null}else v=null;h!==null&&dy(f,p,h,v,!1),y!==null&&_!==null&&dy(f,_,y,v,!0)}}e:{if(p=u?Ms(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var j=H5;else if(ny(p))if(lS)j=G5;else{j=V5;var k=W5}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(j=U5);if(j&&(j=j(e,u))){aS(f,j,r,d);break e}k&&k(e,p,u),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&zm(p,"number",p.value)}switch(k=u?Ms(u):window,e){case"focusin":(ny(k)||k.contentEditable==="true")&&(Ts=k,Xm=u,ri=null);break;case"focusout":ri=Xm=Ts=null;break;case"mousedown":Qm=!0;break;case"contextmenu":case"mouseup":case"dragend":Qm=!1,ly(f,r,d);break;case"selectionchange":if(X5)break;case"keydown":case"keyup":ly(f,r,d)}var N;if(fv)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Rs?oS(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(sS&&r.locale!=="ko"&&(Rs||S!=="onCompositionStart"?S==="onCompositionEnd"&&Rs&&(N=nS()):(bn=d,cv="value"in bn?bn.value:bn.textContent,Rs=!0)),k=ll(u,S),0<k.length&&(S=new Jx(S,e,null,r,d),f.push({event:S,listeners:k}),N?S.data=N:(N=iS(r),N!==null&&(S.data=N)))),(N=z5?q5(e,r):$5(e,r))&&(u=ll(u,"onBeforeInput"),0<u.length&&(d=new Jx("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=N))}xS(f,t)})}function bi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ll(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=pi(e,r),o!=null&&n.unshift(bi(e,o,s)),o=pi(e,t),o!=null&&n.push(bi(e,o,s))),e=e.return}return n}function bs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function dy(e,t,r,n,s){for(var o=t._reactName,i=[];r!==null&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&u!==null&&(a=u,s?(c=pi(r,o),c!=null&&i.unshift(bi(r,c,a))):s||(c=pi(r,o),c!=null&&i.push(bi(r,c,a)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var eR=/\r\n?/g,tR=/\u0000|\uFFFD/g;function fy(e){return(typeof e=="string"?e:""+e).replace(eR,`
`).replace(tR,"")}function fa(e,t,r){if(t=fy(t),fy(e)!==t&&r)throw Error(U(425))}function cl(){}var Zm=null,Jm=null;function eg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var tg=typeof setTimeout=="function"?setTimeout:void 0,rR=typeof clearTimeout=="function"?clearTimeout:void 0,py=typeof Promise=="function"?Promise:void 0,nR=typeof queueMicrotask=="function"?queueMicrotask:typeof py<"u"?function(e){return py.resolve(null).then(e).catch(sR)}:tg;function sR(e){setTimeout(function(){throw e})}function iu(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),gi(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);gi(t)}function kn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var fo=Math.random().toString(36).slice(2),Nr="__reactFiber$"+fo,wi="__reactProps$"+fo,Yr="__reactContainer$"+fo,rg="__reactEvents$"+fo,oR="__reactListeners$"+fo,iR="__reactHandles$"+fo;function Xn(e){var t=e[Nr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Yr]||r[Nr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=hy(e);e!==null;){if(r=e[Nr])return r;e=hy(e)}return t}e=r,r=e.parentNode}return null}function Bi(e){return e=e[Nr]||e[Yr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ms(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(U(33))}function Xl(e){return e[wi]||null}var ng=[],Ps=-1;function Ln(e){return{current:e}}function Te(e){0>Ps||(e.current=ng[Ps],ng[Ps]=null,Ps--)}function Ne(e,t){Ps++,ng[Ps]=e.current,e.current=t}var An={},ft=Ln(An),kt=Ln(!1),is=An;function Zs(e,t){var r=e.type.contextTypes;if(!r)return An;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Nt(e){return e=e.childContextTypes,e!=null}function ul(){Te(kt),Te(ft)}function my(e,t,r){if(ft.current!==An)throw Error(U(168));Ne(ft,t),Ne(kt,r)}function bS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(U(108,W4(e)||"Unknown",s));return ze({},r,n)}function dl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||An,is=ft.current,Ne(ft,e),Ne(kt,kt.current),!0}function gy(e,t,r){var n=e.stateNode;if(!n)throw Error(U(169));r?(e=bS(e,t,is),n.__reactInternalMemoizedMergedChildContext=e,Te(kt),Te(ft),Ne(ft,e)):Te(kt),Ne(kt,r)}var $r=null,Ql=!1,au=!1;function wS(e){$r===null?$r=[e]:$r.push(e)}function aR(e){Ql=!0,wS(e)}function zn(){if(!au&&$r!==null){au=!0;var e=0,t=je;try{var r=$r;for(je=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}$r=null,Ql=!1}catch(s){throw $r!==null&&($r=$r.slice(e+1)),Uj(ov,zn),s}finally{je=t,au=!1}}return null}var As=[],Ds=0,fl=null,pl=0,Ut=[],Gt=0,as=null,Fr=1,Br="";function Un(e,t){As[Ds++]=pl,As[Ds++]=fl,fl=e,pl=t}function _S(e,t,r){Ut[Gt++]=Fr,Ut[Gt++]=Br,Ut[Gt++]=as,as=e;var n=Fr;e=Br;var s=32-fr(n)-1;n&=~(1<<s),r+=1;var o=32-fr(t)+s;if(30<o){var i=s-s%5;o=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Fr=1<<32-fr(t)+s|r<<s|n,Br=o+e}else Fr=1<<o|r<<s|n,Br=e}function hv(e){e.return!==null&&(Un(e,1),_S(e,1,0))}function mv(e){for(;e===fl;)fl=As[--Ds],As[Ds]=null,pl=As[--Ds],As[Ds]=null;for(;e===as;)as=Ut[--Gt],Ut[Gt]=null,Br=Ut[--Gt],Ut[Gt]=null,Fr=Ut[--Gt],Ut[Gt]=null}var Dt=null,At=null,Me=!1,ur=null;function jS(e,t){var r=Yt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function vy(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dt=e,At=kn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dt=e,At=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=as!==null?{id:Fr,overflow:Br}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Yt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Dt=e,At=null,!0):!1;default:return!1}}function sg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function og(e){if(Me){var t=At;if(t){var r=t;if(!vy(e,t)){if(sg(e))throw Error(U(418));t=kn(r.nextSibling);var n=Dt;t&&vy(e,t)?jS(n,r):(e.flags=e.flags&-4097|2,Me=!1,Dt=e)}}else{if(sg(e))throw Error(U(418));e.flags=e.flags&-4097|2,Me=!1,Dt=e}}}function xy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dt=e}function pa(e){if(e!==Dt)return!1;if(!Me)return xy(e),Me=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!eg(e.type,e.memoizedProps)),t&&(t=At)){if(sg(e))throw SS(),Error(U(418));for(;t;)jS(e,t),t=kn(t.nextSibling)}if(xy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(U(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){At=kn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}At=null}}else At=Dt?kn(e.stateNode.nextSibling):null;return!0}function SS(){for(var e=At;e;)e=kn(e.nextSibling)}function Js(){At=Dt=null,Me=!1}function gv(e){ur===null?ur=[e]:ur.push(e)}var lR=tn.ReactCurrentBatchConfig;function To(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(U(309));var n=r.stateNode}if(!n)throw Error(U(147,e));var s=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(U(284));if(!r._owner)throw Error(U(290,e))}return e}function ha(e,t){throw e=Object.prototype.toString.call(t),Error(U(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yy(e){var t=e._init;return t(e._payload)}function kS(e){function t(g,x){if(e){var b=g.deletions;b===null?(g.deletions=[x],g.flags|=16):b.push(x)}}function r(g,x){if(!e)return null;for(;x!==null;)t(g,x),x=x.sibling;return null}function n(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function s(g,x){return g=Rn(g,x),g.index=0,g.sibling=null,g}function o(g,x,b){return g.index=b,e?(b=g.alternate,b!==null?(b=b.index,b<x?(g.flags|=2,x):b):(g.flags|=2,x)):(g.flags|=1048576,x)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function a(g,x,b,w){return x===null||x.tag!==6?(x=hu(b,g.mode,w),x.return=g,x):(x=s(x,b),x.return=g,x)}function c(g,x,b,w){var j=b.type;return j===Cs?d(g,x,b.props.children,w,b.key):x!==null&&(x.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===un&&yy(j)===x.type)?(w=s(x,b.props),w.ref=To(g,x,b),w.return=g,w):(w=Ya(b.type,b.key,b.props,null,g.mode,w),w.ref=To(g,x,b),w.return=g,w)}function u(g,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=mu(b,g.mode,w),x.return=g,x):(x=s(x,b.children||[]),x.return=g,x)}function d(g,x,b,w,j){return x===null||x.tag!==7?(x=ns(b,g.mode,w,j),x.return=g,x):(x=s(x,b),x.return=g,x)}function f(g,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=hu(""+x,g.mode,b),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case na:return b=Ya(x.type,x.key,x.props,null,g.mode,b),b.ref=To(g,null,x),b.return=g,b;case Es:return x=mu(x,g.mode,b),x.return=g,x;case un:var w=x._init;return f(g,w(x._payload),b)}if(Fo(x)||ko(x))return x=ns(x,g.mode,b,null),x.return=g,x;ha(g,x)}return null}function p(g,x,b,w){var j=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:a(g,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case na:return b.key===j?c(g,x,b,w):null;case Es:return b.key===j?u(g,x,b,w):null;case un:return j=b._init,p(g,x,j(b._payload),w)}if(Fo(b)||ko(b))return j!==null?null:d(g,x,b,w,null);ha(g,b)}return null}function h(g,x,b,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(b)||null,a(x,g,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case na:return g=g.get(w.key===null?b:w.key)||null,c(x,g,w,j);case Es:return g=g.get(w.key===null?b:w.key)||null,u(x,g,w,j);case un:var k=w._init;return h(g,x,b,k(w._payload),j)}if(Fo(w)||ko(w))return g=g.get(b)||null,d(x,g,w,j,null);ha(x,w)}return null}function y(g,x,b,w){for(var j=null,k=null,N=x,S=x=0,C=null;N!==null&&S<b.length;S++){N.index>S?(C=N,N=null):C=N.sibling;var R=p(g,N,b[S],w);if(R===null){N===null&&(N=C);break}e&&N&&R.alternate===null&&t(g,N),x=o(R,x,S),k===null?j=R:k.sibling=R,k=R,N=C}if(S===b.length)return r(g,N),Me&&Un(g,S),j;if(N===null){for(;S<b.length;S++)N=f(g,b[S],w),N!==null&&(x=o(N,x,S),k===null?j=N:k.sibling=N,k=N);return Me&&Un(g,S),j}for(N=n(g,N);S<b.length;S++)C=h(N,g,S,b[S],w),C!==null&&(e&&C.alternate!==null&&N.delete(C.key===null?S:C.key),x=o(C,x,S),k===null?j=C:k.sibling=C,k=C);return e&&N.forEach(function(T){return t(g,T)}),Me&&Un(g,S),j}function v(g,x,b,w){var j=ko(b);if(typeof j!="function")throw Error(U(150));if(b=j.call(b),b==null)throw Error(U(151));for(var k=j=null,N=x,S=x=0,C=null,R=b.next();N!==null&&!R.done;S++,R=b.next()){N.index>S?(C=N,N=null):C=N.sibling;var T=p(g,N,R.value,w);if(T===null){N===null&&(N=C);break}e&&N&&T.alternate===null&&t(g,N),x=o(T,x,S),k===null?j=T:k.sibling=T,k=T,N=C}if(R.done)return r(g,N),Me&&Un(g,S),j;if(N===null){for(;!R.done;S++,R=b.next())R=f(g,R.value,w),R!==null&&(x=o(R,x,S),k===null?j=R:k.sibling=R,k=R);return Me&&Un(g,S),j}for(N=n(g,N);!R.done;S++,R=b.next())R=h(N,g,S,R.value,w),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?S:R.key),x=o(R,x,S),k===null?j=R:k.sibling=R,k=R);return e&&N.forEach(function(L){return t(g,L)}),Me&&Un(g,S),j}function _(g,x,b,w){if(typeof b=="object"&&b!==null&&b.type===Cs&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case na:e:{for(var j=b.key,k=x;k!==null;){if(k.key===j){if(j=b.type,j===Cs){if(k.tag===7){r(g,k.sibling),x=s(k,b.props.children),x.return=g,g=x;break e}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===un&&yy(j)===k.type){r(g,k.sibling),x=s(k,b.props),x.ref=To(g,k,b),x.return=g,g=x;break e}r(g,k);break}else t(g,k);k=k.sibling}b.type===Cs?(x=ns(b.props.children,g.mode,w,b.key),x.return=g,g=x):(w=Ya(b.type,b.key,b.props,null,g.mode,w),w.ref=To(g,x,b),w.return=g,g=w)}return i(g);case Es:e:{for(k=b.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){r(g,x.sibling),x=s(x,b.children||[]),x.return=g,g=x;break e}else{r(g,x);break}else t(g,x);x=x.sibling}x=mu(b,g.mode,w),x.return=g,g=x}return i(g);case un:return k=b._init,_(g,x,k(b._payload),w)}if(Fo(b))return y(g,x,b,w);if(ko(b))return v(g,x,b,w);ha(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(r(g,x.sibling),x=s(x,b),x.return=g,g=x):(r(g,x),x=hu(b,g.mode,w),x.return=g,g=x),i(g)):r(g,x)}return _}var eo=kS(!0),NS=kS(!1),hl=Ln(null),ml=null,Os=null,vv=null;function xv(){vv=Os=ml=null}function yv(e){var t=hl.current;Te(hl),e._currentValue=t}function ig(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Vs(e,t){ml=e,vv=Os=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(jt=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(vv!==e)if(e={context:e,memoizedValue:t,next:null},Os===null){if(ml===null)throw Error(U(308));Os=e,ml.dependencies={lanes:0,firstContext:e}}else Os=Os.next=e;return t}var Qn=null;function bv(e){Qn===null?Qn=[e]:Qn.push(e)}function ES(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,bv(t)):(r.next=s.next,s.next=r),t.interleaved=r,Xr(e,n)}function Xr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var dn=!1;function wv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ur(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ve&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Xr(e,r)}return s=n.interleaved,s===null?(t.next=t,bv(n)):(t.next=s.next,s.next=t),n.interleaved=t,Xr(e,r)}function Ha(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,iv(e,r)}}function by(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?s=o=t:o=o.next=t}else s=o=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function gl(e,t,r,n){var s=e.updateQueue;dn=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,u=c.next;c.next=null,i===null?o=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==i&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;i=0,d=u=c=null,a=o;do{var p=a.lane,h=a.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,v=a;switch(p=t,h=r,v.tag){case 1:if(y=v.payload,typeof y=="function"){f=y.call(h,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,p=typeof y=="function"?y.call(h,f,p):y,p==null)break e;f=ze({},f,p);break e;case 2:dn=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else h={eventTime:h,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,i|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);cs|=i,e.lanes=i,e.memoizedState=f}}function wy(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(U(191,s));s.call(n)}}}var Hi={},Rr=Ln(Hi),_i=Ln(Hi),ji=Ln(Hi);function Zn(e){if(e===Hi)throw Error(U(174));return e}function _v(e,t){switch(Ne(ji,t),Ne(_i,e),Ne(Rr,Hi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$m(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$m(t,e)}Te(Rr),Ne(Rr,t)}function to(){Te(Rr),Te(_i),Te(ji)}function RS(e){Zn(ji.current);var t=Zn(Rr.current),r=$m(t,e.type);t!==r&&(Ne(_i,e),Ne(Rr,r))}function jv(e){_i.current===e&&(Te(Rr),Te(_i))}var Oe=Ln(0);function vl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lu=[];function Sv(){for(var e=0;e<lu.length;e++)lu[e]._workInProgressVersionPrimary=null;lu.length=0}var Wa=tn.ReactCurrentDispatcher,cu=tn.ReactCurrentBatchConfig,ls=0,Le=null,Ke=null,Je=null,xl=!1,ni=!1,Si=0,cR=0;function ct(){throw Error(U(321))}function kv(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!hr(e[r],t[r]))return!1;return!0}function Nv(e,t,r,n,s,o){if(ls=o,Le=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Wa.current=e===null||e.memoizedState===null?pR:hR,e=r(n,s),ni){o=0;do{if(ni=!1,Si=0,25<=o)throw Error(U(301));o+=1,Je=Ke=null,t.updateQueue=null,Wa.current=mR,e=r(n,s)}while(ni)}if(Wa.current=yl,t=Ke!==null&&Ke.next!==null,ls=0,Je=Ke=Le=null,xl=!1,t)throw Error(U(300));return e}function Ev(){var e=Si!==0;return Si=0,e}function kr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?Le.memoizedState=Je=e:Je=Je.next=e,Je}function Jt(){if(Ke===null){var e=Le.alternate;e=e!==null?e.memoizedState:null}else e=Ke.next;var t=Je===null?Le.memoizedState:Je.next;if(t!==null)Je=t,Ke=e;else{if(e===null)throw Error(U(310));Ke=e,e={memoizedState:Ke.memoizedState,baseState:Ke.baseState,baseQueue:Ke.baseQueue,queue:Ke.queue,next:null},Je===null?Le.memoizedState=Je=e:Je=Je.next=e}return Je}function ki(e,t){return typeof t=="function"?t(e):t}function uu(e){var t=Jt(),r=t.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=e;var n=Ke,s=n.baseQueue,o=r.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}n.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,n=n.baseState;var a=i=null,c=null,u=o;do{var d=u.lane;if((ls&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=f,i=n):c=c.next=f,Le.lanes|=d,cs|=d}u=u.next}while(u!==null&&u!==o);c===null?i=n:c.next=a,hr(n,t.memoizedState)||(jt=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do o=s.lane,Le.lanes|=o,cs|=o,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function du(e){var t=Jt(),r=t.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,o=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);hr(o,t.memoizedState)||(jt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function TS(){}function IS(e,t){var r=Le,n=Jt(),s=t(),o=!hr(n.memoizedState,s);if(o&&(n.memoizedState=s,jt=!0),n=n.queue,Cv(AS.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Je!==null&&Je.memoizedState.tag&1){if(r.flags|=2048,Ni(9,PS.bind(null,r,n,s,t),void 0,null),tt===null)throw Error(U(349));ls&30||MS(r,t,s)}return s}function MS(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Le.updateQueue,t===null?(t={lastEffect:null,stores:null},Le.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function PS(e,t,r,n){t.value=r,t.getSnapshot=n,DS(t)&&OS(e)}function AS(e,t,r){return r(function(){DS(t)&&OS(e)})}function DS(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!hr(e,r)}catch{return!0}}function OS(e){var t=Xr(e,1);t!==null&&pr(t,e,1,-1)}function _y(e){var t=kr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ki,lastRenderedState:e},t.queue=e,e=e.dispatch=fR.bind(null,Le,e),[t.memoizedState,e]}function Ni(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Le.updateQueue,t===null?(t={lastEffect:null,stores:null},Le.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function LS(){return Jt().memoizedState}function Va(e,t,r,n){var s=kr();Le.flags|=e,s.memoizedState=Ni(1|t,r,void 0,n===void 0?null:n)}function Zl(e,t,r,n){var s=Jt();n=n===void 0?null:n;var o=void 0;if(Ke!==null){var i=Ke.memoizedState;if(o=i.destroy,n!==null&&kv(n,i.deps)){s.memoizedState=Ni(t,r,o,n);return}}Le.flags|=e,s.memoizedState=Ni(1|t,r,o,n)}function jy(e,t){return Va(8390656,8,e,t)}function Cv(e,t){return Zl(2048,8,e,t)}function zS(e,t){return Zl(4,2,e,t)}function qS(e,t){return Zl(4,4,e,t)}function $S(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function FS(e,t,r){return r=r!=null?r.concat([e]):null,Zl(4,4,$S.bind(null,t,e),r)}function Rv(){}function BS(e,t){var r=Jt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kv(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function HS(e,t){var r=Jt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kv(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function WS(e,t,r){return ls&21?(hr(r,t)||(r=Yj(),Le.lanes|=r,cs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,jt=!0),e.memoizedState=r)}function uR(e,t){var r=je;je=r!==0&&4>r?r:4,e(!0);var n=cu.transition;cu.transition={};try{e(!1),t()}finally{je=r,cu.transition=n}}function VS(){return Jt().memoizedState}function dR(e,t,r){var n=Cn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},US(e))GS(t,r);else if(r=ES(e,t,r,n),r!==null){var s=xt();pr(r,e,n,s),KS(r,t,n)}}function fR(e,t,r){var n=Cn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(US(e))GS(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,a=o(i,r);if(s.hasEagerState=!0,s.eagerState=a,hr(a,i)){var c=t.interleaved;c===null?(s.next=s,bv(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=ES(e,t,s,n),r!==null&&(s=xt(),pr(r,e,n,s),KS(r,t,n))}}function US(e){var t=e.alternate;return e===Le||t!==null&&t===Le}function GS(e,t){ni=xl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function KS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,iv(e,r)}}var yl={readContext:Zt,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},pR={readContext:Zt,useCallback:function(e,t){return kr().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:jy,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Va(4194308,4,$S.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Va(4194308,4,e,t)},useInsertionEffect:function(e,t){return Va(4,2,e,t)},useMemo:function(e,t){var r=kr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=kr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=dR.bind(null,Le,e),[n.memoizedState,e]},useRef:function(e){var t=kr();return e={current:e},t.memoizedState=e},useState:_y,useDebugValue:Rv,useDeferredValue:function(e){return kr().memoizedState=e},useTransition:function(){var e=_y(!1),t=e[0];return e=uR.bind(null,e[1]),kr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Le,s=kr();if(Me){if(r===void 0)throw Error(U(407));r=r()}else{if(r=t(),tt===null)throw Error(U(349));ls&30||MS(n,t,r)}s.memoizedState=r;var o={value:r,getSnapshot:t};return s.queue=o,jy(AS.bind(null,n,o,e),[e]),n.flags|=2048,Ni(9,PS.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=kr(),t=tt.identifierPrefix;if(Me){var r=Br,n=Fr;r=(n&~(1<<32-fr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Si++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=cR++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hR={readContext:Zt,useCallback:BS,useContext:Zt,useEffect:Cv,useImperativeHandle:FS,useInsertionEffect:zS,useLayoutEffect:qS,useMemo:HS,useReducer:uu,useRef:LS,useState:function(){return uu(ki)},useDebugValue:Rv,useDeferredValue:function(e){var t=Jt();return WS(t,Ke.memoizedState,e)},useTransition:function(){var e=uu(ki)[0],t=Jt().memoizedState;return[e,t]},useMutableSource:TS,useSyncExternalStore:IS,useId:VS,unstable_isNewReconciler:!1},mR={readContext:Zt,useCallback:BS,useContext:Zt,useEffect:Cv,useImperativeHandle:FS,useInsertionEffect:zS,useLayoutEffect:qS,useMemo:HS,useReducer:du,useRef:LS,useState:function(){return du(ki)},useDebugValue:Rv,useDeferredValue:function(e){var t=Jt();return Ke===null?t.memoizedState=e:WS(t,Ke.memoizedState,e)},useTransition:function(){var e=du(ki)[0],t=Jt().memoizedState;return[e,t]},useMutableSource:TS,useSyncExternalStore:IS,useId:VS,unstable_isNewReconciler:!1};function ar(e,t){if(e&&e.defaultProps){t=ze({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ag(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ze({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Jl={isMounted:function(e){return(e=e._reactInternals)?hs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=xt(),s=Cn(e),o=Ur(n,s);o.payload=t,r!=null&&(o.callback=r),t=Nn(e,o,s),t!==null&&(pr(t,e,s,n),Ha(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=xt(),s=Cn(e),o=Ur(n,s);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=Nn(e,o,s),t!==null&&(pr(t,e,s,n),Ha(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=xt(),n=Cn(e),s=Ur(r,n);s.tag=2,t!=null&&(s.callback=t),t=Nn(e,s,n),t!==null&&(pr(t,e,n,r),Ha(t,e,n))}};function Sy(e,t,r,n,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,i):t.prototype&&t.prototype.isPureReactComponent?!xi(r,n)||!xi(s,o):!0}function YS(e,t,r){var n=!1,s=An,o=t.contextType;return typeof o=="object"&&o!==null?o=Zt(o):(s=Nt(t)?is:ft.current,n=t.contextTypes,o=(n=n!=null)?Zs(e,s):An),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Jl,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function ky(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Jl.enqueueReplaceState(t,t.state,null)}function lg(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},wv(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Zt(o):(o=Nt(t)?is:ft.current,s.context=Zs(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(ag(e,t,o,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Jl.enqueueReplaceState(s,s.state,null),gl(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ro(e,t){try{var r="",n=t;do r+=H4(n),n=n.return;while(n);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function fu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function cg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var gR=typeof WeakMap=="function"?WeakMap:Map;function XS(e,t,r){r=Ur(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){wl||(wl=!0,yg=n),cg(e,t)},r}function QS(e,t,r){r=Ur(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){cg(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){cg(e,t),typeof n!="function"&&(En===null?En=new Set([this]):En.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Ny(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new gR;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=TR.bind(null,e,t,r),t.then(e,e))}function Ey(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Cy(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ur(-1,1),t.tag=2,Nn(r,t,1))),r.lanes|=1),e)}var vR=tn.ReactCurrentOwner,jt=!1;function vt(e,t,r,n){t.child=e===null?NS(t,null,r,n):eo(t,e.child,r,n)}function Ry(e,t,r,n,s){r=r.render;var o=t.ref;return Vs(t,s),n=Nv(e,t,r,n,o,s),r=Ev(),e!==null&&!jt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Qr(e,t,s)):(Me&&r&&hv(t),t.flags|=1,vt(e,t,n,s),t.child)}function Ty(e,t,r,n,s){if(e===null){var o=r.type;return typeof o=="function"&&!Lv(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,ZS(e,t,o,n,s)):(e=Ya(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:xi,r(i,n)&&e.ref===t.ref)return Qr(e,t,s)}return t.flags|=1,e=Rn(o,n),e.ref=t.ref,e.return=t,t.child=e}function ZS(e,t,r,n,s){if(e!==null){var o=e.memoizedProps;if(xi(o,n)&&e.ref===t.ref)if(jt=!1,t.pendingProps=n=o,(e.lanes&s)!==0)e.flags&131072&&(jt=!0);else return t.lanes=e.lanes,Qr(e,t,s)}return ug(e,t,r,n,s)}function JS(e,t,r){var n=t.pendingProps,s=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(zs,Mt),Mt|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ne(zs,Mt),Mt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Ne(zs,Mt),Mt|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Ne(zs,Mt),Mt|=n;return vt(e,t,s,r),t.child}function ek(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ug(e,t,r,n,s){var o=Nt(r)?is:ft.current;return o=Zs(t,o),Vs(t,s),r=Nv(e,t,r,n,o,s),n=Ev(),e!==null&&!jt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Qr(e,t,s)):(Me&&n&&hv(t),t.flags|=1,vt(e,t,r,s),t.child)}function Iy(e,t,r,n,s){if(Nt(r)){var o=!0;dl(t)}else o=!1;if(Vs(t,s),t.stateNode===null)Ua(e,t),YS(t,r,n),lg(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zt(u):(u=Nt(r)?is:ft.current,u=Zs(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==n||c!==u)&&ky(t,i,n,u),dn=!1;var p=t.memoizedState;i.state=p,gl(t,n,i,s),c=t.memoizedState,a!==n||p!==c||kt.current||dn?(typeof d=="function"&&(ag(t,r,d,n),c=t.memoizedState),(a=dn||Sy(t,r,a,n,p,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,CS(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:ar(t.type,a),i.props=u,f=t.pendingProps,p=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Zt(c):(c=Nt(r)?is:ft.current,c=Zs(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==f||p!==c)&&ky(t,i,n,c),dn=!1,p=t.memoizedState,i.state=p,gl(t,n,i,s);var y=t.memoizedState;a!==f||p!==y||kt.current||dn?(typeof h=="function"&&(ag(t,r,h,n),y=t.memoizedState),(u=dn||Sy(t,r,u,n,p,y,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,y,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),i.props=n,i.state=y,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return dg(e,t,r,n,o,s)}function dg(e,t,r,n,s,o){ek(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&gy(t,r,!1),Qr(e,t,o);n=t.stateNode,vR.current=t;var a=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=eo(t,e.child,null,o),t.child=eo(t,null,a,o)):vt(e,t,a,o),t.memoizedState=n.state,s&&gy(t,r,!0),t.child}function tk(e){var t=e.stateNode;t.pendingContext?my(e,t.pendingContext,t.pendingContext!==t.context):t.context&&my(e,t.context,!1),_v(e,t.containerInfo)}function My(e,t,r,n,s){return Js(),gv(s),t.flags|=256,vt(e,t,r,n),t.child}var fg={dehydrated:null,treeContext:null,retryLane:0};function pg(e){return{baseLanes:e,cachePool:null,transitions:null}}function rk(e,t,r){var n=t.pendingProps,s=Oe.current,o=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ne(Oe,s&1),e===null)return og(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,o?(n=t.mode,o=t.child,i={mode:"hidden",children:i},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=rc(i,n,0,null),e=ns(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=pg(r),t.memoizedState=fg,e):Tv(t,i));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return xR(e,t,i,n,a,s,r);if(o){o=n.fallback,i=t.mode,s=e.child,a=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Rn(s,c),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Rn(a,o):(o=ns(o,i,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,i=e.child.memoizedState,i=i===null?pg(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~r,t.memoizedState=fg,n}return o=e.child,e=o.sibling,n=Rn(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Tv(e,t){return t=rc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ma(e,t,r,n){return n!==null&&gv(n),eo(t,e.child,null,r),e=Tv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function xR(e,t,r,n,s,o,i){if(r)return t.flags&256?(t.flags&=-257,n=fu(Error(U(422))),ma(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,s=t.mode,n=rc({mode:"visible",children:n.children},s,0,null),o=ns(o,s,i,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&eo(t,e.child,null,i),t.child.memoizedState=pg(i),t.memoizedState=fg,o);if(!(t.mode&1))return ma(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(U(419)),n=fu(o,n,void 0),ma(e,t,i,n)}if(a=(i&e.childLanes)!==0,jt||a){if(n=tt,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Xr(e,s),pr(n,e,s,-1))}return Ov(),n=fu(Error(U(421))),ma(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=IR.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,At=kn(s.nextSibling),Dt=t,Me=!0,ur=null,e!==null&&(Ut[Gt++]=Fr,Ut[Gt++]=Br,Ut[Gt++]=as,Fr=e.id,Br=e.overflow,as=t),t=Tv(t,n.children),t.flags|=4096,t)}function Py(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ig(e.return,t,r)}function pu(e,t,r,n,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s)}function nk(e,t,r){var n=t.pendingProps,s=n.revealOrder,o=n.tail;if(vt(e,t,n.children,r),n=Oe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Py(e,r,t);else if(e.tag===19)Py(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ne(Oe,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&vl(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),pu(t,!1,s,r,o);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&vl(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}pu(t,!0,r,null,o);break;case"together":pu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ua(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),cs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(U(153));if(t.child!==null){for(e=t.child,r=Rn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Rn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function yR(e,t,r){switch(t.tag){case 3:tk(t),Js();break;case 5:RS(t);break;case 1:Nt(t.type)&&dl(t);break;case 4:_v(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ne(hl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ne(Oe,Oe.current&1),t.flags|=128,null):r&t.child.childLanes?rk(e,t,r):(Ne(Oe,Oe.current&1),e=Qr(e,t,r),e!==null?e.sibling:null);Ne(Oe,Oe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return nk(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ne(Oe,Oe.current),n)break;return null;case 22:case 23:return t.lanes=0,JS(e,t,r)}return Qr(e,t,r)}var sk,hg,ok,ik;sk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};hg=function(){};ok=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Zn(Rr.current);var o=null;switch(r){case"input":s=Om(e,s),n=Om(e,n),o=[];break;case"select":s=ze({},s,{value:void 0}),n=ze({},n,{value:void 0}),o=[];break;case"textarea":s=qm(e,s),n=qm(e,n),o=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=cl)}Fm(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(di.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var c=n[u];if(a=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&a[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(di.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Re("scroll",e),o||a===c||(o=[])):(o=o||[]).push(u,c))}r&&(o=o||[]).push("style",r);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};ik=function(e,t,r,n){r!==n&&(t.flags|=4)};function Io(e,t){if(!Me)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ut(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function bR(e,t,r){var n=t.pendingProps;switch(mv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(t),null;case 1:return Nt(t.type)&&ul(),ut(t),null;case 3:return n=t.stateNode,to(),Te(kt),Te(ft),Sv(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(pa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ur!==null&&(_g(ur),ur=null))),hg(e,t),ut(t),null;case 5:jv(t);var s=Zn(ji.current);if(r=t.type,e!==null&&t.stateNode!=null)ok(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(U(166));return ut(t),null}if(e=Zn(Rr.current),pa(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Nr]=t,n[wi]=o,e=(t.mode&1)!==0,r){case"dialog":Re("cancel",n),Re("close",n);break;case"iframe":case"object":case"embed":Re("load",n);break;case"video":case"audio":for(s=0;s<Ho.length;s++)Re(Ho[s],n);break;case"source":Re("error",n);break;case"img":case"image":case"link":Re("error",n),Re("load",n);break;case"details":Re("toggle",n);break;case"input":Bx(n,o),Re("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Re("invalid",n);break;case"textarea":Wx(n,o),Re("invalid",n)}Fm(r,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&fa(n.textContent,a,e),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&fa(n.textContent,a,e),s=["children",""+a]):di.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Re("scroll",n)}switch(r){case"input":sa(n),Hx(n,o,!0);break;case"textarea":sa(n),Vx(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=cl)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Aj(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Nr]=t,e[wi]=n,sk(e,t,!1,!1),t.stateNode=e;e:{switch(i=Bm(r,n),r){case"dialog":Re("cancel",e),Re("close",e),s=n;break;case"iframe":case"object":case"embed":Re("load",e),s=n;break;case"video":case"audio":for(s=0;s<Ho.length;s++)Re(Ho[s],e);s=n;break;case"source":Re("error",e),s=n;break;case"img":case"image":case"link":Re("error",e),Re("load",e),s=n;break;case"details":Re("toggle",e),s=n;break;case"input":Bx(e,n),s=Om(e,n),Re("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=ze({},n,{value:void 0}),Re("invalid",e);break;case"textarea":Wx(e,n),s=qm(e,n),Re("invalid",e);break;default:s=n}Fm(r,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?Lj(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Dj(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&fi(e,c):typeof c=="number"&&fi(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(di.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Re("scroll",e):c!=null&&ev(e,o,c,i))}switch(r){case"input":sa(e),Hx(e,n,!1);break;case"textarea":sa(e),Vx(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Pn(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?Fs(e,!!n.multiple,o,!1):n.defaultValue!=null&&Fs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=cl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ut(t),null;case 6:if(e&&t.stateNode!=null)ik(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(U(166));if(r=Zn(ji.current),Zn(Rr.current),pa(t)){if(n=t.stateNode,r=t.memoizedProps,n[Nr]=t,(o=n.nodeValue!==r)&&(e=Dt,e!==null))switch(e.tag){case 3:fa(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fa(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Nr]=t,t.stateNode=n}return ut(t),null;case 13:if(Te(Oe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Me&&At!==null&&t.mode&1&&!(t.flags&128))SS(),Js(),t.flags|=98560,o=!1;else if(o=pa(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(U(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(U(317));o[Nr]=t}else Js(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ut(t),o=!1}else ur!==null&&(_g(ur),ur=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Oe.current&1?Xe===0&&(Xe=3):Ov())),t.updateQueue!==null&&(t.flags|=4),ut(t),null);case 4:return to(),hg(e,t),e===null&&yi(t.stateNode.containerInfo),ut(t),null;case 10:return yv(t.type._context),ut(t),null;case 17:return Nt(t.type)&&ul(),ut(t),null;case 19:if(Te(Oe),o=t.memoizedState,o===null)return ut(t),null;if(n=(t.flags&128)!==0,i=o.rendering,i===null)if(n)Io(o,!1);else{if(Xe!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=vl(e),i!==null){for(t.flags|=128,Io(o,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ne(Oe,Oe.current&1|2),t.child}e=e.sibling}o.tail!==null&&Be()>no&&(t.flags|=128,n=!0,Io(o,!1),t.lanes=4194304)}else{if(!n)if(e=vl(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Io(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Me)return ut(t),null}else 2*Be()-o.renderingStartTime>no&&r!==1073741824&&(t.flags|=128,n=!0,Io(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(r=o.last,r!==null?r.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Be(),t.sibling=null,r=Oe.current,Ne(Oe,n?r&1|2:r&1),t):(ut(t),null);case 22:case 23:return Dv(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Mt&1073741824&&(ut(t),t.subtreeFlags&6&&(t.flags|=8192)):ut(t),null;case 24:return null;case 25:return null}throw Error(U(156,t.tag))}function wR(e,t){switch(mv(t),t.tag){case 1:return Nt(t.type)&&ul(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return to(),Te(kt),Te(ft),Sv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return jv(t),null;case 13:if(Te(Oe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(U(340));Js()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Te(Oe),null;case 4:return to(),null;case 10:return yv(t.type._context),null;case 22:case 23:return Dv(),null;case 24:return null;default:return null}}var ga=!1,dt=!1,_R=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Ls(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){qe(e,t,n)}else r.current=null}function mg(e,t,r){try{r()}catch(n){qe(e,t,n)}}var Ay=!1;function jR(e,t){if(Zm=il,e=dS(),pv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,a=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(a=i+s),f!==o||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++u===s&&(a=i),p===o&&++d===n&&(c=i),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Jm={focusedElem:e,selectionRange:r},il=!1,Z=t;Z!==null;)if(t=Z,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Z=e;else for(;Z!==null;){t=Z;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,_=y.memoizedState,g=t.stateNode,x=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:ar(t.type,v),_);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(w){qe(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Z=e;break}Z=t.return}return y=Ay,Ay=!1,y}function si(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&mg(t,r,o)}s=s.next}while(s!==n)}}function ec(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function gg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ak(e){var t=e.alternate;t!==null&&(e.alternate=null,ak(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Nr],delete t[wi],delete t[rg],delete t[oR],delete t[iR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lk(e){return e.tag===5||e.tag===3||e.tag===4}function Dy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=cl));else if(n!==4&&(e=e.child,e!==null))for(vg(e,t,r),e=e.sibling;e!==null;)vg(e,t,r),e=e.sibling}function xg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(xg(e,t,r),e=e.sibling;e!==null;)xg(e,t,r),e=e.sibling}var it=null,lr=!1;function an(e,t,r){for(r=r.child;r!==null;)ck(e,t,r),r=r.sibling}function ck(e,t,r){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Ul,r)}catch{}switch(r.tag){case 5:dt||Ls(r,t);case 6:var n=it,s=lr;it=null,an(e,t,r),it=n,lr=s,it!==null&&(lr?(e=it,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):it.removeChild(r.stateNode));break;case 18:it!==null&&(lr?(e=it,r=r.stateNode,e.nodeType===8?iu(e.parentNode,r):e.nodeType===1&&iu(e,r),gi(e)):iu(it,r.stateNode));break;case 4:n=it,s=lr,it=r.stateNode.containerInfo,lr=!0,an(e,t,r),it=n,lr=s;break;case 0:case 11:case 14:case 15:if(!dt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&mg(r,t,i),s=s.next}while(s!==n)}an(e,t,r);break;case 1:if(!dt&&(Ls(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){qe(r,t,a)}an(e,t,r);break;case 21:an(e,t,r);break;case 22:r.mode&1?(dt=(n=dt)||r.memoizedState!==null,an(e,t,r),dt=n):an(e,t,r);break;default:an(e,t,r)}}function Oy(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new _R),t.forEach(function(n){var s=MR.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function or(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var o=e,i=t,a=i;e:for(;a!==null;){switch(a.tag){case 5:it=a.stateNode,lr=!1;break e;case 3:it=a.stateNode.containerInfo,lr=!0;break e;case 4:it=a.stateNode.containerInfo,lr=!0;break e}a=a.return}if(it===null)throw Error(U(160));ck(o,i,s),it=null,lr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){qe(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)uk(t,e),t=t.sibling}function uk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(or(t,e),_r(e),n&4){try{si(3,e,e.return),ec(3,e)}catch(v){qe(e,e.return,v)}try{si(5,e,e.return)}catch(v){qe(e,e.return,v)}}break;case 1:or(t,e),_r(e),n&512&&r!==null&&Ls(r,r.return);break;case 5:if(or(t,e),_r(e),n&512&&r!==null&&Ls(r,r.return),e.flags&32){var s=e.stateNode;try{fi(s,"")}catch(v){qe(e,e.return,v)}}if(n&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=r!==null?r.memoizedProps:o,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Mj(s,o),Bm(a,i);var u=Bm(a,o);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?Lj(s,f):d==="dangerouslySetInnerHTML"?Dj(s,f):d==="children"?fi(s,f):ev(s,d,f,u)}switch(a){case"input":Lm(s,o);break;case"textarea":Pj(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Fs(s,!!o.multiple,h,!1):p!==!!o.multiple&&(o.defaultValue!=null?Fs(s,!!o.multiple,o.defaultValue,!0):Fs(s,!!o.multiple,o.multiple?[]:"",!1))}s[wi]=o}catch(v){qe(e,e.return,v)}}break;case 6:if(or(t,e),_r(e),n&4){if(e.stateNode===null)throw Error(U(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(v){qe(e,e.return,v)}}break;case 3:if(or(t,e),_r(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{gi(t.containerInfo)}catch(v){qe(e,e.return,v)}break;case 4:or(t,e),_r(e);break;case 13:or(t,e),_r(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Pv=Be())),n&4&&Oy(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(dt=(u=dt)||d,or(t,e),dt=u):or(t,e),_r(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Z=e,d=e.child;d!==null;){for(f=Z=d;Z!==null;){switch(p=Z,h=p.child,p.tag){case 0:case 11:case 14:case 15:si(4,p,p.return);break;case 1:Ls(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(v){qe(n,r,v)}}break;case 5:Ls(p,p.return);break;case 22:if(p.memoizedState!==null){zy(f);continue}}h!==null?(h.return=p,Z=h):zy(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Oj("display",i))}catch(v){qe(e,e.return,v)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){qe(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:or(t,e),_r(e),n&4&&Oy(e);break;case 21:break;default:or(t,e),_r(e)}}function _r(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(lk(r)){var n=r;break e}r=r.return}throw Error(U(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(fi(s,""),n.flags&=-33);var o=Dy(e);xg(e,o,s);break;case 3:case 4:var i=n.stateNode.containerInfo,a=Dy(e);vg(e,a,i);break;default:throw Error(U(161))}}catch(c){qe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function SR(e,t,r){Z=e,dk(e)}function dk(e,t,r){for(var n=(e.mode&1)!==0;Z!==null;){var s=Z,o=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||ga;if(!i){var a=s.alternate,c=a!==null&&a.memoizedState!==null||dt;a=ga;var u=dt;if(ga=i,(dt=c)&&!u)for(Z=s;Z!==null;)i=Z,c=i.child,i.tag===22&&i.memoizedState!==null?qy(s):c!==null?(c.return=i,Z=c):qy(s);for(;o!==null;)Z=o,dk(o),o=o.sibling;Z=s,ga=a,dt=u}Ly(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Z=o):Ly(e)}}function Ly(e){for(;Z!==null;){var t=Z;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dt||ec(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!dt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ar(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&wy(t,o,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}wy(t,i,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&gi(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}dt||t.flags&512&&gg(t)}catch(p){qe(t,t.return,p)}}if(t===e){Z=null;break}if(r=t.sibling,r!==null){r.return=t.return,Z=r;break}Z=t.return}}function zy(e){for(;Z!==null;){var t=Z;if(t===e){Z=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Z=r;break}Z=t.return}}function qy(e){for(;Z!==null;){var t=Z;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ec(4,t)}catch(c){qe(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){qe(t,s,c)}}var o=t.return;try{gg(t)}catch(c){qe(t,o,c)}break;case 5:var i=t.return;try{gg(t)}catch(c){qe(t,i,c)}}}catch(c){qe(t,t.return,c)}if(t===e){Z=null;break}var a=t.sibling;if(a!==null){a.return=t.return,Z=a;break}Z=t.return}}var kR=Math.ceil,bl=tn.ReactCurrentDispatcher,Iv=tn.ReactCurrentOwner,Qt=tn.ReactCurrentBatchConfig,ve=0,tt=null,We=null,at=0,Mt=0,zs=Ln(0),Xe=0,Ei=null,cs=0,tc=0,Mv=0,oi=null,_t=null,Pv=0,no=1/0,qr=null,wl=!1,yg=null,En=null,va=!1,wn=null,_l=0,ii=0,bg=null,Ga=-1,Ka=0;function xt(){return ve&6?Be():Ga!==-1?Ga:Ga=Be()}function Cn(e){return e.mode&1?ve&2&&at!==0?at&-at:lR.transition!==null?(Ka===0&&(Ka=Yj()),Ka):(e=je,e!==0||(e=window.event,e=e===void 0?16:rS(e.type)),e):1}function pr(e,t,r,n){if(50<ii)throw ii=0,bg=null,Error(U(185));$i(e,r,n),(!(ve&2)||e!==tt)&&(e===tt&&(!(ve&2)&&(tc|=r),Xe===4&&gn(e,at)),Et(e,n),r===1&&ve===0&&!(t.mode&1)&&(no=Be()+500,Ql&&zn()))}function Et(e,t){var r=e.callbackNode;l5(e,t);var n=ol(e,e===tt?at:0);if(n===0)r!==null&&Kx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Kx(r),t===1)e.tag===0?aR($y.bind(null,e)):wS($y.bind(null,e)),nR(function(){!(ve&6)&&zn()}),r=null;else{switch(Xj(n)){case 1:r=ov;break;case 4:r=Gj;break;case 16:r=sl;break;case 536870912:r=Kj;break;default:r=sl}r=yk(r,fk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function fk(e,t){if(Ga=-1,Ka=0,ve&6)throw Error(U(327));var r=e.callbackNode;if(Us()&&e.callbackNode!==r)return null;var n=ol(e,e===tt?at:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=jl(e,n);else{t=n;var s=ve;ve|=2;var o=hk();(tt!==e||at!==t)&&(qr=null,no=Be()+500,rs(e,t));do try{CR();break}catch(a){pk(e,a)}while(!0);xv(),bl.current=o,ve=s,We!==null?t=0:(tt=null,at=0,t=Xe)}if(t!==0){if(t===2&&(s=Gm(e),s!==0&&(n=s,t=wg(e,s))),t===1)throw r=Ei,rs(e,0),gn(e,n),Et(e,Be()),r;if(t===6)gn(e,n);else{if(s=e.current.alternate,!(n&30)&&!NR(s)&&(t=jl(e,n),t===2&&(o=Gm(e),o!==0&&(n=o,t=wg(e,o))),t===1))throw r=Ei,rs(e,0),gn(e,n),Et(e,Be()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(U(345));case 2:Gn(e,_t,qr);break;case 3:if(gn(e,n),(n&130023424)===n&&(t=Pv+500-Be(),10<t)){if(ol(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){xt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=tg(Gn.bind(null,e,_t,qr),t);break}Gn(e,_t,qr);break;case 4:if(gn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-fr(n);o=1<<i,i=t[i],i>s&&(s=i),n&=~o}if(n=s,n=Be()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*kR(n/1960))-n,10<n){e.timeoutHandle=tg(Gn.bind(null,e,_t,qr),n);break}Gn(e,_t,qr);break;case 5:Gn(e,_t,qr);break;default:throw Error(U(329))}}}return Et(e,Be()),e.callbackNode===r?fk.bind(null,e):null}function wg(e,t){var r=oi;return e.current.memoizedState.isDehydrated&&(rs(e,t).flags|=256),e=jl(e,t),e!==2&&(t=_t,_t=r,t!==null&&_g(t)),e}function _g(e){_t===null?_t=e:_t.push.apply(_t,e)}function NR(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],o=s.getSnapshot;s=s.value;try{if(!hr(o(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gn(e,t){for(t&=~Mv,t&=~tc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-fr(t),n=1<<r;e[r]=-1,t&=~n}}function $y(e){if(ve&6)throw Error(U(327));Us();var t=ol(e,0);if(!(t&1))return Et(e,Be()),null;var r=jl(e,t);if(e.tag!==0&&r===2){var n=Gm(e);n!==0&&(t=n,r=wg(e,n))}if(r===1)throw r=Ei,rs(e,0),gn(e,t),Et(e,Be()),r;if(r===6)throw Error(U(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gn(e,_t,qr),Et(e,Be()),null}function Av(e,t){var r=ve;ve|=1;try{return e(t)}finally{ve=r,ve===0&&(no=Be()+500,Ql&&zn())}}function us(e){wn!==null&&wn.tag===0&&!(ve&6)&&Us();var t=ve;ve|=1;var r=Qt.transition,n=je;try{if(Qt.transition=null,je=1,e)return e()}finally{je=n,Qt.transition=r,ve=t,!(ve&6)&&zn()}}function Dv(){Mt=zs.current,Te(zs)}function rs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,rR(r)),We!==null)for(r=We.return;r!==null;){var n=r;switch(mv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ul();break;case 3:to(),Te(kt),Te(ft),Sv();break;case 5:jv(n);break;case 4:to();break;case 13:Te(Oe);break;case 19:Te(Oe);break;case 10:yv(n.type._context);break;case 22:case 23:Dv()}r=r.return}if(tt=e,We=e=Rn(e.current,null),at=Mt=t,Xe=0,Ei=null,Mv=tc=cs=0,_t=oi=null,Qn!==null){for(t=0;t<Qn.length;t++)if(r=Qn[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,o=r.pending;if(o!==null){var i=o.next;o.next=s,n.next=i}r.pending=n}Qn=null}return e}function pk(e,t){do{var r=We;try{if(xv(),Wa.current=yl,xl){for(var n=Le.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}xl=!1}if(ls=0,Je=Ke=Le=null,ni=!1,Si=0,Iv.current=null,r===null||r.return===null){Xe=1,Ei=t,We=null;break}e:{var o=e,i=r.return,a=r,c=t;if(t=at,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=Ey(i);if(h!==null){h.flags&=-257,Cy(h,i,a,o,t),h.mode&1&&Ny(o,u,t),t=h,c=u;var y=t.updateQueue;if(y===null){var v=new Set;v.add(c),t.updateQueue=v}else y.add(c);break e}else{if(!(t&1)){Ny(o,u,t),Ov();break e}c=Error(U(426))}}else if(Me&&a.mode&1){var _=Ey(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Cy(_,i,a,o,t),gv(ro(c,a));break e}}o=c=ro(c,a),Xe!==4&&(Xe=2),oi===null?oi=[o]:oi.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var g=XS(o,c,t);by(o,g);break e;case 1:a=c;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(En===null||!En.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=QS(o,a,t);by(o,w);break e}}o=o.return}while(o!==null)}gk(r)}catch(j){t=j,We===r&&r!==null&&(We=r=r.return);continue}break}while(!0)}function hk(){var e=bl.current;return bl.current=yl,e===null?yl:e}function Ov(){(Xe===0||Xe===3||Xe===2)&&(Xe=4),tt===null||!(cs&268435455)&&!(tc&268435455)||gn(tt,at)}function jl(e,t){var r=ve;ve|=2;var n=hk();(tt!==e||at!==t)&&(qr=null,rs(e,t));do try{ER();break}catch(s){pk(e,s)}while(!0);if(xv(),ve=r,bl.current=n,We!==null)throw Error(U(261));return tt=null,at=0,Xe}function ER(){for(;We!==null;)mk(We)}function CR(){for(;We!==null&&!J4();)mk(We)}function mk(e){var t=xk(e.alternate,e,Mt);e.memoizedProps=e.pendingProps,t===null?gk(e):We=t,Iv.current=null}function gk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=wR(r,t),r!==null){r.flags&=32767,We=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xe=6,We=null;return}}else if(r=bR(r,t,Mt),r!==null){We=r;return}if(t=t.sibling,t!==null){We=t;return}We=t=e}while(t!==null);Xe===0&&(Xe=5)}function Gn(e,t,r){var n=je,s=Qt.transition;try{Qt.transition=null,je=1,RR(e,t,r,n)}finally{Qt.transition=s,je=n}return null}function RR(e,t,r,n){do Us();while(wn!==null);if(ve&6)throw Error(U(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(U(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(c5(e,o),e===tt&&(We=tt=null,at=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||va||(va=!0,yk(sl,function(){return Us(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Qt.transition,Qt.transition=null;var i=je;je=1;var a=ve;ve|=4,Iv.current=null,jR(e,r),uk(r,e),Y5(Jm),il=!!Zm,Jm=Zm=null,e.current=r,SR(r),e5(),ve=a,je=i,Qt.transition=o}else e.current=r;if(va&&(va=!1,wn=e,_l=s),o=e.pendingLanes,o===0&&(En=null),n5(r.stateNode),Et(e,Be()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(wl)throw wl=!1,e=yg,yg=null,e;return _l&1&&e.tag!==0&&Us(),o=e.pendingLanes,o&1?e===bg?ii++:(ii=0,bg=e):ii=0,zn(),null}function Us(){if(wn!==null){var e=Xj(_l),t=Qt.transition,r=je;try{if(Qt.transition=null,je=16>e?16:e,wn===null)var n=!1;else{if(e=wn,wn=null,_l=0,ve&6)throw Error(U(331));var s=ve;for(ve|=4,Z=e.current;Z!==null;){var o=Z,i=o.child;if(Z.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(Z=u;Z!==null;){var d=Z;switch(d.tag){case 0:case 11:case 15:si(8,d,o)}var f=d.child;if(f!==null)f.return=d,Z=f;else for(;Z!==null;){d=Z;var p=d.sibling,h=d.return;if(ak(d),d===u){Z=null;break}if(p!==null){p.return=h,Z=p;break}Z=h}}}var y=o.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}Z=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Z=i;else e:for(;Z!==null;){if(o=Z,o.flags&2048)switch(o.tag){case 0:case 11:case 15:si(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,Z=g;break e}Z=o.return}}var x=e.current;for(Z=x;Z!==null;){i=Z;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,Z=b;else e:for(i=x;Z!==null;){if(a=Z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ec(9,a)}}catch(j){qe(a,a.return,j)}if(a===i){Z=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,Z=w;break e}Z=a.return}}if(ve=s,zn(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Ul,e)}catch{}n=!0}return n}finally{je=r,Qt.transition=t}}return!1}function Fy(e,t,r){t=ro(r,t),t=XS(e,t,1),e=Nn(e,t,1),t=xt(),e!==null&&($i(e,1,t),Et(e,t))}function qe(e,t,r){if(e.tag===3)Fy(e,e,r);else for(;t!==null;){if(t.tag===3){Fy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(En===null||!En.has(n))){e=ro(r,e),e=QS(t,e,1),t=Nn(t,e,1),e=xt(),t!==null&&($i(t,1,e),Et(t,e));break}}t=t.return}}function TR(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=xt(),e.pingedLanes|=e.suspendedLanes&r,tt===e&&(at&r)===r&&(Xe===4||Xe===3&&(at&130023424)===at&&500>Be()-Pv?rs(e,0):Mv|=r),Et(e,t)}function vk(e,t){t===0&&(e.mode&1?(t=aa,aa<<=1,!(aa&130023424)&&(aa=4194304)):t=1);var r=xt();e=Xr(e,t),e!==null&&($i(e,t,r),Et(e,r))}function IR(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),vk(e,r)}function MR(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(U(314))}n!==null&&n.delete(t),vk(e,r)}var xk;xk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||kt.current)jt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return jt=!1,yR(e,t,r);jt=!!(e.flags&131072)}else jt=!1,Me&&t.flags&1048576&&_S(t,pl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ua(e,t),e=t.pendingProps;var s=Zs(t,ft.current);Vs(t,r),s=Nv(null,t,n,e,s,r);var o=Ev();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nt(n)?(o=!0,dl(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,wv(t),s.updater=Jl,t.stateNode=s,s._reactInternals=t,lg(t,n,e,r),t=dg(null,t,n,!0,o,r)):(t.tag=0,Me&&o&&hv(t),vt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ua(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=AR(n),e=ar(n,e),s){case 0:t=ug(null,t,n,e,r);break e;case 1:t=Iy(null,t,n,e,r);break e;case 11:t=Ry(null,t,n,e,r);break e;case 14:t=Ty(null,t,n,ar(n.type,e),r);break e}throw Error(U(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),ug(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),Iy(e,t,n,s,r);case 3:e:{if(tk(t),e===null)throw Error(U(387));n=t.pendingProps,o=t.memoizedState,s=o.element,CS(e,t),gl(t,n,null,r);var i=t.memoizedState;if(n=i.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=ro(Error(U(423)),t),t=My(e,t,n,r,s);break e}else if(n!==s){s=ro(Error(U(424)),t),t=My(e,t,n,r,s);break e}else for(At=kn(t.stateNode.containerInfo.firstChild),Dt=t,Me=!0,ur=null,r=NS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Js(),n===s){t=Qr(e,t,r);break e}vt(e,t,n,r)}t=t.child}return t;case 5:return RS(t),e===null&&og(t),n=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,eg(n,s)?i=null:o!==null&&eg(n,o)&&(t.flags|=32),ek(e,t),vt(e,t,i,r),t.child;case 6:return e===null&&og(t),null;case 13:return rk(e,t,r);case 4:return _v(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=eo(t,null,n,r):vt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),Ry(e,t,n,s,r);case 7:return vt(e,t,t.pendingProps,r),t.child;case 8:return vt(e,t,t.pendingProps.children,r),t.child;case 12:return vt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,Ne(hl,n._currentValue),n._currentValue=i,o!==null)if(hr(o.value,i)){if(o.children===s.children&&!kt.current){t=Qr(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=Ur(-1,r&-r),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),ig(o.return,r,t),a.lanes|=r;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(U(341));i.lanes|=r,a=i.alternate,a!==null&&(a.lanes|=r),ig(i,r,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}vt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Vs(t,r),s=Zt(s),n=n(s),t.flags|=1,vt(e,t,n,r),t.child;case 14:return n=t.type,s=ar(n,t.pendingProps),s=ar(n.type,s),Ty(e,t,n,s,r);case 15:return ZS(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),Ua(e,t),t.tag=1,Nt(n)?(e=!0,dl(t)):e=!1,Vs(t,r),YS(t,n,s),lg(t,n,s,r),dg(null,t,n,!0,e,r);case 19:return nk(e,t,r);case 22:return JS(e,t,r)}throw Error(U(156,t.tag))};function yk(e,t){return Uj(e,t)}function PR(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(e,t,r,n){return new PR(e,t,r,n)}function Lv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function AR(e){if(typeof e=="function")return Lv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rv)return 11;if(e===nv)return 14}return 2}function Rn(e,t){var r=e.alternate;return r===null?(r=Yt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ya(e,t,r,n,s,o){var i=2;if(n=e,typeof e=="function")Lv(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Cs:return ns(r.children,s,o,t);case tv:i=8,s|=8;break;case Mm:return e=Yt(12,r,t,s|2),e.elementType=Mm,e.lanes=o,e;case Pm:return e=Yt(13,r,t,s),e.elementType=Pm,e.lanes=o,e;case Am:return e=Yt(19,r,t,s),e.elementType=Am,e.lanes=o,e;case Rj:return rc(r,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ej:i=10;break e;case Cj:i=9;break e;case rv:i=11;break e;case nv:i=14;break e;case un:i=16,n=null;break e}throw Error(U(130,e==null?e:typeof e,""))}return t=Yt(i,r,t,s),t.elementType=e,t.type=n,t.lanes=o,t}function ns(e,t,r,n){return e=Yt(7,e,n,t),e.lanes=r,e}function rc(e,t,r,n){return e=Yt(22,e,n,t),e.elementType=Rj,e.lanes=r,e.stateNode={isHidden:!1},e}function hu(e,t,r){return e=Yt(6,e,null,t),e.lanes=r,e}function mu(e,t,r){return t=Yt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function DR(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yc(0),this.expirationTimes=Yc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yc(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zv(e,t,r,n,s,o,i,a,c){return e=new DR(e,t,r,a,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Yt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},wv(o),e}function OR(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Es,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function bk(e){if(!e)return An;e=e._reactInternals;e:{if(hs(e)!==e||e.tag!==1)throw Error(U(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(U(171))}if(e.tag===1){var r=e.type;if(Nt(r))return bS(e,r,t)}return t}function wk(e,t,r,n,s,o,i,a,c){return e=zv(r,n,!0,e,s,o,i,a,c),e.context=bk(null),r=e.current,n=xt(),s=Cn(r),o=Ur(n,s),o.callback=t??null,Nn(r,o,s),e.current.lanes=s,$i(e,s,n),Et(e,n),e}function nc(e,t,r,n){var s=t.current,o=xt(),i=Cn(s);return r=bk(r),t.context===null?t.context=r:t.pendingContext=r,t=Ur(o,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Nn(s,t,i),e!==null&&(pr(e,s,i,o),Ha(e,s,i)),i}function Sl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function By(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function qv(e,t){By(e,t),(e=e.alternate)&&By(e,t)}function LR(){return null}var _k=typeof reportError=="function"?reportError:function(e){console.error(e)};function $v(e){this._internalRoot=e}sc.prototype.render=$v.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(U(409));nc(e,t,null,null)};sc.prototype.unmount=$v.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;us(function(){nc(null,e,null,null)}),t[Yr]=null}};function sc(e){this._internalRoot=e}sc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Jj();e={blockedOn:null,target:e,priority:t};for(var r=0;r<mn.length&&t!==0&&t<mn[r].priority;r++);mn.splice(r,0,e),r===0&&tS(e)}};function Fv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Hy(){}function zR(e,t,r,n,s){if(s){if(typeof n=="function"){var o=n;n=function(){var u=Sl(i);o.call(u)}}var i=wk(t,n,e,0,null,!1,!1,"",Hy);return e._reactRootContainer=i,e[Yr]=i.current,yi(e.nodeType===8?e.parentNode:e),us(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var u=Sl(c);a.call(u)}}var c=zv(e,0,!1,null,null,!1,!1,"",Hy);return e._reactRootContainer=c,e[Yr]=c.current,yi(e.nodeType===8?e.parentNode:e),us(function(){nc(t,c,r,n)}),c}function ic(e,t,r,n,s){var o=r._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var c=Sl(i);a.call(c)}}nc(t,i,e,s)}else i=zR(r,t,e,s,n);return Sl(i)}Qj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Bo(t.pendingLanes);r!==0&&(iv(t,r|1),Et(t,Be()),!(ve&6)&&(no=Be()+500,zn()))}break;case 13:us(function(){var n=Xr(e,1);if(n!==null){var s=xt();pr(n,e,1,s)}}),qv(e,1)}};av=function(e){if(e.tag===13){var t=Xr(e,134217728);if(t!==null){var r=xt();pr(t,e,134217728,r)}qv(e,134217728)}};Zj=function(e){if(e.tag===13){var t=Cn(e),r=Xr(e,t);if(r!==null){var n=xt();pr(r,e,t,n)}qv(e,t)}};Jj=function(){return je};eS=function(e,t){var r=je;try{return je=e,t()}finally{je=r}};Wm=function(e,t,r){switch(t){case"input":if(Lm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Xl(n);if(!s)throw Error(U(90));Ij(n),Lm(n,s)}}}break;case"textarea":Pj(e,r);break;case"select":t=r.value,t!=null&&Fs(e,!!r.multiple,t,!1)}};$j=Av;Fj=us;var qR={usingClientEntryPoint:!1,Events:[Bi,Ms,Xl,zj,qj,Av]},Mo={findFiberByHostInstance:Xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$R={bundleType:Mo.bundleType,version:Mo.version,rendererPackageName:Mo.rendererPackageName,rendererConfig:Mo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:tn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Wj(e),e===null?null:e.stateNode},findFiberByHostInstance:Mo.findFiberByHostInstance||LR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xa.isDisabled&&xa.supportsFiber)try{Ul=xa.inject($R),Cr=xa}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qR;zt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fv(t))throw Error(U(200));return OR(e,t,null,r)};zt.createRoot=function(e,t){if(!Fv(e))throw Error(U(299));var r=!1,n="",s=_k;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=zv(e,1,!1,null,null,r,!1,n,s),e[Yr]=t.current,yi(e.nodeType===8?e.parentNode:e),new $v(t)};zt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(U(188)):(e=Object.keys(e).join(","),Error(U(268,e)));return e=Wj(t),e=e===null?null:e.stateNode,e};zt.flushSync=function(e){return us(e)};zt.hydrate=function(e,t,r){if(!oc(t))throw Error(U(200));return ic(null,e,t,!0,r)};zt.hydrateRoot=function(e,t,r){if(!Fv(e))throw Error(U(405));var n=r!=null&&r.hydratedSources||null,s=!1,o="",i=_k;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=wk(t,null,e,1,r??null,s,!1,o,i),e[Yr]=t.current,yi(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new sc(t)};zt.render=function(e,t,r){if(!oc(t))throw Error(U(200));return ic(null,e,t,!1,r)};zt.unmountComponentAtNode=function(e){if(!oc(e))throw Error(U(40));return e._reactRootContainer?(us(function(){ic(null,null,e,!1,function(){e._reactRootContainer=null,e[Yr]=null})}),!0):!1};zt.unstable_batchedUpdates=Av;zt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!oc(r))throw Error(U(200));if(e==null||e._reactInternals===void 0)throw Error(U(38));return ic(e,t,r,!1,n)};zt.version="18.3.1-next-f1338f8080-20240426";function jk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jk)}catch(e){console.error(e)}}jk(),jj.exports=zt;var qs=jj.exports,Wy=qs;Tm.createRoot=Wy.createRoot,Tm.hydrateRoot=Wy.hydrateRoot;function Rt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Rt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var Sk={exports:{}},kk={},Nk={exports:{}},Ek={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var so=m;function FR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var BR=typeof Object.is=="function"?Object.is:FR,HR=so.useState,WR=so.useEffect,VR=so.useLayoutEffect,UR=so.useDebugValue;function GR(e,t){var r=t(),n=HR({inst:{value:r,getSnapshot:t}}),s=n[0].inst,o=n[1];return VR(function(){s.value=r,s.getSnapshot=t,gu(s)&&o({inst:s})},[e,r,t]),WR(function(){return gu(s)&&o({inst:s}),e(function(){gu(s)&&o({inst:s})})},[e]),UR(r),r}function gu(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!BR(e,r)}catch{return!0}}function KR(e,t){return t()}var YR=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?KR:GR;Ek.useSyncExternalStore=so.useSyncExternalStore!==void 0?so.useSyncExternalStore:YR;Nk.exports=Ek;var XR=Nk.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ac=m,QR=XR;function ZR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var JR=typeof Object.is=="function"?Object.is:ZR,e3=QR.useSyncExternalStore,t3=ac.useRef,r3=ac.useEffect,n3=ac.useMemo,s3=ac.useDebugValue;kk.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var o=t3(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=n3(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&i.hasValue){var y=i.value;if(s(y,h))return f=y}return f=h}if(y=f,JR(d,h))return y;var v=n(h);return s!==void 0&&s(y,v)?(d=h,y):(d=h,f=v)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,s]);var a=e3(e,o[0],o[1]);return r3(function(){i.hasValue=!0,i.value=a},[a]),s3(a),a};Sk.exports=kk;var o3=Sk.exports;const i3=Gg(o3),a3={},Vy=e=>{let t;const r=new Set,n=(d,f)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(y=>y(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(a3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,s,c);return c},l3=e=>e?Vy(e):Vy,{useDebugValue:c3}=B,{useSyncExternalStoreWithSelector:u3}=i3,d3=e=>e;function Ck(e,t=d3,r){const n=u3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return c3(n),n}const Uy=(e,t)=>{const r=l3(e),n=(s,o=t)=>Ck(r,s,o);return Object.assign(n,r),n},f3=(e,t)=>e?Uy(e,t):Uy;function pt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var p3={value:()=>{}};function lc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Xa(r)}function Xa(e){this._=e}function h3(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Xa.prototype=lc.prototype={constructor:Xa,on:function(e,t){var r=this._,n=h3(e+"",r),s,o=-1,i=n.length;if(arguments.length<2){for(;++o<i;)if((s=(e=n[o]).type)&&(s=m3(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(s=(e=n[o]).type)r[s]=Gy(r[s],e.name,t);else if(t==null)for(s in r)r[s]=Gy(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Xa(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,o;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,s=o.length;n<s;++n)o[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],s=0,o=n.length;s<o;++s)n[s].value.apply(t,r)}};function m3(e,t){for(var r=0,n=e.length,s;r<n;++r)if((s=e[r]).name===t)return s.value}function Gy(e,t,r){for(var n=0,s=e.length;n<s;++n)if(e[n].name===t){e[n]=p3,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var jg="http://www.w3.org/1999/xhtml";const Ky={svg:"http://www.w3.org/2000/svg",xhtml:jg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function cc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Ky.hasOwnProperty(t)?{space:Ky[t],local:e}:e}function g3(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===jg&&t.documentElement.namespaceURI===jg?t.createElement(e):t.createElementNS(r,e)}}function v3(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Rk(e){var t=cc(e);return(t.local?v3:g3)(t)}function x3(){}function Bv(e){return e==null?x3:function(){return this.querySelector(e)}}function y3(e){typeof e!="function"&&(e=Bv(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],i=o.length,a=n[s]=new Array(i),c,u,d=0;d<i;++d)(c=o[d])&&(u=e.call(c,c.__data__,d,o))&&("__data__"in c&&(u.__data__=c.__data__),a[d]=u);return new Lt(n,this._parents)}function b3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function w3(){return[]}function Tk(e){return e==null?w3:function(){return this.querySelectorAll(e)}}function _3(e){return function(){return b3(e.apply(this,arguments))}}function j3(e){typeof e=="function"?e=_3(e):e=Tk(e);for(var t=this._groups,r=t.length,n=[],s=[],o=0;o<r;++o)for(var i=t[o],a=i.length,c,u=0;u<a;++u)(c=i[u])&&(n.push(e.call(c,c.__data__,u,i)),s.push(c));return new Lt(n,s)}function Ik(e){return function(){return this.matches(e)}}function Mk(e){return function(t){return t.matches(e)}}var S3=Array.prototype.find;function k3(e){return function(){return S3.call(this.children,e)}}function N3(){return this.firstElementChild}function E3(e){return this.select(e==null?N3:k3(typeof e=="function"?e:Mk(e)))}var C3=Array.prototype.filter;function R3(){return Array.from(this.children)}function T3(e){return function(){return C3.call(this.children,e)}}function I3(e){return this.selectAll(e==null?R3:T3(typeof e=="function"?e:Mk(e)))}function M3(e){typeof e!="function"&&(e=Ik(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],i=o.length,a=n[s]=[],c,u=0;u<i;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&a.push(c);return new Lt(n,this._parents)}function Pk(e){return new Array(e.length)}function P3(){return new Lt(this._enter||this._groups.map(Pk),this._parents)}function kl(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}kl.prototype={constructor:kl,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function A3(e){return function(){return e}}function D3(e,t,r,n,s,o){for(var i=0,a,c=t.length,u=o.length;i<u;++i)(a=t[i])?(a.__data__=o[i],n[i]=a):r[i]=new kl(e,o[i]);for(;i<c;++i)(a=t[i])&&(s[i]=a)}function O3(e,t,r,n,s,o,i){var a,c,u=new Map,d=t.length,f=o.length,p=new Array(d),h;for(a=0;a<d;++a)(c=t[a])&&(p[a]=h=i.call(c,c.__data__,a,t)+"",u.has(h)?s[a]=c:u.set(h,c));for(a=0;a<f;++a)h=i.call(e,o[a],a,o)+"",(c=u.get(h))?(n[a]=c,c.__data__=o[a],u.delete(h)):r[a]=new kl(e,o[a]);for(a=0;a<d;++a)(c=t[a])&&u.get(p[a])===c&&(s[a]=c)}function L3(e){return e.__data__}function z3(e,t){if(!arguments.length)return Array.from(this,L3);var r=t?O3:D3,n=this._parents,s=this._groups;typeof e!="function"&&(e=A3(e));for(var o=s.length,i=new Array(o),a=new Array(o),c=new Array(o),u=0;u<o;++u){var d=n[u],f=s[u],p=f.length,h=q3(e.call(d,d&&d.__data__,u,n)),y=h.length,v=a[u]=new Array(y),_=i[u]=new Array(y),g=c[u]=new Array(p);r(d,f,v,_,g,h,t);for(var x=0,b=0,w,j;x<y;++x)if(w=v[x]){for(x>=b&&(b=x+1);!(j=_[b])&&++b<y;);w._next=j||null}}return i=new Lt(i,n),i._enter=a,i._exit=c,i}function q3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function $3(){return new Lt(this._exit||this._groups.map(Pk),this._parents)}function F3(e,t,r){var n=this.enter(),s=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?o.remove():r(o),n&&s?n.merge(s).order():s}function B3(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,s=r.length,o=n.length,i=Math.min(s,o),a=new Array(s),c=0;c<i;++c)for(var u=r[c],d=n[c],f=u.length,p=a[c]=new Array(f),h,y=0;y<f;++y)(h=u[y]||d[y])&&(p[y]=h);for(;c<s;++c)a[c]=r[c];return new Lt(a,this._parents)}function H3(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],s=n.length-1,o=n[s],i;--s>=0;)(i=n[s])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function W3(e){e||(e=V3);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,s=new Array(n),o=0;o<n;++o){for(var i=r[o],a=i.length,c=s[o]=new Array(a),u,d=0;d<a;++d)(u=i[d])&&(c[d]=u);c.sort(t)}return new Lt(s,this._parents).order()}function V3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function U3(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function G3(){return Array.from(this)}function K3(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length;s<o;++s){var i=n[s];if(i)return i}return null}function Y3(){let e=0;for(const t of this)++e;return e}function X3(){return!this.node()}function Q3(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var s=t[r],o=0,i=s.length,a;o<i;++o)(a=s[o])&&e.call(a,a.__data__,o,s);return this}function Z3(e){return function(){this.removeAttribute(e)}}function J3(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eT(e,t){return function(){this.setAttribute(e,t)}}function tT(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function rT(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function nT(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function sT(e,t){var r=cc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?J3:Z3:typeof t=="function"?r.local?nT:rT:r.local?tT:eT)(r,t))}function Ak(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function oT(e){return function(){this.style.removeProperty(e)}}function iT(e,t,r){return function(){this.style.setProperty(e,t,r)}}function aT(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function lT(e,t,r){return arguments.length>1?this.each((t==null?oT:typeof t=="function"?aT:iT)(e,t,r??"")):oo(this.node(),e)}function oo(e,t){return e.style.getPropertyValue(t)||Ak(e).getComputedStyle(e,null).getPropertyValue(t)}function cT(e){return function(){delete this[e]}}function uT(e,t){return function(){this[e]=t}}function dT(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function fT(e,t){return arguments.length>1?this.each((t==null?cT:typeof t=="function"?dT:uT)(e,t)):this.node()[e]}function Dk(e){return e.trim().split(/^|\s+/)}function Hv(e){return e.classList||new Ok(e)}function Ok(e){this._node=e,this._names=Dk(e.getAttribute("class")||"")}Ok.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Lk(e,t){for(var r=Hv(e),n=-1,s=t.length;++n<s;)r.add(t[n])}function zk(e,t){for(var r=Hv(e),n=-1,s=t.length;++n<s;)r.remove(t[n])}function pT(e){return function(){Lk(this,e)}}function hT(e){return function(){zk(this,e)}}function mT(e,t){return function(){(t.apply(this,arguments)?Lk:zk)(this,e)}}function gT(e,t){var r=Dk(e+"");if(arguments.length<2){for(var n=Hv(this.node()),s=-1,o=r.length;++s<o;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?mT:t?pT:hT)(r,t))}function vT(){this.textContent=""}function xT(e){return function(){this.textContent=e}}function yT(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function bT(e){return arguments.length?this.each(e==null?vT:(typeof e=="function"?yT:xT)(e)):this.node().textContent}function wT(){this.innerHTML=""}function _T(e){return function(){this.innerHTML=e}}function jT(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ST(e){return arguments.length?this.each(e==null?wT:(typeof e=="function"?jT:_T)(e)):this.node().innerHTML}function kT(){this.nextSibling&&this.parentNode.appendChild(this)}function NT(){return this.each(kT)}function ET(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function CT(){return this.each(ET)}function RT(e){var t=typeof e=="function"?e:Rk(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function TT(){return null}function IT(e,t){var r=typeof e=="function"?e:Rk(e),n=t==null?TT:typeof t=="function"?t:Bv(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function MT(){var e=this.parentNode;e&&e.removeChild(this)}function PT(){return this.each(MT)}function AT(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function DT(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function OT(e){return this.select(e?DT:AT)}function LT(e){return arguments.length?this.property("__data__",e):this.node().__data__}function zT(e){return function(t){e.call(this,t,this.__data__)}}function qT(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function $T(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,s=t.length,o;r<s;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function FT(e,t,r){return function(){var n=this.__on,s,o=zT(t);if(n){for(var i=0,a=n.length;i<a;++i)if((s=n[i]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=r),s.value=t;return}}this.addEventListener(e.type,o,r),s={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(s):this.__on=[s]}}function BT(e,t,r){var n=qT(e+""),s,o=n.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,d;c<u;++c)for(s=0,d=a[c];s<o;++s)if((i=n[s]).type===d.type&&i.name===d.name)return d.value}return}for(a=t?FT:$T,s=0;s<o;++s)this.each(a(n[s],t,r));return this}function qk(e,t,r){var n=Ak(e),s=n.CustomEvent;typeof s=="function"?s=new s(t,r):(s=n.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function HT(e,t){return function(){return qk(this,e,t)}}function WT(e,t){return function(){return qk(this,e,t.apply(this,arguments))}}function VT(e,t){return this.each((typeof t=="function"?WT:HT)(e,t))}function*UT(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length,i;s<o;++s)(i=n[s])&&(yield i)}var $k=[null];function Lt(e,t){this._groups=e,this._parents=t}function Wi(){return new Lt([[document.documentElement]],$k)}function GT(){return this}Lt.prototype=Wi.prototype={constructor:Lt,select:y3,selectAll:j3,selectChild:E3,selectChildren:I3,filter:M3,data:z3,enter:P3,exit:$3,join:F3,merge:B3,selection:GT,order:H3,sort:W3,call:U3,nodes:G3,node:K3,size:Y3,empty:X3,each:Q3,attr:sT,style:lT,property:fT,classed:gT,text:bT,html:ST,raise:NT,lower:CT,append:RT,insert:IT,remove:PT,clone:OT,datum:LT,on:BT,dispatch:VT,[Symbol.iterator]:UT};function Kt(e){return typeof e=="string"?new Lt([[document.querySelector(e)]],[document.documentElement]):new Lt([[e]],$k)}function KT(e){let t;for(;t=e.sourceEvent;)e=t;return e}function cr(e,t){if(e=KT(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const YT={passive:!1},Ci={capture:!0,passive:!1};function vu(e){e.stopImmediatePropagation()}function Gs(e){e.preventDefault(),e.stopImmediatePropagation()}function Fk(e){var t=e.document.documentElement,r=Kt(e).on("dragstart.drag",Gs,Ci);"onselectstart"in t?r.on("selectstart.drag",Gs,Ci):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Bk(e,t){var r=e.document.documentElement,n=Kt(e).on("dragstart.drag",null);t&&(n.on("click.drag",Gs,Ci),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const ya=e=>()=>e;function Sg(e,{sourceEvent:t,subject:r,target:n,identifier:s,active:o,x:i,y:a,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}Sg.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function XT(e){return!e.ctrlKey&&!e.button}function QT(){return this.parentNode}function ZT(e,t){return t??{x:e.x,y:e.y}}function JT(){return navigator.maxTouchPoints||"ontouchstart"in this}function eI(){var e=XT,t=QT,r=ZT,n=JT,s={},o=lc("start","drag","end"),i=0,a,c,u,d,f=0;function p(w){w.on("mousedown.drag",h).filter(n).on("touchstart.drag",_).on("touchmove.drag",g,YT).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,j){if(!(d||!e.call(this,w,j))){var k=b(this,t.call(this,w,j),w,j,"mouse");k&&(Kt(w.view).on("mousemove.drag",y,Ci).on("mouseup.drag",v,Ci),Fk(w.view),vu(w),u=!1,a=w.clientX,c=w.clientY,k("start",w))}}function y(w){if(Gs(w),!u){var j=w.clientX-a,k=w.clientY-c;u=j*j+k*k>f}s.mouse("drag",w)}function v(w){Kt(w.view).on("mousemove.drag mouseup.drag",null),Bk(w.view,u),Gs(w),s.mouse("end",w)}function _(w,j){if(e.call(this,w,j)){var k=w.changedTouches,N=t.call(this,w,j),S=k.length,C,R;for(C=0;C<S;++C)(R=b(this,N,w,j,k[C].identifier,k[C]))&&(vu(w),R("start",w,k[C]))}}function g(w){var j=w.changedTouches,k=j.length,N,S;for(N=0;N<k;++N)(S=s[j[N].identifier])&&(Gs(w),S("drag",w,j[N]))}function x(w){var j=w.changedTouches,k=j.length,N,S;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),N=0;N<k;++N)(S=s[j[N].identifier])&&(vu(w),S("end",w,j[N]))}function b(w,j,k,N,S,C){var R=o.copy(),T=cr(C||k,j),L,q,E;if((E=r.call(w,new Sg("beforestart",{sourceEvent:k,target:p,identifier:S,active:i,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),N))!=null)return L=E.x-T[0]||0,q=E.y-T[1]||0,function D(A,$,O){var M=T,z;switch(A){case"start":s[S]=D,z=i++;break;case"end":delete s[S],--i;case"drag":T=cr(O||$,j),z=i;break}R.call(A,w,new Sg(A,{sourceEvent:$,subject:E,target:p,identifier:S,active:z,x:T[0]+L,y:T[1]+q,dx:T[0]-M[0],dy:T[1]-M[1],dispatch:R}),N)}}return p.filter=function(w){return arguments.length?(e=typeof w=="function"?w:ya(!!w),p):e},p.container=function(w){return arguments.length?(t=typeof w=="function"?w:ya(w),p):t},p.subject=function(w){return arguments.length?(r=typeof w=="function"?w:ya(w),p):r},p.touchable=function(w){return arguments.length?(n=typeof w=="function"?w:ya(!!w),p):n},p.on=function(){var w=o.on.apply(o,arguments);return w===o?p:w},p.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,p):Math.sqrt(f)},p}function Wv(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Hk(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Vi(){}var Ri=.7,Nl=1/Ri,Ks="\\s*([+-]?\\d+)\\s*",Ti="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tI=/^#([0-9a-f]{3,8})$/,rI=new RegExp(`^rgb\\(${Ks},${Ks},${Ks}\\)$`),nI=new RegExp(`^rgb\\(${Tr},${Tr},${Tr}\\)$`),sI=new RegExp(`^rgba\\(${Ks},${Ks},${Ks},${Ti}\\)$`),oI=new RegExp(`^rgba\\(${Tr},${Tr},${Tr},${Ti}\\)$`),iI=new RegExp(`^hsl\\(${Ti},${Tr},${Tr}\\)$`),aI=new RegExp(`^hsla\\(${Ti},${Tr},${Tr},${Ti}\\)$`),Yy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wv(Vi,Ii,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Xy,formatHex:Xy,formatHex8:lI,formatHsl:cI,formatRgb:Qy,toString:Qy});function Xy(){return this.rgb().formatHex()}function lI(){return this.rgb().formatHex8()}function cI(){return Wk(this).formatHsl()}function Qy(){return this.rgb().formatRgb()}function Ii(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=tI.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Zy(t):r===3?new St(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ba(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=rI.exec(e))?new St(t[1],t[2],t[3],1):(t=nI.exec(e))?new St(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=sI.exec(e))?ba(t[1],t[2],t[3],t[4]):(t=oI.exec(e))?ba(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=iI.exec(e))?t0(t[1],t[2]/100,t[3]/100,1):(t=aI.exec(e))?t0(t[1],t[2]/100,t[3]/100,t[4]):Yy.hasOwnProperty(e)?Zy(Yy[e]):e==="transparent"?new St(NaN,NaN,NaN,0):null}function Zy(e){return new St(e>>16&255,e>>8&255,e&255,1)}function ba(e,t,r,n){return n<=0&&(e=t=r=NaN),new St(e,t,r,n)}function uI(e){return e instanceof Vi||(e=Ii(e)),e?(e=e.rgb(),new St(e.r,e.g,e.b,e.opacity)):new St}function kg(e,t,r,n){return arguments.length===1?uI(e):new St(e,t,r,n??1)}function St(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Wv(St,kg,Hk(Vi,{brighter(e){return e=e==null?Nl:Math.pow(Nl,e),new St(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ri:Math.pow(Ri,e),new St(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new St(ss(this.r),ss(this.g),ss(this.b),El(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jy,formatHex:Jy,formatHex8:dI,formatRgb:e0,toString:e0}));function Jy(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}`}function dI(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}${Jn((isNaN(this.opacity)?1:this.opacity)*255)}`}function e0(){const e=El(this.opacity);return`${e===1?"rgb(":"rgba("}${ss(this.r)}, ${ss(this.g)}, ${ss(this.b)}${e===1?")":`, ${e})`}`}function El(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ss(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jn(e){return e=ss(e),(e<16?"0":"")+e.toString(16)}function t0(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new dr(e,t,r,n)}function Wk(e){if(e instanceof dr)return new dr(e.h,e.s,e.l,e.opacity);if(e instanceof Vi||(e=Ii(e)),!e)return new dr;if(e instanceof dr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),o=Math.max(t,r,n),i=NaN,a=o-s,c=(o+s)/2;return a?(t===o?i=(r-n)/a+(r<n)*6:r===o?i=(n-t)/a+2:i=(t-r)/a+4,a/=c<.5?o+s:2-o-s,i*=60):a=c>0&&c<1?0:i,new dr(i,a,c,e.opacity)}function fI(e,t,r,n){return arguments.length===1?Wk(e):new dr(e,t,r,n??1)}function dr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Wv(dr,fI,Hk(Vi,{brighter(e){return e=e==null?Nl:Math.pow(Nl,e),new dr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ri:Math.pow(Ri,e),new dr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new St(xu(e>=240?e-240:e+120,s,n),xu(e,s,n),xu(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new dr(r0(this.h),wa(this.s),wa(this.l),El(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=El(this.opacity);return`${e===1?"hsl(":"hsla("}${r0(this.h)}, ${wa(this.s)*100}%, ${wa(this.l)*100}%${e===1?")":`, ${e})`}`}}));function r0(e){return e=(e||0)%360,e<0?e+360:e}function wa(e){return Math.max(0,Math.min(1,e||0))}function xu(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Vk=e=>()=>e;function pI(e,t){return function(r){return e+r*t}}function hI(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function mI(e){return(e=+e)==1?Uk:function(t,r){return r-t?hI(t,r,e):Vk(isNaN(t)?r:t)}}function Uk(e,t){var r=t-e;return r?pI(e,r):Vk(isNaN(e)?t:e)}const n0=function e(t){var r=mI(t);function n(s,o){var i=r((s=kg(s)).r,(o=kg(o)).r),a=r(s.g,o.g),c=r(s.b,o.b),u=Uk(s.opacity,o.opacity);return function(d){return s.r=i(d),s.g=a(d),s.b=c(d),s.opacity=u(d),s+""}}return n.gamma=e,n}(1);function fn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var Ng=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yu=new RegExp(Ng.source,"g");function gI(e){return function(){return e}}function vI(e){return function(t){return e(t)+""}}function xI(e,t){var r=Ng.lastIndex=yu.lastIndex=0,n,s,o,i=-1,a=[],c=[];for(e=e+"",t=t+"";(n=Ng.exec(e))&&(s=yu.exec(t));)(o=s.index)>r&&(o=t.slice(r,o),a[i]?a[i]+=o:a[++i]=o),(n=n[0])===(s=s[0])?a[i]?a[i]+=s:a[++i]=s:(a[++i]=null,c.push({i,x:fn(n,s)})),r=yu.lastIndex;return r<t.length&&(o=t.slice(r),a[i]?a[i]+=o:a[++i]=o),a.length<2?c[0]?vI(c[0].x):gI(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)a[(f=c[d]).i]=f.x(u);return a.join("")})}var s0=180/Math.PI,Eg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Gk(e,t,r,n,s,o){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,c/=a),e*n<t*r&&(e=-e,t=-t,c=-c,i=-i),{translateX:s,translateY:o,rotate:Math.atan2(t,e)*s0,skewX:Math.atan(c)*s0,scaleX:i,scaleY:a}}var _a;function yI(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Eg:Gk(t.a,t.b,t.c,t.d,t.e,t.f)}function bI(e){return e==null||(_a||(_a=document.createElementNS("http://www.w3.org/2000/svg","g")),_a.setAttribute("transform",e),!(e=_a.transform.baseVal.consolidate()))?Eg:(e=e.matrix,Gk(e.a,e.b,e.c,e.d,e.e,e.f))}function Kk(e,t,r,n){function s(u){return u.length?u.pop()+" ":""}function o(u,d,f,p,h,y){if(u!==f||d!==p){var v=h.push("translate(",null,t,null,r);y.push({i:v-4,x:fn(u,f)},{i:v-2,x:fn(d,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function i(u,d,f,p){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),p.push({i:f.push(s(f)+"rotate(",null,n)-2,x:fn(u,d)})):d&&f.push(s(f)+"rotate("+d+n)}function a(u,d,f,p){u!==d?p.push({i:f.push(s(f)+"skewX(",null,n)-2,x:fn(u,d)}):d&&f.push(s(f)+"skewX("+d+n)}function c(u,d,f,p,h,y){if(u!==f||d!==p){var v=h.push(s(h)+"scale(",null,",",null,")");y.push({i:v-4,x:fn(u,f)},{i:v-2,x:fn(d,p)})}else(f!==1||p!==1)&&h.push(s(h)+"scale("+f+","+p+")")}return function(u,d){var f=[],p=[];return u=e(u),d=e(d),o(u.translateX,u.translateY,d.translateX,d.translateY,f,p),i(u.rotate,d.rotate,f,p),a(u.skewX,d.skewX,f,p),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,p),u=d=null,function(h){for(var y=-1,v=p.length,_;++y<v;)f[(_=p[y]).i]=_.x(h);return f.join("")}}}var wI=Kk(yI,"px, ","px)","deg)"),_I=Kk(bI,", ",")",")"),jI=1e-12;function o0(e){return((e=Math.exp(e))+1/e)/2}function SI(e){return((e=Math.exp(e))-1/e)/2}function kI(e){return((e=Math.exp(2*e))-1)/(e+1)}const NI=function e(t,r,n){function s(o,i){var a=o[0],c=o[1],u=o[2],d=i[0],f=i[1],p=i[2],h=d-a,y=f-c,v=h*h+y*y,_,g;if(v<jI)g=Math.log(p/u)/t,_=function(N){return[a+N*h,c+N*y,u*Math.exp(t*N*g)]};else{var x=Math.sqrt(v),b=(p*p-u*u+n*v)/(2*u*r*x),w=(p*p-u*u-n*v)/(2*p*r*x),j=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(w*w+1)-w);g=(k-j)/t,_=function(N){var S=N*g,C=o0(j),R=u/(r*x)*(C*kI(t*S+j)-SI(j));return[a+R*h,c+R*y,u*C/o0(t*S+j)]}}return _.duration=g*1e3*t/Math.SQRT2,_}return s.rho=function(o){var i=Math.max(.001,+o),a=i*i,c=a*a;return e(i,a,c)},s}(Math.SQRT2,2,4);var io=0,Wo=0,Po=0,Yk=1e3,Cl,Vo,Rl=0,ds=0,uc=0,Mi=typeof performance=="object"&&performance.now?performance:Date,Xk=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Vv(){return ds||(Xk(EI),ds=Mi.now()+uc)}function EI(){ds=0}function Tl(){this._call=this._time=this._next=null}Tl.prototype=Qk.prototype={constructor:Tl,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Vv():+r)+(t==null?0:+t),!this._next&&Vo!==this&&(Vo?Vo._next=this:Cl=this,Vo=this),this._call=e,this._time=r,Cg()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cg())}};function Qk(e,t,r){var n=new Tl;return n.restart(e,t,r),n}function CI(){Vv(),++io;for(var e=Cl,t;e;)(t=ds-e._time)>=0&&e._call.call(void 0,t),e=e._next;--io}function i0(){ds=(Rl=Mi.now())+uc,io=Wo=0;try{CI()}finally{io=0,TI(),ds=0}}function RI(){var e=Mi.now(),t=e-Rl;t>Yk&&(uc-=t,Rl=e)}function TI(){for(var e,t=Cl,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Cl=r);Vo=e,Cg(n)}function Cg(e){if(!io){Wo&&(Wo=clearTimeout(Wo));var t=e-ds;t>24?(e<1/0&&(Wo=setTimeout(i0,e-Mi.now()-uc)),Po&&(Po=clearInterval(Po))):(Po||(Rl=Mi.now(),Po=setInterval(RI,Yk)),io=1,Xk(i0))}}function a0(e,t,r){var n=new Tl;return t=t==null?0:+t,n.restart(s=>{n.stop(),e(s+t)},t,r),n}var II=lc("start","end","cancel","interrupt"),MI=[],Zk=0,l0=1,Rg=2,Qa=3,c0=4,Tg=5,Za=6;function dc(e,t,r,n,s,o){var i=e.__transition;if(!i)e.__transition={};else if(r in i)return;PI(e,r,{name:t,index:n,group:s,on:II,tween:MI,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Zk})}function Uv(e,t){var r=gr(e,t);if(r.state>Zk)throw new Error("too late; already scheduled");return r}function Pr(e,t){var r=gr(e,t);if(r.state>Qa)throw new Error("too late; already running");return r}function gr(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function PI(e,t,r){var n=e.__transition,s;n[t]=r,r.timer=Qk(o,0,r.time);function o(u){r.state=l0,r.timer.restart(i,r.delay,r.time),r.delay<=u&&i(u-r.delay)}function i(u){var d,f,p,h;if(r.state!==l0)return c();for(d in n)if(h=n[d],h.name===r.name){if(h.state===Qa)return a0(i);h.state===c0?(h.state=Za,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[d]):+d<t&&(h.state=Za,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[d])}if(a0(function(){r.state===Qa&&(r.state=c0,r.timer.restart(a,r.delay,r.time),a(u))}),r.state=Rg,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Rg){for(r.state=Qa,s=new Array(p=r.tween.length),d=0,f=-1;d<p;++d)(h=r.tween[d].value.call(e,e.__data__,r.index,r.group))&&(s[++f]=h);s.length=f+1}}function a(u){for(var d=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=Tg,1),f=-1,p=s.length;++f<p;)s[f].call(e,d);r.state===Tg&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Za,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function Ja(e,t){var r=e.__transition,n,s,o=!0,i;if(r){t=t==null?null:t+"";for(i in r){if((n=r[i]).name!==t){o=!1;continue}s=n.state>Rg&&n.state<Tg,n.state=Za,n.timer.stop(),n.on.call(s?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[i]}o&&delete e.__transition}}function AI(e){return this.each(function(){Ja(this,e)})}function DI(e,t){var r,n;return function(){var s=Pr(this,e),o=s.tween;if(o!==r){n=r=o;for(var i=0,a=n.length;i<a;++i)if(n[i].name===t){n=n.slice(),n.splice(i,1);break}}s.tween=n}}function OI(e,t,r){var n,s;if(typeof r!="function")throw new Error;return function(){var o=Pr(this,e),i=o.tween;if(i!==n){s=(n=i).slice();for(var a={name:t,value:r},c=0,u=s.length;c<u;++c)if(s[c].name===t){s[c]=a;break}c===u&&s.push(a)}o.tween=s}}function LI(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=gr(this.node(),r).tween,s=0,o=n.length,i;s<o;++s)if((i=n[s]).name===e)return i.value;return null}return this.each((t==null?DI:OI)(r,e,t))}function Gv(e,t,r){var n=e._id;return e.each(function(){var s=Pr(this,n);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return gr(s,n).value[t]}}function Jk(e,t){var r;return(typeof t=="number"?fn:t instanceof Ii?n0:(r=Ii(t))?(t=r,n0):xI)(e,t)}function zI(e){return function(){this.removeAttribute(e)}}function qI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $I(e,t,r){var n,s=r+"",o;return function(){var i=this.getAttribute(e);return i===s?null:i===n?o:o=t(n=i,r)}}function FI(e,t,r){var n,s=r+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===s?null:i===n?o:o=t(n=i,r)}}function BI(e,t,r){var n,s,o;return function(){var i,a=r(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===n&&c===s?o:(s=c,o=t(n=i,a)))}}function HI(e,t,r){var n,s,o;return function(){var i,a=r(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===n&&c===s?o:(s=c,o=t(n=i,a)))}}function WI(e,t){var r=cc(e),n=r==="transform"?_I:Jk;return this.attrTween(e,typeof t=="function"?(r.local?HI:BI)(r,n,Gv(this,"attr."+e,t)):t==null?(r.local?qI:zI)(r):(r.local?FI:$I)(r,n,t))}function VI(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function UI(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function GI(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&UI(e,o)),r}return s._value=t,s}function KI(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&VI(e,o)),r}return s._value=t,s}function YI(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=cc(e);return this.tween(r,(n.local?GI:KI)(n,t))}function XI(e,t){return function(){Uv(this,e).delay=+t.apply(this,arguments)}}function QI(e,t){return t=+t,function(){Uv(this,e).delay=t}}function ZI(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?XI:QI)(t,e)):gr(this.node(),t).delay}function JI(e,t){return function(){Pr(this,e).duration=+t.apply(this,arguments)}}function eM(e,t){return t=+t,function(){Pr(this,e).duration=t}}function tM(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?JI:eM)(t,e)):gr(this.node(),t).duration}function rM(e,t){if(typeof t!="function")throw new Error;return function(){Pr(this,e).ease=t}}function nM(e){var t=this._id;return arguments.length?this.each(rM(t,e)):gr(this.node(),t).ease}function sM(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Pr(this,e).ease=r}}function oM(e){if(typeof e!="function")throw new Error;return this.each(sM(this._id,e))}function iM(e){typeof e!="function"&&(e=Ik(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],i=o.length,a=n[s]=[],c,u=0;u<i;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&a.push(c);return new Zr(n,this._parents,this._name,this._id)}function aM(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,s=r.length,o=Math.min(n,s),i=new Array(n),a=0;a<o;++a)for(var c=t[a],u=r[a],d=c.length,f=i[a]=new Array(d),p,h=0;h<d;++h)(p=c[h]||u[h])&&(f[h]=p);for(;a<n;++a)i[a]=t[a];return new Zr(i,this._parents,this._name,this._id)}function lM(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function cM(e,t,r){var n,s,o=lM(t)?Uv:Pr;return function(){var i=o(this,e),a=i.on;a!==n&&(s=(n=a).copy()).on(t,r),i.on=s}}function uM(e,t){var r=this._id;return arguments.length<2?gr(this.node(),r).on.on(e):this.each(cM(r,e,t))}function dM(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function fM(){return this.on("end.remove",dM(this._id))}function pM(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Bv(e));for(var n=this._groups,s=n.length,o=new Array(s),i=0;i<s;++i)for(var a=n[i],c=a.length,u=o[i]=new Array(c),d,f,p=0;p<c;++p)(d=a[p])&&(f=e.call(d,d.__data__,p,a))&&("__data__"in d&&(f.__data__=d.__data__),u[p]=f,dc(u[p],t,r,p,u,gr(d,r)));return new Zr(o,this._parents,t,r)}function hM(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Tk(e));for(var n=this._groups,s=n.length,o=[],i=[],a=0;a<s;++a)for(var c=n[a],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var p=e.call(d,d.__data__,f,c),h,y=gr(d,r),v=0,_=p.length;v<_;++v)(h=p[v])&&dc(h,t,r,v,p,y);o.push(p),i.push(d)}return new Zr(o,i,t,r)}var mM=Wi.prototype.constructor;function gM(){return new mM(this._groups,this._parents)}function vM(e,t){var r,n,s;return function(){var o=oo(this,e),i=(this.style.removeProperty(e),oo(this,e));return o===i?null:o===r&&i===n?s:s=t(r=o,n=i)}}function eN(e){return function(){this.style.removeProperty(e)}}function xM(e,t,r){var n,s=r+"",o;return function(){var i=oo(this,e);return i===s?null:i===n?o:o=t(n=i,r)}}function yM(e,t,r){var n,s,o;return function(){var i=oo(this,e),a=r(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),oo(this,e))),i===c?null:i===n&&c===s?o:(s=c,o=t(n=i,a))}}function bM(e,t){var r,n,s,o="style."+t,i="end."+o,a;return function(){var c=Pr(this,e),u=c.on,d=c.value[o]==null?a||(a=eN(t)):void 0;(u!==r||s!==d)&&(n=(r=u).copy()).on(i,s=d),c.on=n}}function wM(e,t,r){var n=(e+="")=="transform"?wI:Jk;return t==null?this.styleTween(e,vM(e,n)).on("end.style."+e,eN(e)):typeof t=="function"?this.styleTween(e,yM(e,n,Gv(this,"style."+e,t))).each(bM(this._id,e)):this.styleTween(e,xM(e,n,t),r).on("end.style."+e,null)}function _M(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function jM(e,t,r){var n,s;function o(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&_M(e,i,r)),n}return o._value=t,o}function SM(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,jM(e,t,r??""))}function kM(e){return function(){this.textContent=e}}function NM(e){return function(){var t=e(this);this.textContent=t??""}}function EM(e){return this.tween("text",typeof e=="function"?NM(Gv(this,"text",e)):kM(e==null?"":e+""))}function CM(e){return function(t){this.textContent=e.call(this,t)}}function RM(e){var t,r;function n(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&CM(s)),t}return n._value=e,n}function TM(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,RM(e))}function IM(){for(var e=this._name,t=this._id,r=tN(),n=this._groups,s=n.length,o=0;o<s;++o)for(var i=n[o],a=i.length,c,u=0;u<a;++u)if(c=i[u]){var d=gr(c,t);dc(c,e,r,u,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Zr(n,this._parents,e,r)}function MM(){var e,t,r=this,n=r._id,s=r.size();return new Promise(function(o,i){var a={value:i},c={value:function(){--s===0&&o()}};r.each(function(){var u=Pr(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),s===0&&o()})}var PM=0;function Zr(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function tN(){return++PM}var Dr=Wi.prototype;Zr.prototype={constructor:Zr,select:pM,selectAll:hM,selectChild:Dr.selectChild,selectChildren:Dr.selectChildren,filter:iM,merge:aM,selection:gM,transition:IM,call:Dr.call,nodes:Dr.nodes,node:Dr.node,size:Dr.size,empty:Dr.empty,each:Dr.each,on:uM,attr:WI,attrTween:YI,style:wM,styleTween:SM,text:EM,textTween:TM,remove:fM,tween:LI,delay:ZI,duration:tM,ease:nM,easeVarying:oM,end:MM,[Symbol.iterator]:Dr[Symbol.iterator]};function AM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var DM={time:null,delay:0,duration:250,ease:AM};function OM(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function LM(e){var t,r;e instanceof Zr?(t=e._id,e=e._name):(t=tN(),(r=DM).time=Vv(),e=e==null?null:e+"");for(var n=this._groups,s=n.length,o=0;o<s;++o)for(var i=n[o],a=i.length,c,u=0;u<a;++u)(c=i[u])&&dc(c,e,t,u,i,r||OM(c,t));return new Zr(n,this._parents,e,t)}Wi.prototype.interrupt=AI;Wi.prototype.transition=LM;const ja=e=>()=>e;function zM(e,{sourceEvent:t,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function Hr(e,t,r){this.k=e,this.x=t,this.y=r}Hr.prototype={constructor:Hr,scale:function(e){return e===1?this:new Hr(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Hr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Gr=new Hr(1,0,0);Hr.prototype;function bu(e){e.stopImmediatePropagation()}function Ao(e){e.preventDefault(),e.stopImmediatePropagation()}function qM(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function $M(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function u0(){return this.__zoom||Gr}function FM(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function BM(){return navigator.maxTouchPoints||"ontouchstart"in this}function HM(e,t,r){var n=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],i=e.invertY(t[1][1])-r[1][1];return e.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function rN(){var e=qM,t=$M,r=HM,n=FM,s=BM,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=NI,u=lc("start","zoom","end"),d,f,p,h=500,y=150,v=0,_=10;function g(E){E.property("__zoom",u0).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",R).filter(s).on("touchstart.zoom",T).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(E,D,A,$){var O=E.selection?E.selection():E;O.property("__zoom",u0),E!==O?j(E,D,A,$):O.interrupt().each(function(){k(this,arguments).event($).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},g.scaleBy=function(E,D,A,$){g.scaleTo(E,function(){var O=this.__zoom.k,M=typeof D=="function"?D.apply(this,arguments):D;return O*M},A,$)},g.scaleTo=function(E,D,A,$){g.transform(E,function(){var O=t.apply(this,arguments),M=this.__zoom,z=A==null?w(O):typeof A=="function"?A.apply(this,arguments):A,P=M.invert(z),I=typeof D=="function"?D.apply(this,arguments):D;return r(b(x(M,I),z,P),O,i)},A,$)},g.translateBy=function(E,D,A,$){g.transform(E,function(){return r(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),i)},null,$)},g.translateTo=function(E,D,A,$,O){g.transform(E,function(){var M=t.apply(this,arguments),z=this.__zoom,P=$==null?w(M):typeof $=="function"?$.apply(this,arguments):$;return r(Gr.translate(P[0],P[1]).scale(z.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof A=="function"?-A.apply(this,arguments):-A),M,i)},$,O)};function x(E,D){return D=Math.max(o[0],Math.min(o[1],D)),D===E.k?E:new Hr(D,E.x,E.y)}function b(E,D,A){var $=D[0]-A[0]*E.k,O=D[1]-A[1]*E.k;return $===E.x&&O===E.y?E:new Hr(E.k,$,O)}function w(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function j(E,D,A,$){E.on("start.zoom",function(){k(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event($).end()}).tween("zoom",function(){var O=this,M=arguments,z=k(O,M).event($),P=t.apply(O,M),I=A==null?w(P):typeof A=="function"?A.apply(O,M):A,F=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),V=O.__zoom,G=typeof D=="function"?D.apply(O,M):D,X=c(V.invert(I).concat(F/V.k),G.invert(I).concat(F/G.k));return function(te){if(te===1)te=G;else{var se=X(te),re=F/se[2];te=new Hr(re,I[0]-se[0]*re,I[1]-se[1]*re)}z.zoom(null,te)}})}function k(E,D,A){return!A&&E.__zooming||new N(E,D)}function N(E,D){this.that=E,this.args=D,this.active=0,this.sourceEvent=null,this.extent=t.apply(E,D),this.taps=0}N.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,D){return this.mouse&&E!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var D=Kt(this.that).datum();u.call(E,this.that,new zM(E,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:u}),D)}};function S(E,...D){if(!e.apply(this,arguments))return;var A=k(this,D).event(E),$=this.__zoom,O=Math.max(o[0],Math.min(o[1],$.k*Math.pow(2,n.apply(this,arguments)))),M=cr(E);if(A.wheel)(A.mouse[0][0]!==M[0]||A.mouse[0][1]!==M[1])&&(A.mouse[1]=$.invert(A.mouse[0]=M)),clearTimeout(A.wheel);else{if($.k===O)return;A.mouse=[M,$.invert(M)],Ja(this),A.start()}Ao(E),A.wheel=setTimeout(z,y),A.zoom("mouse",r(b(x($,O),A.mouse[0],A.mouse[1]),A.extent,i));function z(){A.wheel=null,A.end()}}function C(E,...D){if(p||!e.apply(this,arguments))return;var A=E.currentTarget,$=k(this,D,!0).event(E),O=Kt(E.view).on("mousemove.zoom",I,!0).on("mouseup.zoom",F,!0),M=cr(E,A),z=E.clientX,P=E.clientY;Fk(E.view),bu(E),$.mouse=[M,this.__zoom.invert(M)],Ja(this),$.start();function I(V){if(Ao(V),!$.moved){var G=V.clientX-z,X=V.clientY-P;$.moved=G*G+X*X>v}$.event(V).zoom("mouse",r(b($.that.__zoom,$.mouse[0]=cr(V,A),$.mouse[1]),$.extent,i))}function F(V){O.on("mousemove.zoom mouseup.zoom",null),Bk(V.view,$.moved),Ao(V),$.event(V).end()}}function R(E,...D){if(e.apply(this,arguments)){var A=this.__zoom,$=cr(E.changedTouches?E.changedTouches[0]:E,this),O=A.invert($),M=A.k*(E.shiftKey?.5:2),z=r(b(x(A,M),$,O),t.apply(this,D),i);Ao(E),a>0?Kt(this).transition().duration(a).call(j,z,$,E):Kt(this).call(g.transform,z,$,E)}}function T(E,...D){if(e.apply(this,arguments)){var A=E.touches,$=A.length,O=k(this,D,E.changedTouches.length===$).event(E),M,z,P,I;for(bu(E),z=0;z<$;++z)P=A[z],I=cr(P,this),I=[I,this.__zoom.invert(I),P.identifier],O.touch0?!O.touch1&&O.touch0[2]!==I[2]&&(O.touch1=I,O.taps=0):(O.touch0=I,M=!0,O.taps=1+!!d);d&&(d=clearTimeout(d)),M&&(O.taps<2&&(f=I[0],d=setTimeout(function(){d=null},h)),Ja(this),O.start())}}function L(E,...D){if(this.__zooming){var A=k(this,D).event(E),$=E.changedTouches,O=$.length,M,z,P,I;for(Ao(E),M=0;M<O;++M)z=$[M],P=cr(z,this),A.touch0&&A.touch0[2]===z.identifier?A.touch0[0]=P:A.touch1&&A.touch1[2]===z.identifier&&(A.touch1[0]=P);if(z=A.that.__zoom,A.touch1){var F=A.touch0[0],V=A.touch0[1],G=A.touch1[0],X=A.touch1[1],te=(te=G[0]-F[0])*te+(te=G[1]-F[1])*te,se=(se=X[0]-V[0])*se+(se=X[1]-V[1])*se;z=x(z,Math.sqrt(te/se)),P=[(F[0]+G[0])/2,(F[1]+G[1])/2],I=[(V[0]+X[0])/2,(V[1]+X[1])/2]}else if(A.touch0)P=A.touch0[0],I=A.touch0[1];else return;A.zoom("touch",r(b(z,P,I),A.extent,i))}}function q(E,...D){if(this.__zooming){var A=k(this,D).event(E),$=E.changedTouches,O=$.length,M,z;for(bu(E),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),M=0;M<O;++M)z=$[M],A.touch0&&A.touch0[2]===z.identifier?delete A.touch0:A.touch1&&A.touch1[2]===z.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(z=cr(z,this),Math.hypot(f[0]-z[0],f[1]-z[1])<_)){var P=Kt(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return g.wheelDelta=function(E){return arguments.length?(n=typeof E=="function"?E:ja(+E),g):n},g.filter=function(E){return arguments.length?(e=typeof E=="function"?E:ja(!!E),g):e},g.touchable=function(E){return arguments.length?(s=typeof E=="function"?E:ja(!!E),g):s},g.extent=function(E){return arguments.length?(t=typeof E=="function"?E:ja([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),g):t},g.scaleExtent=function(E){return arguments.length?(o[0]=+E[0],o[1]=+E[1],g):[o[0],o[1]]},g.translateExtent=function(E){return arguments.length?(i[0][0]=+E[0][0],i[1][0]=+E[1][0],i[0][1]=+E[0][1],i[1][1]=+E[1][1],g):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},g.constrain=function(E){return arguments.length?(r=E,g):r},g.duration=function(E){return arguments.length?(a=+E,g):a},g.interpolate=function(E){return arguments.length?(c=E,g):c},g.on=function(){var E=u.on.apply(u,arguments);return E===u?g:E},g.clickDistance=function(E){return arguments.length?(v=(E=+E)*E,g):Math.sqrt(v)},g.tapDistance=function(E){return arguments.length?(_=+E,g):_},g}const fc=m.createContext(null),WM=fc.Provider,Jr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},nN=Jr.error001();function Ae(e,t){const r=m.useContext(fc);if(r===null)throw new Error(nN);return Ck(r,e,t)}const rt=()=>{const e=m.useContext(fc);if(e===null)throw new Error(nN);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},VM=e=>e.userSelectionActive?"none":"all";function Tn({position:e,children:t,className:r,style:n,...s}){const o=Ae(VM),i=`${e}`.split("-");return B.createElement("div",{className:Rt(["react-flow__panel",r,...i]),style:{...n,pointerEvents:o},...s},t)}function UM({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:B.createElement(Tn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},B.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const GM=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:s=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...d})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),y=Rt(["react-flow__edge-textwrapper",u]);return m.useEffect(()=>{if(f.current){const v=f.current.getBBox();h({x:v.x,y:v.y,width:v.width,height:v.height})}},[r]),typeof r>"u"||!r?null:B.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:y,visibility:p.width?"visible":"hidden",...d},s&&B.createElement("rect",{width:p.width+2*i[0],x:-i[0],y:-i[1],height:p.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:a,ry:a}),B.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var KM=m.memo(GM);const Kv=e=>({width:e.offsetWidth,height:e.offsetHeight}),ao=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Yv=(e={x:0,y:0},t)=>({x:ao(e.x,t[0][0],t[1][0]),y:ao(e.y,t[0][1],t[1][1])}),d0=(e,t,r)=>e<t?ao(Math.abs(e-t),1,50)/50:e>r?-ao(Math.abs(e-r),1,50)/50:0,sN=(e,t)=>{const r=d0(e.x,35,t.width-35)*20,n=d0(e.y,35,t.height-35)*20;return[r,n]},oN=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},iN=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Pi=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),aN=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),f0=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),YM=(e,t)=>aN(iN(Pi(e),Pi(t))),Ig=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},XM=e=>Xt(e.width)&&Xt(e.height)&&Xt(e.x)&&Xt(e.y),Xt=e=>!isNaN(e)&&isFinite(e),$e=Symbol.for("internals"),lN=["Enter"," ","Escape"],QM=(e,t)=>{},ZM=e=>"nativeEvent"in e;function Mg(e){var s,o;const t=ZM(e)?e.nativeEvent:e,r=((o=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:o[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const cN=e=>"clientX"in e,In=(e,t)=>{var o,i;const r=cN(e),n=r?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,s=r?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},Il=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Ui=({id:e,path:t,labelX:r,labelY:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:h=20})=>B.createElement(B.Fragment,null,B.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&B.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&Xt(r)&&Xt(n)?B.createElement(KM,{x:r,y:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);Ui.displayName="BaseEdge";function Do(e,t,r){return r===void 0?r:n=>{const s=t().edges.find(o=>o.id===e);s&&r(n,{...s})}}function uN({sourceX:e,sourceY:t,targetX:r,targetY:n}){const s=Math.abs(r-e)/2,o=r<e?r+s:r-s,i=Math.abs(n-t)/2,a=n<t?n+i:n-i;return[o,a,s,i]}function dN({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:s,sourceControlY:o,targetControlX:i,targetControlY:a}){const c=e*.125+s*.375+i*.375+r*.125,u=t*.125+o*.375+a*.375+n*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}var fs;(function(e){e.Strict="strict",e.Loose="loose"})(fs||(fs={}));var es;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(es||(es={}));var Ai;(function(e){e.Partial="partial",e.Full="full"})(Ai||(Ai={}));var vn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(vn||(vn={}));var Ml;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Ml||(Ml={}));var J;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(J||(J={}));function p0({pos:e,x1:t,y1:r,x2:n,y2:s}){return e===J.Left||e===J.Right?[.5*(t+n),r]:[t,.5*(r+s)]}function fN({sourceX:e,sourceY:t,sourcePosition:r=J.Bottom,targetX:n,targetY:s,targetPosition:o=J.Top}){const[i,a]=p0({pos:r,x1:e,y1:t,x2:n,y2:s}),[c,u]=p0({pos:o,x1:n,y1:s,x2:e,y2:t}),[d,f,p,h]=dN({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${i},${a} ${c},${u} ${n},${s}`,d,f,p,h]}const Xv=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=J.Bottom,targetPosition:o=J.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,interactionWidth:v})=>{const[_,g,x]=fN({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o});return B.createElement(Ui,{path:_,labelX:g,labelY:x,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,interactionWidth:v})});Xv.displayName="SimpleBezierEdge";const h0={[J.Left]:{x:-1,y:0},[J.Right]:{x:1,y:0},[J.Top]:{x:0,y:-1},[J.Bottom]:{x:0,y:1}},JM=({source:e,sourcePosition:t=J.Bottom,target:r})=>t===J.Left||t===J.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},m0=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function eP({source:e,sourcePosition:t=J.Bottom,target:r,targetPosition:n=J.Top,center:s,offset:o}){const i=h0[t],a=h0[n],c={x:e.x+i.x*o,y:e.y+i.y*o},u={x:r.x+a.x*o,y:r.y+a.y*o},d=JM({source:c,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",p=d[f];let h=[],y,v;const _={x:0,y:0},g={x:0,y:0},[x,b,w,j]=uN({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(i[f]*a[f]===-1){y=s.x??x,v=s.y??b;const N=[{x:y,y:c.y},{x:y,y:u.y}],S=[{x:c.x,y:v},{x:u.x,y:v}];i[f]===p?h=f==="x"?N:S:h=f==="x"?S:N}else{const N=[{x:c.x,y:u.y}],S=[{x:u.x,y:c.y}];if(f==="x"?h=i.x===p?S:N:h=i.y===p?N:S,t===n){const q=Math.abs(e[f]-r[f]);if(q<=o){const E=Math.min(o-1,o-q);i[f]===p?_[f]=(c[f]>e[f]?-1:1)*E:g[f]=(u[f]>r[f]?-1:1)*E}}if(t!==n){const q=f==="x"?"y":"x",E=i[f]===a[q],D=c[q]>u[q],A=c[q]<u[q];(i[f]===1&&(!E&&D||E&&A)||i[f]!==1&&(!E&&A||E&&D))&&(h=f==="x"?N:S)}const C={x:c.x+_.x,y:c.y+_.y},R={x:u.x+g.x,y:u.y+g.y},T=Math.max(Math.abs(C.x-h[0].x),Math.abs(R.x-h[0].x)),L=Math.max(Math.abs(C.y-h[0].y),Math.abs(R.y-h[0].y));T>=L?(y=(C.x+R.x)/2,v=h[0].y):(y=h[0].x,v=(C.y+R.y)/2)}return[[e,{x:c.x+_.x,y:c.y+_.y},...h,{x:u.x+g.x,y:u.y+g.y},r],y,v,w,j]}function tP(e,t,r,n){const s=Math.min(m0(e,t)/2,m0(t,r)/2,n),{x:o,y:i}=t;if(e.x===o&&o===r.x||e.y===i&&i===r.y)return`L${o} ${i}`;if(e.y===i){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${o+s*u},${i}Q ${o},${i} ${o},${i+s*d}`}const a=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${i+s*c}Q ${o},${i} ${o+s*a},${i}`}function Pg({sourceX:e,sourceY:t,sourcePosition:r=J.Bottom,targetX:n,targetY:s,targetPosition:o=J.Top,borderRadius:i=5,centerX:a,centerY:c,offset:u=20}){const[d,f,p,h,y]=eP({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:s},targetPosition:o,center:{x:a,y:c},offset:u});return[d.reduce((_,g,x)=>{let b="";return x>0&&x<d.length-1?b=tP(d[x-1],g,d[x+1],i):b=`${x===0?"M":"L"}${g.x} ${g.y}`,_+=b,_},""),f,p,h,y]}const pc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,sourcePosition:f=J.Bottom,targetPosition:p=J.Top,markerEnd:h,markerStart:y,pathOptions:v,interactionWidth:_})=>{const[g,x,b]=Pg({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:v==null?void 0:v.borderRadius,offset:v==null?void 0:v.offset});return B.createElement(Ui,{path:g,labelX:x,labelY:b,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:h,markerStart:y,interactionWidth:_})});pc.displayName="SmoothStepEdge";const Qv=m.memo(e=>{var t;return B.createElement(pc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Qv.displayName="StepEdge";function rP({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[s,o,i,a]=uN({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,s,o,i,a]}const Zv=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[y,v,_]=rP({sourceX:e,sourceY:t,targetX:r,targetY:n});return B.createElement(Ui,{path:y,labelX:v,labelY:_,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:h})});Zv.displayName="StraightEdge";function Sa(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function g0({pos:e,x1:t,y1:r,x2:n,y2:s,c:o}){switch(e){case J.Left:return[t-Sa(t-n,o),r];case J.Right:return[t+Sa(n-t,o),r];case J.Top:return[t,r-Sa(r-s,o)];case J.Bottom:return[t,r+Sa(s-r,o)]}}function pN({sourceX:e,sourceY:t,sourcePosition:r=J.Bottom,targetX:n,targetY:s,targetPosition:o=J.Top,curvature:i=.25}){const[a,c]=g0({pos:r,x1:e,y1:t,x2:n,y2:s,c:i}),[u,d]=g0({pos:o,x1:n,y1:s,x2:e,y2:t,c:i}),[f,p,h,y]=dN({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${a},${c} ${u},${d} ${n},${s}`,f,p,h,y]}const Pl=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=J.Bottom,targetPosition:o=J.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,pathOptions:v,interactionWidth:_})=>{const[g,x,b]=pN({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o,curvature:v==null?void 0:v.curvature});return B.createElement(Ui,{path:g,labelX:x,labelY:b,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,interactionWidth:_})});Pl.displayName="BezierEdge";const Jv=m.createContext(null),nP=Jv.Provider;Jv.Consumer;const sP=()=>m.useContext(Jv),oP=e=>"id"in e&&"source"in e&&"target"in e,iP=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Ag=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,aP=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),lP=(e,t)=>{if(!e.source||!e.target)return t;let r;return oP(e)?r={...e}:r={...e,id:iP(e)},aP(r,t)?t:t.concat(r)},Dg=({x:e,y:t},[r,n,s],o,[i,a])=>{const c={x:(e-r)/s,y:(t-n)/s};return o?{x:i*Math.round(c.x/i),y:a*Math.round(c.y/a)}:c},hN=({x:e,y:t},[r,n,s])=>({x:e*s+r,y:t*s+n}),os=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-n};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:s}},hc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,s)=>{const{x:o,y:i}=os(s,t).positionAbsolute;return iN(n,Pi({x:o,y:i,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return aN(r)},mN=(e,t,[r,n,s]=[0,0,1],o=!1,i=!1,a=[0,0])=>{const c={x:(t.x-r)/s,y:(t.y-n)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(d=>{const{width:f,height:p,selectable:h=!0,hidden:y=!1}=d;if(i&&!h||y)return!1;const{positionAbsolute:v}=os(d,a),_={x:v.x,y:v.y,width:f||0,height:p||0},g=Ig(c,_),x=typeof f>"u"||typeof p>"u"||f===null||p===null,b=o&&g>0,w=(f||0)*(p||0);(x||b||g>=w||d.dragging)&&u.push(d)}),u},gN=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},vN=(e,t,r,n,s,o=.1)=>{const i=t/(e.width*(1+o)),a=r/(e.height*(1+o)),c=Math.min(i,a),u=ao(c,n,s),d=e.x+e.width/2,f=e.y+e.height/2,p=t/2-d*u,h=r/2-f*u;return{x:p,y:h,zoom:u}},Kn=(e,t=0)=>e.transition().duration(t);function v0(e,t,r,n){return(t[r]||[]).reduce((s,o)=>{var i,a;return`${e.id}-${o.id}-${r}`!==n&&s.push({id:o.id||null,type:r,nodeId:e.id,x:(((i=e.positionAbsolute)==null?void 0:i.x)??0)+o.x+o.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+o.y+o.height/2}),s},[])}function cP(e,t,r,n,s,o){const{x:i,y:a}=In(e),u=t.elementsFromPoint(i,a).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const v=ex(void 0,u),_=u.getAttribute("data-handleid"),g=o({nodeId:y,id:_,type:v});if(g){const x=s.find(b=>b.nodeId===y&&b.type===v&&b.id===_);return{handle:{id:_,type:v,nodeId:y,x:(x==null?void 0:x.x)||r.x,y:(x==null?void 0:x.y)||r.y},validHandleResult:g}}}}let d=[],f=1/0;if(s.forEach(y=>{const v=Math.sqrt((y.x-r.x)**2+(y.y-r.y)**2);if(v<=n){const _=o(y);v<=f&&(v<f?d=[{handle:y,validHandleResult:_}]:v===f&&d.push({handle:y,validHandleResult:_}),f=v)}}),!d.length)return{handle:null,validHandleResult:xN()};if(d.length===1)return d[0];const p=d.some(({validHandleResult:y})=>y.isValid),h=d.some(({handle:y})=>y.type==="target");return d.find(({handle:y,validHandleResult:v})=>h?y.type==="target":p?v.isValid:!0)||d[0]}const uP={source:null,target:null,sourceHandle:null,targetHandle:null},xN=()=>({handleDomNode:null,isValid:!1,connection:uP,endHandle:null});function yN(e,t,r,n,s,o,i){const a=s==="target",c=i.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...xN(),handleDomNode:c};if(c){const d=ex(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),v={source:a?f:r,sourceHandle:a?p:n,target:a?r:f,targetHandle:a?n:p};u.connection=v,h&&y&&(t===fs.Strict?a&&d==="source"||!a&&d==="target":f!==r||p!==n)&&(u.endHandle={nodeId:f,handleId:p,type:d},u.isValid=o(v))}return u}function dP({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((s,o)=>{if(o[$e]){const{handleBounds:i}=o[$e];let a=[],c=[];i&&(a=v0(o,i,"source",`${t}-${r}-${n}`),c=v0(o,i,"target",`${t}-${r}-${n}`)),s.push(...a,...c)}return s},[])}function ex(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function wu(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function fP(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function bN({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:s,getState:o,setState:i,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const d=oN(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:y,onConnectStart:v,panBy:_,getNodes:g,cancelConnection:x}=o();let b=0,w;const{x:j,y:k}=In(e),N=d==null?void 0:d.elementFromPoint(j,k),S=ex(c,N),C=p==null?void 0:p.getBoundingClientRect();if(!C||!S)return;let R,T=In(e,C),L=!1,q=null,E=!1,D=null;const A=dP({nodes:g(),nodeId:r,handleId:t,handleType:S}),$=()=>{if(!h)return;const[z,P]=sN(T,C);_({x:z,y:P}),b=requestAnimationFrame($)};i({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:S,connectionStartHandle:{nodeId:r,handleId:t,type:S},connectionEndHandle:null}),v==null||v(e,{nodeId:r,handleId:t,handleType:S});function O(z){const{transform:P}=o();T=In(z,C);const{handle:I,validHandleResult:F}=cP(z,d,Dg(T,P,!1,[1,1]),y,A,V=>yN(V,f,r,t,s?"target":"source",a,d));if(w=I,L||($(),L=!0),D=F.handleDomNode,q=F.connection,E=F.isValid,i({connectionPosition:w&&E?hN({x:w.x,y:w.y},P):T,connectionStatus:fP(!!w,E),connectionEndHandle:F.endHandle}),!w&&!E&&!D)return wu(R);q.source!==q.target&&D&&(wu(R),R=D,D.classList.add("connecting","react-flow__handle-connecting"),D.classList.toggle("valid",E),D.classList.toggle("react-flow__handle-valid",E))}function M(z){var P,I;(w||D)&&q&&E&&(n==null||n(q)),(I=(P=o()).onConnectEnd)==null||I.call(P,z),c&&(u==null||u(z)),wu(R),x(),cancelAnimationFrame(b),L=!1,E=!1,q=null,D=null,d.removeEventListener("mousemove",O),d.removeEventListener("mouseup",M),d.removeEventListener("touchmove",O),d.removeEventListener("touchend",M)}d.addEventListener("mousemove",O),d.addEventListener("mouseup",M),d.addEventListener("touchmove",O),d.addEventListener("touchend",M)}const x0=()=>!0,pP=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),hP=(e,t,r)=>n=>{const{connectionStartHandle:s,connectionEndHandle:o,connectionClickStartHandle:i}=n;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r}},wN=m.forwardRef(({type:e="source",position:t=J.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:o=!0,id:i,onConnect:a,children:c,className:u,onMouseDown:d,onTouchStart:f,...p},h)=>{var C,R;const y=i||null,v=e==="target",_=rt(),g=sP(),{connectOnClick:x,noPanClassName:b}=Ae(pP,pt),{connecting:w,clickConnecting:j}=Ae(hP(g,y,e),pt);g||(R=(C=_.getState()).onError)==null||R.call(C,"010",Jr.error010());const k=T=>{const{defaultEdgeOptions:L,onConnect:q,hasDefaultEdges:E}=_.getState(),D={...L,...T};if(E){const{edges:A,setEdges:$}=_.getState();$(lP(D,A))}q==null||q(D),a==null||a(D)},N=T=>{if(!g)return;const L=cN(T);s&&(L&&T.button===0||!L)&&bN({event:T,handleId:y,nodeId:g,onConnect:k,isTarget:v,getState:_.getState,setState:_.setState,isValidConnection:r||_.getState().isValidConnection||x0}),L?d==null||d(T):f==null||f(T)},S=T=>{const{onClickConnectStart:L,onClickConnectEnd:q,connectionClickStartHandle:E,connectionMode:D,isValidConnection:A}=_.getState();if(!g||!E&&!s)return;if(!E){L==null||L(T,{nodeId:g,handleId:y,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:g,type:e,handleId:y}});return}const $=oN(T.target),O=r||A||x0,{connection:M,isValid:z}=yN({nodeId:g,id:y,type:e},D,E.nodeId,E.handleId||null,E.type,O,$);z&&k(M),q==null||q(T),_.setState({connectionClickStartHandle:null})};return B.createElement("div",{"data-handleid":y,"data-nodeid":g,"data-handlepos":t,"data-id":`${g}-${y}-${e}`,className:Rt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,u,{source:!v,target:v,connectable:n,connectablestart:s,connectableend:o,connecting:j,connectionindicator:n&&(s&&!w||o&&w)}]),onMouseDown:N,onTouchStart:N,onClick:x?S:void 0,ref:h,...p},c)});wN.displayName="Handle";var Ir=m.memo(wN);const _N=({data:e,isConnectable:t,targetPosition:r=J.Top,sourcePosition:n=J.Bottom})=>B.createElement(B.Fragment,null,B.createElement(Ir,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,B.createElement(Ir,{type:"source",position:n,isConnectable:t}));_N.displayName="DefaultNode";var Og=m.memo(_N);const jN=({data:e,isConnectable:t,sourcePosition:r=J.Bottom})=>B.createElement(B.Fragment,null,e==null?void 0:e.label,B.createElement(Ir,{type:"source",position:r,isConnectable:t}));jN.displayName="InputNode";var SN=m.memo(jN);const kN=({data:e,isConnectable:t,targetPosition:r=J.Top})=>B.createElement(B.Fragment,null,B.createElement(Ir,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);kN.displayName="OutputNode";var NN=m.memo(kN);const tx=()=>null;tx.displayName="GroupNode";const mP=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),ka=e=>e.id;function gP(e,t){return pt(e.selectedNodes.map(ka),t.selectedNodes.map(ka))&&pt(e.selectedEdges.map(ka),t.selectedEdges.map(ka))}const EN=m.memo(({onSelectionChange:e})=>{const t=rt(),{selectedNodes:r,selectedEdges:n}=Ae(mP,gP);return m.useEffect(()=>{const s={nodes:r,edges:n};e==null||e(s),t.getState().onSelectionChange.forEach(o=>o(s))},[r,n,e]),null});EN.displayName="SelectionListener";const vP=e=>!!e.onSelectionChange;function xP({onSelectionChange:e}){const t=Ae(vP);return e||t?B.createElement(EN,{onSelectionChange:e}):null}const yP=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function ws(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function de(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const bP=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:s,onConnectStart:o,onConnectEnd:i,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:d,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:y,minZoom:v,maxZoom:_,nodeExtent:g,onNodesChange:x,onEdgesChange:b,elementsSelectable:w,connectionMode:j,snapGrid:k,snapToGrid:N,translateExtent:S,connectOnClick:C,defaultEdgeOptions:R,fitView:T,fitViewOptions:L,onNodesDelete:q,onEdgesDelete:E,onNodeDrag:D,onNodeDragStart:A,onNodeDragStop:$,onSelectionDrag:O,onSelectionDragStart:M,onSelectionDragStop:z,noPanClassName:P,nodeOrigin:I,rfId:F,autoPanOnConnect:V,autoPanOnNodeDrag:G,onError:X,connectionRadius:te,isValidConnection:se,nodeDragThreshold:re})=>{const{setNodes:Q,setEdges:xe,setDefaultNodesAndEdges:ne,setMinZoom:ye,setMaxZoom:ee,setTranslateExtent:Y,setNodeExtent:pe,reset:W}=Ae(yP,pt),K=rt();return m.useEffect(()=>{const ae=n==null?void 0:n.map(ce=>({...ce,...R}));return ne(r,ae),()=>{W()}},[]),de("defaultEdgeOptions",R,K.setState),de("connectionMode",j,K.setState),de("onConnect",s,K.setState),de("onConnectStart",o,K.setState),de("onConnectEnd",i,K.setState),de("onClickConnectStart",a,K.setState),de("onClickConnectEnd",c,K.setState),de("nodesDraggable",u,K.setState),de("nodesConnectable",d,K.setState),de("nodesFocusable",f,K.setState),de("edgesFocusable",p,K.setState),de("edgesUpdatable",h,K.setState),de("elementsSelectable",w,K.setState),de("elevateNodesOnSelect",y,K.setState),de("snapToGrid",N,K.setState),de("snapGrid",k,K.setState),de("onNodesChange",x,K.setState),de("onEdgesChange",b,K.setState),de("connectOnClick",C,K.setState),de("fitViewOnInit",T,K.setState),de("fitViewOnInitOptions",L,K.setState),de("onNodesDelete",q,K.setState),de("onEdgesDelete",E,K.setState),de("onNodeDrag",D,K.setState),de("onNodeDragStart",A,K.setState),de("onNodeDragStop",$,K.setState),de("onSelectionDrag",O,K.setState),de("onSelectionDragStart",M,K.setState),de("onSelectionDragStop",z,K.setState),de("noPanClassName",P,K.setState),de("nodeOrigin",I,K.setState),de("rfId",F,K.setState),de("autoPanOnConnect",V,K.setState),de("autoPanOnNodeDrag",G,K.setState),de("onError",X,K.setState),de("connectionRadius",te,K.setState),de("isValidConnection",se,K.setState),de("nodeDragThreshold",re,K.setState),ws(e,Q),ws(t,xe),ws(v,ye),ws(_,ee),ws(S,Y),ws(g,pe),null},y0={display:"none"},wP={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},CN="react-flow__node-desc",RN="react-flow__edge-desc",_P="react-flow__aria-live",jP=e=>e.ariaLiveMessage;function SP({rfId:e}){const t=Ae(jP);return B.createElement("div",{id:`${_P}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:wP},t)}function kP({rfId:e,disableKeyboardA11y:t}){return B.createElement(B.Fragment,null,B.createElement("div",{id:`${CN}-${e}`,style:y0},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),B.createElement("div",{id:`${RN}-${e}`,style:y0},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&B.createElement(SP,{rfId:e}))}var Di=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),s=m.useRef(!1),o=m.useRef(new Set([])),[i,a]=m.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),d=u.reduce((f,p)=>f.concat(...p),[]);return[u,d]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const d=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Mg(h))return!1;const v=w0(h.code,a);o.current.add(h[v]),b0(i,o.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Mg(h))return!1;const v=w0(h.code,a);b0(i,o.current,!0)?(n(!1),o.current.clear()):o.current.delete(h[v]),h.key==="Meta"&&o.current.clear(),s.current=!1},p=()=>{o.current.clear(),n(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function b0(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(s=>t.has(s)))}function w0(e,t){return t.includes(e)?"code":"key"}function TN(e,t,r,n){var a,c;const s=e.parentNode||e.parentId;if(!s)return r;const o=t.get(s),i=os(o,n);return TN(o,t,{x:(r.x??0)+i.x,y:(r.y??0)+i.y,z:(((a=o[$e])==null?void 0:a.z)??0)>(r.z??0)?((c=o[$e])==null?void 0:c.z)??0:r.z??0},n)}function IN(e,t,r){e.forEach(n=>{var o;const s=n.parentNode||n.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[n.id]){const{x:i,y:a,z:c}=TN(n,e,{...n.position,z:((o=n[$e])==null?void 0:o.z)??0},t);n.positionAbsolute={x:i,y:a},n[$e].z=c,r!=null&&r[n.id]&&(n[$e].isParent=!0)}})}function _u(e,t,r,n){const s=new Map,o={},i=n?1e3:0;return e.forEach(a=>{var h;const c=(Xt(a.zIndex)?a.zIndex:0)+(a.selected?i:0),u=t.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},f=a.parentNode||a.parentId;f&&(o[f]=!0);const p=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(d,$e,{enumerable:!1,value:{handleBounds:p||(h=u==null?void 0:u[$e])==null?void 0:h.handleBounds,z:c}}),s.set(a.id,d)}),IN(s,r,o),s}function MN(e,t={}){const{getNodes:r,width:n,height:s,minZoom:o,maxZoom:i,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:d,nodeOrigin:f}=e(),p=t.initial&&!u&&d;if(a&&c&&(p||!t.initial)){const y=r().filter(_=>{var x;const g=t.includeHiddenNodes?_.width&&_.height:!_.hidden;return(x=t.nodes)!=null&&x.length?g&&t.nodes.some(b=>b.id===_.id):g}),v=y.every(_=>_.width&&_.height);if(y.length>0&&v){const _=hc(y,f),{x:g,y:x,zoom:b}=vN(_,n,s,t.minZoom??o,t.maxZoom??i,t.padding??.1),w=Gr.translate(g,x).scale(b);return typeof t.duration=="number"&&t.duration>0?a.transform(Kn(c,t.duration),w):a.transform(c,w),!0}}return!1}function NP(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[$e]:n[$e],selected:r.selected})}),new Map(t)}function EP(e,t){return t.map(r=>{const n=e.find(s=>s.id===r.id);return n&&(r.selected=n.selected),r})}function Na({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:s,edges:o,onNodesChange:i,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=r();e!=null&&e.length&&(c&&n({nodeInternals:NP(e,s)}),i==null||i(e)),t!=null&&t.length&&(u&&n({edges:EP(t,o)}),a==null||a(t))}const _s=()=>{},CP={zoomIn:_s,zoomOut:_s,zoomTo:_s,getZoom:()=>1,setViewport:_s,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:_s,fitBounds:_s,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},RP=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),TP=()=>{const e=rt(),{d3Zoom:t,d3Selection:r}=Ae(RP,pt);return m.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(Kn(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(Kn(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,o)=>t.scaleTo(Kn(r,o==null?void 0:o.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,o)=>{const[i,a,c]=e.getState().transform,u=Gr.translate(s.x??i,s.y??a).scale(s.zoom??c);t.transform(Kn(r,o==null?void 0:o.duration),u)},getViewport:()=>{const[s,o,i]=e.getState().transform;return{x:s,y:o,zoom:i}},fitView:s=>MN(e.getState,s),setCenter:(s,o,i)=>{const{width:a,height:c,maxZoom:u}=e.getState(),d=typeof(i==null?void 0:i.zoom)<"u"?i.zoom:u,f=a/2-s*d,p=c/2-o*d,h=Gr.translate(f,p).scale(d);t.transform(Kn(r,i==null?void 0:i.duration),h)},fitBounds:(s,o)=>{const{width:i,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:d,y:f,zoom:p}=vN(s,i,a,c,u,(o==null?void 0:o.padding)??.1),h=Gr.translate(d,f).scale(p);t.transform(Kn(r,o==null?void 0:o.duration),h)},project:s=>{const{transform:o,snapToGrid:i,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Dg(s,o,i,a)},screenToFlowPosition:s=>{const{transform:o,snapToGrid:i,snapGrid:a,domNode:c}=e.getState();if(!c)return s;const{x:u,y:d}=c.getBoundingClientRect(),f={x:s.x-u,y:s.y-d};return Dg(f,o,i,a)},flowToScreenPosition:s=>{const{transform:o,domNode:i}=e.getState();if(!i)return s;const{x:a,y:c}=i.getBoundingClientRect(),u=hN(s,o);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:CP,[t,r])};function mc(){const e=TP(),t=rt(),r=m.useCallback(()=>t.getState().getNodes().map(v=>({...v})),[]),n=m.useCallback(v=>t.getState().nodeInternals.get(v),[]),s=m.useCallback(()=>{const{edges:v=[]}=t.getState();return v.map(_=>({..._}))},[]),o=m.useCallback(v=>{const{edges:_=[]}=t.getState();return _.find(g=>g.id===v)},[]),i=m.useCallback(v=>{const{getNodes:_,setNodes:g,hasDefaultNodes:x,onNodesChange:b}=t.getState(),w=_(),j=typeof v=="function"?v(w):v;if(x)g(j);else if(b){const k=j.length===0?w.map(N=>({type:"remove",id:N.id})):j.map(N=>({item:N,type:"reset"}));b(k)}},[]),a=m.useCallback(v=>{const{edges:_=[],setEdges:g,hasDefaultEdges:x,onEdgesChange:b}=t.getState(),w=typeof v=="function"?v(_):v;if(x)g(w);else if(b){const j=w.length===0?_.map(k=>({type:"remove",id:k.id})):w.map(k=>({item:k,type:"reset"}));b(j)}},[]),c=m.useCallback(v=>{const _=Array.isArray(v)?v:[v],{getNodes:g,setNodes:x,hasDefaultNodes:b,onNodesChange:w}=t.getState();if(b){const k=[...g(),..._];x(k)}else if(w){const j=_.map(k=>({item:k,type:"add"}));w(j)}},[]),u=m.useCallback(v=>{const _=Array.isArray(v)?v:[v],{edges:g=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:w}=t.getState();if(b)x([...g,..._]);else if(w){const j=_.map(k=>({item:k,type:"add"}));w(j)}},[]),d=m.useCallback(()=>{const{getNodes:v,edges:_=[],transform:g}=t.getState(),[x,b,w]=g;return{nodes:v().map(j=>({...j})),edges:_.map(j=>({...j})),viewport:{x,y:b,zoom:w}}},[]),f=m.useCallback(({nodes:v,edges:_})=>{const{nodeInternals:g,getNodes:x,edges:b,hasDefaultNodes:w,hasDefaultEdges:j,onNodesDelete:k,onEdgesDelete:N,onNodesChange:S,onEdgesChange:C}=t.getState(),R=(v||[]).map(D=>D.id),T=(_||[]).map(D=>D.id),L=x().reduce((D,A)=>{const $=A.parentNode||A.parentId,O=!R.includes(A.id)&&$&&D.find(z=>z.id===$);return(typeof A.deletable=="boolean"?A.deletable:!0)&&(R.includes(A.id)||O)&&D.push(A),D},[]),q=b.filter(D=>typeof D.deletable=="boolean"?D.deletable:!0),E=q.filter(D=>T.includes(D.id));if(L||E){const D=gN(L,q),A=[...E,...D],$=A.reduce((O,M)=>(O.includes(M.id)||O.push(M.id),O),[]);if((j||w)&&(j&&t.setState({edges:b.filter(O=>!$.includes(O.id))}),w&&(L.forEach(O=>{g.delete(O.id)}),t.setState({nodeInternals:new Map(g)}))),$.length>0&&(N==null||N(A),C&&C($.map(O=>({id:O,type:"remove"})))),L.length>0&&(k==null||k(L),S)){const O=L.map(M=>({id:M.id,type:"remove"}));S(O)}}},[]),p=m.useCallback(v=>{const _=XM(v),g=_?null:t.getState().nodeInternals.get(v.id);return!_&&!g?[null,null,_]:[_?v:f0(g),g,_]},[]),h=m.useCallback((v,_=!0,g)=>{const[x,b,w]=p(v);return x?(g||t.getState().getNodes()).filter(j=>{if(!w&&(j.id===b.id||!j.positionAbsolute))return!1;const k=f0(j),N=Ig(k,x);return _&&N>0||N>=x.width*x.height}):[]},[]),y=m.useCallback((v,_,g=!0)=>{const[x]=p(v);if(!x)return!1;const b=Ig(x,_);return g&&b>0||b>=x.width*x.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:s,getEdge:o,setNodes:i,setEdges:a,addNodes:c,addEdges:u,toObject:d,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:y}),[e,r,n,s,o,i,a,c,u,d,f,h,y])}const IP={actInsideInputWithModifier:!1};var MP=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=rt(),{deleteElements:n}=mc(),s=Di(e,IP),o=Di(t);m.useEffect(()=>{if(s){const{edges:i,getNodes:a}=r.getState(),c=a().filter(d=>d.selected),u=i.filter(d=>d.selected);n({nodes:c,edges:u}),r.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])};function PP(e){const t=rt();m.useEffect(()=>{let r;const n=()=>{var o,i;if(!e.current)return;const s=Kv(e.current);(s.height===0||s.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",Jr.error004())),t.setState({width:s.width||500,height:s.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const rx={position:"absolute",width:"100%",height:"100%",top:0,left:0},AP=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Ea=e=>({x:e.x,y:e.y,zoom:e.k}),js=(e,t)=>e.target.closest(`.${t}`),_0=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),j0=e=>{const t=e.ctrlKey&&Il()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},DP=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),OP=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:s=!0,zoomOnPinch:o=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=es.Free,zoomOnDoubleClick:u=!0,elementsSelectable:d,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:y,maxZoom:v,zoomActivationKeyCode:_,preventScrolling:g=!0,children:x,noWheelClassName:b,noPanClassName:w})=>{const j=m.useRef(),k=rt(),N=m.useRef(!1),S=m.useRef(!1),C=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:L,d3ZoomHandler:q,userSelectionActive:E}=Ae(DP,pt),D=Di(_),A=m.useRef(0),$=m.useRef(!1),O=m.useRef();return PP(C),m.useEffect(()=>{if(C.current){const M=C.current.getBoundingClientRect(),z=rN().scaleExtent([y,v]).translateExtent(h),P=Kt(C.current).call(z),I=Gr.translate(p.x,p.y).scale(ao(p.zoom,y,v)),F=[[0,0],[M.width,M.height]],V=z.constrain()(I,F,h);z.transform(P,V),z.wheelDelta(j0),k.setState({d3Zoom:z,d3Selection:P,d3ZoomHandler:P.on("wheel.zoom"),transform:[V.x,V.y,V.k],domNode:C.current.closest(".react-flow")})}},[]),m.useEffect(()=>{L&&T&&(i&&!D&&!E?L.on("wheel.zoom",M=>{if(js(M,b))return!1;M.preventDefault(),M.stopImmediatePropagation();const z=L.property("__zoom").k||1;if(M.ctrlKey&&o){const se=cr(M),re=j0(M),Q=z*Math.pow(2,re);T.scaleTo(L,Q,se,M);return}const P=M.deltaMode===1?20:1;let I=c===es.Vertical?0:M.deltaX*P,F=c===es.Horizontal?0:M.deltaY*P;!Il()&&M.shiftKey&&c!==es.Vertical&&(I=M.deltaY*P,F=0),T.translateBy(L,-(I/z)*a,-(F/z)*a,{internal:!0});const V=Ea(L.property("__zoom")),{onViewportChangeStart:G,onViewportChange:X,onViewportChangeEnd:te}=k.getState();clearTimeout(O.current),$.current||($.current=!0,t==null||t(M,V),G==null||G(V)),$.current&&(e==null||e(M,V),X==null||X(V),O.current=setTimeout(()=>{r==null||r(M,V),te==null||te(V),$.current=!1},150))},{passive:!1}):typeof q<"u"&&L.on("wheel.zoom",function(M,z){if(!g&&M.type==="wheel"&&!M.ctrlKey||js(M,b))return null;M.preventDefault(),q.call(this,M,z)},{passive:!1}))},[E,i,c,L,T,q,D,o,g,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",M=>{var I,F;if(!M.sourceEvent||M.sourceEvent.internal)return null;A.current=(I=M.sourceEvent)==null?void 0:I.button;const{onViewportChangeStart:z}=k.getState(),P=Ea(M.transform);N.current=!0,R.current=P,((F=M.sourceEvent)==null?void 0:F.type)==="mousedown"&&k.setState({paneDragging:!0}),z==null||z(P),t==null||t(M.sourceEvent,P)})},[T,t]),m.useEffect(()=>{T&&(E&&!N.current?T.on("zoom",null):E||T.on("zoom",M=>{var P;const{onViewportChange:z}=k.getState();if(k.setState({transform:[M.transform.x,M.transform.y,M.transform.k]}),S.current=!!(n&&_0(f,A.current??0)),(e||z)&&!((P=M.sourceEvent)!=null&&P.internal)){const I=Ea(M.transform);z==null||z(I),e==null||e(M.sourceEvent,I)}}))},[E,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",M=>{if(!M.sourceEvent||M.sourceEvent.internal)return null;const{onViewportChangeEnd:z}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),n&&_0(f,A.current??0)&&!S.current&&n(M.sourceEvent),S.current=!1,(r||z)&&AP(R.current,M.transform)){const P=Ea(M.transform);R.current=P,clearTimeout(j.current),j.current=setTimeout(()=>{z==null||z(P),r==null||r(M.sourceEvent,P)},i?150:0)}})},[T,i,f,r,n]),m.useEffect(()=>{T&&T.filter(M=>{const z=D||s,P=o&&M.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&M.button===1&&M.type==="mousedown"&&(js(M,"react-flow__node")||js(M,"react-flow__edge")))return!0;if(!f&&!z&&!i&&!u&&!o||E||!u&&M.type==="dblclick"||js(M,b)&&M.type==="wheel"||js(M,w)&&(M.type!=="wheel"||i&&M.type==="wheel"&&!D)||!o&&M.ctrlKey&&M.type==="wheel"||!z&&!i&&!P&&M.type==="wheel"||!f&&(M.type==="mousedown"||M.type==="touchstart")||Array.isArray(f)&&!f.includes(M.button)&&M.type==="mousedown")return!1;const I=Array.isArray(f)&&f.includes(M.button)||!M.button||M.button<=1;return(!M.ctrlKey||M.type==="wheel")&&I})},[E,T,s,o,i,u,f,d,D]),B.createElement("div",{className:"react-flow__renderer",ref:C,style:rx},x)},LP=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function zP(){const{userSelectionActive:e,userSelectionRect:t}=Ae(LP,pt);return e&&t?B.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function S0(e,t){const r=t.parentNode||t.parentId,n=e.find(s=>s.id===r);if(n){const s=t.position.x+t.width-n.width,o=t.position.y+t.height-n.height;if(s>0||o>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,s>0&&(n.style.width+=s),o>0&&(n.style.height+=o),t.position.x<0){const i=Math.abs(t.position.x);n.position.x=n.position.x-i,n.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);n.position.y=n.position.y-i,n.style.height+=i,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function PN(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,s)=>{const o=e.filter(a=>a.id===s.id);if(o.length===0)return n.push(s),n;const i={...s};for(const a of o)if(a)switch(a.type){case"select":{i.selected=a.selected;break}case"position":{typeof a.position<"u"&&(i.position=a.position),typeof a.positionAbsolute<"u"&&(i.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(i.dragging=a.dragging),i.expandParent&&S0(n,i);break}case"dimensions":{typeof a.dimensions<"u"&&(i.width=a.dimensions.width,i.height=a.dimensions.height),typeof a.updateStyle<"u"&&(i.style={...i.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(i.resizing=a.resizing),i.expandParent&&S0(n,i);break}case"remove":return n}return n.push(i),n},r)}function AN(e,t){return PN(e,t)}function qP(e,t){return PN(e,t)}const pn=(e,t)=>({id:e,type:"select",selected:t});function $s(e,t){return e.reduce((r,n)=>{const s=t.includes(n.id);return!n.selected&&s?(n.selected=!0,r.push(pn(n.id,!0))):n.selected&&!s&&(n.selected=!1,r.push(pn(n.id,!1))),r},[])}const ju=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},$P=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),DN=m.memo(({isSelecting:e,selectionMode:t=Ai.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:s,onPaneClick:o,onPaneContextMenu:i,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:d,children:f})=>{const p=m.useRef(null),h=rt(),y=m.useRef(0),v=m.useRef(0),_=m.useRef(),{userSelectionActive:g,elementsSelectable:x,dragging:b}=Ae($P,pt),w=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,v.current=0},j=q=>{o==null||o(q),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},k=q=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){q.preventDefault();return}i==null||i(q)},N=a?q=>a(q):void 0,S=q=>{const{resetSelectedElements:E,domNode:D}=h.getState();if(_.current=D==null?void 0:D.getBoundingClientRect(),!x||!e||q.button!==0||q.target!==p.current||!_.current)return;const{x:A,y:$}=In(q,_.current);E(),h.setState({userSelectionRect:{width:0,height:0,startX:A,startY:$,x:A,y:$}}),n==null||n(q)},C=q=>{const{userSelectionRect:E,nodeInternals:D,edges:A,transform:$,onNodesChange:O,onEdgesChange:M,nodeOrigin:z,getNodes:P}=h.getState();if(!e||!_.current||!E)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const I=In(q,_.current),F=E.startX??0,V=E.startY??0,G={...E,x:I.x<F?I.x:F,y:I.y<V?I.y:V,width:Math.abs(I.x-F),height:Math.abs(I.y-V)},X=P(),te=mN(D,G,$,t===Ai.Partial,!0,z),se=gN(te,A).map(Q=>Q.id),re=te.map(Q=>Q.id);if(y.current!==re.length){y.current=re.length;const Q=$s(X,re);Q.length&&(O==null||O(Q))}if(v.current!==se.length){v.current=se.length;const Q=$s(A,se);Q.length&&(M==null||M(Q))}h.setState({userSelectionRect:G})},R=q=>{if(q.button!==0)return;const{userSelectionRect:E}=h.getState();!g&&E&&q.target===p.current&&(j==null||j(q)),h.setState({nodesSelectionActive:y.current>0}),w(),s==null||s(q)},T=q=>{g&&(h.setState({nodesSelectionActive:y.current>0}),s==null||s(q)),w()},L=x&&(e||g);return B.createElement("div",{className:Rt(["react-flow__pane",{dragging:b,selection:e}]),onClick:L?void 0:ju(j,p),onContextMenu:ju(k,p),onWheel:ju(N,p),onMouseEnter:L?void 0:c,onMouseDown:L?S:void 0,onMouseMove:L?C:u,onMouseUp:L?R:void 0,onMouseLeave:L?T:d,ref:p,style:rx},f,B.createElement(zP,null))});DN.displayName="Pane";function ON(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:ON(n,t):!1}function k0(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function FP(e,t,r,n){return Array.from(e.values()).filter(s=>(s.selected||s.id===n)&&(!s.parentNode||s.parentId||!ON(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var o,i;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((o=s.positionAbsolute)==null?void 0:o.x)??0),y:r.y-(((i=s.positionAbsolute)==null?void 0:i.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function BP(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function LN(e,t,r,n,s=[0,0],o){const i=BP(e,e.extent||n);let a=i;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=os(f,s).positionAbsolute;a=f&&Xt(p)&&Xt(h)&&Xt(f.width)&&Xt(f.height)?[[p+e.width*s[0],h+e.height*s[1]],[p+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:a}else o==null||o("005",Jr.error005()),a=i;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=os(f,s).positionAbsolute;a=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let u={x:0,y:0};if(c){const f=r.get(c);u=os(f,s).positionAbsolute}const d=a&&a!=="parent"?Yv(t,a):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function Su({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?n.find(s=>s.id===e):n[0],n]}const N0=(e,t,r,n)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const o=Array.from(s),i=t.getBoundingClientRect(),a={x:i.width*n[0],y:i.height*n[1]};return o.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-i.left-a.x)/r,y:(u.top-i.top-a.y)/r,...Kv(c)}})};function Oo(e,t,r){return r===void 0?r:n=>{const s=t().nodeInternals.get(e);s&&r(n,{...s})}}function Lg({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:o,multiSelectionActive:i,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",Jr.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&i)&&(o({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=n==null?void 0:n.current)==null?void 0:d.blur()})):s([e])}function HP(){const e=rt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:s,snapToGrid:o}=e.getState(),i=r.touches?r.touches[0].clientX:r.clientX,a=r.touches?r.touches[0].clientY:r.clientY,c={x:(i-n[0])/n[2],y:(a-n[1])/n[2]};return{xSnapped:o?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:o?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function ku(e){return(t,r,n)=>e==null?void 0:e(t,n)}function zN({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:o,selectNodesOnDrag:i}){const a=rt(),[c,u]=m.useState(!1),d=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),y=m.useRef({x:0,y:0}),v=m.useRef(null),_=m.useRef(!1),g=m.useRef(!1),x=m.useRef(!1),b=HP();return m.useEffect(()=>{if(e!=null&&e.current){const w=Kt(e.current),j=({x:S,y:C})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:L,updateNodePositions:q,nodeExtent:E,snapGrid:D,snapToGrid:A,nodeOrigin:$,onError:O}=a.getState();f.current={x:S,y:C};let M=!1,z={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&E){const I=hc(d.current,$);z=Pi(I)}if(d.current=d.current.map(I=>{const F={x:S-I.distance.x,y:C-I.distance.y};A&&(F.x=D[0]*Math.round(F.x/D[0]),F.y=D[1]*Math.round(F.y/D[1]));const V=[[E[0][0],E[0][1]],[E[1][0],E[1][1]]];d.current.length>1&&E&&!I.extent&&(V[0][0]=I.positionAbsolute.x-z.x+E[0][0],V[1][0]=I.positionAbsolute.x+(I.width??0)-z.x2+E[1][0],V[0][1]=I.positionAbsolute.y-z.y+E[0][1],V[1][1]=I.positionAbsolute.y+(I.height??0)-z.y2+E[1][1]);const G=LN(I,F,R,V,$,O);return M=M||I.position.x!==G.position.x||I.position.y!==G.position.y,I.position=G.position,I.positionAbsolute=G.positionAbsolute,I}),!M)return;q(d.current,!0,!0),u(!0);const P=s?T:ku(L);if(P&&v.current){const[I,F]=Su({nodeId:s,dragItems:d.current,nodeInternals:R});P(v.current,I,F)}},k=()=>{if(!h.current)return;const[S,C]=sN(y.current,h.current);if(S!==0||C!==0){const{transform:R,panBy:T}=a.getState();f.current.x=(f.current.x??0)-S/R[2],f.current.y=(f.current.y??0)-C/R[2],T({x:S,y:C})&&j(f.current)}p.current=requestAnimationFrame(k)},N=S=>{var $;const{nodeInternals:C,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:L,onNodeDragStart:q,onSelectionDragStart:E}=a.getState();g.current=!0;const D=s?q:ku(E);(!i||!o)&&!R&&s&&(($=C.get(s))!=null&&$.selected||L()),s&&o&&i&&Lg({id:s,store:a,nodeRef:e});const A=b(S);if(f.current=A,d.current=FP(C,T,A,s),D&&d.current){const[O,M]=Su({nodeId:s,dragItems:d.current,nodeInternals:C});D(S.sourceEvent,O,M)}};if(t)w.on(".drag",null);else{const S=eI().on("start",C=>{const{domNode:R,nodeDragThreshold:T}=a.getState();T===0&&N(C),x.current=!1;const L=b(C);f.current=L,h.current=(R==null?void 0:R.getBoundingClientRect())||null,y.current=In(C.sourceEvent,h.current)}).on("drag",C=>{var q,E;const R=b(C),{autoPanOnNodeDrag:T,nodeDragThreshold:L}=a.getState();if(C.sourceEvent.type==="touchmove"&&C.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!_.current&&g.current&&T&&(_.current=!0,k()),!g.current){const D=R.xSnapped-(((q=f==null?void 0:f.current)==null?void 0:q.x)??0),A=R.ySnapped-(((E=f==null?void 0:f.current)==null?void 0:E.y)??0);Math.sqrt(D*D+A*A)>L&&N(C)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&d.current&&g.current&&(v.current=C.sourceEvent,y.current=In(C.sourceEvent,h.current),j(R))}}).on("end",C=>{if(!(!g.current||x.current)&&(u(!1),_.current=!1,g.current=!1,cancelAnimationFrame(p.current),d.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:L,onSelectionDragStop:q}=a.getState(),E=s?L:ku(q);if(R(d.current,!1,!1),E){const[D,A]=Su({nodeId:s,dragItems:d.current,nodeInternals:T});E(C.sourceEvent,D,A)}}}).filter(C=>{const R=C.target;return!C.button&&(!r||!k0(R,`.${r}`,e))&&(!n||k0(R,n,e))});return w.call(S),()=>{w.on(".drag",null)}}}},[e,t,r,n,o,a,s,i,b]),c}function qN(){const e=rt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:s,updateNodePositions:o,getNodes:i,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:d}=e.getState(),f=i().filter(x=>x.selected&&(x.draggable||d&&typeof x.draggable>"u")),p=a?c[0]:5,h=a?c[1]:5,y=r.isShiftPressed?4:1,v=r.x*p*y,_=r.y*h*y,g=f.map(x=>{if(x.positionAbsolute){const b={x:x.positionAbsolute.x+v,y:x.positionAbsolute.y+_};a&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:w,position:j}=LN(x,b,n,s,void 0,u);x.position=j,x.positionAbsolute=w}return x});o(g,!0,!1)},[])}const Ys={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Lo=e=>{const t=({id:r,type:n,data:s,xPos:o,yPos:i,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:d,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:y,onDoubleClick:v,style:_,className:g,isDraggable:x,isSelectable:b,isConnectable:w,isFocusable:j,selectNodesOnDrag:k,sourcePosition:N,targetPosition:S,hidden:C,resizeObserver:R,dragHandle:T,zIndex:L,isParent:q,noDragClassName:E,noPanClassName:D,initialized:A,disableKeyboardA11y:$,ariaLabel:O,rfId:M,hasHandleBounds:z})=>{const P=rt(),I=m.useRef(null),F=m.useRef(null),V=m.useRef(N),G=m.useRef(S),X=m.useRef(n),te=b||x||d||f||p||h,se=qN(),re=Oo(r,P.getState,f),Q=Oo(r,P.getState,p),xe=Oo(r,P.getState,h),ne=Oo(r,P.getState,y),ye=Oo(r,P.getState,v),ee=W=>{const{nodeDragThreshold:K}=P.getState();if(b&&(!k||!x||K>0)&&Lg({id:r,store:P,nodeRef:I}),d){const ae=P.getState().nodeInternals.get(r);ae&&d(W,{...ae})}},Y=W=>{if(!Mg(W)&&!$)if(lN.includes(W.key)&&b){const K=W.key==="Escape";Lg({id:r,store:P,unselect:K,nodeRef:I})}else x&&u&&Object.prototype.hasOwnProperty.call(Ys,W.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${W.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~i}`}),se({x:Ys[W.key].x,y:Ys[W.key].y,isShiftPressed:W.shiftKey}))};m.useEffect(()=>()=>{F.current&&(R==null||R.unobserve(F.current),F.current=null)},[]),m.useEffect(()=>{if(I.current&&!C){const W=I.current;(!A||!z||F.current!==W)&&(F.current&&(R==null||R.unobserve(F.current)),R==null||R.observe(W),F.current=W)}},[C,A,z]),m.useEffect(()=>{const W=X.current!==n,K=V.current!==N,ae=G.current!==S;I.current&&(W||K||ae)&&(W&&(X.current=n),K&&(V.current=N),ae&&(G.current=S),P.getState().updateNodeDimensions([{id:r,nodeElement:I.current,forceUpdate:!0}]))},[r,n,N,S]);const pe=zN({nodeRef:I,disabled:C||!x,noDragClassName:E,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:k});return C?null:B.createElement("div",{className:Rt(["react-flow__node",`react-flow__node-${n}`,{[D]:x},g,{selected:u,selectable:b,parent:q,dragging:pe}]),ref:I,style:{zIndex:L,transform:`translate(${a}px,${c}px)`,pointerEvents:te?"all":"none",visibility:A?"visible":"hidden",..._},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:re,onMouseMove:Q,onMouseLeave:xe,onContextMenu:ne,onClick:ee,onDoubleClick:ye,onKeyDown:j?Y:void 0,tabIndex:j?0:void 0,role:j?"button":void 0,"aria-describedby":$?void 0:`${CN}-${M}`,"aria-label":O},B.createElement(nP,{value:r},B.createElement(e,{id:r,data:s,type:n,xPos:o,yPos:i,selected:u,isConnectable:w,sourcePosition:N,targetPosition:S,dragging:pe,dragHandle:T,zIndex:L})))};return t.displayName="NodeWrapper",m.memo(t)};const WP=e=>{const t=e.getNodes().filter(r=>r.selected);return{...hc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function VP({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=rt(),{width:s,height:o,x:i,y:a,transformString:c,userSelectionActive:u}=Ae(WP,pt),d=qN(),f=m.useRef(null);if(m.useEffect(()=>{var y;r||(y=f.current)==null||y.focus({preventScroll:!0})},[r]),zN({nodeRef:f}),u||!s||!o)return null;const p=e?y=>{const v=n.getState().getNodes().filter(_=>_.selected);e(y,v)}:void 0,h=y=>{Object.prototype.hasOwnProperty.call(Ys,y.key)&&d({x:Ys[y.key].x,y:Ys[y.key].y,isShiftPressed:y.shiftKey})};return B.createElement("div",{className:Rt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},B.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:s,height:o,top:a,left:i}}))}var UP=m.memo(VP);const GP=e=>e.nodesSelectionActive,$N=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:i,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:d,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:y,onSelectionEnd:v,multiSelectionKeyCode:_,panActivationKeyCode:g,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:j,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:R,defaultViewport:T,translateExtent:L,minZoom:q,maxZoom:E,preventScrolling:D,onSelectionContextMenu:A,noWheelClassName:$,noPanClassName:O,disableKeyboardA11y:M})=>{const z=Ae(GP),P=Di(f),I=Di(g),F=I||R,V=I||k,G=P||p&&F!==!0;return MP({deleteKeyCode:a,multiSelectionKeyCode:_}),B.createElement(OP,{onMove:c,onMoveStart:u,onMoveEnd:d,onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:j,panOnScroll:V,panOnScrollSpeed:N,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:!P&&F,defaultViewport:T,translateExtent:L,minZoom:q,maxZoom:E,zoomActivationKeyCode:x,preventScrolling:D,noWheelClassName:$,noPanClassName:O},B.createElement(DN,{onSelectionStart:y,onSelectionEnd:v,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:F,isSelecting:!!G,selectionMode:h},e,z&&B.createElement(UP,{onSelectionContextMenu:A,noPanClassName:O,disableKeyboardA11y:M})))};$N.displayName="FlowRenderer";var KP=m.memo($N);function YP(e){return Ae(m.useCallback(r=>e?mN(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function XP(e){const t={input:Lo(e.input||SN),default:Lo(e.default||Og),output:Lo(e.output||NN),group:Lo(e.group||tx)},r={},n=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,o)=>(s[o]=Lo(e[o]||Og),s),r);return{...t,...n}}const QP=({x:e,y:t,width:r,height:n,origin:s})=>!r||!n?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-n*s[1]},ZP=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),FN=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,updateNodeDimensions:o,onError:i}=Ae(ZP,pt),a=YP(e.onlyRenderVisibleElements),c=m.useRef(),u=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));o(p)});return c.current=d,d},[]);return m.useEffect(()=>()=>{var d;(d=c==null?void 0:c.current)==null||d.disconnect()},[]),B.createElement("div",{className:"react-flow__nodes",style:rx},a.map(d=>{var j,k,N;let f=d.type||"default";e.nodeTypes[f]||(i==null||i("003",Jr.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(d.draggable||t&&typeof d.draggable>"u"),y=!!(d.selectable||s&&typeof d.selectable>"u"),v=!!(d.connectable||r&&typeof d.connectable>"u"),_=!!(d.focusable||n&&typeof d.focusable>"u"),g=e.nodeExtent?Yv(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,x=(g==null?void 0:g.x)??0,b=(g==null?void 0:g.y)??0,w=QP({x,y:b,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return B.createElement(p,{key:d.id,id:d.id,className:d.className,style:d.style,type:f,data:d.data,sourcePosition:d.sourcePosition||J.Bottom,targetPosition:d.targetPosition||J.Top,hidden:d.hidden,xPos:x,yPos:b,xPosOrigin:w.x,yPosOrigin:w.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:h,isSelectable:y,isConnectable:v,isFocusable:_,resizeObserver:u,dragHandle:d.dragHandle,zIndex:((j=d[$e])==null?void 0:j.z)??0,isParent:!!((k=d[$e])!=null&&k.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((N=d[$e])!=null&&N.handleBounds)})}))};FN.displayName="NodeRenderer";var JP=m.memo(FN);const eA=(e,t,r)=>r===J.Left?e-t:r===J.Right?e+t:e,tA=(e,t,r)=>r===J.Top?e-t:r===J.Bottom?e+t:e,E0="react-flow__edgeupdater",C0=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:o,onMouseOut:i,type:a})=>B.createElement("circle",{onMouseDown:s,onMouseEnter:o,onMouseOut:i,className:Rt([E0,`${E0}-${a}`]),cx:eA(t,n,e),cy:tA(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),rA=()=>!0;var Ss=e=>{const t=({id:r,className:n,type:s,data:o,onClick:i,onEdgeDoubleClick:a,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:y,labelBgBorderRadius:v,style:_,source:g,target:x,sourceX:b,sourceY:w,targetX:j,targetY:k,sourcePosition:N,targetPosition:S,elementsSelectable:C,hidden:R,sourceHandleId:T,targetHandleId:L,onContextMenu:q,onMouseEnter:E,onMouseMove:D,onMouseLeave:A,reconnectRadius:$,onReconnect:O,onReconnectStart:M,onReconnectEnd:z,markerEnd:P,markerStart:I,rfId:F,ariaLabel:V,isFocusable:G,isReconnectable:X,pathOptions:te,interactionWidth:se,disableKeyboardA11y:re})=>{const Q=m.useRef(null),[xe,ne]=m.useState(!1),[ye,ee]=m.useState(!1),Y=rt(),pe=m.useMemo(()=>`url('#${Ag(I,F)}')`,[I,F]),W=m.useMemo(()=>`url('#${Ag(P,F)}')`,[P,F]);if(R)return null;const K=ke=>{var Ft;const{edges:st,addSelectedEdges:Qe,unselectNodesAndEdges:ot,multiSelectionActive:nr}=Y.getState(),$t=st.find(sn=>sn.id===r);$t&&(C&&(Y.setState({nodesSelectionActive:!1}),$t.selected&&nr?(ot({nodes:[],edges:[$t]}),(Ft=Q.current)==null||Ft.blur()):Qe([r])),i&&i(ke,$t))},ae=Do(r,Y.getState,a),ce=Do(r,Y.getState,q),Se=Do(r,Y.getState,E),be=Do(r,Y.getState,D),le=Do(r,Y.getState,A),H=(ke,st)=>{if(ke.button!==0)return;const{edges:Qe,isValidConnection:ot}=Y.getState(),nr=st?x:g,$t=(st?L:T)||null,Ft=st?"target":"source",sn=ot||rA,_o=st,$n=Qe.find(Fe=>Fe.id===r);ee(!0),M==null||M(ke,$n,Ft);const jo=Fe=>{ee(!1),z==null||z(Fe,$n,Ft)};bN({event:ke,handleId:$t,nodeId:nr,onConnect:Fe=>O==null?void 0:O($n,Fe),isTarget:_o,getState:Y.getState,setState:Y.setState,isValidConnection:sn,edgeUpdaterType:Ft,onReconnectEnd:jo})},Ce=ke=>H(ke,!0),oe=ke=>H(ke,!1),nt=()=>ne(!0),He=()=>ne(!1),ht=!C&&!i,rr=ke=>{var st;if(!re&&lN.includes(ke.key)&&C){const{unselectNodesAndEdges:Qe,addSelectedEdges:ot,edges:nr}=Y.getState();ke.key==="Escape"?((st=Q.current)==null||st.blur(),Qe({edges:[nr.find(Ft=>Ft.id===r)]})):ot([r])}};return B.createElement("g",{className:Rt(["react-flow__edge",`react-flow__edge-${s}`,n,{selected:c,animated:u,inactive:ht,updating:xe}]),onClick:K,onDoubleClick:ae,onContextMenu:ce,onMouseEnter:Se,onMouseMove:be,onMouseLeave:le,onKeyDown:G?rr:void 0,tabIndex:G?0:void 0,role:G?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":V===null?void 0:V||`Edge from ${g} to ${x}`,"aria-describedby":G?`${RN}-${F}`:void 0,ref:Q},!ye&&B.createElement(e,{id:r,source:g,target:x,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:y,labelBgBorderRadius:v,data:o,style:_,sourceX:b,sourceY:w,targetX:j,targetY:k,sourcePosition:N,targetPosition:S,sourceHandleId:T,targetHandleId:L,markerStart:pe,markerEnd:W,pathOptions:te,interactionWidth:se}),X&&B.createElement(B.Fragment,null,(X==="source"||X===!0)&&B.createElement(C0,{position:N,centerX:b,centerY:w,radius:$,onMouseDown:Ce,onMouseEnter:nt,onMouseOut:He,type:"source"}),(X==="target"||X===!0)&&B.createElement(C0,{position:S,centerX:j,centerY:k,radius:$,onMouseDown:oe,onMouseEnter:nt,onMouseOut:He,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function nA(e){const t={default:Ss(e.default||Pl),straight:Ss(e.bezier||Zv),step:Ss(e.step||Qv),smoothstep:Ss(e.step||pc),simplebezier:Ss(e.simplebezier||Xv)},r={},n=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,o)=>(s[o]=Ss(e[o]||Pl),s),r);return{...t,...n}}function R0(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,o=(r==null?void 0:r.width)||t.width,i=(r==null?void 0:r.height)||t.height;switch(e){case J.Top:return{x:n+o/2,y:s};case J.Right:return{x:n+o,y:s+i/2};case J.Bottom:return{x:n+o/2,y:s+i};case J.Left:return{x:n,y:s+i/2}}}function T0(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const sA=(e,t,r,n,s,o)=>{const i=R0(r,e,t),a=R0(o,n,s);return{sourceX:i.x,sourceY:i.y,targetX:a.x,targetY:a.y}};function oA({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:s,targetHeight:o,width:i,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+n,t.y+o)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=Pi({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:i/c[2],height:a/c[2]}),f=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),p=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(f*p)>0}function I0(e){var n,s,o,i,a;const t=((n=e==null?void 0:e[$e])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)<"u";return[{x:((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const iA=[{level:0,isMaxLevel:!0,edges:[]}];function aA(e,t,r=!1){let n=-1;const s=e.reduce((i,a)=>{var d,f;const c=Xt(a.zIndex);let u=c?a.zIndex:0;if(r){const p=t.get(a.target),h=t.get(a.source),y=a.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),v=Math.max(((d=h==null?void 0:h[$e])==null?void 0:d.z)||0,((f=p==null?void 0:p[$e])==null?void 0:f.z)||0,1e3);u=(c?a.zIndex:0)+(y?v:0)}return i[u]?i[u].push(a):i[u]=[a],n=u>n?u:n,i},{}),o=Object.entries(s).map(([i,a])=>{const c=+i;return{edges:a,level:c,isMaxLevel:c===n}});return o.length===0?iA:o}function lA(e,t,r){const n=Ae(m.useCallback(s=>e?s.edges.filter(o=>{const i=t.get(o.source),a=t.get(o.target);return(i==null?void 0:i.width)&&(i==null?void 0:i.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&oA({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:a.width,targetHeight:a.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return aA(n,t,r)}const cA=({color:e="none",strokeWidth:t=1})=>B.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),uA=({color:e="none",strokeWidth:t=1})=>B.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),M0={[Ml.Arrow]:cA,[Ml.ArrowClosed]:uA};function dA(e){const t=rt();return m.useMemo(()=>{var s,o;return Object.prototype.hasOwnProperty.call(M0,e)?M0[e]:((o=(s=t.getState()).onError)==null||o.call(s,"009",Jr.error009(e)),null)},[e])}const fA=({id:e,type:t,color:r,width:n=12.5,height:s=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=dA(t);return c?B.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:a,refX:"0",refY:"0"},B.createElement(c,{color:r,strokeWidth:i})):null},pA=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((s,o)=>([o.markerStart,o.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const a=Ag(i,t);n.includes(a)||(s.push({id:a,color:i.color||e,...i}),n.push(a))}}),s),[]).sort((s,o)=>s.id.localeCompare(o.id))},BN=({defaultColor:e,rfId:t})=>{const r=Ae(m.useCallback(pA({defaultColor:e,rfId:t}),[e,t]),(n,s)=>!(n.length!==s.length||n.some((o,i)=>o.id!==s[i].id)));return B.createElement("defs",null,r.map(n=>B.createElement(fA,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};BN.displayName="MarkerDefinitions";var hA=m.memo(BN);const mA=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),HN=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:s,noPanClassName:o,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:y,reconnectRadius:v,children:_,disableKeyboardA11y:g})=>{const{edgesFocusable:x,edgesUpdatable:b,elementsSelectable:w,width:j,height:k,connectionMode:N,nodeInternals:S,onError:C}=Ae(mA,pt),R=lA(t,S,r);return j?B.createElement(B.Fragment,null,R.map(({level:T,edges:L,isMaxLevel:q})=>B.createElement("svg",{key:T,style:{zIndex:T},width:j,height:k,className:"react-flow__edges react-flow__container"},q&&B.createElement(hA,{defaultColor:e,rfId:n}),B.createElement("g",null,L.map(E=>{const[D,A,$]=I0(S.get(E.source)),[O,M,z]=I0(S.get(E.target));if(!$||!z)return null;let P=E.type||"default";s[P]||(C==null||C("011",Jr.error011(P)),P="default");const I=s[P]||s.default,F=N===fs.Strict?M.target:(M.target??[]).concat(M.source??[]),V=T0(A.source,E.sourceHandle),G=T0(F,E.targetHandle),X=(V==null?void 0:V.position)||J.Bottom,te=(G==null?void 0:G.position)||J.Top,se=!!(E.focusable||x&&typeof E.focusable>"u"),re=E.reconnectable||E.updatable,Q=typeof p<"u"&&(re||b&&typeof re>"u");if(!V||!G)return C==null||C("008",Jr.error008(V,E)),null;const{sourceX:xe,sourceY:ne,targetX:ye,targetY:ee}=sA(D,V,X,O,G,te);return B.createElement(I,{key:E.id,id:E.id,className:Rt([E.className,o]),type:P,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:xe,sourceY:ne,targetX:ye,targetY:ee,sourcePosition:X,targetPosition:te,elementsSelectable:w,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:d,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:y,reconnectRadius:v,rfId:n,ariaLabel:E.ariaLabel,isFocusable:se,isReconnectable:Q,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth,disableKeyboardA11y:g})})))),_):null};HN.displayName="EdgeRenderer";var gA=m.memo(HN);const vA=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function xA({children:e}){const t=Ae(vA);return B.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function yA(e){const t=mc(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const bA={[J.Left]:J.Right,[J.Right]:J.Left,[J.Top]:J.Bottom,[J.Bottom]:J.Top},WN=({nodeId:e,handleType:t,style:r,type:n=vn.Bezier,CustomComponent:s,connectionStatus:o})=>{var k,N,S;const{fromNode:i,handleId:a,toX:c,toY:u,connectionMode:d}=Ae(m.useCallback(C=>({fromNode:C.nodeInternals.get(e),handleId:C.connectionHandleId,toX:(C.connectionPosition.x-C.transform[0])/C.transform[2],toY:(C.connectionPosition.y-C.transform[1])/C.transform[2],connectionMode:C.connectionMode}),[e]),pt),f=(k=i==null?void 0:i[$e])==null?void 0:k.handleBounds;let p=f==null?void 0:f[t];if(d===fs.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!i||!p)return null;const h=a?p.find(C=>C.id===a):p[0],y=h?h.x+h.width/2:(i.width??0)/2,v=h?h.y+h.height/2:i.height??0,_=(((N=i.positionAbsolute)==null?void 0:N.x)??0)+y,g=(((S=i.positionAbsolute)==null?void 0:S.y)??0)+v,x=h==null?void 0:h.position,b=x?bA[x]:null;if(!x||!b)return null;if(s)return B.createElement(s,{connectionLineType:n,connectionLineStyle:r,fromNode:i,fromHandle:h,fromX:_,fromY:g,toX:c,toY:u,fromPosition:x,toPosition:b,connectionStatus:o});let w="";const j={sourceX:_,sourceY:g,sourcePosition:x,targetX:c,targetY:u,targetPosition:b};return n===vn.Bezier?[w]=pN(j):n===vn.Step?[w]=Pg({...j,borderRadius:0}):n===vn.SmoothStep?[w]=Pg(j):n===vn.SimpleBezier?[w]=fN(j):w=`M${_},${g} ${c},${u}`,B.createElement("path",{d:w,fill:"none",className:"react-flow__connection-path",style:r})};WN.displayName="ConnectionLine";const wA=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function _A({containerStyle:e,style:t,type:r,component:n}){const{nodeId:s,handleType:o,nodesConnectable:i,width:a,height:c,connectionStatus:u}=Ae(wA,pt);return!(s&&o&&a&&i)?null:B.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},B.createElement("g",{className:Rt(["react-flow__connection",u])},B.createElement(WN,{nodeId:s,handleType:o,style:t,type:r,CustomComponent:n,connectionStatus:u})))}function P0(e,t){return m.useRef(null),rt(),m.useMemo(()=>t(e),[e])}const VN=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:s,onInit:o,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:y,onSelectionStart:v,onSelectionEnd:_,connectionLineType:g,connectionLineStyle:x,connectionLineComponent:b,connectionLineContainerStyle:w,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:S,panActivationKeyCode:C,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:L,elementsSelectable:q,selectNodesOnDrag:E,defaultViewport:D,translateExtent:A,minZoom:$,maxZoom:O,preventScrolling:M,defaultMarkerColor:z,zoomOnScroll:P,zoomOnPinch:I,panOnScroll:F,panOnScrollSpeed:V,panOnScrollMode:G,zoomOnDoubleClick:X,panOnDrag:te,onPaneClick:se,onPaneMouseEnter:re,onPaneMouseMove:Q,onPaneMouseLeave:xe,onPaneScroll:ne,onPaneContextMenu:ye,onEdgeContextMenu:ee,onEdgeMouseEnter:Y,onEdgeMouseMove:pe,onEdgeMouseLeave:W,onReconnect:K,onReconnectStart:ae,onReconnectEnd:ce,reconnectRadius:Se,noDragClassName:be,noWheelClassName:le,noPanClassName:H,elevateEdgesOnSelect:Ce,disableKeyboardA11y:oe,nodeOrigin:nt,nodeExtent:He,rfId:ht})=>{const rr=P0(e,XP),ke=P0(t,nA);return yA(o),B.createElement(KP,{onPaneClick:se,onPaneMouseEnter:re,onPaneMouseMove:Q,onPaneMouseLeave:xe,onPaneContextMenu:ye,onPaneScroll:ne,deleteKeyCode:T,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,onSelectionStart:v,onSelectionEnd:_,multiSelectionKeyCode:S,panActivationKeyCode:C,zoomActivationKeyCode:R,elementsSelectable:q,onMove:r,onMoveStart:n,onMoveEnd:s,zoomOnScroll:P,zoomOnPinch:I,zoomOnDoubleClick:X,panOnScroll:F,panOnScrollSpeed:V,panOnScrollMode:G,panOnDrag:te,defaultViewport:D,translateExtent:A,minZoom:$,maxZoom:O,onSelectionContextMenu:y,preventScrolling:M,noDragClassName:be,noWheelClassName:le,noPanClassName:H,disableKeyboardA11y:oe},B.createElement(xA,null,B.createElement(gA,{edgeTypes:ke,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:L,onEdgeContextMenu:ee,onEdgeMouseEnter:Y,onEdgeMouseMove:pe,onEdgeMouseLeave:W,onReconnect:K,onReconnectStart:ae,onReconnectEnd:ce,reconnectRadius:Se,defaultMarkerColor:z,noPanClassName:H,elevateEdgesOnSelect:!!Ce,disableKeyboardA11y:oe,rfId:ht},B.createElement(_A,{style:x,type:g,component:b,containerStyle:w})),B.createElement("div",{className:"react-flow__edgelabel-renderer"}),B.createElement(JP,{nodeTypes:rr,onNodeClick:i,onNodeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:E,onlyRenderVisibleElements:L,noPanClassName:H,noDragClassName:be,disableKeyboardA11y:oe,nodeOrigin:nt,nodeExtent:He,rfId:ht})))};VN.displayName="GraphView";var jA=m.memo(VN);const zg=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ln={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:zg,nodeExtent:zg,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:fs.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:QM,isValidConnection:void 0},SA=()=>f3((e,t)=>({...ln,setNodes:r=>{const{nodeInternals:n,nodeOrigin:s,elevateNodesOnSelect:o}=t();e({nodeInternals:_u(r,n,s,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(s=>({...n,...s}))})},setDefaultNodesAndEdges:(r,n)=>{const s=typeof r<"u",o=typeof n<"u",i=s?_u(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:i,edges:o?n:[],hasDefaultNodes:s,hasDefaultEdges:o})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:s,fitViewOnInit:o,fitViewOnInitDone:i,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),d=c==null?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const f=window.getComputedStyle(d),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((v,_)=>{const g=s.get(_.id);if(g!=null&&g.hidden)s.set(g.id,{...g,[$e]:{...g[$e],handleBounds:void 0}});else if(g){const x=Kv(_.nodeElement);!!(x.width&&x.height&&(g.width!==x.width||g.height!==x.height||_.forceUpdate))&&(s.set(g.id,{...g,[$e]:{...g[$e],handleBounds:{source:N0(".source",_.nodeElement,p,u),target:N0(".target",_.nodeElement,p,u)}},...x}),v.push({id:g.id,type:"dimensions",dimensions:x}))}return v},[]);IN(s,u);const y=i||o&&!i&&MN(t,{initial:!0,...a});e({nodeInternals:new Map(s),fitViewOnInitDone:y}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,s=!1)=>{const{triggerNodeChanges:o}=t(),i=r.map(a=>{const c={id:a.id,type:"position",dragging:s};return n&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});o(i)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:s,hasDefaultNodes:o,nodeOrigin:i,getNodes:a,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(o){const u=AN(r,a()),d=_u(u,s,i,c);e({nodeInternals:d})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let i,a=null;n?i=r.map(c=>pn(c,!0)):(i=$s(o(),r),a=$s(s,[])),Na({changedNodes:i,changedEdges:a,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let i,a=null;n?i=r.map(c=>pn(c,!0)):(i=$s(s,r),a=$s(o(),[])),Na({changedNodes:a,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:s,getNodes:o}=t(),i=r||o(),a=n||s,c=i.map(d=>(d.selected=!1,pn(d.id,!1))),u=a.map(d=>pn(d.id,!1));Na({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:s}=t();n==null||n.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:s}=t();n==null||n.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),o=n().filter(a=>a.selected).map(a=>pn(a.id,!1)),i=r.filter(a=>a.selected).map(a=>pn(a.id,!1));Na({changedNodes:o,changedEdges:i,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(s=>{s.positionAbsolute=Yv(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:s,height:o,d3Zoom:i,d3Selection:a,translateExtent:c}=t();if(!i||!a||!r.x&&!r.y)return!1;const u=Gr.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),d=[[0,0],[s,o]],f=i==null?void 0:i.constrain()(u,d,c);return i.transform(a,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:ln.connectionNodeId,connectionHandleId:ln.connectionHandleId,connectionHandleType:ln.connectionHandleType,connectionStatus:ln.connectionStatus,connectionStartHandle:ln.connectionStartHandle,connectionEndHandle:ln.connectionEndHandle}),reset:()=>e({...ln})}),Object.is),gc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=SA()),B.createElement(WM,{value:t.current},e)};gc.displayName="ReactFlowProvider";const UN=({children:e})=>m.useContext(fc)?B.createElement(B.Fragment,null,e):B.createElement(gc,null,e);UN.displayName="ReactFlowWrapper";const kA={input:SN,default:Og,output:NN,group:tx},NA={default:Pl,straight:Zv,step:Qv,smoothstep:pc,simplebezier:Xv},EA=[0,0],CA=[15,15],RA={x:0,y:0,zoom:1},TA={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},nx=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:o=kA,edgeTypes:i=NA,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:y,onConnectEnd:v,onClickConnectStart:_,onClickConnectEnd:g,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:j,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:S,onNodeDragStop:C,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:L,onSelectionDragStart:q,onSelectionDrag:E,onSelectionDragStop:D,onSelectionContextMenu:A,onSelectionStart:$,onSelectionEnd:O,connectionMode:M=fs.Strict,connectionLineType:z=vn.Bezier,connectionLineStyle:P,connectionLineComponent:I,connectionLineContainerStyle:F,deleteKeyCode:V="Backspace",selectionKeyCode:G="Shift",selectionOnDrag:X=!1,selectionMode:te=Ai.Full,panActivationKeyCode:se="Space",multiSelectionKeyCode:re=Il()?"Meta":"Control",zoomActivationKeyCode:Q=Il()?"Meta":"Control",snapToGrid:xe=!1,snapGrid:ne=CA,onlyRenderVisibleElements:ye=!1,selectNodesOnDrag:ee=!0,nodesDraggable:Y,nodesConnectable:pe,nodesFocusable:W,nodeOrigin:K=EA,edgesFocusable:ae,edgesUpdatable:ce,elementsSelectable:Se,defaultViewport:be=RA,minZoom:le=.5,maxZoom:H=2,translateExtent:Ce=zg,preventScrolling:oe=!0,nodeExtent:nt,defaultMarkerColor:He="#b1b1b7",zoomOnScroll:ht=!0,zoomOnPinch:rr=!0,panOnScroll:ke=!1,panOnScrollSpeed:st=.5,panOnScrollMode:Qe=es.Free,zoomOnDoubleClick:ot=!0,panOnDrag:nr=!0,onPaneClick:$t,onPaneMouseEnter:Ft,onPaneMouseMove:sn,onPaneMouseLeave:_o,onPaneScroll:$n,onPaneContextMenu:jo,children:Ue,onEdgeContextMenu:Fe,onEdgeDoubleClick:mt,onEdgeMouseEnter:yr,onEdgeMouseMove:wt,onEdgeMouseLeave:gt,onEdgeUpdate:Bt,onEdgeUpdateStart:on,onEdgeUpdateEnd:Ge,onReconnect:br,onReconnectStart:Ht,onReconnectEnd:sr,reconnectRadius:Fn=10,edgeUpdaterRadius:Bn=10,onNodesChange:wr,onEdgesChange:Hn,noDragClassName:So="nodrag",noWheelClassName:ZC="nowheel",noPanClassName:Px="nopan",fitView:JC=!1,fitViewOptions:e4,connectOnClick:t4=!0,attributionPosition:r4,proOptions:n4,defaultEdgeOptions:s4,elevateNodesOnSelect:o4=!0,elevateEdgesOnSelect:i4=!1,disableKeyboardA11y:Ax=!1,autoPanOnConnect:a4=!0,autoPanOnNodeDrag:l4=!0,connectionRadius:c4=20,isValidConnection:u4,onError:d4,style:f4,id:Dx,nodeDragThreshold:p4,...h4},m4)=>{const Hc=Dx||"1";return B.createElement("div",{...h4,style:{...f4,...TA},ref:m4,className:Rt(["react-flow",s]),"data-testid":"rf__wrapper",id:Dx},B.createElement(UN,null,B.createElement(jA,{onInit:u,onMove:d,onMoveStart:f,onMoveEnd:p,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:j,onNodeDoubleClick:k,nodeTypes:o,edgeTypes:i,connectionLineType:z,connectionLineStyle:P,connectionLineComponent:I,connectionLineContainerStyle:F,selectionKeyCode:G,selectionOnDrag:X,selectionMode:te,deleteKeyCode:V,multiSelectionKeyCode:re,panActivationKeyCode:se,zoomActivationKeyCode:Q,onlyRenderVisibleElements:ye,selectNodesOnDrag:ee,defaultViewport:be,translateExtent:Ce,minZoom:le,maxZoom:H,preventScrolling:oe,zoomOnScroll:ht,zoomOnPinch:rr,zoomOnDoubleClick:ot,panOnScroll:ke,panOnScrollSpeed:st,panOnScrollMode:Qe,panOnDrag:nr,onPaneClick:$t,onPaneMouseEnter:Ft,onPaneMouseMove:sn,onPaneMouseLeave:_o,onPaneScroll:$n,onPaneContextMenu:jo,onSelectionContextMenu:A,onSelectionStart:$,onSelectionEnd:O,onEdgeContextMenu:Fe,onEdgeDoubleClick:mt,onEdgeMouseEnter:yr,onEdgeMouseMove:wt,onEdgeMouseLeave:gt,onReconnect:br??Bt,onReconnectStart:Ht??on,onReconnectEnd:sr??Ge,reconnectRadius:Fn??Bn,defaultMarkerColor:He,noDragClassName:So,noWheelClassName:ZC,noPanClassName:Px,elevateEdgesOnSelect:i4,rfId:Hc,disableKeyboardA11y:Ax,nodeOrigin:K,nodeExtent:nt}),B.createElement(bP,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:y,onConnectEnd:v,onClickConnectStart:_,onClickConnectEnd:g,nodesDraggable:Y,nodesConnectable:pe,nodesFocusable:W,edgesFocusable:ae,edgesUpdatable:ce,elementsSelectable:Se,elevateNodesOnSelect:o4,minZoom:le,maxZoom:H,nodeExtent:nt,onNodesChange:wr,onEdgesChange:Hn,snapToGrid:xe,snapGrid:ne,connectionMode:M,translateExtent:Ce,connectOnClick:t4,defaultEdgeOptions:s4,fitView:JC,fitViewOptions:e4,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:N,onNodeDrag:S,onNodeDragStop:C,onSelectionDrag:E,onSelectionDragStart:q,onSelectionDragStop:D,noPanClassName:Px,nodeOrigin:K,rfId:Hc,autoPanOnConnect:a4,autoPanOnNodeDrag:l4,onError:d4,connectionRadius:c4,isValidConnection:u4,nodeDragThreshold:p4}),B.createElement(xP,{onSelectionChange:L}),Ue,B.createElement(UM,{proOptions:n4,position:r4}),B.createElement(kP,{rfId:Hc,disableKeyboardA11y:Ax})))});nx.displayName="ReactFlow";function GN(e){return t=>{const[r,n]=m.useState(t),s=m.useCallback(o=>n(i=>e(o,i)),[]);return[r,n,s]}}const KN=GN(AN),YN=GN(qP),XN=({id:e,x:t,y:r,width:n,height:s,style:o,color:i,strokeColor:a,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,onClick:p,selected:h})=>{const{background:y,backgroundColor:v}=o||{},_=i||y||v;return B.createElement("rect",{className:Rt(["react-flow__minimap-node",{selected:h},u]),x:t,y:r,rx:d,ry:d,width:n,height:s,fill:_,stroke:a,strokeWidth:c,shapeRendering:f,onClick:p?g=>p(g,e):void 0})};XN.displayName="MiniMapNode";var IA=m.memo(XN);const MA=e=>e.nodeOrigin,PA=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),Nu=e=>e instanceof Function?e:()=>e;function AA({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:s=2,nodeComponent:o=IA,onClick:i}){const a=Ae(PA,pt),c=Ae(MA),u=Nu(t),d=Nu(e),f=Nu(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return B.createElement(B.Fragment,null,a.map(h=>{const{x:y,y:v}=os(h,c).positionAbsolute;return B.createElement(o,{key:h.id,x:y,y:v,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:u(h),borderRadius:n,strokeColor:d(h),strokeWidth:s,shapeRendering:p,onClick:i,id:h.id})}))}var DA=m.memo(AA);const OA=200,LA=150,zA=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?YM(hc(t,e.nodeOrigin),r):r,rfId:e.rfId}},qA="react-flow__minimap-desc";function QN({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:s="",nodeBorderRadius:o=5,nodeStrokeWidth:i=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:d=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:y=!1,zoomable:v=!1,ariaLabel:_="React Flow mini map",inversePan:g=!1,zoomStep:x=10,offsetScale:b=5}){const w=rt(),j=m.useRef(null),{boundingRect:k,viewBB:N,rfId:S}=Ae(zA,pt),C=(e==null?void 0:e.width)??OA,R=(e==null?void 0:e.height)??LA,T=k.width/C,L=k.height/R,q=Math.max(T,L),E=q*C,D=q*R,A=b*q,$=k.x-(E-k.width)/2-A,O=k.y-(D-k.height)/2-A,M=E+A*2,z=D+A*2,P=`${qA}-${S}`,I=m.useRef(0);I.current=q,m.useEffect(()=>{if(j.current){const G=Kt(j.current),X=re=>{const{transform:Q,d3Selection:xe,d3Zoom:ne}=w.getState();if(re.sourceEvent.type!=="wheel"||!xe||!ne)return;const ye=-re.sourceEvent.deltaY*(re.sourceEvent.deltaMode===1?.05:re.sourceEvent.deltaMode?1:.002)*x,ee=Q[2]*Math.pow(2,ye);ne.scaleTo(xe,ee)},te=re=>{const{transform:Q,d3Selection:xe,d3Zoom:ne,translateExtent:ye,width:ee,height:Y}=w.getState();if(re.sourceEvent.type!=="mousemove"||!xe||!ne)return;const pe=I.current*Math.max(1,Q[2])*(g?-1:1),W={x:Q[0]-re.sourceEvent.movementX*pe,y:Q[1]-re.sourceEvent.movementY*pe},K=[[0,0],[ee,Y]],ae=Gr.translate(W.x,W.y).scale(Q[2]),ce=ne.constrain()(ae,K,ye);ne.transform(xe,ce)},se=rN().on("zoom",y?te:null).on("zoom.wheel",v?X:null);return G.call(se),()=>{G.on("zoom",null)}}},[y,v,g,x]);const F=p?G=>{const X=cr(G);p(G,{x:X[0],y:X[1]})}:void 0,V=h?(G,X)=>{const te=w.getState().nodeInternals.get(X);h(G,te)}:void 0;return B.createElement(Tn,{position:f,style:e,className:Rt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},B.createElement("svg",{width:C,height:R,viewBox:`${$} ${O} ${M} ${z}`,role:"img","aria-labelledby":P,ref:j,onClick:F},_&&B.createElement("title",{id:P},_),B.createElement(DA,{onClick:V,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:a}),B.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-A},${O-A}h${M+A*2}v${z+A*2}h${-M-A*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:d,pointerEvents:"none"})))}QN.displayName="MiniMap";var ZN=m.memo(QN);const Ca={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},$A=180,FA=400,BA=260,HA=48;function WA(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function VA({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:s,onToggleShowArchived:o,userSection:i}){const[a,c]=m.useState(!1),[u,d]=m.useState(BA),[f,p]=m.useState(!1),h=m.useRef(null),y=m.useRef(null);m.useEffect(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const v=m.useMemo(()=>Object.values(e).sort((j,k)=>{const N=(j.name||"").localeCompare(k.name||"");return N!==0?N:(j.projectId||"").localeCompare(k.projectId||"")}),[e]),_=()=>{n()},g=m.useCallback(j=>{j.preventDefault(),p(!0)},[]),x=m.useCallback(j=>{if(!f)return;const k=Math.min(FA,Math.max($A,j.clientX));d(k)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",x),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,x,b]);const w=a?HA:u;return l.jsxs("div",{ref:h,className:"h-full flex flex-col relative",style:{width:w,minWidth:w,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[l.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!a&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),l.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:s?"#f59e0b":"var(--text-muted)"},title:s?"Hide archived":"Show archived",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),l.jsx("button",{onClick:()=>c(!a),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:a?"Expand sidebar":"Collapse sidebar",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:a?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:l.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!a&&l.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:v.map(j=>{const k=t===j.id;return l.jsxs("div",{ref:k?y:null,onClick:()=>r(j.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:k?"var(--state-active-bg)":"transparent",border:k?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:k?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:k?"#ffffff":Ca[j.status]||Ca.queued}}),l.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:k?"#ffffff":"var(--text-primary)"},children:j.name}),j.isArchived&&l.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:k?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),l.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[l.jsx("span",{className:"text-[10px] font-mono",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:j.projectId}),l.jsx("span",{className:"text-[10px]",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:WA(j.createdAt)})]})]},j.id)})}),a&&l.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:v.map(j=>l.jsx("div",{onClick:()=>r(j.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:j.name,children:l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:Ca[j.status]||Ca.queued,boxShadow:t===j.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},j.id))}),!a&&l.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:_,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[l.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),l.jsx("span",{children:"New Project"})]})}),a&&l.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:l.jsx("button",{onClick:_,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:l.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),i,!a&&l.jsx("div",{onMouseDown:g,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function UA({stations:e}){return e!=null&&e.length?l.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,r)=>{const n=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",s=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",o=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return l.jsxs(B.Fragment,{children:[r>0&&l.jsx("div",{className:"w-4 h-0.5",style:{background:s}}),l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:n}}),l.jsx("span",{className:"text-[7px] mt-0.5",style:{color:o,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const A0={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},JN=(e,t)=>{var r;return((r=A0[t])==null?void 0:r[e])||A0.industrial.queued},ir={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},ai={GAP:8,WIDTH:280},Eu=["pgc","asm","draft","qa","done"],xn=["industrial","light","blueprint"];function GA({questions:e,nodeWidth:t,onSubmit:r,onClose:n,onZoomComplete:s}){const[o,i]=m.useState({}),a=e.filter(c=>c.required).every(c=>o[c.id]);return m.useEffect(()=>{if(s){const c=setTimeout(()=>s(),150);return()=>clearTimeout(c)}},[s]),l.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+ai.GAP,width:ai.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[l.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:ai.GAP}}),l.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),l.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[l.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),l.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),l.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>l.jsxs("div",{children:[l.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&l.jsx("span",{className:"text-amber-600",children:"*"})]}),l.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:o[c.id]||"",onChange:u=>i(d=>({...d,[c.id]:u.target.value}))})]},c.id))}),l.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:l.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${a?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!a,onClick:()=>r(o),children:"Submit & Continue"})})]})}function KA({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:s}){const o=e.length>6,i=o?240:320;return m.useEffect(()=>{if(s){const a=setTimeout(()=>s(),150);return()=>clearTimeout(a)}},[s]),l.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:r+ai.GAP,width:i,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[l.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:ai.GAP}}),l.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),l.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[l.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),l.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),l.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${o?"":"grid grid-cols-2 gap-2"}`,children:e.map(a=>{const c=a.state==="complete"?"var(--state-stabilized-bg)":a.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return l.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${o?"mb-1":""}`,children:[l.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),l.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:a.name})]},a.id)})}),l.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const sx="/api/v1";class YA extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function XA(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function _e(e,t={}){const r=`${sx}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},s=await fetch(r,n);if(!s.ok){const o=await s.json().catch(()=>({}));throw new YA(o.detail||`Request failed: ${s.status}`,s.status,o)}return s.status===204?null:s.json()}const Pe={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":XA()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return _e(`/projects${r?"?"+r:""}`)},getProject:e=>_e(`/projects/${e}`),getProjectTree:e=>_e(`/projects/${e}/tree`),createProject:e=>_e("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>_e(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>_e(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>_e(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>_e(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>_e(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),_e(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>_e(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>_e(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>_e("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>_e(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>_e(`/document-workflows/executions/${e}`),getPgcAnswers:e=>_e(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>_e(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>_e(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>_e("/intake/start",{method:"POST"}),getIntakeState:e=>_e(`/intake/${e}`),submitIntakeMessage:(e,t)=>_e(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>_e(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>_e(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>_e(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>_e(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>_e(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>_e(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>_e(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>_e(`/projects/${e}/workflow/complete`,{method:"POST"})};function QA(e){const t=`${sx}/production/events?project_id=${e}`;return new EventSource(t)}function ZA(e){const t=`${sx}/intake/${e}/events`;return new EventSource(t)}function JA(e){return`/auth/login/${e}`}function e6({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?l.jsxs("div",{style:{marginBottom:12},children:[l.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&l.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function D0({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const s=n==="numbered"?"decimal":"disc";return l.jsxs("div",{style:{marginBottom:12},children:[t.title&&l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),l.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":s},children:r.map((o,i)=>l.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&l.jsx("span",{style:{color:"#10b981"},children:""}),typeof o=="string"?o:(o==null?void 0:o.value)||(o==null?void 0:o.text)||(o==null?void 0:o.question)||(o==null?void 0:o.description)||JSON.stringify(o)]},i))})]})}function t6({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,o={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return l.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&l.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),l.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:o.bg,color:o.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function eE({block:e}){const{data:t}=e,{id:r,text:n,blocking:s,why_it_matters:o,priority:i,tags:a,options:c}=t,u={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},d=u[i]||u.should;return l.jsx("div",{style:{padding:"12px 16px",background:s?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${s?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),l.jsxs("div",{style:{flex:1},children:[l.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),o&&l.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:o}),l.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[s&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),i&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:d.bg,color:d.text,textTransform:"uppercase"},children:i}),a==null?void 0:a.map((f,p)=>l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},p))]}),c&&c.length>0&&l.jsxs("div",{style:{marginTop:8},children:[l.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,p)=>l.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:p>0?8:4},children:f},p))]})]})]})})}function r6({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,s=t.blocking_count||r.filter(o=>o.blocking).length;return r.length===0?l.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):l.jsxs("div",{children:[l.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[l.jsxs("span",{style:{color:"#6b7280"},children:[l.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),s>0&&l.jsxs("span",{style:{color:"#dc2626"},children:[l.jsx("strong",{children:s})," blocking"]})]}),r.map((o,i)=>l.jsx(eE,{block:{type:"schema:OpenQuestionV1",data:o}},o.id||i))]})}function O0({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const s={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return l.jsxs("div",{style:{marginBottom:12},children:[n&&l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,i)=>{const a=o.severity||o.likelihood||"medium",c=s[a]||s.medium;return l.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[o.id&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:o.id}),l.jsxs("div",{style:{flex:1},children:[l.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:o.description||o.reason||JSON.stringify(o)}),o.impact&&l.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",o.impact]}),o.mitigation&&l.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",o.mitigation]})]}),l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:a})]})},o.id||i)})})]})}function n6({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([s])=>t[s]&&typeof t[s]=="string").map(([s,o])=>({title:o,content:t[s]}));return n.length===0?null:l.jsx("div",{style:{marginBottom:12},children:n.map((s,o)=>l.jsxs("div",{style:{marginBottom:o<n.length-1?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:s.title}),l.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:l.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:s.content})})]},o))})}function L0({block:e}){const{data:t}=e,{epic_id:r,title:n,name:s,intent:o,phase:i,mvp_phase:a,risk_level:c,stories:u,detail_ref:d}=t,f=i||a,p=n||s,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},y=h[c]||h.medium,v={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},_=v[f]||v.mvp;return l.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),l.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),o&&l.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:o}),u&&u.length>0&&l.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[u.length," stories"]})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:_.bg,color:_.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&l.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:y.bg,color:y.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),d&&l.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:l.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function s6({block:e}){const{data:t}=e,{story_id:r,title:n,intent:s,phase:o,risk_level:i,detail_ref:a}=t,u={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[i]||null,d={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=d[o]||d.mvp;return l.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),l.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),s&&l.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:s})]}),l.jsxs("div",{style:{display:"flex",gap:4},children:[o&&l.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:o}),u&&l.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:u.bg,color:u.text,textTransform:"uppercase",fontWeight:500},children:i})]})]})})}function o6({block:e}){const{type:t,data:r}=e;return l.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[l.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),l.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function i6({block:e}){const{data:t}=e,r=t.items||[],[n,s]=m.useState({});if(r.length===0)return null;const o=i=>{s(a=>({...a,[i]:!a[i]}))};return l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((i,a)=>{const c=n[a],u=i.why_it_matters||i.impact_if_unresolved;return l.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[l.jsxs("button",{onClick:()=>u&&o(a),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:u?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[l.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:i.question||i.value||i.text||"Unknown"}),u&&l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:l.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&u&&l.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[i.why_it_matters&&l.jsxs("div",{style:{marginTop:10},children:[l.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),l.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:i.why_it_matters})]}),i.impact_if_unresolved&&l.jsxs("div",{style:{marginTop:10},children:[l.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),l.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:i.impact_if_unresolved})]})]})]},a)})})}function a6({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return l.jsxs("div",{style:{marginBottom:12},children:[r&&l.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&l.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function l6({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:s}=t;return l.jsxs("div",{style:{marginBottom:12},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[l.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&l.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),s&&l.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s})]})}function c6({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,s=r&&r.length>0,o=n&&n.length>0;return!s&&!o?null:l.jsxs("div",{style:{marginBottom:12},children:[s&&l.jsxs("div",{style:{marginBottom:o?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((i,a)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#f59e0b"},children:""}),l.jsx("span",{children:i})]},a))})]}),o&&l.jsxs("div",{children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((i,a)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#3b82f6"},children:""}),l.jsx("span",{children:i})]},a))})]})]})}function u6({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:s=[]}=t,o=r&&r.length>0,i=n&&n.length>0,a=s&&s.length>0;return!o&&!i&&!a?null:l.jsxs("div",{style:{marginBottom:12},children:[o&&l.jsxs("div",{style:{marginBottom:i||a?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#3b82f6"},children:""}),l.jsx("span",{children:c})]},u))})]}),i&&l.jsxs("div",{style:{marginBottom:a?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#f59e0b"},children:""}),l.jsx("span",{children:c})]},u))})]}),a&&l.jsxs("div",{children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:s.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#6b7280"},children:""}),l.jsx("span",{children:c})]},u))})]})]})}function d6({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:s}=t,i={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return l.jsxs("div",{style:{marginBottom:12},children:[r&&l.jsx("div",{style:{marginBottom:12},children:l.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:i.bg,color:i.text},children:r})}),n&&l.jsx("p",{style:{margin:0,marginBottom:s?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),s&&l.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:l.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",s]})})]})}const f6={"schema:ParagraphBlockV1":e6,"schema:StringListBlockV1":D0,"schema:IndicatorBlockV1":t6,"schema:OpenQuestionV1":eE,"schema:OpenQuestionsBlockV1":r6,"schema:RisksBlockV1":O0,"schema:DependenciesBlockV1":O0,"schema:SummaryBlockV1":n6,"schema:EpicSummaryBlockV1":L0,"schema:StorySummaryBlockV1":s6,"schema:EpicStoriesCardBlockV1":L0,"schema:StoriesBlockV1":D0,"schema:UnknownsBlockV1":i6,"schema:IntakeSummaryBlockV1":a6,"schema:IntakeProjectTypeBlockV1":l6,"schema:IntakeConstraintsBlockV1":c6,"schema:IntakeOpenGapsBlockV1":u6,"schema:IntakeOutcomeBlockV1":d6};function p6(e){return f6[e]||o6}function h6(e,t){const r=p6(e.type);return l.jsx(r,{block:e},e.key||t)}function tE({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:s=""}){var _;const[o,i]=m.useState(new Set(((_=e==null?void 0:e.sections)==null?void 0:_.map(g=>g.section_id))||[]));if(!e)return l.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:a,subtitle:c,sections:u=[],metadata:d}=e;if(d!=null&&d.fallback&&e.raw_content)return l.jsx(g6,{title:a,content:e.raw_content,reason:d.reason});const f=g=>{i(x=>{const b=new Set(x);return b.has(g)?b.delete(g):b.add(g),b})},p=t==="compact"||t==="sidecar",y=t==="sidecar"?u.filter(g=>g.viewer_tab==="overview"||!g.viewer_tab):u,v=(()=>{if(!a)return"Document";const g=a.indexOf(": ");return g>-1?a.slice(g+2):a})();return l.jsxs("div",{className:s,children:[t==="full"&&!r&&l.jsxs("div",{style:{marginBottom:24},children:[l.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:v}),c&&l.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:y.map(g=>l.jsx(m6,{section:g,isExpanded:o.has(g.section_id),onToggle:()=>f(g.section_id),onClick:()=>n==null?void 0:n(g),variant:t},g.section_id))}),y.length===0&&l.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function m6({section:e,isExpanded:t,onToggle:r,onClick:n,variant:s}){const{section_id:o,title:i,description:a,blocks:c=[],sidecar_max_items:u}=e,d=s==="compact"||s==="sidecar",f=s==="sidecar";if(c.length===0)return null;const p=f&&u&&c.length>u?c.slice(0,u):c,h=f&&u&&c.length>u;return l.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[l.jsxs("button",{onClick:r,style:{width:"100%",padding:d?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[l.jsxs("div",{children:[l.jsxs("h3",{style:{margin:0,fontSize:d?13:15,fontWeight:600,color:"#111827"},children:[i,h&&l.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",u," of ",c.length,")"]})]}),a&&!d&&l.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:a})]}),l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:l.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&l.jsxs("div",{style:{padding:d?12:18},children:[p.map((y,v)=>h6(y,v)),h&&l.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-u," more in full view"]})]})]})}function g6({title:e,content:t,reason:r}){return l.jsxs("div",{children:[l.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function v6({renderModel:e,projectCode:t,documentName:r,isExpanded:n,onToggleExpand:s,onClose:o,onViewFull:i,nodeWidth:a=280}){const p=n?900:520,h=n?900:600,y=`${t||"DOC"} - ${r||"Document"}`,v=_=>{_.stopPropagation()};return l.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:a+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:v,onPointerDown:v,children:[l.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),l.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),l.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),l.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const _=(e==null?void 0:e.title)||"DOCUMENT",g=_.indexOf(": ");return(g>-1?_.slice(g+2):_).toUpperCase()})()}),l.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:s,title:n?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:n?l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),l.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),l.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:n?600:400},children:l.jsx(tE,{renderModel:e,variant:"sidecar"})}),l.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:l.jsxs("button",{onClick:i,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[l.jsx("span",{children:"View Full Document"}),l.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function x6({document:e,projectId:t,projectCode:r,nodeWidth:n,onClose:s,onZoomComplete:o,onViewFull:i}){const[a,c]=m.useState(null),[u,d]=m.useState(null),[f,p]=m.useState(!0),[h,y]=m.useState(!1);return m.useEffect(()=>{if(o){const v=setTimeout(()=>o(),150);return()=>clearTimeout(v)}},[o]),m.useEffect(()=>{async function v(){var _;if(!t||!e.id){p(!1);return}try{p(!0);try{const x=await Pe.getDocumentRenderModel(t,e.id);if(x&&x.sections&&x.sections.length>0){c(x),d(null);return}if((_=x==null?void 0:x.metadata)!=null&&_.fallback&&x.raw_content){c(null),d(x.raw_content);return}}catch(x){console.log("RenderModel not available, falling back to raw document:",x.message)}const g=await Pe.getDocument(t,e.id);c(null),d((g==null?void 0:g.content)||null)}catch(g){console.error("Failed to fetch document for sidecar:",g)}finally{p(!1)}}v()},[t,e.id]),f?null:a?l.jsx(v6,{renderModel:a,projectCode:r,documentName:e.name,isExpanded:h,onToggleExpand:()=>y(!h),onClose:s,onViewFull:()=>i==null?void 0:i(e.id),nodeWidth:n}):l.jsx(y6,{document:e,projectCode:r,rawContent:u,nodeWidth:n,isExpanded:h,onToggleExpand:()=>y(!h),onClose:s,onViewFull:()=>i==null?void 0:i(e.id)})}function y6({document:e,projectCode:t,rawContent:r,nodeWidth:n,isExpanded:s,onToggleExpand:o,onClose:i,onViewFull:a}){var _;const p=s?900:520,h=s?900:600,y=`${t||"DOC"} - ${e.name||"Document"}`,v=g=>{g.stopPropagation()};return l.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:n+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:v,onPointerDown:v,children:[l.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),l.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),l.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),l.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((_=e.name)==null?void 0:_.toUpperCase())||"DOCUMENT"}),l.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:o,title:s?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:s?l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),l.jsx("button",{onClick:i,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),l.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:s?600:400},children:[l.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]}),l.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:l.jsxs("button",{onClick:a,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[l.jsx("span",{children:"View Full Document"}),l.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const b6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function w6({data:e}){var w,j,k;const r=(e.level||1)===1,n=e.isExpanded,s=e.expandType,o=((w=e.questions)==null?void 0:w.length)>0,i=((j=e.features)==null?void 0:j.length)>0,a=(k=e.stations)==null?void 0:k.some(N=>N.needs_input),c=e.state||"ready_for_production",u=["produced","stabilized","ready"].includes(c),d=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),p=d&&e.stations,h=d?"node-active":"",y=r?"DOCUMENT":"EPIC",v=r?"subway-node-header-doc":"subway-node-header-epic",_=u?"var(--state-produced-bg, var(--state-stabilized-bg))":d?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",g=u?"var(--state-produced-text, var(--state-stabilized-text))":d?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",x=d?"var(--state-in-production-bg, var(--state-active-bg))":u?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=b6[c]||c;return l.jsxs("div",{className:"relative",children:[l.jsx(Ir,{type:"target",position:J.Top,className:"!opacity-0",style:{left:"15%"}}),l.jsxs("div",{className:`subway-node rounded-lg border ${h} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:x},children:[l.jsxs("div",{className:`${v} border-b px-3 py-1.5 flex items-center justify-between`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:y}),l.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&l.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),l.jsxs("div",{className:"p-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:_}}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:g},children:b}),r&&e.desc&&l.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),p&&l.jsx(UA,{stations:e.stations}),l.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&u&&l.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:N=>{var S;N.stopPropagation(),(S=e.onExpand)==null||S.call(e,e.id,"document")},children:"View Document"}),a&&o&&!n&&l.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:N=>{var S;N.stopPropagation(),(S=e.onExpand)==null||S.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&i&&(n&&s==="features"?l.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):l.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:N=>{var S;N.stopPropagation(),(S=e.onExpand)==null||S.call(e,e.id,"features")},children:[l.jsx("span",{className:"text-indigo-400",children:e.features.length}),l.jsx("span",{children:"features"}),l.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),n&&s==="questions"&&o&&l.jsx(GA,{questions:e.questions,nodeWidth:e.width,onSubmit:N=>{var S;return(S=e.onSubmitQuestions)==null?void 0:S.call(e,e.id,N)},onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&s==="features"&&i&&l.jsx(KA,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&s==="document"&&r&&u&&l.jsx(x6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)},onViewFull:N=>{var S;return(S=e.onViewFullDocument)==null?void 0:S.call(e,N)}}),l.jsx(Ir,{type:"source",position:J.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function _6(){return l.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[l.jsx(Ir,{type:"target",position:J.Top,style:{opacity:0}}),l.jsx(Ir,{type:"source",position:J.Bottom,style:{opacity:0}})]})}function j6({projectId:e,projectCode:t,docTypeId:r,onClose:n}){const[s,o]=m.useState(null),[i,a]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null);return m.useEffect(()=>{async function p(){var h;try{u(!0),f(null);try{const v=await Pe.getDocumentRenderModel(e,r);if(v&&v.sections&&v.sections.length>0){o(v),a(null);return}if((h=v==null?void 0:v.metadata)!=null&&h.fallback&&v.raw_content){o(null),a(v.raw_content);return}}catch(v){console.log("RenderModel not available, falling back to raw document:",v.message)}const y=await Pe.getDocument(e,r);o(null),a((y==null?void 0:y.content)||null)}catch(y){f(y.message),console.error("Failed to fetch document:",y)}finally{u(!1)}}p()},[e,r]),m.useEffect(()=>{const p=h=>{h.key==="Escape"&&n()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[n]),c?l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:l.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:p=>p.target===p.currentTarget&&n(),children:l.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[l.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[l.jsx("div",{children:t&&l.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),l.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[d&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-red-500",children:d})}),s&&l.jsx(tE,{renderModel:s,variant:"full"}),i&&!s&&l.jsx(S6,{content:i,docTypeId:r}),!s&&!i&&!d&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function S6({content:e,docTypeId:t}){if(!e)return l.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n=e.description||e.summary||e.preliminary_summary;return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",l.jsx("strong",{children:t})," - displaying raw content"]}),(r||n)&&l.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[r&&l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),n&&l.jsx("p",{className:"text-gray-700 text-sm",children:n})]}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const k6="/api/v1/admin";class N6 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function E6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ie(e,t={}){var o;const r=`${k6}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const i=E6();i&&(n.headers["X-CSRF-Token"]=i)}const s=await fetch(r,n);if(!s.ok){const i=await s.json().catch(()=>({})),a=((o=i.detail)==null?void 0:o.message)||i.detail||`Request failed: ${s.status}`;throw new N6(a,s.status,i.detail||i)}return s.status===204?null:s.json()}const Ee={getCurrentWorkspace:async()=>{try{return await Ie("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ie("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ie(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ie(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ie(`/workspaces/${e}/artifacts/${t}`),writeArtifact:(e,t,r)=>Ie(`/workspaces/${e}/artifacts/${t}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ie(`/workspaces/${e}/preview/${t}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ie(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ie(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ie(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ie("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ie(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ie(`/workbench/document-types/${e}/versions`),getRoles:()=>Ie("/workbench/roles"),getTemplates:()=>Ie("/workbench/templates"),getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ie(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ie(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ie("/workbench/workflows"),getOrchestrationWorkflows:()=>Ie("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ie(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ie(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ie(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),getActiveReleases:()=>Ie("/workbench/active-releases"),invalidateCache:()=>Ie("/workbench/cache/invalidate",{method:"POST"})};function C6({projectId:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,i]=m.useState(null),[a,c]=m.useState(!1),[u,d]=m.useState([]),[f,p]=m.useState(!1),[h,y]=m.useState(!1),[v,_]=m.useState(null),[g,x]=m.useState(!1),[b,w]=m.useState(!1),j=m.useCallback(async()=>{if(e){s(!0),i(null);try{const L=await Pe.getWorkflowInstance(e);r(L)}catch(L){L.status===404?r(null):i(L.message)}finally{s(!1)}}},[e]);m.useEffect(()=>{j()},[j]);const k=async()=>{c(!0),p(!0);try{const L=await Ee.getOrchestrationWorkflows();d(L.workflows||[])}catch{d([])}finally{p(!1)}},N=async L=>{y(!0);try{const q=await Pe.createWorkflowInstance(e,L.workflow_id,L.active_version);r(q),c(!1)}catch(q){i(q.message)}finally{y(!1)}},S=async()=>{if(t&&(w(!b),!v)){x(!0);try{const L=await Pe.getWorkflowDrift(e);_(L)}catch(L){_({error:L.message})}finally{x(!1)}}};if(n)return l.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(o&&!t)return l.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:o});if(!t)return l.jsxs("div",{className:"p-4",children:[l.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),a?l.jsx(R6,{workflows:u,loading:f,assigning:h,onSelect:N,onCancel:()=>c(!1)}):l.jsx("button",{onClick:k,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const C=t.effective_workflow||{},R=C.steps||[],T=t.base_workflow_ref||{};return l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:C.name||T.workflow_id||"Workflow"}),l.jsx(T6,{status:t.status})]}),l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",T.workflow_id," v",T.version,T.pow_class?` (${T.pow_class})`:""]})]}),l.jsx("button",{onClick:S,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:g?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&v&&l.jsx(I6,{drift:v}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",R.length,")"]}),R.length===0?l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):l.jsx("div",{className:"space-y-1",children:R.map((L,q)=>l.jsx(M6,{step:L,index:q},L.step_id||q))})]}),o&&l.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:o})]})}function R6({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:s}){const o=e.filter(a=>(a.pow_class||"reference")==="reference"),i=e.filter(a=>a.pow_class==="template");return l.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):l.jsxs(l.Fragment,{children:[o.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),o.map(a=>l.jsxs("button",{onClick:()=>n(a),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[l.jsx("div",{className:"font-medium",children:a.name||a.workflow_id}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",a.active_version,"  ",a.step_count," steps"]})]},a.workflow_id))]}),i.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),i.map(a=>l.jsxs("button",{onClick:()=>n(a),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[l.jsx("div",{className:"font-medium",children:a.name||a.workflow_id}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",a.active_version,"  ",a.step_count," steps",a.derived_from_label?`  from ${a.derived_from_label}`:""]})]},a.workflow_id))]}),o.length===0&&i.length===0&&l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),l.jsx("button",{onClick:s,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function T6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return l.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function I6({drift:e}){return e.error?l.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):l.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[l.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[l.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),l.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&l.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&l.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&l.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&l.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&l.jsx("div",{children:"~ Metadata changed"})]})]})}function M6({step:e,index:t}){return l.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),l.jsxs("div",{style:{flex:1},children:[l.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&l.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&l.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function ox(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Cu,z0;function P6(){if(z0)return Cu;z0=1;function e(){this.__data__=[],this.size=0}return Cu=e,Cu}var Ru,q0;function po(){if(q0)return Ru;q0=1;function e(t,r){return t===r||t!==t&&r!==r}return Ru=e,Ru}var Tu,$0;function vc(){if($0)return Tu;$0=1;var e=po();function t(r,n){for(var s=r.length;s--;)if(e(r[s][0],n))return s;return-1}return Tu=t,Tu}var Iu,F0;function A6(){if(F0)return Iu;F0=1;var e=vc(),t=Array.prototype,r=t.splice;function n(s){var o=this.__data__,i=e(o,s);if(i<0)return!1;var a=o.length-1;return i==a?o.pop():r.call(o,i,1),--this.size,!0}return Iu=n,Iu}var Mu,B0;function D6(){if(B0)return Mu;B0=1;var e=vc();function t(r){var n=this.__data__,s=e(n,r);return s<0?void 0:n[s][1]}return Mu=t,Mu}var Pu,H0;function O6(){if(H0)return Pu;H0=1;var e=vc();function t(r){return e(this.__data__,r)>-1}return Pu=t,Pu}var Au,W0;function L6(){if(W0)return Au;W0=1;var e=vc();function t(r,n){var s=this.__data__,o=e(s,r);return o<0?(++this.size,s.push([r,n])):s[o][1]=n,this}return Au=t,Au}var Du,V0;function xc(){if(V0)return Du;V0=1;var e=P6(),t=A6(),r=D6(),n=O6(),s=L6();function o(i){var a=-1,c=i==null?0:i.length;for(this.clear();++a<c;){var u=i[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,Du=o,Du}var Ou,U0;function z6(){if(U0)return Ou;U0=1;var e=xc();function t(){this.__data__=new e,this.size=0}return Ou=t,Ou}var Lu,G0;function q6(){if(G0)return Lu;G0=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Lu=e,Lu}var zu,K0;function $6(){if(K0)return zu;K0=1;function e(t){return this.__data__.get(t)}return zu=e,zu}var qu,Y0;function F6(){if(Y0)return qu;Y0=1;function e(t){return this.__data__.has(t)}return qu=e,qu}var $u,X0;function rE(){if(X0)return $u;X0=1;var e=typeof ta=="object"&&ta&&ta.Object===Object&&ta;return $u=e,$u}var Fu,Q0;function vr(){if(Q0)return Fu;Q0=1;var e=rE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Fu=r,Fu}var Bu,Z0;function ho(){if(Z0)return Bu;Z0=1;var e=vr(),t=e.Symbol;return Bu=t,Bu}var Hu,J0;function B6(){if(J0)return Hu;J0=1;var e=ho(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,s=e?e.toStringTag:void 0;function o(i){var a=r.call(i,s),c=i[s];try{i[s]=void 0;var u=!0}catch{}var d=n.call(i);return u&&(a?i[s]=c:delete i[s]),d}return Hu=o,Hu}var Wu,e1;function H6(){if(e1)return Wu;e1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Wu=r,Wu}var Vu,t1;function ms(){if(t1)return Vu;t1=1;var e=ho(),t=B6(),r=H6(),n="[object Null]",s="[object Undefined]",o=e?e.toStringTag:void 0;function i(a){return a==null?a===void 0?s:n:o&&o in Object(a)?t(a):r(a)}return Vu=i,Vu}var Uu,r1;function er(){if(r1)return Uu;r1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Uu=e,Uu}var Gu,n1;function Gi(){if(n1)return Gu;n1=1;var e=ms(),t=er(),r="[object AsyncFunction]",n="[object Function]",s="[object GeneratorFunction]",o="[object Proxy]";function i(a){if(!t(a))return!1;var c=e(a);return c==n||c==s||c==r||c==o}return Gu=i,Gu}var Ku,s1;function W6(){if(s1)return Ku;s1=1;var e=vr(),t=e["__core-js_shared__"];return Ku=t,Ku}var Yu,o1;function V6(){if(o1)return Yu;o1=1;var e=W6(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Yu=r,Yu}var Xu,i1;function nE(){if(i1)return Xu;i1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Xu=r,Xu}var Qu,a1;function U6(){if(a1)return Qu;a1=1;var e=Gi(),t=V6(),r=er(),n=nE(),s=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,a=Object.prototype,c=i.toString,u=a.hasOwnProperty,d=RegExp("^"+c.call(u).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?d:o;return h.test(n(p))}return Qu=f,Qu}var Zu,l1;function G6(){if(l1)return Zu;l1=1;function e(t,r){return t==null?void 0:t[r]}return Zu=e,Zu}var Ju,c1;function gs(){if(c1)return Ju;c1=1;var e=U6(),t=G6();function r(n,s){var o=t(n,s);return e(o)?o:void 0}return Ju=r,Ju}var ed,u1;function ix(){if(u1)return ed;u1=1;var e=gs(),t=vr(),r=e(t,"Map");return ed=r,ed}var td,d1;function yc(){if(d1)return td;d1=1;var e=gs(),t=e(Object,"create");return td=t,td}var rd,f1;function K6(){if(f1)return rd;f1=1;var e=yc();function t(){this.__data__=e?e(null):{},this.size=0}return rd=t,rd}var nd,p1;function Y6(){if(p1)return nd;p1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return nd=e,nd}var sd,h1;function X6(){if(h1)return sd;h1=1;var e=yc(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function s(o){var i=this.__data__;if(e){var a=i[o];return a===t?void 0:a}return n.call(i,o)?i[o]:void 0}return sd=s,sd}var od,m1;function Q6(){if(m1)return od;m1=1;var e=yc(),t=Object.prototype,r=t.hasOwnProperty;function n(s){var o=this.__data__;return e?o[s]!==void 0:r.call(o,s)}return od=n,od}var id,g1;function Z6(){if(g1)return id;g1=1;var e=yc(),t="__lodash_hash_undefined__";function r(n,s){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=e&&s===void 0?t:s,this}return id=r,id}var ad,v1;function J6(){if(v1)return ad;v1=1;var e=K6(),t=Y6(),r=X6(),n=Q6(),s=Z6();function o(i){var a=-1,c=i==null?0:i.length;for(this.clear();++a<c;){var u=i[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,ad=o,ad}var ld,x1;function eD(){if(x1)return ld;x1=1;var e=J6(),t=xc(),r=ix();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return ld=n,ld}var cd,y1;function tD(){if(y1)return cd;y1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return cd=e,cd}var ud,b1;function bc(){if(b1)return ud;b1=1;var e=tD();function t(r,n){var s=r.__data__;return e(n)?s[typeof n=="string"?"string":"hash"]:s.map}return ud=t,ud}var dd,w1;function rD(){if(w1)return dd;w1=1;var e=bc();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return dd=t,dd}var fd,_1;function nD(){if(_1)return fd;_1=1;var e=bc();function t(r){return e(this,r).get(r)}return fd=t,fd}var pd,j1;function sD(){if(j1)return pd;j1=1;var e=bc();function t(r){return e(this,r).has(r)}return pd=t,pd}var hd,S1;function oD(){if(S1)return hd;S1=1;var e=bc();function t(r,n){var s=e(this,r),o=s.size;return s.set(r,n),this.size+=s.size==o?0:1,this}return hd=t,hd}var md,k1;function ax(){if(k1)return md;k1=1;var e=eD(),t=rD(),r=nD(),n=sD(),s=oD();function o(i){var a=-1,c=i==null?0:i.length;for(this.clear();++a<c;){var u=i[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,md=o,md}var gd,N1;function iD(){if(N1)return gd;N1=1;var e=xc(),t=ix(),r=ax(),n=200;function s(o,i){var a=this.__data__;if(a instanceof e){var c=a.__data__;if(!t||c.length<n-1)return c.push([o,i]),this.size=++a.size,this;a=this.__data__=new r(c)}return a.set(o,i),this.size=a.size,this}return gd=s,gd}var vd,E1;function wc(){if(E1)return vd;E1=1;var e=xc(),t=z6(),r=q6(),n=$6(),s=F6(),o=iD();function i(a){var c=this.__data__=new e(a);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=r,i.prototype.get=n,i.prototype.has=s,i.prototype.set=o,vd=i,vd}var xd,C1;function lx(){if(C1)return xd;C1=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s&&r(t[n],n,t)!==!1;);return t}return xd=e,xd}var yd,R1;function sE(){if(R1)return yd;R1=1;var e=gs(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return yd=t,yd}var bd,T1;function _c(){if(T1)return bd;T1=1;var e=sE();function t(r,n,s){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:s,writable:!0}):r[n]=s}return bd=t,bd}var wd,I1;function jc(){if(I1)return wd;I1=1;var e=_c(),t=po(),r=Object.prototype,n=r.hasOwnProperty;function s(o,i,a){var c=o[i];(!(n.call(o,i)&&t(c,a))||a===void 0&&!(i in o))&&e(o,i,a)}return wd=s,wd}var _d,M1;function Ki(){if(M1)return _d;M1=1;var e=jc(),t=_c();function r(n,s,o,i){var a=!o;o||(o={});for(var c=-1,u=s.length;++c<u;){var d=s[c],f=i?i(o[d],n[d],d,o,n):void 0;f===void 0&&(f=n[d]),a?t(o,d,f):e(o,d,f)}return o}return _d=r,_d}var jd,P1;function aD(){if(P1)return jd;P1=1;function e(t,r){for(var n=-1,s=Array(t);++n<t;)s[n]=r(n);return s}return jd=e,jd}var Sd,A1;function Ar(){if(A1)return Sd;A1=1;function e(t){return t!=null&&typeof t=="object"}return Sd=e,Sd}var kd,D1;function lD(){if(D1)return kd;D1=1;var e=ms(),t=Ar(),r="[object Arguments]";function n(s){return t(s)&&e(s)==r}return kd=n,kd}var Nd,O1;function Yi(){if(O1)return Nd;O1=1;var e=lD(),t=Ar(),r=Object.prototype,n=r.hasOwnProperty,s=r.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&n.call(i,"callee")&&!s.call(i,"callee")};return Nd=o,Nd}var Ed,L1;function Ve(){if(L1)return Ed;L1=1;var e=Array.isArray;return Ed=e,Ed}var Uo={exports:{}},Cd,z1;function cD(){if(z1)return Cd;z1=1;function e(){return!1}return Cd=e,Cd}Uo.exports;var q1;function mo(){return q1||(q1=1,function(e,t){var r=vr(),n=cD(),s=t&&!t.nodeType&&t,o=s&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===s,a=i?r.Buffer:void 0,c=a?a.isBuffer:void 0,u=c||n;e.exports=u}(Uo,Uo.exports)),Uo.exports}var Rd,$1;function Sc(){if($1)return Rd;$1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,s){var o=typeof n;return s=s??e,!!s&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<s}return Rd=r,Rd}var Td,F1;function cx(){if(F1)return Td;F1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return Td=t,Td}var Id,B1;function uD(){if(B1)return Id;B1=1;var e=ms(),t=cx(),r=Ar(),n="[object Arguments]",s="[object Array]",o="[object Boolean]",i="[object Date]",a="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",y="[object String]",v="[object WeakMap]",_="[object ArrayBuffer]",g="[object DataView]",x="[object Float32Array]",b="[object Float64Array]",w="[object Int8Array]",j="[object Int16Array]",k="[object Int32Array]",N="[object Uint8Array]",S="[object Uint8ClampedArray]",C="[object Uint16Array]",R="[object Uint32Array]",T={};T[x]=T[b]=T[w]=T[j]=T[k]=T[N]=T[S]=T[C]=T[R]=!0,T[n]=T[s]=T[_]=T[o]=T[g]=T[i]=T[a]=T[c]=T[u]=T[d]=T[f]=T[p]=T[h]=T[y]=T[v]=!1;function L(q){return r(q)&&t(q.length)&&!!T[e(q)]}return Id=L,Id}var Md,H1;function kc(){if(H1)return Md;H1=1;function e(t){return function(r){return t(r)}}return Md=e,Md}var Go={exports:{}};Go.exports;var W1;function ux(){return W1||(W1=1,function(e,t){var r=rE(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,i=o&&r.process,a=function(){try{var c=s&&s.require&&s.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=a}(Go,Go.exports)),Go.exports}var Pd,V1;function Xi(){if(V1)return Pd;V1=1;var e=uD(),t=kc(),r=ux(),n=r&&r.isTypedArray,s=n?t(n):e;return Pd=s,Pd}var Ad,U1;function oE(){if(U1)return Ad;U1=1;var e=aD(),t=Yi(),r=Ve(),n=mo(),s=Sc(),o=Xi(),i=Object.prototype,a=i.hasOwnProperty;function c(u,d){var f=r(u),p=!f&&t(u),h=!f&&!p&&n(u),y=!f&&!p&&!h&&o(u),v=f||p||h||y,_=v?e(u.length,String):[],g=_.length;for(var x in u)(d||a.call(u,x))&&!(v&&(x=="length"||h&&(x=="offset"||x=="parent")||y&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||s(x,g)))&&_.push(x);return _}return Ad=c,Ad}var Dd,G1;function Nc(){if(G1)return Dd;G1=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,s=typeof n=="function"&&n.prototype||e;return r===s}return Dd=t,Dd}var Od,K1;function iE(){if(K1)return Od;K1=1;function e(t,r){return function(n){return t(r(n))}}return Od=e,Od}var Ld,Y1;function dD(){if(Y1)return Ld;Y1=1;var e=iE(),t=e(Object.keys,Object);return Ld=t,Ld}var zd,X1;function dx(){if(X1)return zd;X1=1;var e=Nc(),t=dD(),r=Object.prototype,n=r.hasOwnProperty;function s(o){if(!e(o))return t(o);var i=[];for(var a in Object(o))n.call(o,a)&&a!="constructor"&&i.push(a);return i}return zd=s,zd}var qd,Q1;function rn(){if(Q1)return qd;Q1=1;var e=Gi(),t=cx();function r(n){return n!=null&&t(n.length)&&!e(n)}return qd=r,qd}var $d,Z1;function qn(){if(Z1)return $d;Z1=1;var e=oE(),t=dx(),r=rn();function n(s){return r(s)?e(s):t(s)}return $d=n,$d}var Fd,J1;function fD(){if(J1)return Fd;J1=1;var e=Ki(),t=qn();function r(n,s){return n&&e(s,t(s),n)}return Fd=r,Fd}var Bd,eb;function pD(){if(eb)return Bd;eb=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return Bd=e,Bd}var Hd,tb;function hD(){if(tb)return Hd;tb=1;var e=er(),t=Nc(),r=pD(),n=Object.prototype,s=n.hasOwnProperty;function o(i){if(!e(i))return r(i);var a=t(i),c=[];for(var u in i)u=="constructor"&&(a||!s.call(i,u))||c.push(u);return c}return Hd=o,Hd}var Wd,rb;function vs(){if(rb)return Wd;rb=1;var e=oE(),t=hD(),r=rn();function n(s){return r(s)?e(s,!0):t(s)}return Wd=n,Wd}var Vd,nb;function mD(){if(nb)return Vd;nb=1;var e=Ki(),t=vs();function r(n,s){return n&&e(s,t(s),n)}return Vd=r,Vd}var Ko={exports:{}};Ko.exports;var sb;function aE(){return sb||(sb=1,function(e,t){var r=vr(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,i=o?r.Buffer:void 0,a=i?i.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var f=u.length,p=a?a(f):new u.constructor(f);return u.copy(p),p}e.exports=c}(Ko,Ko.exports)),Ko.exports}var Ud,ob;function lE(){if(ob)return Ud;ob=1;function e(t,r){var n=-1,s=t.length;for(r||(r=Array(s));++n<s;)r[n]=t[n];return r}return Ud=e,Ud}var Gd,ib;function cE(){if(ib)return Gd;ib=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=0,i=[];++n<s;){var a=t[n];r(a,n,t)&&(i[o++]=a)}return i}return Gd=e,Gd}var Kd,ab;function uE(){if(ab)return Kd;ab=1;function e(){return[]}return Kd=e,Kd}var Yd,lb;function fx(){if(lb)return Yd;lb=1;var e=cE(),t=uE(),r=Object.prototype,n=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,o=s?function(i){return i==null?[]:(i=Object(i),e(s(i),function(a){return n.call(i,a)}))}:t;return Yd=o,Yd}var Xd,cb;function gD(){if(cb)return Xd;cb=1;var e=Ki(),t=fx();function r(n,s){return e(n,t(n),s)}return Xd=r,Xd}var Qd,ub;function px(){if(ub)return Qd;ub=1;function e(t,r){for(var n=-1,s=r.length,o=t.length;++n<s;)t[o+n]=r[n];return t}return Qd=e,Qd}var Zd,db;function Ec(){if(db)return Zd;db=1;var e=iE(),t=e(Object.getPrototypeOf,Object);return Zd=t,Zd}var Jd,fb;function dE(){if(fb)return Jd;fb=1;var e=px(),t=Ec(),r=fx(),n=uE(),s=Object.getOwnPropertySymbols,o=s?function(i){for(var a=[];i;)e(a,r(i)),i=t(i);return a}:n;return Jd=o,Jd}var ef,pb;function vD(){if(pb)return ef;pb=1;var e=Ki(),t=dE();function r(n,s){return e(n,t(n),s)}return ef=r,ef}var tf,hb;function fE(){if(hb)return tf;hb=1;var e=px(),t=Ve();function r(n,s,o){var i=s(n);return t(n)?i:e(i,o(n))}return tf=r,tf}var rf,mb;function pE(){if(mb)return rf;mb=1;var e=fE(),t=fx(),r=qn();function n(s){return e(s,r,t)}return rf=n,rf}var nf,gb;function xD(){if(gb)return nf;gb=1;var e=fE(),t=dE(),r=vs();function n(s){return e(s,r,t)}return nf=n,nf}var sf,vb;function yD(){if(vb)return sf;vb=1;var e=gs(),t=vr(),r=e(t,"DataView");return sf=r,sf}var of,xb;function bD(){if(xb)return of;xb=1;var e=gs(),t=vr(),r=e(t,"Promise");return of=r,of}var af,yb;function hE(){if(yb)return af;yb=1;var e=gs(),t=vr(),r=e(t,"Set");return af=r,af}var lf,bb;function wD(){if(bb)return lf;bb=1;var e=gs(),t=vr(),r=e(t,"WeakMap");return lf=r,lf}var cf,wb;function go(){if(wb)return cf;wb=1;var e=yD(),t=ix(),r=bD(),n=hE(),s=wD(),o=ms(),i=nE(),a="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",f="[object WeakMap]",p="[object DataView]",h=i(e),y=i(t),v=i(r),_=i(n),g=i(s),x=o;return(e&&x(new e(new ArrayBuffer(1)))!=p||t&&x(new t)!=a||r&&x(r.resolve())!=u||n&&x(new n)!=d||s&&x(new s)!=f)&&(x=function(b){var w=o(b),j=w==c?b.constructor:void 0,k=j?i(j):"";if(k)switch(k){case h:return p;case y:return a;case v:return u;case _:return d;case g:return f}return w}),cf=x,cf}var uf,_b;function _D(){if(_b)return uf;_b=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var s=n.length,o=new n.constructor(s);return s&&typeof n[0]=="string"&&t.call(n,"index")&&(o.index=n.index,o.input=n.input),o}return uf=r,uf}var df,jb;function mE(){if(jb)return df;jb=1;var e=vr(),t=e.Uint8Array;return df=t,df}var ff,Sb;function hx(){if(Sb)return ff;Sb=1;var e=mE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return ff=t,ff}var pf,kb;function jD(){if(kb)return pf;kb=1;var e=hx();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.byteLength)}return pf=t,pf}var hf,Nb;function SD(){if(Nb)return hf;Nb=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return hf=t,hf}var mf,Eb;function kD(){if(Eb)return mf;Eb=1;var e=ho(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(s){return r?Object(r.call(s)):{}}return mf=n,mf}var gf,Cb;function gE(){if(Cb)return gf;Cb=1;var e=hx();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.length)}return gf=t,gf}var vf,Rb;function ND(){if(Rb)return vf;Rb=1;var e=hx(),t=jD(),r=SD(),n=kD(),s=gE(),o="[object Boolean]",i="[object Date]",a="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",y="[object DataView]",v="[object Float32Array]",_="[object Float64Array]",g="[object Int8Array]",x="[object Int16Array]",b="[object Int32Array]",w="[object Uint8Array]",j="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]";function S(C,R,T){var L=C.constructor;switch(R){case h:return e(C);case o:case i:return new L(+C);case y:return t(C,T);case v:case _:case g:case x:case b:case w:case j:case k:case N:return s(C,T);case a:return new L;case c:case f:return new L(C);case u:return r(C);case d:return new L;case p:return n(C)}}return vf=S,vf}var xf,Tb;function vE(){if(Tb)return xf;Tb=1;var e=er(),t=Object.create,r=function(){function n(){}return function(s){if(!e(s))return{};if(t)return t(s);n.prototype=s;var o=new n;return n.prototype=void 0,o}}();return xf=r,xf}var yf,Ib;function xE(){if(Ib)return yf;Ib=1;var e=vE(),t=Ec(),r=Nc();function n(s){return typeof s.constructor=="function"&&!r(s)?e(t(s)):{}}return yf=n,yf}var bf,Mb;function ED(){if(Mb)return bf;Mb=1;var e=go(),t=Ar(),r="[object Map]";function n(s){return t(s)&&e(s)==r}return bf=n,bf}var wf,Pb;function CD(){if(Pb)return wf;Pb=1;var e=ED(),t=kc(),r=ux(),n=r&&r.isMap,s=n?t(n):e;return wf=s,wf}var _f,Ab;function RD(){if(Ab)return _f;Ab=1;var e=go(),t=Ar(),r="[object Set]";function n(s){return t(s)&&e(s)==r}return _f=n,_f}var jf,Db;function TD(){if(Db)return jf;Db=1;var e=RD(),t=kc(),r=ux(),n=r&&r.isSet,s=n?t(n):e;return jf=s,jf}var Sf,Ob;function yE(){if(Ob)return Sf;Ob=1;var e=wc(),t=lx(),r=jc(),n=fD(),s=mD(),o=aE(),i=lE(),a=gD(),c=vD(),u=pE(),d=xD(),f=go(),p=_D(),h=ND(),y=xE(),v=Ve(),_=mo(),g=CD(),x=er(),b=TD(),w=qn(),j=vs(),k=1,N=2,S=4,C="[object Arguments]",R="[object Array]",T="[object Boolean]",L="[object Date]",q="[object Error]",E="[object Function]",D="[object GeneratorFunction]",A="[object Map]",$="[object Number]",O="[object Object]",M="[object RegExp]",z="[object Set]",P="[object String]",I="[object Symbol]",F="[object WeakMap]",V="[object ArrayBuffer]",G="[object DataView]",X="[object Float32Array]",te="[object Float64Array]",se="[object Int8Array]",re="[object Int16Array]",Q="[object Int32Array]",xe="[object Uint8Array]",ne="[object Uint8ClampedArray]",ye="[object Uint16Array]",ee="[object Uint32Array]",Y={};Y[C]=Y[R]=Y[V]=Y[G]=Y[T]=Y[L]=Y[X]=Y[te]=Y[se]=Y[re]=Y[Q]=Y[A]=Y[$]=Y[O]=Y[M]=Y[z]=Y[P]=Y[I]=Y[xe]=Y[ne]=Y[ye]=Y[ee]=!0,Y[q]=Y[E]=Y[F]=!1;function pe(W,K,ae,ce,Se,be){var le,H=K&k,Ce=K&N,oe=K&S;if(ae&&(le=Se?ae(W,ce,Se,be):ae(W)),le!==void 0)return le;if(!x(W))return W;var nt=v(W);if(nt){if(le=p(W),!H)return i(W,le)}else{var He=f(W),ht=He==E||He==D;if(_(W))return o(W,H);if(He==O||He==C||ht&&!Se){if(le=Ce||ht?{}:y(W),!H)return Ce?c(W,s(le,W)):a(W,n(le,W))}else{if(!Y[He])return Se?W:{};le=h(W,He,H)}}be||(be=new e);var rr=be.get(W);if(rr)return rr;be.set(W,le),b(W)?W.forEach(function(Qe){le.add(pe(Qe,K,ae,Qe,W,be))}):g(W)&&W.forEach(function(Qe,ot){le.set(ot,pe(Qe,K,ae,ot,W,be))});var ke=oe?Ce?d:u:Ce?j:w,st=nt?void 0:ke(W);return t(st||W,function(Qe,ot){st&&(ot=Qe,Qe=W[ot]),r(le,ot,pe(Qe,K,ae,ot,W,be))}),le}return Sf=pe,Sf}var kf,Lb;function ID(){if(Lb)return kf;Lb=1;var e=yE(),t=4;function r(n){return e(n,t)}return kf=r,kf}var Nf,zb;function mx(){if(zb)return Nf;zb=1;function e(t){return function(){return t}}return Nf=e,Nf}var Ef,qb;function MD(){if(qb)return Ef;qb=1;function e(t){return function(r,n,s){for(var o=-1,i=Object(r),a=s(r),c=a.length;c--;){var u=a[t?c:++o];if(n(i[u],u,i)===!1)break}return r}}return Ef=e,Ef}var Cf,$b;function gx(){if($b)return Cf;$b=1;var e=MD(),t=e();return Cf=t,Cf}var Rf,Fb;function vx(){if(Fb)return Rf;Fb=1;var e=gx(),t=qn();function r(n,s){return n&&e(n,s,t)}return Rf=r,Rf}var Tf,Bb;function PD(){if(Bb)return Tf;Bb=1;var e=rn();function t(r,n){return function(s,o){if(s==null)return s;if(!e(s))return r(s,o);for(var i=s.length,a=n?i:-1,c=Object(s);(n?a--:++a<i)&&o(c[a],a,c)!==!1;);return s}}return Tf=t,Tf}var If,Hb;function Cc(){if(Hb)return If;Hb=1;var e=vx(),t=PD(),r=t(e);return If=r,If}var Mf,Wb;function xs(){if(Wb)return Mf;Wb=1;function e(t){return t}return Mf=e,Mf}var Pf,Vb;function bE(){if(Vb)return Pf;Vb=1;var e=xs();function t(r){return typeof r=="function"?r:e}return Pf=t,Pf}var Af,Ub;function wE(){if(Ub)return Af;Ub=1;var e=lx(),t=Cc(),r=bE(),n=Ve();function s(o,i){var a=n(o)?e:t;return a(o,r(i))}return Af=s,Af}var Df,Gb;function _E(){return Gb||(Gb=1,Df=wE()),Df}var Of,Kb;function AD(){if(Kb)return Of;Kb=1;var e=Cc();function t(r,n){var s=[];return e(r,function(o,i,a){n(o,i,a)&&s.push(o)}),s}return Of=t,Of}var Lf,Yb;function DD(){if(Yb)return Lf;Yb=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Lf=t,Lf}var zf,Xb;function OD(){if(Xb)return zf;Xb=1;function e(t){return this.__data__.has(t)}return zf=e,zf}var qf,Qb;function jE(){if(Qb)return qf;Qb=1;var e=ax(),t=DD(),r=OD();function n(s){var o=-1,i=s==null?0:s.length;for(this.__data__=new e;++o<i;)this.add(s[o])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,qf=n,qf}var $f,Zb;function LD(){if(Zb)return $f;Zb=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s;)if(r(t[n],n,t))return!0;return!1}return $f=e,$f}var Ff,Jb;function SE(){if(Jb)return Ff;Jb=1;function e(t,r){return t.has(r)}return Ff=e,Ff}var Bf,ew;function kE(){if(ew)return Bf;ew=1;var e=jE(),t=LD(),r=SE(),n=1,s=2;function o(i,a,c,u,d,f){var p=c&n,h=i.length,y=a.length;if(h!=y&&!(p&&y>h))return!1;var v=f.get(i),_=f.get(a);if(v&&_)return v==a&&_==i;var g=-1,x=!0,b=c&s?new e:void 0;for(f.set(i,a),f.set(a,i);++g<h;){var w=i[g],j=a[g];if(u)var k=p?u(j,w,g,a,i,f):u(w,j,g,i,a,f);if(k!==void 0){if(k)continue;x=!1;break}if(b){if(!t(a,function(N,S){if(!r(b,S)&&(w===N||d(w,N,c,u,f)))return b.push(S)})){x=!1;break}}else if(!(w===j||d(w,j,c,u,f))){x=!1;break}}return f.delete(i),f.delete(a),x}return Bf=o,Bf}var Hf,tw;function zD(){if(tw)return Hf;tw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s,o){n[++r]=[o,s]}),n}return Hf=e,Hf}var Wf,rw;function xx(){if(rw)return Wf;rw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s){n[++r]=s}),n}return Wf=e,Wf}var Vf,nw;function qD(){if(nw)return Vf;nw=1;var e=ho(),t=mE(),r=po(),n=kE(),s=zD(),o=xx(),i=1,a=2,c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",y="[object Set]",v="[object String]",_="[object Symbol]",g="[object ArrayBuffer]",x="[object DataView]",b=e?e.prototype:void 0,w=b?b.valueOf:void 0;function j(k,N,S,C,R,T,L){switch(S){case x:if(k.byteLength!=N.byteLength||k.byteOffset!=N.byteOffset)return!1;k=k.buffer,N=N.buffer;case g:return!(k.byteLength!=N.byteLength||!T(new t(k),new t(N)));case c:case u:case p:return r(+k,+N);case d:return k.name==N.name&&k.message==N.message;case h:case v:return k==N+"";case f:var q=s;case y:var E=C&i;if(q||(q=o),k.size!=N.size&&!E)return!1;var D=L.get(k);if(D)return D==N;C|=a,L.set(k,N);var A=n(q(k),q(N),C,R,T,L);return L.delete(k),A;case _:if(w)return w.call(k)==w.call(N)}return!1}return Vf=j,Vf}var Uf,sw;function $D(){if(sw)return Uf;sw=1;var e=pE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function s(o,i,a,c,u,d){var f=a&t,p=e(o),h=p.length,y=e(i),v=y.length;if(h!=v&&!f)return!1;for(var _=h;_--;){var g=p[_];if(!(f?g in i:n.call(i,g)))return!1}var x=d.get(o),b=d.get(i);if(x&&b)return x==i&&b==o;var w=!0;d.set(o,i),d.set(i,o);for(var j=f;++_<h;){g=p[_];var k=o[g],N=i[g];if(c)var S=f?c(N,k,g,i,o,d):c(k,N,g,o,i,d);if(!(S===void 0?k===N||u(k,N,a,c,d):S)){w=!1;break}j||(j=g=="constructor")}if(w&&!j){var C=o.constructor,R=i.constructor;C!=R&&"constructor"in o&&"constructor"in i&&!(typeof C=="function"&&C instanceof C&&typeof R=="function"&&R instanceof R)&&(w=!1)}return d.delete(o),d.delete(i),w}return Uf=s,Uf}var Gf,ow;function FD(){if(ow)return Gf;ow=1;var e=wc(),t=kE(),r=qD(),n=$D(),s=go(),o=Ve(),i=mo(),a=Xi(),c=1,u="[object Arguments]",d="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function y(v,_,g,x,b,w){var j=o(v),k=o(_),N=j?d:s(v),S=k?d:s(_);N=N==u?f:N,S=S==u?f:S;var C=N==f,R=S==f,T=N==S;if(T&&i(v)){if(!i(_))return!1;j=!0,C=!1}if(T&&!C)return w||(w=new e),j||a(v)?t(v,_,g,x,b,w):r(v,_,N,g,x,b,w);if(!(g&c)){var L=C&&h.call(v,"__wrapped__"),q=R&&h.call(_,"__wrapped__");if(L||q){var E=L?v.value():v,D=q?_.value():_;return w||(w=new e),b(E,D,g,x,w)}}return T?(w||(w=new e),n(v,_,g,x,b,w)):!1}return Gf=y,Gf}var Kf,iw;function NE(){if(iw)return Kf;iw=1;var e=FD(),t=Ar();function r(n,s,o,i,a){return n===s?!0:n==null||s==null||!t(n)&&!t(s)?n!==n&&s!==s:e(n,s,o,i,r,a)}return Kf=r,Kf}var Yf,aw;function BD(){if(aw)return Yf;aw=1;var e=wc(),t=NE(),r=1,n=2;function s(o,i,a,c){var u=a.length,d=u,f=!c;if(o==null)return!d;for(o=Object(o);u--;){var p=a[u];if(f&&p[2]?p[1]!==o[p[0]]:!(p[0]in o))return!1}for(;++u<d;){p=a[u];var h=p[0],y=o[h],v=p[1];if(f&&p[2]){if(y===void 0&&!(h in o))return!1}else{var _=new e;if(c)var g=c(y,v,h,o,i,_);if(!(g===void 0?t(v,y,r|n,c,_):g))return!1}}return!0}return Yf=s,Yf}var Xf,lw;function EE(){if(lw)return Xf;lw=1;var e=er();function t(r){return r===r&&!e(r)}return Xf=t,Xf}var Qf,cw;function HD(){if(cw)return Qf;cw=1;var e=EE(),t=qn();function r(n){for(var s=t(n),o=s.length;o--;){var i=s[o],a=n[i];s[o]=[i,a,e(a)]}return s}return Qf=r,Qf}var Zf,uw;function CE(){if(uw)return Zf;uw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Zf=e,Zf}var Jf,dw;function WD(){if(dw)return Jf;dw=1;var e=BD(),t=HD(),r=CE();function n(s){var o=t(s);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(i){return i===s||e(i,s,o)}}return Jf=n,Jf}var ep,fw;function vo(){if(fw)return ep;fw=1;var e=ms(),t=Ar(),r="[object Symbol]";function n(s){return typeof s=="symbol"||t(s)&&e(s)==r}return ep=n,ep}var tp,pw;function yx(){if(pw)return tp;pw=1;var e=Ve(),t=vo(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(o,i){if(e(o))return!1;var a=typeof o;return a=="number"||a=="symbol"||a=="boolean"||o==null||t(o)?!0:n.test(o)||!r.test(o)||i!=null&&o in Object(i)}return tp=s,tp}var rp,hw;function VD(){if(hw)return rp;hw=1;var e=ax(),t="Expected a function";function r(n,s){if(typeof n!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var o=function(){var i=arguments,a=s?s.apply(this,i):i[0],c=o.cache;if(c.has(a))return c.get(a);var u=n.apply(this,i);return o.cache=c.set(a,u)||c,u};return o.cache=new(r.Cache||e),o}return r.Cache=e,rp=r,rp}var np,mw;function UD(){if(mw)return np;mw=1;var e=VD(),t=500;function r(n){var s=e(n,function(i){return o.size===t&&o.clear(),i}),o=s.cache;return s}return np=r,np}var sp,gw;function GD(){if(gw)return sp;gw=1;var e=UD(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(s){var o=[];return s.charCodeAt(0)===46&&o.push(""),s.replace(t,function(i,a,c,u){o.push(c?u.replace(r,"$1"):a||i)}),o});return sp=n,sp}var op,vw;function Rc(){if(vw)return op;vw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=Array(s);++n<s;)o[n]=r(t[n],n,t);return o}return op=e,op}var ip,xw;function KD(){if(xw)return ip;xw=1;var e=ho(),t=Rc(),r=Ve(),n=vo(),s=e?e.prototype:void 0,o=s?s.toString:void 0;function i(a){if(typeof a=="string")return a;if(r(a))return t(a,i)+"";if(n(a))return o?o.call(a):"";var c=a+"";return c=="0"&&1/a==-1/0?"-0":c}return ip=i,ip}var ap,yw;function RE(){if(yw)return ap;yw=1;var e=KD();function t(r){return r==null?"":e(r)}return ap=t,ap}var lp,bw;function Tc(){if(bw)return lp;bw=1;var e=Ve(),t=yx(),r=GD(),n=RE();function s(o,i){return e(o)?o:t(o,i)?[o]:r(n(o))}return lp=s,lp}var cp,ww;function Qi(){if(ww)return cp;ww=1;var e=vo();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return cp=t,cp}var up,_w;function Ic(){if(_w)return up;_w=1;var e=Tc(),t=Qi();function r(n,s){s=e(s,n);for(var o=0,i=s.length;n!=null&&o<i;)n=n[t(s[o++])];return o&&o==i?n:void 0}return up=r,up}var dp,jw;function YD(){if(jw)return dp;jw=1;var e=Ic();function t(r,n,s){var o=r==null?void 0:e(r,n);return o===void 0?s:o}return dp=t,dp}var fp,Sw;function XD(){if(Sw)return fp;Sw=1;function e(t,r){return t!=null&&r in Object(t)}return fp=e,fp}var pp,kw;function TE(){if(kw)return pp;kw=1;var e=Tc(),t=Yi(),r=Ve(),n=Sc(),s=cx(),o=Qi();function i(a,c,u){c=e(c,a);for(var d=-1,f=c.length,p=!1;++d<f;){var h=o(c[d]);if(!(p=a!=null&&u(a,h)))break;a=a[h]}return p||++d!=f?p:(f=a==null?0:a.length,!!f&&s(f)&&n(h,f)&&(r(a)||t(a)))}return pp=i,pp}var hp,Nw;function IE(){if(Nw)return hp;Nw=1;var e=XD(),t=TE();function r(n,s){return n!=null&&t(n,s,e)}return hp=r,hp}var mp,Ew;function QD(){if(Ew)return mp;Ew=1;var e=NE(),t=YD(),r=IE(),n=yx(),s=EE(),o=CE(),i=Qi(),a=1,c=2;function u(d,f){return n(d)&&s(f)?o(i(d),f):function(p){var h=t(p,d);return h===void 0&&h===f?r(p,d):e(f,h,a|c)}}return mp=u,mp}var gp,Cw;function ME(){if(Cw)return gp;Cw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return gp=e,gp}var vp,Rw;function ZD(){if(Rw)return vp;Rw=1;var e=Ic();function t(r){return function(n){return e(n,r)}}return vp=t,vp}var xp,Tw;function JD(){if(Tw)return xp;Tw=1;var e=ME(),t=ZD(),r=yx(),n=Qi();function s(o){return r(o)?e(n(o)):t(o)}return xp=s,xp}var yp,Iw;function nn(){if(Iw)return yp;Iw=1;var e=WD(),t=QD(),r=xs(),n=Ve(),s=JD();function o(i){return typeof i=="function"?i:i==null?r:typeof i=="object"?n(i)?t(i[0],i[1]):e(i):s(i)}return yp=o,yp}var bp,Mw;function PE(){if(Mw)return bp;Mw=1;var e=cE(),t=AD(),r=nn(),n=Ve();function s(o,i){var a=n(o)?e:t;return a(o,r(i,3))}return bp=s,bp}var wp,Pw;function eO(){if(Pw)return wp;Pw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,s){return n!=null&&t.call(n,s)}return wp=r,wp}var _p,Aw;function AE(){if(Aw)return _p;Aw=1;var e=eO(),t=TE();function r(n,s){return n!=null&&t(n,s,e)}return _p=r,_p}var jp,Dw;function tO(){if(Dw)return jp;Dw=1;var e=dx(),t=go(),r=Yi(),n=Ve(),s=rn(),o=mo(),i=Nc(),a=Xi(),c="[object Map]",u="[object Set]",d=Object.prototype,f=d.hasOwnProperty;function p(h){if(h==null)return!0;if(s(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||a(h)||r(h)))return!h.length;var y=t(h);if(y==c||y==u)return!h.size;if(i(h))return!e(h).length;for(var v in h)if(f.call(h,v))return!1;return!0}return jp=p,jp}var Sp,Ow;function DE(){if(Ow)return Sp;Ow=1;function e(t){return t===void 0}return Sp=e,Sp}var kp,Lw;function OE(){if(Lw)return kp;Lw=1;var e=Cc(),t=rn();function r(n,s){var o=-1,i=t(n)?Array(n.length):[];return e(n,function(a,c,u){i[++o]=s(a,c,u)}),i}return kp=r,kp}var Np,zw;function LE(){if(zw)return Np;zw=1;var e=Rc(),t=nn(),r=OE(),n=Ve();function s(o,i){var a=n(o)?e:r;return a(o,t(i,3))}return Np=s,Np}var Ep,qw;function rO(){if(qw)return Ep;qw=1;function e(t,r,n,s){var o=-1,i=t==null?0:t.length;for(s&&i&&(n=t[++o]);++o<i;)n=r(n,t[o],o,t);return n}return Ep=e,Ep}var Cp,$w;function nO(){if($w)return Cp;$w=1;function e(t,r,n,s,o){return o(t,function(i,a,c){n=s?(s=!1,i):r(n,i,a,c)}),n}return Cp=e,Cp}var Rp,Fw;function zE(){if(Fw)return Rp;Fw=1;var e=rO(),t=Cc(),r=nn(),n=nO(),s=Ve();function o(i,a,c){var u=s(i)?e:n,d=arguments.length<3;return u(i,r(a,4),c,d,t)}return Rp=o,Rp}var Tp,Bw;function sO(){if(Bw)return Tp;Bw=1;var e=ms(),t=Ve(),r=Ar(),n="[object String]";function s(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==n}return Tp=s,Tp}var Ip,Hw;function oO(){if(Hw)return Ip;Hw=1;var e=ME(),t=e("length");return Ip=t,Ip}var Mp,Ww;function iO(){if(Ww)return Mp;Ww=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",i="\\u200d",a=RegExp("["+i+e+s+o+"]");function c(u){return a.test(u)}return Mp=c,Mp}var Pp,Vw;function aO(){if(Vw)return Pp;Vw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",i="["+e+"]",a="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+a+"|"+c+")",d="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",y=u+"?",v="["+o+"]?",_="(?:"+h+"(?:"+[d,f,p].join("|")+")"+v+y+")*",g=v+y+_,x="(?:"+[d+a+"?",a,f,p,i].join("|")+")",b=RegExp(c+"(?="+c+")|"+x+g,"g");function w(j){for(var k=b.lastIndex=0;b.test(j);)++k;return k}return Pp=w,Pp}var Ap,Uw;function lO(){if(Uw)return Ap;Uw=1;var e=oO(),t=iO(),r=aO();function n(s){return t(s)?r(s):e(s)}return Ap=n,Ap}var Dp,Gw;function cO(){if(Gw)return Dp;Gw=1;var e=dx(),t=go(),r=rn(),n=sO(),s=lO(),o="[object Map]",i="[object Set]";function a(c){if(c==null)return 0;if(r(c))return n(c)?s(c):c.length;var u=t(c);return u==o||u==i?c.size:e(c).length}return Dp=a,Dp}var Op,Kw;function uO(){if(Kw)return Op;Kw=1;var e=lx(),t=vE(),r=vx(),n=nn(),s=Ec(),o=Ve(),i=mo(),a=Gi(),c=er(),u=Xi();function d(f,p,h){var y=o(f),v=y||i(f)||u(f);if(p=n(p,4),h==null){var _=f&&f.constructor;v?h=y?new _:[]:c(f)?h=a(_)?t(s(f)):{}:h={}}return(v?e:r)(f,function(g,x,b){return p(h,g,x,b)}),h}return Op=d,Op}var Lp,Yw;function dO(){if(Yw)return Lp;Yw=1;var e=ho(),t=Yi(),r=Ve(),n=e?e.isConcatSpreadable:void 0;function s(o){return r(o)||t(o)||!!(n&&o&&o[n])}return Lp=s,Lp}var zp,Xw;function bx(){if(Xw)return zp;Xw=1;var e=px(),t=dO();function r(n,s,o,i,a){var c=-1,u=n.length;for(o||(o=t),a||(a=[]);++c<u;){var d=n[c];s>0&&o(d)?s>1?r(d,s-1,o,i,a):e(a,d):i||(a[a.length]=d)}return a}return zp=r,zp}var qp,Qw;function fO(){if(Qw)return qp;Qw=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return qp=e,qp}var $p,Zw;function qE(){if(Zw)return $p;Zw=1;var e=fO(),t=Math.max;function r(n,s,o){return s=t(s===void 0?n.length-1:s,0),function(){for(var i=arguments,a=-1,c=t(i.length-s,0),u=Array(c);++a<c;)u[a]=i[s+a];a=-1;for(var d=Array(s+1);++a<s;)d[a]=i[a];return d[s]=o(u),e(n,this,d)}}return $p=r,$p}var Fp,Jw;function pO(){if(Jw)return Fp;Jw=1;var e=mx(),t=sE(),r=xs(),n=t?function(s,o){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return Fp=n,Fp}var Bp,e_;function hO(){if(e_)return Bp;e_=1;var e=800,t=16,r=Date.now;function n(s){var o=0,i=0;return function(){var a=r(),c=t-(a-i);if(i=a,c>0){if(++o>=e)return arguments[0]}else o=0;return s.apply(void 0,arguments)}}return Bp=n,Bp}var Hp,t_;function $E(){if(t_)return Hp;t_=1;var e=pO(),t=hO(),r=t(e);return Hp=r,Hp}var Wp,r_;function Mc(){if(r_)return Wp;r_=1;var e=xs(),t=qE(),r=$E();function n(s,o){return r(t(s,o,e),s+"")}return Wp=n,Wp}var Vp,n_;function FE(){if(n_)return Vp;n_=1;function e(t,r,n,s){for(var o=t.length,i=n+(s?1:-1);s?i--:++i<o;)if(r(t[i],i,t))return i;return-1}return Vp=e,Vp}var Up,s_;function mO(){if(s_)return Up;s_=1;function e(t){return t!==t}return Up=e,Up}var Gp,o_;function gO(){if(o_)return Gp;o_=1;function e(t,r,n){for(var s=n-1,o=t.length;++s<o;)if(t[s]===r)return s;return-1}return Gp=e,Gp}var Kp,i_;function vO(){if(i_)return Kp;i_=1;var e=FE(),t=mO(),r=gO();function n(s,o,i){return o===o?r(s,o,i):e(s,t,i)}return Kp=n,Kp}var Yp,a_;function xO(){if(a_)return Yp;a_=1;var e=vO();function t(r,n){var s=r==null?0:r.length;return!!s&&e(r,n,0)>-1}return Yp=t,Yp}var Xp,l_;function yO(){if(l_)return Xp;l_=1;function e(t,r,n){for(var s=-1,o=t==null?0:t.length;++s<o;)if(n(r,t[s]))return!0;return!1}return Xp=e,Xp}var Qp,c_;function bO(){if(c_)return Qp;c_=1;function e(){}return Qp=e,Qp}var Zp,u_;function wO(){if(u_)return Zp;u_=1;var e=hE(),t=bO(),r=xx(),n=1/0,s=e&&1/r(new e([,-0]))[1]==n?function(o){return new e(o)}:t;return Zp=s,Zp}var Jp,d_;function _O(){if(d_)return Jp;d_=1;var e=jE(),t=xO(),r=yO(),n=SE(),s=wO(),o=xx(),i=200;function a(c,u,d){var f=-1,p=t,h=c.length,y=!0,v=[],_=v;if(d)y=!1,p=r;else if(h>=i){var g=u?null:s(c);if(g)return o(g);y=!1,p=n,_=new e}else _=u?[]:v;e:for(;++f<h;){var x=c[f],b=u?u(x):x;if(x=d||x!==0?x:0,y&&b===b){for(var w=_.length;w--;)if(_[w]===b)continue e;u&&_.push(b),v.push(x)}else p(_,b,d)||(_!==v&&_.push(b),v.push(x))}return v}return Jp=a,Jp}var eh,f_;function BE(){if(f_)return eh;f_=1;var e=rn(),t=Ar();function r(n){return t(n)&&e(n)}return eh=r,eh}var th,p_;function jO(){if(p_)return th;p_=1;var e=bx(),t=Mc(),r=_O(),n=BE(),s=t(function(o){return r(e(o,1,n,!0))});return th=s,th}var rh,h_;function SO(){if(h_)return rh;h_=1;var e=Rc();function t(r,n){return e(n,function(s){return r[s]})}return rh=t,rh}var nh,m_;function HE(){if(m_)return nh;m_=1;var e=SO(),t=qn();function r(n){return n==null?[]:e(n,t(n))}return nh=r,nh}var sh,g_;function tr(){if(g_)return sh;g_=1;var e;if(typeof ox=="function")try{e={clone:ID(),constant:mx(),each:_E(),filter:PE(),has:AE(),isArray:Ve(),isEmpty:tO(),isFunction:Gi(),isUndefined:DE(),keys:qn(),map:LE(),reduce:zE(),size:cO(),transform:uO(),union:jO(),values:HE()}}catch{}return e||(e=window._),sh=e,sh}var oh,v_;function wx(){if(v_)return oh;v_=1;var e=tr();oh=s;var t="\0",r="\0",n="";function s(d){this._isDirected=e.has(d,"directed")?d.directed:!0,this._isMultigraph=e.has(d,"multigraph")?d.multigraph:!1,this._isCompound=e.has(d,"compound")?d.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(d){return this._label=d,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultNodeLabelFn=d,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._in[f])})},s.prototype.sinks=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._out[f])})},s.prototype.setNodes=function(d,f){var p=arguments,h=this;return e.each(d,function(y){p.length>1?h.setNode(y,f):h.setNode(y)}),this},s.prototype.setNode=function(d,f){return e.has(this._nodes,d)?(arguments.length>1&&(this._nodes[d]=f),this):(this._nodes[d]=arguments.length>1?f:this._defaultNodeLabelFn(d),this._isCompound&&(this._parent[d]=r,this._children[d]={},this._children[r][d]=!0),this._in[d]={},this._preds[d]={},this._out[d]={},this._sucs[d]={},++this._nodeCount,this)},s.prototype.node=function(d){return this._nodes[d]},s.prototype.hasNode=function(d){return e.has(this._nodes,d)},s.prototype.removeNode=function(d){var f=this;if(e.has(this._nodes,d)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[d],this._isCompound&&(this._removeFromParentsChildList(d),delete this._parent[d],e.each(this.children(d),function(h){f.setParent(h)}),delete this._children[d]),e.each(e.keys(this._in[d]),p),delete this._in[d],delete this._preds[d],e.each(e.keys(this._out[d]),p),delete this._out[d],delete this._sucs[d],--this._nodeCount}return this},s.prototype.setParent=function(d,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===d)throw new Error("Setting "+f+" as parent of "+d+" would create a cycle");this.setNode(f)}return this.setNode(d),this._removeFromParentsChildList(d),this._parent[d]=f,this._children[f][d]=!0,this},s.prototype._removeFromParentsChildList=function(d){delete this._children[this._parent[d]][d]},s.prototype.parent=function(d){if(this._isCompound){var f=this._parent[d];if(f!==r)return f}},s.prototype.children=function(d){if(e.isUndefined(d)&&(d=r),this._isCompound){var f=this._children[d];if(f)return e.keys(f)}else{if(d===r)return this.nodes();if(this.hasNode(d))return[]}},s.prototype.predecessors=function(d){var f=this._preds[d];if(f)return e.keys(f)},s.prototype.successors=function(d){var f=this._sucs[d];if(f)return e.keys(f)},s.prototype.neighbors=function(d){var f=this.predecessors(d);if(f)return e.union(f,this.successors(d))},s.prototype.isLeaf=function(d){var f;return this.isDirected()?f=this.successors(d):f=this.neighbors(d),f.length===0},s.prototype.filterNodes=function(d){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(v,_){d(_)&&f.setNode(_,v)}),e.each(this._edgeObjs,function(v){f.hasNode(v.v)&&f.hasNode(v.w)&&f.setEdge(v,p.edge(v))});var h={};function y(v){var _=p.parent(v);return _===void 0||f.hasNode(_)?(h[v]=_,_):_ in h?h[_]:y(_)}return this._isCompound&&e.each(f.nodes(),function(v){f.setParent(v,y(v))}),f},s.prototype.setDefaultEdgeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultEdgeLabelFn=d,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(d,f){var p=this,h=arguments;return e.reduce(d,function(y,v){return h.length>1?p.setEdge(y,v,f):p.setEdge(y,v),v}),this},s.prototype.setEdge=function(){var d,f,p,h,y=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(d=v.v,f=v.w,p=v.name,arguments.length===2&&(h=arguments[1],y=!0)):(d=v,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],y=!0)),d=""+d,f=""+f,e.isUndefined(p)||(p=""+p);var _=a(this._isDirected,d,f,p);if(e.has(this._edgeLabels,_))return y&&(this._edgeLabels[_]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(f),this._edgeLabels[_]=y?h:this._defaultEdgeLabelFn(d,f,p);var g=c(this._isDirected,d,f,p);return d=g.v,f=g.w,Object.freeze(g),this._edgeObjs[_]=g,o(this._preds[f],d),o(this._sucs[d],f),this._in[f][_]=g,this._out[d][_]=g,this._edgeCount++,this},s.prototype.edge=function(d,f,p){var h=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,p);return this._edgeLabels[h]},s.prototype.hasEdge=function(d,f,p){var h=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,p);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(d,f,p){var h=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,p),y=this._edgeObjs[h];return y&&(d=y.v,f=y.w,delete this._edgeLabels[h],delete this._edgeObjs[h],i(this._preds[f],d),i(this._sucs[d],f),delete this._in[f][h],delete this._out[d][h],this._edgeCount--),this},s.prototype.inEdges=function(d,f){var p=this._in[d];if(p){var h=e.values(p);return f?e.filter(h,function(y){return y.v===f}):h}},s.prototype.outEdges=function(d,f){var p=this._out[d];if(p){var h=e.values(p);return f?e.filter(h,function(y){return y.w===f}):h}},s.prototype.nodeEdges=function(d,f){var p=this.inEdges(d,f);if(p)return p.concat(this.outEdges(d,f))};function o(d,f){d[f]?d[f]++:d[f]=1}function i(d,f){--d[f]||delete d[f]}function a(d,f,p,h){var y=""+f,v=""+p;if(!d&&y>v){var _=y;y=v,v=_}return y+n+v+n+(e.isUndefined(h)?t:h)}function c(d,f,p,h){var y=""+f,v=""+p;if(!d&&y>v){var _=y;y=v,v=_}var g={v:y,w:v};return h&&(g.name=h),g}function u(d,f){return a(d,f.v,f.w,f.name)}return oh}var ih,x_;function kO(){return x_||(x_=1,ih="2.1.8"),ih}var ah,y_;function NO(){return y_||(y_=1,ah={Graph:wx(),version:kO()}),ah}var lh,b_;function EO(){if(b_)return lh;b_=1;var e=tr(),t=wx();lh={write:r,read:o};function r(i){var a={options:{directed:i.isDirected(),multigraph:i.isMultigraph(),compound:i.isCompound()},nodes:n(i),edges:s(i)};return e.isUndefined(i.graph())||(a.value=e.clone(i.graph())),a}function n(i){return e.map(i.nodes(),function(a){var c=i.node(a),u=i.parent(a),d={v:a};return e.isUndefined(c)||(d.value=c),e.isUndefined(u)||(d.parent=u),d})}function s(i){return e.map(i.edges(),function(a){var c=i.edge(a),u={v:a.v,w:a.w};return e.isUndefined(a.name)||(u.name=a.name),e.isUndefined(c)||(u.value=c),u})}function o(i){var a=new t(i.options).setGraph(i.value);return e.each(i.nodes,function(c){a.setNode(c.v,c.value),c.parent&&a.setParent(c.v,c.parent)}),e.each(i.edges,function(c){a.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),a}return lh}var ch,w_;function CO(){if(w_)return ch;w_=1;var e=tr();ch=t;function t(r){var n={},s=[],o;function i(a){e.has(n,a)||(n[a]=!0,o.push(a),e.each(r.successors(a),i),e.each(r.predecessors(a),i))}return e.each(r.nodes(),function(a){o=[],i(a),o.length&&s.push(o)}),s}return ch}var uh,__;function WE(){if(__)return uh;__=1;var e=tr();uh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var s=this._keyIndices;if(r=String(r),!e.has(s,r)){var o=this._arr,i=o.length;return s[r]=i,o.push({key:r,priority:n}),this._decrease(i),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var s=this._keyIndices[r];if(n>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[s].priority+" New: "+n);this._arr[s].priority=n,this._decrease(s)},t.prototype._heapify=function(r){var n=this._arr,s=2*r,o=s+1,i=r;s<n.length&&(i=n[s].priority<n[i].priority?s:i,o<n.length&&(i=n[o].priority<n[i].priority?o:i),i!==r&&(this._swap(r,i),this._heapify(i)))},t.prototype._decrease=function(r){for(var n=this._arr,s=n[r].priority,o;r!==0&&(o=r>>1,!(n[o].priority<s));)this._swap(r,o),r=o},t.prototype._swap=function(r,n){var s=this._arr,o=this._keyIndices,i=s[r],a=s[n];s[r]=a,s[n]=i,o[a.key]=r,o[i.key]=n},uh}var dh,j_;function VE(){if(j_)return dh;j_=1;var e=tr(),t=WE();dh=n;var r=e.constant(1);function n(o,i,a,c){return s(o,String(i),a||r,c||function(u){return o.outEdges(u)})}function s(o,i,a,c){var u={},d=new t,f,p,h=function(y){var v=y.v!==f?y.v:y.w,_=u[v],g=a(y),x=p.distance+g;if(g<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+y+" Weight: "+g);x<_.distance&&(_.distance=x,_.predecessor=f,d.decrease(v,x))};for(o.nodes().forEach(function(y){var v=y===i?0:Number.POSITIVE_INFINITY;u[y]={distance:v},d.add(y,v)});d.size()>0&&(f=d.removeMin(),p=u[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return u}return dh}var fh,S_;function RO(){if(S_)return fh;S_=1;var e=VE(),t=tr();fh=r;function r(n,s,o){return t.transform(n.nodes(),function(i,a){i[a]=e(n,a,s,o)},{})}return fh}var ph,k_;function UE(){if(k_)return ph;k_=1;var e=tr();ph=t;function t(r){var n=0,s=[],o={},i=[];function a(c){var u=o[c]={onStack:!0,lowlink:n,index:n++};if(s.push(c),r.successors(c).forEach(function(p){e.has(o,p)?o[p].onStack&&(u.lowlink=Math.min(u.lowlink,o[p].index)):(a(p),u.lowlink=Math.min(u.lowlink,o[p].lowlink))}),u.lowlink===u.index){var d=[],f;do f=s.pop(),o[f].onStack=!1,d.push(f);while(c!==f);i.push(d)}}return r.nodes().forEach(function(c){e.has(o,c)||a(c)}),i}return ph}var hh,N_;function TO(){if(N_)return hh;N_=1;var e=tr(),t=UE();hh=r;function r(n){return e.filter(t(n),function(s){return s.length>1||s.length===1&&n.hasEdge(s[0],s[0])})}return hh}var mh,E_;function IO(){if(E_)return mh;E_=1;var e=tr();mh=r;var t=e.constant(1);function r(s,o,i){return n(s,o||t,i||function(a){return s.outEdges(a)})}function n(s,o,i){var a={},c=s.nodes();return c.forEach(function(u){a[u]={},a[u][u]={distance:0},c.forEach(function(d){u!==d&&(a[u][d]={distance:Number.POSITIVE_INFINITY})}),i(u).forEach(function(d){var f=d.v===u?d.w:d.v,p=o(d);a[u][f]={distance:p,predecessor:u}})}),c.forEach(function(u){var d=a[u];c.forEach(function(f){var p=a[f];c.forEach(function(h){var y=p[u],v=d[h],_=p[h],g=y.distance+v.distance;g<_.distance&&(_.distance=g,_.predecessor=v.predecessor)})})}),a}return mh}var gh,C_;function GE(){if(C_)return gh;C_=1;var e=tr();gh=t,t.CycleException=r;function t(n){var s={},o={},i=[];function a(c){if(e.has(o,c))throw new r;e.has(s,c)||(o[c]=!0,s[c]=!0,e.each(n.predecessors(c),a),delete o[c],i.push(c))}if(e.each(n.sinks(),a),e.size(s)!==n.nodeCount())throw new r;return i}function r(){}return r.prototype=new Error,gh}var vh,R_;function MO(){if(R_)return vh;R_=1;var e=GE();vh=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return vh}var xh,T_;function KE(){if(T_)return xh;T_=1;var e=tr();xh=t;function t(n,s,o){e.isArray(s)||(s=[s]);var i=(n.isDirected()?n.successors:n.neighbors).bind(n),a=[],c={};return e.each(s,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);r(n,u,o==="post",c,i,a)}),a}function r(n,s,o,i,a,c){e.has(i,s)||(i[s]=!0,o||c.push(s),e.each(a(s),function(u){r(n,u,o,i,a,c)}),o&&c.push(s))}return xh}var yh,I_;function PO(){if(I_)return yh;I_=1;var e=KE();yh=t;function t(r,n){return e(r,n,"post")}return yh}var bh,M_;function AO(){if(M_)return bh;M_=1;var e=KE();bh=t;function t(r,n){return e(r,n,"pre")}return bh}var wh,P_;function DO(){if(P_)return wh;P_=1;var e=tr(),t=wx(),r=WE();wh=n;function n(s,o){var i=new t,a={},c=new r,u;function d(p){var h=p.v===u?p.w:p.v,y=c.priority(h);if(y!==void 0){var v=o(p);v<y&&(a[h]=u,c.decrease(h,v))}}if(s.nodeCount()===0)return i;e.each(s.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),i.setNode(p)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(u=c.removeMin(),e.has(a,u))i.setEdge(u,a[u]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(u).forEach(d)}return i}return wh}var _h,A_;function OO(){return A_||(A_=1,_h={components:CO(),dijkstra:VE(),dijkstraAll:RO(),findCycles:TO(),floydWarshall:IO(),isAcyclic:MO(),postorder:PO(),preorder:AO(),prim:DO(),tarjan:UE(),topsort:GE()}),_h}var jh,D_;function LO(){if(D_)return jh;D_=1;var e=NO();return jh={Graph:e.Graph,json:EO(),alg:OO(),version:e.version},jh}var Al;if(typeof ox=="function")try{Al=LO()}catch{}Al||(Al=window.graphlib);var xr=Al,Sh,O_;function zO(){if(O_)return Sh;O_=1;var e=yE(),t=1,r=4;function n(s){return e(s,t|r)}return Sh=n,Sh}var kh,L_;function Pc(){if(L_)return kh;L_=1;var e=po(),t=rn(),r=Sc(),n=er();function s(o,i,a){if(!n(a))return!1;var c=typeof i;return(c=="number"?t(a)&&r(i,a.length):c=="string"&&i in a)?e(a[i],o):!1}return kh=s,kh}var Nh,z_;function qO(){if(z_)return Nh;z_=1;var e=Mc(),t=po(),r=Pc(),n=vs(),s=Object.prototype,o=s.hasOwnProperty,i=e(function(a,c){a=Object(a);var u=-1,d=c.length,f=d>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(d=1);++u<d;)for(var p=c[u],h=n(p),y=-1,v=h.length;++y<v;){var _=h[y],g=a[_];(g===void 0||t(g,s[_])&&!o.call(a,_))&&(a[_]=p[_])}return a});return Nh=i,Nh}var Eh,q_;function $O(){if(q_)return Eh;q_=1;var e=nn(),t=rn(),r=qn();function n(s){return function(o,i,a){var c=Object(o);if(!t(o)){var u=e(i,3);o=r(o),i=function(f){return u(c[f],f,c)}}var d=s(o,i,a);return d>-1?c[u?o[d]:d]:void 0}}return Eh=n,Eh}var Ch,$_;function FO(){if($_)return Ch;$_=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return Ch=t,Ch}var Rh,F_;function BO(){if(F_)return Rh;F_=1;var e=FO(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return Rh=r,Rh}var Th,B_;function HO(){if(B_)return Th;B_=1;var e=BO(),t=er(),r=vo(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,a=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var f=o.test(u);return f||i.test(u)?a(u.slice(2),f?2:8):s.test(u)?n:+u}return Th=c,Th}var Ih,H_;function YE(){if(H_)return Ih;H_=1;var e=HO(),t=1/0,r=17976931348623157e292;function n(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var o=s<0?-1:1;return o*r}return s===s?s:0}return Ih=n,Ih}var Mh,W_;function WO(){if(W_)return Mh;W_=1;var e=YE();function t(r){var n=e(r),s=n%1;return n===n?s?n-s:n:0}return Mh=t,Mh}var Ph,V_;function VO(){if(V_)return Ph;V_=1;var e=FE(),t=nn(),r=WO(),n=Math.max;function s(o,i,a){var c=o==null?0:o.length;if(!c)return-1;var u=a==null?0:r(a);return u<0&&(u=n(c+u,0)),e(o,t(i,3),u)}return Ph=s,Ph}var Ah,U_;function UO(){if(U_)return Ah;U_=1;var e=$O(),t=VO(),r=e(t);return Ah=r,Ah}var Dh,G_;function XE(){if(G_)return Dh;G_=1;var e=bx();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return Dh=t,Dh}var Oh,K_;function GO(){if(K_)return Oh;K_=1;var e=gx(),t=bE(),r=vs();function n(s,o){return s==null?s:e(s,t(o),r)}return Oh=n,Oh}var Lh,Y_;function KO(){if(Y_)return Lh;Y_=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Lh=e,Lh}var zh,X_;function YO(){if(X_)return zh;X_=1;var e=_c(),t=vx(),r=nn();function n(s,o){var i={};return o=r(o,3),t(s,function(a,c,u){e(i,c,o(a,c,u))}),i}return zh=n,zh}var qh,Q_;function _x(){if(Q_)return qh;Q_=1;var e=vo();function t(r,n,s){for(var o=-1,i=r.length;++o<i;){var a=r[o],c=n(a);if(c!=null&&(u===void 0?c===c&&!e(c):s(c,u)))var u=c,d=a}return d}return qh=t,qh}var $h,Z_;function XO(){if(Z_)return $h;Z_=1;function e(t,r){return t>r}return $h=e,$h}var Fh,J_;function QO(){if(J_)return Fh;J_=1;var e=_x(),t=XO(),r=xs();function n(s){return s&&s.length?e(s,r,t):void 0}return Fh=n,Fh}var Bh,e2;function QE(){if(e2)return Bh;e2=1;var e=_c(),t=po();function r(n,s,o){(o!==void 0&&!t(n[s],o)||o===void 0&&!(s in n))&&e(n,s,o)}return Bh=r,Bh}var Hh,t2;function ZO(){if(t2)return Hh;t2=1;var e=ms(),t=Ec(),r=Ar(),n="[object Object]",s=Function.prototype,o=Object.prototype,i=s.toString,a=o.hasOwnProperty,c=i.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var f=t(d);if(f===null)return!0;var p=a.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&i.call(p)==c}return Hh=u,Hh}var Wh,r2;function ZE(){if(r2)return Wh;r2=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Wh=e,Wh}var Vh,n2;function JO(){if(n2)return Vh;n2=1;var e=Ki(),t=vs();function r(n){return e(n,t(n))}return Vh=r,Vh}var Uh,s2;function e8(){if(s2)return Uh;s2=1;var e=QE(),t=aE(),r=gE(),n=lE(),s=xE(),o=Yi(),i=Ve(),a=BE(),c=mo(),u=Gi(),d=er(),f=ZO(),p=Xi(),h=ZE(),y=JO();function v(_,g,x,b,w,j,k){var N=h(_,x),S=h(g,x),C=k.get(S);if(C){e(_,x,C);return}var R=j?j(N,S,x+"",_,g,k):void 0,T=R===void 0;if(T){var L=i(S),q=!L&&c(S),E=!L&&!q&&p(S);R=S,L||q||E?i(N)?R=N:a(N)?R=n(N):q?(T=!1,R=t(S,!0)):E?(T=!1,R=r(S,!0)):R=[]:f(S)||o(S)?(R=N,o(N)?R=y(N):(!d(N)||u(N))&&(R=s(S))):T=!1}T&&(k.set(S,R),w(R,S,b,j,k),k.delete(S)),e(_,x,R)}return Uh=v,Uh}var Gh,o2;function t8(){if(o2)return Gh;o2=1;var e=wc(),t=QE(),r=gx(),n=e8(),s=er(),o=vs(),i=ZE();function a(c,u,d,f,p){c!==u&&r(u,function(h,y){if(p||(p=new e),s(h))n(c,u,y,d,a,f,p);else{var v=f?f(i(c,y),h,y+"",c,u,p):void 0;v===void 0&&(v=h),t(c,y,v)}},o)}return Gh=a,Gh}var Kh,i2;function r8(){if(i2)return Kh;i2=1;var e=Mc(),t=Pc();function r(n){return e(function(s,o){var i=-1,a=o.length,c=a>1?o[a-1]:void 0,u=a>2?o[2]:void 0;for(c=n.length>3&&typeof c=="function"?(a--,c):void 0,u&&t(o[0],o[1],u)&&(c=a<3?void 0:c,a=1),s=Object(s);++i<a;){var d=o[i];d&&n(s,d,i,c)}return s})}return Kh=r,Kh}var Yh,a2;function n8(){if(a2)return Yh;a2=1;var e=t8(),t=r8(),r=t(function(n,s,o){e(n,s,o)});return Yh=r,Yh}var Xh,l2;function JE(){if(l2)return Xh;l2=1;function e(t,r){return t<r}return Xh=e,Xh}var Qh,c2;function s8(){if(c2)return Qh;c2=1;var e=_x(),t=JE(),r=xs();function n(s){return s&&s.length?e(s,r,t):void 0}return Qh=n,Qh}var Zh,u2;function o8(){if(u2)return Zh;u2=1;var e=_x(),t=nn(),r=JE();function n(s,o){return s&&s.length?e(s,t(o,2),r):void 0}return Zh=n,Zh}var Jh,d2;function i8(){if(d2)return Jh;d2=1;var e=vr(),t=function(){return e.Date.now()};return Jh=t,Jh}var em,f2;function a8(){if(f2)return em;f2=1;var e=jc(),t=Tc(),r=Sc(),n=er(),s=Qi();function o(i,a,c,u){if(!n(i))return i;a=t(a,i);for(var d=-1,f=a.length,p=f-1,h=i;h!=null&&++d<f;){var y=s(a[d]),v=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return i;if(d!=p){var _=h[y];v=u?u(_,y,h):void 0,v===void 0&&(v=n(_)?_:r(a[d+1])?[]:{})}e(h,y,v),h=h[y]}return i}return em=o,em}var tm,p2;function l8(){if(p2)return tm;p2=1;var e=Ic(),t=a8(),r=Tc();function n(s,o,i){for(var a=-1,c=o.length,u={};++a<c;){var d=o[a],f=e(s,d);i(f,d)&&t(u,r(d,s),f)}return u}return tm=n,tm}var rm,h2;function c8(){if(h2)return rm;h2=1;var e=l8(),t=IE();function r(n,s){return e(n,s,function(o,i){return t(n,i)})}return rm=r,rm}var nm,m2;function u8(){if(m2)return nm;m2=1;var e=XE(),t=qE(),r=$E();function n(s){return r(t(s,void 0,e),s+"")}return nm=n,nm}var sm,g2;function d8(){if(g2)return sm;g2=1;var e=c8(),t=u8(),r=t(function(n,s){return n==null?{}:e(n,s)});return sm=r,sm}var om,v2;function f8(){if(v2)return om;v2=1;var e=Math.ceil,t=Math.max;function r(n,s,o,i){for(var a=-1,c=t(e((s-n)/(o||1)),0),u=Array(c);c--;)u[i?c:++a]=n,n+=o;return u}return om=r,om}var im,x2;function p8(){if(x2)return im;x2=1;var e=f8(),t=Pc(),r=YE();function n(s){return function(o,i,a){return a&&typeof a!="number"&&t(o,i,a)&&(i=a=void 0),o=r(o),i===void 0?(i=o,o=0):i=r(i),a=a===void 0?o<i?1:-1:r(a),e(o,i,a,s)}}return im=n,im}var am,y2;function h8(){if(y2)return am;y2=1;var e=p8(),t=e();return am=t,am}var lm,b2;function m8(){if(b2)return lm;b2=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return lm=e,lm}var cm,w2;function g8(){if(w2)return cm;w2=1;var e=vo();function t(r,n){if(r!==n){var s=r!==void 0,o=r===null,i=r===r,a=e(r),c=n!==void 0,u=n===null,d=n===n,f=e(n);if(!u&&!f&&!a&&r>n||a&&c&&d&&!u&&!f||o&&c&&d||!s&&d||!i)return 1;if(!o&&!a&&!f&&r<n||f&&s&&i&&!o&&!a||u&&s&&i||!c&&i||!d)return-1}return 0}return cm=t,cm}var um,_2;function v8(){if(_2)return um;_2=1;var e=g8();function t(r,n,s){for(var o=-1,i=r.criteria,a=n.criteria,c=i.length,u=s.length;++o<c;){var d=e(i[o],a[o]);if(d){if(o>=u)return d;var f=s[o];return d*(f=="desc"?-1:1)}}return r.index-n.index}return um=t,um}var dm,j2;function x8(){if(j2)return dm;j2=1;var e=Rc(),t=Ic(),r=nn(),n=OE(),s=m8(),o=kc(),i=v8(),a=xs(),c=Ve();function u(d,f,p){f.length?f=e(f,function(v){return c(v)?function(_){return t(_,v.length===1?v[0]:v)}:v}):f=[a];var h=-1;f=e(f,o(r));var y=n(d,function(v,_,g){var x=e(f,function(b){return b(v)});return{criteria:x,index:++h,value:v}});return s(y,function(v,_){return i(v,_,p)})}return dm=u,dm}var fm,S2;function y8(){if(S2)return fm;S2=1;var e=bx(),t=x8(),r=Mc(),n=Pc(),s=r(function(o,i){if(o==null)return[];var a=i.length;return a>1&&n(o,i[0],i[1])?i=[]:a>2&&n(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return fm=s,fm}var pm,k2;function b8(){if(k2)return pm;k2=1;var e=RE(),t=0;function r(n){var s=++t;return e(n)+s}return pm=r,pm}var hm,N2;function w8(){if(N2)return hm;N2=1;function e(t,r,n){for(var s=-1,o=t.length,i=r.length,a={};++s<o;){var c=s<i?r[s]:void 0;n(a,t[s],c)}return a}return hm=e,hm}var mm,E2;function _8(){if(E2)return mm;E2=1;var e=jc(),t=w8();function r(n,s){return t(n||[],s||[],e)}return mm=r,mm}var Dl;if(typeof ox=="function")try{Dl={cloneDeep:zO(),constant:mx(),defaults:qO(),each:_E(),filter:PE(),find:UO(),flatten:XE(),forEach:wE(),forIn:GO(),has:AE(),isUndefined:DE(),last:KO(),map:LE(),mapValues:YO(),max:QO(),merge:n8(),min:s8(),minBy:o8(),now:i8(),pick:d8(),range:h8(),reduce:zE(),sortBy:y8(),uniqueId:b8(),values:HE(),zipObject:_8()}}catch{}Dl||(Dl=window._);var De=Dl,j8=Ac;function Ac(){var e={};e._next=e._prev=e,this._sentinel=e}Ac.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return eC(t),t};Ac.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&eC(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};Ac.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,S8)),r=r._prev;return"["+e.join(", ")+"]"};function eC(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function S8(e,t){if(e!=="_next"&&e!=="_prev")return t}var Wr=De,k8=xr.Graph,N8=j8,E8=R8,C8=Wr.constant(1);function R8(e,t){if(e.nodeCount()<=1)return[];var r=I8(e,t||C8),n=T8(r.graph,r.buckets,r.zeroIdx);return Wr.flatten(Wr.map(n,function(s){return e.outEdges(s.v,s.w)}),!0)}function T8(e,t,r){for(var n=[],s=t[t.length-1],o=t[0],i;e.nodeCount();){for(;i=o.dequeue();)gm(e,t,r,i);for(;i=s.dequeue();)gm(e,t,r,i);if(e.nodeCount()){for(var a=t.length-2;a>0;--a)if(i=t[a].dequeue(),i){n=n.concat(gm(e,t,r,i,!0));break}}}return n}function gm(e,t,r,n,s){var o=s?[]:void 0;return Wr.forEach(e.inEdges(n.v),function(i){var a=e.edge(i),c=e.node(i.v);s&&o.push({v:i.v,w:i.w}),c.out-=a,qg(t,r,c)}),Wr.forEach(e.outEdges(n.v),function(i){var a=e.edge(i),c=i.w,u=e.node(c);u.in-=a,qg(t,r,u)}),e.removeNode(n.v),o}function I8(e,t){var r=new k8,n=0,s=0;Wr.forEach(e.nodes(),function(a){r.setNode(a,{v:a,in:0,out:0})}),Wr.forEach(e.edges(),function(a){var c=r.edge(a.v,a.w)||0,u=t(a),d=c+u;r.setEdge(a.v,a.w,d),s=Math.max(s,r.node(a.v).out+=u),n=Math.max(n,r.node(a.w).in+=u)});var o=Wr.range(s+n+3).map(function(){return new N8}),i=n+1;return Wr.forEach(r.nodes(),function(a){qg(o,i,r.node(a))}),{graph:r,buckets:o,zeroIdx:i}}function qg(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var ts=De,M8=E8,P8={run:A8,undo:O8};function A8(e){var t=e.graph().acyclicer==="greedy"?M8(e,r(e)):D8(e);ts.forEach(t,function(n){var s=e.edge(n);e.removeEdge(n),s.forwardName=n.name,s.reversed=!0,e.setEdge(n.w,n.v,s,ts.uniqueId("rev"))});function r(n){return function(s){return n.edge(s).weight}}}function D8(e){var t=[],r={},n={};function s(o){ts.has(n,o)||(n[o]=!0,r[o]=!0,ts.forEach(e.outEdges(o),function(i){ts.has(r,i.w)?t.push(i):s(i.w)}),delete r[o])}return ts.forEach(e.nodes(),s),t}function O8(e){ts.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var we=De,tC=xr.Graph,Ct={addDummyNode:rC,simplify:L8,asNonCompoundGraph:z8,successorWeights:q8,predecessorWeights:$8,intersectRect:F8,buildLayerMatrix:B8,normalizeRanks:H8,removeEmptyRanks:W8,addBorderNode:V8,maxRank:nC,partition:U8,time:G8,notime:K8};function rC(e,t,r,n){var s;do s=we.uniqueId(n);while(e.hasNode(s));return r.dummy=t,e.setNode(s,r),s}function L8(e){var t=new tC().setGraph(e.graph());return we.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),we.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},s=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+s.weight,minlen:Math.max(n.minlen,s.minlen)})}),t}function z8(e){var t=new tC({multigraph:e.isMultigraph()}).setGraph(e.graph());return we.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),we.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function q8(e){var t=we.map(e.nodes(),function(r){var n={};return we.forEach(e.outEdges(r),function(s){n[s.w]=(n[s.w]||0)+e.edge(s).weight}),n});return we.zipObject(e.nodes(),t)}function $8(e){var t=we.map(e.nodes(),function(r){var n={};return we.forEach(e.inEdges(r),function(s){n[s.v]=(n[s.v]||0)+e.edge(s).weight}),n});return we.zipObject(e.nodes(),t)}function F8(e,t){var r=e.x,n=e.y,s=t.x-r,o=t.y-n,i=e.width/2,a=e.height/2;if(!s&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var c,u;return Math.abs(o)*i>Math.abs(s)*a?(o<0&&(a=-a),c=a*s/o,u=a):(s<0&&(i=-i),c=i,u=i*o/s),{x:r+c,y:n+u}}function B8(e){var t=we.map(we.range(nC(e)+1),function(){return[]});return we.forEach(e.nodes(),function(r){var n=e.node(r),s=n.rank;we.isUndefined(s)||(t[s][n.order]=r)}),t}function H8(e){var t=we.min(we.map(e.nodes(),function(r){return e.node(r).rank}));we.forEach(e.nodes(),function(r){var n=e.node(r);we.has(n,"rank")&&(n.rank-=t)})}function W8(e){var t=we.min(we.map(e.nodes(),function(o){return e.node(o).rank})),r=[];we.forEach(e.nodes(),function(o){var i=e.node(o).rank-t;r[i]||(r[i]=[]),r[i].push(o)});var n=0,s=e.graph().nodeRankFactor;we.forEach(r,function(o,i){we.isUndefined(o)&&i%s!==0?--n:n&&we.forEach(o,function(a){e.node(a).rank+=n})})}function V8(e,t,r,n){var s={width:0,height:0};return arguments.length>=4&&(s.rank=r,s.order=n),rC(e,"border",s,t)}function nC(e){return we.max(we.map(e.nodes(),function(t){var r=e.node(t).rank;if(!we.isUndefined(r))return r}))}function U8(e,t){var r={lhs:[],rhs:[]};return we.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function G8(e,t){var r=we.now();try{return t()}finally{console.log(e+" time: "+(we.now()-r)+"ms")}}function K8(e,t){return t()}var sC=De,Y8=Ct,X8={run:Q8,undo:J8};function Q8(e){e.graph().dummyChains=[],sC.forEach(e.edges(),function(t){Z8(e,t)})}function Z8(e,t){var r=t.v,n=e.node(r).rank,s=t.w,o=e.node(s).rank,i=t.name,a=e.edge(t),c=a.labelRank;if(o!==n+1){e.removeEdge(t);var u,d,f;for(f=0,++n;n<o;++f,++n)a.points=[],d={width:0,height:0,edgeLabel:a,edgeObj:t,rank:n},u=Y8.addDummyNode(e,"edge",d,"_d"),n===c&&(d.width=a.width,d.height=a.height,d.dummy="edge-label",d.labelpos=a.labelpos),e.setEdge(r,u,{weight:a.weight},i),f===0&&e.graph().dummyChains.push(u),r=u;e.setEdge(r,s,{weight:a.weight},i)}}function J8(e){sC.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,s;for(e.setEdge(r.edgeObj,n);r.dummy;)s=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=s,r=e.node(t)})}var Ra=De,Dc={longestPath:eL,slack:tL};function eL(e){var t={};function r(n){var s=e.node(n);if(Ra.has(t,n))return s.rank;t[n]=!0;var o=Ra.min(Ra.map(e.outEdges(n),function(i){return r(i.w)-e.edge(i).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),s.rank=o}Ra.forEach(e.sources(),r)}function tL(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var Ol=De,rL=xr.Graph,Ll=Dc.slack,oC=nL;function nL(e){var t=new rL({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var s,o;sL(t,e)<n;)s=oL(t,e),o=t.hasNode(s.v)?Ll(e,s):-Ll(e,s),iL(t,e,o);return t}function sL(e,t){function r(n){Ol.forEach(t.nodeEdges(n),function(s){var o=s.v,i=n===o?s.w:o;!e.hasNode(i)&&!Ll(t,s)&&(e.setNode(i,{}),e.setEdge(n,i,{}),r(i))})}return Ol.forEach(e.nodes(),r),e.nodeCount()}function oL(e,t){return Ol.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return Ll(t,r)})}function iL(e,t,r){Ol.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var en=De,aL=oC,lL=Dc.slack,cL=Dc.longestPath,uL=xr.alg.preorder,dL=xr.alg.postorder,fL=Ct.simplify,pL=ys;ys.initLowLimValues=Sx;ys.initCutValues=jx;ys.calcCutValue=iC;ys.leaveEdge=lC;ys.enterEdge=cC;ys.exchangeEdges=uC;function ys(e){e=fL(e),cL(e);var t=aL(e);Sx(t),jx(t,e);for(var r,n;r=lC(t);)n=cC(t,e,r),uC(t,e,r,n)}function jx(e,t){var r=dL(e,e.nodes());r=r.slice(0,r.length-1),en.forEach(r,function(n){hL(e,t,n)})}function hL(e,t,r){var n=e.node(r),s=n.parent;e.edge(r,s).cutvalue=iC(e,t,r)}function iC(e,t,r){var n=e.node(r),s=n.parent,o=!0,i=t.edge(r,s),a=0;return i||(o=!1,i=t.edge(s,r)),a=i.weight,en.forEach(t.nodeEdges(r),function(c){var u=c.v===r,d=u?c.w:c.v;if(d!==s){var f=u===o,p=t.edge(c).weight;if(a+=f?p:-p,gL(e,r,d)){var h=e.edge(r,d).cutvalue;a+=f?-h:h}}}),a}function Sx(e,t){arguments.length<2&&(t=e.nodes()[0]),aC(e,{},1,t)}function aC(e,t,r,n,s){var o=r,i=e.node(n);return t[n]=!0,en.forEach(e.neighbors(n),function(a){en.has(t,a)||(r=aC(e,t,r,a,n))}),i.low=o,i.lim=r++,s?i.parent=s:delete i.parent,r}function lC(e){return en.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function cC(e,t,r){var n=r.v,s=r.w;t.hasEdge(n,s)||(n=r.w,s=r.v);var o=e.node(n),i=e.node(s),a=o,c=!1;o.lim>i.lim&&(a=i,c=!0);var u=en.filter(t.edges(),function(d){return c===C2(e,e.node(d.v),a)&&c!==C2(e,e.node(d.w),a)});return en.minBy(u,function(d){return lL(t,d)})}function uC(e,t,r,n){var s=r.v,o=r.w;e.removeEdge(s,o),e.setEdge(n.v,n.w,{}),Sx(e),jx(e,t),mL(e,t)}function mL(e,t){var r=en.find(e.nodes(),function(s){return!t.node(s).parent}),n=uL(e,r);n=n.slice(1),en.forEach(n,function(s){var o=e.node(s).parent,i=t.edge(s,o),a=!1;i||(i=t.edge(o,s),a=!0),t.node(s).rank=t.node(o).rank+(a?i.minlen:-i.minlen)})}function gL(e,t,r){return e.hasEdge(t,r)}function C2(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var vL=Dc,dC=vL.longestPath,xL=oC,yL=pL,bL=wL;function wL(e){switch(e.graph().ranker){case"network-simplex":R2(e);break;case"tight-tree":jL(e);break;case"longest-path":_L(e);break;default:R2(e)}}var _L=dC;function jL(e){dC(e),xL(e)}function R2(e){yL(e)}var $g=De,SL=kL;function kL(e){var t=EL(e);$g.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),s=n.edgeObj,o=NL(e,t,s.v,s.w),i=o.path,a=o.lca,c=0,u=i[c],d=!0;r!==s.w;){if(n=e.node(r),d){for(;(u=i[c])!==a&&e.node(u).maxRank<n.rank;)c++;u===a&&(d=!1)}if(!d){for(;c<i.length-1&&e.node(u=i[c+1]).minRank<=n.rank;)c++;u=i[c]}e.setParent(r,u),r=e.successors(r)[0]}})}function NL(e,t,r,n){var s=[],o=[],i=Math.min(t[r].low,t[n].low),a=Math.max(t[r].lim,t[n].lim),c,u;c=r;do c=e.parent(c),s.push(c);while(c&&(t[c].low>i||a>t[c].lim));for(u=c,c=n;(c=e.parent(c))!==u;)o.push(c);return{path:s.concat(o.reverse()),lca:u}}function EL(e){var t={},r=0;function n(s){var o=r;$g.forEach(e.children(s),n),t[s]={low:o,lim:r++}}return $g.forEach(e.children(),n),t}var Vr=De,Fg=Ct,CL={run:RL,cleanup:ML};function RL(e){var t=Fg.addDummyNode(e,"root",{},"_root"),r=TL(e),n=Vr.max(Vr.values(r))-1,s=2*n+1;e.graph().nestingRoot=t,Vr.forEach(e.edges(),function(i){e.edge(i).minlen*=s});var o=IL(e)+1;Vr.forEach(e.children(),function(i){fC(e,t,s,o,n,r,i)}),e.graph().nodeRankFactor=s}function fC(e,t,r,n,s,o,i){var a=e.children(i);if(!a.length){i!==t&&e.setEdge(t,i,{weight:0,minlen:r});return}var c=Fg.addBorderNode(e,"_bt"),u=Fg.addBorderNode(e,"_bb"),d=e.node(i);e.setParent(c,i),d.borderTop=c,e.setParent(u,i),d.borderBottom=u,Vr.forEach(a,function(f){fC(e,t,r,n,s,o,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,y=p.borderBottom?p.borderBottom:f,v=p.borderTop?n:2*n,_=h!==y?1:s-o[i]+1;e.setEdge(c,h,{weight:v,minlen:_,nestingEdge:!0}),e.setEdge(y,u,{weight:v,minlen:_,nestingEdge:!0})}),e.parent(i)||e.setEdge(t,c,{weight:0,minlen:s+o[i]})}function TL(e){var t={};function r(n,s){var o=e.children(n);o&&o.length&&Vr.forEach(o,function(i){r(i,s+1)}),t[n]=s}return Vr.forEach(e.children(),function(n){r(n,1)}),t}function IL(e){return Vr.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function ML(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,Vr.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var vm=De,PL=Ct,AL=DL;function DL(e){function t(r){var n=e.children(r),s=e.node(r);if(n.length&&vm.forEach(n,t),vm.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var o=s.minRank,i=s.maxRank+1;o<i;++o)T2(e,"borderLeft","_bl",r,s,o),T2(e,"borderRight","_br",r,s,o)}}vm.forEach(e.children(),t)}function T2(e,t,r,n,s,o){var i={width:0,height:0,rank:o,borderType:t},a=s[t][o-1],c=PL.addDummyNode(e,"border",i,r);s[t][o]=c,e.setParent(c,n),a&&e.setEdge(a,c,{weight:1})}var Er=De,OL={adjust:LL,undo:zL};function LL(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&pC(e)}function zL(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&qL(e),(t==="lr"||t==="rl")&&($L(e),pC(e))}function pC(e){Er.forEach(e.nodes(),function(t){I2(e.node(t))}),Er.forEach(e.edges(),function(t){I2(e.edge(t))})}function I2(e){var t=e.width;e.width=e.height,e.height=t}function qL(e){Er.forEach(e.nodes(),function(t){xm(e.node(t))}),Er.forEach(e.edges(),function(t){var r=e.edge(t);Er.forEach(r.points,xm),Er.has(r,"y")&&xm(r)})}function xm(e){e.y=-e.y}function $L(e){Er.forEach(e.nodes(),function(t){ym(e.node(t))}),Er.forEach(e.edges(),function(t){var r=e.edge(t);Er.forEach(r.points,ym),Er.has(r,"x")&&ym(r)})}function ym(e){var t=e.x;e.x=e.y,e.y=t}var Or=De,FL=BL;function BL(e){var t={},r=Or.filter(e.nodes(),function(a){return!e.children(a).length}),n=Or.max(Or.map(r,function(a){return e.node(a).rank})),s=Or.map(Or.range(n+1),function(){return[]});function o(a){if(!Or.has(t,a)){t[a]=!0;var c=e.node(a);s[c.rank].push(a),Or.forEach(e.successors(a),o)}}var i=Or.sortBy(r,function(a){return e.node(a).rank});return Or.forEach(i,o),s}var cn=De,HL=WL;function WL(e,t){for(var r=0,n=1;n<t.length;++n)r+=VL(e,t[n-1],t[n]);return r}function VL(e,t,r){for(var n=cn.zipObject(r,cn.map(r,function(u,d){return d})),s=cn.flatten(cn.map(t,function(u){return cn.sortBy(cn.map(e.outEdges(u),function(d){return{pos:n[d.w],weight:e.edge(d).weight}}),"pos")}),!0),o=1;o<r.length;)o<<=1;var i=2*o-1;o-=1;var a=cn.map(new Array(i),function(){return 0}),c=0;return cn.forEach(s.forEach(function(u){var d=u.pos+o;a[d]+=u.weight;for(var f=0;d>0;)d%2&&(f+=a[d+1]),d=d-1>>1,a[d]+=u.weight;c+=u.weight*f})),c}var M2=De,UL=GL;function GL(e,t){return M2.map(t,function(r){var n=e.inEdges(r);if(n.length){var s=M2.reduce(n,function(o,i){var a=e.edge(i),c=e.node(i.v);return{sum:o.sum+a.weight*c.order,weight:o.weight+a.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}var Pt=De,KL=YL;function YL(e,t){var r={};Pt.forEach(e,function(s,o){var i=r[s.v]={indegree:0,in:[],out:[],vs:[s.v],i:o};Pt.isUndefined(s.barycenter)||(i.barycenter=s.barycenter,i.weight=s.weight)}),Pt.forEach(t.edges(),function(s){var o=r[s.v],i=r[s.w];!Pt.isUndefined(o)&&!Pt.isUndefined(i)&&(i.indegree++,o.out.push(r[s.w]))});var n=Pt.filter(r,function(s){return!s.indegree});return XL(n)}function XL(e){var t=[];function r(o){return function(i){i.merged||(Pt.isUndefined(i.barycenter)||Pt.isUndefined(o.barycenter)||i.barycenter>=o.barycenter)&&QL(o,i)}}function n(o){return function(i){i.in.push(o),--i.indegree===0&&e.push(i)}}for(;e.length;){var s=e.pop();t.push(s),Pt.forEach(s.in.reverse(),r(s)),Pt.forEach(s.out,n(s))}return Pt.map(Pt.filter(t,function(o){return!o.merged}),function(o){return Pt.pick(o,["vs","i","barycenter","weight"])})}function QL(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var Yo=De,ZL=Ct,JL=ez;function ez(e,t){var r=ZL.partition(e,function(d){return Yo.has(d,"barycenter")}),n=r.lhs,s=Yo.sortBy(r.rhs,function(d){return-d.i}),o=[],i=0,a=0,c=0;n.sort(tz(!!t)),c=P2(o,s,c),Yo.forEach(n,function(d){c+=d.vs.length,o.push(d.vs),i+=d.barycenter*d.weight,a+=d.weight,c=P2(o,s,c)});var u={vs:Yo.flatten(o,!0)};return a&&(u.barycenter=i/a,u.weight=a),u}function P2(e,t,r){for(var n;t.length&&(n=Yo.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function tz(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var yn=De,rz=UL,nz=KL,sz=JL,oz=hC;function hC(e,t,r,n){var s=e.children(t),o=e.node(t),i=o?o.borderLeft:void 0,a=o?o.borderRight:void 0,c={};i&&(s=yn.filter(s,function(y){return y!==i&&y!==a}));var u=rz(e,s);yn.forEach(u,function(y){if(e.children(y.v).length){var v=hC(e,y.v,r,n);c[y.v]=v,yn.has(v,"barycenter")&&az(y,v)}});var d=nz(u,r);iz(d,c);var f=sz(d,n);if(i&&(f.vs=yn.flatten([i,f.vs,a],!0),e.predecessors(i).length)){var p=e.node(e.predecessors(i)[0]),h=e.node(e.predecessors(a)[0]);yn.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function iz(e,t){yn.forEach(e,function(r){r.vs=yn.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function az(e,t){yn.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var Xo=De,lz=xr.Graph,cz=uz;function uz(e,t,r){var n=dz(e),s=new lz({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(o){return e.node(o)});return Xo.forEach(e.nodes(),function(o){var i=e.node(o),a=e.parent(o);(i.rank===t||i.minRank<=t&&t<=i.maxRank)&&(s.setNode(o),s.setParent(o,a||n),Xo.forEach(e[r](o),function(c){var u=c.v===o?c.w:c.v,d=s.edge(u,o),f=Xo.isUndefined(d)?0:d.weight;s.setEdge(u,o,{weight:e.edge(c).weight+f})}),Xo.has(i,"minRank")&&s.setNode(o,{borderLeft:i.borderLeft[t],borderRight:i.borderRight[t]}))}),s}function dz(e){for(var t;e.hasNode(t=Xo.uniqueId("_root")););return t}var fz=De,pz=hz;function hz(e,t,r){var n={},s;fz.forEach(r,function(o){for(var i=e.parent(o),a,c;i;){if(a=e.parent(i),a?(c=n[a],n[a]=i):(c=s,s=i),c&&c!==i){t.setEdge(c,i);return}i=a}})}var Mn=De,mz=FL,gz=HL,vz=oz,xz=cz,yz=pz,bz=xr.Graph,A2=Ct,wz=_z;function _z(e){var t=A2.maxRank(e),r=D2(e,Mn.range(1,t+1),"inEdges"),n=D2(e,Mn.range(t-1,-1,-1),"outEdges"),s=mz(e);O2(e,s);for(var o=Number.POSITIVE_INFINITY,i,a=0,c=0;c<4;++a,++c){jz(a%2?r:n,a%4>=2),s=A2.buildLayerMatrix(e);var u=gz(e,s);u<o&&(c=0,i=Mn.cloneDeep(s),o=u)}O2(e,i)}function D2(e,t,r){return Mn.map(t,function(n){return xz(e,n,r)})}function jz(e,t){var r=new bz;Mn.forEach(e,function(n){var s=n.graph().root,o=vz(n,s,r,t);Mn.forEach(o.vs,function(i,a){n.node(i).order=a}),yz(n,r,o.vs)})}function O2(e,t){Mn.forEach(t,function(r){Mn.forEach(r,function(n,s){e.node(n).order=s})})}var ie=De,Sz=xr.Graph,kz=Ct,Nz={positionX:Lz};function Ez(e,t){var r={};function n(s,o){var i=0,a=0,c=s.length,u=ie.last(o);return ie.forEach(o,function(d,f){var p=Rz(e,d),h=p?e.node(p).order:c;(p||d===u)&&(ie.forEach(o.slice(a,f+1),function(y){ie.forEach(e.predecessors(y),function(v){var _=e.node(v),g=_.order;(g<i||h<g)&&!(_.dummy&&e.node(y).dummy)&&mC(r,v,y)})}),a=f+1,i=h)}),o}return ie.reduce(t,n),r}function Cz(e,t){var r={};function n(o,i,a,c,u){var d;ie.forEach(ie.range(i,a),function(f){d=o[f],e.node(d).dummy&&ie.forEach(e.predecessors(d),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>u)&&mC(r,p,d)})})}function s(o,i){var a=-1,c,u=0;return ie.forEach(i,function(d,f){if(e.node(d).dummy==="border"){var p=e.predecessors(d);p.length&&(c=e.node(p[0]).order,n(i,u,f,a,c),u=f,a=c)}n(i,u,i.length,c,o.length)}),i}return ie.reduce(t,s),r}function Rz(e,t){if(e.node(t).dummy)return ie.find(e.predecessors(t),function(r){return e.node(r).dummy})}function mC(e,t,r){if(t>r){var n=t;t=r,r=n}var s=e[t];s||(e[t]=s={}),s[r]=!0}function Tz(e,t,r){if(t>r){var n=t;t=r,r=n}return ie.has(e[t],r)}function Iz(e,t,r,n){var s={},o={},i={};return ie.forEach(t,function(a){ie.forEach(a,function(c,u){s[c]=c,o[c]=c,i[c]=u})}),ie.forEach(t,function(a){var c=-1;ie.forEach(a,function(u){var d=n(u);if(d.length){d=ie.sortBy(d,function(v){return i[v]});for(var f=(d.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var y=d[p];o[u]===u&&c<i[y]&&!Tz(r,u,y)&&(o[y]=u,o[u]=s[u]=s[y],c=i[y])}}})}),{root:s,align:o}}function Mz(e,t,r,n,s){var o={},i=Pz(e,t,r,s),a=s?"borderLeft":"borderRight";function c(f,p){for(var h=i.nodes(),y=h.pop(),v={};y;)v[y]?f(y):(v[y]=!0,h.push(y),h=h.concat(p(y))),y=h.pop()}function u(f){o[f]=i.inEdges(f).reduce(function(p,h){return Math.max(p,o[h.v]+i.edge(h))},0)}function d(f){var p=i.outEdges(f).reduce(function(y,v){return Math.min(y,o[v.w]-i.edge(v))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(o[f]=Math.max(o[f],p))}return c(u,i.predecessors.bind(i)),c(d,i.successors.bind(i)),ie.forEach(n,function(f){o[f]=o[r[f]]}),o}function Pz(e,t,r,n){var s=new Sz,o=e.graph(),i=zz(o.nodesep,o.edgesep,n);return ie.forEach(t,function(a){var c;ie.forEach(a,function(u){var d=r[u];if(s.setNode(d),c){var f=r[c],p=s.edge(f,d);s.setEdge(f,d,Math.max(i(e,u,c),p||0))}c=u})}),s}function Az(e,t){return ie.minBy(ie.values(t),function(r){var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return ie.forIn(r,function(o,i){var a=qz(e,i)/2;n=Math.max(o+a,n),s=Math.min(o-a,s)}),n-s})}function Dz(e,t){var r=ie.values(t),n=ie.min(r),s=ie.max(r);ie.forEach(["u","d"],function(o){ie.forEach(["l","r"],function(i){var a=o+i,c=e[a],u;if(c!==t){var d=ie.values(c);u=i==="l"?n-ie.min(d):s-ie.max(d),u&&(e[a]=ie.mapValues(c,function(f){return f+u}))}})})}function Oz(e,t){return ie.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var s=ie.sortBy(ie.map(e,n));return(s[1]+s[2])/2})}function Lz(e){var t=kz.buildLayerMatrix(e),r=ie.merge(Ez(e,t),Cz(e,t)),n={},s;ie.forEach(["u","d"],function(i){s=i==="u"?t:ie.values(t).reverse(),ie.forEach(["l","r"],function(a){a==="r"&&(s=ie.map(s,function(f){return ie.values(f).reverse()}));var c=(i==="u"?e.predecessors:e.successors).bind(e),u=Iz(e,s,r,c),d=Mz(e,s,u.root,u.align,a==="r");a==="r"&&(d=ie.mapValues(d,function(f){return-f})),n[i+a]=d})});var o=Az(e,n);return Dz(n,o),Oz(n,e.graph().align)}function zz(e,t,r){return function(n,s,o){var i=n.node(s),a=n.node(o),c=0,u;if(c+=i.width/2,ie.has(i,"labelpos"))switch(i.labelpos.toLowerCase()){case"l":u=-i.width/2;break;case"r":u=i.width/2;break}if(u&&(c+=r?u:-u),u=0,c+=(i.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,ie.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":u=a.width/2;break;case"r":u=-a.width/2;break}return u&&(c+=r?u:-u),u=0,c}}function qz(e,t){return e.node(t).width}var Qo=De,gC=Ct,$z=Nz.positionX,Fz=Bz;function Bz(e){e=gC.asNonCompoundGraph(e),Hz(e),Qo.forEach($z(e),function(t,r){e.node(r).x=t})}function Hz(e){var t=gC.buildLayerMatrix(e),r=e.graph().ranksep,n=0;Qo.forEach(t,function(s){var o=Qo.max(Qo.map(s,function(i){return e.node(i).height}));Qo.forEach(s,function(i){e.node(i).y=n+o/2}),n+=o+r})}var ue=De,L2=P8,z2=X8,Wz=bL,Vz=Ct.normalizeRanks,Uz=SL,Gz=Ct.removeEmptyRanks,q2=CL,Kz=AL,$2=OL,Yz=wz,Xz=Fz,Dn=Ct,Qz=xr.Graph,Zz=Jz;function Jz(e,t){var r=t&&t.debugTiming?Dn.time:Dn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return uq(e)});r("  runLayout",function(){eq(n,r)}),r("  updateInputGraph",function(){tq(e,n)})})}function eq(e,t){t("    makeSpaceForEdgeLabels",function(){dq(e)}),t("    removeSelfEdges",function(){bq(e)}),t("    acyclic",function(){L2.run(e)}),t("    nestingGraph.run",function(){q2.run(e)}),t("    rank",function(){Wz(Dn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){fq(e)}),t("    removeEmptyRanks",function(){Gz(e)}),t("    nestingGraph.cleanup",function(){q2.cleanup(e)}),t("    normalizeRanks",function(){Vz(e)}),t("    assignRankMinMax",function(){pq(e)}),t("    removeEdgeLabelProxies",function(){hq(e)}),t("    normalize.run",function(){z2.run(e)}),t("    parentDummyChains",function(){Uz(e)}),t("    addBorderSegments",function(){Kz(e)}),t("    order",function(){Yz(e)}),t("    insertSelfEdges",function(){wq(e)}),t("    adjustCoordinateSystem",function(){$2.adjust(e)}),t("    position",function(){Xz(e)}),t("    positionSelfEdges",function(){_q(e)}),t("    removeBorderNodes",function(){yq(e)}),t("    normalize.undo",function(){z2.undo(e)}),t("    fixupEdgeLabelCoords",function(){vq(e)}),t("    undoCoordinateSystem",function(){$2.undo(e)}),t("    translateGraph",function(){mq(e)}),t("    assignNodeIntersects",function(){gq(e)}),t("    reversePoints",function(){xq(e)}),t("    acyclic.undo",function(){L2.undo(e)})}function tq(e,t){ue.forEach(e.nodes(),function(r){var n=e.node(r),s=t.node(r);n&&(n.x=s.x,n.y=s.y,t.children(r).length&&(n.width=s.width,n.height=s.height))}),ue.forEach(e.edges(),function(r){var n=e.edge(r),s=t.edge(r);n.points=s.points,ue.has(s,"x")&&(n.x=s.x,n.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var rq=["nodesep","edgesep","ranksep","marginx","marginy"],nq={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},sq=["acyclicer","ranker","rankdir","align"],oq=["width","height"],iq={width:0,height:0},aq=["minlen","weight","width","height","labeloffset"],lq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},cq=["labelpos"];function uq(e){var t=new Qz({multigraph:!0,compound:!0}),r=wm(e.graph());return t.setGraph(ue.merge({},nq,bm(r,rq),ue.pick(r,sq))),ue.forEach(e.nodes(),function(n){var s=wm(e.node(n));t.setNode(n,ue.defaults(bm(s,oq),iq)),t.setParent(n,e.parent(n))}),ue.forEach(e.edges(),function(n){var s=wm(e.edge(n));t.setEdge(n,ue.merge({},lq,bm(s,aq),ue.pick(s,cq)))}),t}function dq(e){var t=e.graph();t.ranksep/=2,ue.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function fq(e){ue.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),s=e.node(t.w),o={rank:(s.rank-n.rank)/2+n.rank,e:t};Dn.addDummyNode(e,"edge-proxy",o,"_ep")}})}function pq(e){var t=0;ue.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=ue.max(t,n.maxRank))}),e.graph().maxRank=t}function hq(e){ue.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function mq(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,s=0,o=e.graph(),i=o.marginx||0,a=o.marginy||0;function c(u){var d=u.x,f=u.y,p=u.width,h=u.height;t=Math.min(t,d-p/2),r=Math.max(r,d+p/2),n=Math.min(n,f-h/2),s=Math.max(s,f+h/2)}ue.forEach(e.nodes(),function(u){c(e.node(u))}),ue.forEach(e.edges(),function(u){var d=e.edge(u);ue.has(d,"x")&&c(d)}),t-=i,n-=a,ue.forEach(e.nodes(),function(u){var d=e.node(u);d.x-=t,d.y-=n}),ue.forEach(e.edges(),function(u){var d=e.edge(u);ue.forEach(d.points,function(f){f.x-=t,f.y-=n}),ue.has(d,"x")&&(d.x-=t),ue.has(d,"y")&&(d.y-=n)}),o.width=r-t+i,o.height=s-n+a}function gq(e){ue.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),s=e.node(t.w),o,i;r.points?(o=r.points[0],i=r.points[r.points.length-1]):(r.points=[],o=s,i=n),r.points.unshift(Dn.intersectRect(n,o)),r.points.push(Dn.intersectRect(s,i))})}function vq(e){ue.forEach(e.edges(),function(t){var r=e.edge(t);if(ue.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function xq(e){ue.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function yq(e){ue.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),s=e.node(r.borderBottom),o=e.node(ue.last(r.borderLeft)),i=e.node(ue.last(r.borderRight));r.width=Math.abs(i.x-o.x),r.height=Math.abs(s.y-n.y),r.x=o.x+r.width/2,r.y=n.y+r.height/2}}),ue.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function bq(e){ue.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function wq(e){var t=Dn.buildLayerMatrix(e);ue.forEach(t,function(r){var n=0;ue.forEach(r,function(s,o){var i=e.node(s);i.order=o+n,ue.forEach(i.selfEdges,function(a){Dn.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:i.rank,order:o+ ++n,e:a.e,label:a.label},"_se")}),delete i.selfEdges})})}function _q(e){ue.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),s=n.x+n.width/2,o=n.y,i=r.x-s,a=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:s+2*i/3,y:o-a},{x:s+5*i/6,y:o-a},{x:s+i,y:o},{x:s+5*i/6,y:o+a},{x:s+2*i/3,y:o+a}],r.label.x=r.x,r.label.y=r.y}})}function bm(e,t){return ue.mapValues(ue.pick(e,t),Number)}function wm(e){var t={};return ue.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var Ta=De,jq=Ct,Sq=xr.Graph,kq={debugOrdering:Nq};function Nq(e){var t=jq.buildLayerMatrix(e),r=new Sq({compound:!0,multigraph:!0}).setGraph({});return Ta.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),Ta.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),Ta.forEach(t,function(n,s){var o="layer"+s;r.setNode(o,{rank:"same"}),Ta.reduce(n,function(i,a){return r.setEdge(i,a,{style:"invis"}),a})}),r}var Eq="0.8.5",Cq={graphlib:xr,layout:Zz,debug:kq,util:{time:Ct.time,notime:Ct.notime},version:Eq};const zl=Gg(Cq),F2=(e,t)=>{const r=new zl.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),zl.layout(r),{nodes:e.map(n=>{const s=r.node(n.id);return{...n,targetPosition:J.Top,sourcePosition:J.Bottom,position:{x:s.x-(n.data.width??280)/2,y:s.y-(n.data.height??90)/2}}}),edges:t}},B2=(e,t,r)=>{let n=[],s=[],o=null,i=null,a=[];const c=r.theme||"industrial";return e.forEach((u,d)=>{var y,v;if((u.level||1)!==1)return;const f=280;let p=95;u.state==="active"&&u.stations&&(p+=35);const h=t===u.id;if(n.push({id:u.id,type:"documentNode",data:{...u,width:f,height:p,isExpanded:h,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),o){const _=(y=e[d-1])==null?void 0:y.state;s.push({id:"e-"+o+"-"+u.id,source:o,target:u.id,type:"smoothstep",animated:_==="active",style:{stroke:JN(_,c),strokeWidth:3}})}((v=u.children)==null?void 0:v.length)>0&&(i=u.id,a=u.children),o=u.id}),{nodes:n,edges:s,epicBacklogId:i,epicChildren:a}},H2=(e,t,r,n,s)=>{const{nodes:o,edges:i}=e;if(!t||!r.length)return{nodes:o,edges:i};const a=o.find(b=>b.id===t);if(!a)return{nodes:o,edges:i};const c=a.position.x,u=a.position.y+(a.data.height||95),d=a.data.state,f=s.theme||"industrial",p=JN(d,f),h=d==="active",y=ir.EPIC_HEIGHT+ir.EPIC_GAP_Y,v=Math.ceil(r.length/ir.EPICS_PER_ROW),_=c+280*.15,g=50,x={};r.forEach((b,w)=>{const j=Math.floor(w/ir.EPICS_PER_ROW);x[j]||(x[j]=[]),x[j].push({epic:b,idx:w})});for(let b=0;b<v;b++){const w=x[b]||[];if(w.length===0)continue;const j=u+ir.EPIC_OFFSET_Y+b*y,k=`junction-row-${b}`;o.push({id:k,type:"waypoint",position:{x:_,y:j-g},draggable:!1,connectable:!1,selectable:!1}),b===0?i.push({id:`e-spine-drop-${b}`,source:t,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):i.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),w.forEach(({epic:N,idx:S})=>{const C=S%ir.EPICS_PER_ROW,R=c+ir.EPIC_OFFSET_X+C*(ir.EPIC_WIDTH+ir.EPIC_GAP_X),T=j,L=n===N.id;o.push({id:N.id,type:"documentNode",data:{...N,width:ir.EPIC_WIDTH,height:ir.EPIC_HEIGHT,isExpanded:L,...s},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:J.Top,sourcePosition:J.Bottom,zIndex:L?1e3:0}),i.push({id:`e-branch-${N.id}`,source:k,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:o,edges:i}},Rq={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},W2={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function Tq(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function Iq(e,t=[]){const r=[],n=[],s={};for(const o of e.tracks){const i=Mq(o,t);if((o.scope||"project")==="project")n.push({...i,mayOwn:o.may_own||[],childDocType:o.child_doc_type});else{const c=o.document_type;s[c]||(s[c]=[]),s[c].push(i)}}for(const o of n)o.childDocType&&s[o.childDocType]&&(o.children=s[o.childDocType].map(i=>({...i,level:2}))),r.push(o);return r}function Mq(e,t=[]){const r=Rq[e.state]||"ready_for_production",n=e.state==="awaiting_operator",s=t.find(a=>a.document_type===e.document_type);let o=null;(r==="in_production"||n)&&(o=Pq(e.stations,e.state,e.station));let i=null;return s&&s.questions&&(i=s.questions.map((a,c)=>({id:a.id||`q${c+1}`,text:a.question||a.text||a,required:a.required!==!1}))),{id:e.document_type,name:e.document_name||Aq(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:o,questions:i,interruptId:s==null?void 0:s.id,blockedBy:e.blocked_by||[]}}function Pq(e,t,r){if(!e||e.length===0){const n=r||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return Eu.map(s=>({id:s,label:W2[s]||s.toUpperCase(),state:n===s?"active":Eu.indexOf(s)<Eu.indexOf(n)?"complete":"pending",needs_input:s==="pgc"&&t==="awaiting_operator"}))}return e.map(n=>({id:n.station,label:W2[n.station]||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function Aq(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function Dq({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,s]=m.useState(!0),[o,i]=m.useState(null),a=m.useCallback(async()=>{s(!0),i(null);try{const u=await Pe.getProjects({includeArchived:e}),d=Tq(u);r(d)}catch(u){i(u.message),console.error("Failed to fetch projects:",u)}finally{s(!1)}},[e]),c=m.useCallback(async u=>{try{const d=await Pe.createProject({name:u,description:""});return r(f=>({...f,[d.id]:{id:d.id,projectId:d.project_id,name:d.name,description:d.description||"",status:"active",icon:d.icon,createdAt:d.created_at}})),d}catch(d){throw i(d.message),console.error("Failed to create project:",d),d}},[]);return m.useEffect(()=>{a()},[a]),{projects:t,loading:n,error:o,addProject:c,refresh:a}}function Oq(e){const[t,r]=m.useState([]),[n,s]=m.useState("idle"),[o,i]=m.useState([]),[a,c]=m.useState(!0),[u,d]=m.useState(null),[f,p]=m.useState(!1),h=m.useRef(null),y=m.useRef(null),v=m.useCallback(async()=>{if(e)try{c(!0),d(null);const[w,j]=await Promise.all([Pe.getProductionStatus(e),Pe.getProjectInterrupts(e).catch(()=>[])]);i(j),s(w.line_state),r(Iq(w,j))}catch(w){d(w.message),console.error("Failed to fetch production status:",w)}finally{c(!1)}},[e]),_=m.useCallback(()=>{if(!e)return;h.current&&h.current.close();const w=QA(e);h.current=w,w.addEventListener("connected",()=>{p(!0),d(null),console.log(`SSE connected for project ${e}`)}),w.addEventListener("station_transition",j=>{try{const k=JSON.parse(j.data);console.log("Station transition:",k),v()}catch(k){console.error("Failed to parse station_transition:",k)}}),w.addEventListener("line_stopped",j=>{try{const k=JSON.parse(j.data);console.log("Line stopped:",k),s("stopped"),v()}catch(k){console.error("Failed to parse line_stopped:",k)}}),w.addEventListener("production_complete",j=>{try{const k=JSON.parse(j.data);console.log("Production complete:",k),s("complete"),v()}catch(k){console.error("Failed to parse production_complete:",k)}}),w.addEventListener("interrupt_resolved",j=>{try{const k=JSON.parse(j.data);console.log("Interrupt resolved:",k),v()}catch(k){console.error("Failed to parse interrupt_resolved:",k)}}),w.addEventListener("track_started",j=>{try{const k=JSON.parse(j.data);console.log("Track started:",k),s("active"),v()}catch(k){console.error("Failed to parse track_started:",k)}}),w.onerror=j=>{console.error("SSE error:",j),p(!1),d("Connection lost"),w.close(),y.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),_()},3e3)}},[e,v]),g=m.useCallback(()=>{y.current&&clearTimeout(y.current),h.current&&(h.current.close(),h.current=null),p(!1)},[]),x=m.useCallback(async(w,j)=>{try{await Pe.resolveInterrupt(w,{answers:j}),await v()}catch(k){throw console.error("Failed to resolve interrupt:",k),k}},[v]),b=m.useCallback(async(w=null)=>{try{await Pe.startProduction(e,w),s("active"),await v()}catch(j){throw console.error("Failed to start production:",j),j}},[e,v]);return m.useEffect(()=>(v(),_(),()=>g()),[v,_,g]),{data:t,lineState:n,interrupts:o,loading:a,error:u,connected:f,refresh:v,resolveInterrupt:x,startProduction:b}}const V2="combine-theme";function vC(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const o=localStorage.getItem(V2);return o&&xn.includes(o)?o:e});m.useEffect(()=>{localStorage.setItem(V2,t)},[t]);const n=m.useCallback(o=>{xn.includes(o)&&r(o)},[]),s=m.useCallback(()=>{r(o=>{const i=xn.indexOf(o);return xn[(i+1)%xn.length]})},[]);return{theme:t,setTheme:n,cycleTheme:s}}function Lq(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[s,o]=m.useState([]),[i,a]=m.useState(null),[c,u]=m.useState(null),[d,f]=m.useState({}),[p,h]=m.useState(0),[y,v]=m.useState([]),[_,g]=m.useState(!1),[x,b]=m.useState(null),[w,j]=m.useState(null),[k,N]=m.useState(null),[S,C]=m.useState(!1),[R,T]=m.useState(!1),L=m.useRef(null),q=m.useRef(!0);m.useEffect(()=>(q.current=!0,()=>{q.current=!1,L.current&&L.current.close()}),[]);const E=m.useCallback(P=>{q.current&&(n(P.phase),o(P.messages||[]),a(P.pending_prompt),u(P.pending_choices),f(P.interpretation||{}),h(P.confidence||0),v(P.missing_fields||[]),g(P.can_initialize||!1),b(P.gate_outcome),j(P.project))},[]),D=m.useCallback(async()=>{N(null),C(!0);try{const P=await Pe.startIntake();if(!q.current)return;t(P.execution_id),n(P.phase||"describe"),a(P.pending_prompt),o([]),f({}),j(null),b(null)}catch(P){if(!q.current)return;N(P.message||"Failed to start intake")}finally{q.current&&C(!1)}},[]),A=m.useCallback(async P=>{if(!e||!P.trim())return;N(null),T(!0);const I={role:"user",content:P};o(F=>[...F,I]);try{const F=await Pe.submitIntakeMessage(e,P);if(!q.current)return;E(F)}catch(F){if(!q.current)return;o(V=>V.filter(G=>G!==I)),N(F.message||"Failed to submit message")}finally{q.current&&T(!1)}},[e,E]),$=m.useCallback(async(P,I)=>{if(e){N(null),f(F=>({...F,[P]:{value:I,source:"user",locked:!0}}));try{const F=await Pe.updateIntakeField(e,P,I);if(!q.current)return;E(F)}catch(F){if(!q.current)return;N(F.message||"Failed to update field");const V=await Pe.getIntakeState(e);q.current&&E(V)}}},[e,E]),O=m.useCallback(async()=>{if(!(!e||!_)){N(null),C(!0);try{const P=await Pe.initializeIntake(e);if(!q.current)return;E(P),P.phase==="generating"&&M()}catch(P){if(!q.current)return;N(P.message||"Failed to initialize project"),C(!1)}}},[e,_,E]),M=m.useCallback(()=>{L.current&&L.current.close();const P=ZA(e);L.current=P,P.addEventListener("started",I=>{if(!q.current)return;const F=JSON.parse(I.data);console.log("Intake started:",F)}),P.addEventListener("progress",I=>{if(!q.current)return;const F=JSON.parse(I.data);console.log("Intake progress:",F.current_node)}),P.addEventListener("complete",async I=>{if(!q.current)return;const F=JSON.parse(I.data);console.log("Intake complete:",F),P.close(),L.current=null,n("complete"),b(F.gate_outcome),j(F.project),C(!1)}),P.addEventListener("error",I=>{if(q.current&&P.readyState!==EventSource.CLOSED){try{const F=JSON.parse(I.data);N(F.message||"Generation failed")}catch{N("Connection lost during generation")}P.close(),L.current=null,C(!1)}}),P.onerror=()=>{q.current&&P.readyState===EventSource.CLOSED&&(L.current=null,C(!1))}},[e]),z=m.useCallback(()=>{L.current&&(L.current.close(),L.current=null),t(null),n("idle"),o([]),a(null),u(null),f({}),h(0),v([]),g(!1),b(null),j(null),N(null),C(!1),T(!1)},[]);return{executionId:e,phase:r,messages:s,pendingPrompt:i,pendingChoices:c,interpretation:d,confidence:p,missingFields:y,canInitialize:_,gateOutcome:x,project:w,error:k,loading:S,submitting:R,startIntake:D,submitMessage:A,updateField:$,lockAndGenerate:O,reset:z}}const xC=m.createContext(null);function zq({children:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,i]=m.useState(null);m.useEffect(()=>{a()},[]);const a=m.useCallback(async()=>{s(!0),i(null);try{const f=await Pe.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),i(f.message),r(null)}finally{s(!1)}},[]),c=m.useCallback(f=>{window.location.href=JA(f)},[]),u=m.useCallback(async()=>{try{await Pe.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),d={user:t,loading:n,error:o,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:u,checkAuth:a};return l.jsx(xC.Provider,{value:d,children:e})}function xo(){const e=m.useContext(xC);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function qq(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[s,o]=m.useState(!0),[i,a]=m.useState(null),c=m.useCallback(async()=>{o(!0),a(null);try{let d=await Ee.getCurrentWorkspace();d||(d=await Ee.createWorkspace()),t(d.workspace_id),n(d.branch)}catch(d){a(d.message),console.error("Failed to initialize workspace:",d)}finally{o(!1)}},[]),u=m.useCallback(async(d=!1)=>{if(e)try{await Ee.closeWorkspace(e,d),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:s,error:i,closeWorkspace:u,reinitialize:c}}function $q(e,t=1e4){var d,f;const[r,n]=m.useState(null),[s,o]=m.useState(!0),[i,a]=m.useState(null),c=m.useRef(null),u=m.useCallback(async()=>{if(!e){n(null),o(!1);return}try{const p=await Ee.getWorkspaceState(e);n(p),a(null)}catch(p){a(p.message),console.error("Failed to fetch workspace state:",p)}finally{o(!1)}},[e]);return m.useEffect(()=>{e&&(o(!0),u())},[e,u]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(u,t),()=>{c.current&&clearInterval(c.current)}},[e,t,u]),{state:r,loading:s,error:i,refresh:u,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((d=r==null?void 0:r.tier1)==null?void 0:d.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function Fq(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ee.getDocumentTypes();t(a.document_types||[])}catch(a){o(a.message),console.error("Failed to fetch document types:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{documentTypes:e,loading:r,error:s,refresh:i}}function Bq(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ee.getRoles();t(a.roles||[])}catch(a){o(a.message),console.error("Failed to fetch roles:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{roles:e,loading:r,error:s,refresh:i}}function kx(e,t,{debounceMs:r=500,onSave:n}={}){const[s,o]=m.useState(""),[i,a]=m.useState(""),[c,u]=m.useState(!0),[d,f]=m.useState(null),[p,h]=m.useState(!1),[y,v]=m.useState(null),_=m.useRef(null),g=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){o(""),a(""),u(!1);return}u(!0),f(null);try{const S=await Ee.getArtifact(e,t);o(S.content),a(S.content)}catch(S){f(S.message),console.error("Failed to load artifact:",S)}finally{u(!1)}},[e,t]),b=m.useCallback(async S=>{if(!(!e||!t)){h(!0),f(null);try{const C=await Ee.writeArtifact(e,t,S);v(C),a(S),n&&n(C)}catch(C){f(C.message),console.error("Failed to save artifact:",C)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(S=>{g.current=S,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),j=m.useCallback(S=>{o(S),S!==i&&w(S)},[i,w]),k=m.useCallback(()=>{_.current&&clearTimeout(_.current),g.current=null,o(i)},[i]),N=m.useCallback(()=>{_.current&&clearTimeout(_.current),s!==i&&b(s)},[s,i,b]);return m.useEffect(()=>(x(),()=>{_.current&&clearTimeout(_.current)}),[x]),{content:s,originalContent:i,loading:c,error:d,saving:p,lastSaveResult:y,isDirty:s!==i,updateContent:j,reset:k,saveNow:N,reload:x}}const Hq={documentNode:w6,waypoint:_6},Wq={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function Vq({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:s,theme:o,onThemeChange:i,onProjectUpdate:a,onProjectArchive:c,onProjectUnarchive:u,onProjectDelete:d}){const{data:f,lineState:p,loading:h,error:y,connected:v,resolveInterrupt:_}=Oq(e),[g,x]=m.useState([]),[b,w]=m.useState(null),[j,k]=m.useState(null),[N,S]=m.useState(null),[C,R]=m.useState(!1),[T,L]=m.useState(""),[q,E]=m.useState(!1),[D,A]=m.useState(!1),[$,O]=m.useState(!1),M=mc();m.useEffect(()=>{f.length>0&&x(f)},[f]),m.useEffect(()=>{s&&g.length>0&&setTimeout(()=>{w(s),k("questions")},300)},[s,g.length]),m.useEffect(()=>{w(null),k(null)},[e]);const z=m.useCallback(()=>{const W=xn.indexOf(o);i(xn[(W+1)%xn.length])},[o,i]),P=m.useCallback(()=>{L(r||""),R(!0)},[r]),I=m.useCallback(async()=>{if(!T.trim()||T===r){R(!1);return}A(!0);try{await a(e,{name:T.trim()}),R(!1)}catch(W){console.error("Failed to update name:",W)}finally{A(!1)}},[T,r,e,a]),F=m.useCallback(()=>{R(!1),L("")},[]),V=m.useCallback(async()=>{A(!0);try{n?await u(e):await c(e)}catch(W){console.error("Failed to toggle archive:",W)}finally{A(!1)}},[e,n,c,u]),G=m.useCallback(async()=>{A(!0);try{await d(e),E(!1)}catch(W){console.error("Failed to delete:",W)}finally{A(!1)}},[e,d]),X=m.useCallback(W=>{const K=M.getNode(W);if(K){const ce=window.innerWidth,Se=-K.position.x*.9+ce/2-400,be=-K.position.y*.9+120;M.setViewport({x:Se,y:be,zoom:.9},{duration:800})}},[M]),te=m.useMemo(()=>({onExpand:(W,K)=>{w(W),k(K)},onCollapse:()=>{w(null),k(null),setTimeout(()=>M.fitView({padding:.2,duration:300}),50)},onViewFullDocument:W=>{S(W)},onSubmitQuestions:async(W,K)=>{console.log("Submitted:",W,K);const ae=g.find(ce=>ce.id===W);if(ae!=null&&ae.interruptId)try{await _(ae.interruptId,K)}catch(ce){console.error("Failed to submit answers:",ce)}w(null),k(null),x(ce=>{const Se=be=>be.map(le=>le.id===W&&le.stations?{...le,stations:le.stations.map(H=>H.id==="pgc"?{...H,state:"complete",needs_input:!1}:H.id==="asm"?{...H,state:"active"}:H)}:le.children?{...le,children:Se(le.children)}:le);return Se(ce)})}}),[M,g,_]),{layoutNodes:se,layoutEdges:re}=m.useMemo(()=>{if(g.length===0)return{layoutNodes:[],layoutEdges:[]};const W={...te,expandType:j,theme:o,onZoomToNode:X,projectId:e,projectCode:t},{nodes:K,edges:ae,epicBacklogId:ce,epicChildren:Se}=B2(g,b,W),be=F2(K,ae),{nodes:le,edges:H}=H2(be,ce,Se,b,W);return{layoutNodes:le.map(oe=>({...oe,data:{...oe.data,expandType:oe.id===b?j:null}})),layoutEdges:H}},[g,b,j,te,o,X,e,t]),[Q,xe,ne]=KN(se),[ye,ee,Y]=YN(re);m.useEffect(()=>{if(g.length===0)return;const W={...te,expandType:j,theme:o,onZoomToNode:X,projectId:e,projectCode:t},{nodes:K,edges:ae,epicBacklogId:ce,epicChildren:Se}=B2(g,b,W),be=F2(K,ae),{nodes:le,edges:H}=H2(be,ce,Se,b,W),Ce=le.map(oe=>({...oe,data:{...oe.data,expandType:oe.id===b?j:null}}));xe(Ce),ee(H)},[g,b,j,te,xe,ee,o,X,e,t]);const pe=m.useCallback((W,K)=>{},[]);return h&&g.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):y&&g.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:l.jsx("p",{className:"text-red-500 mb-4",children:y})})}):l.jsxs("div",{className:"w-full h-full",children:[l.jsxs(nx,{nodes:Q,edges:ye,onNodesChange:ne,onEdgesChange:Y,onNodeClick:pe,nodeTypes:Hq,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[l.jsx(Tn,{position:"top-left",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),l.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[p==="active"&&l.jsx("span",{className:"text-amber-500",children:" Active"}),p==="stopped"&&l.jsx("span",{className:"text-red-500",children:" Stopped"}),p==="complete"&&l.jsx("span",{className:"text-emerald-500",children:" Complete"}),p==="idle"&&l.jsx("span",{children:" Idle"}),!v&&l.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),l.jsx("button",{onClick:z,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:Wq[o]})]})}),l.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:l.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),C?l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("input",{type:"text",value:T,onChange:W=>L(W.target.value),onKeyDown:W=>{W.key==="Enter"&&I(),W.key==="Escape"&&F()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:D}),l.jsx("button",{onClick:I,disabled:D,className:"p-1 rounded hover:bg-white/10",title:"Save",children:l.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M5 13l4 4L19 7"})})}),l.jsx("button",{onClick:F,disabled:D,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:l.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):l.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!C&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:P,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),l.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),l.jsx("button",{onClick:V,disabled:D,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:l.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&l.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),l.jsx("button",{onClick:()=>E(!0),disabled:D||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:l.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),l.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[l.jsxs("button",{onClick:()=>O(!$),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[l.jsx("span",{children:"Workflow"}),l.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:$?"":""})]}),$&&l.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:l.jsx(C6,{projectId:e})})]})]})}),l.jsx(ZN,{position:"top-right",nodeColor:W=>{var ae;const K=(ae=W.data)==null?void 0:ae.state;return["produced","stabilized","ready"].includes(K)?"#10b981":["in_production","active"].includes(K)?"#f59e0b":["requirements_not_met","blocked"].includes(K)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),l.jsx(Tn,{position:"bottom-left",children:l.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[l.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),l.jsx(Tn,{position:"bottom-right",children:l.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),N&&l.jsx(j6,{projectId:e,projectCode:t,docTypeId:N,onClose:()=>S(null)}),q&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:l.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),l.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",l.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),l.jsxs("div",{className:"flex gap-3 justify-end",children:[l.jsx("button",{onClick:()=>E(!1),disabled:D,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),l.jsx("button",{onClick:G,disabled:D,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:D?"Deleting...":"Delete"})]})]})})]})}function Ia({messages:e,pendingPrompt:t}){const r=m.useRef(null);return m.useEffect(()=>{var n;(n=r.current)==null||n.scrollIntoView({behavior:"smooth"})},[e,t]),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.map((n,s)=>l.jsx("div",{className:`flex ${n.role==="user"?"justify-end":"justify-start"}`,children:l.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${n.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:n.content})},s)),t&&l.jsx("div",{className:"flex justify-start",children:l.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),l.jsx("div",{ref:r})]})}function Uq({onSubmit:e,disabled:t,placeholder:r}){const[n,s]=m.useState(""),o=m.useRef(null);m.useEffect(()=>{var c;t||(c=o.current)==null||c.focus()},[t]);const i=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),s("")))},a=()=>{n.trim()&&!t&&(e(n.trim()),s(""))};return l.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("textarea",{ref:o,value:n,onChange:c=>s(c.target.value),onKeyDown:i,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),l.jsx("button",{onClick:a,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),l.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const Gq={project_name:"Project Name",problem_statement:"Problem Statement",project_type:"Project Type"},Kq=["project_name","problem_statement","project_type"];function Yq({interpretation:e,missingFields:t,canInitialize:r,onUpdateField:n,onInitialize:s,loading:o}){const[i,a]=m.useState(null),[c,u]=m.useState(""),d=(h,y)=>{a(h),u(y)},f=async()=>{i&&c.trim()&&(await n(i,c.trim()),a(null),u(""))},p=()=>{a(null),u("")};return l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Review & Lock"}),t.length>0&&l.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded bg-amber-500/20 text-amber-400",children:[t.length," missing"]})]}),Kq.map(h=>{const y=e[h];if(!y)return null;const v=y.locked,_=t.includes(h),g=i===h;return l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"text-[10px] font-medium",style:{color:"var(--text-muted)"},children:[Gq[h]||h,_&&l.jsx("span",{className:"text-amber-400 ml-1",children:"*"})]}),v&&l.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"locked"})]}),g?l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:c,onChange:x=>u(x.target.value),onKeyDown:x=>{x.key==="Enter"&&f(),x.key==="Escape"&&p()},autoFocus:!0,className:"flex-1 rounded px-2 py-1.5 text-xs",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),l.jsx("button",{onClick:f,className:"px-2 py-1 rounded text-xs bg-emerald-500 text-white",children:"Save"}),l.jsx("button",{onClick:p,className:"px-2 py-1 rounded text-xs",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Cancel"})]}):l.jsx("div",{onClick:()=>!v&&d(h,y.value),className:`rounded px-2 py-1.5 text-xs ${v?"cursor-default":"cursor-pointer hover:bg-white/5"} ${_?"border border-amber-500/50":""}`,style:{background:"var(--bg-input)",color:y.value?"var(--text-primary)":"var(--text-muted)"},children:y.value||"Click to edit..."})]},h)}),l.jsx("button",{onClick:s,disabled:!r||o,className:`w-full py-2.5 rounded-lg text-sm font-medium transition-colors ${r&&!o?"bg-violet-500 text-white hover:bg-violet-400":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:o?"Initializing...":"Lock & Initialize Project"}),!r&&l.jsx("p",{className:"text-[10px] text-center",style:{color:"var(--text-muted)"},children:"Fill all required fields to continue"})]})}function Xq(){return l.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[l.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[l.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-violet-500/20"}),l.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent animate-spin"}),l.jsx("div",{className:"absolute inset-3 rounded-full bg-violet-500/20 animate-pulse"})]}),l.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"Generating Project"}),l.jsx("p",{className:"text-xs text-center max-w-[200px]",style:{color:"var(--text-muted)"},children:"Creating intake document and running quality checks..."}),l.jsxs("div",{className:"flex gap-1 mt-4",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"300ms"}})]})]})}const U2={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function Qq({type:e,className:t}){switch(e){case"check":return l.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M12 9v4M12 17h.01"}),l.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),l.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function Zq({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const s=U2[e]||U2.blocked,o=e==="qualified";return l.jsxs("div",{className:"p-6 text-center",children:[l.jsx("div",{className:`w-16 h-16 rounded-full ${s.iconBg} flex items-center justify-center mx-auto mb-4`,children:l.jsx(Qq,{type:s.icon,className:`w-8 h-8 ${s.iconColor}`})}),l.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:s.title}),l.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:s.description}),o&&t&&l.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[l.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),l.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),l.jsxs("div",{className:"flex gap-2 justify-center",children:[o&&t&&l.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),l.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function Jq({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:s,interpretation:o,missingFields:i,canInitialize:a,gateOutcome:c,project:u,error:d,loading:f,submitting:p,startIntake:h,submitMessage:y,updateField:v,lockAndGenerate:_,reset:g}=Lq();m.useEffect(()=>(h(),()=>g()),[]);const x=()=>{g(),e()},b=()=>{u&&t&&t(u),x()},w=()=>{const k=[{id:"describe",label:"Describe"},{id:"review",label:"Review"},{id:"generating",label:"Generate"},{id:"complete",label:"Done"}],N=k.findIndex(S=>S.id===r);return l.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:k.map((S,C)=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:`px-2 py-0.5 rounded ${C===N?"bg-violet-500/30 text-violet-300":C<N?"text-emerald-400":"text-slate-500"}`,children:S.label}),C<k.length-1&&l.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},S.id))})},j=()=>{if(f&&r==="idle")return l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});switch(r){case"describe":return l.jsxs(l.Fragment,{children:[l.jsx(Ia,{messages:n,pendingPrompt:s}),l.jsx(Uq,{onSubmit:y,disabled:p,placeholder:"Describe what you want to build..."})]});case"review":return l.jsxs(l.Fragment,{children:[l.jsx(Ia,{messages:n}),l.jsx("div",{className:"border-t",style:{borderColor:"var(--border-panel)"},children:l.jsx(Yq,{interpretation:o,missingFields:i,canInitialize:a,onUpdateField:v,onInitialize:_,loading:f})})]});case"generating":return l.jsxs(l.Fragment,{children:[l.jsx(Ia,{messages:n}),l.jsx(Xq,{})]});case"complete":return l.jsxs(l.Fragment,{children:[l.jsx(Ia,{messages:n}),l.jsx(Zq,{gateOutcome:c,project:u,onViewProject:b,onClose:x})]});default:return null}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:l.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),w()]})]}),l.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),d&&l.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:d}),j()]})})}function e$({onClose:e}){const{user:t,logout:r,isAdmin:n}=xo(),[s,o]=m.useState(null),[i,a]=m.useState([]),[c,u]=m.useState(!1),[d,f]=m.useState(null);m.useEffect(()=>{s==="linked"&&p()},[s]);const p=async()=>{try{u(!0);const j=await fetch("/auth/accounts",{credentials:"include"});if(j.ok){const k=await j.json();a(k.identities||[])}}catch(j){console.error("Failed to load accounts:",j)}finally{u(!1)}},h=j=>{window.location.href=`/auth/accounts/link/${j}`},y=async j=>{var k;if(i.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${j} account?`))try{const N=(k=document.cookie.split("; ").find(C=>C.startsWith("csrf=")||C.startsWith("__Host-csrf=")))==null?void 0:k.split("=")[1],S=await fetch(`/auth/accounts/${j}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(S.ok)f({type:"success",text:"Account unlinked"}),await p();else{const C=await S.json();throw new Error(C.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},v=async()=>{await r(),e()},_=j=>{o(s===j?null:j),f(null)},g={google:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},x=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=j=>{const k={user:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"9",cy:"7",r:"4"}),l.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),l.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),l.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"3"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return k[j]||k.user},w=j=>{switch(j){case"account":return l.jsxs("div",{className:"px-4 py-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),l.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),l.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return l.jsxs("div",{className:"px-4 py-3",children:[d&&l.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${d.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:d.text}),c?l.jsx("div",{className:"flex items-center justify-center py-4",children:l.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-2 mb-4",children:i.map(k=>l.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[g[k.provider_id],l.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:k.provider_email})]}),l.jsx("button",{onClick:()=>y(k.provider_id),disabled:i.length<=1,className:`text-xs px-2 py-1 rounded ${i.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},k.provider_id))}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),l.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.google,"Google"]}),l.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.microsoft,"Microsoft"]})]})]})]});default:return l.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),l.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?l.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):l.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),l.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&l.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),l.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[l.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),l.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),l.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[l.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),l.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),l.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),x.map(j=>l.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[l.jsxs("button",{onClick:()=>!j.future&&_(j.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${j.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:j.future,children:[l.jsx("span",{style:{color:"var(--text-muted)"},children:b(j.icon)}),l.jsx("span",{className:"flex-1 text-sm text-left",children:j.label}),j.future?l.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):l.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:s===j.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),s===j.id&&!j.future&&l.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:w(j.id)})]},j.id))]}),l.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:v,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),l.jsx("polyline",{points:"16 17 21 12 16 7"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const ge={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function t$(){return l.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:ge.bg,borderColor:ge.border},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:ge.textPrimary},children:"THE COMBINE"}),l.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:ge.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function r$(){return l.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:ge.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),l.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:ge.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),l.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:ge.textMuted},onMouseOver:e=>e.currentTarget.style.color=ge.textSecondary,onMouseOut:e=>e.currentTarget.style.color=ge.textMuted,children:["Learn how The Combine works",l.jsx("span",{"aria-hidden":"true",children:""})]})]})}function n$(){const e=[{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return l.jsx("section",{className:"max-w-4xl mx-auto",children:l.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>l.jsxs("div",{className:"flex-1 text-center group",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:ge.bgElevated,border:`1px solid ${ge.border}`,color:ge.textMuted},children:t.icon}),l.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:ge.textPrimary},children:t.title}),l.jsx("p",{className:"text-xs",style:{color:ge.textMuted},children:t.description}),r<e.length-1&&l.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:ge.border}})]},r))})})}function s$(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return l.jsx("section",{className:"text-center",children:l.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>l.jsx("span",{className:"text-xs",style:{color:ge.textMuted},children:t},r))})})}function o$({onLogin:e}){return l.jsxs("section",{className:"text-center",children:[l.jsx("p",{className:"text-sm font-medium mb-4",style:{color:ge.textSecondary},children:"Ready?"}),l.jsxs("div",{className:"inline-flex flex-col gap-3",children:[l.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:ge.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=ge.accentHover,onMouseOut:t=>t.currentTarget.style.background=ge.accent,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),l.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:ge.bg,border:`1px solid ${ge.border}`,color:ge.textPrimary},onMouseOver:t=>t.currentTarget.style.background=ge.bgElevated,onMouseOut:t=>t.currentTarget.style.background=ge.bg,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function i$(){return l.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[l.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:ge.textSubtle},onMouseOver:e=>e.currentTarget.style.color=ge.textMuted,onMouseOut:e=>e.currentTarget.style.color=ge.textSubtle,children:"Terms"}),l.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:ge.textSubtle},onMouseOver:e=>e.currentTarget.style.color=ge.textMuted,onMouseOut:e=>e.currentTarget.style.color=ge.textSubtle,children:"Privacy"}),l.jsx("span",{className:"text-xs",style:{color:ge.border},children:" 2026 The Combine"})]})}function a$(){const{login:e}=xo();return l.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:ge.bg},children:[l.jsx(t$,{}),l.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:l.jsxs("div",{className:"space-y-12",children:[l.jsx(r$,{}),l.jsx(n$,{}),l.jsx(s$,{}),l.jsx(o$,{onLogin:e})]})}),l.jsx(i$,{})]})}const he={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function l$(){return l.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:he.bg,borderColor:he.border},children:[l.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:he.textMuted},onMouseOver:e=>e.currentTarget.style.color=he.textSecondary,onMouseOut:e=>e.currentTarget.style.color=he.textMuted,children:[l.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),l.jsx("span",{className:"text-sm",children:"Back"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),l.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:he.textPrimary},children:"THE COMBINE"})]}),l.jsx("div",{className:"w-16"})," "]})}function Wn({title:e,children:t}){return l.jsxs("section",{className:"mb-16",children:[e&&l.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:he.textPrimary},children:e}),t]})}function Ze({children:e,className:t=""}){return l.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:he.textSecondary},children:e})}function zo({children:e}){return l.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:he.textPrimary,borderLeft:`2px solid ${he.border}`},children:e})}function Ma({items:e}){return l.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>l.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:he.textSecondary},children:[l.jsx("span",{style:{color:he.textMuted},children:"-"}),t]},r))})}function Pa({number:e,title:t,children:r}){return l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[l.jsxs("span",{className:"text-sm font-mono",style:{color:he.textMuted},children:[e,"."]}),l.jsx("h3",{className:"text-base font-medium",style:{color:he.textPrimary},children:t})]}),l.jsx("div",{className:"pl-7",children:l.jsx(Ze,{children:r})})]})}function Aa({title:e,children:t}){return l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-base font-medium mb-2",style:{color:he.textPrimary},children:e}),l.jsx(Ze,{className:"mb-0",children:t})]})}function c$({onLogin:e}){return l.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:he.bgElevated,border:`1px solid ${he.border}`},children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:he.textPrimary},children:"When You're Ready"}),l.jsx(Ze,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),l.jsx(Ze,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),l.jsx(Ze,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),l.jsxs("div",{className:"inline-flex flex-col gap-3",children:[l.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:he.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=he.accentHover,onMouseOut:t=>t.currentTarget.style.background=he.accent,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),l.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:he.bg,border:`1px solid ${he.border}`,color:he.textPrimary},onMouseOver:t=>t.currentTarget.style.background=he.bgElevated,onMouseOut:t=>t.currentTarget.style.background=he.bg,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function u$(){return l.jsxs("footer",{className:"py-8 text-center",children:[l.jsx("p",{className:"text-sm mb-6",style:{color:he.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),l.jsxs("div",{className:"flex items-center justify-center gap-6",children:[l.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:he.textSubtle},onMouseOver:e=>e.currentTarget.style.color=he.textMuted,onMouseOut:e=>e.currentTarget.style.color=he.textSubtle,children:"Terms"}),l.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:he.textSubtle},onMouseOver:e=>e.currentTarget.style.color=he.textMuted,onMouseOut:e=>e.currentTarget.style.color=he.textSubtle,children:"Privacy"}),l.jsx("span",{className:"text-xs",style:{color:he.border},children:" 2026 The Combine"})]})]})}function d$(){const{login:e}=xo();return l.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:he.bg},children:[l.jsx(l$,{}),l.jsx("main",{className:"flex-1 px-6 py-12",children:l.jsxs("article",{className:"max-w-2xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:he.textPrimary},children:"Learn More"}),l.jsxs(Wn,{title:"What The Combine Is",children:[l.jsx(Ze,{children:"The Combine is an AI-assisted production system for knowledge work."}),l.jsx(Ze,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),l.jsx(zo,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),l.jsx(zo,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),l.jsxs(Wn,{title:"Why It Exists",children:[l.jsx(Ze,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),l.jsx(Ze,{children:"It breaks down when the work must be:"}),l.jsx(Ma,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),l.jsx(Ze,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),l.jsxs(Wn,{title:'Why "The Combine"',children:[l.jsx(Ze,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),l.jsx(Ze,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),l.jsx(Ze,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),l.jsx(Ze,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),l.jsx(Ze,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),l.jsx(Ma,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),l.jsx(Ze,{children:"This is not automation for speed. It is industrialization for reliability."}),l.jsx(zo,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),l.jsxs(Wn,{title:"How It Works",children:[l.jsx(Pa,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),l.jsx(Pa,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),l.jsx(Pa,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),l.jsx(Pa,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),l.jsxs(Wn,{title:"What Makes It Different",children:[l.jsx(Aa,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),l.jsx(Aa,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),l.jsx(Aa,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),l.jsx(Aa,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),l.jsxs(Wn,{title:"What The Combine Is Not",children:[l.jsx(Ma,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),l.jsx(Ze,{children:"If you want improvisation, there are better tools."}),l.jsx(zo,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),l.jsxs(Wn,{title:"Who It's For",children:[l.jsx(Ze,{children:"The Combine is designed for people responsible for outcomes, including:"}),l.jsx(Ma,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),l.jsx(zo,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),l.jsx(c$,{onLogin:e})]})}),l.jsx(u$,{})]})}function f$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ee.getTemplates();t(a.templates||[])}catch(a){o(a.message),console.error("Failed to fetch templates:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{templates:e,loading:r,error:s,refresh:i}}function p$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ee.getOrchestrationWorkflows();t(a.workflows||[])}catch(a){o(a.message),console.error("Failed to fetch orchestration workflows:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{workflows:e,loading:r,error:s,refresh:i}}const _m="doctype-browser-collapsed";function Nx(e,t){const[r,n]=m.useState(()=>{try{const o=JSON.parse(localStorage.getItem(_m)||"{}");return e in o?o[e]:t}catch{return t}}),s=m.useCallback(o=>{const i=typeof o=="function"?o(r):o;n(i);try{const a=JSON.parse(localStorage.getItem(_m)||"{}");a[e]=i,localStorage.setItem(_m,JSON.stringify(a))}catch{}},[e,r]);return[r,s]}function jm({title:e,defaultOpen:t=!0,children:r}){const[n,s]=Nx(`group:${e}`,t);return l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>s(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[l.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function G2({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:s}){const[o,i]=Nx(`sub:${e}`,r);return l.jsxs("div",{children:[l.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[l.jsxs("button",{onClick:()=>i(!o),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[l.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&l.jsx("span",{style:{color:n,fontSize:8},children:""}),l.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),o&&s]})}function ks({selected:e,onClick:t,label:r,sublabel:n,badge:s}){return l.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"font-medium truncate",children:r}),s&&l.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:s})]}),n&&l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function Da({label:e,count:t,dotColor:r,active:n,defaultOpen:s=!1,children:o}){const[i,a]=Nx(`bb:${e}`,s);return l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>a(!i),className:"w-full px-4 py-2 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:n?"var(--bg-selected)":"transparent",color:n?"var(--text-primary)":"var(--text-secondary)",borderLeft:n?"2px solid var(--action-primary)":"2px solid transparent",cursor:"pointer"},children:[l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("span",{style:{color:r,fontSize:10},children:""}),l.jsx("span",{className:"font-medium",children:e})]}),l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t}),l.jsx("span",{style:{color:"var(--text-muted)",transform:i?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""})]})]}),i&&o]})}function Ns({loading:e,empty:t,emptyMessage:r="None found"}){return e?l.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?l.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function h$({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],loading:s=!1,rolesLoading:o=!1,templatesLoading:i=!1,workflowsLoading:a=!1,selectedDocType:c=null,docTypeSource:u=null,selectedRole:d=null,selectedTemplate:f=null,selectedWorkflow:p=null,onSelectDocType:h,onSelectRole:y,onSelectTemplate:v,onSelectWorkflow:_,onCreateWorkflow:g,onSelectTask:x,onSelectSchema:b,workspaceState:w=null}){var P;const[j,k]=m.useState(null),[N,S]=m.useState(null),[C,R]=m.useState(""),[T,L]=m.useState(!1),q=[...e].sort((I,F)=>(I.display_name||"").localeCompare(F.display_name||"")),E=n.filter(I=>(I.pow_class||"reference")==="reference"),D=I=>{const F=I.pow_class||"reference";return F==="reference"?"ref":F==="template"?"tpl":"inst"},A=e.filter(I=>I.active_version).length+n.filter(I=>I.active_version).length,$=((P=w==null?void 0:w.modified_artifacts)==null?void 0:P.length)??0,O=(w==null?void 0:w.is_dirty)??!1,M=()=>{k(null),S(null),R("")},z=async()=>{const I=C.trim().toLowerCase().replace(/\s+/g,"_");if(!(!I||!/^[a-z][a-z0-9_]*$/.test(I))){L(!0);try{const F={workflow_id:I,pow_class:"template"};N&&(F.derived_from={workflow_id:N.workflow_id,version:N.active_version},F.source_version=N.active_version),await(g==null?void 0:g(F)),M()}catch{}finally{L(!1)}}};return l.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l.jsxs(jm,{title:"Production Workflows",defaultOpen:!0,children:[l.jsxs(G2,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:g&&l.jsx("button",{onClick:()=>k(j?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[j==="choose"&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsxs("button",{onClick:()=>k("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:E.length===0,children:["From Reference",E.length===0?" (none available)":""]}),l.jsx("button",{onClick:()=>k("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),l.jsx("button",{onClick:M,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),j==="from_reference"&&!N&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),E.map(I=>l.jsxs("button",{onClick:()=>S(I),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[l.jsx("div",{className:"font-medium",children:I.name||I.workflow_id.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase())}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",I.active_version]})]},I.workflow_id)),l.jsx("button",{onClick:()=>k("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(j==="blank"||j==="from_reference"&&N)&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[N&&l.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",N.name||N.workflow_id," v",N.active_version]}),l.jsx("input",{type:"text",value:C,onChange:I=>R(I.target.value),onKeyDown:I=>{I.key==="Enter"&&z(),I.key==="Escape"&&M()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:T,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:z,disabled:T||!C.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:T?"wait":"pointer",opacity:!C.trim()||T?.5:1},children:T?"Creating...":"Create"}),l.jsx("button",{onClick:M,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),l.jsx(Ns,{loading:a,empty:!a&&n.length===0,emptyMessage:"No workflows"}),!a&&n.length>0&&l.jsx("div",{className:"py-1",children:n.map(I=>l.jsx(ks,{selected:(p==null?void 0:p.workflow_id)===I.workflow_id,onClick:()=>_==null?void 0:_(I),label:I.name||I.workflow_id.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase()),sublabel:`v${I.active_version}`,badge:D(I)},I.workflow_id))})]}),l.jsxs(G2,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",children:[l.jsx(Ns,{loading:s,empty:!s&&e.length===0,emptyMessage:"No document workflows"}),!s&&q.length>0&&l.jsx("div",{className:"py-1",children:q.map(I=>l.jsx(ks,{selected:u==="docworkflow"&&(c==null?void 0:c.doc_type_id)===I.doc_type_id,onClick:()=>h==null?void 0:h(I),label:I.display_name,badge:`v${I.active_version}`},I.doc_type_id))})]})]}),l.jsxs(jm,{title:"Building Blocks",defaultOpen:!0,children:[l.jsxs(Da,{label:"Roles",count:t.length,dotColor:"var(--dot-purple)",active:!!d,children:[l.jsx(Ns,{loading:o,empty:!o&&t.length===0,emptyMessage:"No roles"}),!o&&t.length>0&&l.jsx("div",{className:"py-1",children:t.map(I=>l.jsx(ks,{selected:(d==null?void 0:d.role_id)===I.role_id,onClick:()=>y==null?void 0:y(I),label:I.role_id.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase()),sublabel:`v${I.active_version}`},I.role_id))})]}),l.jsxs(Da,{label:"Interactions",count:e.length,dotColor:"var(--action-primary)",active:u==="task",children:[l.jsx(Ns,{loading:s,empty:!s&&e.length===0,emptyMessage:"No interactions"}),!s&&e.length>0&&l.jsx("div",{className:"py-1",children:e.map(I=>l.jsx(ks,{selected:u==="task"&&(c==null?void 0:c.doc_type_id)===I.doc_type_id,onClick:()=>{var F;return(F=x||h)==null?void 0:F({doc_type_id:I.doc_type_id,display_name:I.display_name,active_version:I.active_version})},label:I.display_name,sublabel:`from ${I.doc_type_id}`},`task-${I.doc_type_id}`))})]}),l.jsxs(Da,{label:"Schemas",count:e.length,dotColor:"var(--dot-blue)",active:u==="schema",children:[l.jsx(Ns,{loading:s,empty:!s&&e.length===0,emptyMessage:"No schemas"}),!s&&e.length>0&&l.jsx("div",{className:"py-1",children:e.map(I=>l.jsx(ks,{selected:u==="schema"&&(c==null?void 0:c.doc_type_id)===I.doc_type_id,onClick:()=>{var F;return(F=b||h)==null?void 0:F({doc_type_id:I.doc_type_id,display_name:I.display_name,active_version:I.active_version})},label:I.display_name,sublabel:`from ${I.doc_type_id}`},`schema-${I.doc_type_id}`))})]}),l.jsxs(Da,{label:"Templates",count:r.length,dotColor:"var(--dot-green)",active:!!f,children:[l.jsx(Ns,{loading:i,empty:!i&&r.length===0,emptyMessage:"No templates"}),!i&&r.length>0&&l.jsx("div",{className:"py-1",children:r.map(I=>l.jsx(ks,{selected:(f==null?void 0:f.template_id)===I.template_id,onClick:()=>v==null?void 0:v(I),label:I.template_id.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase()),sublabel:`v${I.active_version}`},I.template_id))})]})]}),l.jsxs(jm,{title:"Governance",defaultOpen:!1,children:[l.jsx("div",{className:"px-4 py-3",children:l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),l.jsxs("div",{children:[A," active ",A===1?"release":"releases"]})]})}),w&&l.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),O&&l.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[$," dirty"]})]})]})]})})}function Yn({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:s=!1,error:o=null,readOnly:i=!1,placeholder:a="Enter prompt content...",isJson:c=!1}){const u=m.useCallback(()=>{if(!(!e||!c))try{const d=JSON.parse(e),f=JSON.stringify(d,null,2);t==null||t(f)}catch(d){console.warn("Invalid JSON, cannot format:",d.message)}},[e,c,t]);return l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[i&&l.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!i&&s&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[c&&!i&&l.jsx("button",{onClick:u,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&l.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&s&&l.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),o&&l.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",o]})]})]}),l.jsx("div",{className:"flex-1 relative",children:r?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):l.jsx("textarea",{value:e,onChange:d=>t==null?void 0:t(d.target.value),placeholder:a,readOnly:i,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function m$({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[s,o]=m.useState(!0),[i,a]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),o(!1);return}(async()=>{o(!0),a(null);try{const u=await Ee.getPreview(e,t);n(u)}catch(u){a(u.message),console.error("Failed to load preview:",u)}finally{o(!1)}})()},[e,t]),l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),l.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&l.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&l.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&l.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&l.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),l.jsx("div",{className:"flex-1 relative overflow-auto",children:s?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):i?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[l.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),l.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:i})]})}):l.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function g$({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[s,o]=m.useState(null),[i,a]=m.useState(!1),[c,u]=m.useState(!1),[d,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,w,j;t&&(o({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((w=t.ui)==null?void 0:w.category)||"",ui_display_order:((j=t.ui)==null?void 0:j.display_order)||0}),h(!1),f(null))},[t]);const y=m.useCallback((b,w)=>{o(j=>({...j,[b]:w})),h(!0)},[]),v=m.useCallback((b,w)=>{const j=w.split(",").map(k=>k.trim()).filter(k=>k);o(k=>({...k,[b]:j})),h(!0)},[]),_=m.useCallback(b=>{if(!b)return"";const w=r.find(j=>j.role_id===b);return w?`prompt:role:${b}:${w.active_version}`:""},[r]),g=m.useCallback(b=>{if(!b)return"";const w=b.split(":");return w.length>=3&&w[0]==="prompt"&&w[1]==="role"?w[2]:""},[]),x=m.useCallback(async()=>{if(!(!e||!t||!s)){u(!0),f(null);try{const b=t.version||t.active_version,w=`doctype:${t.doc_type_id}:${b}:manifest`,j=v$(t.doc_type_id,b,s),k=await Ee.writeArtifact(e,w,j);h(!1),n==null||n(w,k)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{u(!1)}}},[e,t,s,n]);return!t||!s?l.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsx("div",{className:"flex items-center gap-2",children:p&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[c&&l.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),d&&l.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",d]}),l.jsx("button",{onClick:x,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"max-w-2xl space-y-6",children:[l.jsxs(qo,{title:"Identity",children:[l.jsx(It,{label:"Display Name",children:l.jsx("input",{type:"text",value:s.display_name,onChange:b=>y("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Description",children:l.jsx("textarea",{value:s.description,onChange:b=>y("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),l.jsxs(qo,{title:"Classification",children:[l.jsx(It,{label:"Authority Level",children:l.jsxs("select",{value:s.authority_level,onChange:b=>y("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"descriptive",children:"Descriptive"}),l.jsx("option",{value:"prescriptive",children:"Prescriptive"}),l.jsx("option",{value:"constructive",children:"Constructive"}),l.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),l.jsx(It,{label:"Creation Mode",children:l.jsxs("select",{value:s.creation_mode,onChange:b=>y("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"llm_generated",children:"LLM Generated"}),l.jsx("option",{value:"constructed",children:"Constructed"}),l.jsx("option",{value:"extracted",children:"Extracted"})]})}),l.jsx(It,{label:"Scope",children:l.jsxs("select",{value:s.scope,onChange:b=>y("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"project",children:"Project"}),l.jsx("option",{value:"epic",children:"Epic"}),l.jsx("option",{value:"feature",children:"Feature"})]})})]}),l.jsx(qo,{title:"Shared References",children:l.jsxs(It,{label:"Role Prompt",children:[l.jsxs("select",{value:g(s.role_prompt_ref),onChange:b=>y("role_prompt_ref",_(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"",children:"None"}),r.map(b=>l.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())},b.role_id))]}),s.role_prompt_ref&&l.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:s.role_prompt_ref})]})}),l.jsxs(qo,{title:"Dependencies",children:[l.jsx(It,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:s.required_inputs.join(", "),onChange:b=>v("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:s.optional_inputs.join(", "),onChange:b=>v("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Parent Doc Type",children:l.jsx("input",{type:"text",value:s.parent_doc_type,onChange:b=>y("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:s.creates_children.join(", "),onChange:b=>v("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),l.jsxs(qo,{title:"UI Configuration",children:[l.jsx(It,{label:"Icon",children:l.jsx("input",{type:"text",value:s.ui_icon,onChange:b=>y("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Category",children:l.jsxs("select",{value:s.ui_category,onChange:b=>y("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"",children:"Select category..."}),l.jsx("option",{value:"intake",children:"Intake"}),l.jsx("option",{value:"architecture",children:"Architecture"}),l.jsx("option",{value:"planning",children:"Planning"}),l.jsx("option",{value:"execution",children:"Execution"})]})}),l.jsx(It,{label:"Display Order",children:l.jsx("input",{type:"number",value:s.ui_display_order,onChange:b=>y("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function qo({title:e,children:t}){return l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),l.jsx("div",{className:"space-y-4",children:t})]})}function It({label:e,hint:t,children:r}){return l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&l.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function v$(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(s=>`"${s}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(s=>`"${s}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(s=>`"${s}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function yC(e,t,{debounceMs:r=1e3,onSave:n}={}){const[s,o]=m.useState(null),[i,a]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null),[p,h]=m.useState(!1),[y,v]=m.useState(null),_=m.useRef(null),g=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){o(null),a(null),u(!1);return}u(!0),f(null);try{const N=await Ee.getArtifact(e,t),S=JSON.parse(N.content);o(S),a(S)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{u(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){h(!0),f(null);try{const S=JSON.stringify(N,null,2),C=await Ee.writeArtifact(e,t,S);v(C),a(N),n&&n(C)}catch(S){f(S.message),console.error("Failed to save workflow:",S)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(N=>{g.current=N,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),j=m.useCallback(N=>{o(N),w(N)},[w]),k=m.useCallback(()=>{_.current&&clearTimeout(_.current),s&&b(s)},[s,b]);return m.useEffect(()=>(x(),()=>{_.current&&clearTimeout(_.current)}),[x]),{workflowJson:s,originalJson:i,loading:c,error:d,saving:p,lastSaveResult:y,isDirty:s!==i,updateWorkflow:j,saveNow:k,reload:x}}function x$({data:e,selected:t}){const{config:r,isEntry:n}=e,s=e.type==="end";return l.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 12px ${r.color}40`:"none",transition:"box-shadow 0.2s"},children:[l.jsx(Ir,{type:"target",position:J.Top,style:{background:r.color,width:8,height:8,border:"none"}}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[l.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&l.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),l.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&l.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),l.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!s&&l.jsx(Ir,{type:"source",position:J.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const y$=m.memo(x$),ql={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},b$={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},K2=220,Y2=110;function X2(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(s=>{const o=ql[s.type]||ql.task,a=s.type==="end"&&["blocked","abandoned"].includes(s.terminal_outcome)?b$:o;return{id:s.node_id,type:"workflowNode",position:s._position||{x:0,y:0},data:{...s,config:a,isEntry:t.includes(s.node_id)}}}),n=(e.edges||[]).map(s=>{const o=s.non_advancing||!s.to_node_id,i=s.conditions&&s.conditions.length>0;let a=s.label||s.outcome;if(i){const c=s.conditions[0],u={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;a=`${a} (${c.type} ${u} ${c.value})`}return{id:s.edge_id,source:s.from_node_id,target:s.to_node_id||s.from_node_id,type:"smoothstep",animated:o,label:a,data:{...s},style:{stroke:o?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:o?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:s.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function Q2(e,t,r="TB"){const n=new zl.graphlib.Graph;return n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(s=>{n.setNode(s.id,{width:K2,height:Y2})}),t.forEach(s=>{s.target!==s.source&&n.setEdge(s.source,s.target)}),zl.layout(n),e.map(s=>{const o=n.node(s.id);return o?{...s,position:{x:o.x-K2/2,y:o.y-Y2/2}}:s})}function w$(e,t){const r=new Set(t.map(o=>o.id||o.node_id));let n=1,s=`${e}_${n}`;for(;r.has(s);)n++,s=`${e}_${n}`;return s}function _$(e,t,r){const n=new Set(r.map(i=>i.id||i.edge_id));let s=1,o=`${e}_to_${t}`;for(;n.has(o);)s++,o=`${e}_to_${t}_${s}`;return o}function j$(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const S$={workflowNode:y$},k$=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function N$({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:s,onEdgeSelect:o}){const i=mc(),[a,c,u]=KN([]),[d,f,p]=YN([]),[h,y]=m.useState(!1),v=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:C,edges:R}=X2(e);(!C.some(L=>L.position.x!==0||L.position.y!==0)||!v.current)&&(C=Q2(C,R),v.current=!0),c(C),f(R)},[e,c,f]);const _=m.useCallback(C=>{if(!e)return;const T={edge_id:_$(C.source,C.target,e.edges||[]),from_node_id:C.source,to_node_id:C.target,outcome:"success",label:"",kind:"auto"},L={...e,edges:[...e.edges||[],T]};t(L)},[e,t]),g=m.useCallback((C,R)=>{if(!e)return;const T=e.nodes.map(L=>L.node_id===R.id?{...L,_position:R.position}:L);t({...e,nodes:T})},[e,t]),x=m.useCallback((C,R)=>{s==null||s(R.id)},[s]),b=m.useCallback((C,R)=>{o==null||o(R.id)},[o]),w=m.useCallback(()=>{s==null||s(null),o==null||o(null)},[s,o]),j=m.useCallback(C=>{if(C.key==="Delete"||C.key==="Backspace"){if(r&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(R),s==null||s(null)}else if(n&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(R),o==null||o(null)}}},[r,n,e,t,s,o]),k=m.useCallback(C=>{if(!e)return;const R=w$(C,e.nodes||[]),T=j$(C);T.node_id=R;const L=i.getViewport(),q=(-L.x+window.innerWidth/2)/L.zoom,E=(-L.y+window.innerHeight/2)/L.zoom;T._position={x:q-110,y:E-50};const D={...e,nodes:[...e.nodes||[],T]};t(D),y(!1),s==null||s(R)},[e,t,i,s]),N=m.useCallback(()=>{if(!e)return;let{nodes:C,edges:R}=X2(e);C=Q2(C,R);const T=e.nodes.map(L=>{const q=C.find(E=>E.id===L.node_id);return q?{...L,_position:q.position}:L});t({...e,nodes:T}),setTimeout(()=>{i.fitView({padding:.2,duration:300})},50)},[e,t,i]),S=m.useCallback(()=>{i.fitView({padding:.2,duration:300})},[i]);return l.jsx("div",{className:"flex-1 relative",onKeyDown:j,tabIndex:0,style:{outline:"none"},children:l.jsxs(nx,{nodes:a,edges:d,onNodesChange:u,onEdgesChange:p,onConnect:_,onNodeDragStop:g,onNodeClick:x,onEdgeClick:b,onPaneClick:w,nodeTypes:S$,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[l.jsx(Tn,{position:"top-left",children:l.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>y(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&l.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:k$.map(C=>{const R=ql[C.value]||{};return l.jsxs("button",{onClick:()=>k(C.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),C.label]},C.value)})})]}),l.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),l.jsx("button",{onClick:S,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),l.jsx(ZN,{position:"bottom-right",nodeColor:C=>{var T;const R=(T=C.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),l.jsx(Tn,{position:"bottom-left",children:l.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(ql).map(([C,R])=>l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},C))})}),l.jsx(Tn,{position:"top-right",children:l.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const E$=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],C$=["semantic","structural","hybrid"],R$=["stabilized","blocked","abandoned"],jr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Lr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function T$({node:e,onChange:t,onDelete:r}){const[n,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(u,d)=>{const f={...n,[u]:d};s(f),t(f)},i=(u,d)=>{const f={...n.includes,[u]:d},p={...n,includes:f};s(p),t(p)},a=u=>{const d={...n.includes};delete d[u];const f={...n,includes:d};s(f),t(f)},c=()=>{const u={...n.includes,NEW_KEY:""},d={...n,includes:u};s(d),t(d)};return n?l.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Node Properties"}),l.jsx("button",{onClick:()=>r(n.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Node ID"}),l.jsx("input",{type:"text",value:n.node_id||"",onChange:u=>o("node_id",u.target.value),style:jr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Type"}),l.jsx("select",{value:n.type||"task",onChange:u=>o("type",u.target.value),style:jr,children:E$.map(u=>l.jsx("option",{value:u.value,children:u.label},u.value))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Description"}),l.jsx("textarea",{value:n.description||"",onChange:u=>o("description",u.target.value),rows:3,style:{...jr,resize:"vertical"}})]}),["task","qa","pgc","intake_gate"].includes(n.type)&&l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Task Ref"}),l.jsx("input",{type:"text",value:n.task_ref||"",onChange:u=>o("task_ref",u.target.value),placeholder:"tasks/Name v1.0",style:jr})]}),["task","intake_gate"].includes(n.type)&&l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Produces"}),l.jsx("input",{type:"text",value:n.produces||"",onChange:u=>o("produces",u.target.value),placeholder:"document_type",style:jr})]}),n.type==="qa"&&l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"QA Mode"}),l.jsx("select",{value:n.qa_mode||"semantic",onChange:u=>o("qa_mode",u.target.value),style:jr,children:C$.map(u=>l.jsx("option",{value:u,children:u},u))})]}),n.type==="end"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Terminal Outcome"}),l.jsx("select",{value:n.terminal_outcome||"stabilized",onChange:u=>o("terminal_outcome",u.target.value),style:jr,children:R$.map(u=>l.jsx("option",{value:u,children:u},u))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Gate Outcome"}),l.jsx("input",{type:"text",value:n.gate_outcome||"",onChange:u=>o("gate_outcome",u.target.value),placeholder:"e.g., complete, failed",style:jr})]})]}),l.jsxs("div",{className:"flex gap-4",children:[n.type==="qa"&&l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:n.requires_qa||!1,onChange:u=>o("requires_qa",u.target.checked)}),"Requires QA"]}),l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:n.non_advancing||!1,onChange:u=>o("non_advancing",u.target.checked)}),"Non-advancing"]})]}),["task","pgc"].includes(n.type)&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:Lr,children:"Includes"}),l.jsx("button",{onClick:c,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),l.jsx("div",{className:"space-y-2",children:Object.entries(n.includes||{}).map(([u,d])=>l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"text",value:u,onChange:f=>{const p={...n.includes};delete p[u],p[f.target.value]=d;const h={...n,includes:p};s(h),t(h)},style:{...jr,width:"35%",fontSize:10},placeholder:"KEY"}),l.jsx("input",{type:"text",value:d,onChange:f=>i(u,f.target.value),style:{...jr,flex:1,fontSize:10},placeholder:"path/to/file"}),l.jsx("button",{onClick:()=>a(u),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},u))})]})]})]}):null}const I$=["auto","user_choice"],M$=["eq","ne","lt","lte","gt","gte"],zr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Vn={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function P$({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[s,o]=m.useState(e);m.useEffect(()=>{o(e)},[e]);const i=(d,f)=>{const p={...s,[d]:f};o(p),r(p)},a=()=>{const d=[...s.conditions||[],{type:"retry_count",operator:"lt",value:2}];i("conditions",d)},c=(d,f,p)=>{const h=[...s.conditions||[]];h[d]={...h[d],[f]:p},i("conditions",h)},u=d=>{const f=(s.conditions||[]).filter((p,h)=>h!==d);i("conditions",f)};return s?l.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),l.jsx("button",{onClick:()=>n(s.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{style:Vn,children:"Edge ID"}),l.jsx("input",{type:"text",value:s.edge_id||"",onChange:d=>i("edge_id",d.target.value),style:zr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Vn,children:"From Node"}),l.jsx("select",{value:s.from_node_id||"",onChange:d=>i("from_node_id",d.target.value),style:zr,children:t.map(d=>l.jsx("option",{value:d,children:d},d))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Vn,children:"To Node"}),l.jsxs("select",{value:s.to_node_id||"",onChange:d=>i("to_node_id",d.target.value||null),style:zr,children:[l.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(d=>l.jsx("option",{value:d,children:d},d))]})]}),l.jsxs("div",{children:[l.jsx("label",{style:Vn,children:"Outcome"}),l.jsx("input",{type:"text",value:s.outcome||"",onChange:d=>i("outcome",d.target.value),placeholder:"success, failed, etc.",style:zr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Vn,children:"Label"}),l.jsx("input",{type:"text",value:s.label||"",onChange:d=>i("label",d.target.value),placeholder:"Human-readable label",style:zr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Vn,children:"Kind"}),l.jsx("select",{value:s.kind||"auto",onChange:d=>i("kind",d.target.value),style:zr,children:I$.map(d=>l.jsx("option",{value:d,children:d},d))})]}),l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:s.non_advancing||!1,onChange:d=>i("non_advancing",d.target.checked)}),"Non-advancing"]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:Vn,children:"Conditions"}),l.jsx("button",{onClick:a,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),l.jsx("div",{className:"space-y-2",children:(s.conditions||[]).map((d,f)=>l.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:l.jsxs("div",{className:"flex gap-1 items-center",children:[l.jsx("input",{type:"text",value:d.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...zr,flex:1,fontSize:10}}),l.jsx("select",{value:d.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...zr,width:"auto",fontSize:10},children:M$.map(p=>l.jsx("option",{value:p,children:p},p))}),l.jsx("input",{type:"text",value:d.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...zr,width:50,fontSize:10}}),l.jsx("button",{onClick:()=>u(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const A$={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function D$({workspaceId:e,artifactId:t,onArtifactSave:r}){var O,M,z;const[n,s]=m.useState("canvas"),[o,i]=m.useState(null),[a,c]=m.useState(null),[u,d]=m.useState(""),[f,p]=m.useState(null),{workflowJson:h,loading:y,error:v,saving:_,lastSaveResult:g,updateWorkflow:x}=yC(e,t,{onSave:P=>{r==null||r(t,P)}}),b=m.useMemo(()=>{var P;return!o||!h?null:((P=h.nodes)==null?void 0:P.find(I=>I.node_id===o))||null},[o,h]),w=m.useMemo(()=>{var P;return!a||!h?null:((P=h.edges)==null?void 0:P.find(I=>I.edge_id===a))||null},[a,h]),j=m.useMemo(()=>h!=null&&h.nodes?h.nodes.map(P=>P.node_id):[],[h]),k=m.useCallback(P=>{x(P)},[x]),N=m.useCallback(P=>{if(!h)return;const I=h.nodes.map(G=>G.node_id===o?P:G);let F=h.edges,V=h.entry_node_ids||[];P.node_id!==o&&(F=h.edges.map(G=>({...G,from_node_id:G.from_node_id===o?P.node_id:G.from_node_id,to_node_id:G.to_node_id===o?P.node_id:G.to_node_id})),V=V.map(G=>G===o?P.node_id:G),i(P.node_id)),x({...h,nodes:I,edges:F,entry_node_ids:V})},[h,o,x]),S=m.useCallback(P=>{if(!h)return;const I=h.edges.map(F=>F.edge_id===a?P:F);P.edge_id!==a&&c(P.edge_id),x({...h,edges:I})},[h,a,x]),C=m.useCallback(P=>{h&&(x({...h,nodes:h.nodes.filter(I=>I.node_id!==P),edges:h.edges.filter(I=>I.from_node_id!==P&&I.to_node_id!==P),entry_node_ids:(h.entry_node_ids||[]).filter(I=>I!==P)}),i(null))},[h,x]),R=m.useCallback(P=>{h&&(x({...h,edges:h.edges.filter(I=>I.edge_id!==P)}),c(null))},[h,x]),T=m.useCallback(P=>{i(P),P&&c(null)},[]),L=m.useCallback(P=>{c(P),P&&i(null)},[]),q=m.useCallback(P=>{P==="json"&&h&&(d(JSON.stringify(h,null,2)),p(null)),s(P)},[h]),E=m.useCallback(P=>{const I=P.target.value;d(I);try{const F=JSON.parse(I);p(null),x(F)}catch(F){p(F.message)}},[x]),D=((O=g==null?void 0:g.tier1_report)==null?void 0:O.results)||[],A=D.filter(P=>P.severity==="error").length,$=D.filter(P=>P.severity==="warning").length;return l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[_&&l.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),v&&l.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:v}),!_&&!v&&h&&l.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((M=h.nodes)==null?void 0:M.length)||0," nodes, ",((z=h.edges)==null?void 0:z.length)||0," edges"]})]})}),l.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(P=>l.jsx("button",{onClick:()=>q(P.id),style:{...A$,color:n===P.id?"var(--text-primary)":"var(--text-muted)",borderBottom:n===P.id?"2px solid var(--action-primary)":"2px solid transparent"},children:P.label},P.id))}),y?l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):l.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[n==="canvas"&&l.jsxs(l.Fragment,{children:[l.jsx(gc,{children:l.jsx(N$,{workflowJson:h,onWorkflowChange:k,selectedNodeId:o,selectedEdgeId:a,onNodeSelect:T,onEdgeSelect:L})}),b&&l.jsx(T$,{node:b,onChange:N,onDelete:C}),w&&l.jsx(P$,{edge:w,nodeIds:j,onChange:S,onDelete:R})]}),n==="json"&&l.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[l.jsx("textarea",{value:u,onChange:E,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:f?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),f&&l.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",f]})]}),n==="metadata"&&l.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:h?l.jsx(O$,{workflow:h}):l.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),D.length>0&&l.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[A>0&&l.jsxs("span",{style:{color:"#ef4444"},children:[A," error",A!==1?"s":""]}),$>0&&l.jsxs("span",{style:{color:"#f59e0b"},children:[$," warning",$!==1?"s":""]}),A===0&&$===0&&l.jsx("span",{style:{color:"#10b981"},children:"Valid"}),l.jsx("span",{style:{color:"var(--text-muted)"},children:D.map(P=>P.message).join(" | ")})]})]})}function O$({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],s=e.thread_ownership||{},o=Object.entries(s),i=e.entry_node_ids||[];return l.jsxs("div",{className:"space-y-4 max-w-lg",children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(a=>l.jsxs("div",{children:[l.jsx("label",{style:r,children:a.label}),l.jsx("div",{style:t,children:e[a.key]||"-"})]},a.key)),l.jsxs("div",{children:[l.jsx("label",{style:r,children:"Entry Node IDs"}),l.jsx("div",{style:t,children:i.length>0?i.join(", "):"-"})]}),o.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),o.map(([a,c])=>l.jsxs("div",{children:[l.jsx("label",{style:r,children:a}),l.jsx("div",{style:t,children:c})]},a))]})]})}function Sm({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:s}){const[o,i]=m.useState(!1),a=m.useRef(null);return m.useEffect(()=>{if(!o)return;const c=u=>{a.current&&!a.current.contains(u.target)&&i(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[o]),t.length===0?null:l.jsxs("div",{ref:a,style:{position:"relative"},children:[l.jsxs("button",{onClick:()=>i(!o),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:s?"var(--text-primary)":"var(--text-muted)",background:s?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:s?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,l.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),o&&l.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>l.jsxs("button",{onClick:()=>{n(c.id),i(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&l.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function km({label:e,isSelected:t,onClick:r}){return l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function L$({workspaceId:e,docType:t,loading:r=!1,roles:n=[],onArtifactSave:s,initialTab:o=null,docTypeSource:i=null}){var Se,be,le;const[a,c]=m.useState(o||"task_prompt");m.useEffect(()=>{o&&c(o)},[o]);const[u,d]=m.useState("source"),[f,p]=m.useState(null),[h,y]=m.useState(!1),[v,_]=m.useState(null),[g,x]=m.useState(null),[b,w]=m.useState(!1),[j,k]=m.useState(null),[N,S]=m.useState(null),[C,R]=m.useState(!1),[T,L]=m.useState(null),[q,E]=m.useState(null),[D,A]=m.useState(!1),[$,O]=m.useState(null),M=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const H=t.role_prompt_ref.split(":");return H.length!==4||H[0]!=="prompt"||H[1]!=="role"?null:{roleId:H[2],version:H[3]}},[t==null?void 0:t.role_prompt_ref]),z=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const H=t.template_ref.split(":");return H.length!==4||H[0]!=="prompt"||H[1]!=="template"?null:{templateId:H[2],version:H[3]}},[t==null?void 0:t.template_ref]),P=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const H=t.qa_template_ref.split(":");return H.length!==4||H[0]!=="prompt"||H[1]!=="template"?null:{templateId:H[2],version:H[3]}},[t==null?void 0:t.qa_template_ref]),I=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const H=t.pgc_template_ref.split(":");return H.length!==4||H[0]!=="prompt"||H[1]!=="template"?null:{templateId:H[2],version:H[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!M){p(null);return}y(!0),_(null),Ee.getRole(M.roleId,M.version).then(H=>{p(H.content)}).catch(H=>{console.error("Failed to load role:",H),_(H.message)}).finally(()=>{y(!1)})},[M]),m.useEffect(()=>{if(!z){x(null);return}w(!0),k(null),Ee.getTemplate(z.templateId,z.version).then(H=>{x(H.content)}).catch(H=>{console.error("Failed to load template:",H),k(H.message)}).finally(()=>{w(!1)})},[z]),m.useEffect(()=>{if(!P){S(null);return}R(!0),L(null),Ee.getTemplate(P.templateId,P.version).then(H=>{S(H.content)}).catch(H=>{console.error("Failed to load QA template:",H),L(H.message)}).finally(()=>{R(!1)})},[P]),m.useEffect(()=>{if(!I){E(null);return}A(!0),O(null),Ee.getTemplate(I.templateId,I.version).then(H=>{E(H.content)}).catch(H=>{console.error("Failed to load PGC template:",H),O(H.message)}).finally(()=>{A(!1)})},[I]);const F=m.useMemo(()=>{if(!t||a==="role_prompt")return null;const H=t.version||t.active_version;return`doctype:${t.doc_type_id}:${H}:${a}`},[t,a]),{content:V,loading:G,error:X,saving:te,isDirty:se,updateContent:re,lastSaveResult:Q}=kx(e,F,{onSave:H=>{s==null||s(F,H)}}),xe=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],ne=m.useMemo(()=>t?xe.filter(H=>H.id==="package"?!0:H.id==="role_prompt"?!!t.role_prompt_ref:H.id==="template"?!!t.template_ref:H.id==="qa_template"?!!t.qa_template_ref:H.id==="pgc_template"?!!t.pgc_template_ref:H.id==="workflow"?!!t.workflow_ref:t.artifacts?t.artifacts[H.id]!=null:!1):[],[t]);m.useEffect(()=>{ne.length>0&&!ne.find(H=>H.id===a)&&c(ne[0].id)},[ne,a]);const ye=a==="role_prompt"||a==="template"||a==="qa_template"||a==="pgc_template",ee=a==="package",Y=a==="schema",pe=a==="workflow",W=!ye&&!ee&&!Y&&!pe;if(!t&&!r)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),l.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),l.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const K=i==="task"||i==="schema",ae=i==="task"?"Interaction":i==="schema"?"Schema":null,ce=!K&&(a==="task_prompt"||a==="schema");return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),l.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:K?ae:l.jsxs(l.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),K&&l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:i==="task"?"Task Prompt":"Schema"})}),!K&&l.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[ne.find(H=>H.id==="package")&&l.jsx(km,{label:"Package",isSelected:a==="package",onClick:()=>{c("package"),d("source")}}),ne.find(H=>H.id==="workflow")&&l.jsx(km,{label:"Workflow",isSelected:a==="workflow",onClick:()=>{c("workflow"),d("source")}}),(()=>{const H=["role_prompt","task_prompt","template"],Ce=ne.filter(oe=>H.includes(oe.id)).map(oe=>({id:oe.id,label:oe.id==="role_prompt"?"Role":oe.id==="task_prompt"?"Task":"Template",viewOnly:oe.viewOnly}));return Ce.length===0?null:l.jsx(Sm,{label:"Generation",items:Ce,selectedId:H.includes(a)?a:null,onSelect:oe=>{c(oe),d("source")},isGroupActive:H.includes(a)})})(),(()=>{const H=["qa_prompt","qa_template"],Ce=ne.filter(oe=>H.includes(oe.id)).map(oe=>({id:oe.id,label:oe.id==="qa_prompt"?"Prompt":"Template",viewOnly:oe.viewOnly}));return Ce.length===0?null:l.jsx(Sm,{label:"QA",items:Ce,selectedId:H.includes(a)?a:null,onSelect:oe=>{c(oe),d("source")},isGroupActive:H.includes(a)})})(),(()=>{const H=["pgc_context","pgc_template"],Ce=ne.filter(oe=>H.includes(oe.id)).map(oe=>({id:oe.id,label:oe.id==="pgc_context"?"Context":"Template",viewOnly:oe.viewOnly}));return Ce.length===0?null:l.jsx(Sm,{label:"PGC",items:Ce,selectedId:H.includes(a)?a:null,onSelect:oe=>{c(oe),d("source")},isGroupActive:H.includes(a)})})(),ne.find(H=>H.id==="schema")&&l.jsx(km,{label:"Schema",isSelected:a==="schema",onClick:()=>{c("schema"),d("source")}})]}),!K&&W&&!ce&&l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>d("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:u==="source"?"var(--action-primary)":"transparent",color:u==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),l.jsx("button",{onClick:()=>d("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:u==="resolved"?"var(--action-primary)":"transparent",color:u==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),u==="source"&&((Se=t==null?void 0:t.artifacts)==null?void 0:Se[a])&&l.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[a]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[a]]})]}),ye&&l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:a==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),a==="role_prompt"&&M&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[M.roleId.replace(/_/g," ")," v",M.version]}),a==="template"&&z&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[z.templateId.replace(/_/g," ")," v",z.version]}),a==="qa_template"&&P&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[P.templateId.replace(/_/g," ")," v",P.version]}),a==="pgc_template"&&I&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[I.templateId.replace(/_/g," ")," v",I.version]})]}),ce&&l.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:a==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),Y&&((be=t==null?void 0:t.artifacts)==null?void 0:be.schema)&&l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),l.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:pe?l.jsx(D$,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s}):a==="package"?l.jsx(g$,{workspaceId:e,docType:t,roles:n,onSave:s}):a==="role_prompt"?l.jsx(Yn,{content:f||"",onChange:()=>{},loading:h,saving:!1,isDirty:!1,error:v,readOnly:!0,placeholder:"No role prompt configured for this document type"}):a==="template"?l.jsx(Yn,{content:g||"",onChange:()=>{},loading:b,saving:!1,isDirty:!1,error:j,readOnly:!0,placeholder:"No template configured for this document type"}):a==="qa_template"?l.jsx(Yn,{content:N||"",onChange:()=>{},loading:C,saving:!1,isDirty:!1,error:T,readOnly:!0,placeholder:"No QA template configured for this document type"}):a==="pgc_template"?l.jsx(Yn,{content:q||"",onChange:()=>{},loading:D,saving:!1,isDirty:!1,error:$,readOnly:!0,placeholder:"No PGC template configured for this document type"}):u==="source"||Y?l.jsx(Yn,{content:V,onChange:ce?()=>{}:re,loading:G,saving:ce?!1:te,isDirty:ce?!1:se,error:X,readOnly:ce,placeholder:`Enter ${((le=ne.find(H=>H.id===a))==null?void 0:le.label)||"prompt"} content...`,isJson:Y}):l.jsx(m$,{workspaceId:e,artifactId:F})}),W&&(Q==null?void 0:Q.tier1)&&!Q.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function z$({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:s,loading:o,error:i,saving:a,isDirty:c,updateContent:u,lastSaveResult:d}=kx(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),l.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),l.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(Yn,{content:s,onChange:u,loading:o,saving:a,isDirty:c,error:i,placeholder:"Enter role prompt content..."})}),(d==null?void 0:d.tier1)&&!d.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function q$({workspaceId:e,template:t,onArtifactSave:r}){const n=t?`template:${t.template_id}:${t.active_version}:template`:null,{content:s,loading:o,error:i,saving:a,isDirty:c,updateContent:u,lastSaveResult:d}=kx(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),l.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const f=t.template_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),l.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Shared Template"]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Template"})}),l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(Yn,{content:s,onChange:u,loading:o,saving:a,isDirty:c,error:i,placeholder:"Enter template content..."})}),(d==null?void 0:d.tier1)&&!d.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function $$(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(s=>s(n))},t)}const Oc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function yo(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ex(e){return"nodeType"in e}function Tt(e){var t,r;return e?yo(e)?e:Ex(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Cx(e){const{Document:t}=Tt(e);return e instanceof t}function Zi(e){return yo(e)?!1:e instanceof Tt(e).HTMLElement}function bC(e){return e instanceof Tt(e).SVGElement}function bo(e){return e?yo(e)?e.document:Ex(e)?Cx(e)?e:Zi(e)||bC(e)?e.ownerDocument:document:document:document}const Mr=Oc?m.useLayoutEffect:m.useEffect;function Rx(e){const t=m.useRef(e);return Mr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function F$(){const e=m.useRef(null),t=m.useCallback((n,s)=>{e.current=setInterval(n,s)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Oi(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Mr(()=>{r.current!==e&&(r.current=e)},t),r}function Ji(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function $l(e){const t=Rx(e),r=m.useRef(null),n=m.useCallback(s=>{s!==r.current&&(t==null||t(s,r.current)),r.current=s},[]);return[r,n]}function Bg(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Nm={};function ea(e,t){return m.useMemo(()=>{if(t)return t;const r=Nm[e]==null?0:Nm[e]+1;return Nm[e]=r,e+"-"+r},[e,t])}function wC(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((o,i)=>{const a=Object.entries(i);for(const[c,u]of a){const d=o[c];d!=null&&(o[c]=d+e*u)}return o},{...t})}}const Xs=wC(1),Li=wC(-1);function B$(e){return"clientX"in e&&"clientY"in e}function Tx(e){if(!e)return!1;const{KeyboardEvent:t}=Tt(e.target);return t&&e instanceof t}function H$(e){if(!e)return!1;const{TouchEvent:t}=Tt(e.target);return t&&e instanceof t}function Hg(e){if(H$(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return B$(e)?{x:e.clientX,y:e.clientY}:null}const lo=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[lo.Translate.toString(e),lo.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),Z2="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function W$(e){return e.matches(Z2)?e:e.querySelector(Z2)}const V$={display:"none"};function U$(e){let{id:t,value:r}=e;return B.createElement("div",{id:t,style:V$},r)}function G$(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return B.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function K$(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const _C=m.createContext(null);function Y$(e){const t=m.useContext(_C);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function X$(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:s,event:o}=n;e.forEach(i=>{var a;return(a=i[s])==null?void 0:a.call(i,o)})},[e]),t]}const Q$={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Z$={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function J$(e){let{announcements:t=Z$,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=Q$}=e;const{announce:o,announcement:i}=K$(),a=ea("DndLiveRegion"),[c,u]=m.useState(!1);if(m.useEffect(()=>{u(!0)},[]),Y$(m.useMemo(()=>({onDragStart(f){let{active:p}=f;o(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&o(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;o(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;o(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;o(t.onDragCancel({active:p,over:h}))}}),[o,t])),!c)return null;const d=B.createElement(B.Fragment,null,B.createElement(U$,{id:n,value:s.draggable}),B.createElement(G$,{id:a,announcement:i}));return r?qs.createPortal(d,r):d}var Ye;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ye||(Ye={}));function Fl(){}function Bl(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function jC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const mr=Object.freeze({x:0,y:0});function SC(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function kC(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function eF(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function J2(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function NC(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function ej(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const EC=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=ej(t,t.left,t.top),o=[];for(const i of n){const{id:a}=i,c=r.get(a);if(c){const u=SC(ej(c),s);o.push({id:a,data:{droppableContainer:i,value:u}})}}return o.sort(kC)},tF=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=J2(t),o=[];for(const i of n){const{id:a}=i,c=r.get(a);if(c){const u=J2(c),d=s.reduce((p,h,y)=>p+SC(u[y],h),0),f=Number((d/4).toFixed(4));o.push({id:a,data:{droppableContainer:i,value:f}})}}return o.sort(kC)};function rF(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=s-n,a=o-r;if(n<s&&r<o){const c=t.width*t.height,u=e.width*e.height,d=i*a,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const nF=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const o of n){const{id:i}=o,a=r.get(i);if(a){const c=rF(a,t);c>0&&s.push({id:i,data:{droppableContainer:o,value:c}})}}return s.sort(eF)};function sF(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function CC(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:mr}function oF(e){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return s.reduce((i,a)=>({...i,top:i.top+e*a.y,bottom:i.bottom+e*a.y,left:i.left+e*a.x,right:i.right+e*a.x}),{...r})}}const iF=oF(1);function aF(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function lF(e,t,r){const n=aF(t);if(!n)return e;const{scaleX:s,scaleY:o,x:i,y:a}=n,c=e.left-i-(1-s)*parseFloat(r),u=e.top-a-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),d=s?e.width/s:e.width,f=o?e.height/o:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const cF={ignoreTransform:!1};function wo(e,t){t===void 0&&(t=cF);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Tt(e).getComputedStyle(e);u&&(r=lF(r,u,d))}const{top:n,left:s,width:o,height:i,bottom:a,right:c}=r;return{top:n,left:s,width:o,height:i,bottom:a,right:c}}function tj(e){return wo(e,{ignoreTransform:!0})}function uF(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function dF(e,t){return t===void 0&&(t=Tt(e).getComputedStyle(e)),t.position==="fixed"}function fF(e,t){t===void 0&&(t=Tt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?r.test(o):!1})}function Lc(e,t){const r=[];function n(s){if(t!=null&&r.length>=t||!s)return r;if(Cx(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!Zi(s)||bC(s)||r.includes(s))return r;const o=Tt(e).getComputedStyle(s);return s!==e&&fF(s,o)&&r.push(s),dF(s,o)?r:n(s.parentNode)}return e?n(e):r}function RC(e){const[t]=Lc(e,1);return t??null}function Em(e){return!Oc||!e?null:yo(e)?e:Ex(e)?Cx(e)||e===bo(e).scrollingElement?window:Zi(e)?e:null:null}function TC(e){return yo(e)?e.scrollX:e.scrollLeft}function IC(e){return yo(e)?e.scrollY:e.scrollTop}function Wg(e){return{x:TC(e),y:IC(e)}}var et;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(et||(et={}));function MC(e){return!Oc||!e?!1:e===document.scrollingElement}function PC(e){const t={x:0,y:0},r=MC(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,i=e.scrollTop>=n.y,a=e.scrollLeft>=n.x;return{isTop:s,isLeft:o,isBottom:i,isRight:a,maxScroll:n,minScroll:t}}const pF={x:.2,y:.2};function hF(e,t,r,n,s){let{top:o,left:i,right:a,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=pF);const{isTop:u,isBottom:d,isLeft:f,isRight:p}=PC(e),h={x:0,y:0},y={x:0,y:0},v={height:t.height*s.y,width:t.width*s.x};return!u&&o<=t.top+v.height?(h.y=et.Backward,y.y=n*Math.abs((t.top+v.height-o)/v.height)):!d&&c>=t.bottom-v.height&&(h.y=et.Forward,y.y=n*Math.abs((t.bottom-v.height-c)/v.height)),!p&&a>=t.right-v.width?(h.x=et.Forward,y.x=n*Math.abs((t.right-v.width-a)/v.width)):!f&&i<=t.left+v.width&&(h.x=et.Backward,y.x=n*Math.abs((t.left+v.width-i)/v.width)),{direction:h,speed:y}}function mF(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function AC(e){return e.reduce((t,r)=>Xs(t,Wg(r)),mr)}function gF(e){return e.reduce((t,r)=>t+TC(r),0)}function vF(e){return e.reduce((t,r)=>t+IC(r),0)}function xF(e,t){if(t===void 0&&(t=wo),!e)return;const{top:r,left:n,bottom:s,right:o}=t(e);RC(e)&&(s<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const yF=[["x",["left","right"],gF],["y",["top","bottom"],vF]];class Ix{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Lc(r),s=AC(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,i,a]of yF)for(const c of i)Object.defineProperty(this,c,{get:()=>{const u=a(n),d=s[o]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class li{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var s;(s=this.target)==null||s.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function bF(e){const{EventTarget:t}=Tt(e);return e instanceof t?e:bo(e)}function Cm(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var Vt;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Vt||(Vt={}));function rj(e){e.preventDefault()}function wF(e){e.stopPropagation()}var me;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(me||(me={}));const DC={start:[me.Space,me.Enter],cancel:[me.Esc],end:[me.Space,me.Enter,me.Tab]},_F=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case me.Right:return{...r,x:r.x+25};case me.Left:return{...r,x:r.x-25};case me.Down:return{...r,y:r.y+25};case me.Up:return{...r,y:r.y-25}}};class zc{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new li(bo(r)),this.windowListeners=new li(Tt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Vt.Resize,this.handleCancel),this.windowListeners.add(Vt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Vt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&xF(n),r(mr)}handleKeyDown(t){if(Tx(t)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:o=DC,coordinateGetter:i=_F,scrollBehavior:a="smooth"}=s,{code:c}=t;if(o.end.includes(c)){this.handleEnd(t);return}if(o.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:mr;this.referenceCoordinates||(this.referenceCoordinates=d);const f=i(t,{active:r,context:n.current,currentCoordinates:d});if(f){const p=Li(f,d),h={x:0,y:0},{scrollableAncestors:y}=n.current;for(const v of y){const _=t.code,{isTop:g,isRight:x,isLeft:b,isBottom:w,maxScroll:j,minScroll:k}=PC(v),N=mF(v),S={x:Math.min(_===me.Right?N.right-N.width/2:N.right,Math.max(_===me.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(_===me.Down?N.bottom-N.height/2:N.bottom,Math.max(_===me.Down?N.top:N.top+N.height/2,f.y))},C=_===me.Right&&!x||_===me.Left&&!b,R=_===me.Down&&!w||_===me.Up&&!g;if(C&&S.x!==f.x){const T=v.scrollLeft+p.x,L=_===me.Right&&T<=j.x||_===me.Left&&T>=k.x;if(L&&!p.y){v.scrollTo({left:T,behavior:a});return}L?h.x=v.scrollLeft-T:h.x=_===me.Right?v.scrollLeft-j.x:v.scrollLeft-k.x,h.x&&v.scrollBy({left:-h.x,behavior:a});break}else if(R&&S.y!==f.y){const T=v.scrollTop+p.y,L=_===me.Down&&T<=j.y||_===me.Up&&T>=k.y;if(L&&!p.x){v.scrollTo({top:T,behavior:a});return}L?h.y=v.scrollTop-T:h.y=_===me.Down?v.scrollTop-j.y:v.scrollTop-k.y,h.y&&v.scrollBy({top:-h.y,behavior:a});break}}this.handleMove(t,Xs(Li(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}zc.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=DC,onActivation:s}=t,{active:o}=r;const{code:i}=e.nativeEvent;if(n.start.includes(i)){const a=o.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function nj(e){return!!(e&&"distance"in e)}function sj(e){return!!(e&&"delay"in e)}class Mx{constructor(t,r,n){var s;n===void 0&&(n=bF(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:i}=o;this.props=t,this.events=r,this.document=bo(i),this.documentListeners=new li(this.document),this.listeners=new li(n),this.windowListeners=new li(Tt(i)),this.initialCoordinates=(s=Hg(o))!=null?s:mr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Vt.Resize,this.handleCancel),this.windowListeners.add(Vt.DragStart,rj),this.windowListeners.add(Vt.VisibilityChange,this.handleCancel),this.windowListeners.add(Vt.ContextMenu,rj),this.documentListeners.add(Vt.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(sj(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(nj(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Vt.Click,wF,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Vt.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:s,props:o}=this,{onMove:i,options:{activationConstraint:a}}=o;if(!s)return;const c=(r=Hg(t))!=null?r:mr,u=Li(s,c);if(!n&&a){if(nj(a)){if(a.tolerance!=null&&Cm(u,a.tolerance))return this.handleCancel();if(Cm(u,a.distance))return this.handleStart()}if(sj(a)&&Cm(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}t.cancelable&&t.preventDefault(),i(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===me.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const jF={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class qc extends Mx{constructor(t){const{event:r}=t,n=bo(r.target);super(t,jF,n)}}qc.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const SF={move:{name:"mousemove"},end:{name:"mouseup"}};var Vg;(function(e){e[e.RightClick=2]="RightClick"})(Vg||(Vg={}));class kF extends Mx{constructor(t){super(t,SF,bo(t.event.target))}}kF.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Vg.RightClick?!1:(n==null||n({event:r}),!0)}}];const Rm={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class NF extends Mx{constructor(t){super(t,Rm)}static setup(){return window.addEventListener(Rm.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Rm.move.name,t)};function t(){}}}NF.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var ci;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(ci||(ci={}));var Hl;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Hl||(Hl={}));function EF(e){let{acceleration:t,activator:r=ci.Pointer,canScroll:n,draggingRect:s,enabled:o,interval:i=5,order:a=Hl.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:p}=e;const h=RF({delta:f,disabled:!o}),[y,v]=F$(),_=m.useRef({x:0,y:0}),g=m.useRef({x:0,y:0}),x=m.useMemo(()=>{switch(r){case ci.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case ci.DraggableRect:return s}},[r,s,c]),b=m.useRef(null),w=m.useCallback(()=>{const k=b.current;if(!k)return;const N=_.current.x*g.current.x,S=_.current.y*g.current.y;k.scrollBy(N,S)},[]),j=m.useMemo(()=>a===Hl.TreeOrder?[...u].reverse():u,[a,u]);m.useEffect(()=>{if(!o||!u.length||!x){v();return}for(const k of j){if((n==null?void 0:n(k))===!1)continue;const N=u.indexOf(k),S=d[N];if(!S)continue;const{direction:C,speed:R}=hF(k,S,x,t,p);for(const T of["x","y"])h[T][C[T]]||(R[T]=0,C[T]=0);if(R.x>0||R.y>0){v(),b.current=k,y(w,i),_.current=R,g.current=C;return}}_.current={x:0,y:0},g.current={x:0,y:0},v()},[t,w,n,v,o,i,JSON.stringify(x),JSON.stringify(h),y,u,j,d,JSON.stringify(p)])}const CF={x:{[et.Backward]:!1,[et.Forward]:!1},y:{[et.Backward]:!1,[et.Forward]:!1}};function RF(e){let{delta:t,disabled:r}=e;const n=Bg(t);return Ji(s=>{if(r||!n||!s)return CF;const o={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[et.Backward]:s.x[et.Backward]||o.x===-1,[et.Forward]:s.x[et.Forward]||o.x===1},y:{[et.Backward]:s.y[et.Backward]||o.y===-1,[et.Forward]:s.y[et.Forward]||o.y===1}}},[r,t,n])}function TF(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Ji(s=>{var o;return t==null?null:(o=n??s)!=null?o:null},[n,t])}function IF(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:s}=n,o=s.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,n)}));return[...r,...o]},[]),[e,t])}var zi;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(zi||(zi={}));var Ug;(function(e){e.Optimized="optimized"})(Ug||(Ug={}));const oj=new Map;function MF(e,t){let{dragging:r,dependencies:n,config:s}=t;const[o,i]=m.useState(null),{frequency:a,measure:c,strategy:u}=s,d=m.useRef(e),f=_(),p=Oi(f),h=m.useCallback(function(g){g===void 0&&(g=[]),!p.current&&i(x=>x===null?g:x.concat(g.filter(b=>!x.includes(b))))},[p]),y=m.useRef(null),v=Ji(g=>{if(f&&!r)return oj;if(!g||g===oj||d.current!==e||o!=null){const x=new Map;for(let b of e){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){x.set(b.id,b.rect.current);continue}const w=b.node.current,j=w?new Ix(c(w),w):null;b.rect.current=j,j&&x.set(b.id,j)}return x}return g},[e,o,r,f,c]);return m.useEffect(()=>{d.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),m.useEffect(()=>{f||typeof a!="number"||y.current!==null||(y.current=setTimeout(()=>{h(),y.current=null},a))},[a,f,h,...n]),{droppableRects:v,measureDroppableContainers:h,measuringScheduled:o!=null};function _(){switch(u){case zi.Always:return!1;case zi.BeforeDragging:return r;default:return!r}}}function OC(e,t){return Ji(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function PF(e,t){return OC(e,t)}function AF(e){let{callback:t,disabled:r}=e;const n=Rx(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function $c(e){let{callback:t,disabled:r}=e;const n=Rx(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function DF(e){return new Ix(wo(e),e)}function ij(e,t,r){t===void 0&&(t=DF);const[n,s]=m.useState(null);function o(){s(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const i=AF({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){o();break}}}}),a=$c({callback:o});return Mr(()=>{o(),e?(a==null||a.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),i==null||i.disconnect())},[e]),n}function OF(e){const t=OC(e);return CC(e,t)}const aj=[];function LF(e){const t=m.useRef(e),r=Ji(n=>e?n&&n!==aj&&e&&t.current&&e.parentNode===t.current.parentNode?n:Lc(e):aj,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function zF(e){const[t,r]=m.useState(null),n=m.useRef(e),s=m.useCallback(o=>{const i=Em(o.target);i&&r(a=>a?(a.set(i,Wg(i)),new Map(a)):null)},[]);return m.useEffect(()=>{const o=n.current;if(e!==o){i(o);const a=e.map(c=>{const u=Em(c);return u?(u.addEventListener("scroll",s,{passive:!0}),[u,Wg(u)]):null}).filter(c=>c!=null);r(a.length?new Map(a):null),n.current=e}return()=>{i(e),i(o)};function i(a){a.forEach(c=>{const u=Em(c);u==null||u.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,i)=>Xs(o,i),mr):AC(e):mr,[e,t])}function lj(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==mr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?Li(e,r.current):mr}function qF(e){m.useEffect(()=>{if(!Oc)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function $F(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:s,handler:o}=n;return r[s]=i=>{o(i,t)},r},{}),[e,t])}function LC(e){return m.useMemo(()=>e?uF(e):null,[e])}const cj=[];function FF(e,t){t===void 0&&(t=wo);const[r]=e,n=LC(r?Tt(r):null),[s,o]=m.useState(cj);function i(){o(()=>e.length?e.map(c=>MC(c)?n:new Ix(t(c),c)):cj)}const a=$c({callback:i});return Mr(()=>{a==null||a.disconnect(),i(),e.forEach(c=>a==null?void 0:a.observe(c))},[e]),s}function BF(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Zi(t)?t:e}function HF(e){let{measure:t}=e;const[r,n]=m.useState(null),s=m.useCallback(u=>{for(const{target:d}of u)if(Zi(d)){n(f=>{const p=t(d);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),o=$c({callback:s}),i=m.useCallback(u=>{const d=BF(u);o==null||o.disconnect(),d&&(o==null||o.observe(d)),n(d?t(d):null)},[t,o]),[a,c]=$l(i);return m.useMemo(()=>({nodeRef:a,rect:r,setRef:c}),[r,a,c])}const WF=[{sensor:qc,options:{}},{sensor:zc,options:{}}],VF={current:{}},el={draggable:{measure:tj},droppable:{measure:tj,strategy:zi.WhileDragging,frequency:Ug.Optimized},dragOverlay:{measure:wo}};class ui extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const UF={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ui,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Fl},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:el,measureDroppableContainers:Fl,windowRect:null,measuringScheduled:!1},GF={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Fl,draggableNodes:new Map,over:null,measureDroppableContainers:Fl},Fc=m.createContext(GF),zC=m.createContext(UF);function KF(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ui}}}function YF(e,t){switch(t.type){case Ye.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ye.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ye.DragEnd:case Ye.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ye.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new ui(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case Ye.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;const i=new ui(e.droppable.containers);return i.set(r,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:i}}}case Ye.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new ui(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function XF(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:s}=m.useContext(Fc),o=Bg(n),i=Bg(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&o&&i!=null){if(!Tx(o)||document.activeElement===o.target)return;const a=s.get(i);if(!a)return;const{activatorNode:c,node:u}=a;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=W$(d);if(f){f.focus();break}}})}},[n,t,s,i,o]),null}function QF(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...n}),r):r}function ZF(e){return m.useMemo(()=>({draggable:{...el.draggable,...e==null?void 0:e.draggable},droppable:{...el.droppable,...e==null?void 0:e.droppable},dragOverlay:{...el.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function JF(e){let{activeNode:t,measure:r,initialRect:n,config:s=!0}=e;const o=m.useRef(!1),{x:i,y:a}=typeof s=="boolean"?{x:s,y:s}:s;Mr(()=>{if(!i&&!a||!t){o.current=!1;return}if(o.current||!n)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=CC(d,n);if(i||(f.x=0),a||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=RC(u);p&&p.scrollBy({top:f.y,left:f.x})}},[t,i,a,n,r])}const qC=m.createContext({...mr,scaleX:1,scaleY:1});var hn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(hn||(hn={}));const $C=m.memo(function(t){var r,n,s,o;let{id:i,accessibility:a,autoScroll:c=!0,children:u,sensors:d=WF,collisionDetection:f=nF,measuring:p,modifiers:h,...y}=t;const v=m.useReducer(YF,void 0,KF),[_,g]=v,[x,b]=X$(),[w,j]=m.useState(hn.Uninitialized),k=w===hn.Initialized,{draggable:{active:N,nodes:S,translate:C},droppable:{containers:R}}=_,T=N!=null?S.get(N):null,L=m.useRef({initial:null,translated:null}),q=m.useMemo(()=>{var Ue;return N!=null?{id:N,data:(Ue=T==null?void 0:T.data)!=null?Ue:VF,rect:L}:null},[N,T]),E=m.useRef(null),[D,A]=m.useState(null),[$,O]=m.useState(null),M=Oi(y,Object.values(y)),z=ea("DndDescribedBy",i),P=m.useMemo(()=>R.getEnabled(),[R]),I=ZF(p),{droppableRects:F,measureDroppableContainers:V,measuringScheduled:G}=MF(P,{dragging:k,dependencies:[C.x,C.y],config:I.droppable}),X=TF(S,N),te=m.useMemo(()=>$?Hg($):null,[$]),se=jo(),re=PF(X,I.draggable.measure);JF({activeNode:N!=null?S.get(N):null,config:se.layoutShiftCompensation,initialRect:re,measure:I.draggable.measure});const Q=ij(X,I.draggable.measure,re),xe=ij(X?X.parentElement:null),ne=m.useRef({activatorEvent:null,active:null,activeNode:X,collisionRect:null,collisions:null,droppableRects:F,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ye=R.getNodeFor((r=ne.current.over)==null?void 0:r.id),ee=HF({measure:I.dragOverlay.measure}),Y=(n=ee.nodeRef.current)!=null?n:X,pe=k?(s=ee.rect)!=null?s:Q:null,W=!!(ee.nodeRef.current&&ee.rect),K=OF(W?null:Q),ae=LC(Y?Tt(Y):null),ce=LF(k?ye??X:null),Se=FF(ce),be=QF(h,{transform:{x:C.x-K.x,y:C.y-K.y,scaleX:1,scaleY:1},activatorEvent:$,active:q,activeNodeRect:Q,containerNodeRect:xe,draggingNodeRect:pe,over:ne.current.over,overlayNodeRect:ee.rect,scrollableAncestors:ce,scrollableAncestorRects:Se,windowRect:ae}),le=te?Xs(te,C):null,H=zF(ce),Ce=lj(H),oe=lj(H,[Q]),nt=Xs(be,Ce),He=pe?iF(pe,be):null,ht=q&&He?f({active:q,collisionRect:He,droppableRects:F,droppableContainers:P,pointerCoordinates:le}):null,rr=NC(ht,"id"),[ke,st]=m.useState(null),Qe=W?be:Xs(be,oe),ot=sF(Qe,(o=ke==null?void 0:ke.rect)!=null?o:null,Q),nr=m.useRef(null),$t=m.useCallback((Ue,Fe)=>{let{sensor:mt,options:yr}=Fe;if(E.current==null)return;const wt=S.get(E.current);if(!wt)return;const gt=Ue.nativeEvent,Bt=new mt({active:E.current,activeNode:wt,event:gt,options:yr,context:ne,onAbort(Ge){if(!S.get(Ge))return;const{onDragAbort:Ht}=M.current,sr={id:Ge};Ht==null||Ht(sr),x({type:"onDragAbort",event:sr})},onPending(Ge,br,Ht,sr){if(!S.get(Ge))return;const{onDragPending:Bn}=M.current,wr={id:Ge,constraint:br,initialCoordinates:Ht,offset:sr};Bn==null||Bn(wr),x({type:"onDragPending",event:wr})},onStart(Ge){const br=E.current;if(br==null)return;const Ht=S.get(br);if(!Ht)return;const{onDragStart:sr}=M.current,Fn={activatorEvent:gt,active:{id:br,data:Ht.data,rect:L}};qs.unstable_batchedUpdates(()=>{sr==null||sr(Fn),j(hn.Initializing),g({type:Ye.DragStart,initialCoordinates:Ge,active:br}),x({type:"onDragStart",event:Fn}),A(nr.current),O(gt)})},onMove(Ge){g({type:Ye.DragMove,coordinates:Ge})},onEnd:on(Ye.DragEnd),onCancel:on(Ye.DragCancel)});nr.current=Bt;function on(Ge){return async function(){const{active:Ht,collisions:sr,over:Fn,scrollAdjustedTranslate:Bn}=ne.current;let wr=null;if(Ht&&Bn){const{cancelDrop:Hn}=M.current;wr={activatorEvent:gt,active:Ht,collisions:sr,delta:Bn,over:Fn},Ge===Ye.DragEnd&&typeof Hn=="function"&&await Promise.resolve(Hn(wr))&&(Ge=Ye.DragCancel)}E.current=null,qs.unstable_batchedUpdates(()=>{g({type:Ge}),j(hn.Uninitialized),st(null),A(null),O(null),nr.current=null;const Hn=Ge===Ye.DragEnd?"onDragEnd":"onDragCancel";if(wr){const So=M.current[Hn];So==null||So(wr),x({type:Hn,event:wr})}})}}},[S]),Ft=m.useCallback((Ue,Fe)=>(mt,yr)=>{const wt=mt.nativeEvent,gt=S.get(yr);if(E.current!==null||!gt||wt.dndKit||wt.defaultPrevented)return;const Bt={active:gt};Ue(mt,Fe.options,Bt)===!0&&(wt.dndKit={capturedBy:Fe.sensor},E.current=yr,$t(mt,Fe))},[S,$t]),sn=IF(d,Ft);qF(d),Mr(()=>{Q&&w===hn.Initializing&&j(hn.Initialized)},[Q,w]),m.useEffect(()=>{const{onDragMove:Ue}=M.current,{active:Fe,activatorEvent:mt,collisions:yr,over:wt}=ne.current;if(!Fe||!mt)return;const gt={active:Fe,activatorEvent:mt,collisions:yr,delta:{x:nt.x,y:nt.y},over:wt};qs.unstable_batchedUpdates(()=>{Ue==null||Ue(gt),x({type:"onDragMove",event:gt})})},[nt.x,nt.y]),m.useEffect(()=>{const{active:Ue,activatorEvent:Fe,collisions:mt,droppableContainers:yr,scrollAdjustedTranslate:wt}=ne.current;if(!Ue||E.current==null||!Fe||!wt)return;const{onDragOver:gt}=M.current,Bt=yr.get(rr),on=Bt&&Bt.rect.current?{id:Bt.id,rect:Bt.rect.current,data:Bt.data,disabled:Bt.disabled}:null,Ge={active:Ue,activatorEvent:Fe,collisions:mt,delta:{x:wt.x,y:wt.y},over:on};qs.unstable_batchedUpdates(()=>{st(on),gt==null||gt(Ge),x({type:"onDragOver",event:Ge})})},[rr]),Mr(()=>{ne.current={activatorEvent:$,active:q,activeNode:X,collisionRect:He,collisions:ht,droppableRects:F,draggableNodes:S,draggingNode:Y,draggingNodeRect:pe,droppableContainers:R,over:ke,scrollableAncestors:ce,scrollAdjustedTranslate:nt},L.current={initial:pe,translated:He}},[q,X,ht,He,S,Y,pe,F,R,ke,ce,nt]),EF({...se,delta:C,draggingRect:He,pointerCoordinates:le,scrollableAncestors:ce,scrollableAncestorRects:Se});const _o=m.useMemo(()=>({active:q,activeNode:X,activeNodeRect:Q,activatorEvent:$,collisions:ht,containerNodeRect:xe,dragOverlay:ee,draggableNodes:S,droppableContainers:R,droppableRects:F,over:ke,measureDroppableContainers:V,scrollableAncestors:ce,scrollableAncestorRects:Se,measuringConfiguration:I,measuringScheduled:G,windowRect:ae}),[q,X,Q,$,ht,xe,ee,S,R,F,ke,V,ce,Se,I,G,ae]),$n=m.useMemo(()=>({activatorEvent:$,activators:sn,active:q,activeNodeRect:Q,ariaDescribedById:{draggable:z},dispatch:g,draggableNodes:S,over:ke,measureDroppableContainers:V}),[$,sn,q,Q,g,z,S,ke,V]);return B.createElement(_C.Provider,{value:b},B.createElement(Fc.Provider,{value:$n},B.createElement(zC.Provider,{value:_o},B.createElement(qC.Provider,{value:ot},u)),B.createElement(XF,{disabled:(a==null?void 0:a.restoreFocus)===!1})),B.createElement(J$,{...a,hiddenTextDescribedById:z}));function jo(){const Ue=(D==null?void 0:D.autoScrollEnabled)===!1,Fe=typeof c=="object"?c.enabled===!1:c===!1,mt=k&&!Ue&&!Fe;return typeof c=="object"?{...c,enabled:mt}:{enabled:mt}}}),eB=m.createContext(null),uj="button",tB="Draggable";function rB(e){let{id:t,data:r,disabled:n=!1,attributes:s}=e;const o=ea(tB),{activators:i,activatorEvent:a,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:p}=m.useContext(Fc),{role:h=uj,roleDescription:y="draggable",tabIndex:v=0}=s??{},_=(c==null?void 0:c.id)===t,g=m.useContext(_?qC:eB),[x,b]=$l(),[w,j]=$l(),k=$F(i,t),N=Oi(r);Mr(()=>(f.set(t,{id:t,key:o,node:x,activatorNode:w,data:N}),()=>{const C=f.get(t);C&&C.key===o&&f.delete(t)}),[f,t]);const S=m.useMemo(()=>({role:h,tabIndex:v,"aria-disabled":n,"aria-pressed":_&&h===uj?!0:void 0,"aria-roledescription":y,"aria-describedby":d.draggable}),[n,h,v,_,y,d.draggable]);return{active:c,activatorEvent:a,activeNodeRect:u,attributes:S,isDragging:_,listeners:n?void 0:k,node:x,over:p,setNodeRef:b,setActivatorNodeRef:j,transform:g}}function nB(){return m.useContext(zC)}const sB="Droppable",oB={timeout:25};function iB(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:s}=e;const o=ea(sB),{active:i,dispatch:a,over:c,measureDroppableContainers:u}=m.useContext(Fc),d=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:_}={...oB,...s},g=Oi(v??n),x=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{u(Array.isArray(g.current)?g.current:[g.current]),h.current=null},_)},[_]),b=$c({callback:x,disabled:y||!i}),w=m.useCallback((S,C)=>{b&&(C&&(b.unobserve(C),f.current=!1),S&&b.observe(S))},[b]),[j,k]=$l(w),N=Oi(t);return m.useEffect(()=>{!b||!j.current||(b.disconnect(),f.current=!1,b.observe(j.current))},[j,b]),m.useEffect(()=>(a({type:Ye.RegisterDroppable,element:{id:n,key:o,disabled:r,node:j,rect:p,data:N}}),()=>a({type:Ye.UnregisterDroppable,key:o,id:n})),[n]),m.useEffect(()=>{r!==d.current.disabled&&(a({type:Ye.SetDroppableDisabled,id:n,key:o,disabled:r}),d.current.disabled=r)},[n,o,r,a]),{active:i,rect:p,isOver:(c==null?void 0:c.id)===n,node:j,over:c,setNodeRef:k}}function Bc(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function aB(e,t){return e.reduce((r,n,s)=>{const o=t.get(n);return o&&(r[s]=o),r},Array(e.length))}function Oa(e){return e!==null&&e>=0}function lB(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function cB(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const FC=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const o=Bc(t,n,r),i=t[s],a=o[s];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},La={scaleX:1,scaleY:1},BC=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:o,overIndex:i}=e;const a=(t=o[r])!=null?t:n;if(!a)return null;if(s===r){const u=o[i];return u?{x:0,y:r<i?u.top+u.height-(a.top+a.height):u.top-a.top,...La}:null}const c=uB(o,s,r);return s>r&&s<=i?{x:0,y:-a.height-c,...La}:s<r&&s>=i?{x:0,y:a.height+c,...La}:{x:0,y:0,...La}};function uB(e,t,r){const n=e[t],s=e[t-1],o=e[t+1];return n?r<t?s?n.top-(s.top+s.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):s?n.top-(s.top+s.height):0:0}const HC="Sortable",WC=B.createContext({activeIndex:-1,containerId:HC,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:FC,disabled:{draggable:!1,droppable:!1}});function VC(e){let{children:t,id:r,items:n,strategy:s=FC,disabled:o=!1}=e;const{active:i,dragOverlay:a,droppableRects:c,over:u,measureDroppableContainers:d}=nB(),f=ea(HC,r),p=a.rect!==null,h=m.useMemo(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),y=i!=null,v=i?h.indexOf(i.id):-1,_=u?h.indexOf(u.id):-1,g=m.useRef(h),x=!lB(h,g.current),b=_!==-1&&v===-1||x,w=cB(o);Mr(()=>{x&&y&&d(h)},[x,h,y,d]),m.useEffect(()=>{g.current=h},[h]);const j=m.useMemo(()=>({activeIndex:v,containerId:f,disabled:w,disableTransforms:b,items:h,overIndex:_,useDragOverlay:p,sortedRects:aB(h,c),strategy:s}),[v,f,w.draggable,w.droppable,b,h,_,c,p,s]);return B.createElement(WC.Provider,{value:j},t)}const dB=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return Bc(r,n,s).indexOf(t)},fB=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:o,newIndex:i,previousItems:a,previousContainerId:c,transition:u}=e;return!u||!n||a!==o&&s===i?!1:r?!0:i!==s&&t===c},pB={duration:200,easing:"ease"},UC="transform",hB=lo.Transition.toString({property:UC,duration:0,easing:"linear"}),mB={roleDescription:"sortable"};function gB(e){let{disabled:t,index:r,node:n,rect:s}=e;const[o,i]=m.useState(null),a=m.useRef(r);return Mr(()=>{if(!t&&r!==a.current&&n.current){const c=s.current;if(c){const u=wo(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&i(d)}}r!==a.current&&(a.current=r)},[t,r,n,s]),m.useEffect(()=>{o&&i(null)},[o]),o}function GC(e){let{animateLayoutChanges:t=fB,attributes:r,disabled:n,data:s,getNewIndex:o=dB,id:i,strategy:a,resizeObserverConfig:c,transition:u=pB}=e;const{items:d,containerId:f,activeIndex:p,disabled:h,disableTransforms:y,sortedRects:v,overIndex:_,useDragOverlay:g,strategy:x}=m.useContext(WC),b=vB(n,h),w=d.indexOf(i),j=m.useMemo(()=>({sortable:{containerId:f,index:w,items:d},...s}),[f,s,w,d]),k=m.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:N,node:S,isOver:C,setNodeRef:R}=iB({id:i,data:j,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:T,activatorEvent:L,activeNodeRect:q,attributes:E,setNodeRef:D,listeners:A,isDragging:$,over:O,setActivatorNodeRef:M,transform:z}=rB({id:i,data:j,attributes:{...mB,...r},disabled:b.draggable}),P=$$(R,D),I=!!T,F=I&&!y&&Oa(p)&&Oa(_),V=!g&&$,G=V&&F?z:null,te=F?G??(a??x)({rects:v,activeNodeRect:q,activeIndex:p,overIndex:_,index:w}):null,se=Oa(p)&&Oa(_)?o({id:i,items:d,activeIndex:p,overIndex:_}):w,re=T==null?void 0:T.id,Q=m.useRef({activeId:re,items:d,newIndex:se,containerId:f}),xe=d!==Q.current.items,ne=t({active:T,containerId:f,isDragging:$,isSorting:I,id:i,index:w,items:d,newIndex:Q.current.newIndex,previousItems:Q.current.items,previousContainerId:Q.current.containerId,transition:u,wasDragging:Q.current.activeId!=null}),ye=gB({disabled:!ne,index:w,node:S,rect:N});return m.useEffect(()=>{I&&Q.current.newIndex!==se&&(Q.current.newIndex=se),f!==Q.current.containerId&&(Q.current.containerId=f),d!==Q.current.items&&(Q.current.items=d)},[I,se,f,d]),m.useEffect(()=>{if(re===Q.current.activeId)return;if(re!=null&&Q.current.activeId==null){Q.current.activeId=re;return}const Y=setTimeout(()=>{Q.current.activeId=re},50);return()=>clearTimeout(Y)},[re]),{active:T,activeIndex:p,attributes:E,data:j,rect:N,index:w,newIndex:se,items:d,isOver:C,isSorting:I,isDragging:$,listeners:A,node:S,overIndex:_,over:O,setNodeRef:P,setActivatorNodeRef:M,setDroppableNodeRef:R,setDraggableNodeRef:D,transform:ye??te,transition:ee()};function ee(){if(ye||xe&&Q.current.newIndex===w)return hB;if(!(V&&!Tx(L)||!u)&&(I||ne))return lo.Transition.toString({...u,property:UC})}}function vB(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Wl(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const xB=[me.Down,me.Right,me.Up,me.Left],KC=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:o,over:i,scrollableAncestors:a}}=t;if(xB.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];o.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=s.get(f.id);if(p)switch(e.code){case me.Down:n.top<p.top&&c.push(f);break;case me.Up:n.top>p.top&&c.push(f);break;case me.Left:n.left>p.left&&c.push(f);break;case me.Right:n.left<p.left&&c.push(f);break}});const u=tF({collisionRect:n,droppableRects:s,droppableContainers:c});let d=NC(u,"id");if(d===(i==null?void 0:i.id)&&u.length>1&&(d=u[1].id),d!=null){const f=o.get(r.id),p=o.get(d),h=p?s.get(p.id):null,y=p==null?void 0:p.node.current;if(y&&h&&f&&p){const _=Lc(y).some((k,N)=>a[N]!==k),g=YC(f,p),x=yB(f,p),b=_||!g?{x:0,y:0}:{x:x?n.width-h.width:0,y:x?n.height-h.height:0},w={x:h.left,y:h.top};return b.x&&b.y?w:Li(w,b)}}}};function YC(e,t){return!Wl(e)||!Wl(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function yB(e,t){return!Wl(e)||!Wl(t)||!YC(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const bB={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Sr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},Wt={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},XC={step_id:"new_step",produces:"",scope:"",inputs:[]},wB={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function _B({workspaceId:e,workflow:t,onArtifactSave:r,onDelete:n,onNavigateToWorkflow:s}){const[o,i]=m.useState("steps"),[a,c]=m.useState(""),[u,d]=m.useState(null),f=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:p,loading:h,error:y,saving:v,updateWorkflow:_}=yC(e,f,{onSave:S=>{r==null||r(f,S)}}),g=m.useCallback(S=>{S==="json"&&p&&(c(JSON.stringify(p,null,2)),d(null)),i(S)},[p]),x=m.useCallback(S=>{const C=S.target.value;c(C);try{const R=JSON.parse(C);d(null),_(R)}catch(R){d(R.message)}},[_]),b=m.useCallback((S,C)=>{if(!p)return;const R=[...p.steps];R[S]=C,_({...p,steps:R})},[p,_]),w=m.useCallback(S=>{if(!p)return;const C=p.steps.filter((R,T)=>T!==S);_({...p,steps:C})},[p,_]),j=m.useCallback(S=>{var R,T;if(!p)return;const C=S==="iteration"?{...wB,step_id:`new_iteration_${(((R=p.steps)==null?void 0:R.length)||0)+1}`}:{...XC,step_id:`new_step_${(((T=p.steps)==null?void 0:T.length)||0)+1}`};_({...p,steps:[...p.steps||[],C]})},[p,_]),k=m.useCallback((S,C)=>{if(!p)return;const R=Bc(p.steps,S,C);_({...p,steps:R})},[p,_]),N=m.useCallback(()=>{!n||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&n(t.workflow_id)},[n,t]);return t?l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(p==null?void 0:p.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())}),((p==null?void 0:p.pow_class)||t.pow_class)&&l.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(p==null?void 0:p.pow_class)||t.pow_class})]}),l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(p==null?void 0:p.description)&&`  ${p.description}`]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[v&&l.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),y&&l.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:y}),n&&l.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),l.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(S=>l.jsx("button",{onClick:()=>g(S.id),style:{...bB,color:o===S.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===S.id?"2px solid var(--action-primary)":"2px solid transparent"},children:S.label},S.id))}),h?l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):l.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&l.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[l.jsx(jB,{steps:(p==null?void 0:p.steps)||[],onStepChange:b,onStepDelete:w,onReorder:k}),l.jsxs("div",{className:"flex gap-2 mt-3",children:[l.jsx("button",{onClick:()=>j("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),l.jsx("button",{onClick:()=>j("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&l.jsxs("div",{className:"h-full flex flex-col p-4",children:[l.jsx("textarea",{value:a,onChange:x,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&l.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),o==="metadata"&&l.jsx("div",{className:"h-full overflow-y-auto p-4",children:p?l.jsx(EB,{workflow:p,onUpdateWorkflow:_,onNavigateToWorkflow:s}):l.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),l.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function jB({steps:e,onStepChange:t,onStepDelete:r,onReorder:n}){const s=jC(Bl(qc,{activationConstraint:{distance:5}}),Bl(zc,{coordinateGetter:KC})),o=m.useMemo(()=>e.map(a=>a.step_id),[e]),i=m.useCallback(a=>{const{active:c,over:u}=a;if(!u||c.id===u.id)return;const d=e.findIndex(p=>p.step_id===c.id),f=e.findIndex(p=>p.step_id===u.id);d!==-1&&f!==-1&&n(d,f)},[e,n]);return e.length===0?l.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):l.jsx($C,{sensors:s,collisionDetection:EC,onDragEnd:i,children:l.jsx(VC,{items:o,strategy:BC,children:e.map((a,c)=>l.jsx(SB,{step:a,index:c,onChange:t,onDelete:r},a.step_id))})})}function SB({step:e,index:t,onChange:r,onDelete:n}){const{attributes:s,listeners:o,setNodeRef:i,transform:a,transition:c,isDragging:u}=GC({id:e.step_id}),d={transform:lo.Transform.toString(a),transition:c,opacity:u?.5:1};return l.jsx("div",{ref:i,style:d,children:l.jsx(QC,{step:e,index:t,onChange:r,onDelete:n,dragHandleProps:{...s,...o}})})}function QC({step:e,index:t,onChange:r,onDelete:n,dragHandleProps:s,depth:o=0}){var j,k,N;const[i,a]=m.useState(e),[c,u]=m.useState(!0);m.useEffect(()=>{a(e)},[e]);const d=!!i.iterate_over,f=(S,C)=>{const R={...i,[S]:C};a(R),r(t,R)},p=(S,C)=>{const R={...i.iterate_over,[S]:C},T={...i,iterate_over:R};a(T),r(t,T)},h=()=>{const S=[...i.inputs||[],{doc_type:"",scope:""}],C={...i,inputs:S};a(C),r(t,C)},y=(S,C,R)=>{const T=[...i.inputs||[]];T[S]={...T[S],[C]:R};const L={...i,inputs:T};a(L),r(t,L)},v=S=>{const C=(i.inputs||[]).filter((T,L)=>L!==S),R={...i,inputs:C};a(R),r(t,R)},_=m.useCallback((S,C)=>{const R=[...i.steps||[]];R[S]=C;const T={...i,steps:R};a(T),r(t,T)},[i,t,r]),g=m.useCallback(S=>{const C=(i.steps||[]).filter((T,L)=>L!==S),R={...i,steps:C};a(R),r(t,R)},[i,t,r]),x=m.useCallback(()=>{var R;const S=[...i.steps||[],{...XC,step_id:`nested_step_${(((R=i.steps)==null?void 0:R.length)||0)+1}`}],C={...i,steps:S};a(C),r(t,C)},[i,t,r]),b=m.useCallback((S,C)=>{const R=Bc(i.steps||[],S,C),T={...i,steps:R};a(T),r(t,T)},[i,t,r]),w={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:d?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return l.jsxs("div",{style:w,children:[l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:c?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:c?"6px 6px 0 0":6},children:[s&&l.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:l.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),l.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),l.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),l.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:d?"var(--action-primary)":"var(--bg-canvas)",color:d?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:d?"ITER":"STEP"}),l.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:i.step_id}),l.jsx("span",{style:{flex:1}}),l.jsx("button",{onClick:()=>u(!c),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:c?"Collapse":"Expand",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c?l.jsx("path",{d:"M18 15l-6-6-6 6"}):l.jsx("path",{d:"M6 9l6 6 6-6"})})}),l.jsx("button",{onClick:()=>n(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),c&&l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Step ID"}),l.jsx("input",{type:"text",value:i.step_id||"",onChange:S=>f("step_id",S.target.value),style:Sr})]}),d?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Doc Type"}),l.jsx("input",{type:"text",value:((j=i.iterate_over)==null?void 0:j.doc_type)||"",onChange:S=>p("doc_type",S.target.value),style:Sr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Collection Field"}),l.jsx("input",{type:"text",value:((k=i.iterate_over)==null?void 0:k.collection_field)||"",onChange:S=>p("collection_field",S.target.value),style:Sr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Entity Type"}),l.jsx("input",{type:"text",value:((N=i.iterate_over)==null?void 0:N.entity_type)||"",onChange:S=>p("entity_type",S.target.value),style:Sr})]})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Scope"}),l.jsx("input",{type:"text",value:i.scope||"",onChange:S=>f("scope",S.target.value),style:Sr})]}),l.jsxs("div",{className:"mt-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{style:Wt,children:"Nested Steps"}),l.jsx("button",{onClick:x,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),l.jsx(kB,{steps:i.steps||[],onStepChange:_,onStepDelete:g,onReorder:b})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Produces"}),l.jsx("input",{type:"text",value:i.produces||"",onChange:S=>f("produces",S.target.value),placeholder:"document_type (e.g., project_discovery)",style:Sr})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Scope"}),l.jsx("input",{type:"text",value:i.scope||"",onChange:S=>f("scope",S.target.value),placeholder:"project",style:Sr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Creates Entities"}),l.jsx("input",{type:"text",value:i.creates_entities||"",onChange:S=>f("creates_entities",S.target.value||void 0),placeholder:"e.g., epic",style:Sr})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:Wt,children:"Inputs"}),l.jsx("button",{onClick:h,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(i.inputs||[]).length===0?l.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):l.jsx("div",{className:"space-y-1",children:(i.inputs||[]).map((S,C)=>l.jsxs("div",{className:"flex gap-1 items-end",children:[l.jsxs("div",{style:{flex:1},children:[C===0&&l.jsx("label",{style:{...Wt,fontSize:9},children:"Doc/Entity Type"}),l.jsx("input",{type:"text",value:S.doc_type||S.entity_type||"",onChange:R=>{const T=R.target.value;S.entity_type!==void 0?y(C,"entity_type",T):y(C,"doc_type",T)},placeholder:"doc_type",style:{...Sr,fontSize:11}})]}),l.jsxs("div",{style:{width:"30%"},children:[C===0&&l.jsx("label",{style:{...Wt,fontSize:9},children:"Scope"}),l.jsx("input",{type:"text",value:S.scope||"",onChange:R=>y(C,"scope",R.target.value),placeholder:"scope",style:{...Sr,fontSize:11}})]}),l.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[l.jsx("input",{type:"checkbox",checked:S.context||!1,onChange:R=>y(C,"context",R.target.checked||void 0)}),"ctx"]}),l.jsx("button",{onClick:()=>v(C),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},C))})]})]})]})]})}function kB({steps:e,onStepChange:t,onStepDelete:r,onReorder:n}){const s=jC(Bl(qc,{activationConstraint:{distance:5}}),Bl(zc,{coordinateGetter:KC})),o=m.useMemo(()=>e.map(a=>a.step_id),[e]),i=m.useCallback(a=>{const{active:c,over:u}=a;if(!u||c.id===u.id)return;const d=e.findIndex(p=>p.step_id===c.id),f=e.findIndex(p=>p.step_id===u.id);d!==-1&&f!==-1&&n(d,f)},[e,n]);return e.length===0?l.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):l.jsx($C,{sensors:s,collisionDetection:EC,onDragEnd:i,children:l.jsx(VC,{items:o,strategy:BC,children:e.map((a,c)=>l.jsx(NB,{step:a,index:c,onChange:t,onDelete:r},a.step_id))})})}function NB({step:e,index:t,onChange:r,onDelete:n}){const{attributes:s,listeners:o,setNodeRef:i,transform:a,transition:c,isDragging:u}=GC({id:e.step_id}),d={transform:lo.Transform.toString(a),transition:c,opacity:u?.5:1};return l.jsx("div",{ref:i,style:d,children:l.jsx(QC,{step:e,index:t,onChange:r,onDelete:n,dragHandleProps:{...s,...o},depth:1})})}function EB({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,s]=m.useState(""),o={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},i={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},a=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},u=Object.entries(c),d=e.document_types||{},f=Object.entries(d),p=e.pow_class||"reference",h=e.derived_from,y=e.source_version,v=e.tags||[],_=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||v.includes(b)||(t==null||t({...e,tags:[...v,b]}),s(""))},g=b=>{t==null||t({...e,tags:v.filter(w=>w!==b)})},x=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return l.jsxs("div",{className:"space-y-4 max-w-lg",children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),l.jsxs("div",{children:[l.jsx("label",{style:i,children:"POW Class"}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&l.jsxs("div",{children:[l.jsx("label",{style:i,children:"Derived From"}),l.jsx("div",{style:o,children:r?l.jsxs("button",{onClick:x,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):l.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),y&&l.jsxs("div",{children:[l.jsx("label",{style:i,children:"Source Version"}),l.jsx("div",{style:o,children:y})]}),l.jsxs("div",{children:[l.jsx("label",{style:i,children:"Tags"}),l.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[v.length===0&&l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),v.map(b=>l.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&l.jsx("button",{onClick:()=>g(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"text",value:n,onChange:b=>s(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),_())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),l.jsx("button",{onClick:_,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),a.map(b=>l.jsxs("div",{children:[l.jsx("label",{style:i,children:b.label}),l.jsx("div",{style:o,children:e[b.key]||"-"})]},b.key)),u.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),u.map(([b,w])=>l.jsxs("div",{children:[l.jsx("label",{style:i,children:b}),l.jsxs("div",{style:o,children:["parent: ",w.parent||"none"]})]},b))]}),f.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,w])=>l.jsxs("div",{children:[l.jsx("label",{style:i,children:b}),l.jsxs("div",{style:o,children:[w.name,w.scope&&` (${w.scope})`,w.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function dj({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(s=>s.status==="fail"),n=e.filter(s=>s.status==="pass");return t?l.jsx("div",{className:"flex items-center gap-2",children:r.length>0?l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):l.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):l.jsxs("div",{className:"space-y-2",children:[r.map((s,o)=>l.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[l.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[l.jsx("span",{className:"text-red-400",children:"FAIL"}),l.jsx("span",{className:"font-mono",children:s.rule_id})]}),s.message&&l.jsx("div",{className:"mt-1 opacity-80",children:s.message}),s.artifact_id&&l.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:s.artifact_id})]},o)),n.length>0&&r.length>0&&l.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function CB(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),s=[];let o=0,i=0;for(;o<r.length||i<n.length;)if(o>=r.length)s.push({type:"added",line:n[i],lineNum:i+1}),i++;else if(i>=n.length)s.push({type:"removed",line:r[o],lineNum:o+1}),o++;else if(r[o]===n[i])s.push({type:"same",line:r[o],oldLineNum:o+1,newLineNum:i+1}),o++,i++;else{let a=n.slice(i,i+5).indexOf(r[o]),c=r.slice(o,o+5).indexOf(n[i]);if(a!==-1&&(c===-1||a<=c)){for(let u=0;u<a;u++)s.push({type:"added",line:n[i+u],lineNum:i+u+1});i+=a}else if(c!==-1){for(let u=0;u<c;u++)s.push({type:"removed",line:r[o+u],lineNum:o+u+1});o+=c}else s.push({type:"removed",line:r[o],lineNum:o+1}),s.push({type:"added",line:n[i],lineNum:i+1}),o++,i++}return s}function RB({diff:e}){const[t,r]=m.useState(!0),n=CB(e.old_content,e.new_content),s={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return l.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:s[e.status]||s.M,children:e.status}),l.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),l.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&l.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:l.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((o,i)=>l.jsxs("div",{className:"flex",style:{background:o.type==="added"?"rgba(34, 197, 94, 0.1)":o.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:o.type==="added"?"3px solid #22c55e":o.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[l.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:o.type==="same"?o.oldLineNum:o.lineNum||""}),l.jsx("span",{className:"select-none px-1",style:{color:o.type==="added"?"#22c55e":o.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:o.type==="added"?"+":o.type==="removed"?"-":" "}),l.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:o.line})]},i))})})]})}function TB({workspaceId:e,artifactId:t=null,onClose:r}){const[n,s]=m.useState([]),[o,i]=m.useState(!0),[a,c]=m.useState(null);m.useEffect(()=>{e&&(i(!0),c(null),Ee.getDiff(e,t).then(d=>{s(d.diffs||[])}).catch(d=>{c(d.message)}).finally(()=>{i(!1)}))},[e,t]);const u=d=>{d.key==="Escape"&&(r==null||r())};return l.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:d=>d.target===d.currentTarget&&(r==null?void 0:r()),onKeyDown:u,tabIndex:0,children:l.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),l.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o?l.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):a?l.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",a]}):n.length===0?l.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((d,f)=>l.jsx(RB,{diff:d},d.artifact_id||f))}),l.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function IB(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,s,o]=t,i=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),a=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:s,kind:o,displayName:i,kindLabel:a,display:`${i} - ${a}`}}function MB(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=IB(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function PB({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:s=[],modifiedFiles:o=[]}){const[i,a]=m.useState(""),[c,u]=m.useState(!1),d=MB(s),f=s.length,p=y=>{y.preventDefault(),i.trim()&&!n&&t(i.trim())},h=y=>{y.key==="Escape"&&!n&&r()};return l.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:y=>y.target===y.currentTarget&&!n&&r(),onKeyDown:h,children:[l.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&l.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),l.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:d.map(y=>l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:y.label}),l.jsx("div",{className:"space-y-1",children:y.items.map((v,_)=>l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),l.jsx("span",{style:{color:"var(--text-primary)"},children:v.displayName}),l.jsx("span",{style:{color:"var(--text-muted)"},children:v.kindLabel}),l.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",v.version]})]},_))})]},y.scope))}),l.jsx("button",{type:"button",onClick:()=>u(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),l.jsxs("form",{onSubmit:p,children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),l.jsx("textarea",{value:i,onChange:y=>a(y.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),l.jsx("button",{type:"submit",disabled:!i.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:i.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:i.trim()&&!n?"#000":"var(--text-muted)",cursor:i.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&l.jsx(TB,{workspaceId:e,onClose:()=>u(!1)})]})}function AB(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,s,o]=t,i=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),a=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:i,kind:o,kindLabel:a,version:s,display:`${i} - ${a}`}}function DB({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:s,onClose:o,onRefresh:i}){var C,R;const[a,c]=m.useState(!1),[u,d]=m.useState(!1),[f,p]=m.useState(!1),[h,y]=m.useState(null),v=(t==null?void 0:t.is_dirty)??!1,_=(t==null?void 0:t.modified_artifacts)??[],g=((C=t==null?void 0:t.tier1)==null?void 0:C.passed)??!0,x=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",w=t!=null&&t.expires_at?new Date(t.expires_at):null,j=async T=>{d(!0),y(null);try{const L=await Ee.commit(e,T);c(!1),n==null||n(L),i==null||i()}catch(L){y(L.message)}finally{d(!1)}},k=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await Ee.discard(e),s==null||s(),i==null||i()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},N=async()=>{if(v){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await Ee.closeWorkspace(e),o==null||o()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},S=T=>{if(!T)return null;const q=T-new Date;if(q<=0)return"Expired";const E=Math.floor(q/(1e3*60*60)),D=Math.floor(q%(1e3*60*60)/(1e3*60));return E>0?`${E}h ${D}m remaining`:`${D}m remaining`};return l.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:l.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?l.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),l.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),w&&l.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:S(w)})]}),l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),l.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:v?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:v?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:v?"Modified":"Clean"})]}),_.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",_.length,")"]}),l.jsx("div",{className:"space-y-1",children:_.map(T=>{const L=AB(T);return l.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[l.jsx("span",{style:{color:"var(--text-primary)"},children:L.displayName||T}),L.kindLabel&&l.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",L.kindLabel]})]},T)})})]})]}),l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),l.jsx(dj,{results:x,compact:!0})]}),x.length>0&&!g&&l.jsx("div",{className:"mt-3",children:l.jsx(dj,{results:x})})]})]}),l.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[l.jsx("button",{onClick:()=>c(!0),disabled:!v||!g||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:v&&g?"var(--action-success)":"var(--border-panel)",color:v&&g?"#000":"var(--text-muted)",cursor:v&&g&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!g&&v&&l.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),v&&l.jsx("button",{onClick:k,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!v&&l.jsx("button",{onClick:N,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),a&&l.jsx(PB,{workspaceId:e,onCommit:j,onCancel:()=>{c(!1),y(null)},loading:u,modifiedArtifacts:_,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&l.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function OB(){const{isAdmin:e,loading:t}=xo(),[r,n]=m.useState(null),[s,o]=m.useState(null),[i,a]=m.useState(!1),[c,u]=m.useState(null),[d,f]=m.useState(null),[p,h]=m.useState(null),[y,v]=m.useState(null),[_,g]=m.useState(null),{workspaceId:x,loading:b,error:w,reinitialize:j}=qq(),{state:k,loading:N,refresh:S}=$q(x),{documentTypes:C,loading:R}=Fq(),{roles:T,loading:L}=Bq(),{templates:q,loading:E}=f$(),{workflows:D,loading:A,refresh:$}=p$(),O=m.useCallback(async(ee,Y=null,pe="docworkflow")=>{if(n(ee),u(null),f(null),h(null),o(null),v(Y),g(pe),!!ee){a(!0);try{const W=await Ee.getDocumentType(ee.doc_type_id);o(W)}catch(W){console.error("Failed to load doc type details:",W),o(ee)}finally{a(!1)}}},[]),M=m.useCallback(ee=>{O(ee,"task_prompt","task")},[O]),z=m.useCallback(ee=>{O(ee,"schema","schema")},[O]),P=m.useCallback(ee=>{u(ee),n(null),o(null),f(null),h(null)},[]),I=m.useCallback(ee=>{f(ee),n(null),o(null),u(null),h(null)},[]),F=m.useCallback(ee=>{h(ee),n(null),o(null),u(null),f(null)},[]),V=m.useCallback(ee=>{const Y=D.find(pe=>pe.workflow_id===ee);Y&&F(Y)},[D,F]),G=m.useCallback((ee,Y)=>{S()},[S]),X=m.useCallback(ee=>{console.log("Committed:",ee.commit_hash)},[]),te=m.useCallback(()=>{n(null),o(null),u(null),f(null),h(null)},[]),se=m.useCallback(async ee=>{if(x)try{const Y=await Ee.createOrchestrationWorkflow(x,ee);await $(),S(),h({workflow_id:Y.workflow_id,active_version:Y.version,name:ee.name||Y.workflow_id.replace(/_/g," ").replace(/\b\w/g,pe=>pe.toUpperCase())}),n(null),o(null),u(null),f(null)}catch(Y){console.error("Failed to create workflow:",Y),alert(`Failed to create workflow: ${Y.message}`)}},[x,$,S]),re=m.useCallback(async ee=>{if(x)try{await Ee.deleteOrchestrationWorkflow(x,ee),await $(),S(),h(null)}catch(Y){console.error("Failed to delete workflow:",Y),alert(`Failed to delete workflow: ${Y.message}`)}},[x,$,S]),Q=m.useCallback(()=>{j(),n(null),o(null),u(null),f(null),h(null)},[j]);if(t)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),l.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(b)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),l.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(w)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),l.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:w}),l.jsx("button",{onClick:j,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const xe=c&&!r&&!d&&!p,ne=d&&!r&&!c&&!p,ye=p&&!r&&!c&&!d;return l.jsxs("div",{className:"flex h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx(h$,{documentTypes:C,roles:T,templates:q,workflows:D,loading:R,rolesLoading:L,templatesLoading:E,workflowsLoading:A,selectedDocType:r,docTypeSource:_,selectedRole:c,selectedTemplate:d,selectedWorkflow:p,onSelectDocType:O,onSelectRole:P,onSelectTemplate:I,onSelectWorkflow:F,onCreateWorkflow:se,onSelectTask:M,onSelectSchema:z,workspaceState:k}),xe?l.jsx(z$,{workspaceId:x,role:c,onArtifactSave:G}):ne?l.jsx(q$,{workspaceId:x,template:d,onArtifactSave:G}):ye?l.jsx(_B,{workspaceId:x,workflow:p,onArtifactSave:G,onDelete:re,onNavigateToWorkflow:V}):l.jsx(L$,{workspaceId:x,docType:s,loading:i,roles:T,onArtifactSave:G,initialTab:y,docTypeSource:_}),l.jsx(DB,{workspaceId:x,state:k,loading:N,onCommit:X,onDiscard:te,onClose:Q,onRefresh:S})]})}function LB({user:e,onClick:t}){return l.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?l.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):l.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),l.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[l.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function zB(){var T,L,q;const{user:e}=xo(),[t,r]=m.useState(!1),{projects:n,loading:s,error:o,refresh:i}=Dq({includeArchived:t}),[a,c]=m.useState(null),[u,d]=m.useState(null),[f,p]=m.useState(!1),[h,y]=m.useState(!1),{theme:v,setTheme:_}=vC(),g=Object.keys(n),x=a&&n[a]?a:g[0]||null;m.useEffect(()=>{if(x&&n[x]){const E=n[x];document.title=`${E.projectId} - The Combine`}else document.title="The Combine"},[x,n]);const b=E=>{c(E),d(null)},w=()=>{p(!0)},j=async E=>{await i(),E&&E.id&&(c(E.id),d("concierge_intake")),p(!1)},k=()=>{p(!1)},N=async(E,D)=>{try{await Pe.updateProject(E,D),await i()}catch(A){throw console.error("Failed to update project:",A),A}},S=async E=>{try{if(await Pe.archiveProject(E),!t){const D=Object.values(n).sort((O,M)=>{const z=(O.name||"").localeCompare(M.name||"");return z!==0?z:(O.projectId||"").localeCompare(M.projectId||"")}),A=D.findIndex(O=>O.id===E),$=D[A+1]||D[A-1]||null;c(($==null?void 0:$.id)||null)}await i()}catch(D){throw console.error("Failed to archive project:",D),D}},C=async E=>{try{await Pe.unarchiveProject(E),await i()}catch(D){throw console.error("Failed to unarchive project:",D),D}},R=async E=>{try{await Pe.deleteProject(E);const D=Object.values(n).sort((O,M)=>{const z=(O.name||"").localeCompare(M.name||"");return z!==0?z:(O.projectId||"").localeCompare(M.projectId||"")}),A=D.findIndex(O=>O.id===E),$=D[A+1]||D[A-1]||null;c(($==null?void 0:$.id)||null),await i()}catch(D){throw console.error("Failed to delete project:",D),D}};return s?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${v}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):o?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${v}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[l.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",o]}),l.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):l.jsxs("div",{className:`flex flex-col h-screen theme-${v}`,children:[l.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),l.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),l.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),l.jsx("path",{d:"M12 17h.01"})]})})]}),l.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[l.jsx(VA,{projects:n,selectedId:x,onSelectProject:b,onNewProject:w,showArchived:t,onToggleShowArchived:()=>r(E=>!E),userSection:l.jsx(LB,{user:e,onClick:()=>y(!0)})}),l.jsx("div",{className:"flex-1",children:x?l.jsx(gc,{children:l.jsx(Vq,{projectId:x,projectCode:(T=n[x])==null?void 0:T.projectId,projectName:(L=n[x])==null?void 0:L.name,isArchived:(q=n[x])==null?void 0:q.isArchived,autoExpandNodeId:u,theme:v,onThemeChange:_,onProjectUpdate:N,onProjectArchive:S,onProjectUnarchive:C,onProjectDelete:R})},x):l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsx("div",{className:"text-center",children:l.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&l.jsx(Jq,{onClose:k,onComplete:j}),h&&l.jsx(e$,{onClose:()=>y(!1)})]})]})}function qB(){const{isAuthenticated:e,loading:t}=xo(),{theme:r}=vC(),[n,s]=m.useState(window.location.pathname);return m.useEffect(()=>{const o=()=>s(window.location.pathname);return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),t?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?l.jsx("div",{className:`h-screen theme-${r}`,children:l.jsx(OB,{})}):l.jsx(zB,{}):n==="/learn"?l.jsx(d$,{}):l.jsx(a$,{})}function $B(){return l.jsx(zq,{children:l.jsx(qB,{})})}Tm.createRoot(document.getElementById("root")).render(l.jsx(B.StrictMode,{children:l.jsx($B,{})}));
//# sourceMappingURL=index-CkWySMkG.js.map
