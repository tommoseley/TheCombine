(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Q2={exports:{}},Ac={},X2={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ha=Symbol.for("react.element"),YA=Symbol.for("react.portal"),QA=Symbol.for("react.fragment"),XA=Symbol.for("react.strict_mode"),ZA=Symbol.for("react.profiler"),JA=Symbol.for("react.provider"),eR=Symbol.for("react.context"),tR=Symbol.for("react.forward_ref"),rR=Symbol.for("react.suspense"),nR=Symbol.for("react.memo"),sR=Symbol.for("react.lazy"),Qy=Symbol.iterator;function iR(e){return e===null||typeof e!="object"?null:(e=Qy&&e[Qy]||e["@@iterator"],typeof e=="function"?e:null)}var Z2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},J2=Object.assign,ek={};function Ai(e,t,r){this.props=e,this.context=t,this.refs=ek,this.updater=r||Z2}Ai.prototype.isReactComponent={};Ai.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ai.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function tk(){}tk.prototype=Ai.prototype;function Jg(e,t,r){this.props=e,this.context=t,this.refs=ek,this.updater=r||Z2}var ev=Jg.prototype=new tk;ev.constructor=Jg;J2(ev,Ai.prototype);ev.isPureReactComponent=!0;var Xy=Array.isArray,rk=Object.prototype.hasOwnProperty,tv={current:null},nk={key:!0,ref:!0,__self:!0,__source:!0};function sk(e,t,r){var n,s={},i=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)rk.call(t,n)&&!nk.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:ha,type:e,key:i,ref:a,props:s,_owner:tv.current}}function oR(e,t){return{$$typeof:ha,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function rv(e){return typeof e=="object"&&e!==null&&e.$$typeof===ha}function aR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Zy=/\/+/g;function Au(e,t){return typeof e=="object"&&e!==null&&e.key!=null?aR(""+e.key):t.toString(36)}function gl(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ha:case YA:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+Au(a,0):n,Xy(s)?(r="",e!=null&&(r=e.replace(Zy,"$&/")+"/"),gl(s,t,r,"",function(d){return d})):s!=null&&(rv(s)&&(s=oR(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Zy,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",Xy(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Au(i,l);a+=gl(i,t,r,c,s)}else if(c=iR(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Au(i,l++),a+=gl(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ia(e,t,r){if(e==null)return e;var n=[],s=0;return gl(e,n,"","",function(i){return t.call(r,i,s++)}),n}function lR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ft={current:null},vl={transition:null},cR={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:vl,ReactCurrentOwner:tv};function ik(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Ia,forEach:function(e,t,r){Ia(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ia(e,function(){t++}),t},toArray:function(e){return Ia(e,function(t){return t})||[]},only:function(e){if(!rv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Ai;Ce.Fragment=QA;Ce.Profiler=ZA;Ce.PureComponent=Jg;Ce.StrictMode=XA;Ce.Suspense=rR;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cR;Ce.act=ik;Ce.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=J2({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=tv.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)rk.call(t,c)&&!nk.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:ha,type:e.type,key:s,ref:i,props:n,_owner:a}};Ce.createContext=function(e){return e={$$typeof:eR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:JA,_context:e},e.Consumer=e};Ce.createElement=sk;Ce.createFactory=function(e){var t=sk.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:tR,render:e}};Ce.isValidElement=rv;Ce.lazy=function(e){return{$$typeof:sR,_payload:{_status:-1,_result:e},_init:lR}};Ce.memo=function(e,t){return{$$typeof:nR,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=vl.transition;vl.transition={};try{e()}finally{vl.transition=t}};Ce.unstable_act=ik;Ce.useCallback=function(e,t){return Ft.current.useCallback(e,t)};Ce.useContext=function(e){return Ft.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Ft.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Ft.current.useEffect(e,t)};Ce.useId=function(){return Ft.current.useId()};Ce.useImperativeHandle=function(e,t,r){return Ft.current.useImperativeHandle(e,t,r)};Ce.useInsertionEffect=function(e,t){return Ft.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Ft.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Ft.current.useMemo(e,t)};Ce.useReducer=function(e,t,r){return Ft.current.useReducer(e,t,r)};Ce.useRef=function(e){return Ft.current.useRef(e)};Ce.useState=function(e){return Ft.current.useState(e)};Ce.useSyncExternalStore=function(e,t,r){return Ft.current.useSyncExternalStore(e,t,r)};Ce.useTransition=function(){return Ft.current.useTransition()};Ce.version="18.3.1";X2.exports=Ce;var m=X2.exports;const Y=Zg(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uR=m,dR=Symbol.for("react.element"),fR=Symbol.for("react.fragment"),pR=Object.prototype.hasOwnProperty,hR=uR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mR={key:!0,ref:!0,__self:!0,__source:!0};function ok(e,t,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)pR.call(t,n)&&!mR.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:dR,type:e,key:i,ref:a,props:s,_owner:hR.current}}Ac.Fragment=fR;Ac.jsx=ok;Ac.jsxs=ok;Q2.exports=Ac;var o=Q2.exports,Ex={},ak={exports:{}},or={},lk={exports:{}},ck={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,I){var O=M.length;M.push(I);e:for(;0<O;){var F=O-1>>>1,q=M[F];if(0<s(q,I))M[F]=I,M[O]=q,O=F;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var I=M[0],O=M.pop();if(O!==I){M[0]=O;e:for(var F=0,q=M.length,U=q>>>1;F<U;){var G=2*(F+1)-1,J=M[G],B=G+1,te=M[B];if(0>s(J,O))B<q&&0>s(te,J)?(M[F]=te,M[B]=O,F=B):(M[F]=J,M[G]=O,F=G);else if(B<q&&0>s(te,O))M[F]=te,M[B]=O,F=B;else break e}}return I}function s(M,I){var O=M.sortIndex-I.sortIndex;return O!==0?O:M.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,v=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var I=r(d);I!==null;){if(I.callback===null)n(d);else if(I.startTime<=M)n(d),I.sortIndex=I.expirationTime,t(c,I);else break;I=r(d)}}function j(M){if(x=!1,b(M),!v)if(r(c)!==null)v=!0,A(k);else{var I=r(d);I!==null&&P(j,I.startTime-M)}}function k(M,I){v=!1,x&&(x=!1,g(C),C=-1),h=!0;var O=p;try{for(b(I),f=r(c);f!==null&&(!(f.expirationTime>I)||M&&!T());){var F=f.callback;if(typeof F=="function"){f.callback=null,p=f.priorityLevel;var q=F(f.expirationTime<=I);I=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(I)}else n(c);f=r(c)}if(f!==null)var U=!0;else{var G=r(d);G!==null&&P(j,G.startTime-I),U=!1}return U}finally{f=null,p=O,h=!1}}var N=!1,S=null,C=-1,_=5,R=-1;function T(){return!(e.unstable_now()-R<_)}function D(){if(S!==null){var M=e.unstable_now();R=M;var I=!0;try{I=S(!0,M)}finally{I?$():(N=!1,S=null)}}else N=!1}var $;if(typeof y=="function")$=function(){y(D)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,L=E.port2;E.port1.onmessage=D,$=function(){L.postMessage(null)}}else $=function(){w(D,0)};function A(M){S=M,N||(N=!0,$())}function P(M,I){C=w(function(){M(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,A(k))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(M){switch(p){case 1:case 2:case 3:var I=3;break;default:I=p}var O=p;p=I;try{return M()}finally{p=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,I){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var O=p;p=M;try{return I()}finally{p=O}},e.unstable_scheduleCallback=function(M,I,O){var F=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?F+O:F):O=F,M){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=O+q,M={id:u++,callback:I,priorityLevel:M,startTime:O,expirationTime:q,sortIndex:-1},O>F?(M.sortIndex=O,t(d,M),r(c)===null&&M===r(d)&&(x?(g(C),C=-1):x=!0,P(j,O-F))):(M.sortIndex=q,t(c,M),v||h||(v=!0,A(k))),M},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(M){var I=p;return function(){var O=p;p=I;try{return M.apply(this,arguments)}finally{p=O}}}})(ck);lk.exports=ck;var xR=lk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gR=m,sr=xR;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uk=new Set,Mo={};function Ns(e,t){xi(e,t),xi(e+"Capture",t)}function xi(e,t){for(Mo[e]=t,e=0;e<t.length;e++)uk.add(t[e])}var cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tx=Object.prototype.hasOwnProperty,vR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jy={},e0={};function yR(e){return Tx.call(e0,e)?!0:Tx.call(Jy,e)?!1:vR.test(e)?e0[e]=!0:(Jy[e]=!0,!1)}function bR(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function wR(e,t,r,n){if(t===null||typeof t>"u"||bR(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $t(e,t,r,n,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Nt[e]=new $t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Nt[t]=new $t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Nt[e]=new $t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Nt[e]=new $t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Nt[e]=new $t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Nt[e]=new $t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Nt[e]=new $t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Nt[e]=new $t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Nt[e]=new $t(e,5,!1,e.toLowerCase(),null,!1,!1)});var nv=/[\-:]([a-z])/g;function sv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(nv,sv);Nt[t]=new $t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(nv,sv);Nt[t]=new $t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(nv,sv);Nt[t]=new $t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Nt[e]=new $t(e,1,!1,e.toLowerCase(),null,!1,!1)});Nt.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Nt[e]=new $t(e,1,!1,e.toLowerCase(),null,!0,!0)});function iv(e,t,r,n){var s=Nt.hasOwnProperty(t)?Nt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(wR(t,r,s,n)&&(r=null),n||s===null?yR(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var gn=gR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pa=Symbol.for("react.element"),Hs=Symbol.for("react.portal"),Us=Symbol.for("react.fragment"),ov=Symbol.for("react.strict_mode"),Ax=Symbol.for("react.profiler"),dk=Symbol.for("react.provider"),fk=Symbol.for("react.context"),av=Symbol.for("react.forward_ref"),Rx=Symbol.for("react.suspense"),Ix=Symbol.for("react.suspense_list"),lv=Symbol.for("react.memo"),jn=Symbol.for("react.lazy"),pk=Symbol.for("react.offscreen"),t0=Symbol.iterator;function Bi(e){return e===null||typeof e!="object"?null:(e=t0&&e[t0]||e["@@iterator"],typeof e=="function"?e:null)}var Ze=Object.assign,Ru;function lo(e){if(Ru===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ru=t&&t[1]||""}return`
`+Ru+e}var Iu=!1;function Pu(e,t){if(!e||Iu)return"";Iu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{Iu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?lo(e):""}function _R(e){switch(e.tag){case 5:return lo(e.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return e=Pu(e.type,!1),e;case 11:return e=Pu(e.type.render,!1),e;case 1:return e=Pu(e.type,!0),e;default:return""}}function Px(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Us:return"Fragment";case Hs:return"Portal";case Ax:return"Profiler";case ov:return"StrictMode";case Rx:return"Suspense";case Ix:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case fk:return(e.displayName||"Context")+".Consumer";case dk:return(e._context.displayName||"Context")+".Provider";case av:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lv:return t=e.displayName||null,t!==null?t:Px(e.type)||"Memo";case jn:t=e._payload,e=e._init;try{return Px(e(t))}catch{}}return null}function jR(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Px(t);case 8:return t===ov?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Vn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function hk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function SR(e){var t=hk(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Oa(e){e._valueTracker||(e._valueTracker=SR(e))}function mk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=hk(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ol(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ox(e,t){var r=t.checked;return Ze({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function r0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Vn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function xk(e,t){t=t.checked,t!=null&&iv(e,"checked",t,!1)}function Mx(e,t){xk(e,t);var r=Vn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Dx(e,t.type,r):t.hasOwnProperty("defaultValue")&&Dx(e,t.type,Vn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function n0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Dx(e,t,r){(t!=="number"||Ol(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var co=Array.isArray;function oi(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Vn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Lx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return Ze({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function s0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Z(92));if(co(r)){if(1<r.length)throw Error(Z(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Vn(r)}}function gk(e,t){var r=Vn(t.value),n=Vn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function i0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function vk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?vk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ma,yk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ma=Ma||document.createElement("div"),Ma.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ma.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Do(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var _o={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kR=["Webkit","ms","Moz","O"];Object.keys(_o).forEach(function(e){kR.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_o[t]=_o[e]})});function bk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||_o.hasOwnProperty(e)&&_o[e]?(""+t).trim():t+"px"}function wk(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=bk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var NR=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fx(e,t){if(t){if(NR[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function $x(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qx=null;function cv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bx=null,ai=null,li=null;function o0(e){if(e=ga(e)){if(typeof Bx!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=Mc(t),Bx(e.stateNode,e.type,t))}}function _k(e){ai?li?li.push(e):li=[e]:ai=e}function jk(){if(ai){var e=ai,t=li;if(li=ai=null,o0(e),t)for(e=0;e<t.length;e++)o0(t[e])}}function Sk(e,t){return e(t)}function kk(){}var Ou=!1;function Nk(e,t,r){if(Ou)return e(t,r);Ou=!0;try{return Sk(e,t,r)}finally{Ou=!1,(ai!==null||li!==null)&&(kk(),jk())}}function Lo(e,t){var r=e.stateNode;if(r===null)return null;var n=Mc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Z(231,t,typeof r));return r}var Wx=!1;if(cn)try{var Wi={};Object.defineProperty(Wi,"passive",{get:function(){Wx=!0}}),window.addEventListener("test",Wi,Wi),window.removeEventListener("test",Wi,Wi)}catch{Wx=!1}function CR(e,t,r,n,s,i,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var jo=!1,Ml=null,Dl=!1,Hx=null,ER={onError:function(e){jo=!0,Ml=e}};function TR(e,t,r,n,s,i,a,l,c){jo=!1,Ml=null,CR.apply(ER,arguments)}function AR(e,t,r,n,s,i,a,l,c){if(TR.apply(this,arguments),jo){if(jo){var d=Ml;jo=!1,Ml=null}else throw Error(Z(198));Dl||(Dl=!0,Hx=d)}}function Cs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Ck(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function a0(e){if(Cs(e)!==e)throw Error(Z(188))}function RR(e){var t=e.alternate;if(!t){if(t=Cs(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return a0(s),e;if(i===n)return a0(s),t;i=i.sibling}throw Error(Z(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(Z(189))}}if(r.alternate!==n)throw Error(Z(190))}if(r.tag!==3)throw Error(Z(188));return r.stateNode.current===r?e:t}function Ek(e){return e=RR(e),e!==null?Tk(e):null}function Tk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Tk(e);if(t!==null)return t;e=e.sibling}return null}var Ak=sr.unstable_scheduleCallback,l0=sr.unstable_cancelCallback,IR=sr.unstable_shouldYield,PR=sr.unstable_requestPaint,st=sr.unstable_now,OR=sr.unstable_getCurrentPriorityLevel,uv=sr.unstable_ImmediatePriority,Rk=sr.unstable_UserBlockingPriority,Ll=sr.unstable_NormalPriority,MR=sr.unstable_LowPriority,Ik=sr.unstable_IdlePriority,Rc=null,Br=null;function DR(e){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Rc,e,void 0,(e.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:FR,LR=Math.log,zR=Math.LN2;function FR(e){return e>>>=0,e===0?32:31-(LR(e)/zR|0)|0}var Da=64,La=4194304;function uo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function zl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=uo(l):(i&=a,i!==0&&(n=uo(i)))}else a=r&~s,a!==0?n=uo(a):i!==0&&(n=uo(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Er(t),s=1<<r,n|=e[r],t&=~s;return n}function $R(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qR(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Er(i),l=1<<a,c=s[a];c===-1?(!(l&r)||l&n)&&(s[a]=$R(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Ux(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Pk(){var e=Da;return Da<<=1,!(Da&4194240)&&(Da=64),e}function Mu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ma(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Er(t),e[t]=r}function BR(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Er(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function dv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Er(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var $e=0;function Ok(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Mk,fv,Dk,Lk,zk,Vx=!1,za=[],Mn=null,Dn=null,Ln=null,zo=new Map,Fo=new Map,En=[],WR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function c0(e,t){switch(e){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":zo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(t.pointerId)}}function Hi(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=ga(t),t!==null&&fv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function HR(e,t,r,n,s){switch(t){case"focusin":return Mn=Hi(Mn,e,t,r,n,s),!0;case"dragenter":return Dn=Hi(Dn,e,t,r,n,s),!0;case"mouseover":return Ln=Hi(Ln,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return zo.set(i,Hi(zo.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Fo.set(i,Hi(Fo.get(i)||null,e,t,r,n,s)),!0}return!1}function Fk(e){var t=ls(e.target);if(t!==null){var r=Cs(t);if(r!==null){if(t=r.tag,t===13){if(t=Ck(r),t!==null){e.blockedOn=t,zk(e.priority,function(){Dk(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function yl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);qx=n,r.target.dispatchEvent(n),qx=null}else return t=ga(r),t!==null&&fv(t),e.blockedOn=r,!1;t.shift()}return!0}function u0(e,t,r){yl(e)&&r.delete(t)}function UR(){Vx=!1,Mn!==null&&yl(Mn)&&(Mn=null),Dn!==null&&yl(Dn)&&(Dn=null),Ln!==null&&yl(Ln)&&(Ln=null),zo.forEach(u0),Fo.forEach(u0)}function Ui(e,t){e.blockedOn===t&&(e.blockedOn=null,Vx||(Vx=!0,sr.unstable_scheduleCallback(sr.unstable_NormalPriority,UR)))}function $o(e){function t(s){return Ui(s,e)}if(0<za.length){Ui(za[0],e);for(var r=1;r<za.length;r++){var n=za[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Mn!==null&&Ui(Mn,e),Dn!==null&&Ui(Dn,e),Ln!==null&&Ui(Ln,e),zo.forEach(t),Fo.forEach(t),r=0;r<En.length;r++)n=En[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<En.length&&(r=En[0],r.blockedOn===null);)Fk(r),r.blockedOn===null&&En.shift()}var ci=gn.ReactCurrentBatchConfig,Fl=!0;function VR(e,t,r,n){var s=$e,i=ci.transition;ci.transition=null;try{$e=1,pv(e,t,r,n)}finally{$e=s,ci.transition=i}}function GR(e,t,r,n){var s=$e,i=ci.transition;ci.transition=null;try{$e=4,pv(e,t,r,n)}finally{$e=s,ci.transition=i}}function pv(e,t,r,n){if(Fl){var s=Gx(e,t,r,n);if(s===null)Uu(e,t,n,$l,r),c0(e,n);else if(HR(s,e,t,r,n))n.stopPropagation();else if(c0(e,n),t&4&&-1<WR.indexOf(e)){for(;s!==null;){var i=ga(s);if(i!==null&&Mk(i),i=Gx(e,t,r,n),i===null&&Uu(e,t,n,$l,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Uu(e,t,n,null,r)}}var $l=null;function Gx(e,t,r,n){if($l=null,e=cv(n),e=ls(e),e!==null)if(t=Cs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Ck(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $l=e,null}function $k(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OR()){case uv:return 1;case Rk:return 4;case Ll:case MR:return 16;case Ik:return 536870912;default:return 16}default:return 16}}var Pn=null,hv=null,bl=null;function qk(){if(bl)return bl;var e,t=hv,r=t.length,n,s="value"in Pn?Pn.value:Pn.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[i-n];n++);return bl=s.slice(e,1<n?1-n:void 0)}function wl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fa(){return!0}function d0(){return!1}function ar(e){function t(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Fa:d0,this.isPropagationStopped=d0,this}return Ze(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Fa)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Fa)},persist:function(){},isPersistent:Fa}),t}var Ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mv=ar(Ri),xa=Ze({},Ri,{view:0,detail:0}),KR=ar(xa),Du,Lu,Vi,Ic=Ze({},xa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vi&&(Vi&&e.type==="mousemove"?(Du=e.screenX-Vi.screenX,Lu=e.screenY-Vi.screenY):Lu=Du=0,Vi=e),Du)},movementY:function(e){return"movementY"in e?e.movementY:Lu}}),f0=ar(Ic),YR=Ze({},Ic,{dataTransfer:0}),QR=ar(YR),XR=Ze({},xa,{relatedTarget:0}),zu=ar(XR),ZR=Ze({},Ri,{animationName:0,elapsedTime:0,pseudoElement:0}),JR=ar(ZR),e3=Ze({},Ri,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),t3=ar(e3),r3=Ze({},Ri,{data:0}),p0=ar(r3),n3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function o3(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=i3[e])?!!t[e]:!1}function xv(){return o3}var a3=Ze({},xa,{key:function(e){if(e.key){var t=n3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?s3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xv,charCode:function(e){return e.type==="keypress"?wl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),l3=ar(a3),c3=Ze({},Ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),h0=ar(c3),u3=Ze({},xa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xv}),d3=ar(u3),f3=Ze({},Ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),p3=ar(f3),h3=Ze({},Ic,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),m3=ar(h3),x3=[9,13,27,32],gv=cn&&"CompositionEvent"in window,So=null;cn&&"documentMode"in document&&(So=document.documentMode);var g3=cn&&"TextEvent"in window&&!So,Bk=cn&&(!gv||So&&8<So&&11>=So),m0=" ",x0=!1;function Wk(e,t){switch(e){case"keyup":return x3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vs=!1;function v3(e,t){switch(e){case"compositionend":return Hk(t);case"keypress":return t.which!==32?null:(x0=!0,m0);case"textInput":return e=t.data,e===m0&&x0?null:e;default:return null}}function y3(e,t){if(Vs)return e==="compositionend"||!gv&&Wk(e,t)?(e=qk(),bl=hv=Pn=null,Vs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bk&&t.locale!=="ko"?null:t.data;default:return null}}var b3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!b3[e.type]:t==="textarea"}function Uk(e,t,r,n){_k(n),t=ql(t,"onChange"),0<t.length&&(r=new mv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ko=null,qo=null;function w3(e){rN(e,0)}function Pc(e){var t=Ys(e);if(mk(t))return e}function _3(e,t){if(e==="change")return t}var Vk=!1;if(cn){var Fu;if(cn){var $u="oninput"in document;if(!$u){var v0=document.createElement("div");v0.setAttribute("oninput","return;"),$u=typeof v0.oninput=="function"}Fu=$u}else Fu=!1;Vk=Fu&&(!document.documentMode||9<document.documentMode)}function y0(){ko&&(ko.detachEvent("onpropertychange",Gk),qo=ko=null)}function Gk(e){if(e.propertyName==="value"&&Pc(qo)){var t=[];Uk(t,qo,e,cv(e)),Nk(w3,t)}}function j3(e,t,r){e==="focusin"?(y0(),ko=t,qo=r,ko.attachEvent("onpropertychange",Gk)):e==="focusout"&&y0()}function S3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Pc(qo)}function k3(e,t){if(e==="click")return Pc(t)}function N3(e,t){if(e==="input"||e==="change")return Pc(t)}function C3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ar=typeof Object.is=="function"?Object.is:C3;function Bo(e,t){if(Ar(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Tx.call(t,s)||!Ar(e[s],t[s]))return!1}return!0}function b0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function w0(e,t){var r=b0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=b0(r)}}function Kk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Kk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Yk(){for(var e=window,t=Ol();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ol(e.document)}return t}function vv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function E3(e){var t=Yk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Kk(r.ownerDocument.documentElement,r)){if(n!==null&&vv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=w0(r,i);var a=w0(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var T3=cn&&"documentMode"in document&&11>=document.documentMode,Gs=null,Kx=null,No=null,Yx=!1;function _0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Yx||Gs==null||Gs!==Ol(n)||(n=Gs,"selectionStart"in n&&vv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),No&&Bo(No,n)||(No=n,n=ql(Kx,"onSelect"),0<n.length&&(t=new mv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gs)))}function $a(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ks={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionend:$a("Transition","TransitionEnd")},qu={},Qk={};cn&&(Qk=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Oc(e){if(qu[e])return qu[e];if(!Ks[e])return e;var t=Ks[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Qk)return qu[e]=t[r];return e}var Xk=Oc("animationend"),Zk=Oc("animationiteration"),Jk=Oc("animationstart"),eN=Oc("transitionend"),tN=new Map,j0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xn(e,t){tN.set(e,t),Ns(t,[e])}for(var Bu=0;Bu<j0.length;Bu++){var Wu=j0[Bu],A3=Wu.toLowerCase(),R3=Wu[0].toUpperCase()+Wu.slice(1);Xn(A3,"on"+R3)}Xn(Xk,"onAnimationEnd");Xn(Zk,"onAnimationIteration");Xn(Jk,"onAnimationStart");Xn("dblclick","onDoubleClick");Xn("focusin","onFocus");Xn("focusout","onBlur");Xn(eN,"onTransitionEnd");xi("onMouseEnter",["mouseout","mouseover"]);xi("onMouseLeave",["mouseout","mouseover"]);xi("onPointerEnter",["pointerout","pointerover"]);xi("onPointerLeave",["pointerout","pointerover"]);Ns("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ns("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ns("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ns("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ns("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ns("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I3=new Set("cancel close invalid load scroll toggle".split(" ").concat(fo));function S0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,AR(n,t,void 0,e),e.currentTarget=null}function rN(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;S0(s,l,d),i=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;S0(s,l,d),i=c}}}if(Dl)throw e=Hx,Dl=!1,Hx=null,e}function Ue(e,t){var r=t[eg];r===void 0&&(r=t[eg]=new Set);var n=e+"__bubble";r.has(n)||(nN(t,e,2,!1),r.add(n))}function Hu(e,t,r){var n=0;t&&(n|=4),nN(r,e,n,t)}var qa="_reactListening"+Math.random().toString(36).slice(2);function Wo(e){if(!e[qa]){e[qa]=!0,uk.forEach(function(r){r!=="selectionchange"&&(I3.has(r)||Hu(r,!1,e),Hu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[qa]||(t[qa]=!0,Hu("selectionchange",!1,t))}}function nN(e,t,r,n){switch($k(t)){case 1:var s=VR;break;case 4:s=GR;break;default:s=pv}r=s.bind(null,t,r,e),s=void 0,!Wx||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Uu(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ls(l),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}l=l.parentNode}}n=n.return}Nk(function(){var d=i,u=cv(r),f=[];e:{var p=tN.get(e);if(p!==void 0){var h=mv,v=e;switch(e){case"keypress":if(wl(r)===0)break e;case"keydown":case"keyup":h=l3;break;case"focusin":v="focus",h=zu;break;case"focusout":v="blur",h=zu;break;case"beforeblur":case"afterblur":h=zu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=f0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=QR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=d3;break;case Xk:case Zk:case Jk:h=JR;break;case eN:h=p3;break;case"scroll":h=KR;break;case"wheel":h=m3;break;case"copy":case"cut":case"paste":h=t3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=h0}var x=(t&4)!==0,w=!x&&e==="scroll",g=x?p!==null?p+"Capture":null:p;x=[];for(var y=d,b;y!==null;){b=y;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,g!==null&&(j=Lo(y,g),j!=null&&x.push(Ho(y,j,b)))),w)break;y=y.return}0<x.length&&(p=new h(p,v,null,r,u),f.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==qx&&(v=r.relatedTarget||r.fromElement)&&(ls(v)||v[un]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=d,v=v?ls(v):null,v!==null&&(w=Cs(v),v!==w||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=d),h!==v)){if(x=f0,j="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(x=h0,j="onPointerLeave",g="onPointerEnter",y="pointer"),w=h==null?p:Ys(h),b=v==null?p:Ys(v),p=new x(j,y+"leave",h,r,u),p.target=w,p.relatedTarget=b,j=null,ls(u)===d&&(x=new x(g,y+"enter",v,r,u),x.target=b,x.relatedTarget=w,j=x),w=j,h&&v)t:{for(x=h,g=v,y=0,b=x;b;b=Os(b))y++;for(b=0,j=g;j;j=Os(j))b++;for(;0<y-b;)x=Os(x),y--;for(;0<b-y;)g=Os(g),b--;for(;y--;){if(x===g||g!==null&&x===g.alternate)break t;x=Os(x),g=Os(g)}x=null}else x=null;h!==null&&k0(f,p,h,x,!1),v!==null&&w!==null&&k0(f,w,v,x,!0)}}e:{if(p=d?Ys(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var k=_3;else if(g0(p))if(Vk)k=N3;else{k=S3;var N=j3}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=k3);if(k&&(k=k(e,d))){Uk(f,k,r,u);break e}N&&N(e,p,d),e==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&Dx(p,"number",p.value)}switch(N=d?Ys(d):window,e){case"focusin":(g0(N)||N.contentEditable==="true")&&(Gs=N,Kx=d,No=null);break;case"focusout":No=Kx=Gs=null;break;case"mousedown":Yx=!0;break;case"contextmenu":case"mouseup":case"dragend":Yx=!1,_0(f,r,u);break;case"selectionchange":if(T3)break;case"keydown":case"keyup":_0(f,r,u)}var S;if(gv)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Vs?Wk(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(Bk&&r.locale!=="ko"&&(Vs||C!=="onCompositionStart"?C==="onCompositionEnd"&&Vs&&(S=qk()):(Pn=u,hv="value"in Pn?Pn.value:Pn.textContent,Vs=!0)),N=ql(d,C),0<N.length&&(C=new p0(C,e,null,r,u),f.push({event:C,listeners:N}),S?C.data=S:(S=Hk(r),S!==null&&(C.data=S)))),(S=g3?v3(e,r):y3(e,r))&&(d=ql(d,"onBeforeInput"),0<d.length&&(u=new p0("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=S))}rN(f,t)})}function Ho(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ql(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Lo(e,r),i!=null&&n.unshift(Ho(e,i,s)),i=Lo(e,t),i!=null&&n.push(Ho(e,i,s))),e=e.return}return n}function Os(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function k0(e,t,r,n,s){for(var i=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=Lo(r,i),c!=null&&a.unshift(Ho(r,c,l))):s||(c=Lo(r,i),c!=null&&a.push(Ho(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var P3=/\r\n?/g,O3=/\u0000|\uFFFD/g;function N0(e){return(typeof e=="string"?e:""+e).replace(P3,`
`).replace(O3,"")}function Ba(e,t,r){if(t=N0(t),N0(e)!==t&&r)throw Error(Z(425))}function Bl(){}var Qx=null,Xx=null;function Zx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jx=typeof setTimeout=="function"?setTimeout:void 0,M3=typeof clearTimeout=="function"?clearTimeout:void 0,C0=typeof Promise=="function"?Promise:void 0,D3=typeof queueMicrotask=="function"?queueMicrotask:typeof C0<"u"?function(e){return C0.resolve(null).then(e).catch(L3)}:Jx;function L3(e){setTimeout(function(){throw e})}function Vu(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),$o(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);$o(t)}function zn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function E0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ii=Math.random().toString(36).slice(2),$r="__reactFiber$"+Ii,Uo="__reactProps$"+Ii,un="__reactContainer$"+Ii,eg="__reactEvents$"+Ii,z3="__reactListeners$"+Ii,F3="__reactHandles$"+Ii;function ls(e){var t=e[$r];if(t)return t;for(var r=e.parentNode;r;){if(t=r[un]||r[$r]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=E0(e);e!==null;){if(r=e[$r])return r;e=E0(e)}return t}e=r,r=e.parentNode}return null}function ga(e){return e=e[$r]||e[un],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ys(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function Mc(e){return e[Uo]||null}var tg=[],Qs=-1;function Zn(e){return{current:e}}function Ve(e){0>Qs||(e.current=tg[Qs],tg[Qs]=null,Qs--)}function We(e,t){Qs++,tg[Qs]=e.current,e.current=t}var Gn={},It=Zn(Gn),Vt=Zn(!1),ys=Gn;function gi(e,t){var r=e.type.contextTypes;if(!r)return Gn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Gt(e){return e=e.childContextTypes,e!=null}function Wl(){Ve(Vt),Ve(It)}function T0(e,t,r){if(It.current!==Gn)throw Error(Z(168));We(It,t),We(Vt,r)}function sN(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Z(108,jR(e)||"Unknown",s));return Ze({},r,n)}function Hl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Gn,ys=It.current,We(It,e),We(Vt,Vt.current),!0}function A0(e,t,r){var n=e.stateNode;if(!n)throw Error(Z(169));r?(e=sN(e,t,ys),n.__reactInternalMemoizedMergedChildContext=e,Ve(Vt),Ve(It),We(It,e)):Ve(Vt),We(Vt,r)}var Jr=null,Dc=!1,Gu=!1;function iN(e){Jr===null?Jr=[e]:Jr.push(e)}function $3(e){Dc=!0,iN(e)}function Jn(){if(!Gu&&Jr!==null){Gu=!0;var e=0,t=$e;try{var r=Jr;for($e=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jr=null,Dc=!1}catch(s){throw Jr!==null&&(Jr=Jr.slice(e+1)),Ak(uv,Jn),s}finally{$e=t,Gu=!1}}return null}var Xs=[],Zs=0,Ul=null,Vl=0,dr=[],fr=0,bs=null,tn=1,rn="";function is(e,t){Xs[Zs++]=Vl,Xs[Zs++]=Ul,Ul=e,Vl=t}function oN(e,t,r){dr[fr++]=tn,dr[fr++]=rn,dr[fr++]=bs,bs=e;var n=tn;e=rn;var s=32-Er(n)-1;n&=~(1<<s),r+=1;var i=32-Er(t)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,tn=1<<32-Er(t)+s|r<<s|n,rn=i+e}else tn=1<<i|r<<s|n,rn=e}function yv(e){e.return!==null&&(is(e,1),oN(e,1,0))}function bv(e){for(;e===Ul;)Ul=Xs[--Zs],Xs[Zs]=null,Vl=Xs[--Zs],Xs[Zs]=null;for(;e===bs;)bs=dr[--fr],dr[fr]=null,rn=dr[--fr],dr[fr]=null,tn=dr[--fr],dr[fr]=null}var nr=null,rr=null,Ge=!1,Nr=null;function aN(e,t){var r=hr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function R0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nr=e,rr=zn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nr=e,rr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=bs!==null?{id:tn,overflow:rn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=hr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,nr=e,rr=null,!0):!1;default:return!1}}function rg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ng(e){if(Ge){var t=rr;if(t){var r=t;if(!R0(e,t)){if(rg(e))throw Error(Z(418));t=zn(r.nextSibling);var n=nr;t&&R0(e,t)?aN(n,r):(e.flags=e.flags&-4097|2,Ge=!1,nr=e)}}else{if(rg(e))throw Error(Z(418));e.flags=e.flags&-4097|2,Ge=!1,nr=e}}}function I0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nr=e}function Wa(e){if(e!==nr)return!1;if(!Ge)return I0(e),Ge=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Zx(e.type,e.memoizedProps)),t&&(t=rr)){if(rg(e))throw lN(),Error(Z(418));for(;t;)aN(e,t),t=zn(t.nextSibling)}if(I0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){rr=zn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}rr=null}}else rr=nr?zn(e.stateNode.nextSibling):null;return!0}function lN(){for(var e=rr;e;)e=zn(e.nextSibling)}function vi(){rr=nr=null,Ge=!1}function wv(e){Nr===null?Nr=[e]:Nr.push(e)}var q3=gn.ReactCurrentBatchConfig;function Gi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Z(309));var n=r.stateNode}if(!n)throw Error(Z(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(Z(284));if(!r._owner)throw Error(Z(290,e))}return e}function Ha(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function P0(e){var t=e._init;return t(e._payload)}function cN(e){function t(g,y){if(e){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function r(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function s(g,y){return g=Bn(g,y),g.index=0,g.sibling=null,g}function i(g,y,b){return g.index=b,e?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=2,y):b):(g.flags|=2,y)):(g.flags|=1048576,y)}function a(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,y,b,j){return y===null||y.tag!==6?(y=ed(b,g.mode,j),y.return=g,y):(y=s(y,b),y.return=g,y)}function c(g,y,b,j){var k=b.type;return k===Us?u(g,y,b.props.children,j,b.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===jn&&P0(k)===y.type)?(j=s(y,b.props),j.ref=Gi(g,y,b),j.return=g,j):(j=El(b.type,b.key,b.props,null,g.mode,j),j.ref=Gi(g,y,b),j.return=g,j)}function d(g,y,b,j){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=td(b,g.mode,j),y.return=g,y):(y=s(y,b.children||[]),y.return=g,y)}function u(g,y,b,j,k){return y===null||y.tag!==7?(y=ms(b,g.mode,j,k),y.return=g,y):(y=s(y,b),y.return=g,y)}function f(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ed(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Pa:return b=El(y.type,y.key,y.props,null,g.mode,b),b.ref=Gi(g,null,y),b.return=g,b;case Hs:return y=td(y,g.mode,b),y.return=g,y;case jn:var j=y._init;return f(g,j(y._payload),b)}if(co(y)||Bi(y))return y=ms(y,g.mode,b,null),y.return=g,y;Ha(g,y)}return null}function p(g,y,b,j){var k=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:l(g,y,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Pa:return b.key===k?c(g,y,b,j):null;case Hs:return b.key===k?d(g,y,b,j):null;case jn:return k=b._init,p(g,y,k(b._payload),j)}if(co(b)||Bi(b))return k!==null?null:u(g,y,b,j,null);Ha(g,b)}return null}function h(g,y,b,j,k){if(typeof j=="string"&&j!==""||typeof j=="number")return g=g.get(b)||null,l(y,g,""+j,k);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Pa:return g=g.get(j.key===null?b:j.key)||null,c(y,g,j,k);case Hs:return g=g.get(j.key===null?b:j.key)||null,d(y,g,j,k);case jn:var N=j._init;return h(g,y,b,N(j._payload),k)}if(co(j)||Bi(j))return g=g.get(b)||null,u(y,g,j,k,null);Ha(y,j)}return null}function v(g,y,b,j){for(var k=null,N=null,S=y,C=y=0,_=null;S!==null&&C<b.length;C++){S.index>C?(_=S,S=null):_=S.sibling;var R=p(g,S,b[C],j);if(R===null){S===null&&(S=_);break}e&&S&&R.alternate===null&&t(g,S),y=i(R,y,C),N===null?k=R:N.sibling=R,N=R,S=_}if(C===b.length)return r(g,S),Ge&&is(g,C),k;if(S===null){for(;C<b.length;C++)S=f(g,b[C],j),S!==null&&(y=i(S,y,C),N===null?k=S:N.sibling=S,N=S);return Ge&&is(g,C),k}for(S=n(g,S);C<b.length;C++)_=h(S,g,C,b[C],j),_!==null&&(e&&_.alternate!==null&&S.delete(_.key===null?C:_.key),y=i(_,y,C),N===null?k=_:N.sibling=_,N=_);return e&&S.forEach(function(T){return t(g,T)}),Ge&&is(g,C),k}function x(g,y,b,j){var k=Bi(b);if(typeof k!="function")throw Error(Z(150));if(b=k.call(b),b==null)throw Error(Z(151));for(var N=k=null,S=y,C=y=0,_=null,R=b.next();S!==null&&!R.done;C++,R=b.next()){S.index>C?(_=S,S=null):_=S.sibling;var T=p(g,S,R.value,j);if(T===null){S===null&&(S=_);break}e&&S&&T.alternate===null&&t(g,S),y=i(T,y,C),N===null?k=T:N.sibling=T,N=T,S=_}if(R.done)return r(g,S),Ge&&is(g,C),k;if(S===null){for(;!R.done;C++,R=b.next())R=f(g,R.value,j),R!==null&&(y=i(R,y,C),N===null?k=R:N.sibling=R,N=R);return Ge&&is(g,C),k}for(S=n(g,S);!R.done;C++,R=b.next())R=h(S,g,C,R.value,j),R!==null&&(e&&R.alternate!==null&&S.delete(R.key===null?C:R.key),y=i(R,y,C),N===null?k=R:N.sibling=R,N=R);return e&&S.forEach(function(D){return t(g,D)}),Ge&&is(g,C),k}function w(g,y,b,j){if(typeof b=="object"&&b!==null&&b.type===Us&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Pa:e:{for(var k=b.key,N=y;N!==null;){if(N.key===k){if(k=b.type,k===Us){if(N.tag===7){r(g,N.sibling),y=s(N,b.props.children),y.return=g,g=y;break e}}else if(N.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===jn&&P0(k)===N.type){r(g,N.sibling),y=s(N,b.props),y.ref=Gi(g,N,b),y.return=g,g=y;break e}r(g,N);break}else t(g,N);N=N.sibling}b.type===Us?(y=ms(b.props.children,g.mode,j,b.key),y.return=g,g=y):(j=El(b.type,b.key,b.props,null,g.mode,j),j.ref=Gi(g,y,b),j.return=g,g=j)}return a(g);case Hs:e:{for(N=b.key;y!==null;){if(y.key===N)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(g,y.sibling),y=s(y,b.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else t(g,y);y=y.sibling}y=td(b,g.mode,j),y.return=g,g=y}return a(g);case jn:return N=b._init,w(g,y,N(b._payload),j)}if(co(b))return v(g,y,b,j);if(Bi(b))return x(g,y,b,j);Ha(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(g,y.sibling),y=s(y,b),y.return=g,g=y):(r(g,y),y=ed(b,g.mode,j),y.return=g,g=y),a(g)):r(g,y)}return w}var yi=cN(!0),uN=cN(!1),Gl=Zn(null),Kl=null,Js=null,_v=null;function jv(){_v=Js=Kl=null}function Sv(e){var t=Gl.current;Ve(Gl),e._currentValue=t}function sg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ui(e,t){Kl=e,_v=Js=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wt=!0),e.firstContext=null)}function gr(e){var t=e._currentValue;if(_v!==e)if(e={context:e,memoizedValue:t,next:null},Js===null){if(Kl===null)throw Error(Z(308));Js=e,Kl.dependencies={lanes:0,firstContext:e}}else Js=Js.next=e;return t}var cs=null;function kv(e){cs===null?cs=[e]:cs.push(e)}function dN(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,kv(t)):(r.next=s.next,s.next=r),t.interleaved=r,dn(e,n)}function dn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Sn=!1;function Nv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fN(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function an(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Me&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,dn(e,r)}return s=n.interleaved,s===null?(t.next=t,kv(n)):(t.next=s.next,s.next=t),n.interleaved=t,dn(e,r)}function _l(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dv(e,r)}}function O0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Yl(e,t,r,n){var s=e.updateQueue;Sn=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;a=0,u=d=c=null,l=i;do{var p=l.lane,h=l.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,x=l;switch(p=t,h=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(h,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,p=typeof v=="function"?v.call(h,f,p):v,p==null)break e;f=Ze({},f,p);break e;case 2:Sn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);_s|=a,e.lanes=a,e.memoizedState=f}}function M0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Z(191,s));s.call(n)}}}var va={},Wr=Zn(va),Vo=Zn(va),Go=Zn(va);function us(e){if(e===va)throw Error(Z(174));return e}function Cv(e,t){switch(We(Go,t),We(Vo,e),We(Wr,va),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:zx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=zx(t,e)}Ve(Wr),We(Wr,t)}function bi(){Ve(Wr),Ve(Vo),Ve(Go)}function pN(e){us(Go.current);var t=us(Wr.current),r=zx(t,e.type);t!==r&&(We(Vo,e),We(Wr,r))}function Ev(e){Vo.current===e&&(Ve(Wr),Ve(Vo))}var Qe=Zn(0);function Ql(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ku=[];function Tv(){for(var e=0;e<Ku.length;e++)Ku[e]._workInProgressVersionPrimary=null;Ku.length=0}var jl=gn.ReactCurrentDispatcher,Yu=gn.ReactCurrentBatchConfig,ws=0,Xe=null,ct=null,mt=null,Xl=!1,Co=!1,Ko=0,B3=0;function Tt(){throw Error(Z(321))}function Av(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ar(e[r],t[r]))return!1;return!0}function Rv(e,t,r,n,s,i){if(ws=i,Xe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,jl.current=e===null||e.memoizedState===null?V3:G3,e=r(n,s),Co){i=0;do{if(Co=!1,Ko=0,25<=i)throw Error(Z(301));i+=1,mt=ct=null,t.updateQueue=null,jl.current=K3,e=r(n,s)}while(Co)}if(jl.current=Zl,t=ct!==null&&ct.next!==null,ws=0,mt=ct=Xe=null,Xl=!1,t)throw Error(Z(300));return e}function Iv(){var e=Ko!==0;return Ko=0,e}function Fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Xe.memoizedState=mt=e:mt=mt.next=e,mt}function vr(){if(ct===null){var e=Xe.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=mt===null?Xe.memoizedState:mt.next;if(t!==null)mt=t,ct=e;else{if(e===null)throw Error(Z(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},mt===null?Xe.memoizedState=mt=e:mt=mt.next=e}return mt}function Yo(e,t){return typeof t=="function"?t(e):t}function Qu(e){var t=vr(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=ct,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,c=null,d=i;do{var u=d.lane;if((ws&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,a=n):c=c.next=f,Xe.lanes|=u,_s|=u}d=d.next}while(d!==null&&d!==i);c===null?a=n:c.next=l,Ar(n,t.memoizedState)||(Wt=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Xe.lanes|=i,_s|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Xu(e){var t=vr(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Ar(i,t.memoizedState)||(Wt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function hN(){}function mN(e,t){var r=Xe,n=vr(),s=t(),i=!Ar(n.memoizedState,s);if(i&&(n.memoizedState=s,Wt=!0),n=n.queue,Pv(vN.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||mt!==null&&mt.memoizedState.tag&1){if(r.flags|=2048,Qo(9,gN.bind(null,r,n,s,t),void 0,null),gt===null)throw Error(Z(349));ws&30||xN(r,t,s)}return s}function xN(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function gN(e,t,r,n){t.value=r,t.getSnapshot=n,yN(t)&&bN(e)}function vN(e,t,r){return r(function(){yN(t)&&bN(e)})}function yN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ar(e,r)}catch{return!0}}function bN(e){var t=dn(e,1);t!==null&&Tr(t,e,1,-1)}function D0(e){var t=Fr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:e},t.queue=e,e=e.dispatch=U3.bind(null,Xe,e),[t.memoizedState,e]}function Qo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function wN(){return vr().memoizedState}function Sl(e,t,r,n){var s=Fr();Xe.flags|=e,s.memoizedState=Qo(1|t,r,void 0,n===void 0?null:n)}function Lc(e,t,r,n){var s=vr();n=n===void 0?null:n;var i=void 0;if(ct!==null){var a=ct.memoizedState;if(i=a.destroy,n!==null&&Av(n,a.deps)){s.memoizedState=Qo(t,r,i,n);return}}Xe.flags|=e,s.memoizedState=Qo(1|t,r,i,n)}function L0(e,t){return Sl(8390656,8,e,t)}function Pv(e,t){return Lc(2048,8,e,t)}function _N(e,t){return Lc(4,2,e,t)}function jN(e,t){return Lc(4,4,e,t)}function SN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function kN(e,t,r){return r=r!=null?r.concat([e]):null,Lc(4,4,SN.bind(null,t,e),r)}function Ov(){}function NN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Av(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function CN(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Av(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function EN(e,t,r){return ws&21?(Ar(r,t)||(r=Pk(),Xe.lanes|=r,_s|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wt=!0),e.memoizedState=r)}function W3(e,t){var r=$e;$e=r!==0&&4>r?r:4,e(!0);var n=Yu.transition;Yu.transition={};try{e(!1),t()}finally{$e=r,Yu.transition=n}}function TN(){return vr().memoizedState}function H3(e,t,r){var n=qn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},AN(e))RN(t,r);else if(r=dN(e,t,r,n),r!==null){var s=zt();Tr(r,e,n,s),IN(r,t,n)}}function U3(e,t,r){var n=qn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(AN(e))RN(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,Ar(l,a)){var c=t.interleaved;c===null?(s.next=s,kv(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=dN(e,t,s,n),r!==null&&(s=zt(),Tr(r,e,n,s),IN(r,t,n))}}function AN(e){var t=e.alternate;return e===Xe||t!==null&&t===Xe}function RN(e,t){Co=Xl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function IN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dv(e,r)}}var Zl={readContext:gr,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},V3={readContext:gr,useCallback:function(e,t){return Fr().memoizedState=[e,t===void 0?null:t],e},useContext:gr,useEffect:L0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Sl(4194308,4,SN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Sl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Sl(4,2,e,t)},useMemo:function(e,t){var r=Fr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Fr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=H3.bind(null,Xe,e),[n.memoizedState,e]},useRef:function(e){var t=Fr();return e={current:e},t.memoizedState=e},useState:D0,useDebugValue:Ov,useDeferredValue:function(e){return Fr().memoizedState=e},useTransition:function(){var e=D0(!1),t=e[0];return e=W3.bind(null,e[1]),Fr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Xe,s=Fr();if(Ge){if(r===void 0)throw Error(Z(407));r=r()}else{if(r=t(),gt===null)throw Error(Z(349));ws&30||xN(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,L0(vN.bind(null,n,i,e),[e]),n.flags|=2048,Qo(9,gN.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Fr(),t=gt.identifierPrefix;if(Ge){var r=rn,n=tn;r=(n&~(1<<32-Er(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ko++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=B3++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},G3={readContext:gr,useCallback:NN,useContext:gr,useEffect:Pv,useImperativeHandle:kN,useInsertionEffect:_N,useLayoutEffect:jN,useMemo:CN,useReducer:Qu,useRef:wN,useState:function(){return Qu(Yo)},useDebugValue:Ov,useDeferredValue:function(e){var t=vr();return EN(t,ct.memoizedState,e)},useTransition:function(){var e=Qu(Yo)[0],t=vr().memoizedState;return[e,t]},useMutableSource:hN,useSyncExternalStore:mN,useId:TN,unstable_isNewReconciler:!1},K3={readContext:gr,useCallback:NN,useContext:gr,useEffect:Pv,useImperativeHandle:kN,useInsertionEffect:_N,useLayoutEffect:jN,useMemo:CN,useReducer:Xu,useRef:wN,useState:function(){return Xu(Yo)},useDebugValue:Ov,useDeferredValue:function(e){var t=vr();return ct===null?t.memoizedState=e:EN(t,ct.memoizedState,e)},useTransition:function(){var e=Xu(Yo)[0],t=vr().memoizedState;return[e,t]},useMutableSource:hN,useSyncExternalStore:mN,useId:TN,unstable_isNewReconciler:!1};function jr(e,t){if(e&&e.defaultProps){t=Ze({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ig(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ze({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var zc={isMounted:function(e){return(e=e._reactInternals)?Cs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=zt(),s=qn(e),i=an(n,s);i.payload=t,r!=null&&(i.callback=r),t=Fn(e,i,s),t!==null&&(Tr(t,e,s,n),_l(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=zt(),s=qn(e),i=an(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Fn(e,i,s),t!==null&&(Tr(t,e,s,n),_l(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=zt(),n=qn(e),s=an(r,n);s.tag=2,t!=null&&(s.callback=t),t=Fn(e,s,n),t!==null&&(Tr(t,e,n,r),_l(t,e,n))}};function z0(e,t,r,n,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,a):t.prototype&&t.prototype.isPureReactComponent?!Bo(r,n)||!Bo(s,i):!0}function PN(e,t,r){var n=!1,s=Gn,i=t.contextType;return typeof i=="object"&&i!==null?i=gr(i):(s=Gt(t)?ys:It.current,n=t.contextTypes,i=(n=n!=null)?gi(e,s):Gn),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=zc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function F0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&zc.enqueueReplaceState(t,t.state,null)}function og(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Nv(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=gr(i):(i=Gt(t)?ys:It.current,s.context=gi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ig(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&zc.enqueueReplaceState(s,s.state,null),Yl(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function wi(e,t){try{var r="",n=t;do r+=_R(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Zu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ag(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Y3=typeof WeakMap=="function"?WeakMap:Map;function ON(e,t,r){r=an(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ec||(ec=!0,gg=n),ag(e,t)},r}function MN(e,t,r){r=an(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){ag(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){ag(e,t),typeof n!="function"&&($n===null?$n=new Set([this]):$n.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function $0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Y3;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=c5.bind(null,e,t,r),t.then(e,e))}function q0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function B0(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=an(-1,1),t.tag=2,Fn(r,t,1))),r.lanes|=1),e)}var Q3=gn.ReactCurrentOwner,Wt=!1;function Dt(e,t,r,n){t.child=e===null?uN(t,null,r,n):yi(t,e.child,r,n)}function W0(e,t,r,n,s){r=r.render;var i=t.ref;return ui(t,s),n=Rv(e,t,r,n,i,s),r=Iv(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fn(e,t,s)):(Ge&&r&&yv(t),t.flags|=1,Dt(e,t,n,s),t.child)}function H0(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!Bv(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,DN(e,t,i,n,s)):(e=El(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Bo,r(a,n)&&e.ref===t.ref)return fn(e,t,s)}return t.flags|=1,e=Bn(i,n),e.ref=t.ref,e.return=t,t.child=e}function DN(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Bo(i,n)&&e.ref===t.ref)if(Wt=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Wt=!0);else return t.lanes=e.lanes,fn(e,t,s)}return lg(e,t,r,n,s)}function LN(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(ti,er),er|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,We(ti,er),er|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,We(ti,er),er|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,We(ti,er),er|=n;return Dt(e,t,s,r),t.child}function zN(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function lg(e,t,r,n,s){var i=Gt(r)?ys:It.current;return i=gi(t,i),ui(t,s),r=Rv(e,t,r,n,i,s),n=Iv(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fn(e,t,s)):(Ge&&n&&yv(t),t.flags|=1,Dt(e,t,r,s),t.child)}function U0(e,t,r,n,s){if(Gt(r)){var i=!0;Hl(t)}else i=!1;if(ui(t,s),t.stateNode===null)kl(e,t),PN(t,r,n),og(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=gr(d):(d=Gt(r)?ys:It.current,d=gi(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==d)&&F0(t,a,n,d),Sn=!1;var p=t.memoizedState;a.state=p,Yl(t,n,a,s),c=t.memoizedState,l!==n||p!==c||Vt.current||Sn?(typeof u=="function"&&(ig(t,r,u,n),c=t.memoizedState),(l=Sn||z0(t,r,l,n,p,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=d,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,fN(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:jr(t.type,l),a.props=d,f=t.pendingProps,p=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=gr(c):(c=Gt(r)?ys:It.current,c=gi(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==c)&&F0(t,a,n,c),Sn=!1,p=t.memoizedState,a.state=p,Yl(t,n,a,s);var v=t.memoizedState;l!==f||p!==v||Vt.current||Sn?(typeof h=="function"&&(ig(t,r,h,n),v=t.memoizedState),(d=Sn||z0(t,r,d,n,p,v,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),a.props=n,a.state=v,a.context=c,n=d):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return cg(e,t,r,n,i,s)}function cg(e,t,r,n,s,i){zN(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&A0(t,r,!1),fn(e,t,i);n=t.stateNode,Q3.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=yi(t,e.child,null,i),t.child=yi(t,null,l,i)):Dt(e,t,l,i),t.memoizedState=n.state,s&&A0(t,r,!0),t.child}function FN(e){var t=e.stateNode;t.pendingContext?T0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&T0(e,t.context,!1),Cv(e,t.containerInfo)}function V0(e,t,r,n,s){return vi(),wv(s),t.flags|=256,Dt(e,t,r,n),t.child}var ug={dehydrated:null,treeContext:null,retryLane:0};function dg(e){return{baseLanes:e,cachePool:null,transitions:null}}function $N(e,t,r){var n=t.pendingProps,s=Qe.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),We(Qe,s&1),e===null)return ng(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,i?(n=t.mode,i=t.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=qc(a,n,0,null),e=ms(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=dg(r),t.memoizedState=ug,e):Mv(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return X3(e,t,a,n,l,s,r);if(i){i=n.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bn(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Bn(l,i):(i=ms(i,a,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,a=e.child.memoizedState,a=a===null?dg(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,t.memoizedState=ug,n}return i=e.child,e=i.sibling,n=Bn(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Mv(e,t){return t=qc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ua(e,t,r,n){return n!==null&&wv(n),yi(t,e.child,null,r),e=Mv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function X3(e,t,r,n,s,i,a){if(r)return t.flags&256?(t.flags&=-257,n=Zu(Error(Z(422))),Ua(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=qc({mode:"visible",children:n.children},s,0,null),i=ms(i,s,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&yi(t,e.child,null,a),t.child.memoizedState=dg(a),t.memoizedState=ug,i);if(!(t.mode&1))return Ua(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Z(419)),n=Zu(i,n,void 0),Ua(e,t,a,n)}if(l=(a&e.childLanes)!==0,Wt||l){if(n=gt,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,dn(e,s),Tr(n,e,s,-1))}return qv(),n=Zu(Error(Z(421))),Ua(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=u5.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,rr=zn(s.nextSibling),nr=t,Ge=!0,Nr=null,e!==null&&(dr[fr++]=tn,dr[fr++]=rn,dr[fr++]=bs,tn=e.id,rn=e.overflow,bs=t),t=Mv(t,n.children),t.flags|=4096,t)}function G0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),sg(e.return,t,r)}function Ju(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function qN(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Dt(e,t,n.children,r),n=Qe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&G0(e,r,t);else if(e.tag===19)G0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(We(Qe,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Ql(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Ju(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ql(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Ju(t,!0,r,null,i);break;case"together":Ju(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function kl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),_s|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,r=Bn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Z3(e,t,r){switch(t.tag){case 3:FN(t),vi();break;case 5:pN(t);break;case 1:Gt(t.type)&&Hl(t);break;case 4:Cv(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;We(Gl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(We(Qe,Qe.current&1),t.flags|=128,null):r&t.child.childLanes?$N(e,t,r):(We(Qe,Qe.current&1),e=fn(e,t,r),e!==null?e.sibling:null);We(Qe,Qe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return qN(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),We(Qe,Qe.current),n)break;return null;case 22:case 23:return t.lanes=0,LN(e,t,r)}return fn(e,t,r)}var BN,fg,WN,HN;BN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};fg=function(){};WN=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,us(Wr.current);var i=null;switch(r){case"input":s=Ox(e,s),n=Ox(e,n),i=[];break;case"select":s=Ze({},s,{value:void 0}),n=Ze({},n,{value:void 0}),i=[];break;case"textarea":s=Lx(e,s),n=Lx(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Bl)}Fx(r,n);var a;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Mo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Mo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ue("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};HN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ki(e,t){if(!Ge)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function J3(e,t,r){var n=t.pendingProps;switch(bv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Gt(t.type)&&Wl(),At(t),null;case 3:return n=t.stateNode,bi(),Ve(Vt),Ve(It),Tv(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Wa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nr!==null&&(bg(Nr),Nr=null))),fg(e,t),At(t),null;case 5:Ev(t);var s=us(Go.current);if(r=t.type,e!==null&&t.stateNode!=null)WN(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Z(166));return At(t),null}if(e=us(Wr.current),Wa(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[$r]=t,n[Uo]=i,e=(t.mode&1)!==0,r){case"dialog":Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":case"embed":Ue("load",n);break;case"video":case"audio":for(s=0;s<fo.length;s++)Ue(fo[s],n);break;case"source":Ue("error",n);break;case"img":case"image":case"link":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"input":r0(n,i),Ue("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ue("invalid",n);break;case"textarea":s0(n,i),Ue("invalid",n)}Fx(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ba(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ba(n.textContent,l,e),s=["children",""+l]):Mo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ue("scroll",n)}switch(r){case"input":Oa(n),n0(n,i,!0);break;case"textarea":Oa(n),i0(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Bl)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=vk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[$r]=t,e[Uo]=n,BN(e,t,!1,!1),t.stateNode=e;e:{switch(a=$x(r,n),r){case"dialog":Ue("cancel",e),Ue("close",e),s=n;break;case"iframe":case"object":case"embed":Ue("load",e),s=n;break;case"video":case"audio":for(s=0;s<fo.length;s++)Ue(fo[s],e);s=n;break;case"source":Ue("error",e),s=n;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),s=n;break;case"details":Ue("toggle",e),s=n;break;case"input":r0(e,n),s=Ox(e,n),Ue("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Ze({},n,{value:void 0}),Ue("invalid",e);break;case"textarea":s0(e,n),s=Lx(e,n),Ue("invalid",e);break;default:s=n}Fx(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?wk(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&yk(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Do(e,c):typeof c=="number"&&Do(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Mo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ue("scroll",e):c!=null&&iv(e,i,c,a))}switch(r){case"input":Oa(e),n0(e,n,!1);break;case"textarea":Oa(e),i0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Vn(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?oi(e,!!n.multiple,i,!1):n.defaultValue!=null&&oi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Bl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)HN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Z(166));if(r=us(Go.current),us(Wr.current),Wa(t)){if(n=t.stateNode,r=t.memoizedProps,n[$r]=t,(i=n.nodeValue!==r)&&(e=nr,e!==null))switch(e.tag){case 3:Ba(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ba(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$r]=t,t.stateNode=n}return At(t),null;case 13:if(Ve(Qe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ge&&rr!==null&&t.mode&1&&!(t.flags&128))lN(),vi(),t.flags|=98560,i=!1;else if(i=Wa(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Z(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Z(317));i[$r]=t}else vi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;At(t),i=!1}else Nr!==null&&(bg(Nr),Nr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qe.current&1?ft===0&&(ft=3):qv())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return bi(),fg(e,t),e===null&&Wo(t.stateNode.containerInfo),At(t),null;case 10:return Sv(t.type._context),At(t),null;case 17:return Gt(t.type)&&Wl(),At(t),null;case 19:if(Ve(Qe),i=t.memoizedState,i===null)return At(t),null;if(n=(t.flags&128)!==0,a=i.rendering,a===null)if(n)Ki(i,!1);else{if(ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ql(e),a!==null){for(t.flags|=128,Ki(i,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return We(Qe,Qe.current&1|2),t.child}e=e.sibling}i.tail!==null&&st()>_i&&(t.flags|=128,n=!0,Ki(i,!1),t.lanes=4194304)}else{if(!n)if(e=Ql(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ki(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ge)return At(t),null}else 2*st()-i.renderingStartTime>_i&&r!==1073741824&&(t.flags|=128,n=!0,Ki(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(r=i.last,r!==null?r.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=st(),t.sibling=null,r=Qe.current,We(Qe,n?r&1|2:r&1),t):(At(t),null);case 22:case 23:return $v(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?er&1073741824&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function e5(e,t){switch(bv(t),t.tag){case 1:return Gt(t.type)&&Wl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bi(),Ve(Vt),Ve(It),Tv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ev(t),null;case 13:if(Ve(Qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));vi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ve(Qe),null;case 4:return bi(),null;case 10:return Sv(t.type._context),null;case 22:case 23:return $v(),null;case 24:return null;default:return null}}var Va=!1,Rt=!1,t5=typeof WeakSet=="function"?WeakSet:Set,ce=null;function ei(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function pg(e,t,r){try{r()}catch(n){tt(e,t,n)}}var K0=!1;function r5(e,t){if(Qx=Fl,e=Yk(),vv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(l=a+s),f!==i||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++d===s&&(l=a),p===i&&++u===n&&(c=a),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Xx={focusedElem:e,selectionRange:r},Fl=!1,ce=t;ce!==null;)if(t=ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ce=e;else for(;ce!==null;){t=ce;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,w=v.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?x:jr(t.type,x),w);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(j){tt(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,ce=e;break}ce=t.return}return v=K0,K0=!1,v}function Eo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&pg(t,r,i)}s=s.next}while(s!==n)}}function Fc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function hg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function UN(e){var t=e.alternate;t!==null&&(e.alternate=null,UN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$r],delete t[Uo],delete t[eg],delete t[z3],delete t[F3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function VN(e){return e.tag===5||e.tag===3||e.tag===4}function Y0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||VN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function mg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Bl));else if(n!==4&&(e=e.child,e!==null))for(mg(e,t,r),e=e.sibling;e!==null;)mg(e,t,r),e=e.sibling}function xg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(xg(e,t,r),e=e.sibling;e!==null;)xg(e,t,r),e=e.sibling}var jt=null,Sr=!1;function bn(e,t,r){for(r=r.child;r!==null;)GN(e,t,r),r=r.sibling}function GN(e,t,r){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Rc,r)}catch{}switch(r.tag){case 5:Rt||ei(r,t);case 6:var n=jt,s=Sr;jt=null,bn(e,t,r),jt=n,Sr=s,jt!==null&&(Sr?(e=jt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):jt.removeChild(r.stateNode));break;case 18:jt!==null&&(Sr?(e=jt,r=r.stateNode,e.nodeType===8?Vu(e.parentNode,r):e.nodeType===1&&Vu(e,r),$o(e)):Vu(jt,r.stateNode));break;case 4:n=jt,s=Sr,jt=r.stateNode.containerInfo,Sr=!0,bn(e,t,r),jt=n,Sr=s;break;case 0:case 11:case 14:case 15:if(!Rt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&pg(r,t,a),s=s.next}while(s!==n)}bn(e,t,r);break;case 1:if(!Rt&&(ei(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){tt(r,t,l)}bn(e,t,r);break;case 21:bn(e,t,r);break;case 22:r.mode&1?(Rt=(n=Rt)||r.memoizedState!==null,bn(e,t,r),Rt=n):bn(e,t,r);break;default:bn(e,t,r)}}function Q0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new t5),t.forEach(function(n){var s=d5.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function _r(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:jt=l.stateNode,Sr=!1;break e;case 3:jt=l.stateNode.containerInfo,Sr=!0;break e;case 4:jt=l.stateNode.containerInfo,Sr=!0;break e}l=l.return}if(jt===null)throw Error(Z(160));GN(i,a,s),jt=null,Sr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){tt(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)KN(t,e),t=t.sibling}function KN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_r(t,e),Lr(e),n&4){try{Eo(3,e,e.return),Fc(3,e)}catch(x){tt(e,e.return,x)}try{Eo(5,e,e.return)}catch(x){tt(e,e.return,x)}}break;case 1:_r(t,e),Lr(e),n&512&&r!==null&&ei(r,r.return);break;case 5:if(_r(t,e),Lr(e),n&512&&r!==null&&ei(r,r.return),e.flags&32){var s=e.stateNode;try{Do(s,"")}catch(x){tt(e,e.return,x)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&xk(s,i),$x(l,a);var d=$x(l,i);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?wk(s,f):u==="dangerouslySetInnerHTML"?yk(s,f):u==="children"?Do(s,f):iv(s,u,f,d)}switch(l){case"input":Mx(s,i);break;case"textarea":gk(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?oi(s,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Uo]=i}catch(x){tt(e,e.return,x)}}break;case 6:if(_r(t,e),Lr(e),n&4){if(e.stateNode===null)throw Error(Z(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(x){tt(e,e.return,x)}}break;case 3:if(_r(t,e),Lr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$o(t.containerInfo)}catch(x){tt(e,e.return,x)}break;case 4:_r(t,e),Lr(e);break;case 13:_r(t,e),Lr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(zv=st())),n&4&&Q0(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Rt=(d=Rt)||u,_r(t,e),Rt=d):_r(t,e),Lr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(ce=e,u=e.child;u!==null;){for(f=ce=u;ce!==null;){switch(p=ce,h=p.child,p.tag){case 0:case 11:case 14:case 15:Eo(4,p,p.return);break;case 1:ei(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){tt(n,r,x)}}break;case 5:ei(p,p.return);break;case 22:if(p.memoizedState!==null){Z0(f);continue}}h!==null?(h.return=p,ce=h):Z0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=bk("display",a))}catch(x){tt(e,e.return,x)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(x){tt(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:_r(t,e),Lr(e),n&4&&Q0(e);break;case 21:break;default:_r(t,e),Lr(e)}}function Lr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(VN(r)){var n=r;break e}r=r.return}throw Error(Z(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Do(s,""),n.flags&=-33);var i=Y0(e);xg(e,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=Y0(e);mg(e,l,a);break;default:throw Error(Z(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function n5(e,t,r){ce=e,YN(e)}function YN(e,t,r){for(var n=(e.mode&1)!==0;ce!==null;){var s=ce,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Va;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Rt;l=Va;var d=Rt;if(Va=a,(Rt=c)&&!d)for(ce=s;ce!==null;)a=ce,c=a.child,a.tag===22&&a.memoizedState!==null?J0(s):c!==null?(c.return=a,ce=c):J0(s);for(;i!==null;)ce=i,YN(i),i=i.sibling;ce=s,Va=l,Rt=d}X0(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ce=i):X0(e)}}function X0(e){for(;ce!==null;){var t=ce;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Rt||Fc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Rt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:jr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&M0(t,i,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}M0(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&$o(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Rt||t.flags&512&&hg(t)}catch(p){tt(t,t.return,p)}}if(t===e){ce=null;break}if(r=t.sibling,r!==null){r.return=t.return,ce=r;break}ce=t.return}}function Z0(e){for(;ce!==null;){var t=ce;if(t===e){ce=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ce=r;break}ce=t.return}}function J0(e){for(;ce!==null;){var t=ce;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Fc(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){tt(t,s,c)}}var i=t.return;try{hg(t)}catch(c){tt(t,i,c)}break;case 5:var a=t.return;try{hg(t)}catch(c){tt(t,a,c)}}}catch(c){tt(t,t.return,c)}if(t===e){ce=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ce=l;break}ce=t.return}}var s5=Math.ceil,Jl=gn.ReactCurrentDispatcher,Dv=gn.ReactCurrentOwner,xr=gn.ReactCurrentBatchConfig,Me=0,gt=null,it=null,St=0,er=0,ti=Zn(0),ft=0,Xo=null,_s=0,$c=0,Lv=0,To=null,Bt=null,zv=0,_i=1/0,Zr=null,ec=!1,gg=null,$n=null,Ga=!1,On=null,tc=0,Ao=0,vg=null,Nl=-1,Cl=0;function zt(){return Me&6?st():Nl!==-1?Nl:Nl=st()}function qn(e){return e.mode&1?Me&2&&St!==0?St&-St:q3.transition!==null?(Cl===0&&(Cl=Pk()),Cl):(e=$e,e!==0||(e=window.event,e=e===void 0?16:$k(e.type)),e):1}function Tr(e,t,r,n){if(50<Ao)throw Ao=0,vg=null,Error(Z(185));ma(e,r,n),(!(Me&2)||e!==gt)&&(e===gt&&(!(Me&2)&&($c|=r),ft===4&&Tn(e,St)),Kt(e,n),r===1&&Me===0&&!(t.mode&1)&&(_i=st()+500,Dc&&Jn()))}function Kt(e,t){var r=e.callbackNode;qR(e,t);var n=zl(e,e===gt?St:0);if(n===0)r!==null&&l0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&l0(r),t===1)e.tag===0?$3(eb.bind(null,e)):iN(eb.bind(null,e)),D3(function(){!(Me&6)&&Jn()}),r=null;else{switch(Ok(n)){case 1:r=uv;break;case 4:r=Rk;break;case 16:r=Ll;break;case 536870912:r=Ik;break;default:r=Ll}r=nC(r,QN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function QN(e,t){if(Nl=-1,Cl=0,Me&6)throw Error(Z(327));var r=e.callbackNode;if(di()&&e.callbackNode!==r)return null;var n=zl(e,e===gt?St:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=rc(e,n);else{t=n;var s=Me;Me|=2;var i=ZN();(gt!==e||St!==t)&&(Zr=null,_i=st()+500,hs(e,t));do try{a5();break}catch(l){XN(e,l)}while(!0);jv(),Jl.current=i,Me=s,it!==null?t=0:(gt=null,St=0,t=ft)}if(t!==0){if(t===2&&(s=Ux(e),s!==0&&(n=s,t=yg(e,s))),t===1)throw r=Xo,hs(e,0),Tn(e,n),Kt(e,st()),r;if(t===6)Tn(e,n);else{if(s=e.current.alternate,!(n&30)&&!i5(s)&&(t=rc(e,n),t===2&&(i=Ux(e),i!==0&&(n=i,t=yg(e,i))),t===1))throw r=Xo,hs(e,0),Tn(e,n),Kt(e,st()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Z(345));case 2:os(e,Bt,Zr);break;case 3:if(Tn(e,n),(n&130023424)===n&&(t=zv+500-st(),10<t)){if(zl(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){zt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Jx(os.bind(null,e,Bt,Zr),t);break}os(e,Bt,Zr);break;case 4:if(Tn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Er(n);i=1<<a,a=t[a],a>s&&(s=a),n&=~i}if(n=s,n=st()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*s5(n/1960))-n,10<n){e.timeoutHandle=Jx(os.bind(null,e,Bt,Zr),n);break}os(e,Bt,Zr);break;case 5:os(e,Bt,Zr);break;default:throw Error(Z(329))}}}return Kt(e,st()),e.callbackNode===r?QN.bind(null,e):null}function yg(e,t){var r=To;return e.current.memoizedState.isDehydrated&&(hs(e,t).flags|=256),e=rc(e,t),e!==2&&(t=Bt,Bt=r,t!==null&&bg(t)),e}function bg(e){Bt===null?Bt=e:Bt.push.apply(Bt,e)}function i5(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ar(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tn(e,t){for(t&=~Lv,t&=~$c,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Er(t),n=1<<r;e[r]=-1,t&=~n}}function eb(e){if(Me&6)throw Error(Z(327));di();var t=zl(e,0);if(!(t&1))return Kt(e,st()),null;var r=rc(e,t);if(e.tag!==0&&r===2){var n=Ux(e);n!==0&&(t=n,r=yg(e,n))}if(r===1)throw r=Xo,hs(e,0),Tn(e,t),Kt(e,st()),r;if(r===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,os(e,Bt,Zr),Kt(e,st()),null}function Fv(e,t){var r=Me;Me|=1;try{return e(t)}finally{Me=r,Me===0&&(_i=st()+500,Dc&&Jn())}}function js(e){On!==null&&On.tag===0&&!(Me&6)&&di();var t=Me;Me|=1;var r=xr.transition,n=$e;try{if(xr.transition=null,$e=1,e)return e()}finally{$e=n,xr.transition=r,Me=t,!(Me&6)&&Jn()}}function $v(){er=ti.current,Ve(ti)}function hs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,M3(r)),it!==null)for(r=it.return;r!==null;){var n=r;switch(bv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Wl();break;case 3:bi(),Ve(Vt),Ve(It),Tv();break;case 5:Ev(n);break;case 4:bi();break;case 13:Ve(Qe);break;case 19:Ve(Qe);break;case 10:Sv(n.type._context);break;case 22:case 23:$v()}r=r.return}if(gt=e,it=e=Bn(e.current,null),St=er=t,ft=0,Xo=null,Lv=$c=_s=0,Bt=To=null,cs!==null){for(t=0;t<cs.length;t++)if(r=cs[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}cs=null}return e}function XN(e,t){do{var r=it;try{if(jv(),jl.current=Zl,Xl){for(var n=Xe.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Xl=!1}if(ws=0,mt=ct=Xe=null,Co=!1,Ko=0,Dv.current=null,r===null||r.return===null){ft=1,Xo=t,it=null;break}e:{var i=e,a=r.return,l=r,c=t;if(t=St,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=q0(a);if(h!==null){h.flags&=-257,B0(h,a,l,i,t),h.mode&1&&$0(i,d,t),t=h,c=d;var v=t.updateQueue;if(v===null){var x=new Set;x.add(c),t.updateQueue=x}else v.add(c);break e}else{if(!(t&1)){$0(i,d,t),qv();break e}c=Error(Z(426))}}else if(Ge&&l.mode&1){var w=q0(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),B0(w,a,l,i,t),wv(wi(c,l));break e}}i=c=wi(c,l),ft!==4&&(ft=2),To===null?To=[i]:To.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=ON(i,c,t);O0(i,g);break e;case 1:l=c;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&($n===null||!$n.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=MN(i,l,t);O0(i,j);break e}}i=i.return}while(i!==null)}eC(r)}catch(k){t=k,it===r&&r!==null&&(it=r=r.return);continue}break}while(!0)}function ZN(){var e=Jl.current;return Jl.current=Zl,e===null?Zl:e}function qv(){(ft===0||ft===3||ft===2)&&(ft=4),gt===null||!(_s&268435455)&&!($c&268435455)||Tn(gt,St)}function rc(e,t){var r=Me;Me|=2;var n=ZN();(gt!==e||St!==t)&&(Zr=null,hs(e,t));do try{o5();break}catch(s){XN(e,s)}while(!0);if(jv(),Me=r,Jl.current=n,it!==null)throw Error(Z(261));return gt=null,St=0,ft}function o5(){for(;it!==null;)JN(it)}function a5(){for(;it!==null&&!IR();)JN(it)}function JN(e){var t=rC(e.alternate,e,er);e.memoizedProps=e.pendingProps,t===null?eC(e):it=t,Dv.current=null}function eC(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=e5(r,t),r!==null){r.flags&=32767,it=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ft=6,it=null;return}}else if(r=J3(r,t,er),r!==null){it=r;return}if(t=t.sibling,t!==null){it=t;return}it=t=e}while(t!==null);ft===0&&(ft=5)}function os(e,t,r){var n=$e,s=xr.transition;try{xr.transition=null,$e=1,l5(e,t,r,n)}finally{xr.transition=s,$e=n}return null}function l5(e,t,r,n){do di();while(On!==null);if(Me&6)throw Error(Z(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(BR(e,i),e===gt&&(it=gt=null,St=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ga||(Ga=!0,nC(Ll,function(){return di(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=xr.transition,xr.transition=null;var a=$e;$e=1;var l=Me;Me|=4,Dv.current=null,r5(e,r),KN(r,e),E3(Xx),Fl=!!Qx,Xx=Qx=null,e.current=r,n5(r),PR(),Me=l,$e=a,xr.transition=i}else e.current=r;if(Ga&&(Ga=!1,On=e,tc=s),i=e.pendingLanes,i===0&&($n=null),DR(r.stateNode),Kt(e,st()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(ec)throw ec=!1,e=gg,gg=null,e;return tc&1&&e.tag!==0&&di(),i=e.pendingLanes,i&1?e===vg?Ao++:(Ao=0,vg=e):Ao=0,Jn(),null}function di(){if(On!==null){var e=Ok(tc),t=xr.transition,r=$e;try{if(xr.transition=null,$e=16>e?16:e,On===null)var n=!1;else{if(e=On,On=null,tc=0,Me&6)throw Error(Z(331));var s=Me;for(Me|=4,ce=e.current;ce!==null;){var i=ce,a=i.child;if(ce.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ce=d;ce!==null;){var u=ce;switch(u.tag){case 0:case 11:case 15:Eo(8,u,i)}var f=u.child;if(f!==null)f.return=u,ce=f;else for(;ce!==null;){u=ce;var p=u.sibling,h=u.return;if(UN(u),u===d){ce=null;break}if(p!==null){p.return=h,ce=p;break}ce=h}}}var v=i.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}ce=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ce=a;else e:for(;ce!==null;){if(i=ce,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Eo(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,ce=g;break e}ce=i.return}}var y=e.current;for(ce=y;ce!==null;){a=ce;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,ce=b;else e:for(a=y;ce!==null;){if(l=ce,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Fc(9,l)}}catch(k){tt(l,l.return,k)}if(l===a){ce=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,ce=j;break e}ce=l.return}}if(Me=s,Jn(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Rc,e)}catch{}n=!0}return n}finally{$e=r,xr.transition=t}}return!1}function tb(e,t,r){t=wi(r,t),t=ON(e,t,1),e=Fn(e,t,1),t=zt(),e!==null&&(ma(e,1,t),Kt(e,t))}function tt(e,t,r){if(e.tag===3)tb(e,e,r);else for(;t!==null;){if(t.tag===3){tb(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&($n===null||!$n.has(n))){e=wi(r,e),e=MN(t,e,1),t=Fn(t,e,1),e=zt(),t!==null&&(ma(t,1,e),Kt(t,e));break}}t=t.return}}function c5(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=zt(),e.pingedLanes|=e.suspendedLanes&r,gt===e&&(St&r)===r&&(ft===4||ft===3&&(St&130023424)===St&&500>st()-zv?hs(e,0):Lv|=r),Kt(e,t)}function tC(e,t){t===0&&(e.mode&1?(t=La,La<<=1,!(La&130023424)&&(La=4194304)):t=1);var r=zt();e=dn(e,t),e!==null&&(ma(e,t,r),Kt(e,r))}function u5(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),tC(e,r)}function d5(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Z(314))}n!==null&&n.delete(t),tC(e,r)}var rC;rC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vt.current)Wt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Wt=!1,Z3(e,t,r);Wt=!!(e.flags&131072)}else Wt=!1,Ge&&t.flags&1048576&&oN(t,Vl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;kl(e,t),e=t.pendingProps;var s=gi(t,It.current);ui(t,r),s=Rv(null,t,n,e,s,r);var i=Iv();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gt(n)?(i=!0,Hl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Nv(t),s.updater=zc,t.stateNode=s,s._reactInternals=t,og(t,n,e,r),t=cg(null,t,n,!0,i,r)):(t.tag=0,Ge&&i&&yv(t),Dt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(kl(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=p5(n),e=jr(n,e),s){case 0:t=lg(null,t,n,e,r);break e;case 1:t=U0(null,t,n,e,r);break e;case 11:t=W0(null,t,n,e,r);break e;case 14:t=H0(null,t,n,jr(n.type,e),r);break e}throw Error(Z(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:jr(n,s),lg(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:jr(n,s),U0(e,t,n,s,r);case 3:e:{if(FN(t),e===null)throw Error(Z(387));n=t.pendingProps,i=t.memoizedState,s=i.element,fN(e,t),Yl(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=wi(Error(Z(423)),t),t=V0(e,t,n,r,s);break e}else if(n!==s){s=wi(Error(Z(424)),t),t=V0(e,t,n,r,s);break e}else for(rr=zn(t.stateNode.containerInfo.firstChild),nr=t,Ge=!0,Nr=null,r=uN(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vi(),n===s){t=fn(e,t,r);break e}Dt(e,t,n,r)}t=t.child}return t;case 5:return pN(t),e===null&&ng(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Zx(n,s)?a=null:i!==null&&Zx(n,i)&&(t.flags|=32),zN(e,t),Dt(e,t,a,r),t.child;case 6:return e===null&&ng(t),null;case 13:return $N(e,t,r);case 4:return Cv(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=yi(t,null,n,r):Dt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:jr(n,s),W0(e,t,n,s,r);case 7:return Dt(e,t,t.pendingProps,r),t.child;case 8:return Dt(e,t,t.pendingProps.children,r),t.child;case 12:return Dt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,We(Gl,n._currentValue),n._currentValue=a,i!==null)if(Ar(i.value,a)){if(i.children===s.children&&!Vt.current){t=fn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=an(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),sg(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Z(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),sg(a,r,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Dt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,ui(t,r),s=gr(s),n=n(s),t.flags|=1,Dt(e,t,n,r),t.child;case 14:return n=t.type,s=jr(n,t.pendingProps),s=jr(n.type,s),H0(e,t,n,s,r);case 15:return DN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:jr(n,s),kl(e,t),t.tag=1,Gt(n)?(e=!0,Hl(t)):e=!1,ui(t,r),PN(t,n,s),og(t,n,s,r),cg(null,t,n,!0,e,r);case 19:return qN(e,t,r);case 22:return LN(e,t,r)}throw Error(Z(156,t.tag))};function nC(e,t){return Ak(e,t)}function f5(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(e,t,r,n){return new f5(e,t,r,n)}function Bv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function p5(e){if(typeof e=="function")return Bv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===av)return 11;if(e===lv)return 14}return 2}function Bn(e,t){var r=e.alternate;return r===null?(r=hr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function El(e,t,r,n,s,i){var a=2;if(n=e,typeof e=="function")Bv(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Us:return ms(r.children,s,i,t);case ov:a=8,s|=8;break;case Ax:return e=hr(12,r,t,s|2),e.elementType=Ax,e.lanes=i,e;case Rx:return e=hr(13,r,t,s),e.elementType=Rx,e.lanes=i,e;case Ix:return e=hr(19,r,t,s),e.elementType=Ix,e.lanes=i,e;case pk:return qc(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case dk:a=10;break e;case fk:a=9;break e;case av:a=11;break e;case lv:a=14;break e;case jn:a=16,n=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=hr(a,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function ms(e,t,r,n){return e=hr(7,e,n,t),e.lanes=r,e}function qc(e,t,r,n){return e=hr(22,e,n,t),e.elementType=pk,e.lanes=r,e.stateNode={isHidden:!1},e}function ed(e,t,r){return e=hr(6,e,null,t),e.lanes=r,e}function td(e,t,r){return t=hr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function h5(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mu(0),this.expirationTimes=Mu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mu(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wv(e,t,r,n,s,i,a,l,c){return e=new h5(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=hr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nv(i),e}function m5(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function sC(e){if(!e)return Gn;e=e._reactInternals;e:{if(Cs(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var r=e.type;if(Gt(r))return sN(e,r,t)}return t}function iC(e,t,r,n,s,i,a,l,c){return e=Wv(r,n,!0,e,s,i,a,l,c),e.context=sC(null),r=e.current,n=zt(),s=qn(r),i=an(n,s),i.callback=t??null,Fn(r,i,s),e.current.lanes=s,ma(e,s,n),Kt(e,n),e}function Bc(e,t,r,n){var s=t.current,i=zt(),a=qn(s);return r=sC(r),t.context===null?t.context=r:t.pendingContext=r,t=an(i,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Fn(s,t,a),e!==null&&(Tr(e,s,a,i),_l(e,s,a)),a}function nc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function rb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Hv(e,t){rb(e,t),(e=e.alternate)&&rb(e,t)}function x5(){return null}var oC=typeof reportError=="function"?reportError:function(e){console.error(e)};function Uv(e){this._internalRoot=e}Wc.prototype.render=Uv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));Bc(e,t,null,null)};Wc.prototype.unmount=Uv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;js(function(){Bc(null,e,null,null)}),t[un]=null}};function Wc(e){this._internalRoot=e}Wc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Lk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<En.length&&t!==0&&t<En[r].priority;r++);En.splice(r,0,e),r===0&&Fk(e)}};function Vv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Hc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function nb(){}function g5(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=nc(a);i.call(d)}}var a=iC(t,n,e,0,null,!1,!1,"",nb);return e._reactRootContainer=a,e[un]=a.current,Wo(e.nodeType===8?e.parentNode:e),js(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=nc(c);l.call(d)}}var c=Wv(e,0,!1,null,null,!1,!1,"",nb);return e._reactRootContainer=c,e[un]=c.current,Wo(e.nodeType===8?e.parentNode:e),js(function(){Bc(t,c,r,n)}),c}function Uc(e,t,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=nc(a);l.call(c)}}Bc(t,a,e,s)}else a=g5(r,t,e,s,n);return nc(a)}Mk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=uo(t.pendingLanes);r!==0&&(dv(t,r|1),Kt(t,st()),!(Me&6)&&(_i=st()+500,Jn()))}break;case 13:js(function(){var n=dn(e,1);if(n!==null){var s=zt();Tr(n,e,1,s)}}),Hv(e,1)}};fv=function(e){if(e.tag===13){var t=dn(e,134217728);if(t!==null){var r=zt();Tr(t,e,134217728,r)}Hv(e,134217728)}};Dk=function(e){if(e.tag===13){var t=qn(e),r=dn(e,t);if(r!==null){var n=zt();Tr(r,e,t,n)}Hv(e,t)}};Lk=function(){return $e};zk=function(e,t){var r=$e;try{return $e=e,t()}finally{$e=r}};Bx=function(e,t,r){switch(t){case"input":if(Mx(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Mc(n);if(!s)throw Error(Z(90));mk(n),Mx(n,s)}}}break;case"textarea":gk(e,r);break;case"select":t=r.value,t!=null&&oi(e,!!r.multiple,t,!1)}};Sk=Fv;kk=js;var v5={usingClientEntryPoint:!1,Events:[ga,Ys,Mc,_k,jk,Fv]},Yi={findFiberByHostInstance:ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},y5={bundleType:Yi.bundleType,version:Yi.version,rendererPackageName:Yi.rendererPackageName,rendererConfig:Yi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ek(e),e===null?null:e.stateNode},findFiberByHostInstance:Yi.findFiberByHostInstance||x5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ka=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ka.isDisabled&&Ka.supportsFiber)try{Rc=Ka.inject(y5),Br=Ka}catch{}}or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=v5;or.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vv(t))throw Error(Z(200));return m5(e,t,null,r)};or.createRoot=function(e,t){if(!Vv(e))throw Error(Z(299));var r=!1,n="",s=oC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Wv(e,1,!1,null,null,r,!1,n,s),e[un]=t.current,Wo(e.nodeType===8?e.parentNode:e),new Uv(t)};or.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=Ek(t),e=e===null?null:e.stateNode,e};or.flushSync=function(e){return js(e)};or.hydrate=function(e,t,r){if(!Hc(t))throw Error(Z(200));return Uc(null,e,t,!0,r)};or.hydrateRoot=function(e,t,r){if(!Vv(e))throw Error(Z(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=oC;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=iC(t,null,e,1,r??null,s,!1,i,a),e[un]=t.current,Wo(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Wc(t)};or.render=function(e,t,r){if(!Hc(t))throw Error(Z(200));return Uc(null,e,t,!1,r)};or.unmountComponentAtNode=function(e){if(!Hc(e))throw Error(Z(40));return e._reactRootContainer?(js(function(){Uc(null,null,e,!1,function(){e._reactRootContainer=null,e[un]=null})}),!0):!1};or.unstable_batchedUpdates=Fv;or.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Hc(r))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return Uc(e,t,r,!1,n)};or.version="18.3.1-next-f1338f8080-20240426";function aC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aC)}catch(e){console.error(e)}}aC(),ak.exports=or;var ri=ak.exports,sb=ri;Ex.createRoot=sb.createRoot,Ex.hydrateRoot=sb.hydrateRoot;const Ya={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},b5=180,w5=400,_5=260,j5=48;function S5(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function k5({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:s,onToggleShowArchived:i,userSection:a}){const[l,c]=m.useState(!1),[d,u]=m.useState(_5),[f,p]=m.useState(!1),h=m.useRef(null),v=m.useRef(null);m.useEffect(()=>{v.current&&v.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const x=m.useMemo(()=>Object.values(e).sort((k,N)=>{const S=(k.name||"").localeCompare(N.name||"");return S!==0?S:(k.projectId||"").localeCompare(N.projectId||"")}),[e]),w=()=>{n()},g=m.useCallback(k=>{k.preventDefault(),p(!0)},[]),y=m.useCallback(k=>{if(!f)return;const N=Math.min(w5,Math.max(b5,k.clientX));u(N)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const j=l?j5:d;return o.jsxs("div",{ref:h,className:"h-full flex flex-col relative",onWheel:k=>k.stopPropagation(),style:{width:j,minWidth:j,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[o.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),o.jsx("button",{onClick:i,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:s?"#f59e0b":"var(--text-muted)"},title:s?"Hide archived":"Show archived",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),o.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:o.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&o.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:x.map(k=>{const N=t===k.id;return o.jsxs("div",{ref:N?v:null,onClick:()=>r(k.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:N?"var(--state-active-bg)":"transparent",border:N?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:N?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:N?"#ffffff":Ya[k.status]||Ya.queued}}),o.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:N?"#ffffff":"var(--text-primary)"},children:k.name}),k.isArchived&&o.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:N?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),o.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[o.jsx("span",{className:"text-[10px] font-mono",style:{color:N?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:k.projectId}),o.jsx("span",{className:"text-[10px]",style:{color:N?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:S5(k.createdAt)})]})]},k.id)})}),l&&o.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:x.map(k=>o.jsx("div",{onClick:()=>r(k.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:k.name,children:o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:Ya[k.status]||Ya.queued,boxShadow:t===k.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},k.id))}),!l&&o.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:w,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[o.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),o.jsx("span",{children:"New Project"})]})}),l&&o.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:o.jsx("button",{onClick:w,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:o.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),a,!l&&o.jsx("div",{onMouseDown:g,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function lC({stations:e,dormant:t}){if(!(e!=null&&e.length))return null;const r=e.reduce((l,c,d)=>c.state==="complete"?d:l,-1),n=e.findIndex(l=>l.state==="active"),s=e.find(l=>l.state==="active"),i=s==null?void 0:s.currentStep,a="var(--state-queued-bg)";return o.jsxs("div",{className:"mt-2",style:t?{opacity:.45}:void 0,children:[o.jsxs("div",{className:"relative flex items-start",children:[o.jsx("div",{className:"absolute h-0.5 left-0 right-0",style:{top:5,background:a}}),!t&&r>=0&&o.jsx("div",{className:"absolute h-0.5 left-0",style:{top:5,width:`${(r+.5)/e.length*100}%`,background:"var(--state-stabilized-bg)"}}),!t&&n>=0&&o.jsx("div",{className:"absolute h-0.5",style:{top:5,left:r>=0?`${(r+.5)/e.length*100}%`:"0%",width:r>=0?`${(n-r)/e.length*100}%`:`${(n+.5)/e.length*100}%`,background:"var(--state-active-bg)"}}),e.map(l=>{const c=!t&&l.state==="active",d=!t&&l.state==="complete",u=t?a:d?"var(--state-stabilized-bg)":c?"var(--state-active-bg)":l.state==="failed"?"var(--state-blocked-bg)":a,f=c?"var(--state-active-text)":"var(--text-muted)";return o.jsxs("div",{className:"flex-1 flex flex-col items-center relative z-10",children:[o.jsx("div",{className:`w-3 h-3 rounded-full${c?" station-active":""}${c&&l.needs_input?" station-needs-input":""}`,style:{background:u,boxShadow:c&&l.needs_input?"0 0 0 2px var(--state-active-bg)":void 0}}),o.jsx("span",{className:"text-[7px] mt-0.5",style:{color:c&&l.needs_input?"var(--state-active-text)":f,fontWeight:c?500:400},children:l.label})]},l.id)})]}),!t&&i&&o.jsx("div",{className:"text-center text-[8px] mt-1 font-medium",style:{color:"var(--state-active-text)"},children:i.name})]})}const N5=[{id:"pgc",label:"PGC",state:"queued"},{id:"draft",label:"DRAFT",state:"queued"},{id:"qa",label:"QA",state:"queued"},{id:"done",label:"DONE",state:"queued"}];function wg(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const cC={blocked:{bg:"var(--state-blocked-bg)",text:"var(--state-blocked-text)"},in_progress:{bg:"var(--state-active-bg)",text:"var(--state-active-text)"},ready:{bg:"var(--state-ready-bg)",text:"var(--state-ready-text)"},stabilized:{bg:"var(--state-stabilized-bg)",text:"var(--state-stabilized-text)"}},C5={blocked:"Blocked",in_progress:"In Progress",ready:"Ready",stabilized:"Stabilized"},ib={implementation_plan:"Implementation Plan",project_discovery:"Project Discovery",technical_architecture:"Technical Architecture",concierge_intake:"Concierge Intake"};function E5(e){return e?ib[e]?ib[e]:e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):""}function T5({item:e,isSelected:t,onClick:r}){var p,h;const n=e.state||"ready_for_production",s=wg(n),i=cC[s],a=C5[s],l=s==="blocked",c=s==="in_progress",d=e.id==="work_package",u=d?"WORK BINDER":"DOCUMENT",f=d?"subway-node-header-wp":"subway-node-header-doc";return o.jsxs("div",{className:`subway-node rounded-lg border overflow-hidden cursor-pointer transition-all ${c?"node-active":""}`,style:{borderColor:t?"var(--accent, #7c3aed)":i.bg,borderWidth:t?2:1,boxShadow:t?"0 0 0 2px var(--accent, rgba(124,58,237,0.3))":void 0},onClick:r,children:[o.jsxs("div",{className:`${f} border-b px-3 py-1.5 flex items-center gap-2`,children:[o.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:d?"var(--header-text-wp, var(--header-text-doc))":"var(--header-text-doc)"},children:u}),o.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:d?"Work Binder":E5(e.id)})]}),o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-5 h-5 rounded-full flex-shrink-0",style:{backgroundColor:i.bg}}),o.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:i.text},children:a})]}),!d&&o.jsx(lC,{stations:((p=e.stations)==null?void 0:p.length)>0?e.stations:N5,dormant:l||!(((h=e.stations)==null?void 0:h.length)>0)})]})]})}function A5({sourceState:e,targetState:t,theme:r}){var l;const s=wg(t||"ready_for_production")==="blocked"?t:e,i=wg(s||"ready_for_production"),a=((l=cC[i])==null?void 0:l.bg)||"var(--state-queued-bg)";return o.jsx("div",{className:"flex justify-center",style:{height:24},children:o.jsx("div",{style:{width:3,height:"100%",background:a,borderRadius:2}})})}function R5({data:e,selectedNodeId:t,onSelectNode:r,theme:n}){const s=e.filter(i=>(i.level||1)===1);return s.length===0?null:o.jsx("div",{className:"flex flex-col gap-0 px-4 py-3",children:s.map((i,a)=>{var l;return o.jsxs("div",{children:[o.jsx(T5,{item:i,isSelected:t===i.id,onClick:()=>r(i.id)}),a<s.length-1&&o.jsx(A5,{sourceState:i.state,targetState:(l=s[a+1])==null?void 0:l.state,theme:n})]},i.id)})})}const Gv="/api/v1";class I5 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function P5(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function ve(e,t={}){const r=`${Gv}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},s=await fetch(r,n);if(!s.ok){const i=await s.json().catch(()=>({}));throw new I5(i.detail||`Request failed: ${s.status}`,s.status,i)}return s.status===204?null:s.json()}const De={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":P5()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return ve(`/projects${r?"?"+r:""}`)},getProject:e=>ve(`/projects/${e}`),getProjectTree:e=>ve(`/projects/${e}/tree`),createProject:e=>ve("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>ve(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),saveFloorLayout:(e,t)=>ve(`/projects/${e}`,{method:"PATCH",body:JSON.stringify({metadata:{floor_layout:t}})}),archiveProject:e=>ve(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>ve(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>ve(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>ve(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),ve(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>ve(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>ve(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),getExecutions:()=>ve("/executions"),getExecution:e=>ve(`/executions/${e}`),getExecutionTranscript:e=>ve(`/executions/${e}/transcript`),getExecutionQACoverage:e=>ve(`/executions/${e}/qa-coverage`),getDocumentWorkflowExecutions:()=>ve("/document-workflows/executions"),getDocumentWorkflowExecution:e=>ve(`/document-workflows/executions/${e}`),startWorkflow:(e,t,r=null)=>ve("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>ve(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>ve(`/document-workflows/executions/${e}`),getPgcAnswers:e=>ve(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return ve(`/projects/${e}/documents/${t}${n}`)},getDocumentRenderModel:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return ve(`/projects/${e}/documents/${t}/render-model${n}`)},getDocumentPgc:(e,t,r)=>{const n=r?`?instance_id=${encodeURIComponent(r)}`:"";return ve(`/projects/${e}/documents/${t}/pgc${n}`)},getWorkPackages:e=>ve(`/projects/${e}/work-packages`),generateWorkPackages:e=>ve(`/projects/${e}/work-packages/generate`,{method:"POST"}),getWorkStatements:(e,t)=>ve(`/projects/${e}/work-packages/${t}/work-statements`),generateWorkStatements:(e,t)=>ve(`/projects/${e}/work-packages/${t}/work-statements/generate`,{method:"POST"}),startIntake:()=>ve("/intake/start",{method:"POST"}),getIntakeState:e=>ve(`/intake/${e}`),submitIntakeMessage:(e,t)=>ve(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>ve(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>ve(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>ve(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>ve(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>ve(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>ve(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>ve(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>ve(`/projects/${e}/workflow/complete`,{method:"POST"}),createIntent:(e,t)=>ve("/intents",{method:"POST",body:JSON.stringify({project_id:e,...t})}),getIntent:e=>ve(`/intents/${e}`)};function O5(e){const t=`${Gv}/production/events?project_id=${e}`;return new EventSource(t)}function M5(e){const t=`${Gv}/intake/${e}/events`;return new EventSource(t)}function D5(e){return`/auth/login/${e}`}function L5({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"var(--text-secondary)",whiteSpace:"pre-line"},children:r}),t.detail_ref&&o.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function ob({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const s=n==="numbered"?"decimal":"disc";return o.jsxs("div",{style:{marginBottom:12},children:[t.title&&o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),o.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":s},children:r.map((i,a)=>o.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"var(--text-secondary)",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&o.jsx("span",{style:{color:"#10b981"},children:""}),typeof i=="string"?i:typeof i=="object"&&i!==null?o.jsx(z5,{item:i}):String(i)]},(i==null?void 0:i.id)||a))})]})}function z5({item:e}){const t=e.value||e.text||e.constraint||e.assumption||e.guardrail||e.recommendation||e.question||e.description||e.statement||e.name;return t?o.jsxs("span",{children:[e.id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"var(--text-dim)",marginRight:6},children:e.id}),t,e.constraint_type&&o.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",background:"var(--bg-button)",borderRadius:4,color:"var(--text-muted)"},children:e.constraint_type}),e.confidence&&o.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:e.confidence==="high"?"#dcfce7":e.confidence==="medium"?"#fef3c7":"#fee2e2",color:e.confidence==="high"?"#166534":e.confidence==="medium"?"#92400e":"#991b1b"},children:e.confidence}),e.validation_approach&&o.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:2},children:[o.jsx("span",{style:{fontWeight:500},children:"Validation:"})," ",e.validation_approach]})]}):o.jsx("span",{children:Object.entries(e).map(([r,n],s)=>o.jsxs("span",{children:[s>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[r,":"]})," ",typeof n=="string"?n:JSON.stringify(n)]},r))})}function F5({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,i={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return o.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&o.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)",fontWeight:500},children:[n,":"]}),o.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:i.bg,color:i.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function uC({block:e}){const{data:t}=e,r=t.text||t.question||t.decision_area,{id:n,blocking:s,priority:i,tags:a,options:l}=t,c=t.why_it_matters||t.why_early,d=t.directed_to,u=t.recommendation_direction,f={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},p=f[i]||f.should;return o.jsx("div",{style:{padding:"12px 16px",background:s?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${s?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"var(--text-muted)",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:n}),o.jsxs("div",{style:{flex:1},children:[o.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"var(--text-primary)",marginBottom:6},children:r}),c&&o.jsx("p",{style:{margin:0,fontSize:12,color:"var(--text-muted)",fontStyle:"italic"},children:c}),o.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[s&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),d&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:d.replace(/_/g," ")}),i&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:p.bg,color:p.text,textTransform:"uppercase"},children:i}),a==null?void 0:a.map((h,v)=>o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:h},v))]}),l&&l.length>0&&o.jsxs("div",{style:{marginTop:8},children:[o.jsx("span",{style:{fontSize:11,color:"var(--text-muted)",fontWeight:500},children:"Options: "}),l.map((h,v)=>o.jsx("span",{style:{fontSize:11,color:"var(--text-secondary)",marginLeft:v>0?8:4},children:h},v))]}),u&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:"#059669"},children:["Recommendation: ",u]})]})]})})}function $5({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,s=t.blocking_count||r.filter(i=>i.blocking).length;return r.length===0?o.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"var(--bg-panel)",borderRadius:6,fontSize:12},children:[o.jsxs("span",{style:{color:"var(--text-muted)"},children:[o.jsx("strong",{style:{color:"var(--text-secondary)"},children:n})," questions"]}),s>0&&o.jsxs("span",{style:{color:"#dc2626"},children:[o.jsx("strong",{children:s})," blocking"]})]}),r.map((i,a)=>o.jsx(uC,{block:{type:"schema:OpenQuestionV1",data:i}},i.id||a))]})}function ab({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const s={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return o.jsxs("div",{style:{marginBottom:12},children:[n&&o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((i,a)=>{const l=i.severity||i.impact||i.likelihood||"medium",c=s[l]||s.medium;return o.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[i.id&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:i.id}),o.jsxs("div",{style:{flex:1},children:[o.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:i.risk||i.description||i.reason||JSON.stringify(i)}),i.impact&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",i.impact]}),i.impact_on_planning&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Planning impact: ",i.impact_on_planning]}),(i.mitigation||i.mitigation_direction)&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",i.mitigation||i.mitigation_direction]}),i.status&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:11,color:c.text,opacity:.7,textTransform:"capitalize"},children:["Status: ",i.status]})]}),o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},i.id||a)})})]})}function q5({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition",refined_description:"Description",architectural_style:"Architectural Style",style:"Architectural Style"}).filter(([s])=>t[s]&&typeof t[s]=="string").map(([s,i])=>({title:i,content:t[s]}));return n.length===0&&!t.title?null:o.jsxs("div",{style:{marginBottom:12},children:[t.title&&o.jsx("h3",{style:{fontSize:16,fontWeight:600,color:"var(--text-primary)",marginBottom:12},children:t.title}),n.map((s,i)=>o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:s.title}),o.jsx("div",{style:{padding:"12px 16px",background:"var(--bg-panel)",borderRadius:6,borderLeft:"3px solid #6366f1"},children:o.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"var(--text-secondary)",whiteSpace:"pre-line"},children:s.content})})]},i))]})}function B5({block:e}){const{data:t}=e,{story_id:r,title:n,intent:s,phase:i,risk_level:a,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[a]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[i]||u.mvp;return o.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid var(--border-node)",marginBottom:8},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[o.jsxs("div",{style:{flex:1},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),o.jsx("span",{style:{fontSize:13,fontWeight:500,color:"var(--text-primary)"},children:n})]}),s&&o.jsx("p",{style:{margin:0,fontSize:12,color:"var(--text-muted)",lineHeight:1.4},children:s})]}),o.jsxs("div",{style:{display:"flex",gap:4},children:[i&&o.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:i}),d&&o.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:a})]})]})})}function W5({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=t.technology||(Array.isArray(t.technology_choices)?t.technology_choices.join(", "):null),n=t.interfaces||[],s=t.dependencies||t.depends_on_components||[],i=t.responsibilities||[],a=t.layer,l=t.mvp_phase,c={fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:2},d={fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,margin:0},u=(f,p)=>({fontSize:12,padding:"2px 8px",background:f,color:p,borderRadius:4});return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"var(--bg-panel)",borderRadius:8,border:"1px solid var(--border-node)"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),a&&o.jsx("span",{style:u("#f0fdf4","#166534"),children:a}),l&&o.jsx("span",{style:u("#eff6ff","#1e40af"),children:l})]}),t.purpose&&o.jsx("p",{style:{...d,marginBottom:10,color:"#475569"},children:t.purpose}),r&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Technology"}),o.jsx("p",{style:d,children:r})]}),Array.isArray(i)&&i.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Responsibilities"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:i.map((f,p)=>o.jsx("li",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:f},p))})]}),Array.isArray(n)&&n.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Interfaces"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:n.map((f,p)=>o.jsx("span",{style:u("#e0e7ff","#3730a3"),children:f},p))})]}),Array.isArray(s)&&s.length>0&&o.jsxs("div",{children:[o.jsx("div",{style:c,children:"Dependencies"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:s.map((f,p)=>o.jsx("span",{style:u("#fef3c7","#92400e"),children:f},p))})]})]})}function Qt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Qt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var dC={exports:{}},fC={},pC={exports:{}},hC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ji=m;function H5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var U5=typeof Object.is=="function"?Object.is:H5,V5=ji.useState,G5=ji.useEffect,K5=ji.useLayoutEffect,Y5=ji.useDebugValue;function Q5(e,t){var r=t(),n=V5({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return K5(function(){s.value=r,s.getSnapshot=t,rd(s)&&i({inst:s})},[e,r,t]),G5(function(){return rd(s)&&i({inst:s}),e(function(){rd(s)&&i({inst:s})})},[e]),Y5(r),r}function rd(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!U5(e,r)}catch{return!0}}function X5(e,t){return t()}var Z5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?X5:Q5;hC.useSyncExternalStore=ji.useSyncExternalStore!==void 0?ji.useSyncExternalStore:Z5;pC.exports=hC;var J5=pC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vc=m,eI=J5;function tI(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rI=typeof Object.is=="function"?Object.is:tI,nI=eI.useSyncExternalStore,sI=Vc.useRef,iI=Vc.useEffect,oI=Vc.useMemo,aI=Vc.useDebugValue;fC.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=sI(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=oI(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),s!==void 0&&a.hasValue){var v=a.value;if(s(v,h))return f=v}return f=h}if(v=f,rI(u,h))return v;var x=n(h);return s!==void 0&&s(v,x)?(u=h,v):(u=h,f=x)}var d=!1,u,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,s]);var l=nI(e,i[0],i[1]);return iI(function(){a.hasValue=!0,a.value=l},[l]),aI(l),l};dC.exports=fC;var lI=dC.exports;const cI=Zg(lI),uI={},lb=e=>{let t;const r=new Set,n=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(v=>v(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>d,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(uI?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,s,c);return c},dI=e=>e?lb(e):lb,{useDebugValue:fI}=Y,{useSyncExternalStoreWithSelector:pI}=cI,hI=e=>e;function mC(e,t=hI,r){const n=pI(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return fI(n),n}const cb=(e,t)=>{const r=dI(e),n=(s,i=t)=>mC(r,s,i);return Object.assign(n,r),n},mI=(e,t)=>e?cb(e,t):cb;function Pt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var xI={value:()=>{}};function Gc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Tl(r)}function Tl(e){this._=e}function gI(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Tl.prototype=Gc.prototype={constructor:Tl,on:function(e,t){var r=this._,n=gI(e+"",r),s,i=-1,a=n.length;if(arguments.length<2){for(;++i<a;)if((s=(e=n[i]).type)&&(s=vI(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=n[i]).type)r[s]=ub(r[s],e.name,t);else if(t==null)for(s in r)r[s]=ub(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Tl(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,i;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,s=i.length;n<s;++n)i[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],s=0,i=n.length;s<i;++s)n[s].value.apply(t,r)}};function vI(e,t){for(var r=0,n=e.length,s;r<n;++r)if((s=e[r]).name===t)return s.value}function ub(e,t,r){for(var n=0,s=e.length;n<s;++n)if(e[n].name===t){e[n]=xI,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var _g="http://www.w3.org/1999/xhtml";const db={svg:"http://www.w3.org/2000/svg",xhtml:_g,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Kc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),db.hasOwnProperty(t)?{space:db[t],local:e}:e}function yI(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===_g&&t.documentElement.namespaceURI===_g?t.createElement(e):t.createElementNS(r,e)}}function bI(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xC(e){var t=Kc(e);return(t.local?bI:yI)(t)}function wI(){}function Kv(e){return e==null?wI:function(){return this.querySelector(e)}}function _I(e){typeof e!="function"&&(e=Kv(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var i=t[s],a=i.length,l=n[s]=new Array(a),c,d,u=0;u<a;++u)(c=i[u])&&(d=e.call(c,c.__data__,u,i))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new ir(n,this._parents)}function jI(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function SI(){return[]}function gC(e){return e==null?SI:function(){return this.querySelectorAll(e)}}function kI(e){return function(){return jI(e.apply(this,arguments))}}function NI(e){typeof e=="function"?e=kI(e):e=gC(e);for(var t=this._groups,r=t.length,n=[],s=[],i=0;i<r;++i)for(var a=t[i],l=a.length,c,d=0;d<l;++d)(c=a[d])&&(n.push(e.call(c,c.__data__,d,a)),s.push(c));return new ir(n,s)}function vC(e){return function(){return this.matches(e)}}function yC(e){return function(t){return t.matches(e)}}var CI=Array.prototype.find;function EI(e){return function(){return CI.call(this.children,e)}}function TI(){return this.firstElementChild}function AI(e){return this.select(e==null?TI:EI(typeof e=="function"?e:yC(e)))}var RI=Array.prototype.filter;function II(){return Array.from(this.children)}function PI(e){return function(){return RI.call(this.children,e)}}function OI(e){return this.selectAll(e==null?II:PI(typeof e=="function"?e:yC(e)))}function MI(e){typeof e!="function"&&(e=vC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var i=t[s],a=i.length,l=n[s]=[],c,d=0;d<a;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&l.push(c);return new ir(n,this._parents)}function bC(e){return new Array(e.length)}function DI(){return new ir(this._enter||this._groups.map(bC),this._parents)}function sc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}sc.prototype={constructor:sc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function LI(e){return function(){return e}}function zI(e,t,r,n,s,i){for(var a=0,l,c=t.length,d=i.length;a<d;++a)(l=t[a])?(l.__data__=i[a],n[a]=l):r[a]=new sc(e,i[a]);for(;a<c;++a)(l=t[a])&&(s[a]=l)}function FI(e,t,r,n,s,i,a){var l,c,d=new Map,u=t.length,f=i.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=a.call(c,c.__data__,l,t)+"",d.has(h)?s[l]=c:d.set(h,c));for(l=0;l<f;++l)h=a.call(e,i[l],l,i)+"",(c=d.get(h))?(n[l]=c,c.__data__=i[l],d.delete(h)):r[l]=new sc(e,i[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(s[l]=c)}function $I(e){return e.__data__}function qI(e,t){if(!arguments.length)return Array.from(this,$I);var r=t?FI:zI,n=this._parents,s=this._groups;typeof e!="function"&&(e=LI(e));for(var i=s.length,a=new Array(i),l=new Array(i),c=new Array(i),d=0;d<i;++d){var u=n[d],f=s[d],p=f.length,h=BI(e.call(u,u&&u.__data__,d,n)),v=h.length,x=l[d]=new Array(v),w=a[d]=new Array(v),g=c[d]=new Array(p);r(u,f,x,w,g,h,t);for(var y=0,b=0,j,k;y<v;++y)if(j=x[y]){for(y>=b&&(b=y+1);!(k=w[b])&&++b<v;);j._next=k||null}}return a=new ir(a,n),a._enter=l,a._exit=c,a}function BI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function WI(){return new ir(this._exit||this._groups.map(bC),this._parents)}function HI(e,t,r){var n=this.enter(),s=this,i=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?i.remove():r(i),n&&s?n.merge(s).order():s}function UI(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,s=r.length,i=n.length,a=Math.min(s,i),l=new Array(s),c=0;c<a;++c)for(var d=r[c],u=n[c],f=d.length,p=l[c]=new Array(f),h,v=0;v<f;++v)(h=d[v]||u[v])&&(p[v]=h);for(;c<s;++c)l[c]=r[c];return new ir(l,this._parents)}function VI(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],s=n.length-1,i=n[s],a;--s>=0;)(a=n[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function GI(e){e||(e=KI);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,s=new Array(n),i=0;i<n;++i){for(var a=r[i],l=a.length,c=s[i]=new Array(l),d,u=0;u<l;++u)(d=a[u])&&(c[u]=d);c.sort(t)}return new ir(s,this._parents).order()}function KI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function YI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function QI(){return Array.from(this)}function XI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,i=n.length;s<i;++s){var a=n[s];if(a)return a}return null}function ZI(){let e=0;for(const t of this)++e;return e}function JI(){return!this.node()}function eP(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var s=t[r],i=0,a=s.length,l;i<a;++i)(l=s[i])&&e.call(l,l.__data__,i,s);return this}function tP(e){return function(){this.removeAttribute(e)}}function rP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function nP(e,t){return function(){this.setAttribute(e,t)}}function sP(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function iP(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function oP(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function aP(e,t){var r=Kc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?rP:tP:typeof t=="function"?r.local?oP:iP:r.local?sP:nP)(r,t))}function wC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function lP(e){return function(){this.style.removeProperty(e)}}function cP(e,t,r){return function(){this.style.setProperty(e,t,r)}}function uP(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function dP(e,t,r){return arguments.length>1?this.each((t==null?lP:typeof t=="function"?uP:cP)(e,t,r??"")):Si(this.node(),e)}function Si(e,t){return e.style.getPropertyValue(t)||wC(e).getComputedStyle(e,null).getPropertyValue(t)}function fP(e){return function(){delete this[e]}}function pP(e,t){return function(){this[e]=t}}function hP(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function mP(e,t){return arguments.length>1?this.each((t==null?fP:typeof t=="function"?hP:pP)(e,t)):this.node()[e]}function _C(e){return e.trim().split(/^|\s+/)}function Yv(e){return e.classList||new jC(e)}function jC(e){this._node=e,this._names=_C(e.getAttribute("class")||"")}jC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function SC(e,t){for(var r=Yv(e),n=-1,s=t.length;++n<s;)r.add(t[n])}function kC(e,t){for(var r=Yv(e),n=-1,s=t.length;++n<s;)r.remove(t[n])}function xP(e){return function(){SC(this,e)}}function gP(e){return function(){kC(this,e)}}function vP(e,t){return function(){(t.apply(this,arguments)?SC:kC)(this,e)}}function yP(e,t){var r=_C(e+"");if(arguments.length<2){for(var n=Yv(this.node()),s=-1,i=r.length;++s<i;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?vP:t?xP:gP)(r,t))}function bP(){this.textContent=""}function wP(e){return function(){this.textContent=e}}function _P(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function jP(e){return arguments.length?this.each(e==null?bP:(typeof e=="function"?_P:wP)(e)):this.node().textContent}function SP(){this.innerHTML=""}function kP(e){return function(){this.innerHTML=e}}function NP(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function CP(e){return arguments.length?this.each(e==null?SP:(typeof e=="function"?NP:kP)(e)):this.node().innerHTML}function EP(){this.nextSibling&&this.parentNode.appendChild(this)}function TP(){return this.each(EP)}function AP(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function RP(){return this.each(AP)}function IP(e){var t=typeof e=="function"?e:xC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function PP(){return null}function OP(e,t){var r=typeof e=="function"?e:xC(e),n=t==null?PP:typeof t=="function"?t:Kv(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function MP(){var e=this.parentNode;e&&e.removeChild(this)}function DP(){return this.each(MP)}function LP(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function zP(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function FP(e){return this.select(e?zP:LP)}function $P(e){return arguments.length?this.property("__data__",e):this.node().__data__}function qP(e){return function(t){e.call(this,t,this.__data__)}}function BP(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function WP(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,s=t.length,i;r<s;++r)i=t[r],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++n]=i;++n?t.length=n:delete this.__on}}}function HP(e,t,r){return function(){var n=this.__on,s,i=qP(t);if(n){for(var a=0,l=n.length;a<l;++a)if((s=n[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=r),s.value=t;return}}this.addEventListener(e.type,i,r),s={type:e.type,name:e.name,value:t,listener:i,options:r},n?n.push(s):this.__on=[s]}}function UP(e,t,r){var n=BP(e+""),s,i=n.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(s=0,u=l[c];s<i;++s)if((a=n[s]).type===u.type&&a.name===u.name)return u.value}return}for(l=t?HP:WP,s=0;s<i;++s)this.each(l(n[s],t,r));return this}function NC(e,t,r){var n=wC(e),s=n.CustomEvent;typeof s=="function"?s=new s(t,r):(s=n.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function VP(e,t){return function(){return NC(this,e,t)}}function GP(e,t){return function(){return NC(this,e,t.apply(this,arguments))}}function KP(e,t){return this.each((typeof t=="function"?GP:VP)(e,t))}function*YP(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,i=n.length,a;s<i;++s)(a=n[s])&&(yield a)}var CC=[null];function ir(e,t){this._groups=e,this._parents=t}function ya(){return new ir([[document.documentElement]],CC)}function QP(){return this}ir.prototype=ya.prototype={constructor:ir,select:_I,selectAll:NI,selectChild:AI,selectChildren:OI,filter:MI,data:qI,enter:DI,exit:WI,join:HI,merge:UI,selection:QP,order:VI,sort:GI,call:YI,nodes:QI,node:XI,size:ZI,empty:JI,each:eP,attr:aP,style:dP,property:mP,classed:yP,text:jP,html:CP,raise:TP,lower:RP,append:IP,insert:OP,remove:DP,clone:FP,datum:$P,on:UP,dispatch:KP,[Symbol.iterator]:YP};function pr(e){return typeof e=="string"?new ir([[document.querySelector(e)]],[document.documentElement]):new ir([[e]],CC)}function XP(e){let t;for(;t=e.sourceEvent;)e=t;return e}function kr(e,t){if(e=XP(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const ZP={passive:!1},Zo={capture:!0,passive:!1};function nd(e){e.stopImmediatePropagation()}function fi(e){e.preventDefault(),e.stopImmediatePropagation()}function EC(e){var t=e.document.documentElement,r=pr(e).on("dragstart.drag",fi,Zo);"onselectstart"in t?r.on("selectstart.drag",fi,Zo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function TC(e,t){var r=e.document.documentElement,n=pr(e).on("dragstart.drag",null);t&&(n.on("click.drag",fi,Zo),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Qa=e=>()=>e;function jg(e,{sourceEvent:t,subject:r,target:n,identifier:s,active:i,x:a,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}jg.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function JP(e){return!e.ctrlKey&&!e.button}function eO(){return this.parentNode}function tO(e,t){return t??{x:e.x,y:e.y}}function rO(){return navigator.maxTouchPoints||"ontouchstart"in this}function nO(){var e=JP,t=eO,r=tO,n=rO,s={},i=Gc("start","drag","end"),a=0,l,c,d,u,f=0;function p(j){j.on("mousedown.drag",h).filter(n).on("touchstart.drag",w).on("touchmove.drag",g,ZP).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(j,k){if(!(u||!e.call(this,j,k))){var N=b(this,t.call(this,j,k),j,k,"mouse");N&&(pr(j.view).on("mousemove.drag",v,Zo).on("mouseup.drag",x,Zo),EC(j.view),nd(j),d=!1,l=j.clientX,c=j.clientY,N("start",j))}}function v(j){if(fi(j),!d){var k=j.clientX-l,N=j.clientY-c;d=k*k+N*N>f}s.mouse("drag",j)}function x(j){pr(j.view).on("mousemove.drag mouseup.drag",null),TC(j.view,d),fi(j),s.mouse("end",j)}function w(j,k){if(e.call(this,j,k)){var N=j.changedTouches,S=t.call(this,j,k),C=N.length,_,R;for(_=0;_<C;++_)(R=b(this,S,j,k,N[_].identifier,N[_]))&&(nd(j),R("start",j,N[_]))}}function g(j){var k=j.changedTouches,N=k.length,S,C;for(S=0;S<N;++S)(C=s[k[S].identifier])&&(fi(j),C("drag",j,k[S]))}function y(j){var k=j.changedTouches,N=k.length,S,C;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),S=0;S<N;++S)(C=s[k[S].identifier])&&(nd(j),C("end",j,k[S]))}function b(j,k,N,S,C,_){var R=i.copy(),T=kr(_||N,k),D,$,E;if((E=r.call(j,new jg("beforestart",{sourceEvent:N,target:p,identifier:C,active:a,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),S))!=null)return D=E.x-T[0]||0,$=E.y-T[1]||0,function L(A,P,M){var I=T,O;switch(A){case"start":s[C]=L,O=a++;break;case"end":delete s[C],--a;case"drag":T=kr(M||P,k),O=a;break}R.call(A,j,new jg(A,{sourceEvent:P,subject:E,target:p,identifier:C,active:O,x:T[0]+D,y:T[1]+$,dx:T[0]-I[0],dy:T[1]-I[1],dispatch:R}),S)}}return p.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Qa(!!j),p):e},p.container=function(j){return arguments.length?(t=typeof j=="function"?j:Qa(j),p):t},p.subject=function(j){return arguments.length?(r=typeof j=="function"?j:Qa(j),p):r},p.touchable=function(j){return arguments.length?(n=typeof j=="function"?j:Qa(!!j),p):n},p.on=function(){var j=i.on.apply(i,arguments);return j===i?p:j},p.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,p):Math.sqrt(f)},p}function Qv(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function AC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ba(){}var Jo=.7,ic=1/Jo,pi="\\s*([+-]?\\d+)\\s*",ea="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",sO=/^#([0-9a-f]{3,8})$/,iO=new RegExp(`^rgb\\(${pi},${pi},${pi}\\)$`),oO=new RegExp(`^rgb\\(${Hr},${Hr},${Hr}\\)$`),aO=new RegExp(`^rgba\\(${pi},${pi},${pi},${ea}\\)$`),lO=new RegExp(`^rgba\\(${Hr},${Hr},${Hr},${ea}\\)$`),cO=new RegExp(`^hsl\\(${ea},${Hr},${Hr}\\)$`),uO=new RegExp(`^hsla\\(${ea},${Hr},${Hr},${ea}\\)$`),fb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Qv(ba,ta,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:pb,formatHex:pb,formatHex8:dO,formatHsl:fO,formatRgb:hb,toString:hb});function pb(){return this.rgb().formatHex()}function dO(){return this.rgb().formatHex8()}function fO(){return RC(this).formatHsl()}function hb(){return this.rgb().formatRgb()}function ta(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=sO.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?mb(t):r===3?new Ht(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Xa(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Xa(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=iO.exec(e))?new Ht(t[1],t[2],t[3],1):(t=oO.exec(e))?new Ht(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=aO.exec(e))?Xa(t[1],t[2],t[3],t[4]):(t=lO.exec(e))?Xa(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=cO.exec(e))?vb(t[1],t[2]/100,t[3]/100,1):(t=uO.exec(e))?vb(t[1],t[2]/100,t[3]/100,t[4]):fb.hasOwnProperty(e)?mb(fb[e]):e==="transparent"?new Ht(NaN,NaN,NaN,0):null}function mb(e){return new Ht(e>>16&255,e>>8&255,e&255,1)}function Xa(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ht(e,t,r,n)}function pO(e){return e instanceof ba||(e=ta(e)),e?(e=e.rgb(),new Ht(e.r,e.g,e.b,e.opacity)):new Ht}function Sg(e,t,r,n){return arguments.length===1?pO(e):new Ht(e,t,r,n??1)}function Ht(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Qv(Ht,Sg,AC(ba,{brighter(e){return e=e==null?ic:Math.pow(ic,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ht(xs(this.r),xs(this.g),xs(this.b),oc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xb,formatHex:xb,formatHex8:hO,formatRgb:gb,toString:gb}));function xb(){return`#${ds(this.r)}${ds(this.g)}${ds(this.b)}`}function hO(){return`#${ds(this.r)}${ds(this.g)}${ds(this.b)}${ds((isNaN(this.opacity)?1:this.opacity)*255)}`}function gb(){const e=oc(this.opacity);return`${e===1?"rgb(":"rgba("}${xs(this.r)}, ${xs(this.g)}, ${xs(this.b)}${e===1?")":`, ${e})`}`}function oc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ds(e){return e=xs(e),(e<16?"0":"")+e.toString(16)}function vb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Cr(e,t,r,n)}function RC(e){if(e instanceof Cr)return new Cr(e.h,e.s,e.l,e.opacity);if(e instanceof ba||(e=ta(e)),!e)return new Cr;if(e instanceof Cr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),i=Math.max(t,r,n),a=NaN,l=i-s,c=(i+s)/2;return l?(t===i?a=(r-n)/l+(r<n)*6:r===i?a=(n-t)/l+2:a=(t-r)/l+4,l/=c<.5?i+s:2-i-s,a*=60):l=c>0&&c<1?0:a,new Cr(a,l,c,e.opacity)}function mO(e,t,r,n){return arguments.length===1?RC(e):new Cr(e,t,r,n??1)}function Cr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Qv(Cr,mO,AC(ba,{brighter(e){return e=e==null?ic:Math.pow(ic,e),new Cr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Cr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new Ht(sd(e>=240?e-240:e+120,s,n),sd(e,s,n),sd(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new Cr(yb(this.h),Za(this.s),Za(this.l),oc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=oc(this.opacity);return`${e===1?"hsl(":"hsla("}${yb(this.h)}, ${Za(this.s)*100}%, ${Za(this.l)*100}%${e===1?")":`, ${e})`}`}}));function yb(e){return e=(e||0)%360,e<0?e+360:e}function Za(e){return Math.max(0,Math.min(1,e||0))}function sd(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const IC=e=>()=>e;function xO(e,t){return function(r){return e+r*t}}function gO(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function vO(e){return(e=+e)==1?PC:function(t,r){return r-t?gO(t,r,e):IC(isNaN(t)?r:t)}}function PC(e,t){var r=t-e;return r?xO(e,r):IC(isNaN(e)?t:e)}const bb=function e(t){var r=vO(t);function n(s,i){var a=r((s=Sg(s)).r,(i=Sg(i)).r),l=r(s.g,i.g),c=r(s.b,i.b),d=PC(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return n.gamma=e,n}(1);function kn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var kg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,id=new RegExp(kg.source,"g");function yO(e){return function(){return e}}function bO(e){return function(t){return e(t)+""}}function wO(e,t){var r=kg.lastIndex=id.lastIndex=0,n,s,i,a=-1,l=[],c=[];for(e=e+"",t=t+"";(n=kg.exec(e))&&(s=id.exec(t));)(i=s.index)>r&&(i=t.slice(r,i),l[a]?l[a]+=i:l[++a]=i),(n=n[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:kn(n,s)})),r=id.lastIndex;return r<t.length&&(i=t.slice(r),l[a]?l[a]+=i:l[++a]=i),l.length<2?c[0]?bO(c[0].x):yO(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var wb=180/Math.PI,Ng={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function OC(e,t,r,n,s,i){var a,l,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*wb,skewX:Math.atan(c)*wb,scaleX:a,scaleY:l}}var Ja;function _O(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ng:OC(t.a,t.b,t.c,t.d,t.e,t.f)}function jO(e){return e==null||(Ja||(Ja=document.createElementNS("http://www.w3.org/2000/svg","g")),Ja.setAttribute("transform",e),!(e=Ja.transform.baseVal.consolidate()))?Ng:(e=e.matrix,OC(e.a,e.b,e.c,e.d,e.e,e.f))}function MC(e,t,r,n){function s(d){return d.length?d.pop()+" ":""}function i(d,u,f,p,h,v){if(d!==f||u!==p){var x=h.push("translate(",null,t,null,r);v.push({i:x-4,x:kn(d,f)},{i:x-2,x:kn(u,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function a(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(s(f)+"rotate(",null,n)-2,x:kn(d,u)})):u&&f.push(s(f)+"rotate("+u+n)}function l(d,u,f,p){d!==u?p.push({i:f.push(s(f)+"skewX(",null,n)-2,x:kn(d,u)}):u&&f.push(s(f)+"skewX("+u+n)}function c(d,u,f,p,h,v){if(d!==f||u!==p){var x=h.push(s(h)+"scale(",null,",",null,")");v.push({i:x-4,x:kn(d,f)},{i:x-2,x:kn(u,p)})}else(f!==1||p!==1)&&h.push(s(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),i(d.translateX,d.translateY,u.translateX,u.translateY,f,p),a(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var v=-1,x=p.length,w;++v<x;)f[(w=p[v]).i]=w.x(h);return f.join("")}}}var SO=MC(_O,"px, ","px)","deg)"),kO=MC(jO,", ",")",")"),NO=1e-12;function _b(e){return((e=Math.exp(e))+1/e)/2}function CO(e){return((e=Math.exp(e))-1/e)/2}function EO(e){return((e=Math.exp(2*e))-1)/(e+1)}const TO=function e(t,r,n){function s(i,a){var l=i[0],c=i[1],d=i[2],u=a[0],f=a[1],p=a[2],h=u-l,v=f-c,x=h*h+v*v,w,g;if(x<NO)g=Math.log(p/d)/t,w=function(S){return[l+S*h,c+S*v,d*Math.exp(t*S*g)]};else{var y=Math.sqrt(x),b=(p*p-d*d+n*x)/(2*d*r*y),j=(p*p-d*d-n*x)/(2*p*r*y),k=Math.log(Math.sqrt(b*b+1)-b),N=Math.log(Math.sqrt(j*j+1)-j);g=(N-k)/t,w=function(S){var C=S*g,_=_b(k),R=d/(r*y)*(_*EO(t*C+k)-CO(k));return[l+R*h,c+R*v,d*_/_b(t*C+k)]}}return w.duration=g*1e3*t/Math.SQRT2,w}return s.rho=function(i){var a=Math.max(.001,+i),l=a*a,c=l*l;return e(a,l,c)},s}(Math.SQRT2,2,4);var ki=0,po=0,Qi=0,DC=1e3,ac,ho,lc=0,Ss=0,Yc=0,ra=typeof performance=="object"&&performance.now?performance:Date,LC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Xv(){return Ss||(LC(AO),Ss=ra.now()+Yc)}function AO(){Ss=0}function cc(){this._call=this._time=this._next=null}cc.prototype=zC.prototype={constructor:cc,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Xv():+r)+(t==null?0:+t),!this._next&&ho!==this&&(ho?ho._next=this:ac=this,ho=this),this._call=e,this._time=r,Cg()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cg())}};function zC(e,t,r){var n=new cc;return n.restart(e,t,r),n}function RO(){Xv(),++ki;for(var e=ac,t;e;)(t=Ss-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ki}function jb(){Ss=(lc=ra.now())+Yc,ki=po=0;try{RO()}finally{ki=0,PO(),Ss=0}}function IO(){var e=ra.now(),t=e-lc;t>DC&&(Yc-=t,lc=e)}function PO(){for(var e,t=ac,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:ac=r);ho=e,Cg(n)}function Cg(e){if(!ki){po&&(po=clearTimeout(po));var t=e-Ss;t>24?(e<1/0&&(po=setTimeout(jb,e-ra.now()-Yc)),Qi&&(Qi=clearInterval(Qi))):(Qi||(lc=ra.now(),Qi=setInterval(IO,DC)),ki=1,LC(jb))}}function Sb(e,t,r){var n=new cc;return t=t==null?0:+t,n.restart(s=>{n.stop(),e(s+t)},t,r),n}var OO=Gc("start","end","cancel","interrupt"),MO=[],FC=0,kb=1,Eg=2,Al=3,Nb=4,Tg=5,Rl=6;function Qc(e,t,r,n,s,i){var a=e.__transition;if(!a)e.__transition={};else if(r in a)return;DO(e,r,{name:t,index:n,group:s,on:OO,tween:MO,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:FC})}function Zv(e,t){var r=Ir(e,t);if(r.state>FC)throw new Error("too late; already scheduled");return r}function Gr(e,t){var r=Ir(e,t);if(r.state>Al)throw new Error("too late; already running");return r}function Ir(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function DO(e,t,r){var n=e.__transition,s;n[t]=r,r.timer=zC(i,0,r.time);function i(d){r.state=kb,r.timer.restart(a,r.delay,r.time),r.delay<=d&&a(d-r.delay)}function a(d){var u,f,p,h;if(r.state!==kb)return c();for(u in n)if(h=n[u],h.name===r.name){if(h.state===Al)return Sb(a);h.state===Nb?(h.state=Rl,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[u]):+u<t&&(h.state=Rl,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[u])}if(Sb(function(){r.state===Al&&(r.state=Nb,r.timer.restart(l,r.delay,r.time),l(d))}),r.state=Eg,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Eg){for(r.state=Al,s=new Array(p=r.tween.length),u=0,f=-1;u<p;++u)(h=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(s[++f]=h);s.length=f+1}}function l(d){for(var u=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(c),r.state=Tg,1),f=-1,p=s.length;++f<p;)s[f].call(e,u);r.state===Tg&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Rl,r.timer.stop(),delete n[t];for(var d in n)return;delete e.__transition}}function Il(e,t){var r=e.__transition,n,s,i=!0,a;if(r){t=t==null?null:t+"";for(a in r){if((n=r[a]).name!==t){i=!1;continue}s=n.state>Eg&&n.state<Tg,n.state=Rl,n.timer.stop(),n.on.call(s?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[a]}i&&delete e.__transition}}function LO(e){return this.each(function(){Il(this,e)})}function zO(e,t){var r,n;return function(){var s=Gr(this,e),i=s.tween;if(i!==r){n=r=i;for(var a=0,l=n.length;a<l;++a)if(n[a].name===t){n=n.slice(),n.splice(a,1);break}}s.tween=n}}function FO(e,t,r){var n,s;if(typeof r!="function")throw new Error;return function(){var i=Gr(this,e),a=i.tween;if(a!==n){s=(n=a).slice();for(var l={name:t,value:r},c=0,d=s.length;c<d;++c)if(s[c].name===t){s[c]=l;break}c===d&&s.push(l)}i.tween=s}}function $O(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Ir(this.node(),r).tween,s=0,i=n.length,a;s<i;++s)if((a=n[s]).name===e)return a.value;return null}return this.each((t==null?zO:FO)(r,e,t))}function Jv(e,t,r){var n=e._id;return e.each(function(){var s=Gr(this,n);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return Ir(s,n).value[t]}}function $C(e,t){var r;return(typeof t=="number"?kn:t instanceof ta?bb:(r=ta(t))?(t=r,bb):wO)(e,t)}function qO(e){return function(){this.removeAttribute(e)}}function BO(e){return function(){this.removeAttributeNS(e.space,e.local)}}function WO(e,t,r){var n,s=r+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===n?i:i=t(n=a,r)}}function HO(e,t,r){var n,s=r+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===n?i:i=t(n=a,r)}}function UO(e,t,r){var n,s,i;return function(){var a,l=r(this),c;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=l+"",a===c?null:a===n&&c===s?i:(s=c,i=t(n=a,l)))}}function VO(e,t,r){var n,s,i;return function(){var a,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=l+"",a===c?null:a===n&&c===s?i:(s=c,i=t(n=a,l)))}}function GO(e,t){var r=Kc(e),n=r==="transform"?kO:$C;return this.attrTween(e,typeof t=="function"?(r.local?VO:UO)(r,n,Jv(this,"attr."+e,t)):t==null?(r.local?BO:qO)(r):(r.local?HO:WO)(r,n,t))}function KO(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function YO(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function QO(e,t){var r,n;function s(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&YO(e,i)),r}return s._value=t,s}function XO(e,t){var r,n;function s(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&KO(e,i)),r}return s._value=t,s}function ZO(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Kc(e);return this.tween(r,(n.local?QO:XO)(n,t))}function JO(e,t){return function(){Zv(this,e).delay=+t.apply(this,arguments)}}function e6(e,t){return t=+t,function(){Zv(this,e).delay=t}}function t6(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?JO:e6)(t,e)):Ir(this.node(),t).delay}function r6(e,t){return function(){Gr(this,e).duration=+t.apply(this,arguments)}}function n6(e,t){return t=+t,function(){Gr(this,e).duration=t}}function s6(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?r6:n6)(t,e)):Ir(this.node(),t).duration}function i6(e,t){if(typeof t!="function")throw new Error;return function(){Gr(this,e).ease=t}}function o6(e){var t=this._id;return arguments.length?this.each(i6(t,e)):Ir(this.node(),t).ease}function a6(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Gr(this,e).ease=r}}function l6(e){if(typeof e!="function")throw new Error;return this.each(a6(this._id,e))}function c6(e){typeof e!="function"&&(e=vC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var i=t[s],a=i.length,l=n[s]=[],c,d=0;d<a;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&l.push(c);return new pn(n,this._parents,this._name,this._id)}function u6(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,s=r.length,i=Math.min(n,s),a=new Array(n),l=0;l<i;++l)for(var c=t[l],d=r[l],u=c.length,f=a[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<n;++l)a[l]=t[l];return new pn(a,this._parents,this._name,this._id)}function d6(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function f6(e,t,r){var n,s,i=d6(t)?Zv:Gr;return function(){var a=i(this,e),l=a.on;l!==n&&(s=(n=l).copy()).on(t,r),a.on=s}}function p6(e,t){var r=this._id;return arguments.length<2?Ir(this.node(),r).on.on(e):this.each(f6(r,e,t))}function h6(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function m6(){return this.on("end.remove",h6(this._id))}function x6(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Kv(e));for(var n=this._groups,s=n.length,i=new Array(s),a=0;a<s;++a)for(var l=n[a],c=l.length,d=i[a]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,Qc(d[p],t,r,p,d,Ir(u,r)));return new pn(i,this._parents,t,r)}function g6(e){var t=this._name,r=this._id;typeof e!="function"&&(e=gC(e));for(var n=this._groups,s=n.length,i=[],a=[],l=0;l<s;++l)for(var c=n[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,v=Ir(u,r),x=0,w=p.length;x<w;++x)(h=p[x])&&Qc(h,t,r,x,p,v);i.push(p),a.push(u)}return new pn(i,a,t,r)}var v6=ya.prototype.constructor;function y6(){return new v6(this._groups,this._parents)}function b6(e,t){var r,n,s;return function(){var i=Si(this,e),a=(this.style.removeProperty(e),Si(this,e));return i===a?null:i===r&&a===n?s:s=t(r=i,n=a)}}function qC(e){return function(){this.style.removeProperty(e)}}function w6(e,t,r){var n,s=r+"",i;return function(){var a=Si(this,e);return a===s?null:a===n?i:i=t(n=a,r)}}function _6(e,t,r){var n,s,i;return function(){var a=Si(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Si(this,e))),a===c?null:a===n&&c===s?i:(s=c,i=t(n=a,l))}}function j6(e,t){var r,n,s,i="style."+t,a="end."+i,l;return function(){var c=Gr(this,e),d=c.on,u=c.value[i]==null?l||(l=qC(t)):void 0;(d!==r||s!==u)&&(n=(r=d).copy()).on(a,s=u),c.on=n}}function S6(e,t,r){var n=(e+="")=="transform"?SO:$C;return t==null?this.styleTween(e,b6(e,n)).on("end.style."+e,qC(e)):typeof t=="function"?this.styleTween(e,_6(e,n,Jv(this,"style."+e,t))).each(j6(this._id,e)):this.styleTween(e,w6(e,n,t),r).on("end.style."+e,null)}function k6(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function N6(e,t,r){var n,s;function i(){var a=t.apply(this,arguments);return a!==s&&(n=(s=a)&&k6(e,a,r)),n}return i._value=t,i}function C6(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,N6(e,t,r??""))}function E6(e){return function(){this.textContent=e}}function T6(e){return function(){var t=e(this);this.textContent=t??""}}function A6(e){return this.tween("text",typeof e=="function"?T6(Jv(this,"text",e)):E6(e==null?"":e+""))}function R6(e){return function(t){this.textContent=e.call(this,t)}}function I6(e){var t,r;function n(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&R6(s)),t}return n._value=e,n}function P6(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,I6(e))}function O6(){for(var e=this._name,t=this._id,r=BC(),n=this._groups,s=n.length,i=0;i<s;++i)for(var a=n[i],l=a.length,c,d=0;d<l;++d)if(c=a[d]){var u=Ir(c,t);Qc(c,e,r,d,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new pn(n,this._parents,e,r)}function M6(){var e,t,r=this,n=r._id,s=r.size();return new Promise(function(i,a){var l={value:a},c={value:function(){--s===0&&i()}};r.each(function(){var d=Gr(this,n),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),s===0&&i()})}var D6=0;function pn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function BC(){return++D6}var Yr=ya.prototype;pn.prototype={constructor:pn,select:x6,selectAll:g6,selectChild:Yr.selectChild,selectChildren:Yr.selectChildren,filter:c6,merge:u6,selection:y6,transition:O6,call:Yr.call,nodes:Yr.nodes,node:Yr.node,size:Yr.size,empty:Yr.empty,each:Yr.each,on:p6,attr:GO,attrTween:ZO,style:S6,styleTween:C6,text:A6,textTween:P6,remove:m6,tween:$O,delay:t6,duration:s6,ease:o6,easeVarying:l6,end:M6,[Symbol.iterator]:Yr[Symbol.iterator]};function L6(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var z6={time:null,delay:0,duration:250,ease:L6};function F6(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function $6(e){var t,r;e instanceof pn?(t=e._id,e=e._name):(t=BC(),(r=z6).time=Xv(),e=e==null?null:e+"");for(var n=this._groups,s=n.length,i=0;i<s;++i)for(var a=n[i],l=a.length,c,d=0;d<l;++d)(c=a[d])&&Qc(c,e,t,d,a,r||F6(c,t));return new pn(n,this._parents,e,t)}ya.prototype.interrupt=LO;ya.prototype.transition=$6;const el=e=>()=>e;function q6(e,{sourceEvent:t,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function nn(e,t,r){this.k=e,this.x=t,this.y=r}nn.prototype={constructor:nn,scale:function(e){return e===1?this:new nn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new nn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ln=new nn(1,0,0);nn.prototype;function od(e){e.stopImmediatePropagation()}function Xi(e){e.preventDefault(),e.stopImmediatePropagation()}function B6(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function W6(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Cb(){return this.__zoom||ln}function H6(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function U6(){return navigator.maxTouchPoints||"ontouchstart"in this}function V6(e,t,r){var n=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],i=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function WC(){var e=B6,t=W6,r=V6,n=H6,s=U6,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,c=TO,d=Gc("start","zoom","end"),u,f,p,h=500,v=150,x=0,w=10;function g(E){E.property("__zoom",Cb).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",_).on("dblclick.zoom",R).filter(s).on("touchstart.zoom",T).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",$).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(E,L,A,P){var M=E.selection?E.selection():E;M.property("__zoom",Cb),E!==M?k(E,L,A,P):M.interrupt().each(function(){N(this,arguments).event(P).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},g.scaleBy=function(E,L,A,P){g.scaleTo(E,function(){var M=this.__zoom.k,I=typeof L=="function"?L.apply(this,arguments):L;return M*I},A,P)},g.scaleTo=function(E,L,A,P){g.transform(E,function(){var M=t.apply(this,arguments),I=this.__zoom,O=A==null?j(M):typeof A=="function"?A.apply(this,arguments):A,F=I.invert(O),q=typeof L=="function"?L.apply(this,arguments):L;return r(b(y(I,q),O,F),M,a)},A,P)},g.translateBy=function(E,L,A,P){g.transform(E,function(){return r(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),a)},null,P)},g.translateTo=function(E,L,A,P,M){g.transform(E,function(){var I=t.apply(this,arguments),O=this.__zoom,F=P==null?j(I):typeof P=="function"?P.apply(this,arguments):P;return r(ln.translate(F[0],F[1]).scale(O.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof A=="function"?-A.apply(this,arguments):-A),I,a)},P,M)};function y(E,L){return L=Math.max(i[0],Math.min(i[1],L)),L===E.k?E:new nn(L,E.x,E.y)}function b(E,L,A){var P=L[0]-A[0]*E.k,M=L[1]-A[1]*E.k;return P===E.x&&M===E.y?E:new nn(E.k,P,M)}function j(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function k(E,L,A,P){E.on("start.zoom",function(){N(this,arguments).event(P).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(P).end()}).tween("zoom",function(){var M=this,I=arguments,O=N(M,I).event(P),F=t.apply(M,I),q=A==null?j(F):typeof A=="function"?A.apply(M,I):A,U=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),G=M.__zoom,J=typeof L=="function"?L.apply(M,I):L,B=c(G.invert(q).concat(U/G.k),J.invert(q).concat(U/J.k));return function(te){if(te===1)te=J;else{var oe=B(te),Q=U/oe[2];te=new nn(Q,q[0]-oe[0]*Q,q[1]-oe[1]*Q)}O.zoom(null,te)}})}function N(E,L,A){return!A&&E.__zooming||new S(E,L)}function S(E,L){this.that=E,this.args=L,this.active=0,this.sourceEvent=null,this.extent=t.apply(E,L),this.taps=0}S.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,L){return this.mouse&&E!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var L=pr(this.that).datum();d.call(E,this.that,new q6(E,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:d}),L)}};function C(E,...L){if(!e.apply(this,arguments))return;var A=N(this,L).event(E),P=this.__zoom,M=Math.max(i[0],Math.min(i[1],P.k*Math.pow(2,n.apply(this,arguments)))),I=kr(E);if(A.wheel)(A.mouse[0][0]!==I[0]||A.mouse[0][1]!==I[1])&&(A.mouse[1]=P.invert(A.mouse[0]=I)),clearTimeout(A.wheel);else{if(P.k===M)return;A.mouse=[I,P.invert(I)],Il(this),A.start()}Xi(E),A.wheel=setTimeout(O,v),A.zoom("mouse",r(b(y(P,M),A.mouse[0],A.mouse[1]),A.extent,a));function O(){A.wheel=null,A.end()}}function _(E,...L){if(p||!e.apply(this,arguments))return;var A=E.currentTarget,P=N(this,L,!0).event(E),M=pr(E.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",U,!0),I=kr(E,A),O=E.clientX,F=E.clientY;EC(E.view),od(E),P.mouse=[I,this.__zoom.invert(I)],Il(this),P.start();function q(G){if(Xi(G),!P.moved){var J=G.clientX-O,B=G.clientY-F;P.moved=J*J+B*B>x}P.event(G).zoom("mouse",r(b(P.that.__zoom,P.mouse[0]=kr(G,A),P.mouse[1]),P.extent,a))}function U(G){M.on("mousemove.zoom mouseup.zoom",null),TC(G.view,P.moved),Xi(G),P.event(G).end()}}function R(E,...L){if(e.apply(this,arguments)){var A=this.__zoom,P=kr(E.changedTouches?E.changedTouches[0]:E,this),M=A.invert(P),I=A.k*(E.shiftKey?.5:2),O=r(b(y(A,I),P,M),t.apply(this,L),a);Xi(E),l>0?pr(this).transition().duration(l).call(k,O,P,E):pr(this).call(g.transform,O,P,E)}}function T(E,...L){if(e.apply(this,arguments)){var A=E.touches,P=A.length,M=N(this,L,E.changedTouches.length===P).event(E),I,O,F,q;for(od(E),O=0;O<P;++O)F=A[O],q=kr(F,this),q=[q,this.__zoom.invert(q),F.identifier],M.touch0?!M.touch1&&M.touch0[2]!==q[2]&&(M.touch1=q,M.taps=0):(M.touch0=q,I=!0,M.taps=1+!!u);u&&(u=clearTimeout(u)),I&&(M.taps<2&&(f=q[0],u=setTimeout(function(){u=null},h)),Il(this),M.start())}}function D(E,...L){if(this.__zooming){var A=N(this,L).event(E),P=E.changedTouches,M=P.length,I,O,F,q;for(Xi(E),I=0;I<M;++I)O=P[I],F=kr(O,this),A.touch0&&A.touch0[2]===O.identifier?A.touch0[0]=F:A.touch1&&A.touch1[2]===O.identifier&&(A.touch1[0]=F);if(O=A.that.__zoom,A.touch1){var U=A.touch0[0],G=A.touch0[1],J=A.touch1[0],B=A.touch1[1],te=(te=J[0]-U[0])*te+(te=J[1]-U[1])*te,oe=(oe=B[0]-G[0])*oe+(oe=B[1]-G[1])*oe;O=y(O,Math.sqrt(te/oe)),F=[(U[0]+J[0])/2,(U[1]+J[1])/2],q=[(G[0]+B[0])/2,(G[1]+B[1])/2]}else if(A.touch0)F=A.touch0[0],q=A.touch0[1];else return;A.zoom("touch",r(b(O,F,q),A.extent,a))}}function $(E,...L){if(this.__zooming){var A=N(this,L).event(E),P=E.changedTouches,M=P.length,I,O;for(od(E),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),I=0;I<M;++I)O=P[I],A.touch0&&A.touch0[2]===O.identifier?delete A.touch0:A.touch1&&A.touch1[2]===O.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(O=kr(O,this),Math.hypot(f[0]-O[0],f[1]-O[1])<w)){var F=pr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return g.wheelDelta=function(E){return arguments.length?(n=typeof E=="function"?E:el(+E),g):n},g.filter=function(E){return arguments.length?(e=typeof E=="function"?E:el(!!E),g):e},g.touchable=function(E){return arguments.length?(s=typeof E=="function"?E:el(!!E),g):s},g.extent=function(E){return arguments.length?(t=typeof E=="function"?E:el([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),g):t},g.scaleExtent=function(E){return arguments.length?(i[0]=+E[0],i[1]=+E[1],g):[i[0],i[1]]},g.translateExtent=function(E){return arguments.length?(a[0][0]=+E[0][0],a[1][0]=+E[1][0],a[0][1]=+E[0][1],a[1][1]=+E[1][1],g):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},g.constrain=function(E){return arguments.length?(r=E,g):r},g.duration=function(E){return arguments.length?(l=+E,g):l},g.interpolate=function(E){return arguments.length?(c=E,g):c},g.on=function(){var E=d.on.apply(d,arguments);return E===d?g:E},g.clickDistance=function(E){return arguments.length?(x=(E=+E)*E,g):Math.sqrt(x)},g.tapDistance=function(E){return arguments.length?(w=+E,g):w},g}const Xc=m.createContext(null),G6=Xc.Provider,hn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},HC=hn.error001();function Ke(e,t){const r=m.useContext(Xc);if(r===null)throw new Error(HC);return mC(r,e,t)}const vt=()=>{const e=m.useContext(Xc);if(e===null)throw new Error(HC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},K6=e=>e.userSelectionActive?"none":"all";function Ro({position:e,children:t,className:r,style:n,...s}){const i=Ke(K6),a=`${e}`.split("-");return Y.createElement("div",{className:Qt(["react-flow__panel",r,...a]),style:{...n,pointerEvents:i},...s},t)}function Y6({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:Y.createElement(Ro,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},Y.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Q6=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),v=Qt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const x=f.current.getBBox();h({x:x.x,y:x.y,width:x.width,height:x.height})}},[r]),typeof r>"u"||!r?null:Y.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:v,visibility:p.width?"visible":"hidden",...u},s&&Y.createElement("rect",{width:p.width+2*a[0],x:-a[0],y:-a[1],height:p.height+2*a[1],className:"react-flow__edge-textbg",style:i,rx:l,ry:l}),Y.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var X6=m.memo(Q6);const ey=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ni=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),ty=(e={x:0,y:0},t)=>({x:Ni(e.x,t[0][0],t[1][0]),y:Ni(e.y,t[0][1],t[1][1])}),Eb=(e,t,r)=>e<t?Ni(Math.abs(e-t),1,50)/50:e>r?-Ni(Math.abs(e-r),1,50)/50:0,UC=(e,t)=>{const r=Eb(e.x,35,t.width-35)*20,n=Eb(e.y,35,t.height-35)*20;return[r,n]},VC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},GC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),na=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),KC=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),Tb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Z6=(e,t)=>KC(GC(na(e),na(t))),Ag=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},J6=e=>mr(e.width)&&mr(e.height)&&mr(e.x)&&mr(e.y),mr=e=>!isNaN(e)&&isFinite(e),rt=Symbol.for("internals"),YC=["Enter"," ","Escape"],eM=(e,t)=>{},tM=e=>"nativeEvent"in e;function Rg(e){var s,i;const t=tM(e)?e.nativeEvent:e,r=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const QC=e=>"clientX"in e,Wn=(e,t)=>{var i,a;const r=QC(e),n=r?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=r?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},uc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},wa=({id:e,path:t,labelX:r,labelY:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>Y.createElement(Y.Fragment,null,Y.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&Y.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&mr(r)&&mr(n)?Y.createElement(X6,{x:r,y:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);wa.displayName="BaseEdge";function Zi(e,t,r){return r===void 0?r:n=>{const s=t().edges.find(i=>i.id===e);s&&r(n,{...s})}}function XC({sourceX:e,sourceY:t,targetX:r,targetY:n}){const s=Math.abs(r-e)/2,i=r<e?r+s:r-s,a=Math.abs(n-t)/2,l=n<t?n+a:n-a;return[i,l,s,a]}function ZC({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:s,sourceControlY:i,targetControlX:a,targetControlY:l}){const c=e*.125+s*.375+a*.375+r*.125,d=t*.125+i*.375+l*.375+n*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var ks;(function(e){e.Strict="strict",e.Loose="loose"})(ks||(ks={}));var fs;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(fs||(fs={}));var sa;(function(e){e.Partial="partial",e.Full="full"})(sa||(sa={}));var An;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(An||(An={}));var dc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(dc||(dc={}));var fe;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(fe||(fe={}));function Ab({pos:e,x1:t,y1:r,x2:n,y2:s}){return e===fe.Left||e===fe.Right?[.5*(t+n),r]:[t,.5*(r+s)]}function JC({sourceX:e,sourceY:t,sourcePosition:r=fe.Bottom,targetX:n,targetY:s,targetPosition:i=fe.Top}){const[a,l]=Ab({pos:r,x1:e,y1:t,x2:n,y2:s}),[c,d]=Ab({pos:i,x1:n,y1:s,x2:e,y2:t}),[u,f,p,h]=ZC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${n},${s}`,u,f,p,h]}const ry=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=fe.Bottom,targetPosition:i=fe.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:x})=>{const[w,g,y]=JC({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:i});return Y.createElement(wa,{path:w,labelX:g,labelY:y,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:x})});ry.displayName="SimpleBezierEdge";const Rb={[fe.Left]:{x:-1,y:0},[fe.Right]:{x:1,y:0},[fe.Top]:{x:0,y:-1},[fe.Bottom]:{x:0,y:1}},rM=({source:e,sourcePosition:t=fe.Bottom,target:r})=>t===fe.Left||t===fe.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Ib=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function nM({source:e,sourcePosition:t=fe.Bottom,target:r,targetPosition:n=fe.Top,center:s,offset:i}){const a=Rb[t],l=Rb[n],c={x:e.x+a.x*i,y:e.y+a.y*i},d={x:r.x+l.x*i,y:r.y+l.y*i},u=rM({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],v,x;const w={x:0,y:0},g={x:0,y:0},[y,b,j,k]=XC({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(a[f]*l[f]===-1){v=s.x??y,x=s.y??b;const S=[{x:v,y:c.y},{x:v,y:d.y}],C=[{x:c.x,y:x},{x:d.x,y:x}];a[f]===p?h=f==="x"?S:C:h=f==="x"?C:S}else{const S=[{x:c.x,y:d.y}],C=[{x:d.x,y:c.y}];if(f==="x"?h=a.x===p?C:S:h=a.y===p?S:C,t===n){const $=Math.abs(e[f]-r[f]);if($<=i){const E=Math.min(i-1,i-$);a[f]===p?w[f]=(c[f]>e[f]?-1:1)*E:g[f]=(d[f]>r[f]?-1:1)*E}}if(t!==n){const $=f==="x"?"y":"x",E=a[f]===l[$],L=c[$]>d[$],A=c[$]<d[$];(a[f]===1&&(!E&&L||E&&A)||a[f]!==1&&(!E&&A||E&&L))&&(h=f==="x"?S:C)}const _={x:c.x+w.x,y:c.y+w.y},R={x:d.x+g.x,y:d.y+g.y},T=Math.max(Math.abs(_.x-h[0].x),Math.abs(R.x-h[0].x)),D=Math.max(Math.abs(_.y-h[0].y),Math.abs(R.y-h[0].y));T>=D?(v=(_.x+R.x)/2,x=h[0].y):(v=h[0].x,x=(_.y+R.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...h,{x:d.x+g.x,y:d.y+g.y},r],v,x,j,k]}function sM(e,t,r,n){const s=Math.min(Ib(e,t)/2,Ib(t,r)/2,n),{x:i,y:a}=t;if(e.x===i&&i===r.x||e.y===a&&a===r.y)return`L${i} ${a}`;if(e.y===a){const d=e.x<r.x?-1:1,u=e.y<r.y?1:-1;return`L ${i+s*d},${a}Q ${i},${a} ${i},${a+s*u}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${i},${a+s*c}Q ${i},${a} ${i+s*l},${a}`}function Ig({sourceX:e,sourceY:t,sourcePosition:r=fe.Bottom,targetX:n,targetY:s,targetPosition:i=fe.Top,borderRadius:a=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,v]=nM({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:s},targetPosition:i,center:{x:l,y:c},offset:d});return[u.reduce((w,g,y)=>{let b="";return y>0&&y<u.length-1?b=sM(u[y-1],g,u[y+1],a):b=`${y===0?"M":"L"}${g.x} ${g.y}`,w+=b,w},""),f,p,h,v]}const Zc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=fe.Bottom,targetPosition:p=fe.Top,markerEnd:h,markerStart:v,pathOptions:x,interactionWidth:w})=>{const[g,y,b]=Ig({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset});return Y.createElement(wa,{path:g,labelX:y,labelY:b,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:v,interactionWidth:w})});Zc.displayName="SmoothStepEdge";const ny=m.memo(e=>{var t;return Y.createElement(Zc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});ny.displayName="StepEdge";function iM({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[s,i,a,l]=XC({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,s,i,a,l]}const sy=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[v,x,w]=iM({sourceX:e,sourceY:t,targetX:r,targetY:n});return Y.createElement(wa,{path:v,labelX:x,labelY:w,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});sy.displayName="StraightEdge";function tl(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Pb({pos:e,x1:t,y1:r,x2:n,y2:s,c:i}){switch(e){case fe.Left:return[t-tl(t-n,i),r];case fe.Right:return[t+tl(n-t,i),r];case fe.Top:return[t,r-tl(r-s,i)];case fe.Bottom:return[t,r+tl(s-r,i)]}}function eE({sourceX:e,sourceY:t,sourcePosition:r=fe.Bottom,targetX:n,targetY:s,targetPosition:i=fe.Top,curvature:a=.25}){const[l,c]=Pb({pos:r,x1:e,y1:t,x2:n,y2:s,c:a}),[d,u]=Pb({pos:i,x1:n,y1:s,x2:e,y2:t,c:a}),[f,p,h,v]=ZC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${n},${s}`,f,p,h,v]}const fc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=fe.Bottom,targetPosition:i=fe.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,pathOptions:x,interactionWidth:w})=>{const[g,y,b]=eE({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:i,curvature:x==null?void 0:x.curvature});return Y.createElement(wa,{path:g,labelX:y,labelY:b,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:w})});fc.displayName="BezierEdge";const iy=m.createContext(null),oM=iy.Provider;iy.Consumer;const aM=()=>m.useContext(iy),lM=e=>"id"in e&&"source"in e&&"target"in e,cM=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Pg=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,uM=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),dM=(e,t)=>{if(!e.source||!e.target)return t;let r;return lM(e)?r={...e}:r={...e,id:cM(e)},uM(r,t)?t:t.concat(r)},Og=({x:e,y:t},[r,n,s],i,[a,l])=>{const c={x:(e-r)/s,y:(t-n)/s};return i?{x:a*Math.round(c.x/a),y:l*Math.round(c.y/l)}:c},tE=({x:e,y:t},[r,n,s])=>({x:e*s+r,y:t*s+n}),gs=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-n};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:s}},Jc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,s)=>{const{x:i,y:a}=gs(s,t).positionAbsolute;return GC(n,na({x:i,y:a,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return KC(r)},rE=(e,t,[r,n,s]=[0,0,1],i=!1,a=!1,l=[0,0])=>{const c={x:(t.x-r)/s,y:(t.y-n)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:v=!1}=u;if(a&&!h||v)return!1;const{positionAbsolute:x}=gs(u,l),w={x:x.x,y:x.y,width:f||0,height:p||0},g=Ag(c,w),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=i&&g>0,j=(f||0)*(p||0);(y||b||g>=j||u.dragging)&&d.push(u)}),d},nE=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},sE=(e,t,r,n,s,i=.1)=>{const a=t/(e.width*(1+i)),l=r/(e.height*(1+i)),c=Math.min(a,l),d=Ni(c,n,s),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=r/2-f*d;return{x:p,y:h,zoom:d}},as=(e,t=0)=>e.transition().duration(t);function Ob(e,t,r,n){return(t[r]||[]).reduce((s,i)=>{var a,l;return`${e.id}-${i.id}-${r}`!==n&&s.push({id:i.id||null,type:r,nodeId:e.id,x:(((a=e.positionAbsolute)==null?void 0:a.x)??0)+i.x+i.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+i.y+i.height/2}),s},[])}function fM(e,t,r,n,s,i){const{x:a,y:l}=Wn(e),d=t.elementsFromPoint(a,l).find(v=>v.classList.contains("react-flow__handle"));if(d){const v=d.getAttribute("data-nodeid");if(v){const x=oy(void 0,d),w=d.getAttribute("data-handleid"),g=i({nodeId:v,id:w,type:x});if(g){const y=s.find(b=>b.nodeId===v&&b.type===x&&b.id===w);return{handle:{id:w,type:x,nodeId:v,x:(y==null?void 0:y.x)||r.x,y:(y==null?void 0:y.y)||r.y},validHandleResult:g}}}}let u=[],f=1/0;if(s.forEach(v=>{const x=Math.sqrt((v.x-r.x)**2+(v.y-r.y)**2);if(x<=n){const w=i(v);x<=f&&(x<f?u=[{handle:v,validHandleResult:w}]:x===f&&u.push({handle:v,validHandleResult:w}),f=x)}}),!u.length)return{handle:null,validHandleResult:iE()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:v})=>v.isValid),h=u.some(({handle:v})=>v.type==="target");return u.find(({handle:v,validHandleResult:x})=>h?v.type==="target":p?x.isValid:!0)||u[0]}const pM={source:null,target:null,sourceHandle:null,targetHandle:null},iE=()=>({handleDomNode:null,isValid:!1,connection:pM,endHandle:null});function oE(e,t,r,n,s,i,a){const l=s==="target",c=a.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...iE(),handleDomNode:c};if(c){const u=oy(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),v=c.classList.contains("connectableend"),x={source:l?f:r,sourceHandle:l?p:n,target:l?r:f,targetHandle:l?n:p};d.connection=x,h&&v&&(t===ks.Strict?l&&u==="source"||!l&&u==="target":f!==r||p!==n)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=i(x))}return d}function hM({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((s,i)=>{if(i[rt]){const{handleBounds:a}=i[rt];let l=[],c=[];a&&(l=Ob(i,a,"source",`${t}-${r}-${n}`),c=Ob(i,a,"target",`${t}-${r}-${n}`)),s.push(...l,...c)}return s},[])}function oy(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ad(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function mM(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function aE({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:s,getState:i,setState:a,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=VC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:v,onConnectStart:x,panBy:w,getNodes:g,cancelConnection:y}=i();let b=0,j;const{x:k,y:N}=Wn(e),S=u==null?void 0:u.elementFromPoint(k,N),C=oy(c,S),_=p==null?void 0:p.getBoundingClientRect();if(!_||!C)return;let R,T=Wn(e,_),D=!1,$=null,E=!1,L=null;const A=hM({nodes:g(),nodeId:r,handleId:t,handleType:C}),P=()=>{if(!h)return;const[O,F]=UC(T,_);w({x:O,y:F}),b=requestAnimationFrame(P)};a({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:C,connectionStartHandle:{nodeId:r,handleId:t,type:C},connectionEndHandle:null}),x==null||x(e,{nodeId:r,handleId:t,handleType:C});function M(O){const{transform:F}=i();T=Wn(O,_);const{handle:q,validHandleResult:U}=fM(O,u,Og(T,F,!1,[1,1]),v,A,G=>oE(G,f,r,t,s?"target":"source",l,u));if(j=q,D||(P(),D=!0),L=U.handleDomNode,$=U.connection,E=U.isValid,a({connectionPosition:j&&E?tE({x:j.x,y:j.y},F):T,connectionStatus:mM(!!j,E),connectionEndHandle:U.endHandle}),!j&&!E&&!L)return ad(R);$.source!==$.target&&L&&(ad(R),R=L,L.classList.add("connecting","react-flow__handle-connecting"),L.classList.toggle("valid",E),L.classList.toggle("react-flow__handle-valid",E))}function I(O){var F,q;(j||L)&&$&&E&&(n==null||n($)),(q=(F=i()).onConnectEnd)==null||q.call(F,O),c&&(d==null||d(O)),ad(R),y(),cancelAnimationFrame(b),D=!1,E=!1,$=null,L=null,u.removeEventListener("mousemove",M),u.removeEventListener("mouseup",I),u.removeEventListener("touchmove",M),u.removeEventListener("touchend",I)}u.addEventListener("mousemove",M),u.addEventListener("mouseup",I),u.addEventListener("touchmove",M),u.addEventListener("touchend",I)}const Mb=()=>!0,xM=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),gM=(e,t,r)=>n=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:a}=n;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.handleId)===t&&(a==null?void 0:a.type)===r}},lE=m.forwardRef(({type:e="source",position:t=fe.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:a,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var _,R;const v=a||null,x=e==="target",w=vt(),g=aM(),{connectOnClick:y,noPanClassName:b}=Ke(xM,Pt),{connecting:j,clickConnecting:k}=Ke(gM(g,v,e),Pt);g||(R=(_=w.getState()).onError)==null||R.call(_,"010",hn.error010());const N=T=>{const{defaultEdgeOptions:D,onConnect:$,hasDefaultEdges:E}=w.getState(),L={...D,...T};if(E){const{edges:A,setEdges:P}=w.getState();P(dM(L,A))}$==null||$(L),l==null||l(L)},S=T=>{if(!g)return;const D=QC(T);s&&(D&&T.button===0||!D)&&aE({event:T,handleId:v,nodeId:g,onConnect:N,isTarget:x,getState:w.getState,setState:w.setState,isValidConnection:r||w.getState().isValidConnection||Mb}),D?u==null||u(T):f==null||f(T)},C=T=>{const{onClickConnectStart:D,onClickConnectEnd:$,connectionClickStartHandle:E,connectionMode:L,isValidConnection:A}=w.getState();if(!g||!E&&!s)return;if(!E){D==null||D(T,{nodeId:g,handleId:v,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:g,type:e,handleId:v}});return}const P=VC(T.target),M=r||A||Mb,{connection:I,isValid:O}=oE({nodeId:g,id:v,type:e},L,E.nodeId,E.handleId||null,E.type,M,P);O&&N(I),$==null||$(T),w.setState({connectionClickStartHandle:null})};return Y.createElement("div",{"data-handleid":v,"data-nodeid":g,"data-handlepos":t,"data-id":`${g}-${v}-${e}`,className:Qt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!x,target:x,connectable:n,connectablestart:s,connectableend:i,connecting:k,connectionindicator:n&&(s&&!j||i&&j)}]),onMouseDown:S,onTouchStart:S,onClick:y?C:void 0,ref:h,...p},c)});lE.displayName="Handle";var Kn=m.memo(lE);const cE=({data:e,isConnectable:t,targetPosition:r=fe.Top,sourcePosition:n=fe.Bottom})=>Y.createElement(Y.Fragment,null,Y.createElement(Kn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,Y.createElement(Kn,{type:"source",position:n,isConnectable:t}));cE.displayName="DefaultNode";var Mg=m.memo(cE);const uE=({data:e,isConnectable:t,sourcePosition:r=fe.Bottom})=>Y.createElement(Y.Fragment,null,e==null?void 0:e.label,Y.createElement(Kn,{type:"source",position:r,isConnectable:t}));uE.displayName="InputNode";var dE=m.memo(uE);const fE=({data:e,isConnectable:t,targetPosition:r=fe.Top})=>Y.createElement(Y.Fragment,null,Y.createElement(Kn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);fE.displayName="OutputNode";var pE=m.memo(fE);const ay=()=>null;ay.displayName="GroupNode";const vM=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),rl=e=>e.id;function yM(e,t){return Pt(e.selectedNodes.map(rl),t.selectedNodes.map(rl))&&Pt(e.selectedEdges.map(rl),t.selectedEdges.map(rl))}const hE=m.memo(({onSelectionChange:e})=>{const t=vt(),{selectedNodes:r,selectedEdges:n}=Ke(vM,yM);return m.useEffect(()=>{const s={nodes:r,edges:n};e==null||e(s),t.getState().onSelectionChange.forEach(i=>i(s))},[r,n,e]),null});hE.displayName="SelectionListener";const bM=e=>!!e.onSelectionChange;function wM({onSelectionChange:e}){const t=Ke(bM);return e||t?Y.createElement(hE,{onSelectionChange:e}):null}const _M=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Ms(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Se(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const jM=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:s,onConnectStart:i,onConnectEnd:a,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:v,minZoom:x,maxZoom:w,nodeExtent:g,onNodesChange:y,onEdgesChange:b,elementsSelectable:j,connectionMode:k,snapGrid:N,snapToGrid:S,translateExtent:C,connectOnClick:_,defaultEdgeOptions:R,fitView:T,fitViewOptions:D,onNodesDelete:$,onEdgesDelete:E,onNodeDrag:L,onNodeDragStart:A,onNodeDragStop:P,onSelectionDrag:M,onSelectionDragStart:I,onSelectionDragStop:O,noPanClassName:F,nodeOrigin:q,rfId:U,autoPanOnConnect:G,autoPanOnNodeDrag:J,onError:B,connectionRadius:te,isValidConnection:oe,nodeDragThreshold:Q})=>{const{setNodes:H,setEdges:ie,setDefaultNodesAndEdges:ae,setMinZoom:pe,setMaxZoom:me,setTranslateExtent:le,setNodeExtent:V,reset:ee}=Ke(_M,Pt),re=vt();return m.useEffect(()=>{const je=n==null?void 0:n.map(be=>({...be,...R}));return ae(r,je),()=>{ee()}},[]),Se("defaultEdgeOptions",R,re.setState),Se("connectionMode",k,re.setState),Se("onConnect",s,re.setState),Se("onConnectStart",i,re.setState),Se("onConnectEnd",a,re.setState),Se("onClickConnectStart",l,re.setState),Se("onClickConnectEnd",c,re.setState),Se("nodesDraggable",d,re.setState),Se("nodesConnectable",u,re.setState),Se("nodesFocusable",f,re.setState),Se("edgesFocusable",p,re.setState),Se("edgesUpdatable",h,re.setState),Se("elementsSelectable",j,re.setState),Se("elevateNodesOnSelect",v,re.setState),Se("snapToGrid",S,re.setState),Se("snapGrid",N,re.setState),Se("onNodesChange",y,re.setState),Se("onEdgesChange",b,re.setState),Se("connectOnClick",_,re.setState),Se("fitViewOnInit",T,re.setState),Se("fitViewOnInitOptions",D,re.setState),Se("onNodesDelete",$,re.setState),Se("onEdgesDelete",E,re.setState),Se("onNodeDrag",L,re.setState),Se("onNodeDragStart",A,re.setState),Se("onNodeDragStop",P,re.setState),Se("onSelectionDrag",M,re.setState),Se("onSelectionDragStart",I,re.setState),Se("onSelectionDragStop",O,re.setState),Se("noPanClassName",F,re.setState),Se("nodeOrigin",q,re.setState),Se("rfId",U,re.setState),Se("autoPanOnConnect",G,re.setState),Se("autoPanOnNodeDrag",J,re.setState),Se("onError",B,re.setState),Se("connectionRadius",te,re.setState),Se("isValidConnection",oe,re.setState),Se("nodeDragThreshold",Q,re.setState),Ms(e,H),Ms(t,ie),Ms(x,pe),Ms(w,me),Ms(C,le),Ms(g,V),null},Db={display:"none"},SM={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},mE="react-flow__node-desc",xE="react-flow__edge-desc",kM="react-flow__aria-live",NM=e=>e.ariaLiveMessage;function CM({rfId:e}){const t=Ke(NM);return Y.createElement("div",{id:`${kM}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:SM},t)}function EM({rfId:e,disableKeyboardA11y:t}){return Y.createElement(Y.Fragment,null,Y.createElement("div",{id:`${mE}-${e}`,style:Db},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),Y.createElement("div",{id:`${xE}-${e}`,style:Db},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&Y.createElement(CM,{rfId:e}))}var ia=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),s=m.useRef(!1),i=m.useRef(new Set([])),[a,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Rg(h))return!1;const x=zb(h.code,l);i.current.add(h[x]),Lb(a,i.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Rg(h))return!1;const x=zb(h.code,l);Lb(a,i.current,!0)?(n(!1),i.current.clear()):i.current.delete(h[x]),h.key==="Meta"&&i.current.clear(),s.current=!1},p=()=>{i.current.clear(),n(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function Lb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(s=>t.has(s)))}function zb(e,t){return t.includes(e)?"code":"key"}function gE(e,t,r,n){var l,c;const s=e.parentNode||e.parentId;if(!s)return r;const i=t.get(s),a=gs(i,n);return gE(i,t,{x:(r.x??0)+a.x,y:(r.y??0)+a.y,z:(((l=i[rt])==null?void 0:l.z)??0)>(r.z??0)?((c=i[rt])==null?void 0:c.z)??0:r.z??0},n)}function vE(e,t,r){e.forEach(n=>{var i;const s=n.parentNode||n.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[n.id]){const{x:a,y:l,z:c}=gE(n,e,{...n.position,z:((i=n[rt])==null?void 0:i.z)??0},t);n.positionAbsolute={x:a,y:l},n[rt].z=c,r!=null&&r[n.id]&&(n[rt].isParent=!0)}})}function ld(e,t,r,n){const s=new Map,i={},a=n?1e3:0;return e.forEach(l=>{var h;const c=(mr(l.zIndex)?l.zIndex:0)+(l.selected?a:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(i[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,rt,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[rt])==null?void 0:h.handleBounds,z:c}}),s.set(l.id,u)}),vE(s,r,i),s}function yE(e,t={}){const{getNodes:r,width:n,height:s,minZoom:i,maxZoom:a,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const v=r().filter(w=>{var y;const g=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(y=t.nodes)!=null&&y.length?g&&t.nodes.some(b=>b.id===w.id):g}),x=v.every(w=>w.width&&w.height);if(v.length>0&&x){const w=Jc(v,f),{x:g,y,zoom:b}=sE(w,n,s,t.minZoom??i,t.maxZoom??a,t.padding??.1),j=ln.translate(g,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(as(c,t.duration),j):l.transform(c,j),!0}}return!1}function TM(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[rt]:n[rt],selected:r.selected})}),new Map(t)}function AM(e,t){return t.map(r=>{const n=e.find(s=>s.id===r.id);return n&&(r.selected=n.selected),r})}function nl({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:s,edges:i,onNodesChange:a,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=r();e!=null&&e.length&&(c&&n({nodeInternals:TM(e,s)}),a==null||a(e)),t!=null&&t.length&&(d&&n({edges:AM(t,i)}),l==null||l(t))}const Ds=()=>{},RM={zoomIn:Ds,zoomOut:Ds,zoomTo:Ds,getZoom:()=>1,setViewport:Ds,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ds,fitBounds:Ds,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},IM=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),PM=()=>{const e=vt(),{d3Zoom:t,d3Selection:r}=Ke(IM,Pt);return m.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(as(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(as(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(as(r,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[a,l,c]=e.getState().transform,d=ln.translate(s.x??a,s.y??l).scale(s.zoom??c);t.transform(as(r,i==null?void 0:i.duration),d)},getViewport:()=>{const[s,i,a]=e.getState().transform;return{x:s,y:i,zoom:a}},fitView:s=>yE(e.getState,s),setCenter:(s,i,a)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(a==null?void 0:a.zoom)<"u"?a.zoom:d,f=l/2-s*u,p=c/2-i*u,h=ln.translate(f,p).scale(u);t.transform(as(r,a==null?void 0:a.duration),h)},fitBounds:(s,i)=>{const{width:a,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=sE(s,a,l,c,d,(i==null?void 0:i.padding)??.1),h=ln.translate(u,f).scale(p);t.transform(as(r,i==null?void 0:i.duration),h)},project:s=>{const{transform:i,snapToGrid:a,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Og(s,i,a,l)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:a,snapGrid:l,domNode:c}=e.getState();if(!c)return s;const{x:d,y:u}=c.getBoundingClientRect(),f={x:s.x-d,y:s.y-u};return Og(f,i,a,l)},flowToScreenPosition:s=>{const{transform:i,domNode:a}=e.getState();if(!a)return s;const{x:l,y:c}=a.getBoundingClientRect(),d=tE(s,i);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:RM,[t,r])};function ly(){const e=PM(),t=vt(),r=m.useCallback(()=>t.getState().getNodes().map(x=>({...x})),[]),n=m.useCallback(x=>t.getState().nodeInternals.get(x),[]),s=m.useCallback(()=>{const{edges:x=[]}=t.getState();return x.map(w=>({...w}))},[]),i=m.useCallback(x=>{const{edges:w=[]}=t.getState();return w.find(g=>g.id===x)},[]),a=m.useCallback(x=>{const{getNodes:w,setNodes:g,hasDefaultNodes:y,onNodesChange:b}=t.getState(),j=w(),k=typeof x=="function"?x(j):x;if(y)g(k);else if(b){const N=k.length===0?j.map(S=>({type:"remove",id:S.id})):k.map(S=>({item:S,type:"reset"}));b(N)}},[]),l=m.useCallback(x=>{const{edges:w=[],setEdges:g,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),j=typeof x=="function"?x(w):x;if(y)g(j);else if(b){const k=j.length===0?w.map(N=>({type:"remove",id:N.id})):j.map(N=>({item:N,type:"reset"}));b(k)}},[]),c=m.useCallback(x=>{const w=Array.isArray(x)?x:[x],{getNodes:g,setNodes:y,hasDefaultNodes:b,onNodesChange:j}=t.getState();if(b){const N=[...g(),...w];y(N)}else if(j){const k=w.map(N=>({item:N,type:"add"}));j(k)}},[]),d=m.useCallback(x=>{const w=Array.isArray(x)?x:[x],{edges:g=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:j}=t.getState();if(b)y([...g,...w]);else if(j){const k=w.map(N=>({item:N,type:"add"}));j(k)}},[]),u=m.useCallback(()=>{const{getNodes:x,edges:w=[],transform:g}=t.getState(),[y,b,j]=g;return{nodes:x().map(k=>({...k})),edges:w.map(k=>({...k})),viewport:{x:y,y:b,zoom:j}}},[]),f=m.useCallback(({nodes:x,edges:w})=>{const{nodeInternals:g,getNodes:y,edges:b,hasDefaultNodes:j,hasDefaultEdges:k,onNodesDelete:N,onEdgesDelete:S,onNodesChange:C,onEdgesChange:_}=t.getState(),R=(x||[]).map(L=>L.id),T=(w||[]).map(L=>L.id),D=y().reduce((L,A)=>{const P=A.parentNode||A.parentId,M=!R.includes(A.id)&&P&&L.find(O=>O.id===P);return(typeof A.deletable=="boolean"?A.deletable:!0)&&(R.includes(A.id)||M)&&L.push(A),L},[]),$=b.filter(L=>typeof L.deletable=="boolean"?L.deletable:!0),E=$.filter(L=>T.includes(L.id));if(D||E){const L=nE(D,$),A=[...E,...L],P=A.reduce((M,I)=>(M.includes(I.id)||M.push(I.id),M),[]);if((k||j)&&(k&&t.setState({edges:b.filter(M=>!P.includes(M.id))}),j&&(D.forEach(M=>{g.delete(M.id)}),t.setState({nodeInternals:new Map(g)}))),P.length>0&&(S==null||S(A),_&&_(P.map(M=>({id:M,type:"remove"})))),D.length>0&&(N==null||N(D),C)){const M=D.map(I=>({id:I.id,type:"remove"}));C(M)}}},[]),p=m.useCallback(x=>{const w=J6(x),g=w?null:t.getState().nodeInternals.get(x.id);return!w&&!g?[null,null,w]:[w?x:Tb(g),g,w]},[]),h=m.useCallback((x,w=!0,g)=>{const[y,b,j]=p(x);return y?(g||t.getState().getNodes()).filter(k=>{if(!j&&(k.id===b.id||!k.positionAbsolute))return!1;const N=Tb(k),S=Ag(N,y);return w&&S>0||S>=y.width*y.height}):[]},[]),v=m.useCallback((x,w,g=!0)=>{const[y]=p(x);if(!y)return!1;const b=Ag(y,w);return g&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:s,getEdge:i,setNodes:a,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:v}),[e,r,n,s,i,a,l,c,d,u,f,h,v])}const OM={actInsideInputWithModifier:!1};var MM=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=vt(),{deleteElements:n}=ly(),s=ia(e,OM),i=ia(t);m.useEffect(()=>{if(s){const{edges:a,getNodes:l}=r.getState(),c=l().filter(u=>u.selected),d=a.filter(u=>u.selected);n({nodes:c,edges:d}),r.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{r.setState({multiSelectionActive:i})},[i])};function DM(e){const t=vt();m.useEffect(()=>{let r;const n=()=>{var i,a;if(!e.current)return;const s=ey(e.current);(s.height===0||s.width===0)&&((a=(i=t.getState()).onError)==null||a.call(i,"004",hn.error004())),t.setState({width:s.width||500,height:s.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const cy={position:"absolute",width:"100%",height:"100%",top:0,left:0},LM=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,sl=e=>({x:e.x,y:e.y,zoom:e.k}),Ls=(e,t)=>e.target.closest(`.${t}`),Fb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),$b=e=>{const t=e.ctrlKey&&uc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},zM=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),FM=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:a=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=fs.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:v,maxZoom:x,zoomActivationKeyCode:w,preventScrolling:g=!0,children:y,noWheelClassName:b,noPanClassName:j})=>{const k=m.useRef(),N=vt(),S=m.useRef(!1),C=m.useRef(!1),_=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:D,d3ZoomHandler:$,userSelectionActive:E}=Ke(zM,Pt),L=ia(w),A=m.useRef(0),P=m.useRef(!1),M=m.useRef();return DM(_),m.useEffect(()=>{if(_.current){const I=_.current.getBoundingClientRect(),O=WC().scaleExtent([v,x]).translateExtent(h),F=pr(_.current).call(O),q=ln.translate(p.x,p.y).scale(Ni(p.zoom,v,x)),U=[[0,0],[I.width,I.height]],G=O.constrain()(q,U,h);O.transform(F,G),O.wheelDelta($b),N.setState({d3Zoom:O,d3Selection:F,d3ZoomHandler:F.on("wheel.zoom"),transform:[G.x,G.y,G.k],domNode:_.current.closest(".react-flow")})}},[]),m.useEffect(()=>{D&&T&&(a&&!L&&!E?D.on("wheel.zoom",I=>{if(Ls(I,b))return!1;I.preventDefault(),I.stopImmediatePropagation();const O=D.property("__zoom").k||1;if(I.ctrlKey&&i){const oe=kr(I),Q=$b(I),H=O*Math.pow(2,Q);T.scaleTo(D,H,oe,I);return}const F=I.deltaMode===1?20:1;let q=c===fs.Vertical?0:I.deltaX*F,U=c===fs.Horizontal?0:I.deltaY*F;!uc()&&I.shiftKey&&c!==fs.Vertical&&(q=I.deltaY*F,U=0),T.translateBy(D,-(q/O)*l,-(U/O)*l,{internal:!0});const G=sl(D.property("__zoom")),{onViewportChangeStart:J,onViewportChange:B,onViewportChangeEnd:te}=N.getState();clearTimeout(M.current),P.current||(P.current=!0,t==null||t(I,G),J==null||J(G)),P.current&&(e==null||e(I,G),B==null||B(G),M.current=setTimeout(()=>{r==null||r(I,G),te==null||te(G),P.current=!1},150))},{passive:!1}):typeof $<"u"&&D.on("wheel.zoom",function(I,O){if(!g&&I.type==="wheel"&&!I.ctrlKey||Ls(I,b))return null;I.preventDefault(),$.call(this,I,O)},{passive:!1}))},[E,a,c,D,T,$,L,i,g,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",I=>{var q,U;if(!I.sourceEvent||I.sourceEvent.internal)return null;A.current=(q=I.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:O}=N.getState(),F=sl(I.transform);S.current=!0,R.current=F,((U=I.sourceEvent)==null?void 0:U.type)==="mousedown"&&N.setState({paneDragging:!0}),O==null||O(F),t==null||t(I.sourceEvent,F)})},[T,t]),m.useEffect(()=>{T&&(E&&!S.current?T.on("zoom",null):E||T.on("zoom",I=>{var F;const{onViewportChange:O}=N.getState();if(N.setState({transform:[I.transform.x,I.transform.y,I.transform.k]}),C.current=!!(n&&Fb(f,A.current??0)),(e||O)&&!((F=I.sourceEvent)!=null&&F.internal)){const q=sl(I.transform);O==null||O(q),e==null||e(I.sourceEvent,q)}}))},[E,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",I=>{if(!I.sourceEvent||I.sourceEvent.internal)return null;const{onViewportChangeEnd:O}=N.getState();if(S.current=!1,N.setState({paneDragging:!1}),n&&Fb(f,A.current??0)&&!C.current&&n(I.sourceEvent),C.current=!1,(r||O)&&LM(R.current,I.transform)){const F=sl(I.transform);R.current=F,clearTimeout(k.current),k.current=setTimeout(()=>{O==null||O(F),r==null||r(I.sourceEvent,F)},a?150:0)}})},[T,a,f,r,n]),m.useEffect(()=>{T&&T.filter(I=>{const O=L||s,F=i&&I.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&I.button===1&&I.type==="mousedown"&&(Ls(I,"react-flow__node")||Ls(I,"react-flow__edge")))return!0;if(!f&&!O&&!a&&!d&&!i||E||!d&&I.type==="dblclick"||Ls(I,b)&&I.type==="wheel"||Ls(I,j)&&(I.type!=="wheel"||a&&I.type==="wheel"&&!L)||!i&&I.ctrlKey&&I.type==="wheel"||!O&&!a&&!F&&I.type==="wheel"||!f&&(I.type==="mousedown"||I.type==="touchstart")||Array.isArray(f)&&!f.includes(I.button)&&I.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(I.button)||!I.button||I.button<=1;return(!I.ctrlKey||I.type==="wheel")&&q})},[E,T,s,i,a,d,f,u,L]),Y.createElement("div",{className:"react-flow__renderer",ref:_,style:cy},y)},$M=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function qM(){const{userSelectionActive:e,userSelectionRect:t}=Ke($M,Pt);return e&&t?Y.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function qb(e,t){const r=t.parentNode||t.parentId,n=e.find(s=>s.id===r);if(n){const s=t.position.x+t.width-n.width,i=t.position.y+t.height-n.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,s>0&&(n.style.width+=s),i>0&&(n.style.height+=i),t.position.x<0){const a=Math.abs(t.position.x);n.position.x=n.position.x-a,n.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);n.position.y=n.position.y-a,n.style.height+=a,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function bE(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,s)=>{const i=e.filter(l=>l.id===s.id);if(i.length===0)return n.push(s),n;const a={...s};for(const l of i)if(l)switch(l.type){case"select":{a.selected=l.selected;break}case"position":{typeof l.position<"u"&&(a.position=l.position),typeof l.positionAbsolute<"u"&&(a.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(a.dragging=l.dragging),a.expandParent&&qb(n,a);break}case"dimensions":{typeof l.dimensions<"u"&&(a.width=l.dimensions.width,a.height=l.dimensions.height),typeof l.updateStyle<"u"&&(a.style={...a.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(a.resizing=l.resizing),a.expandParent&&qb(n,a);break}case"remove":return n}return n.push(a),n},r)}function wE(e,t){return bE(e,t)}function BM(e,t){return bE(e,t)}const Nn=(e,t)=>({id:e,type:"select",selected:t});function ni(e,t){return e.reduce((r,n)=>{const s=t.includes(n.id);return!n.selected&&s?(n.selected=!0,r.push(Nn(n.id,!0))):n.selected&&!s&&(n.selected=!1,r.push(Nn(n.id,!1))),r},[])}const cd=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},WM=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),_E=m.memo(({isSelecting:e,selectionMode:t=sa.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:a,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=vt(),v=m.useRef(0),x=m.useRef(0),w=m.useRef(),{userSelectionActive:g,elementsSelectable:y,dragging:b}=Ke(WM,Pt),j=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,x.current=0},k=$=>{i==null||i($),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},N=$=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){$.preventDefault();return}a==null||a($)},S=l?$=>l($):void 0,C=$=>{const{resetSelectedElements:E,domNode:L}=h.getState();if(w.current=L==null?void 0:L.getBoundingClientRect(),!y||!e||$.button!==0||$.target!==p.current||!w.current)return;const{x:A,y:P}=Wn($,w.current);E(),h.setState({userSelectionRect:{width:0,height:0,startX:A,startY:P,x:A,y:P}}),n==null||n($)},_=$=>{const{userSelectionRect:E,nodeInternals:L,edges:A,transform:P,onNodesChange:M,onEdgesChange:I,nodeOrigin:O,getNodes:F}=h.getState();if(!e||!w.current||!E)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Wn($,w.current),U=E.startX??0,G=E.startY??0,J={...E,x:q.x<U?q.x:U,y:q.y<G?q.y:G,width:Math.abs(q.x-U),height:Math.abs(q.y-G)},B=F(),te=rE(L,J,P,t===sa.Partial,!0,O),oe=nE(te,A).map(H=>H.id),Q=te.map(H=>H.id);if(v.current!==Q.length){v.current=Q.length;const H=ni(B,Q);H.length&&(M==null||M(H))}if(x.current!==oe.length){x.current=oe.length;const H=ni(A,oe);H.length&&(I==null||I(H))}h.setState({userSelectionRect:J})},R=$=>{if($.button!==0)return;const{userSelectionRect:E}=h.getState();!g&&E&&$.target===p.current&&(k==null||k($)),h.setState({nodesSelectionActive:v.current>0}),j(),s==null||s($)},T=$=>{g&&(h.setState({nodesSelectionActive:v.current>0}),s==null||s($)),j()},D=y&&(e||g);return Y.createElement("div",{className:Qt(["react-flow__pane",{dragging:b,selection:e}]),onClick:D?void 0:cd(k,p),onContextMenu:cd(N,p),onWheel:cd(S,p),onMouseEnter:D?void 0:c,onMouseDown:D?C:void 0,onMouseMove:D?_:d,onMouseUp:D?R:void 0,onMouseLeave:D?T:u,ref:p,style:cy},f,Y.createElement(qM,null))});_E.displayName="Pane";function jE(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:jE(n,t):!1}function Bb(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function HM(e,t,r,n){return Array.from(e.values()).filter(s=>(s.selected||s.id===n)&&(!s.parentNode||s.parentId||!jE(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,a;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:r.y-(((a=s.positionAbsolute)==null?void 0:a.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function UM(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function SE(e,t,r,n,s=[0,0],i){const a=UM(e,e.extent||n);let l=a;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=gs(f,s).positionAbsolute;l=f&&mr(p)&&mr(h)&&mr(f.width)&&mr(f.height)?[[p+e.width*s[0],h+e.height*s[1]],[p+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:l}else i==null||i("005",hn.error005()),l=a;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=gs(f,s).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=r.get(c);d=gs(f,s).positionAbsolute}const u=l&&l!=="parent"?ty(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function ud({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?n.find(s=>s.id===e):n[0],n]}const Wb=(e,t,r,n)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),a=t.getBoundingClientRect(),l={x:a.width*n[0],y:a.height*n[1]};return i.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-a.left-l.x)/r,y:(d.top-a.top-l.y)/r,...ey(c)}})};function Ji(e,t,r){return r===void 0?r:n=>{const s=t().nodeInternals.get(e);s&&r(n,{...s})}}function Dg({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:a,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",hn.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(r||d.selected&&a)&&(i({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=n==null?void 0:n.current)==null?void 0:u.blur()})):s([e])}function VM(){const e=vt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:s,snapToGrid:i}=e.getState(),a=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(a-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:i?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:i?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function dd(e){return(t,r,n)=>e==null?void 0:e(t,n)}function kE({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:i,selectNodesOnDrag:a}){const l=vt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),v=m.useRef({x:0,y:0}),x=m.useRef(null),w=m.useRef(!1),g=m.useRef(!1),y=m.useRef(!1),b=VM();return m.useEffect(()=>{if(e!=null&&e.current){const j=pr(e.current),k=({x:C,y:_})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:D,updateNodePositions:$,nodeExtent:E,snapGrid:L,snapToGrid:A,nodeOrigin:P,onError:M}=l.getState();f.current={x:C,y:_};let I=!1,O={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&E){const q=Jc(u.current,P);O=na(q)}if(u.current=u.current.map(q=>{const U={x:C-q.distance.x,y:_-q.distance.y};A&&(U.x=L[0]*Math.round(U.x/L[0]),U.y=L[1]*Math.round(U.y/L[1]));const G=[[E[0][0],E[0][1]],[E[1][0],E[1][1]]];u.current.length>1&&E&&!q.extent&&(G[0][0]=q.positionAbsolute.x-O.x+E[0][0],G[1][0]=q.positionAbsolute.x+(q.width??0)-O.x2+E[1][0],G[0][1]=q.positionAbsolute.y-O.y+E[0][1],G[1][1]=q.positionAbsolute.y+(q.height??0)-O.y2+E[1][1]);const J=SE(q,U,R,G,P,M);return I=I||q.position.x!==J.position.x||q.position.y!==J.position.y,q.position=J.position,q.positionAbsolute=J.positionAbsolute,q}),!I)return;$(u.current,!0,!0),d(!0);const F=s?T:dd(D);if(F&&x.current){const[q,U]=ud({nodeId:s,dragItems:u.current,nodeInternals:R});F(x.current,q,U)}},N=()=>{if(!h.current)return;const[C,_]=UC(v.current,h.current);if(C!==0||_!==0){const{transform:R,panBy:T}=l.getState();f.current.x=(f.current.x??0)-C/R[2],f.current.y=(f.current.y??0)-_/R[2],T({x:C,y:_})&&k(f.current)}p.current=requestAnimationFrame(N)},S=C=>{var P;const{nodeInternals:_,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:D,onNodeDragStart:$,onSelectionDragStart:E}=l.getState();g.current=!0;const L=s?$:dd(E);(!a||!i)&&!R&&s&&((P=_.get(s))!=null&&P.selected||D()),s&&i&&a&&Dg({id:s,store:l,nodeRef:e});const A=b(C);if(f.current=A,u.current=HM(_,T,A,s),L&&u.current){const[M,I]=ud({nodeId:s,dragItems:u.current,nodeInternals:_});L(C.sourceEvent,M,I)}};if(t)j.on(".drag",null);else{const C=nO().on("start",_=>{const{domNode:R,nodeDragThreshold:T}=l.getState();T===0&&S(_),y.current=!1;const D=b(_);f.current=D,h.current=(R==null?void 0:R.getBoundingClientRect())||null,v.current=Wn(_.sourceEvent,h.current)}).on("drag",_=>{var $,E;const R=b(_),{autoPanOnNodeDrag:T,nodeDragThreshold:D}=l.getState();if(_.sourceEvent.type==="touchmove"&&_.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!w.current&&g.current&&T&&(w.current=!0,N()),!g.current){const L=R.xSnapped-((($=f==null?void 0:f.current)==null?void 0:$.x)??0),A=R.ySnapped-(((E=f==null?void 0:f.current)==null?void 0:E.y)??0);Math.sqrt(L*L+A*A)>D&&S(_)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&u.current&&g.current&&(x.current=_.sourceEvent,v.current=Wn(_.sourceEvent,h.current),k(R))}}).on("end",_=>{if(!(!g.current||y.current)&&(d(!1),w.current=!1,g.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:D,onSelectionDragStop:$}=l.getState(),E=s?D:dd($);if(R(u.current,!1,!1),E){const[L,A]=ud({nodeId:s,dragItems:u.current,nodeInternals:T});E(_.sourceEvent,L,A)}}}).filter(_=>{const R=_.target;return!_.button&&(!r||!Bb(R,`.${r}`,e))&&(!n||Bb(R,n,e))});return j.call(C),()=>{j.on(".drag",null)}}}},[e,t,r,n,i,l,s,a,b]),c}function NE(){const e=vt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:s,updateNodePositions:i,getNodes:a,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=a().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,v=r.isShiftPressed?4:1,x=r.x*p*v,w=r.y*h*v,g=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+x,y:y.positionAbsolute.y+w};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:j,position:k}=SE(y,b,n,s,void 0,d);y.position=k,y.positionAbsolute=j}return y});i(g,!0,!1)},[])}const hi={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var eo=e=>{const t=({id:r,type:n,data:s,xPos:i,yPos:a,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:v,onDoubleClick:x,style:w,className:g,isDraggable:y,isSelectable:b,isConnectable:j,isFocusable:k,selectNodesOnDrag:N,sourcePosition:S,targetPosition:C,hidden:_,resizeObserver:R,dragHandle:T,zIndex:D,isParent:$,noDragClassName:E,noPanClassName:L,initialized:A,disableKeyboardA11y:P,ariaLabel:M,rfId:I,hasHandleBounds:O})=>{const F=vt(),q=m.useRef(null),U=m.useRef(null),G=m.useRef(S),J=m.useRef(C),B=m.useRef(n),te=b||y||u||f||p||h,oe=NE(),Q=Ji(r,F.getState,f),H=Ji(r,F.getState,p),ie=Ji(r,F.getState,h),ae=Ji(r,F.getState,v),pe=Ji(r,F.getState,x),me=ee=>{const{nodeDragThreshold:re}=F.getState();if(b&&(!N||!y||re>0)&&Dg({id:r,store:F,nodeRef:q}),u){const je=F.getState().nodeInternals.get(r);je&&u(ee,{...je})}},le=ee=>{if(!Rg(ee)&&!P)if(YC.includes(ee.key)&&b){const re=ee.key==="Escape";Dg({id:r,store:F,unselect:re,nodeRef:q})}else y&&d&&Object.prototype.hasOwnProperty.call(hi,ee.key)&&(F.setState({ariaLiveMessage:`Moved selected node ${ee.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~a}`}),oe({x:hi[ee.key].x,y:hi[ee.key].y,isShiftPressed:ee.shiftKey}))};m.useEffect(()=>()=>{U.current&&(R==null||R.unobserve(U.current),U.current=null)},[]),m.useEffect(()=>{if(q.current&&!_){const ee=q.current;(!A||!O||U.current!==ee)&&(U.current&&(R==null||R.unobserve(U.current)),R==null||R.observe(ee),U.current=ee)}},[_,A,O]),m.useEffect(()=>{const ee=B.current!==n,re=G.current!==S,je=J.current!==C;q.current&&(ee||re||je)&&(ee&&(B.current=n),re&&(G.current=S),je&&(J.current=C),F.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,n,S,C]);const V=kE({nodeRef:q,disabled:_||!y,noDragClassName:E,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:N});return _?null:Y.createElement("div",{className:Qt(["react-flow__node",`react-flow__node-${n}`,{[L]:y},g,{selected:d,selectable:b,parent:$,dragging:V}]),ref:q,style:{zIndex:D,transform:`translate(${l}px,${c}px)`,pointerEvents:te?"all":"none",visibility:A?"visible":"hidden",...w},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:Q,onMouseMove:H,onMouseLeave:ie,onContextMenu:ae,onClick:me,onDoubleClick:pe,onKeyDown:k?le:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":P?void 0:`${mE}-${I}`,"aria-label":M},Y.createElement(oM,{value:r},Y.createElement(e,{id:r,data:s,type:n,xPos:i,yPos:a,selected:d,isConnectable:j,sourcePosition:S,targetPosition:C,dragging:V,dragHandle:T,zIndex:D})))};return t.displayName="NodeWrapper",m.memo(t)};const GM=e=>{const t=e.getNodes().filter(r=>r.selected);return{...Jc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function KM({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=vt(),{width:s,height:i,x:a,y:l,transformString:c,userSelectionActive:d}=Ke(GM,Pt),u=NE(),f=m.useRef(null);if(m.useEffect(()=>{var v;r||(v=f.current)==null||v.focus({preventScroll:!0})},[r]),kE({nodeRef:f}),d||!s||!i)return null;const p=e?v=>{const x=n.getState().getNodes().filter(w=>w.selected);e(v,x)}:void 0,h=v=>{Object.prototype.hasOwnProperty.call(hi,v.key)&&u({x:hi[v.key].x,y:hi[v.key].y,isShiftPressed:v.shiftKey})};return Y.createElement("div",{className:Qt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},Y.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:s,height:i,top:l,left:a}}))}var YM=m.memo(KM);const QM=e=>e.nodesSelectionActive,CE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:v,onSelectionEnd:x,multiSelectionKeyCode:w,panActivationKeyCode:g,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:k,panOnScroll:N,panOnScrollSpeed:S,panOnScrollMode:C,zoomOnDoubleClick:_,panOnDrag:R,defaultViewport:T,translateExtent:D,minZoom:$,maxZoom:E,preventScrolling:L,onSelectionContextMenu:A,noWheelClassName:P,noPanClassName:M,disableKeyboardA11y:I})=>{const O=Ke(QM),F=ia(f),q=ia(g),U=q||R,G=q||N,J=F||p&&U!==!0;return MM({deleteKeyCode:l,multiSelectionKeyCode:w}),Y.createElement(FM,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:i,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:k,panOnScroll:G,panOnScrollSpeed:S,panOnScrollMode:C,zoomOnDoubleClick:_,panOnDrag:!F&&U,defaultViewport:T,translateExtent:D,minZoom:$,maxZoom:E,zoomActivationKeyCode:y,preventScrolling:L,noWheelClassName:P,noPanClassName:M},Y.createElement(_E,{onSelectionStart:v,onSelectionEnd:x,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,panOnDrag:U,isSelecting:!!J,selectionMode:h},e,O&&Y.createElement(YM,{onSelectionContextMenu:A,noPanClassName:M,disableKeyboardA11y:I})))};CE.displayName="FlowRenderer";var XM=m.memo(CE);function ZM(e){return Ke(m.useCallback(r=>e?rE(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function JM(e){const t={input:eo(e.input||dE),default:eo(e.default||Mg),output:eo(e.output||pE),group:eo(e.group||ay)},r={},n=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=eo(e[i]||Mg),s),r);return{...t,...n}}const eD=({x:e,y:t,width:r,height:n,origin:s})=>!r||!n?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-n*s[1]},tD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),EE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,updateNodeDimensions:i,onError:a}=Ke(tD,Pt),l=ZM(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));i(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),Y.createElement("div",{className:"react-flow__nodes",style:cy},l.map(u=>{var k,N,S;let f=u.type||"default";e.nodeTypes[f]||(a==null||a("003",hn.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),v=!!(u.selectable||s&&typeof u.selectable>"u"),x=!!(u.connectable||r&&typeof u.connectable>"u"),w=!!(u.focusable||n&&typeof u.focusable>"u"),g=e.nodeExtent?ty(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(g==null?void 0:g.x)??0,b=(g==null?void 0:g.y)??0,j=eD({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return Y.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||fe.Bottom,targetPosition:u.targetPosition||fe.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:j.x,yPosOrigin:j.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:v,isConnectable:x,isFocusable:w,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((k=u[rt])==null?void 0:k.z)??0,isParent:!!((N=u[rt])!=null&&N.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((S=u[rt])!=null&&S.handleBounds)})}))};EE.displayName="NodeRenderer";var rD=m.memo(EE);const nD=(e,t,r)=>r===fe.Left?e-t:r===fe.Right?e+t:e,sD=(e,t,r)=>r===fe.Top?e-t:r===fe.Bottom?e+t:e,Hb="react-flow__edgeupdater",Ub=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:i,onMouseOut:a,type:l})=>Y.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:a,className:Qt([Hb,`${Hb}-${l}`]),cx:nD(t,n,e),cy:sD(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),iD=()=>!0;var zs=e=>{const t=({id:r,className:n,type:s,data:i,onClick:a,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:x,style:w,source:g,target:y,sourceX:b,sourceY:j,targetX:k,targetY:N,sourcePosition:S,targetPosition:C,elementsSelectable:_,hidden:R,sourceHandleId:T,targetHandleId:D,onContextMenu:$,onMouseEnter:E,onMouseMove:L,onMouseLeave:A,reconnectRadius:P,onReconnect:M,onReconnectStart:I,onReconnectEnd:O,markerEnd:F,markerStart:q,rfId:U,ariaLabel:G,isFocusable:J,isReconnectable:B,pathOptions:te,interactionWidth:oe,disableKeyboardA11y:Q})=>{const H=m.useRef(null),[ie,ae]=m.useState(!1),[pe,me]=m.useState(!1),le=vt(),V=m.useMemo(()=>`url('#${Pg(q,U)}')`,[q,U]),ee=m.useMemo(()=>`url('#${Pg(F,U)}')`,[F,U]);if(R)return null;const re=Te=>{var bt;const{edges:X,addSelectedEdges:Ne,unselectNodesAndEdges:xe,multiSelectionActive:Ct}=le.getState(),yt=X.find(Zt=>Zt.id===r);yt&&(_&&(le.setState({nodesSelectionActive:!1}),yt.selected&&Ct?(xe({nodes:[],edges:[yt]}),(bt=H.current)==null||bt.blur()):Ne([r])),a&&a(Te,yt))},je=Zi(r,le.getState,l),be=Zi(r,le.getState,$),Re=Zi(r,le.getState,E),Ie=Zi(r,le.getState,L),ne=Zi(r,le.getState,A),we=(Te,X)=>{if(Te.button!==0)return;const{edges:Ne,isValidConnection:xe}=le.getState(),Ct=X?y:g,yt=(X?D:T)||null,bt=X?"target":"source",Zt=xe||iD,z=X,W=Ne.find(Le=>Le.id===r);me(!0),I==null||I(Te,W,bt);const K=Le=>{me(!1),O==null||O(Le,W,bt)};aE({event:Te,handleId:yt,nodeId:Ct,onConnect:Le=>M==null?void 0:M(W,Le),isTarget:z,getState:le.getState,setState:le.setState,isValidConnection:Zt,edgeUpdaterType:bt,onReconnectEnd:K})},Je=Te=>we(Te,!0),pt=Te=>we(Te,!1),qe=()=>ae(!0),Pe=()=>ae(!1),Be=!_&&!a,et=Te=>{var X;if(!Q&&YC.includes(Te.key)&&_){const{unselectNodesAndEdges:Ne,addSelectedEdges:xe,edges:Ct}=le.getState();Te.key==="Escape"?((X=H.current)==null||X.blur(),Ne({edges:[Ct.find(bt=>bt.id===r)]})):xe([r])}};return Y.createElement("g",{className:Qt(["react-flow__edge",`react-flow__edge-${s}`,n,{selected:c,animated:d,inactive:Be,updating:ie}]),onClick:re,onDoubleClick:je,onContextMenu:be,onMouseEnter:Re,onMouseMove:Ie,onMouseLeave:ne,onKeyDown:J?et:void 0,tabIndex:J?0:void 0,role:J?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":G===null?void 0:G||`Edge from ${g} to ${y}`,"aria-describedby":J?`${xE}-${U}`:void 0,ref:H},!pe&&Y.createElement(e,{id:r,source:g,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:x,data:i,style:w,sourceX:b,sourceY:j,targetX:k,targetY:N,sourcePosition:S,targetPosition:C,sourceHandleId:T,targetHandleId:D,markerStart:V,markerEnd:ee,pathOptions:te,interactionWidth:oe}),B&&Y.createElement(Y.Fragment,null,(B==="source"||B===!0)&&Y.createElement(Ub,{position:S,centerX:b,centerY:j,radius:P,onMouseDown:Je,onMouseEnter:qe,onMouseOut:Pe,type:"source"}),(B==="target"||B===!0)&&Y.createElement(Ub,{position:C,centerX:k,centerY:N,radius:P,onMouseDown:pt,onMouseEnter:qe,onMouseOut:Pe,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function oD(e){const t={default:zs(e.default||fc),straight:zs(e.bezier||sy),step:zs(e.step||ny),smoothstep:zs(e.step||Zc),simplebezier:zs(e.simplebezier||ry)},r={},n=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=zs(e[i]||fc),s),r);return{...t,...n}}function Vb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,i=(r==null?void 0:r.width)||t.width,a=(r==null?void 0:r.height)||t.height;switch(e){case fe.Top:return{x:n+i/2,y:s};case fe.Right:return{x:n+i,y:s+a/2};case fe.Bottom:return{x:n+i/2,y:s+a};case fe.Left:return{x:n,y:s+a/2}}}function Gb(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const aD=(e,t,r,n,s,i)=>{const a=Vb(r,e,t),l=Vb(i,n,s);return{sourceX:a.x,sourceY:a.y,targetX:l.x,targetY:l.y}};function lD({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:s,targetHeight:i,width:a,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+n,t.y+i)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=na({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:a/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Kb(e){var n,s,i,a,l;const t=((n=e==null?void 0:e[rt])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const cD=[{level:0,isMaxLevel:!0,edges:[]}];function uD(e,t,r=!1){let n=-1;const s=e.reduce((a,l)=>{var u,f;const c=mr(l.zIndex);let d=c?l.zIndex:0;if(r){const p=t.get(l.target),h=t.get(l.source),v=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),x=Math.max(((u=h==null?void 0:h[rt])==null?void 0:u.z)||0,((f=p==null?void 0:p[rt])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(v?x:0)}return a[d]?a[d].push(l):a[d]=[l],n=d>n?d:n,a},{}),i=Object.entries(s).map(([a,l])=>{const c=+a;return{edges:l,level:c,isMaxLevel:c===n}});return i.length===0?cD:i}function dD(e,t,r){const n=Ke(m.useCallback(s=>e?s.edges.filter(i=>{const a=t.get(i.source),l=t.get(i.target);return(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&lD({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return uD(n,t,r)}const fD=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),pD=({color:e="none",strokeWidth:t=1})=>Y.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Yb={[dc.Arrow]:fD,[dc.ArrowClosed]:pD};function hD(e){const t=vt();return m.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(Yb,e)?Yb[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",hn.error009(e)),null)},[e])}const mD=({id:e,type:t,color:r,width:n=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{const c=hD(t);return c?Y.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:l,refX:"0",refY:"0"},Y.createElement(c,{color:r,strokeWidth:a})):null},xD=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const l=Pg(a,t);n.includes(l)||(s.push({id:l,color:a.color||e,...a}),n.push(l))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},TE=({defaultColor:e,rfId:t})=>{const r=Ke(m.useCallback(xD({defaultColor:e,rfId:t}),[e,t]),(n,s)=>!(n.length!==s.length||n.some((i,a)=>i.id!==s[a].id)));return Y.createElement("defs",null,r.map(n=>Y.createElement(mD,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};TE.displayName="MarkerDefinitions";var gD=m.memo(TE);const vD=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),AE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:x,children:w,disableKeyboardA11y:g})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:j,width:k,height:N,connectionMode:S,nodeInternals:C,onError:_}=Ke(vD,Pt),R=dD(t,C,r);return k?Y.createElement(Y.Fragment,null,R.map(({level:T,edges:D,isMaxLevel:$})=>Y.createElement("svg",{key:T,style:{zIndex:T},width:k,height:N,className:"react-flow__edges react-flow__container"},$&&Y.createElement(gD,{defaultColor:e,rfId:n}),Y.createElement("g",null,D.map(E=>{const[L,A,P]=Kb(C.get(E.source)),[M,I,O]=Kb(C.get(E.target));if(!P||!O)return null;let F=E.type||"default";s[F]||(_==null||_("011",hn.error011(F)),F="default");const q=s[F]||s.default,U=S===ks.Strict?I.target:(I.target??[]).concat(I.source??[]),G=Gb(A.source,E.sourceHandle),J=Gb(U,E.targetHandle),B=(G==null?void 0:G.position)||fe.Bottom,te=(J==null?void 0:J.position)||fe.Top,oe=!!(E.focusable||y&&typeof E.focusable>"u"),Q=E.reconnectable||E.updatable,H=typeof p<"u"&&(Q||b&&typeof Q>"u");if(!G||!J)return _==null||_("008",hn.error008(G,E)),null;const{sourceX:ie,sourceY:ae,targetX:pe,targetY:me}=aD(L,G,B,M,J,te);return Y.createElement(q,{key:E.id,id:E.id,className:Qt([E.className,i]),type:F,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:ie,sourceY:ae,targetX:pe,targetY:me,sourcePosition:B,targetPosition:te,elementsSelectable:j,onContextMenu:a,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:x,rfId:n,ariaLabel:E.ariaLabel,isFocusable:oe,isReconnectable:H,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth,disableKeyboardA11y:g})})))),w):null};AE.displayName="EdgeRenderer";var yD=m.memo(AE);const bD=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function wD({children:e}){const t=Ke(bD);return Y.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function _D(e){const t=ly(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const jD={[fe.Left]:fe.Right,[fe.Right]:fe.Left,[fe.Top]:fe.Bottom,[fe.Bottom]:fe.Top},RE=({nodeId:e,handleType:t,style:r,type:n=An.Bezier,CustomComponent:s,connectionStatus:i})=>{var N,S,C;const{fromNode:a,handleId:l,toX:c,toY:d,connectionMode:u}=Ke(m.useCallback(_=>({fromNode:_.nodeInternals.get(e),handleId:_.connectionHandleId,toX:(_.connectionPosition.x-_.transform[0])/_.transform[2],toY:(_.connectionPosition.y-_.transform[1])/_.transform[2],connectionMode:_.connectionMode}),[e]),Pt),f=(N=a==null?void 0:a[rt])==null?void 0:N.handleBounds;let p=f==null?void 0:f[t];if(u===ks.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!a||!p)return null;const h=l?p.find(_=>_.id===l):p[0],v=h?h.x+h.width/2:(a.width??0)/2,x=h?h.y+h.height/2:a.height??0,w=(((S=a.positionAbsolute)==null?void 0:S.x)??0)+v,g=(((C=a.positionAbsolute)==null?void 0:C.y)??0)+x,y=h==null?void 0:h.position,b=y?jD[y]:null;if(!y||!b)return null;if(s)return Y.createElement(s,{connectionLineType:n,connectionLineStyle:r,fromNode:a,fromHandle:h,fromX:w,fromY:g,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:i});let j="";const k={sourceX:w,sourceY:g,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return n===An.Bezier?[j]=eE(k):n===An.Step?[j]=Ig({...k,borderRadius:0}):n===An.SmoothStep?[j]=Ig(k):n===An.SimpleBezier?[j]=JC(k):j=`M${w},${g} ${c},${d}`,Y.createElement("path",{d:j,fill:"none",className:"react-flow__connection-path",style:r})};RE.displayName="ConnectionLine";const SD=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function kD({containerStyle:e,style:t,type:r,component:n}){const{nodeId:s,handleType:i,nodesConnectable:a,width:l,height:c,connectionStatus:d}=Ke(SD,Pt);return!(s&&i&&l&&a)?null:Y.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},Y.createElement("g",{className:Qt(["react-flow__connection",d])},Y.createElement(RE,{nodeId:s,handleType:i,style:t,type:r,CustomComponent:n,connectionStatus:d})))}function Qb(e,t){return m.useRef(null),vt(),m.useMemo(()=>t(e),[e])}const IE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:s,onInit:i,onNodeClick:a,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:v,onSelectionStart:x,onSelectionEnd:w,connectionLineType:g,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:j,selectionKeyCode:k,selectionOnDrag:N,selectionMode:S,multiSelectionKeyCode:C,panActivationKeyCode:_,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:D,elementsSelectable:$,selectNodesOnDrag:E,defaultViewport:L,translateExtent:A,minZoom:P,maxZoom:M,preventScrolling:I,defaultMarkerColor:O,zoomOnScroll:F,zoomOnPinch:q,panOnScroll:U,panOnScrollSpeed:G,panOnScrollMode:J,zoomOnDoubleClick:B,panOnDrag:te,onPaneClick:oe,onPaneMouseEnter:Q,onPaneMouseMove:H,onPaneMouseLeave:ie,onPaneScroll:ae,onPaneContextMenu:pe,onEdgeContextMenu:me,onEdgeMouseEnter:le,onEdgeMouseMove:V,onEdgeMouseLeave:ee,onReconnect:re,onReconnectStart:je,onReconnectEnd:be,reconnectRadius:Re,noDragClassName:Ie,noWheelClassName:ne,noPanClassName:we,elevateEdgesOnSelect:Je,disableKeyboardA11y:pt,nodeOrigin:qe,nodeExtent:Pe,rfId:Be})=>{const et=Qb(e,JM),Te=Qb(t,oD);return _D(i),Y.createElement(XM,{onPaneClick:oe,onPaneMouseEnter:Q,onPaneMouseMove:H,onPaneMouseLeave:ie,onPaneContextMenu:pe,onPaneScroll:ae,deleteKeyCode:T,selectionKeyCode:k,selectionOnDrag:N,selectionMode:S,onSelectionStart:x,onSelectionEnd:w,multiSelectionKeyCode:C,panActivationKeyCode:_,zoomActivationKeyCode:R,elementsSelectable:$,onMove:r,onMoveStart:n,onMoveEnd:s,zoomOnScroll:F,zoomOnPinch:q,zoomOnDoubleClick:B,panOnScroll:U,panOnScrollSpeed:G,panOnScrollMode:J,panOnDrag:te,defaultViewport:L,translateExtent:A,minZoom:P,maxZoom:M,onSelectionContextMenu:v,preventScrolling:I,noDragClassName:Ie,noWheelClassName:ne,noPanClassName:we,disableKeyboardA11y:pt},Y.createElement(wD,null,Y.createElement(yD,{edgeTypes:Te,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:D,onEdgeContextMenu:me,onEdgeMouseEnter:le,onEdgeMouseMove:V,onEdgeMouseLeave:ee,onReconnect:re,onReconnectStart:je,onReconnectEnd:be,reconnectRadius:Re,defaultMarkerColor:O,noPanClassName:we,elevateEdgesOnSelect:!!Je,disableKeyboardA11y:pt,rfId:Be},Y.createElement(kD,{style:y,type:g,component:b,containerStyle:j})),Y.createElement("div",{className:"react-flow__edgelabel-renderer"}),Y.createElement(rD,{nodeTypes:et,onNodeClick:a,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:E,onlyRenderVisibleElements:D,noPanClassName:we,noDragClassName:Ie,disableKeyboardA11y:pt,nodeOrigin:qe,nodeExtent:Pe,rfId:Be})))};IE.displayName="GraphView";var ND=m.memo(IE);const Lg=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Lg,nodeExtent:Lg,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ks.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:eM,isValidConnection:void 0},CD=()=>mI((e,t)=>({...wn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:ld(r,n,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(s=>({...n,...s}))})},setDefaultNodesAndEdges:(r,n)=>{const s=typeof r<"u",i=typeof n<"u",a=s?ld(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:i?n:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:a,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((x,w)=>{const g=s.get(w.id);if(g!=null&&g.hidden)s.set(g.id,{...g,[rt]:{...g[rt],handleBounds:void 0}});else if(g){const y=ey(w.nodeElement);!!(y.width&&y.height&&(g.width!==y.width||g.height!==y.height||w.forceUpdate))&&(s.set(g.id,{...g,[rt]:{...g[rt],handleBounds:{source:Wb(".source",w.nodeElement,p,d),target:Wb(".target",w.nodeElement,p,d)}},...y}),x.push({id:g.id,type:"dimensions",dimensions:y}))}return x},[]);vE(s,d);const v=a||i&&!a&&yE(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:v}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),a=r.map(l=>{const c={id:l.id,type:"position",dragging:s};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});i(a)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:a,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(i){const d=wE(r,l()),u=ld(d,s,a,c);e({nodeInternals:u})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:s,getNodes:i}=t();let a,l=null;n?a=r.map(c=>Nn(c,!0)):(a=ni(i(),r),l=ni(s,[])),nl({changedNodes:a,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:s,getNodes:i}=t();let a,l=null;n?a=r.map(c=>Nn(c,!0)):(a=ni(s,r),l=ni(i(),[])),nl({changedNodes:l,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:s,getNodes:i}=t(),a=r||i(),l=n||s,c=a.map(u=>(u.selected=!1,Nn(u.id,!1))),d=l.map(u=>Nn(u.id,!1));nl({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:s}=t();n==null||n.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:s}=t();n==null||n.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),i=n().filter(l=>l.selected).map(l=>Nn(l.id,!1)),a=r.filter(l=>l.selected).map(l=>Nn(l.id,!1));nl({changedNodes:i,changedEdges:a,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(s=>{s.positionAbsolute=ty(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:s,height:i,d3Zoom:a,d3Selection:l,translateExtent:c}=t();if(!a||!l||!r.x&&!r.y)return!1;const d=ln.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),u=[[0,0],[s,i]],f=a==null?void 0:a.constrain()(d,u,c);return a.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wn.connectionNodeId,connectionHandleId:wn.connectionHandleId,connectionHandleType:wn.connectionHandleType,connectionStatus:wn.connectionStatus,connectionStartHandle:wn.connectionStartHandle,connectionEndHandle:wn.connectionEndHandle}),reset:()=>e({...wn})}),Object.is),eu=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=CD()),Y.createElement(G6,{value:t.current},e)};eu.displayName="ReactFlowProvider";const PE=({children:e})=>m.useContext(Xc)?Y.createElement(Y.Fragment,null,e):Y.createElement(eu,null,e);PE.displayName="ReactFlowWrapper";const ED={input:dE,default:Mg,output:pE,group:ay},TD={default:fc,straight:sy,step:ny,smoothstep:Zc,simplebezier:ry},AD=[0,0],RD=[15,15],ID={x:0,y:0,zoom:1},PD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},uy=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:i=ED,edgeTypes:a=TD,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:v,onConnectEnd:x,onClickConnectStart:w,onClickConnectEnd:g,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:k,onNodeDoubleClick:N,onNodeDragStart:S,onNodeDrag:C,onNodeDragStop:_,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:D,onSelectionDragStart:$,onSelectionDrag:E,onSelectionDragStop:L,onSelectionContextMenu:A,onSelectionStart:P,onSelectionEnd:M,connectionMode:I=ks.Strict,connectionLineType:O=An.Bezier,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:U,deleteKeyCode:G="Backspace",selectionKeyCode:J="Shift",selectionOnDrag:B=!1,selectionMode:te=sa.Full,panActivationKeyCode:oe="Space",multiSelectionKeyCode:Q=uc()?"Meta":"Control",zoomActivationKeyCode:H=uc()?"Meta":"Control",snapToGrid:ie=!1,snapGrid:ae=RD,onlyRenderVisibleElements:pe=!1,selectNodesOnDrag:me=!0,nodesDraggable:le,nodesConnectable:V,nodesFocusable:ee,nodeOrigin:re=AD,edgesFocusable:je,edgesUpdatable:be,elementsSelectable:Re,defaultViewport:Ie=ID,minZoom:ne=.5,maxZoom:we=2,translateExtent:Je=Lg,preventScrolling:pt=!0,nodeExtent:qe,defaultMarkerColor:Pe="#b1b1b7",zoomOnScroll:Be=!0,zoomOnPinch:et=!0,panOnScroll:Te=!1,panOnScrollSpeed:X=.5,panOnScrollMode:Ne=fs.Free,zoomOnDoubleClick:xe=!0,panOnDrag:Ct=!0,onPaneClick:yt,onPaneMouseEnter:bt,onPaneMouseMove:Zt,onPaneMouseLeave:z,onPaneScroll:W,onPaneContextMenu:K,children:se,onEdgeContextMenu:Le,onEdgeDoubleClick:lt,onEdgeMouseEnter:lr,onEdgeMouseMove:Et,onEdgeMouseLeave:wt,onEdgeUpdate:qt,onEdgeUpdateStart:Mr,onEdgeUpdateEnd:nt,onReconnect:ue,onReconnectStart:de,onReconnectEnd:He,reconnectRadius:wr=10,edgeUpdaterRadius:ts=10,onNodesChange:Dr,onEdgesChange:rs,noDragClassName:qi="nodrag",noWheelClassName:RA="nowheel",noPanClassName:Gy="nopan",fitView:IA=!1,fitViewOptions:PA,connectOnClick:OA=!0,attributionPosition:MA,proOptions:DA,defaultEdgeOptions:LA,elevateNodesOnSelect:zA=!0,elevateEdgesOnSelect:FA=!1,disableKeyboardA11y:Ky=!1,autoPanOnConnect:$A=!0,autoPanOnNodeDrag:qA=!0,connectionRadius:BA=20,isValidConnection:WA,onError:HA,style:UA,id:Yy,nodeDragThreshold:VA,...GA},KA)=>{const Tu=Yy||"1";return Y.createElement("div",{...GA,style:{...UA,...PD},ref:KA,className:Qt(["react-flow",s]),"data-testid":"rf__wrapper",id:Yy},Y.createElement(PE,null,Y.createElement(ND,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:k,onNodeDoubleClick:N,nodeTypes:i,edgeTypes:a,connectionLineType:O,connectionLineStyle:F,connectionLineComponent:q,connectionLineContainerStyle:U,selectionKeyCode:J,selectionOnDrag:B,selectionMode:te,deleteKeyCode:G,multiSelectionKeyCode:Q,panActivationKeyCode:oe,zoomActivationKeyCode:H,onlyRenderVisibleElements:pe,selectNodesOnDrag:me,defaultViewport:Ie,translateExtent:Je,minZoom:ne,maxZoom:we,preventScrolling:pt,zoomOnScroll:Be,zoomOnPinch:et,zoomOnDoubleClick:xe,panOnScroll:Te,panOnScrollSpeed:X,panOnScrollMode:Ne,panOnDrag:Ct,onPaneClick:yt,onPaneMouseEnter:bt,onPaneMouseMove:Zt,onPaneMouseLeave:z,onPaneScroll:W,onPaneContextMenu:K,onSelectionContextMenu:A,onSelectionStart:P,onSelectionEnd:M,onEdgeContextMenu:Le,onEdgeDoubleClick:lt,onEdgeMouseEnter:lr,onEdgeMouseMove:Et,onEdgeMouseLeave:wt,onReconnect:ue??qt,onReconnectStart:de??Mr,onReconnectEnd:He??nt,reconnectRadius:wr??ts,defaultMarkerColor:Pe,noDragClassName:qi,noWheelClassName:RA,noPanClassName:Gy,elevateEdgesOnSelect:FA,rfId:Tu,disableKeyboardA11y:Ky,nodeOrigin:re,nodeExtent:qe}),Y.createElement(jM,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:v,onConnectEnd:x,onClickConnectStart:w,onClickConnectEnd:g,nodesDraggable:le,nodesConnectable:V,nodesFocusable:ee,edgesFocusable:je,edgesUpdatable:be,elementsSelectable:Re,elevateNodesOnSelect:zA,minZoom:ne,maxZoom:we,nodeExtent:qe,onNodesChange:Dr,onEdgesChange:rs,snapToGrid:ie,snapGrid:ae,connectionMode:I,translateExtent:Je,connectOnClick:OA,defaultEdgeOptions:LA,fitView:IA,fitViewOptions:PA,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:S,onNodeDrag:C,onNodeDragStop:_,onSelectionDrag:E,onSelectionDragStart:$,onSelectionDragStop:L,noPanClassName:Gy,nodeOrigin:re,rfId:Tu,autoPanOnConnect:$A,autoPanOnNodeDrag:qA,onError:HA,connectionRadius:BA,isValidConnection:WA,nodeDragThreshold:VA}),Y.createElement(wM,{onSelectionChange:D}),se,Y.createElement(Y6,{proOptions:DA,position:MA}),Y.createElement(EM,{rfId:Tu,disableKeyboardA11y:Ky})))});uy.displayName="ReactFlow";function OE(e){return t=>{const[r,n]=m.useState(t),s=m.useCallback(i=>n(a=>e(i,a)),[]);return[r,n,s]}}const OD=OE(wE),MD=OE(BM),ME=({id:e,x:t,y:r,width:n,height:s,style:i,color:a,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:v,backgroundColor:x}=i||{},w=a||v||x;return Y.createElement("rect",{className:Qt(["react-flow__minimap-node",{selected:h},d]),x:t,y:r,rx:u,ry:u,width:n,height:s,fill:w,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?g=>p(g,e):void 0})};ME.displayName="MiniMapNode";var DD=m.memo(ME);const LD=e=>e.nodeOrigin,zD=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),fd=e=>e instanceof Function?e:()=>e;function FD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:s=2,nodeComponent:i=DD,onClick:a}){const l=Ke(zD,Pt),c=Ke(LD),d=fd(t),u=fd(e),f=fd(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Y.createElement(Y.Fragment,null,l.map(h=>{const{x:v,y:x}=gs(h,c).positionAbsolute;return Y.createElement(i,{key:h.id,x:v,y:x,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:n,strokeColor:u(h),strokeWidth:s,shapeRendering:p,onClick:a,id:h.id})}))}var $D=m.memo(FD);const qD=200,BD=150,WD=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?Z6(Jc(t,e.nodeOrigin),r):r,rfId:e.rfId}},HD="react-flow__minimap-desc";function DE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:a=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:v=!1,zoomable:x=!1,ariaLabel:w="React Flow mini map",inversePan:g=!1,zoomStep:y=10,offsetScale:b=5}){const j=vt(),k=m.useRef(null),{boundingRect:N,viewBB:S,rfId:C}=Ke(WD,Pt),_=(e==null?void 0:e.width)??qD,R=(e==null?void 0:e.height)??BD,T=N.width/_,D=N.height/R,$=Math.max(T,D),E=$*_,L=$*R,A=b*$,P=N.x-(E-N.width)/2-A,M=N.y-(L-N.height)/2-A,I=E+A*2,O=L+A*2,F=`${HD}-${C}`,q=m.useRef(0);q.current=$,m.useEffect(()=>{if(k.current){const J=pr(k.current),B=Q=>{const{transform:H,d3Selection:ie,d3Zoom:ae}=j.getState();if(Q.sourceEvent.type!=="wheel"||!ie||!ae)return;const pe=-Q.sourceEvent.deltaY*(Q.sourceEvent.deltaMode===1?.05:Q.sourceEvent.deltaMode?1:.002)*y,me=H[2]*Math.pow(2,pe);ae.scaleTo(ie,me)},te=Q=>{const{transform:H,d3Selection:ie,d3Zoom:ae,translateExtent:pe,width:me,height:le}=j.getState();if(Q.sourceEvent.type!=="mousemove"||!ie||!ae)return;const V=q.current*Math.max(1,H[2])*(g?-1:1),ee={x:H[0]-Q.sourceEvent.movementX*V,y:H[1]-Q.sourceEvent.movementY*V},re=[[0,0],[me,le]],je=ln.translate(ee.x,ee.y).scale(H[2]),be=ae.constrain()(je,re,pe);ae.transform(ie,be)},oe=WC().on("zoom",v?te:null).on("zoom.wheel",x?B:null);return J.call(oe),()=>{J.on("zoom",null)}}},[v,x,g,y]);const U=p?J=>{const B=kr(J);p(J,{x:B[0],y:B[1]})}:void 0,G=h?(J,B)=>{const te=j.getState().nodeInternals.get(B);h(J,te)}:void 0;return Y.createElement(Ro,{position:f,style:e,className:Qt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},Y.createElement("svg",{width:_,height:R,viewBox:`${P} ${M} ${I} ${O}`,role:"img","aria-labelledby":F,ref:k,onClick:U},w&&Y.createElement("title",{id:F},w),Y.createElement($D,{onClick:G,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:l}),Y.createElement("path",{className:"react-flow__minimap-mask",d:`M${P-A},${M-A}h${I+A*2}v${O+A*2}h${-I-A*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}DE.displayName="MiniMap";var UD=m.memo(DE);function dy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pd,Xb;function VD(){if(Xb)return pd;Xb=1;function e(){this.__data__=[],this.size=0}return pd=e,pd}var hd,Zb;function Pi(){if(Zb)return hd;Zb=1;function e(t,r){return t===r||t!==t&&r!==r}return hd=e,hd}var md,Jb;function tu(){if(Jb)return md;Jb=1;var e=Pi();function t(r,n){for(var s=r.length;s--;)if(e(r[s][0],n))return s;return-1}return md=t,md}var xd,e1;function GD(){if(e1)return xd;e1=1;var e=tu(),t=Array.prototype,r=t.splice;function n(s){var i=this.__data__,a=e(i,s);if(a<0)return!1;var l=i.length-1;return a==l?i.pop():r.call(i,a,1),--this.size,!0}return xd=n,xd}var gd,t1;function KD(){if(t1)return gd;t1=1;var e=tu();function t(r){var n=this.__data__,s=e(n,r);return s<0?void 0:n[s][1]}return gd=t,gd}var vd,r1;function YD(){if(r1)return vd;r1=1;var e=tu();function t(r){return e(this.__data__,r)>-1}return vd=t,vd}var yd,n1;function QD(){if(n1)return yd;n1=1;var e=tu();function t(r,n){var s=this.__data__,i=e(s,r);return i<0?(++this.size,s.push([r,n])):s[i][1]=n,this}return yd=t,yd}var bd,s1;function ru(){if(s1)return bd;s1=1;var e=VD(),t=GD(),r=KD(),n=YD(),s=QD();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=s,bd=i,bd}var wd,i1;function XD(){if(i1)return wd;i1=1;var e=ru();function t(){this.__data__=new e,this.size=0}return wd=t,wd}var _d,o1;function ZD(){if(o1)return _d;o1=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return _d=e,_d}var jd,a1;function JD(){if(a1)return jd;a1=1;function e(t){return this.__data__.get(t)}return jd=e,jd}var Sd,l1;function eL(){if(l1)return Sd;l1=1;function e(t){return this.__data__.has(t)}return Sd=e,Sd}var kd,c1;function LE(){if(c1)return kd;c1=1;var e=typeof Ra=="object"&&Ra&&Ra.Object===Object&&Ra;return kd=e,kd}var Nd,u1;function Pr(){if(u1)return Nd;u1=1;var e=LE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Nd=r,Nd}var Cd,d1;function Oi(){if(d1)return Cd;d1=1;var e=Pr(),t=e.Symbol;return Cd=t,Cd}var Ed,f1;function tL(){if(f1)return Ed;f1=1;var e=Oi(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,s=e?e.toStringTag:void 0;function i(a){var l=r.call(a,s),c=a[s];try{a[s]=void 0;var d=!0}catch{}var u=n.call(a);return d&&(l?a[s]=c:delete a[s]),u}return Ed=i,Ed}var Td,p1;function rL(){if(p1)return Td;p1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Td=r,Td}var Ad,h1;function Es(){if(h1)return Ad;h1=1;var e=Oi(),t=tL(),r=rL(),n="[object Null]",s="[object Undefined]",i=e?e.toStringTag:void 0;function a(l){return l==null?l===void 0?s:n:i&&i in Object(l)?t(l):r(l)}return Ad=a,Ad}var Rd,m1;function yr(){if(m1)return Rd;m1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Rd=e,Rd}var Id,x1;function _a(){if(x1)return Id;x1=1;var e=Es(),t=yr(),r="[object AsyncFunction]",n="[object Function]",s="[object GeneratorFunction]",i="[object Proxy]";function a(l){if(!t(l))return!1;var c=e(l);return c==n||c==s||c==r||c==i}return Id=a,Id}var Pd,g1;function nL(){if(g1)return Pd;g1=1;var e=Pr(),t=e["__core-js_shared__"];return Pd=t,Pd}var Od,v1;function sL(){if(v1)return Od;v1=1;var e=nL(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Od=r,Od}var Md,y1;function zE(){if(y1)return Md;y1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Md=r,Md}var Dd,b1;function iL(){if(b1)return Dd;b1=1;var e=_a(),t=sL(),r=yr(),n=zE(),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,a=Function.prototype,l=Object.prototype,c=a.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?u:i;return h.test(n(p))}return Dd=f,Dd}var Ld,w1;function oL(){if(w1)return Ld;w1=1;function e(t,r){return t==null?void 0:t[r]}return Ld=e,Ld}var zd,_1;function Ts(){if(_1)return zd;_1=1;var e=iL(),t=oL();function r(n,s){var i=t(n,s);return e(i)?i:void 0}return zd=r,zd}var Fd,j1;function fy(){if(j1)return Fd;j1=1;var e=Ts(),t=Pr(),r=e(t,"Map");return Fd=r,Fd}var $d,S1;function nu(){if(S1)return $d;S1=1;var e=Ts(),t=e(Object,"create");return $d=t,$d}var qd,k1;function aL(){if(k1)return qd;k1=1;var e=nu();function t(){this.__data__=e?e(null):{},this.size=0}return qd=t,qd}var Bd,N1;function lL(){if(N1)return Bd;N1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Bd=e,Bd}var Wd,C1;function cL(){if(C1)return Wd;C1=1;var e=nu(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function s(i){var a=this.__data__;if(e){var l=a[i];return l===t?void 0:l}return n.call(a,i)?a[i]:void 0}return Wd=s,Wd}var Hd,E1;function uL(){if(E1)return Hd;E1=1;var e=nu(),t=Object.prototype,r=t.hasOwnProperty;function n(s){var i=this.__data__;return e?i[s]!==void 0:r.call(i,s)}return Hd=n,Hd}var Ud,T1;function dL(){if(T1)return Ud;T1=1;var e=nu(),t="__lodash_hash_undefined__";function r(n,s){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=e&&s===void 0?t:s,this}return Ud=r,Ud}var Vd,A1;function fL(){if(A1)return Vd;A1=1;var e=aL(),t=lL(),r=cL(),n=uL(),s=dL();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=s,Vd=i,Vd}var Gd,R1;function pL(){if(R1)return Gd;R1=1;var e=fL(),t=ru(),r=fy();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Gd=n,Gd}var Kd,I1;function hL(){if(I1)return Kd;I1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Kd=e,Kd}var Yd,P1;function su(){if(P1)return Yd;P1=1;var e=hL();function t(r,n){var s=r.__data__;return e(n)?s[typeof n=="string"?"string":"hash"]:s.map}return Yd=t,Yd}var Qd,O1;function mL(){if(O1)return Qd;O1=1;var e=su();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Qd=t,Qd}var Xd,M1;function xL(){if(M1)return Xd;M1=1;var e=su();function t(r){return e(this,r).get(r)}return Xd=t,Xd}var Zd,D1;function gL(){if(D1)return Zd;D1=1;var e=su();function t(r){return e(this,r).has(r)}return Zd=t,Zd}var Jd,L1;function vL(){if(L1)return Jd;L1=1;var e=su();function t(r,n){var s=e(this,r),i=s.size;return s.set(r,n),this.size+=s.size==i?0:1,this}return Jd=t,Jd}var ef,z1;function py(){if(z1)return ef;z1=1;var e=pL(),t=mL(),r=xL(),n=gL(),s=vL();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=s,ef=i,ef}var tf,F1;function yL(){if(F1)return tf;F1=1;var e=ru(),t=fy(),r=py(),n=200;function s(i,a){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([i,a]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(i,a),this.size=l.size,this}return tf=s,tf}var rf,$1;function iu(){if($1)return rf;$1=1;var e=ru(),t=XD(),r=ZD(),n=JD(),s=eL(),i=yL();function a(l){var c=this.__data__=new e(l);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=r,a.prototype.get=n,a.prototype.has=s,a.prototype.set=i,rf=a,rf}var nf,q1;function hy(){if(q1)return nf;q1=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s&&r(t[n],n,t)!==!1;);return t}return nf=e,nf}var sf,B1;function FE(){if(B1)return sf;B1=1;var e=Ts(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return sf=t,sf}var of,W1;function ou(){if(W1)return of;W1=1;var e=FE();function t(r,n,s){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:s,writable:!0}):r[n]=s}return of=t,of}var af,H1;function au(){if(H1)return af;H1=1;var e=ou(),t=Pi(),r=Object.prototype,n=r.hasOwnProperty;function s(i,a,l){var c=i[a];(!(n.call(i,a)&&t(c,l))||l===void 0&&!(a in i))&&e(i,a,l)}return af=s,af}var lf,U1;function ja(){if(U1)return lf;U1=1;var e=au(),t=ou();function r(n,s,i,a){var l=!i;i||(i={});for(var c=-1,d=s.length;++c<d;){var u=s[c],f=a?a(i[u],n[u],u,i,n):void 0;f===void 0&&(f=n[u]),l?t(i,u,f):e(i,u,f)}return i}return lf=r,lf}var cf,V1;function bL(){if(V1)return cf;V1=1;function e(t,r){for(var n=-1,s=Array(t);++n<t;)s[n]=r(n);return s}return cf=e,cf}var uf,G1;function Kr(){if(G1)return uf;G1=1;function e(t){return t!=null&&typeof t=="object"}return uf=e,uf}var df,K1;function wL(){if(K1)return df;K1=1;var e=Es(),t=Kr(),r="[object Arguments]";function n(s){return t(s)&&e(s)==r}return df=n,df}var ff,Y1;function Sa(){if(Y1)return ff;Y1=1;var e=wL(),t=Kr(),r=Object.prototype,n=r.hasOwnProperty,s=r.propertyIsEnumerable,i=e(function(){return arguments}())?e:function(a){return t(a)&&n.call(a,"callee")&&!s.call(a,"callee")};return ff=i,ff}var pf,Q1;function at(){if(Q1)return pf;Q1=1;var e=Array.isArray;return pf=e,pf}var mo={exports:{}},hf,X1;function _L(){if(X1)return hf;X1=1;function e(){return!1}return hf=e,hf}mo.exports;var Z1;function Mi(){return Z1||(Z1=1,function(e,t){var r=Pr(),n=_L(),s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===s,l=a?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d}(mo,mo.exports)),mo.exports}var mf,J1;function lu(){if(J1)return mf;J1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,s){var i=typeof n;return s=s??e,!!s&&(i=="number"||i!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<s}return mf=r,mf}var xf,ew;function my(){if(ew)return xf;ew=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return xf=t,xf}var gf,tw;function jL(){if(tw)return gf;tw=1;var e=Es(),t=my(),r=Kr(),n="[object Arguments]",s="[object Array]",i="[object Boolean]",a="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",v="[object String]",x="[object WeakMap]",w="[object ArrayBuffer]",g="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",j="[object Int8Array]",k="[object Int16Array]",N="[object Int32Array]",S="[object Uint8Array]",C="[object Uint8ClampedArray]",_="[object Uint16Array]",R="[object Uint32Array]",T={};T[y]=T[b]=T[j]=T[k]=T[N]=T[S]=T[C]=T[_]=T[R]=!0,T[n]=T[s]=T[w]=T[i]=T[g]=T[a]=T[l]=T[c]=T[d]=T[u]=T[f]=T[p]=T[h]=T[v]=T[x]=!1;function D($){return r($)&&t($.length)&&!!T[e($)]}return gf=D,gf}var vf,rw;function cu(){if(rw)return vf;rw=1;function e(t){return function(r){return t(r)}}return vf=e,vf}var xo={exports:{}};xo.exports;var nw;function xy(){return nw||(nw=1,function(e,t){var r=LE(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===n,a=i&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=l}(xo,xo.exports)),xo.exports}var yf,sw;function ka(){if(sw)return yf;sw=1;var e=jL(),t=cu(),r=xy(),n=r&&r.isTypedArray,s=n?t(n):e;return yf=s,yf}var bf,iw;function $E(){if(iw)return bf;iw=1;var e=bL(),t=Sa(),r=at(),n=Mi(),s=lu(),i=ka(),a=Object.prototype,l=a.hasOwnProperty;function c(d,u){var f=r(d),p=!f&&t(d),h=!f&&!p&&n(d),v=!f&&!p&&!h&&i(d),x=f||p||h||v,w=x?e(d.length,String):[],g=w.length;for(var y in d)(u||l.call(d,y))&&!(x&&(y=="length"||h&&(y=="offset"||y=="parent")||v&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||s(y,g)))&&w.push(y);return w}return bf=c,bf}var wf,ow;function uu(){if(ow)return wf;ow=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,s=typeof n=="function"&&n.prototype||e;return r===s}return wf=t,wf}var _f,aw;function qE(){if(aw)return _f;aw=1;function e(t,r){return function(n){return t(r(n))}}return _f=e,_f}var jf,lw;function SL(){if(lw)return jf;lw=1;var e=qE(),t=e(Object.keys,Object);return jf=t,jf}var Sf,cw;function gy(){if(cw)return Sf;cw=1;var e=uu(),t=SL(),r=Object.prototype,n=r.hasOwnProperty;function s(i){if(!e(i))return t(i);var a=[];for(var l in Object(i))n.call(i,l)&&l!="constructor"&&a.push(l);return a}return Sf=s,Sf}var kf,uw;function vn(){if(uw)return kf;uw=1;var e=_a(),t=my();function r(n){return n!=null&&t(n.length)&&!e(n)}return kf=r,kf}var Nf,dw;function es(){if(dw)return Nf;dw=1;var e=$E(),t=gy(),r=vn();function n(s){return r(s)?e(s):t(s)}return Nf=n,Nf}var Cf,fw;function kL(){if(fw)return Cf;fw=1;var e=ja(),t=es();function r(n,s){return n&&e(s,t(s),n)}return Cf=r,Cf}var Ef,pw;function NL(){if(pw)return Ef;pw=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return Ef=e,Ef}var Tf,hw;function CL(){if(hw)return Tf;hw=1;var e=yr(),t=uu(),r=NL(),n=Object.prototype,s=n.hasOwnProperty;function i(a){if(!e(a))return r(a);var l=t(a),c=[];for(var d in a)d=="constructor"&&(l||!s.call(a,d))||c.push(d);return c}return Tf=i,Tf}var Af,mw;function As(){if(mw)return Af;mw=1;var e=$E(),t=CL(),r=vn();function n(s){return r(s)?e(s,!0):t(s)}return Af=n,Af}var Rf,xw;function EL(){if(xw)return Rf;xw=1;var e=ja(),t=As();function r(n,s){return n&&e(s,t(s),n)}return Rf=r,Rf}var go={exports:{}};go.exports;var gw;function BE(){return gw||(gw=1,function(e,t){var r=Pr(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===n,a=i?r.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(go,go.exports)),go.exports}var If,vw;function WE(){if(vw)return If;vw=1;function e(t,r){var n=-1,s=t.length;for(r||(r=Array(s));++n<s;)r[n]=t[n];return r}return If=e,If}var Pf,yw;function HE(){if(yw)return Pf;yw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,i=0,a=[];++n<s;){var l=t[n];r(l,n,t)&&(a[i++]=l)}return a}return Pf=e,Pf}var Of,bw;function UE(){if(bw)return Of;bw=1;function e(){return[]}return Of=e,Of}var Mf,ww;function vy(){if(ww)return Mf;ww=1;var e=HE(),t=UE(),r=Object.prototype,n=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,i=s?function(a){return a==null?[]:(a=Object(a),e(s(a),function(l){return n.call(a,l)}))}:t;return Mf=i,Mf}var Df,_w;function TL(){if(_w)return Df;_w=1;var e=ja(),t=vy();function r(n,s){return e(n,t(n),s)}return Df=r,Df}var Lf,jw;function yy(){if(jw)return Lf;jw=1;function e(t,r){for(var n=-1,s=r.length,i=t.length;++n<s;)t[i+n]=r[n];return t}return Lf=e,Lf}var zf,Sw;function du(){if(Sw)return zf;Sw=1;var e=qE(),t=e(Object.getPrototypeOf,Object);return zf=t,zf}var Ff,kw;function VE(){if(kw)return Ff;kw=1;var e=yy(),t=du(),r=vy(),n=UE(),s=Object.getOwnPropertySymbols,i=s?function(a){for(var l=[];a;)e(l,r(a)),a=t(a);return l}:n;return Ff=i,Ff}var $f,Nw;function AL(){if(Nw)return $f;Nw=1;var e=ja(),t=VE();function r(n,s){return e(n,t(n),s)}return $f=r,$f}var qf,Cw;function GE(){if(Cw)return qf;Cw=1;var e=yy(),t=at();function r(n,s,i){var a=s(n);return t(n)?a:e(a,i(n))}return qf=r,qf}var Bf,Ew;function KE(){if(Ew)return Bf;Ew=1;var e=GE(),t=vy(),r=es();function n(s){return e(s,r,t)}return Bf=n,Bf}var Wf,Tw;function RL(){if(Tw)return Wf;Tw=1;var e=GE(),t=VE(),r=As();function n(s){return e(s,r,t)}return Wf=n,Wf}var Hf,Aw;function IL(){if(Aw)return Hf;Aw=1;var e=Ts(),t=Pr(),r=e(t,"DataView");return Hf=r,Hf}var Uf,Rw;function PL(){if(Rw)return Uf;Rw=1;var e=Ts(),t=Pr(),r=e(t,"Promise");return Uf=r,Uf}var Vf,Iw;function YE(){if(Iw)return Vf;Iw=1;var e=Ts(),t=Pr(),r=e(t,"Set");return Vf=r,Vf}var Gf,Pw;function OL(){if(Pw)return Gf;Pw=1;var e=Ts(),t=Pr(),r=e(t,"WeakMap");return Gf=r,Gf}var Kf,Ow;function Di(){if(Ow)return Kf;Ow=1;var e=IL(),t=fy(),r=PL(),n=YE(),s=OL(),i=Es(),a=zE(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=a(e),v=a(t),x=a(r),w=a(n),g=a(s),y=i;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||r&&y(r.resolve())!=d||n&&y(new n)!=u||s&&y(new s)!=f)&&(y=function(b){var j=i(b),k=j==c?b.constructor:void 0,N=k?a(k):"";if(N)switch(N){case h:return p;case v:return l;case x:return d;case w:return u;case g:return f}return j}),Kf=y,Kf}var Yf,Mw;function ML(){if(Mw)return Yf;Mw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var s=n.length,i=new n.constructor(s);return s&&typeof n[0]=="string"&&t.call(n,"index")&&(i.index=n.index,i.input=n.input),i}return Yf=r,Yf}var Qf,Dw;function QE(){if(Dw)return Qf;Dw=1;var e=Pr(),t=e.Uint8Array;return Qf=t,Qf}var Xf,Lw;function by(){if(Lw)return Xf;Lw=1;var e=QE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return Xf=t,Xf}var Zf,zw;function DL(){if(zw)return Zf;zw=1;var e=by();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.byteLength)}return Zf=t,Zf}var Jf,Fw;function LL(){if(Fw)return Jf;Fw=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return Jf=t,Jf}var ep,$w;function zL(){if($w)return ep;$w=1;var e=Oi(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(s){return r?Object(r.call(s)):{}}return ep=n,ep}var tp,qw;function XE(){if(qw)return tp;qw=1;var e=by();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.length)}return tp=t,tp}var rp,Bw;function FL(){if(Bw)return rp;Bw=1;var e=by(),t=DL(),r=LL(),n=zL(),s=XE(),i="[object Boolean]",a="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",v="[object DataView]",x="[object Float32Array]",w="[object Float64Array]",g="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",j="[object Uint8Array]",k="[object Uint8ClampedArray]",N="[object Uint16Array]",S="[object Uint32Array]";function C(_,R,T){var D=_.constructor;switch(R){case h:return e(_);case i:case a:return new D(+_);case v:return t(_,T);case x:case w:case g:case y:case b:case j:case k:case N:case S:return s(_,T);case l:return new D;case c:case f:return new D(_);case d:return r(_);case u:return new D;case p:return n(_)}}return rp=C,rp}var np,Ww;function ZE(){if(Ww)return np;Ww=1;var e=yr(),t=Object.create,r=function(){function n(){}return function(s){if(!e(s))return{};if(t)return t(s);n.prototype=s;var i=new n;return n.prototype=void 0,i}}();return np=r,np}var sp,Hw;function JE(){if(Hw)return sp;Hw=1;var e=ZE(),t=du(),r=uu();function n(s){return typeof s.constructor=="function"&&!r(s)?e(t(s)):{}}return sp=n,sp}var ip,Uw;function $L(){if(Uw)return ip;Uw=1;var e=Di(),t=Kr(),r="[object Map]";function n(s){return t(s)&&e(s)==r}return ip=n,ip}var op,Vw;function qL(){if(Vw)return op;Vw=1;var e=$L(),t=cu(),r=xy(),n=r&&r.isMap,s=n?t(n):e;return op=s,op}var ap,Gw;function BL(){if(Gw)return ap;Gw=1;var e=Di(),t=Kr(),r="[object Set]";function n(s){return t(s)&&e(s)==r}return ap=n,ap}var lp,Kw;function WL(){if(Kw)return lp;Kw=1;var e=BL(),t=cu(),r=xy(),n=r&&r.isSet,s=n?t(n):e;return lp=s,lp}var cp,Yw;function e4(){if(Yw)return cp;Yw=1;var e=iu(),t=hy(),r=au(),n=kL(),s=EL(),i=BE(),a=WE(),l=TL(),c=AL(),d=KE(),u=RL(),f=Di(),p=ML(),h=FL(),v=JE(),x=at(),w=Mi(),g=qL(),y=yr(),b=WL(),j=es(),k=As(),N=1,S=2,C=4,_="[object Arguments]",R="[object Array]",T="[object Boolean]",D="[object Date]",$="[object Error]",E="[object Function]",L="[object GeneratorFunction]",A="[object Map]",P="[object Number]",M="[object Object]",I="[object RegExp]",O="[object Set]",F="[object String]",q="[object Symbol]",U="[object WeakMap]",G="[object ArrayBuffer]",J="[object DataView]",B="[object Float32Array]",te="[object Float64Array]",oe="[object Int8Array]",Q="[object Int16Array]",H="[object Int32Array]",ie="[object Uint8Array]",ae="[object Uint8ClampedArray]",pe="[object Uint16Array]",me="[object Uint32Array]",le={};le[_]=le[R]=le[G]=le[J]=le[T]=le[D]=le[B]=le[te]=le[oe]=le[Q]=le[H]=le[A]=le[P]=le[M]=le[I]=le[O]=le[F]=le[q]=le[ie]=le[ae]=le[pe]=le[me]=!0,le[$]=le[E]=le[U]=!1;function V(ee,re,je,be,Re,Ie){var ne,we=re&N,Je=re&S,pt=re&C;if(je&&(ne=Re?je(ee,be,Re,Ie):je(ee)),ne!==void 0)return ne;if(!y(ee))return ee;var qe=x(ee);if(qe){if(ne=p(ee),!we)return a(ee,ne)}else{var Pe=f(ee),Be=Pe==E||Pe==L;if(w(ee))return i(ee,we);if(Pe==M||Pe==_||Be&&!Re){if(ne=Je||Be?{}:v(ee),!we)return Je?c(ee,s(ne,ee)):l(ee,n(ne,ee))}else{if(!le[Pe])return Re?ee:{};ne=h(ee,Pe,we)}}Ie||(Ie=new e);var et=Ie.get(ee);if(et)return et;Ie.set(ee,ne),b(ee)?ee.forEach(function(Ne){ne.add(V(Ne,re,je,Ne,ee,Ie))}):g(ee)&&ee.forEach(function(Ne,xe){ne.set(xe,V(Ne,re,je,xe,ee,Ie))});var Te=pt?Je?u:d:Je?k:j,X=qe?void 0:Te(ee);return t(X||ee,function(Ne,xe){X&&(xe=Ne,Ne=ee[xe]),r(ne,xe,V(Ne,re,je,xe,ee,Ie))}),ne}return cp=V,cp}var up,Qw;function HL(){if(Qw)return up;Qw=1;var e=e4(),t=4;function r(n){return e(n,t)}return up=r,up}var dp,Xw;function wy(){if(Xw)return dp;Xw=1;function e(t){return function(){return t}}return dp=e,dp}var fp,Zw;function UL(){if(Zw)return fp;Zw=1;function e(t){return function(r,n,s){for(var i=-1,a=Object(r),l=s(r),c=l.length;c--;){var d=l[t?c:++i];if(n(a[d],d,a)===!1)break}return r}}return fp=e,fp}var pp,Jw;function _y(){if(Jw)return pp;Jw=1;var e=UL(),t=e();return pp=t,pp}var hp,e_;function jy(){if(e_)return hp;e_=1;var e=_y(),t=es();function r(n,s){return n&&e(n,s,t)}return hp=r,hp}var mp,t_;function VL(){if(t_)return mp;t_=1;var e=vn();function t(r,n){return function(s,i){if(s==null)return s;if(!e(s))return r(s,i);for(var a=s.length,l=n?a:-1,c=Object(s);(n?l--:++l<a)&&i(c[l],l,c)!==!1;);return s}}return mp=t,mp}var xp,r_;function fu(){if(r_)return xp;r_=1;var e=jy(),t=VL(),r=t(e);return xp=r,xp}var gp,n_;function Rs(){if(n_)return gp;n_=1;function e(t){return t}return gp=e,gp}var vp,s_;function t4(){if(s_)return vp;s_=1;var e=Rs();function t(r){return typeof r=="function"?r:e}return vp=t,vp}var yp,i_;function r4(){if(i_)return yp;i_=1;var e=hy(),t=fu(),r=t4(),n=at();function s(i,a){var l=n(i)?e:t;return l(i,r(a))}return yp=s,yp}var bp,o_;function n4(){return o_||(o_=1,bp=r4()),bp}var wp,a_;function GL(){if(a_)return wp;a_=1;var e=fu();function t(r,n){var s=[];return e(r,function(i,a,l){n(i,a,l)&&s.push(i)}),s}return wp=t,wp}var _p,l_;function KL(){if(l_)return _p;l_=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return _p=t,_p}var jp,c_;function YL(){if(c_)return jp;c_=1;function e(t){return this.__data__.has(t)}return jp=e,jp}var Sp,u_;function s4(){if(u_)return Sp;u_=1;var e=py(),t=KL(),r=YL();function n(s){var i=-1,a=s==null?0:s.length;for(this.__data__=new e;++i<a;)this.add(s[i])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,Sp=n,Sp}var kp,d_;function QL(){if(d_)return kp;d_=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s;)if(r(t[n],n,t))return!0;return!1}return kp=e,kp}var Np,f_;function i4(){if(f_)return Np;f_=1;function e(t,r){return t.has(r)}return Np=e,Np}var Cp,p_;function o4(){if(p_)return Cp;p_=1;var e=s4(),t=QL(),r=i4(),n=1,s=2;function i(a,l,c,d,u,f){var p=c&n,h=a.length,v=l.length;if(h!=v&&!(p&&v>h))return!1;var x=f.get(a),w=f.get(l);if(x&&w)return x==l&&w==a;var g=-1,y=!0,b=c&s?new e:void 0;for(f.set(a,l),f.set(l,a);++g<h;){var j=a[g],k=l[g];if(d)var N=p?d(k,j,g,l,a,f):d(j,k,g,a,l,f);if(N!==void 0){if(N)continue;y=!1;break}if(b){if(!t(l,function(S,C){if(!r(b,C)&&(j===S||u(j,S,c,d,f)))return b.push(C)})){y=!1;break}}else if(!(j===k||u(j,k,c,d,f))){y=!1;break}}return f.delete(a),f.delete(l),y}return Cp=i,Cp}var Ep,h_;function XL(){if(h_)return Ep;h_=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s,i){n[++r]=[i,s]}),n}return Ep=e,Ep}var Tp,m_;function Sy(){if(m_)return Tp;m_=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s){n[++r]=s}),n}return Tp=e,Tp}var Ap,x_;function ZL(){if(x_)return Ap;x_=1;var e=Oi(),t=QE(),r=Pi(),n=o4(),s=XL(),i=Sy(),a=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",v="[object Set]",x="[object String]",w="[object Symbol]",g="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,j=b?b.valueOf:void 0;function k(N,S,C,_,R,T,D){switch(C){case y:if(N.byteLength!=S.byteLength||N.byteOffset!=S.byteOffset)return!1;N=N.buffer,S=S.buffer;case g:return!(N.byteLength!=S.byteLength||!T(new t(N),new t(S)));case c:case d:case p:return r(+N,+S);case u:return N.name==S.name&&N.message==S.message;case h:case x:return N==S+"";case f:var $=s;case v:var E=_&a;if($||($=i),N.size!=S.size&&!E)return!1;var L=D.get(N);if(L)return L==S;_|=l,D.set(N,S);var A=n($(N),$(S),_,R,T,D);return D.delete(N),A;case w:if(j)return j.call(N)==j.call(S)}return!1}return Ap=k,Ap}var Rp,g_;function JL(){if(g_)return Rp;g_=1;var e=KE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function s(i,a,l,c,d,u){var f=l&t,p=e(i),h=p.length,v=e(a),x=v.length;if(h!=x&&!f)return!1;for(var w=h;w--;){var g=p[w];if(!(f?g in a:n.call(a,g)))return!1}var y=u.get(i),b=u.get(a);if(y&&b)return y==a&&b==i;var j=!0;u.set(i,a),u.set(a,i);for(var k=f;++w<h;){g=p[w];var N=i[g],S=a[g];if(c)var C=f?c(S,N,g,a,i,u):c(N,S,g,i,a,u);if(!(C===void 0?N===S||d(N,S,l,c,u):C)){j=!1;break}k||(k=g=="constructor")}if(j&&!k){var _=i.constructor,R=a.constructor;_!=R&&"constructor"in i&&"constructor"in a&&!(typeof _=="function"&&_ instanceof _&&typeof R=="function"&&R instanceof R)&&(j=!1)}return u.delete(i),u.delete(a),j}return Rp=s,Rp}var Ip,v_;function e8(){if(v_)return Ip;v_=1;var e=iu(),t=o4(),r=ZL(),n=JL(),s=Di(),i=at(),a=Mi(),l=ka(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function v(x,w,g,y,b,j){var k=i(x),N=i(w),S=k?u:s(x),C=N?u:s(w);S=S==d?f:S,C=C==d?f:C;var _=S==f,R=C==f,T=S==C;if(T&&a(x)){if(!a(w))return!1;k=!0,_=!1}if(T&&!_)return j||(j=new e),k||l(x)?t(x,w,g,y,b,j):r(x,w,S,g,y,b,j);if(!(g&c)){var D=_&&h.call(x,"__wrapped__"),$=R&&h.call(w,"__wrapped__");if(D||$){var E=D?x.value():x,L=$?w.value():w;return j||(j=new e),b(E,L,g,y,j)}}return T?(j||(j=new e),n(x,w,g,y,b,j)):!1}return Ip=v,Ip}var Pp,y_;function a4(){if(y_)return Pp;y_=1;var e=e8(),t=Kr();function r(n,s,i,a,l){return n===s?!0:n==null||s==null||!t(n)&&!t(s)?n!==n&&s!==s:e(n,s,i,a,r,l)}return Pp=r,Pp}var Op,b_;function t8(){if(b_)return Op;b_=1;var e=iu(),t=a4(),r=1,n=2;function s(i,a,l,c){var d=l.length,u=d,f=!c;if(i==null)return!u;for(i=Object(i);d--;){var p=l[d];if(f&&p[2]?p[1]!==i[p[0]]:!(p[0]in i))return!1}for(;++d<u;){p=l[d];var h=p[0],v=i[h],x=p[1];if(f&&p[2]){if(v===void 0&&!(h in i))return!1}else{var w=new e;if(c)var g=c(v,x,h,i,a,w);if(!(g===void 0?t(x,v,r|n,c,w):g))return!1}}return!0}return Op=s,Op}var Mp,w_;function l4(){if(w_)return Mp;w_=1;var e=yr();function t(r){return r===r&&!e(r)}return Mp=t,Mp}var Dp,__;function r8(){if(__)return Dp;__=1;var e=l4(),t=es();function r(n){for(var s=t(n),i=s.length;i--;){var a=s[i],l=n[a];s[i]=[a,l,e(l)]}return s}return Dp=r,Dp}var Lp,j_;function c4(){if(j_)return Lp;j_=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Lp=e,Lp}var zp,S_;function n8(){if(S_)return zp;S_=1;var e=t8(),t=r8(),r=c4();function n(s){var i=t(s);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(a){return a===s||e(a,s,i)}}return zp=n,zp}var Fp,k_;function Li(){if(k_)return Fp;k_=1;var e=Es(),t=Kr(),r="[object Symbol]";function n(s){return typeof s=="symbol"||t(s)&&e(s)==r}return Fp=n,Fp}var $p,N_;function ky(){if(N_)return $p;N_=1;var e=at(),t=Li(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(i,a){if(e(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||t(i)?!0:n.test(i)||!r.test(i)||a!=null&&i in Object(a)}return $p=s,$p}var qp,C_;function s8(){if(C_)return qp;C_=1;var e=py(),t="Expected a function";function r(n,s){if(typeof n!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var i=function(){var a=arguments,l=s?s.apply(this,a):a[0],c=i.cache;if(c.has(l))return c.get(l);var d=n.apply(this,a);return i.cache=c.set(l,d)||c,d};return i.cache=new(r.Cache||e),i}return r.Cache=e,qp=r,qp}var Bp,E_;function i8(){if(E_)return Bp;E_=1;var e=s8(),t=500;function r(n){var s=e(n,function(a){return i.size===t&&i.clear(),a}),i=s.cache;return s}return Bp=r,Bp}var Wp,T_;function o8(){if(T_)return Wp;T_=1;var e=i8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(s){var i=[];return s.charCodeAt(0)===46&&i.push(""),s.replace(t,function(a,l,c,d){i.push(c?d.replace(r,"$1"):l||a)}),i});return Wp=n,Wp}var Hp,A_;function pu(){if(A_)return Hp;A_=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,i=Array(s);++n<s;)i[n]=r(t[n],n,t);return i}return Hp=e,Hp}var Up,R_;function a8(){if(R_)return Up;R_=1;var e=Oi(),t=pu(),r=at(),n=Li(),s=e?e.prototype:void 0,i=s?s.toString:void 0;function a(l){if(typeof l=="string")return l;if(r(l))return t(l,a)+"";if(n(l))return i?i.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Up=a,Up}var Vp,I_;function u4(){if(I_)return Vp;I_=1;var e=a8();function t(r){return r==null?"":e(r)}return Vp=t,Vp}var Gp,P_;function hu(){if(P_)return Gp;P_=1;var e=at(),t=ky(),r=o8(),n=u4();function s(i,a){return e(i)?i:t(i,a)?[i]:r(n(i))}return Gp=s,Gp}var Kp,O_;function Na(){if(O_)return Kp;O_=1;var e=Li();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Kp=t,Kp}var Yp,M_;function mu(){if(M_)return Yp;M_=1;var e=hu(),t=Na();function r(n,s){s=e(s,n);for(var i=0,a=s.length;n!=null&&i<a;)n=n[t(s[i++])];return i&&i==a?n:void 0}return Yp=r,Yp}var Qp,D_;function l8(){if(D_)return Qp;D_=1;var e=mu();function t(r,n,s){var i=r==null?void 0:e(r,n);return i===void 0?s:i}return Qp=t,Qp}var Xp,L_;function c8(){if(L_)return Xp;L_=1;function e(t,r){return t!=null&&r in Object(t)}return Xp=e,Xp}var Zp,z_;function d4(){if(z_)return Zp;z_=1;var e=hu(),t=Sa(),r=at(),n=lu(),s=my(),i=Na();function a(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=i(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&s(f)&&n(h,f)&&(r(l)||t(l)))}return Zp=a,Zp}var Jp,F_;function f4(){if(F_)return Jp;F_=1;var e=c8(),t=d4();function r(n,s){return n!=null&&t(n,s,e)}return Jp=r,Jp}var eh,$_;function u8(){if($_)return eh;$_=1;var e=a4(),t=l8(),r=f4(),n=ky(),s=l4(),i=c4(),a=Na(),l=1,c=2;function d(u,f){return n(u)&&s(f)?i(a(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?r(p,u):e(f,h,l|c)}}return eh=d,eh}var th,q_;function p4(){if(q_)return th;q_=1;function e(t){return function(r){return r==null?void 0:r[t]}}return th=e,th}var rh,B_;function d8(){if(B_)return rh;B_=1;var e=mu();function t(r){return function(n){return e(n,r)}}return rh=t,rh}var nh,W_;function f8(){if(W_)return nh;W_=1;var e=p4(),t=d8(),r=ky(),n=Na();function s(i){return r(i)?e(n(i)):t(i)}return nh=s,nh}var sh,H_;function yn(){if(H_)return sh;H_=1;var e=n8(),t=u8(),r=Rs(),n=at(),s=f8();function i(a){return typeof a=="function"?a:a==null?r:typeof a=="object"?n(a)?t(a[0],a[1]):e(a):s(a)}return sh=i,sh}var ih,U_;function h4(){if(U_)return ih;U_=1;var e=HE(),t=GL(),r=yn(),n=at();function s(i,a){var l=n(i)?e:t;return l(i,r(a,3))}return ih=s,ih}var oh,V_;function p8(){if(V_)return oh;V_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,s){return n!=null&&t.call(n,s)}return oh=r,oh}var ah,G_;function m4(){if(G_)return ah;G_=1;var e=p8(),t=d4();function r(n,s){return n!=null&&t(n,s,e)}return ah=r,ah}var lh,K_;function h8(){if(K_)return lh;K_=1;var e=gy(),t=Di(),r=Sa(),n=at(),s=vn(),i=Mi(),a=uu(),l=ka(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(s(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||i(h)||l(h)||r(h)))return!h.length;var v=t(h);if(v==c||v==d)return!h.size;if(a(h))return!e(h).length;for(var x in h)if(f.call(h,x))return!1;return!0}return lh=p,lh}var ch,Y_;function x4(){if(Y_)return ch;Y_=1;function e(t){return t===void 0}return ch=e,ch}var uh,Q_;function g4(){if(Q_)return uh;Q_=1;var e=fu(),t=vn();function r(n,s){var i=-1,a=t(n)?Array(n.length):[];return e(n,function(l,c,d){a[++i]=s(l,c,d)}),a}return uh=r,uh}var dh,X_;function v4(){if(X_)return dh;X_=1;var e=pu(),t=yn(),r=g4(),n=at();function s(i,a){var l=n(i)?e:r;return l(i,t(a,3))}return dh=s,dh}var fh,Z_;function m8(){if(Z_)return fh;Z_=1;function e(t,r,n,s){var i=-1,a=t==null?0:t.length;for(s&&a&&(n=t[++i]);++i<a;)n=r(n,t[i],i,t);return n}return fh=e,fh}var ph,J_;function x8(){if(J_)return ph;J_=1;function e(t,r,n,s,i){return i(t,function(a,l,c){n=s?(s=!1,a):r(n,a,l,c)}),n}return ph=e,ph}var hh,ej;function y4(){if(ej)return hh;ej=1;var e=m8(),t=fu(),r=yn(),n=x8(),s=at();function i(a,l,c){var d=s(a)?e:n,u=arguments.length<3;return d(a,r(l,4),c,u,t)}return hh=i,hh}var mh,tj;function g8(){if(tj)return mh;tj=1;var e=Es(),t=at(),r=Kr(),n="[object String]";function s(i){return typeof i=="string"||!t(i)&&r(i)&&e(i)==n}return mh=s,mh}var xh,rj;function v8(){if(rj)return xh;rj=1;var e=p4(),t=e("length");return xh=t,xh}var gh,nj;function y8(){if(nj)return gh;nj=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,i="\\ufe0e\\ufe0f",a="\\u200d",l=RegExp("["+a+e+s+i+"]");function c(d){return l.test(d)}return gh=c,gh}var vh,sj;function b8(){if(sj)return vh;sj=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,i="\\ufe0e\\ufe0f",a="["+e+"]",l="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",v=d+"?",x="["+i+"]?",w="(?:"+h+"(?:"+[u,f,p].join("|")+")"+x+v+")*",g=x+v+w,y="(?:"+[u+l+"?",l,f,p,a].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+g,"g");function j(k){for(var N=b.lastIndex=0;b.test(k);)++N;return N}return vh=j,vh}var yh,ij;function w8(){if(ij)return yh;ij=1;var e=v8(),t=y8(),r=b8();function n(s){return t(s)?r(s):e(s)}return yh=n,yh}var bh,oj;function _8(){if(oj)return bh;oj=1;var e=gy(),t=Di(),r=vn(),n=g8(),s=w8(),i="[object Map]",a="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?s(c):c.length;var d=t(c);return d==i||d==a?c.size:e(c).length}return bh=l,bh}var wh,aj;function j8(){if(aj)return wh;aj=1;var e=hy(),t=ZE(),r=jy(),n=yn(),s=du(),i=at(),a=Mi(),l=_a(),c=yr(),d=ka();function u(f,p,h){var v=i(f),x=v||a(f)||d(f);if(p=n(p,4),h==null){var w=f&&f.constructor;x?h=v?new w:[]:c(f)?h=l(w)?t(s(f)):{}:h={}}return(x?e:r)(f,function(g,y,b){return p(h,g,y,b)}),h}return wh=u,wh}var _h,lj;function S8(){if(lj)return _h;lj=1;var e=Oi(),t=Sa(),r=at(),n=e?e.isConcatSpreadable:void 0;function s(i){return r(i)||t(i)||!!(n&&i&&i[n])}return _h=s,_h}var jh,cj;function Ny(){if(cj)return jh;cj=1;var e=yy(),t=S8();function r(n,s,i,a,l){var c=-1,d=n.length;for(i||(i=t),l||(l=[]);++c<d;){var u=n[c];s>0&&i(u)?s>1?r(u,s-1,i,a,l):e(l,u):a||(l[l.length]=u)}return l}return jh=r,jh}var Sh,uj;function k8(){if(uj)return Sh;uj=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Sh=e,Sh}var kh,dj;function b4(){if(dj)return kh;dj=1;var e=k8(),t=Math.max;function r(n,s,i){return s=t(s===void 0?n.length-1:s,0),function(){for(var a=arguments,l=-1,c=t(a.length-s,0),d=Array(c);++l<c;)d[l]=a[s+l];l=-1;for(var u=Array(s+1);++l<s;)u[l]=a[l];return u[s]=i(d),e(n,this,u)}}return kh=r,kh}var Nh,fj;function N8(){if(fj)return Nh;fj=1;var e=wy(),t=FE(),r=Rs(),n=t?function(s,i){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:r;return Nh=n,Nh}var Ch,pj;function C8(){if(pj)return Ch;pj=1;var e=800,t=16,r=Date.now;function n(s){var i=0,a=0;return function(){var l=r(),c=t-(l-a);if(a=l,c>0){if(++i>=e)return arguments[0]}else i=0;return s.apply(void 0,arguments)}}return Ch=n,Ch}var Eh,hj;function w4(){if(hj)return Eh;hj=1;var e=N8(),t=C8(),r=t(e);return Eh=r,Eh}var Th,mj;function xu(){if(mj)return Th;mj=1;var e=Rs(),t=b4(),r=w4();function n(s,i){return r(t(s,i,e),s+"")}return Th=n,Th}var Ah,xj;function _4(){if(xj)return Ah;xj=1;function e(t,r,n,s){for(var i=t.length,a=n+(s?1:-1);s?a--:++a<i;)if(r(t[a],a,t))return a;return-1}return Ah=e,Ah}var Rh,gj;function E8(){if(gj)return Rh;gj=1;function e(t){return t!==t}return Rh=e,Rh}var Ih,vj;function T8(){if(vj)return Ih;vj=1;function e(t,r,n){for(var s=n-1,i=t.length;++s<i;)if(t[s]===r)return s;return-1}return Ih=e,Ih}var Ph,yj;function A8(){if(yj)return Ph;yj=1;var e=_4(),t=E8(),r=T8();function n(s,i,a){return i===i?r(s,i,a):e(s,t,a)}return Ph=n,Ph}var Oh,bj;function R8(){if(bj)return Oh;bj=1;var e=A8();function t(r,n){var s=r==null?0:r.length;return!!s&&e(r,n,0)>-1}return Oh=t,Oh}var Mh,wj;function I8(){if(wj)return Mh;wj=1;function e(t,r,n){for(var s=-1,i=t==null?0:t.length;++s<i;)if(n(r,t[s]))return!0;return!1}return Mh=e,Mh}var Dh,_j;function P8(){if(_j)return Dh;_j=1;function e(){}return Dh=e,Dh}var Lh,jj;function O8(){if(jj)return Lh;jj=1;var e=YE(),t=P8(),r=Sy(),n=1/0,s=e&&1/r(new e([,-0]))[1]==n?function(i){return new e(i)}:t;return Lh=s,Lh}var zh,Sj;function M8(){if(Sj)return zh;Sj=1;var e=s4(),t=R8(),r=I8(),n=i4(),s=O8(),i=Sy(),a=200;function l(c,d,u){var f=-1,p=t,h=c.length,v=!0,x=[],w=x;if(u)v=!1,p=r;else if(h>=a){var g=d?null:s(c);if(g)return i(g);v=!1,p=n,w=new e}else w=d?[]:x;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,v&&b===b){for(var j=w.length;j--;)if(w[j]===b)continue e;d&&w.push(b),x.push(y)}else p(w,b,u)||(w!==x&&w.push(b),x.push(y))}return x}return zh=l,zh}var Fh,kj;function j4(){if(kj)return Fh;kj=1;var e=vn(),t=Kr();function r(n){return t(n)&&e(n)}return Fh=r,Fh}var $h,Nj;function D8(){if(Nj)return $h;Nj=1;var e=Ny(),t=xu(),r=M8(),n=j4(),s=t(function(i){return r(e(i,1,n,!0))});return $h=s,$h}var qh,Cj;function L8(){if(Cj)return qh;Cj=1;var e=pu();function t(r,n){return e(n,function(s){return r[s]})}return qh=t,qh}var Bh,Ej;function S4(){if(Ej)return Bh;Ej=1;var e=L8(),t=es();function r(n){return n==null?[]:e(n,t(n))}return Bh=r,Bh}var Wh,Tj;function br(){if(Tj)return Wh;Tj=1;var e;if(typeof dy=="function")try{e={clone:HL(),constant:wy(),each:n4(),filter:h4(),has:m4(),isArray:at(),isEmpty:h8(),isFunction:_a(),isUndefined:x4(),keys:es(),map:v4(),reduce:y4(),size:_8(),transform:j8(),union:D8(),values:S4()}}catch{}return e||(e=window._),Wh=e,Wh}var Hh,Aj;function Cy(){if(Aj)return Hh;Aj=1;var e=br();Hh=s;var t="\0",r="\0",n="";function s(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(u){return this._label=u,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},s.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},s.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(v){p.length>1?h.setNode(v,f):h.setNode(v)}),this},s.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=r,this._children[u]={},this._children[r][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},s.prototype.node=function(u){return this._nodes[u]},s.prototype.hasNode=function(u){return e.has(this._nodes,u)},s.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},s.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},s.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},s.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==r)return f}},s.prototype.children=function(u){if(e.isUndefined(u)&&(u=r),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===r)return this.nodes();if(this.hasNode(u))return[]}},s.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},s.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},s.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},s.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},s.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(x,w){u(w)&&f.setNode(w,x)}),e.each(this._edgeObjs,function(x){f.hasNode(x.v)&&f.hasNode(x.w)&&f.setEdge(x,p.edge(x))});var h={};function v(x){var w=p.parent(x);return w===void 0||f.hasNode(w)?(h[x]=w,w):w in h?h[w]:v(w)}return this._isCompound&&e.each(f.nodes(),function(x){f.setParent(x,v(x))}),f},s.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(v,x){return h.length>1?p.setEdge(v,x,f):p.setEdge(v,x),x}),this},s.prototype.setEdge=function(){var u,f,p,h,v=!1,x=arguments[0];typeof x=="object"&&x!==null&&"v"in x?(u=x.v,f=x.w,p=x.name,arguments.length===2&&(h=arguments[1],v=!0)):(u=x,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],v=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var w=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,w))return v&&(this._edgeLabels[w]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[w]=v?h:this._defaultEdgeLabelFn(u,f,p);var g=c(this._isDirected,u,f,p);return u=g.v,f=g.w,Object.freeze(g),this._edgeObjs[w]=g,i(this._preds[f],u),i(this._sucs[u],f),this._in[f][w]=g,this._out[u][w]=g,this._edgeCount++,this},s.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},s.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),v=this._edgeObjs[h];return v&&(u=v.v,f=v.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[f],u),a(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},s.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.v===f}):h}},s.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.w===f}):h}},s.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function i(u,f){u[f]?u[f]++:u[f]=1}function a(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var v=""+f,x=""+p;if(!u&&v>x){var w=v;v=x,x=w}return v+n+x+n+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var v=""+f,x=""+p;if(!u&&v>x){var w=v;v=x,x=w}var g={v,w:x};return h&&(g.name=h),g}function d(u,f){return l(u,f.v,f.w,f.name)}return Hh}var Uh,Rj;function z8(){return Rj||(Rj=1,Uh="2.1.8"),Uh}var Vh,Ij;function F8(){return Ij||(Ij=1,Vh={Graph:Cy(),version:z8()}),Vh}var Gh,Pj;function $8(){if(Pj)return Gh;Pj=1;var e=br(),t=Cy();Gh={write:r,read:i};function r(a){var l={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:n(a),edges:s(a)};return e.isUndefined(a.graph())||(l.value=e.clone(a.graph())),l}function n(a){return e.map(a.nodes(),function(l){var c=a.node(l),d=a.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function s(a){return e.map(a.edges(),function(l){var c=a.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function i(a){var l=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(a.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Gh}var Kh,Oj;function q8(){if(Oj)return Kh;Oj=1;var e=br();Kh=t;function t(r){var n={},s=[],i;function a(l){e.has(n,l)||(n[l]=!0,i.push(l),e.each(r.successors(l),a),e.each(r.predecessors(l),a))}return e.each(r.nodes(),function(l){i=[],a(l),i.length&&s.push(i)}),s}return Kh}var Yh,Mj;function k4(){if(Mj)return Yh;Mj=1;var e=br();Yh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var s=this._keyIndices;if(r=String(r),!e.has(s,r)){var i=this._arr,a=i.length;return s[r]=a,i.push({key:r,priority:n}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var s=this._keyIndices[r];if(n>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[s].priority+" New: "+n);this._arr[s].priority=n,this._decrease(s)},t.prototype._heapify=function(r){var n=this._arr,s=2*r,i=s+1,a=r;s<n.length&&(a=n[s].priority<n[a].priority?s:a,i<n.length&&(a=n[i].priority<n[a].priority?i:a),a!==r&&(this._swap(r,a),this._heapify(a)))},t.prototype._decrease=function(r){for(var n=this._arr,s=n[r].priority,i;r!==0&&(i=r>>1,!(n[i].priority<s));)this._swap(r,i),r=i},t.prototype._swap=function(r,n){var s=this._arr,i=this._keyIndices,a=s[r],l=s[n];s[r]=l,s[n]=a,i[l.key]=r,i[a.key]=n},Yh}var Qh,Dj;function N4(){if(Dj)return Qh;Dj=1;var e=br(),t=k4();Qh=n;var r=e.constant(1);function n(i,a,l,c){return s(i,String(a),l||r,c||function(d){return i.outEdges(d)})}function s(i,a,l,c){var d={},u=new t,f,p,h=function(v){var x=v.v!==f?v.v:v.w,w=d[x],g=l(v),y=p.distance+g;if(g<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+g);y<w.distance&&(w.distance=y,w.predecessor=f,u.decrease(x,y))};for(i.nodes().forEach(function(v){var x=v===a?0:Number.POSITIVE_INFINITY;d[v]={distance:x},u.add(v,x)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return Qh}var Xh,Lj;function B8(){if(Lj)return Xh;Lj=1;var e=N4(),t=br();Xh=r;function r(n,s,i){return t.transform(n.nodes(),function(a,l){a[l]=e(n,l,s,i)},{})}return Xh}var Zh,zj;function C4(){if(zj)return Zh;zj=1;var e=br();Zh=t;function t(r){var n=0,s=[],i={},a=[];function l(c){var d=i[c]={onStack:!0,lowlink:n,index:n++};if(s.push(c),r.successors(c).forEach(function(p){e.has(i,p)?i[p].onStack&&(d.lowlink=Math.min(d.lowlink,i[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,i[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=s.pop(),i[f].onStack=!1,u.push(f);while(c!==f);a.push(u)}}return r.nodes().forEach(function(c){e.has(i,c)||l(c)}),a}return Zh}var Jh,Fj;function W8(){if(Fj)return Jh;Fj=1;var e=br(),t=C4();Jh=r;function r(n){return e.filter(t(n),function(s){return s.length>1||s.length===1&&n.hasEdge(s[0],s[0])})}return Jh}var em,$j;function H8(){if($j)return em;$j=1;var e=br();em=r;var t=e.constant(1);function r(s,i,a){return n(s,i||t,a||function(l){return s.outEdges(l)})}function n(s,i,a){var l={},c=s.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),a(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=i(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var v=p[d],x=u[h],w=p[h],g=v.distance+x.distance;g<w.distance&&(w.distance=g,w.predecessor=x.predecessor)})})}),l}return em}var tm,qj;function E4(){if(qj)return tm;qj=1;var e=br();tm=t,t.CycleException=r;function t(n){var s={},i={},a=[];function l(c){if(e.has(i,c))throw new r;e.has(s,c)||(i[c]=!0,s[c]=!0,e.each(n.predecessors(c),l),delete i[c],a.push(c))}if(e.each(n.sinks(),l),e.size(s)!==n.nodeCount())throw new r;return a}function r(){}return r.prototype=new Error,tm}var rm,Bj;function U8(){if(Bj)return rm;Bj=1;var e=E4();rm=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return rm}var nm,Wj;function T4(){if(Wj)return nm;Wj=1;var e=br();nm=t;function t(n,s,i){e.isArray(s)||(s=[s]);var a=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(s,function(d){if(!n.hasNode(d))throw new Error("Graph does not have node: "+d);r(n,d,i==="post",c,a,l)}),l}function r(n,s,i,a,l,c){e.has(a,s)||(a[s]=!0,i||c.push(s),e.each(l(s),function(d){r(n,d,i,a,l,c)}),i&&c.push(s))}return nm}var sm,Hj;function V8(){if(Hj)return sm;Hj=1;var e=T4();sm=t;function t(r,n){return e(r,n,"post")}return sm}var im,Uj;function G8(){if(Uj)return im;Uj=1;var e=T4();im=t;function t(r,n){return e(r,n,"pre")}return im}var om,Vj;function K8(){if(Vj)return om;Vj=1;var e=br(),t=Cy(),r=k4();om=n;function n(s,i){var a=new t,l={},c=new r,d;function u(p){var h=p.v===d?p.w:p.v,v=c.priority(h);if(v!==void 0){var x=i(p);x<v&&(l[h]=d,c.decrease(h,x))}}if(s.nodeCount()===0)return a;e.each(s.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),a.setNode(p)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))a.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(d).forEach(u)}return a}return om}var am,Gj;function Y8(){return Gj||(Gj=1,am={components:q8(),dijkstra:N4(),dijkstraAll:B8(),findCycles:W8(),floydWarshall:H8(),isAcyclic:U8(),postorder:V8(),preorder:G8(),prim:K8(),tarjan:C4(),topsort:E4()}),am}var lm,Kj;function Q8(){if(Kj)return lm;Kj=1;var e=F8();return lm={Graph:e.Graph,json:$8(),alg:Y8(),version:e.version},lm}var pc;if(typeof dy=="function")try{pc=Q8()}catch{}pc||(pc=window.graphlib);var Or=pc,cm,Yj;function X8(){if(Yj)return cm;Yj=1;var e=e4(),t=1,r=4;function n(s){return e(s,t|r)}return cm=n,cm}var um,Qj;function gu(){if(Qj)return um;Qj=1;var e=Pi(),t=vn(),r=lu(),n=yr();function s(i,a,l){if(!n(l))return!1;var c=typeof a;return(c=="number"?t(l)&&r(a,l.length):c=="string"&&a in l)?e(l[a],i):!1}return um=s,um}var dm,Xj;function Z8(){if(Xj)return dm;Xj=1;var e=xu(),t=Pi(),r=gu(),n=As(),s=Object.prototype,i=s.hasOwnProperty,a=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=n(p),v=-1,x=h.length;++v<x;){var w=h[v],g=l[w];(g===void 0||t(g,s[w])&&!i.call(l,w))&&(l[w]=p[w])}return l});return dm=a,dm}var fm,Zj;function J8(){if(Zj)return fm;Zj=1;var e=yn(),t=vn(),r=es();function n(s){return function(i,a,l){var c=Object(i);if(!t(i)){var d=e(a,3);i=r(i),a=function(f){return d(c[f],f,c)}}var u=s(i,a,l);return u>-1?c[d?i[u]:u]:void 0}}return fm=n,fm}var pm,Jj;function ez(){if(Jj)return pm;Jj=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return pm=t,pm}var hm,eS;function tz(){if(eS)return hm;eS=1;var e=ez(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return hm=r,hm}var mm,tS;function rz(){if(tS)return mm;tS=1;var e=tz(),t=yr(),r=Li(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return n;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=i.test(d);return f||a.test(d)?l(d.slice(2),f?2:8):s.test(d)?n:+d}return mm=c,mm}var xm,rS;function A4(){if(rS)return xm;rS=1;var e=rz(),t=1/0,r=17976931348623157e292;function n(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var i=s<0?-1:1;return i*r}return s===s?s:0}return xm=n,xm}var gm,nS;function nz(){if(nS)return gm;nS=1;var e=A4();function t(r){var n=e(r),s=n%1;return n===n?s?n-s:n:0}return gm=t,gm}var vm,sS;function sz(){if(sS)return vm;sS=1;var e=_4(),t=yn(),r=nz(),n=Math.max;function s(i,a,l){var c=i==null?0:i.length;if(!c)return-1;var d=l==null?0:r(l);return d<0&&(d=n(c+d,0)),e(i,t(a,3),d)}return vm=s,vm}var ym,iS;function iz(){if(iS)return ym;iS=1;var e=J8(),t=sz(),r=e(t);return ym=r,ym}var bm,oS;function R4(){if(oS)return bm;oS=1;var e=Ny();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return bm=t,bm}var wm,aS;function oz(){if(aS)return wm;aS=1;var e=_y(),t=t4(),r=As();function n(s,i){return s==null?s:e(s,t(i),r)}return wm=n,wm}var _m,lS;function az(){if(lS)return _m;lS=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return _m=e,_m}var jm,cS;function lz(){if(cS)return jm;cS=1;var e=ou(),t=jy(),r=yn();function n(s,i){var a={};return i=r(i,3),t(s,function(l,c,d){e(a,c,i(l,c,d))}),a}return jm=n,jm}var Sm,uS;function Ey(){if(uS)return Sm;uS=1;var e=Li();function t(r,n,s){for(var i=-1,a=r.length;++i<a;){var l=r[i],c=n(l);if(c!=null&&(d===void 0?c===c&&!e(c):s(c,d)))var d=c,u=l}return u}return Sm=t,Sm}var km,dS;function cz(){if(dS)return km;dS=1;function e(t,r){return t>r}return km=e,km}var Nm,fS;function uz(){if(fS)return Nm;fS=1;var e=Ey(),t=cz(),r=Rs();function n(s){return s&&s.length?e(s,r,t):void 0}return Nm=n,Nm}var Cm,pS;function I4(){if(pS)return Cm;pS=1;var e=ou(),t=Pi();function r(n,s,i){(i!==void 0&&!t(n[s],i)||i===void 0&&!(s in n))&&e(n,s,i)}return Cm=r,Cm}var Em,hS;function dz(){if(hS)return Em;hS=1;var e=Es(),t=du(),r=Kr(),n="[object Object]",s=Function.prototype,i=Object.prototype,a=s.toString,l=i.hasOwnProperty,c=a.call(Object);function d(u){if(!r(u)||e(u)!=n)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&a.call(p)==c}return Em=d,Em}var Tm,mS;function P4(){if(mS)return Tm;mS=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Tm=e,Tm}var Am,xS;function fz(){if(xS)return Am;xS=1;var e=ja(),t=As();function r(n){return e(n,t(n))}return Am=r,Am}var Rm,gS;function pz(){if(gS)return Rm;gS=1;var e=I4(),t=BE(),r=XE(),n=WE(),s=JE(),i=Sa(),a=at(),l=j4(),c=Mi(),d=_a(),u=yr(),f=dz(),p=ka(),h=P4(),v=fz();function x(w,g,y,b,j,k,N){var S=h(w,y),C=h(g,y),_=N.get(C);if(_){e(w,y,_);return}var R=k?k(S,C,y+"",w,g,N):void 0,T=R===void 0;if(T){var D=a(C),$=!D&&c(C),E=!D&&!$&&p(C);R=C,D||$||E?a(S)?R=S:l(S)?R=n(S):$?(T=!1,R=t(C,!0)):E?(T=!1,R=r(C,!0)):R=[]:f(C)||i(C)?(R=S,i(S)?R=v(S):(!u(S)||d(S))&&(R=s(C))):T=!1}T&&(N.set(C,R),j(R,C,b,k,N),N.delete(C)),e(w,y,R)}return Rm=x,Rm}var Im,vS;function hz(){if(vS)return Im;vS=1;var e=iu(),t=I4(),r=_y(),n=pz(),s=yr(),i=As(),a=P4();function l(c,d,u,f,p){c!==d&&r(d,function(h,v){if(p||(p=new e),s(h))n(c,d,v,u,l,f,p);else{var x=f?f(a(c,v),h,v+"",c,d,p):void 0;x===void 0&&(x=h),t(c,v,x)}},i)}return Im=l,Im}var Pm,yS;function mz(){if(yS)return Pm;yS=1;var e=xu(),t=gu();function r(n){return e(function(s,i){var a=-1,l=i.length,c=l>1?i[l-1]:void 0,d=l>2?i[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(i[0],i[1],d)&&(c=l<3?void 0:c,l=1),s=Object(s);++a<l;){var u=i[a];u&&n(s,u,a,c)}return s})}return Pm=r,Pm}var Om,bS;function xz(){if(bS)return Om;bS=1;var e=hz(),t=mz(),r=t(function(n,s,i){e(n,s,i)});return Om=r,Om}var Mm,wS;function O4(){if(wS)return Mm;wS=1;function e(t,r){return t<r}return Mm=e,Mm}var Dm,_S;function gz(){if(_S)return Dm;_S=1;var e=Ey(),t=O4(),r=Rs();function n(s){return s&&s.length?e(s,r,t):void 0}return Dm=n,Dm}var Lm,jS;function vz(){if(jS)return Lm;jS=1;var e=Ey(),t=yn(),r=O4();function n(s,i){return s&&s.length?e(s,t(i,2),r):void 0}return Lm=n,Lm}var zm,SS;function yz(){if(SS)return zm;SS=1;var e=Pr(),t=function(){return e.Date.now()};return zm=t,zm}var Fm,kS;function bz(){if(kS)return Fm;kS=1;var e=au(),t=hu(),r=lu(),n=yr(),s=Na();function i(a,l,c,d){if(!n(a))return a;l=t(l,a);for(var u=-1,f=l.length,p=f-1,h=a;h!=null&&++u<f;){var v=s(l[u]),x=c;if(v==="__proto__"||v==="constructor"||v==="prototype")return a;if(u!=p){var w=h[v];x=d?d(w,v,h):void 0,x===void 0&&(x=n(w)?w:r(l[u+1])?[]:{})}e(h,v,x),h=h[v]}return a}return Fm=i,Fm}var $m,NS;function wz(){if(NS)return $m;NS=1;var e=mu(),t=bz(),r=hu();function n(s,i,a){for(var l=-1,c=i.length,d={};++l<c;){var u=i[l],f=e(s,u);a(f,u)&&t(d,r(u,s),f)}return d}return $m=n,$m}var qm,CS;function _z(){if(CS)return qm;CS=1;var e=wz(),t=f4();function r(n,s){return e(n,s,function(i,a){return t(n,a)})}return qm=r,qm}var Bm,ES;function jz(){if(ES)return Bm;ES=1;var e=R4(),t=b4(),r=w4();function n(s){return r(t(s,void 0,e),s+"")}return Bm=n,Bm}var Wm,TS;function Sz(){if(TS)return Wm;TS=1;var e=_z(),t=jz(),r=t(function(n,s){return n==null?{}:e(n,s)});return Wm=r,Wm}var Hm,AS;function kz(){if(AS)return Hm;AS=1;var e=Math.ceil,t=Math.max;function r(n,s,i,a){for(var l=-1,c=t(e((s-n)/(i||1)),0),d=Array(c);c--;)d[a?c:++l]=n,n+=i;return d}return Hm=r,Hm}var Um,RS;function Nz(){if(RS)return Um;RS=1;var e=kz(),t=gu(),r=A4();function n(s){return function(i,a,l){return l&&typeof l!="number"&&t(i,a,l)&&(a=l=void 0),i=r(i),a===void 0?(a=i,i=0):a=r(a),l=l===void 0?i<a?1:-1:r(l),e(i,a,l,s)}}return Um=n,Um}var Vm,IS;function Cz(){if(IS)return Vm;IS=1;var e=Nz(),t=e();return Vm=t,Vm}var Gm,PS;function Ez(){if(PS)return Gm;PS=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Gm=e,Gm}var Km,OS;function Tz(){if(OS)return Km;OS=1;var e=Li();function t(r,n){if(r!==n){var s=r!==void 0,i=r===null,a=r===r,l=e(r),c=n!==void 0,d=n===null,u=n===n,f=e(n);if(!d&&!f&&!l&&r>n||l&&c&&u&&!d&&!f||i&&c&&u||!s&&u||!a)return 1;if(!i&&!l&&!f&&r<n||f&&s&&a&&!i&&!l||d&&s&&a||!c&&a||!u)return-1}return 0}return Km=t,Km}var Ym,MS;function Az(){if(MS)return Ym;MS=1;var e=Tz();function t(r,n,s){for(var i=-1,a=r.criteria,l=n.criteria,c=a.length,d=s.length;++i<c;){var u=e(a[i],l[i]);if(u){if(i>=d)return u;var f=s[i];return u*(f=="desc"?-1:1)}}return r.index-n.index}return Ym=t,Ym}var Qm,DS;function Rz(){if(DS)return Qm;DS=1;var e=pu(),t=mu(),r=yn(),n=g4(),s=Ez(),i=cu(),a=Az(),l=Rs(),c=at();function d(u,f,p){f.length?f=e(f,function(x){return c(x)?function(w){return t(w,x.length===1?x[0]:x)}:x}):f=[l];var h=-1;f=e(f,i(r));var v=n(u,function(x,w,g){var y=e(f,function(b){return b(x)});return{criteria:y,index:++h,value:x}});return s(v,function(x,w){return a(x,w,p)})}return Qm=d,Qm}var Xm,LS;function Iz(){if(LS)return Xm;LS=1;var e=Ny(),t=Rz(),r=xu(),n=gu(),s=r(function(i,a){if(i==null)return[];var l=a.length;return l>1&&n(i,a[0],a[1])?a=[]:l>2&&n(a[0],a[1],a[2])&&(a=[a[0]]),t(i,e(a,1),[])});return Xm=s,Xm}var Zm,zS;function Pz(){if(zS)return Zm;zS=1;var e=u4(),t=0;function r(n){var s=++t;return e(n)+s}return Zm=r,Zm}var Jm,FS;function Oz(){if(FS)return Jm;FS=1;function e(t,r,n){for(var s=-1,i=t.length,a=r.length,l={};++s<i;){var c=s<a?r[s]:void 0;n(l,t[s],c)}return l}return Jm=e,Jm}var ex,$S;function Mz(){if($S)return ex;$S=1;var e=au(),t=Oz();function r(n,s){return t(n||[],s||[],e)}return ex=r,ex}var hc;if(typeof dy=="function")try{hc={cloneDeep:X8(),constant:wy(),defaults:Z8(),each:n4(),filter:h4(),find:iz(),flatten:R4(),forEach:r4(),forIn:oz(),has:m4(),isUndefined:x4(),last:az(),map:v4(),mapValues:lz(),max:uz(),merge:xz(),min:gz(),minBy:vz(),now:yz(),pick:Sz(),range:Cz(),reduce:y4(),sortBy:Iz(),uniqueId:Pz(),values:S4(),zipObject:Mz()}}catch{}hc||(hc=window._);var Ye=hc,Dz=vu;function vu(){var e={};e._next=e._prev=e,this._sentinel=e}vu.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return M4(t),t};vu.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&M4(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};vu.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,Lz)),r=r._prev;return"["+e.join(", ")+"]"};function M4(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Lz(e,t){if(e!=="_next"&&e!=="_prev")return t}var sn=Ye,zz=Or.Graph,Fz=Dz,$z=Bz,qz=sn.constant(1);function Bz(e,t){if(e.nodeCount()<=1)return[];var r=Hz(e,t||qz),n=Wz(r.graph,r.buckets,r.zeroIdx);return sn.flatten(sn.map(n,function(s){return e.outEdges(s.v,s.w)}),!0)}function Wz(e,t,r){for(var n=[],s=t[t.length-1],i=t[0],a;e.nodeCount();){for(;a=i.dequeue();)tx(e,t,r,a);for(;a=s.dequeue();)tx(e,t,r,a);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(a=t[l].dequeue(),a){n=n.concat(tx(e,t,r,a,!0));break}}}return n}function tx(e,t,r,n,s){var i=s?[]:void 0;return sn.forEach(e.inEdges(n.v),function(a){var l=e.edge(a),c=e.node(a.v);s&&i.push({v:a.v,w:a.w}),c.out-=l,zg(t,r,c)}),sn.forEach(e.outEdges(n.v),function(a){var l=e.edge(a),c=a.w,d=e.node(c);d.in-=l,zg(t,r,d)}),e.removeNode(n.v),i}function Hz(e,t){var r=new zz,n=0,s=0;sn.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),sn.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,d=t(l),u=c+d;r.setEdge(l.v,l.w,u),s=Math.max(s,r.node(l.v).out+=d),n=Math.max(n,r.node(l.w).in+=d)});var i=sn.range(s+n+3).map(function(){return new Fz}),a=n+1;return sn.forEach(r.nodes(),function(l){zg(i,a,r.node(l))}),{graph:r,buckets:i,zeroIdx:a}}function zg(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var ps=Ye,Uz=$z,Vz={run:Gz,undo:Yz};function Gz(e){var t=e.graph().acyclicer==="greedy"?Uz(e,r(e)):Kz(e);ps.forEach(t,function(n){var s=e.edge(n);e.removeEdge(n),s.forwardName=n.name,s.reversed=!0,e.setEdge(n.w,n.v,s,ps.uniqueId("rev"))});function r(n){return function(s){return n.edge(s).weight}}}function Kz(e){var t=[],r={},n={};function s(i){ps.has(n,i)||(n[i]=!0,r[i]=!0,ps.forEach(e.outEdges(i),function(a){ps.has(r,a.w)?t.push(a):s(a.w)}),delete r[i])}return ps.forEach(e.nodes(),s),t}function Yz(e){ps.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var Fe=Ye,D4=Or.Graph,Yt={addDummyNode:L4,simplify:Qz,asNonCompoundGraph:Xz,successorWeights:Zz,predecessorWeights:Jz,intersectRect:eF,buildLayerMatrix:tF,normalizeRanks:rF,removeEmptyRanks:nF,addBorderNode:sF,maxRank:z4,partition:iF,time:oF,notime:aF};function L4(e,t,r,n){var s;do s=Fe.uniqueId(n);while(e.hasNode(s));return r.dummy=t,e.setNode(s,r),s}function Qz(e){var t=new D4().setGraph(e.graph());return Fe.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),Fe.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},s=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+s.weight,minlen:Math.max(n.minlen,s.minlen)})}),t}function Xz(e){var t=new D4({multigraph:e.isMultigraph()}).setGraph(e.graph());return Fe.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),Fe.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function Zz(e){var t=Fe.map(e.nodes(),function(r){var n={};return Fe.forEach(e.outEdges(r),function(s){n[s.w]=(n[s.w]||0)+e.edge(s).weight}),n});return Fe.zipObject(e.nodes(),t)}function Jz(e){var t=Fe.map(e.nodes(),function(r){var n={};return Fe.forEach(e.inEdges(r),function(s){n[s.v]=(n[s.v]||0)+e.edge(s).weight}),n});return Fe.zipObject(e.nodes(),t)}function eF(e,t){var r=e.x,n=e.y,s=t.x-r,i=t.y-n,a=e.width/2,l=e.height/2;if(!s&&!i)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(i)*a>Math.abs(s)*l?(i<0&&(l=-l),c=l*s/i,d=l):(s<0&&(a=-a),c=a,d=a*i/s),{x:r+c,y:n+d}}function tF(e){var t=Fe.map(Fe.range(z4(e)+1),function(){return[]});return Fe.forEach(e.nodes(),function(r){var n=e.node(r),s=n.rank;Fe.isUndefined(s)||(t[s][n.order]=r)}),t}function rF(e){var t=Fe.min(Fe.map(e.nodes(),function(r){return e.node(r).rank}));Fe.forEach(e.nodes(),function(r){var n=e.node(r);Fe.has(n,"rank")&&(n.rank-=t)})}function nF(e){var t=Fe.min(Fe.map(e.nodes(),function(i){return e.node(i).rank})),r=[];Fe.forEach(e.nodes(),function(i){var a=e.node(i).rank-t;r[a]||(r[a]=[]),r[a].push(i)});var n=0,s=e.graph().nodeRankFactor;Fe.forEach(r,function(i,a){Fe.isUndefined(i)&&a%s!==0?--n:n&&Fe.forEach(i,function(l){e.node(l).rank+=n})})}function sF(e,t,r,n){var s={width:0,height:0};return arguments.length>=4&&(s.rank=r,s.order=n),L4(e,"border",s,t)}function z4(e){return Fe.max(Fe.map(e.nodes(),function(t){var r=e.node(t).rank;if(!Fe.isUndefined(r))return r}))}function iF(e,t){var r={lhs:[],rhs:[]};return Fe.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function oF(e,t){var r=Fe.now();try{return t()}finally{console.log(e+" time: "+(Fe.now()-r)+"ms")}}function aF(e,t){return t()}var F4=Ye,lF=Yt,cF={run:uF,undo:fF};function uF(e){e.graph().dummyChains=[],F4.forEach(e.edges(),function(t){dF(e,t)})}function dF(e,t){var r=t.v,n=e.node(r).rank,s=t.w,i=e.node(s).rank,a=t.name,l=e.edge(t),c=l.labelRank;if(i!==n+1){e.removeEdge(t);var d,u,f;for(f=0,++n;n<i;++f,++n)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},d=lF.addDummyNode(e,"edge",u,"_d"),n===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(r,d,{weight:l.weight},a),f===0&&e.graph().dummyChains.push(d),r=d;e.setEdge(r,s,{weight:l.weight},a)}}function fF(e){F4.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,s;for(e.setEdge(r.edgeObj,n);r.dummy;)s=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=s,r=e.node(t)})}var il=Ye,yu={longestPath:pF,slack:hF};function pF(e){var t={};function r(n){var s=e.node(n);if(il.has(t,n))return s.rank;t[n]=!0;var i=il.min(il.map(e.outEdges(n),function(a){return r(a.w)-e.edge(a).minlen}));return(i===Number.POSITIVE_INFINITY||i===void 0||i===null)&&(i=0),s.rank=i}il.forEach(e.sources(),r)}function hF(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var mc=Ye,mF=Or.Graph,xc=yu.slack,$4=xF;function xF(e){var t=new mF({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var s,i;gF(t,e)<n;)s=vF(t,e),i=t.hasNode(s.v)?xc(e,s):-xc(e,s),yF(t,e,i);return t}function gF(e,t){function r(n){mc.forEach(t.nodeEdges(n),function(s){var i=s.v,a=n===i?s.w:i;!e.hasNode(a)&&!xc(t,s)&&(e.setNode(a,{}),e.setEdge(n,a,{}),r(a))})}return mc.forEach(e.nodes(),r),e.nodeCount()}function vF(e,t){return mc.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return xc(t,r)})}function yF(e,t,r){mc.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var mn=Ye,bF=$4,wF=yu.slack,_F=yu.longestPath,jF=Or.alg.preorder,SF=Or.alg.postorder,kF=Yt.simplify,NF=Is;Is.initLowLimValues=Ay;Is.initCutValues=Ty;Is.calcCutValue=q4;Is.leaveEdge=W4;Is.enterEdge=H4;Is.exchangeEdges=U4;function Is(e){e=kF(e),_F(e);var t=bF(e);Ay(t),Ty(t,e);for(var r,n;r=W4(t);)n=H4(t,e,r),U4(t,e,r,n)}function Ty(e,t){var r=SF(e,e.nodes());r=r.slice(0,r.length-1),mn.forEach(r,function(n){CF(e,t,n)})}function CF(e,t,r){var n=e.node(r),s=n.parent;e.edge(r,s).cutvalue=q4(e,t,r)}function q4(e,t,r){var n=e.node(r),s=n.parent,i=!0,a=t.edge(r,s),l=0;return a||(i=!1,a=t.edge(s,r)),l=a.weight,mn.forEach(t.nodeEdges(r),function(c){var d=c.v===r,u=d?c.w:c.v;if(u!==s){var f=d===i,p=t.edge(c).weight;if(l+=f?p:-p,TF(e,r,u)){var h=e.edge(r,u).cutvalue;l+=f?-h:h}}}),l}function Ay(e,t){arguments.length<2&&(t=e.nodes()[0]),B4(e,{},1,t)}function B4(e,t,r,n,s){var i=r,a=e.node(n);return t[n]=!0,mn.forEach(e.neighbors(n),function(l){mn.has(t,l)||(r=B4(e,t,r,l,n))}),a.low=i,a.lim=r++,s?a.parent=s:delete a.parent,r}function W4(e){return mn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function H4(e,t,r){var n=r.v,s=r.w;t.hasEdge(n,s)||(n=r.w,s=r.v);var i=e.node(n),a=e.node(s),l=i,c=!1;i.lim>a.lim&&(l=a,c=!0);var d=mn.filter(t.edges(),function(u){return c===qS(e,e.node(u.v),l)&&c!==qS(e,e.node(u.w),l)});return mn.minBy(d,function(u){return wF(t,u)})}function U4(e,t,r,n){var s=r.v,i=r.w;e.removeEdge(s,i),e.setEdge(n.v,n.w,{}),Ay(e),Ty(e,t),EF(e,t)}function EF(e,t){var r=mn.find(e.nodes(),function(s){return!t.node(s).parent}),n=jF(e,r);n=n.slice(1),mn.forEach(n,function(s){var i=e.node(s).parent,a=t.edge(s,i),l=!1;a||(a=t.edge(i,s),l=!0),t.node(s).rank=t.node(i).rank+(l?a.minlen:-a.minlen)})}function TF(e,t,r){return e.hasEdge(t,r)}function qS(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var AF=yu,V4=AF.longestPath,RF=$4,IF=NF,PF=OF;function OF(e){switch(e.graph().ranker){case"network-simplex":BS(e);break;case"tight-tree":DF(e);break;case"longest-path":MF(e);break;default:BS(e)}}var MF=V4;function DF(e){V4(e),RF(e)}function BS(e){IF(e)}var Fg=Ye,LF=zF;function zF(e){var t=$F(e);Fg.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),s=n.edgeObj,i=FF(e,t,s.v,s.w),a=i.path,l=i.lca,c=0,d=a[c],u=!0;r!==s.w;){if(n=e.node(r),u){for(;(d=a[c])!==l&&e.node(d).maxRank<n.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<a.length-1&&e.node(d=a[c+1]).minRank<=n.rank;)c++;d=a[c]}e.setParent(r,d),r=e.successors(r)[0]}})}function FF(e,t,r,n){var s=[],i=[],a=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,d;c=r;do c=e.parent(c),s.push(c);while(c&&(t[c].low>a||l>t[c].lim));for(d=c,c=n;(c=e.parent(c))!==d;)i.push(c);return{path:s.concat(i.reverse()),lca:d}}function $F(e){var t={},r=0;function n(s){var i=r;Fg.forEach(e.children(s),n),t[s]={low:i,lim:r++}}return Fg.forEach(e.children(),n),t}var on=Ye,$g=Yt,qF={run:BF,cleanup:UF};function BF(e){var t=$g.addDummyNode(e,"root",{},"_root"),r=WF(e),n=on.max(on.values(r))-1,s=2*n+1;e.graph().nestingRoot=t,on.forEach(e.edges(),function(a){e.edge(a).minlen*=s});var i=HF(e)+1;on.forEach(e.children(),function(a){G4(e,t,s,i,n,r,a)}),e.graph().nodeRankFactor=s}function G4(e,t,r,n,s,i,a){var l=e.children(a);if(!l.length){a!==t&&e.setEdge(t,a,{weight:0,minlen:r});return}var c=$g.addBorderNode(e,"_bt"),d=$g.addBorderNode(e,"_bb"),u=e.node(a);e.setParent(c,a),u.borderTop=c,e.setParent(d,a),u.borderBottom=d,on.forEach(l,function(f){G4(e,t,r,n,s,i,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,v=p.borderBottom?p.borderBottom:f,x=p.borderTop?n:2*n,w=h!==v?1:s-i[a]+1;e.setEdge(c,h,{weight:x,minlen:w,nestingEdge:!0}),e.setEdge(v,d,{weight:x,minlen:w,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,c,{weight:0,minlen:s+i[a]})}function WF(e){var t={};function r(n,s){var i=e.children(n);i&&i.length&&on.forEach(i,function(a){r(a,s+1)}),t[n]=s}return on.forEach(e.children(),function(n){r(n,1)}),t}function HF(e){return on.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function UF(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,on.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var rx=Ye,VF=Yt,GF=KF;function KF(e){function t(r){var n=e.children(r),s=e.node(r);if(n.length&&rx.forEach(n,t),rx.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var i=s.minRank,a=s.maxRank+1;i<a;++i)WS(e,"borderLeft","_bl",r,s,i),WS(e,"borderRight","_br",r,s,i)}}rx.forEach(e.children(),t)}function WS(e,t,r,n,s,i){var a={width:0,height:0,rank:i,borderType:t},l=s[t][i-1],c=VF.addDummyNode(e,"border",a,r);s[t][i]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var qr=Ye,YF={adjust:QF,undo:XF};function QF(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&K4(e)}function XF(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&ZF(e),(t==="lr"||t==="rl")&&(JF(e),K4(e))}function K4(e){qr.forEach(e.nodes(),function(t){HS(e.node(t))}),qr.forEach(e.edges(),function(t){HS(e.edge(t))})}function HS(e){var t=e.width;e.width=e.height,e.height=t}function ZF(e){qr.forEach(e.nodes(),function(t){nx(e.node(t))}),qr.forEach(e.edges(),function(t){var r=e.edge(t);qr.forEach(r.points,nx),qr.has(r,"y")&&nx(r)})}function nx(e){e.y=-e.y}function JF(e){qr.forEach(e.nodes(),function(t){sx(e.node(t))}),qr.forEach(e.edges(),function(t){var r=e.edge(t);qr.forEach(r.points,sx),qr.has(r,"x")&&sx(r)})}function sx(e){var t=e.x;e.x=e.y,e.y=t}var Qr=Ye,e$=t$;function t$(e){var t={},r=Qr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Qr.max(Qr.map(r,function(l){return e.node(l).rank})),s=Qr.map(Qr.range(n+1),function(){return[]});function i(l){if(!Qr.has(t,l)){t[l]=!0;var c=e.node(l);s[c.rank].push(l),Qr.forEach(e.successors(l),i)}}var a=Qr.sortBy(r,function(l){return e.node(l).rank});return Qr.forEach(a,i),s}var _n=Ye,r$=n$;function n$(e,t){for(var r=0,n=1;n<t.length;++n)r+=s$(e,t[n-1],t[n]);return r}function s$(e,t,r){for(var n=_n.zipObject(r,_n.map(r,function(d,u){return u})),s=_n.flatten(_n.map(t,function(d){return _n.sortBy(_n.map(e.outEdges(d),function(u){return{pos:n[u.w],weight:e.edge(u).weight}}),"pos")}),!0),i=1;i<r.length;)i<<=1;var a=2*i-1;i-=1;var l=_n.map(new Array(a),function(){return 0}),c=0;return _n.forEach(s.forEach(function(d){var u=d.pos+i;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var US=Ye,i$=o$;function o$(e,t){return US.map(t,function(r){var n=e.inEdges(r);if(n.length){var s=US.reduce(n,function(i,a){var l=e.edge(a),c=e.node(a.v);return{sum:i.sum+l.weight*c.order,weight:i.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}var tr=Ye,a$=l$;function l$(e,t){var r={};tr.forEach(e,function(s,i){var a=r[s.v]={indegree:0,in:[],out:[],vs:[s.v],i};tr.isUndefined(s.barycenter)||(a.barycenter=s.barycenter,a.weight=s.weight)}),tr.forEach(t.edges(),function(s){var i=r[s.v],a=r[s.w];!tr.isUndefined(i)&&!tr.isUndefined(a)&&(a.indegree++,i.out.push(r[s.w]))});var n=tr.filter(r,function(s){return!s.indegree});return c$(n)}function c$(e){var t=[];function r(i){return function(a){a.merged||(tr.isUndefined(a.barycenter)||tr.isUndefined(i.barycenter)||a.barycenter>=i.barycenter)&&u$(i,a)}}function n(i){return function(a){a.in.push(i),--a.indegree===0&&e.push(a)}}for(;e.length;){var s=e.pop();t.push(s),tr.forEach(s.in.reverse(),r(s)),tr.forEach(s.out,n(s))}return tr.map(tr.filter(t,function(i){return!i.merged}),function(i){return tr.pick(i,["vs","i","barycenter","weight"])})}function u$(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var vo=Ye,d$=Yt,f$=p$;function p$(e,t){var r=d$.partition(e,function(u){return vo.has(u,"barycenter")}),n=r.lhs,s=vo.sortBy(r.rhs,function(u){return-u.i}),i=[],a=0,l=0,c=0;n.sort(h$(!!t)),c=VS(i,s,c),vo.forEach(n,function(u){c+=u.vs.length,i.push(u.vs),a+=u.barycenter*u.weight,l+=u.weight,c=VS(i,s,c)});var d={vs:vo.flatten(i,!0)};return l&&(d.barycenter=a/l,d.weight=l),d}function VS(e,t,r){for(var n;t.length&&(n=vo.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function h$(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var Rn=Ye,m$=i$,x$=a$,g$=f$,v$=Y4;function Y4(e,t,r,n){var s=e.children(t),i=e.node(t),a=i?i.borderLeft:void 0,l=i?i.borderRight:void 0,c={};a&&(s=Rn.filter(s,function(v){return v!==a&&v!==l}));var d=m$(e,s);Rn.forEach(d,function(v){if(e.children(v.v).length){var x=Y4(e,v.v,r,n);c[v.v]=x,Rn.has(x,"barycenter")&&b$(v,x)}});var u=x$(d,r);y$(u,c);var f=g$(u,n);if(a&&(f.vs=Rn.flatten([a,f.vs,l],!0),e.predecessors(a).length)){var p=e.node(e.predecessors(a)[0]),h=e.node(e.predecessors(l)[0]);Rn.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function y$(e,t){Rn.forEach(e,function(r){r.vs=Rn.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function b$(e,t){Rn.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var yo=Ye,w$=Or.Graph,_$=j$;function j$(e,t,r){var n=S$(e),s=new w$({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(i){return e.node(i)});return yo.forEach(e.nodes(),function(i){var a=e.node(i),l=e.parent(i);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(i),s.setParent(i,l||n),yo.forEach(e[r](i),function(c){var d=c.v===i?c.w:c.v,u=s.edge(d,i),f=yo.isUndefined(u)?0:u.weight;s.setEdge(d,i,{weight:e.edge(c).weight+f})}),yo.has(a,"minRank")&&s.setNode(i,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),s}function S$(e){for(var t;e.hasNode(t=yo.uniqueId("_root")););return t}var k$=Ye,N$=C$;function C$(e,t,r){var n={},s;k$.forEach(r,function(i){for(var a=e.parent(i),l,c;a;){if(l=e.parent(a),l?(c=n[l],n[l]=a):(c=s,s=a),c&&c!==a){t.setEdge(c,a);return}a=l}})}var Hn=Ye,E$=e$,T$=r$,A$=v$,R$=_$,I$=N$,P$=Or.Graph,GS=Yt,O$=M$;function M$(e){var t=GS.maxRank(e),r=KS(e,Hn.range(1,t+1),"inEdges"),n=KS(e,Hn.range(t-1,-1,-1),"outEdges"),s=E$(e);YS(e,s);for(var i=Number.POSITIVE_INFINITY,a,l=0,c=0;c<4;++l,++c){D$(l%2?r:n,l%4>=2),s=GS.buildLayerMatrix(e);var d=T$(e,s);d<i&&(c=0,a=Hn.cloneDeep(s),i=d)}YS(e,a)}function KS(e,t,r){return Hn.map(t,function(n){return R$(e,n,r)})}function D$(e,t){var r=new P$;Hn.forEach(e,function(n){var s=n.graph().root,i=A$(n,s,r,t);Hn.forEach(i.vs,function(a,l){n.node(a).order=l}),I$(n,r,i.vs)})}function YS(e,t){Hn.forEach(t,function(r){Hn.forEach(r,function(n,s){e.node(n).order=s})})}var ge=Ye,L$=Or.Graph,z$=Yt,F$={positionX:Q$};function $$(e,t){var r={};function n(s,i){var a=0,l=0,c=s.length,d=ge.last(i);return ge.forEach(i,function(u,f){var p=B$(e,u),h=p?e.node(p).order:c;(p||u===d)&&(ge.forEach(i.slice(l,f+1),function(v){ge.forEach(e.predecessors(v),function(x){var w=e.node(x),g=w.order;(g<a||h<g)&&!(w.dummy&&e.node(v).dummy)&&Q4(r,x,v)})}),l=f+1,a=h)}),i}return ge.reduce(t,n),r}function q$(e,t){var r={};function n(i,a,l,c,d){var u;ge.forEach(ge.range(a,l),function(f){u=i[f],e.node(u).dummy&&ge.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&Q4(r,p,u)})})}function s(i,a){var l=-1,c,d=0;return ge.forEach(a,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,n(a,d,f,l,c),d=f,l=c)}n(a,d,a.length,c,i.length)}),a}return ge.reduce(t,s),r}function B$(e,t){if(e.node(t).dummy)return ge.find(e.predecessors(t),function(r){return e.node(r).dummy})}function Q4(e,t,r){if(t>r){var n=t;t=r,r=n}var s=e[t];s||(e[t]=s={}),s[r]=!0}function W$(e,t,r){if(t>r){var n=t;t=r,r=n}return ge.has(e[t],r)}function H$(e,t,r,n){var s={},i={},a={};return ge.forEach(t,function(l){ge.forEach(l,function(c,d){s[c]=c,i[c]=c,a[c]=d})}),ge.forEach(t,function(l){var c=-1;ge.forEach(l,function(d){var u=n(d);if(u.length){u=ge.sortBy(u,function(x){return a[x]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var v=u[p];i[d]===d&&c<a[v]&&!W$(r,d,v)&&(i[v]=d,i[d]=s[d]=s[v],c=a[v])}}})}),{root:s,align:i}}function U$(e,t,r,n,s){var i={},a=V$(e,t,r,s),l=s?"borderLeft":"borderRight";function c(f,p){for(var h=a.nodes(),v=h.pop(),x={};v;)x[v]?f(v):(x[v]=!0,h.push(v),h=h.concat(p(v))),v=h.pop()}function d(f){i[f]=a.inEdges(f).reduce(function(p,h){return Math.max(p,i[h.v]+a.edge(h))},0)}function u(f){var p=a.outEdges(f).reduce(function(v,x){return Math.min(v,i[x.w]-a.edge(x))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(i[f]=Math.max(i[f],p))}return c(d,a.predecessors.bind(a)),c(u,a.successors.bind(a)),ge.forEach(n,function(f){i[f]=i[r[f]]}),i}function V$(e,t,r,n){var s=new L$,i=e.graph(),a=X$(i.nodesep,i.edgesep,n);return ge.forEach(t,function(l){var c;ge.forEach(l,function(d){var u=r[d];if(s.setNode(u),c){var f=r[c],p=s.edge(f,u);s.setEdge(f,u,Math.max(a(e,d,c),p||0))}c=d})}),s}function G$(e,t){return ge.minBy(ge.values(t),function(r){var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return ge.forIn(r,function(i,a){var l=Z$(e,a)/2;n=Math.max(i+l,n),s=Math.min(i-l,s)}),n-s})}function K$(e,t){var r=ge.values(t),n=ge.min(r),s=ge.max(r);ge.forEach(["u","d"],function(i){ge.forEach(["l","r"],function(a){var l=i+a,c=e[l],d;if(c!==t){var u=ge.values(c);d=a==="l"?n-ge.min(u):s-ge.max(u),d&&(e[l]=ge.mapValues(c,function(f){return f+d}))}})})}function Y$(e,t){return ge.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var s=ge.sortBy(ge.map(e,n));return(s[1]+s[2])/2})}function Q$(e){var t=z$.buildLayerMatrix(e),r=ge.merge($$(e,t),q$(e,t)),n={},s;ge.forEach(["u","d"],function(a){s=a==="u"?t:ge.values(t).reverse(),ge.forEach(["l","r"],function(l){l==="r"&&(s=ge.map(s,function(f){return ge.values(f).reverse()}));var c=(a==="u"?e.predecessors:e.successors).bind(e),d=H$(e,s,r,c),u=U$(e,s,d.root,d.align,l==="r");l==="r"&&(u=ge.mapValues(u,function(f){return-f})),n[a+l]=u})});var i=G$(e,n);return K$(n,i),Y$(n,e.graph().align)}function X$(e,t,r){return function(n,s,i){var a=n.node(s),l=n.node(i),c=0,d;if(c+=a.width/2,ge.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":d=-a.width/2;break;case"r":d=a.width/2;break}if(d&&(c+=r?d:-d),d=0,c+=(a.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,ge.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=r?d:-d),d=0,c}}function Z$(e,t){return e.node(t).width}var bo=Ye,X4=Yt,J$=F$.positionX,eq=tq;function tq(e){e=X4.asNonCompoundGraph(e),rq(e),bo.forEach(J$(e),function(t,r){e.node(r).x=t})}function rq(e){var t=X4.buildLayerMatrix(e),r=e.graph().ranksep,n=0;bo.forEach(t,function(s){var i=bo.max(bo.map(s,function(a){return e.node(a).height}));bo.forEach(s,function(a){e.node(a).y=n+i/2}),n+=i+r})}var _e=Ye,QS=Vz,XS=cF,nq=PF,sq=Yt.normalizeRanks,iq=LF,oq=Yt.removeEmptyRanks,ZS=qF,aq=GF,JS=YF,lq=O$,cq=eq,Yn=Yt,uq=Or.Graph,dq=fq;function fq(e,t){var r=t&&t.debugTiming?Yn.time:Yn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return jq(e)});r("  runLayout",function(){pq(n,r)}),r("  updateInputGraph",function(){hq(e,n)})})}function pq(e,t){t("    makeSpaceForEdgeLabels",function(){Sq(e)}),t("    removeSelfEdges",function(){Pq(e)}),t("    acyclic",function(){QS.run(e)}),t("    nestingGraph.run",function(){ZS.run(e)}),t("    rank",function(){nq(Yn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){kq(e)}),t("    removeEmptyRanks",function(){oq(e)}),t("    nestingGraph.cleanup",function(){ZS.cleanup(e)}),t("    normalizeRanks",function(){sq(e)}),t("    assignRankMinMax",function(){Nq(e)}),t("    removeEdgeLabelProxies",function(){Cq(e)}),t("    normalize.run",function(){XS.run(e)}),t("    parentDummyChains",function(){iq(e)}),t("    addBorderSegments",function(){aq(e)}),t("    order",function(){lq(e)}),t("    insertSelfEdges",function(){Oq(e)}),t("    adjustCoordinateSystem",function(){JS.adjust(e)}),t("    position",function(){cq(e)}),t("    positionSelfEdges",function(){Mq(e)}),t("    removeBorderNodes",function(){Iq(e)}),t("    normalize.undo",function(){XS.undo(e)}),t("    fixupEdgeLabelCoords",function(){Aq(e)}),t("    undoCoordinateSystem",function(){JS.undo(e)}),t("    translateGraph",function(){Eq(e)}),t("    assignNodeIntersects",function(){Tq(e)}),t("    reversePoints",function(){Rq(e)}),t("    acyclic.undo",function(){QS.undo(e)})}function hq(e,t){_e.forEach(e.nodes(),function(r){var n=e.node(r),s=t.node(r);n&&(n.x=s.x,n.y=s.y,t.children(r).length&&(n.width=s.width,n.height=s.height))}),_e.forEach(e.edges(),function(r){var n=e.edge(r),s=t.edge(r);n.points=s.points,_e.has(s,"x")&&(n.x=s.x,n.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var mq=["nodesep","edgesep","ranksep","marginx","marginy"],xq={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},gq=["acyclicer","ranker","rankdir","align"],vq=["width","height"],yq={width:0,height:0},bq=["minlen","weight","width","height","labeloffset"],wq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},_q=["labelpos"];function jq(e){var t=new uq({multigraph:!0,compound:!0}),r=ox(e.graph());return t.setGraph(_e.merge({},xq,ix(r,mq),_e.pick(r,gq))),_e.forEach(e.nodes(),function(n){var s=ox(e.node(n));t.setNode(n,_e.defaults(ix(s,vq),yq)),t.setParent(n,e.parent(n))}),_e.forEach(e.edges(),function(n){var s=ox(e.edge(n));t.setEdge(n,_e.merge({},wq,ix(s,bq),_e.pick(s,_q)))}),t}function Sq(e){var t=e.graph();t.ranksep/=2,_e.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function kq(e){_e.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),s=e.node(t.w),i={rank:(s.rank-n.rank)/2+n.rank,e:t};Yn.addDummyNode(e,"edge-proxy",i,"_ep")}})}function Nq(e){var t=0;_e.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=_e.max(t,n.maxRank))}),e.graph().maxRank=t}function Cq(e){_e.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function Eq(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,s=0,i=e.graph(),a=i.marginx||0,l=i.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),r=Math.max(r,u+p/2),n=Math.min(n,f-h/2),s=Math.max(s,f+h/2)}_e.forEach(e.nodes(),function(d){c(e.node(d))}),_e.forEach(e.edges(),function(d){var u=e.edge(d);_e.has(u,"x")&&c(u)}),t-=a,n-=l,_e.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=n}),_e.forEach(e.edges(),function(d){var u=e.edge(d);_e.forEach(u.points,function(f){f.x-=t,f.y-=n}),_e.has(u,"x")&&(u.x-=t),_e.has(u,"y")&&(u.y-=n)}),i.width=r-t+a,i.height=s-n+l}function Tq(e){_e.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),s=e.node(t.w),i,a;r.points?(i=r.points[0],a=r.points[r.points.length-1]):(r.points=[],i=s,a=n),r.points.unshift(Yn.intersectRect(n,i)),r.points.push(Yn.intersectRect(s,a))})}function Aq(e){_e.forEach(e.edges(),function(t){var r=e.edge(t);if(_e.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Rq(e){_e.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function Iq(e){_e.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),s=e.node(r.borderBottom),i=e.node(_e.last(r.borderLeft)),a=e.node(_e.last(r.borderRight));r.width=Math.abs(a.x-i.x),r.height=Math.abs(s.y-n.y),r.x=i.x+r.width/2,r.y=n.y+r.height/2}}),_e.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function Pq(e){_e.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function Oq(e){var t=Yn.buildLayerMatrix(e);_e.forEach(t,function(r){var n=0;_e.forEach(r,function(s,i){var a=e.node(s);a.order=i+n,_e.forEach(a.selfEdges,function(l){Yn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:a.rank,order:i+ ++n,e:l.e,label:l.label},"_se")}),delete a.selfEdges})})}function Mq(e){_e.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),s=n.x+n.width/2,i=n.y,a=r.x-s,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:s+2*a/3,y:i-l},{x:s+5*a/6,y:i-l},{x:s+a,y:i},{x:s+5*a/6,y:i+l},{x:s+2*a/3,y:i+l}],r.label.x=r.x,r.label.y=r.y}})}function ix(e,t){return _e.mapValues(_e.pick(e,t),Number)}function ox(e){var t={};return _e.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var ol=Ye,Dq=Yt,Lq=Or.Graph,zq={debugOrdering:Fq};function Fq(e){var t=Dq.buildLayerMatrix(e),r=new Lq({compound:!0,multigraph:!0}).setGraph({});return ol.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),ol.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),ol.forEach(t,function(n,s){var i="layer"+s;r.setNode(i,{rank:"same"}),ol.reduce(n,function(a,l){return r.setEdge(a,l,{style:"invis"}),l})}),r}var $q="0.8.5",qq={graphlib:Or,layout:dq,debug:zq,util:{time:Yt.time,notime:Yt.notime},version:$q};const e2=Zg(qq),gc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},Bq={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},Wq=220,Hq=110;function t2(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(s=>{const i=gc[s.type]||gc.task,l=s.type==="end"&&["blocked","abandoned"].includes(s.terminal_outcome)?Bq:i;return{id:s.node_id,type:"workflowNode",position:s._position||{x:0,y:0},data:{...s,config:l,isEntry:t.includes(s.node_id)}}}),n=(e.edges||[]).map(s=>{const i=s.non_advancing||!s.to_node_id,a=s.conditions&&s.conditions.length>0;let l=s.label||s.outcome;if(a){const c=s.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:s.edge_id,source:s.from_node_id,target:s.to_node_id||s.from_node_id,type:"smoothstep",animated:i,label:l,data:{...s},style:{stroke:i?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:i?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:s.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function qg(e,t,r="TB",n=Wq,s=Hq){const i=new e2.graphlib.Graph;return i.setDefaultEdgeLabel(()=>({})),i.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(a=>{i.setNode(a.id,{width:n,height:s})}),t.forEach(a=>{a.target!==a.source&&i.setEdge(a.source,a.target)}),e2.layout(i),e.map(a=>{const l=i.node(a.id);return l?{...a,position:{x:l.x-n/2,y:l.y-s/2}}:a})}function Uq(e,t){const r=new Set(t.map(i=>i.id||i.node_id));let n=1,s=`${e}_${n}`;for(;r.has(s);)n++,s=`${e}_${n}`;return s}function Vq(e,t,r){const n=new Set(r.map(a=>a.id||a.edge_id));let s=1,i=`${e}_to_${t}`;for(;n.has(i);)s++,i=`${e}_to_${t}_${s}`;return i}function Gq(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const r2={action:{color:"#1d4ed8",bgColor:"#eff6ff",borderColor:"#3b82f6",label:"Action"},gate:{color:"#b45309",bgColor:"#fef3c7",borderColor:"#f59e0b",label:"Gate"},escalation:{color:"#b91c1c",bgColor:"#fee2e2",borderColor:"#ef4444",label:"Escalation"},parallel_fork:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Fork"},parallel_join:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Join"},start:{color:"#047857",bgColor:"#d1fae5",borderColor:"#10b981",label:"Start"},end:{color:"#374151",bgColor:"#f3f4f6",borderColor:"#6b7280",label:"End"}},n2={normal:{stroke:"#64748b",strokeWidth:2},error:{stroke:"#ef4444",strokeWidth:2,strokeDasharray:"6,3"},retry:{stroke:"#f97316",strokeWidth:2,strokeDasharray:"6,3",animated:!0},parallel:{stroke:"#8b5cf6",strokeWidth:2}},Kq=160,Yq=80;function Qq({data:e}){const{config:t,showLineage:r}=e,n=e.type==="end",s=e.type==="start",i=r&&(e.dcw_ref||e.task_ref||e.operation_ref||e.gate_profile),a=e.component,l=e.output,c=a||l;return o.jsxs("div",{style:{background:t.bgColor,border:`2px solid ${t.borderColor}`,borderRadius:8,padding:"10px 14px",minWidth:260,maxWidth:360,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[!s&&o.jsx(Kn,{type:"target",position:fe.Top,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}}),o.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:t.color,letterSpacing:"0.05em",marginBottom:4},children:t.label}),o.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e293b",lineHeight:"18px",marginBottom:6},children:e.label}),e.actor&&o.jsx("div",{style:{fontSize:11,color:"#4f46e5",fontWeight:500,marginBottom:4},children:e.actor}),c&&o.jsxs("div",{style:{marginTop:6,paddingTop:6,borderTop:"1px solid #e2e8f0",display:"flex",flexDirection:"column",gap:4},children:[a&&o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[o.jsx("span",{style:{fontSize:9,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Component"}),o.jsx("span",{style:{fontSize:11,color:"#0d9488",fontWeight:500,lineHeight:1.4},children:a})]}),l&&o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[o.jsx("span",{style:{fontSize:9,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Output"}),o.jsx("span",{style:{fontSize:11,color:"#7c3aed",fontWeight:500,lineHeight:1.4},children:l})]})]}),i&&o.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px dashed #cbd5e1"},children:[e.dcw_ref&&o.jsx(ax,{label:"DCW",value:e.dcw_ref}),e.task_ref&&o.jsx(ax,{label:"Task",value:e.task_ref}),e.operation_ref&&o.jsx(ax,{label:"Op",value:e.operation_ref}),e.gate_profile&&o.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3},children:[o.jsx("span",{style:{fontWeight:600},children:"Gate:"})," ",Array.isArray(e.gate_profile)?e.gate_profile.join(" -> "):e.gate_profile]})]}),!n&&o.jsx(Kn,{type:"source",position:fe.Bottom,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}})]})}function ax({label:e,value:t}){const r=t.length>30?"..."+t.slice(-27):t;return o.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3,fontFamily:"monospace"},title:t,children:[o.jsxs("span",{style:{fontWeight:600,fontFamily:"inherit"},children:[e,":"]})," ",r]})}const Xq=m.memo(Qq),Zq={archWorkflowNode:Xq};function Jq(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const r=[...e].sort((s,i)=>(s.step||s.order||0)-(i.step||i.order||0)).map((s,i)=>({node_id:`step_${i+1}`,type:"action",label:s.action||`Step ${i+1}`,actor:s.actor,description:s.description,inputs:s.inputs,outputs:s.outputs,notes:s.notes})),n=[];for(let s=0;s<r.length-1;s++)n.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:r[s].node_id,to_node_id:r[s+1].node_id,type:"normal"});return{nodes:r,edges:n}}function eB(e,t){const r=e.map(i=>{const a=r2[i.type]||r2.action;return{id:i.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...i,config:a}}}),n=t.map(i=>{const a=i.type||"normal",l=n2[a]||n2.normal;return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id,type:"smoothstep",animated:l.animated||!1,label:i.label,style:{stroke:l.stroke,strokeWidth:l.strokeWidth,strokeDasharray:l.strokeDasharray},labelStyle:{fontSize:9,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:l.stroke}}});return{nodes:qg(r,n,"TB",Kq,Yq),edges:n}}function s2({block:e}){const{data:t}=e;if(!t||!t.name)return null;const[r,n]=m.useState(!1),{graphNodes:s,graphEdges:i,isV1:a}=m.useMemo(()=>{const d=Array.isArray(t.nodes)&&t.nodes.length>0,u=Array.isArray(t.steps)&&t.steps.length>0;if(d)return{graphNodes:t.nodes,graphEdges:t.edges||[],isV1:!1};if(u){const{nodes:f,edges:p}=Jq(t.steps);return{graphNodes:f,graphEdges:p,isV1:!0}}return{graphNodes:[],graphEdges:[],isV1:!1}},[t.nodes,t.edges,t.steps]),l=m.useMemo(()=>s.length===0?null:eB(s,i),[s,i]),c=r?600:350;return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"var(--bg-panel)",borderRadius:8,border:"1px solid var(--border-node)"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.description&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),t.trigger&&o.jsxs("p",{style:{margin:"0 0 8px",fontSize:13,color:"var(--text-muted)",fontStyle:"italic"},children:["Trigger: ",t.trigger]}),l&&l.nodes.length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{height:c,border:"1px solid var(--border-node)",borderRadius:6,background:"var(--bg-canvas)",overflow:"hidden",transition:"height 0.2s ease"},children:o.jsx(eu,{children:o.jsx(uy,{nodes:l.nodes,edges:l.edges,nodeTypes:Zq,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!1,fitView:!0,fitViewOptions:{padding:.2},proOptions:{hideAttribution:!0},minZoom:.3,maxZoom:1.5})})}),o.jsx("button",{onClick:()=>n(d=>!d),style:{marginTop:6,padding:"3px 10px",fontSize:11,color:"#6366f1",background:"none",border:"1px solid var(--border-node)",borderRadius:4,cursor:"pointer"},children:r?"Collapse":"Expand"})]}):o.jsx("p",{style:{margin:0,fontSize:13,color:"var(--text-dim)",fontStyle:"italic"},children:"No workflow steps defined."})]})}function tB({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.acceptance_criteria)?t.acceptance_criteria:[];return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"var(--bg-panel)",borderRadius:8,border:"1px solid var(--border-node)"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.target&&o.jsx("p",{style:{margin:"0 0 6px",fontSize:13,color:"#475569"},children:t.target}),t.rationale&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:12,color:"var(--text-muted)",fontStyle:"italic"},children:t.rationale}),r.length>0&&o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Acceptance Criteria"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:r.map((n,s)=>o.jsx("li",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:n},s))})]})]})}function rB({block:e}){const{data:t}=e,r=(t==null?void 0:t.name)||(t==null?void 0:t.entity_name);if(!t||!r)return null;const n=Array.isArray(t.fields)?t.fields:[],s=Array.isArray(t.primary_keys)?t.primary_keys:[],i=Array.isArray(t.relationships)?t.relationships:[];return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"var(--bg-panel)",borderRadius:8,border:"1px solid var(--border-node)"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:r}),t.description&&o.jsx("p",{style:{margin:"0 0 10px",fontSize:13,color:"#475569"},children:t.description}),n.length>0&&o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{borderBottom:"2px solid #e2e8f0"},children:[o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"var(--text-muted)",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Field"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"var(--text-muted)",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Type"}),o.jsx("th",{style:{textAlign:"center",padding:"4px 8px",color:"var(--text-muted)",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Required"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"var(--text-muted)",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Notes"})]})}),o.jsx("tbody",{children:n.map((a,l)=>o.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[o.jsxs("td",{style:{padding:"4px 8px",fontFamily:"monospace",color:"#1e293b",fontWeight:s.includes(a.name)?600:400},children:[a.name,s.includes(a.name)?" (PK)":""]}),o.jsx("td",{style:{padding:"4px 8px",color:"#6366f1",fontFamily:"monospace"},children:a.type}),o.jsx("td",{style:{padding:"4px 8px",textAlign:"center"},children:a.required?"Yes":"No"}),o.jsx("td",{style:{padding:"4px 8px",color:"var(--text-muted)"},children:Array.isArray(a.notes)?a.notes.join("; "):a.notes||a.description||""})]},l))})]}),i.length>0&&o.jsxs("div",{style:{marginTop:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Relationships"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:i.map((a,l)=>o.jsx("li",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:typeof a=="string"?a:`${a.type||""} ${a.target||""} ${a.description||""}`.trim()},l))})]})]})}function nB({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.endpoints)?t.endpoints:[],n={GET:{bg:"#d1fae5",color:"#065f46"},POST:{bg:"#dbeafe",color:"#1e40af"},PUT:{bg:"#fef3c7",color:"#92400e"},PATCH:{bg:"#fef3c7",color:"#92400e"},DELETE:{bg:"#fee2e2",color:"#991b1b"}};return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"var(--bg-panel)",borderRadius:8,border:"1px solid var(--border-node)"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.type&&o.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#f0fdf4",color:"#166534",borderRadius:4},children:t.type}),t.protocol&&o.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#eff6ff",color:"#1e40af",borderRadius:4},children:t.protocol})]}),t.description&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),(t.authentication||t.authorization)&&o.jsxs("div",{style:{marginBottom:8,fontSize:12,color:"var(--text-muted)"},children:[t.authentication&&o.jsxs("span",{children:["Auth: ",t.authentication]}),t.authentication&&t.authorization&&o.jsx("span",{children:" | "}),t.authorization&&o.jsxs("span",{children:["Authz: ",t.authorization]})]}),r.length>0&&o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.map((s,i)=>{const a=n[s.method]||{bg:"#f3f4f6",color:"var(--text-secondary)"};return o.jsxs("div",{style:{padding:"8px 10px",background:"var(--bg-canvas)",borderRadius:6,border:"1px solid var(--border-node)"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 6px",borderRadius:3,background:a.bg,color:a.color,fontFamily:"monospace"},children:s.method}),o.jsx("code",{style:{fontSize:13,color:"#1e293b"},children:s.path})]}),s.description&&o.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"var(--text-muted)"},children:s.description})]},i)})})]})}function sB({block:e}){const{type:t,data:r}=e;return o.jsxs("div",{style:{padding:"12px 16px",background:"var(--bg-panel)",borderRadius:6,border:"1px solid var(--border-node)",marginBottom:12},children:[o.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),o.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function iB({block:e}){const{data:t}=e,r=t.items||[],[n,s]=m.useState({});if(r.length===0)return null;const i=a=>{s(l=>({...l,[a]:!l[a]}))};return o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((a,l)=>{const c=n[l],d=a.why_it_matters||a.impact_if_unresolved;return o.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[o.jsxs("button",{onClick:()=>d&&i(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[o.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:a.question||a.value||a.text||"Unknown"}),d&&o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:o.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&o.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[a.why_it_matters&&o.jsxs("div",{style:{marginTop:10},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),o.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.why_it_matters})]}),a.impact_if_unresolved&&o.jsxs("div",{style:{marginTop:10},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),o.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.impact_if_unresolved})]})]})]},l)})})}function oB({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return o.jsxs("div",{style:{marginBottom:12},children:[r&&o.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"var(--text-secondary)",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&o.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"var(--text-muted)",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function aB({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:s}=t;return o.jsxs("div",{style:{marginBottom:12},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[o.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&o.jsxs("span",{style:{fontSize:13,color:"var(--text-muted)"},children:["Confidence: ",n]})]}),s&&o.jsx("p",{style:{margin:0,fontSize:13,color:"var(--text-muted)",lineHeight:1.5},children:s})]})}function lB({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,s=r&&r.length>0,i=n&&n.length>0;return!s&&!i?null:o.jsxs("div",{style:{marginBottom:12},children:[s&&o.jsxs("div",{style:{marginBottom:i?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)",marginBottom:8,marginTop:0},children:"Explicit"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((a,l)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"var(--text-secondary)"},children:[o.jsx("span",{style:{color:"#f59e0b"},children:""}),o.jsx("span",{children:a})]},l))})]}),i&&o.jsxs("div",{children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)",marginBottom:8,marginTop:0},children:"Inferred"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((a,l)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"var(--text-secondary)"},children:[o.jsx("span",{style:{color:"#3b82f6"},children:""}),o.jsx("span",{children:a})]},l))})]})]})}function cB({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:s=[]}=t,i=r&&r.length>0,a=n&&n.length>0,l=s&&s.length>0;return!i&&!a&&!l?null:o.jsxs("div",{style:{marginBottom:12},children:[i&&o.jsxs("div",{style:{marginBottom:a||l?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)",marginBottom:8,marginTop:0},children:"Questions"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"var(--text-secondary)"},children:[o.jsx("span",{style:{color:"#3b82f6"},children:""}),o.jsx("span",{children:c})]},d))})]}),a&&o.jsxs("div",{style:{marginBottom:l?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)",marginBottom:8,marginTop:0},children:"Missing Context"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"var(--text-secondary)"},children:[o.jsx("span",{style:{color:"#f59e0b"},children:""}),o.jsx("span",{children:c})]},d))})]}),l&&o.jsxs("div",{children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"var(--text-muted)",marginBottom:8,marginTop:0},children:"Assumptions"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:s.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"var(--text-secondary)"},children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:""}),o.jsx("span",{children:c})]},d))})]})]})}function uB({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:s}=t,a={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return o.jsxs("div",{style:{marginBottom:12},children:[r&&o.jsx("div",{style:{marginBottom:12},children:o.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:a.bg,color:a.text},children:r})}),n&&o.jsx("p",{style:{margin:0,marginBottom:s?12:0,fontSize:13,color:"var(--text-muted)",lineHeight:1.5},children:n}),s&&o.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:o.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",s]})})]})}const dB={"schema:ParagraphBlockV1":L5,"schema:StringListBlockV1":ob,"schema:IndicatorBlockV1":F5,"schema:OpenQuestionV1":uC,"schema:OpenQuestionsBlockV1":$5,"schema:RisksBlockV1":ab,"schema:DependenciesBlockV1":ab,"schema:ArchComponentBlockV1":W5,"schema:WorkflowBlockV1":s2,"schema:WorkflowBlockV2":s2,"schema:QualityAttributeBlockV1":tB,"schema:DataModelBlockV1":rB,"schema:InterfaceBlockV1":nB,"schema:SummaryBlockV1":q5,"schema:StorySummaryBlockV1":B5,"schema:StoriesBlockV1":ob,"schema:UnknownsBlockV1":iB,"schema:IntakeSummaryBlockV1":oB,"schema:IntakeProjectTypeBlockV1":aB,"schema:IntakeConstraintsBlockV1":lB,"schema:IntakeOpenGapsBlockV1":cB,"schema:IntakeOutcomeBlockV1":uB};function fB(e){return dB[e]||sB}function pB(e,t){const r=fB(e.type);return o.jsx(r,{block:e},e.key||t)}function Z4({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:s=""}){var w;const[i,a]=m.useState(new Set(((w=e==null?void 0:e.sections)==null?void 0:w.map(g=>g.section_id))||[]));if(!e)return o.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return o.jsx(vB,{title:l,content:e.raw_content,reason:u.reason});const f=g=>{a(y=>{const b=new Set(y);return b.has(g)?b.delete(g):b.add(g),b})},p=t==="compact"||t==="sidecar",v=t==="sidecar"?d.filter(g=>g.viewer_tab==="overview"||!g.viewer_tab):d,x=(()=>{if(!l)return"Document";const g=l.indexOf(": ");return g>-1?l.slice(g+2):l})();return o.jsxs("div",{className:s,children:[t==="full"&&!r&&o.jsxs("div",{style:{marginBottom:24},children:[o.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"var(--text-primary)"},children:x}),c&&o.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"var(--text-muted)"},children:c})]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:v.map(g=>o.jsx(gB,{section:g,isExpanded:i.has(g.section_id),onToggle:()=>f(g.section_id),onClick:()=>n==null?void 0:n(g),variant:t},g.section_id))}),v.length===0&&o.jsx("div",{style:{padding:32,textAlign:"center",color:"var(--text-dim)",background:"var(--bg-panel)",borderRadius:8},children:"No content sections available"})]})}function hB(e){if(!e||!e.data)return"";const{type:t,data:r}=e;switch(t){case"schema:ParagraphBlockV1":return r.text||"";case"schema:StringListBlockV1":return(r.items||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.text||""}`).join(`
`);case"schema:IndicatorBlockV1":return`${r.label||""}: ${r.value||""}`;case"schema:OpenQuestionV1":return`Q: ${r.question||""}
A: ${r.answer||"No answer yet"}`;case"schema:OpenQuestionsBlockV1":return(r.questions||[]).map(n=>`Q: ${n.question||""}
A: ${n.answer||"No answer yet"}`).join(`

`);case"schema:RisksBlockV1":case"schema:DependenciesBlockV1":return(r.items||[]).map(n=>`- ${n.title||n.name||""}: ${n.description||""}`).join(`
`);case"schema:SummaryBlockV1":return r.summary||r.text||"";case"schema:EpicSummaryBlockV1":case"schema:StorySummaryBlockV1":return[r.title||"",r.description||r.summary||""].filter(Boolean).join(`

`);case"schema:UnknownsBlockV1":return(r.items||r.unknowns||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.description||n.text||""}`).join(`
`);case"schema:IntakeSummaryBlockV1":return r.summary||"";case"schema:IntakeProjectTypeBlockV1":return`Project Type: ${r.project_type||r.type||""}`;case"schema:IntakeConstraintsBlockV1":return(r.constraints||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOpenGapsBlockV1":return(r.gaps||r.open_gaps||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOutcomeBlockV1":return`Outcome: ${r.outcome||r.status||""}`;default:return r.text?r.text:r.content?r.content:r.summary?r.summary:r.items&&Array.isArray(r.items)?r.items.map(n=>typeof n=="string"?`- ${n}`:`- ${JSON.stringify(n)}`).join(`
`):""}}function mB({size:e=14}){return o.jsxs("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"5",y:"5",width:"9",height:"9",rx:"1"}),o.jsx("path",{d:"M2 11V3a1 1 0 011-1h8"})]})}function xB({size:e=14}){return o.jsx("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M3 8l4 4 6-7"})})}function gB({section:e,isExpanded:t,onToggle:r,onClick:n,variant:s}){const[i,a]=m.useState(!1),{section_id:l,title:c,description:d,blocks:u=[],sidecar_max_items:f}=e,p=s==="compact"||s==="sidecar",h=s==="sidecar";if(u.length===0)return null;const v=async g=>{g.stopPropagation();const y=u.map(hB).filter(Boolean).join(`

`);try{await navigator.clipboard.writeText(y),a(!0),setTimeout(()=>a(!1),2e3)}catch(b){console.error("Failed to copy:",b)}},x=h&&f&&u.length>f?u.slice(0,f):u,w=h&&f&&u.length>f;return o.jsxs("div",{style:{background:"var(--bg-node)",borderRadius:8,border:"1px solid var(--border-node)",overflow:"hidden"},children:[o.jsxs("button",{onClick:r,style:{width:"100%",padding:p?"10px 14px":"14px 18px",background:"var(--bg-panel)",border:"none",borderBottom:t?"1px solid var(--border-node)":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[o.jsxs("div",{children:[o.jsxs("h3",{style:{margin:0,fontSize:p?13:15,fontWeight:600,color:"var(--text-primary)"},children:[c,w&&o.jsxs("span",{style:{fontWeight:400,color:"var(--text-muted)",marginLeft:6},children:["(showing ",f," of ",u.length,")"]})]}),d&&!p&&o.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"var(--text-muted)"},children:d})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[o.jsx("button",{onClick:v,title:i?"Copied!":"Copy section",style:{padding:4,background:"none",border:"none",cursor:"pointer",color:i?"#10b981":"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,transition:"color 0.2s"},children:i?o.jsx(xB,{size:14}):o.jsx(mB,{size:14})}),o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-dim)",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:o.jsx("path",{d:"M4 6l4 4 4-4"})})]})]}),t&&o.jsxs("div",{style:{padding:p?12:18},children:[x.map((g,y)=>pB(g,y)),w&&o.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"var(--bg-button)",borderRadius:4,fontSize:12,color:"var(--text-muted)",textAlign:"center"},children:["+",u.length-f," more in full view"]})]})]})}function vB({title:e,content:t,reason:r}){return o.jsxs("div",{children:[o.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),o.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:o.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function Ci(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function Ry({bind:e,data:t,label:r}){if(t==null)return o.jsx("span",{style:{color:"var(--text-dim)",fontSize:13},children:"No data"});switch((e==null?void 0:e.render_as)||"paragraph"){case"paragraph":return o.jsx(vc,{data:t});case"list":return o.jsx(Iy,{data:t});case"ordered-list":return o.jsx(yB,{data:t});case"table":return o.jsx(bB,{data:t,columns:e.columns});case"key-value-pairs":return o.jsx(eT,{data:t});case"card-list":return o.jsx(wB,{data:t,card:e.card});case"nested-object":return o.jsx(_B,{data:t,fields:e.fields});default:return o.jsx(vc,{data:t})}}function vc({data:e}){const t=typeof e=="string"?e:JSON.stringify(e);return o.jsx("p",{style:{fontSize:14,color:"var(--text-primary)",margin:0,lineHeight:1.6,whiteSpace:"pre-wrap"},children:t})}function Iy({data:e}){return!Array.isArray(e)||e.length===0?o.jsx("span",{style:{color:"var(--text-dim)",fontSize:13},children:"Empty list"}):o.jsx("ul",{style:{margin:0,paddingLeft:20},children:e.map((t,r)=>o.jsx("li",{style:{fontSize:14,color:"var(--text-secondary)",marginBottom:4},children:typeof t=="string"?t:o.jsx(J4,{item:t})},r))})}function yB({data:e}){return!Array.isArray(e)||e.length===0?o.jsx("span",{style:{color:"var(--text-dim)",fontSize:13},children:"Empty list"}):o.jsx("ol",{style:{margin:0,paddingLeft:20},children:e.map((t,r)=>o.jsx("li",{style:{fontSize:14,color:"var(--text-secondary)",marginBottom:4},children:typeof t=="string"?t:o.jsx(J4,{item:t})},r))})}function J4({item:e}){if(typeof e!="object"||e===null)return String(e);const r=["description","text","recommendation","name","title","constraint","assumption","guardrail","statement","value"].find(a=>e[a]&&typeof e[a]=="string");if(!r)return o.jsx("span",{children:Object.entries(e).map(([a,l],c)=>o.jsxs("span",{children:[c>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[Ci(a),":"]})," ",typeof l=="string"?l:JSON.stringify(l)]},a))});const n=e[r],s=e.id,i=Object.entries(e).filter(([a])=>a!==r&&a!=="id");return o.jsxs("div",{children:[o.jsxs("span",{children:[s&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"var(--text-dim)",marginRight:6},children:s}),n]}),i.length>0&&o.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:2},children:i.map(([a,l])=>o.jsxs("span",{style:{marginRight:10},children:[o.jsxs("span",{style:{fontWeight:500},children:[Ci(a),":"]})," ",typeof l=="string"?l:JSON.stringify(l)]},a))})]})}function bB({data:e,columns:t}){if(!Array.isArray(e)||e.length===0)return o.jsx("span",{style:{color:"var(--text-dim)",fontSize:13},children:"No data"});if(!t||t.length===0){const r=e[0];if(typeof r=="object"&&r!==null)t=Object.keys(r).map(n=>({field:n,label:Ci(n)}));else return o.jsx(Iy,{data:e})}return o.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"var(--border-panel)"},children:o.jsxs("table",{className:"w-full text-sm",style:{borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{background:"var(--bg-panel)"},children:t.map(r=>o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"var(--text-muted)",borderBottom:"1px solid var(--border-node)"},children:r.label},r.field))})}),o.jsx("tbody",{children:e.map((r,n)=>o.jsx("tr",{style:{borderTop:n>0?"1px solid var(--border-node)":"none"},children:t.map(s=>{const i=r==null?void 0:r[s.field];return o.jsx("td",{className:"px-3 py-2",style:{color:"var(--text-primary)",fontSize:13},children:i==null?"-":typeof i=="boolean"?i?"Yes":"No":typeof i=="object"?JSON.stringify(i):String(i)},s.field)})},n))})]})})}function eT({data:e}){return typeof e!="object"||e===null||Array.isArray(e)?o.jsx(vc,{data:e}):o.jsx("div",{className:"space-y-2",children:Object.entries(e).map(([t,r])=>o.jsxs("div",{style:{display:"flex",gap:12,fontSize:14},children:[o.jsx("span",{style:{fontWeight:600,color:"var(--text-muted)",minWidth:120,flexShrink:0},children:Ci(t)}),o.jsx("span",{style:{color:"var(--text-primary)"},children:typeof r=="string"?r:JSON.stringify(r)})]},t))})}function wB({data:e,card:t}){if(!Array.isArray(e)||e.length===0)return o.jsx("span",{style:{color:"var(--text-dim)",fontSize:13},children:"No items"});if(!t)return o.jsx(Iy,{data:e.map(s=>typeof s=="string"?s:JSON.stringify(s))});const r=t.title||"name",n=t.fields||[];return o.jsx("div",{className:"space-y-4",children:e.map((s,i)=>{const a=s[r]||`Item ${i+1}`;return o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8,overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-node)",background:"var(--bg-panel)"},children:o.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text-primary)"},children:a})}),o.jsx("div",{style:{padding:16},className:"space-y-4",children:n.map(l=>{const c=s[l.path];return c==null?null:o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:6},children:l.label||Ci(l.path)}),o.jsx(Ry,{bind:l,data:c})]},l.path)})})]},s.id||i)})})}function _B({data:e,fields:t}){return typeof e!="object"||e===null||Array.isArray(e)?o.jsx(vc,{data:e}):!t||t.length===0?o.jsx(eT,{data:e}):o.jsx("div",{className:"space-y-4",children:t.map(r=>{const n=e[r.path];return n==null?null:o.jsxs("div",{style:{borderLeft:"3px solid var(--border-node)",paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:6},children:r.label||Ci(r.path)}),o.jsx(Ry,{bind:r,data:n})]},r.path)})})}function jB(e){return typeof e=="string"?{path:e}:e}function SB({renderModel:e,projectId:t,projectCode:r,docTypeId:n,executionId:s,docTypeName:i,onClose:a}){const[l,c]=m.useState(null),{tabDefs:d,tabSections:u,isRawContentMode:f}=m.useMemo(()=>{var $,E;const N=($=e==null?void 0:e.rendering_config)==null?void 0:$.detail_html,S=e==null?void 0:e.information_architecture,C=(e==null?void 0:e.sections)||[],_=e==null?void 0:e.raw_content;if(!(N!=null&&N.tabs)||!(S!=null&&S.sections))return{tabDefs:[{id:"overview",label:"Overview",sections:[]}],tabSections:{overview:C},isRawContentMode:!1};const R={};if(S.sections.forEach(L=>{R[L.id]={binds:(L.binds||[]).map(jB),label:L.label||L.id}}),_&&typeof _=="object"){const L=new Set;if(Object.values(R).forEach(M=>M.binds.forEach(I=>L.add(I.path))),[...L].some(M=>_[M]!==void 0&&_[M]!==null)){const M={};return N.tabs.forEach(I=>{const O=[];(I.sections||[]).forEach(F=>{const q=R[F];q&&q.binds.forEach(U=>{const G=_[U.path];G!=null&&O.push({fieldName:U.path,label:q.label,data:G,bind:U})})}),M[I.id]=O}),{tabDefs:N.tabs,tabSections:M,isRawContentMode:!0}}const P=_.raw===!0&&typeof _.content=="string"?_.content:null;if(P){const M=((E=N.tabs[0])==null?void 0:E.id)||"overview",I={};return N.tabs.forEach(O=>{I[O.id]=[]}),I[M]=[{fieldName:"_fallback",label:"Content",data:P,bind:{path:"_fallback"}}],{tabDefs:N.tabs,tabSections:I,isRawContentMode:!0}}}const T={};N.tabs.forEach(L=>{(L.sections||[]).forEach(A=>{const P=R[A];P&&P.binds.forEach(M=>{T[M.path]=L.id})})});const D={};return N.tabs.forEach(L=>{D[L.id]=[]}),C.forEach(L=>{const A=L.section_id,P=T[A]||"overview";D[P]?D[P].push(L):D.overview&&D.overview.push(L)}),{tabDefs:N.tabs,tabSections:D,isRawContentMode:!1}},[e]),p=l||(d.length>0?d[0].id:"overview"),h=m.useMemo(()=>d.map(N=>{var _,R,T;const S=u[N.id]||[];if(f){let D=null;return S.length===1&&Array.isArray((_=S[0])==null?void 0:_.data)?D=S[0].data.length:S.length>1&&(D=S.length),{id:N.id,label:N.label,count:D,disabled:S.length===0}}const C=((T=(R=S[0])==null?void 0:R.blocks)==null?void 0:T.length)||null;return{id:N.id,label:N.label,count:C,disabled:N.id!=="overview"&&!S.length}}),[d,u,f]),v=(e==null?void 0:e.metadata)||{},x=s?`/admin?execution=${s}`:"/admin",w=(()=>{const N=(e==null?void 0:e.title)||"Document",S=N.indexOf(": ");return S>-1?N.slice(S+2):N})(),g=N=>{if(!N)return null;try{return new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},y=g(v.created_at),b=g(v.updated_at),j=v.lifecycle_state,k=N=>{if(!e)return null;const S=u[N]||[];return{...e,sections:S}};return o.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"px-5 py-3 border-b",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:4},children:[r&&o.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",title:s?`View execution ${s}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:r}),o.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:i||(n==null?void 0:n.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase()))||"Document"}),j&&o.jsx("span",{style:{padding:"2px 8px",background:j==="complete"?"#dcfce7":"#fef3c7",color:j==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:j})]}),o.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"var(--text-primary)",lineHeight:1.3},children:w}),y&&o.jsxs("div",{style:{marginTop:2,fontSize:12,color:"var(--text-dim)"},children:["Generated ",y,b&&b!==y&&o.jsxs("span",{children:["  Updated ",b]})]})]}),o.jsx("div",{className:"flex items-center gap-1 px-4 border-b",style:{background:"var(--bg-canvas)",borderColor:"var(--border-panel)",minHeight:40},children:h.map(N=>{const S=p===N.id;return o.jsxs("button",{onClick:()=>!N.disabled&&c(N.id),disabled:N.disabled,className:"relative px-4 py-2 text-sm font-medium transition-colors",style:{color:S?"var(--action-primary)":N.disabled?"var(--text-dim)":"var(--text-muted)",background:"transparent",border:"none",cursor:N.disabled?"not-allowed":"pointer"},children:[N.label,N.count!==null&&o.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs rounded-full",style:{background:S?"var(--bg-selected)":"var(--bg-button)",color:S?"var(--action-primary)":"var(--text-muted)"},children:N.count}),S&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--action-primary)"}})]},N.id)})}),o.jsx("div",{className:"flex-1 overflow-hidden",style:{minHeight:0},children:f?o.jsx(NB,{fields:u[p]||[]}):o.jsx(kB,{renderModel:k(p),sections:u[p]||[]})},p)]})}function kB({renderModel:e,sections:t}){return o.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:r=>r.stopPropagation(),children:e&&t.length>0?o.jsx(Z4,{renderModel:e,variant:"full",hideHeader:!0}):o.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})})}function NB({fields:e}){return!e||e.length===0?o.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:t=>t.stopPropagation(),children:o.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})}):o.jsx("div",{className:"h-full overflow-y-auto p-6 space-y-6",onWheel:t=>t.stopPropagation(),children:e.map((t,r)=>{var n;return o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid var(--border-node)"},children:[o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text-primary)"},children:t.label||Py(t.fieldName)}),Array.isArray(t.data)&&o.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"var(--text-dim)"},children:t.data.length})]}),o.jsx("div",{style:{padding:16},children:(n=t.bind)!=null&&n.render_as?o.jsx(Ry,{bind:t.bind,data:t.data,label:t.label}):o.jsx(CB,{data:t.data,fieldName:t.fieldName})})]},t.fieldName||r)})})}function CB({data:e,fieldName:t}){return e==null?o.jsx("span",{style:{color:"var(--text-dim)",fontSize:13},children:"No data"}):typeof e=="string"?o.jsx("p",{style:{fontSize:14,color:"var(--text-primary)",margin:0,lineHeight:1.6,whiteSpace:"pre-wrap"},children:e}):Array.isArray(e)?e.length===0?o.jsx("span",{style:{color:"var(--text-dim)",fontSize:13},children:"Empty list"}):o.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((r,n)=>o.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"var(--text-secondary)"},children:[o.jsx("span",{style:{color:"var(--text-muted)",marginTop:2,flexShrink:0,fontSize:12},children:""}),o.jsx("div",{style:{flex:1},children:typeof r=="string"?o.jsx("span",{children:r}):typeof r=="object"&&r!==null?o.jsx(EB,{item:r}):o.jsx("span",{children:String(r)})})]},typeof r=="object"&&(r==null?void 0:r.id)||n))}):typeof e=="object"?o.jsx("div",{className:"space-y-3",children:Object.entries(e).map(([r,n])=>o.jsxs("div",{style:{borderLeft:"3px solid var(--border-node)",paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:Py(r)}),o.jsx("div",{style:{fontSize:14,color:"var(--text-primary)"},children:typeof n=="string"?n:typeof n=="object"?JSON.stringify(n,null,2):String(n)})]},r))}):o.jsx("pre",{style:{margin:0,fontSize:12,color:"var(--text-secondary)",whiteSpace:"pre-wrap",fontFamily:"monospace"},children:JSON.stringify(e,null,2)})}function EB({item:e}){const r=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title","problem_understanding","architectural_intent","proposed_system_shape"].find(h=>e[h]&&typeof e[h]=="string"),n=r?e[r]:null,s=e.id,i=e.confidence,a=e.likelihood,l=e.constraint_type,c=e.why_it_matters||e.why_early,d=e.impact_on_planning||e.impact_if_unresolved||e.impact,u=e.mitigation_direction,f=e.recommendation_direction,p=e.validation_approach;return n?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"var(--text-dim)"},children:s}),o.jsx("span",{style:{fontWeight:500},children:n}),l&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"var(--bg-button)",borderRadius:4,color:"var(--text-muted)"},children:l}),i&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:i==="high"?"#dcfce7":i==="medium"?"#fef3c7":"#fee2e2",color:i==="high"?"#166534":i==="medium"?"#92400e":"#991b1b"},children:i}),a&&o.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[a,e.impact?`/${e.impact}`:""]})]}),p&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Validation: ",p]}),c&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Why: ",c]}),d&&typeof d=="string"&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Impact: ",d]}),u&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Mitigation: ",u]}),f&&o.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",f]})]}):o.jsx("span",{style:{fontSize:13,color:"var(--text-secondary)"},children:Object.entries(e).map(([h,v],x)=>o.jsxs("span",{children:[x>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[Py(h),":"]})," ",typeof v=="string"?v:JSON.stringify(v)]},h))})}function Py(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function tT({projectId:e,projectCode:t,docTypeId:r,instanceId:n,onClose:s,inline:i}){var _,R,T,D;const[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(null),[v,x]=m.useState(null),[w,g]=m.useState(!0),[y,b]=m.useState(null);if(m.useEffect(()=>{async function $(){var E,L;try{g(!0),b(null),De.getDocumentPgc(e,r,n).then(P=>{P!=null&&P.has_pgc&&x(P)}).catch(()=>{});try{const P=await De.getDocumentRenderModel(e,r,n);if(P!=null&&P.metadata&&f(P.metadata),P!=null&&P.title&&h(P.title),(E=P==null?void 0:P.rendering_config)!=null&&E.detail_html){l(P),d(null);return}if(P&&P.sections&&P.sections.length>0){l(P),d(null);return}if((L=P==null?void 0:P.metadata)!=null&&L.fallback&&P.raw_content){l(null),d(P.raw_content);return}}catch(P){console.log("RenderModel not available, falling back to raw document:",P.message)}const A=await De.getDocument(e,r,n);l(null),d((A==null?void 0:A.content)||null)}catch(A){b(A.message),console.error("Failed to fetch document:",A)}finally{g(!1)}}$()},[e,r,n]),m.useEffect(()=>{if(i)return;const $=E=>{E.key==="Escape"&&s()};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[s,i]),w)return i?o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("div",{style:{color:"var(--text-muted)",fontSize:14},children:"Loading document..."})}):o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:o.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})});const j=(a==null?void 0:a.metadata)||u,k=j.execution_id,N=k?`/admin?execution=${k}`:"/admin";if(((_=a==null?void 0:a.rendering_config)==null?void 0:_.detail_html)&&a){const $=o.jsx(SB,{renderModel:a,projectId:e,projectCode:t,docTypeId:r,executionId:k,docTypeName:j.document_type_name,onClose:s});return i?o.jsx("div",{className:"w-full h-full overflow-hidden flex flex-col",style:{background:"var(--bg-canvas)"},children:$}):o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:E=>E.target===E.currentTarget&&s(),children:o.jsxs("div",{className:"relative w-full max-w-6xl h-[90vh] overflow-hidden rounded-lg shadow-2xl flex flex-col",style:{background:"var(--bg-canvas)"},children:[o.jsx("button",{onClick:s,className:"absolute top-2 right-3 z-10 p-1.5 rounded-lg hover:opacity-80 transition-colors",style:{background:"var(--bg-panel)"},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),$]})})}const C=o.jsxs(o.Fragment,{children:[o.jsx(TB,{title:(a==null?void 0:a.title)||p,projectCode:t,adminUrl:N,executionId:k,metadata:j,onClose:i?void 0:s}),((R=j==null?void 0:j.spawned_children)==null?void 0:R.count)>0&&o.jsx(AB,{children:j.spawned_children}),o.jsxs("div",{className:"overflow-y-auto p-6",style:i?{flex:1}:{maxHeight:((T=j==null?void 0:j.spawned_children)==null?void 0:T.count)>0?"calc(90vh - 130px)":"calc(90vh - 80px)"},onWheel:i?void 0:$=>$.stopPropagation(),children:[y&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-red-500",children:y})}),a&&o.jsx(Z4,{renderModel:a,variant:"full",hideHeader:!0}),c&&!a&&o.jsx(RB,{content:c,docTypeId:r}),!a&&!c&&!y&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"No content available"})}),v&&((D=v.clarifications)==null?void 0:D.length)>0&&o.jsx(MB,{pgcContext:v})]})]});return i?o.jsx("div",{className:"w-full h-full overflow-hidden flex flex-col",style:{background:"var(--bg-canvas)"},children:C}):o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:$=>$.target===$.currentTarget&&s(),children:o.jsx("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"var(--bg-canvas)"},children:C})})}function TB({title:e,projectCode:t,adminUrl:r,executionId:n,metadata:s,onClose:i}){const a=(()=>{if(!e)return"Document";const h=e.indexOf(": ");return h>-1?e.slice(h+2):e})(),l=(s==null?void 0:s.document_type_name)||(s!=null&&s.document_type?s.document_type.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase()):null),c=h=>{if(!h)return null;try{return new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},d=c(s==null?void 0:s.created_at),u=c(s==null?void 0:s.updated_at),f=s==null?void 0:s.version,p=s==null?void 0:s.lifecycle_state;return o.jsx("div",{className:"sticky top-0 px-6 py-4 border-b",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:6},children:[t&&o.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:n?`View execution ${n}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:t}),l&&o.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:l}),p&&o.jsx("span",{style:{padding:"2px 8px",background:p==="complete"?"#dcfce7":"#fef3c7",color:p==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:p}),f&&f>1&&o.jsxs("span",{style:{padding:"2px 8px",background:"var(--bg-button)",color:"var(--text-muted)",fontSize:11,fontWeight:600,borderRadius:4},children:["v",f]})]}),o.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"var(--text-primary)",lineHeight:1.3},children:a}),d&&o.jsxs("div",{style:{marginTop:4,fontSize:12,color:"var(--text-dim)"},children:["Generated ",d,u&&u!==d&&o.jsxs("span",{children:["  Updated ",u]})]})]}),o.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:opacity-80 transition-colors",style:{flexShrink:0,marginLeft:12},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})})}function AB({children:e}){const{count:t,items:r}=e;return o.jsxs("div",{className:"flex items-center gap-3 flex-wrap px-6 py-3",style:{background:"#f0fdf4",borderBottom:"1px solid #bbf7d0"},children:[o.jsxs("span",{style:{fontSize:13,color:"#166534",fontWeight:600},children:["This plan produced ",t," Epic document",t!==1?"s":""]}),o.jsx("div",{className:"flex items-center gap-1.5 flex-wrap",children:r.map(n=>o.jsx("span",{title:n.title||n.name,style:{padding:"2px 8px",background:"#dcfce7",color:"#15803d",fontSize:11,fontWeight:500,borderRadius:4,whiteSpace:"nowrap"},children:n.name||n.epic_id},n.epic_id))})]})}function RB({content:e,docTypeId:t}){if(!e)return o.jsx("p",{style:{color:"var(--text-muted)"},children:"No content available"});const r=e.project_name||e.title||e.name,n={preliminary_summary:{title:"Summary",icon:"S",color:"#7c3aed",render:"summary"},stakeholder_questions:{title:"Stakeholder Questions",icon:"?",color:"#dc2626",render:"questions"},unknowns:{title:"Unknowns to Resolve",icon:"?",color:"#d97706"},early_decision_points:{title:"Early Decision Points",icon:"D",color:"#7c3aed"},risks:{title:"Risks",icon:"!",color:"#dc2626"},known_constraints:{title:"Known Constraints",icon:"C",color:"var(--text-muted)"},assumptions:{title:"Assumptions",icon:"A",color:"#d97706"},mvp_guardrails:{title:"MVP Guardrails",icon:"G",color:"#059669"},recommendations_for_pm:{title:"Recommendations for PM",icon:"R",color:"#2563eb"},pgc_clarifications:{title:"PGC Clarifications",icon:"Q",color:"#7c3aed",render:"clarifications"}},s=new Set(["project_name","title","name","meta","description","summary"]),i=Object.keys(e).filter(l=>!s.has(l)&&(Array.isArray(e[l])||typeof e[l]=="object"&&e[l]!==null));return i.length>0?o.jsxs("div",{className:"space-y-6",children:[r&&o.jsxs("div",{style:{borderBottom:"2px solid var(--action-primary)",paddingBottom:12},children:[o.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--text-primary)"},children:r}),o.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-dim)"},children:t})]}),Object.entries(n).map(([l,c])=>{const d=e[l];return d?c.render==="summary"&&typeof d=="object"&&!Array.isArray(d)?o.jsx(IB,{data:d,config:c},l):c.render==="questions"&&Array.isArray(d)?o.jsx(PB,{data:d,config:c},l):c.render==="clarifications"&&Array.isArray(d)?o.jsx(OB,{data:d,config:c},l):Array.isArray(d)?o.jsx(a2,{data:d,config:c},l):null:null}),i.filter(l=>!n[l]).map(l=>{const c=e[l];return Array.isArray(c)?o.jsx(a2,{data:c,config:{title:oa(l),icon:"#",color:"var(--text-muted)"}},l):typeof c=="object"&&c!==null?o.jsx(LB,{data:c,label:oa(l)},l):null}),o.jsxs("details",{style:{borderRadius:8,border:"1px solid var(--border-node)"},children:[o.jsx("summary",{style:{padding:"12px 16px",cursor:"pointer",fontSize:13,fontWeight:600,color:"var(--text-muted)",background:"var(--bg-panel)",borderRadius:8},children:"Raw Data (JSON)"}),o.jsx("div",{style:{padding:16,overflow:"auto"},children:o.jsx("pre",{style:{margin:0,fontSize:11,color:"var(--text-secondary)",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(e,null,2)})})]})]}):o.jsx(zB,{content:e,docTypeId:t,title:r})}function IB({data:e,config:t}){const r=[{key:"problem_understanding",label:"Problem Understanding"},{key:"architectural_intent",label:"Architectural Intent"},{key:"proposed_system_shape",label:"Proposed System Shape"}];return o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8},children:[o.jsx(bu,{config:t}),o.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.map(n=>e[n.key]?o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:n.label}),o.jsx("p",{style:{fontSize:14,color:"var(--text-primary)",margin:0,lineHeight:1.6},children:e[n.key]})]},n.key):null),Object.entries(e).filter(([n])=>!r.some(s=>s.key===n)).map(([n,s])=>typeof s=="string"?o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:oa(n)}),o.jsx("p",{style:{fontSize:14,color:"var(--text-primary)",margin:0,lineHeight:1.6},children:s})]},n):null)]})]})}function PB({data:e,config:t}){const r=e.filter(s=>s.blocking),n=e.filter(s=>!s.blocking);return o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8},children:[o.jsx(bu,{config:t,count:e.length}),o.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#dc2626",marginBottom:8,textTransform:"uppercase"},children:"Blocking"}),r.map((s,i)=>o.jsx(i2,{q:s,borderColor:"#dc2626"},s.id||i))]}),n.length>0&&o.jsxs("div",{children:[r.length>0&&o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"var(--text-muted)",marginBottom:8,textTransform:"uppercase"},children:"Non-blocking"}),n.map((s,i)=>o.jsx(i2,{q:s,borderColor:"#d1d5db"},s.id||i))]})]})]})}function i2({q:e,borderColor:t}){return o.jsxs("div",{style:{borderLeft:`3px solid ${t}`,paddingLeft:12,marginBottom:8},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2},children:[e.id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"var(--text-dim)"},children:e.id}),e.directed_to&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"var(--bg-button)",borderRadius:4,color:"var(--text-muted)"},children:e.directed_to.replace(/_/g," ")})]}),o.jsx("p",{style:{fontSize:14,color:"var(--text-primary)",margin:0,fontWeight:500},children:e.question||e.text||FB(e)}),e.notes&&o.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"4px 0 0"},children:e.notes})]})}function OB({data:e,config:t}){const r={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}};return o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8},children:[o.jsx(bu,{config:t,count:e.length}),o.jsx("div",{style:{padding:16},className:"space-y-3",children:e.map((n,s)=>{const i=r[n.constraint_kind]||r.selection;return o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12,marginBottom:8},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[n.question_id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"var(--text-dim)"},children:n.question_id}),n.binding&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),n.constraint_kind&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:i.bg,color:i.color,borderRadius:4},children:n.constraint_kind}),n.binding_source&&o.jsxs("span",{style:{fontSize:10,color:"var(--text-dim)"},children:["via ",n.binding_source]})]}),o.jsx("p",{style:{fontSize:14,color:"var(--text-primary)",margin:"2px 0",fontWeight:500},children:n.question}),n.why_it_matters&&o.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"4px 0",fontStyle:"italic"},children:n.why_it_matters}),n.answer&&o.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[o.jsx("span",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),o.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:n.answer})]})]},n.question_id||s)})})]})}function MB({pgcContext:e}){const{clarifications:t}=e,r=t.filter(s=>s.binding),n=t.filter(s=>!s.binding);return o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8,marginTop:24},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid var(--border-node)"},children:[o.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:"#7c3aed15",color:"#7c3aed"},children:"Q"}),o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text-primary)"},children:"Pre-Generation Clarifications"}),o.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"var(--text-dim)"},children:t.length})]}),o.jsxs("div",{style:{padding:16},className:"space-y-4",children:[r.length>0&&o.jsxs("div",{children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#1e40af",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Binding Constraints (",r.length,")"]}),r.map((s,i)=>o.jsx(o2,{item:s},s.question_id||i))]}),n.length>0&&o.jsxs("div",{children:[r.length>0&&o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"var(--text-muted)",marginBottom:8,marginTop:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Informational (",n.length,")"]}),n.map((s,i)=>o.jsx(o2,{item:s},s.question_id||i))]})]})]})}function o2({item:e}){const t={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}},r=t[e.constraint_kind]||t.selection;return o.jsxs("div",{style:{borderLeft:`3px solid ${e.binding?"#3b82f6":"#d1d5db"}`,paddingLeft:12,marginBottom:12},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[e.question_id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"var(--text-dim)"},children:e.question_id}),e.binding&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),e.constraint_kind&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:r.bg,color:r.color,borderRadius:4},children:e.constraint_kind}),e.binding_source&&o.jsxs("span",{style:{fontSize:10,color:"var(--text-dim)"},children:["via ",e.binding_source]})]}),o.jsx("p",{style:{fontSize:14,color:"var(--text-primary)",margin:"2px 0",fontWeight:500},children:e.question}),e.why_it_matters&&o.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"4px 0",fontStyle:"italic"},children:e.why_it_matters}),e.answer&&o.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[o.jsx("span",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),o.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:e.answer})]})]})}function a2({data:e,config:t}){return!e||e.length===0?null:o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8},children:[o.jsx(bu,{config:t,count:e.length}),o.jsx("div",{style:{padding:16},children:o.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((r,n)=>o.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"var(--text-secondary)"},children:[o.jsx("span",{style:{color:t.color,marginTop:2,flexShrink:0,fontSize:12},children:t.icon==="!"?"":""}),o.jsx("div",{style:{flex:1},children:typeof r=="string"?o.jsx("span",{children:r}):typeof r=="object"&&r!==null?o.jsx(DB,{item:r}):o.jsx("span",{children:String(r)})})]},typeof r=="object"&&r.id||n))})})]})}function DB({item:e}){const r=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title"].find(h=>e[h]&&typeof e[h]=="string"),n=r?e[r]:null,s=e.id,i=e.confidence,a=e.constraint_type,l=e.validation_approach,c=e.impact_on_planning||e.impact_if_unresolved,d=e.mitigation_direction,u=e.likelihood,f=e.why_it_matters||e.why_early,p=e.recommendation_direction;return n?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"var(--text-dim)"},children:s}),o.jsx("span",{style:{fontWeight:500},children:n}),a&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"var(--bg-button)",borderRadius:4,color:"var(--text-muted)"},children:a}),i&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:i==="high"?"#dcfce7":i==="medium"?"#fef3c7":"#fee2e2",color:i==="high"?"#166534":i==="medium"?"#92400e":"#991b1b"},children:i}),u&&o.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[u,"/",e.impact||"?"]})]}),l&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Validation: ",l]}),f&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Why: ",f]}),c&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Impact: ",c]}),d&&o.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["Mitigation: ",d]}),p&&o.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",p]})]}):o.jsx("span",{style:{fontSize:13,color:"var(--text-secondary)"},children:Object.entries(e).map(([h,v],x)=>o.jsxs("span",{children:[x>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[oa(h),":"]})," ",typeof v=="string"?v:JSON.stringify(v)]},h))})}function LB({data:e,label:t}){return o.jsxs("div",{style:{background:"var(--bg-node)",border:"1px solid var(--border-node)",borderRadius:8},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-node)",fontWeight:600,fontSize:14,color:"var(--text-primary)"},children:t}),o.jsx("div",{style:{padding:16},children:Object.entries(e).map(([r,n])=>o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:oa(r)}),o.jsx("div",{style:{fontSize:14,color:"var(--text-primary)"},children:typeof n=="string"?n:typeof n=="object"?JSON.stringify(n,null,2):String(n)})]},r))})]})}function bu({config:e,count:t}){return o.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid var(--border-node)"},children:[o.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:`${e.color}15`,color:e.color},children:e.icon}),o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text-primary)"},children:e.title}),t!==void 0&&o.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"var(--text-dim)"},children:t})]})}function zB({content:e,docTypeId:t,title:r}){return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",o.jsx("strong",{children:t})," - displaying raw content"]}),r&&o.jsx("div",{style:{padding:16,background:"var(--bg-panel)",borderRadius:8,border:"1px solid var(--border-node)"},children:o.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:r})}),o.jsx("div",{style:{background:"var(--bg-panel)",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:o.jsx("pre",{style:{margin:0,fontSize:12,color:"var(--text-secondary)",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}function FB(e){if(typeof e=="string")return e;if(typeof e!="object"||e===null)return String(e);for(const t of Object.values(e))if(typeof t=="string"&&t.length>10)return t;return JSON.stringify(e)}function oa(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}const lx={PLANNED:"var(--state-ready-bg)",READY:"var(--state-stabilized-bg)",IN_PROGRESS:"var(--state-active-bg)",DONE:"var(--state-queued-bg)"};function $B(e){if(!e)return lx.PLANNED;const t=e.toUpperCase().replace(/ /g,"_");return lx[t]||lx.PLANNED}function qB(e){return e.wp_id||e.code||`WP-${String(e.sequence||"???").padStart(3,"0")}`}function BB({wps:e,selectedWpId:t,onSelectWp:r,onInsertPackage:n}){const[s,i]=m.useState(!1),[a,l]=m.useState(""),[c,d]=m.useState(!1),u=m.useCallback(async()=>{if(a.trim()){d(!0);try{await n(a.trim()),l(""),i(!1)}finally{d(!1)}}},[a,n]),f=m.useCallback(p=>{p.key==="Enter"&&u(),p.key==="Escape"&&(i(!1),l(""))},[u]);return o.jsxs("div",{className:"wb-index",children:[o.jsxs("div",{className:"wb-index-header",children:[o.jsx("span",{className:"wb-index-label",children:"PACKAGES"}),o.jsx("span",{className:"wb-index-count",children:e.length})]}),o.jsxs("div",{className:"wb-index-list",children:[e.length===0&&!s&&o.jsx("div",{className:"wb-index-empty",children:o.jsx("p",{children:"No work packages yet."})}),e.map(p=>{const h=p.id===t,v=$B(p.state);return o.jsxs("button",{className:`wb-index-item ${h?"wb-index-item--selected":""}`,onClick:()=>r(p.id),children:[o.jsx("div",{className:"wb-index-state-sliver",style:{backgroundColor:v},title:p.state||"PLANNED"}),o.jsxs("div",{className:"wb-index-item-content",children:[o.jsx("span",{className:"wb-index-item-id",children:qB(p)}),o.jsx("span",{className:"wb-index-item-title",children:p.title||"Untitled"})]})]},p.id)})]}),o.jsx("div",{className:"wb-index-footer",children:s?o.jsxs("div",{className:"wb-insert-form",children:[o.jsx("input",{type:"text",className:"wb-insert-input",placeholder:"Package title...",value:a,onChange:p=>l(p.target.value),onKeyDown:f,autoFocus:!0,disabled:c}),o.jsxs("div",{className:"wb-insert-actions",children:[o.jsx("button",{className:"wb-btn wb-btn--primary",onClick:u,disabled:c||!a.trim(),children:c?"CREATING...":"CREATE PACKAGE"}),o.jsx("button",{className:"wb-btn wb-btn--ghost",onClick:()=>{i(!1),l("")},disabled:c,children:"CANCEL"})]})]}):o.jsx("button",{className:"wb-btn wb-btn--outline wb-insert-btn",onClick:()=>i(!0),children:"INSERT PACKAGE"})})]})}const cx={DRAFT:{label:"DRAFT",cssVar:"--state-ready-bg"},STABILIZED:{label:"STABILIZED",cssVar:"--state-stabilized-bg"},IN_PROGRESS:{label:"IN PROGRESS",cssVar:"--state-active-bg"},BLOCKED:{label:"BLOCKED",cssVar:"--state-blocked-bg"},COMPLETE:{label:"COMPLETE",cssVar:"--state-stabilized-bg"}};function WB(e){if(!e)return cx.DRAFT;const t=e.toUpperCase().replace(/ /g,"_");return cx[t]||cx.DRAFT}function HB(e){return e.ws_id||e.code||`WS-${String(e.sequence||"???").padStart(3,"0")}`}async function UB(e,t){try{const r=await fetch(`/api/v1/work-binder/wp/${encodeURIComponent(t)}/work-statements`);if(!r.ok)throw new Error(`${r.status}`);const n=await r.json();return Array.isArray(n)?n:(n==null?void 0:n.items)||[]}catch(r){return console.warn("WorkView: WS fetch failed:",r.message),[]}}async function VB(e,t){const r=await fetch(`/api/v1/work-binder/wp/${encodeURIComponent(e)}/work-statements`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({intent:t})});if(!r.ok)throw new Error(`Failed to create WS: ${r.status}`);return r.json()}async function GB(e){const t=await fetch(`/api/v1/work-binder/work-statements/${encodeURIComponent(e)}/stabilize`,{method:"POST"});if(!t.ok)throw new Error(`Failed to stabilize WS: ${t.status}`);return t.json()}async function KB(e,t){const r=await fetch(`/api/v1/work-binder/wp/${encodeURIComponent(e)}/ws-index`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ws_ids:t})});if(!r.ok)throw new Error(`Failed to reorder: ${r.status}`);return r.json()}function YB({ws:e,isFocused:t,onFocus:r,onStabilize:n,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:l}){const c=WB(e.state),d=HB(e);return o.jsxs("div",{className:`wb-ws-sheet ${t?"wb-ws-sheet--focused":""}`,onClick:()=>r(e.id),children:[o.jsxs("div",{className:"wb-ws-sheet-header",children:[o.jsx("span",{className:"wb-mono wb-ws-id",children:d}),o.jsx("span",{className:"wb-ws-title",children:e.title||e.objective||"Untitled"}),o.jsx("span",{className:"wb-ws-badge",style:{backgroundColor:`var(${c.cssVar})`},children:c.label})]}),t&&o.jsxs("div",{className:"wb-ws-sheet-body",children:[e.objective&&o.jsx("p",{className:"wb-ws-objective",children:e.objective}),o.jsxs("div",{className:"wb-ws-sheet-actions",children:[e.state!=="STABILIZED"&&e.state!=="COMPLETE"&&o.jsx("button",{className:"wb-btn wb-btn--primary wb-btn--sm",onClick:u=>{u.stopPropagation(),n(e.id)},children:"STABILIZE STATEMENT"}),o.jsxs("div",{className:"wb-ws-reorder",children:[o.jsx("button",{className:"wb-btn wb-btn--ghost wb-btn--sm",onClick:u=>{u.stopPropagation(),s(e.id)},disabled:a,title:"Move up",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 19V5M5 12l7-7 7 7"})})}),o.jsx("button",{className:"wb-btn wb-btn--ghost wb-btn--sm",onClick:u=>{u.stopPropagation(),i(e.id)},disabled:l,title:"Move down",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 5v14M5 12l7 7 7-7"})})})]})]}),e.provenance&&o.jsx("div",{className:"wb-ws-provenance",children:o.jsxs("span",{className:"wb-mono",children:[e.provenance.source&&`SOURCE: ${e.provenance.source}`,e.provenance.authorization&&` | AUTH: ${e.provenance.authorization}`]})})]})]})}function QB({onSubmit:e}){const[t,r]=m.useState(""),[n,s]=m.useState(!1),i=m.useCallback(async()=>{if(t.trim()){s(!0);try{await e(t.trim()),r("")}finally{s(!1)}}},[t,e]);return o.jsxs("div",{className:"wb-ws-ghost",children:[o.jsx("span",{className:"wb-mono wb-ws-ghost-id",children:"WS-NEW:"}),o.jsx("input",{type:"text",className:"wb-ws-ghost-input",placeholder:"ENTER INTENT",value:t,onChange:a=>r(a.target.value),onKeyDown:a=>{a.key==="Enter"&&i()},disabled:n}),t.trim()&&o.jsx("button",{className:"wb-btn wb-btn--primary wb-btn--sm",onClick:i,disabled:n,children:n?"CREATING...":"CREATE STATEMENT"})]})}function XB({wp:e,projectId:t,onRefresh:r}){const[n,s]=m.useState([]),[i,a]=m.useState(!0),[l,c]=m.useState(null),[d,u]=m.useState(null),f=m.useCallback(async()=>{a(!0);const x=await UB(t,e.id);s(x),a(!1)},[t,e.id]);m.useEffect(()=>{f()},[f]);const p=m.useCallback(async x=>{try{await GB(x),await f()}catch(w){u("Stabilize failed: "+w.message)}},[f]),h=m.useCallback(async x=>{try{await VB(e.id,x),await f()}catch(w){u("Create failed: "+w.message)}},[e.id,f]),v=m.useCallback(async(x,w)=>{const g=n.findIndex(j=>j.id===x);if(g<0)return;const y=w==="up"?g-1:g+1;if(y<0||y>=n.length)return;const b=[...n];[b[g],b[y]]=[b[y],b[g]],s(b);try{await KB(e.id,b.map(j=>j.id))}catch(j){await f(),u("Reorder failed: "+j.message)}},[n,e.id,f]);return i?o.jsx("div",{className:"wb-work-loading",children:o.jsx("p",{style:{color:"var(--text-muted)",fontSize:13},children:"Loading work statements..."})}):o.jsxs("div",{className:"wb-work-view",children:[d&&o.jsxs("div",{className:"wb-error-inline",children:[o.jsx("span",{children:d}),o.jsx("button",{onClick:()=>u(null),children:""})]}),n.length===0&&o.jsx("div",{className:"wb-work-empty",children:o.jsx("p",{children:"No work statements yet. Use the ghost row below to create one."})}),o.jsx("div",{className:"wb-ws-list",children:n.map((x,w)=>o.jsx(YB,{ws:x,isFocused:l===x.id,onFocus:c,onStabilize:p,onMoveUp:g=>v(g,"up"),onMoveDown:g=>v(g,"down"),isFirst:w===0,isLast:w===n.length-1},x.id))}),o.jsx(QB,{onSubmit:h})]})}async function ZB(e){try{const t=await fetch(`/api/v1/work-binder/wp/${encodeURIComponent(e)}/history`);if(!t.ok)throw new Error(`${t.status}`);const r=await t.json();return Array.isArray(r)?r:(r==null?void 0:r.editions)||[]}catch(t){return console.warn("HistoryView: fetch failed:",t.message),[]}}function JB(e){if(!e)return"--";try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}}function e9({edition:e}){const t=e.change_summary||e.changes||[];return o.jsxs("div",{className:"wb-history-edition",children:[o.jsxs("div",{className:"wb-history-edition-header",children:[o.jsxs("span",{className:"wb-mono wb-history-edition-num",children:["Edition ",e.edition||e.version||"?"]}),o.jsx("span",{className:"wb-history-timestamp",children:JB(e.timestamp||e.created_at)}),e.updated_by&&o.jsx("span",{className:"wb-history-author",children:e.updated_by})]}),t.length>0&&o.jsx("ul",{className:"wb-history-changes",children:t.map((r,n)=>o.jsx("li",{className:"wb-history-change-item",children:typeof r=="string"?r:r.description||JSON.stringify(r)},n))})]})}function t9({wp:e,projectId:t}){const[r,n]=m.useState([]),[s,i]=m.useState(!0),a=m.useCallback(async()=>{i(!0);const l=await ZB(e.id);n(l),i(!1)},[e.id]);return m.useEffect(()=>{a()},[a]),s?o.jsx("div",{className:"wb-history-loading",children:o.jsx("p",{style:{color:"var(--text-muted)",fontSize:13},children:"Loading edition history..."})}):r.length===0?o.jsx("div",{className:"wb-history-empty",children:o.jsx("p",{children:"No edition history available for this work package."})}):o.jsx("div",{className:"wb-history-view",children:r.map((l,c)=>o.jsx(e9,{edition:l},l.id||c))})}function l2({label:e,value:t}){return!t&&t!==0&&t!==!1?null:o.jsxs("div",{className:"wb-gov-pin",children:[o.jsx("span",{className:"wb-gov-pin-label",children:e}),o.jsx("span",{className:"wb-gov-pin-value wb-mono",children:typeof t=="object"?JSON.stringify(t):String(t)})]})}function ux({title:e,children:t,empty:r}){return o.jsxs("div",{className:"wb-gov-section",children:[o.jsx("h4",{className:"wb-gov-section-title",children:e}),t||o.jsx("p",{className:"wb-gov-empty",children:r||"No data available."})]})}function r9({wp:e}){const t=e.governance_pins||e.governance||{},r=e.transformation||e.transform_metadata||null,n=e.source_candidate_ids||e.candidates||[],s=Object.keys(t).length>0;return o.jsxs("div",{className:"wb-governance-view",children:[o.jsx(ux,{title:"Governance Pins",empty:"No governance pins defined.",children:s&&o.jsx("div",{className:"wb-gov-pins-grid",children:Object.entries(t).map(([i,a])=>o.jsx(l2,{label:i,value:a},i))})}),o.jsx(ux,{title:"Transformation",empty:"No transformation metadata.",children:r&&o.jsxs("div",{className:"wb-gov-transform",children:[r.type&&o.jsx(l2,{label:"Type",value:r.type}),(r.transformation||r.description)&&o.jsx("p",{className:"wb-gov-transform-desc",children:r.transformation||r.description}),r.transformation_notes&&o.jsxs("div",{className:"wb-gov-transform-notes",children:[o.jsx("span",{className:"wb-gov-pin-label",children:"Notes"}),o.jsx("p",{children:r.transformation_notes})]})]})}),o.jsx(ux,{title:"Source Lineage",empty:"No source candidates linked.",children:n.length>0&&o.jsx("ul",{className:"wb-gov-candidates",children:n.map((i,a)=>o.jsx("li",{className:"wb-gov-candidate wb-mono",children:typeof i=="string"?i:i.id||JSON.stringify(i)},a))})})]})}const n9=["WORK","HISTORY","GOVERNANCE"];function s9(e){return e.wp_id||e.code||`WP-${String(e.sequence||"???").padStart(3,"0")}`}function i9({wp:e}){var r;const t=e.ta_component_id||((r=e.binding)==null?void 0:r.component_id)||null;return o.jsxs("div",{className:"wb-binding-block",children:[o.jsx("span",{className:"wb-binding-label",children:"TA COMPONENT"}),t?o.jsx("span",{className:"wb-binding-value wb-mono",children:t}):o.jsx("span",{className:"wb-binding-unbound",children:"Unbound"})]})}function o9({wp:e}){var n,s;const t=((n=e.provenance)==null?void 0:n.source)||e.source||"UNKNOWN",r=((s=e.provenance)==null?void 0:s.authorization)||e.authorization||"UNKNOWN";return o.jsx("div",{className:"wb-provenance",children:o.jsxs("span",{className:"wb-mono wb-provenance-text",children:["SOURCE: ",t," | AUTH: ",r]})})}function a9({wp:e,projectId:t,activeSubView:r,onChangeSubView:n,onRefresh:s}){return e?o.jsxs("div",{className:"wb-content-area",children:[o.jsxs("div",{className:"wb-content-header",children:[o.jsx("div",{className:"wb-content-header-top",children:o.jsxs("h3",{className:"wb-content-title",children:[o.jsx("span",{className:"wb-mono",children:s9(e)}),e.title&&o.jsx("span",{className:"wb-content-title-text",children:e.title})]})}),o.jsxs("div",{className:"wb-content-meta",children:[o.jsx(i9,{wp:e}),o.jsx(o9,{wp:e})]})]}),o.jsx("div",{className:"wb-tabs",children:n9.map(i=>o.jsx("button",{className:`wb-tab ${r===i?"wb-tab--active":""}`,onClick:()=>n(i),children:i},i))}),o.jsxs("div",{className:"wb-content-body",children:[r==="WORK"&&o.jsx(XB,{wp:e,projectId:t,onRefresh:s}),r==="HISTORY"&&o.jsx(t9,{wp:e,projectId:t}),r==="GOVERNANCE"&&o.jsx(r9,{wp:e})]})]}):o.jsx("div",{className:"wb-content-area",children:o.jsx("div",{className:"wb-content-empty",children:o.jsx("p",{children:"Select a work package to view its contents."})})})}async function l9(e){try{const t=await De.getWorkPackages?await De.getWorkPackages(e):await fetch(`/api/v1/work-binder/wp?project_id=${encodeURIComponent(e)}`).then(r=>{if(!r.ok)throw new Error(`${r.status}`);return r.json()});return Array.isArray(t)?t:(t==null?void 0:t.items)||[]}catch(t){return console.warn("WorkBinder: WP fetch failed, endpoint may not exist yet:",t.message),[]}}function c9({projectId:e,projectCode:t}){const[r,n]=m.useState([]),[s,i]=m.useState(!0),[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState("WORK"),p=m.useCallback(async()=>{i(!0),l(null);try{const w=await l9(e);n(w),!c&&w.length>0&&d(w[0].id)}catch(w){l(w.message)}finally{i(!1)}},[e,c]);m.useEffect(()=>{p()},[e]);const h=m.useCallback(w=>{d(w),f("WORK")},[]),v=m.useCallback(async w=>{try{const g=await fetch("/api/v1/work-binder/wp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:e,title:w})});if(!g.ok)throw new Error(`Failed to create WP: ${g.status}`);const y=await g.json();await p(),d(y.id)}catch(g){l("Failed to insert package: "+g.message)}},[e,p]),x=r.find(w=>w.id===c)||null;return s?o.jsx("div",{className:"wb-root",children:o.jsx("div",{className:"wb-loading",children:o.jsx("p",{style:{fontSize:14,color:"var(--text-muted)"},children:"Loading work binder..."})})}):o.jsxs("div",{className:"wb-root",children:[o.jsxs("div",{className:"wb-header",children:[o.jsx("h2",{className:"wb-header-title",children:"Work Binder"}),o.jsx("span",{className:"wb-header-project",children:t||"No Project"})]}),a&&o.jsxs("div",{className:"wb-error-banner",children:[o.jsx("p",{children:a}),o.jsx("button",{onClick:()=>l(null),className:"wb-error-dismiss",children:""})]}),o.jsxs("div",{className:"wb-layout",children:[o.jsx(BB,{wps:r,selectedWpId:c,onSelectWp:h,onInsertPackage:v}),o.jsx(a9,{wp:x,projectId:e,activeSubView:u,onChangeSubView:f,onRefresh:p})]})]})}const c2={GAP:8},In=["industrial","light","blueprint"],u9=400,d9=560;function f9({question:e,value:t,onChange:r}){const n=e.answer_type||"text",s=e.choices||[];if(n==="single_choice"&&s.length>0)return o.jsx("div",{className:"space-y-1.5",children:s.map(i=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"radio",name:e.id,value:i.value,checked:t===i.value,onChange:()=>r(i.value),className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:i.label})]},i.value))});if(n==="multi_choice"&&s.length>0){const i=Array.isArray(t)?t:[];return o.jsx("div",{className:"space-y-1.5",children:s.map(a=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"checkbox",checked:i.includes(a.value),onChange:l=>{l.target.checked?r([...i,a.value]):r(i.filter(c=>c!==a.value))},className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:a.label})]},a.value))})}return n==="boolean"?o.jsx("div",{className:"flex gap-3",children:[{label:"Yes",value:!0},{label:"No",value:!1}].map(i=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"radio",name:e.id,checked:t===i.value,onChange:()=>r(i.value),className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:i.label})]},String(i.value)))}):n==="number"?o.jsx("input",{type:"number",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:i=>r(i.target.value?Number(i.target.value):"")}):n==="free_text"||n==="long_text"?o.jsx("textarea",{className:"w-full rounded px-2 py-1.5 text-xs border resize-none",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)",minHeight:60},value:t||"",onChange:i=>r(i.target.value)}):o.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:i=>r(i.target.value)})}function p9({priority:e}){if(!e)return null;const t={must:{bg:"bg-red-500/20",text:"text-red-400"},should:{bg:"bg-amber-500/20",text:"text-amber-400"},could:{bg:"bg-blue-500/20",text:"text-blue-400"}},r=t[e]||t.should;return o.jsx("span",{className:`${r.bg} ${r.text} text-[8px] px-1.5 py-0.5 rounded uppercase font-semibold`,children:e})}function h9({questions:e,nodeWidth:t,onSubmit:r,onClose:n}){const[s,i]=m.useState({}),[a,l]=m.useState(!1),[c,d]=m.useState(!1),u=e.filter(x=>x.required).every(x=>{const w=s[x.id];return Array.isArray(w)?w.length>0:w!==void 0&&w!==""}),f=a?d9:u9,p=(x,w)=>{i(g=>({...g,[x]:w}))},h=async()=>{d(!0);try{await r(s)}catch(x){console.error("Submit failed:",x),d(!1)}},v=x=>x.stopPropagation();return o.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:t+c2.GAP,width:f,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",transition:"width 0.2s ease",userSelect:"text"},onMouseDown:v,onPointerDown:v,onWheel:v,children:[o.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:c2.GAP}}),o.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),o.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[o.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>l(!a),title:a?"Contract":"Expand",className:"hover:opacity-70 transition-opacity p-1",style:{color:"var(--text-sidecar-muted)"},children:a?o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),o.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]})]}),o.jsx("div",{className:`p-3 space-y-4 overflow-y-auto nowheel ${a?"max-h-[520px]":"max-h-[420px]"}`,children:e.map(x=>o.jsxs("div",{className:"pb-3",style:{borderBottom:"1px solid var(--border-input)"},children:[o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[o.jsxs("label",{className:"block text-[11px] font-medium",style:{color:"var(--text-sidecar)"},children:[x.text," ",x.required&&o.jsx("span",{className:"text-amber-500",children:"*"})]}),o.jsx(p9,{priority:x.priority})]}),x.why_it_matters&&o.jsx("p",{className:"text-[9px] mb-2 italic",style:{color:"var(--text-sidecar-muted)"},children:x.why_it_matters}),o.jsx(f9,{question:x,value:s[x.id],onChange:w=>p(x.id,w)})]},x.id))}),o.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:o.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${u&&!c?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!u||c,onClick:h,children:c?"Submitting...":"Submit & Continue"})})]})}function m9(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}function yc(e){if(!e)return"";const t={implementation_plan:"Implementation Plan",project_discovery:"Project Discovery",technical_architecture:"Technical Architecture",concierge_intake:"Concierge Intake"};return t[e]?t[e]:e.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}const rT={concierge_intake:"Structured intake document produced by the Concierge workflow. Contains synthesized intent, constraints, and gate outcomes from the intake conversation. First document in the pipeline.",project_discovery:"Early architectural discovery performed before PM decomposition. Surfaces critical questions, identifies constraints and risks, proposes candidate directions, and establishes guardrails.",implementation_plan:"Unified implementation plan produced from project discovery. Contains candidate Work Packages (advisory), risk analysis, and architecture recommendations. Candidates are promoted to governed WPs after TA review.",technical_architecture:"Comprehensive technical architecture including components, interfaces, data models, workflows, and quality attributes. Built after implementation plan, informs final planning.",work_package:"Unit of planned work with scope, governance pins, and completion criteria. Tracks dependencies, state, and child Work Statement references.",work_statement:"Unit of authorized execution within a Work Package. Defines objective, scope, procedure, verification criteria, prohibited actions, and allowed file paths."};function x9({step:e,onStartProduction:t}){const r=rT[e.id];return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-6",children:[o.jsxs("div",{className:"text-center max-w-md",children:[o.jsxs("div",{className:"w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center relative",children:[o.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:"var(--state-ready-bg)",opacity:.15}}),o.jsx("div",{className:"w-10 h-10 rounded-full relative",style:{background:"var(--state-ready-bg)"}})]}),o.jsx("h2",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:yc(e.id)}),r&&o.jsx("p",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:8},children:r}),o.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",lineHeight:1.6},children:"Ready to be produced. All prerequisite inputs are available."})]}),o.jsx("button",{className:"px-5 py-2.5 rounded-lg font-semibold transition-all hover:brightness-110",style:{fontSize:14,backgroundColor:"var(--state-ready-bg)",color:"white"},onClick:()=>t(e.id),children:"Start Production"})]})}function g9({step:e}){const t=e.blockedBy||[],r=rT[e.id];return o.jsx("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsxs("div",{className:"w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center relative",children:[o.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:"var(--state-blocked-bg)",opacity:.15}}),o.jsxs("svg",{className:"w-8 h-8 relative",viewBox:"0 0 24 24",fill:"none",stroke:"var(--state-blocked-bg)",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M15 9l-6 6M9 9l6 6"})]})]}),o.jsx("h2",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:yc(e.id)}),r&&o.jsx("p",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:8},children:r}),o.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",lineHeight:1.6},children:"Cannot be produced yet. Prerequisites are not met."}),t.length>0&&o.jsxs("div",{className:"mt-4 rounded-lg border-l-4 p-3",style:{borderColor:"var(--state-blocked-bg)",background:"var(--bg-node)"},children:[o.jsx("div",{className:"text-xs font-medium uppercase tracking-wider mb-1",style:{color:"var(--text-muted)"},children:"Waiting for"}),o.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)"},children:t.map(yc).join(", ")})]})]})})}function v9({step:e,onSubmitQuestions:t}){var s,i,a;const r=((s=e.questions)==null?void 0:s.length)>0,n=(i=e.stations)==null?void 0:i.some(l=>l.state==="active"&&l.needs_input);return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[o.jsxs("div",{className:"text-center max-w-md",children:[o.jsxs("div",{className:"w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center relative",children:[o.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:"var(--state-active-bg)",opacity:.15}}),o.jsxs("svg",{className:"w-8 h-8 relative",viewBox:"0 0 24 24",fill:"none",stroke:"var(--state-active-bg)",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M12 6v6l4 2"})]})]}),o.jsx("h2",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:yc(e.id)}),o.jsx("p",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6},children:n?"Production is waiting for your input.":"Production is in progress. Stations are executing."})]}),((a=e.stations)==null?void 0:a.length)>0&&o.jsxs("div",{className:"rounded-lg border p-4 w-full max-w-md",style:{background:"var(--bg-node)",borderColor:"var(--border-node)"},children:[o.jsx("div",{className:"text-xs font-medium uppercase tracking-wider mb-3",style:{color:"var(--text-muted)"},children:"Station Progress"}),o.jsx(lC,{stations:e.stations})]}),n&&r&&o.jsx("div",{className:"w-full max-w-lg",children:o.jsx(h9,{questions:e.questions,nodeWidth:500,onSubmit:l=>t(e.id,l),onClose:()=>{},inline:!0})})]})}function y9({step:e,projectId:t,projectCode:r,onStartProduction:n,onSubmitQuestions:s}){if(!e)return o.jsx("div",{className:"flex-1 flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("p",{style:{fontSize:14,color:"var(--text-muted)"},children:"Select a pipeline step to view details"})});if(e.isWorkBinder||e.id==="work_package")return o.jsx("div",{className:"flex-1 h-full overflow-y-auto",style:{background:"var(--bg-canvas)"},children:o.jsx(c9,{projectId:t,projectCode:r})});const i=m9(e.state||"ready_for_production");return i==="stabilized"?o.jsx("div",{className:"flex-1 h-full overflow-hidden",style:{background:"var(--bg-canvas)"},children:o.jsx(tT,{projectId:t,projectCode:r,docTypeId:e.id,instanceId:e.instanceId,onClose:()=>{},inline:!0})}):i==="in_progress"?o.jsx("div",{className:"flex-1 h-full overflow-y-auto",style:{background:"var(--bg-canvas)"},children:o.jsx(v9,{step:e,onSubmitQuestions:s})}):i==="blocked"?o.jsx("div",{className:"flex-1 h-full overflow-y-auto",style:{background:"var(--bg-canvas)"},children:o.jsx(g9,{step:e})}):o.jsx("div",{className:"flex-1 h-full overflow-y-auto",style:{background:"var(--bg-canvas)"},children:o.jsx(x9,{step:e,onStartProduction:n})})}const b9="/api/v1/admin";class w9 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function _9(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function ke(e,t={}){var i;const r=`${b9}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const a=_9();a&&(n.headers["X-CSRF-Token"]=a)}const s=await fetch(r,n);if(!s.ok){const a=await s.json().catch(()=>({})),l=((i=a.detail)==null?void 0:i.message)||a.detail||`Request failed: ${s.status}`;throw new w9(l,s.status,a.detail||a)}return s.status===204?null:s.json()}const ye={getCurrentWorkspace:async()=>{try{return await ke("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>ke("/workspaces",{method:"POST"}),getWorkspaceState:e=>ke(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>ke(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>ke(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>ke(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>ke(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return ke(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>ke(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>ke(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>ke("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return ke(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>ke(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>ke("/workbench/prompt-fragments"),getRoles:()=>ke("/workbench/roles"),getTemplates:()=>ke("/workbench/templates"),getSchemas:()=>ke("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return ke(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return ke(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return ke(`/workbench/templates/${e}${r}`)},getWorkflows:()=>ke("/workbench/workflows"),getOrchestrationWorkflows:()=>ke("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return ke(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>ke(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>ke(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>ke(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>ke(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>ke(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>ke(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>ke(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>ke(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>ke("/workbench/active-releases"),invalidateCache:()=>ke("/workbench/invalidate-cache",{method:"POST"}),getMechanicalOpTypes:()=>ke("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>ke(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>ke("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>ke("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const r=t?`?version=${t}`:"";return ke(`/workbench/mechanical-ops/${e}${r}`)}};function j9({projectId:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[i,a]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,v]=m.useState(!1),[x,w]=m.useState(null),[g,y]=m.useState(!1),[b,j]=m.useState(!1),k=m.useCallback(async()=>{try{const E=((await ye.getOrchestrationWorkflows()).workflows||[]).filter(A=>A.workflow_id!=="intake_and_route"),L=E.find(A=>A.workflow_id==="software_product_development")||E[0];if(L){const A=await De.createWorkflowInstance(e,L.workflow_id,L.active_version);r(A)}}catch($){console.error("Failed to auto-assign workflow:",$)}},[e]),N=m.useCallback(async()=>{if(e){s(!0),a(null);try{const $=await De.getWorkflowInstance(e);r($)}catch($){$.status===404?(r(null),await k()):a($.message)}finally{s(!1)}}},[e,k]);m.useEffect(()=>{N()},[N]);const S=async()=>{c(!0),p(!0);try{const E=((await ye.getOrchestrationWorkflows()).workflows||[]).filter(L=>L.workflow_id!=="intake_and_route");u(E)}catch{u([])}finally{p(!1)}},C=async $=>{v(!0);try{const E=await De.createWorkflowInstance(e,$.workflow_id,$.active_version);r(E),c(!1)}catch(E){a(E.message)}finally{v(!1)}},_=async()=>{if(t&&(j(!b),!x)){y(!0);try{const $=await De.getWorkflowDrift(e);w($)}catch($){w({error:$.message})}finally{y(!1)}}};if(n)return o.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(i&&!t)return o.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:i});if(!t)return o.jsxs("div",{className:"p-4",children:[o.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?o.jsx(S9,{workflows:d,loading:f,assigning:h,onSelect:C,onCancel:()=>c(!1)}):o.jsx("button",{onClick:S,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const R=t.effective_workflow||{},T=R.steps||[],D=t.base_workflow_ref||{};return o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:R.name||D.workflow_id||"Workflow"}),o.jsx(k9,{status:t.status})]}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",D.workflow_id," v",D.version,D.pow_class?` (${D.pow_class})`:""]})]}),o.jsx("button",{onClick:_,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:g?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&x&&o.jsx(N9,{drift:x}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",T.length,")"]}),T.length===0?o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):o.jsx("div",{className:"space-y-1",children:T.map(($,E)=>o.jsx(C9,{step:$,index:E},$.step_id||E))})]}),i&&o.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:i})]})}function S9({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:s}){const i=e.filter(l=>(l.pow_class||"reference")==="reference"),a=e.filter(l=>l.pow_class==="template");return o.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):o.jsxs(o.Fragment,{children:[i.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),i.map(l=>o.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[o.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),a.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),a.map(l=>o.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[o.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),i.length===0&&a.length===0&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),o.jsx("button",{onClick:s,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function k9({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function N9({drift:e}){return e.error?o.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):o.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[o.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[o.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),o.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&o.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&o.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&o.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&o.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&o.jsx("div",{children:"~ Metadata changed"})]})]})}function C9({step:e,index:t}){return o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),o.jsxs("div",{style:{flex:1},children:[o.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&o.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&o.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}const E9={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"};function T9(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1,metadata:r.metadata||{}};return t}function A9(e,t=[]){const r=[],n=[],s={};for(const i of e.tracks){const a=R9(i,t);if((i.scope||"project")==="project")n.push({...a,mayOwn:i.may_own||[],childDocType:i.child_doc_type});else{const c=i.document_type;s[c]||(s[c]=[]),s[c].push({...a,sequence:i.sequence})}}for(const i of n)i.childDocType&&s[i.childDocType]&&(i.children=s[i.childDocType].sort((a,l)=>(a.sequence??999)-(l.sequence??999)).map(a=>({...a,level:2,docTypeId:a.docTypeId,instanceId:a.instanceId}))),r.push(i);return r}function R9(e,t=[]){var a,l,c,d,u,f,p;const r=E9[e.state]||"ready_for_production";e.state;const n=t.find(h=>h.document_type===e.document_type);let s=null;e.stations&&e.stations.length>0&&(s=I9(e.stations,e.state,e.station));let i=null;if(n){const h=n.questions||((l=(a=n.payload)==null?void 0:a.data)==null?void 0:l.questions)||(Array.isArray((c=n.payload)==null?void 0:c.data)?n.payload.data:null);h&&Array.isArray(h)&&(i=h.map((v,x)=>({id:v.id||`q${x+1}`,text:v.question||v.text||v,required:v.required!==!1,choices:v.choices||null,answer_type:v.answer_type||"text",why_it_matters:v.why_it_matters||null,priority:v.priority||null,blocking:v.blocking!==!1,default:v.default||null,constraint_kind:v.constraint_kind||null})))}return{id:e.identifier||e.document_type,docTypeId:e.document_type,instanceId:e.instance_id||null,name:e.document_name||P9(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:s,questions:i,interruptId:n==null?void 0:n.id,blockedBy:e.blocked_by||[],ws_done:e.ws_done??((d=e.metadata)==null?void 0:d.ws_done)??0,ws_total:e.ws_total??((u=e.metadata)==null?void 0:u.ws_total)??0,mode_b_count:e.mode_b_count??((f=e.metadata)==null?void 0:f.mode_b_count)??0,dependencies:e.dependencies||[],workStatements:e.work_statements||((p=e.metadata)==null?void 0:p.work_statements)||[]}}function I9(e,t,r){return!e||e.length===0?null:e.map(n=>({id:n.station,label:n.label||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function P9(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function O9({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,s]=m.useState(!0),[i,a]=m.useState(null),l=m.useCallback(async()=>{s(!0),a(null);try{const d=await De.getProjects({includeArchived:e}),u=T9(d);r(u)}catch(d){a(d.message),console.error("Failed to fetch projects:",d)}finally{s(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await De.createProject({name:d,description:""});return r(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw a(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:i,addProject:c,refresh:l}}function M9(e){const[t,r]=m.useState([]),[n,s]=m.useState("idle"),[i,a]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(null),x=m.useRef(null),w=m.useRef(null),g=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[S,C]=await Promise.all([De.getProductionStatus(e),De.getProjectInterrupts(e).catch(()=>[])]);a(C),s(S.line_state),r(A9(S,C))}catch(S){u(S.message),console.error("Failed to fetch production status:",S)}finally{c(!1)}},[e]),y=m.useCallback(()=>{if(!e)return;x.current&&x.current.close();const S=O5(e);x.current=S,S.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),S.addEventListener("station_transition",C=>{try{const _=JSON.parse(C.data);console.log("Station transition:",_),g()}catch(_){console.error("Failed to parse station_transition:",_)}}),S.addEventListener("line_stopped",C=>{try{const _=JSON.parse(C.data);console.log("Line stopped:",_),s("stopped"),g()}catch(_){console.error("Failed to parse line_stopped:",_)}}),S.addEventListener("production_complete",C=>{try{const _=JSON.parse(C.data);console.log("Production complete:",_),s("complete"),g()}catch(_){console.error("Failed to parse production_complete:",_)}}),S.addEventListener("interrupt_resolved",C=>{try{const _=JSON.parse(C.data);console.log("Interrupt resolved:",_),g()}catch(_){console.error("Failed to parse interrupt_resolved:",_)}}),S.addEventListener("track_started",C=>{try{const _=JSON.parse(C.data);console.log("Track started:",_),s("active"),g()}catch(_){console.error("Failed to parse track_started:",_)}}),S.addEventListener("track_stabilized",C=>{try{const _=JSON.parse(C.data);console.log("Track stabilized:",_),g()}catch(_){console.error("Failed to parse track_stabilized:",_)}}),S.addEventListener("children_updated",C=>{try{const _=JSON.parse(C.data);console.log("Children updated:",_),g()}catch(_){console.error("Failed to parse children_updated:",_)}}),S.addEventListener("stations_declared",C=>{try{const _=JSON.parse(C.data);console.log("Stations declared:",_);const{document_type:R,stations:T}=_;r(D=>{const $=D.some(L=>L.id===R);console.log("stations_declared raw stations:",T);const E=T.map(L=>({id:L.id,label:L.label,state:L.state,phases:L.phases||[],phase:null}));return console.log("stations_declared processed:",E),$?D.map(L=>L.id===R?{...L,state:"in_production",stations:E}:L):[...D,{id:R,name:R.replace(/_/g," ").replace(/\b\w/g,L=>L.toUpperCase()),state:"in_production",stations:E}]})}catch(_){console.error("Failed to parse stations_declared:",_)}}),S.addEventListener("station_changed",C=>{try{const _=JSON.parse(C.data);console.log("Station changed:",_);const{document_type:R,station_id:T,state:D}=_;r($=>$.map(E=>E.id!==R||!E.stations?E:{...E,stations:E.stations.map(L=>L.id===T?{...L,state:D}:L)}))}catch(_){console.error("Failed to parse station_changed:",_)}}),S.addEventListener("internal_step",C=>{try{const _=JSON.parse(C.data);console.log("Internal step:",_);const{document_type:R,station_id:T,step:D}=_;r($=>$.map(E=>E.id!==R||!E.stations?E:{...E,stations:E.stations.map(L=>L.id===T?{...L,currentStep:D}:L)}))}catch(_){console.error("Failed to parse internal_step:",_)}}),S.onerror=C=>{console.error("SSE error:",C),p(!1),u("Connection lost"),S.close(),w.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),y()},3e3)}},[e,g]),b=m.useCallback(()=>{w.current&&clearTimeout(w.current),x.current&&(x.current.close(),x.current=null),p(!1)},[]),j=m.useCallback(async(S,C)=>{try{await De.resolveInterrupt(S,{answers:C})}catch(_){throw console.error("Failed to resolve interrupt:",_),_}},[]),k=m.useCallback(async(S=null)=>{var C;try{v(null),await De.startProduction(e,S),s("active")}catch(_){console.error("Failed to start production:",_);const R=((C=_.data)==null?void 0:C.message)||_.message||"Failed to start production";throw v({type:"error",message:R}),S&&r(T=>T.map(D=>D.id===S?{...D,state:"ready_for_production",stations:null}:D)),s("idle"),g(),_}},[e,g]),N=m.useCallback(()=>{v(null)},[]);return m.useEffect(()=>(g(),y(),()=>b()),[g,y,b]),{data:t,lineState:n,interrupts:i,loading:l,error:d,connected:f,notification:h,dismissNotification:N,refresh:g,resolveInterrupt:j,startProduction:k}}const u2="combine-theme";function nT(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const i=localStorage.getItem(u2);return i&&In.includes(i)?i:e});m.useEffect(()=>{localStorage.setItem(u2,t)},[t]);const n=m.useCallback(i=>{In.includes(i)&&r(i)},[]),s=m.useCallback(()=>{r(i=>{const a=In.indexOf(i);return In[(a+1)%In.length]})},[]);return{theme:t,setTheme:n,cycleTheme:s}}function D9(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[s,i]=m.useState([]),[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[v,x]=m.useState([]),[w,g]=m.useState(!1),[y,b]=m.useState(null),[j,k]=m.useState(null),[N,S]=m.useState(null),[C,_]=m.useState(!1),[R,T]=m.useState(!1),[D,$]=m.useState(null),[E,L]=m.useState(null),[A,P]=m.useState(null),M=m.useRef(null),I=m.useRef(null),O=m.useRef(!0);m.useEffect(()=>(O.current=!0,()=>{O.current=!1,M.current&&M.current.close()}),[]);const F=m.useCallback(Q=>{O.current&&(n(Q.phase),i(Q.messages||[]),l(Q.pending_prompt),d(Q.pending_choices),f(Q.interpretation||{}),h(Q.confidence||0),x(Q.missing_fields||[]),g(Q.can_initialize||!1),b(Q.gate_outcome),k(Q.project),$(Q.intake_classification),L(Q.intake_gate_phase),P(Q.operational_error||null))},[]),q=m.useCallback(async()=>{S(null),_(!0);try{const Q=await De.startIntake();if(!O.current)return;t(Q.execution_id),F(Q)}catch(Q){if(!O.current)return;S(Q.message||"Failed to start intake")}finally{O.current&&_(!1)}},[]),U=m.useCallback(async Q=>{if(!e||!Q.trim())return;S(null),P(null),T(!0),I.current=Q;const H={role:"user",content:Q};i(ie=>[...ie,H]);try{const ie=await De.submitIntakeMessage(e,Q);if(!O.current)return;F(ie)}catch(ie){if(!O.current)return;i(ae=>ae.filter(pe=>pe!==H)),S(ie.message||"Failed to submit message")}finally{O.current&&T(!1)}},[e,F]),G=m.useCallback(async()=>{I.current&&(P(null),await U(I.current))},[U]),J=m.useCallback(async(Q,H)=>{if(e){S(null),f(ie=>({...ie,[Q]:{value:H,source:"user",locked:!0}}));try{const ie=await De.updateIntakeField(e,Q,H);if(!O.current)return;F(ie)}catch(ie){if(!O.current)return;S(ie.message||"Failed to update field");const ae=await De.getIntakeState(e);O.current&&F(ae)}}},[e,F]),B=m.useCallback(async()=>{if(!(!e||!w)){S(null),_(!0);try{const Q=await De.initializeIntake(e);if(!O.current)return;F(Q),Q.phase==="generating"&&te()}catch(Q){if(!O.current)return;S(Q.message||"Failed to initialize project"),_(!1)}}},[e,w,F]),te=m.useCallback(()=>{M.current&&M.current.close();const Q=M5(e);M.current=Q,Q.addEventListener("started",H=>{if(!O.current)return;const ie=JSON.parse(H.data);console.log("Intake started:",ie)}),Q.addEventListener("progress",H=>{if(!O.current)return;const ie=JSON.parse(H.data);console.log("Intake progress:",ie.current_node)}),Q.addEventListener("complete",async H=>{if(!O.current)return;const ie=JSON.parse(H.data);console.log("Intake complete:",ie),Q.close(),M.current=null,n("complete"),b(ie.gate_outcome),k(ie.project),_(!1)}),Q.addEventListener("error",H=>{if(O.current&&Q.readyState!==EventSource.CLOSED){try{const ie=JSON.parse(H.data);S(ie.message||"Generation failed")}catch{S("Connection lost during generation")}Q.close(),M.current=null,_(!1)}}),Q.onerror=()=>{O.current&&Q.readyState===EventSource.CLOSED&&(M.current=null,_(!1))}},[e]),oe=m.useCallback(()=>{M.current&&(M.current.close(),M.current=null),t(null),n("idle"),i([]),l(null),d(null),f({}),h(0),x([]),g(!1),b(null),k(null),S(null),_(!1),T(!1),P(null),I.current=null},[]);return{executionId:e,phase:r,messages:s,pendingPrompt:a,pendingChoices:c,interpretation:u,confidence:p,missingFields:v,canInitialize:w,gateOutcome:y,project:j,error:N,loading:C,submitting:R,intakeClassification:D,intakeGatePhase:E,operationalError:A,startIntake:q,submitMessage:U,updateField:J,lockAndGenerate:B,retryLastMessage:G,reset:oe}}const sT=m.createContext(null);function L9({children:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[i,a]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{s(!0),a(null);try{const f=await De.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),a(f.message),r(null)}finally{s(!1)}},[]),c=m.useCallback(f=>{window.location.href=D5(f)},[]),d=m.useCallback(async()=>{try{await De.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),u={user:t,loading:n,error:i,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return o.jsx(sT.Provider,{value:u,children:e})}function Ps(){const e=m.useContext(sT);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function z9(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null),c=m.useCallback(async()=>{i(!0),l(null);try{let u=await ye.getCurrentWorkspace();u||(u=await ye.createWorkspace()),t(u.workspace_id),n(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{i(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await ye.closeWorkspace(e,u),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:s,error:a,closeWorkspace:d,reinitialize:c}}function F9(e,t=1e4){var u,f;const[r,n]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){n(null),i(!1);return}try{const p=await ye.getWorkspaceState(e);n(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{i(!1)}},[e]);return m.useEffect(()=>{e&&(i(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:r,loading:s,error:a,refresh:d,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((u=r==null?void 0:r.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function $9(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await ye.getDocumentTypes();t(l.document_types||[])}catch(l){i(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{documentTypes:e,loading:r,error:s,refresh:a}}function q9(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await ye.getRoles();t(l.roles||[])}catch(l){i(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{roles:e,loading:r,error:s,refresh:a}}function Ca(e,t,{debounceMs:r=500,onSave:n}={}){const[s,i]=m.useState(""),[a,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,x]=m.useState(null),w=m.useRef(null),g=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){i(""),l(""),d(!1);return}d(!0),f(null);try{const C=await ye.getArtifact(e,t);i(C.content),l(C.content)}catch(C){f(C.message),console.error("Failed to load artifact:",C)}finally{d(!1)}},[e,t]),b=m.useCallback(async C=>{if(!(!e||!t)){h(!0),f(null);try{const _=await ye.writeArtifact(e,t,C);x(_),l(C),n&&n(_)}catch(_){f(_.message),console.error("Failed to save artifact:",_)}finally{h(!1)}}},[e,t,n]),j=m.useCallback(C=>{g.current=C,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),k=m.useCallback(C=>{i(C),C!==a&&j(C)},[a,j]),N=m.useCallback(()=>{w.current&&clearTimeout(w.current),g.current=null,i(a)},[a]),S=m.useCallback(()=>{w.current&&clearTimeout(w.current),s!==a&&b(s)},[s,a,b]);return m.useEffect(()=>(y(),()=>{w.current&&clearTimeout(w.current)}),[y]),{content:s,originalContent:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateContent:k,reset:N,saveNow:S,reload:y}}const B9={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function W9({projectId:e,projectCode:t,projectName:r,isArchived:n,savedLayout:s,autoExpandNodeId:i,theme:a,onThemeChange:l,onProjectUpdate:c,onProjectArchive:d,onProjectUnarchive:u,onProjectDelete:f}){const{data:p,lineState:h,loading:v,error:x,connected:w,notification:g,dismissNotification:y,resolveInterrupt:b,startProduction:j}=M9(e),[k,N]=m.useState([]),[S,C]=m.useState(null),[_,R]=m.useState(null),[T,D]=m.useState(!1),[$,E]=m.useState(""),[L,A]=m.useState(!1),[P,M]=m.useState(!1),[I,O]=m.useState(!1);m.useEffect(()=>{p.length>0&&N(p)},[p]),m.useEffect(()=>{if(k.length>0&&!S){const H=k.find(ie=>(ie.level||1)===1);H&&C(H.id)}},[k,S]),m.useEffect(()=>{C(null)},[e]);const F=m.useCallback(()=>{const H=In.indexOf(a);l(In[(H+1)%In.length])},[a,l]),q=m.useCallback(()=>{E(r||""),D(!0)},[r]),U=m.useCallback(async()=>{if(!$.trim()||$===r){D(!1);return}M(!0);try{await c(e,{name:$.trim()}),D(!1)}catch(H){console.error("Failed to update name:",H)}finally{M(!1)}},[$,r,e,c]),G=m.useCallback(()=>{D(!1),E("")},[]),J=m.useCallback(async()=>{M(!0);try{n?await u(e):await d(e)}catch(H){console.error("Failed to toggle archive:",H)}finally{M(!1)}},[e,n,d,u]),B=m.useCallback(async()=>{M(!0);try{await f(e),A(!1)}catch(H){console.error("Failed to delete:",H)}finally{M(!1)}},[e,f]),te=m.useCallback(async H=>{console.log("Starting production for:",H),N(ie=>ie.map(ae=>ae.id===H?{...ae,_prevState:ae.state,state:"in_production"}:ae));try{await j(H)}catch{N(ae=>ae.map(pe=>pe.id===H?{...pe,state:pe._prevState||"ready_for_production",stations:null}:pe))}},[j]),oe=m.useCallback(async(H,ie)=>{console.log("Submitted:",H,ie),N(pe=>{const me=le=>le.map(V=>V.id===H&&V.stations?{...V,state:"in_production",stations:V.stations.map(ee=>ee.id==="pgc"?{...ee,state:"complete",needs_input:!1}:ee.id==="asm"?{...ee,state:"active"}:ee)}:V.children?{...V,children:me(V.children)}:V);return me(pe)});const ae=k.find(pe=>pe.id===H);if(ae!=null&&ae.interruptId)try{await b(ae.interruptId,ie)}catch(pe){console.error("Failed to submit answers:",pe)}},[k,b]),Q=m.useMemo(()=>{var ie;if(!S)return null;const H=k.find(ae=>ae.id===S&&(ae.level||1)===1);if(H)return H;for(const ae of k){const pe=(ie=ae.children)==null?void 0:ie.find(me=>me.id===S);if(pe)return pe}return null},[k,S]);return v&&k.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):x&&k.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:o.jsx("p",{className:"text-red-500 mb-4",children:x})})}):o.jsxs("div",{className:"w-full h-full flex",children:[o.jsxs("div",{className:"flex flex-col flex-shrink-0",style:{width:320,borderRight:"1px solid var(--border-panel)",background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"space-y-2 p-3",style:{flexShrink:0},children:[o.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),o.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[h==="active"&&o.jsx("span",{className:"text-amber-500",children:" Active"}),h==="stopped"&&o.jsx("span",{className:"text-red-500",children:" Stopped"}),h==="complete"&&o.jsx("span",{className:"text-emerald-500",children:" Complete"}),h==="idle"&&o.jsx("span",{children:" Idle"}),!w&&o.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),o.jsx("button",{onClick:F,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:B9[a]})]})}),o.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:o.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),T?o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("input",{type:"text",value:$,onChange:H=>E(H.target.value),onKeyDown:H=>{H.key==="Enter"&&U(),H.key==="Escape"&&G()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:P}),o.jsx("button",{onClick:U,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Save",children:o.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})}),o.jsx("button",{onClick:G,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:o.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):o.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!T&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:q,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),o.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),o.jsx("button",{onClick:J,disabled:P,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:o.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&o.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),o.jsx("button",{onClick:()=>A(!0),disabled:P||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:o.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),o.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[o.jsxs("button",{onClick:()=>O(!I),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[o.jsx("span",{children:"Workflow"}),o.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:I?"":""})]}),I&&o.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:o.jsx(j9,{projectId:e})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:o.jsx(R5,{data:k,selectedNodeId:S,onSelectNode:C,theme:a})}),o.jsx("div",{className:"subway-panel border-t px-4 py-2",style:{flexShrink:0},children:o.jsxs("div",{className:"flex flex-wrap gap-3 text-[10px]",children:[o.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Stabilized"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{background:"var(--state-ready-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{background:"var(--state-active-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"In Progress"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{background:"var(--state-blocked-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Blocked"})]})]})})]}),o.jsx(y9,{step:Q,projectId:e,projectCode:t,onStartProduction:te,onSubmitQuestions:oe}),g&&o.jsxs("div",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 px-5 py-3 rounded-lg shadow-lg border",style:{background:g.type==="error"?"#fef2f2":"#f0fdf4",borderColor:g.type==="error"?"#fecaca":"#bbf7d0",maxWidth:500,animation:"fadeIn 0.2s ease-out"},children:[o.jsx("span",{style:{fontSize:18,color:g.type==="error"?"#dc2626":"#16a34a",flexShrink:0},children:g.type==="error"?"":""}),o.jsx("span",{style:{fontSize:13,color:"#1f2937",lineHeight:1.4},children:g.message}),o.jsx("button",{onClick:y,style:{marginLeft:"auto",background:"none",border:"none",color:"#9ca3af",fontSize:18,cursor:"pointer",padding:"0 2px",lineHeight:1,flexShrink:0},children:""})]}),_&&o.jsx(tT,{projectId:e,projectCode:t,docTypeId:typeof _=="object"?_.docTypeId:_,instanceId:typeof _=="object"?_.instanceId:void 0,onClose:()=>R(null)}),L&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:o.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),o.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",o.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),o.jsxs("div",{className:"flex gap-3 justify-end",children:[o.jsx("button",{onClick:()=>A(!1),disabled:P,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),o.jsx("button",{onClick:B,disabled:P,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:P?"Deleting...":"Delete"})]})]})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function iT(e){return typeof e>"u"||e===null}function H9(e){return typeof e=="object"&&e!==null}function U9(e){return Array.isArray(e)?e:iT(e)?[]:[e]}function V9(e,t){var r,n,s,i;if(t)for(i=Object.keys(t),r=0,n=i.length;r<n;r+=1)s=i[r],e[s]=t[s];return e}function G9(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function K9(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var Y9=iT,Q9=H9,X9=U9,Z9=G9,J9=K9,eW=V9,dt={isNothing:Y9,isObject:Q9,toArray:X9,repeat:Z9,isNegativeZero:J9,extend:eW};function oT(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function aa(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=oT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}aa.prototype=Object.create(Error.prototype);aa.prototype.constructor=aa;aa.prototype.toString=function(t){return this.name+": "+oT(this,t)};var Lt=aa;function dx(e,t,r,n,s){var i="",a="",l=Math.floor(s/2)-1;return n-t>l&&(i=" ... ",t=n-l+i.length),r-n>l&&(a=" ...",r=n+l-a.length),{str:i+e.slice(t,r).replace(/\t/g,"")+a,pos:n-t+i.length}}function fx(e,t){return dt.repeat(" ",t-e.length)+e}function tW(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],s=[],i,a=-1;i=r.exec(e.buffer);)s.push(i.index),n.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=n.length-2);a<0&&(a=n.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,s.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(a-c<0);c++)d=dx(e.buffer,n[a-c],s[a-c],e.position-(n[a]-n[a-c]),f),l=dt.repeat(" ",t.indent)+fx((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=dx(e.buffer,n[a],s[a],e.position,f),l+=dt.repeat(" ",t.indent)+fx((e.line+1).toString(),u)+" | "+d.str+`
`,l+=dt.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(a+c>=s.length);c++)d=dx(e.buffer,n[a+c],s[a+c],e.position-(n[a]-n[a+c]),f),l+=dt.repeat(" ",t.indent)+fx((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var rW=tW,nW=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],sW=["scalar","sequence","mapping"];function iW(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function oW(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(nW.indexOf(r)===-1)throw new Lt('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=iW(t.styleAliases||null),sW.indexOf(this.kind)===-1)throw new Lt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var kt=oW;function d2(e,t){var r=[];return e[t].forEach(function(n){var s=r.length;r.forEach(function(i,a){i.tag===n.tag&&i.kind===n.kind&&i.multi===n.multi&&(s=a)}),r[s]=n}),r}function aW(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Bg(e){return this.extend(e)}Bg.prototype.extend=function(t){var r=[],n=[];if(t instanceof kt)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new Lt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(i){if(!(i instanceof kt))throw new Lt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Lt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Lt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(i){if(!(i instanceof kt))throw new Lt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Bg.prototype);return s.implicit=(this.implicit||[]).concat(r),s.explicit=(this.explicit||[]).concat(n),s.compiledImplicit=d2(s,"implicit"),s.compiledExplicit=d2(s,"explicit"),s.compiledTypeMap=aW(s.compiledImplicit,s.compiledExplicit),s};var aT=Bg,lT=new kt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),cT=new kt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),uT=new kt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),dT=new aT({explicit:[lT,cT,uT]});function lW(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function cW(){return null}function uW(e){return e===null}var fT=new kt("tag:yaml.org,2002:null",{kind:"scalar",resolve:lW,construct:cW,predicate:uW,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function dW(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function fW(e){return e==="true"||e==="True"||e==="TRUE"}function pW(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var pT=new kt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:dW,construct:fW,predicate:pW,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function hW(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function mW(e){return 48<=e&&e<=55}function xW(e){return 48<=e&&e<=57}function gW(e){if(e===null)return!1;var t=e.length,r=0,n=!1,s;if(!t)return!1;if(s=e[r],(s==="-"||s==="+")&&(s=e[++r]),s==="0"){if(r+1===t)return!0;if(s=e[++r],s==="b"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(s!=="0"&&s!=="1")return!1;n=!0}return n&&s!=="_"}if(s==="x"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!hW(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}if(s==="o"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!mW(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}}if(s==="_")return!1;for(;r<t;r++)if(s=e[r],s!=="_"){if(!xW(e.charCodeAt(r)))return!1;n=!0}return!(!n||s==="_")}function vW(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function yW(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!dt.isNegativeZero(e)}var hT=new kt("tag:yaml.org,2002:int",{kind:"scalar",resolve:gW,construct:vW,predicate:yW,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),bW=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function wW(e){return!(e===null||!bW.test(e)||e[e.length-1]==="_")}function _W(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var jW=/^[-+]?[0-9]+e/;function SW(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(dt.isNegativeZero(e))return"-0.0";return r=e.toString(10),jW.test(r)?r.replace("e",".e"):r}function kW(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||dt.isNegativeZero(e))}var mT=new kt("tag:yaml.org,2002:float",{kind:"scalar",resolve:wW,construct:_W,predicate:kW,represent:SW,defaultStyle:"lowercase"}),xT=dT.extend({implicit:[fT,pT,hT,mT]}),gT=xT,vT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),yT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function NW(e){return e===null?!1:vT.exec(e)!==null||yT.exec(e)!==null}function CW(e){var t,r,n,s,i,a,l,c=0,d=null,u,f,p;if(t=vT.exec(e),t===null&&(t=yT.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(r,n,s));if(i=+t[4],a=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(r,n,s,i,a,l,c)),d&&p.setTime(p.getTime()-d),p}function EW(e){return e.toISOString()}var bT=new kt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:NW,construct:CW,instanceOf:Date,represent:EW});function TW(e){return e==="<<"||e===null}var wT=new kt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:TW}),Oy=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function AW(e){if(e===null)return!1;var t,r,n=0,s=e.length,i=Oy;for(r=0;r<s;r++)if(t=i.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function RW(e){var t,r,n=e.replace(/[\r\n=]/g,""),s=n.length,i=Oy,a=0,l=[];for(t=0;t<s;t++)t%4===0&&t&&(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)),a=a<<6|i.indexOf(n.charAt(t));return r=s%4*6,r===0?(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)):r===18?(l.push(a>>10&255),l.push(a>>2&255)):r===12&&l.push(a>>4&255),new Uint8Array(l)}function IW(e){var t="",r=0,n,s,i=e.length,a=Oy;for(n=0;n<i;n++)n%3===0&&n&&(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]),r=(r<<8)+e[n];return s=i%3,s===0?(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]):s===2?(t+=a[r>>10&63],t+=a[r>>4&63],t+=a[r<<2&63],t+=a[64]):s===1&&(t+=a[r>>2&63],t+=a[r<<4&63],t+=a[64],t+=a[64]),t}function PW(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var _T=new kt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:AW,construct:RW,predicate:PW,represent:IW}),OW=Object.prototype.hasOwnProperty,MW=Object.prototype.toString;function DW(e){if(e===null)return!0;var t=[],r,n,s,i,a,l=e;for(r=0,n=l.length;r<n;r+=1){if(s=l[r],a=!1,MW.call(s)!=="[object Object]")return!1;for(i in s)if(OW.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}function LW(e){return e!==null?e:[]}var jT=new kt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:DW,construct:LW}),zW=Object.prototype.toString;function FW(e){if(e===null)return!0;var t,r,n,s,i,a=e;for(i=new Array(a.length),t=0,r=a.length;t<r;t+=1){if(n=a[t],zW.call(n)!=="[object Object]"||(s=Object.keys(n),s.length!==1))return!1;i[t]=[s[0],n[s[0]]]}return!0}function $W(e){if(e===null)return[];var t,r,n,s,i,a=e;for(i=new Array(a.length),t=0,r=a.length;t<r;t+=1)n=a[t],s=Object.keys(n),i[t]=[s[0],n[s[0]]];return i}var ST=new kt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:FW,construct:$W}),qW=Object.prototype.hasOwnProperty;function BW(e){if(e===null)return!0;var t,r=e;for(t in r)if(qW.call(r,t)&&r[t]!==null)return!1;return!0}function WW(e){return e!==null?e:{}}var kT=new kt("tag:yaml.org,2002:set",{kind:"mapping",resolve:BW,construct:WW}),My=gT.extend({implicit:[bT,wT],explicit:[_T,jT,ST,kT]}),Qn=Object.prototype.hasOwnProperty,bc=1,NT=2,CT=3,wc=4,px=1,HW=2,f2=3,UW=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,VW=/[\x85\u2028\u2029]/,GW=/[,\[\]\{\}]/,ET=/^(?:!|!!|![a-z\-]+!)$/i,TT=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function p2(e){return Object.prototype.toString.call(e)}function Ur(e){return e===10||e===13}function vs(e){return e===9||e===32}function Ut(e){return e===9||e===32||e===10||e===13}function si(e){return e===44||e===91||e===93||e===123||e===125}function KW(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function YW(e){return e===120?2:e===117?4:e===85?8:0}function QW(e){return 48<=e&&e<=57?e-48:-1}function h2(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function XW(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function AT(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var RT=new Array(256),IT=new Array(256);for(var Fs=0;Fs<256;Fs++)RT[Fs]=h2(Fs)?1:0,IT[Fs]=h2(Fs);function ZW(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||My,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function PT(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=rW(r),new Lt(t,r)}function he(e,t){throw PT(e,t)}function _c(e,t){e.onWarning&&e.onWarning.call(null,PT(e,t))}var m2={YAML:function(t,r,n){var s,i,a;t.version!==null&&he(t,"duplication of %YAML directive"),n.length!==1&&he(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),s===null&&he(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&he(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&_c(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var s,i;n.length!==2&&he(t,"TAG directive accepts exactly two arguments"),s=n[0],i=n[1],ET.test(s)||he(t,"ill-formed tag handle (first argument) of the TAG directive"),Qn.call(t.tagMap,s)&&he(t,'there is a previously declared suffix for "'+s+'" tag handle'),TT.test(i)||he(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{he(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i}};function Un(e,t,r,n){var s,i,a,l;if(t<r){if(l=e.input.slice(t,r),n)for(s=0,i=l.length;s<i;s+=1)a=l.charCodeAt(s),a===9||32<=a&&a<=1114111||he(e,"expected valid JSON character");else UW.test(l)&&he(e,"the stream contains non-printable characters");e.result+=l}}function x2(e,t,r,n){var s,i,a,l;for(dt.isObject(r)||he(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(r),a=0,l=s.length;a<l;a+=1)i=s[a],Qn.call(t,i)||(AT(t,i,r[i]),n[i]=!0)}function ii(e,t,r,n,s,i,a,l,c){var d,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),d=0,u=s.length;d<u;d+=1)Array.isArray(s[d])&&he(e,"nested arrays are not supported inside keys"),typeof s=="object"&&p2(s[d])==="[object Object]"&&(s[d]="[object Object]");if(typeof s=="object"&&p2(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(d=0,u=i.length;d<u;d+=1)x2(e,t,i[d],r);else x2(e,t,i,r);else!e.json&&!Qn.call(r,s)&&Qn.call(t,s)&&(e.line=a||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,he(e,"duplicated mapping key")),AT(t,s,i),delete r[s];return t}function Dy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):he(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ot(e,t,r){for(var n=0,s=e.input.charCodeAt(e.position);s!==0;){for(;vs(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Ur(s))for(Dy(e),s=e.input.charCodeAt(e.position),n++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&_c(e,"deficient indentation"),n}function wu(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Ut(r)))}function Ly(e,t){t===1?e.result+=" ":t>1&&(e.result+=dt.repeat(`
`,t-1))}function JW(e,t,r){var n,s,i,a,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Ut(h)||si(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(s=e.input.charCodeAt(e.position+1),Ut(s)||r&&si(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,l=!1;h!==0;){if(h===58){if(s=e.input.charCodeAt(e.position+1),Ut(s)||r&&si(s))break}else if(h===35){if(n=e.input.charCodeAt(e.position-1),Ut(n))break}else{if(e.position===e.lineStart&&wu(e)||r&&si(h))break;if(Ur(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,ot(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Un(e,i,a,!1),Ly(e,e.line-c),i=a=e.position,l=!1),vs(h)||(a=e.position+1),h=e.input.charCodeAt(++e.position)}return Un(e,i,a,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function e7(e,t){var r,n,s;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=s=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Un(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,s=e.position;else return!0;else Ur(r)?(Un(e,n,s,!0),Ly(e,ot(e,!1,t)),n=s=e.position):e.position===e.lineStart&&wu(e)?he(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);he(e,"unexpected end of the stream within a single quoted scalar")}function t7(e,t){var r,n,s,i,a,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Un(e,r,e.position,!0),e.position++,!0;if(l===92){if(Un(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Ur(l))ot(e,!1,t);else if(l<256&&RT[l])e.result+=IT[l],e.position++;else if((a=YW(l))>0){for(s=a,i=0;s>0;s--)l=e.input.charCodeAt(++e.position),(a=KW(l))>=0?i=(i<<4)+a:he(e,"expected hexadecimal character");e.result+=XW(i),e.position++}else he(e,"unknown escape sequence");r=n=e.position}else Ur(l)?(Un(e,r,n,!0),Ly(e,ot(e,!1,t)),r=n=e.position):e.position===e.lineStart&&wu(e)?he(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}he(e,"unexpected end of the stream within a double quoted scalar")}function r7(e,t){var r=!0,n,s,i,a=e.tag,l,c=e.anchor,d,u,f,p,h,v=Object.create(null),x,w,g,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(ot(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=a,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;r?y===44&&he(e,"expected the node content, but found ','"):he(e,"missed comma between flow collection entries"),w=x=g=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Ut(d)&&(f=p=!0,e.position++,ot(e,!0,t))),n=e.line,s=e.lineStart,i=e.position,Ei(e,t,bc,!1,!0),w=e.tag,x=e.result,ot(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===n)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),ot(e,!0,t),Ei(e,t,bc,!1,!0),g=e.result),h?ii(e,l,v,w,x,g,n,s,i):f?l.push(ii(e,null,v,w,x,g,n,s,i)):l.push(x),ot(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}he(e,"unexpected end of the stream within a flow collection")}function n7(e,t){var r,n,s=px,i=!1,a=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)px===s?s=f===43?f2:HW:he(e,"repeat of a chomping mode identifier");else if((u=QW(f))>=0)u===0?he(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?he(e,"repeat of an indentation width identifier"):(l=t+u-1,a=!0);else break;if(vs(f)){do f=e.input.charCodeAt(++e.position);while(vs(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Ur(f)&&f!==0)}for(;f!==0;){for(Dy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!a||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>l&&(l=e.lineIndent),Ur(f)){c++;continue}if(e.lineIndent<l){s===f2?e.result+=dt.repeat(`
`,i?1+c:c):s===px&&i&&(e.result+=`
`);break}for(n?vs(f)?(d=!0,e.result+=dt.repeat(`
`,i?1+c:c)):d?(d=!1,e.result+=dt.repeat(`
`,c+1)):c===0?i&&(e.result+=" "):e.result+=dt.repeat(`
`,c):e.result+=dt.repeat(`
`,i?1+c:c),i=!0,a=!0,c=0,r=e.position;!Ur(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Un(e,r,e.position,!1)}return!0}function g2(e,t){var r,n=e.tag,s=e.anchor,i=[],a,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,he(e,"tab characters must not be used in indentation")),!(c!==45||(a=e.input.charCodeAt(e.position+1),!Ut(a))));){if(l=!0,e.position++,ot(e,!0,-1)&&e.lineIndent<=t){i.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Ei(e,t,CT,!1,!0),i.push(e.result),ot(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)he(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}function s7(e,t,r){var n,s,i,a,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,v=null,x=null,w=!1,g=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!w&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,he(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),i=e.line,(y===63||y===58)&&Ut(n))y===63?(w&&(ii(e,f,p,h,v,null,a,l,c),h=v=x=null),g=!0,w=!0,s=!0):w?(w=!1,s=!0):he(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=n;else{if(a=e.line,l=e.lineStart,c=e.position,!Ei(e,r,NT,!1,!0))break;if(e.line===i){for(y=e.input.charCodeAt(e.position);vs(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Ut(y)||he(e,"a whitespace character is expected after the key-value separator within a block mapping"),w&&(ii(e,f,p,h,v,null,a,l,c),h=v=x=null),g=!0,w=!1,s=!1,h=e.tag,v=e.result;else if(g)he(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(g)he(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(w&&(a=e.line,l=e.lineStart,c=e.position),Ei(e,t,wc,!0,s)&&(w?v=e.result:x=e.result),w||(ii(e,f,p,h,v,x,a,l,c),h=v=x=null),ot(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&y!==0)he(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return w&&ii(e,f,p,h,v,null,a,l,c),g&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),g}function i7(e){var t,r=!1,n=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&he(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(r=!0,a=e.input.charCodeAt(++e.position)):a===33?(n=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,r){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):he(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Ut(a);)a===33&&(n?he(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),ET.test(s)||he(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),GW.test(i)&&he(e,"tag suffix cannot contain flow indicator characters")}i&&!TT.test(i)&&he(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{he(e,"tag name is malformed: "+i)}return r?e.tag=i:Qn.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:he(e,'undeclared tag handle "'+s+'"'),!0}function o7(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&he(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ut(r)&&!si(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&he(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function a7(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ut(n)&&!si(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&he(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Qn.call(e.anchorMap,r)||he(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],ot(e,!0,-1),!0}function Ei(e,t,r,n,s){var i,a,l,c=1,d=!1,u=!1,f,p,h,v,x,w;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=l=wc===r||CT===r,n&&ot(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;i7(e)||o7(e);)ot(e,!0,-1)?(d=!0,l=i,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||s),(c===1||wc===r)&&(bc===r||NT===r?x=t:x=t+1,w=e.position-e.lineStart,c===1?l&&(g2(e,w)||s7(e,w,x))||r7(e,x)?u=!0:(a&&n7(e,x)||e7(e,x)||t7(e,x)?u=!0:a7(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&he(e,"alias node should not have any properties")):JW(e,x,bc===r)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&g2(e,w))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&he(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(v=e.implicitTypes[f],v.resolve(e.result)){e.result=v.construct(e.result),e.tag=v.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Qn.call(e.typeMap[e.kind||"fallback"],e.tag))v=e.typeMap[e.kind||"fallback"][e.tag];else for(v=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){v=h[f];break}v||he(e,"unknown tag !<"+e.tag+">"),e.result!==null&&v.kind!==e.kind&&he(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+v.kind+'", not "'+e.kind+'"'),v.resolve(e.result,e.tag)?(e.result=v.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):he(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function l7(e){var t=e.position,r,n,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(ot(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),r=e.position;a!==0&&!Ut(a);)a=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),s=[],n.length<1&&he(e,"directive name must not be less than one character in length");a!==0;){for(;vs(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Ur(a));break}if(Ur(a))break;for(r=e.position;a!==0&&!Ut(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(r,e.position))}a!==0&&Dy(e),Qn.call(m2,n)?m2[n](e,n,s):_c(e,'unknown document directive "'+n+'"')}if(ot(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,ot(e,!0,-1)):i&&he(e,"directives end mark is expected"),Ei(e,e.lineIndent-1,wc,!1,!0),ot(e,!0,-1),e.checkLineBreaks&&VW.test(e.input.slice(t,e.position))&&_c(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&wu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,ot(e,!0,-1));return}if(e.position<e.length-1)he(e,"end of the stream or a document separator is expected");else return}function OT(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new ZW(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,he(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)l7(r);return r.documents}function c7(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=OT(e,r);if(typeof t!="function")return n;for(var s=0,i=n.length;s<i;s+=1)t(n[s])}function u7(e,t){var r=OT(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new Lt("expected a single document in the stream, but found more")}}var d7=c7,f7=u7,MT={loadAll:d7,load:f7},DT=Object.prototype.toString,LT=Object.prototype.hasOwnProperty,zy=65279,p7=9,la=10,h7=13,m7=32,x7=33,g7=34,Wg=35,v7=37,y7=38,b7=39,w7=42,zT=44,_7=45,jc=58,j7=61,S7=62,k7=63,N7=64,FT=91,$T=93,C7=96,qT=123,E7=124,BT=125,Ot={};Ot[0]="\\0";Ot[7]="\\a";Ot[8]="\\b";Ot[9]="\\t";Ot[10]="\\n";Ot[11]="\\v";Ot[12]="\\f";Ot[13]="\\r";Ot[27]="\\e";Ot[34]='\\"';Ot[92]="\\\\";Ot[133]="\\N";Ot[160]="\\_";Ot[8232]="\\L";Ot[8233]="\\P";var T7=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],A7=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function R7(e,t){var r,n,s,i,a,l,c;if(t===null)return{};for(r={},n=Object.keys(t),s=0,i=n.length;s<i;s+=1)a=n[s],l=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),c=e.compiledTypeMap.fallback[a],c&&LT.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[a]=l;return r}function I7(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new Lt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+dt.repeat("0",n-t.length)+t}var P7=1,ca=2;function O7(e){this.schema=e.schema||My,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=dt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=R7(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?ca:P7,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function v2(e,t){for(var r=dt.repeat(" ",t),n=0,s=-1,i="",a,l=e.length;n<l;)s=e.indexOf(`
`,n),s===-1?(a=e.slice(n),n=l):(a=e.slice(n,s+1),n=s+1),a.length&&a!==`
`&&(i+=r),i+=a;return i}function Hg(e,t){return`
`+dt.repeat(" ",e.indent*t)}function M7(e,t){var r,n,s;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(s=e.implicitTypes[r],s.resolve(t))return!0;return!1}function Sc(e){return e===m7||e===p7}function ua(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==zy||65536<=e&&e<=1114111}function y2(e){return ua(e)&&e!==zy&&e!==h7&&e!==la}function b2(e,t,r){var n=y2(e),s=n&&!Sc(e);return(r?n:n&&e!==zT&&e!==FT&&e!==$T&&e!==qT&&e!==BT)&&e!==Wg&&!(t===jc&&!s)||y2(t)&&!Sc(t)&&e===Wg||t===jc&&s}function D7(e){return ua(e)&&e!==zy&&!Sc(e)&&e!==_7&&e!==k7&&e!==jc&&e!==zT&&e!==FT&&e!==$T&&e!==qT&&e!==BT&&e!==Wg&&e!==y7&&e!==w7&&e!==x7&&e!==E7&&e!==j7&&e!==S7&&e!==b7&&e!==g7&&e!==v7&&e!==N7&&e!==C7}function L7(e){return!Sc(e)&&e!==jc}function wo(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function WT(e){var t=/^\n* /;return t.test(e)}var HT=1,Ug=2,UT=3,VT=4,Ws=5;function z7(e,t,r,n,s,i,a,l){var c,d=0,u=null,f=!1,p=!1,h=n!==-1,v=-1,x=D7(wo(e,0))&&L7(wo(e,e.length-1));if(t||a)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wo(e,c),!ua(d))return Ws;x=x&&b2(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wo(e,c),d===la)f=!0,h&&(p=p||c-v-1>n&&e[v+1]!==" ",v=c);else if(!ua(d))return Ws;x=x&&b2(d,u,l),u=d}p=p||h&&c-v-1>n&&e[v+1]!==" "}return!f&&!p?x&&!a&&!s(e)?HT:i===ca?Ws:Ug:r>9&&WT(e)?Ws:a?i===ca?Ws:Ug:p?VT:UT}function F7(e,t,r,n,s){e.dump=function(){if(t.length===0)return e.quotingType===ca?'""':"''";if(!e.noCompatMode&&(T7.indexOf(t)!==-1||A7.test(t)))return e.quotingType===ca?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,r),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(d){return M7(e,d)}switch(z7(t,l,e.indent,a,c,e.quotingType,e.forceQuotes&&!n,s)){case HT:return t;case Ug:return"'"+t.replace(/'/g,"''")+"'";case UT:return"|"+w2(t,e.indent)+_2(v2(t,i));case VT:return">"+w2(t,e.indent)+_2(v2($7(t,a),i));case Ws:return'"'+q7(t)+'"';default:throw new Lt("impossible error: invalid scalar style")}}()}function w2(e,t){var r=WT(e)?String(t):"",n=e[e.length-1]===`
`,s=n&&(e[e.length-2]===`
`||e===`
`),i=s?"+":n?"":"-";return r+i+`
`}function _2(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function $7(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,r.lastIndex=d,j2(e.slice(0,d),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=r.exec(e);){var l=a[1],c=a[2];i=c[0]===" ",n+=l+(!s&&!i&&c!==""?`
`:"")+j2(c,t),s=i}return n}function j2(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,s=0,i,a=0,l=0,c="";n=r.exec(e);)l=n.index,l-s>t&&(i=a>s?a:l,c+=`
`+e.slice(s,i),s=i+1),a=l;return c+=`
`,e.length-s>t&&a>s?c+=e.slice(s,a)+`
`+e.slice(a+1):c+=e.slice(s),c.slice(1)}function q7(e){for(var t="",r=0,n,s=0;s<e.length;r>=65536?s+=2:s++)r=wo(e,s),n=Ot[r],!n&&ua(r)?(t+=e[s],r>=65536&&(t+=e[s+1])):t+=n||I7(r);return t}function B7(e,t,r){var n="",s=e.tag,i,a,l;for(i=0,a=r.length;i<a;i+=1)l=r[i],e.replacer&&(l=e.replacer.call(r,String(i),l)),(xn(e,t,l,!1,!1)||typeof l>"u"&&xn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=s,e.dump="["+n+"]"}function S2(e,t,r,n){var s="",i=e.tag,a,l,c;for(a=0,l=r.length;a<l;a+=1)c=r[a],e.replacer&&(c=e.replacer.call(r,String(a),c)),(xn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&xn(e,t+1,null,!0,!0,!1,!0))&&((!n||s!=="")&&(s+=Hg(e,t)),e.dump&&la===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}function W7(e,t,r){var n="",s=e.tag,i=Object.keys(r),a,l,c,d,u;for(a=0,l=i.length;a<l;a+=1)u="",n!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=i[a],d=r[c],e.replacer&&(d=e.replacer.call(r,c,d)),xn(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),xn(e,t,d,!1,!1)&&(u+=e.dump,n+=u));e.tag=s,e.dump="{"+n+"}"}function H7(e,t,r,n){var s="",i=e.tag,a=Object.keys(r),l,c,d,u,f,p;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new Lt("sortKeys must be a boolean or a function");for(l=0,c=a.length;l<c;l+=1)p="",(!n||s!=="")&&(p+=Hg(e,t)),d=a[l],u=r[d],e.replacer&&(u=e.replacer.call(r,d,u)),xn(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&la===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Hg(e,t)),xn(e,t+1,u,!0,f)&&(e.dump&&la===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,s+=p));e.tag=i,e.dump=s||"{}"}function k2(e,t,r){var n,s,i,a,l,c;for(s=r?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(l=s[i],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,DT.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(LT.call(l.represent,c))n=l.represent[c](t,c);else throw new Lt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function xn(e,t,r,n,s,i,a){e.tag=null,e.dump=r,k2(e,r,!1)||k2(e,r,!0);var l=DT.call(e.dump),c=n,d;n&&(n=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(r),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(s=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(H7(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(W7(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?S2(e,t-1,e.dump,s):S2(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(B7(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&F7(e,e.dump,t,i,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Lt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function U7(e,t){var r=[],n=[],s,i;for(Vg(e,r,n),s=0,i=n.length;s<i;s+=1)t.duplicates.push(r[n[s]]);t.usedDuplicates=new Array(i)}function Vg(e,t,r){var n,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)r.indexOf(s)===-1&&r.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)Vg(e[s],t,r);else for(n=Object.keys(e),s=0,i=n.length;s<i;s+=1)Vg(e[n[s]],t,r)}function V7(e,t){t=t||{};var r=new O7(t);r.noRefs||U7(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),xn(r,0,n,!0,!0)?r.dump+`
`:""}var G7=V7,K7={dump:G7};function Fy(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var Y7=kt,Q7=aT,X7=dT,Z7=xT,J7=gT,eH=My,tH=MT.load,rH=MT.loadAll,nH=K7.dump,sH=Lt,iH={binary:_T,float:mT,map:uT,null:fT,pairs:ST,set:kT,timestamp:bT,bool:pT,int:hT,merge:wT,omap:jT,seq:cT,str:lT},oH=Fy("safeLoad","load"),aH=Fy("safeLoadAll","loadAll"),lH=Fy("safeDump","dump"),$y={Type:Y7,Schema:Q7,FAILSAFE_SCHEMA:X7,JSON_SCHEMA:Z7,CORE_SCHEMA:J7,DEFAULT_SCHEMA:eH,load:tH,loadAll:rH,dump:nH,YAMLException:sH,types:iH,safeLoad:oH,safeLoadAll:aH,safeDump:lH};function N2({messages:e,pendingPrompt:t,introContent:r}){const n=m.useRef(null);return m.useEffect(()=>{var s;(s=n.current)==null||s.scrollIntoView({behavior:"smooth"})},[e,t]),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",onWheel:s=>s.stopPropagation(),children:[r,e.map((s,i)=>o.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:o.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${s.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:s.content})},i)),t&&o.jsx("div",{className:"flex justify-start",children:o.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),o.jsx("div",{ref:n})]})}function cH({onSubmit:e,disabled:t,placeholder:r}){const[n,s]=m.useState(""),i=m.useRef(null);m.useEffect(()=>{var c;t||(c=i.current)==null||c.focus()},[t]);const a=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),s("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),s(""))};return o.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("textarea",{ref:i,value:n,onChange:c=>s(c.target.value),onKeyDown:a,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),o.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),o.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const C2={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function uH({type:e,className:t}){switch(e){case"check":return o.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 9v4M12 17h.01"}),o.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),o.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function dH({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const s=C2[e]||C2.blocked,i=e==="qualified";return o.jsxs("div",{className:"p-6 text-center",children:[o.jsx("div",{className:`w-16 h-16 rounded-full ${s.iconBg} flex items-center justify-center mx-auto mb-4`,children:o.jsx(uH,{type:s.icon,className:`w-8 h-8 ${s.iconColor}`})}),o.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:s.title}),o.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:s.description}),i&&t&&o.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[o.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),o.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),o.jsxs("div",{className:"flex gap-2 justify-center",children:[i&&t&&o.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),o.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function fH({operation:e,context:t,onSubmit:r,onCancel:n}){var w;const[s,i]=m.useState("confirm"),[a,l]=m.useState(!1),[c,d]=m.useState((t==null?void 0:t.project_type)||""),[u,f]=m.useState(""),h=((e==null?void 0:e.config)||{}).entry_prompt||"Review the intake classification.",v=[{value:"greenfield",label:"Greenfield (New Project)"},{value:"enhancement",label:"Enhancement (Existing Project)"},{value:"migration",label:"Migration"},{value:"integration",label:"Integration"},{value:"unknown",label:"Unknown / Other"}],x=()=>{l(!0);const g={confirmed:s==="confirm",timestamp:new Date().toISOString()};s==="correct"&&(g.corrected_project_type=c),u.trim()&&(g.notes=u.trim()),r(g)};return o.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-green, #22c55e)",color:"#fff"},children:"Intake"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Concierge Entry"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirm or correct the intake classification"})]})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",onWheel:g=>g.stopPropagation(),children:o.jsxs("div",{className:"max-w-2xl space-y-6",children:[o.jsx("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:o.jsx("div",{className:"text-sm",style:{color:"var(--text-primary)"},children:h})}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirmation requested"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Classification Result"}),o.jsxs("div",{className:"p-4 rounded space-y-3",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Intent Classification"}),o.jsx("span",{className:"px-3 py-1 rounded font-semibold",style:{background:"var(--accent-primary, #3b82f6)",color:"#fff",fontSize:12},children:((w=t==null?void 0:t.project_type)==null?void 0:w.replace(/_/g," ").toUpperCase())||"Unknown"})]}),(t==null?void 0:t.artifact_type)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Artifact Type"}),o.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.artifact_type.replace(/_/g," ")})]}),(t==null?void 0:t.audience)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Audience"}),o.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.audience})]}),(t==null?void 0:t.intake_summary)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Summary"}),o.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.intake_summary})]}),(t==null?void 0:t.classification_rationale)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Rationale"}),o.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:t.classification_rationale})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Your Decision"}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:()=>i("confirm"),className:"flex-1 p-4 rounded text-left",style:{background:s==="confirm"?"rgba(34, 197, 94, 0.1)":"var(--bg-panel)",border:s==="confirm"?"2px solid #22c55e":"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Confirm"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"The classification is correct"})]}),o.jsxs("button",{onClick:()=>i("correct"),className:"flex-1 p-4 rounded text-left",style:{background:s==="correct"?"rgba(249, 115, 22, 0.1)":"var(--bg-panel)",border:s==="correct"?"2px solid #f97316":"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Correct"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"I need to change the classification before proceeding"})]})]})]}),s==="correct"&&o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Correct Intent Classification"}),o.jsxs("select",{value:c,onChange:g=>d(g.target.value),className:"w-full p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[o.jsx("option",{value:"",children:"Select intent classification..."}),v.map(g=>o.jsx("option",{value:g.value,children:g.label},g.value))]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Notes (Optional)"}),o.jsx("textarea",{value:u,onChange:g=>f(g.target.value),placeholder:"Add any additional context or notes...",className:"w-full p-3 rounded text-sm",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:80,resize:"vertical"}})]})]})}),o.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[n&&o.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:"Cancel"}),o.jsxs("button",{onClick:x,disabled:a||s==="correct"&&!c,className:"px-4 py-2 rounded text-sm font-semibold flex items-center gap-2",style:{background:s==="confirm"?"#22c55e":"#f97316",color:"#fff",opacity:a||s==="correct"&&!c?.5:1},children:[a&&o.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="confirm"?"Confirm Classification":"Submit Correction"]})]})]})}function pH({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:s,gateOutcome:i,project:a,error:l,loading:c,submitting:d,intakeClassification:u,intakeGatePhase:f,operationalError:p,startIntake:h,submitMessage:v,retryLastMessage:x,reset:w}=D9(),[g,y]=m.useState(null);m.useEffect(()=>(h(),fetch("/content/concierge-intro.yaml").then(C=>C.text()).then(C=>y($y.load(C))).catch(C=>console.error("Failed to load intro content:",C)),()=>w()),[]);const b=()=>{w(),e()},j=()=>{a&&t&&t(a),b()},k=C=>{v(JSON.stringify(C))},N=()=>{const C=[{id:"describe",label:"Describe"},{id:"confirm",label:"Confirm"},{id:"complete",label:"Done"}];let _=r;f==="awaiting_confirmation"&&(_="confirm"),(_==="review"||_==="generating")&&(_="complete");const R=C.findIndex(T=>T.id===_);return o.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:C.map((T,D)=>o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:`px-2 py-0.5 rounded ${D===R?"bg-violet-500/30 text-violet-300":D<R?"text-emerald-400":"text-slate-500"}`,children:T.label}),D<C.length-1&&o.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},T.id))})},S=()=>{var C;if(c&&r==="idle")return o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});if(p)return o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-6 text-center gap-4",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-500/20 flex items-center justify-center",children:o.jsxs("svg",{className:"w-6 h-6 text-amber-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),o.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),o.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"The AI provider is temporarily unavailable."}),o.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"This is usually resolved within a few moments."})]}),o.jsx("button",{onClick:x,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors bg-violet-500/20 hover:bg-violet-500/30",style:{color:"var(--text-primary)"},children:"Retry"})]});if(f==="awaiting_confirmation"&&u)return o.jsx(fH,{operation:{config:{entry_prompt:s}},context:u,onSubmit:k,onCancel:b});switch(r){case"describe":const _=g?o.jsxs("div",{className:"mb-4 pb-4 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("h3",{className:"text-base font-semibold mb-3",style:{color:"var(--text-primary)"},children:g.title}),o.jsx("div",{className:"text-sm space-y-3",style:{color:"var(--text-secondary)"},children:(C=g.paragraphs)==null?void 0:C.map((R,T)=>o.jsx("p",{children:R},T))}),g.call_to_action&&o.jsx("p",{className:"text-sm font-medium mt-4",style:{color:"var(--text-primary)"},children:g.call_to_action})]}):null;return o.jsxs(o.Fragment,{children:[o.jsx(N2,{messages:n,pendingPrompt:s,introContent:_}),o.jsx(cH,{onSubmit:v,disabled:d,placeholder:"Describe what you want to build..."})]});case"complete":return o.jsxs(o.Fragment,{children:[o.jsx(N2,{messages:n}),o.jsx(dH,{gateOutcome:i,project:a,onViewProject:j,onClose:b})]});default:return null}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:o.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},onWheel:C=>C.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),N()]})]}),o.jsx("button",{onClick:b,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l&&o.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:l}),S()]})})}function hH({onClose:e}){const{user:t,logout:r,isAdmin:n}=Ps(),[s,i]=m.useState(null),[a,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{s==="linked"&&p()},[s]);const p=async()=>{try{d(!0);const k=await fetch("/auth/accounts",{credentials:"include"});if(k.ok){const N=await k.json();l(N.identities||[])}}catch(k){console.error("Failed to load accounts:",k)}finally{d(!1)}},h=k=>{window.location.href=`/auth/accounts/link/${k}`},v=async k=>{var N;if(a.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${k} account?`))try{const S=(N=document.cookie.split("; ").find(_=>_.startsWith("csrf=")||_.startsWith("__Host-csrf=")))==null?void 0:N.split("=")[1],C=await fetch(`/auth/accounts/${k}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":S||""}});if(C.ok)f({type:"success",text:"Account unlinked"}),await p();else{const _=await C.json();throw new Error(_.detail||"Failed to unlink")}}catch(S){f({type:"error",text:S.message})}},x=async()=>{await r(),e()},w=k=>{i(s===k?null:k),f(null)},g={google:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=k=>{const N={user:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),o.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),o.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return N[k]||N.user},j=k=>{switch(k){case"account":return o.jsxs("div",{className:"px-4 py-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),o.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),o.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return o.jsxs("div",{className:"px-4 py-3",children:[u&&o.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"space-y-2 mb-4",children:a.map(N=>o.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[g[N.provider_id],o.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:N.provider_email})]}),o.jsx("button",{onClick:()=>v(N.provider_id),disabled:a.length<=1,className:`text-xs px-2 py-1 rounded ${a.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},N.provider_id))}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),o.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.google,"Google"]}),o.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.microsoft,"Microsoft"]})]})]})]});default:return o.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),o.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?o.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):o.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),o.jsxs("div",{className:"flex-1 overflow-hidden",children:[o.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),o.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),o.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[o.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),o.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),o.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[o.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),o.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),o.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),o.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(k=>o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsxs("button",{onClick:()=>!k.future&&w(k.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${k.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:k.future,children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:b(k.icon)}),o.jsx("span",{className:"flex-1 text-sm text-left",children:k.label}),k.future?o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):o.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:s===k.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),s===k.id&&!k.future&&o.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:j(k.id)})]},k.id))]}),o.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:x,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),o.jsx("polyline",{points:"16 17 21 12 16 7"}),o.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Oe={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function mH(){return o.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Oe.bg,borderColor:Oe.border},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Oe.textPrimary},children:"THE COMBINE"}),o.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Oe.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function xH(){return o.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Oe.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),o.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Oe.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),o.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Oe.textMuted},onMouseOver:e=>e.currentTarget.style.color=Oe.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Oe.textMuted,children:["Learn how The Combine works",o.jsx("span",{"aria-hidden":"true",children:""})]})]})}function gH(){const e=[{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return o.jsx("section",{className:"max-w-4xl mx-auto",children:o.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>o.jsxs("div",{className:"flex-1 text-center group",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Oe.bgElevated,border:`1px solid ${Oe.border}`,color:Oe.textMuted},children:t.icon}),o.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Oe.textPrimary},children:t.title}),o.jsx("p",{className:"text-xs",style:{color:Oe.textMuted},children:t.description}),r<e.length-1&&o.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Oe.border}})]},r))})})}function vH(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return o.jsx("section",{className:"text-center",children:o.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>o.jsx("span",{className:"text-xs",style:{color:Oe.textMuted},children:t},r))})})}function yH({onLogin:e}){return o.jsxs("section",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Oe.textSecondary},children:"Ready?"}),o.jsxs("div",{className:"inline-flex flex-col gap-3",children:[o.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Oe.accentHover,onMouseOut:t=>t.currentTarget.style.background=Oe.accent,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),o.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.bg,border:`1px solid ${Oe.border}`,color:Oe.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Oe.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Oe.bg,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function bH(){return o.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[o.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Terms"}),o.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Privacy"}),o.jsx("span",{className:"text-xs",style:{color:Oe.border},children:" 2026 The Combine"})]})}function wH(){const{login:e}=Ps();return o.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Oe.bg},children:[o.jsx(mH,{}),o.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:o.jsxs("div",{className:"space-y-12",children:[o.jsx(xH,{}),o.jsx(gH,{}),o.jsx(vH,{}),o.jsx(yH,{onLogin:e})]})}),o.jsx(bH,{})]})}const Ee={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function _H(){return o.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Ee.bg,borderColor:Ee.border},children:[o.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Ee.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ee.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ee.textMuted,children:[o.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),o.jsx("span",{className:"text-sm",children:"Back"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),o.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Ee.textPrimary},children:"THE COMBINE"})]}),o.jsx("div",{className:"w-16"})," "]})}function ns({title:e,children:t}){return o.jsxs("section",{className:"mb-16",children:[e&&o.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Ee.textPrimary},children:e}),t]})}function ht({children:e,className:t=""}){return o.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Ee.textSecondary},children:e})}function to({children:e}){return o.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Ee.textPrimary,borderLeft:`2px solid ${Ee.border}`},children:e})}function al({items:e}){return o.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>o.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Ee.textSecondary},children:[o.jsx("span",{style:{color:Ee.textMuted},children:"-"}),t]},r))})}function ll({number:e,title:t,children:r}){return o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[o.jsxs("span",{className:"text-sm font-mono",style:{color:Ee.textMuted},children:[e,"."]}),o.jsx("h3",{className:"text-base font-medium",style:{color:Ee.textPrimary},children:t})]}),o.jsx("div",{className:"pl-7",children:o.jsx(ht,{children:r})})]})}function cl({title:e,children:t}){return o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Ee.textPrimary},children:e}),o.jsx(ht,{className:"mb-0",children:t})]})}function jH({onLogin:e}){return o.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Ee.bgElevated,border:`1px solid ${Ee.border}`},children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Ee.textPrimary},children:"When You're Ready"}),o.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),o.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),o.jsx(ht,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),o.jsxs("div",{className:"inline-flex flex-col gap-3",children:[o.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ee.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ee.accent,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),o.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.bg,border:`1px solid ${Ee.border}`,color:Ee.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ee.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ee.bg,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function SH(){return o.jsxs("footer",{className:"py-8 text-center",children:[o.jsx("p",{className:"text-sm mb-6",style:{color:Ee.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),o.jsxs("div",{className:"flex items-center justify-center gap-6",children:[o.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Terms"}),o.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Privacy"}),o.jsx("span",{className:"text-xs",style:{color:Ee.border},children:" 2026 The Combine"})]})]})}function kH(){const{login:e}=Ps();return o.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ee.bg},children:[o.jsx(_H,{}),o.jsx("main",{className:"flex-1 px-6 py-12",children:o.jsxs("article",{className:"max-w-2xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Ee.textPrimary},children:"Learn More"}),o.jsxs(ns,{title:"What The Combine Is",children:[o.jsx(ht,{children:"The Combine is an AI-assisted production system for knowledge work."}),o.jsx(ht,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),o.jsx(to,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),o.jsx(to,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),o.jsxs(ns,{title:"Why It Exists",children:[o.jsx(ht,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),o.jsx(ht,{children:"It breaks down when the work must be:"}),o.jsx(al,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),o.jsx(ht,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),o.jsxs(ns,{title:'Why "The Combine"',children:[o.jsx(ht,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),o.jsx(ht,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),o.jsx(ht,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),o.jsx(ht,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),o.jsx(ht,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),o.jsx(al,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),o.jsx(ht,{children:"This is not automation for speed. It is industrialization for reliability."}),o.jsx(to,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),o.jsxs(ns,{title:"How It Works",children:[o.jsx(ll,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),o.jsx(ll,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),o.jsx(ll,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),o.jsx(ll,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),o.jsxs(ns,{title:"What Makes It Different",children:[o.jsx(cl,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),o.jsx(cl,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),o.jsx(cl,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),o.jsx(cl,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),o.jsxs(ns,{title:"What The Combine Is Not",children:[o.jsx(al,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),o.jsx(ht,{children:"If you want improvisation, there are better tools."}),o.jsx(to,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),o.jsxs(ns,{title:"Who It's For",children:[o.jsx(ht,{children:"The Combine is designed for people responsible for outcomes, including:"}),o.jsx(al,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),o.jsx(to,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),o.jsx(jH,{onLogin:e})]})}),o.jsx(SH,{})]})}function GT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await ye.getTemplates();t(l.templates||[])}catch(l){i(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{templates:e,loading:r,error:s,refresh:a}}function NH(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await ye.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){i(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{workflows:e,loading:r,error:s,refresh:a}}function KT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await ye.getSchemas();t(l.schemas||[])}catch(l){i(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{schemas:e,loading:r,error:s,refresh:a}}function YT(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){n(!0),i(null);try{const h=await ye.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&i(h.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return p(),()=>{f=!1}},[]);const a=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:a.role.length,task:a.task.length,qa:a.qa.length,pgc:a.pgc.length,questions:a.questions.length,reflection:a.reflection.length}),[e,a]),c=m.useCallback(f=>!f||f==="all"?e:a[f]||[],[e,a]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{n(!0),i(null);try{const f=await ye.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),i(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:s,fragmentsByKind:a,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const hx="doctype-browser-collapsed";function QT(e,t){const[r,n]=m.useState(()=>{try{const i=JSON.parse(localStorage.getItem(hx)||"{}");return e in i?i[e]:t}catch{return t}}),s=m.useCallback(i=>{const a=typeof i=="function"?i(r):i;n(a);try{const l=JSON.parse(localStorage.getItem(hx)||"{}");l[e]=a,localStorage.setItem(hx,JSON.stringify(l))}catch{}},[e,r]);return[r,s]}function E2({title:e,defaultOpen:t=!0,children:r}){const[n,s]=QT(`group:${e}`,t);return o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>s(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function T2({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:s}){const[i,a]=QT(`sub:${e}`,r);return o.jsxs("div",{children:[o.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[o.jsxs("button",{onClick:()=>a(!i),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[o.jsx("span",{style:{color:"var(--text-muted)",transform:i?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&o.jsx("span",{style:{color:n,fontSize:8},children:""}),o.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),i&&s]})}function A2({selected:e,onClick:t,label:r,sublabel:n,badge:s}){return o.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium truncate",children:r}),s&&o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:s})]}),n&&o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function R2({loading:e,empty:t,emptyMessage:r="None found"}){return e?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function CH({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:s=[],promptFragmentKindOptions:i=[],schemas:a=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:v=null,selectedRole:x=null,selectedTemplate:w=null,selectedWorkflow:g=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:j,onSelectRole:k,onSelectTemplate:N,onSelectWorkflow:S,onSelectFragment:C,onSelectStandaloneSchema:_,onCreateWorkflow:R,onCreateDocType:T,onCreateFragment:D,onCreateTemplate:$,onCreateSchema:E,onSelectTask:L,onSelectSchema:A,workspaceState:P=null}){var Ie;const[M,I]=m.useState(null),[O,F]=m.useState(null),[q,U]=m.useState(""),[G,J]=m.useState(!1),[B,te]=m.useState(!1),[oe,Q]=m.useState(""),[H,ie]=m.useState(!1),ae=[...e].sort((ne,we)=>(ne.display_name||"").localeCompare(we.display_name||"")),pe=n.filter(ne=>(ne.pow_class||"reference")==="reference"),me=ne=>{const we=ne.pow_class||"reference";return we==="reference"?"ref":we==="template"?"tpl":"inst"},le=e.filter(ne=>ne.active_version).length+n.filter(ne=>ne.active_version).length,V=((Ie=P==null?void 0:P.modified_artifacts)==null?void 0:Ie.length)??0,ee=(P==null?void 0:P.is_dirty)??!1,re=()=>{I(null),F(null),U("")},je=()=>{te(!1),Q("")},be=async()=>{const ne=oe.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){ie(!0);try{await(T==null?void 0:T({doc_type_id:ne})),je()}catch{}finally{ie(!1)}}},Re=async()=>{const ne=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){J(!0);try{const we={workflow_id:ne,pow_class:"template"};O&&(we.derived_from={workflow_id:O.workflow_id,version:O.active_version},we.source_version=O.active_version),await(R==null?void 0:R(we)),re()}catch{}finally{J(!1)}}};return o.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs(E2,{title:"Production Workflows",defaultOpen:!0,children:[o.jsxs(T2,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&o.jsx("button",{onClick:()=>I(M?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[M==="choose"&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsxs("button",{onClick:()=>I("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:pe.length===0,children:["From Reference",pe.length===0?" (none available)":""]}),o.jsx("button",{onClick:()=>I("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),o.jsx("button",{onClick:re,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),M==="from_reference"&&!O&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),pe.map(ne=>o.jsxs("button",{onClick:()=>F(ne),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[o.jsx("div",{className:"font-medium",children:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,we=>we.toUpperCase())}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",ne.active_version]})]},ne.workflow_id)),o.jsx("button",{onClick:()=>I("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(M==="blank"||M==="from_reference"&&O)&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[O&&o.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",O.name||O.workflow_id," v",O.active_version]}),o.jsx("input",{type:"text",value:q,onChange:ne=>U(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&Re(),ne.key==="Escape"&&re()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:G,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:Re,disabled:G||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:G?"wait":"pointer",opacity:!q.trim()||G?.5:1},children:G?"Creating...":"Create"}),o.jsx("button",{onClick:re,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(R2,{loading:u,empty:!u&&n.length===0,emptyMessage:"No workflows"}),!u&&n.length>0&&o.jsx("div",{className:"py-1",children:n.map(ne=>o.jsx(A2,{selected:(g==null?void 0:g.workflow_id)===ne.workflow_id,onClick:()=>S==null?void 0:S(ne),label:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,we=>we.toUpperCase()),sublabel:`v${ne.active_version}`,badge:me(ne)},ne.workflow_id))})]}),o.jsxs(T2,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&o.jsx("button",{onClick:()=>te(!B),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[B&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:oe,onChange:ne=>Q(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&be(),ne.key==="Escape"&&je()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:H,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:be,disabled:H||!oe.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:H?"wait":"pointer",opacity:!oe.trim()||H?.5:1},children:H?"Creating...":"Create"}),o.jsx("button",{onClick:je,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(R2,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&ae.length>0&&o.jsx("div",{className:"py-1",children:ae.map(ne=>o.jsx(A2,{selected:v==="docworkflow"&&(h==null?void 0:h.doc_type_id)===ne.doc_type_id,onClick:()=>j==null?void 0:j(ne),label:ne.display_name,badge:`v${ne.active_version}`},ne.doc_type_id))})]})]}),o.jsxs(E2,{title:"Governance",defaultOpen:!1,children:[o.jsx("div",{className:"px-4 py-3",children:o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),o.jsxs("div",{children:[le," active ",le===1?"release":"releases"]})]})}),P&&o.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),ee&&o.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[V," dirty"]})]})]})]})})}function EH({kinds:e=[],selectedKind:t="all",onSelect:r}){return o.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:s,count:i})=>{const a=t===n;return o.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:a?"var(--action-primary)":"var(--bg-panel)",color:a?"#000":"var(--text-secondary)",border:a?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[s,i!==void 0&&o.jsxs("span",{style:{marginLeft:4,opacity:a?.7:.6},children:["(",i,")"]})]},n)})})}function ul({title:e,count:t,dotColor:r,defaultOpen:n=!1,action:s,children:i}){const[a,l]=m.useState(n);return o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[o.jsxs("button",{onClick:()=>l(!a),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{style:{color:"var(--text-muted)",transform:a?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),o.jsx("span",{style:{color:r,fontSize:10},children:""}),o.jsx("span",{className:"font-semibold",children:e})]}),o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),s&&o.jsx("div",{className:"pr-3",children:s})]}),a&&o.jsx("div",{style:{background:"var(--bg-panel)"},children:i})]})}function ro({onClick:e,label:t,sublabel:r,badge:n,isSelected:s}){return o.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:s?"var(--bg-selected, rgba(99, 102, 241, 0.15))":"transparent",border:"none",borderLeft:s?"3px solid var(--action-primary)":"3px solid transparent",color:s?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium truncate",children:t}),n&&o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:n})]}),r&&o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function dl({loading:e,empty:t,emptyMessage:r="None found"}){return e?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function TH({isOpen:e,onClose:t,promptFragments:r=[],promptFragmentKindOptions:n=[],templates:s=[],schemas:i=[],documentTypes:a=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,selectedFragment:h=null,selectedTemplate:v=null,selectedSchema:x=null,selectedMechanicalOp:w=null,onSelectFragment:g,onSelectTemplate:y,onSelectSchema:b,onSelectStandaloneSchema:j,onSelectMechanicalOp:k,onCreateFragment:N,onCreateTemplate:S,onCreateSchema:C}){const[_,R]=m.useState("all"),[T,D]=m.useState(!1),[$,E]=m.useState("role"),[L,A]=m.useState(""),[P,M]=m.useState(!1),[I,O]=m.useState(!1),[F,q]=m.useState(""),[U,G]=m.useState(!1),[J,B]=m.useState(!1),[te,oe]=m.useState(""),[Q,H]=m.useState(!1),ie=_==="all"?r:r.filter(V=>V.kind===_);m.useEffect(()=>{e||(D(!1),O(!1),B(!1),A(""),q(""),oe(""))},[e]);const ae=m.useCallback((V,ee)=>{V==null||V(ee)},[]),pe=async()=>{const V=L.trim().toLowerCase().replace(/\s+/g,"_");if(!(!V||!/^[a-z][a-z0-9_]*$/.test(V))){M(!0);try{await(N==null?void 0:N({role_id:V,kind:$})),D(!1),A("")}catch{}finally{M(!1)}}},me=async()=>{const V=F.trim().toLowerCase().replace(/\s+/g,"_");if(!(!V||!/^[a-z][a-z0-9_]*$/.test(V))){G(!0);try{await(S==null?void 0:S({template_id:V})),O(!1),q("")}catch{}finally{G(!1)}}},le=async()=>{const V=te.trim().toLowerCase().replace(/\s+/g,"_");if(!(!V||!/^[a-z][a-z0-9_]*$/.test(V))){H(!0);try{await(C==null?void 0:C({schema_id:V})),B(!1),oe("")}catch{}finally{H(!1)}}};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),o.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),o.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs(ul,{title:"Prompt Fragments",count:r.length,dotColor:"#f59e0b",defaultOpen:!0,action:N&&o.jsx("button",{onClick:()=>D(!T),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[T&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),o.jsx("select",{value:$,onChange:V=>E(V.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:o.jsx("option",{value:"role",children:"Role"})})]}),o.jsx("input",{type:"text",value:L,onChange:V=>A(V.target.value),onKeyDown:V=>{V.key==="Enter"&&pe(),V.key==="Escape"&&D(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:P,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:pe,disabled:P||!L.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:P?"wait":"pointer",opacity:!L.trim()||P?.5:1},children:P?"Creating...":"Create"}),o.jsx("button",{onClick:()=>D(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.length>0&&o.jsx(EH,{kinds:n,selectedKind:_,onSelect:R}),o.jsx(dl,{loading:d,empty:!d&&ie.length===0,emptyMessage:_==="all"?"No prompt fragments":`No ${_} fragments`}),!d&&ie.length>0&&o.jsx("div",{className:"py-1",children:ie.map(V=>o.jsx(ro,{onClick:()=>ae(g,V),label:V.name||V.fragment_id,sublabel:`${V.kind}  v${V.version}`,badge:V.kind,isSelected:(h==null?void 0:h.fragment_id)===V.fragment_id},V.fragment_id))})]}),o.jsxs(ul,{title:"Templates",count:s.length,dotColor:"var(--dot-green)",action:S&&o.jsx("button",{onClick:()=>O(!I),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[I&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:F,onChange:V=>q(V.target.value),onKeyDown:V=>{V.key==="Enter"&&me(),V.key==="Escape"&&O(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:U,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:me,disabled:U||!F.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:U?"wait":"pointer",opacity:!F.trim()||U?.5:1},children:U?"Creating...":"Create"}),o.jsx("button",{onClick:()=>O(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(dl,{loading:u,empty:!u&&s.length===0,emptyMessage:"No templates"}),!u&&s.length>0&&o.jsx("div",{className:"py-1",children:s.map(V=>o.jsx(ro,{onClick:()=>ae(y,V),label:V.name||V.template_id.replace(/_/g," ").replace(/\b\w/g,ee=>ee.toUpperCase()),sublabel:`v${V.active_version}`,isSelected:(v==null?void 0:v.template_id)===V.template_id},V.template_id))})]}),o.jsxs(ul,{title:"Schemas",count:i.length||a.length,dotColor:"var(--dot-blue)",action:C&&o.jsx("button",{onClick:()=>B(!J),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[J&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:te,onChange:V=>oe(V.target.value),onKeyDown:V=>{V.key==="Enter"&&le(),V.key==="Escape"&&B(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:Q,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:le,disabled:Q||!te.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Q?"wait":"pointer",opacity:!te.trim()||Q?.5:1},children:Q?"Creating...":"Create"}),o.jsx("button",{onClick:()=>B(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(dl,{loading:f,empty:!f&&i.length===0&&a.length===0,emptyMessage:"No schemas"}),!f&&i.length>0&&o.jsx("div",{className:"py-1",children:i.map(V=>o.jsx(ro,{onClick:()=>ae(j,V),label:V.title||V.schema_id,sublabel:`v${V.active_version}`,isSelected:(x==null?void 0:x.schema_id)===V.schema_id},`standalone-${V.schema_id}`))}),i.length===0&&a.length>0&&o.jsx("div",{className:"py-1",children:a.map(V=>o.jsx(ro,{onClick:()=>ae(b,{doc_type_id:V.doc_type_id,display_name:V.display_name,active_version:V.active_version}),label:V.display_name,sublabel:`from ${V.doc_type_id}`},`schema-${V.doc_type_id}`))})]}),o.jsxs(ul,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[o.jsx(dl,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&o.jsx("div",{className:"py-1",children:l.map(V=>{const ee=c.filter(re=>re.type===V.type_id);return o.jsxs("div",{children:[o.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsx("span",{style:{fontSize:10},children:""}),o.jsx("span",{children:V.name}),o.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",ee.length,")"]})]}),ee.length>0?ee.map(re=>o.jsx(ro,{onClick:()=>ae(k,re),label:re.name,sublabel:`v${re.active_version}`,badge:re.type,isSelected:(w==null?void 0:w.op_id)===re.op_id},re.op_id)):o.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},V.type_id)})}),!p&&l.length===0&&c.length===0&&o.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),o.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function en({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:s=!1,error:i=null,readOnly:a=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a&&o.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!a&&s&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[c&&!a&&o.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&o.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&s&&o.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),i&&o.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",i]})]})]}),o.jsx("div",{className:"flex-1 relative",children:r?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):o.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:a,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function AH({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),i(!1);return}(async()=>{i(!0),l(null);try{const d=await ye.getPreview(e,t);n(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{i(!1)}})()},[e,t]),o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),o.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&o.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&o.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&o.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&o.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),o.jsx("div",{className:"flex-1 relative overflow-auto",children:s?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):a?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[o.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),o.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:a})]})}):o.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function RH({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,j,k;t&&(i({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((j=t.ui)==null?void 0:j.category)||"",ui_display_order:((k=t.ui)==null?void 0:k.display_order)||0}),h(!1),f(null))},[t]);const v=m.useCallback((b,j)=>{i(k=>({...k,[b]:j})),h(!0)},[]),x=m.useCallback((b,j)=>{const k=j.split(",").map(N=>N.trim()).filter(N=>N);i(N=>({...N,[b]:k})),h(!0)},[]),w=m.useCallback(b=>{if(!b)return"";const j=r.find(k=>k.role_id===b);return j?`prompt:role:${b}:${j.active_version}`:""},[r]),g=m.useCallback(b=>{if(!b)return"";const j=b.split(":");return j.length>=3&&j[0]==="prompt"&&j[1]==="role"?j[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!s)){d(!0),f(null);try{const b=t.version||t.active_version,j=`doctype:${t.doc_type_id}:${b}:manifest`,k=IH(t.doc_type_id,b,s),N=await ye.writeArtifact(e,j,k);h(!1),n==null||n(j,N)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,s,n]);return!t||!s?o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsx("div",{className:"flex items-center gap-2",children:p&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),o.jsxs("div",{className:"flex items-center gap-2",children:[c&&o.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&o.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),o.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"max-w-2xl space-y-6",children:[o.jsxs(no,{title:"Identity",children:[o.jsx(Jt,{label:"Display Name",children:o.jsx("input",{type:"text",value:s.display_name,onChange:b=>v("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Jt,{label:"Description",children:o.jsx("textarea",{value:s.description,onChange:b=>v("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),o.jsxs(no,{title:"Classification",children:[o.jsx(Jt,{label:"Authority Level",children:o.jsxs("select",{value:s.authority_level,onChange:b=>v("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"descriptive",children:"Descriptive"}),o.jsx("option",{value:"prescriptive",children:"Prescriptive"}),o.jsx("option",{value:"constructive",children:"Constructive"}),o.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),o.jsx(Jt,{label:"Creation Mode",children:o.jsxs("select",{value:s.creation_mode,onChange:b=>v("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"llm_generated",children:"LLM Generated"}),o.jsx("option",{value:"constructed",children:"Constructed"}),o.jsx("option",{value:"extracted",children:"Extracted"})]})}),o.jsx(Jt,{label:"Scope",children:o.jsxs("select",{value:s.scope,onChange:b=>v("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"project",children:"Project"}),o.jsx("option",{value:"work_package",children:"Work Package"}),o.jsx("option",{value:"work_statement",children:"Work Statement"})]})})]}),o.jsx(no,{title:"Shared References",children:o.jsxs(Jt,{label:"Role Prompt",children:[o.jsxs("select",{value:g(s.role_prompt_ref),onChange:b=>v("role_prompt_ref",w(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"",children:"None"}),r.map(b=>o.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())},b.role_id))]}),s.role_prompt_ref&&o.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:s.role_prompt_ref})]})}),o.jsxs(no,{title:"Dependencies",children:[o.jsx(Jt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.required_inputs.join(", "),onChange:b=>x("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Jt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.optional_inputs.join(", "),onChange:b=>x("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Jt,{label:"Parent Doc Type",children:o.jsx("input",{type:"text",value:s.parent_doc_type,onChange:b=>v("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Jt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.creates_children.join(", "),onChange:b=>x("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),o.jsxs(no,{title:"UI Configuration",children:[o.jsx(Jt,{label:"Icon",children:o.jsx("input",{type:"text",value:s.ui_icon,onChange:b=>v("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Jt,{label:"Category",children:o.jsxs("select",{value:s.ui_category,onChange:b=>v("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"",children:"Select category..."}),o.jsx("option",{value:"intake",children:"Intake"}),o.jsx("option",{value:"architecture",children:"Architecture"}),o.jsx("option",{value:"planning",children:"Planning"}),o.jsx("option",{value:"execution",children:"Execution"})]})}),o.jsx(Jt,{label:"Display Order",children:o.jsx("input",{type:"number",value:s.ui_display_order,onChange:b=>v("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function no({title:e,children:t}){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),o.jsx("div",{className:"space-y-4",children:t})]})}function Jt({label:e,hint:t,children:r}){return o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&o.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function IH(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(s=>`"${s}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(s=>`"${s}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(s=>`"${s}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function XT(e,t,{debounceMs:r=1e3,onSave:n}={}){const[s,i]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,x]=m.useState(null),w=m.useRef(null),g=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){i(null),l(null),d(!1);return}d(!0),f(null);try{const S=await ye.getArtifact(e,t),C=JSON.parse(S.content);i(C),l(C)}catch(S){f(S.message),console.error("Failed to load workflow artifact:",S)}finally{d(!1)}},[e,t]),b=m.useCallback(async S=>{if(!(!e||!t)){h(!0),f(null);try{const C=JSON.stringify(S,null,2),_=await ye.writeArtifact(e,t,C);x(_),l(S),n&&n(_)}catch(C){f(C.message),console.error("Failed to save workflow:",C)}finally{h(!1)}}},[e,t,n]),j=m.useCallback(S=>{g.current=S,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),k=m.useCallback(S=>{i(S),j(S)},[j]),N=m.useCallback(()=>{w.current&&clearTimeout(w.current),s&&b(s)},[s,b]);return m.useEffect(()=>(y(),()=>{w.current&&clearTimeout(w.current)}),[y]),{workflowJson:s,originalJson:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateWorkflow:k,saveNow:N,reload:y}}function PH({data:e,selected:t}){const{config:r,isEntry:n}=e,s=e.type==="end";return o.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[o.jsx(Kn,{type:"target",position:fe.Top,style:{background:r.color,width:8,height:8,border:"none"}}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&o.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),o.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&o.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),o.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!s&&o.jsx(Kn,{type:"source",position:fe.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const OH=m.memo(PH),MH={workflowNode:OH},DH=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function LH({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:s,onEdgeSelect:i}){const a=ly(),[l,c,d]=OD([]),[u,f,p]=MD([]),[h,v]=m.useState(!1),x=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:_,edges:R}=t2(e);(!_.some(D=>D.position.x!==0||D.position.y!==0)||!x.current)&&(_=qg(_,R),x.current=!0),c(_),f(R)},[e,c,f]),m.useEffect(()=>{c(_=>_.map(R=>({...R,selected:R.id===r})))},[r,c]);const w=m.useCallback(_=>{if(!e)return;const T={edge_id:Vq(_.source,_.target,e.edges||[]),from_node_id:_.source,to_node_id:_.target,outcome:"success",label:"",kind:"auto"},D={...e,edges:[...e.edges||[],T]};t(D)},[e,t]),g=m.useCallback((_,R)=>{if(!e)return;const T=e.nodes.map(D=>D.node_id===R.id?{...D,_position:R.position}:D);t({...e,nodes:T})},[e,t]),y=m.useCallback((_,R)=>{s==null||s(R.id)},[s]),b=m.useCallback((_,R)=>{i==null||i(R.id)},[i]),j=m.useCallback(()=>{s==null||s(null),i==null||i(null)},[s,i]),k=m.useCallback(_=>{if(_.key==="Delete"||_.key==="Backspace"){if(r&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(R),s==null||s(null)}else if(n&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(R),i==null||i(null)}}},[r,n,e,t,s,i]),N=m.useCallback(_=>{if(!e)return;const R=Uq(_,e.nodes||[]),T=Gq(_);T.node_id=R;const D=a.getViewport(),$=(-D.x+window.innerWidth/2)/D.zoom,E=(-D.y+window.innerHeight/2)/D.zoom;T._position={x:$-110,y:E-50};const L={...e,nodes:[...e.nodes||[],T]};t(L),v(!1),s==null||s(R)},[e,t,a,s]),S=m.useCallback(()=>{if(!e)return;let{nodes:_,edges:R}=t2(e);_=qg(_,R);const T=e.nodes.map(D=>{const $=_.find(E=>E.id===D.node_id);return $?{...D,_position:$.position}:D});t({...e,nodes:T}),setTimeout(()=>{a.fitView({padding:.2,duration:300})},50)},[e,t,a]),C=m.useCallback(()=>{a.fitView({padding:.2,duration:300})},[a]);return o.jsx("div",{className:"flex-1 relative",onKeyDown:k,tabIndex:0,style:{outline:"none"},children:o.jsxs(uy,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:w,onNodeDragStop:g,onNodeClick:y,onEdgeClick:b,onPaneClick:j,nodeTypes:MH,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[o.jsx(Ro,{position:"top-left",children:o.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>v(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&o.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:DH.map(_=>{const R=gc[_.value]||{};return o.jsxs("button",{onClick:()=>N(_.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[o.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),_.label]},_.value)})})]}),o.jsx("button",{onClick:S,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),o.jsx("button",{onClick:C,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),o.jsx(UD,{position:"bottom-right",nodeColor:_=>{var T;const R=(T=_.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),o.jsx(Ro,{position:"bottom-left",children:o.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(gc).map(([_,R])=>o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},_))})}),o.jsx(Ro,{position:"top-right",children:o.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const zH=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],I2=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],P2=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"work_package",label:"Work Package Gate",produces:"pgc_clarifications.work_package"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],FH=["semantic","structural","hybrid"],$H=["stabilized","blocked","abandoned"],ze={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},_t={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},qH={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function mx(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function xx(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function $s(e){var s;if(!e)return"";const t=e.kind||"role",r=((s=e.fragment_id)==null?void 0:s.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function qs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function fl(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function pl(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function gx({title:e,defaultOpen:t=!1,isOpen:r,onToggle:n,children:s,badge:i}){const[a,l]=m.useState(t),c=r!==void 0,d=c?r:a,u=()=>{c&&n?n():l(!a)};return o.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:o.jsx("path",{d:"M9 18l6-6-6-6"})}),o.jsx("span",{style:{..._t,marginBottom:0},children:e})]}),i&&o.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:i})]}),d&&o.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:s})]})}function vx(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function Bs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function BH({node:e,onChange:t,onDelete:r,templates:n=[],schemas:s=[],roleFragments:i=[],taskFragments:a=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var be,Re,Ie,ne,we,Je,pt,qe,Pe,Be,et,Te,X,Ne,xe,Ct,yt,bt,Zt;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const v=(z,W)=>{const K={...u,[z]:W};f(K),t(K)},x=(z,W)=>{const K={...u.includes,[z]:W},se={...u,includes:K};f(se),t(se)},w=z=>{const W={...u.includes};delete W[z];const K={...u,includes:W};f(K),t(K)},g=()=>{const z={...u.includes,NEW_KEY:""},W={...u,includes:z};f(W),t(W)},y=z=>{const W={...u,internals:z};f(W),t(W)},b=(z,W)=>{const K=u.internals||N(),se={...K.question_generation,[z]:W};y({...K,question_generation:se})},j=(z,W)=>{const K=u.internals||N(),se={...K.question_generation.includes,[z]:W},Le={...K.question_generation,includes:se};y({...K,question_generation:Le})},k=(z,W)=>{const K=u.internals||N(),se={...K.clarification_merge,[z]:W};y({...K,clarification_merge:se})},N=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const S=u.type==="pgc",C=xx(u.task_ref),_=u.includes||{},R=_.ROLE_PROMPT||"",T=_.TASK_PROMPT||"",D=_.OUTPUT_SCHEMA||"",$=_.PGC_CONTEXT||"",E=qs(R),L=qs(T),A=pl(D),P=qs($),M=Object.entries(_).filter(([z])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(z)),I=u.internals||N(),O=xx((be=I.question_generation)==null?void 0:be.template_ref),F=qs((Ie=(Re=I.question_generation)==null?void 0:Re.includes)==null?void 0:Ie.ROLE_PROMPT),q=qs((we=(ne=I.question_generation)==null?void 0:ne.includes)==null?void 0:we.TASK_PROMPT),U=qs((pt=(Je=I.question_generation)==null?void 0:Je.includes)==null?void 0:pt.PGC_CONTEXT),G=pl((qe=I.question_generation)==null?void 0:qe.output_schema_ref),J=xx((Pe=I.clarification_merge)==null?void 0:Pe.template_ref),B=pl((Be=I.clarification_merge)==null?void 0:Be.output_schema_ref),te=z=>{const W=z.target.value;if(!W){v("task_ref","");return}const K=n.find(se=>se.template_id===W);K&&v("task_ref",mx(K))},oe=z=>{const W=z.target.value;if(!W){w("ROLE_PROMPT");return}const K=i.find(se=>se.fragment_id===`role:${W}`||se.id===W);K&&x("ROLE_PROMPT",$s(K))},Q=z=>{const W=z.target.value;if(!W){w("TASK_PROMPT");return}const K=a.find(se=>se.fragment_id===`task:${W}`||se.id===W);K&&x("TASK_PROMPT",$s(K))},H=z=>{const W=z.target.value;if(!W){w("OUTPUT_SCHEMA");return}const K=s.find(se=>se.schema_id===W);K&&x("OUTPUT_SCHEMA",fl(K))},ie=z=>{const W=z.target.value;if(!W){w("PGC_CONTEXT");return}const K=l.find(se=>se.fragment_id===`pgc:${W}`||se.id===W);K&&x("PGC_CONTEXT",$s(K))},ae=z=>{const W=z.target.value,K=P2.find(lt=>lt.value===W),se=(K==null?void 0:K.produces)||`pgc_clarifications.${W}`,Le={...u,gate_kind:W,produces:se};f(Le),t(Le)},pe=z=>{const W=z.target.value;if(!W){b("template_ref","");return}const K=n.find(se=>se.template_id===W);K&&b("template_ref",mx(K))},me=z=>{const W=z.target.value;if(!W){j("ROLE_PROMPT","");return}const K=i.find(se=>se.fragment_id===`role:${W}`||se.id===W);K&&j("ROLE_PROMPT",$s(K))},le=z=>{const W=z.target.value;if(!W){j("TASK_PROMPT","");return}const K=a.find(se=>se.fragment_id===`task:${W}`||se.id===W);K&&j("TASK_PROMPT",$s(K))},V=z=>{const W=z.target.value;if(!W){j("PGC_CONTEXT","");return}const K=l.find(se=>se.fragment_id===`pgc:${W}`||se.id===W);K&&j("PGC_CONTEXT",$s(K))},ee=z=>{const W=z.target.value;if(!W){b("output_schema_ref","");return}const K=s.find(se=>se.schema_id===W);K&&b("output_schema_ref",fl(K))},re=z=>{const W=z.target.value;if(!W){k("template_ref","");return}const K=n.find(se=>se.template_id===W);K&&k("template_ref",mx(K))},je=z=>{const W=z.target.value;if(!W){k("output_schema_ref","");return}const K=s.find(se=>se.schema_id===W);K&&k("output_schema_ref",fl(K))};return o.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:S?"PGC Gate Properties":"Node Properties"}),o.jsx("button",{onClick:()=>r(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Node ID"}),o.jsx("input",{type:"text",value:u.node_id||"",onChange:z=>v("node_id",z.target.value),style:ze})]}),o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Type"}),o.jsx("select",{value:u.type||"task",onChange:z=>v("type",z.target.value),style:ze,children:zH.map(z=>o.jsx("option",{value:z.value,children:z.label},z.value))})]}),S&&o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Gate Kind"}),o.jsx("select",{value:u.gate_kind||"discovery",onChange:ae,style:ze,children:P2.map(z=>o.jsx("option",{value:z.value,children:z.label},z.value))})]}),o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Description"}),o.jsx("textarea",{value:u.description||"",onChange:z=>v("description",z.target.value),rows:2,style:{...ze,resize:"vertical"}})]}),(S||["task","intake_gate"].includes(u.type))&&o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Produces"}),o.jsx("input",{type:"text",value:u.produces||"",onChange:z=>v("produces",z.target.value),placeholder:S?"pgc_clarifications.discovery":"document_type",style:ze})]}),S&&o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{style:qH,children:"Gate Internals"}),o.jsx(gx,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),o.jsxs("select",{value:O||"",onChange:pe,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Template --"}),n.map(z=>o.jsx("option",{value:z.template_id,children:z.name||z.template_id.replace(/_/g," ")},z.template_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),o.jsxs("select",{value:F||"",onChange:me,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Role --"}),i.map(z=>{var K;const W=((K=z.fragment_id)==null?void 0:K.replace("role:",""))||z.id;return o.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),o.jsxs("select",{value:q||"",onChange:le,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Task --"}),a.map(z=>{var K;const W=((K=z.fragment_id)==null?void 0:K.replace("task:",""))||z.id;return o.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),o.jsxs("select",{value:U||"",onChange:V,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(z=>{var K;const W=((K=z.fragment_id)==null?void 0:K.replace("pgc:",""))||z.id;return o.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:G||"",onChange:ee,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>o.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]})}),o.jsx("div",{className:"mt-2",children:o.jsx(gx,{title:"Entry: Operator Answers",badge:"UI",children:o.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Renders:"}),o.jsx("span",{className:"font-mono",children:((et=I.operator_entry)==null?void 0:et.renders)||"question_set"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Captures:"}),o.jsx("span",{className:"font-mono",children:((Te=I.operator_entry)==null?void 0:Te.captures)||"pgc_answers"})]}),o.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),o.jsx("div",{className:"mt-2",children:o.jsx(gx,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((X=I.clarification_merge)==null?void 0:X.internal_type)||"LLM",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),o.jsxs("select",{value:((Ne=I.clarification_merge)==null?void 0:Ne.internal_type)||"LLM",onChange:z=>k("internal_type",z.target.value),style:{...ze,fontSize:11},children:[o.jsx("option",{value:"LLM",children:"LLM"}),o.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((xe=I.clarification_merge)==null?void 0:xe.internal_type)||"LLM")==="LLM"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),o.jsxs("select",{value:J||"",onChange:re,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Template --"}),n.map(z=>o.jsx("option",{value:z.template_id,children:z.name||z.template_id.replace(/_/g," ")},z.template_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:B||"",onChange:je,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>o.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]}),((Ct=I.clarification_merge)==null?void 0:Ct.internal_type)==="MECH"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),o.jsxs("select",{value:Bs((yt=I.clarification_merge)==null?void 0:yt.op_ref)||"",onChange:z=>{const W=z.target.value;if(!W){k("op_ref","");return}const K=d.find(se=>se.op_id===W);K&&k("op_ref",vx(K))},style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(z=>z.type==="merger").map(z=>o.jsx("option",{value:z.op_id,children:z.name},z.op_id))]})]}),((bt=I.clarification_merge)==null?void 0:bt.op_ref)&&(()=>{const z=Bs(I.clarification_merge.op_ref),W=d.find(K=>K.op_id===z);return W?o.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:W.type}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:B||"",onChange:je,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>o.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]}),o.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Internal Type"}),o.jsx("select",{value:u.internal_type||"LLM",onChange:z=>v("internal_type",z.target.value),style:ze,children:I2.map(z=>o.jsx("option",{value:z.value,children:z.label},z.value))}),o.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Zt=I2.find(z=>z.value===(u.internal_type||"LLM")))==null?void 0:Zt.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Interaction Template"}),o.jsxs("select",{value:C||"",onChange:te,style:ze,children:[o.jsx("option",{value:"",children:"-- Select Template --"}),n.map(z=>o.jsx("option",{value:z.template_id,children:z.name||z.template_id.replace(/_/g," ")},z.template_id))]}),u.task_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Mechanical Operation"}),o.jsxs("select",{value:Bs(u.op_ref)||"",onChange:z=>{const W=z.target.value;if(!W){v("op_ref","");return}const K=d.find(se=>se.op_id===W);K&&v("op_ref",vx(K))},style:ze,children:[o.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(z=>{const W=d.filter(K=>K.type===z.type_id);return W.length===0?null:o.jsx("optgroup",{label:z.name,children:W.map(K=>o.jsx("option",{value:K.op_id,children:K.name},K.op_id))},z.type_id)})]}),u.op_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const z=Bs(u.op_ref),W=d.find(se=>se.op_id===z),K=W?c.find(se=>se.type_id===W.type):null;return W?o.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(K==null?void 0:K.name)||W.type}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Output Schema"}),o.jsxs("select",{value:pl(u.output_schema_ref)||"",onChange:z=>{const W=z.target.value;if(!W){v("output_schema_ref","");return}const K=s.find(se=>se.schema_id===W);K&&v("output_schema_ref",fl(K))},style:ze,children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>o.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Entry Operation"}),o.jsxs("select",{value:Bs(u.op_ref)||"",onChange:z=>{const W=z.target.value;if(!W){v("op_ref","");return}const K=d.find(se=>se.op_id===W);K&&v("op_ref",vx(K))},style:ze,children:[o.jsx("option",{value:"",children:"-- Select Entry Operation --"}),d.filter(z=>z.type==="entry").map(z=>o.jsx("option",{value:z.op_id,children:z.name},z.op_id))]}),u.op_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const z=Bs(u.op_ref),W=d.find(se=>se.op_id===z);if(!W)return null;const K=W.config||{};return o.jsxs("div",{className:"p-2 rounded text-xs space-y-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-orange, #f97316)",color:"#fff"},children:"Entry"}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description}),o.jsxs("div",{className:"pt-2 border-t space-y-1",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Renders:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:K.renders||"-"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Captures:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:K.captures||"-"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Layout:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:K.layout||"form"})]})]}),K.entry_prompt&&o.jsxs("div",{className:"p-2 rounded mt-2",style:{background:"var(--bg-panel)"},children:[o.jsx("div",{className:"text-[10px] uppercase mb-1",style:{color:"var(--text-muted)"},children:"Entry Prompt"}),o.jsx("div",{style:{color:"var(--text-primary)"},children:K.entry_prompt})]})]})})(),!u.op_ref&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Select an Entry operation above, or define custom renders/captures below."}),o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Renders"}),o.jsx("input",{type:"text",value:u.renders||"",onChange:z=>v("renders",z.target.value),placeholder:"e.g., question_set",style:ze})]}),o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Captures"}),o.jsx("input",{type:"text",value:u.captures||"",onChange:z=>v("captures",z.target.value),placeholder:"e.g., user_answers",style:ze})]})]})]}),u.type==="qa"&&o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"QA Mode"}),o.jsx("select",{value:u.qa_mode||"semantic",onChange:z=>v("qa_mode",z.target.value),style:ze,children:FH.map(z=>o.jsx("option",{value:z,children:z},z))})]}),u.type==="end"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Terminal Outcome"}),o.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:z=>v("terminal_outcome",z.target.value),style:ze,children:$H.map(z=>o.jsx("option",{value:z,children:z},z))})]}),o.jsxs("div",{children:[o.jsx("label",{style:_t,children:"Gate Outcome"}),o.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:z=>v("gate_outcome",z.target.value),placeholder:"e.g., complete, failed",style:ze})]})]}),o.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:z=>v("requires_qa",z.target.checked)}),"Requires QA"]}),o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:z=>v("non_advancing",z.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&o.jsxs("div",{children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsx("label",{style:_t,children:"Includes"})}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),o.jsxs("select",{value:E||"",onChange:oe,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Role --"}),i.map(z=>{var K;const W=((K=z.fragment_id)==null?void 0:K.replace("role:",""))||z.id;return o.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),o.jsxs("select",{value:L||"",onChange:Q,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Task --"}),a.map(z=>{var K;const W=((K=z.fragment_id)==null?void 0:K.replace("task:",""))||z.id;return o.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:A||"",onChange:H,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(z=>o.jsx("option",{value:z.schema_id,children:z.title||z.schema_id.replace(/_/g," ")},z.schema_id))]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),o.jsxs("select",{value:P||"",onChange:ie,style:{...ze,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(z=>{var K;const W=((K=z.fragment_id)==null?void 0:K.replace("pgc:",""))||z.id;return o.jsx("option",{value:W,children:z.name||(W==null?void 0:W.replace(/_/g," "))},z.fragment_id||z.id)})]})]}),M.length>0&&o.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),o.jsx("div",{className:"space-y-2",children:M.map(([z,W])=>o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"text",value:z,onChange:K=>{const se={...u.includes};delete se[z],se[K.target.value]=W;const Le={...u,includes:se};f(Le),t(Le)},style:{...ze,width:"35%",fontSize:10},placeholder:"KEY"}),o.jsx("input",{type:"text",value:W,onChange:K=>x(z,K.target.value),style:{...ze,flex:1,fontSize:10},placeholder:"path/to/file"}),o.jsx("button",{onClick:()=>w(z),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},z))})]}),o.jsx("button",{onClick:g,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const WH=["auto","user_choice"],HH=["eq","ne","lt","lte","gt","gte"],Xr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ss={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function UH({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[s,i]=m.useState(e);m.useEffect(()=>{i(e)},[e]);const a=(u,f)=>{const p={...s,[u]:f};i(p),r(p)},l=()=>{const u=[...s.conditions||[],{type:"retry_count",operator:"lt",value:2}];a("conditions",u)},c=(u,f,p)=>{const h=[...s.conditions||[]];h[u]={...h[u],[f]:p},a("conditions",h)},d=u=>{const f=(s.conditions||[]).filter((p,h)=>h!==u);a("conditions",f)};return s?o.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),o.jsx("button",{onClick:()=>n(s.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:ss,children:"Edge ID"}),o.jsx("input",{type:"text",value:s.edge_id||"",onChange:u=>a("edge_id",u.target.value),style:Xr})]}),o.jsxs("div",{children:[o.jsx("label",{style:ss,children:"From Node"}),o.jsx("select",{value:s.from_node_id||"",onChange:u=>a("from_node_id",u.target.value),style:Xr,children:t.map(u=>o.jsx("option",{value:u,children:u},u))})]}),o.jsxs("div",{children:[o.jsx("label",{style:ss,children:"To Node"}),o.jsxs("select",{value:s.to_node_id||"",onChange:u=>a("to_node_id",u.target.value||null),style:Xr,children:[o.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>o.jsx("option",{value:u,children:u},u))]})]}),o.jsxs("div",{children:[o.jsx("label",{style:ss,children:"Outcome"}),o.jsx("input",{type:"text",value:s.outcome||"",onChange:u=>a("outcome",u.target.value),placeholder:"success, failed, etc.",style:Xr})]}),o.jsxs("div",{children:[o.jsx("label",{style:ss,children:"Label"}),o.jsx("input",{type:"text",value:s.label||"",onChange:u=>a("label",u.target.value),placeholder:"Human-readable label",style:Xr})]}),o.jsxs("div",{children:[o.jsx("label",{style:ss,children:"Kind"}),o.jsx("select",{value:s.kind||"auto",onChange:u=>a("kind",u.target.value),style:Xr,children:WH.map(u=>o.jsx("option",{value:u,children:u},u))})]}),o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:s.non_advancing||!1,onChange:u=>a("non_advancing",u.target.checked)}),"Non-advancing"]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{style:ss,children:"Conditions"}),o.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),o.jsx("div",{className:"space-y-2",children:(s.conditions||[]).map((u,f)=>o.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:o.jsxs("div",{className:"flex gap-1 items-center",children:[o.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Xr,flex:1,fontSize:10}}),o.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Xr,width:"auto",fontSize:10},children:HH.map(p=>o.jsx("option",{value:p,children:p},p))}),o.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Xr,width:50,fontSize:10}}),o.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const VH={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function GH({workspaceId:e,artifactId:t,onArtifactSave:r,mechanicalOpTypes:n=[],mechanicalOps:s=[]}){var U,G,J;const[i,a]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,v]=m.useState(null),{workflowJson:x,loading:w,error:g,saving:y,lastSaveResult:b,updateWorkflow:j}=XT(e,t,{onSave:B=>{r==null||r(t,B)}}),{templates:k}=GT(),{schemas:N}=KT(),{fragmentsByKind:S}=YT(),C=m.useMemo(()=>{var B;return!l||!x?null:((B=x.nodes)==null?void 0:B.find(te=>te.node_id===l))||null},[l,x]),_=m.useMemo(()=>{var B;return!d||!x?null:((B=x.edges)==null?void 0:B.find(te=>te.edge_id===d))||null},[d,x]),R=m.useMemo(()=>x!=null&&x.nodes?x.nodes.map(B=>B.node_id):[],[x]),T=m.useCallback(B=>{j(B)},[j]),D=m.useCallback(B=>{if(!x)return;const te=x.nodes.map(H=>H.node_id===l?B:H);let oe=x.edges,Q=x.entry_node_ids||[];B.node_id!==l&&(oe=x.edges.map(H=>({...H,from_node_id:H.from_node_id===l?B.node_id:H.from_node_id,to_node_id:H.to_node_id===l?B.node_id:H.to_node_id})),Q=Q.map(H=>H===l?B.node_id:H),c(B.node_id)),j({...x,nodes:te,edges:oe,entry_node_ids:Q})},[x,l,j]),$=m.useCallback(B=>{if(!x)return;const te=x.edges.map(oe=>oe.edge_id===d?B:oe);B.edge_id!==d&&u(B.edge_id),j({...x,edges:te})},[x,d,j]),E=m.useCallback(B=>{x&&(j({...x,nodes:x.nodes.filter(te=>te.node_id!==B),edges:x.edges.filter(te=>te.from_node_id!==B&&te.to_node_id!==B),entry_node_ids:(x.entry_node_ids||[]).filter(te=>te!==B)}),c(null))},[x,j]),L=m.useCallback(B=>{x&&(j({...x,edges:x.edges.filter(te=>te.edge_id!==B)}),u(null))},[x,j]),A=m.useCallback(B=>{c(B),B&&u(null)},[]),P=m.useCallback(B=>{u(B),B&&c(null)},[]),M=m.useCallback(B=>{B==="json"&&x&&(p(JSON.stringify(x,null,2)),v(null)),a(B)},[x]),I=m.useCallback(B=>{const te=B.target.value;p(te);try{const oe=JSON.parse(te);v(null),j(oe)}catch(oe){v(oe.message)}},[j]),O=((U=b==null?void 0:b.tier1_report)==null?void 0:U.results)||[],F=O.filter(B=>B.severity==="error").length,q=O.filter(B=>B.severity==="warning").length;return o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[y&&o.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&o.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),!y&&!g&&x&&o.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((G=x.nodes)==null?void 0:G.length)||0," nodes, ",((J=x.edges)==null?void 0:J.length)||0," edges"]})]})}),o.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>o.jsx("button",{onClick:()=>M(B.id),style:{...VH,color:i===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:i===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),w?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i==="canvas"&&o.jsxs(o.Fragment,{children:[o.jsx(eu,{children:o.jsx(LH,{workflowJson:x,onWorkflowChange:T,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:A,onEdgeSelect:P})}),C&&o.jsx(BH,{node:C,onChange:D,onDelete:E,templates:k,schemas:N,roleFragments:S.role||[],taskFragments:S.task||[],pgcFragments:S.pgc||[],mechanicalOpTypes:n,mechanicalOps:s}),_&&o.jsx(UH,{edge:_,nodeIds:R,onChange:$,onDelete:L})]}),i==="json"&&o.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[o.jsx("textarea",{value:f,onChange:I,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&o.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),i==="metadata"&&o.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:x?o.jsx(KH,{workflow:x}):o.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),O.length>0&&o.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[F>0&&o.jsxs("span",{style:{color:"#ef4444"},children:[F," error",F!==1?"s":""]}),q>0&&o.jsxs("span",{style:{color:"#f59e0b"},children:[q," warning",q!==1?"s":""]}),F===0&&q===0&&o.jsx("span",{style:{color:"#10b981"},children:"Valid"}),o.jsx("span",{style:{color:"var(--text-muted)"},children:O.map(B=>B.message).join(" | ")})]})]})}function KH({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],s=e.thread_ownership||{},i=Object.entries(s),a=e.entry_node_ids||[];return o.jsxs("div",{className:"space-y-4 max-w-lg",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>o.jsxs("div",{children:[o.jsx("label",{style:r,children:l.label}),o.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),o.jsxs("div",{children:[o.jsx("label",{style:r,children:"Entry Node IDs"}),o.jsx("div",{style:t,children:a.length>0?a.join(", "):"-"})]}),i.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),i.map(([l,c])=>o.jsxs("div",{children:[o.jsx("label",{style:r,children:l}),o.jsx("div",{style:t,children:c})]},l))]})]})}function yx({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:s}){const[i,a]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!i)return;const c=d=>{l.current&&!l.current.contains(d.target)&&a(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[i]),t.length===0?null:o.jsxs("div",{ref:l,style:{position:"relative"},children:[o.jsxs("button",{onClick:()=>a(!i),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:s?"var(--text-primary)":"var(--text-muted)",background:s?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:s?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,o.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),i&&o.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>o.jsxs("button",{onClick:()=>{n(c.id),a(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&o.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function bx({label:e,isSelected:t,onClick:r}){return o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function YH({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:s=[],onArtifactSave:i,onCreateDcwWorkflow:a,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var Be,et,Te;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,v]=m.useState("source"),[x,w]=m.useState(null),[g,y]=m.useState(!1),[b,j]=m.useState(null),[k,N]=m.useState(null),[S,C]=m.useState(!1),[_,R]=m.useState(null),[T,D]=m.useState(null),[$,E]=m.useState(!1),[L,A]=m.useState(null),[P,M]=m.useState(null),[I,O]=m.useState(!1),[F,q]=m.useState(null),U=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const X=t.role_prompt_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="role"?null:{roleId:X[2],version:X[3]}},[t==null?void 0:t.role_prompt_ref]),G=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const X=t.template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.template_ref]),J=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const X=t.qa_template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const X=t.pgc_template_ref.split(":");return X.length!==4||X[0]!=="prompt"||X[1]!=="template"?null:{templateId:X[2],version:X[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!U){w(null);return}y(!0),j(null),ye.getRole(U.roleId,U.version).then(X=>{w(X.content)}).catch(X=>{console.error("Failed to load role:",X),j(X.message)}).finally(()=>{y(!1)})},[U]),m.useEffect(()=>{if(!G){N(null);return}C(!0),R(null),ye.getTemplate(G.templateId,G.version).then(X=>{N(X.content)}).catch(X=>{console.error("Failed to load template:",X),R(X.message)}).finally(()=>{C(!1)})},[G]),m.useEffect(()=>{if(!J){D(null);return}E(!0),A(null),ye.getTemplate(J.templateId,J.version).then(X=>{D(X.content)}).catch(X=>{console.error("Failed to load QA template:",X),A(X.message)}).finally(()=>{E(!1)})},[J]),m.useEffect(()=>{if(!B){M(null);return}O(!0),q(null),ye.getTemplate(B.templateId,B.version).then(X=>{M(X.content)}).catch(X=>{console.error("Failed to load PGC template:",X),q(X.message)}).finally(()=>{O(!1)})},[B]);const te=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const X=t.version||t.active_version;return`doctype:${t.doc_type_id}:${X}:${f}`},[t,f]),{content:oe,loading:Q,error:H,saving:ie,isDirty:ae,updateContent:pe,lastSaveResult:me}=Ca(e,te,{onSave:X=>{i==null||i(te,X)}}),le=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],V=m.useMemo(()=>t?le.filter(X=>X.id==="package"?!0:X.id==="role_prompt"?!!t.role_prompt_ref:X.id==="template"?!!t.template_ref:X.id==="qa_template"?!!t.qa_template_ref:X.id==="pgc_template"?!!t.pgc_template_ref:X.id==="workflow"?!0:t.artifacts?t.artifacts[X.id]!=null:!1):[],[t]),ee=c==="task"||c==="schema";m.useEffect(()=>{ee||V.length>0&&!V.find(X=>X.id===f)&&p(V[0].id)},[V,f,ee]);const re=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",je=f==="package",be=f==="schema",Re=f==="workflow",Ie=!re&&!je&&!be&&!Re,ne=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:s.some(X=>X.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,s]),[we,Je]=m.useState(!1),pt=async()=>{if(!(!(t!=null&&t.doc_type_id)||!a)){Je(!0);try{await a(t.doc_type_id)}finally{Je(!1)}}};if(!t&&!r)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),o.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),o.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const qe=c==="task"?"Interaction":c==="schema"?"Schema":null,Pe=!ee&&(f==="task_prompt"||f==="schema");return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),o.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:ee?qe:o.jsxs(o.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),ee&&o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!ee&&o.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[V.find(X=>X.id==="package")&&o.jsx(bx,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),v("source")}}),V.find(X=>X.id==="workflow")&&o.jsx(bx,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),v("source")}}),(()=>{const X=["role_prompt","task_prompt","template"],Ne=V.filter(xe=>X.includes(xe.id)).map(xe=>({id:xe.id,label:xe.id==="role_prompt"?"Role":xe.id==="task_prompt"?"Task":"Template",viewOnly:xe.viewOnly}));return Ne.length===0?null:o.jsx(yx,{label:"Generation",items:Ne,selectedId:X.includes(f)?f:null,onSelect:xe=>{p(xe),v("source")},isGroupActive:X.includes(f)})})(),(()=>{const X=["qa_prompt","qa_template"],Ne=V.filter(xe=>X.includes(xe.id)).map(xe=>({id:xe.id,label:xe.id==="qa_prompt"?"Prompt":"Template",viewOnly:xe.viewOnly}));return Ne.length===0?null:o.jsx(yx,{label:"QA",items:Ne,selectedId:X.includes(f)?f:null,onSelect:xe=>{p(xe),v("source")},isGroupActive:X.includes(f)})})(),(()=>{const X=["pgc_context","pgc_template"],Ne=V.filter(xe=>X.includes(xe.id)).map(xe=>({id:xe.id,label:xe.id==="pgc_context"?"Context":"Template",viewOnly:xe.viewOnly}));return Ne.length===0?null:o.jsx(yx,{label:"PGC",items:Ne,selectedId:X.includes(f)?f:null,onSelect:xe=>{p(xe),v("source")},isGroupActive:X.includes(f)})})(),V.find(X=>X.id==="schema")&&o.jsx(bx,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),v("source")}})]}),!ee&&Ie&&!Pe&&o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>v("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),o.jsx("button",{onClick:()=>v("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((Be=t==null?void 0:t.artifacts)==null?void 0:Be[f])&&o.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),re&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&U&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[U.roleId.replace(/_/g," ")," v",U.version]}),f==="template"&&G&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[G.templateId.replace(/_/g," ")," v",G.version]}),f==="qa_template"&&J&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[J.templateId.replace(/_/g," ")," v",J.version]}),f==="pgc_template"&&B&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Pe&&o.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),be&&((et=t==null?void 0:t.artifacts)==null?void 0:et.schema)&&o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),o.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:Re?ne?o.jsx(GH,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:i,mechanicalOpTypes:d,mechanicalOps:u}):o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 max-w-md",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),o.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),a&&o.jsx("button",{onClick:pt,disabled:we,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:we?"wait":"pointer",opacity:we?.7:1},children:we?"Creating...":"Create Workflow"})]})}):f==="package"?o.jsx(RH,{workspaceId:e,docType:t,roles:n,onSave:i}):f==="role_prompt"?o.jsx(en,{content:x||"",onChange:()=>{},loading:g,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?o.jsx(en,{content:k||"",onChange:()=>{},loading:S,saving:!1,isDirty:!1,error:_,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?o.jsx(en,{content:T||"",onChange:()=>{},loading:$,saving:!1,isDirty:!1,error:L,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?o.jsx(en,{content:P||"",onChange:()=>{},loading:I,saving:!1,isDirty:!1,error:F,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||be?o.jsx(en,{content:oe,onChange:Pe?()=>{}:pe,loading:Q,saving:Pe?!1:ie,isDirty:Pe?!1:ae,error:H,readOnly:Pe,placeholder:`Enter ${((Te=V.find(X=>X.id===f))==null?void 0:Te.label)||"prompt"} content...`,isJson:be}):o.jsx(AH,{workspaceId:e,artifactId:te})}),Ie&&(me==null?void 0:me.tier1)&&!me.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function QH({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:s,loading:i,error:a,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=Ca(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),o.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),o.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(en,{content:s,onChange:d,loading:i,saving:l,isDirty:c,error:a,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const XH=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],wx={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},_x={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function ZH({workspaceId:e,template:t,onArtifactSave:r}){const[n,s]=m.useState("metadata"),[i,a]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:v,error:x,saving:w,isDirty:g,updateContent:y,lastSaveResult:b}=Ca(e,f,{onSave:_=>{r==null||r(f,_)}});m.useEffect(()=>{t&&(a({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const j=m.useCallback((_,R)=>{a(T=>({...T,[_]:R})),c(!0)},[]),k=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const _=$y.dump({name:i.name||null,purpose:i.purpose||null,use_case:i.use_case||null},{lineWidth:-1});await ye.writeArtifact(e,p,_),c(!1),r==null||r(p,{success:!0})}catch(_){console.error("Failed to save metadata:",_),alert(`Failed to save metadata: ${_.message}`)}finally{u(!1)}}},[e,p,i,r]),N=m.useCallback(()=>{l&&k()},[l,k]);if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),o.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const S=i.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase()),C=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:S}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",t.active_version]}),o.jsx("span",{children:""}),o.jsx("span",{children:"Shared Template"}),i.purpose&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:i.purpose})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:C.map(_=>o.jsxs("button",{onClick:()=>s(_.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===_.id?"var(--text-primary)":"var(--text-muted)",background:n===_.id?"var(--bg-canvas)":"transparent",borderBottom:n===_.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[_.label,_.id==="metadata"&&l&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),_.id==="template"&&g&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},_.id))}),n==="metadata"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:_x,children:"Template Name"}),o.jsx("input",{type:"text",value:i.name,onChange:_=>j("name",_.target.value),onBlur:N,placeholder:"e.g., Document Generator",style:wx}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),o.jsxs("div",{children:[o.jsx("label",{style:_x,children:"Template Purpose"}),o.jsx("select",{value:i.purpose,onChange:_=>{j("purpose",_.target.value),setTimeout(()=>k(),0)},style:wx,children:XH.map(_=>o.jsx("option",{value:_.value,children:_.label},_.value))}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),o.jsxs("div",{children:[o.jsx("label",{style:_x,children:"Use Case"}),o.jsx("textarea",{value:i.use_case,onChange:_=>j("use_case",_.target.value),onBlur:N,placeholder:"Describe when and how this template should be used...",rows:4,style:{...wx,resize:"vertical"}}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(en,{content:h,onChange:y,loading:v,saving:w,isDirty:g,error:x,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const so={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function JH({workspaceId:e,schema:t,onArtifactSave:r}){var g;const[n,s]=m.useState("content"),i=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:a,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=Ca(e,i,{onSave:y=>{r==null||r(i,y)}});if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),o.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((g=t.schema_id)==null?void 0:g.replace(/_/g," "))||"Schema",v=t.active_version||t.version||"1.0.0",x=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],w=!e;return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,o.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",v]}),w&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:x.map(y=>o.jsxs("button",{onClick:()=>s(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===y.id?"var(--text-primary)":"var(--text-muted)",background:n===y.id?"var(--bg-canvas)":"transparent",borderBottom:n===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),n==="content"&&o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(en,{content:a,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:w,isJson:!0})}),n==="info"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:so,children:"Schema ID"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),o.jsxs("div",{children:[o.jsx("label",{style:so,children:"Version"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:v})]}),o.jsxs("div",{children:[o.jsx("label",{style:so,children:"Title (from JSON)"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),o.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),o.jsxs("div",{children:[o.jsx("label",{style:so,children:"File Path"}),o.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",v,"/schema.json"]})]}),o.jsxs("div",{children:[o.jsx("label",{style:so,children:"Artifact ID"}),o.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",v]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const eU={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},tU={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},jx={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function rU({workspaceId:e,fragment:t,onArtifactSave:r}){var O;const[n,s]=m.useState("content"),[i,a]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,v]=((O=t==null?void 0:t.fragment_id)==null?void 0:O.split(":"))||[null,null],x=t?h==="role"?`fragment:role:${v}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,w=t&&h==="role"?`fragment:role:${v}:${t.version}:meta`:null,{content:g,loading:y,error:b,saving:j,isDirty:k,updateContent:N,lastSaveResult:S}=Ca(e,x,{onSave:F=>{r==null||r(x,F)}});m.useEffect(()=>{t&&(a({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const C=m.useCallback((F,q)=>{a(U=>({...U,[F]:q})),c(!0)},[]),_=m.useCallback(async()=>{if(!(!e||!w)){u(!0);try{const F=$y.dump({name:i.name||null,intent:i.intent||null,tags:i.tags.length>0?i.tags:null},{lineWidth:-1});await ye.writeArtifact(e,w,F),c(!1),r==null||r(w,{success:!0})}catch(F){console.error("Failed to save metadata:",F),alert(`Failed to save metadata: ${F.message}`)}finally{u(!1)}}},[e,w,i,r]),R=m.useCallback(()=>{l&&w&&_()},[l,w,_]),T=m.useCallback(()=>{const F=f.trim().toLowerCase();F&&!i.tags.includes(F)&&(C("tags",[...i.tags,F]),p(""))},[f,i.tags,C]),D=m.useCallback(F=>{C("tags",i.tags.filter(q=>q!==F))},[i.tags,C]),$=m.useCallback(F=>{F.key==="Enter"&&(F.preventDefault(),T())},[T]);if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),o.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const E=i.name||t.name||t.fragment_id,L=eU[h]||h,A=tU[h]||"var(--text-muted)",P=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],M=!e,I=w&&!M;return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[E,o.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:A,color:"#fff"},children:L})]}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{children:["from ",t.source_doc_type]})]}),M&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:P.map(F=>o.jsxs("button",{onClick:()=>s(F.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===F.id?"var(--text-primary)":"var(--text-muted)",background:n===F.id?"var(--bg-canvas)":"transparent",borderBottom:n===F.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[F.label,F.id==="content"&&k&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),F.id==="metadata"&&l&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},F.id))}),n==="content"&&o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(en,{content:g,onChange:N,loading:y,saving:j,isDirty:k,error:b,placeholder:"Enter prompt content...",readOnly:M})}),n==="metadata"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Kind"}),o.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:A}}),o.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:L})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Name"}),o.jsx("input",{type:"text",value:i.name,onChange:F=>C("name",F.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:jx,disabled:!I}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Intent"}),o.jsx("textarea",{value:i.intent,onChange:F=>C("intent",F.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...jx,resize:"vertical"},disabled:!I}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:i.tags.map(F=>o.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[F,I&&o.jsx("button",{onClick:()=>D(F),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},F))}),I&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:f,onChange:F=>p(F.target.value),onKeyDown:$,placeholder:"Add tag...",style:{...jx,flex:1}}),o.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Source"}),o.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",o.jsx("strong",{children:t.source_doc_type})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!I&&!t.source_doc_type&&o.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(S==null?void 0:S.tier1)&&!S.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const oo={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ao={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function nU({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[r,n]=m.useState(null),[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){n(null),i(null);return}(async()=>{l(!0),d(null);try{const x=await ye.getMechanicalOp(e.op_id);n(x);const w=t.find(g=>g.type_id===x.type);if(w)i(w);else try{const g=await ye.getMechanicalOpType(x.type);i(g)}catch{}}catch(x){console.error("Failed to load mechanical op details:",x),d(x.message),n(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),o.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=r||e;return o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(s==null?void 0:s.name)||u.type}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a&&o.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&o.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!a&&o.jsxs("div",{className:"space-y-6 max-w-2xl",children:[o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:ao,children:"Operation ID"}),o.jsx("div",{style:oo,className:"font-mono",children:u.op_id})]}),o.jsxs("div",{children:[o.jsx("label",{style:ao,children:"Name"}),o.jsx("div",{style:oo,children:u.name})]}),u.description&&o.jsxs("div",{children:[o.jsx("label",{style:ao,children:"Description"}),o.jsx("div",{style:{...oo,whiteSpace:"pre-wrap"},children:u.description})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:ao,children:"Type"}),o.jsx("div",{style:oo,children:u.type})]}),o.jsxs("div",{children:[o.jsx("label",{style:ao,children:"Version"}),o.jsx("div",{style:oo,children:u.active_version||u.version})]})]})]})]}),s&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),o.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxs("span",{style:{fontSize:16},children:[s.icon==="git-merge"&&"",s.icon==="scissors"&&"",s.icon==="check-circle"&&"",s.icon==="shuffle"&&"",s.icon==="git-branch"&&""]}),o.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:s.name}),o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:s.category})]}),o.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description}),o.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=s.inputs)==null?void 0:f.length)>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),s.inputs.map((v,x)=>o.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},x))]}),((p=s.outputs)==null?void 0:p.length)>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),s.outputs.map((v,x)=>o.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},x))]})]})]})]}),u.config&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),o.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),o.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),o.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),o.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),o.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(v=>o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:v},v))})]})]})]}),o.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[o.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",o.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function sU(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(s=>s(n))},t)}const _u=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function zi(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function qy(e){return"nodeType"in e}function Xt(e){var t,r;return e?zi(e)?e:qy(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function By(e){const{Document:t}=Xt(e);return e instanceof t}function Ea(e){return zi(e)?!1:e instanceof Xt(e).HTMLElement}function ZT(e){return e instanceof Xt(e).SVGElement}function Fi(e){return e?zi(e)?e.document:qy(e)?By(e)?e:Ea(e)||ZT(e)?e.ownerDocument:document:document:document}const Vr=_u?m.useLayoutEffect:m.useEffect;function Wy(e){const t=m.useRef(e);return Vr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function iU(){const e=m.useRef(null),t=m.useCallback((n,s)=>{e.current=setInterval(n,s)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function da(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Vr(()=>{r.current!==e&&(r.current=e)},t),r}function Ta(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function kc(e){const t=Wy(e),r=m.useRef(null),n=m.useCallback(s=>{s!==r.current&&(t==null||t(s,r.current)),r.current=s},[]);return[r,n]}function Gg(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Sx={};function Aa(e,t){return m.useMemo(()=>{if(t)return t;const r=Sx[e]==null?0:Sx[e]+1;return Sx[e]=r,e+"-"+r},[e,t])}function JT(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((i,a)=>{const l=Object.entries(a);for(const[c,d]of l){const u=i[c];u!=null&&(i[c]=u+e*d)}return i},{...t})}}const mi=JT(1),fa=JT(-1);function oU(e){return"clientX"in e&&"clientY"in e}function Hy(e){if(!e)return!1;const{KeyboardEvent:t}=Xt(e.target);return t&&e instanceof t}function aU(e){if(!e)return!1;const{TouchEvent:t}=Xt(e.target);return t&&e instanceof t}function Kg(e){if(aU(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return oU(e)?{x:e.clientX,y:e.clientY}:null}const Ti=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Ti.Translate.toString(e),Ti.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),O2="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function lU(e){return e.matches(O2)?e:e.querySelector(O2)}const cU={display:"none"};function uU(e){let{id:t,value:r}=e;return Y.createElement("div",{id:t,style:cU},r)}function dU(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function fU(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const eA=m.createContext(null);function pU(e){const t=m.useContext(eA);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function hU(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:s,event:i}=n;e.forEach(a=>{var l;return(l=a[s])==null?void 0:l.call(a,i)})},[e]),t]}const mU={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},xU={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function gU(e){let{announcements:t=xU,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=mU}=e;const{announce:i,announcement:a}=fU(),l=Aa("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),pU(m.useMemo(()=>({onDragStart(f){let{active:p}=f;i(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&i(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;i(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;i(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;i(t.onDragCancel({active:p,over:h}))}}),[i,t])),!c)return null;const u=Y.createElement(Y.Fragment,null,Y.createElement(uU,{id:n,value:s.draggable}),Y.createElement(dU,{id:l,announcement:a}));return r?ri.createPortal(u,r):u}var ut;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ut||(ut={}));function Nc(){}function Cc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function tA(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Rr=Object.freeze({x:0,y:0});function rA(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function nA(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function vU(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function M2(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function sA(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function D2(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const iA=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=D2(t,t.left,t.top),i=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=rA(D2(c),s);i.push({id:l,data:{droppableContainer:a,value:d}})}}return i.sort(nA)},yU=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=M2(t),i=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=M2(c),u=s.reduce((p,h,v)=>p+rA(d[v],h),0),f=Number((u/4).toFixed(4));i.push({id:l,data:{droppableContainer:a,value:f}})}}return i.sort(nA)};function bU(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-n,l=i-r;if(n<s&&r<i){const c=t.width*t.height,d=e.width*e.height,u=a*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const wU=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const i of n){const{id:a}=i,l=r.get(a);if(l){const c=bU(l,t);c>0&&s.push({id:a,data:{droppableContainer:i,value:c}})}}return s.sort(vU)};function _U(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function oA(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Rr}function jU(e){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return s.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...r})}}const SU=jU(1);function kU(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function NU(e,t,r){const n=kU(t);if(!n)return e;const{scaleX:s,scaleY:i,x:a,y:l}=n,c=e.left-a-(1-s)*parseFloat(r),d=e.top-l-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),u=s?e.width/s:e.width,f=i?e.height/i:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const CU={ignoreTransform:!1};function $i(e,t){t===void 0&&(t=CU);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Xt(e).getComputedStyle(e);d&&(r=NU(r,d,u))}const{top:n,left:s,width:i,height:a,bottom:l,right:c}=r;return{top:n,left:s,width:i,height:a,bottom:l,right:c}}function L2(e){return $i(e,{ignoreTransform:!0})}function EU(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function TU(e,t){return t===void 0&&(t=Xt(e).getComputedStyle(e)),t.position==="fixed"}function AU(e,t){t===void 0&&(t=Xt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?r.test(i):!1})}function ju(e,t){const r=[];function n(s){if(t!=null&&r.length>=t||!s)return r;if(By(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!Ea(s)||ZT(s)||r.includes(s))return r;const i=Xt(e).getComputedStyle(s);return s!==e&&AU(s,i)&&r.push(s),TU(s,i)?r:n(s.parentNode)}return e?n(e):r}function aA(e){const[t]=ju(e,1);return t??null}function kx(e){return!_u||!e?null:zi(e)?e:qy(e)?By(e)||e===Fi(e).scrollingElement?window:Ea(e)?e:null:null}function lA(e){return zi(e)?e.scrollX:e.scrollLeft}function cA(e){return zi(e)?e.scrollY:e.scrollTop}function Yg(e){return{x:lA(e),y:cA(e)}}var xt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(xt||(xt={}));function uA(e){return!_u||!e?!1:e===document.scrollingElement}function dA(e){const t={x:0,y:0},r=uA(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:s,isLeft:i,isBottom:a,isRight:l,maxScroll:n,minScroll:t}}const RU={x:.2,y:.2};function IU(e,t,r,n,s){let{top:i,left:a,right:l,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=RU);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=dA(e),h={x:0,y:0},v={x:0,y:0},x={height:t.height*s.y,width:t.width*s.x};return!d&&i<=t.top+x.height?(h.y=xt.Backward,v.y=n*Math.abs((t.top+x.height-i)/x.height)):!u&&c>=t.bottom-x.height&&(h.y=xt.Forward,v.y=n*Math.abs((t.bottom-x.height-c)/x.height)),!p&&l>=t.right-x.width?(h.x=xt.Forward,v.x=n*Math.abs((t.right-x.width-l)/x.width)):!f&&a<=t.left+x.width&&(h.x=xt.Backward,v.x=n*Math.abs((t.left+x.width-a)/x.width)),{direction:h,speed:v}}function PU(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function fA(e){return e.reduce((t,r)=>mi(t,Yg(r)),Rr)}function OU(e){return e.reduce((t,r)=>t+lA(r),0)}function MU(e){return e.reduce((t,r)=>t+cA(r),0)}function DU(e,t){if(t===void 0&&(t=$i),!e)return;const{top:r,left:n,bottom:s,right:i}=t(e);aA(e)&&(s<=0||i<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const LU=[["x",["left","right"],OU],["y",["top","bottom"],MU]];class Uy{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=ju(r),s=fA(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,l]of LU)for(const c of a)Object.defineProperty(this,c,{get:()=>{const d=l(n),u=s[i]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Io{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var s;(s=this.target)==null||s.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function zU(e){const{EventTarget:t}=Xt(e);return e instanceof t?e:Fi(e)}function Nx(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ur;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ur||(ur={}));function z2(e){e.preventDefault()}function FU(e){e.stopPropagation()}var Ae;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ae||(Ae={}));const pA={start:[Ae.Space,Ae.Enter],cancel:[Ae.Esc],end:[Ae.Space,Ae.Enter,Ae.Tab]},$U=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Ae.Right:return{...r,x:r.x+25};case Ae.Left:return{...r,x:r.x-25};case Ae.Down:return{...r,y:r.y+25};case Ae.Up:return{...r,y:r.y-25}}};class Su{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Io(Fi(r)),this.windowListeners=new Io(Xt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ur.Resize,this.handleCancel),this.windowListeners.add(ur.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ur.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&DU(n),r(Rr)}handleKeyDown(t){if(Hy(t)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:i=pA,coordinateGetter:a=$U,scrollBehavior:l="smooth"}=s,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=n.current,u=d?{x:d.left,y:d.top}:Rr;this.referenceCoordinates||(this.referenceCoordinates=u);const f=a(t,{active:r,context:n.current,currentCoordinates:u});if(f){const p=fa(f,u),h={x:0,y:0},{scrollableAncestors:v}=n.current;for(const x of v){const w=t.code,{isTop:g,isRight:y,isLeft:b,isBottom:j,maxScroll:k,minScroll:N}=dA(x),S=PU(x),C={x:Math.min(w===Ae.Right?S.right-S.width/2:S.right,Math.max(w===Ae.Right?S.left:S.left+S.width/2,f.x)),y:Math.min(w===Ae.Down?S.bottom-S.height/2:S.bottom,Math.max(w===Ae.Down?S.top:S.top+S.height/2,f.y))},_=w===Ae.Right&&!y||w===Ae.Left&&!b,R=w===Ae.Down&&!j||w===Ae.Up&&!g;if(_&&C.x!==f.x){const T=x.scrollLeft+p.x,D=w===Ae.Right&&T<=k.x||w===Ae.Left&&T>=N.x;if(D&&!p.y){x.scrollTo({left:T,behavior:l});return}D?h.x=x.scrollLeft-T:h.x=w===Ae.Right?x.scrollLeft-k.x:x.scrollLeft-N.x,h.x&&x.scrollBy({left:-h.x,behavior:l});break}else if(R&&C.y!==f.y){const T=x.scrollTop+p.y,D=w===Ae.Down&&T<=k.y||w===Ae.Up&&T>=N.y;if(D&&!p.x){x.scrollTo({top:T,behavior:l});return}D?h.y=x.scrollTop-T:h.y=w===Ae.Down?x.scrollTop-k.y:x.scrollTop-N.y,h.y&&x.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,mi(fa(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Su.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=pA,onActivation:s}=t,{active:i}=r;const{code:a}=e.nativeEvent;if(n.start.includes(a)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function F2(e){return!!(e&&"distance"in e)}function $2(e){return!!(e&&"delay"in e)}class Vy{constructor(t,r,n){var s;n===void 0&&(n=zU(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:i}=t,{target:a}=i;this.props=t,this.events=r,this.document=Fi(a),this.documentListeners=new Io(this.document),this.listeners=new Io(n),this.windowListeners=new Io(Xt(a)),this.initialCoordinates=(s=Kg(i))!=null?s:Rr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ur.Resize,this.handleCancel),this.windowListeners.add(ur.DragStart,z2),this.windowListeners.add(ur.VisibilityChange,this.handleCancel),this.windowListeners.add(ur.ContextMenu,z2),this.documentListeners.add(ur.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if($2(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(F2(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ur.Click,FU,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ur.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:l}}=i;if(!s)return;const c=(r=Kg(t))!=null?r:Rr,d=fa(s,c);if(!n&&l){if(F2(l)){if(l.tolerance!=null&&Nx(d,l.tolerance))return this.handleCancel();if(Nx(d,l.distance))return this.handleStart()}if($2(l)&&Nx(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),a(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Ae.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const qU={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ku extends Vy{constructor(t){const{event:r}=t,n=Fi(r.target);super(t,qU,n)}}ku.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const BU={move:{name:"mousemove"},end:{name:"mouseup"}};var Qg;(function(e){e[e.RightClick=2]="RightClick"})(Qg||(Qg={}));class WU extends Vy{constructor(t){super(t,BU,Fi(t.event.target))}}WU.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Qg.RightClick?!1:(n==null||n({event:r}),!0)}}];const Cx={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class HU extends Vy{constructor(t){super(t,Cx)}static setup(){return window.addEventListener(Cx.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Cx.move.name,t)};function t(){}}}HU.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var Po;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Po||(Po={}));var Ec;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ec||(Ec={}));function UU(e){let{acceleration:t,activator:r=Po.Pointer,canScroll:n,draggingRect:s,enabled:i,interval:a=5,order:l=Ec.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=GU({delta:f,disabled:!i}),[v,x]=iU(),w=m.useRef({x:0,y:0}),g=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(r){case Po.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Po.DraggableRect:return s}},[r,s,c]),b=m.useRef(null),j=m.useCallback(()=>{const N=b.current;if(!N)return;const S=w.current.x*g.current.x,C=w.current.y*g.current.y;N.scrollBy(S,C)},[]),k=m.useMemo(()=>l===Ec.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!i||!d.length||!y){x();return}for(const N of k){if((n==null?void 0:n(N))===!1)continue;const S=d.indexOf(N),C=u[S];if(!C)continue;const{direction:_,speed:R}=IU(N,C,y,t,p);for(const T of["x","y"])h[T][_[T]]||(R[T]=0,_[T]=0);if(R.x>0||R.y>0){x(),b.current=N,v(j,a),w.current=R,g.current=_;return}}w.current={x:0,y:0},g.current={x:0,y:0},x()},[t,j,n,x,i,a,JSON.stringify(y),JSON.stringify(h),v,d,k,u,JSON.stringify(p)])}const VU={x:{[xt.Backward]:!1,[xt.Forward]:!1},y:{[xt.Backward]:!1,[xt.Forward]:!1}};function GU(e){let{delta:t,disabled:r}=e;const n=Gg(t);return Ta(s=>{if(r||!n||!s)return VU;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[xt.Backward]:s.x[xt.Backward]||i.x===-1,[xt.Forward]:s.x[xt.Forward]||i.x===1},y:{[xt.Backward]:s.y[xt.Backward]||i.y===-1,[xt.Forward]:s.y[xt.Forward]||i.y===1}}},[r,t,n])}function KU(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Ta(s=>{var i;return t==null?null:(i=n??s)!=null?i:null},[n,t])}function YU(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:s}=n,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,n)}));return[...r,...i]},[]),[e,t])}var pa;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(pa||(pa={}));var Xg;(function(e){e.Optimized="optimized"})(Xg||(Xg={}));const q2=new Map;function QU(e,t){let{dragging:r,dependencies:n,config:s}=t;const[i,a]=m.useState(null),{frequency:l,measure:c,strategy:d}=s,u=m.useRef(e),f=w(),p=da(f),h=m.useCallback(function(g){g===void 0&&(g=[]),!p.current&&a(y=>y===null?g:y.concat(g.filter(b=>!y.includes(b))))},[p]),v=m.useRef(null),x=Ta(g=>{if(f&&!r)return q2;if(!g||g===q2||u.current!==e||i!=null){const y=new Map;for(let b of e){if(!b)continue;if(i&&i.length>0&&!i.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const j=b.node.current,k=j?new Uy(c(j),j):null;b.rect.current=k,k&&y.set(b.id,k)}return y}return g},[e,i,r,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),m.useEffect(()=>{f||typeof l!="number"||v.current!==null||(v.current=setTimeout(()=>{h(),v.current=null},l))},[l,f,h,...n]),{droppableRects:x,measureDroppableContainers:h,measuringScheduled:i!=null};function w(){switch(d){case pa.Always:return!1;case pa.BeforeDragging:return r;default:return!r}}}function hA(e,t){return Ta(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function XU(e,t){return hA(e,t)}function ZU(e){let{callback:t,disabled:r}=e;const n=Wy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(n)},[n,r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Nu(e){let{callback:t,disabled:r}=e;const n=Wy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(n)},[r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function JU(e){return new Uy($i(e),e)}function B2(e,t,r){t===void 0&&(t=JU);const[n,s]=m.useState(null);function i(){s(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??r)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const a=ZU({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),l=Nu({callback:i});return Vr(()=>{i(),e?(l==null||l.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),a==null||a.disconnect())},[e]),n}function eV(e){const t=hA(e);return oA(e,t)}const W2=[];function tV(e){const t=m.useRef(e),r=Ta(n=>e?n&&n!==W2&&e&&t.current&&e.parentNode===t.current.parentNode?n:ju(e):W2,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function rV(e){const[t,r]=m.useState(null),n=m.useRef(e),s=m.useCallback(i=>{const a=kx(i.target);a&&r(l=>l?(l.set(a,Yg(a)),new Map(l)):null)},[]);return m.useEffect(()=>{const i=n.current;if(e!==i){a(i);const l=e.map(c=>{const d=kx(c);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,Yg(d)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{a(e),a(i)};function a(l){l.forEach(c=>{const d=kx(c);d==null||d.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>mi(i,a),Rr):fA(e):Rr,[e,t])}function H2(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Rr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?fa(e,r.current):Rr}function nV(e){m.useEffect(()=>{if(!_u)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function sV(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:s,handler:i}=n;return r[s]=a=>{i(a,t)},r},{}),[e,t])}function mA(e){return m.useMemo(()=>e?EU(e):null,[e])}const U2=[];function iV(e,t){t===void 0&&(t=$i);const[r]=e,n=mA(r?Xt(r):null),[s,i]=m.useState(U2);function a(){i(()=>e.length?e.map(c=>uA(c)?n:new Uy(t(c),c)):U2)}const l=Nu({callback:a});return Vr(()=>{l==null||l.disconnect(),a(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),s}function oV(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ea(t)?t:e}function aV(e){let{measure:t}=e;const[r,n]=m.useState(null),s=m.useCallback(d=>{for(const{target:u}of d)if(Ea(u)){n(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),i=Nu({callback:s}),a=m.useCallback(d=>{const u=oV(d);i==null||i.disconnect(),u&&(i==null||i.observe(u)),n(u?t(u):null)},[t,i]),[l,c]=kc(a);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const lV=[{sensor:ku,options:{}},{sensor:Su,options:{}}],cV={current:{}},Pl={draggable:{measure:L2},droppable:{measure:L2,strategy:pa.WhileDragging,frequency:Xg.Optimized},dragOverlay:{measure:$i}};class Oo extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const uV={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Oo,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Nc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Pl,measureDroppableContainers:Nc,windowRect:null,measuringScheduled:!1},dV={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Nc,draggableNodes:new Map,over:null,measureDroppableContainers:Nc},Cu=m.createContext(dV),xA=m.createContext(uV);function fV(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Oo}}}function pV(e,t){switch(t.type){case ut.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ut.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ut.DragEnd:case ut.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ut.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new Oo(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case ut.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const a=new Oo(e.droppable.containers);return a.set(r,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case ut.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const i=new Oo(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function hV(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:s}=m.useContext(Cu),i=Gg(n),a=Gg(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&i&&a!=null){if(!Hy(i)||document.activeElement===i.target)return;const l=s.get(a);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=lU(u);if(f){f.focus();break}}})}},[n,t,s,a,i]),null}function mV(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...n}),r):r}function xV(e){return m.useMemo(()=>({draggable:{...Pl.draggable,...e==null?void 0:e.draggable},droppable:{...Pl.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Pl.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function gV(e){let{activeNode:t,measure:r,initialRect:n,config:s=!0}=e;const i=m.useRef(!1),{x:a,y:l}=typeof s=="boolean"?{x:s,y:s}:s;Vr(()=>{if(!a&&!l||!t){i.current=!1;return}if(i.current||!n)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=r(d),f=oA(u,n);if(a||(f.x=0),l||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=aA(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,a,l,n,r])}const gA=m.createContext({...Rr,scaleX:1,scaleY:1});var Cn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Cn||(Cn={}));const vA=m.memo(function(t){var r,n,s,i;let{id:a,accessibility:l,autoScroll:c=!0,children:d,sensors:u=lV,collisionDetection:f=wU,measuring:p,modifiers:h,...v}=t;const x=m.useReducer(pV,void 0,fV),[w,g]=x,[y,b]=hU(),[j,k]=m.useState(Cn.Uninitialized),N=j===Cn.Initialized,{draggable:{active:S,nodes:C,translate:_},droppable:{containers:R}}=w,T=S!=null?C.get(S):null,D=m.useRef({initial:null,translated:null}),$=m.useMemo(()=>{var se;return S!=null?{id:S,data:(se=T==null?void 0:T.data)!=null?se:cV,rect:D}:null},[S,T]),E=m.useRef(null),[L,A]=m.useState(null),[P,M]=m.useState(null),I=da(v,Object.values(v)),O=Aa("DndDescribedBy",a),F=m.useMemo(()=>R.getEnabled(),[R]),q=xV(p),{droppableRects:U,measureDroppableContainers:G,measuringScheduled:J}=QU(F,{dragging:N,dependencies:[_.x,_.y],config:q.droppable}),B=KU(C,S),te=m.useMemo(()=>P?Kg(P):null,[P]),oe=K(),Q=XU(B,q.draggable.measure);gV({activeNode:S!=null?C.get(S):null,config:oe.layoutShiftCompensation,initialRect:Q,measure:q.draggable.measure});const H=B2(B,q.draggable.measure,Q),ie=B2(B?B.parentElement:null),ae=m.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:U,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),pe=R.getNodeFor((r=ae.current.over)==null?void 0:r.id),me=aV({measure:q.dragOverlay.measure}),le=(n=me.nodeRef.current)!=null?n:B,V=N?(s=me.rect)!=null?s:H:null,ee=!!(me.nodeRef.current&&me.rect),re=eV(ee?null:H),je=mA(le?Xt(le):null),be=tV(N?pe??B:null),Re=iV(be),Ie=mV(h,{transform:{x:_.x-re.x,y:_.y-re.y,scaleX:1,scaleY:1},activatorEvent:P,active:$,activeNodeRect:H,containerNodeRect:ie,draggingNodeRect:V,over:ae.current.over,overlayNodeRect:me.rect,scrollableAncestors:be,scrollableAncestorRects:Re,windowRect:je}),ne=te?mi(te,_):null,we=rV(be),Je=H2(we),pt=H2(we,[H]),qe=mi(Ie,Je),Pe=V?SU(V,Ie):null,Be=$&&Pe?f({active:$,collisionRect:Pe,droppableRects:U,droppableContainers:F,pointerCoordinates:ne}):null,et=sA(Be,"id"),[Te,X]=m.useState(null),Ne=ee?Ie:mi(Ie,pt),xe=_U(Ne,(i=Te==null?void 0:Te.rect)!=null?i:null,H),Ct=m.useRef(null),yt=m.useCallback((se,Le)=>{let{sensor:lt,options:lr}=Le;if(E.current==null)return;const Et=C.get(E.current);if(!Et)return;const wt=se.nativeEvent,qt=new lt({active:E.current,activeNode:Et,event:wt,options:lr,context:ae,onAbort(nt){if(!C.get(nt))return;const{onDragAbort:de}=I.current,He={id:nt};de==null||de(He),y({type:"onDragAbort",event:He})},onPending(nt,ue,de,He){if(!C.get(nt))return;const{onDragPending:ts}=I.current,Dr={id:nt,constraint:ue,initialCoordinates:de,offset:He};ts==null||ts(Dr),y({type:"onDragPending",event:Dr})},onStart(nt){const ue=E.current;if(ue==null)return;const de=C.get(ue);if(!de)return;const{onDragStart:He}=I.current,wr={activatorEvent:wt,active:{id:ue,data:de.data,rect:D}};ri.unstable_batchedUpdates(()=>{He==null||He(wr),k(Cn.Initializing),g({type:ut.DragStart,initialCoordinates:nt,active:ue}),y({type:"onDragStart",event:wr}),A(Ct.current),M(wt)})},onMove(nt){g({type:ut.DragMove,coordinates:nt})},onEnd:Mr(ut.DragEnd),onCancel:Mr(ut.DragCancel)});Ct.current=qt;function Mr(nt){return async function(){const{active:de,collisions:He,over:wr,scrollAdjustedTranslate:ts}=ae.current;let Dr=null;if(de&&ts){const{cancelDrop:rs}=I.current;Dr={activatorEvent:wt,active:de,collisions:He,delta:ts,over:wr},nt===ut.DragEnd&&typeof rs=="function"&&await Promise.resolve(rs(Dr))&&(nt=ut.DragCancel)}E.current=null,ri.unstable_batchedUpdates(()=>{g({type:nt}),k(Cn.Uninitialized),X(null),A(null),M(null),Ct.current=null;const rs=nt===ut.DragEnd?"onDragEnd":"onDragCancel";if(Dr){const qi=I.current[rs];qi==null||qi(Dr),y({type:rs,event:Dr})}})}}},[C]),bt=m.useCallback((se,Le)=>(lt,lr)=>{const Et=lt.nativeEvent,wt=C.get(lr);if(E.current!==null||!wt||Et.dndKit||Et.defaultPrevented)return;const qt={active:wt};se(lt,Le.options,qt)===!0&&(Et.dndKit={capturedBy:Le.sensor},E.current=lr,yt(lt,Le))},[C,yt]),Zt=YU(u,bt);nV(u),Vr(()=>{H&&j===Cn.Initializing&&k(Cn.Initialized)},[H,j]),m.useEffect(()=>{const{onDragMove:se}=I.current,{active:Le,activatorEvent:lt,collisions:lr,over:Et}=ae.current;if(!Le||!lt)return;const wt={active:Le,activatorEvent:lt,collisions:lr,delta:{x:qe.x,y:qe.y},over:Et};ri.unstable_batchedUpdates(()=>{se==null||se(wt),y({type:"onDragMove",event:wt})})},[qe.x,qe.y]),m.useEffect(()=>{const{active:se,activatorEvent:Le,collisions:lt,droppableContainers:lr,scrollAdjustedTranslate:Et}=ae.current;if(!se||E.current==null||!Le||!Et)return;const{onDragOver:wt}=I.current,qt=lr.get(et),Mr=qt&&qt.rect.current?{id:qt.id,rect:qt.rect.current,data:qt.data,disabled:qt.disabled}:null,nt={active:se,activatorEvent:Le,collisions:lt,delta:{x:Et.x,y:Et.y},over:Mr};ri.unstable_batchedUpdates(()=>{X(Mr),wt==null||wt(nt),y({type:"onDragOver",event:nt})})},[et]),Vr(()=>{ae.current={activatorEvent:P,active:$,activeNode:B,collisionRect:Pe,collisions:Be,droppableRects:U,draggableNodes:C,draggingNode:le,draggingNodeRect:V,droppableContainers:R,over:Te,scrollableAncestors:be,scrollAdjustedTranslate:qe},D.current={initial:V,translated:Pe}},[$,B,Be,Pe,C,le,V,U,R,Te,be,qe]),UU({...oe,delta:_,draggingRect:Pe,pointerCoordinates:ne,scrollableAncestors:be,scrollableAncestorRects:Re});const z=m.useMemo(()=>({active:$,activeNode:B,activeNodeRect:H,activatorEvent:P,collisions:Be,containerNodeRect:ie,dragOverlay:me,draggableNodes:C,droppableContainers:R,droppableRects:U,over:Te,measureDroppableContainers:G,scrollableAncestors:be,scrollableAncestorRects:Re,measuringConfiguration:q,measuringScheduled:J,windowRect:je}),[$,B,H,P,Be,ie,me,C,R,U,Te,G,be,Re,q,J,je]),W=m.useMemo(()=>({activatorEvent:P,activators:Zt,active:$,activeNodeRect:H,ariaDescribedById:{draggable:O},dispatch:g,draggableNodes:C,over:Te,measureDroppableContainers:G}),[P,Zt,$,H,g,O,C,Te,G]);return Y.createElement(eA.Provider,{value:b},Y.createElement(Cu.Provider,{value:W},Y.createElement(xA.Provider,{value:z},Y.createElement(gA.Provider,{value:xe},d)),Y.createElement(hV,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Y.createElement(gU,{...l,hiddenTextDescribedById:O}));function K(){const se=(L==null?void 0:L.autoScrollEnabled)===!1,Le=typeof c=="object"?c.enabled===!1:c===!1,lt=N&&!se&&!Le;return typeof c=="object"?{...c,enabled:lt}:{enabled:lt}}}),vV=m.createContext(null),V2="button",yV="Draggable";function bV(e){let{id:t,data:r,disabled:n=!1,attributes:s}=e;const i=Aa(yV),{activators:a,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(Cu),{role:h=V2,roleDescription:v="draggable",tabIndex:x=0}=s??{},w=(c==null?void 0:c.id)===t,g=m.useContext(w?gA:vV),[y,b]=kc(),[j,k]=kc(),N=sV(a,t),S=da(r);Vr(()=>(f.set(t,{id:t,key:i,node:y,activatorNode:j,data:S}),()=>{const _=f.get(t);_&&_.key===i&&f.delete(t)}),[f,t]);const C=m.useMemo(()=>({role:h,tabIndex:x,"aria-disabled":n,"aria-pressed":w&&h===V2?!0:void 0,"aria-roledescription":v,"aria-describedby":u.draggable}),[n,h,x,w,v,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:C,isDragging:w,listeners:n?void 0:N,node:y,over:p,setNodeRef:b,setActivatorNodeRef:k,transform:g}}function wV(){return m.useContext(xA)}const _V="Droppable",jV={timeout:25};function SV(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:s}=e;const i=Aa(_V),{active:a,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(Cu),u=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:v,updateMeasurementsFor:x,timeout:w}={...jV,...s},g=da(x??n),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(g.current)?g.current:[g.current]),h.current=null},w)},[w]),b=Nu({callback:y,disabled:v||!a}),j=m.useCallback((C,_)=>{b&&(_&&(b.unobserve(_),f.current=!1),C&&b.observe(C))},[b]),[k,N]=kc(j),S=da(t);return m.useEffect(()=>{!b||!k.current||(b.disconnect(),f.current=!1,b.observe(k.current))},[k,b]),m.useEffect(()=>(l({type:ut.RegisterDroppable,element:{id:n,key:i,disabled:r,node:k,rect:p,data:S}}),()=>l({type:ut.UnregisterDroppable,key:i,id:n})),[n]),m.useEffect(()=>{r!==u.current.disabled&&(l({type:ut.SetDroppableDisabled,id:n,key:i,disabled:r}),u.current.disabled=r)},[n,i,r,l]),{active:a,rect:p,isOver:(c==null?void 0:c.id)===n,node:k,over:c,setNodeRef:N}}function Eu(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function kV(e,t){return e.reduce((r,n,s)=>{const i=t.get(n);return i&&(r[s]=i),r},Array(e.length))}function hl(e){return e!==null&&e>=0}function NV(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function CV(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const yA=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const i=Eu(t,n,r),a=t[s],l=i[s];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},ml={scaleX:1,scaleY:1},bA=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:i,overIndex:a}=e;const l=(t=i[r])!=null?t:n;if(!l)return null;if(s===r){const d=i[a];return d?{x:0,y:r<a?d.top+d.height-(l.top+l.height):d.top-l.top,...ml}:null}const c=EV(i,s,r);return s>r&&s<=a?{x:0,y:-l.height-c,...ml}:s<r&&s>=a?{x:0,y:l.height+c,...ml}:{x:0,y:0,...ml}};function EV(e,t,r){const n=e[t],s=e[t-1],i=e[t+1];return n?r<t?s?n.top-(s.top+s.height):i?i.top-(n.top+n.height):0:i?i.top-(n.top+n.height):s?n.top-(s.top+s.height):0:0}const wA="Sortable",_A=Y.createContext({activeIndex:-1,containerId:wA,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:yA,disabled:{draggable:!1,droppable:!1}});function jA(e){let{children:t,id:r,items:n,strategy:s=yA,disabled:i=!1}=e;const{active:a,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=wV(),f=Aa(wA,r),p=l.rect!==null,h=m.useMemo(()=>n.map(N=>typeof N=="object"&&"id"in N?N.id:N),[n]),v=a!=null,x=a?h.indexOf(a.id):-1,w=d?h.indexOf(d.id):-1,g=m.useRef(h),y=!NV(h,g.current),b=w!==-1&&x===-1||y,j=CV(i);Vr(()=>{y&&v&&u(h)},[y,h,v,u]),m.useEffect(()=>{g.current=h},[h]);const k=m.useMemo(()=>({activeIndex:x,containerId:f,disabled:j,disableTransforms:b,items:h,overIndex:w,useDragOverlay:p,sortedRects:kV(h,c),strategy:s}),[x,f,j.draggable,j.droppable,b,h,w,c,p,s]);return Y.createElement(_A.Provider,{value:k},t)}const TV=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return Eu(r,n,s).indexOf(t)},AV=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:i,newIndex:a,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!n||l!==i&&s===a?!1:r?!0:a!==s&&t===c},RV={duration:200,easing:"ease"},SA="transform",IV=Ti.Transition.toString({property:SA,duration:0,easing:"linear"}),PV={roleDescription:"sortable"};function OV(e){let{disabled:t,index:r,node:n,rect:s}=e;const[i,a]=m.useState(null),l=m.useRef(r);return Vr(()=>{if(!t&&r!==l.current&&n.current){const c=s.current;if(c){const d=$i(n.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&a(u)}}r!==l.current&&(l.current=r)},[t,r,n,s]),m.useEffect(()=>{i&&a(null)},[i]),i}function kA(e){let{animateLayoutChanges:t=AV,attributes:r,disabled:n,data:s,getNewIndex:i=TV,id:a,strategy:l,resizeObserverConfig:c,transition:d=RV}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:v,sortedRects:x,overIndex:w,useDragOverlay:g,strategy:y}=m.useContext(_A),b=MV(n,h),j=u.indexOf(a),k=m.useMemo(()=>({sortable:{containerId:f,index:j,items:u},...s}),[f,s,j,u]),N=m.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:S,node:C,isOver:_,setNodeRef:R}=SV({id:a,data:k,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...c}}),{active:T,activatorEvent:D,activeNodeRect:$,attributes:E,setNodeRef:L,listeners:A,isDragging:P,over:M,setActivatorNodeRef:I,transform:O}=bV({id:a,data:k,attributes:{...PV,...r},disabled:b.draggable}),F=sU(R,L),q=!!T,U=q&&!v&&hl(p)&&hl(w),G=!g&&P,J=G&&U?O:null,te=U?J??(l??y)({rects:x,activeNodeRect:$,activeIndex:p,overIndex:w,index:j}):null,oe=hl(p)&&hl(w)?i({id:a,items:u,activeIndex:p,overIndex:w}):j,Q=T==null?void 0:T.id,H=m.useRef({activeId:Q,items:u,newIndex:oe,containerId:f}),ie=u!==H.current.items,ae=t({active:T,containerId:f,isDragging:P,isSorting:q,id:a,index:j,items:u,newIndex:H.current.newIndex,previousItems:H.current.items,previousContainerId:H.current.containerId,transition:d,wasDragging:H.current.activeId!=null}),pe=OV({disabled:!ae,index:j,node:C,rect:S});return m.useEffect(()=>{q&&H.current.newIndex!==oe&&(H.current.newIndex=oe),f!==H.current.containerId&&(H.current.containerId=f),u!==H.current.items&&(H.current.items=u)},[q,oe,f,u]),m.useEffect(()=>{if(Q===H.current.activeId)return;if(Q!=null&&H.current.activeId==null){H.current.activeId=Q;return}const le=setTimeout(()=>{H.current.activeId=Q},50);return()=>clearTimeout(le)},[Q]),{active:T,activeIndex:p,attributes:E,data:k,rect:S,index:j,newIndex:oe,items:u,isOver:_,isSorting:q,isDragging:P,listeners:A,node:C,overIndex:w,over:M,setNodeRef:F,setActivatorNodeRef:I,setDroppableNodeRef:R,setDraggableNodeRef:L,transform:pe??te,transition:me()};function me(){if(pe||ie&&H.current.newIndex===j)return IV;if(!(G&&!Hy(D)||!d)&&(q||ae))return Ti.Transition.toString({...d,property:SA})}}function MV(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Tc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const DV=[Ae.Down,Ae.Right,Ae.Up,Ae.Left],NA=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:l}}=t;if(DV.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];i.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=s.get(f.id);if(p)switch(e.code){case Ae.Down:n.top<p.top&&c.push(f);break;case Ae.Up:n.top>p.top&&c.push(f);break;case Ae.Left:n.left>p.left&&c.push(f);break;case Ae.Right:n.left<p.left&&c.push(f);break}});const d=yU({collisionRect:n,droppableRects:s,droppableContainers:c});let u=sA(d,"id");if(u===(a==null?void 0:a.id)&&d.length>1&&(u=d[1].id),u!=null){const f=i.get(r.id),p=i.get(u),h=p?s.get(p.id):null,v=p==null?void 0:p.node.current;if(v&&h&&f&&p){const w=ju(v).some((N,S)=>l[S]!==N),g=CA(f,p),y=LV(f,p),b=w||!g?{x:0,y:0}:{x:y?n.width-h.width:0,y:y?n.height-h.height:0},j={x:h.left,y:h.top};return b.x&&b.y?j:fa(j,b)}}}};function CA(e,t){return!Tc(e)||!Tc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function LV(e,t){return!Tc(e)||!Tc(t)||!CA(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const zV={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},zr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},cr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},EA={step_id:"new_step",produces:"",scope:"",inputs:[]},FV={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function $V({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:s,onNavigateToWorkflow:i}){const[a,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:v,error:x,saving:w,updateWorkflow:g}=XT(e,p,{onSave:_=>{n==null||n(p,_)}}),y=m.useCallback(_=>{_==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(_)},[h]),b=m.useCallback(_=>{const R=_.target.value;d(R);try{const T=JSON.parse(R);f(null),g(T)}catch(T){f(T.message)}},[g]),j=m.useCallback((_,R)=>{if(!h)return;const T=[...h.steps];T[_]=R,g({...h,steps:T})},[h,g]),k=m.useCallback(_=>{if(!h)return;const R=h.steps.filter((T,D)=>D!==_);g({...h,steps:R})},[h,g]),N=m.useCallback(_=>{var T,D;if(!h)return;const R=_==="iteration"?{...FV,step_id:`new_iteration_${(((T=h.steps)==null?void 0:T.length)||0)+1}`}:{...EA,step_id:`new_step_${(((D=h.steps)==null?void 0:D.length)||0)+1}`};g({...h,steps:[...h.steps||[],R]})},[h,g]),S=m.useCallback((_,R)=>{if(!h)return;const T=Eu(h.steps,_,R);g({...h,steps:T})},[h,g]),C=m.useCallback(()=>{!s||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&s(t.workflow_id)},[s,t]);return t?o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[w&&o.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),x&&o.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:x}),s&&o.jsx("button",{onClick:C,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),o.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(_=>o.jsx("button",{onClick:()=>y(_.id),style:{...zV,color:a===_.id?"var(--text-primary)":"var(--text-muted)",borderBottom:a===_.id?"2px solid var(--action-primary)":"2px solid transparent"},children:_.label},_.id))}),v?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):o.jsxs("div",{className:"flex-1 overflow-hidden",children:[a==="steps"&&o.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[o.jsx(qV,{steps:(h==null?void 0:h.steps)||[],documentTypes:r,onStepChange:j,onStepDelete:k,onReorder:S}),o.jsxs("div",{className:"flex gap-2 mt-3",children:[o.jsx("button",{onClick:()=>N("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),o.jsx("button",{onClick:()=>N("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),a==="json"&&o.jsxs("div",{className:"h-full flex flex-col p-4",children:[o.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&o.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),a==="metadata"&&o.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?o.jsx(UV,{workflow:h,onUpdateWorkflow:g,onNavigateToWorkflow:i}):o.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),o.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function qV({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const i=tA(Cc(ku,{activationConstraint:{distance:5}}),Cc(Su,{coordinateGetter:NA})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?o.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):o.jsx(vA,{sensors:i,collisionDetection:iA,onDragEnd:l,children:o.jsx(jA,{items:a,strategy:bA,children:e.map((c,d)=>o.jsx(BV,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function BV({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:i,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=kA({id:e.step_id}),f={transform:Ti.Transform.toString(c),transition:d,opacity:u?.5:1};return o.jsx("div",{ref:l,style:f,children:o.jsx(TA,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...i,...a}})})}function TA({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s,dragHandleProps:i,depth:a=0}){var N,S,C;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(_,R)=>{const T={...l,[_]:R};c(T),n(t,T)},h=(_,R)=>{const T={...l.iterate_over,[_]:R},D={...l,iterate_over:T};c(D),n(t,D)},v=()=>{const _=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:_};c(R),n(t,R)},x=(_,R,T)=>{const D=[...l.inputs||[]];D[_]={...D[_],[R]:T};const $={...l,inputs:D};c($),n(t,$)},w=_=>{const R=(l.inputs||[]).filter((D,$)=>$!==_),T={...l,inputs:R};c(T),n(t,T)},g=m.useCallback((_,R)=>{const T=[...l.steps||[]];T[_]=R;const D={...l,steps:T};c(D),n(t,D)},[l,t,n]),y=m.useCallback(_=>{const R=(l.steps||[]).filter((D,$)=>$!==_),T={...l,steps:R};c(T),n(t,T)},[l,t,n]),b=m.useCallback(()=>{var T;const _=[...l.steps||[],{...EA,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],R={...l,steps:_};c(R),n(t,R)},[l,t,n]),j=m.useCallback((_,R)=>{const T=Eu(l.steps||[],_,R),D={...l,steps:T};c(D),n(t,D)},[l,t,n]),k={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:a*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return o.jsxs("div",{style:k,children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[i&&o.jsx("span",{...i,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:o.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[o.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),o.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),o.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),o.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),o.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),o.jsx("span",{style:{flex:1}}),o.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?o.jsx("path",{d:"M18 15l-6-6-6 6"}):o.jsx("path",{d:"M6 9l6 6 6-6"})})}),o.jsx("button",{onClick:()=>s(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&o.jsxs("div",{className:"p-3 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Step ID"}),o.jsx("input",{type:"text",value:l.step_id||"",onChange:_=>p("step_id",_.target.value),style:zr})]}),f?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Doc Type"}),o.jsxs("select",{value:((N=l.iterate_over)==null?void 0:N.doc_type)||"",onChange:_=>h("doc_type",_.target.value),style:zr,children:[o.jsx("option",{value:"",children:"-- Select --"}),r.map(_=>o.jsx("option",{value:_.doc_type_id,children:_.doc_type_id},_.doc_type_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Collection Field"}),o.jsx("input",{type:"text",value:((S=l.iterate_over)==null?void 0:S.collection_field)||"",onChange:_=>h("collection_field",_.target.value),style:zr})]}),o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Entity Type"}),o.jsx("input",{type:"text",value:((C=l.iterate_over)==null?void 0:C.entity_type)||"",onChange:_=>h("entity_type",_.target.value),style:zr})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Scope"}),o.jsx("input",{type:"text",value:l.scope||"",onChange:_=>p("scope",_.target.value),style:zr})]}),o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{style:cr,children:"Nested Steps"}),o.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),o.jsx(WV,{steps:l.steps||[],documentTypes:r,onStepChange:g,onStepDelete:y,onReorder:j})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Produces"}),o.jsxs("select",{value:l.produces||"",onChange:_=>p("produces",_.target.value),style:zr,children:[o.jsx("option",{value:"",children:"-- Select document type --"}),r.map(_=>o.jsx("option",{value:_.doc_type_id,children:_.doc_type_id},_.doc_type_id))]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Scope"}),o.jsx("input",{type:"text",value:l.scope||"",onChange:_=>p("scope",_.target.value),placeholder:"project",style:zr})]}),o.jsxs("div",{children:[o.jsx("label",{style:cr,children:"Creates Entities"}),o.jsx("input",{type:"text",value:l.creates_entities||"",onChange:_=>p("creates_entities",_.target.value||void 0),placeholder:"e.g., epic",style:zr})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{style:cr,children:"Inputs"}),o.jsx("button",{onClick:v,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?o.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):o.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((_,R)=>o.jsxs("div",{className:"flex gap-1 items-end",children:[o.jsxs("div",{style:{flex:1},children:[R===0&&o.jsx("label",{style:{...cr,fontSize:9},children:"Doc/Entity Type"}),o.jsxs("select",{value:_.doc_type||_.entity_type||"",onChange:T=>{const D=T.target.value;_.entity_type!==void 0?x(R,"entity_type",D):x(R,"doc_type",D)},style:{...zr,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select --"}),r.map(T=>o.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),o.jsxs("div",{style:{width:"30%"},children:[R===0&&o.jsx("label",{style:{...cr,fontSize:9},children:"Scope"}),o.jsx("input",{type:"text",value:_.scope||"",onChange:T=>x(R,"scope",T.target.value),placeholder:"scope",style:{...zr,fontSize:11}})]}),o.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[o.jsx("input",{type:"checkbox",checked:_.context||!1,onChange:T=>x(R,"context",T.target.checked||void 0)}),"ctx"]}),o.jsx("button",{onClick:()=>w(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function WV({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const i=tA(Cc(ku,{activationConstraint:{distance:5}}),Cc(Su,{coordinateGetter:NA})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?o.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):o.jsx(vA,{sensors:i,collisionDetection:iA,onDragEnd:l,children:o.jsx(jA,{items:a,strategy:bA,children:e.map((c,d)=>o.jsx(HV,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function HV({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:i,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=kA({id:e.step_id}),f={transform:Ti.Transform.toString(c),transition:d,opacity:u?.5:1};return o.jsx("div",{ref:l,style:f,children:o.jsx(TA,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...i,...a},depth:1})})}function UV({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,s]=m.useState(""),i={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},a={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,v=e.source_version,x=e.tags||[],w=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||x.includes(b)||(t==null||t({...e,tags:[...x,b]}),s(""))},g=b=>{t==null||t({...e,tags:x.filter(j=>j!==b)})},y=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return o.jsxs("div",{className:"space-y-4 max-w-lg",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),o.jsxs("div",{children:[o.jsx("label",{style:a,children:"POW Class"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Derived From"}),o.jsx("div",{style:i,children:r?o.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):o.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),v&&o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Source Version"}),o.jsx("div",{style:i,children:v})]}),o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Tags"}),o.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[x.length===0&&o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),x.map(b=>o.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&o.jsx("button",{onClick:()=>g(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"text",value:n,onChange:b=>s(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),w())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),o.jsx("button",{onClick:w,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b.label}),o.jsx("div",{style:i,children:e[b.key]||"-"})]},b.key)),d.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,j])=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b}),o.jsxs("div",{style:i,children:["parent: ",j.parent||"none"]})]},b))]}),f.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,j])=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b}),o.jsxs("div",{style:i,children:[j.name,j.scope&&` (${j.scope})`,j.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function G2({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(s=>s.status==="fail"),n=e.filter(s=>s.status==="pass");return t?o.jsx("div",{className:"flex items-center gap-2",children:r.length>0?o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):o.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):o.jsxs("div",{className:"space-y-2",children:[r.map((s,i)=>o.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[o.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[o.jsx("span",{className:"text-red-400",children:"FAIL"}),o.jsx("span",{className:"font-mono",children:s.rule_id})]}),s.message&&o.jsx("div",{className:"mt-1 opacity-80",children:s.message}),s.artifact_id&&o.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:s.artifact_id})]},i)),n.length>0&&r.length>0&&o.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function VV(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),s=[];let i=0,a=0;for(;i<r.length||a<n.length;)if(i>=r.length)s.push({type:"added",line:n[a],lineNum:a+1}),a++;else if(a>=n.length)s.push({type:"removed",line:r[i],lineNum:i+1}),i++;else if(r[i]===n[a])s.push({type:"same",line:r[i],oldLineNum:i+1,newLineNum:a+1}),i++,a++;else{let l=n.slice(a,a+5).indexOf(r[i]),c=r.slice(i,i+5).indexOf(n[a]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)s.push({type:"added",line:n[a+d],lineNum:a+d+1});a+=l}else if(c!==-1){for(let d=0;d<c;d++)s.push({type:"removed",line:r[i+d],lineNum:i+d+1});i+=c}else s.push({type:"removed",line:r[i],lineNum:i+1}),s.push({type:"added",line:n[a],lineNum:a+1}),i++,a++}return s}function GV({diff:e}){const[t,r]=m.useState(!0),n=VV(e.old_content,e.new_content),s={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return o.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:s[e.status]||s.M,children:e.status}),o.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),o.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&o.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:o.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((i,a)=>o.jsxs("div",{className:"flex",style:{background:i.type==="added"?"rgba(34, 197, 94, 0.1)":i.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:i.type==="added"?"3px solid #22c55e":i.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[o.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:i.type==="same"?i.oldLineNum:i.lineNum||""}),o.jsx("span",{className:"select-none px-1",style:{color:i.type==="added"?"#22c55e":i.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:i.type==="added"?"+":i.type==="removed"?"-":" "}),o.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:i.line})]},a))})})]})}function KV({workspaceId:e,artifactId:t=null,onClose:r}){const[n,s]=m.useState([]),[i,a]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(a(!0),c(null),ye.getDiff(e,t).then(u=>{s(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{a(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(r==null||r())};return o.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(r==null?void 0:r()),onKeyDown:d,tabIndex:0,children:o.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),o.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i?o.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?o.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?o.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((u,f)=>o.jsx(GV,{diff:u},u.artifact_id||f))}),o.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function YV(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,s,i]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=i.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:s,kind:i,displayName:a,kindLabel:l,display:`${a} - ${l}`}}function QV(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=YV(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function XV({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:s=[],modifiedFiles:i=[]}){const[a,l]=m.useState(""),[c,d]=m.useState(!1),u=QV(s),f=s.length,p=v=>{v.preventDefault(),a.trim()&&!n&&t(a.trim())},h=v=>{v.key==="Escape"&&!n&&r()};return o.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:v=>v.target===v.currentTarget&&!n&&r(),onKeyDown:h,children:[o.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&o.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),o.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(v=>o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:v.label}),o.jsx("div",{className:"space-y-1",children:v.items.map((x,w)=>o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),o.jsx("span",{style:{color:"var(--text-primary)"},children:x.displayName}),o.jsx("span",{style:{color:"var(--text-muted)"},children:x.kindLabel}),o.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",x.version]})]},w))})]},v.scope))}),o.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),o.jsxs("form",{onSubmit:p,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),o.jsx("textarea",{value:a,onChange:v=>l(v.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),o.jsx("button",{type:"submit",disabled:!a.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:a.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:a.trim()&&!n?"#000":"var(--text-muted)",cursor:a.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&o.jsx(KV,{workspaceId:e,onClose:()=>d(!1)})]})}function ZV(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,s,i]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=i.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:a,kind:i,kindLabel:l,version:s,display:`${a} - ${l}`}}function JV({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:s,onClose:i,onRefresh:a}){var _,R;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,v]=m.useState(null),x=(t==null?void 0:t.is_dirty)??!1,w=(t==null?void 0:t.modified_artifacts)??[],g=((_=t==null?void 0:t.tier1)==null?void 0:_.passed)??!0,y=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",j=t!=null&&t.expires_at?new Date(t.expires_at):null,k=async T=>{u(!0),v(null);try{const D=await ye.commit(e,T);c(!1),n==null||n(D),a==null||a()}catch(D){v(D.message)}finally{u(!1)}},N=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await ye.discard(e),s==null||s(),a==null||a()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},S=async()=>{if(x){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await ye.closeWorkspace(e),i==null||i()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},C=T=>{if(!T)return null;const $=T-new Date;if($<=0)return"Expired";const E=Math.floor($/(1e3*60*60)),L=Math.floor($%(1e3*60*60)/(1e3*60));return E>0?`${E}h ${L}m remaining`:`${L}m remaining`};return o.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:o.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?o.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),o.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),j&&o.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:C(j)})]}),o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),o.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:x?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:x?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:x?"Modified":"Clean"})]}),w.length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",w.length,")"]}),o.jsx("div",{className:"space-y-1",children:w.map(T=>{const D=ZV(T);return o.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[o.jsx("span",{style:{color:"var(--text-primary)"},children:D.displayName||T}),D.kindLabel&&o.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",D.kindLabel]})]},T)})})]})]}),o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),o.jsx(G2,{results:y,compact:!0})]}),y.length>0&&!g&&o.jsx("div",{className:"mt-3",children:o.jsx(G2,{results:y})})]})]}),o.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[o.jsx("button",{onClick:()=>c(!0),disabled:!x||!g||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:x&&g?"var(--action-success)":"var(--border-panel)",color:x&&g?"#000":"var(--text-muted)",cursor:x&&g&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!g&&x&&o.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),x&&o.jsx("button",{onClick:N,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!x&&o.jsx("button",{onClick:S,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&o.jsx(XV,{workspaceId:e,onCommit:k,onCancel:()=>{c(!1),v(null)},loading:d,modifiedArtifacts:w,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&o.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function eG(){const{isAdmin:e,loading:t}=Ps(),[r,n]=m.useState(null),[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[v,x]=m.useState(null),[w,g]=m.useState(null),[y,b]=m.useState(null),[j,k]=m.useState(null),[N,S]=m.useState(!1),{workspaceId:C,loading:_,error:R,reinitialize:T}=z9(),{state:D,loading:$,refresh:E}=F9(C),{documentTypes:L,loading:A,refresh:P}=$9(),{roles:M,loading:I,refresh:O}=q9(),{templates:F,loading:q,refresh:U}=GT(),{workflows:G,loading:J,refresh:B}=NH(),{fragments:te,loading:oe,kindOptions:Q,refresh:H}=YT(),{schemas:ie,loading:ae,refresh:pe}=KT(),[me,le]=m.useState([]),[V,ee]=m.useState([]),[re,je]=m.useState(!1),[be,Re]=m.useState(null),Ie=m.useCallback(async()=>{je(!0);try{const[ue,de]=await Promise.all([ye.getMechanicalOpTypes(),ye.getMechanicalOps()]);le(ue.types||[]),ee(de.operations||[])}catch(ue){console.error("Failed to load mechanical ops:",ue)}finally{je(!1)}},[]);m.useEffect(()=>{Ie()},[Ie]);const ne=m.useCallback(async(ue,de=null,He="docworkflow")=>{if(n(ue),d(null),f(null),h(null),i(null),x(null),g(null),Re(null),b(de),k(He),!!ue){l(!0);try{const wr=await ye.getDocumentType(ue.doc_type_id);i(wr)}catch(wr){console.error("Failed to load doc type details:",wr),i(ue)}finally{l(!1)}}},[]),we=m.useCallback(ue=>{ne(ue,"task_prompt","task")},[ne]),Je=m.useCallback(ue=>{ne(ue,"schema","schema")},[ne]),pt=m.useCallback(ue=>{d(ue),n(null),i(null),f(null),h(null),x(null),g(null),Re(null)},[]),qe=m.useCallback(ue=>{f(ue),n(null),i(null),d(null),h(null),x(null),g(null),Re(null)},[]),Pe=m.useCallback(ue=>{h(ue),n(null),i(null),d(null),f(null),x(null),g(null),Re(null)},[]),Be=m.useCallback(ue=>{x(ue),n(null),i(null),d(null),f(null),h(null),g(null),Re(null)},[]),et=m.useCallback(ue=>{g(ue),n(null),i(null),d(null),f(null),h(null),x(null),Re(null)},[]),Te=m.useCallback(ue=>{Re(ue),n(null),i(null),d(null),f(null),h(null),x(null),g(null)},[]),X=m.useCallback(ue=>{const de=G.find(He=>He.workflow_id===ue);de&&Pe(de)},[G,Pe]),Ne=m.useCallback((ue,de)=>{E()},[E]),xe=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),Ct=m.useCallback(()=>{n(null),i(null),d(null),f(null),h(null),x(null),g(null),Re(null)},[]),yt=m.useCallback(async ue=>{if(C)try{const de=await ye.createOrchestrationWorkflow(C,ue);await B(),E(),h({workflow_id:de.workflow_id,active_version:de.version,name:ue.name||de.workflow_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())}),n(null),i(null),d(null),f(null)}catch(de){console.error("Failed to create workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[C,B,E]),bt=m.useCallback(async ue=>{if(C)try{await ye.deleteOrchestrationWorkflow(C,ue),await B(),E(),h(null)}catch(de){console.error("Failed to delete workflow:",de),alert(`Failed to delete workflow: ${de.message}`)}},[C,B,E]),Zt=m.useCallback(async ue=>{if(C)try{const de=await ye.createDocumentType(C,ue);await P(),E(),ne({doc_type_id:de.doc_type_id,display_name:ue.display_name||de.doc_type_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase()),active_version:de.version})}catch(de){console.error("Failed to create document type:",de),alert(`Failed to create document type: ${de.message}`)}},[C,P,E,ne]);m.useCallback(async ue=>{if(C)try{await ye.deleteDocumentType(C,ue),await P(),E(),n(null),i(null)}catch(de){console.error("Failed to delete document type:",de),alert(`Failed to delete document type: ${de.message}`)}},[C,P,E]);const z=m.useCallback(async ue=>{if(C)try{await ye.createDcwWorkflow(C,{doc_type_id:ue}),await B(),E()}catch(de){console.error("Failed to create DCW workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[C,B,E]),W=m.useCallback(async ue=>{if(C)try{const de=await ye.createRolePrompt(C,ue);await H(),await O(),E(),Be({fragment_id:`role:${de.role_id}`,kind:"role",version:de.version,name:ue.name||de.role_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(de){console.error("Failed to create role prompt:",de),alert(`Failed to create role prompt: ${de.message}`)}},[C,H,O,E,Be]),K=m.useCallback(async ue=>{if(C)try{const de=await ye.createTemplate(C,ue);await U(),E(),qe({template_id:de.template_id,active_version:de.version,name:ue.name||de.template_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(de){console.error("Failed to create template:",de),alert(`Failed to create template: ${de.message}`)}},[C,U,E,qe]),se=m.useCallback(async ue=>{if(C)try{const de=await ye.createStandaloneSchema(C,ue);await pe(),E(),et({schema_id:de.schema_id,active_version:de.version,title:ue.title||de.schema_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(de){console.error("Failed to create schema:",de),alert(`Failed to create schema: ${de.message}`)}},[C,pe,E,et]),Le=m.useCallback(()=>{T(),n(null),i(null),d(null),f(null),h(null),x(null),g(null),Re(null)},[T]),lt=m.useCallback(async()=>{try{await ye.invalidateCache(),await Promise.all([P(),O(),U(),B(),H(),pe(),Ie(),E()])}catch(ue){console.error("Failed to reload config:",ue),alert(`Failed to reload config: ${ue.message}`)}},[P,O,U,B,H,pe,Ie,E]);if(t)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),o.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(_)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),o.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(R)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),o.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:R}),o.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const lr=c&&!r&&!u&&!p&&!v&&!w&&!be,Et=u&&!r&&!c&&!p&&!v&&!w&&!be,wt=p&&!r&&!c&&!u&&!v&&!w&&!be,qt=v&&!r&&!c&&!u&&!p&&!w&&!be,Mr=w&&!r&&!c&&!u&&!p&&!v&&!be,nt=be&&!r&&!c&&!u&&!p&&!v&&!w;return o.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{window.location.href="/"},title:"Return to Home"}),o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:lt,className:"flex items-center gap-1 px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{background:"var(--bg-panel)",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:11},title:"Reload config from disk (invalidate cache)",children:[o.jsx("span",{style:{fontSize:12},children:""}),o.jsx("span",{children:"Reload"})]}),o.jsxs("button",{onClick:()=>S(!N),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:N?"var(--action-primary)":"var(--bg-panel)",color:N?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[o.jsx("span",{style:{fontSize:14},children:""}),o.jsx("span",{children:"Building Blocks"})]})]})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsx(CH,{documentTypes:L,roles:M,templates:F,workflows:G,promptFragments:te,promptFragmentKindOptions:Q,schemas:ie,loading:A,rolesLoading:I,templatesLoading:q,workflowsLoading:J,promptFragmentsLoading:oe,schemasLoading:ae,selectedDocType:r,docTypeSource:j,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:v,selectedSchema:w,onSelectDocType:ne,onSelectRole:pt,onSelectTemplate:qe,onSelectWorkflow:Pe,onSelectFragment:Be,onSelectStandaloneSchema:et,onCreateWorkflow:yt,onCreateDocType:Zt,onCreateFragment:W,onCreateTemplate:K,onCreateSchema:se,onSelectTask:we,onSelectSchema:Je,workspaceState:D}),lr?o.jsx(QH,{workspaceId:C,role:c,onArtifactSave:Ne}):Et?o.jsx(ZH,{workspaceId:C,template:u,onArtifactSave:Ne}):qt?o.jsx(rU,{workspaceId:C,fragment:v,onArtifactSave:Ne}):wt?o.jsx($V,{workspaceId:C,workflow:p,documentTypes:L,onArtifactSave:Ne,onDelete:bt,onNavigateToWorkflow:X}):Mr?o.jsx(JH,{workspaceId:C,schema:w,onArtifactSave:Ne}):nt?o.jsx(nU,{mechanicalOp:be,mechanicalOpTypes:me}):o.jsx(YH,{workspaceId:C,docType:s,loading:a,roles:M,workflows:G,onArtifactSave:Ne,onCreateDcwWorkflow:z,initialTab:y,docTypeSource:j,mechanicalOpTypes:me,mechanicalOps:V}),o.jsx(JV,{workspaceId:C,state:D,loading:$,onCommit:xe,onDiscard:Ct,onClose:Le,onRefresh:E})]}),o.jsx(TH,{isOpen:N,onClose:()=>S(!1),promptFragments:te,promptFragmentKindOptions:Q,templates:F,schemas:ie,documentTypes:L,promptFragmentsLoading:oe,templatesLoading:q,schemasLoading:ae,selectedFragment:v,selectedTemplate:u,selectedSchema:w,selectedMechanicalOp:be,onSelectFragment:Be,onSelectTemplate:qe,onSelectSchema:Je,onSelectStandaloneSchema:et,onCreateFragment:W,onCreateTemplate:K,onCreateSchema:se,mechanicalOpTypes:me,mechanicalOps:V,mechanicalOpsLoading:re,onSelectMechanicalOp:Te})]})}function tG({onSelectExecution:e}){const[t,r]=m.useState([]),[n,s]=m.useState([]),[i,a]=m.useState({}),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState("all"),[h,v]=m.useState("all"),[x,w]=m.useState("all"),[g,y]=m.useState(""),[b,j]=m.useState("startedAt"),[k,N]=m.useState("desc");m.useEffect(()=>{S()},[]);async function S(){var A;c(!0),u(null);try{const[P,M,I]=await Promise.allSettled([De.getExecutions(),De.getDocumentWorkflowExecutions(),De.getProjects()]);if(P.status==="fulfilled"&&r(P.value.executions||[]),M.status==="fulfilled"&&s(M.value||[]),I.status==="fulfilled"){const O=((A=I.value)==null?void 0:A.projects)||I.value||[],F={};for(const q of Array.isArray(O)?O:[]){const U=q.project_id||q.projectId;q.id&&U&&(F[q.id]=U)}a(F)}}catch(P){u(P.message)}finally{c(!1)}}const C=m.useMemo(()=>[...t.map(A=>({id:A.execution_id,type:"workflow",workflowId:A.workflow_id,projectId:A.project_id,projectCode:i[A.project_id]||"--",documentType:A.document_type||A.workflow_id||"--",status:A.status,startedAt:A.started_at,label:A.workflow_id})),...n.map(A=>({id:A.execution_id,type:"document",workflowId:A.workflow_id,projectId:A.project_id,projectCode:i[A.project_id]||"--",documentType:A.document_type||A.workflow_id||"--",status:A.status,startedAt:A.created_at||A.updated_at,label:A.document_type||A.workflow_id}))],[t,n,i]),_=m.useMemo(()=>[...new Set(C.map(A=>A.documentType).filter(Boolean).filter(A=>A!=="--"))].sort(),[C]),R=m.useMemo(()=>[...new Set(C.map(A=>{var P;return(P=A.status)==null?void 0:P.toLowerCase()}).filter(Boolean))],[C]),T=m.useMemo(()=>{const A=g.toLowerCase().trim();return C.filter(P=>{var M,I,O;if(f!=="all"&&((M=P.status)==null?void 0:M.toLowerCase())!==f||h!=="all"&&P.type!==h||x!=="all"&&P.documentType!==x)return!1;if(A){const F=(I=P.id)==null?void 0:I.toLowerCase().includes(A),q=(O=P.projectCode)==null?void 0:O.toLowerCase().includes(A);if(!F&&!q)return!1}return!0})},[C,f,h,x,g]),D=m.useMemo(()=>{const A=[...T];return A.sort((P,M)=>{let I=P[b],O=M[b];if(I==null&&O==null)return 0;if(I==null)return 1;if(O==null)return-1;if(b==="startedAt"&&(I=new Date(I).getTime(),O=new Date(O).getTime()),typeof I=="string"&&typeof O=="string"){const q=I.localeCompare(O);return k==="asc"?q:-q}const F=I<O?-1:I>O?1:0;return k==="asc"?F:-F}),A},[T,b,k]);function $(A){b===A?N(P=>P==="asc"?"desc":"asc"):(j(A),N("asc"))}function E({columnKey:A}){return b!==A?null:o.jsx("span",{className:"ml-1",children:k==="asc"?"":""})}if(l)return o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading executions..."})});const L=[{key:"id",label:"Execution ID",minWidth:"200px"},{key:"projectCode",label:"Project"},{key:"type",label:"Source"},{key:"documentType",label:"Document Type"},{key:"status",label:"Status"},{key:"startedAt",label:"Started"}];return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"flex items-center gap-4 p-4 border-b flex-shrink-0 flex-wrap",style:{borderColor:"var(--border-panel)"},children:[o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("input",{type:"text",value:g,onChange:A=>y(A.target.value),placeholder:"Search by ID or project...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)",width:"200px"}})}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status:"}),o.jsxs("select",{value:f,onChange:A=>p(A.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"all",children:"All"}),R.map(A=>o.jsx("option",{value:A,children:A},A))]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Source:"}),o.jsxs("select",{value:h,onChange:A=>v(A.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"workflow",children:"Workflows"}),o.jsx("option",{value:"document",children:"Documents"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Type:"}),o.jsxs("select",{value:x,onChange:A=>w(A.target.value),className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"all",children:"All"}),_.map(A=>o.jsx("option",{value:A,children:A},A))]})]}),o.jsx("button",{onClick:S,className:"text-xs px-3 py-1 rounded hover:opacity-80 transition-opacity ml-auto",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Refresh"}),o.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[D.length," execution",D.length!==1?"s":""]})]}),d&&o.jsx("div",{className:"p-3 m-4 rounded text-sm",style:{background:"var(--bg-error, #fecaca)",color:"#991b1b"},children:d}),o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsxs("table",{className:"w-full text-sm",style:{color:"var(--text-primary)"},children:[o.jsx("thead",{children:o.jsx("tr",{className:"border-b",style:{borderColor:"var(--border-panel)"},children:L.map(A=>o.jsxs("th",{onClick:()=>$(A.key),className:"text-left p-3 font-medium text-xs cursor-pointer hover:opacity-80 select-none",style:{color:"var(--text-muted)",minWidth:A.minWidth||void 0},children:[A.label,o.jsx(E,{columnKey:A.key})]},A.key))})}),o.jsxs("tbody",{children:[D.map(A=>o.jsxs("tr",{onClick:()=>e(A.id),className:"border-b cursor-pointer hover:bg-white/5 transition-colors",style:{borderColor:"var(--border-panel)"},children:[o.jsx("td",{className:"p-3 font-mono text-xs",style:{minWidth:"200px"},children:A.id}),o.jsx("td",{className:"p-3 font-mono text-xs",children:A.projectCode}),o.jsx("td",{className:"p-3",children:o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:A.type==="workflow"?"var(--accent-primary, #3b82f6)":"var(--accent-secondary, #8b5cf6)",color:"white",opacity:.8},children:A.type})}),o.jsx("td",{className:"p-3 text-xs",children:A.documentType}),o.jsx("td",{className:"p-3",children:o.jsx(rG,{status:A.status})}),o.jsx("td",{className:"p-3 text-xs",style:{color:"var(--text-muted)"},children:A.startedAt?nG(A.startedAt):"-"})]},A.id)),D.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:L.length,className:"p-8 text-center",style:{color:"var(--text-muted)"},children:"No executions found."})})]})]})})]})}function rG({status:e}){const t=(e||"").toLowerCase();let r="var(--text-muted)";return t.includes("complete")||t==="done"?r="var(--state-complete, #10b981)":t.includes("running")||t.includes("active")||t.includes("progress")?r="var(--state-active, #f59e0b)":t.includes("fail")||t.includes("error")?r="var(--state-error, #ef4444)":t.includes("wait")||t.includes("pending")?r="var(--state-pending, #6b7280)":t.includes("cancel")&&(r="var(--text-muted)"),o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:r,color:"white"},children:e||"unknown"})}function nG(e){try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric"})+" "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return e}}function sG({executionId:e,onBack:t}){const[r,n]=m.useState(null),[s,i]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState("overview");m.useEffect(()=>{p()},[e]);async function p(){d(!0);try{const[v,x,w,g]=await Promise.allSettled([De.getExecution(e),De.getDocumentWorkflowExecution(e),De.getExecutionTranscript(e),De.getExecutionQACoverage(e)]);if(x.status==="fulfilled"&&x.value){const y=x.value;n({execution_id:y.execution_id,workflow_id:y.workflow_id,project_id:y.project_id,status:y.status,current_step_id:y.current_node_id,document_type:y.document_type,started_at:y.created_at,completed_at:y.updated_at,produced_documents:y.produced_documents})}else v.status==="fulfilled"&&v.value&&n(v.value);w.status==="fulfilled"&&i(w.value),g.status==="fulfilled"&&l(g.value)}catch(v){console.error("Failed to load execution detail:",v)}finally{d(!1)}}if(c)return o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading execution..."})});const h=[{id:"overview",label:"Overview"},{id:"transcript",label:`Transcript${s?` (${s.total_runs||0})`:""}`},{id:"qa",label:"QA Coverage"}];return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"flex items-center gap-3 p-4 border-b flex-shrink-0",style:{borderColor:"var(--border-panel)"},children:[o.jsx("button",{onClick:t,className:"text-xs px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Back"}),o.jsx("span",{className:"font-mono text-sm",style:{color:"var(--text-primary)"},children:e}),(r==null?void 0:r.status)&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:AA(r.status),color:"white"},children:r.status})]}),o.jsx("div",{className:"flex border-b px-4 flex-shrink-0",style:{borderColor:"var(--border-panel)"},children:h.map(v=>o.jsxs("button",{onClick:()=>f(v.id),className:"px-3 py-2 text-xs transition-colors relative",style:{color:u===v.id?"var(--text-primary)":"var(--text-muted)",fontWeight:u===v.id?600:400},children:[v.label,u===v.id&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-primary)"}})]},v.id))}),o.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[u==="overview"&&o.jsx(iG,{execution:r,transcript:s}),u==="transcript"&&o.jsx(oG,{transcript:s}),u==="qa"&&o.jsx(aG,{qaCoverage:a})]})]})}function iG({execution:e,transcript:t}){var r;return e?o.jsxs("div",{className:"space-y-4 max-w-2xl",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsx(Mt,{label:"Execution ID",value:e.execution_id,mono:!0}),o.jsx(Mt,{label:"Workflow",value:e.workflow_id}),o.jsx(Mt,{label:"Project",value:e.project_id}),o.jsx(Mt,{label:"Status",value:e.status}),o.jsx(Mt,{label:"Started",value:Y2(e.started_at)}),o.jsx(Mt,{label:"Completed",value:Y2(e.completed_at)}),o.jsx(Mt,{label:"Current Step",value:e.current_step_id||"-"}),o.jsx(Mt,{label:"Completed Steps",value:((r=e.completed_steps)==null?void 0:r.length)||0})]}),t&&o.jsxs("div",{className:"mt-6 p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("h3",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:"Cost Summary"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsx(Mt,{label:"Total Runs",value:t.total_runs||0}),o.jsx(Mt,{label:"Total Tokens",value:(t.total_tokens||0).toLocaleString()}),o.jsx(Mt,{label:"Total Cost",value:`$${(t.total_cost||0).toFixed(4)}`})]})]})]}):o.jsx("p",{style:{color:"var(--text-muted)"},children:"No execution data available."})}function oG({transcript:e}){var s;const[t,r]=m.useState({});if(!e||!((s=e.transcript)!=null&&s.length))return o.jsx("p",{style:{color:"var(--text-muted)"},children:"No transcript data available."});const n=i=>{r(a=>({...a,[i]:!a[i]}))};return o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"flex items-center gap-4 mb-4",children:o.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[e.total_runs," run",e.total_runs!==1?"s":""," |"," ",(e.total_tokens||0).toLocaleString()," tokens |"," ","$",(e.total_cost||0).toFixed(4)]})}),e.transcript.map((i,a)=>{var l,c,d,u,f;return o.jsxs("div",{className:"rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("button",{onClick:()=>n(a),className:"w-full text-left p-3 hover:opacity-80 transition-opacity",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("span",{style:{color:"var(--text-muted)",fontSize:"10px"},children:t[a]?"":""}),o.jsxs("span",{className:"font-mono font-medium",style:{color:"var(--text-primary)"},children:["#",i.run_number]}),o.jsx("span",{style:{color:"var(--text-muted)"},children:i.role}),i.node_id&&o.jsx("span",{className:"font-mono",style:{color:"var(--text-muted)"},children:i.node_id}),i.task_ref&&o.jsx("span",{className:"font-mono",style:{color:"var(--text-muted)",opacity:.7},children:i.task_ref}),o.jsx("span",{className:"ml-auto",style:{color:"var(--text-muted)"},children:i.model})]}),o.jsxs("div",{className:"flex items-center gap-4",style:{color:"var(--text-muted)"},children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:AA(i.status),color:"white"},children:i.status}),i.duration&&o.jsx("span",{children:i.duration}),o.jsxs("span",{children:[(typeof i.tokens=="number"?i.tokens:((l=i.tokens)==null?void 0:l.total)||0).toLocaleString()," tokens"]}),o.jsxs("span",{children:["$",(i.cost||0).toFixed(4)]})]})]}),t[a]&&o.jsxs("div",{className:"border-t px-3 pb-3",style:{borderColor:"var(--border-panel)"},children:[((c=i.inputs)==null?void 0:c.length)>0&&o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:["Inputs (",i.inputs.length,")"]}),i.inputs.map((p,h)=>o.jsx(K2,{label:p.kind,content:p.content,size:p.size},h))]}),((d=i.outputs)==null?void 0:d.length)>0&&o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:["Outputs (",i.outputs.length,")"]}),i.outputs.map((p,h)=>o.jsx(K2,{label:p.kind,content:p.content,size:p.size,parseStatus:p.parse_status,validationStatus:p.validation_status},h))]}),!((u=i.inputs)!=null&&u.length)&&!((f=i.outputs)!=null&&f.length)&&o.jsx("p",{className:"mt-3",style:{color:"var(--text-muted)"},children:"No input/output content recorded."})]})]},a)})]})}function K2({label:e,content:t,size:r,parseStatus:n,validationStatus:s}){const[i,a]=m.useState(!1),l=t&&t.length>0,c=l&&t.length>500;return o.jsxs("div",{className:"mb-2 rounded",style:{border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5",style:{background:"var(--bg-canvas)"},children:[o.jsx("span",{className:"font-mono font-medium text-xs",style:{color:"var(--accent-primary)"},children:e||"content"}),r>0&&o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:r>1024?`${(r/1024).toFixed(1)} KB`:`${r} B`}),n&&o.jsx("span",{className:"text-xs px-1 rounded",style:{background:n==="ok"?"var(--state-complete, #10b981)":"var(--state-error, #ef4444)",color:"white"},children:n}),s&&o.jsx("span",{className:"text-xs px-1 rounded",style:{background:s==="valid"?"var(--state-complete, #10b981)":"var(--state-error, #ef4444)",color:"white"},children:s}),c&&o.jsx("button",{onClick:()=>a(!i),className:"ml-auto text-xs hover:opacity-80",style:{color:"var(--accent-primary)"},children:i?"Expand":"Collapse"})]}),l&&o.jsx("pre",{className:"p-2 text-xs overflow-x-auto",style:{color:"var(--text-primary)",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:i?"200px":"none",overflow:i?"hidden":"visible",borderTop:"1px solid var(--border-panel)"},children:t}),!l&&o.jsx("p",{className:"px-2 py-1 text-xs",style:{color:"var(--text-muted)"},children:"(empty)"})]})}function aG({qaCoverage:e}){if(!e)return o.jsx("p",{style:{color:"var(--text-muted)"},children:"No QA coverage data available."});const t=e.summary||{},r=e.qa_nodes||[];return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[o.jsx(Mt,{label:"Passed",value:t.passed||0}),o.jsx(Mt,{label:"Failed",value:t.failed||0}),o.jsx(Mt,{label:"Errors",value:t.errors||0}),o.jsx(Mt,{label:"Warnings",value:t.warnings||0})]}),r.length>0&&o.jsxs("div",{className:"space-y-2 mt-4",children:[o.jsx("h3",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"QA Nodes"}),r.map((n,s)=>{var i;return o.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"font-mono font-medium mb-1",style:{color:"var(--text-primary)"},children:n.node_id||`Node ${s+1}`}),((i=n.findings)==null?void 0:i.length)>0&&o.jsx("ul",{className:"list-disc list-inside",style:{color:"var(--text-muted)"},children:n.findings.map((a,l)=>o.jsx("li",{children:typeof a=="string"?a:JSON.stringify(a)},l))})]},s)})]})]})}function Mt({label:e,value:t,mono:r}){return o.jsxs("div",{children:[o.jsx("div",{className:"text-xs mb-0.5",style:{color:"var(--text-muted)"},children:e}),o.jsx("div",{className:`text-sm ${r?"font-mono":""}`,style:{color:"var(--text-primary)"},children:t||"-"})]})}function AA(e){const t=(e||"").toLowerCase();return t.includes("complete")||t==="done"||t==="success"?"var(--state-complete, #10b981)":t.includes("running")||t.includes("active")||t.includes("progress")?"var(--state-active, #f59e0b)":t.includes("fail")||t.includes("error")?"var(--state-error, #ef4444)":"var(--state-pending, #6b7280)"}function Y2(e){if(!e)return"-";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})+" "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return e}}const lG="/api/v1";function cG(){const[e,t]=m.useState(null),[r,n]=m.useState(!0),[s,i]=m.useState(null),[a,l]=m.useState(7);m.useEffect(()=>{c()},[a]);async function c(){n(!0),i(null);try{const f=await fetch(`${lG}/telemetry/costs?days=${a}`,{credentials:"same-origin"});if(!f.ok)throw new Error(`HTTP ${f.status}`);const p=await f.json();t(p)}catch(f){i(f.message)}finally{n(!1)}}if(r)return o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading cost data..."})});if(s)return o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"p-3 rounded text-sm",style:{background:"#fecaca",color:"#991b1b"},children:["Failed to load cost data: ",s]})});const d=(e==null?void 0:e.summary)||{},u=(e==null?void 0:e.daily_data)||[];return o.jsxs("div",{className:"h-full overflow-auto p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:"Period:"}),[7,14,30].map(f=>o.jsxs("button",{onClick:()=>l(f),className:"text-xs px-3 py-1.5 rounded transition-opacity",style:{background:a===f?"var(--accent-primary)":"transparent",color:a===f?"white":"var(--text-muted)",border:a===f?"none":"1px solid var(--border-panel)"},children:[f," days"]},f)),o.jsx("button",{onClick:c,className:"text-xs px-3 py-1 rounded hover:opacity-80 transition-opacity ml-auto",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Refresh"})]}),o.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[o.jsx(xl,{label:"Total Cost",value:`$${(d.total_cost||0).toFixed(2)}`}),o.jsx(xl,{label:"Total Tokens",value:(d.total_tokens||0).toLocaleString()}),o.jsx(xl,{label:"Total Calls",value:d.total_calls||0}),o.jsx(xl,{label:"Avg Cost/Day",value:`$${(d.avg_cost_per_day||0).toFixed(2)}`})]}),o.jsx("div",{className:"rounded",style:{border:"1px solid var(--border-panel)"},children:o.jsxs("table",{className:"w-full text-sm",style:{color:"var(--text-primary)"},children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsx("th",{className:"text-left p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Date"}),o.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Cost"}),o.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Tokens"}),o.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Calls"}),o.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Errors"}),o.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Workflow"}),o.jsx("th",{className:"text-right p-3 font-medium text-xs",style:{color:"var(--text-muted)"},children:"Document"})]})}),o.jsxs("tbody",{children:[u.map((f,p)=>o.jsxs("tr",{className:"border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("td",{className:"p-3 text-xs",children:f.date_short||f.date}),o.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.cost||0).toFixed(4)]}),o.jsx("td",{className:"p-3 text-xs text-right font-mono",children:(f.tokens||0).toLocaleString()}),o.jsx("td",{className:"p-3 text-xs text-right",children:f.calls||0}),o.jsx("td",{className:"p-3 text-xs text-right",style:{color:f.errors>0?"var(--state-error, #ef4444)":"var(--text-muted)"},children:f.errors||0}),o.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.workflow_cost||0).toFixed(4)]}),o.jsxs("td",{className:"p-3 text-xs text-right font-mono",children:["$",(f.document_cost||0).toFixed(4)]})]},p)),u.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"p-8 text-center",style:{color:"var(--text-muted)"},children:"No cost data for this period."})})]})]})})]})}function xl({label:e,value:t}){return o.jsxs("div",{className:"p-4 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:e}),o.jsx("div",{className:"text-lg font-medium font-mono",style:{color:"var(--text-primary)"},children:t})]})}function uG(){const{isAdmin:e,loading:t}=Ps(),[r,n]=m.useState("executions"),[s,i]=m.useState(null);if(m.useEffect(()=>{const c=new URLSearchParams(window.location.search).get("execution");if(c){i(c),n("executions");return}const d=window.location.pathname.match(/^\/admin\/executions\/(.+)$/);d&&(i(d[1]),n("executions"))},[]),t)return o.jsx("div",{className:"flex h-screen items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return o.jsx("div",{className:"flex h-screen items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[o.jsx("p",{style:{color:"var(--text-primary)"},children:"Admin access required."}),o.jsx("a",{href:"/",className:"text-sm mt-2 inline-block",style:{color:"var(--accent-primary)"},children:"Return to Production Floor"})]})});const a=[{id:"executions",label:"Executions"},{id:"costs",label:"Costs"}];return o.jsxs("div",{className:"flex flex-col h-screen",style:{background:"var(--bg-canvas)"},children:[o.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("a",{href:"/",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[o.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),o.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),o.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--accent-primary)",color:"white",opacity:.9},children:"ADMIN"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("a",{href:"/admin/workbench",className:"text-xs px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Workbench"}),o.jsx("a",{href:"/",className:"text-xs px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{color:"var(--text-muted)",border:"1px solid var(--border-panel)"},children:"Production Floor"})]})]}),o.jsx("div",{className:"flex border-b px-4 flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:a.map(l=>o.jsxs("button",{onClick:()=>{n(l.id),l.id!=="executions"&&i(null)},className:"px-4 py-2 text-sm transition-colors relative",style:{color:r===l.id?"var(--text-primary)":"var(--text-muted)",fontWeight:r===l.id?600:400},children:[l.label,r===l.id&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"var(--accent-primary)"}})]},l.id))}),o.jsxs("div",{className:"flex-1 overflow-hidden",children:[r==="executions"&&(s?o.jsx(sG,{executionId:s,onBack:()=>i(null)}):o.jsx(tG,{onSelectExecution:i})),r==="costs"&&o.jsx(cG,{})]})]})}function dG({user:e,onClick:t}){return o.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?o.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):o.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),o.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function fG(){var T,D,$,E,L;const{user:e}=Ps(),[t,r]=m.useState(!1),{projects:n,loading:s,error:i,refresh:a}=O9({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(!1),{theme:x,setTheme:w}=nT(),g=Object.keys(n),y=l&&n[l]?l:g[0]||null;m.useEffect(()=>{if(y&&n[y]){const A=n[y];document.title=`${A.projectId} - The Combine`}else document.title="The Combine"},[y,n]);const b=A=>{c(A),u(null)},j=()=>{p(!0)},k=async A=>{await a(),A&&A.id&&(c(A.id),u("concierge_intake")),p(!1)},N=()=>{p(!1)},S=async(A,P)=>{try{await De.updateProject(A,P),await a()}catch(M){throw console.error("Failed to update project:",M),M}},C=async A=>{try{if(await De.archiveProject(A),!t){const P=Object.values(n).sort((O,F)=>{const q=(O.name||"").localeCompare(F.name||"");return q!==0?q:(O.projectId||"").localeCompare(F.projectId||"")}),M=P.findIndex(O=>O.id===A),I=P[M+1]||P[M-1]||null;c((I==null?void 0:I.id)||null)}await a()}catch(P){throw console.error("Failed to archive project:",P),P}},_=async A=>{try{await De.unarchiveProject(A),await a()}catch(P){throw console.error("Failed to unarchive project:",P),P}},R=async A=>{try{await De.deleteProject(A);const P=Object.values(n).sort((O,F)=>{const q=(O.name||"").localeCompare(F.name||"");return q!==0?q:(O.projectId||"").localeCompare(F.projectId||"")}),M=P.findIndex(O=>O.id===A),I=P[M+1]||P[M-1]||null;c((I==null?void 0:I.id)||null),await a()}catch(P){throw console.error("Failed to delete project:",P),P}};return s?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${x}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):i?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${x}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[o.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",i]}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):o.jsxs("div",{className:`flex flex-col h-screen theme-${x}`,children:[o.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),o.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),o.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),o.jsx("path",{d:"M12 17h.01"})]})})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsx(k5,{projects:n,selectedId:y,onSelectProject:b,onNewProject:j,showArchived:t,onToggleShowArchived:()=>r(A=>!A),userSection:o.jsx(dG,{user:e,onClick:()=>v(!0)})}),o.jsx("div",{className:"flex-1",children:y?o.jsx(W9,{projectId:y,projectCode:(T=n[y])==null?void 0:T.projectId,projectName:(D=n[y])==null?void 0:D.name,isArchived:($=n[y])==null?void 0:$.isArchived,savedLayout:(L=(E=n[y])==null?void 0:E.metadata)==null?void 0:L.floor_layout,autoExpandNodeId:d,theme:x,onThemeChange:w,onProjectUpdate:S,onProjectArchive:C,onProjectUnarchive:_,onProjectDelete:R},y):o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("div",{className:"text-center",children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&o.jsx(pH,{onClose:N,onComplete:k}),h&&o.jsx(hH,{onClose:()=>v(!1)})]})]})}function pG(){const{isAuthenticated:e,loading:t}=Ps(),{theme:r}=nT(),[n,s]=m.useState(window.location.pathname);return m.useEffect(()=>{const i=()=>s(window.location.pathname);return window.addEventListener("popstate",i),()=>window.removeEventListener("popstate",i)},[]),t?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?o.jsx("div",{className:`h-screen theme-${r}`,children:o.jsx(eG,{})}):n==="/admin"||n.startsWith("/admin/executions")?o.jsx("div",{className:`h-screen theme-${r}`,children:o.jsx(uG,{})}):o.jsx(fG,{}):n==="/learn"?o.jsx(kH,{}):o.jsx(wH,{})}function hG(){return o.jsx(L9,{children:o.jsx(pG,{})})}Ex.createRoot(document.getElementById("root")).render(o.jsx(Y.StrictMode,{children:o.jsx(hG,{})}));
//# sourceMappingURL=index-Di_6HbvE.js.map
