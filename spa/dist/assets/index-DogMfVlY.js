(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var BS={exports:{}},Mc={},WS={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ha=Symbol.for("react.element"),FT=Symbol.for("react.portal"),$T=Symbol.for("react.fragment"),qT=Symbol.for("react.strict_mode"),BT=Symbol.for("react.profiler"),WT=Symbol.for("react.provider"),HT=Symbol.for("react.context"),VT=Symbol.for("react.forward_ref"),UT=Symbol.for("react.suspense"),GT=Symbol.for("react.memo"),KT=Symbol.for("react.lazy"),Vy=Symbol.iterator;function YT(e){return e===null||typeof e!="object"?null:(e=Vy&&e[Vy]||e["@@iterator"],typeof e=="function"?e:null)}var HS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},VS=Object.assign,US={};function Ti(e,t,r){this.props=e,this.context=t,this.refs=US,this.updater=r||HS}Ti.prototype.isReactComponent={};Ti.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ti.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function GS(){}GS.prototype=Ti.prototype;function Jx(e,t,r){this.props=e,this.context=t,this.refs=US,this.updater=r||HS}var ev=Jx.prototype=new GS;ev.constructor=Jx;VS(ev,Ti.prototype);ev.isPureReactComponent=!0;var Uy=Array.isArray,KS=Object.prototype.hasOwnProperty,tv={current:null},YS={key:!0,ref:!0,__self:!0,__source:!0};function XS(e,t,r){var n,s={},i=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)KS.call(t,n)&&!YS.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:ha,type:e,key:i,ref:a,props:s,_owner:tv.current}}function XT(e,t){return{$$typeof:ha,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function rv(e){return typeof e=="object"&&e!==null&&e.$$typeof===ha}function QT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Gy=/\/+/g;function Mu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?QT(""+e.key):t.toString(36)}function vl(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ha:case FT:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+Mu(a,0):n,Uy(s)?(r="",e!=null&&(r=e.replace(Gy,"$&/")+"/"),vl(s,t,r,"",function(d){return d})):s!=null&&(rv(s)&&(s=XT(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Gy,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",Uy(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Mu(i,l);a+=vl(i,t,r,c,s)}else if(c=YT(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Mu(i,l++),a+=vl(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Pa(e,t,r){if(e==null)return e;var n=[],s=0;return vl(e,n,"","",function(i){return t.call(r,i,s++)}),n}function ZT(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zt={current:null},yl={transition:null},JT={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:yl,ReactCurrentOwner:tv};function QS(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:Pa,forEach:function(e,t,r){Pa(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Pa(e,function(){t++}),t},toArray:function(e){return Pa(e,function(t){return t})||[]},only:function(e){if(!rv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ae.Component=Ti;Ae.Fragment=$T;Ae.Profiler=BT;Ae.PureComponent=Jx;Ae.StrictMode=qT;Ae.Suspense=UT;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JT;Ae.act=QS;Ae.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=VS({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=tv.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)KS.call(t,c)&&!YS.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:ha,type:e.type,key:s,ref:i,props:n,_owner:a}};Ae.createContext=function(e){return e={$$typeof:HT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:WT,_context:e},e.Consumer=e};Ae.createElement=XS;Ae.createFactory=function(e){var t=XS.bind(null,e);return t.type=e,t};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(e){return{$$typeof:VT,render:e}};Ae.isValidElement=rv;Ae.lazy=function(e){return{$$typeof:KT,_payload:{_status:-1,_result:e},_init:ZT}};Ae.memo=function(e,t){return{$$typeof:GT,type:e,compare:t===void 0?null:t}};Ae.startTransition=function(e){var t=yl.transition;yl.transition={};try{e()}finally{yl.transition=t}};Ae.unstable_act=QS;Ae.useCallback=function(e,t){return zt.current.useCallback(e,t)};Ae.useContext=function(e){return zt.current.useContext(e)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(e){return zt.current.useDeferredValue(e)};Ae.useEffect=function(e,t){return zt.current.useEffect(e,t)};Ae.useId=function(){return zt.current.useId()};Ae.useImperativeHandle=function(e,t,r){return zt.current.useImperativeHandle(e,t,r)};Ae.useInsertionEffect=function(e,t){return zt.current.useInsertionEffect(e,t)};Ae.useLayoutEffect=function(e,t){return zt.current.useLayoutEffect(e,t)};Ae.useMemo=function(e,t){return zt.current.useMemo(e,t)};Ae.useReducer=function(e,t,r){return zt.current.useReducer(e,t,r)};Ae.useRef=function(e){return zt.current.useRef(e)};Ae.useState=function(e){return zt.current.useState(e)};Ae.useSyncExternalStore=function(e,t,r){return zt.current.useSyncExternalStore(e,t,r)};Ae.useTransition=function(){return zt.current.useTransition()};Ae.version="18.3.1";WS.exports=Ae;var m=WS.exports;const G=Zx(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e5=m,t5=Symbol.for("react.element"),r5=Symbol.for("react.fragment"),n5=Object.prototype.hasOwnProperty,s5=e5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i5={key:!0,ref:!0,__self:!0,__source:!0};function ZS(e,t,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)n5.call(t,n)&&!i5.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:t5,type:e,key:i,ref:a,props:s,_owner:s5.current}}Mc.Fragment=r5;Mc.jsx=ZS;Mc.jsxs=ZS;BS.exports=Mc;var o=BS.exports,Ag={},JS={exports:{}},ir={},ek={exports:{}},tk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,R){var L=P.length;P.push(R);e:for(;0<L;){var $=L-1>>>1,q=P[$];if(0<s(q,R))P[$]=R,P[L]=q,L=$;else break e}}function r(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var R=P[0],L=P.pop();if(L!==R){P[0]=L;e:for(var $=0,q=P.length,Y=q>>>1;$<Y;){var K=2*($+1)-1,H=P[K],B=K+1,X=P[B];if(0>s(H,L))B<q&&0>s(X,H)?(P[$]=X,P[B]=L,$=B):(P[$]=H,P[K]=L,$=K);else if(B<q&&0>s(X,L))P[$]=X,P[B]=L,$=B;else break e}}return R}function s(P,R){var L=P.sortIndex-R.sortIndex;return L!==0?L:P.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,v=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(P){for(var R=r(d);R!==null;){if(R.callback===null)n(d);else if(R.startTime<=P)n(d),R.sortIndex=R.expirationTime,t(c,R);else break;R=r(d)}}function w(P){if(g=!1,b(P),!v)if(r(c)!==null)v=!0,M(k);else{var R=r(d);R!==null&&z(w,R.startTime-P)}}function k(P,R){v=!1,g&&(g=!1,x(E),E=-1),h=!0;var L=p;try{for(b(R),f=r(c);f!==null&&(!(f.expirationTime>R)||P&&!T());){var $=f.callback;if(typeof $=="function"){f.callback=null,p=f.priorityLevel;var q=$(f.expirationTime<=R);R=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(R)}else n(c);f=r(c)}if(f!==null)var Y=!0;else{var K=r(d);K!==null&&z(w,K.startTime-R),Y=!1}return Y}finally{f=null,p=L,h=!1}}var C=!1,N=null,E=-1,j=5,A=-1;function T(){return!(e.unstable_now()-A<j)}function D(){if(N!==null){var P=e.unstable_now();A=P;var R=!0;try{R=N(!0,P)}finally{R?F():(C=!1,N=null)}}else C=!1}var F;if(typeof y=="function")F=function(){y(D)};else if(typeof MessageChannel<"u"){var S=new MessageChannel,I=S.port2;S.port1.onmessage=D,F=function(){I.postMessage(null)}}else F=function(){_(D,0)};function M(P){N=P,C||(C=!0,F())}function z(P,R){E=_(function(){P(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,M(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(P){switch(p){case 1:case 2:case 3:var R=3;break;default:R=p}var L=p;p=R;try{return P()}finally{p=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,R){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var L=p;p=P;try{return R()}finally{p=L}},e.unstable_scheduleCallback=function(P,R,L){var $=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?$+L:$):L=$,P){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=L+q,P={id:u++,callback:R,priorityLevel:P,startTime:L,expirationTime:q,sortIndex:-1},L>$?(P.sortIndex=L,t(d,P),r(c)===null&&P===r(d)&&(g?(x(E),E=-1):g=!0,z(w,L-$))):(P.sortIndex=q,t(c,P),v||h||(v=!0,M(k))),P},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(P){var R=p;return function(){var L=p;p=R;try{return P.apply(this,arguments)}finally{p=L}}}})(tk);ek.exports=tk;var o5=ek.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a5=m,nr=o5;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rk=new Set,Oo={};function Cs(e,t){gi(e,t),gi(e+"Capture",t)}function gi(e,t){for(Oo[e]=t,e=0;e<t.length;e++)rk.add(t[e])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rg=Object.prototype.hasOwnProperty,l5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ky={},Yy={};function c5(e){return Rg.call(Yy,e)?!0:Rg.call(Ky,e)?!1:l5.test(e)?Yy[e]=!0:(Ky[e]=!0,!1)}function u5(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function d5(e,t,r,n){if(t===null||typeof t>"u"||u5(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ft(e,t,r,n,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Nt[e]=new Ft(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Nt[t]=new Ft(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Nt[e]=new Ft(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Nt[e]=new Ft(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Nt[e]=new Ft(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Nt[e]=new Ft(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Nt[e]=new Ft(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Nt[e]=new Ft(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Nt[e]=new Ft(e,5,!1,e.toLowerCase(),null,!1,!1)});var nv=/[\-:]([a-z])/g;function sv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(nv,sv);Nt[t]=new Ft(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(nv,sv);Nt[t]=new Ft(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(nv,sv);Nt[t]=new Ft(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Nt[e]=new Ft(e,1,!1,e.toLowerCase(),null,!1,!1)});Nt.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Nt[e]=new Ft(e,1,!1,e.toLowerCase(),null,!0,!0)});function iv(e,t,r,n){var s=Nt.hasOwnProperty(t)?Nt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(d5(t,r,s,n)&&(r=null),n||s===null?c5(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var vn=a5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ma=Symbol.for("react.element"),Hs=Symbol.for("react.portal"),Vs=Symbol.for("react.fragment"),ov=Symbol.for("react.strict_mode"),Ig=Symbol.for("react.profiler"),nk=Symbol.for("react.provider"),sk=Symbol.for("react.context"),av=Symbol.for("react.forward_ref"),Pg=Symbol.for("react.suspense"),Mg=Symbol.for("react.suspense_list"),lv=Symbol.for("react.memo"),Sn=Symbol.for("react.lazy"),ik=Symbol.for("react.offscreen"),Xy=Symbol.iterator;function Wi(e){return e===null||typeof e!="object"?null:(e=Xy&&e[Xy]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Ou;function co(e){if(Ou===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ou=t&&t[1]||""}return`
`+Ou+e}var Du=!1;function Lu(e,t){if(!e||Du)return"";Du=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{Du=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?co(e):""}function f5(e){switch(e.tag){case 5:return co(e.type);case 16:return co("Lazy");case 13:return co("Suspense");case 19:return co("SuspenseList");case 0:case 2:case 15:return e=Lu(e.type,!1),e;case 11:return e=Lu(e.type.render,!1),e;case 1:return e=Lu(e.type,!0),e;default:return""}}function Og(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vs:return"Fragment";case Hs:return"Portal";case Ig:return"Profiler";case ov:return"StrictMode";case Pg:return"Suspense";case Mg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sk:return(e.displayName||"Context")+".Consumer";case nk:return(e._context.displayName||"Context")+".Provider";case av:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lv:return t=e.displayName||null,t!==null?t:Og(e.type)||"Memo";case Sn:t=e._payload,e=e._init;try{return Og(e(t))}catch{}}return null}function p5(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Og(t);case 8:return t===ov?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Kn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ok(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function h5(e){var t=ok(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Oa(e){e._valueTracker||(e._valueTracker=h5(e))}function ak(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ok(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ol(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Dg(e,t){var r=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Qy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Kn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function lk(e,t){t=t.checked,t!=null&&iv(e,"checked",t,!1)}function Lg(e,t){lk(e,t);var r=Kn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?zg(e,t.type,r):t.hasOwnProperty("defaultValue")&&zg(e,t.type,Kn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Zy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function zg(e,t,r){(t!=="number"||Ol(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var uo=Array.isArray;function oi(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Kn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Fg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Jy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ee(92));if(uo(r)){if(1<r.length)throw Error(ee(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Kn(r)}}function ck(e,t){var r=Kn(t.value),n=Kn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function e0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function uk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $g(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?uk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Da,dk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Da=Da||document.createElement("div"),Da.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Da.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Do(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var jo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},m5=["Webkit","ms","Moz","O"];Object.keys(jo).forEach(function(e){m5.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),jo[t]=jo[e]})});function fk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||jo.hasOwnProperty(e)&&jo[e]?(""+t).trim():t+"px"}function pk(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=fk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var g5=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qg(e,t){if(t){if(g5[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function Bg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wg=null;function cv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Hg=null,ai=null,li=null;function t0(e){if(e=xa(e)){if(typeof Hg!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=Fc(t),Hg(e.stateNode,e.type,t))}}function hk(e){ai?li?li.push(e):li=[e]:ai=e}function mk(){if(ai){var e=ai,t=li;if(li=ai=null,t0(e),t)for(e=0;e<t.length;e++)t0(t[e])}}function gk(e,t){return e(t)}function xk(){}var zu=!1;function vk(e,t,r){if(zu)return e(t,r);zu=!0;try{return gk(e,t,r)}finally{zu=!1,(ai!==null||li!==null)&&(xk(),mk())}}function Lo(e,t){var r=e.stateNode;if(r===null)return null;var n=Fc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ee(231,t,typeof r));return r}var Vg=!1;if(un)try{var Hi={};Object.defineProperty(Hi,"passive",{get:function(){Vg=!0}}),window.addEventListener("test",Hi,Hi),window.removeEventListener("test",Hi,Hi)}catch{Vg=!1}function x5(e,t,r,n,s,i,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var So=!1,Dl=null,Ll=!1,Ug=null,v5={onError:function(e){So=!0,Dl=e}};function y5(e,t,r,n,s,i,a,l,c){So=!1,Dl=null,x5.apply(v5,arguments)}function b5(e,t,r,n,s,i,a,l,c){if(y5.apply(this,arguments),So){if(So){var d=Dl;So=!1,Dl=null}else throw Error(ee(198));Ll||(Ll=!0,Ug=d)}}function Es(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function yk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function r0(e){if(Es(e)!==e)throw Error(ee(188))}function _5(e){var t=e.alternate;if(!t){if(t=Es(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return r0(s),e;if(i===n)return r0(s),t;i=i.sibling}throw Error(ee(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(ee(189))}}if(r.alternate!==n)throw Error(ee(190))}if(r.tag!==3)throw Error(ee(188));return r.stateNode.current===r?e:t}function bk(e){return e=_5(e),e!==null?_k(e):null}function _k(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_k(e);if(t!==null)return t;e=e.sibling}return null}var wk=nr.unstable_scheduleCallback,n0=nr.unstable_cancelCallback,w5=nr.unstable_shouldYield,j5=nr.unstable_requestPaint,it=nr.unstable_now,S5=nr.unstable_getCurrentPriorityLevel,uv=nr.unstable_ImmediatePriority,jk=nr.unstable_UserBlockingPriority,zl=nr.unstable_NormalPriority,k5=nr.unstable_LowPriority,Sk=nr.unstable_IdlePriority,Oc=null,Wr=null;function N5(e){if(Wr&&typeof Wr.onCommitFiberRoot=="function")try{Wr.onCommitFiberRoot(Oc,e,void 0,(e.current.flags&128)===128)}catch{}}var Tr=Math.clz32?Math.clz32:T5,C5=Math.log,E5=Math.LN2;function T5(e){return e>>>=0,e===0?32:31-(C5(e)/E5|0)|0}var La=64,za=4194304;function fo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=fo(l):(i&=a,i!==0&&(n=fo(i)))}else a=r&~s,a!==0?n=fo(a):i!==0&&(n=fo(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Tr(t),s=1<<r,n|=e[r],t&=~s;return n}function A5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R5(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Tr(i),l=1<<a,c=s[a];c===-1?(!(l&r)||l&n)&&(s[a]=A5(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Gg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function kk(){var e=La;return La<<=1,!(La&4194240)&&(La=64),e}function Fu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ma(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tr(t),e[t]=r}function I5(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Tr(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function dv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Tr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var We=0;function Nk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ck,fv,Ek,Tk,Ak,Kg=!1,Fa=[],Dn=null,Ln=null,zn=null,zo=new Map,Fo=new Map,Tn=[],P5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function s0(e,t){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":Ln=null;break;case"mouseover":case"mouseout":zn=null;break;case"pointerover":case"pointerout":zo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(t.pointerId)}}function Vi(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=xa(t),t!==null&&fv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function M5(e,t,r,n,s){switch(t){case"focusin":return Dn=Vi(Dn,e,t,r,n,s),!0;case"dragenter":return Ln=Vi(Ln,e,t,r,n,s),!0;case"mouseover":return zn=Vi(zn,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return zo.set(i,Vi(zo.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Fo.set(i,Vi(Fo.get(i)||null,e,t,r,n,s)),!0}return!1}function Rk(e){var t=cs(e.target);if(t!==null){var r=Es(t);if(r!==null){if(t=r.tag,t===13){if(t=yk(r),t!==null){e.blockedOn=t,Ak(e.priority,function(){Ek(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Wg=n,r.target.dispatchEvent(n),Wg=null}else return t=xa(r),t!==null&&fv(t),e.blockedOn=r,!1;t.shift()}return!0}function i0(e,t,r){bl(e)&&r.delete(t)}function O5(){Kg=!1,Dn!==null&&bl(Dn)&&(Dn=null),Ln!==null&&bl(Ln)&&(Ln=null),zn!==null&&bl(zn)&&(zn=null),zo.forEach(i0),Fo.forEach(i0)}function Ui(e,t){e.blockedOn===t&&(e.blockedOn=null,Kg||(Kg=!0,nr.unstable_scheduleCallback(nr.unstable_NormalPriority,O5)))}function $o(e){function t(s){return Ui(s,e)}if(0<Fa.length){Ui(Fa[0],e);for(var r=1;r<Fa.length;r++){var n=Fa[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Dn!==null&&Ui(Dn,e),Ln!==null&&Ui(Ln,e),zn!==null&&Ui(zn,e),zo.forEach(t),Fo.forEach(t),r=0;r<Tn.length;r++)n=Tn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Tn.length&&(r=Tn[0],r.blockedOn===null);)Rk(r),r.blockedOn===null&&Tn.shift()}var ci=vn.ReactCurrentBatchConfig,$l=!0;function D5(e,t,r,n){var s=We,i=ci.transition;ci.transition=null;try{We=1,pv(e,t,r,n)}finally{We=s,ci.transition=i}}function L5(e,t,r,n){var s=We,i=ci.transition;ci.transition=null;try{We=4,pv(e,t,r,n)}finally{We=s,ci.transition=i}}function pv(e,t,r,n){if($l){var s=Yg(e,t,r,n);if(s===null)Yu(e,t,n,ql,r),s0(e,n);else if(M5(s,e,t,r,n))n.stopPropagation();else if(s0(e,n),t&4&&-1<P5.indexOf(e)){for(;s!==null;){var i=xa(s);if(i!==null&&Ck(i),i=Yg(e,t,r,n),i===null&&Yu(e,t,n,ql,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Yu(e,t,n,null,r)}}var ql=null;function Yg(e,t,r,n){if(ql=null,e=cv(n),e=cs(e),e!==null)if(t=Es(e),t===null)e=null;else if(r=t.tag,r===13){if(e=yk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ql=e,null}function Ik(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(S5()){case uv:return 1;case jk:return 4;case zl:case k5:return 16;case Sk:return 536870912;default:return 16}default:return 16}}var Mn=null,hv=null,_l=null;function Pk(){if(_l)return _l;var e,t=hv,r=t.length,n,s="value"in Mn?Mn.value:Mn.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[i-n];n++);return _l=s.slice(e,1<n?1-n:void 0)}function wl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $a(){return!0}function o0(){return!1}function or(e){function t(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$a:o0,this.isPropagationStopped=o0,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$a)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$a)},persist:function(){},isPersistent:$a}),t}var Ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mv=or(Ai),ga=et({},Ai,{view:0,detail:0}),z5=or(ga),$u,qu,Gi,Dc=et({},ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gi&&(Gi&&e.type==="mousemove"?($u=e.screenX-Gi.screenX,qu=e.screenY-Gi.screenY):qu=$u=0,Gi=e),$u)},movementY:function(e){return"movementY"in e?e.movementY:qu}}),a0=or(Dc),F5=et({},Dc,{dataTransfer:0}),$5=or(F5),q5=et({},ga,{relatedTarget:0}),Bu=or(q5),B5=et({},Ai,{animationName:0,elapsedTime:0,pseudoElement:0}),W5=or(B5),H5=et({},Ai,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),V5=or(H5),U5=et({},Ai,{data:0}),l0=or(U5),G5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},K5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function X5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Y5[e])?!!t[e]:!1}function gv(){return X5}var Q5=et({},ga,{key:function(e){if(e.key){var t=G5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?K5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gv,charCode:function(e){return e.type==="keypress"?wl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Z5=or(Q5),J5=et({},Dc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),c0=or(J5),eA=et({},ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gv}),tA=or(eA),rA=et({},Ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),nA=or(rA),sA=et({},Dc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),iA=or(sA),oA=[9,13,27,32],xv=un&&"CompositionEvent"in window,ko=null;un&&"documentMode"in document&&(ko=document.documentMode);var aA=un&&"TextEvent"in window&&!ko,Mk=un&&(!xv||ko&&8<ko&&11>=ko),u0=" ",d0=!1;function Ok(e,t){switch(e){case"keyup":return oA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Us=!1;function lA(e,t){switch(e){case"compositionend":return Dk(t);case"keypress":return t.which!==32?null:(d0=!0,u0);case"textInput":return e=t.data,e===u0&&d0?null:e;default:return null}}function cA(e,t){if(Us)return e==="compositionend"||!xv&&Ok(e,t)?(e=Pk(),_l=hv=Mn=null,Us=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mk&&t.locale!=="ko"?null:t.data;default:return null}}var uA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function f0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!uA[e.type]:t==="textarea"}function Lk(e,t,r,n){hk(n),t=Bl(t,"onChange"),0<t.length&&(r=new mv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var No=null,qo=null;function dA(e){Kk(e,0)}function Lc(e){var t=Ys(e);if(ak(t))return e}function fA(e,t){if(e==="change")return t}var zk=!1;if(un){var Wu;if(un){var Hu="oninput"in document;if(!Hu){var p0=document.createElement("div");p0.setAttribute("oninput","return;"),Hu=typeof p0.oninput=="function"}Wu=Hu}else Wu=!1;zk=Wu&&(!document.documentMode||9<document.documentMode)}function h0(){No&&(No.detachEvent("onpropertychange",Fk),qo=No=null)}function Fk(e){if(e.propertyName==="value"&&Lc(qo)){var t=[];Lk(t,qo,e,cv(e)),vk(dA,t)}}function pA(e,t,r){e==="focusin"?(h0(),No=t,qo=r,No.attachEvent("onpropertychange",Fk)):e==="focusout"&&h0()}function hA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Lc(qo)}function mA(e,t){if(e==="click")return Lc(t)}function gA(e,t){if(e==="input"||e==="change")return Lc(t)}function xA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rr=typeof Object.is=="function"?Object.is:xA;function Bo(e,t){if(Rr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Rg.call(t,s)||!Rr(e[s],t[s]))return!1}return!0}function m0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function g0(e,t){var r=m0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=m0(r)}}function $k(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$k(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qk(){for(var e=window,t=Ol();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ol(e.document)}return t}function vv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function vA(e){var t=qk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&$k(r.ownerDocument.documentElement,r)){if(n!==null&&vv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=g0(r,i);var a=g0(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yA=un&&"documentMode"in document&&11>=document.documentMode,Gs=null,Xg=null,Co=null,Qg=!1;function x0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Qg||Gs==null||Gs!==Ol(n)||(n=Gs,"selectionStart"in n&&vv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Co&&Bo(Co,n)||(Co=n,n=Bl(Xg,"onSelect"),0<n.length&&(t=new mv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gs)))}function qa(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ks={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},Vu={},Bk={};un&&(Bk=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function zc(e){if(Vu[e])return Vu[e];if(!Ks[e])return e;var t=Ks[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Bk)return Vu[e]=t[r];return e}var Wk=zc("animationend"),Hk=zc("animationiteration"),Vk=zc("animationstart"),Uk=zc("transitionend"),Gk=new Map,v0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zn(e,t){Gk.set(e,t),Cs(t,[e])}for(var Uu=0;Uu<v0.length;Uu++){var Gu=v0[Uu],bA=Gu.toLowerCase(),_A=Gu[0].toUpperCase()+Gu.slice(1);Zn(bA,"on"+_A)}Zn(Wk,"onAnimationEnd");Zn(Hk,"onAnimationIteration");Zn(Vk,"onAnimationStart");Zn("dblclick","onDoubleClick");Zn("focusin","onFocus");Zn("focusout","onBlur");Zn(Uk,"onTransitionEnd");gi("onMouseEnter",["mouseout","mouseover"]);gi("onMouseLeave",["mouseout","mouseover"]);gi("onPointerEnter",["pointerout","pointerover"]);gi("onPointerLeave",["pointerout","pointerover"]);Cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wA=new Set("cancel close invalid load scroll toggle".split(" ").concat(po));function y0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,b5(n,t,void 0,e),e.currentTarget=null}function Kk(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;y0(s,l,d),i=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;y0(s,l,d),i=c}}}if(Ll)throw e=Ug,Ll=!1,Ug=null,e}function Ue(e,t){var r=t[rx];r===void 0&&(r=t[rx]=new Set);var n=e+"__bubble";r.has(n)||(Yk(t,e,2,!1),r.add(n))}function Ku(e,t,r){var n=0;t&&(n|=4),Yk(r,e,n,t)}var Ba="_reactListening"+Math.random().toString(36).slice(2);function Wo(e){if(!e[Ba]){e[Ba]=!0,rk.forEach(function(r){r!=="selectionchange"&&(wA.has(r)||Ku(r,!1,e),Ku(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ba]||(t[Ba]=!0,Ku("selectionchange",!1,t))}}function Yk(e,t,r,n){switch(Ik(t)){case 1:var s=D5;break;case 4:s=L5;break;default:s=pv}r=s.bind(null,t,r,e),s=void 0,!Vg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Yu(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=cs(l),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}l=l.parentNode}}n=n.return}vk(function(){var d=i,u=cv(r),f=[];e:{var p=Gk.get(e);if(p!==void 0){var h=mv,v=e;switch(e){case"keypress":if(wl(r)===0)break e;case"keydown":case"keyup":h=Z5;break;case"focusin":v="focus",h=Bu;break;case"focusout":v="blur",h=Bu;break;case"beforeblur":case"afterblur":h=Bu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=a0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=$5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=tA;break;case Wk:case Hk:case Vk:h=W5;break;case Uk:h=nA;break;case"scroll":h=z5;break;case"wheel":h=iA;break;case"copy":case"cut":case"paste":h=V5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=c0}var g=(t&4)!==0,_=!g&&e==="scroll",x=g?p!==null?p+"Capture":null:p;g=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,x!==null&&(w=Lo(y,x),w!=null&&g.push(Ho(y,w,b)))),_)break;y=y.return}0<g.length&&(p=new h(p,v,null,r,u),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Wg&&(v=r.relatedTarget||r.fromElement)&&(cs(v)||v[dn]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=d,v=v?cs(v):null,v!==null&&(_=Es(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=d),h!==v)){if(g=a0,w="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=c0,w="onPointerLeave",x="onPointerEnter",y="pointer"),_=h==null?p:Ys(h),b=v==null?p:Ys(v),p=new g(w,y+"leave",h,r,u),p.target=_,p.relatedTarget=b,w=null,cs(u)===d&&(g=new g(x,y+"enter",v,r,u),g.target=b,g.relatedTarget=_,w=g),_=w,h&&v)t:{for(g=h,x=v,y=0,b=g;b;b=Ms(b))y++;for(b=0,w=x;w;w=Ms(w))b++;for(;0<y-b;)g=Ms(g),y--;for(;0<b-y;)x=Ms(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break t;g=Ms(g),x=Ms(x)}g=null}else g=null;h!==null&&b0(f,p,h,g,!1),v!==null&&_!==null&&b0(f,_,v,g,!0)}}e:{if(p=d?Ys(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var k=fA;else if(f0(p))if(zk)k=gA;else{k=hA;var C=pA}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=mA);if(k&&(k=k(e,d))){Lk(f,k,r,u);break e}C&&C(e,p,d),e==="focusout"&&(C=p._wrapperState)&&C.controlled&&p.type==="number"&&zg(p,"number",p.value)}switch(C=d?Ys(d):window,e){case"focusin":(f0(C)||C.contentEditable==="true")&&(Gs=C,Xg=d,Co=null);break;case"focusout":Co=Xg=Gs=null;break;case"mousedown":Qg=!0;break;case"contextmenu":case"mouseup":case"dragend":Qg=!1,x0(f,r,u);break;case"selectionchange":if(yA)break;case"keydown":case"keyup":x0(f,r,u)}var N;if(xv)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Us?Ok(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(Mk&&r.locale!=="ko"&&(Us||E!=="onCompositionStart"?E==="onCompositionEnd"&&Us&&(N=Pk()):(Mn=u,hv="value"in Mn?Mn.value:Mn.textContent,Us=!0)),C=Bl(d,E),0<C.length&&(E=new l0(E,e,null,r,u),f.push({event:E,listeners:C}),N?E.data=N:(N=Dk(r),N!==null&&(E.data=N)))),(N=aA?lA(e,r):cA(e,r))&&(d=Bl(d,"onBeforeInput"),0<d.length&&(u=new l0("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=N))}Kk(f,t)})}function Ho(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Bl(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Lo(e,r),i!=null&&n.unshift(Ho(e,i,s)),i=Lo(e,t),i!=null&&n.push(Ho(e,i,s))),e=e.return}return n}function Ms(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function b0(e,t,r,n,s){for(var i=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=Lo(r,i),c!=null&&a.unshift(Ho(r,c,l))):s||(c=Lo(r,i),c!=null&&a.push(Ho(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var jA=/\r\n?/g,SA=/\u0000|\uFFFD/g;function _0(e){return(typeof e=="string"?e:""+e).replace(jA,`
`).replace(SA,"")}function Wa(e,t,r){if(t=_0(t),_0(e)!==t&&r)throw Error(ee(425))}function Wl(){}var Zg=null,Jg=null;function ex(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var tx=typeof setTimeout=="function"?setTimeout:void 0,kA=typeof clearTimeout=="function"?clearTimeout:void 0,w0=typeof Promise=="function"?Promise:void 0,NA=typeof queueMicrotask=="function"?queueMicrotask:typeof w0<"u"?function(e){return w0.resolve(null).then(e).catch(CA)}:tx;function CA(e){setTimeout(function(){throw e})}function Xu(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),$o(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);$o(t)}function Fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function j0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ri=Math.random().toString(36).slice(2),qr="__reactFiber$"+Ri,Vo="__reactProps$"+Ri,dn="__reactContainer$"+Ri,rx="__reactEvents$"+Ri,EA="__reactListeners$"+Ri,TA="__reactHandles$"+Ri;function cs(e){var t=e[qr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[dn]||r[qr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=j0(e);e!==null;){if(r=e[qr])return r;e=j0(e)}return t}e=r,r=e.parentNode}return null}function xa(e){return e=e[qr]||e[dn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ys(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function Fc(e){return e[Vo]||null}var nx=[],Xs=-1;function Jn(e){return{current:e}}function Ge(e){0>Xs||(e.current=nx[Xs],nx[Xs]=null,Xs--)}function He(e,t){Xs++,nx[Xs]=e.current,e.current=t}var Yn={},It=Jn(Yn),Vt=Jn(!1),bs=Yn;function xi(e,t){var r=e.type.contextTypes;if(!r)return Yn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ut(e){return e=e.childContextTypes,e!=null}function Hl(){Ge(Vt),Ge(It)}function S0(e,t,r){if(It.current!==Yn)throw Error(ee(168));He(It,t),He(Vt,r)}function Xk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ee(108,p5(e)||"Unknown",s));return et({},r,n)}function Vl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Yn,bs=It.current,He(It,e),He(Vt,Vt.current),!0}function k0(e,t,r){var n=e.stateNode;if(!n)throw Error(ee(169));r?(e=Xk(e,t,bs),n.__reactInternalMemoizedMergedChildContext=e,Ge(Vt),Ge(It),He(It,e)):Ge(Vt),He(Vt,r)}var en=null,$c=!1,Qu=!1;function Qk(e){en===null?en=[e]:en.push(e)}function AA(e){$c=!0,Qk(e)}function es(){if(!Qu&&en!==null){Qu=!0;var e=0,t=We;try{var r=en;for(We=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}en=null,$c=!1}catch(s){throw en!==null&&(en=en.slice(e+1)),wk(uv,es),s}finally{We=t,Qu=!1}}return null}var Qs=[],Zs=0,Ul=null,Gl=0,ur=[],dr=0,_s=null,rn=1,nn="";function os(e,t){Qs[Zs++]=Gl,Qs[Zs++]=Ul,Ul=e,Gl=t}function Zk(e,t,r){ur[dr++]=rn,ur[dr++]=nn,ur[dr++]=_s,_s=e;var n=rn;e=nn;var s=32-Tr(n)-1;n&=~(1<<s),r+=1;var i=32-Tr(t)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,rn=1<<32-Tr(t)+s|r<<s|n,nn=i+e}else rn=1<<i|r<<s|n,nn=e}function yv(e){e.return!==null&&(os(e,1),Zk(e,1,0))}function bv(e){for(;e===Ul;)Ul=Qs[--Zs],Qs[Zs]=null,Gl=Qs[--Zs],Qs[Zs]=null;for(;e===_s;)_s=ur[--dr],ur[dr]=null,nn=ur[--dr],ur[dr]=null,rn=ur[--dr],ur[dr]=null}var rr=null,tr=null,Ke=!1,Cr=null;function Jk(e,t){var r=pr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function N0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rr=e,tr=Fn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rr=e,tr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_s!==null?{id:rn,overflow:nn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=pr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,rr=e,tr=null,!0):!1;default:return!1}}function sx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ix(e){if(Ke){var t=tr;if(t){var r=t;if(!N0(e,t)){if(sx(e))throw Error(ee(418));t=Fn(r.nextSibling);var n=rr;t&&N0(e,t)?Jk(n,r):(e.flags=e.flags&-4097|2,Ke=!1,rr=e)}}else{if(sx(e))throw Error(ee(418));e.flags=e.flags&-4097|2,Ke=!1,rr=e}}}function C0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rr=e}function Ha(e){if(e!==rr)return!1;if(!Ke)return C0(e),Ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ex(e.type,e.memoizedProps)),t&&(t=tr)){if(sx(e))throw eN(),Error(ee(418));for(;t;)Jk(e,t),t=Fn(t.nextSibling)}if(C0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){tr=Fn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}tr=null}}else tr=rr?Fn(e.stateNode.nextSibling):null;return!0}function eN(){for(var e=tr;e;)e=Fn(e.nextSibling)}function vi(){tr=rr=null,Ke=!1}function _v(e){Cr===null?Cr=[e]:Cr.push(e)}var RA=vn.ReactCurrentBatchConfig;function Ki(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ee(309));var n=r.stateNode}if(!n)throw Error(ee(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ee(284));if(!r._owner)throw Error(ee(290,e))}return e}function Va(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function E0(e){var t=e._init;return t(e._payload)}function tN(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=Wn(x,y),x.index=0,x.sibling=null,x}function i(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,y,b,w){return y===null||y.tag!==6?(y=sd(b,x.mode,w),y.return=x,y):(y=s(y,b),y.return=x,y)}function c(x,y,b,w){var k=b.type;return k===Vs?u(x,y,b.props.children,w,b.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Sn&&E0(k)===y.type)?(w=s(y,b.props),w.ref=Ki(x,y,b),w.return=x,w):(w=Tl(b.type,b.key,b.props,null,x.mode,w),w.ref=Ki(x,y,b),w.return=x,w)}function d(x,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=id(b,x.mode,w),y.return=x,y):(y=s(y,b.children||[]),y.return=x,y)}function u(x,y,b,w,k){return y===null||y.tag!==7?(y=gs(b,x.mode,w,k),y.return=x,y):(y=s(y,b),y.return=x,y)}function f(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=sd(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ma:return b=Tl(y.type,y.key,y.props,null,x.mode,b),b.ref=Ki(x,null,y),b.return=x,b;case Hs:return y=id(y,x.mode,b),y.return=x,y;case Sn:var w=y._init;return f(x,w(y._payload),b)}if(uo(y)||Wi(y))return y=gs(y,x.mode,b,null),y.return=x,y;Va(x,y)}return null}function p(x,y,b,w){var k=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:l(x,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ma:return b.key===k?c(x,y,b,w):null;case Hs:return b.key===k?d(x,y,b,w):null;case Sn:return k=b._init,p(x,y,k(b._payload),w)}if(uo(b)||Wi(b))return k!==null?null:u(x,y,b,w,null);Va(x,b)}return null}function h(x,y,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(b)||null,l(y,x,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ma:return x=x.get(w.key===null?b:w.key)||null,c(y,x,w,k);case Hs:return x=x.get(w.key===null?b:w.key)||null,d(y,x,w,k);case Sn:var C=w._init;return h(x,y,b,C(w._payload),k)}if(uo(w)||Wi(w))return x=x.get(b)||null,u(y,x,w,k,null);Va(y,w)}return null}function v(x,y,b,w){for(var k=null,C=null,N=y,E=y=0,j=null;N!==null&&E<b.length;E++){N.index>E?(j=N,N=null):j=N.sibling;var A=p(x,N,b[E],w);if(A===null){N===null&&(N=j);break}e&&N&&A.alternate===null&&t(x,N),y=i(A,y,E),C===null?k=A:C.sibling=A,C=A,N=j}if(E===b.length)return r(x,N),Ke&&os(x,E),k;if(N===null){for(;E<b.length;E++)N=f(x,b[E],w),N!==null&&(y=i(N,y,E),C===null?k=N:C.sibling=N,C=N);return Ke&&os(x,E),k}for(N=n(x,N);E<b.length;E++)j=h(N,x,E,b[E],w),j!==null&&(e&&j.alternate!==null&&N.delete(j.key===null?E:j.key),y=i(j,y,E),C===null?k=j:C.sibling=j,C=j);return e&&N.forEach(function(T){return t(x,T)}),Ke&&os(x,E),k}function g(x,y,b,w){var k=Wi(b);if(typeof k!="function")throw Error(ee(150));if(b=k.call(b),b==null)throw Error(ee(151));for(var C=k=null,N=y,E=y=0,j=null,A=b.next();N!==null&&!A.done;E++,A=b.next()){N.index>E?(j=N,N=null):j=N.sibling;var T=p(x,N,A.value,w);if(T===null){N===null&&(N=j);break}e&&N&&T.alternate===null&&t(x,N),y=i(T,y,E),C===null?k=T:C.sibling=T,C=T,N=j}if(A.done)return r(x,N),Ke&&os(x,E),k;if(N===null){for(;!A.done;E++,A=b.next())A=f(x,A.value,w),A!==null&&(y=i(A,y,E),C===null?k=A:C.sibling=A,C=A);return Ke&&os(x,E),k}for(N=n(x,N);!A.done;E++,A=b.next())A=h(N,x,E,A.value,w),A!==null&&(e&&A.alternate!==null&&N.delete(A.key===null?E:A.key),y=i(A,y,E),C===null?k=A:C.sibling=A,C=A);return e&&N.forEach(function(D){return t(x,D)}),Ke&&os(x,E),k}function _(x,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Vs&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ma:e:{for(var k=b.key,C=y;C!==null;){if(C.key===k){if(k=b.type,k===Vs){if(C.tag===7){r(x,C.sibling),y=s(C,b.props.children),y.return=x,x=y;break e}}else if(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Sn&&E0(k)===C.type){r(x,C.sibling),y=s(C,b.props),y.ref=Ki(x,C,b),y.return=x,x=y;break e}r(x,C);break}else t(x,C);C=C.sibling}b.type===Vs?(y=gs(b.props.children,x.mode,w,b.key),y.return=x,x=y):(w=Tl(b.type,b.key,b.props,null,x.mode,w),w.ref=Ki(x,y,b),w.return=x,x=w)}return a(x);case Hs:e:{for(C=b.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(x,y.sibling),y=s(y,b.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=id(b,x.mode,w),y.return=x,x=y}return a(x);case Sn:return C=b._init,_(x,y,C(b._payload),w)}if(uo(b))return v(x,y,b,w);if(Wi(b))return g(x,y,b,w);Va(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(x,y.sibling),y=s(y,b),y.return=x,x=y):(r(x,y),y=sd(b,x.mode,w),y.return=x,x=y),a(x)):r(x,y)}return _}var yi=tN(!0),rN=tN(!1),Kl=Jn(null),Yl=null,Js=null,wv=null;function jv(){wv=Js=Yl=null}function Sv(e){var t=Kl.current;Ge(Kl),e._currentValue=t}function ox(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ui(e,t){Yl=e,wv=Js=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bt=!0),e.firstContext=null)}function gr(e){var t=e._currentValue;if(wv!==e)if(e={context:e,memoizedValue:t,next:null},Js===null){if(Yl===null)throw Error(ee(308));Js=e,Yl.dependencies={lanes:0,firstContext:e}}else Js=Js.next=e;return t}var us=null;function kv(e){us===null?us=[e]:us.push(e)}function nN(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,kv(t)):(r.next=s.next,s.next=r),t.interleaved=r,fn(e,n)}function fn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var kn=!1;function Nv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sN(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ln(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $n(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,De&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,fn(e,r)}return s=n.interleaved,s===null?(t.next=t,kv(n)):(t.next=s.next,s.next=t),n.interleaved=t,fn(e,r)}function jl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dv(e,r)}}function T0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Xl(e,t,r,n){var s=e.updateQueue;kn=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;a=0,u=d=c=null,l=i;do{var p=l.lane,h=l.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(p=t,h=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(h,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,p=typeof v=="function"?v.call(h,f,p):v,p==null)break e;f=et({},f,p);break e;case 2:kn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);js|=a,e.lanes=a,e.memoizedState=f}}function A0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ee(191,s));s.call(n)}}}var va={},Hr=Jn(va),Uo=Jn(va),Go=Jn(va);function ds(e){if(e===va)throw Error(ee(174));return e}function Cv(e,t){switch(He(Go,t),He(Uo,e),He(Hr,va),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$g(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$g(t,e)}Ge(Hr),He(Hr,t)}function bi(){Ge(Hr),Ge(Uo),Ge(Go)}function iN(e){ds(Go.current);var t=ds(Hr.current),r=$g(t,e.type);t!==r&&(He(Uo,e),He(Hr,r))}function Ev(e){Uo.current===e&&(Ge(Hr),Ge(Uo))}var Ze=Jn(0);function Ql(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Zu=[];function Tv(){for(var e=0;e<Zu.length;e++)Zu[e]._workInProgressVersionPrimary=null;Zu.length=0}var Sl=vn.ReactCurrentDispatcher,Ju=vn.ReactCurrentBatchConfig,ws=0,Je=null,ut=null,mt=null,Zl=!1,Eo=!1,Ko=0,IA=0;function Tt(){throw Error(ee(321))}function Av(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Rr(e[r],t[r]))return!1;return!0}function Rv(e,t,r,n,s,i){if(ws=i,Je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Sl.current=e===null||e.memoizedState===null?DA:LA,e=r(n,s),Eo){i=0;do{if(Eo=!1,Ko=0,25<=i)throw Error(ee(301));i+=1,mt=ut=null,t.updateQueue=null,Sl.current=zA,e=r(n,s)}while(Eo)}if(Sl.current=Jl,t=ut!==null&&ut.next!==null,ws=0,mt=ut=Je=null,Zl=!1,t)throw Error(ee(300));return e}function Iv(){var e=Ko!==0;return Ko=0,e}function $r(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Je.memoizedState=mt=e:mt=mt.next=e,mt}function xr(){if(ut===null){var e=Je.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var t=mt===null?Je.memoizedState:mt.next;if(t!==null)mt=t,ut=e;else{if(e===null)throw Error(ee(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},mt===null?Je.memoizedState=mt=e:mt=mt.next=e}return mt}function Yo(e,t){return typeof t=="function"?t(e):t}function ed(e){var t=xr(),r=t.queue;if(r===null)throw Error(ee(311));r.lastRenderedReducer=e;var n=ut,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,c=null,d=i;do{var u=d.lane;if((ws&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,a=n):c=c.next=f,Je.lanes|=u,js|=u}d=d.next}while(d!==null&&d!==i);c===null?a=n:c.next=l,Rr(n,t.memoizedState)||(Bt=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Je.lanes|=i,js|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function td(e){var t=xr(),r=t.queue;if(r===null)throw Error(ee(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Rr(i,t.memoizedState)||(Bt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function oN(){}function aN(e,t){var r=Je,n=xr(),s=t(),i=!Rr(n.memoizedState,s);if(i&&(n.memoizedState=s,Bt=!0),n=n.queue,Pv(uN.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||mt!==null&&mt.memoizedState.tag&1){if(r.flags|=2048,Xo(9,cN.bind(null,r,n,s,t),void 0,null),xt===null)throw Error(ee(349));ws&30||lN(r,t,s)}return s}function lN(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function cN(e,t,r,n){t.value=r,t.getSnapshot=n,dN(t)&&fN(e)}function uN(e,t,r){return r(function(){dN(t)&&fN(e)})}function dN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Rr(e,r)}catch{return!0}}function fN(e){var t=fn(e,1);t!==null&&Ar(t,e,1,-1)}function R0(e){var t=$r();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:e},t.queue=e,e=e.dispatch=OA.bind(null,Je,e),[t.memoizedState,e]}function Xo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function pN(){return xr().memoizedState}function kl(e,t,r,n){var s=$r();Je.flags|=e,s.memoizedState=Xo(1|t,r,void 0,n===void 0?null:n)}function qc(e,t,r,n){var s=xr();n=n===void 0?null:n;var i=void 0;if(ut!==null){var a=ut.memoizedState;if(i=a.destroy,n!==null&&Av(n,a.deps)){s.memoizedState=Xo(t,r,i,n);return}}Je.flags|=e,s.memoizedState=Xo(1|t,r,i,n)}function I0(e,t){return kl(8390656,8,e,t)}function Pv(e,t){return qc(2048,8,e,t)}function hN(e,t){return qc(4,2,e,t)}function mN(e,t){return qc(4,4,e,t)}function gN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function xN(e,t,r){return r=r!=null?r.concat([e]):null,qc(4,4,gN.bind(null,t,e),r)}function Mv(){}function vN(e,t){var r=xr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Av(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function yN(e,t){var r=xr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Av(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function bN(e,t,r){return ws&21?(Rr(r,t)||(r=kk(),Je.lanes|=r,js|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bt=!0),e.memoizedState=r)}function PA(e,t){var r=We;We=r!==0&&4>r?r:4,e(!0);var n=Ju.transition;Ju.transition={};try{e(!1),t()}finally{We=r,Ju.transition=n}}function _N(){return xr().memoizedState}function MA(e,t,r){var n=Bn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},wN(e))jN(t,r);else if(r=nN(e,t,r,n),r!==null){var s=Lt();Ar(r,e,n,s),SN(r,t,n)}}function OA(e,t,r){var n=Bn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(wN(e))jN(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,Rr(l,a)){var c=t.interleaved;c===null?(s.next=s,kv(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=nN(e,t,s,n),r!==null&&(s=Lt(),Ar(r,e,n,s),SN(r,t,n))}}function wN(e){var t=e.alternate;return e===Je||t!==null&&t===Je}function jN(e,t){Eo=Zl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function SN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dv(e,r)}}var Jl={readContext:gr,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},DA={readContext:gr,useCallback:function(e,t){return $r().memoizedState=[e,t===void 0?null:t],e},useContext:gr,useEffect:I0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,kl(4194308,4,gN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return kl(4194308,4,e,t)},useInsertionEffect:function(e,t){return kl(4,2,e,t)},useMemo:function(e,t){var r=$r();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=$r();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=MA.bind(null,Je,e),[n.memoizedState,e]},useRef:function(e){var t=$r();return e={current:e},t.memoizedState=e},useState:R0,useDebugValue:Mv,useDeferredValue:function(e){return $r().memoizedState=e},useTransition:function(){var e=R0(!1),t=e[0];return e=PA.bind(null,e[1]),$r().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Je,s=$r();if(Ke){if(r===void 0)throw Error(ee(407));r=r()}else{if(r=t(),xt===null)throw Error(ee(349));ws&30||lN(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,I0(uN.bind(null,n,i,e),[e]),n.flags|=2048,Xo(9,cN.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=$r(),t=xt.identifierPrefix;if(Ke){var r=nn,n=rn;r=(n&~(1<<32-Tr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ko++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=IA++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},LA={readContext:gr,useCallback:vN,useContext:gr,useEffect:Pv,useImperativeHandle:xN,useInsertionEffect:hN,useLayoutEffect:mN,useMemo:yN,useReducer:ed,useRef:pN,useState:function(){return ed(Yo)},useDebugValue:Mv,useDeferredValue:function(e){var t=xr();return bN(t,ut.memoizedState,e)},useTransition:function(){var e=ed(Yo)[0],t=xr().memoizedState;return[e,t]},useMutableSource:oN,useSyncExternalStore:aN,useId:_N,unstable_isNewReconciler:!1},zA={readContext:gr,useCallback:vN,useContext:gr,useEffect:Pv,useImperativeHandle:xN,useInsertionEffect:hN,useLayoutEffect:mN,useMemo:yN,useReducer:td,useRef:pN,useState:function(){return td(Yo)},useDebugValue:Mv,useDeferredValue:function(e){var t=xr();return ut===null?t.memoizedState=e:bN(t,ut.memoizedState,e)},useTransition:function(){var e=td(Yo)[0],t=xr().memoizedState;return[e,t]},useMutableSource:oN,useSyncExternalStore:aN,useId:_N,unstable_isNewReconciler:!1};function Sr(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ax(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Bc={isMounted:function(e){return(e=e._reactInternals)?Es(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Lt(),s=Bn(e),i=ln(n,s);i.payload=t,r!=null&&(i.callback=r),t=$n(e,i,s),t!==null&&(Ar(t,e,s,n),jl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Lt(),s=Bn(e),i=ln(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=$n(e,i,s),t!==null&&(Ar(t,e,s,n),jl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Lt(),n=Bn(e),s=ln(r,n);s.tag=2,t!=null&&(s.callback=t),t=$n(e,s,n),t!==null&&(Ar(t,e,n,r),jl(t,e,n))}};function P0(e,t,r,n,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,a):t.prototype&&t.prototype.isPureReactComponent?!Bo(r,n)||!Bo(s,i):!0}function kN(e,t,r){var n=!1,s=Yn,i=t.contextType;return typeof i=="object"&&i!==null?i=gr(i):(s=Ut(t)?bs:It.current,n=t.contextTypes,i=(n=n!=null)?xi(e,s):Yn),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function M0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Bc.enqueueReplaceState(t,t.state,null)}function lx(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Nv(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=gr(i):(i=Ut(t)?bs:It.current,s.context=xi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ax(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Bc.enqueueReplaceState(s,s.state,null),Xl(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function _i(e,t){try{var r="",n=t;do r+=f5(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function rd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function cx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var FA=typeof WeakMap=="function"?WeakMap:Map;function NN(e,t,r){r=ln(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){tc||(tc=!0,yx=n),cx(e,t)},r}function CN(e,t,r){r=ln(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){cx(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){cx(e,t),typeof n!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function O0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new FA;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=JA.bind(null,e,t,r),t.then(e,e))}function D0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function L0(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ln(-1,1),t.tag=2,$n(r,t,1))),r.lanes|=1),e)}var $A=vn.ReactCurrentOwner,Bt=!1;function Ot(e,t,r,n){t.child=e===null?rN(t,null,r,n):yi(t,e.child,r,n)}function z0(e,t,r,n,s){r=r.render;var i=t.ref;return ui(t,s),n=Rv(e,t,r,n,i,s),r=Iv(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,pn(e,t,s)):(Ke&&r&&yv(t),t.flags|=1,Ot(e,t,n,s),t.child)}function F0(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!Bv(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,EN(e,t,i,n,s)):(e=Tl(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Bo,r(a,n)&&e.ref===t.ref)return pn(e,t,s)}return t.flags|=1,e=Wn(i,n),e.ref=t.ref,e.return=t,t.child=e}function EN(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Bo(i,n)&&e.ref===t.ref)if(Bt=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Bt=!0);else return t.lanes=e.lanes,pn(e,t,s)}return ux(e,t,r,n,s)}function TN(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(ti,Jt),Jt|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,He(ti,Jt),Jt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,He(ti,Jt),Jt|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,He(ti,Jt),Jt|=n;return Ot(e,t,s,r),t.child}function AN(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ux(e,t,r,n,s){var i=Ut(r)?bs:It.current;return i=xi(t,i),ui(t,s),r=Rv(e,t,r,n,i,s),n=Iv(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,pn(e,t,s)):(Ke&&n&&yv(t),t.flags|=1,Ot(e,t,r,s),t.child)}function $0(e,t,r,n,s){if(Ut(r)){var i=!0;Vl(t)}else i=!1;if(ui(t,s),t.stateNode===null)Nl(e,t),kN(t,r,n),lx(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=gr(d):(d=Ut(r)?bs:It.current,d=xi(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==d)&&M0(t,a,n,d),kn=!1;var p=t.memoizedState;a.state=p,Xl(t,n,a,s),c=t.memoizedState,l!==n||p!==c||Vt.current||kn?(typeof u=="function"&&(ax(t,r,u,n),c=t.memoizedState),(l=kn||P0(t,r,l,n,p,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=d,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,sN(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Sr(t.type,l),a.props=d,f=t.pendingProps,p=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=gr(c):(c=Ut(r)?bs:It.current,c=xi(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==c)&&M0(t,a,n,c),kn=!1,p=t.memoizedState,a.state=p,Xl(t,n,a,s);var v=t.memoizedState;l!==f||p!==v||Vt.current||kn?(typeof h=="function"&&(ax(t,r,h,n),v=t.memoizedState),(d=kn||P0(t,r,d,n,p,v,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),a.props=n,a.state=v,a.context=c,n=d):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return dx(e,t,r,n,i,s)}function dx(e,t,r,n,s,i){AN(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&k0(t,r,!1),pn(e,t,i);n=t.stateNode,$A.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=yi(t,e.child,null,i),t.child=yi(t,null,l,i)):Ot(e,t,l,i),t.memoizedState=n.state,s&&k0(t,r,!0),t.child}function RN(e){var t=e.stateNode;t.pendingContext?S0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&S0(e,t.context,!1),Cv(e,t.containerInfo)}function q0(e,t,r,n,s){return vi(),_v(s),t.flags|=256,Ot(e,t,r,n),t.child}var fx={dehydrated:null,treeContext:null,retryLane:0};function px(e){return{baseLanes:e,cachePool:null,transitions:null}}function IN(e,t,r){var n=t.pendingProps,s=Ze.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),He(Ze,s&1),e===null)return ix(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,i?(n=t.mode,i=t.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Vc(a,n,0,null),e=gs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=px(r),t.memoizedState=fx,e):Ov(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return qA(e,t,a,n,l,s,r);if(i){i=n.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Wn(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Wn(l,i):(i=gs(i,a,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,a=e.child.memoizedState,a=a===null?px(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,t.memoizedState=fx,n}return i=e.child,e=i.sibling,n=Wn(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ov(e,t){return t=Vc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ua(e,t,r,n){return n!==null&&_v(n),yi(t,e.child,null,r),e=Ov(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function qA(e,t,r,n,s,i,a){if(r)return t.flags&256?(t.flags&=-257,n=rd(Error(ee(422))),Ua(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Vc({mode:"visible",children:n.children},s,0,null),i=gs(i,s,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&yi(t,e.child,null,a),t.child.memoizedState=px(a),t.memoizedState=fx,i);if(!(t.mode&1))return Ua(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(ee(419)),n=rd(i,n,void 0),Ua(e,t,a,n)}if(l=(a&e.childLanes)!==0,Bt||l){if(n=xt,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,fn(e,s),Ar(n,e,s,-1))}return qv(),n=rd(Error(ee(421))),Ua(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=eR.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,tr=Fn(s.nextSibling),rr=t,Ke=!0,Cr=null,e!==null&&(ur[dr++]=rn,ur[dr++]=nn,ur[dr++]=_s,rn=e.id,nn=e.overflow,_s=t),t=Ov(t,n.children),t.flags|=4096,t)}function B0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ox(e.return,t,r)}function nd(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function PN(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Ot(e,t,n.children,r),n=Ze.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&B0(e,r,t);else if(e.tag===19)B0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(He(Ze,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Ql(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),nd(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ql(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}nd(t,!0,r,null,i);break;case"together":nd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Nl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function pn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),js|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,r=Wn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Wn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function BA(e,t,r){switch(t.tag){case 3:RN(t),vi();break;case 5:iN(t);break;case 1:Ut(t.type)&&Vl(t);break;case 4:Cv(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;He(Kl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(He(Ze,Ze.current&1),t.flags|=128,null):r&t.child.childLanes?IN(e,t,r):(He(Ze,Ze.current&1),e=pn(e,t,r),e!==null?e.sibling:null);He(Ze,Ze.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return PN(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),He(Ze,Ze.current),n)break;return null;case 22:case 23:return t.lanes=0,TN(e,t,r)}return pn(e,t,r)}var MN,hx,ON,DN;MN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};hx=function(){};ON=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,ds(Hr.current);var i=null;switch(r){case"input":s=Dg(e,s),n=Dg(e,n),i=[];break;case"select":s=et({},s,{value:void 0}),n=et({},n,{value:void 0}),i=[];break;case"textarea":s=Fg(e,s),n=Fg(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Wl)}qg(r,n);var a;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Oo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Oo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ue("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};DN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Yi(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function WA(e,t,r){var n=t.pendingProps;switch(bv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Ut(t.type)&&Hl(),At(t),null;case 3:return n=t.stateNode,bi(),Ge(Vt),Ge(It),Tv(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ha(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cr!==null&&(wx(Cr),Cr=null))),hx(e,t),At(t),null;case 5:Ev(t);var s=ds(Go.current);if(r=t.type,e!==null&&t.stateNode!=null)ON(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ee(166));return At(t),null}if(e=ds(Hr.current),Ha(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[qr]=t,n[Vo]=i,e=(t.mode&1)!==0,r){case"dialog":Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":case"embed":Ue("load",n);break;case"video":case"audio":for(s=0;s<po.length;s++)Ue(po[s],n);break;case"source":Ue("error",n);break;case"img":case"image":case"link":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"input":Qy(n,i),Ue("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ue("invalid",n);break;case"textarea":Jy(n,i),Ue("invalid",n)}qg(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Wa(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Wa(n.textContent,l,e),s=["children",""+l]):Oo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ue("scroll",n)}switch(r){case"input":Oa(n),Zy(n,i,!0);break;case"textarea":Oa(n),e0(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Wl)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=uk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[qr]=t,e[Vo]=n,MN(e,t,!1,!1),t.stateNode=e;e:{switch(a=Bg(r,n),r){case"dialog":Ue("cancel",e),Ue("close",e),s=n;break;case"iframe":case"object":case"embed":Ue("load",e),s=n;break;case"video":case"audio":for(s=0;s<po.length;s++)Ue(po[s],e);s=n;break;case"source":Ue("error",e),s=n;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),s=n;break;case"details":Ue("toggle",e),s=n;break;case"input":Qy(e,n),s=Dg(e,n),Ue("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=et({},n,{value:void 0}),Ue("invalid",e);break;case"textarea":Jy(e,n),s=Fg(e,n),Ue("invalid",e);break;default:s=n}qg(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?pk(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&dk(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Do(e,c):typeof c=="number"&&Do(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Oo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ue("scroll",e):c!=null&&iv(e,i,c,a))}switch(r){case"input":Oa(e),Zy(e,n,!1);break;case"textarea":Oa(e),e0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Kn(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?oi(e,!!n.multiple,i,!1):n.defaultValue!=null&&oi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Wl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)DN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ee(166));if(r=ds(Go.current),ds(Hr.current),Ha(t)){if(n=t.stateNode,r=t.memoizedProps,n[qr]=t,(i=n.nodeValue!==r)&&(e=rr,e!==null))switch(e.tag){case 3:Wa(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Wa(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[qr]=t,t.stateNode=n}return At(t),null;case 13:if(Ge(Ze),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ke&&tr!==null&&t.mode&1&&!(t.flags&128))eN(),vi(),t.flags|=98560,i=!1;else if(i=Ha(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(ee(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ee(317));i[qr]=t}else vi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;At(t),i=!1}else Cr!==null&&(wx(Cr),Cr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ze.current&1?pt===0&&(pt=3):qv())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return bi(),hx(e,t),e===null&&Wo(t.stateNode.containerInfo),At(t),null;case 10:return Sv(t.type._context),At(t),null;case 17:return Ut(t.type)&&Hl(),At(t),null;case 19:if(Ge(Ze),i=t.memoizedState,i===null)return At(t),null;if(n=(t.flags&128)!==0,a=i.rendering,a===null)if(n)Yi(i,!1);else{if(pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ql(e),a!==null){for(t.flags|=128,Yi(i,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return He(Ze,Ze.current&1|2),t.child}e=e.sibling}i.tail!==null&&it()>wi&&(t.flags|=128,n=!0,Yi(i,!1),t.lanes=4194304)}else{if(!n)if(e=Ql(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Yi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ke)return At(t),null}else 2*it()-i.renderingStartTime>wi&&r!==1073741824&&(t.flags|=128,n=!0,Yi(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(r=i.last,r!==null?r.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=it(),t.sibling=null,r=Ze.current,He(Ze,n?r&1|2:r&1),t):(At(t),null);case 22:case 23:return $v(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Jt&1073741824&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function HA(e,t){switch(bv(t),t.tag){case 1:return Ut(t.type)&&Hl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bi(),Ge(Vt),Ge(It),Tv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ev(t),null;case 13:if(Ge(Ze),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));vi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ge(Ze),null;case 4:return bi(),null;case 10:return Sv(t.type._context),null;case 22:case 23:return $v(),null;case 24:return null;default:return null}}var Ga=!1,Rt=!1,VA=typeof WeakSet=="function"?WeakSet:Set,le=null;function ei(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rt(e,t,n)}else r.current=null}function mx(e,t,r){try{r()}catch(n){rt(e,t,n)}}var W0=!1;function UA(e,t){if(Zg=$l,e=qk(),vv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(l=a+s),f!==i||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++d===s&&(l=a),p===i&&++u===n&&(c=a),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Jg={focusedElem:e,selectionRange:r},$l=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,_=v.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Sr(t.type,g),_);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(w){rt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return v=W0,W0=!1,v}function To(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&mx(t,r,i)}s=s.next}while(s!==n)}}function Wc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function gx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function LN(e){var t=e.alternate;t!==null&&(e.alternate=null,LN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qr],delete t[Vo],delete t[rx],delete t[EA],delete t[TA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function zN(e){return e.tag===5||e.tag===3||e.tag===4}function H0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||zN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Wl));else if(n!==4&&(e=e.child,e!==null))for(xx(e,t,r),e=e.sibling;e!==null;)xx(e,t,r),e=e.sibling}function vx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(vx(e,t,r),e=e.sibling;e!==null;)vx(e,t,r),e=e.sibling}var jt=null,kr=!1;function _n(e,t,r){for(r=r.child;r!==null;)FN(e,t,r),r=r.sibling}function FN(e,t,r){if(Wr&&typeof Wr.onCommitFiberUnmount=="function")try{Wr.onCommitFiberUnmount(Oc,r)}catch{}switch(r.tag){case 5:Rt||ei(r,t);case 6:var n=jt,s=kr;jt=null,_n(e,t,r),jt=n,kr=s,jt!==null&&(kr?(e=jt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):jt.removeChild(r.stateNode));break;case 18:jt!==null&&(kr?(e=jt,r=r.stateNode,e.nodeType===8?Xu(e.parentNode,r):e.nodeType===1&&Xu(e,r),$o(e)):Xu(jt,r.stateNode));break;case 4:n=jt,s=kr,jt=r.stateNode.containerInfo,kr=!0,_n(e,t,r),jt=n,kr=s;break;case 0:case 11:case 14:case 15:if(!Rt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&mx(r,t,a),s=s.next}while(s!==n)}_n(e,t,r);break;case 1:if(!Rt&&(ei(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){rt(r,t,l)}_n(e,t,r);break;case 21:_n(e,t,r);break;case 22:r.mode&1?(Rt=(n=Rt)||r.memoizedState!==null,_n(e,t,r),Rt=n):_n(e,t,r);break;default:_n(e,t,r)}}function V0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new VA),t.forEach(function(n){var s=tR.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function wr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:jt=l.stateNode,kr=!1;break e;case 3:jt=l.stateNode.containerInfo,kr=!0;break e;case 4:jt=l.stateNode.containerInfo,kr=!0;break e}l=l.return}if(jt===null)throw Error(ee(160));FN(i,a,s),jt=null,kr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){rt(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$N(t,e),t=t.sibling}function $N(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(wr(t,e),zr(e),n&4){try{To(3,e,e.return),Wc(3,e)}catch(g){rt(e,e.return,g)}try{To(5,e,e.return)}catch(g){rt(e,e.return,g)}}break;case 1:wr(t,e),zr(e),n&512&&r!==null&&ei(r,r.return);break;case 5:if(wr(t,e),zr(e),n&512&&r!==null&&ei(r,r.return),e.flags&32){var s=e.stateNode;try{Do(s,"")}catch(g){rt(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&lk(s,i),Bg(l,a);var d=Bg(l,i);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?pk(s,f):u==="dangerouslySetInnerHTML"?dk(s,f):u==="children"?Do(s,f):iv(s,u,f,d)}switch(l){case"input":Lg(s,i);break;case"textarea":ck(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?oi(s,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Vo]=i}catch(g){rt(e,e.return,g)}}break;case 6:if(wr(t,e),zr(e),n&4){if(e.stateNode===null)throw Error(ee(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){rt(e,e.return,g)}}break;case 3:if(wr(t,e),zr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$o(t.containerInfo)}catch(g){rt(e,e.return,g)}break;case 4:wr(t,e),zr(e);break;case 13:wr(t,e),zr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(zv=it())),n&4&&V0(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Rt=(d=Rt)||u,wr(t,e),Rt=d):wr(t,e),zr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(le=e,u=e.child;u!==null;){for(f=le=u;le!==null;){switch(p=le,h=p.child,p.tag){case 0:case 11:case 14:case 15:To(4,p,p.return);break;case 1:ei(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){rt(n,r,g)}}break;case 5:ei(p,p.return);break;case 22:if(p.memoizedState!==null){G0(f);continue}}h!==null?(h.return=p,le=h):G0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=fk("display",a))}catch(g){rt(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){rt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:wr(t,e),zr(e),n&4&&V0(e);break;case 21:break;default:wr(t,e),zr(e)}}function zr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(zN(r)){var n=r;break e}r=r.return}throw Error(ee(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Do(s,""),n.flags&=-33);var i=H0(e);vx(e,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=H0(e);xx(e,l,a);break;default:throw Error(ee(161))}}catch(c){rt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function GA(e,t,r){le=e,qN(e)}function qN(e,t,r){for(var n=(e.mode&1)!==0;le!==null;){var s=le,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Ga;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Rt;l=Ga;var d=Rt;if(Ga=a,(Rt=c)&&!d)for(le=s;le!==null;)a=le,c=a.child,a.tag===22&&a.memoizedState!==null?K0(s):c!==null?(c.return=a,le=c):K0(s);for(;i!==null;)le=i,qN(i),i=i.sibling;le=s,Ga=l,Rt=d}U0(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,le=i):U0(e)}}function U0(e){for(;le!==null;){var t=le;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Rt||Wc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Rt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Sr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&A0(t,i,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}A0(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&$o(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Rt||t.flags&512&&gx(t)}catch(p){rt(t,t.return,p)}}if(t===e){le=null;break}if(r=t.sibling,r!==null){r.return=t.return,le=r;break}le=t.return}}function G0(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var r=t.sibling;if(r!==null){r.return=t.return,le=r;break}le=t.return}}function K0(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Wc(4,t)}catch(c){rt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){rt(t,s,c)}}var i=t.return;try{gx(t)}catch(c){rt(t,i,c)}break;case 5:var a=t.return;try{gx(t)}catch(c){rt(t,a,c)}}}catch(c){rt(t,t.return,c)}if(t===e){le=null;break}var l=t.sibling;if(l!==null){l.return=t.return,le=l;break}le=t.return}}var KA=Math.ceil,ec=vn.ReactCurrentDispatcher,Dv=vn.ReactCurrentOwner,mr=vn.ReactCurrentBatchConfig,De=0,xt=null,ot=null,St=0,Jt=0,ti=Jn(0),pt=0,Qo=null,js=0,Hc=0,Lv=0,Ao=null,qt=null,zv=0,wi=1/0,Jr=null,tc=!1,yx=null,qn=null,Ka=!1,On=null,rc=0,Ro=0,bx=null,Cl=-1,El=0;function Lt(){return De&6?it():Cl!==-1?Cl:Cl=it()}function Bn(e){return e.mode&1?De&2&&St!==0?St&-St:RA.transition!==null?(El===0&&(El=kk()),El):(e=We,e!==0||(e=window.event,e=e===void 0?16:Ik(e.type)),e):1}function Ar(e,t,r,n){if(50<Ro)throw Ro=0,bx=null,Error(ee(185));ma(e,r,n),(!(De&2)||e!==xt)&&(e===xt&&(!(De&2)&&(Hc|=r),pt===4&&An(e,St)),Gt(e,n),r===1&&De===0&&!(t.mode&1)&&(wi=it()+500,$c&&es()))}function Gt(e,t){var r=e.callbackNode;R5(e,t);var n=Fl(e,e===xt?St:0);if(n===0)r!==null&&n0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&n0(r),t===1)e.tag===0?AA(Y0.bind(null,e)):Qk(Y0.bind(null,e)),NA(function(){!(De&6)&&es()}),r=null;else{switch(Nk(n)){case 1:r=uv;break;case 4:r=jk;break;case 16:r=zl;break;case 536870912:r=Sk;break;default:r=zl}r=YN(r,BN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function BN(e,t){if(Cl=-1,El=0,De&6)throw Error(ee(327));var r=e.callbackNode;if(di()&&e.callbackNode!==r)return null;var n=Fl(e,e===xt?St:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=nc(e,n);else{t=n;var s=De;De|=2;var i=HN();(xt!==e||St!==t)&&(Jr=null,wi=it()+500,ms(e,t));do try{QA();break}catch(l){WN(e,l)}while(!0);jv(),ec.current=i,De=s,ot!==null?t=0:(xt=null,St=0,t=pt)}if(t!==0){if(t===2&&(s=Gg(e),s!==0&&(n=s,t=_x(e,s))),t===1)throw r=Qo,ms(e,0),An(e,n),Gt(e,it()),r;if(t===6)An(e,n);else{if(s=e.current.alternate,!(n&30)&&!YA(s)&&(t=nc(e,n),t===2&&(i=Gg(e),i!==0&&(n=i,t=_x(e,i))),t===1))throw r=Qo,ms(e,0),An(e,n),Gt(e,it()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ee(345));case 2:as(e,qt,Jr);break;case 3:if(An(e,n),(n&130023424)===n&&(t=zv+500-it(),10<t)){if(Fl(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Lt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=tx(as.bind(null,e,qt,Jr),t);break}as(e,qt,Jr);break;case 4:if(An(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Tr(n);i=1<<a,a=t[a],a>s&&(s=a),n&=~i}if(n=s,n=it()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*KA(n/1960))-n,10<n){e.timeoutHandle=tx(as.bind(null,e,qt,Jr),n);break}as(e,qt,Jr);break;case 5:as(e,qt,Jr);break;default:throw Error(ee(329))}}}return Gt(e,it()),e.callbackNode===r?BN.bind(null,e):null}function _x(e,t){var r=Ao;return e.current.memoizedState.isDehydrated&&(ms(e,t).flags|=256),e=nc(e,t),e!==2&&(t=qt,qt=r,t!==null&&wx(t)),e}function wx(e){qt===null?qt=e:qt.push.apply(qt,e)}function YA(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Rr(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function An(e,t){for(t&=~Lv,t&=~Hc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Tr(t),n=1<<r;e[r]=-1,t&=~n}}function Y0(e){if(De&6)throw Error(ee(327));di();var t=Fl(e,0);if(!(t&1))return Gt(e,it()),null;var r=nc(e,t);if(e.tag!==0&&r===2){var n=Gg(e);n!==0&&(t=n,r=_x(e,n))}if(r===1)throw r=Qo,ms(e,0),An(e,t),Gt(e,it()),r;if(r===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,as(e,qt,Jr),Gt(e,it()),null}function Fv(e,t){var r=De;De|=1;try{return e(t)}finally{De=r,De===0&&(wi=it()+500,$c&&es())}}function Ss(e){On!==null&&On.tag===0&&!(De&6)&&di();var t=De;De|=1;var r=mr.transition,n=We;try{if(mr.transition=null,We=1,e)return e()}finally{We=n,mr.transition=r,De=t,!(De&6)&&es()}}function $v(){Jt=ti.current,Ge(ti)}function ms(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,kA(r)),ot!==null)for(r=ot.return;r!==null;){var n=r;switch(bv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hl();break;case 3:bi(),Ge(Vt),Ge(It),Tv();break;case 5:Ev(n);break;case 4:bi();break;case 13:Ge(Ze);break;case 19:Ge(Ze);break;case 10:Sv(n.type._context);break;case 22:case 23:$v()}r=r.return}if(xt=e,ot=e=Wn(e.current,null),St=Jt=t,pt=0,Qo=null,Lv=Hc=js=0,qt=Ao=null,us!==null){for(t=0;t<us.length;t++)if(r=us[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}us=null}return e}function WN(e,t){do{var r=ot;try{if(jv(),Sl.current=Jl,Zl){for(var n=Je.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Zl=!1}if(ws=0,mt=ut=Je=null,Eo=!1,Ko=0,Dv.current=null,r===null||r.return===null){pt=1,Qo=t,ot=null;break}e:{var i=e,a=r.return,l=r,c=t;if(t=St,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=D0(a);if(h!==null){h.flags&=-257,L0(h,a,l,i,t),h.mode&1&&O0(i,d,t),t=h,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){O0(i,d,t),qv();break e}c=Error(ee(426))}}else if(Ke&&l.mode&1){var _=D0(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),L0(_,a,l,i,t),_v(_i(c,l));break e}}i=c=_i(c,l),pt!==4&&(pt=2),Ao===null?Ao=[i]:Ao.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=NN(i,c,t);T0(i,x);break e;case 1:l=c;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qn===null||!qn.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=CN(i,l,t);T0(i,w);break e}}i=i.return}while(i!==null)}UN(r)}catch(k){t=k,ot===r&&r!==null&&(ot=r=r.return);continue}break}while(!0)}function HN(){var e=ec.current;return ec.current=Jl,e===null?Jl:e}function qv(){(pt===0||pt===3||pt===2)&&(pt=4),xt===null||!(js&268435455)&&!(Hc&268435455)||An(xt,St)}function nc(e,t){var r=De;De|=2;var n=HN();(xt!==e||St!==t)&&(Jr=null,ms(e,t));do try{XA();break}catch(s){WN(e,s)}while(!0);if(jv(),De=r,ec.current=n,ot!==null)throw Error(ee(261));return xt=null,St=0,pt}function XA(){for(;ot!==null;)VN(ot)}function QA(){for(;ot!==null&&!w5();)VN(ot)}function VN(e){var t=KN(e.alternate,e,Jt);e.memoizedProps=e.pendingProps,t===null?UN(e):ot=t,Dv.current=null}function UN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=HA(r,t),r!==null){r.flags&=32767,ot=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,ot=null;return}}else if(r=WA(r,t,Jt),r!==null){ot=r;return}if(t=t.sibling,t!==null){ot=t;return}ot=t=e}while(t!==null);pt===0&&(pt=5)}function as(e,t,r){var n=We,s=mr.transition;try{mr.transition=null,We=1,ZA(e,t,r,n)}finally{mr.transition=s,We=n}return null}function ZA(e,t,r,n){do di();while(On!==null);if(De&6)throw Error(ee(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(I5(e,i),e===xt&&(ot=xt=null,St=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ka||(Ka=!0,YN(zl,function(){return di(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=mr.transition,mr.transition=null;var a=We;We=1;var l=De;De|=4,Dv.current=null,UA(e,r),$N(r,e),vA(Jg),$l=!!Zg,Jg=Zg=null,e.current=r,GA(r),j5(),De=l,We=a,mr.transition=i}else e.current=r;if(Ka&&(Ka=!1,On=e,rc=s),i=e.pendingLanes,i===0&&(qn=null),N5(r.stateNode),Gt(e,it()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(tc)throw tc=!1,e=yx,yx=null,e;return rc&1&&e.tag!==0&&di(),i=e.pendingLanes,i&1?e===bx?Ro++:(Ro=0,bx=e):Ro=0,es(),null}function di(){if(On!==null){var e=Nk(rc),t=mr.transition,r=We;try{if(mr.transition=null,We=16>e?16:e,On===null)var n=!1;else{if(e=On,On=null,rc=0,De&6)throw Error(ee(331));var s=De;for(De|=4,le=e.current;le!==null;){var i=le,a=i.child;if(le.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(le=d;le!==null;){var u=le;switch(u.tag){case 0:case 11:case 15:To(8,u,i)}var f=u.child;if(f!==null)f.return=u,le=f;else for(;le!==null;){u=le;var p=u.sibling,h=u.return;if(LN(u),u===d){le=null;break}if(p!==null){p.return=h,le=p;break}le=h}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(g!==null)}}le=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,le=a;else e:for(;le!==null;){if(i=le,i.flags&2048)switch(i.tag){case 0:case 11:case 15:To(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,le=x;break e}le=i.return}}var y=e.current;for(le=y;le!==null;){a=le;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,le=b;else e:for(a=y;le!==null;){if(l=le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Wc(9,l)}}catch(k){rt(l,l.return,k)}if(l===a){le=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,le=w;break e}le=l.return}}if(De=s,es(),Wr&&typeof Wr.onPostCommitFiberRoot=="function")try{Wr.onPostCommitFiberRoot(Oc,e)}catch{}n=!0}return n}finally{We=r,mr.transition=t}}return!1}function X0(e,t,r){t=_i(r,t),t=NN(e,t,1),e=$n(e,t,1),t=Lt(),e!==null&&(ma(e,1,t),Gt(e,t))}function rt(e,t,r){if(e.tag===3)X0(e,e,r);else for(;t!==null;){if(t.tag===3){X0(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qn===null||!qn.has(n))){e=_i(r,e),e=CN(t,e,1),t=$n(t,e,1),e=Lt(),t!==null&&(ma(t,1,e),Gt(t,e));break}}t=t.return}}function JA(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Lt(),e.pingedLanes|=e.suspendedLanes&r,xt===e&&(St&r)===r&&(pt===4||pt===3&&(St&130023424)===St&&500>it()-zv?ms(e,0):Lv|=r),Gt(e,t)}function GN(e,t){t===0&&(e.mode&1?(t=za,za<<=1,!(za&130023424)&&(za=4194304)):t=1);var r=Lt();e=fn(e,t),e!==null&&(ma(e,t,r),Gt(e,r))}function eR(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),GN(e,r)}function tR(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ee(314))}n!==null&&n.delete(t),GN(e,r)}var KN;KN=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vt.current)Bt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Bt=!1,BA(e,t,r);Bt=!!(e.flags&131072)}else Bt=!1,Ke&&t.flags&1048576&&Zk(t,Gl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Nl(e,t),e=t.pendingProps;var s=xi(t,It.current);ui(t,r),s=Rv(null,t,n,e,s,r);var i=Iv();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ut(n)?(i=!0,Vl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Nv(t),s.updater=Bc,t.stateNode=s,s._reactInternals=t,lx(t,n,e,r),t=dx(null,t,n,!0,i,r)):(t.tag=0,Ke&&i&&yv(t),Ot(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Nl(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=nR(n),e=Sr(n,e),s){case 0:t=ux(null,t,n,e,r);break e;case 1:t=$0(null,t,n,e,r);break e;case 11:t=z0(null,t,n,e,r);break e;case 14:t=F0(null,t,n,Sr(n.type,e),r);break e}throw Error(ee(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Sr(n,s),ux(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Sr(n,s),$0(e,t,n,s,r);case 3:e:{if(RN(t),e===null)throw Error(ee(387));n=t.pendingProps,i=t.memoizedState,s=i.element,sN(e,t),Xl(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=_i(Error(ee(423)),t),t=q0(e,t,n,r,s);break e}else if(n!==s){s=_i(Error(ee(424)),t),t=q0(e,t,n,r,s);break e}else for(tr=Fn(t.stateNode.containerInfo.firstChild),rr=t,Ke=!0,Cr=null,r=rN(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vi(),n===s){t=pn(e,t,r);break e}Ot(e,t,n,r)}t=t.child}return t;case 5:return iN(t),e===null&&ix(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,ex(n,s)?a=null:i!==null&&ex(n,i)&&(t.flags|=32),AN(e,t),Ot(e,t,a,r),t.child;case 6:return e===null&&ix(t),null;case 13:return IN(e,t,r);case 4:return Cv(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=yi(t,null,n,r):Ot(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Sr(n,s),z0(e,t,n,s,r);case 7:return Ot(e,t,t.pendingProps,r),t.child;case 8:return Ot(e,t,t.pendingProps.children,r),t.child;case 12:return Ot(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,He(Kl,n._currentValue),n._currentValue=a,i!==null)if(Rr(i.value,a)){if(i.children===s.children&&!Vt.current){t=pn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=ln(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),ox(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ee(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),ox(a,r,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Ot(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,ui(t,r),s=gr(s),n=n(s),t.flags|=1,Ot(e,t,n,r),t.child;case 14:return n=t.type,s=Sr(n,t.pendingProps),s=Sr(n.type,s),F0(e,t,n,s,r);case 15:return EN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Sr(n,s),Nl(e,t),t.tag=1,Ut(n)?(e=!0,Vl(t)):e=!1,ui(t,r),kN(t,n,s),lx(t,n,s,r),dx(null,t,n,!0,e,r);case 19:return PN(e,t,r);case 22:return TN(e,t,r)}throw Error(ee(156,t.tag))};function YN(e,t){return wk(e,t)}function rR(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(e,t,r,n){return new rR(e,t,r,n)}function Bv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function nR(e){if(typeof e=="function")return Bv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===av)return 11;if(e===lv)return 14}return 2}function Wn(e,t){var r=e.alternate;return r===null?(r=pr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Tl(e,t,r,n,s,i){var a=2;if(n=e,typeof e=="function")Bv(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Vs:return gs(r.children,s,i,t);case ov:a=8,s|=8;break;case Ig:return e=pr(12,r,t,s|2),e.elementType=Ig,e.lanes=i,e;case Pg:return e=pr(13,r,t,s),e.elementType=Pg,e.lanes=i,e;case Mg:return e=pr(19,r,t,s),e.elementType=Mg,e.lanes=i,e;case ik:return Vc(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case nk:a=10;break e;case sk:a=9;break e;case av:a=11;break e;case lv:a=14;break e;case Sn:a=16,n=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=pr(a,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function gs(e,t,r,n){return e=pr(7,e,n,t),e.lanes=r,e}function Vc(e,t,r,n){return e=pr(22,e,n,t),e.elementType=ik,e.lanes=r,e.stateNode={isHidden:!1},e}function sd(e,t,r){return e=pr(6,e,null,t),e.lanes=r,e}function id(e,t,r){return t=pr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function sR(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fu(0),this.expirationTimes=Fu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fu(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wv(e,t,r,n,s,i,a,l,c){return e=new sR(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=pr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nv(i),e}function iR(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function XN(e){if(!e)return Yn;e=e._reactInternals;e:{if(Es(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ut(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var r=e.type;if(Ut(r))return Xk(e,r,t)}return t}function QN(e,t,r,n,s,i,a,l,c){return e=Wv(r,n,!0,e,s,i,a,l,c),e.context=XN(null),r=e.current,n=Lt(),s=Bn(r),i=ln(n,s),i.callback=t??null,$n(r,i,s),e.current.lanes=s,ma(e,s,n),Gt(e,n),e}function Uc(e,t,r,n){var s=t.current,i=Lt(),a=Bn(s);return r=XN(r),t.context===null?t.context=r:t.pendingContext=r,t=ln(i,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=$n(s,t,a),e!==null&&(Ar(e,s,a,i),jl(e,s,a)),a}function sc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Q0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Hv(e,t){Q0(e,t),(e=e.alternate)&&Q0(e,t)}function oR(){return null}var ZN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Vv(e){this._internalRoot=e}Gc.prototype.render=Vv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));Uc(e,t,null,null)};Gc.prototype.unmount=Vv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ss(function(){Uc(null,e,null,null)}),t[dn]=null}};function Gc(e){this._internalRoot=e}Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Tn.length&&t!==0&&t<Tn[r].priority;r++);Tn.splice(r,0,e),r===0&&Rk(e)}};function Uv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Kc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Z0(){}function aR(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=sc(a);i.call(d)}}var a=QN(t,n,e,0,null,!1,!1,"",Z0);return e._reactRootContainer=a,e[dn]=a.current,Wo(e.nodeType===8?e.parentNode:e),Ss(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=sc(c);l.call(d)}}var c=Wv(e,0,!1,null,null,!1,!1,"",Z0);return e._reactRootContainer=c,e[dn]=c.current,Wo(e.nodeType===8?e.parentNode:e),Ss(function(){Uc(t,c,r,n)}),c}function Yc(e,t,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=sc(a);l.call(c)}}Uc(t,a,e,s)}else a=aR(r,t,e,s,n);return sc(a)}Ck=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=fo(t.pendingLanes);r!==0&&(dv(t,r|1),Gt(t,it()),!(De&6)&&(wi=it()+500,es()))}break;case 13:Ss(function(){var n=fn(e,1);if(n!==null){var s=Lt();Ar(n,e,1,s)}}),Hv(e,1)}};fv=function(e){if(e.tag===13){var t=fn(e,134217728);if(t!==null){var r=Lt();Ar(t,e,134217728,r)}Hv(e,134217728)}};Ek=function(e){if(e.tag===13){var t=Bn(e),r=fn(e,t);if(r!==null){var n=Lt();Ar(r,e,t,n)}Hv(e,t)}};Tk=function(){return We};Ak=function(e,t){var r=We;try{return We=e,t()}finally{We=r}};Hg=function(e,t,r){switch(t){case"input":if(Lg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Fc(n);if(!s)throw Error(ee(90));ak(n),Lg(n,s)}}}break;case"textarea":ck(e,r);break;case"select":t=r.value,t!=null&&oi(e,!!r.multiple,t,!1)}};gk=Fv;xk=Ss;var lR={usingClientEntryPoint:!1,Events:[xa,Ys,Fc,hk,mk,Fv]},Xi={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cR={bundleType:Xi.bundleType,version:Xi.version,rendererPackageName:Xi.rendererPackageName,rendererConfig:Xi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bk(e),e===null?null:e.stateNode},findFiberByHostInstance:Xi.findFiberByHostInstance||oR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ya=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ya.isDisabled&&Ya.supportsFiber)try{Oc=Ya.inject(cR),Wr=Ya}catch{}}ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lR;ir.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uv(t))throw Error(ee(200));return iR(e,t,null,r)};ir.createRoot=function(e,t){if(!Uv(e))throw Error(ee(299));var r=!1,n="",s=ZN;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Wv(e,1,!1,null,null,r,!1,n,s),e[dn]=t.current,Wo(e.nodeType===8?e.parentNode:e),new Vv(t)};ir.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=bk(t),e=e===null?null:e.stateNode,e};ir.flushSync=function(e){return Ss(e)};ir.hydrate=function(e,t,r){if(!Kc(t))throw Error(ee(200));return Yc(null,e,t,!0,r)};ir.hydrateRoot=function(e,t,r){if(!Uv(e))throw Error(ee(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=ZN;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=QN(t,null,e,1,r??null,s,!1,i,a),e[dn]=t.current,Wo(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Gc(t)};ir.render=function(e,t,r){if(!Kc(t))throw Error(ee(200));return Yc(null,e,t,!1,r)};ir.unmountComponentAtNode=function(e){if(!Kc(e))throw Error(ee(40));return e._reactRootContainer?(Ss(function(){Yc(null,null,e,!1,function(){e._reactRootContainer=null,e[dn]=null})}),!0):!1};ir.unstable_batchedUpdates=Fv;ir.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Kc(r))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return Yc(e,t,r,!1,n)};ir.version="18.3.1-next-f1338f8080-20240426";function JN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(JN)}catch(e){console.error(e)}}JN(),JS.exports=ir;var ri=JS.exports,J0=ri;Ag.createRoot=J0.createRoot,Ag.hydrateRoot=J0.hydrateRoot;function Yt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Yt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var eC={exports:{}},tC={},rC={exports:{}},nC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ji=m;function uR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dR=typeof Object.is=="function"?Object.is:uR,fR=ji.useState,pR=ji.useEffect,hR=ji.useLayoutEffect,mR=ji.useDebugValue;function gR(e,t){var r=t(),n=fR({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return hR(function(){s.value=r,s.getSnapshot=t,od(s)&&i({inst:s})},[e,r,t]),pR(function(){return od(s)&&i({inst:s}),e(function(){od(s)&&i({inst:s})})},[e]),mR(r),r}function od(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!dR(e,r)}catch{return!0}}function xR(e,t){return t()}var vR=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xR:gR;nC.useSyncExternalStore=ji.useSyncExternalStore!==void 0?ji.useSyncExternalStore:vR;rC.exports=nC;var yR=rC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xc=m,bR=yR;function _R(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wR=typeof Object.is=="function"?Object.is:_R,jR=bR.useSyncExternalStore,SR=Xc.useRef,kR=Xc.useEffect,NR=Xc.useMemo,CR=Xc.useDebugValue;tC.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=SR(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=NR(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),s!==void 0&&a.hasValue){var v=a.value;if(s(v,h))return f=v}return f=h}if(v=f,wR(u,h))return v;var g=n(h);return s!==void 0&&s(v,g)?(u=h,v):(u=h,f=g)}var d=!1,u,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,s]);var l=jR(e,i[0],i[1]);return kR(function(){a.hasValue=!0,a.value=l},[l]),CR(l),l};eC.exports=tC;var ER=eC.exports;const TR=Zx(ER),AR={},eb=e=>{let t;const r=new Set,n=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(v=>v(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>d,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(AR?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,s,c);return c},RR=e=>e?eb(e):eb,{useDebugValue:IR}=G,{useSyncExternalStoreWithSelector:PR}=TR,MR=e=>e;function sC(e,t=MR,r){const n=PR(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return IR(n),n}const tb=(e,t)=>{const r=RR(e),n=(s,i=t)=>sC(r,s,i);return Object.assign(n,r),n},OR=(e,t)=>e?tb(e,t):tb;function Pt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var DR={value:()=>{}};function Qc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Al(r)}function Al(e){this._=e}function LR(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Al.prototype=Qc.prototype={constructor:Al,on:function(e,t){var r=this._,n=LR(e+"",r),s,i=-1,a=n.length;if(arguments.length<2){for(;++i<a;)if((s=(e=n[i]).type)&&(s=zR(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=n[i]).type)r[s]=rb(r[s],e.name,t);else if(t==null)for(s in r)r[s]=rb(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Al(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,i;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,s=i.length;n<s;++n)i[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],s=0,i=n.length;s<i;++s)n[s].value.apply(t,r)}};function zR(e,t){for(var r=0,n=e.length,s;r<n;++r)if((s=e[r]).name===t)return s.value}function rb(e,t,r){for(var n=0,s=e.length;n<s;++n)if(e[n].name===t){e[n]=DR,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var jx="http://www.w3.org/1999/xhtml";const nb={svg:"http://www.w3.org/2000/svg",xhtml:jx,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Zc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),nb.hasOwnProperty(t)?{space:nb[t],local:e}:e}function FR(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===jx&&t.documentElement.namespaceURI===jx?t.createElement(e):t.createElementNS(r,e)}}function $R(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function iC(e){var t=Zc(e);return(t.local?$R:FR)(t)}function qR(){}function Gv(e){return e==null?qR:function(){return this.querySelector(e)}}function BR(e){typeof e!="function"&&(e=Gv(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var i=t[s],a=i.length,l=n[s]=new Array(a),c,d,u=0;u<a;++u)(c=i[u])&&(d=e.call(c,c.__data__,u,i))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new sr(n,this._parents)}function WR(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function HR(){return[]}function oC(e){return e==null?HR:function(){return this.querySelectorAll(e)}}function VR(e){return function(){return WR(e.apply(this,arguments))}}function UR(e){typeof e=="function"?e=VR(e):e=oC(e);for(var t=this._groups,r=t.length,n=[],s=[],i=0;i<r;++i)for(var a=t[i],l=a.length,c,d=0;d<l;++d)(c=a[d])&&(n.push(e.call(c,c.__data__,d,a)),s.push(c));return new sr(n,s)}function aC(e){return function(){return this.matches(e)}}function lC(e){return function(t){return t.matches(e)}}var GR=Array.prototype.find;function KR(e){return function(){return GR.call(this.children,e)}}function YR(){return this.firstElementChild}function XR(e){return this.select(e==null?YR:KR(typeof e=="function"?e:lC(e)))}var QR=Array.prototype.filter;function ZR(){return Array.from(this.children)}function JR(e){return function(){return QR.call(this.children,e)}}function eI(e){return this.selectAll(e==null?ZR:JR(typeof e=="function"?e:lC(e)))}function tI(e){typeof e!="function"&&(e=aC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var i=t[s],a=i.length,l=n[s]=[],c,d=0;d<a;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&l.push(c);return new sr(n,this._parents)}function cC(e){return new Array(e.length)}function rI(){return new sr(this._enter||this._groups.map(cC),this._parents)}function ic(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ic.prototype={constructor:ic,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function nI(e){return function(){return e}}function sI(e,t,r,n,s,i){for(var a=0,l,c=t.length,d=i.length;a<d;++a)(l=t[a])?(l.__data__=i[a],n[a]=l):r[a]=new ic(e,i[a]);for(;a<c;++a)(l=t[a])&&(s[a]=l)}function iI(e,t,r,n,s,i,a){var l,c,d=new Map,u=t.length,f=i.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=a.call(c,c.__data__,l,t)+"",d.has(h)?s[l]=c:d.set(h,c));for(l=0;l<f;++l)h=a.call(e,i[l],l,i)+"",(c=d.get(h))?(n[l]=c,c.__data__=i[l],d.delete(h)):r[l]=new ic(e,i[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(s[l]=c)}function oI(e){return e.__data__}function aI(e,t){if(!arguments.length)return Array.from(this,oI);var r=t?iI:sI,n=this._parents,s=this._groups;typeof e!="function"&&(e=nI(e));for(var i=s.length,a=new Array(i),l=new Array(i),c=new Array(i),d=0;d<i;++d){var u=n[d],f=s[d],p=f.length,h=lI(e.call(u,u&&u.__data__,d,n)),v=h.length,g=l[d]=new Array(v),_=a[d]=new Array(v),x=c[d]=new Array(p);r(u,f,g,_,x,h,t);for(var y=0,b=0,w,k;y<v;++y)if(w=g[y]){for(y>=b&&(b=y+1);!(k=_[b])&&++b<v;);w._next=k||null}}return a=new sr(a,n),a._enter=l,a._exit=c,a}function lI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function cI(){return new sr(this._exit||this._groups.map(cC),this._parents)}function uI(e,t,r){var n=this.enter(),s=this,i=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?i.remove():r(i),n&&s?n.merge(s).order():s}function dI(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,s=r.length,i=n.length,a=Math.min(s,i),l=new Array(s),c=0;c<a;++c)for(var d=r[c],u=n[c],f=d.length,p=l[c]=new Array(f),h,v=0;v<f;++v)(h=d[v]||u[v])&&(p[v]=h);for(;c<s;++c)l[c]=r[c];return new sr(l,this._parents)}function fI(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],s=n.length-1,i=n[s],a;--s>=0;)(a=n[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function pI(e){e||(e=hI);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,s=new Array(n),i=0;i<n;++i){for(var a=r[i],l=a.length,c=s[i]=new Array(l),d,u=0;u<l;++u)(d=a[u])&&(c[u]=d);c.sort(t)}return new sr(s,this._parents).order()}function hI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function mI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function gI(){return Array.from(this)}function xI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,i=n.length;s<i;++s){var a=n[s];if(a)return a}return null}function vI(){let e=0;for(const t of this)++e;return e}function yI(){return!this.node()}function bI(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var s=t[r],i=0,a=s.length,l;i<a;++i)(l=s[i])&&e.call(l,l.__data__,i,s);return this}function _I(e){return function(){this.removeAttribute(e)}}function wI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function jI(e,t){return function(){this.setAttribute(e,t)}}function SI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function kI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function NI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function CI(e,t){var r=Zc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?wI:_I:typeof t=="function"?r.local?NI:kI:r.local?SI:jI)(r,t))}function uC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function EI(e){return function(){this.style.removeProperty(e)}}function TI(e,t,r){return function(){this.style.setProperty(e,t,r)}}function AI(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function RI(e,t,r){return arguments.length>1?this.each((t==null?EI:typeof t=="function"?AI:TI)(e,t,r??"")):Si(this.node(),e)}function Si(e,t){return e.style.getPropertyValue(t)||uC(e).getComputedStyle(e,null).getPropertyValue(t)}function II(e){return function(){delete this[e]}}function PI(e,t){return function(){this[e]=t}}function MI(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function OI(e,t){return arguments.length>1?this.each((t==null?II:typeof t=="function"?MI:PI)(e,t)):this.node()[e]}function dC(e){return e.trim().split(/^|\s+/)}function Kv(e){return e.classList||new fC(e)}function fC(e){this._node=e,this._names=dC(e.getAttribute("class")||"")}fC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function pC(e,t){for(var r=Kv(e),n=-1,s=t.length;++n<s;)r.add(t[n])}function hC(e,t){for(var r=Kv(e),n=-1,s=t.length;++n<s;)r.remove(t[n])}function DI(e){return function(){pC(this,e)}}function LI(e){return function(){hC(this,e)}}function zI(e,t){return function(){(t.apply(this,arguments)?pC:hC)(this,e)}}function FI(e,t){var r=dC(e+"");if(arguments.length<2){for(var n=Kv(this.node()),s=-1,i=r.length;++s<i;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?zI:t?DI:LI)(r,t))}function $I(){this.textContent=""}function qI(e){return function(){this.textContent=e}}function BI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function WI(e){return arguments.length?this.each(e==null?$I:(typeof e=="function"?BI:qI)(e)):this.node().textContent}function HI(){this.innerHTML=""}function VI(e){return function(){this.innerHTML=e}}function UI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function GI(e){return arguments.length?this.each(e==null?HI:(typeof e=="function"?UI:VI)(e)):this.node().innerHTML}function KI(){this.nextSibling&&this.parentNode.appendChild(this)}function YI(){return this.each(KI)}function XI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function QI(){return this.each(XI)}function ZI(e){var t=typeof e=="function"?e:iC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function JI(){return null}function e6(e,t){var r=typeof e=="function"?e:iC(e),n=t==null?JI:typeof t=="function"?t:Gv(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function t6(){var e=this.parentNode;e&&e.removeChild(this)}function r6(){return this.each(t6)}function n6(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function s6(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function i6(e){return this.select(e?s6:n6)}function o6(e){return arguments.length?this.property("__data__",e):this.node().__data__}function a6(e){return function(t){e.call(this,t,this.__data__)}}function l6(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function c6(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,s=t.length,i;r<s;++r)i=t[r],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++n]=i;++n?t.length=n:delete this.__on}}}function u6(e,t,r){return function(){var n=this.__on,s,i=a6(t);if(n){for(var a=0,l=n.length;a<l;++a)if((s=n[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=r),s.value=t;return}}this.addEventListener(e.type,i,r),s={type:e.type,name:e.name,value:t,listener:i,options:r},n?n.push(s):this.__on=[s]}}function d6(e,t,r){var n=l6(e+""),s,i=n.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(s=0,u=l[c];s<i;++s)if((a=n[s]).type===u.type&&a.name===u.name)return u.value}return}for(l=t?u6:c6,s=0;s<i;++s)this.each(l(n[s],t,r));return this}function mC(e,t,r){var n=uC(e),s=n.CustomEvent;typeof s=="function"?s=new s(t,r):(s=n.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function f6(e,t){return function(){return mC(this,e,t)}}function p6(e,t){return function(){return mC(this,e,t.apply(this,arguments))}}function h6(e,t){return this.each((typeof t=="function"?p6:f6)(e,t))}function*m6(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,i=n.length,a;s<i;++s)(a=n[s])&&(yield a)}var gC=[null];function sr(e,t){this._groups=e,this._parents=t}function ya(){return new sr([[document.documentElement]],gC)}function g6(){return this}sr.prototype=ya.prototype={constructor:sr,select:BR,selectAll:UR,selectChild:XR,selectChildren:eI,filter:tI,data:aI,enter:rI,exit:cI,join:uI,merge:dI,selection:g6,order:fI,sort:pI,call:mI,nodes:gI,node:xI,size:vI,empty:yI,each:bI,attr:CI,style:RI,property:OI,classed:FI,text:WI,html:GI,raise:YI,lower:QI,append:ZI,insert:e6,remove:r6,clone:i6,datum:o6,on:d6,dispatch:h6,[Symbol.iterator]:m6};function fr(e){return typeof e=="string"?new sr([[document.querySelector(e)]],[document.documentElement]):new sr([[e]],gC)}function x6(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Nr(e,t){if(e=x6(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const v6={passive:!1},Zo={capture:!0,passive:!1};function ad(e){e.stopImmediatePropagation()}function fi(e){e.preventDefault(),e.stopImmediatePropagation()}function xC(e){var t=e.document.documentElement,r=fr(e).on("dragstart.drag",fi,Zo);"onselectstart"in t?r.on("selectstart.drag",fi,Zo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function vC(e,t){var r=e.document.documentElement,n=fr(e).on("dragstart.drag",null);t&&(n.on("click.drag",fi,Zo),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Xa=e=>()=>e;function Sx(e,{sourceEvent:t,subject:r,target:n,identifier:s,active:i,x:a,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}Sx.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function y6(e){return!e.ctrlKey&&!e.button}function b6(){return this.parentNode}function _6(e,t){return t??{x:e.x,y:e.y}}function w6(){return navigator.maxTouchPoints||"ontouchstart"in this}function j6(){var e=y6,t=b6,r=_6,n=w6,s={},i=Qc("start","drag","end"),a=0,l,c,d,u,f=0;function p(w){w.on("mousedown.drag",h).filter(n).on("touchstart.drag",_).on("touchmove.drag",x,v6).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,k){if(!(u||!e.call(this,w,k))){var C=b(this,t.call(this,w,k),w,k,"mouse");C&&(fr(w.view).on("mousemove.drag",v,Zo).on("mouseup.drag",g,Zo),xC(w.view),ad(w),d=!1,l=w.clientX,c=w.clientY,C("start",w))}}function v(w){if(fi(w),!d){var k=w.clientX-l,C=w.clientY-c;d=k*k+C*C>f}s.mouse("drag",w)}function g(w){fr(w.view).on("mousemove.drag mouseup.drag",null),vC(w.view,d),fi(w),s.mouse("end",w)}function _(w,k){if(e.call(this,w,k)){var C=w.changedTouches,N=t.call(this,w,k),E=C.length,j,A;for(j=0;j<E;++j)(A=b(this,N,w,k,C[j].identifier,C[j]))&&(ad(w),A("start",w,C[j]))}}function x(w){var k=w.changedTouches,C=k.length,N,E;for(N=0;N<C;++N)(E=s[k[N].identifier])&&(fi(w),E("drag",w,k[N]))}function y(w){var k=w.changedTouches,C=k.length,N,E;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),N=0;N<C;++N)(E=s[k[N].identifier])&&(ad(w),E("end",w,k[N]))}function b(w,k,C,N,E,j){var A=i.copy(),T=Nr(j||C,k),D,F,S;if((S=r.call(w,new Sx("beforestart",{sourceEvent:C,target:p,identifier:E,active:a,x:T[0],y:T[1],dx:0,dy:0,dispatch:A}),N))!=null)return D=S.x-T[0]||0,F=S.y-T[1]||0,function I(M,z,P){var R=T,L;switch(M){case"start":s[E]=I,L=a++;break;case"end":delete s[E],--a;case"drag":T=Nr(P||z,k),L=a;break}A.call(M,w,new Sx(M,{sourceEvent:z,subject:S,target:p,identifier:E,active:L,x:T[0]+D,y:T[1]+F,dx:T[0]-R[0],dy:T[1]-R[1],dispatch:A}),N)}}return p.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Xa(!!w),p):e},p.container=function(w){return arguments.length?(t=typeof w=="function"?w:Xa(w),p):t},p.subject=function(w){return arguments.length?(r=typeof w=="function"?w:Xa(w),p):r},p.touchable=function(w){return arguments.length?(n=typeof w=="function"?w:Xa(!!w),p):n},p.on=function(){var w=i.on.apply(i,arguments);return w===i?p:w},p.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,p):Math.sqrt(f)},p}function Yv(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function yC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ba(){}var Jo=.7,oc=1/Jo,pi="\\s*([+-]?\\d+)\\s*",ea="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",S6=/^#([0-9a-f]{3,8})$/,k6=new RegExp(`^rgb\\(${pi},${pi},${pi}\\)$`),N6=new RegExp(`^rgb\\(${Vr},${Vr},${Vr}\\)$`),C6=new RegExp(`^rgba\\(${pi},${pi},${pi},${ea}\\)$`),E6=new RegExp(`^rgba\\(${Vr},${Vr},${Vr},${ea}\\)$`),T6=new RegExp(`^hsl\\(${ea},${Vr},${Vr}\\)$`),A6=new RegExp(`^hsla\\(${ea},${Vr},${Vr},${ea}\\)$`),sb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yv(ba,ta,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ib,formatHex:ib,formatHex8:R6,formatHsl:I6,formatRgb:ob,toString:ob});function ib(){return this.rgb().formatHex()}function R6(){return this.rgb().formatHex8()}function I6(){return bC(this).formatHsl()}function ob(){return this.rgb().formatRgb()}function ta(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=S6.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?ab(t):r===3?new Wt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Qa(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Qa(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=k6.exec(e))?new Wt(t[1],t[2],t[3],1):(t=N6.exec(e))?new Wt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=C6.exec(e))?Qa(t[1],t[2],t[3],t[4]):(t=E6.exec(e))?Qa(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=T6.exec(e))?ub(t[1],t[2]/100,t[3]/100,1):(t=A6.exec(e))?ub(t[1],t[2]/100,t[3]/100,t[4]):sb.hasOwnProperty(e)?ab(sb[e]):e==="transparent"?new Wt(NaN,NaN,NaN,0):null}function ab(e){return new Wt(e>>16&255,e>>8&255,e&255,1)}function Qa(e,t,r,n){return n<=0&&(e=t=r=NaN),new Wt(e,t,r,n)}function P6(e){return e instanceof ba||(e=ta(e)),e?(e=e.rgb(),new Wt(e.r,e.g,e.b,e.opacity)):new Wt}function kx(e,t,r,n){return arguments.length===1?P6(e):new Wt(e,t,r,n??1)}function Wt(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Yv(Wt,kx,yC(ba,{brighter(e){return e=e==null?oc:Math.pow(oc,e),new Wt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Wt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Wt(xs(this.r),xs(this.g),xs(this.b),ac(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:lb,formatHex:lb,formatHex8:M6,formatRgb:cb,toString:cb}));function lb(){return`#${fs(this.r)}${fs(this.g)}${fs(this.b)}`}function M6(){return`#${fs(this.r)}${fs(this.g)}${fs(this.b)}${fs((isNaN(this.opacity)?1:this.opacity)*255)}`}function cb(){const e=ac(this.opacity);return`${e===1?"rgb(":"rgba("}${xs(this.r)}, ${xs(this.g)}, ${xs(this.b)}${e===1?")":`, ${e})`}`}function ac(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fs(e){return e=xs(e),(e<16?"0":"")+e.toString(16)}function ub(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Er(e,t,r,n)}function bC(e){if(e instanceof Er)return new Er(e.h,e.s,e.l,e.opacity);if(e instanceof ba||(e=ta(e)),!e)return new Er;if(e instanceof Er)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),i=Math.max(t,r,n),a=NaN,l=i-s,c=(i+s)/2;return l?(t===i?a=(r-n)/l+(r<n)*6:r===i?a=(n-t)/l+2:a=(t-r)/l+4,l/=c<.5?i+s:2-i-s,a*=60):l=c>0&&c<1?0:a,new Er(a,l,c,e.opacity)}function O6(e,t,r,n){return arguments.length===1?bC(e):new Er(e,t,r,n??1)}function Er(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Yv(Er,O6,yC(ba,{brighter(e){return e=e==null?oc:Math.pow(oc,e),new Er(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Er(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new Wt(ld(e>=240?e-240:e+120,s,n),ld(e,s,n),ld(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new Er(db(this.h),Za(this.s),Za(this.l),ac(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ac(this.opacity);return`${e===1?"hsl(":"hsla("}${db(this.h)}, ${Za(this.s)*100}%, ${Za(this.l)*100}%${e===1?")":`, ${e})`}`}}));function db(e){return e=(e||0)%360,e<0?e+360:e}function Za(e){return Math.max(0,Math.min(1,e||0))}function ld(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const _C=e=>()=>e;function D6(e,t){return function(r){return e+r*t}}function L6(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function z6(e){return(e=+e)==1?wC:function(t,r){return r-t?L6(t,r,e):_C(isNaN(t)?r:t)}}function wC(e,t){var r=t-e;return r?D6(e,r):_C(isNaN(e)?t:e)}const fb=function e(t){var r=z6(t);function n(s,i){var a=r((s=kx(s)).r,(i=kx(i)).r),l=r(s.g,i.g),c=r(s.b,i.b),d=wC(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return n.gamma=e,n}(1);function Nn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var Nx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cd=new RegExp(Nx.source,"g");function F6(e){return function(){return e}}function $6(e){return function(t){return e(t)+""}}function q6(e,t){var r=Nx.lastIndex=cd.lastIndex=0,n,s,i,a=-1,l=[],c=[];for(e=e+"",t=t+"";(n=Nx.exec(e))&&(s=cd.exec(t));)(i=s.index)>r&&(i=t.slice(r,i),l[a]?l[a]+=i:l[++a]=i),(n=n[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:Nn(n,s)})),r=cd.lastIndex;return r<t.length&&(i=t.slice(r),l[a]?l[a]+=i:l[++a]=i),l.length<2?c[0]?$6(c[0].x):F6(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var pb=180/Math.PI,Cx={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function jC(e,t,r,n,s,i){var a,l,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*pb,skewX:Math.atan(c)*pb,scaleX:a,scaleY:l}}var Ja;function B6(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Cx:jC(t.a,t.b,t.c,t.d,t.e,t.f)}function W6(e){return e==null||(Ja||(Ja=document.createElementNS("http://www.w3.org/2000/svg","g")),Ja.setAttribute("transform",e),!(e=Ja.transform.baseVal.consolidate()))?Cx:(e=e.matrix,jC(e.a,e.b,e.c,e.d,e.e,e.f))}function SC(e,t,r,n){function s(d){return d.length?d.pop()+" ":""}function i(d,u,f,p,h,v){if(d!==f||u!==p){var g=h.push("translate(",null,t,null,r);v.push({i:g-4,x:Nn(d,f)},{i:g-2,x:Nn(u,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function a(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(s(f)+"rotate(",null,n)-2,x:Nn(d,u)})):u&&f.push(s(f)+"rotate("+u+n)}function l(d,u,f,p){d!==u?p.push({i:f.push(s(f)+"skewX(",null,n)-2,x:Nn(d,u)}):u&&f.push(s(f)+"skewX("+u+n)}function c(d,u,f,p,h,v){if(d!==f||u!==p){var g=h.push(s(h)+"scale(",null,",",null,")");v.push({i:g-4,x:Nn(d,f)},{i:g-2,x:Nn(u,p)})}else(f!==1||p!==1)&&h.push(s(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),i(d.translateX,d.translateY,u.translateX,u.translateY,f,p),a(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var v=-1,g=p.length,_;++v<g;)f[(_=p[v]).i]=_.x(h);return f.join("")}}}var H6=SC(B6,"px, ","px)","deg)"),V6=SC(W6,", ",")",")"),U6=1e-12;function hb(e){return((e=Math.exp(e))+1/e)/2}function G6(e){return((e=Math.exp(e))-1/e)/2}function K6(e){return((e=Math.exp(2*e))-1)/(e+1)}const Y6=function e(t,r,n){function s(i,a){var l=i[0],c=i[1],d=i[2],u=a[0],f=a[1],p=a[2],h=u-l,v=f-c,g=h*h+v*v,_,x;if(g<U6)x=Math.log(p/d)/t,_=function(N){return[l+N*h,c+N*v,d*Math.exp(t*N*x)]};else{var y=Math.sqrt(g),b=(p*p-d*d+n*g)/(2*d*r*y),w=(p*p-d*d-n*g)/(2*p*r*y),k=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(w*w+1)-w);x=(C-k)/t,_=function(N){var E=N*x,j=hb(k),A=d/(r*y)*(j*K6(t*E+k)-G6(k));return[l+A*h,c+A*v,d*j/hb(t*E+k)]}}return _.duration=x*1e3*t/Math.SQRT2,_}return s.rho=function(i){var a=Math.max(.001,+i),l=a*a,c=l*l;return e(a,l,c)},s}(Math.SQRT2,2,4);var ki=0,ho=0,Qi=0,kC=1e3,lc,mo,cc=0,ks=0,Jc=0,ra=typeof performance=="object"&&performance.now?performance:Date,NC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Xv(){return ks||(NC(X6),ks=ra.now()+Jc)}function X6(){ks=0}function uc(){this._call=this._time=this._next=null}uc.prototype=CC.prototype={constructor:uc,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Xv():+r)+(t==null?0:+t),!this._next&&mo!==this&&(mo?mo._next=this:lc=this,mo=this),this._call=e,this._time=r,Ex()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ex())}};function CC(e,t,r){var n=new uc;return n.restart(e,t,r),n}function Q6(){Xv(),++ki;for(var e=lc,t;e;)(t=ks-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ki}function mb(){ks=(cc=ra.now())+Jc,ki=ho=0;try{Q6()}finally{ki=0,J6(),ks=0}}function Z6(){var e=ra.now(),t=e-cc;t>kC&&(Jc-=t,cc=e)}function J6(){for(var e,t=lc,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:lc=r);mo=e,Ex(n)}function Ex(e){if(!ki){ho&&(ho=clearTimeout(ho));var t=e-ks;t>24?(e<1/0&&(ho=setTimeout(mb,e-ra.now()-Jc)),Qi&&(Qi=clearInterval(Qi))):(Qi||(cc=ra.now(),Qi=setInterval(Z6,kC)),ki=1,NC(mb))}}function gb(e,t,r){var n=new uc;return t=t==null?0:+t,n.restart(s=>{n.stop(),e(s+t)},t,r),n}var eP=Qc("start","end","cancel","interrupt"),tP=[],EC=0,xb=1,Tx=2,Rl=3,vb=4,Ax=5,Il=6;function eu(e,t,r,n,s,i){var a=e.__transition;if(!a)e.__transition={};else if(r in a)return;rP(e,r,{name:t,index:n,group:s,on:eP,tween:tP,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:EC})}function Qv(e,t){var r=Pr(e,t);if(r.state>EC)throw new Error("too late; already scheduled");return r}function Kr(e,t){var r=Pr(e,t);if(r.state>Rl)throw new Error("too late; already running");return r}function Pr(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function rP(e,t,r){var n=e.__transition,s;n[t]=r,r.timer=CC(i,0,r.time);function i(d){r.state=xb,r.timer.restart(a,r.delay,r.time),r.delay<=d&&a(d-r.delay)}function a(d){var u,f,p,h;if(r.state!==xb)return c();for(u in n)if(h=n[u],h.name===r.name){if(h.state===Rl)return gb(a);h.state===vb?(h.state=Il,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[u]):+u<t&&(h.state=Il,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[u])}if(gb(function(){r.state===Rl&&(r.state=vb,r.timer.restart(l,r.delay,r.time),l(d))}),r.state=Tx,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Tx){for(r.state=Rl,s=new Array(p=r.tween.length),u=0,f=-1;u<p;++u)(h=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(s[++f]=h);s.length=f+1}}function l(d){for(var u=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(c),r.state=Ax,1),f=-1,p=s.length;++f<p;)s[f].call(e,u);r.state===Ax&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Il,r.timer.stop(),delete n[t];for(var d in n)return;delete e.__transition}}function Pl(e,t){var r=e.__transition,n,s,i=!0,a;if(r){t=t==null?null:t+"";for(a in r){if((n=r[a]).name!==t){i=!1;continue}s=n.state>Tx&&n.state<Ax,n.state=Il,n.timer.stop(),n.on.call(s?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[a]}i&&delete e.__transition}}function nP(e){return this.each(function(){Pl(this,e)})}function sP(e,t){var r,n;return function(){var s=Kr(this,e),i=s.tween;if(i!==r){n=r=i;for(var a=0,l=n.length;a<l;++a)if(n[a].name===t){n=n.slice(),n.splice(a,1);break}}s.tween=n}}function iP(e,t,r){var n,s;if(typeof r!="function")throw new Error;return function(){var i=Kr(this,e),a=i.tween;if(a!==n){s=(n=a).slice();for(var l={name:t,value:r},c=0,d=s.length;c<d;++c)if(s[c].name===t){s[c]=l;break}c===d&&s.push(l)}i.tween=s}}function oP(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Pr(this.node(),r).tween,s=0,i=n.length,a;s<i;++s)if((a=n[s]).name===e)return a.value;return null}return this.each((t==null?sP:iP)(r,e,t))}function Zv(e,t,r){var n=e._id;return e.each(function(){var s=Kr(this,n);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return Pr(s,n).value[t]}}function TC(e,t){var r;return(typeof t=="number"?Nn:t instanceof ta?fb:(r=ta(t))?(t=r,fb):q6)(e,t)}function aP(e){return function(){this.removeAttribute(e)}}function lP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function cP(e,t,r){var n,s=r+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===n?i:i=t(n=a,r)}}function uP(e,t,r){var n,s=r+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===n?i:i=t(n=a,r)}}function dP(e,t,r){var n,s,i;return function(){var a,l=r(this),c;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=l+"",a===c?null:a===n&&c===s?i:(s=c,i=t(n=a,l)))}}function fP(e,t,r){var n,s,i;return function(){var a,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=l+"",a===c?null:a===n&&c===s?i:(s=c,i=t(n=a,l)))}}function pP(e,t){var r=Zc(e),n=r==="transform"?V6:TC;return this.attrTween(e,typeof t=="function"?(r.local?fP:dP)(r,n,Zv(this,"attr."+e,t)):t==null?(r.local?lP:aP)(r):(r.local?uP:cP)(r,n,t))}function hP(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function mP(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function gP(e,t){var r,n;function s(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&mP(e,i)),r}return s._value=t,s}function xP(e,t){var r,n;function s(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&hP(e,i)),r}return s._value=t,s}function vP(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Zc(e);return this.tween(r,(n.local?gP:xP)(n,t))}function yP(e,t){return function(){Qv(this,e).delay=+t.apply(this,arguments)}}function bP(e,t){return t=+t,function(){Qv(this,e).delay=t}}function _P(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?yP:bP)(t,e)):Pr(this.node(),t).delay}function wP(e,t){return function(){Kr(this,e).duration=+t.apply(this,arguments)}}function jP(e,t){return t=+t,function(){Kr(this,e).duration=t}}function SP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?wP:jP)(t,e)):Pr(this.node(),t).duration}function kP(e,t){if(typeof t!="function")throw new Error;return function(){Kr(this,e).ease=t}}function NP(e){var t=this._id;return arguments.length?this.each(kP(t,e)):Pr(this.node(),t).ease}function CP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Kr(this,e).ease=r}}function EP(e){if(typeof e!="function")throw new Error;return this.each(CP(this._id,e))}function TP(e){typeof e!="function"&&(e=aC(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var i=t[s],a=i.length,l=n[s]=[],c,d=0;d<a;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&l.push(c);return new hn(n,this._parents,this._name,this._id)}function AP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,s=r.length,i=Math.min(n,s),a=new Array(n),l=0;l<i;++l)for(var c=t[l],d=r[l],u=c.length,f=a[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<n;++l)a[l]=t[l];return new hn(a,this._parents,this._name,this._id)}function RP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function IP(e,t,r){var n,s,i=RP(t)?Qv:Kr;return function(){var a=i(this,e),l=a.on;l!==n&&(s=(n=l).copy()).on(t,r),a.on=s}}function PP(e,t){var r=this._id;return arguments.length<2?Pr(this.node(),r).on.on(e):this.each(IP(r,e,t))}function MP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function OP(){return this.on("end.remove",MP(this._id))}function DP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Gv(e));for(var n=this._groups,s=n.length,i=new Array(s),a=0;a<s;++a)for(var l=n[a],c=l.length,d=i[a]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,eu(d[p],t,r,p,d,Pr(u,r)));return new hn(i,this._parents,t,r)}function LP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=oC(e));for(var n=this._groups,s=n.length,i=[],a=[],l=0;l<s;++l)for(var c=n[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,v=Pr(u,r),g=0,_=p.length;g<_;++g)(h=p[g])&&eu(h,t,r,g,p,v);i.push(p),a.push(u)}return new hn(i,a,t,r)}var zP=ya.prototype.constructor;function FP(){return new zP(this._groups,this._parents)}function $P(e,t){var r,n,s;return function(){var i=Si(this,e),a=(this.style.removeProperty(e),Si(this,e));return i===a?null:i===r&&a===n?s:s=t(r=i,n=a)}}function AC(e){return function(){this.style.removeProperty(e)}}function qP(e,t,r){var n,s=r+"",i;return function(){var a=Si(this,e);return a===s?null:a===n?i:i=t(n=a,r)}}function BP(e,t,r){var n,s,i;return function(){var a=Si(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Si(this,e))),a===c?null:a===n&&c===s?i:(s=c,i=t(n=a,l))}}function WP(e,t){var r,n,s,i="style."+t,a="end."+i,l;return function(){var c=Kr(this,e),d=c.on,u=c.value[i]==null?l||(l=AC(t)):void 0;(d!==r||s!==u)&&(n=(r=d).copy()).on(a,s=u),c.on=n}}function HP(e,t,r){var n=(e+="")=="transform"?H6:TC;return t==null?this.styleTween(e,$P(e,n)).on("end.style."+e,AC(e)):typeof t=="function"?this.styleTween(e,BP(e,n,Zv(this,"style."+e,t))).each(WP(this._id,e)):this.styleTween(e,qP(e,n,t),r).on("end.style."+e,null)}function VP(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function UP(e,t,r){var n,s;function i(){var a=t.apply(this,arguments);return a!==s&&(n=(s=a)&&VP(e,a,r)),n}return i._value=t,i}function GP(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,UP(e,t,r??""))}function KP(e){return function(){this.textContent=e}}function YP(e){return function(){var t=e(this);this.textContent=t??""}}function XP(e){return this.tween("text",typeof e=="function"?YP(Zv(this,"text",e)):KP(e==null?"":e+""))}function QP(e){return function(t){this.textContent=e.call(this,t)}}function ZP(e){var t,r;function n(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&QP(s)),t}return n._value=e,n}function JP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,ZP(e))}function eM(){for(var e=this._name,t=this._id,r=RC(),n=this._groups,s=n.length,i=0;i<s;++i)for(var a=n[i],l=a.length,c,d=0;d<l;++d)if(c=a[d]){var u=Pr(c,t);eu(c,e,r,d,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new hn(n,this._parents,e,r)}function tM(){var e,t,r=this,n=r._id,s=r.size();return new Promise(function(i,a){var l={value:a},c={value:function(){--s===0&&i()}};r.each(function(){var d=Kr(this,n),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),s===0&&i()})}var rM=0;function hn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function RC(){return++rM}var Xr=ya.prototype;hn.prototype={constructor:hn,select:DP,selectAll:LP,selectChild:Xr.selectChild,selectChildren:Xr.selectChildren,filter:TP,merge:AP,selection:FP,transition:eM,call:Xr.call,nodes:Xr.nodes,node:Xr.node,size:Xr.size,empty:Xr.empty,each:Xr.each,on:PP,attr:pP,attrTween:vP,style:HP,styleTween:GP,text:XP,textTween:JP,remove:OP,tween:oP,delay:_P,duration:SP,ease:NP,easeVarying:EP,end:tM,[Symbol.iterator]:Xr[Symbol.iterator]};function nM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var sM={time:null,delay:0,duration:250,ease:nM};function iM(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function oM(e){var t,r;e instanceof hn?(t=e._id,e=e._name):(t=RC(),(r=sM).time=Xv(),e=e==null?null:e+"");for(var n=this._groups,s=n.length,i=0;i<s;++i)for(var a=n[i],l=a.length,c,d=0;d<l;++d)(c=a[d])&&eu(c,e,t,d,a,r||iM(c,t));return new hn(n,this._parents,e,t)}ya.prototype.interrupt=nP;ya.prototype.transition=oM;const el=e=>()=>e;function aM(e,{sourceEvent:t,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function sn(e,t,r){this.k=e,this.x=t,this.y=r}sn.prototype={constructor:sn,scale:function(e){return e===1?this:new sn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new sn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var cn=new sn(1,0,0);sn.prototype;function ud(e){e.stopImmediatePropagation()}function Zi(e){e.preventDefault(),e.stopImmediatePropagation()}function lM(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function cM(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function yb(){return this.__zoom||cn}function uM(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function dM(){return navigator.maxTouchPoints||"ontouchstart"in this}function fM(e,t,r){var n=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],i=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function IC(){var e=lM,t=cM,r=fM,n=uM,s=dM,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,c=Y6,d=Qc("start","zoom","end"),u,f,p,h=500,v=150,g=0,_=10;function x(S){S.property("__zoom",yb).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",A).filter(s).on("touchstart.zoom",T).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(S,I,M,z){var P=S.selection?S.selection():S;P.property("__zoom",yb),S!==P?k(S,I,M,z):P.interrupt().each(function(){C(this,arguments).event(z).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},x.scaleBy=function(S,I,M,z){x.scaleTo(S,function(){var P=this.__zoom.k,R=typeof I=="function"?I.apply(this,arguments):I;return P*R},M,z)},x.scaleTo=function(S,I,M,z){x.transform(S,function(){var P=t.apply(this,arguments),R=this.__zoom,L=M==null?w(P):typeof M=="function"?M.apply(this,arguments):M,$=R.invert(L),q=typeof I=="function"?I.apply(this,arguments):I;return r(b(y(R,q),L,$),P,a)},M,z)},x.translateBy=function(S,I,M,z){x.transform(S,function(){return r(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof M=="function"?M.apply(this,arguments):M),t.apply(this,arguments),a)},null,z)},x.translateTo=function(S,I,M,z,P){x.transform(S,function(){var R=t.apply(this,arguments),L=this.__zoom,$=z==null?w(R):typeof z=="function"?z.apply(this,arguments):z;return r(cn.translate($[0],$[1]).scale(L.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof M=="function"?-M.apply(this,arguments):-M),R,a)},z,P)};function y(S,I){return I=Math.max(i[0],Math.min(i[1],I)),I===S.k?S:new sn(I,S.x,S.y)}function b(S,I,M){var z=I[0]-M[0]*S.k,P=I[1]-M[1]*S.k;return z===S.x&&P===S.y?S:new sn(S.k,z,P)}function w(S){return[(+S[0][0]+ +S[1][0])/2,(+S[0][1]+ +S[1][1])/2]}function k(S,I,M,z){S.on("start.zoom",function(){C(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(z).end()}).tween("zoom",function(){var P=this,R=arguments,L=C(P,R).event(z),$=t.apply(P,R),q=M==null?w($):typeof M=="function"?M.apply(P,R):M,Y=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),K=P.__zoom,H=typeof I=="function"?I.apply(P,R):I,B=c(K.invert(q).concat(Y/K.k),H.invert(q).concat(Y/H.k));return function(X){if(X===1)X=H;else{var ie=B(X),oe=Y/ie[2];X=new sn(oe,q[0]-ie[0]*oe,q[1]-ie[1]*oe)}L.zoom(null,X)}})}function C(S,I,M){return!M&&S.__zooming||new N(S,I)}function N(S,I){this.that=S,this.args=I,this.active=0,this.sourceEvent=null,this.extent=t.apply(S,I),this.taps=0}N.prototype={event:function(S){return S&&(this.sourceEvent=S),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(S,I){return this.mouse&&S!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&S!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&S!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(S){var I=fr(this.that).datum();d.call(S,this.that,new aM(S,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:d}),I)}};function E(S,...I){if(!e.apply(this,arguments))return;var M=C(this,I).event(S),z=this.__zoom,P=Math.max(i[0],Math.min(i[1],z.k*Math.pow(2,n.apply(this,arguments)))),R=Nr(S);if(M.wheel)(M.mouse[0][0]!==R[0]||M.mouse[0][1]!==R[1])&&(M.mouse[1]=z.invert(M.mouse[0]=R)),clearTimeout(M.wheel);else{if(z.k===P)return;M.mouse=[R,z.invert(R)],Pl(this),M.start()}Zi(S),M.wheel=setTimeout(L,v),M.zoom("mouse",r(b(y(z,P),M.mouse[0],M.mouse[1]),M.extent,a));function L(){M.wheel=null,M.end()}}function j(S,...I){if(p||!e.apply(this,arguments))return;var M=S.currentTarget,z=C(this,I,!0).event(S),P=fr(S.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",Y,!0),R=Nr(S,M),L=S.clientX,$=S.clientY;xC(S.view),ud(S),z.mouse=[R,this.__zoom.invert(R)],Pl(this),z.start();function q(K){if(Zi(K),!z.moved){var H=K.clientX-L,B=K.clientY-$;z.moved=H*H+B*B>g}z.event(K).zoom("mouse",r(b(z.that.__zoom,z.mouse[0]=Nr(K,M),z.mouse[1]),z.extent,a))}function Y(K){P.on("mousemove.zoom mouseup.zoom",null),vC(K.view,z.moved),Zi(K),z.event(K).end()}}function A(S,...I){if(e.apply(this,arguments)){var M=this.__zoom,z=Nr(S.changedTouches?S.changedTouches[0]:S,this),P=M.invert(z),R=M.k*(S.shiftKey?.5:2),L=r(b(y(M,R),z,P),t.apply(this,I),a);Zi(S),l>0?fr(this).transition().duration(l).call(k,L,z,S):fr(this).call(x.transform,L,z,S)}}function T(S,...I){if(e.apply(this,arguments)){var M=S.touches,z=M.length,P=C(this,I,S.changedTouches.length===z).event(S),R,L,$,q;for(ud(S),L=0;L<z;++L)$=M[L],q=Nr($,this),q=[q,this.__zoom.invert(q),$.identifier],P.touch0?!P.touch1&&P.touch0[2]!==q[2]&&(P.touch1=q,P.taps=0):(P.touch0=q,R=!0,P.taps=1+!!u);u&&(u=clearTimeout(u)),R&&(P.taps<2&&(f=q[0],u=setTimeout(function(){u=null},h)),Pl(this),P.start())}}function D(S,...I){if(this.__zooming){var M=C(this,I).event(S),z=S.changedTouches,P=z.length,R,L,$,q;for(Zi(S),R=0;R<P;++R)L=z[R],$=Nr(L,this),M.touch0&&M.touch0[2]===L.identifier?M.touch0[0]=$:M.touch1&&M.touch1[2]===L.identifier&&(M.touch1[0]=$);if(L=M.that.__zoom,M.touch1){var Y=M.touch0[0],K=M.touch0[1],H=M.touch1[0],B=M.touch1[1],X=(X=H[0]-Y[0])*X+(X=H[1]-Y[1])*X,ie=(ie=B[0]-K[0])*ie+(ie=B[1]-K[1])*ie;L=y(L,Math.sqrt(X/ie)),$=[(Y[0]+H[0])/2,(Y[1]+H[1])/2],q=[(K[0]+B[0])/2,(K[1]+B[1])/2]}else if(M.touch0)$=M.touch0[0],q=M.touch0[1];else return;M.zoom("touch",r(b(L,$,q),M.extent,a))}}function F(S,...I){if(this.__zooming){var M=C(this,I).event(S),z=S.changedTouches,P=z.length,R,L;for(ud(S),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),R=0;R<P;++R)L=z[R],M.touch0&&M.touch0[2]===L.identifier?delete M.touch0:M.touch1&&M.touch1[2]===L.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(L=Nr(L,this),Math.hypot(f[0]-L[0],f[1]-L[1])<_)){var $=fr(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return x.wheelDelta=function(S){return arguments.length?(n=typeof S=="function"?S:el(+S),x):n},x.filter=function(S){return arguments.length?(e=typeof S=="function"?S:el(!!S),x):e},x.touchable=function(S){return arguments.length?(s=typeof S=="function"?S:el(!!S),x):s},x.extent=function(S){return arguments.length?(t=typeof S=="function"?S:el([[+S[0][0],+S[0][1]],[+S[1][0],+S[1][1]]]),x):t},x.scaleExtent=function(S){return arguments.length?(i[0]=+S[0],i[1]=+S[1],x):[i[0],i[1]]},x.translateExtent=function(S){return arguments.length?(a[0][0]=+S[0][0],a[1][0]=+S[1][0],a[0][1]=+S[0][1],a[1][1]=+S[1][1],x):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},x.constrain=function(S){return arguments.length?(r=S,x):r},x.duration=function(S){return arguments.length?(l=+S,x):l},x.interpolate=function(S){return arguments.length?(c=S,x):c},x.on=function(){var S=d.on.apply(d,arguments);return S===d?x:S},x.clickDistance=function(S){return arguments.length?(g=(S=+S)*S,x):Math.sqrt(g)},x.tapDistance=function(S){return arguments.length?(_=+S,x):_},x}const tu=m.createContext(null),pM=tu.Provider,mn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},PC=mn.error001();function Xe(e,t){const r=m.useContext(tu);if(r===null)throw new Error(PC);return sC(r,e,t)}const vt=()=>{const e=m.useContext(tu);if(e===null)throw new Error(PC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},hM=e=>e.userSelectionActive?"none":"all";function Hn({position:e,children:t,className:r,style:n,...s}){const i=Xe(hM),a=`${e}`.split("-");return G.createElement("div",{className:Yt(["react-flow__panel",r,...a]),style:{...n,pointerEvents:i},...s},t)}function mM({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:G.createElement(Hn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},G.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const gM=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),v=Yt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();h({x:g.x,y:g.y,width:g.width,height:g.height})}},[r]),typeof r>"u"||!r?null:G.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:v,visibility:p.width?"visible":"hidden",...u},s&&G.createElement("rect",{width:p.width+2*a[0],x:-a[0],y:-a[1],height:p.height+2*a[1],className:"react-flow__edge-textbg",style:i,rx:l,ry:l}),G.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var xM=m.memo(gM);const Jv=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ni=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),ey=(e={x:0,y:0},t)=>({x:Ni(e.x,t[0][0],t[1][0]),y:Ni(e.y,t[0][1],t[1][1])}),bb=(e,t,r)=>e<t?Ni(Math.abs(e-t),1,50)/50:e>r?-Ni(Math.abs(e-r),1,50)/50:0,MC=(e,t)=>{const r=bb(e.x,35,t.width-35)*20,n=bb(e.y,35,t.height-35)*20;return[r,n]},OC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},DC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),na=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),LC=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),_b=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),vM=(e,t)=>LC(DC(na(e),na(t))),Rx=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},yM=e=>hr(e.width)&&hr(e.height)&&hr(e.x)&&hr(e.y),hr=e=>!isNaN(e)&&isFinite(e),nt=Symbol.for("internals"),zC=["Enter"," ","Escape"],bM=(e,t)=>{},_M=e=>"nativeEvent"in e;function Ix(e){var s,i;const t=_M(e)?e.nativeEvent:e,r=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const FC=e=>"clientX"in e,Vn=(e,t)=>{var i,a;const r=FC(e),n=r?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=r?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},dc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},_a=({id:e,path:t,labelX:r,labelY:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>G.createElement(G.Fragment,null,G.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&G.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&hr(r)&&hr(n)?G.createElement(xM,{x:r,y:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);_a.displayName="BaseEdge";function Ji(e,t,r){return r===void 0?r:n=>{const s=t().edges.find(i=>i.id===e);s&&r(n,{...s})}}function $C({sourceX:e,sourceY:t,targetX:r,targetY:n}){const s=Math.abs(r-e)/2,i=r<e?r+s:r-s,a=Math.abs(n-t)/2,l=n<t?n+a:n-a;return[i,l,s,a]}function qC({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:s,sourceControlY:i,targetControlX:a,targetControlY:l}){const c=e*.125+s*.375+a*.375+r*.125,d=t*.125+i*.375+l*.375+n*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Ns;(function(e){e.Strict="strict",e.Loose="loose"})(Ns||(Ns={}));var ps;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ps||(ps={}));var sa;(function(e){e.Partial="partial",e.Full="full"})(sa||(sa={}));var Rn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Rn||(Rn={}));var fc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(fc||(fc={}));var ce;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ce||(ce={}));function wb({pos:e,x1:t,y1:r,x2:n,y2:s}){return e===ce.Left||e===ce.Right?[.5*(t+n),r]:[t,.5*(r+s)]}function BC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:i=ce.Top}){const[a,l]=wb({pos:r,x1:e,y1:t,x2:n,y2:s}),[c,d]=wb({pos:i,x1:n,y1:s,x2:e,y2:t}),[u,f,p,h]=qC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${n},${s}`,u,f,p,h]}const ty=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=ce.Bottom,targetPosition:i=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:g})=>{const[_,x,y]=BC({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:i});return G.createElement(_a,{path:_,labelX:x,labelY:y,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:g})});ty.displayName="SimpleBezierEdge";const jb={[ce.Left]:{x:-1,y:0},[ce.Right]:{x:1,y:0},[ce.Top]:{x:0,y:-1},[ce.Bottom]:{x:0,y:1}},wM=({source:e,sourcePosition:t=ce.Bottom,target:r})=>t===ce.Left||t===ce.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Sb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function jM({source:e,sourcePosition:t=ce.Bottom,target:r,targetPosition:n=ce.Top,center:s,offset:i}){const a=jb[t],l=jb[n],c={x:e.x+a.x*i,y:e.y+a.y*i},d={x:r.x+l.x*i,y:r.y+l.y*i},u=wM({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],v,g;const _={x:0,y:0},x={x:0,y:0},[y,b,w,k]=$C({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(a[f]*l[f]===-1){v=s.x??y,g=s.y??b;const N=[{x:v,y:c.y},{x:v,y:d.y}],E=[{x:c.x,y:g},{x:d.x,y:g}];a[f]===p?h=f==="x"?N:E:h=f==="x"?E:N}else{const N=[{x:c.x,y:d.y}],E=[{x:d.x,y:c.y}];if(f==="x"?h=a.x===p?E:N:h=a.y===p?N:E,t===n){const F=Math.abs(e[f]-r[f]);if(F<=i){const S=Math.min(i-1,i-F);a[f]===p?_[f]=(c[f]>e[f]?-1:1)*S:x[f]=(d[f]>r[f]?-1:1)*S}}if(t!==n){const F=f==="x"?"y":"x",S=a[f]===l[F],I=c[F]>d[F],M=c[F]<d[F];(a[f]===1&&(!S&&I||S&&M)||a[f]!==1&&(!S&&M||S&&I))&&(h=f==="x"?N:E)}const j={x:c.x+_.x,y:c.y+_.y},A={x:d.x+x.x,y:d.y+x.y},T=Math.max(Math.abs(j.x-h[0].x),Math.abs(A.x-h[0].x)),D=Math.max(Math.abs(j.y-h[0].y),Math.abs(A.y-h[0].y));T>=D?(v=(j.x+A.x)/2,g=h[0].y):(v=h[0].x,g=(j.y+A.y)/2)}return[[e,{x:c.x+_.x,y:c.y+_.y},...h,{x:d.x+x.x,y:d.y+x.y},r],v,g,w,k]}function SM(e,t,r,n){const s=Math.min(Sb(e,t)/2,Sb(t,r)/2,n),{x:i,y:a}=t;if(e.x===i&&i===r.x||e.y===a&&a===r.y)return`L${i} ${a}`;if(e.y===a){const d=e.x<r.x?-1:1,u=e.y<r.y?1:-1;return`L ${i+s*d},${a}Q ${i},${a} ${i},${a+s*u}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${i},${a+s*c}Q ${i},${a} ${i+s*l},${a}`}function Px({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:i=ce.Top,borderRadius:a=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,v]=jM({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:s},targetPosition:i,center:{x:l,y:c},offset:d});return[u.reduce((_,x,y)=>{let b="";return y>0&&y<u.length-1?b=SM(u[y-1],x,u[y+1],a):b=`${y===0?"M":"L"}${x.x} ${x.y}`,_+=b,_},""),f,p,h,v]}const ru=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=ce.Bottom,targetPosition:p=ce.Top,markerEnd:h,markerStart:v,pathOptions:g,interactionWidth:_})=>{const[x,y,b]=Px({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return G.createElement(_a,{path:x,labelX:y,labelY:b,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:v,interactionWidth:_})});ru.displayName="SmoothStepEdge";const ry=m.memo(e=>{var t;return G.createElement(ru,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});ry.displayName="StepEdge";function kM({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[s,i,a,l]=$C({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,s,i,a,l]}const ny=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[v,g,_]=kM({sourceX:e,sourceY:t,targetX:r,targetY:n});return G.createElement(_a,{path:v,labelX:g,labelY:_,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});ny.displayName="StraightEdge";function tl(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function kb({pos:e,x1:t,y1:r,x2:n,y2:s,c:i}){switch(e){case ce.Left:return[t-tl(t-n,i),r];case ce.Right:return[t+tl(n-t,i),r];case ce.Top:return[t,r-tl(r-s,i)];case ce.Bottom:return[t,r+tl(s-r,i)]}}function WC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:s,targetPosition:i=ce.Top,curvature:a=.25}){const[l,c]=kb({pos:r,x1:e,y1:t,x2:n,y2:s,c:a}),[d,u]=kb({pos:i,x1:n,y1:s,x2:e,y2:t,c:a}),[f,p,h,v]=qC({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${n},${s}`,f,p,h,v]}const pc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=ce.Bottom,targetPosition:i=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,pathOptions:g,interactionWidth:_})=>{const[x,y,b]=WC({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:i,curvature:g==null?void 0:g.curvature});return G.createElement(_a,{path:x,labelX:y,labelY:b,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:_})});pc.displayName="BezierEdge";const sy=m.createContext(null),NM=sy.Provider;sy.Consumer;const CM=()=>m.useContext(sy),EM=e=>"id"in e&&"source"in e&&"target"in e,TM=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Mx=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,AM=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),RM=(e,t)=>{if(!e.source||!e.target)return t;let r;return EM(e)?r={...e}:r={...e,id:TM(e)},AM(r,t)?t:t.concat(r)},Ox=({x:e,y:t},[r,n,s],i,[a,l])=>{const c={x:(e-r)/s,y:(t-n)/s};return i?{x:a*Math.round(c.x/a),y:l*Math.round(c.y/l)}:c},HC=({x:e,y:t},[r,n,s])=>({x:e*s+r,y:t*s+n}),vs=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-n};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:s}},nu=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,s)=>{const{x:i,y:a}=vs(s,t).positionAbsolute;return DC(n,na({x:i,y:a,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return LC(r)},VC=(e,t,[r,n,s]=[0,0,1],i=!1,a=!1,l=[0,0])=>{const c={x:(t.x-r)/s,y:(t.y-n)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:v=!1}=u;if(a&&!h||v)return!1;const{positionAbsolute:g}=vs(u,l),_={x:g.x,y:g.y,width:f||0,height:p||0},x=Rx(c,_),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=i&&x>0,w=(f||0)*(p||0);(y||b||x>=w||u.dragging)&&d.push(u)}),d},UC=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},GC=(e,t,r,n,s,i=.1)=>{const a=t/(e.width*(1+i)),l=r/(e.height*(1+i)),c=Math.min(a,l),d=Ni(c,n,s),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=r/2-f*d;return{x:p,y:h,zoom:d}},ls=(e,t=0)=>e.transition().duration(t);function Nb(e,t,r,n){return(t[r]||[]).reduce((s,i)=>{var a,l;return`${e.id}-${i.id}-${r}`!==n&&s.push({id:i.id||null,type:r,nodeId:e.id,x:(((a=e.positionAbsolute)==null?void 0:a.x)??0)+i.x+i.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+i.y+i.height/2}),s},[])}function IM(e,t,r,n,s,i){const{x:a,y:l}=Vn(e),d=t.elementsFromPoint(a,l).find(v=>v.classList.contains("react-flow__handle"));if(d){const v=d.getAttribute("data-nodeid");if(v){const g=iy(void 0,d),_=d.getAttribute("data-handleid"),x=i({nodeId:v,id:_,type:g});if(x){const y=s.find(b=>b.nodeId===v&&b.type===g&&b.id===_);return{handle:{id:_,type:g,nodeId:v,x:(y==null?void 0:y.x)||r.x,y:(y==null?void 0:y.y)||r.y},validHandleResult:x}}}}let u=[],f=1/0;if(s.forEach(v=>{const g=Math.sqrt((v.x-r.x)**2+(v.y-r.y)**2);if(g<=n){const _=i(v);g<=f&&(g<f?u=[{handle:v,validHandleResult:_}]:g===f&&u.push({handle:v,validHandleResult:_}),f=g)}}),!u.length)return{handle:null,validHandleResult:KC()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:v})=>v.isValid),h=u.some(({handle:v})=>v.type==="target");return u.find(({handle:v,validHandleResult:g})=>h?v.type==="target":p?g.isValid:!0)||u[0]}const PM={source:null,target:null,sourceHandle:null,targetHandle:null},KC=()=>({handleDomNode:null,isValid:!1,connection:PM,endHandle:null});function YC(e,t,r,n,s,i,a){const l=s==="target",c=a.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...KC(),handleDomNode:c};if(c){const u=iy(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),v=c.classList.contains("connectableend"),g={source:l?f:r,sourceHandle:l?p:n,target:l?r:f,targetHandle:l?n:p};d.connection=g,h&&v&&(t===Ns.Strict?l&&u==="source"||!l&&u==="target":f!==r||p!==n)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=i(g))}return d}function MM({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((s,i)=>{if(i[nt]){const{handleBounds:a}=i[nt];let l=[],c=[];a&&(l=Nb(i,a,"source",`${t}-${r}-${n}`),c=Nb(i,a,"target",`${t}-${r}-${n}`)),s.push(...l,...c)}return s},[])}function iy(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function dd(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function OM(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function XC({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:s,getState:i,setState:a,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=OC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:v,onConnectStart:g,panBy:_,getNodes:x,cancelConnection:y}=i();let b=0,w;const{x:k,y:C}=Vn(e),N=u==null?void 0:u.elementFromPoint(k,C),E=iy(c,N),j=p==null?void 0:p.getBoundingClientRect();if(!j||!E)return;let A,T=Vn(e,j),D=!1,F=null,S=!1,I=null;const M=MM({nodes:x(),nodeId:r,handleId:t,handleType:E}),z=()=>{if(!h)return;const[L,$]=MC(T,j);_({x:L,y:$}),b=requestAnimationFrame(z)};a({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:r,handleId:t,type:E},connectionEndHandle:null}),g==null||g(e,{nodeId:r,handleId:t,handleType:E});function P(L){const{transform:$}=i();T=Vn(L,j);const{handle:q,validHandleResult:Y}=IM(L,u,Ox(T,$,!1,[1,1]),v,M,K=>YC(K,f,r,t,s?"target":"source",l,u));if(w=q,D||(z(),D=!0),I=Y.handleDomNode,F=Y.connection,S=Y.isValid,a({connectionPosition:w&&S?HC({x:w.x,y:w.y},$):T,connectionStatus:OM(!!w,S),connectionEndHandle:Y.endHandle}),!w&&!S&&!I)return dd(A);F.source!==F.target&&I&&(dd(A),A=I,I.classList.add("connecting","react-flow__handle-connecting"),I.classList.toggle("valid",S),I.classList.toggle("react-flow__handle-valid",S))}function R(L){var $,q;(w||I)&&F&&S&&(n==null||n(F)),(q=($=i()).onConnectEnd)==null||q.call($,L),c&&(d==null||d(L)),dd(A),y(),cancelAnimationFrame(b),D=!1,S=!1,F=null,I=null,u.removeEventListener("mousemove",P),u.removeEventListener("mouseup",R),u.removeEventListener("touchmove",P),u.removeEventListener("touchend",R)}u.addEventListener("mousemove",P),u.addEventListener("mouseup",R),u.addEventListener("touchmove",P),u.addEventListener("touchend",R)}const Cb=()=>!0,DM=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),LM=(e,t,r)=>n=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:a}=n;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.handleId)===t&&(a==null?void 0:a.type)===r}},QC=m.forwardRef(({type:e="source",position:t=ce.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:a,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var j,A;const v=a||null,g=e==="target",_=vt(),x=CM(),{connectOnClick:y,noPanClassName:b}=Xe(DM,Pt),{connecting:w,clickConnecting:k}=Xe(LM(x,v,e),Pt);x||(A=(j=_.getState()).onError)==null||A.call(j,"010",mn.error010());const C=T=>{const{defaultEdgeOptions:D,onConnect:F,hasDefaultEdges:S}=_.getState(),I={...D,...T};if(S){const{edges:M,setEdges:z}=_.getState();z(RM(I,M))}F==null||F(I),l==null||l(I)},N=T=>{if(!x)return;const D=FC(T);s&&(D&&T.button===0||!D)&&XC({event:T,handleId:v,nodeId:x,onConnect:C,isTarget:g,getState:_.getState,setState:_.setState,isValidConnection:r||_.getState().isValidConnection||Cb}),D?u==null||u(T):f==null||f(T)},E=T=>{const{onClickConnectStart:D,onClickConnectEnd:F,connectionClickStartHandle:S,connectionMode:I,isValidConnection:M}=_.getState();if(!x||!S&&!s)return;if(!S){D==null||D(T,{nodeId:x,handleId:v,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:x,type:e,handleId:v}});return}const z=OC(T.target),P=r||M||Cb,{connection:R,isValid:L}=YC({nodeId:x,id:v,type:e},I,S.nodeId,S.handleId||null,S.type,P,z);L&&C(R),F==null||F(T),_.setState({connectionClickStartHandle:null})};return G.createElement("div",{"data-handleid":v,"data-nodeid":x,"data-handlepos":t,"data-id":`${x}-${v}-${e}`,className:Yt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!g,target:g,connectable:n,connectablestart:s,connectableend:i,connecting:k,connectionindicator:n&&(s&&!w||i&&w)}]),onMouseDown:N,onTouchStart:N,onClick:y?E:void 0,ref:h,...p},c)});QC.displayName="Handle";var vr=m.memo(QC);const ZC=({data:e,isConnectable:t,targetPosition:r=ce.Top,sourcePosition:n=ce.Bottom})=>G.createElement(G.Fragment,null,G.createElement(vr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,G.createElement(vr,{type:"source",position:n,isConnectable:t}));ZC.displayName="DefaultNode";var Dx=m.memo(ZC);const JC=({data:e,isConnectable:t,sourcePosition:r=ce.Bottom})=>G.createElement(G.Fragment,null,e==null?void 0:e.label,G.createElement(vr,{type:"source",position:r,isConnectable:t}));JC.displayName="InputNode";var eE=m.memo(JC);const tE=({data:e,isConnectable:t,targetPosition:r=ce.Top})=>G.createElement(G.Fragment,null,G.createElement(vr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);tE.displayName="OutputNode";var rE=m.memo(tE);const oy=()=>null;oy.displayName="GroupNode";const zM=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),rl=e=>e.id;function FM(e,t){return Pt(e.selectedNodes.map(rl),t.selectedNodes.map(rl))&&Pt(e.selectedEdges.map(rl),t.selectedEdges.map(rl))}const nE=m.memo(({onSelectionChange:e})=>{const t=vt(),{selectedNodes:r,selectedEdges:n}=Xe(zM,FM);return m.useEffect(()=>{const s={nodes:r,edges:n};e==null||e(s),t.getState().onSelectionChange.forEach(i=>i(s))},[r,n,e]),null});nE.displayName="SelectionListener";const $M=e=>!!e.onSelectionChange;function qM({onSelectionChange:e}){const t=Xe($M);return e||t?G.createElement(nE,{onSelectionChange:e}):null}const BM=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Os(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ke(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const WM=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:s,onConnectStart:i,onConnectEnd:a,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:v,minZoom:g,maxZoom:_,nodeExtent:x,onNodesChange:y,onEdgesChange:b,elementsSelectable:w,connectionMode:k,snapGrid:C,snapToGrid:N,translateExtent:E,connectOnClick:j,defaultEdgeOptions:A,fitView:T,fitViewOptions:D,onNodesDelete:F,onEdgesDelete:S,onNodeDrag:I,onNodeDragStart:M,onNodeDragStop:z,onSelectionDrag:P,onSelectionDragStart:R,onSelectionDragStop:L,noPanClassName:$,nodeOrigin:q,rfId:Y,autoPanOnConnect:K,autoPanOnNodeDrag:H,onError:B,connectionRadius:X,isValidConnection:ie,nodeDragThreshold:oe})=>{const{setNodes:J,setEdges:we,setDefaultNodesAndEdges:ge,setMinZoom:_e,setMaxZoom:xe,setTranslateExtent:ae,setNodeExtent:U,reset:re}=Xe(BM,Pt),te=vt();return m.useEffect(()=>{const je=n==null?void 0:n.map(se=>({...se,...A}));return ge(r,je),()=>{re()}},[]),ke("defaultEdgeOptions",A,te.setState),ke("connectionMode",k,te.setState),ke("onConnect",s,te.setState),ke("onConnectStart",i,te.setState),ke("onConnectEnd",a,te.setState),ke("onClickConnectStart",l,te.setState),ke("onClickConnectEnd",c,te.setState),ke("nodesDraggable",d,te.setState),ke("nodesConnectable",u,te.setState),ke("nodesFocusable",f,te.setState),ke("edgesFocusable",p,te.setState),ke("edgesUpdatable",h,te.setState),ke("elementsSelectable",w,te.setState),ke("elevateNodesOnSelect",v,te.setState),ke("snapToGrid",N,te.setState),ke("snapGrid",C,te.setState),ke("onNodesChange",y,te.setState),ke("onEdgesChange",b,te.setState),ke("connectOnClick",j,te.setState),ke("fitViewOnInit",T,te.setState),ke("fitViewOnInitOptions",D,te.setState),ke("onNodesDelete",F,te.setState),ke("onEdgesDelete",S,te.setState),ke("onNodeDrag",I,te.setState),ke("onNodeDragStart",M,te.setState),ke("onNodeDragStop",z,te.setState),ke("onSelectionDrag",P,te.setState),ke("onSelectionDragStart",R,te.setState),ke("onSelectionDragStop",L,te.setState),ke("noPanClassName",$,te.setState),ke("nodeOrigin",q,te.setState),ke("rfId",Y,te.setState),ke("autoPanOnConnect",K,te.setState),ke("autoPanOnNodeDrag",H,te.setState),ke("onError",B,te.setState),ke("connectionRadius",X,te.setState),ke("isValidConnection",ie,te.setState),ke("nodeDragThreshold",oe,te.setState),Os(e,J),Os(t,we),Os(g,_e),Os(_,xe),Os(E,ae),Os(x,U),null},Eb={display:"none"},HM={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},sE="react-flow__node-desc",iE="react-flow__edge-desc",VM="react-flow__aria-live",UM=e=>e.ariaLiveMessage;function GM({rfId:e}){const t=Xe(UM);return G.createElement("div",{id:`${VM}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:HM},t)}function KM({rfId:e,disableKeyboardA11y:t}){return G.createElement(G.Fragment,null,G.createElement("div",{id:`${sE}-${e}`,style:Eb},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),G.createElement("div",{id:`${iE}-${e}`,style:Eb},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&G.createElement(GM,{rfId:e}))}var ia=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),s=m.useRef(!1),i=m.useRef(new Set([])),[a,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Ix(h))return!1;const g=Ab(h.code,l);i.current.add(h[g]),Tb(a,i.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Ix(h))return!1;const g=Ab(h.code,l);Tb(a,i.current,!0)?(n(!1),i.current.clear()):i.current.delete(h[g]),h.key==="Meta"&&i.current.clear(),s.current=!1},p=()=>{i.current.clear(),n(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function Tb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(s=>t.has(s)))}function Ab(e,t){return t.includes(e)?"code":"key"}function oE(e,t,r,n){var l,c;const s=e.parentNode||e.parentId;if(!s)return r;const i=t.get(s),a=vs(i,n);return oE(i,t,{x:(r.x??0)+a.x,y:(r.y??0)+a.y,z:(((l=i[nt])==null?void 0:l.z)??0)>(r.z??0)?((c=i[nt])==null?void 0:c.z)??0:r.z??0},n)}function aE(e,t,r){e.forEach(n=>{var i;const s=n.parentNode||n.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[n.id]){const{x:a,y:l,z:c}=oE(n,e,{...n.position,z:((i=n[nt])==null?void 0:i.z)??0},t);n.positionAbsolute={x:a,y:l},n[nt].z=c,r!=null&&r[n.id]&&(n[nt].isParent=!0)}})}function fd(e,t,r,n){const s=new Map,i={},a=n?1e3:0;return e.forEach(l=>{var h;const c=(hr(l.zIndex)?l.zIndex:0)+(l.selected?a:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(i[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,nt,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[nt])==null?void 0:h.handleBounds,z:c}}),s.set(l.id,u)}),aE(s,r,i),s}function lE(e,t={}){const{getNodes:r,width:n,height:s,minZoom:i,maxZoom:a,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const v=r().filter(_=>{var y;const x=t.includeHiddenNodes?_.width&&_.height:!_.hidden;return(y=t.nodes)!=null&&y.length?x&&t.nodes.some(b=>b.id===_.id):x}),g=v.every(_=>_.width&&_.height);if(v.length>0&&g){const _=nu(v,f),{x,y,zoom:b}=GC(_,n,s,t.minZoom??i,t.maxZoom??a,t.padding??.1),w=cn.translate(x,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(ls(c,t.duration),w):l.transform(c,w),!0}}return!1}function YM(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[nt]:n[nt],selected:r.selected})}),new Map(t)}function XM(e,t){return t.map(r=>{const n=e.find(s=>s.id===r.id);return n&&(r.selected=n.selected),r})}function nl({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:s,edges:i,onNodesChange:a,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=r();e!=null&&e.length&&(c&&n({nodeInternals:YM(e,s)}),a==null||a(e)),t!=null&&t.length&&(d&&n({edges:XM(t,i)}),l==null||l(t))}const Ds=()=>{},QM={zoomIn:Ds,zoomOut:Ds,zoomTo:Ds,getZoom:()=>1,setViewport:Ds,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ds,fitBounds:Ds,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},ZM=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),JM=()=>{const e=vt(),{d3Zoom:t,d3Selection:r}=Xe(ZM,Pt);return m.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(ls(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(ls(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(ls(r,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[a,l,c]=e.getState().transform,d=cn.translate(s.x??a,s.y??l).scale(s.zoom??c);t.transform(ls(r,i==null?void 0:i.duration),d)},getViewport:()=>{const[s,i,a]=e.getState().transform;return{x:s,y:i,zoom:a}},fitView:s=>lE(e.getState,s),setCenter:(s,i,a)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(a==null?void 0:a.zoom)<"u"?a.zoom:d,f=l/2-s*u,p=c/2-i*u,h=cn.translate(f,p).scale(u);t.transform(ls(r,a==null?void 0:a.duration),h)},fitBounds:(s,i)=>{const{width:a,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=GC(s,a,l,c,d,(i==null?void 0:i.padding)??.1),h=cn.translate(u,f).scale(p);t.transform(ls(r,i==null?void 0:i.duration),h)},project:s=>{const{transform:i,snapToGrid:a,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ox(s,i,a,l)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:a,snapGrid:l,domNode:c}=e.getState();if(!c)return s;const{x:d,y:u}=c.getBoundingClientRect(),f={x:s.x-d,y:s.y-u};return Ox(f,i,a,l)},flowToScreenPosition:s=>{const{transform:i,domNode:a}=e.getState();if(!a)return s;const{x:l,y:c}=a.getBoundingClientRect(),d=HC(s,i);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:QM,[t,r])};function su(){const e=JM(),t=vt(),r=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),n=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(_=>({..._}))},[]),i=m.useCallback(g=>{const{edges:_=[]}=t.getState();return _.find(x=>x.id===g)},[]),a=m.useCallback(g=>{const{getNodes:_,setNodes:x,hasDefaultNodes:y,onNodesChange:b}=t.getState(),w=_(),k=typeof g=="function"?g(w):g;if(y)x(k);else if(b){const C=k.length===0?w.map(N=>({type:"remove",id:N.id})):k.map(N=>({item:N,type:"reset"}));b(C)}},[]),l=m.useCallback(g=>{const{edges:_=[],setEdges:x,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),w=typeof g=="function"?g(_):g;if(y)x(w);else if(b){const k=w.length===0?_.map(C=>({type:"remove",id:C.id})):w.map(C=>({item:C,type:"reset"}));b(k)}},[]),c=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{getNodes:x,setNodes:y,hasDefaultNodes:b,onNodesChange:w}=t.getState();if(b){const C=[...x(),..._];y(C)}else if(w){const k=_.map(C=>({item:C,type:"add"}));w(k)}},[]),d=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{edges:x=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:w}=t.getState();if(b)y([...x,..._]);else if(w){const k=_.map(C=>({item:C,type:"add"}));w(k)}},[]),u=m.useCallback(()=>{const{getNodes:g,edges:_=[],transform:x}=t.getState(),[y,b,w]=x;return{nodes:g().map(k=>({...k})),edges:_.map(k=>({...k})),viewport:{x:y,y:b,zoom:w}}},[]),f=m.useCallback(({nodes:g,edges:_})=>{const{nodeInternals:x,getNodes:y,edges:b,hasDefaultNodes:w,hasDefaultEdges:k,onNodesDelete:C,onEdgesDelete:N,onNodesChange:E,onEdgesChange:j}=t.getState(),A=(g||[]).map(I=>I.id),T=(_||[]).map(I=>I.id),D=y().reduce((I,M)=>{const z=M.parentNode||M.parentId,P=!A.includes(M.id)&&z&&I.find(L=>L.id===z);return(typeof M.deletable=="boolean"?M.deletable:!0)&&(A.includes(M.id)||P)&&I.push(M),I},[]),F=b.filter(I=>typeof I.deletable=="boolean"?I.deletable:!0),S=F.filter(I=>T.includes(I.id));if(D||S){const I=UC(D,F),M=[...S,...I],z=M.reduce((P,R)=>(P.includes(R.id)||P.push(R.id),P),[]);if((k||w)&&(k&&t.setState({edges:b.filter(P=>!z.includes(P.id))}),w&&(D.forEach(P=>{x.delete(P.id)}),t.setState({nodeInternals:new Map(x)}))),z.length>0&&(N==null||N(M),j&&j(z.map(P=>({id:P,type:"remove"})))),D.length>0&&(C==null||C(D),E)){const P=D.map(R=>({id:R.id,type:"remove"}));E(P)}}},[]),p=m.useCallback(g=>{const _=yM(g),x=_?null:t.getState().nodeInternals.get(g.id);return!_&&!x?[null,null,_]:[_?g:_b(x),x,_]},[]),h=m.useCallback((g,_=!0,x)=>{const[y,b,w]=p(g);return y?(x||t.getState().getNodes()).filter(k=>{if(!w&&(k.id===b.id||!k.positionAbsolute))return!1;const C=_b(k),N=Rx(C,y);return _&&N>0||N>=y.width*y.height}):[]},[]),v=m.useCallback((g,_,x=!0)=>{const[y]=p(g);if(!y)return!1;const b=Rx(y,_);return x&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:s,getEdge:i,setNodes:a,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:v}),[e,r,n,s,i,a,l,c,d,u,f,h,v])}const eO={actInsideInputWithModifier:!1};var tO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=vt(),{deleteElements:n}=su(),s=ia(e,eO),i=ia(t);m.useEffect(()=>{if(s){const{edges:a,getNodes:l}=r.getState(),c=l().filter(u=>u.selected),d=a.filter(u=>u.selected);n({nodes:c,edges:d}),r.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{r.setState({multiSelectionActive:i})},[i])};function rO(e){const t=vt();m.useEffect(()=>{let r;const n=()=>{var i,a;if(!e.current)return;const s=Jv(e.current);(s.height===0||s.width===0)&&((a=(i=t.getState()).onError)==null||a.call(i,"004",mn.error004())),t.setState({width:s.width||500,height:s.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const ay={position:"absolute",width:"100%",height:"100%",top:0,left:0},nO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,sl=e=>({x:e.x,y:e.y,zoom:e.k}),Ls=(e,t)=>e.target.closest(`.${t}`),Rb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Ib=e=>{const t=e.ctrlKey&&dc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},sO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),iO=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:a=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=ps.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:v,maxZoom:g,zoomActivationKeyCode:_,preventScrolling:x=!0,children:y,noWheelClassName:b,noPanClassName:w})=>{const k=m.useRef(),C=vt(),N=m.useRef(!1),E=m.useRef(!1),j=m.useRef(null),A=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:D,d3ZoomHandler:F,userSelectionActive:S}=Xe(sO,Pt),I=ia(_),M=m.useRef(0),z=m.useRef(!1),P=m.useRef();return rO(j),m.useEffect(()=>{if(j.current){const R=j.current.getBoundingClientRect(),L=IC().scaleExtent([v,g]).translateExtent(h),$=fr(j.current).call(L),q=cn.translate(p.x,p.y).scale(Ni(p.zoom,v,g)),Y=[[0,0],[R.width,R.height]],K=L.constrain()(q,Y,h);L.transform($,K),L.wheelDelta(Ib),C.setState({d3Zoom:L,d3Selection:$,d3ZoomHandler:$.on("wheel.zoom"),transform:[K.x,K.y,K.k],domNode:j.current.closest(".react-flow")})}},[]),m.useEffect(()=>{D&&T&&(a&&!I&&!S?D.on("wheel.zoom",R=>{if(Ls(R,b))return!1;R.preventDefault(),R.stopImmediatePropagation();const L=D.property("__zoom").k||1;if(R.ctrlKey&&i){const ie=Nr(R),oe=Ib(R),J=L*Math.pow(2,oe);T.scaleTo(D,J,ie,R);return}const $=R.deltaMode===1?20:1;let q=c===ps.Vertical?0:R.deltaX*$,Y=c===ps.Horizontal?0:R.deltaY*$;!dc()&&R.shiftKey&&c!==ps.Vertical&&(q=R.deltaY*$,Y=0),T.translateBy(D,-(q/L)*l,-(Y/L)*l,{internal:!0});const K=sl(D.property("__zoom")),{onViewportChangeStart:H,onViewportChange:B,onViewportChangeEnd:X}=C.getState();clearTimeout(P.current),z.current||(z.current=!0,t==null||t(R,K),H==null||H(K)),z.current&&(e==null||e(R,K),B==null||B(K),P.current=setTimeout(()=>{r==null||r(R,K),X==null||X(K),z.current=!1},150))},{passive:!1}):typeof F<"u"&&D.on("wheel.zoom",function(R,L){if(!x&&R.type==="wheel"&&!R.ctrlKey||Ls(R,b))return null;R.preventDefault(),F.call(this,R,L)},{passive:!1}))},[S,a,c,D,T,F,I,i,x,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",R=>{var q,Y;if(!R.sourceEvent||R.sourceEvent.internal)return null;M.current=(q=R.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:L}=C.getState(),$=sl(R.transform);N.current=!0,A.current=$,((Y=R.sourceEvent)==null?void 0:Y.type)==="mousedown"&&C.setState({paneDragging:!0}),L==null||L($),t==null||t(R.sourceEvent,$)})},[T,t]),m.useEffect(()=>{T&&(S&&!N.current?T.on("zoom",null):S||T.on("zoom",R=>{var $;const{onViewportChange:L}=C.getState();if(C.setState({transform:[R.transform.x,R.transform.y,R.transform.k]}),E.current=!!(n&&Rb(f,M.current??0)),(e||L)&&!(($=R.sourceEvent)!=null&&$.internal)){const q=sl(R.transform);L==null||L(q),e==null||e(R.sourceEvent,q)}}))},[S,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",R=>{if(!R.sourceEvent||R.sourceEvent.internal)return null;const{onViewportChangeEnd:L}=C.getState();if(N.current=!1,C.setState({paneDragging:!1}),n&&Rb(f,M.current??0)&&!E.current&&n(R.sourceEvent),E.current=!1,(r||L)&&nO(A.current,R.transform)){const $=sl(R.transform);A.current=$,clearTimeout(k.current),k.current=setTimeout(()=>{L==null||L($),r==null||r(R.sourceEvent,$)},a?150:0)}})},[T,a,f,r,n]),m.useEffect(()=>{T&&T.filter(R=>{const L=I||s,$=i&&R.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&R.button===1&&R.type==="mousedown"&&(Ls(R,"react-flow__node")||Ls(R,"react-flow__edge")))return!0;if(!f&&!L&&!a&&!d&&!i||S||!d&&R.type==="dblclick"||Ls(R,b)&&R.type==="wheel"||Ls(R,w)&&(R.type!=="wheel"||a&&R.type==="wheel"&&!I)||!i&&R.ctrlKey&&R.type==="wheel"||!L&&!a&&!$&&R.type==="wheel"||!f&&(R.type==="mousedown"||R.type==="touchstart")||Array.isArray(f)&&!f.includes(R.button)&&R.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(R.button)||!R.button||R.button<=1;return(!R.ctrlKey||R.type==="wheel")&&q})},[S,T,s,i,a,d,f,u,I]),G.createElement("div",{className:"react-flow__renderer",ref:j,style:ay},y)},oO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function aO(){const{userSelectionActive:e,userSelectionRect:t}=Xe(oO,Pt);return e&&t?G.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Pb(e,t){const r=t.parentNode||t.parentId,n=e.find(s=>s.id===r);if(n){const s=t.position.x+t.width-n.width,i=t.position.y+t.height-n.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,s>0&&(n.style.width+=s),i>0&&(n.style.height+=i),t.position.x<0){const a=Math.abs(t.position.x);n.position.x=n.position.x-a,n.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);n.position.y=n.position.y-a,n.style.height+=a,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function cE(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,s)=>{const i=e.filter(l=>l.id===s.id);if(i.length===0)return n.push(s),n;const a={...s};for(const l of i)if(l)switch(l.type){case"select":{a.selected=l.selected;break}case"position":{typeof l.position<"u"&&(a.position=l.position),typeof l.positionAbsolute<"u"&&(a.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(a.dragging=l.dragging),a.expandParent&&Pb(n,a);break}case"dimensions":{typeof l.dimensions<"u"&&(a.width=l.dimensions.width,a.height=l.dimensions.height),typeof l.updateStyle<"u"&&(a.style={...a.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(a.resizing=l.resizing),a.expandParent&&Pb(n,a);break}case"remove":return n}return n.push(a),n},r)}function uE(e,t){return cE(e,t)}function lO(e,t){return cE(e,t)}const Cn=(e,t)=>({id:e,type:"select",selected:t});function ni(e,t){return e.reduce((r,n)=>{const s=t.includes(n.id);return!n.selected&&s?(n.selected=!0,r.push(Cn(n.id,!0))):n.selected&&!s&&(n.selected=!1,r.push(Cn(n.id,!1))),r},[])}const pd=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},cO=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),dE=m.memo(({isSelecting:e,selectionMode:t=sa.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:a,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=vt(),v=m.useRef(0),g=m.useRef(0),_=m.useRef(),{userSelectionActive:x,elementsSelectable:y,dragging:b}=Xe(cO,Pt),w=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,g.current=0},k=F=>{i==null||i(F),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},C=F=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){F.preventDefault();return}a==null||a(F)},N=l?F=>l(F):void 0,E=F=>{const{resetSelectedElements:S,domNode:I}=h.getState();if(_.current=I==null?void 0:I.getBoundingClientRect(),!y||!e||F.button!==0||F.target!==p.current||!_.current)return;const{x:M,y:z}=Vn(F,_.current);S(),h.setState({userSelectionRect:{width:0,height:0,startX:M,startY:z,x:M,y:z}}),n==null||n(F)},j=F=>{const{userSelectionRect:S,nodeInternals:I,edges:M,transform:z,onNodesChange:P,onEdgesChange:R,nodeOrigin:L,getNodes:$}=h.getState();if(!e||!_.current||!S)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Vn(F,_.current),Y=S.startX??0,K=S.startY??0,H={...S,x:q.x<Y?q.x:Y,y:q.y<K?q.y:K,width:Math.abs(q.x-Y),height:Math.abs(q.y-K)},B=$(),X=VC(I,H,z,t===sa.Partial,!0,L),ie=UC(X,M).map(J=>J.id),oe=X.map(J=>J.id);if(v.current!==oe.length){v.current=oe.length;const J=ni(B,oe);J.length&&(P==null||P(J))}if(g.current!==ie.length){g.current=ie.length;const J=ni(M,ie);J.length&&(R==null||R(J))}h.setState({userSelectionRect:H})},A=F=>{if(F.button!==0)return;const{userSelectionRect:S}=h.getState();!x&&S&&F.target===p.current&&(k==null||k(F)),h.setState({nodesSelectionActive:v.current>0}),w(),s==null||s(F)},T=F=>{x&&(h.setState({nodesSelectionActive:v.current>0}),s==null||s(F)),w()},D=y&&(e||x);return G.createElement("div",{className:Yt(["react-flow__pane",{dragging:b,selection:e}]),onClick:D?void 0:pd(k,p),onContextMenu:pd(C,p),onWheel:pd(N,p),onMouseEnter:D?void 0:c,onMouseDown:D?E:void 0,onMouseMove:D?j:d,onMouseUp:D?A:void 0,onMouseLeave:D?T:u,ref:p,style:ay},f,G.createElement(aO,null))});dE.displayName="Pane";function fE(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:fE(n,t):!1}function Mb(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function uO(e,t,r,n){return Array.from(e.values()).filter(s=>(s.selected||s.id===n)&&(!s.parentNode||s.parentId||!fE(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,a;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:r.y-(((a=s.positionAbsolute)==null?void 0:a.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function dO(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function pE(e,t,r,n,s=[0,0],i){const a=dO(e,e.extent||n);let l=a;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=vs(f,s).positionAbsolute;l=f&&hr(p)&&hr(h)&&hr(f.width)&&hr(f.height)?[[p+e.width*s[0],h+e.height*s[1]],[p+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:l}else i==null||i("005",mn.error005()),l=a;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=vs(f,s).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=r.get(c);d=vs(f,s).positionAbsolute}const u=l&&l!=="parent"?ey(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function hd({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?n.find(s=>s.id===e):n[0],n]}const Ob=(e,t,r,n)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),a=t.getBoundingClientRect(),l={x:a.width*n[0],y:a.height*n[1]};return i.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-a.left-l.x)/r,y:(d.top-a.top-l.y)/r,...Jv(c)}})};function eo(e,t,r){return r===void 0?r:n=>{const s=t().nodeInternals.get(e);s&&r(n,{...s})}}function Lx({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:a,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",mn.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(r||d.selected&&a)&&(i({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=n==null?void 0:n.current)==null?void 0:u.blur()})):s([e])}function fO(){const e=vt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:s,snapToGrid:i}=e.getState(),a=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(a-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:i?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:i?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function md(e){return(t,r,n)=>e==null?void 0:e(t,n)}function hE({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:i,selectNodesOnDrag:a}){const l=vt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),v=m.useRef({x:0,y:0}),g=m.useRef(null),_=m.useRef(!1),x=m.useRef(!1),y=m.useRef(!1),b=fO();return m.useEffect(()=>{if(e!=null&&e.current){const w=fr(e.current),k=({x:E,y:j})=>{const{nodeInternals:A,onNodeDrag:T,onSelectionDrag:D,updateNodePositions:F,nodeExtent:S,snapGrid:I,snapToGrid:M,nodeOrigin:z,onError:P}=l.getState();f.current={x:E,y:j};let R=!1,L={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&S){const q=nu(u.current,z);L=na(q)}if(u.current=u.current.map(q=>{const Y={x:E-q.distance.x,y:j-q.distance.y};M&&(Y.x=I[0]*Math.round(Y.x/I[0]),Y.y=I[1]*Math.round(Y.y/I[1]));const K=[[S[0][0],S[0][1]],[S[1][0],S[1][1]]];u.current.length>1&&S&&!q.extent&&(K[0][0]=q.positionAbsolute.x-L.x+S[0][0],K[1][0]=q.positionAbsolute.x+(q.width??0)-L.x2+S[1][0],K[0][1]=q.positionAbsolute.y-L.y+S[0][1],K[1][1]=q.positionAbsolute.y+(q.height??0)-L.y2+S[1][1]);const H=pE(q,Y,A,K,z,P);return R=R||q.position.x!==H.position.x||q.position.y!==H.position.y,q.position=H.position,q.positionAbsolute=H.positionAbsolute,q}),!R)return;F(u.current,!0,!0),d(!0);const $=s?T:md(D);if($&&g.current){const[q,Y]=hd({nodeId:s,dragItems:u.current,nodeInternals:A});$(g.current,q,Y)}},C=()=>{if(!h.current)return;const[E,j]=MC(v.current,h.current);if(E!==0||j!==0){const{transform:A,panBy:T}=l.getState();f.current.x=(f.current.x??0)-E/A[2],f.current.y=(f.current.y??0)-j/A[2],T({x:E,y:j})&&k(f.current)}p.current=requestAnimationFrame(C)},N=E=>{var z;const{nodeInternals:j,multiSelectionActive:A,nodesDraggable:T,unselectNodesAndEdges:D,onNodeDragStart:F,onSelectionDragStart:S}=l.getState();x.current=!0;const I=s?F:md(S);(!a||!i)&&!A&&s&&((z=j.get(s))!=null&&z.selected||D()),s&&i&&a&&Lx({id:s,store:l,nodeRef:e});const M=b(E);if(f.current=M,u.current=uO(j,T,M,s),I&&u.current){const[P,R]=hd({nodeId:s,dragItems:u.current,nodeInternals:j});I(E.sourceEvent,P,R)}};if(t)w.on(".drag",null);else{const E=j6().on("start",j=>{const{domNode:A,nodeDragThreshold:T}=l.getState();T===0&&N(j),y.current=!1;const D=b(j);f.current=D,h.current=(A==null?void 0:A.getBoundingClientRect())||null,v.current=Vn(j.sourceEvent,h.current)}).on("drag",j=>{var F,S;const A=b(j),{autoPanOnNodeDrag:T,nodeDragThreshold:D}=l.getState();if(j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!_.current&&x.current&&T&&(_.current=!0,C()),!x.current){const I=A.xSnapped-(((F=f==null?void 0:f.current)==null?void 0:F.x)??0),M=A.ySnapped-(((S=f==null?void 0:f.current)==null?void 0:S.y)??0);Math.sqrt(I*I+M*M)>D&&N(j)}(f.current.x!==A.xSnapped||f.current.y!==A.ySnapped)&&u.current&&x.current&&(g.current=j.sourceEvent,v.current=Vn(j.sourceEvent,h.current),k(A))}}).on("end",j=>{if(!(!x.current||y.current)&&(d(!1),_.current=!1,x.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:A,nodeInternals:T,onNodeDragStop:D,onSelectionDragStop:F}=l.getState(),S=s?D:md(F);if(A(u.current,!1,!1),S){const[I,M]=hd({nodeId:s,dragItems:u.current,nodeInternals:T});S(j.sourceEvent,I,M)}}}).filter(j=>{const A=j.target;return!j.button&&(!r||!Mb(A,`.${r}`,e))&&(!n||Mb(A,n,e))});return w.call(E),()=>{w.on(".drag",null)}}}},[e,t,r,n,i,l,s,a,b]),c}function mE(){const e=vt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:s,updateNodePositions:i,getNodes:a,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=a().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,v=r.isShiftPressed?4:1,g=r.x*p*v,_=r.y*h*v,x=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+g,y:y.positionAbsolute.y+_};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:w,position:k}=pE(y,b,n,s,void 0,d);y.position=k,y.positionAbsolute=w}return y});i(x,!0,!1)},[])}const hi={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var to=e=>{const t=({id:r,type:n,data:s,xPos:i,yPos:a,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:v,onDoubleClick:g,style:_,className:x,isDraggable:y,isSelectable:b,isConnectable:w,isFocusable:k,selectNodesOnDrag:C,sourcePosition:N,targetPosition:E,hidden:j,resizeObserver:A,dragHandle:T,zIndex:D,isParent:F,noDragClassName:S,noPanClassName:I,initialized:M,disableKeyboardA11y:z,ariaLabel:P,rfId:R,hasHandleBounds:L})=>{const $=vt(),q=m.useRef(null),Y=m.useRef(null),K=m.useRef(N),H=m.useRef(E),B=m.useRef(n),X=b||y||u||f||p||h,ie=mE(),oe=eo(r,$.getState,f),J=eo(r,$.getState,p),we=eo(r,$.getState,h),ge=eo(r,$.getState,v),_e=eo(r,$.getState,g),xe=re=>{const{nodeDragThreshold:te}=$.getState();if(b&&(!C||!y||te>0)&&Lx({id:r,store:$,nodeRef:q}),u){const je=$.getState().nodeInternals.get(r);je&&u(re,{...je})}},ae=re=>{if(!Ix(re)&&!z)if(zC.includes(re.key)&&b){const te=re.key==="Escape";Lx({id:r,store:$,unselect:te,nodeRef:q})}else y&&d&&Object.prototype.hasOwnProperty.call(hi,re.key)&&($.setState({ariaLiveMessage:`Moved selected node ${re.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~a}`}),ie({x:hi[re.key].x,y:hi[re.key].y,isShiftPressed:re.shiftKey}))};m.useEffect(()=>()=>{Y.current&&(A==null||A.unobserve(Y.current),Y.current=null)},[]),m.useEffect(()=>{if(q.current&&!j){const re=q.current;(!M||!L||Y.current!==re)&&(Y.current&&(A==null||A.unobserve(Y.current)),A==null||A.observe(re),Y.current=re)}},[j,M,L]),m.useEffect(()=>{const re=B.current!==n,te=K.current!==N,je=H.current!==E;q.current&&(re||te||je)&&(re&&(B.current=n),te&&(K.current=N),je&&(H.current=E),$.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,n,N,E]);const U=hE({nodeRef:q,disabled:j||!y,noDragClassName:S,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:C});return j?null:G.createElement("div",{className:Yt(["react-flow__node",`react-flow__node-${n}`,{[I]:y},x,{selected:d,selectable:b,parent:F,dragging:U}]),ref:q,style:{zIndex:D,transform:`translate(${l}px,${c}px)`,pointerEvents:X?"all":"none",visibility:M?"visible":"hidden",..._},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:oe,onMouseMove:J,onMouseLeave:we,onContextMenu:ge,onClick:xe,onDoubleClick:_e,onKeyDown:k?ae:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":z?void 0:`${sE}-${R}`,"aria-label":P},G.createElement(NM,{value:r},G.createElement(e,{id:r,data:s,type:n,xPos:i,yPos:a,selected:d,isConnectable:w,sourcePosition:N,targetPosition:E,dragging:U,dragHandle:T,zIndex:D})))};return t.displayName="NodeWrapper",m.memo(t)};const pO=e=>{const t=e.getNodes().filter(r=>r.selected);return{...nu(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function hO({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=vt(),{width:s,height:i,x:a,y:l,transformString:c,userSelectionActive:d}=Xe(pO,Pt),u=mE(),f=m.useRef(null);if(m.useEffect(()=>{var v;r||(v=f.current)==null||v.focus({preventScroll:!0})},[r]),hE({nodeRef:f}),d||!s||!i)return null;const p=e?v=>{const g=n.getState().getNodes().filter(_=>_.selected);e(v,g)}:void 0,h=v=>{Object.prototype.hasOwnProperty.call(hi,v.key)&&u({x:hi[v.key].x,y:hi[v.key].y,isShiftPressed:v.shiftKey})};return G.createElement("div",{className:Yt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},G.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:s,height:i,top:l,left:a}}))}var mO=m.memo(hO);const gO=e=>e.nodesSelectionActive,gE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:v,onSelectionEnd:g,multiSelectionKeyCode:_,panActivationKeyCode:x,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:k,panOnScroll:C,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:j,panOnDrag:A,defaultViewport:T,translateExtent:D,minZoom:F,maxZoom:S,preventScrolling:I,onSelectionContextMenu:M,noWheelClassName:z,noPanClassName:P,disableKeyboardA11y:R})=>{const L=Xe(gO),$=ia(f),q=ia(x),Y=q||A,K=q||C,H=$||p&&Y!==!0;return tO({deleteKeyCode:l,multiSelectionKeyCode:_}),G.createElement(iO,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:i,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:k,panOnScroll:K,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:j,panOnDrag:!$&&Y,defaultViewport:T,translateExtent:D,minZoom:F,maxZoom:S,zoomActivationKeyCode:y,preventScrolling:I,noWheelClassName:z,noPanClassName:P},G.createElement(dE,{onSelectionStart:v,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,panOnDrag:Y,isSelecting:!!H,selectionMode:h},e,L&&G.createElement(mO,{onSelectionContextMenu:M,noPanClassName:P,disableKeyboardA11y:R})))};gE.displayName="FlowRenderer";var xO=m.memo(gE);function vO(e){return Xe(m.useCallback(r=>e?VC(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function yO(e){const t={input:to(e.input||eE),default:to(e.default||Dx),output:to(e.output||rE),group:to(e.group||oy)},r={},n=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=to(e[i]||Dx),s),r);return{...t,...n}}const bO=({x:e,y:t,width:r,height:n,origin:s})=>!r||!n?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-n*s[1]},_O=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),xE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,updateNodeDimensions:i,onError:a}=Xe(_O,Pt),l=vO(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));i(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),G.createElement("div",{className:"react-flow__nodes",style:ay},l.map(u=>{var k,C,N;let f=u.type||"default";e.nodeTypes[f]||(a==null||a("003",mn.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),v=!!(u.selectable||s&&typeof u.selectable>"u"),g=!!(u.connectable||r&&typeof u.connectable>"u"),_=!!(u.focusable||n&&typeof u.focusable>"u"),x=e.nodeExtent?ey(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(x==null?void 0:x.x)??0,b=(x==null?void 0:x.y)??0,w=bO({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return G.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||ce.Bottom,targetPosition:u.targetPosition||ce.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:w.x,yPosOrigin:w.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:v,isConnectable:g,isFocusable:_,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((k=u[nt])==null?void 0:k.z)??0,isParent:!!((C=u[nt])!=null&&C.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((N=u[nt])!=null&&N.handleBounds)})}))};xE.displayName="NodeRenderer";var wO=m.memo(xE);const jO=(e,t,r)=>r===ce.Left?e-t:r===ce.Right?e+t:e,SO=(e,t,r)=>r===ce.Top?e-t:r===ce.Bottom?e+t:e,Db="react-flow__edgeupdater",Lb=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:i,onMouseOut:a,type:l})=>G.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:a,className:Yt([Db,`${Db}-${l}`]),cx:jO(t,n,e),cy:SO(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),kO=()=>!0;var zs=e=>{const t=({id:r,className:n,type:s,data:i,onClick:a,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:g,style:_,source:x,target:y,sourceX:b,sourceY:w,targetX:k,targetY:C,sourcePosition:N,targetPosition:E,elementsSelectable:j,hidden:A,sourceHandleId:T,targetHandleId:D,onContextMenu:F,onMouseEnter:S,onMouseMove:I,onMouseLeave:M,reconnectRadius:z,onReconnect:P,onReconnectStart:R,onReconnectEnd:L,markerEnd:$,markerStart:q,rfId:Y,ariaLabel:K,isFocusable:H,isReconnectable:B,pathOptions:X,interactionWidth:ie,disableKeyboardA11y:oe})=>{const J=m.useRef(null),[we,ge]=m.useState(!1),[_e,xe]=m.useState(!1),ae=vt(),U=m.useMemo(()=>`url('#${Mx(q,Y)}')`,[q,Y]),re=m.useMemo(()=>`url('#${Mx($,Y)}')`,[$,Y]);if(A)return null;const te=Ie=>{var bt;const{edges:Z,addSelectedEdges:Te,unselectNodesAndEdges:ve,multiSelectionActive:Ct}=ae.getState(),yt=Z.find(Qt=>Qt.id===r);yt&&(j&&(ae.setState({nodesSelectionActive:!1}),yt.selected&&Ct?(ve({nodes:[],edges:[yt]}),(bt=J.current)==null||bt.blur()):Te([r])),a&&a(Ie,yt))},je=Ji(r,ae.getState,l),se=Ji(r,ae.getState,F),fe=Ji(r,ae.getState,S),he=Ji(r,ae.getState,I),Q=Ji(r,ae.getState,M),me=(Ie,Z)=>{if(Ie.button!==0)return;const{edges:Te,isValidConnection:ve}=ae.getState(),Ct=Z?y:x,yt=(Z?D:T)||null,bt=Z?"target":"source",Qt=ve||kO,O=Z,W=Te.find(ze=>ze.id===r);xe(!0),R==null||R(Ie,W,bt);const V=ze=>{xe(!1),L==null||L(ze,W,bt)};XC({event:Ie,handleId:yt,nodeId:Ct,onConnect:ze=>P==null?void 0:P(W,ze),isTarget:O,getState:ae.getState,setState:ae.setState,isValidConnection:Qt,edgeUpdaterType:bt,onReconnectEnd:V})},qe=Ie=>me(Ie,!0),Le=Ie=>me(Ie,!1),Ce=()=>ge(!0),Ee=()=>ge(!1),Me=!j&&!a,tt=Ie=>{var Z;if(!oe&&zC.includes(Ie.key)&&j){const{unselectNodesAndEdges:Te,addSelectedEdges:ve,edges:Ct}=ae.getState();Ie.key==="Escape"?((Z=J.current)==null||Z.blur(),Te({edges:[Ct.find(bt=>bt.id===r)]})):ve([r])}};return G.createElement("g",{className:Yt(["react-flow__edge",`react-flow__edge-${s}`,n,{selected:c,animated:d,inactive:Me,updating:we}]),onClick:te,onDoubleClick:je,onContextMenu:se,onMouseEnter:fe,onMouseMove:he,onMouseLeave:Q,onKeyDown:H?tt:void 0,tabIndex:H?0:void 0,role:H?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":K===null?void 0:K||`Edge from ${x} to ${y}`,"aria-describedby":H?`${iE}-${Y}`:void 0,ref:J},!_e&&G.createElement(e,{id:r,source:x,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:g,data:i,style:_,sourceX:b,sourceY:w,targetX:k,targetY:C,sourcePosition:N,targetPosition:E,sourceHandleId:T,targetHandleId:D,markerStart:U,markerEnd:re,pathOptions:X,interactionWidth:ie}),B&&G.createElement(G.Fragment,null,(B==="source"||B===!0)&&G.createElement(Lb,{position:N,centerX:b,centerY:w,radius:z,onMouseDown:qe,onMouseEnter:Ce,onMouseOut:Ee,type:"source"}),(B==="target"||B===!0)&&G.createElement(Lb,{position:E,centerX:k,centerY:C,radius:z,onMouseDown:Le,onMouseEnter:Ce,onMouseOut:Ee,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function NO(e){const t={default:zs(e.default||pc),straight:zs(e.bezier||ny),step:zs(e.step||ry),smoothstep:zs(e.step||ru),simplebezier:zs(e.simplebezier||ty)},r={},n=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=zs(e[i]||pc),s),r);return{...t,...n}}function zb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,i=(r==null?void 0:r.width)||t.width,a=(r==null?void 0:r.height)||t.height;switch(e){case ce.Top:return{x:n+i/2,y:s};case ce.Right:return{x:n+i,y:s+a/2};case ce.Bottom:return{x:n+i/2,y:s+a};case ce.Left:return{x:n,y:s+a/2}}}function Fb(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const CO=(e,t,r,n,s,i)=>{const a=zb(r,e,t),l=zb(i,n,s);return{sourceX:a.x,sourceY:a.y,targetX:l.x,targetY:l.y}};function EO({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:s,targetHeight:i,width:a,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+n,t.y+i)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=na({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:a/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function $b(e){var n,s,i,a,l;const t=((n=e==null?void 0:e[nt])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const TO=[{level:0,isMaxLevel:!0,edges:[]}];function AO(e,t,r=!1){let n=-1;const s=e.reduce((a,l)=>{var u,f;const c=hr(l.zIndex);let d=c?l.zIndex:0;if(r){const p=t.get(l.target),h=t.get(l.source),v=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),g=Math.max(((u=h==null?void 0:h[nt])==null?void 0:u.z)||0,((f=p==null?void 0:p[nt])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(v?g:0)}return a[d]?a[d].push(l):a[d]=[l],n=d>n?d:n,a},{}),i=Object.entries(s).map(([a,l])=>{const c=+a;return{edges:l,level:c,isMaxLevel:c===n}});return i.length===0?TO:i}function RO(e,t,r){const n=Xe(m.useCallback(s=>e?s.edges.filter(i=>{const a=t.get(i.source),l=t.get(i.target);return(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&EO({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return AO(n,t,r)}const IO=({color:e="none",strokeWidth:t=1})=>G.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),PO=({color:e="none",strokeWidth:t=1})=>G.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),qb={[fc.Arrow]:IO,[fc.ArrowClosed]:PO};function MO(e){const t=vt();return m.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(qb,e)?qb[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",mn.error009(e)),null)},[e])}const OO=({id:e,type:t,color:r,width:n=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{const c=MO(t);return c?G.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:l,refX:"0",refY:"0"},G.createElement(c,{color:r,strokeWidth:a})):null},DO=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const l=Mx(a,t);n.includes(l)||(s.push({id:l,color:a.color||e,...a}),n.push(l))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},vE=({defaultColor:e,rfId:t})=>{const r=Xe(m.useCallback(DO({defaultColor:e,rfId:t}),[e,t]),(n,s)=>!(n.length!==s.length||n.some((i,a)=>i.id!==s[a].id)));return G.createElement("defs",null,r.map(n=>G.createElement(OO,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};vE.displayName="MarkerDefinitions";var LO=m.memo(vE);const zO=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),yE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:g,children:_,disableKeyboardA11y:x})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:w,width:k,height:C,connectionMode:N,nodeInternals:E,onError:j}=Xe(zO,Pt),A=RO(t,E,r);return k?G.createElement(G.Fragment,null,A.map(({level:T,edges:D,isMaxLevel:F})=>G.createElement("svg",{key:T,style:{zIndex:T},width:k,height:C,className:"react-flow__edges react-flow__container"},F&&G.createElement(LO,{defaultColor:e,rfId:n}),G.createElement("g",null,D.map(S=>{const[I,M,z]=$b(E.get(S.source)),[P,R,L]=$b(E.get(S.target));if(!z||!L)return null;let $=S.type||"default";s[$]||(j==null||j("011",mn.error011($)),$="default");const q=s[$]||s.default,Y=N===Ns.Strict?R.target:(R.target??[]).concat(R.source??[]),K=Fb(M.source,S.sourceHandle),H=Fb(Y,S.targetHandle),B=(K==null?void 0:K.position)||ce.Bottom,X=(H==null?void 0:H.position)||ce.Top,ie=!!(S.focusable||y&&typeof S.focusable>"u"),oe=S.reconnectable||S.updatable,J=typeof p<"u"&&(oe||b&&typeof oe>"u");if(!K||!H)return j==null||j("008",mn.error008(K,S)),null;const{sourceX:we,sourceY:ge,targetX:_e,targetY:xe}=CO(I,K,B,P,H,X);return G.createElement(q,{key:S.id,id:S.id,className:Yt([S.className,i]),type:$,data:S.data,selected:!!S.selected,animated:!!S.animated,hidden:!!S.hidden,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,style:S.style,source:S.source,target:S.target,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerEnd:S.markerEnd,markerStart:S.markerStart,sourceX:we,sourceY:ge,targetX:_e,targetY:xe,sourcePosition:B,targetPosition:X,elementsSelectable:w,onContextMenu:a,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:g,rfId:n,ariaLabel:S.ariaLabel,isFocusable:ie,isReconnectable:J,pathOptions:"pathOptions"in S?S.pathOptions:void 0,interactionWidth:S.interactionWidth,disableKeyboardA11y:x})})))),_):null};yE.displayName="EdgeRenderer";var FO=m.memo(yE);const $O=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function qO({children:e}){const t=Xe($O);return G.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function BO(e){const t=su(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const WO={[ce.Left]:ce.Right,[ce.Right]:ce.Left,[ce.Top]:ce.Bottom,[ce.Bottom]:ce.Top},bE=({nodeId:e,handleType:t,style:r,type:n=Rn.Bezier,CustomComponent:s,connectionStatus:i})=>{var C,N,E;const{fromNode:a,handleId:l,toX:c,toY:d,connectionMode:u}=Xe(m.useCallback(j=>({fromNode:j.nodeInternals.get(e),handleId:j.connectionHandleId,toX:(j.connectionPosition.x-j.transform[0])/j.transform[2],toY:(j.connectionPosition.y-j.transform[1])/j.transform[2],connectionMode:j.connectionMode}),[e]),Pt),f=(C=a==null?void 0:a[nt])==null?void 0:C.handleBounds;let p=f==null?void 0:f[t];if(u===Ns.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!a||!p)return null;const h=l?p.find(j=>j.id===l):p[0],v=h?h.x+h.width/2:(a.width??0)/2,g=h?h.y+h.height/2:a.height??0,_=(((N=a.positionAbsolute)==null?void 0:N.x)??0)+v,x=(((E=a.positionAbsolute)==null?void 0:E.y)??0)+g,y=h==null?void 0:h.position,b=y?WO[y]:null;if(!y||!b)return null;if(s)return G.createElement(s,{connectionLineType:n,connectionLineStyle:r,fromNode:a,fromHandle:h,fromX:_,fromY:x,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:i});let w="";const k={sourceX:_,sourceY:x,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return n===Rn.Bezier?[w]=WC(k):n===Rn.Step?[w]=Px({...k,borderRadius:0}):n===Rn.SmoothStep?[w]=Px(k):n===Rn.SimpleBezier?[w]=BC(k):w=`M${_},${x} ${c},${d}`,G.createElement("path",{d:w,fill:"none",className:"react-flow__connection-path",style:r})};bE.displayName="ConnectionLine";const HO=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function VO({containerStyle:e,style:t,type:r,component:n}){const{nodeId:s,handleType:i,nodesConnectable:a,width:l,height:c,connectionStatus:d}=Xe(HO,Pt);return!(s&&i&&l&&a)?null:G.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},G.createElement("g",{className:Yt(["react-flow__connection",d])},G.createElement(bE,{nodeId:s,handleType:i,style:t,type:r,CustomComponent:n,connectionStatus:d})))}function Bb(e,t){return m.useRef(null),vt(),m.useMemo(()=>t(e),[e])}const _E=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:s,onInit:i,onNodeClick:a,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:v,onSelectionStart:g,onSelectionEnd:_,connectionLineType:x,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:w,selectionKeyCode:k,selectionOnDrag:C,selectionMode:N,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:A,deleteKeyCode:T,onlyRenderVisibleElements:D,elementsSelectable:F,selectNodesOnDrag:S,defaultViewport:I,translateExtent:M,minZoom:z,maxZoom:P,preventScrolling:R,defaultMarkerColor:L,zoomOnScroll:$,zoomOnPinch:q,panOnScroll:Y,panOnScrollSpeed:K,panOnScrollMode:H,zoomOnDoubleClick:B,panOnDrag:X,onPaneClick:ie,onPaneMouseEnter:oe,onPaneMouseMove:J,onPaneMouseLeave:we,onPaneScroll:ge,onPaneContextMenu:_e,onEdgeContextMenu:xe,onEdgeMouseEnter:ae,onEdgeMouseMove:U,onEdgeMouseLeave:re,onReconnect:te,onReconnectStart:je,onReconnectEnd:se,reconnectRadius:fe,noDragClassName:he,noWheelClassName:Q,noPanClassName:me,elevateEdgesOnSelect:qe,disableKeyboardA11y:Le,nodeOrigin:Ce,nodeExtent:Ee,rfId:Me})=>{const tt=Bb(e,yO),Ie=Bb(t,NO);return BO(i),G.createElement(xO,{onPaneClick:ie,onPaneMouseEnter:oe,onPaneMouseMove:J,onPaneMouseLeave:we,onPaneContextMenu:_e,onPaneScroll:ge,deleteKeyCode:T,selectionKeyCode:k,selectionOnDrag:C,selectionMode:N,onSelectionStart:g,onSelectionEnd:_,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:A,elementsSelectable:F,onMove:r,onMoveStart:n,onMoveEnd:s,zoomOnScroll:$,zoomOnPinch:q,zoomOnDoubleClick:B,panOnScroll:Y,panOnScrollSpeed:K,panOnScrollMode:H,panOnDrag:X,defaultViewport:I,translateExtent:M,minZoom:z,maxZoom:P,onSelectionContextMenu:v,preventScrolling:R,noDragClassName:he,noWheelClassName:Q,noPanClassName:me,disableKeyboardA11y:Le},G.createElement(qO,null,G.createElement(FO,{edgeTypes:Ie,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:D,onEdgeContextMenu:xe,onEdgeMouseEnter:ae,onEdgeMouseMove:U,onEdgeMouseLeave:re,onReconnect:te,onReconnectStart:je,onReconnectEnd:se,reconnectRadius:fe,defaultMarkerColor:L,noPanClassName:me,elevateEdgesOnSelect:!!qe,disableKeyboardA11y:Le,rfId:Me},G.createElement(VO,{style:y,type:x,component:b,containerStyle:w})),G.createElement("div",{className:"react-flow__edgelabel-renderer"}),G.createElement(wO,{nodeTypes:tt,onNodeClick:a,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:S,onlyRenderVisibleElements:D,noPanClassName:me,noDragClassName:he,disableKeyboardA11y:Le,nodeOrigin:Ce,nodeExtent:Ee,rfId:Me})))};_E.displayName="GraphView";var UO=m.memo(_E);const zx=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:zx,nodeExtent:zx,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ns.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:bM,isValidConnection:void 0},GO=()=>OR((e,t)=>({...wn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:fd(r,n,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(s=>({...n,...s}))})},setDefaultNodesAndEdges:(r,n)=>{const s=typeof r<"u",i=typeof n<"u",a=s?fd(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:i?n:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:a,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((g,_)=>{const x=s.get(_.id);if(x!=null&&x.hidden)s.set(x.id,{...x,[nt]:{...x[nt],handleBounds:void 0}});else if(x){const y=Jv(_.nodeElement);!!(y.width&&y.height&&(x.width!==y.width||x.height!==y.height||_.forceUpdate))&&(s.set(x.id,{...x,[nt]:{...x[nt],handleBounds:{source:Ob(".source",_.nodeElement,p,d),target:Ob(".target",_.nodeElement,p,d)}},...y}),g.push({id:x.id,type:"dimensions",dimensions:y}))}return g},[]);aE(s,d);const v=a||i&&!a&&lE(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:v}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),a=r.map(l=>{const c={id:l.id,type:"position",dragging:s};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});i(a)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:a,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(i){const d=uE(r,l()),u=fd(d,s,a,c);e({nodeInternals:u})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:s,getNodes:i}=t();let a,l=null;n?a=r.map(c=>Cn(c,!0)):(a=ni(i(),r),l=ni(s,[])),nl({changedNodes:a,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:s,getNodes:i}=t();let a,l=null;n?a=r.map(c=>Cn(c,!0)):(a=ni(s,r),l=ni(i(),[])),nl({changedNodes:l,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:s,getNodes:i}=t(),a=r||i(),l=n||s,c=a.map(u=>(u.selected=!1,Cn(u.id,!1))),d=l.map(u=>Cn(u.id,!1));nl({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:s}=t();n==null||n.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:s}=t();n==null||n.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),i=n().filter(l=>l.selected).map(l=>Cn(l.id,!1)),a=r.filter(l=>l.selected).map(l=>Cn(l.id,!1));nl({changedNodes:i,changedEdges:a,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(s=>{s.positionAbsolute=ey(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:s,height:i,d3Zoom:a,d3Selection:l,translateExtent:c}=t();if(!a||!l||!r.x&&!r.y)return!1;const d=cn.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),u=[[0,0],[s,i]],f=a==null?void 0:a.constrain()(d,u,c);return a.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wn.connectionNodeId,connectionHandleId:wn.connectionHandleId,connectionHandleType:wn.connectionHandleType,connectionStatus:wn.connectionStatus,connectionStartHandle:wn.connectionStartHandle,connectionEndHandle:wn.connectionEndHandle}),reset:()=>e({...wn})}),Object.is),Ii=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=GO()),G.createElement(pM,{value:t.current},e)};Ii.displayName="ReactFlowProvider";const wE=({children:e})=>m.useContext(tu)?G.createElement(G.Fragment,null,e):G.createElement(Ii,null,e);wE.displayName="ReactFlowWrapper";const KO={input:eE,default:Dx,output:rE,group:oy},YO={default:pc,straight:ny,step:ry,smoothstep:ru,simplebezier:ty},XO=[0,0],QO=[15,15],ZO={x:0,y:0,zoom:1},JO={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},wa=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:i=KO,edgeTypes:a=YO,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:v,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:x,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:C,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:j,onNodesDelete:A,onEdgesDelete:T,onSelectionChange:D,onSelectionDragStart:F,onSelectionDrag:S,onSelectionDragStop:I,onSelectionContextMenu:M,onSelectionStart:z,onSelectionEnd:P,connectionMode:R=Ns.Strict,connectionLineType:L=Rn.Bezier,connectionLineStyle:$,connectionLineComponent:q,connectionLineContainerStyle:Y,deleteKeyCode:K="Backspace",selectionKeyCode:H="Shift",selectionOnDrag:B=!1,selectionMode:X=sa.Full,panActivationKeyCode:ie="Space",multiSelectionKeyCode:oe=dc()?"Meta":"Control",zoomActivationKeyCode:J=dc()?"Meta":"Control",snapToGrid:we=!1,snapGrid:ge=QO,onlyRenderVisibleElements:_e=!1,selectNodesOnDrag:xe=!0,nodesDraggable:ae,nodesConnectable:U,nodesFocusable:re,nodeOrigin:te=XO,edgesFocusable:je,edgesUpdatable:se,elementsSelectable:fe,defaultViewport:he=ZO,minZoom:Q=.5,maxZoom:me=2,translateExtent:qe=zx,preventScrolling:Le=!0,nodeExtent:Ce,defaultMarkerColor:Ee="#b1b1b7",zoomOnScroll:Me=!0,zoomOnPinch:tt=!0,panOnScroll:Ie=!1,panOnScrollSpeed:Z=.5,panOnScrollMode:Te=ps.Free,zoomOnDoubleClick:ve=!0,panOnDrag:Ct=!0,onPaneClick:yt,onPaneMouseEnter:bt,onPaneMouseMove:Qt,onPaneMouseLeave:O,onPaneScroll:W,onPaneContextMenu:V,children:ne,onEdgeContextMenu:ze,onEdgeDoubleClick:ct,onEdgeMouseEnter:ar,onEdgeMouseMove:Et,onEdgeMouseLeave:_t,onEdgeUpdate:$t,onEdgeUpdateStart:Dr,onEdgeUpdateEnd:st,onReconnect:ue,onReconnectStart:de,onReconnectEnd:Ve,reconnectRadius:_r=10,edgeUpdaterRadius:rs=10,onNodesChange:Lr,onEdgesChange:ns,noDragClassName:Bi="nodrag",noWheelClassName:_T="nowheel",noPanClassName:By="nopan",fitView:wT=!1,fitViewOptions:jT,connectOnClick:ST=!0,attributionPosition:kT,proOptions:NT,defaultEdgeOptions:CT,elevateNodesOnSelect:ET=!0,elevateEdgesOnSelect:TT=!1,disableKeyboardA11y:Wy=!1,autoPanOnConnect:AT=!0,autoPanOnNodeDrag:RT=!0,connectionRadius:IT=20,isValidConnection:PT,onError:MT,style:OT,id:Hy,nodeDragThreshold:DT,...LT},zT)=>{const Pu=Hy||"1";return G.createElement("div",{...LT,style:{...OT,...JO},ref:zT,className:Yt(["react-flow",s]),"data-testid":"rf__wrapper",id:Hy},G.createElement(wE,null,G.createElement(UO,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:C,nodeTypes:i,edgeTypes:a,connectionLineType:L,connectionLineStyle:$,connectionLineComponent:q,connectionLineContainerStyle:Y,selectionKeyCode:H,selectionOnDrag:B,selectionMode:X,deleteKeyCode:K,multiSelectionKeyCode:oe,panActivationKeyCode:ie,zoomActivationKeyCode:J,onlyRenderVisibleElements:_e,selectNodesOnDrag:xe,defaultViewport:he,translateExtent:qe,minZoom:Q,maxZoom:me,preventScrolling:Le,zoomOnScroll:Me,zoomOnPinch:tt,zoomOnDoubleClick:ve,panOnScroll:Ie,panOnScrollSpeed:Z,panOnScrollMode:Te,panOnDrag:Ct,onPaneClick:yt,onPaneMouseEnter:bt,onPaneMouseMove:Qt,onPaneMouseLeave:O,onPaneScroll:W,onPaneContextMenu:V,onSelectionContextMenu:M,onSelectionStart:z,onSelectionEnd:P,onEdgeContextMenu:ze,onEdgeDoubleClick:ct,onEdgeMouseEnter:ar,onEdgeMouseMove:Et,onEdgeMouseLeave:_t,onReconnect:ue??$t,onReconnectStart:de??Dr,onReconnectEnd:Ve??st,reconnectRadius:_r??rs,defaultMarkerColor:Ee,noDragClassName:Bi,noWheelClassName:_T,noPanClassName:By,elevateEdgesOnSelect:TT,rfId:Pu,disableKeyboardA11y:Wy,nodeOrigin:te,nodeExtent:Ce}),G.createElement(WM,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:v,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:x,nodesDraggable:ae,nodesConnectable:U,nodesFocusable:re,edgesFocusable:je,edgesUpdatable:se,elementsSelectable:fe,elevateNodesOnSelect:ET,minZoom:Q,maxZoom:me,nodeExtent:Ce,onNodesChange:Lr,onEdgesChange:ns,snapToGrid:we,snapGrid:ge,connectionMode:R,translateExtent:qe,connectOnClick:ST,defaultEdgeOptions:CT,fitView:wT,fitViewOptions:jT,onNodesDelete:A,onEdgesDelete:T,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:j,onSelectionDrag:S,onSelectionDragStart:F,onSelectionDragStop:I,noPanClassName:By,nodeOrigin:te,rfId:Pu,autoPanOnConnect:AT,autoPanOnNodeDrag:RT,onError:MT,connectionRadius:IT,isValidConnection:PT,nodeDragThreshold:DT}),G.createElement(qM,{onSelectionChange:D}),ne,G.createElement(mM,{proOptions:NT,position:kT}),G.createElement(KM,{rfId:Pu,disableKeyboardA11y:Wy})))});wa.displayName="ReactFlow";function jE(e){return t=>{const[r,n]=m.useState(t),s=m.useCallback(i=>n(a=>e(i,a)),[]);return[r,n,s]}}const SE=jE(uE),kE=jE(lO),NE=({id:e,x:t,y:r,width:n,height:s,style:i,color:a,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:v,backgroundColor:g}=i||{},_=a||v||g;return G.createElement("rect",{className:Yt(["react-flow__minimap-node",{selected:h},d]),x:t,y:r,rx:u,ry:u,width:n,height:s,fill:_,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?x=>p(x,e):void 0})};NE.displayName="MiniMapNode";var e8=m.memo(NE);const t8=e=>e.nodeOrigin,r8=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),gd=e=>e instanceof Function?e:()=>e;function n8({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:s=2,nodeComponent:i=e8,onClick:a}){const l=Xe(r8,Pt),c=Xe(t8),d=gd(t),u=gd(e),f=gd(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return G.createElement(G.Fragment,null,l.map(h=>{const{x:v,y:g}=vs(h,c).positionAbsolute;return G.createElement(i,{key:h.id,x:v,y:g,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:n,strokeColor:u(h),strokeWidth:s,shapeRendering:p,onClick:a,id:h.id})}))}var s8=m.memo(n8);const i8=200,o8=150,a8=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?vM(nu(t,e.nodeOrigin),r):r,rfId:e.rfId}},l8="react-flow__minimap-desc";function CE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:a=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:v=!1,zoomable:g=!1,ariaLabel:_="React Flow mini map",inversePan:x=!1,zoomStep:y=10,offsetScale:b=5}){const w=vt(),k=m.useRef(null),{boundingRect:C,viewBB:N,rfId:E}=Xe(a8,Pt),j=(e==null?void 0:e.width)??i8,A=(e==null?void 0:e.height)??o8,T=C.width/j,D=C.height/A,F=Math.max(T,D),S=F*j,I=F*A,M=b*F,z=C.x-(S-C.width)/2-M,P=C.y-(I-C.height)/2-M,R=S+M*2,L=I+M*2,$=`${l8}-${E}`,q=m.useRef(0);q.current=F,m.useEffect(()=>{if(k.current){const H=fr(k.current),B=oe=>{const{transform:J,d3Selection:we,d3Zoom:ge}=w.getState();if(oe.sourceEvent.type!=="wheel"||!we||!ge)return;const _e=-oe.sourceEvent.deltaY*(oe.sourceEvent.deltaMode===1?.05:oe.sourceEvent.deltaMode?1:.002)*y,xe=J[2]*Math.pow(2,_e);ge.scaleTo(we,xe)},X=oe=>{const{transform:J,d3Selection:we,d3Zoom:ge,translateExtent:_e,width:xe,height:ae}=w.getState();if(oe.sourceEvent.type!=="mousemove"||!we||!ge)return;const U=q.current*Math.max(1,J[2])*(x?-1:1),re={x:J[0]-oe.sourceEvent.movementX*U,y:J[1]-oe.sourceEvent.movementY*U},te=[[0,0],[xe,ae]],je=cn.translate(re.x,re.y).scale(J[2]),se=ge.constrain()(je,te,_e);ge.transform(we,se)},ie=IC().on("zoom",v?X:null).on("zoom.wheel",g?B:null);return H.call(ie),()=>{H.on("zoom",null)}}},[v,g,x,y]);const Y=p?H=>{const B=Nr(H);p(H,{x:B[0],y:B[1]})}:void 0,K=h?(H,B)=>{const X=w.getState().nodeInternals.get(B);h(H,X)}:void 0;return G.createElement(Hn,{position:f,style:e,className:Yt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},G.createElement("svg",{width:j,height:A,viewBox:`${z} ${P} ${R} ${L}`,role:"img","aria-labelledby":$,ref:k,onClick:Y},_&&G.createElement("title",{id:$},_),G.createElement(s8,{onClick:K,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:l}),G.createElement("path",{className:"react-flow__minimap-mask",d:`M${z-M},${P-M}h${R+M*2}v${L+M*2}h${-R-M*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}CE.displayName="MiniMap";var EE=m.memo(CE);const il={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},c8=180,u8=400,d8=260,f8=48;function p8(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function h8({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:s,onToggleShowArchived:i,userSection:a}){const[l,c]=m.useState(!1),[d,u]=m.useState(d8),[f,p]=m.useState(!1),h=m.useRef(null),v=m.useRef(null);m.useEffect(()=>{v.current&&v.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((k,C)=>{const N=(k.name||"").localeCompare(C.name||"");return N!==0?N:(k.projectId||"").localeCompare(C.projectId||"")}),[e]),_=()=>{n()},x=m.useCallback(k=>{k.preventDefault(),p(!0)},[]),y=m.useCallback(k=>{if(!f)return;const C=Math.min(u8,Math.max(c8,k.clientX));u(C)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const w=l?f8:d;return o.jsxs("div",{ref:h,className:"h-full flex flex-col relative",onWheel:k=>k.stopPropagation(),style:{width:w,minWidth:w,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[o.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),o.jsx("button",{onClick:i,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:s?"#f59e0b":"var(--text-muted)"},title:s?"Hide archived":"Show archived",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),o.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:o.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&o.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(k=>{const C=t===k.id;return o.jsxs("div",{ref:C?v:null,onClick:()=>r(k.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:C?"var(--state-active-bg)":"transparent",border:C?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:C?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:C?"#ffffff":il[k.status]||il.queued}}),o.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:C?"#ffffff":"var(--text-primary)"},children:k.name}),k.isArchived&&o.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:C?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),o.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[o.jsx("span",{className:"text-[10px] font-mono",style:{color:C?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:k.projectId}),o.jsx("span",{className:"text-[10px]",style:{color:C?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:p8(k.createdAt)})]})]},k.id)})}),l&&o.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(k=>o.jsx("div",{onClick:()=>r(k.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:k.name,children:o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:il[k.status]||il.queued,boxShadow:t===k.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},k.id))}),!l&&o.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:_,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[o.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),o.jsx("span",{children:"New Project"})]})}),l&&o.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:o.jsx("button",{onClick:_,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:o.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),a,!l&&o.jsx("div",{onMouseDown:x,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function m8({stations:e}){if(!(e!=null&&e.length))return null;const t=e.reduce((i,a,l)=>a.state==="complete"?l:i,-1),r=e.findIndex(i=>i.state==="active"),n=e.find(i=>i.state==="active"),s=n==null?void 0:n.currentStep;return o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"relative flex items-start",children:[o.jsx("div",{className:"absolute h-0.5 left-0 right-0",style:{top:5,background:"var(--state-queued-bg)"}}),t>=0&&o.jsx("div",{className:"absolute h-0.5 left-0",style:{top:5,width:`${(t+.5)/e.length*100}%`,background:"var(--state-stabilized-bg)"}}),r>=0&&o.jsx("div",{className:"absolute h-0.5",style:{top:5,left:t>=0?`${(t+.5)/e.length*100}%`:"0%",width:t>=0?`${(r-t)/e.length*100}%`:`${(r+.5)/e.length*100}%`,background:"var(--state-active-bg)"}}),e.map(i=>{const a=i.state==="active",c=i.state==="complete"?"var(--state-stabilized-bg)":a?"var(--state-active-bg)":i.state==="failed"?"var(--state-blocked-bg)":"var(--state-queued-bg)",d=a?"var(--state-active-text)":"var(--text-muted)";return o.jsxs("div",{className:"flex-1 flex flex-col items-center relative z-10",children:[o.jsx("div",{className:`w-3 h-3 rounded-full${a?" station-active":""}${a&&i.needs_input?" station-needs-input":""}`,style:{background:c,boxShadow:a&&i.needs_input?"0 0 0 2px var(--state-active-bg)":void 0}}),o.jsx("span",{className:"text-[7px] mt-0.5",style:{color:a&&i.needs_input?"var(--state-active-text)":d,fontWeight:a?500:400},children:i.label})]},i.id)})]}),s&&o.jsx("div",{className:"text-center text-[8px] mt-1 font-medium",style:{color:"var(--state-active-text)"},children:s.name})]})}const Wb={light:{blocked:"#ef4444",in_progress:"#6366f1",ready:"#eab308",stabilized:"#10b981",active:"#6366f1",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},industrial:{blocked:"#ef4444",in_progress:"#f59e0b",ready:"#eab308",stabilized:"#10b981",active:"#f59e0b",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},blueprint:{blocked:"#ef4444",in_progress:"#fbbf24",ready:"#eab308",stabilized:"#10b981",active:"#fbbf24",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"}};function g8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const TE=(e,t)=>{var n;const r=g8(e);return((n=Wb[t])==null?void 0:n[r])||Wb.industrial.ready},jr={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},hc={GAP:8},In=["industrial","light","blueprint"],x8=400,v8=560;function y8({question:e,value:t,onChange:r}){const n=e.answer_type||"text",s=e.choices||[];if(n==="single_choice"&&s.length>0)return o.jsx("div",{className:"space-y-1.5",children:s.map(i=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"radio",name:e.id,value:i.value,checked:t===i.value,onChange:()=>r(i.value),className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:i.label})]},i.value))});if(n==="multi_choice"&&s.length>0){const i=Array.isArray(t)?t:[];return o.jsx("div",{className:"space-y-1.5",children:s.map(a=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"checkbox",checked:i.includes(a.value),onChange:l=>{l.target.checked?r([...i,a.value]):r(i.filter(c=>c!==a.value))},className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:a.label})]},a.value))})}return n==="boolean"?o.jsx("div",{className:"flex gap-3",children:[{label:"Yes",value:!0},{label:"No",value:!1}].map(i=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"radio",name:e.id,checked:t===i.value,onChange:()=>r(i.value),className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:i.label})]},String(i.value)))}):n==="number"?o.jsx("input",{type:"number",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:i=>r(i.target.value?Number(i.target.value):"")}):n==="free_text"||n==="long_text"?o.jsx("textarea",{className:"w-full rounded px-2 py-1.5 text-xs border resize-none",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)",minHeight:60},value:t||"",onChange:i=>r(i.target.value)}):o.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:i=>r(i.target.value)})}function b8({priority:e}){if(!e)return null;const t={must:{bg:"bg-red-500/20",text:"text-red-400"},should:{bg:"bg-amber-500/20",text:"text-amber-400"},could:{bg:"bg-blue-500/20",text:"text-blue-400"}},r=t[e]||t.should;return o.jsx("span",{className:`${r.bg} ${r.text} text-[8px] px-1.5 py-0.5 rounded uppercase font-semibold`,children:e})}function _8({questions:e,nodeWidth:t,onSubmit:r,onClose:n}){const[s,i]=m.useState({}),[a,l]=m.useState(!1),[c,d]=m.useState(!1),u=e.filter(g=>g.required).every(g=>{const _=s[g.id];return Array.isArray(_)?_.length>0:_!==void 0&&_!==""}),f=a?v8:x8,p=(g,_)=>{i(x=>({...x,[g]:_}))},h=async()=>{d(!0);try{await r(s)}catch(g){console.error("Submit failed:",g),d(!1)}},v=g=>g.stopPropagation();return o.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:t+hc.GAP,width:f,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",transition:"width 0.2s ease",userSelect:"text"},onMouseDown:v,onPointerDown:v,onWheel:v,children:[o.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:hc.GAP}}),o.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),o.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[o.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>l(!a),title:a?"Contract":"Expand",className:"hover:opacity-70 transition-opacity p-1",style:{color:"var(--text-sidecar-muted)"},children:a?o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),o.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]})]}),o.jsx("div",{className:`p-3 space-y-4 overflow-y-auto nowheel ${a?"max-h-[520px]":"max-h-[420px]"}`,children:e.map(g=>o.jsxs("div",{className:"pb-3",style:{borderBottom:"1px solid var(--border-input)"},children:[o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[o.jsxs("label",{className:"block text-[11px] font-medium",style:{color:"var(--text-sidecar)"},children:[g.text," ",g.required&&o.jsx("span",{className:"text-amber-500",children:"*"})]}),o.jsx(b8,{priority:g.priority})]}),g.why_it_matters&&o.jsx("p",{className:"text-[9px] mb-2 italic",style:{color:"var(--text-sidecar-muted)"},children:g.why_it_matters}),o.jsx(y8,{question:g,value:s[g.id],onChange:_=>p(g.id,_)})]},g.id))}),o.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:o.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${u&&!c?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!u||c,onClick:h,children:c?"Submitting...":"Submit & Continue"})})]})}function w8({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:s}){const i=e.length>6,a=i?240:320;m.useEffect(()=>{if(s){const c=setTimeout(()=>s(),150);return()=>clearTimeout(c)}},[s]);const l=c=>c.stopPropagation();return o.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:r+hc.GAP,width:a,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",userSelect:"text"},onMouseDown:l,onPointerDown:l,onWheel:l,children:[o.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:hc.GAP}}),o.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),o.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[o.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),o.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),o.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${i?"":"grid grid-cols-2 gap-2"}`,children:e.map(c=>{const d=c.state==="complete"?"var(--state-stabilized-bg)":c.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return o.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${i?"mb-1":""}`,children:[o.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:d}}),o.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:c.name})]},c.id)})}),o.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const j8={blocked:{bg:"var(--state-blocked-bg)",text:"var(--state-blocked-text)"},in_progress:{bg:"var(--state-active-bg)",text:"var(--state-active-text)"},ready:{bg:"var(--state-ready-bg)",text:"var(--state-ready-text)"},stabilized:{bg:"var(--state-stabilized-bg)",text:"var(--state-stabilized-text)"}};function S8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const k8={blocked:"Blocked",in_progress:"In Progress",ready:"Ready",stabilized:"Stabilized"};function N8(e){return e?e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):""}function C8({data:e}){var C,N,E,j;const r=(e.level||1)===1,n=e.isExpanded,s=e.expandType,i=((C=e.questions)==null?void 0:C.length)>0,a=((N=e.features)==null?void 0:N.length)>0,l=(E=e.stations)==null?void 0:E.some(A=>A.state==="active"&&A.needs_input),c=e.state||"ready_for_production",d=S8(c),u=d==="stabilized",f=d==="in_progress",p=d==="blocked",h=f&&e.stations,v=f?"node-active":"",g=r?"DOCUMENT":"EPIC",_=r?"subway-node-header-doc":"subway-node-header-epic",x=j8[d],y=x.bg,b=x.text,w=x.bg,k=k8[d];return o.jsxs("div",{className:"relative",children:[o.jsx(vr,{type:"target",position:ce.Top,className:"!opacity-0",style:{left:"15%"}}),o.jsxs("div",{className:`subway-node rounded-lg border ${v} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:w},children:[o.jsxs("div",{className:`${_} border-b px-3 py-1.5 flex items-center justify-between`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:g}),o.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&o.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:y}}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:b},children:k}),r&&e.desc&&o.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),h&&o.jsx(m8,{stations:e.stations}),o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&u&&o.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-stabilized-bg)",color:"white"},onClick:A=>{var T;A.stopPropagation(),(T=e.onViewFullDocument)==null||T.call(e,e.id)},children:"View Document"}),r&&d==="ready"&&o.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-ready-bg)",color:"white"},onClick:A=>{var T;A.stopPropagation(),(T=e.onStartProduction)==null||T.call(e,e.id)},children:"Start Production"}),l&&i&&!n&&o.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all amber-pulse",style:{backgroundColor:"var(--state-active-bg)",color:"white"},onClick:A=>{var T;A.stopPropagation(),(T=e.onExpand)==null||T.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&a&&(n&&s==="features"?o.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):o.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:A=>{var T;A.stopPropagation(),(T=e.onExpand)==null||T.call(e,e.id,"features")},children:[o.jsx("span",{className:"text-indigo-400",children:e.features.length}),o.jsx("span",{children:"features"}),o.jsx("span",{className:"text-indigo-400",children:""})]}))]}),((j=e.blockedBy)==null?void 0:j.length)>0&&(p||d==="ready")&&o.jsxs("div",{className:"mt-2 pt-2 border-t text-[8px]",style:{borderColor:"var(--border-node)",color:"var(--text-muted)"},children:[o.jsx("span",{className:"font-medium",children:"Waiting for: "}),e.blockedBy.map(N8).join(", ")]})]})]}),n&&s==="questions"&&i&&o.jsx(_8,{questions:e.questions,nodeWidth:e.width,onSubmit:A=>{var T;return(T=e.onSubmitQuestions)==null?void 0:T.call(e,e.id,A)},onClose:()=>{var A;return(A=e.onCollapse)==null?void 0:A.call(e)}}),n&&s==="features"&&a&&o.jsx(w8,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var A;return(A=e.onCollapse)==null?void 0:A.call(e)},onZoomComplete:()=>{var A;return(A=e.onZoomToNode)==null?void 0:A.call(e,e.id)}}),o.jsx(vr,{type:"source",position:ce.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function E8(){return o.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[o.jsx(vr,{type:"target",position:ce.Top,style:{opacity:0}}),o.jsx(vr,{type:"source",position:ce.Bottom,style:{opacity:0}})]})}const ly="/api/v1";class T8 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function A8(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Be(e,t={}){const r=`${ly}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},s=await fetch(r,n);if(!s.ok){const i=await s.json().catch(()=>({}));throw new T8(i.detail||`Request failed: ${s.status}`,s.status,i)}return s.status===204?null:s.json()}const Ye={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":A8()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return Be(`/projects${r?"?"+r:""}`)},getProject:e=>Be(`/projects/${e}`),getProjectTree:e=>Be(`/projects/${e}/tree`),createProject:e=>Be("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>Be(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>Be(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>Be(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>Be(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>Be(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),Be(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>Be(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>Be(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>Be("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>Be(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>Be(`/document-workflows/executions/${e}`),getPgcAnswers:e=>Be(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>Be(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>Be(`/projects/${e}/documents/${t}/render-model`),getDocumentPgc:(e,t)=>Be(`/projects/${e}/documents/${t}/pgc`),startIntake:()=>Be("/intake/start",{method:"POST"}),getIntakeState:e=>Be(`/intake/${e}`),submitIntakeMessage:(e,t)=>Be(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>Be(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>Be(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>Be(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>Be(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>Be(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>Be(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>Be(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>Be(`/projects/${e}/workflow/complete`,{method:"POST"})};function R8(e){const t=`${ly}/production/events?project_id=${e}`;return new EventSource(t)}function I8(e){const t=`${ly}/intake/${e}/events`;return new EventSource(t)}function P8(e){return`/auth/login/${e}`}function M8({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&o.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Hb({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const s=n==="numbered"?"decimal":"disc";return o.jsxs("div",{style:{marginBottom:12},children:[t.title&&o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),o.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":s},children:r.map((i,a)=>o.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&o.jsx("span",{style:{color:"#10b981"},children:""}),typeof i=="string"?i:typeof i=="object"&&i!==null?o.jsx(O8,{item:i}):String(i)]},(i==null?void 0:i.id)||a))})]})}function O8({item:e}){const t=e.value||e.text||e.constraint||e.assumption||e.guardrail||e.recommendation||e.question||e.description||e.statement||e.name;return t?o.jsxs("span",{children:[e.id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af",marginRight:6},children:e.id}),t,e.constraint_type&&o.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.constraint_type}),e.confidence&&o.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:e.confidence==="high"?"#dcfce7":e.confidence==="medium"?"#fef3c7":"#fee2e2",color:e.confidence==="high"?"#166534":e.confidence==="medium"?"#92400e":"#991b1b"},children:e.confidence}),e.validation_approach&&o.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:[o.jsx("span",{style:{fontWeight:500},children:"Validation:"})," ",e.validation_approach]})]}):o.jsx("span",{children:Object.entries(e).map(([r,n],s)=>o.jsxs("span",{children:[s>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[r,":"]})," ",typeof n=="string"?n:JSON.stringify(n)]},r))})}function D8({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,i={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return o.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&o.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),o.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:i.bg,color:i.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function AE({block:e}){const{data:t}=e,{id:r,text:n,blocking:s,why_it_matters:i,priority:a,tags:l,options:c}=t,d={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},u=d[a]||d.should;return o.jsx("div",{style:{padding:"12px 16px",background:s?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${s?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),o.jsxs("div",{style:{flex:1},children:[o.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),i&&o.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:i}),o.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[s&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),a&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:u.bg,color:u.text,textTransform:"uppercase"},children:a}),l==null?void 0:l.map((f,p)=>o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},p))]}),c&&c.length>0&&o.jsxs("div",{style:{marginTop:8},children:[o.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,p)=>o.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:p>0?8:4},children:f},p))]})]})]})})}function L8({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,s=t.blocking_count||r.filter(i=>i.blocking).length;return r.length===0?o.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[o.jsxs("span",{style:{color:"#6b7280"},children:[o.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),s>0&&o.jsxs("span",{style:{color:"#dc2626"},children:[o.jsx("strong",{children:s})," blocking"]})]}),r.map((i,a)=>o.jsx(AE,{block:{type:"schema:OpenQuestionV1",data:i}},i.id||a))]})}function Vb({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const s={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return o.jsxs("div",{style:{marginBottom:12},children:[n&&o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((i,a)=>{const l=i.severity||i.impact||i.likelihood||"medium",c=s[l]||s.medium;return o.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[i.id&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:i.id}),o.jsxs("div",{style:{flex:1},children:[o.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:i.risk||i.description||i.reason||JSON.stringify(i)}),i.impact&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",i.impact]}),i.mitigation&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",i.mitigation]}),i.status&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:11,color:c.text,opacity:.7,textTransform:"capitalize"},children:["Status: ",i.status]})]}),o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},i.id||a)})})]})}function z8({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition",refined_description:"Description",architectural_style:"Architectural Style",style:"Architectural Style"}).filter(([s])=>t[s]&&typeof t[s]=="string").map(([s,i])=>({title:i,content:t[s]}));return n.length===0&&!t.title?null:o.jsxs("div",{style:{marginBottom:12},children:[t.title&&o.jsx("h3",{style:{fontSize:16,fontWeight:600,color:"#1f2937",marginBottom:12},children:t.title}),n.map((s,i)=>o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:s.title}),o.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:o.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:s.content})})]},i))]})}function Ub({block:e}){const{data:t}=e,{epic_id:r,title:n,name:s,intent:i,phase:a,mvp_phase:l,risk_level:c,stories:d,detail_ref:u}=t,f=a||l,p=n||s,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},v=h[c]||h.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},_=g[f]||g.mvp;return o.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[o.jsxs("div",{style:{flex:1},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),o.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),i&&o.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i}),d&&d.length>0&&o.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[d.length," stories"]})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:_.bg,color:_.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&o.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:v.bg,color:v.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),u&&o.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:o.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function F8({block:e}){const{data:t}=e,{story_id:r,title:n,intent:s,phase:i,risk_level:a,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[a]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[i]||u.mvp;return o.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[o.jsxs("div",{style:{flex:1},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),o.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),s&&o.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:s})]}),o.jsxs("div",{style:{display:"flex",gap:4},children:[i&&o.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:i}),d&&o.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:a})]})]})})}function $8({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=t.technology||(Array.isArray(t.technology_choices)?t.technology_choices.join(", "):null),n=t.interfaces||[],s=t.dependencies||t.depends_on_components||[],i=t.responsibilities||[],a=t.layer,l=t.mvp_phase,c={fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:2},d={fontSize:13,color:"#374151",lineHeight:1.5,margin:0},u=(f,p)=>({fontSize:12,padding:"2px 8px",background:f,color:p,borderRadius:4});return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),a&&o.jsx("span",{style:u("#f0fdf4","#166534"),children:a}),l&&o.jsx("span",{style:u("#eff6ff","#1e40af"),children:l})]}),t.purpose&&o.jsx("p",{style:{...d,marginBottom:10,color:"#475569"},children:t.purpose}),r&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Technology"}),o.jsx("p",{style:d,children:r})]}),Array.isArray(i)&&i.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Responsibilities"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:i.map((f,p)=>o.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:f},p))})]}),Array.isArray(n)&&n.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Interfaces"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:n.map((f,p)=>o.jsx("span",{style:u("#e0e7ff","#3730a3"),children:f},p))})]}),Array.isArray(s)&&s.length>0&&o.jsxs("div",{children:[o.jsx("div",{style:c,children:"Dependencies"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:s.map((f,p)=>o.jsx("span",{style:u("#fef3c7","#92400e"),children:f},p))})]})]})}function cy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xd,Gb;function q8(){if(Gb)return xd;Gb=1;function e(){this.__data__=[],this.size=0}return xd=e,xd}var vd,Kb;function Pi(){if(Kb)return vd;Kb=1;function e(t,r){return t===r||t!==t&&r!==r}return vd=e,vd}var yd,Yb;function iu(){if(Yb)return yd;Yb=1;var e=Pi();function t(r,n){for(var s=r.length;s--;)if(e(r[s][0],n))return s;return-1}return yd=t,yd}var bd,Xb;function B8(){if(Xb)return bd;Xb=1;var e=iu(),t=Array.prototype,r=t.splice;function n(s){var i=this.__data__,a=e(i,s);if(a<0)return!1;var l=i.length-1;return a==l?i.pop():r.call(i,a,1),--this.size,!0}return bd=n,bd}var _d,Qb;function W8(){if(Qb)return _d;Qb=1;var e=iu();function t(r){var n=this.__data__,s=e(n,r);return s<0?void 0:n[s][1]}return _d=t,_d}var wd,Zb;function H8(){if(Zb)return wd;Zb=1;var e=iu();function t(r){return e(this.__data__,r)>-1}return wd=t,wd}var jd,Jb;function V8(){if(Jb)return jd;Jb=1;var e=iu();function t(r,n){var s=this.__data__,i=e(s,r);return i<0?(++this.size,s.push([r,n])):s[i][1]=n,this}return jd=t,jd}var Sd,e1;function ou(){if(e1)return Sd;e1=1;var e=q8(),t=B8(),r=W8(),n=H8(),s=V8();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=s,Sd=i,Sd}var kd,t1;function U8(){if(t1)return kd;t1=1;var e=ou();function t(){this.__data__=new e,this.size=0}return kd=t,kd}var Nd,r1;function G8(){if(r1)return Nd;r1=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Nd=e,Nd}var Cd,n1;function K8(){if(n1)return Cd;n1=1;function e(t){return this.__data__.get(t)}return Cd=e,Cd}var Ed,s1;function Y8(){if(s1)return Ed;s1=1;function e(t){return this.__data__.has(t)}return Ed=e,Ed}var Td,i1;function RE(){if(i1)return Td;i1=1;var e=typeof Ia=="object"&&Ia&&Ia.Object===Object&&Ia;return Td=e,Td}var Ad,o1;function Mr(){if(o1)return Ad;o1=1;var e=RE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Ad=r,Ad}var Rd,a1;function Mi(){if(a1)return Rd;a1=1;var e=Mr(),t=e.Symbol;return Rd=t,Rd}var Id,l1;function X8(){if(l1)return Id;l1=1;var e=Mi(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,s=e?e.toStringTag:void 0;function i(a){var l=r.call(a,s),c=a[s];try{a[s]=void 0;var d=!0}catch{}var u=n.call(a);return d&&(l?a[s]=c:delete a[s]),u}return Id=i,Id}var Pd,c1;function Q8(){if(c1)return Pd;c1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Pd=r,Pd}var Md,u1;function Ts(){if(u1)return Md;u1=1;var e=Mi(),t=X8(),r=Q8(),n="[object Null]",s="[object Undefined]",i=e?e.toStringTag:void 0;function a(l){return l==null?l===void 0?s:n:i&&i in Object(l)?t(l):r(l)}return Md=a,Md}var Od,d1;function yr(){if(d1)return Od;d1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Od=e,Od}var Dd,f1;function ja(){if(f1)return Dd;f1=1;var e=Ts(),t=yr(),r="[object AsyncFunction]",n="[object Function]",s="[object GeneratorFunction]",i="[object Proxy]";function a(l){if(!t(l))return!1;var c=e(l);return c==n||c==s||c==r||c==i}return Dd=a,Dd}var Ld,p1;function Z8(){if(p1)return Ld;p1=1;var e=Mr(),t=e["__core-js_shared__"];return Ld=t,Ld}var zd,h1;function J8(){if(h1)return zd;h1=1;var e=Z8(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return zd=r,zd}var Fd,m1;function IE(){if(m1)return Fd;m1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Fd=r,Fd}var $d,g1;function eD(){if(g1)return $d;g1=1;var e=ja(),t=J8(),r=yr(),n=IE(),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,a=Function.prototype,l=Object.prototype,c=a.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?u:i;return h.test(n(p))}return $d=f,$d}var qd,x1;function tD(){if(x1)return qd;x1=1;function e(t,r){return t==null?void 0:t[r]}return qd=e,qd}var Bd,v1;function As(){if(v1)return Bd;v1=1;var e=eD(),t=tD();function r(n,s){var i=t(n,s);return e(i)?i:void 0}return Bd=r,Bd}var Wd,y1;function uy(){if(y1)return Wd;y1=1;var e=As(),t=Mr(),r=e(t,"Map");return Wd=r,Wd}var Hd,b1;function au(){if(b1)return Hd;b1=1;var e=As(),t=e(Object,"create");return Hd=t,Hd}var Vd,_1;function rD(){if(_1)return Vd;_1=1;var e=au();function t(){this.__data__=e?e(null):{},this.size=0}return Vd=t,Vd}var Ud,w1;function nD(){if(w1)return Ud;w1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Ud=e,Ud}var Gd,j1;function sD(){if(j1)return Gd;j1=1;var e=au(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function s(i){var a=this.__data__;if(e){var l=a[i];return l===t?void 0:l}return n.call(a,i)?a[i]:void 0}return Gd=s,Gd}var Kd,S1;function iD(){if(S1)return Kd;S1=1;var e=au(),t=Object.prototype,r=t.hasOwnProperty;function n(s){var i=this.__data__;return e?i[s]!==void 0:r.call(i,s)}return Kd=n,Kd}var Yd,k1;function oD(){if(k1)return Yd;k1=1;var e=au(),t="__lodash_hash_undefined__";function r(n,s){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=e&&s===void 0?t:s,this}return Yd=r,Yd}var Xd,N1;function aD(){if(N1)return Xd;N1=1;var e=rD(),t=nD(),r=sD(),n=iD(),s=oD();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=s,Xd=i,Xd}var Qd,C1;function lD(){if(C1)return Qd;C1=1;var e=aD(),t=ou(),r=uy();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Qd=n,Qd}var Zd,E1;function cD(){if(E1)return Zd;E1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Zd=e,Zd}var Jd,T1;function lu(){if(T1)return Jd;T1=1;var e=cD();function t(r,n){var s=r.__data__;return e(n)?s[typeof n=="string"?"string":"hash"]:s.map}return Jd=t,Jd}var ef,A1;function uD(){if(A1)return ef;A1=1;var e=lu();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return ef=t,ef}var tf,R1;function dD(){if(R1)return tf;R1=1;var e=lu();function t(r){return e(this,r).get(r)}return tf=t,tf}var rf,I1;function fD(){if(I1)return rf;I1=1;var e=lu();function t(r){return e(this,r).has(r)}return rf=t,rf}var nf,P1;function pD(){if(P1)return nf;P1=1;var e=lu();function t(r,n){var s=e(this,r),i=s.size;return s.set(r,n),this.size+=s.size==i?0:1,this}return nf=t,nf}var sf,M1;function dy(){if(M1)return sf;M1=1;var e=lD(),t=uD(),r=dD(),n=fD(),s=pD();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=s,sf=i,sf}var of,O1;function hD(){if(O1)return of;O1=1;var e=ou(),t=uy(),r=dy(),n=200;function s(i,a){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([i,a]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(i,a),this.size=l.size,this}return of=s,of}var af,D1;function cu(){if(D1)return af;D1=1;var e=ou(),t=U8(),r=G8(),n=K8(),s=Y8(),i=hD();function a(l){var c=this.__data__=new e(l);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=r,a.prototype.get=n,a.prototype.has=s,a.prototype.set=i,af=a,af}var lf,L1;function fy(){if(L1)return lf;L1=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s&&r(t[n],n,t)!==!1;);return t}return lf=e,lf}var cf,z1;function PE(){if(z1)return cf;z1=1;var e=As(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return cf=t,cf}var uf,F1;function uu(){if(F1)return uf;F1=1;var e=PE();function t(r,n,s){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:s,writable:!0}):r[n]=s}return uf=t,uf}var df,$1;function du(){if($1)return df;$1=1;var e=uu(),t=Pi(),r=Object.prototype,n=r.hasOwnProperty;function s(i,a,l){var c=i[a];(!(n.call(i,a)&&t(c,l))||l===void 0&&!(a in i))&&e(i,a,l)}return df=s,df}var ff,q1;function Sa(){if(q1)return ff;q1=1;var e=du(),t=uu();function r(n,s,i,a){var l=!i;i||(i={});for(var c=-1,d=s.length;++c<d;){var u=s[c],f=a?a(i[u],n[u],u,i,n):void 0;f===void 0&&(f=n[u]),l?t(i,u,f):e(i,u,f)}return i}return ff=r,ff}var pf,B1;function mD(){if(B1)return pf;B1=1;function e(t,r){for(var n=-1,s=Array(t);++n<t;)s[n]=r(n);return s}return pf=e,pf}var hf,W1;function Yr(){if(W1)return hf;W1=1;function e(t){return t!=null&&typeof t=="object"}return hf=e,hf}var mf,H1;function gD(){if(H1)return mf;H1=1;var e=Ts(),t=Yr(),r="[object Arguments]";function n(s){return t(s)&&e(s)==r}return mf=n,mf}var gf,V1;function ka(){if(V1)return gf;V1=1;var e=gD(),t=Yr(),r=Object.prototype,n=r.hasOwnProperty,s=r.propertyIsEnumerable,i=e(function(){return arguments}())?e:function(a){return t(a)&&n.call(a,"callee")&&!s.call(a,"callee")};return gf=i,gf}var xf,U1;function lt(){if(U1)return xf;U1=1;var e=Array.isArray;return xf=e,xf}var go={exports:{}},vf,G1;function xD(){if(G1)return vf;G1=1;function e(){return!1}return vf=e,vf}go.exports;var K1;function Oi(){return K1||(K1=1,function(e,t){var r=Mr(),n=xD(),s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===s,l=a?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d}(go,go.exports)),go.exports}var yf,Y1;function fu(){if(Y1)return yf;Y1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,s){var i=typeof n;return s=s??e,!!s&&(i=="number"||i!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<s}return yf=r,yf}var bf,X1;function py(){if(X1)return bf;X1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return bf=t,bf}var _f,Q1;function vD(){if(Q1)return _f;Q1=1;var e=Ts(),t=py(),r=Yr(),n="[object Arguments]",s="[object Array]",i="[object Boolean]",a="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",v="[object String]",g="[object WeakMap]",_="[object ArrayBuffer]",x="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",w="[object Int8Array]",k="[object Int16Array]",C="[object Int32Array]",N="[object Uint8Array]",E="[object Uint8ClampedArray]",j="[object Uint16Array]",A="[object Uint32Array]",T={};T[y]=T[b]=T[w]=T[k]=T[C]=T[N]=T[E]=T[j]=T[A]=!0,T[n]=T[s]=T[_]=T[i]=T[x]=T[a]=T[l]=T[c]=T[d]=T[u]=T[f]=T[p]=T[h]=T[v]=T[g]=!1;function D(F){return r(F)&&t(F.length)&&!!T[e(F)]}return _f=D,_f}var wf,Z1;function pu(){if(Z1)return wf;Z1=1;function e(t){return function(r){return t(r)}}return wf=e,wf}var xo={exports:{}};xo.exports;var J1;function hy(){return J1||(J1=1,function(e,t){var r=RE(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===n,a=i&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=l}(xo,xo.exports)),xo.exports}var jf,e_;function Na(){if(e_)return jf;e_=1;var e=vD(),t=pu(),r=hy(),n=r&&r.isTypedArray,s=n?t(n):e;return jf=s,jf}var Sf,t_;function ME(){if(t_)return Sf;t_=1;var e=mD(),t=ka(),r=lt(),n=Oi(),s=fu(),i=Na(),a=Object.prototype,l=a.hasOwnProperty;function c(d,u){var f=r(d),p=!f&&t(d),h=!f&&!p&&n(d),v=!f&&!p&&!h&&i(d),g=f||p||h||v,_=g?e(d.length,String):[],x=_.length;for(var y in d)(u||l.call(d,y))&&!(g&&(y=="length"||h&&(y=="offset"||y=="parent")||v&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||s(y,x)))&&_.push(y);return _}return Sf=c,Sf}var kf,r_;function hu(){if(r_)return kf;r_=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,s=typeof n=="function"&&n.prototype||e;return r===s}return kf=t,kf}var Nf,n_;function OE(){if(n_)return Nf;n_=1;function e(t,r){return function(n){return t(r(n))}}return Nf=e,Nf}var Cf,s_;function yD(){if(s_)return Cf;s_=1;var e=OE(),t=e(Object.keys,Object);return Cf=t,Cf}var Ef,i_;function my(){if(i_)return Ef;i_=1;var e=hu(),t=yD(),r=Object.prototype,n=r.hasOwnProperty;function s(i){if(!e(i))return t(i);var a=[];for(var l in Object(i))n.call(i,l)&&l!="constructor"&&a.push(l);return a}return Ef=s,Ef}var Tf,o_;function yn(){if(o_)return Tf;o_=1;var e=ja(),t=py();function r(n){return n!=null&&t(n.length)&&!e(n)}return Tf=r,Tf}var Af,a_;function ts(){if(a_)return Af;a_=1;var e=ME(),t=my(),r=yn();function n(s){return r(s)?e(s):t(s)}return Af=n,Af}var Rf,l_;function bD(){if(l_)return Rf;l_=1;var e=Sa(),t=ts();function r(n,s){return n&&e(s,t(s),n)}return Rf=r,Rf}var If,c_;function _D(){if(c_)return If;c_=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return If=e,If}var Pf,u_;function wD(){if(u_)return Pf;u_=1;var e=yr(),t=hu(),r=_D(),n=Object.prototype,s=n.hasOwnProperty;function i(a){if(!e(a))return r(a);var l=t(a),c=[];for(var d in a)d=="constructor"&&(l||!s.call(a,d))||c.push(d);return c}return Pf=i,Pf}var Mf,d_;function Rs(){if(d_)return Mf;d_=1;var e=ME(),t=wD(),r=yn();function n(s){return r(s)?e(s,!0):t(s)}return Mf=n,Mf}var Of,f_;function jD(){if(f_)return Of;f_=1;var e=Sa(),t=Rs();function r(n,s){return n&&e(s,t(s),n)}return Of=r,Of}var vo={exports:{}};vo.exports;var p_;function DE(){return p_||(p_=1,function(e,t){var r=Mr(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===n,a=i?r.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(vo,vo.exports)),vo.exports}var Df,h_;function LE(){if(h_)return Df;h_=1;function e(t,r){var n=-1,s=t.length;for(r||(r=Array(s));++n<s;)r[n]=t[n];return r}return Df=e,Df}var Lf,m_;function zE(){if(m_)return Lf;m_=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,i=0,a=[];++n<s;){var l=t[n];r(l,n,t)&&(a[i++]=l)}return a}return Lf=e,Lf}var zf,g_;function FE(){if(g_)return zf;g_=1;function e(){return[]}return zf=e,zf}var Ff,x_;function gy(){if(x_)return Ff;x_=1;var e=zE(),t=FE(),r=Object.prototype,n=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,i=s?function(a){return a==null?[]:(a=Object(a),e(s(a),function(l){return n.call(a,l)}))}:t;return Ff=i,Ff}var $f,v_;function SD(){if(v_)return $f;v_=1;var e=Sa(),t=gy();function r(n,s){return e(n,t(n),s)}return $f=r,$f}var qf,y_;function xy(){if(y_)return qf;y_=1;function e(t,r){for(var n=-1,s=r.length,i=t.length;++n<s;)t[i+n]=r[n];return t}return qf=e,qf}var Bf,b_;function mu(){if(b_)return Bf;b_=1;var e=OE(),t=e(Object.getPrototypeOf,Object);return Bf=t,Bf}var Wf,__;function $E(){if(__)return Wf;__=1;var e=xy(),t=mu(),r=gy(),n=FE(),s=Object.getOwnPropertySymbols,i=s?function(a){for(var l=[];a;)e(l,r(a)),a=t(a);return l}:n;return Wf=i,Wf}var Hf,w_;function kD(){if(w_)return Hf;w_=1;var e=Sa(),t=$E();function r(n,s){return e(n,t(n),s)}return Hf=r,Hf}var Vf,j_;function qE(){if(j_)return Vf;j_=1;var e=xy(),t=lt();function r(n,s,i){var a=s(n);return t(n)?a:e(a,i(n))}return Vf=r,Vf}var Uf,S_;function BE(){if(S_)return Uf;S_=1;var e=qE(),t=gy(),r=ts();function n(s){return e(s,r,t)}return Uf=n,Uf}var Gf,k_;function ND(){if(k_)return Gf;k_=1;var e=qE(),t=$E(),r=Rs();function n(s){return e(s,r,t)}return Gf=n,Gf}var Kf,N_;function CD(){if(N_)return Kf;N_=1;var e=As(),t=Mr(),r=e(t,"DataView");return Kf=r,Kf}var Yf,C_;function ED(){if(C_)return Yf;C_=1;var e=As(),t=Mr(),r=e(t,"Promise");return Yf=r,Yf}var Xf,E_;function WE(){if(E_)return Xf;E_=1;var e=As(),t=Mr(),r=e(t,"Set");return Xf=r,Xf}var Qf,T_;function TD(){if(T_)return Qf;T_=1;var e=As(),t=Mr(),r=e(t,"WeakMap");return Qf=r,Qf}var Zf,A_;function Di(){if(A_)return Zf;A_=1;var e=CD(),t=uy(),r=ED(),n=WE(),s=TD(),i=Ts(),a=IE(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=a(e),v=a(t),g=a(r),_=a(n),x=a(s),y=i;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||r&&y(r.resolve())!=d||n&&y(new n)!=u||s&&y(new s)!=f)&&(y=function(b){var w=i(b),k=w==c?b.constructor:void 0,C=k?a(k):"";if(C)switch(C){case h:return p;case v:return l;case g:return d;case _:return u;case x:return f}return w}),Zf=y,Zf}var Jf,R_;function AD(){if(R_)return Jf;R_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var s=n.length,i=new n.constructor(s);return s&&typeof n[0]=="string"&&t.call(n,"index")&&(i.index=n.index,i.input=n.input),i}return Jf=r,Jf}var ep,I_;function HE(){if(I_)return ep;I_=1;var e=Mr(),t=e.Uint8Array;return ep=t,ep}var tp,P_;function vy(){if(P_)return tp;P_=1;var e=HE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return tp=t,tp}var rp,M_;function RD(){if(M_)return rp;M_=1;var e=vy();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.byteLength)}return rp=t,rp}var np,O_;function ID(){if(O_)return np;O_=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return np=t,np}var sp,D_;function PD(){if(D_)return sp;D_=1;var e=Mi(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(s){return r?Object(r.call(s)):{}}return sp=n,sp}var ip,L_;function VE(){if(L_)return ip;L_=1;var e=vy();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.length)}return ip=t,ip}var op,z_;function MD(){if(z_)return op;z_=1;var e=vy(),t=RD(),r=ID(),n=PD(),s=VE(),i="[object Boolean]",a="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",v="[object DataView]",g="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",w="[object Uint8Array]",k="[object Uint8ClampedArray]",C="[object Uint16Array]",N="[object Uint32Array]";function E(j,A,T){var D=j.constructor;switch(A){case h:return e(j);case i:case a:return new D(+j);case v:return t(j,T);case g:case _:case x:case y:case b:case w:case k:case C:case N:return s(j,T);case l:return new D;case c:case f:return new D(j);case d:return r(j);case u:return new D;case p:return n(j)}}return op=E,op}var ap,F_;function UE(){if(F_)return ap;F_=1;var e=yr(),t=Object.create,r=function(){function n(){}return function(s){if(!e(s))return{};if(t)return t(s);n.prototype=s;var i=new n;return n.prototype=void 0,i}}();return ap=r,ap}var lp,$_;function GE(){if($_)return lp;$_=1;var e=UE(),t=mu(),r=hu();function n(s){return typeof s.constructor=="function"&&!r(s)?e(t(s)):{}}return lp=n,lp}var cp,q_;function OD(){if(q_)return cp;q_=1;var e=Di(),t=Yr(),r="[object Map]";function n(s){return t(s)&&e(s)==r}return cp=n,cp}var up,B_;function DD(){if(B_)return up;B_=1;var e=OD(),t=pu(),r=hy(),n=r&&r.isMap,s=n?t(n):e;return up=s,up}var dp,W_;function LD(){if(W_)return dp;W_=1;var e=Di(),t=Yr(),r="[object Set]";function n(s){return t(s)&&e(s)==r}return dp=n,dp}var fp,H_;function zD(){if(H_)return fp;H_=1;var e=LD(),t=pu(),r=hy(),n=r&&r.isSet,s=n?t(n):e;return fp=s,fp}var pp,V_;function KE(){if(V_)return pp;V_=1;var e=cu(),t=fy(),r=du(),n=bD(),s=jD(),i=DE(),a=LE(),l=SD(),c=kD(),d=BE(),u=ND(),f=Di(),p=AD(),h=MD(),v=GE(),g=lt(),_=Oi(),x=DD(),y=yr(),b=zD(),w=ts(),k=Rs(),C=1,N=2,E=4,j="[object Arguments]",A="[object Array]",T="[object Boolean]",D="[object Date]",F="[object Error]",S="[object Function]",I="[object GeneratorFunction]",M="[object Map]",z="[object Number]",P="[object Object]",R="[object RegExp]",L="[object Set]",$="[object String]",q="[object Symbol]",Y="[object WeakMap]",K="[object ArrayBuffer]",H="[object DataView]",B="[object Float32Array]",X="[object Float64Array]",ie="[object Int8Array]",oe="[object Int16Array]",J="[object Int32Array]",we="[object Uint8Array]",ge="[object Uint8ClampedArray]",_e="[object Uint16Array]",xe="[object Uint32Array]",ae={};ae[j]=ae[A]=ae[K]=ae[H]=ae[T]=ae[D]=ae[B]=ae[X]=ae[ie]=ae[oe]=ae[J]=ae[M]=ae[z]=ae[P]=ae[R]=ae[L]=ae[$]=ae[q]=ae[we]=ae[ge]=ae[_e]=ae[xe]=!0,ae[F]=ae[S]=ae[Y]=!1;function U(re,te,je,se,fe,he){var Q,me=te&C,qe=te&N,Le=te&E;if(je&&(Q=fe?je(re,se,fe,he):je(re)),Q!==void 0)return Q;if(!y(re))return re;var Ce=g(re);if(Ce){if(Q=p(re),!me)return a(re,Q)}else{var Ee=f(re),Me=Ee==S||Ee==I;if(_(re))return i(re,me);if(Ee==P||Ee==j||Me&&!fe){if(Q=qe||Me?{}:v(re),!me)return qe?c(re,s(Q,re)):l(re,n(Q,re))}else{if(!ae[Ee])return fe?re:{};Q=h(re,Ee,me)}}he||(he=new e);var tt=he.get(re);if(tt)return tt;he.set(re,Q),b(re)?re.forEach(function(Te){Q.add(U(Te,te,je,Te,re,he))}):x(re)&&re.forEach(function(Te,ve){Q.set(ve,U(Te,te,je,ve,re,he))});var Ie=Le?qe?u:d:qe?k:w,Z=Ce?void 0:Ie(re);return t(Z||re,function(Te,ve){Z&&(ve=Te,Te=re[ve]),r(Q,ve,U(Te,te,je,ve,re,he))}),Q}return pp=U,pp}var hp,U_;function FD(){if(U_)return hp;U_=1;var e=KE(),t=4;function r(n){return e(n,t)}return hp=r,hp}var mp,G_;function yy(){if(G_)return mp;G_=1;function e(t){return function(){return t}}return mp=e,mp}var gp,K_;function $D(){if(K_)return gp;K_=1;function e(t){return function(r,n,s){for(var i=-1,a=Object(r),l=s(r),c=l.length;c--;){var d=l[t?c:++i];if(n(a[d],d,a)===!1)break}return r}}return gp=e,gp}var xp,Y_;function by(){if(Y_)return xp;Y_=1;var e=$D(),t=e();return xp=t,xp}var vp,X_;function _y(){if(X_)return vp;X_=1;var e=by(),t=ts();function r(n,s){return n&&e(n,s,t)}return vp=r,vp}var yp,Q_;function qD(){if(Q_)return yp;Q_=1;var e=yn();function t(r,n){return function(s,i){if(s==null)return s;if(!e(s))return r(s,i);for(var a=s.length,l=n?a:-1,c=Object(s);(n?l--:++l<a)&&i(c[l],l,c)!==!1;);return s}}return yp=t,yp}var bp,Z_;function gu(){if(Z_)return bp;Z_=1;var e=_y(),t=qD(),r=t(e);return bp=r,bp}var _p,J_;function Is(){if(J_)return _p;J_=1;function e(t){return t}return _p=e,_p}var wp,ew;function YE(){if(ew)return wp;ew=1;var e=Is();function t(r){return typeof r=="function"?r:e}return wp=t,wp}var jp,tw;function XE(){if(tw)return jp;tw=1;var e=fy(),t=gu(),r=YE(),n=lt();function s(i,a){var l=n(i)?e:t;return l(i,r(a))}return jp=s,jp}var Sp,rw;function QE(){return rw||(rw=1,Sp=XE()),Sp}var kp,nw;function BD(){if(nw)return kp;nw=1;var e=gu();function t(r,n){var s=[];return e(r,function(i,a,l){n(i,a,l)&&s.push(i)}),s}return kp=t,kp}var Np,sw;function WD(){if(sw)return Np;sw=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Np=t,Np}var Cp,iw;function HD(){if(iw)return Cp;iw=1;function e(t){return this.__data__.has(t)}return Cp=e,Cp}var Ep,ow;function ZE(){if(ow)return Ep;ow=1;var e=dy(),t=WD(),r=HD();function n(s){var i=-1,a=s==null?0:s.length;for(this.__data__=new e;++i<a;)this.add(s[i])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,Ep=n,Ep}var Tp,aw;function VD(){if(aw)return Tp;aw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s;)if(r(t[n],n,t))return!0;return!1}return Tp=e,Tp}var Ap,lw;function JE(){if(lw)return Ap;lw=1;function e(t,r){return t.has(r)}return Ap=e,Ap}var Rp,cw;function e4(){if(cw)return Rp;cw=1;var e=ZE(),t=VD(),r=JE(),n=1,s=2;function i(a,l,c,d,u,f){var p=c&n,h=a.length,v=l.length;if(h!=v&&!(p&&v>h))return!1;var g=f.get(a),_=f.get(l);if(g&&_)return g==l&&_==a;var x=-1,y=!0,b=c&s?new e:void 0;for(f.set(a,l),f.set(l,a);++x<h;){var w=a[x],k=l[x];if(d)var C=p?d(k,w,x,l,a,f):d(w,k,x,a,l,f);if(C!==void 0){if(C)continue;y=!1;break}if(b){if(!t(l,function(N,E){if(!r(b,E)&&(w===N||u(w,N,c,d,f)))return b.push(E)})){y=!1;break}}else if(!(w===k||u(w,k,c,d,f))){y=!1;break}}return f.delete(a),f.delete(l),y}return Rp=i,Rp}var Ip,uw;function UD(){if(uw)return Ip;uw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s,i){n[++r]=[i,s]}),n}return Ip=e,Ip}var Pp,dw;function wy(){if(dw)return Pp;dw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s){n[++r]=s}),n}return Pp=e,Pp}var Mp,fw;function GD(){if(fw)return Mp;fw=1;var e=Mi(),t=HE(),r=Pi(),n=e4(),s=UD(),i=wy(),a=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",v="[object Set]",g="[object String]",_="[object Symbol]",x="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,w=b?b.valueOf:void 0;function k(C,N,E,j,A,T,D){switch(E){case y:if(C.byteLength!=N.byteLength||C.byteOffset!=N.byteOffset)return!1;C=C.buffer,N=N.buffer;case x:return!(C.byteLength!=N.byteLength||!T(new t(C),new t(N)));case c:case d:case p:return r(+C,+N);case u:return C.name==N.name&&C.message==N.message;case h:case g:return C==N+"";case f:var F=s;case v:var S=j&a;if(F||(F=i),C.size!=N.size&&!S)return!1;var I=D.get(C);if(I)return I==N;j|=l,D.set(C,N);var M=n(F(C),F(N),j,A,T,D);return D.delete(C),M;case _:if(w)return w.call(C)==w.call(N)}return!1}return Mp=k,Mp}var Op,pw;function KD(){if(pw)return Op;pw=1;var e=BE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function s(i,a,l,c,d,u){var f=l&t,p=e(i),h=p.length,v=e(a),g=v.length;if(h!=g&&!f)return!1;for(var _=h;_--;){var x=p[_];if(!(f?x in a:n.call(a,x)))return!1}var y=u.get(i),b=u.get(a);if(y&&b)return y==a&&b==i;var w=!0;u.set(i,a),u.set(a,i);for(var k=f;++_<h;){x=p[_];var C=i[x],N=a[x];if(c)var E=f?c(N,C,x,a,i,u):c(C,N,x,i,a,u);if(!(E===void 0?C===N||d(C,N,l,c,u):E)){w=!1;break}k||(k=x=="constructor")}if(w&&!k){var j=i.constructor,A=a.constructor;j!=A&&"constructor"in i&&"constructor"in a&&!(typeof j=="function"&&j instanceof j&&typeof A=="function"&&A instanceof A)&&(w=!1)}return u.delete(i),u.delete(a),w}return Op=s,Op}var Dp,hw;function YD(){if(hw)return Dp;hw=1;var e=cu(),t=e4(),r=GD(),n=KD(),s=Di(),i=lt(),a=Oi(),l=Na(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function v(g,_,x,y,b,w){var k=i(g),C=i(_),N=k?u:s(g),E=C?u:s(_);N=N==d?f:N,E=E==d?f:E;var j=N==f,A=E==f,T=N==E;if(T&&a(g)){if(!a(_))return!1;k=!0,j=!1}if(T&&!j)return w||(w=new e),k||l(g)?t(g,_,x,y,b,w):r(g,_,N,x,y,b,w);if(!(x&c)){var D=j&&h.call(g,"__wrapped__"),F=A&&h.call(_,"__wrapped__");if(D||F){var S=D?g.value():g,I=F?_.value():_;return w||(w=new e),b(S,I,x,y,w)}}return T?(w||(w=new e),n(g,_,x,y,b,w)):!1}return Dp=v,Dp}var Lp,mw;function t4(){if(mw)return Lp;mw=1;var e=YD(),t=Yr();function r(n,s,i,a,l){return n===s?!0:n==null||s==null||!t(n)&&!t(s)?n!==n&&s!==s:e(n,s,i,a,r,l)}return Lp=r,Lp}var zp,gw;function XD(){if(gw)return zp;gw=1;var e=cu(),t=t4(),r=1,n=2;function s(i,a,l,c){var d=l.length,u=d,f=!c;if(i==null)return!u;for(i=Object(i);d--;){var p=l[d];if(f&&p[2]?p[1]!==i[p[0]]:!(p[0]in i))return!1}for(;++d<u;){p=l[d];var h=p[0],v=i[h],g=p[1];if(f&&p[2]){if(v===void 0&&!(h in i))return!1}else{var _=new e;if(c)var x=c(v,g,h,i,a,_);if(!(x===void 0?t(g,v,r|n,c,_):x))return!1}}return!0}return zp=s,zp}var Fp,xw;function r4(){if(xw)return Fp;xw=1;var e=yr();function t(r){return r===r&&!e(r)}return Fp=t,Fp}var $p,vw;function QD(){if(vw)return $p;vw=1;var e=r4(),t=ts();function r(n){for(var s=t(n),i=s.length;i--;){var a=s[i],l=n[a];s[i]=[a,l,e(l)]}return s}return $p=r,$p}var qp,yw;function n4(){if(yw)return qp;yw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return qp=e,qp}var Bp,bw;function ZD(){if(bw)return Bp;bw=1;var e=XD(),t=QD(),r=n4();function n(s){var i=t(s);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(a){return a===s||e(a,s,i)}}return Bp=n,Bp}var Wp,_w;function Li(){if(_w)return Wp;_w=1;var e=Ts(),t=Yr(),r="[object Symbol]";function n(s){return typeof s=="symbol"||t(s)&&e(s)==r}return Wp=n,Wp}var Hp,ww;function jy(){if(ww)return Hp;ww=1;var e=lt(),t=Li(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(i,a){if(e(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||t(i)?!0:n.test(i)||!r.test(i)||a!=null&&i in Object(a)}return Hp=s,Hp}var Vp,jw;function JD(){if(jw)return Vp;jw=1;var e=dy(),t="Expected a function";function r(n,s){if(typeof n!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var i=function(){var a=arguments,l=s?s.apply(this,a):a[0],c=i.cache;if(c.has(l))return c.get(l);var d=n.apply(this,a);return i.cache=c.set(l,d)||c,d};return i.cache=new(r.Cache||e),i}return r.Cache=e,Vp=r,Vp}var Up,Sw;function eL(){if(Sw)return Up;Sw=1;var e=JD(),t=500;function r(n){var s=e(n,function(a){return i.size===t&&i.clear(),a}),i=s.cache;return s}return Up=r,Up}var Gp,kw;function tL(){if(kw)return Gp;kw=1;var e=eL(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(s){var i=[];return s.charCodeAt(0)===46&&i.push(""),s.replace(t,function(a,l,c,d){i.push(c?d.replace(r,"$1"):l||a)}),i});return Gp=n,Gp}var Kp,Nw;function xu(){if(Nw)return Kp;Nw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,i=Array(s);++n<s;)i[n]=r(t[n],n,t);return i}return Kp=e,Kp}var Yp,Cw;function rL(){if(Cw)return Yp;Cw=1;var e=Mi(),t=xu(),r=lt(),n=Li(),s=e?e.prototype:void 0,i=s?s.toString:void 0;function a(l){if(typeof l=="string")return l;if(r(l))return t(l,a)+"";if(n(l))return i?i.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Yp=a,Yp}var Xp,Ew;function s4(){if(Ew)return Xp;Ew=1;var e=rL();function t(r){return r==null?"":e(r)}return Xp=t,Xp}var Qp,Tw;function vu(){if(Tw)return Qp;Tw=1;var e=lt(),t=jy(),r=tL(),n=s4();function s(i,a){return e(i)?i:t(i,a)?[i]:r(n(i))}return Qp=s,Qp}var Zp,Aw;function Ca(){if(Aw)return Zp;Aw=1;var e=Li();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Zp=t,Zp}var Jp,Rw;function yu(){if(Rw)return Jp;Rw=1;var e=vu(),t=Ca();function r(n,s){s=e(s,n);for(var i=0,a=s.length;n!=null&&i<a;)n=n[t(s[i++])];return i&&i==a?n:void 0}return Jp=r,Jp}var eh,Iw;function nL(){if(Iw)return eh;Iw=1;var e=yu();function t(r,n,s){var i=r==null?void 0:e(r,n);return i===void 0?s:i}return eh=t,eh}var th,Pw;function sL(){if(Pw)return th;Pw=1;function e(t,r){return t!=null&&r in Object(t)}return th=e,th}var rh,Mw;function i4(){if(Mw)return rh;Mw=1;var e=vu(),t=ka(),r=lt(),n=fu(),s=py(),i=Ca();function a(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=i(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&s(f)&&n(h,f)&&(r(l)||t(l)))}return rh=a,rh}var nh,Ow;function o4(){if(Ow)return nh;Ow=1;var e=sL(),t=i4();function r(n,s){return n!=null&&t(n,s,e)}return nh=r,nh}var sh,Dw;function iL(){if(Dw)return sh;Dw=1;var e=t4(),t=nL(),r=o4(),n=jy(),s=r4(),i=n4(),a=Ca(),l=1,c=2;function d(u,f){return n(u)&&s(f)?i(a(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?r(p,u):e(f,h,l|c)}}return sh=d,sh}var ih,Lw;function a4(){if(Lw)return ih;Lw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return ih=e,ih}var oh,zw;function oL(){if(zw)return oh;zw=1;var e=yu();function t(r){return function(n){return e(n,r)}}return oh=t,oh}var ah,Fw;function aL(){if(Fw)return ah;Fw=1;var e=a4(),t=oL(),r=jy(),n=Ca();function s(i){return r(i)?e(n(i)):t(i)}return ah=s,ah}var lh,$w;function bn(){if($w)return lh;$w=1;var e=ZD(),t=iL(),r=Is(),n=lt(),s=aL();function i(a){return typeof a=="function"?a:a==null?r:typeof a=="object"?n(a)?t(a[0],a[1]):e(a):s(a)}return lh=i,lh}var ch,qw;function l4(){if(qw)return ch;qw=1;var e=zE(),t=BD(),r=bn(),n=lt();function s(i,a){var l=n(i)?e:t;return l(i,r(a,3))}return ch=s,ch}var uh,Bw;function lL(){if(Bw)return uh;Bw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,s){return n!=null&&t.call(n,s)}return uh=r,uh}var dh,Ww;function c4(){if(Ww)return dh;Ww=1;var e=lL(),t=i4();function r(n,s){return n!=null&&t(n,s,e)}return dh=r,dh}var fh,Hw;function cL(){if(Hw)return fh;Hw=1;var e=my(),t=Di(),r=ka(),n=lt(),s=yn(),i=Oi(),a=hu(),l=Na(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(s(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||i(h)||l(h)||r(h)))return!h.length;var v=t(h);if(v==c||v==d)return!h.size;if(a(h))return!e(h).length;for(var g in h)if(f.call(h,g))return!1;return!0}return fh=p,fh}var ph,Vw;function u4(){if(Vw)return ph;Vw=1;function e(t){return t===void 0}return ph=e,ph}var hh,Uw;function d4(){if(Uw)return hh;Uw=1;var e=gu(),t=yn();function r(n,s){var i=-1,a=t(n)?Array(n.length):[];return e(n,function(l,c,d){a[++i]=s(l,c,d)}),a}return hh=r,hh}var mh,Gw;function f4(){if(Gw)return mh;Gw=1;var e=xu(),t=bn(),r=d4(),n=lt();function s(i,a){var l=n(i)?e:r;return l(i,t(a,3))}return mh=s,mh}var gh,Kw;function uL(){if(Kw)return gh;Kw=1;function e(t,r,n,s){var i=-1,a=t==null?0:t.length;for(s&&a&&(n=t[++i]);++i<a;)n=r(n,t[i],i,t);return n}return gh=e,gh}var xh,Yw;function dL(){if(Yw)return xh;Yw=1;function e(t,r,n,s,i){return i(t,function(a,l,c){n=s?(s=!1,a):r(n,a,l,c)}),n}return xh=e,xh}var vh,Xw;function p4(){if(Xw)return vh;Xw=1;var e=uL(),t=gu(),r=bn(),n=dL(),s=lt();function i(a,l,c){var d=s(a)?e:n,u=arguments.length<3;return d(a,r(l,4),c,u,t)}return vh=i,vh}var yh,Qw;function fL(){if(Qw)return yh;Qw=1;var e=Ts(),t=lt(),r=Yr(),n="[object String]";function s(i){return typeof i=="string"||!t(i)&&r(i)&&e(i)==n}return yh=s,yh}var bh,Zw;function pL(){if(Zw)return bh;Zw=1;var e=a4(),t=e("length");return bh=t,bh}var _h,Jw;function hL(){if(Jw)return _h;Jw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,i="\\ufe0e\\ufe0f",a="\\u200d",l=RegExp("["+a+e+s+i+"]");function c(d){return l.test(d)}return _h=c,_h}var wh,ej;function mL(){if(ej)return wh;ej=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,i="\\ufe0e\\ufe0f",a="["+e+"]",l="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",v=d+"?",g="["+i+"]?",_="(?:"+h+"(?:"+[u,f,p].join("|")+")"+g+v+")*",x=g+v+_,y="(?:"+[u+l+"?",l,f,p,a].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+x,"g");function w(k){for(var C=b.lastIndex=0;b.test(k);)++C;return C}return wh=w,wh}var jh,tj;function gL(){if(tj)return jh;tj=1;var e=pL(),t=hL(),r=mL();function n(s){return t(s)?r(s):e(s)}return jh=n,jh}var Sh,rj;function xL(){if(rj)return Sh;rj=1;var e=my(),t=Di(),r=yn(),n=fL(),s=gL(),i="[object Map]",a="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?s(c):c.length;var d=t(c);return d==i||d==a?c.size:e(c).length}return Sh=l,Sh}var kh,nj;function vL(){if(nj)return kh;nj=1;var e=fy(),t=UE(),r=_y(),n=bn(),s=mu(),i=lt(),a=Oi(),l=ja(),c=yr(),d=Na();function u(f,p,h){var v=i(f),g=v||a(f)||d(f);if(p=n(p,4),h==null){var _=f&&f.constructor;g?h=v?new _:[]:c(f)?h=l(_)?t(s(f)):{}:h={}}return(g?e:r)(f,function(x,y,b){return p(h,x,y,b)}),h}return kh=u,kh}var Nh,sj;function yL(){if(sj)return Nh;sj=1;var e=Mi(),t=ka(),r=lt(),n=e?e.isConcatSpreadable:void 0;function s(i){return r(i)||t(i)||!!(n&&i&&i[n])}return Nh=s,Nh}var Ch,ij;function Sy(){if(ij)return Ch;ij=1;var e=xy(),t=yL();function r(n,s,i,a,l){var c=-1,d=n.length;for(i||(i=t),l||(l=[]);++c<d;){var u=n[c];s>0&&i(u)?s>1?r(u,s-1,i,a,l):e(l,u):a||(l[l.length]=u)}return l}return Ch=r,Ch}var Eh,oj;function bL(){if(oj)return Eh;oj=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Eh=e,Eh}var Th,aj;function h4(){if(aj)return Th;aj=1;var e=bL(),t=Math.max;function r(n,s,i){return s=t(s===void 0?n.length-1:s,0),function(){for(var a=arguments,l=-1,c=t(a.length-s,0),d=Array(c);++l<c;)d[l]=a[s+l];l=-1;for(var u=Array(s+1);++l<s;)u[l]=a[l];return u[s]=i(d),e(n,this,u)}}return Th=r,Th}var Ah,lj;function _L(){if(lj)return Ah;lj=1;var e=yy(),t=PE(),r=Is(),n=t?function(s,i){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:r;return Ah=n,Ah}var Rh,cj;function wL(){if(cj)return Rh;cj=1;var e=800,t=16,r=Date.now;function n(s){var i=0,a=0;return function(){var l=r(),c=t-(l-a);if(a=l,c>0){if(++i>=e)return arguments[0]}else i=0;return s.apply(void 0,arguments)}}return Rh=n,Rh}var Ih,uj;function m4(){if(uj)return Ih;uj=1;var e=_L(),t=wL(),r=t(e);return Ih=r,Ih}var Ph,dj;function bu(){if(dj)return Ph;dj=1;var e=Is(),t=h4(),r=m4();function n(s,i){return r(t(s,i,e),s+"")}return Ph=n,Ph}var Mh,fj;function g4(){if(fj)return Mh;fj=1;function e(t,r,n,s){for(var i=t.length,a=n+(s?1:-1);s?a--:++a<i;)if(r(t[a],a,t))return a;return-1}return Mh=e,Mh}var Oh,pj;function jL(){if(pj)return Oh;pj=1;function e(t){return t!==t}return Oh=e,Oh}var Dh,hj;function SL(){if(hj)return Dh;hj=1;function e(t,r,n){for(var s=n-1,i=t.length;++s<i;)if(t[s]===r)return s;return-1}return Dh=e,Dh}var Lh,mj;function kL(){if(mj)return Lh;mj=1;var e=g4(),t=jL(),r=SL();function n(s,i,a){return i===i?r(s,i,a):e(s,t,a)}return Lh=n,Lh}var zh,gj;function NL(){if(gj)return zh;gj=1;var e=kL();function t(r,n){var s=r==null?0:r.length;return!!s&&e(r,n,0)>-1}return zh=t,zh}var Fh,xj;function CL(){if(xj)return Fh;xj=1;function e(t,r,n){for(var s=-1,i=t==null?0:t.length;++s<i;)if(n(r,t[s]))return!0;return!1}return Fh=e,Fh}var $h,vj;function EL(){if(vj)return $h;vj=1;function e(){}return $h=e,$h}var qh,yj;function TL(){if(yj)return qh;yj=1;var e=WE(),t=EL(),r=wy(),n=1/0,s=e&&1/r(new e([,-0]))[1]==n?function(i){return new e(i)}:t;return qh=s,qh}var Bh,bj;function AL(){if(bj)return Bh;bj=1;var e=ZE(),t=NL(),r=CL(),n=JE(),s=TL(),i=wy(),a=200;function l(c,d,u){var f=-1,p=t,h=c.length,v=!0,g=[],_=g;if(u)v=!1,p=r;else if(h>=a){var x=d?null:s(c);if(x)return i(x);v=!1,p=n,_=new e}else _=d?[]:g;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,v&&b===b){for(var w=_.length;w--;)if(_[w]===b)continue e;d&&_.push(b),g.push(y)}else p(_,b,u)||(_!==g&&_.push(b),g.push(y))}return g}return Bh=l,Bh}var Wh,_j;function x4(){if(_j)return Wh;_j=1;var e=yn(),t=Yr();function r(n){return t(n)&&e(n)}return Wh=r,Wh}var Hh,wj;function RL(){if(wj)return Hh;wj=1;var e=Sy(),t=bu(),r=AL(),n=x4(),s=t(function(i){return r(e(i,1,n,!0))});return Hh=s,Hh}var Vh,jj;function IL(){if(jj)return Vh;jj=1;var e=xu();function t(r,n){return e(n,function(s){return r[s]})}return Vh=t,Vh}var Uh,Sj;function v4(){if(Sj)return Uh;Sj=1;var e=IL(),t=ts();function r(n){return n==null?[]:e(n,t(n))}return Uh=r,Uh}var Gh,kj;function br(){if(kj)return Gh;kj=1;var e;if(typeof cy=="function")try{e={clone:FD(),constant:yy(),each:QE(),filter:l4(),has:c4(),isArray:lt(),isEmpty:cL(),isFunction:ja(),isUndefined:u4(),keys:ts(),map:f4(),reduce:p4(),size:xL(),transform:vL(),union:RL(),values:v4()}}catch{}return e||(e=window._),Gh=e,Gh}var Kh,Nj;function ky(){if(Nj)return Kh;Nj=1;var e=br();Kh=s;var t="\0",r="\0",n="";function s(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(u){return this._label=u,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},s.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},s.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(v){p.length>1?h.setNode(v,f):h.setNode(v)}),this},s.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=r,this._children[u]={},this._children[r][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},s.prototype.node=function(u){return this._nodes[u]},s.prototype.hasNode=function(u){return e.has(this._nodes,u)},s.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},s.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},s.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},s.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==r)return f}},s.prototype.children=function(u){if(e.isUndefined(u)&&(u=r),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===r)return this.nodes();if(this.hasNode(u))return[]}},s.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},s.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},s.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},s.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},s.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(g,_){u(_)&&f.setNode(_,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,p.edge(g))});var h={};function v(g){var _=p.parent(g);return _===void 0||f.hasNode(_)?(h[g]=_,_):_ in h?h[_]:v(_)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,v(g))}),f},s.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(v,g){return h.length>1?p.setEdge(v,g,f):p.setEdge(v,g),g}),this},s.prototype.setEdge=function(){var u,f,p,h,v=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(u=g.v,f=g.w,p=g.name,arguments.length===2&&(h=arguments[1],v=!0)):(u=g,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],v=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var _=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,_))return v&&(this._edgeLabels[_]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[_]=v?h:this._defaultEdgeLabelFn(u,f,p);var x=c(this._isDirected,u,f,p);return u=x.v,f=x.w,Object.freeze(x),this._edgeObjs[_]=x,i(this._preds[f],u),i(this._sucs[u],f),this._in[f][_]=x,this._out[u][_]=x,this._edgeCount++,this},s.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},s.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),v=this._edgeObjs[h];return v&&(u=v.v,f=v.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[f],u),a(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},s.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.v===f}):h}},s.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.w===f}):h}},s.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function i(u,f){u[f]?u[f]++:u[f]=1}function a(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var v=""+f,g=""+p;if(!u&&v>g){var _=v;v=g,g=_}return v+n+g+n+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var v=""+f,g=""+p;if(!u&&v>g){var _=v;v=g,g=_}var x={v,w:g};return h&&(x.name=h),x}function d(u,f){return l(u,f.v,f.w,f.name)}return Kh}var Yh,Cj;function PL(){return Cj||(Cj=1,Yh="2.1.8"),Yh}var Xh,Ej;function ML(){return Ej||(Ej=1,Xh={Graph:ky(),version:PL()}),Xh}var Qh,Tj;function OL(){if(Tj)return Qh;Tj=1;var e=br(),t=ky();Qh={write:r,read:i};function r(a){var l={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:n(a),edges:s(a)};return e.isUndefined(a.graph())||(l.value=e.clone(a.graph())),l}function n(a){return e.map(a.nodes(),function(l){var c=a.node(l),d=a.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function s(a){return e.map(a.edges(),function(l){var c=a.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function i(a){var l=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(a.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Qh}var Zh,Aj;function DL(){if(Aj)return Zh;Aj=1;var e=br();Zh=t;function t(r){var n={},s=[],i;function a(l){e.has(n,l)||(n[l]=!0,i.push(l),e.each(r.successors(l),a),e.each(r.predecessors(l),a))}return e.each(r.nodes(),function(l){i=[],a(l),i.length&&s.push(i)}),s}return Zh}var Jh,Rj;function y4(){if(Rj)return Jh;Rj=1;var e=br();Jh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var s=this._keyIndices;if(r=String(r),!e.has(s,r)){var i=this._arr,a=i.length;return s[r]=a,i.push({key:r,priority:n}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var s=this._keyIndices[r];if(n>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[s].priority+" New: "+n);this._arr[s].priority=n,this._decrease(s)},t.prototype._heapify=function(r){var n=this._arr,s=2*r,i=s+1,a=r;s<n.length&&(a=n[s].priority<n[a].priority?s:a,i<n.length&&(a=n[i].priority<n[a].priority?i:a),a!==r&&(this._swap(r,a),this._heapify(a)))},t.prototype._decrease=function(r){for(var n=this._arr,s=n[r].priority,i;r!==0&&(i=r>>1,!(n[i].priority<s));)this._swap(r,i),r=i},t.prototype._swap=function(r,n){var s=this._arr,i=this._keyIndices,a=s[r],l=s[n];s[r]=l,s[n]=a,i[l.key]=r,i[a.key]=n},Jh}var em,Ij;function b4(){if(Ij)return em;Ij=1;var e=br(),t=y4();em=n;var r=e.constant(1);function n(i,a,l,c){return s(i,String(a),l||r,c||function(d){return i.outEdges(d)})}function s(i,a,l,c){var d={},u=new t,f,p,h=function(v){var g=v.v!==f?v.v:v.w,_=d[g],x=l(v),y=p.distance+x;if(x<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+x);y<_.distance&&(_.distance=y,_.predecessor=f,u.decrease(g,y))};for(i.nodes().forEach(function(v){var g=v===a?0:Number.POSITIVE_INFINITY;d[v]={distance:g},u.add(v,g)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return em}var tm,Pj;function LL(){if(Pj)return tm;Pj=1;var e=b4(),t=br();tm=r;function r(n,s,i){return t.transform(n.nodes(),function(a,l){a[l]=e(n,l,s,i)},{})}return tm}var rm,Mj;function _4(){if(Mj)return rm;Mj=1;var e=br();rm=t;function t(r){var n=0,s=[],i={},a=[];function l(c){var d=i[c]={onStack:!0,lowlink:n,index:n++};if(s.push(c),r.successors(c).forEach(function(p){e.has(i,p)?i[p].onStack&&(d.lowlink=Math.min(d.lowlink,i[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,i[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=s.pop(),i[f].onStack=!1,u.push(f);while(c!==f);a.push(u)}}return r.nodes().forEach(function(c){e.has(i,c)||l(c)}),a}return rm}var nm,Oj;function zL(){if(Oj)return nm;Oj=1;var e=br(),t=_4();nm=r;function r(n){return e.filter(t(n),function(s){return s.length>1||s.length===1&&n.hasEdge(s[0],s[0])})}return nm}var sm,Dj;function FL(){if(Dj)return sm;Dj=1;var e=br();sm=r;var t=e.constant(1);function r(s,i,a){return n(s,i||t,a||function(l){return s.outEdges(l)})}function n(s,i,a){var l={},c=s.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),a(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=i(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var v=p[d],g=u[h],_=p[h],x=v.distance+g.distance;x<_.distance&&(_.distance=x,_.predecessor=g.predecessor)})})}),l}return sm}var im,Lj;function w4(){if(Lj)return im;Lj=1;var e=br();im=t,t.CycleException=r;function t(n){var s={},i={},a=[];function l(c){if(e.has(i,c))throw new r;e.has(s,c)||(i[c]=!0,s[c]=!0,e.each(n.predecessors(c),l),delete i[c],a.push(c))}if(e.each(n.sinks(),l),e.size(s)!==n.nodeCount())throw new r;return a}function r(){}return r.prototype=new Error,im}var om,zj;function $L(){if(zj)return om;zj=1;var e=w4();om=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return om}var am,Fj;function j4(){if(Fj)return am;Fj=1;var e=br();am=t;function t(n,s,i){e.isArray(s)||(s=[s]);var a=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(s,function(d){if(!n.hasNode(d))throw new Error("Graph does not have node: "+d);r(n,d,i==="post",c,a,l)}),l}function r(n,s,i,a,l,c){e.has(a,s)||(a[s]=!0,i||c.push(s),e.each(l(s),function(d){r(n,d,i,a,l,c)}),i&&c.push(s))}return am}var lm,$j;function qL(){if($j)return lm;$j=1;var e=j4();lm=t;function t(r,n){return e(r,n,"post")}return lm}var cm,qj;function BL(){if(qj)return cm;qj=1;var e=j4();cm=t;function t(r,n){return e(r,n,"pre")}return cm}var um,Bj;function WL(){if(Bj)return um;Bj=1;var e=br(),t=ky(),r=y4();um=n;function n(s,i){var a=new t,l={},c=new r,d;function u(p){var h=p.v===d?p.w:p.v,v=c.priority(h);if(v!==void 0){var g=i(p);g<v&&(l[h]=d,c.decrease(h,g))}}if(s.nodeCount()===0)return a;e.each(s.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),a.setNode(p)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))a.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(d).forEach(u)}return a}return um}var dm,Wj;function HL(){return Wj||(Wj=1,dm={components:DL(),dijkstra:b4(),dijkstraAll:LL(),findCycles:zL(),floydWarshall:FL(),isAcyclic:$L(),postorder:qL(),preorder:BL(),prim:WL(),tarjan:_4(),topsort:w4()}),dm}var fm,Hj;function VL(){if(Hj)return fm;Hj=1;var e=ML();return fm={Graph:e.Graph,json:OL(),alg:HL(),version:e.version},fm}var mc;if(typeof cy=="function")try{mc=VL()}catch{}mc||(mc=window.graphlib);var Or=mc,pm,Vj;function UL(){if(Vj)return pm;Vj=1;var e=KE(),t=1,r=4;function n(s){return e(s,t|r)}return pm=n,pm}var hm,Uj;function _u(){if(Uj)return hm;Uj=1;var e=Pi(),t=yn(),r=fu(),n=yr();function s(i,a,l){if(!n(l))return!1;var c=typeof a;return(c=="number"?t(l)&&r(a,l.length):c=="string"&&a in l)?e(l[a],i):!1}return hm=s,hm}var mm,Gj;function GL(){if(Gj)return mm;Gj=1;var e=bu(),t=Pi(),r=_u(),n=Rs(),s=Object.prototype,i=s.hasOwnProperty,a=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=n(p),v=-1,g=h.length;++v<g;){var _=h[v],x=l[_];(x===void 0||t(x,s[_])&&!i.call(l,_))&&(l[_]=p[_])}return l});return mm=a,mm}var gm,Kj;function KL(){if(Kj)return gm;Kj=1;var e=bn(),t=yn(),r=ts();function n(s){return function(i,a,l){var c=Object(i);if(!t(i)){var d=e(a,3);i=r(i),a=function(f){return d(c[f],f,c)}}var u=s(i,a,l);return u>-1?c[d?i[u]:u]:void 0}}return gm=n,gm}var xm,Yj;function YL(){if(Yj)return xm;Yj=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return xm=t,xm}var vm,Xj;function XL(){if(Xj)return vm;Xj=1;var e=YL(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return vm=r,vm}var ym,Qj;function QL(){if(Qj)return ym;Qj=1;var e=XL(),t=yr(),r=Li(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return n;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=i.test(d);return f||a.test(d)?l(d.slice(2),f?2:8):s.test(d)?n:+d}return ym=c,ym}var bm,Zj;function S4(){if(Zj)return bm;Zj=1;var e=QL(),t=1/0,r=17976931348623157e292;function n(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var i=s<0?-1:1;return i*r}return s===s?s:0}return bm=n,bm}var _m,Jj;function ZL(){if(Jj)return _m;Jj=1;var e=S4();function t(r){var n=e(r),s=n%1;return n===n?s?n-s:n:0}return _m=t,_m}var wm,e2;function JL(){if(e2)return wm;e2=1;var e=g4(),t=bn(),r=ZL(),n=Math.max;function s(i,a,l){var c=i==null?0:i.length;if(!c)return-1;var d=l==null?0:r(l);return d<0&&(d=n(c+d,0)),e(i,t(a,3),d)}return wm=s,wm}var jm,t2;function ez(){if(t2)return jm;t2=1;var e=KL(),t=JL(),r=e(t);return jm=r,jm}var Sm,r2;function k4(){if(r2)return Sm;r2=1;var e=Sy();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return Sm=t,Sm}var km,n2;function tz(){if(n2)return km;n2=1;var e=by(),t=YE(),r=Rs();function n(s,i){return s==null?s:e(s,t(i),r)}return km=n,km}var Nm,s2;function rz(){if(s2)return Nm;s2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Nm=e,Nm}var Cm,i2;function nz(){if(i2)return Cm;i2=1;var e=uu(),t=_y(),r=bn();function n(s,i){var a={};return i=r(i,3),t(s,function(l,c,d){e(a,c,i(l,c,d))}),a}return Cm=n,Cm}var Em,o2;function Ny(){if(o2)return Em;o2=1;var e=Li();function t(r,n,s){for(var i=-1,a=r.length;++i<a;){var l=r[i],c=n(l);if(c!=null&&(d===void 0?c===c&&!e(c):s(c,d)))var d=c,u=l}return u}return Em=t,Em}var Tm,a2;function sz(){if(a2)return Tm;a2=1;function e(t,r){return t>r}return Tm=e,Tm}var Am,l2;function iz(){if(l2)return Am;l2=1;var e=Ny(),t=sz(),r=Is();function n(s){return s&&s.length?e(s,r,t):void 0}return Am=n,Am}var Rm,c2;function N4(){if(c2)return Rm;c2=1;var e=uu(),t=Pi();function r(n,s,i){(i!==void 0&&!t(n[s],i)||i===void 0&&!(s in n))&&e(n,s,i)}return Rm=r,Rm}var Im,u2;function oz(){if(u2)return Im;u2=1;var e=Ts(),t=mu(),r=Yr(),n="[object Object]",s=Function.prototype,i=Object.prototype,a=s.toString,l=i.hasOwnProperty,c=a.call(Object);function d(u){if(!r(u)||e(u)!=n)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&a.call(p)==c}return Im=d,Im}var Pm,d2;function C4(){if(d2)return Pm;d2=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Pm=e,Pm}var Mm,f2;function az(){if(f2)return Mm;f2=1;var e=Sa(),t=Rs();function r(n){return e(n,t(n))}return Mm=r,Mm}var Om,p2;function lz(){if(p2)return Om;p2=1;var e=N4(),t=DE(),r=VE(),n=LE(),s=GE(),i=ka(),a=lt(),l=x4(),c=Oi(),d=ja(),u=yr(),f=oz(),p=Na(),h=C4(),v=az();function g(_,x,y,b,w,k,C){var N=h(_,y),E=h(x,y),j=C.get(E);if(j){e(_,y,j);return}var A=k?k(N,E,y+"",_,x,C):void 0,T=A===void 0;if(T){var D=a(E),F=!D&&c(E),S=!D&&!F&&p(E);A=E,D||F||S?a(N)?A=N:l(N)?A=n(N):F?(T=!1,A=t(E,!0)):S?(T=!1,A=r(E,!0)):A=[]:f(E)||i(E)?(A=N,i(N)?A=v(N):(!u(N)||d(N))&&(A=s(E))):T=!1}T&&(C.set(E,A),w(A,E,b,k,C),C.delete(E)),e(_,y,A)}return Om=g,Om}var Dm,h2;function cz(){if(h2)return Dm;h2=1;var e=cu(),t=N4(),r=by(),n=lz(),s=yr(),i=Rs(),a=C4();function l(c,d,u,f,p){c!==d&&r(d,function(h,v){if(p||(p=new e),s(h))n(c,d,v,u,l,f,p);else{var g=f?f(a(c,v),h,v+"",c,d,p):void 0;g===void 0&&(g=h),t(c,v,g)}},i)}return Dm=l,Dm}var Lm,m2;function uz(){if(m2)return Lm;m2=1;var e=bu(),t=_u();function r(n){return e(function(s,i){var a=-1,l=i.length,c=l>1?i[l-1]:void 0,d=l>2?i[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(i[0],i[1],d)&&(c=l<3?void 0:c,l=1),s=Object(s);++a<l;){var u=i[a];u&&n(s,u,a,c)}return s})}return Lm=r,Lm}var zm,g2;function dz(){if(g2)return zm;g2=1;var e=cz(),t=uz(),r=t(function(n,s,i){e(n,s,i)});return zm=r,zm}var Fm,x2;function E4(){if(x2)return Fm;x2=1;function e(t,r){return t<r}return Fm=e,Fm}var $m,v2;function fz(){if(v2)return $m;v2=1;var e=Ny(),t=E4(),r=Is();function n(s){return s&&s.length?e(s,r,t):void 0}return $m=n,$m}var qm,y2;function pz(){if(y2)return qm;y2=1;var e=Ny(),t=bn(),r=E4();function n(s,i){return s&&s.length?e(s,t(i,2),r):void 0}return qm=n,qm}var Bm,b2;function hz(){if(b2)return Bm;b2=1;var e=Mr(),t=function(){return e.Date.now()};return Bm=t,Bm}var Wm,_2;function mz(){if(_2)return Wm;_2=1;var e=du(),t=vu(),r=fu(),n=yr(),s=Ca();function i(a,l,c,d){if(!n(a))return a;l=t(l,a);for(var u=-1,f=l.length,p=f-1,h=a;h!=null&&++u<f;){var v=s(l[u]),g=c;if(v==="__proto__"||v==="constructor"||v==="prototype")return a;if(u!=p){var _=h[v];g=d?d(_,v,h):void 0,g===void 0&&(g=n(_)?_:r(l[u+1])?[]:{})}e(h,v,g),h=h[v]}return a}return Wm=i,Wm}var Hm,w2;function gz(){if(w2)return Hm;w2=1;var e=yu(),t=mz(),r=vu();function n(s,i,a){for(var l=-1,c=i.length,d={};++l<c;){var u=i[l],f=e(s,u);a(f,u)&&t(d,r(u,s),f)}return d}return Hm=n,Hm}var Vm,j2;function xz(){if(j2)return Vm;j2=1;var e=gz(),t=o4();function r(n,s){return e(n,s,function(i,a){return t(n,a)})}return Vm=r,Vm}var Um,S2;function vz(){if(S2)return Um;S2=1;var e=k4(),t=h4(),r=m4();function n(s){return r(t(s,void 0,e),s+"")}return Um=n,Um}var Gm,k2;function yz(){if(k2)return Gm;k2=1;var e=xz(),t=vz(),r=t(function(n,s){return n==null?{}:e(n,s)});return Gm=r,Gm}var Km,N2;function bz(){if(N2)return Km;N2=1;var e=Math.ceil,t=Math.max;function r(n,s,i,a){for(var l=-1,c=t(e((s-n)/(i||1)),0),d=Array(c);c--;)d[a?c:++l]=n,n+=i;return d}return Km=r,Km}var Ym,C2;function _z(){if(C2)return Ym;C2=1;var e=bz(),t=_u(),r=S4();function n(s){return function(i,a,l){return l&&typeof l!="number"&&t(i,a,l)&&(a=l=void 0),i=r(i),a===void 0?(a=i,i=0):a=r(a),l=l===void 0?i<a?1:-1:r(l),e(i,a,l,s)}}return Ym=n,Ym}var Xm,E2;function wz(){if(E2)return Xm;E2=1;var e=_z(),t=e();return Xm=t,Xm}var Qm,T2;function jz(){if(T2)return Qm;T2=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Qm=e,Qm}var Zm,A2;function Sz(){if(A2)return Zm;A2=1;var e=Li();function t(r,n){if(r!==n){var s=r!==void 0,i=r===null,a=r===r,l=e(r),c=n!==void 0,d=n===null,u=n===n,f=e(n);if(!d&&!f&&!l&&r>n||l&&c&&u&&!d&&!f||i&&c&&u||!s&&u||!a)return 1;if(!i&&!l&&!f&&r<n||f&&s&&a&&!i&&!l||d&&s&&a||!c&&a||!u)return-1}return 0}return Zm=t,Zm}var Jm,R2;function kz(){if(R2)return Jm;R2=1;var e=Sz();function t(r,n,s){for(var i=-1,a=r.criteria,l=n.criteria,c=a.length,d=s.length;++i<c;){var u=e(a[i],l[i]);if(u){if(i>=d)return u;var f=s[i];return u*(f=="desc"?-1:1)}}return r.index-n.index}return Jm=t,Jm}var eg,I2;function Nz(){if(I2)return eg;I2=1;var e=xu(),t=yu(),r=bn(),n=d4(),s=jz(),i=pu(),a=kz(),l=Is(),c=lt();function d(u,f,p){f.length?f=e(f,function(g){return c(g)?function(_){return t(_,g.length===1?g[0]:g)}:g}):f=[l];var h=-1;f=e(f,i(r));var v=n(u,function(g,_,x){var y=e(f,function(b){return b(g)});return{criteria:y,index:++h,value:g}});return s(v,function(g,_){return a(g,_,p)})}return eg=d,eg}var tg,P2;function Cz(){if(P2)return tg;P2=1;var e=Sy(),t=Nz(),r=bu(),n=_u(),s=r(function(i,a){if(i==null)return[];var l=a.length;return l>1&&n(i,a[0],a[1])?a=[]:l>2&&n(a[0],a[1],a[2])&&(a=[a[0]]),t(i,e(a,1),[])});return tg=s,tg}var rg,M2;function Ez(){if(M2)return rg;M2=1;var e=s4(),t=0;function r(n){var s=++t;return e(n)+s}return rg=r,rg}var ng,O2;function Tz(){if(O2)return ng;O2=1;function e(t,r,n){for(var s=-1,i=t.length,a=r.length,l={};++s<i;){var c=s<a?r[s]:void 0;n(l,t[s],c)}return l}return ng=e,ng}var sg,D2;function Az(){if(D2)return sg;D2=1;var e=du(),t=Tz();function r(n,s){return t(n||[],s||[],e)}return sg=r,sg}var gc;if(typeof cy=="function")try{gc={cloneDeep:UL(),constant:yy(),defaults:GL(),each:QE(),filter:l4(),find:ez(),flatten:k4(),forEach:XE(),forIn:tz(),has:c4(),isUndefined:u4(),last:rz(),map:f4(),mapValues:nz(),max:iz(),merge:dz(),min:fz(),minBy:pz(),now:hz(),pick:yz(),range:wz(),reduce:p4(),sortBy:Cz(),uniqueId:Ez(),values:v4(),zipObject:Az()}}catch{}gc||(gc=window._);var Qe=gc,Rz=wu;function wu(){var e={};e._next=e._prev=e,this._sentinel=e}wu.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return T4(t),t};wu.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&T4(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};wu.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,Iz)),r=r._prev;return"["+e.join(", ")+"]"};function T4(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Iz(e,t){if(e!=="_next"&&e!=="_prev")return t}var on=Qe,Pz=Or.Graph,Mz=Rz,Oz=Lz,Dz=on.constant(1);function Lz(e,t){if(e.nodeCount()<=1)return[];var r=Fz(e,t||Dz),n=zz(r.graph,r.buckets,r.zeroIdx);return on.flatten(on.map(n,function(s){return e.outEdges(s.v,s.w)}),!0)}function zz(e,t,r){for(var n=[],s=t[t.length-1],i=t[0],a;e.nodeCount();){for(;a=i.dequeue();)ig(e,t,r,a);for(;a=s.dequeue();)ig(e,t,r,a);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(a=t[l].dequeue(),a){n=n.concat(ig(e,t,r,a,!0));break}}}return n}function ig(e,t,r,n,s){var i=s?[]:void 0;return on.forEach(e.inEdges(n.v),function(a){var l=e.edge(a),c=e.node(a.v);s&&i.push({v:a.v,w:a.w}),c.out-=l,Fx(t,r,c)}),on.forEach(e.outEdges(n.v),function(a){var l=e.edge(a),c=a.w,d=e.node(c);d.in-=l,Fx(t,r,d)}),e.removeNode(n.v),i}function Fz(e,t){var r=new Pz,n=0,s=0;on.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),on.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,d=t(l),u=c+d;r.setEdge(l.v,l.w,u),s=Math.max(s,r.node(l.v).out+=d),n=Math.max(n,r.node(l.w).in+=d)});var i=on.range(s+n+3).map(function(){return new Mz}),a=n+1;return on.forEach(r.nodes(),function(l){Fx(i,a,r.node(l))}),{graph:r,buckets:i,zeroIdx:a}}function Fx(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var hs=Qe,$z=Oz,qz={run:Bz,undo:Hz};function Bz(e){var t=e.graph().acyclicer==="greedy"?$z(e,r(e)):Wz(e);hs.forEach(t,function(n){var s=e.edge(n);e.removeEdge(n),s.forwardName=n.name,s.reversed=!0,e.setEdge(n.w,n.v,s,hs.uniqueId("rev"))});function r(n){return function(s){return n.edge(s).weight}}}function Wz(e){var t=[],r={},n={};function s(i){hs.has(n,i)||(n[i]=!0,r[i]=!0,hs.forEach(e.outEdges(i),function(a){hs.has(r,a.w)?t.push(a):s(a.w)}),delete r[i])}return hs.forEach(e.nodes(),s),t}function Hz(e){hs.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var $e=Qe,A4=Or.Graph,Kt={addDummyNode:R4,simplify:Vz,asNonCompoundGraph:Uz,successorWeights:Gz,predecessorWeights:Kz,intersectRect:Yz,buildLayerMatrix:Xz,normalizeRanks:Qz,removeEmptyRanks:Zz,addBorderNode:Jz,maxRank:I4,partition:eF,time:tF,notime:rF};function R4(e,t,r,n){var s;do s=$e.uniqueId(n);while(e.hasNode(s));return r.dummy=t,e.setNode(s,r),s}function Vz(e){var t=new A4().setGraph(e.graph());return $e.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),$e.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},s=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+s.weight,minlen:Math.max(n.minlen,s.minlen)})}),t}function Uz(e){var t=new A4({multigraph:e.isMultigraph()}).setGraph(e.graph());return $e.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),$e.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function Gz(e){var t=$e.map(e.nodes(),function(r){var n={};return $e.forEach(e.outEdges(r),function(s){n[s.w]=(n[s.w]||0)+e.edge(s).weight}),n});return $e.zipObject(e.nodes(),t)}function Kz(e){var t=$e.map(e.nodes(),function(r){var n={};return $e.forEach(e.inEdges(r),function(s){n[s.v]=(n[s.v]||0)+e.edge(s).weight}),n});return $e.zipObject(e.nodes(),t)}function Yz(e,t){var r=e.x,n=e.y,s=t.x-r,i=t.y-n,a=e.width/2,l=e.height/2;if(!s&&!i)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(i)*a>Math.abs(s)*l?(i<0&&(l=-l),c=l*s/i,d=l):(s<0&&(a=-a),c=a,d=a*i/s),{x:r+c,y:n+d}}function Xz(e){var t=$e.map($e.range(I4(e)+1),function(){return[]});return $e.forEach(e.nodes(),function(r){var n=e.node(r),s=n.rank;$e.isUndefined(s)||(t[s][n.order]=r)}),t}function Qz(e){var t=$e.min($e.map(e.nodes(),function(r){return e.node(r).rank}));$e.forEach(e.nodes(),function(r){var n=e.node(r);$e.has(n,"rank")&&(n.rank-=t)})}function Zz(e){var t=$e.min($e.map(e.nodes(),function(i){return e.node(i).rank})),r=[];$e.forEach(e.nodes(),function(i){var a=e.node(i).rank-t;r[a]||(r[a]=[]),r[a].push(i)});var n=0,s=e.graph().nodeRankFactor;$e.forEach(r,function(i,a){$e.isUndefined(i)&&a%s!==0?--n:n&&$e.forEach(i,function(l){e.node(l).rank+=n})})}function Jz(e,t,r,n){var s={width:0,height:0};return arguments.length>=4&&(s.rank=r,s.order=n),R4(e,"border",s,t)}function I4(e){return $e.max($e.map(e.nodes(),function(t){var r=e.node(t).rank;if(!$e.isUndefined(r))return r}))}function eF(e,t){var r={lhs:[],rhs:[]};return $e.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function tF(e,t){var r=$e.now();try{return t()}finally{console.log(e+" time: "+($e.now()-r)+"ms")}}function rF(e,t){return t()}var P4=Qe,nF=Kt,sF={run:iF,undo:aF};function iF(e){e.graph().dummyChains=[],P4.forEach(e.edges(),function(t){oF(e,t)})}function oF(e,t){var r=t.v,n=e.node(r).rank,s=t.w,i=e.node(s).rank,a=t.name,l=e.edge(t),c=l.labelRank;if(i!==n+1){e.removeEdge(t);var d,u,f;for(f=0,++n;n<i;++f,++n)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},d=nF.addDummyNode(e,"edge",u,"_d"),n===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(r,d,{weight:l.weight},a),f===0&&e.graph().dummyChains.push(d),r=d;e.setEdge(r,s,{weight:l.weight},a)}}function aF(e){P4.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,s;for(e.setEdge(r.edgeObj,n);r.dummy;)s=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=s,r=e.node(t)})}var ol=Qe,ju={longestPath:lF,slack:cF};function lF(e){var t={};function r(n){var s=e.node(n);if(ol.has(t,n))return s.rank;t[n]=!0;var i=ol.min(ol.map(e.outEdges(n),function(a){return r(a.w)-e.edge(a).minlen}));return(i===Number.POSITIVE_INFINITY||i===void 0||i===null)&&(i=0),s.rank=i}ol.forEach(e.sources(),r)}function cF(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var xc=Qe,uF=Or.Graph,vc=ju.slack,M4=dF;function dF(e){var t=new uF({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var s,i;fF(t,e)<n;)s=pF(t,e),i=t.hasNode(s.v)?vc(e,s):-vc(e,s),hF(t,e,i);return t}function fF(e,t){function r(n){xc.forEach(t.nodeEdges(n),function(s){var i=s.v,a=n===i?s.w:i;!e.hasNode(a)&&!vc(t,s)&&(e.setNode(a,{}),e.setEdge(n,a,{}),r(a))})}return xc.forEach(e.nodes(),r),e.nodeCount()}function pF(e,t){return xc.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return vc(t,r)})}function hF(e,t,r){xc.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var gn=Qe,mF=M4,gF=ju.slack,xF=ju.longestPath,vF=Or.alg.preorder,yF=Or.alg.postorder,bF=Kt.simplify,_F=Ps;Ps.initLowLimValues=Ey;Ps.initCutValues=Cy;Ps.calcCutValue=O4;Ps.leaveEdge=L4;Ps.enterEdge=z4;Ps.exchangeEdges=F4;function Ps(e){e=bF(e),xF(e);var t=mF(e);Ey(t),Cy(t,e);for(var r,n;r=L4(t);)n=z4(t,e,r),F4(t,e,r,n)}function Cy(e,t){var r=yF(e,e.nodes());r=r.slice(0,r.length-1),gn.forEach(r,function(n){wF(e,t,n)})}function wF(e,t,r){var n=e.node(r),s=n.parent;e.edge(r,s).cutvalue=O4(e,t,r)}function O4(e,t,r){var n=e.node(r),s=n.parent,i=!0,a=t.edge(r,s),l=0;return a||(i=!1,a=t.edge(s,r)),l=a.weight,gn.forEach(t.nodeEdges(r),function(c){var d=c.v===r,u=d?c.w:c.v;if(u!==s){var f=d===i,p=t.edge(c).weight;if(l+=f?p:-p,SF(e,r,u)){var h=e.edge(r,u).cutvalue;l+=f?-h:h}}}),l}function Ey(e,t){arguments.length<2&&(t=e.nodes()[0]),D4(e,{},1,t)}function D4(e,t,r,n,s){var i=r,a=e.node(n);return t[n]=!0,gn.forEach(e.neighbors(n),function(l){gn.has(t,l)||(r=D4(e,t,r,l,n))}),a.low=i,a.lim=r++,s?a.parent=s:delete a.parent,r}function L4(e){return gn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function z4(e,t,r){var n=r.v,s=r.w;t.hasEdge(n,s)||(n=r.w,s=r.v);var i=e.node(n),a=e.node(s),l=i,c=!1;i.lim>a.lim&&(l=a,c=!0);var d=gn.filter(t.edges(),function(u){return c===L2(e,e.node(u.v),l)&&c!==L2(e,e.node(u.w),l)});return gn.minBy(d,function(u){return gF(t,u)})}function F4(e,t,r,n){var s=r.v,i=r.w;e.removeEdge(s,i),e.setEdge(n.v,n.w,{}),Ey(e),Cy(e,t),jF(e,t)}function jF(e,t){var r=gn.find(e.nodes(),function(s){return!t.node(s).parent}),n=vF(e,r);n=n.slice(1),gn.forEach(n,function(s){var i=e.node(s).parent,a=t.edge(s,i),l=!1;a||(a=t.edge(i,s),l=!0),t.node(s).rank=t.node(i).rank+(l?a.minlen:-a.minlen)})}function SF(e,t,r){return e.hasEdge(t,r)}function L2(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var kF=ju,$4=kF.longestPath,NF=M4,CF=_F,EF=TF;function TF(e){switch(e.graph().ranker){case"network-simplex":z2(e);break;case"tight-tree":RF(e);break;case"longest-path":AF(e);break;default:z2(e)}}var AF=$4;function RF(e){$4(e),NF(e)}function z2(e){CF(e)}var $x=Qe,IF=PF;function PF(e){var t=OF(e);$x.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),s=n.edgeObj,i=MF(e,t,s.v,s.w),a=i.path,l=i.lca,c=0,d=a[c],u=!0;r!==s.w;){if(n=e.node(r),u){for(;(d=a[c])!==l&&e.node(d).maxRank<n.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<a.length-1&&e.node(d=a[c+1]).minRank<=n.rank;)c++;d=a[c]}e.setParent(r,d),r=e.successors(r)[0]}})}function MF(e,t,r,n){var s=[],i=[],a=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,d;c=r;do c=e.parent(c),s.push(c);while(c&&(t[c].low>a||l>t[c].lim));for(d=c,c=n;(c=e.parent(c))!==d;)i.push(c);return{path:s.concat(i.reverse()),lca:d}}function OF(e){var t={},r=0;function n(s){var i=r;$x.forEach(e.children(s),n),t[s]={low:i,lim:r++}}return $x.forEach(e.children(),n),t}var an=Qe,qx=Kt,DF={run:LF,cleanup:$F};function LF(e){var t=qx.addDummyNode(e,"root",{},"_root"),r=zF(e),n=an.max(an.values(r))-1,s=2*n+1;e.graph().nestingRoot=t,an.forEach(e.edges(),function(a){e.edge(a).minlen*=s});var i=FF(e)+1;an.forEach(e.children(),function(a){q4(e,t,s,i,n,r,a)}),e.graph().nodeRankFactor=s}function q4(e,t,r,n,s,i,a){var l=e.children(a);if(!l.length){a!==t&&e.setEdge(t,a,{weight:0,minlen:r});return}var c=qx.addBorderNode(e,"_bt"),d=qx.addBorderNode(e,"_bb"),u=e.node(a);e.setParent(c,a),u.borderTop=c,e.setParent(d,a),u.borderBottom=d,an.forEach(l,function(f){q4(e,t,r,n,s,i,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,v=p.borderBottom?p.borderBottom:f,g=p.borderTop?n:2*n,_=h!==v?1:s-i[a]+1;e.setEdge(c,h,{weight:g,minlen:_,nestingEdge:!0}),e.setEdge(v,d,{weight:g,minlen:_,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,c,{weight:0,minlen:s+i[a]})}function zF(e){var t={};function r(n,s){var i=e.children(n);i&&i.length&&an.forEach(i,function(a){r(a,s+1)}),t[n]=s}return an.forEach(e.children(),function(n){r(n,1)}),t}function FF(e){return an.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function $F(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,an.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var og=Qe,qF=Kt,BF=WF;function WF(e){function t(r){var n=e.children(r),s=e.node(r);if(n.length&&og.forEach(n,t),og.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var i=s.minRank,a=s.maxRank+1;i<a;++i)F2(e,"borderLeft","_bl",r,s,i),F2(e,"borderRight","_br",r,s,i)}}og.forEach(e.children(),t)}function F2(e,t,r,n,s,i){var a={width:0,height:0,rank:i,borderType:t},l=s[t][i-1],c=qF.addDummyNode(e,"border",a,r);s[t][i]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var Br=Qe,HF={adjust:VF,undo:UF};function VF(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&B4(e)}function UF(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&GF(e),(t==="lr"||t==="rl")&&(KF(e),B4(e))}function B4(e){Br.forEach(e.nodes(),function(t){$2(e.node(t))}),Br.forEach(e.edges(),function(t){$2(e.edge(t))})}function $2(e){var t=e.width;e.width=e.height,e.height=t}function GF(e){Br.forEach(e.nodes(),function(t){ag(e.node(t))}),Br.forEach(e.edges(),function(t){var r=e.edge(t);Br.forEach(r.points,ag),Br.has(r,"y")&&ag(r)})}function ag(e){e.y=-e.y}function KF(e){Br.forEach(e.nodes(),function(t){lg(e.node(t))}),Br.forEach(e.edges(),function(t){var r=e.edge(t);Br.forEach(r.points,lg),Br.has(r,"x")&&lg(r)})}function lg(e){var t=e.x;e.x=e.y,e.y=t}var Qr=Qe,YF=XF;function XF(e){var t={},r=Qr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Qr.max(Qr.map(r,function(l){return e.node(l).rank})),s=Qr.map(Qr.range(n+1),function(){return[]});function i(l){if(!Qr.has(t,l)){t[l]=!0;var c=e.node(l);s[c.rank].push(l),Qr.forEach(e.successors(l),i)}}var a=Qr.sortBy(r,function(l){return e.node(l).rank});return Qr.forEach(a,i),s}var jn=Qe,QF=ZF;function ZF(e,t){for(var r=0,n=1;n<t.length;++n)r+=JF(e,t[n-1],t[n]);return r}function JF(e,t,r){for(var n=jn.zipObject(r,jn.map(r,function(d,u){return u})),s=jn.flatten(jn.map(t,function(d){return jn.sortBy(jn.map(e.outEdges(d),function(u){return{pos:n[u.w],weight:e.edge(u).weight}}),"pos")}),!0),i=1;i<r.length;)i<<=1;var a=2*i-1;i-=1;var l=jn.map(new Array(a),function(){return 0}),c=0;return jn.forEach(s.forEach(function(d){var u=d.pos+i;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var q2=Qe,e$=t$;function t$(e,t){return q2.map(t,function(r){var n=e.inEdges(r);if(n.length){var s=q2.reduce(n,function(i,a){var l=e.edge(a),c=e.node(a.v);return{sum:i.sum+l.weight*c.order,weight:i.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}var er=Qe,r$=n$;function n$(e,t){var r={};er.forEach(e,function(s,i){var a=r[s.v]={indegree:0,in:[],out:[],vs:[s.v],i};er.isUndefined(s.barycenter)||(a.barycenter=s.barycenter,a.weight=s.weight)}),er.forEach(t.edges(),function(s){var i=r[s.v],a=r[s.w];!er.isUndefined(i)&&!er.isUndefined(a)&&(a.indegree++,i.out.push(r[s.w]))});var n=er.filter(r,function(s){return!s.indegree});return s$(n)}function s$(e){var t=[];function r(i){return function(a){a.merged||(er.isUndefined(a.barycenter)||er.isUndefined(i.barycenter)||a.barycenter>=i.barycenter)&&i$(i,a)}}function n(i){return function(a){a.in.push(i),--a.indegree===0&&e.push(a)}}for(;e.length;){var s=e.pop();t.push(s),er.forEach(s.in.reverse(),r(s)),er.forEach(s.out,n(s))}return er.map(er.filter(t,function(i){return!i.merged}),function(i){return er.pick(i,["vs","i","barycenter","weight"])})}function i$(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var yo=Qe,o$=Kt,a$=l$;function l$(e,t){var r=o$.partition(e,function(u){return yo.has(u,"barycenter")}),n=r.lhs,s=yo.sortBy(r.rhs,function(u){return-u.i}),i=[],a=0,l=0,c=0;n.sort(c$(!!t)),c=B2(i,s,c),yo.forEach(n,function(u){c+=u.vs.length,i.push(u.vs),a+=u.barycenter*u.weight,l+=u.weight,c=B2(i,s,c)});var d={vs:yo.flatten(i,!0)};return l&&(d.barycenter=a/l,d.weight=l),d}function B2(e,t,r){for(var n;t.length&&(n=yo.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function c$(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var Pn=Qe,u$=e$,d$=r$,f$=a$,p$=W4;function W4(e,t,r,n){var s=e.children(t),i=e.node(t),a=i?i.borderLeft:void 0,l=i?i.borderRight:void 0,c={};a&&(s=Pn.filter(s,function(v){return v!==a&&v!==l}));var d=u$(e,s);Pn.forEach(d,function(v){if(e.children(v.v).length){var g=W4(e,v.v,r,n);c[v.v]=g,Pn.has(g,"barycenter")&&m$(v,g)}});var u=d$(d,r);h$(u,c);var f=f$(u,n);if(a&&(f.vs=Pn.flatten([a,f.vs,l],!0),e.predecessors(a).length)){var p=e.node(e.predecessors(a)[0]),h=e.node(e.predecessors(l)[0]);Pn.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function h$(e,t){Pn.forEach(e,function(r){r.vs=Pn.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function m$(e,t){Pn.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var bo=Qe,g$=Or.Graph,x$=v$;function v$(e,t,r){var n=y$(e),s=new g$({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(i){return e.node(i)});return bo.forEach(e.nodes(),function(i){var a=e.node(i),l=e.parent(i);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(i),s.setParent(i,l||n),bo.forEach(e[r](i),function(c){var d=c.v===i?c.w:c.v,u=s.edge(d,i),f=bo.isUndefined(u)?0:u.weight;s.setEdge(d,i,{weight:e.edge(c).weight+f})}),bo.has(a,"minRank")&&s.setNode(i,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),s}function y$(e){for(var t;e.hasNode(t=bo.uniqueId("_root")););return t}var b$=Qe,_$=w$;function w$(e,t,r){var n={},s;b$.forEach(r,function(i){for(var a=e.parent(i),l,c;a;){if(l=e.parent(a),l?(c=n[l],n[l]=a):(c=s,s=a),c&&c!==a){t.setEdge(c,a);return}a=l}})}var Un=Qe,j$=YF,S$=QF,k$=p$,N$=x$,C$=_$,E$=Or.Graph,W2=Kt,T$=A$;function A$(e){var t=W2.maxRank(e),r=H2(e,Un.range(1,t+1),"inEdges"),n=H2(e,Un.range(t-1,-1,-1),"outEdges"),s=j$(e);V2(e,s);for(var i=Number.POSITIVE_INFINITY,a,l=0,c=0;c<4;++l,++c){R$(l%2?r:n,l%4>=2),s=W2.buildLayerMatrix(e);var d=S$(e,s);d<i&&(c=0,a=Un.cloneDeep(s),i=d)}V2(e,a)}function H2(e,t,r){return Un.map(t,function(n){return N$(e,n,r)})}function R$(e,t){var r=new E$;Un.forEach(e,function(n){var s=n.graph().root,i=k$(n,s,r,t);Un.forEach(i.vs,function(a,l){n.node(a).order=l}),C$(n,r,i.vs)})}function V2(e,t){Un.forEach(t,function(r){Un.forEach(r,function(n,s){e.node(n).order=s})})}var ye=Qe,I$=Or.Graph,P$=Kt,M$={positionX:V$};function O$(e,t){var r={};function n(s,i){var a=0,l=0,c=s.length,d=ye.last(i);return ye.forEach(i,function(u,f){var p=L$(e,u),h=p?e.node(p).order:c;(p||u===d)&&(ye.forEach(i.slice(l,f+1),function(v){ye.forEach(e.predecessors(v),function(g){var _=e.node(g),x=_.order;(x<a||h<x)&&!(_.dummy&&e.node(v).dummy)&&H4(r,g,v)})}),l=f+1,a=h)}),i}return ye.reduce(t,n),r}function D$(e,t){var r={};function n(i,a,l,c,d){var u;ye.forEach(ye.range(a,l),function(f){u=i[f],e.node(u).dummy&&ye.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&H4(r,p,u)})})}function s(i,a){var l=-1,c,d=0;return ye.forEach(a,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,n(a,d,f,l,c),d=f,l=c)}n(a,d,a.length,c,i.length)}),a}return ye.reduce(t,s),r}function L$(e,t){if(e.node(t).dummy)return ye.find(e.predecessors(t),function(r){return e.node(r).dummy})}function H4(e,t,r){if(t>r){var n=t;t=r,r=n}var s=e[t];s||(e[t]=s={}),s[r]=!0}function z$(e,t,r){if(t>r){var n=t;t=r,r=n}return ye.has(e[t],r)}function F$(e,t,r,n){var s={},i={},a={};return ye.forEach(t,function(l){ye.forEach(l,function(c,d){s[c]=c,i[c]=c,a[c]=d})}),ye.forEach(t,function(l){var c=-1;ye.forEach(l,function(d){var u=n(d);if(u.length){u=ye.sortBy(u,function(g){return a[g]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var v=u[p];i[d]===d&&c<a[v]&&!z$(r,d,v)&&(i[v]=d,i[d]=s[d]=s[v],c=a[v])}}})}),{root:s,align:i}}function $$(e,t,r,n,s){var i={},a=q$(e,t,r,s),l=s?"borderLeft":"borderRight";function c(f,p){for(var h=a.nodes(),v=h.pop(),g={};v;)g[v]?f(v):(g[v]=!0,h.push(v),h=h.concat(p(v))),v=h.pop()}function d(f){i[f]=a.inEdges(f).reduce(function(p,h){return Math.max(p,i[h.v]+a.edge(h))},0)}function u(f){var p=a.outEdges(f).reduce(function(v,g){return Math.min(v,i[g.w]-a.edge(g))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(i[f]=Math.max(i[f],p))}return c(d,a.predecessors.bind(a)),c(u,a.successors.bind(a)),ye.forEach(n,function(f){i[f]=i[r[f]]}),i}function q$(e,t,r,n){var s=new I$,i=e.graph(),a=U$(i.nodesep,i.edgesep,n);return ye.forEach(t,function(l){var c;ye.forEach(l,function(d){var u=r[d];if(s.setNode(u),c){var f=r[c],p=s.edge(f,u);s.setEdge(f,u,Math.max(a(e,d,c),p||0))}c=d})}),s}function B$(e,t){return ye.minBy(ye.values(t),function(r){var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return ye.forIn(r,function(i,a){var l=G$(e,a)/2;n=Math.max(i+l,n),s=Math.min(i-l,s)}),n-s})}function W$(e,t){var r=ye.values(t),n=ye.min(r),s=ye.max(r);ye.forEach(["u","d"],function(i){ye.forEach(["l","r"],function(a){var l=i+a,c=e[l],d;if(c!==t){var u=ye.values(c);d=a==="l"?n-ye.min(u):s-ye.max(u),d&&(e[l]=ye.mapValues(c,function(f){return f+d}))}})})}function H$(e,t){return ye.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var s=ye.sortBy(ye.map(e,n));return(s[1]+s[2])/2})}function V$(e){var t=P$.buildLayerMatrix(e),r=ye.merge(O$(e,t),D$(e,t)),n={},s;ye.forEach(["u","d"],function(a){s=a==="u"?t:ye.values(t).reverse(),ye.forEach(["l","r"],function(l){l==="r"&&(s=ye.map(s,function(f){return ye.values(f).reverse()}));var c=(a==="u"?e.predecessors:e.successors).bind(e),d=F$(e,s,r,c),u=$$(e,s,d.root,d.align,l==="r");l==="r"&&(u=ye.mapValues(u,function(f){return-f})),n[a+l]=u})});var i=B$(e,n);return W$(n,i),H$(n,e.graph().align)}function U$(e,t,r){return function(n,s,i){var a=n.node(s),l=n.node(i),c=0,d;if(c+=a.width/2,ye.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":d=-a.width/2;break;case"r":d=a.width/2;break}if(d&&(c+=r?d:-d),d=0,c+=(a.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,ye.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=r?d:-d),d=0,c}}function G$(e,t){return e.node(t).width}var _o=Qe,V4=Kt,K$=M$.positionX,Y$=X$;function X$(e){e=V4.asNonCompoundGraph(e),Q$(e),_o.forEach(K$(e),function(t,r){e.node(r).x=t})}function Q$(e){var t=V4.buildLayerMatrix(e),r=e.graph().ranksep,n=0;_o.forEach(t,function(s){var i=_o.max(_o.map(s,function(a){return e.node(a).height}));_o.forEach(s,function(a){e.node(a).y=n+i/2}),n+=i+r})}var Se=Qe,U2=qz,G2=sF,Z$=EF,J$=Kt.normalizeRanks,eq=IF,tq=Kt.removeEmptyRanks,K2=DF,rq=BF,Y2=HF,nq=T$,sq=Y$,Xn=Kt,iq=Or.Graph,oq=aq;function aq(e,t){var r=t&&t.debugTiming?Xn.time:Xn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return vq(e)});r("  runLayout",function(){lq(n,r)}),r("  updateInputGraph",function(){cq(e,n)})})}function lq(e,t){t("    makeSpaceForEdgeLabels",function(){yq(e)}),t("    removeSelfEdges",function(){Eq(e)}),t("    acyclic",function(){U2.run(e)}),t("    nestingGraph.run",function(){K2.run(e)}),t("    rank",function(){Z$(Xn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){bq(e)}),t("    removeEmptyRanks",function(){tq(e)}),t("    nestingGraph.cleanup",function(){K2.cleanup(e)}),t("    normalizeRanks",function(){J$(e)}),t("    assignRankMinMax",function(){_q(e)}),t("    removeEdgeLabelProxies",function(){wq(e)}),t("    normalize.run",function(){G2.run(e)}),t("    parentDummyChains",function(){eq(e)}),t("    addBorderSegments",function(){rq(e)}),t("    order",function(){nq(e)}),t("    insertSelfEdges",function(){Tq(e)}),t("    adjustCoordinateSystem",function(){Y2.adjust(e)}),t("    position",function(){sq(e)}),t("    positionSelfEdges",function(){Aq(e)}),t("    removeBorderNodes",function(){Cq(e)}),t("    normalize.undo",function(){G2.undo(e)}),t("    fixupEdgeLabelCoords",function(){kq(e)}),t("    undoCoordinateSystem",function(){Y2.undo(e)}),t("    translateGraph",function(){jq(e)}),t("    assignNodeIntersects",function(){Sq(e)}),t("    reversePoints",function(){Nq(e)}),t("    acyclic.undo",function(){U2.undo(e)})}function cq(e,t){Se.forEach(e.nodes(),function(r){var n=e.node(r),s=t.node(r);n&&(n.x=s.x,n.y=s.y,t.children(r).length&&(n.width=s.width,n.height=s.height))}),Se.forEach(e.edges(),function(r){var n=e.edge(r),s=t.edge(r);n.points=s.points,Se.has(s,"x")&&(n.x=s.x,n.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var uq=["nodesep","edgesep","ranksep","marginx","marginy"],dq={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},fq=["acyclicer","ranker","rankdir","align"],pq=["width","height"],hq={width:0,height:0},mq=["minlen","weight","width","height","labeloffset"],gq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},xq=["labelpos"];function vq(e){var t=new iq({multigraph:!0,compound:!0}),r=ug(e.graph());return t.setGraph(Se.merge({},dq,cg(r,uq),Se.pick(r,fq))),Se.forEach(e.nodes(),function(n){var s=ug(e.node(n));t.setNode(n,Se.defaults(cg(s,pq),hq)),t.setParent(n,e.parent(n))}),Se.forEach(e.edges(),function(n){var s=ug(e.edge(n));t.setEdge(n,Se.merge({},gq,cg(s,mq),Se.pick(s,xq)))}),t}function yq(e){var t=e.graph();t.ranksep/=2,Se.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function bq(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),s=e.node(t.w),i={rank:(s.rank-n.rank)/2+n.rank,e:t};Xn.addDummyNode(e,"edge-proxy",i,"_ep")}})}function _q(e){var t=0;Se.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=Se.max(t,n.maxRank))}),e.graph().maxRank=t}function wq(e){Se.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function jq(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,s=0,i=e.graph(),a=i.marginx||0,l=i.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),r=Math.max(r,u+p/2),n=Math.min(n,f-h/2),s=Math.max(s,f+h/2)}Se.forEach(e.nodes(),function(d){c(e.node(d))}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.has(u,"x")&&c(u)}),t-=a,n-=l,Se.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=n}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.forEach(u.points,function(f){f.x-=t,f.y-=n}),Se.has(u,"x")&&(u.x-=t),Se.has(u,"y")&&(u.y-=n)}),i.width=r-t+a,i.height=s-n+l}function Sq(e){Se.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),s=e.node(t.w),i,a;r.points?(i=r.points[0],a=r.points[r.points.length-1]):(r.points=[],i=s,a=n),r.points.unshift(Xn.intersectRect(n,i)),r.points.push(Xn.intersectRect(s,a))})}function kq(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);if(Se.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Nq(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function Cq(e){Se.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),s=e.node(r.borderBottom),i=e.node(Se.last(r.borderLeft)),a=e.node(Se.last(r.borderRight));r.width=Math.abs(a.x-i.x),r.height=Math.abs(s.y-n.y),r.x=i.x+r.width/2,r.y=n.y+r.height/2}}),Se.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function Eq(e){Se.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function Tq(e){var t=Xn.buildLayerMatrix(e);Se.forEach(t,function(r){var n=0;Se.forEach(r,function(s,i){var a=e.node(s);a.order=i+n,Se.forEach(a.selfEdges,function(l){Xn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:a.rank,order:i+ ++n,e:l.e,label:l.label},"_se")}),delete a.selfEdges})})}function Aq(e){Se.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),s=n.x+n.width/2,i=n.y,a=r.x-s,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:s+2*a/3,y:i-l},{x:s+5*a/6,y:i-l},{x:s+a,y:i},{x:s+5*a/6,y:i+l},{x:s+2*a/3,y:i+l}],r.label.x=r.x,r.label.y=r.y}})}function cg(e,t){return Se.mapValues(Se.pick(e,t),Number)}function ug(e){var t={};return Se.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var al=Qe,Rq=Kt,Iq=Or.Graph,Pq={debugOrdering:Mq};function Mq(e){var t=Rq.buildLayerMatrix(e),r=new Iq({compound:!0,multigraph:!0}).setGraph({});return al.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),al.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),al.forEach(t,function(n,s){var i="layer"+s;r.setNode(i,{rank:"same"}),al.reduce(n,function(a,l){return r.setEdge(a,l,{style:"invis"}),l})}),r}var Oq="0.8.5",Dq={graphlib:Or,layout:oq,debug:Pq,util:{time:Kt.time,notime:Kt.notime},version:Oq};const yc=Zx(Dq),bc={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},Lq={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},zq=220,Fq=110;function X2(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(s=>{const i=bc[s.type]||bc.task,l=s.type==="end"&&["blocked","abandoned"].includes(s.terminal_outcome)?Lq:i;return{id:s.node_id,type:"workflowNode",position:s._position||{x:0,y:0},data:{...s,config:l,isEntry:t.includes(s.node_id)}}}),n=(e.edges||[]).map(s=>{const i=s.non_advancing||!s.to_node_id,a=s.conditions&&s.conditions.length>0;let l=s.label||s.outcome;if(a){const c=s.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:s.edge_id,source:s.from_node_id,target:s.to_node_id||s.from_node_id,type:"smoothstep",animated:i,label:l,data:{...s},style:{stroke:i?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:i?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:s.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function _c(e,t,r="TB",n=zq,s=Fq){const i=new yc.graphlib.Graph;return i.setDefaultEdgeLabel(()=>({})),i.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(a=>{i.setNode(a.id,{width:n,height:s})}),t.forEach(a=>{a.target!==a.source&&i.setEdge(a.source,a.target)}),yc.layout(i),e.map(a=>{const l=i.node(a.id);return l?{...a,position:{x:l.x-n/2,y:l.y-s/2}}:a})}function $q(e,t){const r=new Set(t.map(i=>i.id||i.node_id));let n=1,s=`${e}_${n}`;for(;r.has(s);)n++,s=`${e}_${n}`;return s}function qq(e,t,r){const n=new Set(r.map(a=>a.id||a.edge_id));let s=1,i=`${e}_to_${t}`;for(;n.has(i);)s++,i=`${e}_to_${t}_${s}`;return i}function Bq(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const wc={action:{color:"#1d4ed8",bgColor:"#eff6ff",borderColor:"#3b82f6",label:"Action"},gate:{color:"#b45309",bgColor:"#fef3c7",borderColor:"#f59e0b",label:"Gate"},escalation:{color:"#b91c1c",bgColor:"#fee2e2",borderColor:"#ef4444",label:"Escalation"},parallel_fork:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Fork"},parallel_join:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Join"},start:{color:"#047857",bgColor:"#d1fae5",borderColor:"#10b981",label:"Start"},end:{color:"#374151",bgColor:"#f3f4f6",borderColor:"#6b7280",label:"End"}},jc={normal:{stroke:"#64748b",strokeWidth:2},error:{stroke:"#ef4444",strokeWidth:2,strokeDasharray:"6,3"},retry:{stroke:"#f97316",strokeWidth:2,strokeDasharray:"6,3",animated:!0},parallel:{stroke:"#8b5cf6",strokeWidth:2}},Wq=160,Hq=80;function Vq({data:e}){const{config:t,showLineage:r}=e,n=e.type==="end",s=e.type==="start",i=r&&(e.dcw_ref||e.task_ref||e.operation_ref||e.gate_profile),a=e.component,l=e.output,c=a||l;return o.jsxs("div",{style:{background:t.bgColor,border:`2px solid ${t.borderColor}`,borderRadius:8,padding:"10px 14px",minWidth:260,maxWidth:360,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[!s&&o.jsx(vr,{type:"target",position:ce.Top,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}}),o.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:t.color,letterSpacing:"0.05em",marginBottom:4},children:t.label}),o.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e293b",lineHeight:"18px",marginBottom:6},children:e.label}),e.actor&&o.jsx("div",{style:{fontSize:11,color:"#4f46e5",fontWeight:500,marginBottom:4},children:e.actor}),c&&o.jsxs("div",{style:{marginTop:6,paddingTop:6,borderTop:"1px solid #e2e8f0",display:"flex",flexDirection:"column",gap:4},children:[a&&o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[o.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Component"}),o.jsx("span",{style:{fontSize:11,color:"#0d9488",fontWeight:500,lineHeight:1.4},children:a})]}),l&&o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[o.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Output"}),o.jsx("span",{style:{fontSize:11,color:"#7c3aed",fontWeight:500,lineHeight:1.4},children:l})]})]}),i&&o.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px dashed #cbd5e1"},children:[e.dcw_ref&&o.jsx(dg,{label:"DCW",value:e.dcw_ref}),e.task_ref&&o.jsx(dg,{label:"Task",value:e.task_ref}),e.operation_ref&&o.jsx(dg,{label:"Op",value:e.operation_ref}),e.gate_profile&&o.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3},children:[o.jsx("span",{style:{fontWeight:600},children:"Gate:"})," ",Array.isArray(e.gate_profile)?e.gate_profile.join(" -> "):e.gate_profile]})]}),!n&&o.jsx(vr,{type:"source",position:ce.Bottom,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}})]})}function dg({label:e,value:t}){const r=t.length>30?"..."+t.slice(-27):t;return o.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3,fontFamily:"monospace"},title:t,children:[o.jsxs("span",{style:{fontWeight:600,fontFamily:"inherit"},children:[e,":"]})," ",r]})}const U4=m.memo(Vq),Uq={archWorkflowNode:U4};function Gq(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const r=[...e].sort((s,i)=>(s.step||s.order||0)-(i.step||i.order||0)).map((s,i)=>({node_id:`step_${i+1}`,type:"action",label:s.action||`Step ${i+1}`,actor:s.actor,description:s.description,inputs:s.inputs,outputs:s.outputs,notes:s.notes})),n=[];for(let s=0;s<r.length-1;s++)n.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:r[s].node_id,to_node_id:r[s+1].node_id,type:"normal"});return{nodes:r,edges:n}}function Kq(e,t){const r=e.map(i=>{const a=wc[i.type]||wc.action;return{id:i.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...i,config:a}}}),n=t.map(i=>{const a=i.type||"normal",l=jc[a]||jc.normal;return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id,type:"smoothstep",animated:l.animated||!1,label:i.label,style:{stroke:l.stroke,strokeWidth:l.strokeWidth,strokeDasharray:l.strokeDasharray},labelStyle:{fontSize:9,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:l.stroke}}});return{nodes:_c(r,n,"TB",Wq,Hq),edges:n}}function Q2({block:e}){const{data:t}=e;if(!t||!t.name)return null;const[r,n]=m.useState(!1),{graphNodes:s,graphEdges:i,isV1:a}=m.useMemo(()=>{const d=Array.isArray(t.nodes)&&t.nodes.length>0,u=Array.isArray(t.steps)&&t.steps.length>0;if(d)return{graphNodes:t.nodes,graphEdges:t.edges||[],isV1:!1};if(u){const{nodes:f,edges:p}=Gq(t.steps);return{graphNodes:f,graphEdges:p,isV1:!0}}return{graphNodes:[],graphEdges:[],isV1:!1}},[t.nodes,t.edges,t.steps]),l=m.useMemo(()=>s.length===0?null:Kq(s,i),[s,i]),c=r?600:350;return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.description&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),t.trigger&&o.jsxs("p",{style:{margin:"0 0 8px",fontSize:13,color:"#6b7280",fontStyle:"italic"},children:["Trigger: ",t.trigger]}),l&&l.nodes.length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{height:c,border:"1px solid #e5e7eb",borderRadius:6,background:"#ffffff",overflow:"hidden",transition:"height 0.2s ease"},children:o.jsx(Ii,{children:o.jsx(wa,{nodes:l.nodes,edges:l.edges,nodeTypes:Uq,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!1,fitView:!0,fitViewOptions:{padding:.2},proOptions:{hideAttribution:!0},minZoom:.3,maxZoom:1.5})})}),o.jsx("button",{onClick:()=>n(d=>!d),style:{marginTop:6,padding:"3px 10px",fontSize:11,color:"#6366f1",background:"none",border:"1px solid #e5e7eb",borderRadius:4,cursor:"pointer"},children:r?"Collapse":"Expand"})]}):o.jsx("p",{style:{margin:0,fontSize:13,color:"#9ca3af",fontStyle:"italic"},children:"No workflow steps defined."})]})}function Yq({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.acceptance_criteria)?t.acceptance_criteria:[];return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.target&&o.jsx("p",{style:{margin:"0 0 6px",fontSize:13,color:"#475569"},children:t.target}),t.rationale&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:12,color:"#6b7280",fontStyle:"italic"},children:t.rationale}),r.length>0&&o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Acceptance Criteria"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:r.map((n,s)=>o.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:n},s))})]})]})}function Xq({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.fields)?t.fields:[],n=Array.isArray(t.primary_keys)?t.primary_keys:[],s=Array.isArray(t.relationships)?t.relationships:[];return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.description&&o.jsx("p",{style:{margin:"0 0 10px",fontSize:13,color:"#475569"},children:t.description}),r.length>0&&o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{borderBottom:"2px solid #e2e8f0"},children:[o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Field"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Type"}),o.jsx("th",{style:{textAlign:"center",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Required"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Notes"})]})}),o.jsx("tbody",{children:r.map((i,a)=>o.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[o.jsxs("td",{style:{padding:"4px 8px",fontFamily:"monospace",color:"#1e293b",fontWeight:n.includes(i.name)?600:400},children:[i.name,n.includes(i.name)?" (PK)":""]}),o.jsx("td",{style:{padding:"4px 8px",color:"#6366f1",fontFamily:"monospace"},children:i.type}),o.jsx("td",{style:{padding:"4px 8px",textAlign:"center"},children:i.required?"Yes":"No"}),o.jsx("td",{style:{padding:"4px 8px",color:"#6b7280"},children:Array.isArray(i.notes)?i.notes.join("; "):i.notes||""})]},a))})]}),s.length>0&&o.jsxs("div",{style:{marginTop:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Relationships"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:s.map((i,a)=>o.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:typeof i=="string"?i:`${i.type||""} ${i.target||""} ${i.description||""}`.trim()},a))})]})]})}function Qq({block:e}){const{data:t}=e;if(!t||!t.name)return null;const r=Array.isArray(t.endpoints)?t.endpoints:[],n={GET:{bg:"#d1fae5",color:"#065f46"},POST:{bg:"#dbeafe",color:"#1e40af"},PUT:{bg:"#fef3c7",color:"#92400e"},PATCH:{bg:"#fef3c7",color:"#92400e"},DELETE:{bg:"#fee2e2",color:"#991b1b"}};return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.type&&o.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#f0fdf4",color:"#166534",borderRadius:4},children:t.type}),t.protocol&&o.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#eff6ff",color:"#1e40af",borderRadius:4},children:t.protocol})]}),t.description&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),(t.authentication||t.authorization)&&o.jsxs("div",{style:{marginBottom:8,fontSize:12,color:"#6b7280"},children:[t.authentication&&o.jsxs("span",{children:["Auth: ",t.authentication]}),t.authentication&&t.authorization&&o.jsx("span",{children:" | "}),t.authorization&&o.jsxs("span",{children:["Authz: ",t.authorization]})]}),r.length>0&&o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.map((s,i)=>{const a=n[s.method]||{bg:"#f3f4f6",color:"#374151"};return o.jsxs("div",{style:{padding:"8px 10px",background:"#ffffff",borderRadius:6,border:"1px solid #e5e7eb"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 6px",borderRadius:3,background:a.bg,color:a.color,fontFamily:"monospace"},children:s.method}),o.jsx("code",{style:{fontSize:13,color:"#1e293b"},children:s.path})]}),s.description&&o.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:s.description})]},i)})})]})}function Zq({block:e}){const{type:t,data:r}=e;return o.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[o.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),o.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function Jq({block:e}){const{data:t}=e,r=t.items||[],[n,s]=m.useState({});if(r.length===0)return null;const i=a=>{s(l=>({...l,[a]:!l[a]}))};return o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((a,l)=>{const c=n[l],d=a.why_it_matters||a.impact_if_unresolved;return o.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[o.jsxs("button",{onClick:()=>d&&i(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[o.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:a.question||a.value||a.text||"Unknown"}),d&&o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:o.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&o.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[a.why_it_matters&&o.jsxs("div",{style:{marginTop:10},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),o.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.why_it_matters})]}),a.impact_if_unresolved&&o.jsxs("div",{style:{marginTop:10},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),o.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.impact_if_unresolved})]})]})]},l)})})}function eB({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return o.jsxs("div",{style:{marginBottom:12},children:[r&&o.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&o.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function tB({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:s}=t;return o.jsxs("div",{style:{marginBottom:12},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[o.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&o.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),s&&o.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s})]})}function rB({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,s=r&&r.length>0,i=n&&n.length>0;return!s&&!i?null:o.jsxs("div",{style:{marginBottom:12},children:[s&&o.jsxs("div",{style:{marginBottom:i?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((a,l)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#f59e0b"},children:""}),o.jsx("span",{children:a})]},l))})]}),i&&o.jsxs("div",{children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((a,l)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#3b82f6"},children:""}),o.jsx("span",{children:a})]},l))})]})]})}function nB({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:s=[]}=t,i=r&&r.length>0,a=n&&n.length>0,l=s&&s.length>0;return!i&&!a&&!l?null:o.jsxs("div",{style:{marginBottom:12},children:[i&&o.jsxs("div",{style:{marginBottom:a||l?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#3b82f6"},children:""}),o.jsx("span",{children:c})]},d))})]}),a&&o.jsxs("div",{style:{marginBottom:l?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#f59e0b"},children:""}),o.jsx("span",{children:c})]},d))})]}),l&&o.jsxs("div",{children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:s.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#6b7280"},children:""}),o.jsx("span",{children:c})]},d))})]})]})}function sB({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:s}=t,a={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return o.jsxs("div",{style:{marginBottom:12},children:[r&&o.jsx("div",{style:{marginBottom:12},children:o.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:a.bg,color:a.text},children:r})}),n&&o.jsx("p",{style:{margin:0,marginBottom:s?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),s&&o.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:o.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",s]})})]})}const iB={"schema:ParagraphBlockV1":M8,"schema:StringListBlockV1":Hb,"schema:IndicatorBlockV1":D8,"schema:OpenQuestionV1":AE,"schema:OpenQuestionsBlockV1":L8,"schema:RisksBlockV1":Vb,"schema:DependenciesBlockV1":Vb,"schema:ArchComponentBlockV1":$8,"schema:WorkflowBlockV1":Q2,"schema:WorkflowBlockV2":Q2,"schema:QualityAttributeBlockV1":Yq,"schema:DataModelBlockV1":Xq,"schema:InterfaceBlockV1":Qq,"schema:SummaryBlockV1":z8,"schema:EpicSummaryBlockV1":Ub,"schema:StorySummaryBlockV1":F8,"schema:EpicStoriesCardBlockV1":Ub,"schema:StoriesBlockV1":Hb,"schema:UnknownsBlockV1":Jq,"schema:IntakeSummaryBlockV1":eB,"schema:IntakeProjectTypeBlockV1":tB,"schema:IntakeConstraintsBlockV1":rB,"schema:IntakeOpenGapsBlockV1":nB,"schema:IntakeOutcomeBlockV1":sB};function oB(e){return iB[e]||Zq}function aB(e,t){const r=oB(e.type);return o.jsx(r,{block:e},e.key||t)}function G4({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:s=""}){var _;const[i,a]=m.useState(new Set(((_=e==null?void 0:e.sections)==null?void 0:_.map(x=>x.section_id))||[]));if(!e)return o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return o.jsx(fB,{title:l,content:e.raw_content,reason:u.reason});const f=x=>{a(y=>{const b=new Set(y);return b.has(x)?b.delete(x):b.add(x),b})},p=t==="compact"||t==="sidecar",v=t==="sidecar"?d.filter(x=>x.viewer_tab==="overview"||!x.viewer_tab):d,g=(()=>{if(!l)return"Document";const x=l.indexOf(": ");return x>-1?l.slice(x+2):l})();return o.jsxs("div",{className:s,children:[t==="full"&&!r&&o.jsxs("div",{style:{marginBottom:24},children:[o.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&o.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:v.map(x=>o.jsx(dB,{section:x,isExpanded:i.has(x.section_id),onToggle:()=>f(x.section_id),onClick:()=>n==null?void 0:n(x),variant:t},x.section_id))}),v.length===0&&o.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function lB(e){if(!e||!e.data)return"";const{type:t,data:r}=e;switch(t){case"schema:ParagraphBlockV1":return r.text||"";case"schema:StringListBlockV1":return(r.items||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.text||""}`).join(`
`);case"schema:IndicatorBlockV1":return`${r.label||""}: ${r.value||""}`;case"schema:OpenQuestionV1":return`Q: ${r.question||""}
A: ${r.answer||"No answer yet"}`;case"schema:OpenQuestionsBlockV1":return(r.questions||[]).map(n=>`Q: ${n.question||""}
A: ${n.answer||"No answer yet"}`).join(`

`);case"schema:RisksBlockV1":case"schema:DependenciesBlockV1":return(r.items||[]).map(n=>`- ${n.title||n.name||""}: ${n.description||""}`).join(`
`);case"schema:SummaryBlockV1":return r.summary||r.text||"";case"schema:EpicSummaryBlockV1":case"schema:StorySummaryBlockV1":return[r.title||"",r.description||r.summary||""].filter(Boolean).join(`

`);case"schema:UnknownsBlockV1":return(r.items||r.unknowns||[]).map(n=>typeof n=="string"?`- ${n}`:`- ${n.description||n.text||""}`).join(`
`);case"schema:IntakeSummaryBlockV1":return r.summary||"";case"schema:IntakeProjectTypeBlockV1":return`Project Type: ${r.project_type||r.type||""}`;case"schema:IntakeConstraintsBlockV1":return(r.constraints||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOpenGapsBlockV1":return(r.gaps||r.open_gaps||[]).map(n=>`- ${n}`).join(`
`);case"schema:IntakeOutcomeBlockV1":return`Outcome: ${r.outcome||r.status||""}`;default:return r.text?r.text:r.content?r.content:r.summary?r.summary:r.items&&Array.isArray(r.items)?r.items.map(n=>typeof n=="string"?`- ${n}`:`- ${JSON.stringify(n)}`).join(`
`):""}}function cB({size:e=14}){return o.jsxs("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"5",y:"5",width:"9",height:"9",rx:"1"}),o.jsx("path",{d:"M2 11V3a1 1 0 011-1h8"})]})}function uB({size:e=14}){return o.jsx("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M3 8l4 4 6-7"})})}function dB({section:e,isExpanded:t,onToggle:r,onClick:n,variant:s}){const[i,a]=m.useState(!1),{section_id:l,title:c,description:d,blocks:u=[],sidecar_max_items:f}=e,p=s==="compact"||s==="sidecar",h=s==="sidecar";if(u.length===0)return null;const v=async x=>{x.stopPropagation();const y=u.map(lB).filter(Boolean).join(`

`);try{await navigator.clipboard.writeText(y),a(!0),setTimeout(()=>a(!1),2e3)}catch(b){console.error("Failed to copy:",b)}},g=h&&f&&u.length>f?u.slice(0,f):u,_=h&&f&&u.length>f;return o.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[o.jsxs("button",{onClick:r,style:{width:"100%",padding:p?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[o.jsxs("div",{children:[o.jsxs("h3",{style:{margin:0,fontSize:p?13:15,fontWeight:600,color:"#111827"},children:[c,_&&o.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",f," of ",u.length,")"]})]}),d&&!p&&o.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:d})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[o.jsx("button",{onClick:v,title:i?"Copied!":"Copy section",style:{padding:4,background:"none",border:"none",cursor:"pointer",color:i?"#10b981":"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,transition:"color 0.2s"},children:i?o.jsx(uB,{size:14}):o.jsx(cB,{size:14})}),o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:o.jsx("path",{d:"M4 6l4 4 4-4"})})]})]}),t&&o.jsxs("div",{style:{padding:p?12:18},children:[g.map((x,y)=>aB(x,y)),_&&o.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",u.length-f," more in full view"]})]})]})}function fB({title:e,content:t,reason:r}){return o.jsxs("div",{children:[o.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),o.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:o.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function pB({workflow:e,onClose:t}){var n,s,i,a;m.useEffect(()=>{const l=c=>{c.key==="Escape"&&t()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[t]);const r=((n=e==null?void 0:e.block)==null?void 0:n.data)||{};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-end",style:{background:"rgba(0,0,0,0.4)"},onClick:l=>l.target===l.currentTarget&&t(),children:o.jsxs("div",{className:"h-full w-full max-w-2xl flex flex-col shadow-2xl",style:{background:"#ffffff"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold",style:{color:"#1e293b"},children:"Workflow Audit"}),o.jsx("p",{className:"text-sm",style:{color:"#64748b"},children:e.name})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded hover:bg-gray-200 transition-colors",children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsxs("div",{className:"flex-1 overflow-auto p-4",style:{background:"#f8fafc"},onWheel:l=>l.stopPropagation(),children:[o.jsxs("div",{className:"mb-4 flex gap-4",children:[o.jsx(fg,{label:"Nodes",value:((s=r.nodes)==null?void 0:s.length)||((i=r.steps)==null?void 0:i.length)||0}),o.jsx(fg,{label:"Edges",value:((a=r.edges)==null?void 0:a.length)||0}),r.trigger&&o.jsx(fg,{label:"Trigger",value:r.trigger,isText:!0})]}),(r.nodes||r.steps)&&o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:r.nodes?"Nodes":"Steps"}),o.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"#f1f5f9"},children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"ID"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Label"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Actor"})]})}),o.jsx("tbody",{children:(r.nodes||r.steps).map((l,c)=>o.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[o.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:l.node_id||`step_${c+1}`}),o.jsx("td",{className:"px-3 py-2",children:o.jsx(hB,{type:l.type||"action"})}),o.jsx("td",{className:"px-3 py-2",style:{color:"#1e293b"},children:l.label||l.action||"-"}),o.jsx("td",{className:"px-3 py-2",style:{color:"#64748b"},children:l.actor||"-"})]},l.node_id||c))})]})})]}),r.edges&&r.edges.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:"Edges"}),o.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"#f1f5f9"},children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"From"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"To"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Label"})]})}),o.jsx("tbody",{children:r.edges.map((l,c)=>o.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[o.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:l.from_node_id}),o.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:l.to_node_id}),o.jsx("td",{className:"px-3 py-2",children:o.jsx(mB,{type:l.type||"normal"})}),o.jsx("td",{className:"px-3 py-2",style:{color:"#64748b"},children:l.label||"-"})]},l.edge_id||c))})]})})]}),o.jsxs("details",{className:"rounded border",style:{borderColor:"#e2e8f0"},children:[o.jsx("summary",{className:"px-3 py-2 cursor-pointer text-sm font-medium",style:{background:"#f1f5f9",color:"#64748b"},children:"Raw JSON"}),o.jsx("div",{className:"p-3 overflow-auto",style:{background:"#ffffff"},children:o.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap",style:{color:"#374151",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]})]})]})})}function fg({label:e,value:t,isText:r=!1}){return o.jsxs("div",{className:"px-3 py-1.5 rounded",style:{background:"#e0e7ff",color:"#4338ca"},children:[o.jsxs("span",{className:"text-xs font-medium",children:[e,": "]}),o.jsx("span",{className:`text-sm font-semibold ${r?"":"tabular-nums"}`,children:t})]})}function hB({type:e}){const t={start:{bg:"#dcfce7",color:"#166534"},end:{bg:"#fee2e2",color:"#991b1b"},action:{bg:"#dbeafe",color:"#1e40af"},gate:{bg:"#fef3c7",color:"#92400e"},decision:{bg:"#fef3c7",color:"#92400e"},error:{bg:"#fee2e2",color:"#991b1b"}},r=t[e]||t.action;return o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:r.bg,color:r.color},children:e})}function mB({type:e}){const t={normal:{bg:"#f1f5f9",color:"#64748b"},error:{bg:"#fee2e2",color:"#991b1b"},retry:{bg:"#fef3c7",color:"#92400e"},conditional:{bg:"#e0e7ff",color:"#4338ca"}},r=t[e]||t.normal;return o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:r.bg,color:r.color},children:e})}const gB={archWorkflowNode:U4},xB=300,vB=140;function yB(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const r=[...e].sort((s,i)=>(s.step||s.order||0)-(i.step||i.order||0)).map((s,i)=>({...s,node_id:`step_${i+1}`,type:s.type||"action",label:s.action||s.label||`Step ${i+1}`})),n=[];for(let s=0;s<r.length-1;s++)n.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:r[s].node_id,to_node_id:r[s+1].node_id,type:"normal"});return{nodes:r,edges:n}}function bB(e,t,r=!1){const n=e.map(a=>{const l=wc[a.type]||wc.action;return{id:a.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...a,config:l,showLineage:r}}}),s=t.map(a=>{const l=a.type||"normal",c=jc[l]||jc.normal;return{id:a.edge_id,source:a.from_node_id,target:a.to_node_id,type:"smoothstep",animated:c.animated||!1,label:a.label,style:{stroke:c.stroke,strokeWidth:c.strokeWidth,strokeDasharray:c.strokeDasharray},labelStyle:{fontSize:10,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:c.stroke}}});return{nodes:_c(n,s,"TB",xB,vB),edges:s}}function _B({workflows:e}){var u;const[t,r]=m.useState(((u=e[0])==null?void 0:u.id)||null),[n,s]=m.useState(!1),[i,a]=m.useState(!1),l=e.find(f=>f.id===t),c=m.useMemo(()=>{var _;if(!((_=l==null?void 0:l.block)!=null&&_.data))return null;const f=l.block.data,p=Array.isArray(f.nodes)&&f.nodes.length>0,h=Array.isArray(f.steps)&&f.steps.length>0;let v,g;if(p)v=f.nodes,g=f.edges||[];else if(h){const x=yB(f.steps);v=x.nodes,g=x.edges}else return null;return bB(v,g,n)},[l,n]),d=f=>{const p=e.findIndex(h=>h.id===t);f.key==="ArrowDown"&&p<e.length-1?(f.preventDefault(),r(e[p+1].id)):f.key==="ArrowUp"&&p>0&&(f.preventDefault(),r(e[p-1].id))};return o.jsxs("div",{className:"flex h-full",onKeyDown:d,tabIndex:0,children:[o.jsx("div",{className:"flex-shrink-0 border-r overflow-y-auto",style:{width:220,background:"#f8fafc",borderColor:"#e2e8f0"},onWheel:f=>f.stopPropagation(),children:o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#64748b"},children:["Workflows (",e.length,")"]}),e.map(f=>{const p=f.id===t;return o.jsxs("button",{onClick:()=>r(f.id),className:"w-full text-left p-2.5 rounded-md mb-1 transition-colors",style:{background:p?"#eef2ff":"transparent",borderLeft:p?"3px solid #4f46e5":"3px solid transparent"},children:[o.jsx("div",{className:"text-sm font-medium truncate",style:{color:p?"#4f46e5":"#1e293b"},children:f.name}),o.jsxs("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:[f.nodeCount," steps"]})]},f.id)})]})}),o.jsx("div",{className:"flex-1 flex flex-col min-w-0",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-b",style:{borderColor:"#e2e8f0"},children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",style:{color:"#1e293b"},children:l.name}),l.description&&o.jsx("p",{className:"text-sm mt-0.5",style:{color:"#64748b"},children:l.description}),l.trigger&&o.jsxs("p",{className:"text-sm mt-1 italic",style:{color:"#9ca3af"},children:["Trigger: ",l.trigger]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>s(f=>!f),className:"px-3 py-1.5 text-xs font-medium rounded transition-colors",style:{background:n?"#eef2ff":"#f1f5f9",color:n?"#4f46e5":"#64748b",border:`1px solid ${n?"#c7d2fe":"#e2e8f0"}`},children:n?"Hide Lineage":"Show Lineage"}),o.jsx("button",{onClick:()=>a(!0),className:"px-3 py-1.5 text-xs font-medium rounded transition-colors",style:{background:"#f1f5f9",color:"#64748b",border:"1px solid #e2e8f0"},children:"Audit"})]})]})}),o.jsx("div",{className:"flex-1 min-h-0",style:{background:"#ffffff"},children:c&&c.nodes.length>0?o.jsx(Ii,{children:o.jsx(wa,{nodes:c.nodes,edges:c.edges,nodeTypes:gB,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!0,fitView:!0,fitViewOptions:{padding:.15},proOptions:{hideAttribution:!0},minZoom:.2,maxZoom:2})}):o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"No workflow steps defined"})})]}):o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"Select a workflow from the list"})}),i&&l&&o.jsx(pB,{workflow:l,onClose:()=>a(!1)})]})}function wB({components:e}){var a,l,c,d;const[t,r]=m.useState(((a=e[0])==null?void 0:a.id)||null),n=e.find(u=>u.id===t),s=u=>{const f=e.findIndex(p=>p.id===t);u.key==="ArrowDown"&&f<e.length-1?(u.preventDefault(),r(e[f+1].id)):u.key==="ArrowUp"&&f>0&&(u.preventDefault(),r(e[f-1].id))},i=(u,f)=>({fontSize:12,padding:"3px 10px",background:u,color:f,borderRadius:4,fontWeight:500});return o.jsxs("div",{className:"flex h-full",onKeyDown:s,tabIndex:0,children:[o.jsx("div",{className:"flex-shrink-0 border-r overflow-y-auto",style:{width:220,background:"#f8fafc",borderColor:"#e2e8f0"},onWheel:u=>u.stopPropagation(),children:o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#64748b"},children:["Components (",e.length,")"]}),e.map(u=>{const f=u.id===t;return o.jsxs("button",{onClick:()=>r(u.id),className:"w-full text-left p-2.5 rounded-md mb-1 transition-colors",style:{background:f?"#eef2ff":"transparent",borderLeft:f?"3px solid #4f46e5":"3px solid transparent"},children:[o.jsx("div",{className:"text-sm font-medium truncate",style:{color:f?"#4f46e5":"#1e293b"},children:u.name}),u.layer&&o.jsx("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:u.layer})]},u.id)})]})}),o.jsx("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto",onWheel:u=>u.stopPropagation(),children:n?o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("h2",{className:"text-xl font-semibold",style:{color:"#1e293b"},children:n.name}),n.layer&&o.jsx("span",{style:i("#f0fdf4","#166534"),children:n.layer}),n.mvpPhase&&o.jsx("span",{style:i("#eff6ff","#1e40af"),children:n.mvpPhase})]}),n.purpose&&o.jsx("p",{className:"text-base",style:{color:"#475569",lineHeight:1.6},children:n.purpose})]}),n.technology&&o.jsx(ll,{title:"Technology",children:o.jsx("p",{style:{color:"#374151",fontSize:14},children:n.technology})}),((l=n.responsibilities)==null?void 0:l.length)>0&&o.jsx(ll,{title:"Responsibilities",children:o.jsx("ul",{className:"list-disc pl-5 space-y-1",children:n.responsibilities.map((u,f)=>o.jsx("li",{style:{color:"#374151",fontSize:14},children:u},f))})}),((c=n.interfaces)==null?void 0:c.length)>0&&o.jsx(ll,{title:"Interfaces",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:n.interfaces.map((u,f)=>o.jsx("span",{style:i("#e0e7ff","#3730a3"),children:u},f))})}),((d=n.dependencies)==null?void 0:d.length)>0&&o.jsx(ll,{title:"Dependencies",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:n.dependencies.map((u,f)=>o.jsx("span",{style:i("#fef3c7","#92400e"),children:u},f))})})]}):o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"Select a component from the list"})})]})}function ll({title:e,children:t}){return o.jsxs("div",{className:"mb-5",children:[o.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#6b7280"},children:e}),t]})}const jB=[{id:"overview",label:"Overview"},{id:"components",label:"Components"},{id:"workflows",label:"Workflows"}];function SB({renderModel:e,projectCode:t,onClose:r}){const[n,s]=m.useState("overview"),{workflowSections:i,componentSections:a,overviewSections:l}=m.useMemo(()=>{if(!(e!=null&&e.sections))return{workflowSections:[],componentSections:[],overviewSections:[]};const h=[],v=[],g=[];return e.sections.forEach(_=>{_.section_id==="workflows"||_.title==="Workflows"?h.push(_):_.section_id==="components"||_.title==="Components"?v.push(_):g.push(_)}),{workflowSections:h,componentSections:v,overviewSections:g}},[e==null?void 0:e.sections]),c=m.useMemo(()=>{if(!i.length)return[];const h=i[0];return h!=null&&h.blocks?h.blocks.map((v,g)=>{var _,x,y,b,w,k,C;return{id:v.block_id||`wf-${g}`,name:((_=v.data)==null?void 0:_.name)||`Workflow ${g+1}`,description:(x=v.data)==null?void 0:x.description,trigger:(y=v.data)==null?void 0:y.trigger,nodeCount:((w=(b=v.data)==null?void 0:b.nodes)==null?void 0:w.length)||((C=(k=v.data)==null?void 0:k.steps)==null?void 0:C.length)||0,block:v}}):[]},[i]),d=m.useMemo(()=>{if(!a.length)return[];const h=a[0];return h!=null&&h.blocks?h.blocks.map((v,g)=>{const _=v.data||{};return{id:v.block_id||`comp-${g}`,name:_.name||`Component ${g+1}`,purpose:_.purpose,layer:_.layer,mvpPhase:_.mvp_phase,technology:_.technology||(Array.isArray(_.technology_choices)?_.technology_choices.join(", "):null),interfaces:_.interfaces||[],dependencies:_.dependencies||_.depends_on_components||[],responsibilities:_.responsibilities||[],block:v}}):[]},[a]),u=m.useMemo(()=>e?{...e,sections:l}:null,[e,l]),f=c.length>0,p=d.length>0;return o.jsxs("div",{className:"flex flex-col h-full",style:{background:"#ffffff"},children:[o.jsxs("div",{className:"flex items-center gap-1 px-4 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0",minHeight:44},children:[t&&o.jsx("span",{style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",marginRight:12},children:t}),jB.map(h=>{const v=n===h.id,g=h.id==="workflows"&&!f,_=h.id==="components"&&!p,x=g||_;let y=null;return h.id==="workflows"&&f&&(y=c.length),h.id==="components"&&p&&(y=d.length),o.jsxs("button",{onClick:()=>!x&&s(h.id),disabled:x,className:"relative px-4 py-2 text-sm font-medium transition-colors",style:{color:v?"#4f46e5":x?"#9ca3af":"#64748b",background:"transparent",border:"none",cursor:x?"not-allowed":"pointer"},children:[h.label,y!==null&&o.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs rounded-full",style:{background:v?"#eef2ff":"#f1f5f9",color:v?"#4f46e5":"#64748b"},children:y}),v&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"#4f46e5"}})]},h.id)})]}),o.jsx("div",{className:"flex-1 overflow-hidden",style:{minHeight:0},children:n==="workflows"&&f?o.jsx(_B,{workflows:c}):n==="components"&&p?o.jsx(wB,{components:d}):o.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:h=>h.stopPropagation(),children:u&&l.length>0?o.jsx(G4,{renderModel:u,variant:"full",hideHeader:!0}):o.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})})})]})}function kB({projectId:e,projectCode:t,docTypeId:r,onClose:n}){var g;const[s,i]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState(!0),[p,h]=m.useState(null);return m.useEffect(()=>{async function _(){var x;try{f(!0),h(null),Ye.getDocumentPgc(e,r).then(b=>{b!=null&&b.has_pgc&&d(b)}).catch(()=>{});try{const b=await Ye.getDocumentRenderModel(e,r);if(b&&b.sections&&b.sections.length>0){i(b),l(null);return}if((x=b==null?void 0:b.metadata)!=null&&x.fallback&&b.raw_content){i(null),l(b.raw_content);return}}catch(b){console.log("RenderModel not available, falling back to raw document:",b.message)}const y=await Ye.getDocument(e,r);i(null),l((y==null?void 0:y.content)||null)}catch(y){h(y.message),console.error("Failed to fetch document:",y)}finally{f(!1)}}_()},[e,r]),m.useEffect(()=>{const _=x=>{x.key==="Escape"&&n()};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[n]),u?o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:o.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):r==="technical_architecture"&&s?o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:_=>_.target===_.currentTarget&&n(),children:o.jsxs("div",{className:"relative w-full max-w-6xl h-[90vh] overflow-hidden rounded-lg shadow-2xl flex flex-col",style:{background:"#ffffff"},children:[o.jsx("button",{onClick:n,className:"absolute top-2 right-3 z-10 p-1.5 rounded-lg hover:bg-gray-200 transition-colors",style:{background:"rgba(255,255,255,0.9)"},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),o.jsx(SB,{renderModel:s,projectCode:t,pgcContext:c,onClose:n})]})}):o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:_=>_.target===_.currentTarget&&n(),children:o.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[o.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsx("div",{children:t&&o.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),o.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},onWheel:_=>_.stopPropagation(),children:[p&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-red-500",children:p})}),s&&o.jsx(G4,{renderModel:s,variant:"full"}),a&&!s&&o.jsx(NB,{content:a,docTypeId:r}),!s&&!a&&!p&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-500",children:"No content available"})}),c&&((g=c.clarifications)==null?void 0:g.length)>0&&o.jsx(AB,{pgcContext:c})]})]})})}function NB({content:e,docTypeId:t}){if(!e)return o.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n={preliminary_summary:{title:"Summary",icon:"S",color:"#7c3aed",render:"summary"},stakeholder_questions:{title:"Stakeholder Questions",icon:"?",color:"#dc2626",render:"questions"},unknowns:{title:"Unknowns to Resolve",icon:"?",color:"#d97706"},early_decision_points:{title:"Early Decision Points",icon:"D",color:"#7c3aed"},risks:{title:"Risks",icon:"!",color:"#dc2626"},known_constraints:{title:"Known Constraints",icon:"C",color:"#6b7280"},assumptions:{title:"Assumptions",icon:"A",color:"#d97706"},mvp_guardrails:{title:"MVP Guardrails",icon:"G",color:"#059669"},recommendations_for_pm:{title:"Recommendations for PM",icon:"R",color:"#2563eb"},pgc_clarifications:{title:"PGC Clarifications",icon:"Q",color:"#7c3aed",render:"clarifications"}},s=new Set(["project_name","title","name","meta","description","summary"]),i=Object.keys(e).filter(l=>!s.has(l)&&(Array.isArray(e[l])||typeof e[l]=="object"&&e[l]!==null));return i.length>0?o.jsxs("div",{className:"space-y-6",children:[r&&o.jsxs("div",{style:{borderBottom:"2px solid #7c3aed",paddingBottom:12},children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r}),o.jsx("span",{className:"text-xs font-mono text-gray-400",children:t})]}),Object.entries(n).map(([l,c])=>{const d=e[l];return d?c.render==="summary"&&typeof d=="object"&&!Array.isArray(d)?o.jsx(CB,{data:d,config:c},l):c.render==="questions"&&Array.isArray(d)?o.jsx(EB,{data:d,config:c},l):c.render==="clarifications"&&Array.isArray(d)?o.jsx(TB,{data:d,config:c},l):Array.isArray(d)?o.jsx(eS,{data:d,config:c},l):null:null}),i.filter(l=>!n[l]).map(l=>{const c=e[l];return Array.isArray(c)?o.jsx(eS,{data:c,config:{title:oa(l),icon:"#",color:"#6b7280"}},l):typeof c=="object"&&c!==null?o.jsx(IB,{data:c,label:oa(l)},l):null}),o.jsxs("details",{style:{borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("summary",{style:{padding:"12px 16px",cursor:"pointer",fontSize:13,fontWeight:600,color:"#6b7280",background:"#f8fafc",borderRadius:8},children:"Raw Data (JSON)"}),o.jsx("div",{style:{padding:16,overflow:"auto"},children:o.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(e,null,2)})})]})]}):o.jsx(PB,{content:e,docTypeId:t,title:r})}function CB({data:e,config:t}){const r=[{key:"problem_understanding",label:"Problem Understanding"},{key:"architectural_intent",label:"Architectural Intent"},{key:"proposed_system_shape",label:"Proposed System Shape"}];return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(Su,{config:t}),o.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.map(n=>e[n.key]?o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:n.label}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:e[n.key]})]},n.key):null),Object.entries(e).filter(([n])=>!r.some(s=>s.key===n)).map(([n,s])=>typeof s=="string"?o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:oa(n)}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:s})]},n):null)]})]})}function EB({data:e,config:t}){const r=e.filter(s=>s.blocking),n=e.filter(s=>!s.blocking);return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(Su,{config:t,count:e.length}),o.jsxs("div",{style:{padding:16},className:"space-y-3",children:[r.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#dc2626",marginBottom:8,textTransform:"uppercase"},children:"Blocking"}),r.map((s,i)=>o.jsx(Z2,{q:s,borderColor:"#dc2626"},s.id||i))]}),n.length>0&&o.jsxs("div",{children:[r.length>0&&o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,textTransform:"uppercase"},children:"Non-blocking"}),n.map((s,i)=>o.jsx(Z2,{q:s,borderColor:"#d1d5db"},s.id||i))]})]})]})}function Z2({q:e,borderColor:t}){return o.jsxs("div",{style:{borderLeft:`3px solid ${t}`,paddingLeft:12,marginBottom:8},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2},children:[e.id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.id}),e.directed_to&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.directed_to.replace(/_/g," ")})]}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,fontWeight:500},children:e.question||e.text||MB(e)}),e.notes&&o.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0 0"},children:e.notes})]})}function TB({data:e,config:t}){const r={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}};return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(Su,{config:t,count:e.length}),o.jsx("div",{style:{padding:16},className:"space-y-3",children:e.map((n,s)=>{const i=r[n.constraint_kind]||r.selection;return o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12,marginBottom:8},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[n.question_id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:n.question_id}),n.binding&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),n.constraint_kind&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:i.bg,color:i.color,borderRadius:4},children:n.constraint_kind}),n.binding_source&&o.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",n.binding_source]})]}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:n.question}),n.why_it_matters&&o.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:n.why_it_matters}),n.answer&&o.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[o.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),o.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:n.answer})]})]},n.question_id||s)})})]})}function AB({pgcContext:e}){const{clarifications:t}=e,r=t.filter(s=>s.binding),n=t.filter(s=>!s.binding);return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,marginTop:24},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[o.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:"#7c3aed15",color:"#7c3aed"},children:"Q"}),o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:"Pre-Generation Clarifications"}),o.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t.length})]}),o.jsxs("div",{style:{padding:16},className:"space-y-4",children:[r.length>0&&o.jsxs("div",{children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#1e40af",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Binding Constraints (",r.length,")"]}),r.map((s,i)=>o.jsx(J2,{item:s},s.question_id||i))]}),n.length>0&&o.jsxs("div",{children:[r.length>0&&o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,marginTop:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Informational (",n.length,")"]}),n.map((s,i)=>o.jsx(J2,{item:s},s.question_id||i))]})]})]})}function J2({item:e}){const t={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}},r=t[e.constraint_kind]||t.selection;return o.jsxs("div",{style:{borderLeft:`3px solid ${e.binding?"#3b82f6":"#d1d5db"}`,paddingLeft:12,marginBottom:12},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[e.question_id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.question_id}),e.binding&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),e.constraint_kind&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:r.bg,color:r.color,borderRadius:4},children:e.constraint_kind}),e.binding_source&&o.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",e.binding_source]})]}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:e.question}),e.why_it_matters&&o.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:e.why_it_matters}),e.answer&&o.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[o.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),o.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:e.answer})]})]})}function eS({data:e,config:t}){return!e||e.length===0?null:o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(Su,{config:t,count:e.length}),o.jsx("div",{style:{padding:16},children:o.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((r,n)=>o.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"#374151"},children:[o.jsx("span",{style:{color:t.color,marginTop:2,flexShrink:0,fontSize:12},children:t.icon==="!"?"":""}),o.jsx("div",{style:{flex:1},children:typeof r=="string"?o.jsx("span",{children:r}):typeof r=="object"&&r!==null?o.jsx(RB,{item:r}):o.jsx("span",{children:String(r)})})]},typeof r=="object"&&r.id||n))})})]})}function RB({item:e}){const r=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title"].find(h=>e[h]&&typeof e[h]=="string"),n=r?e[r]:null,s=e.id,i=e.confidence,a=e.constraint_type,l=e.validation_approach,c=e.impact_on_planning||e.impact_if_unresolved,d=e.mitigation_direction,u=e.likelihood,f=e.why_it_matters||e.why_early,p=e.recommendation_direction;return n?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:s}),o.jsx("span",{style:{fontWeight:500},children:n}),a&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:a}),i&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:i==="high"?"#dcfce7":i==="medium"?"#fef3c7":"#fee2e2",color:i==="high"?"#166534":i==="medium"?"#92400e":"#991b1b"},children:i}),u&&o.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[u,"/",e.impact||"?"]})]}),l&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Validation: ",l]}),f&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Why: ",f]}),c&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Impact: ",c]}),d&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Mitigation: ",d]}),p&&o.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",p]})]}):o.jsx("span",{style:{fontSize:13,color:"#374151"},children:Object.entries(e).map(([h,v],g)=>o.jsxs("span",{children:[g>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[oa(h),":"]})," ",typeof v=="string"?v:JSON.stringify(v)]},h))})}function IB({data:e,label:t}){return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontWeight:600,fontSize:14,color:"#1f2937"},children:t}),o.jsx("div",{style:{padding:16},children:Object.entries(e).map(([r,n])=>o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:oa(r)}),o.jsx("div",{style:{fontSize:14,color:"#1f2937"},children:typeof n=="string"?n:typeof n=="object"?JSON.stringify(n,null,2):String(n)})]},r))})]})}function Su({config:e,count:t}){return o.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[o.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:`${e.color}15`,color:e.color},children:e.icon}),o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:e.title}),t!==void 0&&o.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t})]})}function PB({content:e,docTypeId:t,title:r}){return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",o.jsx("strong",{children:t})," - displaying raw content"]}),r&&o.jsx("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r})}),o.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:n=>n.stopPropagation(),children:o.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}function MB(e){if(typeof e=="string")return e;if(typeof e!="object"||e===null)return String(e);for(const t of Object.values(e))if(typeof t=="string"&&t.length>10)return t;return JSON.stringify(e)}function oa(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}const OB="/api/v1/admin";class DB extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function LB(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ne(e,t={}){var i;const r=`${OB}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const a=LB();a&&(n.headers["X-CSRF-Token"]=a)}const s=await fetch(r,n);if(!s.ok){const a=await s.json().catch(()=>({})),l=((i=a.detail)==null?void 0:i.message)||a.detail||`Request failed: ${s.status}`;throw new DB(l,s.status,a.detail||a)}return s.status===204?null:s.json()}const be={getCurrentWorkspace:async()=>{try{return await Ne("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ne("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ne(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ne(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ne(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ne(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ne(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ne(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ne("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ne(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ne("/workbench/prompt-fragments"),getRoles:()=>Ne("/workbench/roles"),getTemplates:()=>Ne("/workbench/templates"),getSchemas:()=>Ne("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ne("/workbench/workflows"),getOrchestrationWorkflows:()=>Ne("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ne(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ne(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ne(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ne(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ne("/workbench/active-releases"),invalidateCache:()=>Ne("/workbench/invalidate-cache",{method:"POST"}),getMechanicalOpTypes:()=>Ne("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Ne(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Ne("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Ne("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/mechanical-ops/${e}${r}`)}};function zB({projectId:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[i,a]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,v]=m.useState(!1),[g,_]=m.useState(null),[x,y]=m.useState(!1),[b,w]=m.useState(!1),k=m.useCallback(async()=>{try{const S=((await be.getOrchestrationWorkflows()).workflows||[]).filter(M=>M.workflow_id!=="intake_and_route"),I=S.find(M=>M.workflow_id==="software_product_development")||S[0];if(I){const M=await Ye.createWorkflowInstance(e,I.workflow_id,I.active_version);r(M)}}catch(F){console.error("Failed to auto-assign workflow:",F)}},[e]),C=m.useCallback(async()=>{if(e){s(!0),a(null);try{const F=await Ye.getWorkflowInstance(e);r(F)}catch(F){F.status===404?(r(null),await k()):a(F.message)}finally{s(!1)}}},[e,k]);m.useEffect(()=>{C()},[C]);const N=async()=>{c(!0),p(!0);try{const S=((await be.getOrchestrationWorkflows()).workflows||[]).filter(I=>I.workflow_id!=="intake_and_route");u(S)}catch{u([])}finally{p(!1)}},E=async F=>{v(!0);try{const S=await Ye.createWorkflowInstance(e,F.workflow_id,F.active_version);r(S),c(!1)}catch(S){a(S.message)}finally{v(!1)}},j=async()=>{if(t&&(w(!b),!g)){y(!0);try{const F=await Ye.getWorkflowDrift(e);_(F)}catch(F){_({error:F.message})}finally{y(!1)}}};if(n)return o.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(i&&!t)return o.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:i});if(!t)return o.jsxs("div",{className:"p-4",children:[o.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?o.jsx(FB,{workflows:d,loading:f,assigning:h,onSelect:E,onCancel:()=>c(!1)}):o.jsx("button",{onClick:N,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const A=t.effective_workflow||{},T=A.steps||[],D=t.base_workflow_ref||{};return o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:A.name||D.workflow_id||"Workflow"}),o.jsx($B,{status:t.status})]}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",D.workflow_id," v",D.version,D.pow_class?` (${D.pow_class})`:""]})]}),o.jsx("button",{onClick:j,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:x?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&o.jsx(qB,{drift:g}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",T.length,")"]}),T.length===0?o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):o.jsx("div",{className:"space-y-1",children:T.map((F,S)=>o.jsx(BB,{step:F,index:S},F.step_id||S))})]}),i&&o.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:i})]})}function FB({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:s}){const i=e.filter(l=>(l.pow_class||"reference")==="reference"),a=e.filter(l=>l.pow_class==="template");return o.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):o.jsxs(o.Fragment,{children:[i.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),i.map(l=>o.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[o.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),a.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),a.map(l=>o.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[o.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),i.length===0&&a.length===0&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),o.jsx("button",{onClick:s,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function $B({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function qB({drift:e}){return e.error?o.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):o.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[o.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[o.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),o.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&o.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&o.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&o.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&o.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&o.jsx("div",{children:"~ Metadata changed"})]})]})}function BB({step:e,index:t}){return o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),o.jsxs("div",{style:{flex:1},children:[o.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&o.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&o.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}const tS=(e,t)=>{const r=new yc.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),yc.layout(r),{nodes:e.map(n=>{const s=r.node(n.id);return{...n,targetPosition:ce.Top,sourcePosition:ce.Bottom,position:{x:s.x-(n.data.width??280)/2,y:s.y-(n.data.height??90)/2}}}),edges:t}},rS=(e,t,r)=>{let n=[],s=[],i=null,a=null,l=[];const c=r.theme||"industrial";return e.forEach((d,u)=>{var v,g;if((d.level||1)!==1)return;const f=280;let p=95;d.state==="active"&&d.stations&&(p+=35);const h=t===d.id;if(n.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),i){const _=(v=e[u-1])==null?void 0:v.state;s.push({id:"e-"+i+"-"+d.id,source:i,target:d.id,type:"smoothstep",animated:_==="active",style:{stroke:TE(_,c),strokeWidth:3}})}((g=d.children)==null?void 0:g.length)>0&&(a=d.id,l=d.children),i=d.id}),{nodes:n,edges:s,epicBacklogId:a,epicChildren:l}},nS=(e,t,r,n,s)=>{const{nodes:i,edges:a}=e;if(!t||!r.length)return{nodes:i,edges:a};const l=i.find(b=>b.id===t);if(!l)return{nodes:i,edges:a};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=s.theme||"industrial",p=TE(u,f),h=u==="active",v=jr.EPIC_HEIGHT+jr.EPIC_GAP_Y,g=Math.ceil(r.length/jr.EPICS_PER_ROW),_=c+280*.15,x=50,y={};r.forEach((b,w)=>{const k=Math.floor(w/jr.EPICS_PER_ROW);y[k]||(y[k]=[]),y[k].push({epic:b,idx:w})});for(let b=0;b<g;b++){const w=y[b]||[];if(w.length===0)continue;const k=d+jr.EPIC_OFFSET_Y+b*v,C=`junction-row-${b}`;i.push({id:C,type:"waypoint",position:{x:_,y:k-x},draggable:!1,connectable:!1,selectable:!1}),b===0?a.push({id:`e-spine-drop-${b}`,source:t,target:C,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):a.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:C,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),w.forEach(({epic:N,idx:E})=>{const j=E%jr.EPICS_PER_ROW,A=c+jr.EPIC_OFFSET_X+j*(jr.EPIC_WIDTH+jr.EPIC_GAP_X),T=k,D=n===N.id;i.push({id:N.id,type:"documentNode",data:{...N,width:jr.EPIC_WIDTH,height:jr.EPIC_HEIGHT,isExpanded:D,...s},draggable:!1,connectable:!1,position:{x:A,y:T},targetPosition:ce.Top,sourcePosition:ce.Bottom,zIndex:D?1e3:0}),a.push({id:`e-branch-${N.id}`,source:C,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:i,edges:a}},WB={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"};function HB(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function VB(e,t=[]){const r=[],n=[],s={};for(const i of e.tracks){const a=UB(i,t);if((i.scope||"project")==="project")n.push({...a,mayOwn:i.may_own||[],childDocType:i.child_doc_type});else{const c=i.document_type;s[c]||(s[c]=[]),s[c].push(a)}}for(const i of n)i.childDocType&&s[i.childDocType]&&(i.children=s[i.childDocType].map(a=>({...a,level:2}))),r.push(i);return r}function UB(e,t=[]){var l,c,d;const r=WB[e.state]||"ready_for_production",n=e.state==="awaiting_operator",s=t.find(u=>u.document_type===e.document_type);let i=null;(r==="in_production"||n)&&(i=GB(e.stations,e.state,e.station));let a=null;if(s){const u=s.questions||((c=(l=s.payload)==null?void 0:l.data)==null?void 0:c.questions)||(Array.isArray((d=s.payload)==null?void 0:d.data)?s.payload.data:null);u&&Array.isArray(u)&&(a=u.map((f,p)=>({id:f.id||`q${p+1}`,text:f.question||f.text||f,required:f.required!==!1,choices:f.choices||null,answer_type:f.answer_type||"text",why_it_matters:f.why_it_matters||null,priority:f.priority||null,blocking:f.blocking!==!1,default:f.default||null,constraint_kind:f.constraint_kind||null})))}return{id:e.document_type,name:e.document_name||KB(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:i,questions:a,interruptId:s==null?void 0:s.id,blockedBy:e.blocked_by||[]}}function GB(e,t,r){return!e||e.length===0?null:e.map(n=>({id:n.station,label:n.label||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function KB(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function YB({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,s]=m.useState(!0),[i,a]=m.useState(null),l=m.useCallback(async()=>{s(!0),a(null);try{const d=await Ye.getProjects({includeArchived:e}),u=HB(d);r(u)}catch(d){a(d.message),console.error("Failed to fetch projects:",d)}finally{s(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await Ye.createProject({name:d,description:""});return r(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw a(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:i,addProject:c,refresh:l}}function XB(e){const[t,r]=m.useState([]),[n,s]=m.useState("idle"),[i,a]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(null),g=m.useRef(null),_=m.useRef(null),x=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[N,E]=await Promise.all([Ye.getProductionStatus(e),Ye.getProjectInterrupts(e).catch(()=>[])]);a(E),s(N.line_state),r(VB(N,E))}catch(N){u(N.message),console.error("Failed to fetch production status:",N)}finally{c(!1)}},[e]),y=m.useCallback(()=>{if(!e)return;g.current&&g.current.close();const N=R8(e);g.current=N,N.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),N.addEventListener("station_transition",E=>{try{const j=JSON.parse(E.data);console.log("Station transition:",j),x()}catch(j){console.error("Failed to parse station_transition:",j)}}),N.addEventListener("line_stopped",E=>{try{const j=JSON.parse(E.data);console.log("Line stopped:",j),s("stopped"),x()}catch(j){console.error("Failed to parse line_stopped:",j)}}),N.addEventListener("production_complete",E=>{try{const j=JSON.parse(E.data);console.log("Production complete:",j),s("complete"),x()}catch(j){console.error("Failed to parse production_complete:",j)}}),N.addEventListener("interrupt_resolved",E=>{try{const j=JSON.parse(E.data);console.log("Interrupt resolved:",j),x()}catch(j){console.error("Failed to parse interrupt_resolved:",j)}}),N.addEventListener("track_started",E=>{try{const j=JSON.parse(E.data);console.log("Track started:",j),s("active"),x()}catch(j){console.error("Failed to parse track_started:",j)}}),N.addEventListener("track_stabilized",E=>{try{const j=JSON.parse(E.data);console.log("Track stabilized:",j),x()}catch(j){console.error("Failed to parse track_stabilized:",j)}}),N.addEventListener("stations_declared",E=>{try{const j=JSON.parse(E.data);console.log("Stations declared:",j);const{document_type:A,stations:T}=j;r(D=>{const F=D.some(I=>I.id===A);console.log("stations_declared raw stations:",T);const S=T.map(I=>({id:I.id,label:I.label,state:I.state,phases:I.phases||[],phase:null}));return console.log("stations_declared processed:",S),F?D.map(I=>I.id===A?{...I,state:"in_production",stations:S}:I):[...D,{id:A,name:A.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase()),state:"in_production",stations:S}]})}catch(j){console.error("Failed to parse stations_declared:",j)}}),N.addEventListener("station_changed",E=>{try{const j=JSON.parse(E.data);console.log("Station changed:",j);const{document_type:A,station_id:T,state:D}=j;r(F=>F.map(S=>S.id!==A||!S.stations?S:{...S,stations:S.stations.map(I=>I.id===T?{...I,state:D}:I)}))}catch(j){console.error("Failed to parse station_changed:",j)}}),N.addEventListener("internal_step",E=>{try{const j=JSON.parse(E.data);console.log("Internal step:",j);const{document_type:A,station_id:T,step:D}=j;r(F=>F.map(S=>S.id!==A||!S.stations?S:{...S,stations:S.stations.map(I=>I.id===T?{...I,currentStep:D}:I)}))}catch(j){console.error("Failed to parse internal_step:",j)}}),N.onerror=E=>{console.error("SSE error:",E),p(!1),u("Connection lost"),N.close(),_.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),y()},3e3)}},[e,x]),b=m.useCallback(()=>{_.current&&clearTimeout(_.current),g.current&&(g.current.close(),g.current=null),p(!1)},[]),w=m.useCallback(async(N,E)=>{try{await Ye.resolveInterrupt(N,{answers:E})}catch(j){throw console.error("Failed to resolve interrupt:",j),j}},[]),k=m.useCallback(async(N=null)=>{var E;try{v(null),await Ye.startProduction(e,N),s("active")}catch(j){console.error("Failed to start production:",j);const A=((E=j.data)==null?void 0:E.message)||j.message||"Failed to start production";throw v({type:"error",message:A}),N&&r(T=>T.map(D=>D.id===N?{...D,state:"ready_for_production",stations:null}:D)),s("idle"),x(),j}},[e,x]),C=m.useCallback(()=>{v(null)},[]);return m.useEffect(()=>(x(),y(),()=>b()),[x,y,b]),{data:t,lineState:n,interrupts:i,loading:l,error:d,connected:f,notification:h,dismissNotification:C,refresh:x,resolveInterrupt:w,startProduction:k}}const sS="combine-theme";function K4(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const i=localStorage.getItem(sS);return i&&In.includes(i)?i:e});m.useEffect(()=>{localStorage.setItem(sS,t)},[t]);const n=m.useCallback(i=>{In.includes(i)&&r(i)},[]),s=m.useCallback(()=>{r(i=>{const a=In.indexOf(i);return In[(a+1)%In.length]})},[]);return{theme:t,setTheme:n,cycleTheme:s}}function QB(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[s,i]=m.useState([]),[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[v,g]=m.useState([]),[_,x]=m.useState(!1),[y,b]=m.useState(null),[w,k]=m.useState(null),[C,N]=m.useState(null),[E,j]=m.useState(!1),[A,T]=m.useState(!1),[D,F]=m.useState(null),[S,I]=m.useState(null),M=m.useRef(null),z=m.useRef(!0);m.useEffect(()=>(z.current=!0,()=>{z.current=!1,M.current&&M.current.close()}),[]);const P=m.useCallback(H=>{z.current&&(n(H.phase),i(H.messages||[]),l(H.pending_prompt),d(H.pending_choices),f(H.interpretation||{}),h(H.confidence||0),g(H.missing_fields||[]),x(H.can_initialize||!1),b(H.gate_outcome),k(H.project),F(H.intake_classification),I(H.intake_gate_phase))},[]),R=m.useCallback(async()=>{N(null),j(!0);try{const H=await Ye.startIntake();if(!z.current)return;t(H.execution_id),P(H)}catch(H){if(!z.current)return;N(H.message||"Failed to start intake")}finally{z.current&&j(!1)}},[]),L=m.useCallback(async H=>{if(!e||!H.trim())return;N(null),T(!0);const B={role:"user",content:H};i(X=>[...X,B]);try{const X=await Ye.submitIntakeMessage(e,H);if(!z.current)return;P(X)}catch(X){if(!z.current)return;i(ie=>ie.filter(oe=>oe!==B)),N(X.message||"Failed to submit message")}finally{z.current&&T(!1)}},[e,P]),$=m.useCallback(async(H,B)=>{if(e){N(null),f(X=>({...X,[H]:{value:B,source:"user",locked:!0}}));try{const X=await Ye.updateIntakeField(e,H,B);if(!z.current)return;P(X)}catch(X){if(!z.current)return;N(X.message||"Failed to update field");const ie=await Ye.getIntakeState(e);z.current&&P(ie)}}},[e,P]),q=m.useCallback(async()=>{if(!(!e||!_)){N(null),j(!0);try{const H=await Ye.initializeIntake(e);if(!z.current)return;P(H),H.phase==="generating"&&Y()}catch(H){if(!z.current)return;N(H.message||"Failed to initialize project"),j(!1)}}},[e,_,P]),Y=m.useCallback(()=>{M.current&&M.current.close();const H=I8(e);M.current=H,H.addEventListener("started",B=>{if(!z.current)return;const X=JSON.parse(B.data);console.log("Intake started:",X)}),H.addEventListener("progress",B=>{if(!z.current)return;const X=JSON.parse(B.data);console.log("Intake progress:",X.current_node)}),H.addEventListener("complete",async B=>{if(!z.current)return;const X=JSON.parse(B.data);console.log("Intake complete:",X),H.close(),M.current=null,n("complete"),b(X.gate_outcome),k(X.project),j(!1)}),H.addEventListener("error",B=>{if(z.current&&H.readyState!==EventSource.CLOSED){try{const X=JSON.parse(B.data);N(X.message||"Generation failed")}catch{N("Connection lost during generation")}H.close(),M.current=null,j(!1)}}),H.onerror=()=>{z.current&&H.readyState===EventSource.CLOSED&&(M.current=null,j(!1))}},[e]),K=m.useCallback(()=>{M.current&&(M.current.close(),M.current=null),t(null),n("idle"),i([]),l(null),d(null),f({}),h(0),g([]),x(!1),b(null),k(null),N(null),j(!1),T(!1)},[]);return{executionId:e,phase:r,messages:s,pendingPrompt:a,pendingChoices:c,interpretation:u,confidence:p,missingFields:v,canInitialize:_,gateOutcome:y,project:w,error:C,loading:E,submitting:A,intakeClassification:D,intakeGatePhase:S,startIntake:R,submitMessage:L,updateField:$,lockAndGenerate:q,reset:K}}const Y4=m.createContext(null);function ZB({children:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[i,a]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{s(!0),a(null);try{const f=await Ye.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),a(f.message),r(null)}finally{s(!1)}},[]),c=m.useCallback(f=>{window.location.href=P8(f)},[]),d=m.useCallback(async()=>{try{await Ye.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),u={user:t,loading:n,error:i,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return o.jsx(Y4.Provider,{value:u,children:e})}function zi(){const e=m.useContext(Y4);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function JB(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null),c=m.useCallback(async()=>{i(!0),l(null);try{let u=await be.getCurrentWorkspace();u||(u=await be.createWorkspace()),t(u.workspace_id),n(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{i(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await be.closeWorkspace(e,u),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:s,error:a,closeWorkspace:d,reinitialize:c}}function e9(e,t=1e4){var u,f;const[r,n]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){n(null),i(!1);return}try{const p=await be.getWorkspaceState(e);n(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{i(!1)}},[e]);return m.useEffect(()=>{e&&(i(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:r,loading:s,error:a,refresh:d,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((u=r==null?void 0:r.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function t9(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await be.getDocumentTypes();t(l.document_types||[])}catch(l){i(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{documentTypes:e,loading:r,error:s,refresh:a}}function r9(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await be.getRoles();t(l.roles||[])}catch(l){i(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{roles:e,loading:r,error:s,refresh:a}}function Ea(e,t,{debounceMs:r=500,onSave:n}={}){const[s,i]=m.useState(""),[a,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,g]=m.useState(null),_=m.useRef(null),x=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){i(""),l(""),d(!1);return}d(!0),f(null);try{const E=await be.getArtifact(e,t);i(E.content),l(E.content)}catch(E){f(E.message),console.error("Failed to load artifact:",E)}finally{d(!1)}},[e,t]),b=m.useCallback(async E=>{if(!(!e||!t)){h(!0),f(null);try{const j=await be.writeArtifact(e,t,E);g(j),l(E),n&&n(j)}catch(j){f(j.message),console.error("Failed to save artifact:",j)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(E=>{x.current=E,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{x.current!==null&&(b(x.current),x.current=null)},r)},[b,r]),k=m.useCallback(E=>{i(E),E!==a&&w(E)},[a,w]),C=m.useCallback(()=>{_.current&&clearTimeout(_.current),x.current=null,i(a)},[a]),N=m.useCallback(()=>{_.current&&clearTimeout(_.current),s!==a&&b(s)},[s,a,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{content:s,originalContent:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateContent:k,reset:C,saveNow:N,reload:y}}const n9={documentNode:C8,waypoint:E8},s9={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function i9({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:s,theme:i,onThemeChange:a,onProjectUpdate:l,onProjectArchive:c,onProjectUnarchive:d,onProjectDelete:u}){const{data:f,lineState:p,loading:h,error:v,connected:g,notification:_,dismissNotification:x,resolveInterrupt:y,startProduction:b}=XB(e),[w,k]=m.useState([]),[C,N]=m.useState(null),[E,j]=m.useState(null),[A,T]=m.useState(null),[D,F]=m.useState(!1),[S,I]=m.useState(""),[M,z]=m.useState(!1),[P,R]=m.useState(!1),[L,$]=m.useState(!1),q=su();m.useEffect(()=>{f.length>0&&k(f)},[f]),m.useEffect(()=>{s&&w.length>0&&setTimeout(()=>{N(s),j("questions")},300)},[s,w.length]),m.useEffect(()=>{N(null),j(null)},[e]);const Y=m.useCallback(()=>{const se=In.indexOf(i);a(In[(se+1)%In.length])},[i,a]),K=m.useCallback(()=>{I(r||""),F(!0)},[r]),H=m.useCallback(async()=>{if(!S.trim()||S===r){F(!1);return}R(!0);try{await l(e,{name:S.trim()}),F(!1)}catch(se){console.error("Failed to update name:",se)}finally{R(!1)}},[S,r,e,l]),B=m.useCallback(()=>{F(!1),I("")},[]),X=m.useCallback(async()=>{R(!0);try{n?await d(e):await c(e)}catch(se){console.error("Failed to toggle archive:",se)}finally{R(!1)}},[e,n,c,d]),ie=m.useCallback(async()=>{R(!0);try{await u(e),z(!1)}catch(se){console.error("Failed to delete:",se)}finally{R(!1)}},[e,u]),oe=m.useCallback(se=>{const fe=q.getNode(se);if(fe){const Q=window.innerWidth,me=-fe.position.x*.9+Q/2-400,qe=-fe.position.y*.9+120;q.setViewport({x:me,y:qe,zoom:.9},{duration:800})}},[q]),J=m.useMemo(()=>({onExpand:(se,fe)=>{N(se),j(fe)},onCollapse:()=>{N(null),j(null),setTimeout(()=>q.fitView({padding:.2,duration:300}),50)},onViewFullDocument:se=>{T(se)},onStartProduction:async se=>{console.log("Starting production for:",se),k(fe=>fe.map(he=>he.id===se?{...he,_prevState:he.state,state:"in_production"}:he));try{await b(se)}catch{k(he=>he.map(Q=>Q.id===se?{...Q,state:Q._prevState||"ready_for_production",stations:null}:Q))}},onSubmitQuestions:async(se,fe)=>{console.log("Submitted:",se,fe),N(null),j(null),k(Q=>{const me=qe=>qe.map(Le=>Le.id===se&&Le.stations?{...Le,state:"in_production",stations:Le.stations.map(Ce=>Ce.id==="pgc"?{...Ce,state:"complete",needs_input:!1}:Ce.id==="asm"?{...Ce,state:"active"}:Ce)}:Le.children?{...Le,children:me(Le.children)}:Le);return me(Q)});const he=w.find(Q=>Q.id===se);if(he!=null&&he.interruptId)try{await y(he.interruptId,fe)}catch(Q){console.error("Failed to submit answers:",Q)}}}),[q,w,y,b]),{layoutNodes:we,layoutEdges:ge}=m.useMemo(()=>{if(w.length===0)return{layoutNodes:[],layoutEdges:[]};const se={...J,expandType:E,theme:i,onZoomToNode:oe,projectId:e,projectCode:t},{nodes:fe,edges:he,epicBacklogId:Q,epicChildren:me}=rS(w,C,se),qe=tS(fe,he),{nodes:Le,edges:Ce}=nS(qe,Q,me,C,se);return{layoutNodes:Le.map(Me=>({...Me,data:{...Me.data,expandType:Me.id===C?E:null}})),layoutEdges:Ce}},[w,C,E,J,i,oe,e,t]),[_e,xe,ae]=SE(we),[U,re,te]=kE(ge);m.useEffect(()=>{if(w.length===0)return;const se={...J,expandType:E,theme:i,onZoomToNode:oe,projectId:e,projectCode:t},{nodes:fe,edges:he,epicBacklogId:Q,epicChildren:me}=rS(w,C,se),qe=tS(fe,he),{nodes:Le,edges:Ce}=nS(qe,Q,me,C,se),Ee=Le.map(Me=>({...Me,data:{...Me.data,expandType:Me.id===C?E:null}}));xe(Ee),re(Ce)},[w,C,E,J,xe,re,i,oe,e,t]);const je=m.useCallback((se,fe)=>{},[]);return h&&w.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):v&&w.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:o.jsx("p",{className:"text-red-500 mb-4",children:v})})}):o.jsxs("div",{className:"w-full h-full",children:[o.jsxs(wa,{nodes:_e,edges:U,onNodesChange:ae,onEdgesChange:te,onNodeClick:je,nodeTypes:n9,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,zoomOnScroll:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[o.jsx(Hn,{position:"top-left",children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),o.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[p==="active"&&o.jsx("span",{className:"text-amber-500",children:" Active"}),p==="stopped"&&o.jsx("span",{className:"text-red-500",children:" Stopped"}),p==="complete"&&o.jsx("span",{className:"text-emerald-500",children:" Complete"}),p==="idle"&&o.jsx("span",{children:" Idle"}),!g&&o.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),o.jsx("button",{onClick:Y,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:s9[i]})]})}),o.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:o.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),D?o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("input",{type:"text",value:S,onChange:se=>I(se.target.value),onKeyDown:se=>{se.key==="Enter"&&H(),se.key==="Escape"&&B()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:P}),o.jsx("button",{onClick:H,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Save",children:o.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})}),o.jsx("button",{onClick:B,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:o.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):o.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!D&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:K,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),o.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),o.jsx("button",{onClick:X,disabled:P,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:o.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&o.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),o.jsx("button",{onClick:()=>z(!0),disabled:P||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:o.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),o.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[o.jsxs("button",{onClick:()=>$(!L),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[o.jsx("span",{children:"Workflow"}),o.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:L?"":""})]}),L&&o.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:o.jsx(zB,{projectId:e})})]})]})}),o.jsx(EE,{position:"top-right",nodeColor:se=>{var me;const fe=(me=se.data)==null?void 0:me.state,he=document.querySelector('[class*="theme-"]')||document.body,Q=getComputedStyle(he);return["produced","stabilized","ready","complete"].includes(fe)?Q.getPropertyValue("--state-stabilized-bg").trim():["requirements_not_met","blocked","halted","failed"].includes(fe)?Q.getPropertyValue("--state-blocked-bg").trim():["in_production","active","queued","awaiting_operator"].includes(fe)?Q.getPropertyValue("--state-active-bg").trim():(["ready_for_production","waiting","pending_acceptance"].includes(fe),Q.getPropertyValue("--state-ready-bg").trim())},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),o.jsx(Hn,{position:"bottom-left",children:o.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[o.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Stabilized"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-ready-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"In Progress"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-blocked-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Blocked"})]})]})}),o.jsx(Hn,{position:"bottom-right",children:o.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Pinch to zoom | Drag to pan"})})]}),_&&o.jsxs("div",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 px-5 py-3 rounded-lg shadow-lg border",style:{background:_.type==="error"?"#fef2f2":"#f0fdf4",borderColor:_.type==="error"?"#fecaca":"#bbf7d0",maxWidth:500,animation:"fadeIn 0.2s ease-out"},children:[o.jsx("span",{style:{fontSize:18,color:_.type==="error"?"#dc2626":"#16a34a",flexShrink:0},children:_.type==="error"?"":""}),o.jsx("span",{style:{fontSize:13,color:"#1f2937",lineHeight:1.4},children:_.message}),o.jsx("button",{onClick:x,style:{marginLeft:"auto",background:"none",border:"none",color:"#9ca3af",fontSize:18,cursor:"pointer",padding:"0 2px",lineHeight:1,flexShrink:0},children:""})]}),A&&o.jsx(kB,{projectId:e,projectCode:t,docTypeId:A,onClose:()=>T(null)}),M&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:o.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),o.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",o.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),o.jsxs("div",{className:"flex gap-3 justify-end",children:[o.jsx("button",{onClick:()=>z(!1),disabled:P,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),o.jsx("button",{onClick:ie,disabled:P,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:P?"Deleting...":"Delete"})]})]})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function X4(e){return typeof e>"u"||e===null}function o9(e){return typeof e=="object"&&e!==null}function a9(e){return Array.isArray(e)?e:X4(e)?[]:[e]}function l9(e,t){var r,n,s,i;if(t)for(i=Object.keys(t),r=0,n=i.length;r<n;r+=1)s=i[r],e[s]=t[s];return e}function c9(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function u9(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var d9=X4,f9=o9,p9=a9,h9=c9,m9=u9,g9=l9,ft={isNothing:d9,isObject:f9,toArray:p9,repeat:h9,isNegativeZero:m9,extend:g9};function Q4(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function aa(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Q4(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}aa.prototype=Object.create(Error.prototype);aa.prototype.constructor=aa;aa.prototype.toString=function(t){return this.name+": "+Q4(this,t)};var Dt=aa;function pg(e,t,r,n,s){var i="",a="",l=Math.floor(s/2)-1;return n-t>l&&(i=" ... ",t=n-l+i.length),r-n>l&&(a=" ...",r=n+l-a.length),{str:i+e.slice(t,r).replace(/\t/g,"")+a,pos:n-t+i.length}}function hg(e,t){return ft.repeat(" ",t-e.length)+e}function x9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],s=[],i,a=-1;i=r.exec(e.buffer);)s.push(i.index),n.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=n.length-2);a<0&&(a=n.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,s.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(a-c<0);c++)d=pg(e.buffer,n[a-c],s[a-c],e.position-(n[a]-n[a-c]),f),l=ft.repeat(" ",t.indent)+hg((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=pg(e.buffer,n[a],s[a],e.position,f),l+=ft.repeat(" ",t.indent)+hg((e.line+1).toString(),u)+" | "+d.str+`
`,l+=ft.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(a+c>=s.length);c++)d=pg(e.buffer,n[a+c],s[a+c],e.position-(n[a]-n[a+c]),f),l+=ft.repeat(" ",t.indent)+hg((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var v9=x9,y9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],b9=["scalar","sequence","mapping"];function _9(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function w9(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(y9.indexOf(r)===-1)throw new Dt('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=_9(t.styleAliases||null),b9.indexOf(this.kind)===-1)throw new Dt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var kt=w9;function iS(e,t){var r=[];return e[t].forEach(function(n){var s=r.length;r.forEach(function(i,a){i.tag===n.tag&&i.kind===n.kind&&i.multi===n.multi&&(s=a)}),r[s]=n}),r}function j9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Bx(e){return this.extend(e)}Bx.prototype.extend=function(t){var r=[],n=[];if(t instanceof kt)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new Dt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(i){if(!(i instanceof kt))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Dt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Dt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(i){if(!(i instanceof kt))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Bx.prototype);return s.implicit=(this.implicit||[]).concat(r),s.explicit=(this.explicit||[]).concat(n),s.compiledImplicit=iS(s,"implicit"),s.compiledExplicit=iS(s,"explicit"),s.compiledTypeMap=j9(s.compiledImplicit,s.compiledExplicit),s};var Z4=Bx,J4=new kt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),e3=new kt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),t3=new kt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),r3=new Z4({explicit:[J4,e3,t3]});function S9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function k9(){return null}function N9(e){return e===null}var n3=new kt("tag:yaml.org,2002:null",{kind:"scalar",resolve:S9,construct:k9,predicate:N9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function C9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function E9(e){return e==="true"||e==="True"||e==="TRUE"}function T9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var s3=new kt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:C9,construct:E9,predicate:T9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function A9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function R9(e){return 48<=e&&e<=55}function I9(e){return 48<=e&&e<=57}function P9(e){if(e===null)return!1;var t=e.length,r=0,n=!1,s;if(!t)return!1;if(s=e[r],(s==="-"||s==="+")&&(s=e[++r]),s==="0"){if(r+1===t)return!0;if(s=e[++r],s==="b"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(s!=="0"&&s!=="1")return!1;n=!0}return n&&s!=="_"}if(s==="x"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!A9(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}if(s==="o"){for(r++;r<t;r++)if(s=e[r],s!=="_"){if(!R9(e.charCodeAt(r)))return!1;n=!0}return n&&s!=="_"}}if(s==="_")return!1;for(;r<t;r++)if(s=e[r],s!=="_"){if(!I9(e.charCodeAt(r)))return!1;n=!0}return!(!n||s==="_")}function M9(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function O9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!ft.isNegativeZero(e)}var i3=new kt("tag:yaml.org,2002:int",{kind:"scalar",resolve:P9,construct:M9,predicate:O9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),D9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function L9(e){return!(e===null||!D9.test(e)||e[e.length-1]==="_")}function z9(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var F9=/^[-+]?[0-9]+e/;function $9(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(ft.isNegativeZero(e))return"-0.0";return r=e.toString(10),F9.test(r)?r.replace("e",".e"):r}function q9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||ft.isNegativeZero(e))}var o3=new kt("tag:yaml.org,2002:float",{kind:"scalar",resolve:L9,construct:z9,predicate:q9,represent:$9,defaultStyle:"lowercase"}),a3=r3.extend({implicit:[n3,s3,i3,o3]}),l3=a3,c3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),u3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function B9(e){return e===null?!1:c3.exec(e)!==null||u3.exec(e)!==null}function W9(e){var t,r,n,s,i,a,l,c=0,d=null,u,f,p;if(t=c3.exec(e),t===null&&(t=u3.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(r,n,s));if(i=+t[4],a=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(r,n,s,i,a,l,c)),d&&p.setTime(p.getTime()-d),p}function H9(e){return e.toISOString()}var d3=new kt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:B9,construct:W9,instanceOf:Date,represent:H9});function V9(e){return e==="<<"||e===null}var f3=new kt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:V9}),Ty=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function U9(e){if(e===null)return!1;var t,r,n=0,s=e.length,i=Ty;for(r=0;r<s;r++)if(t=i.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function G9(e){var t,r,n=e.replace(/[\r\n=]/g,""),s=n.length,i=Ty,a=0,l=[];for(t=0;t<s;t++)t%4===0&&t&&(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)),a=a<<6|i.indexOf(n.charAt(t));return r=s%4*6,r===0?(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)):r===18?(l.push(a>>10&255),l.push(a>>2&255)):r===12&&l.push(a>>4&255),new Uint8Array(l)}function K9(e){var t="",r=0,n,s,i=e.length,a=Ty;for(n=0;n<i;n++)n%3===0&&n&&(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]),r=(r<<8)+e[n];return s=i%3,s===0?(t+=a[r>>18&63],t+=a[r>>12&63],t+=a[r>>6&63],t+=a[r&63]):s===2?(t+=a[r>>10&63],t+=a[r>>4&63],t+=a[r<<2&63],t+=a[64]):s===1&&(t+=a[r>>2&63],t+=a[r<<4&63],t+=a[64],t+=a[64]),t}function Y9(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var p3=new kt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:U9,construct:G9,predicate:Y9,represent:K9}),X9=Object.prototype.hasOwnProperty,Q9=Object.prototype.toString;function Z9(e){if(e===null)return!0;var t=[],r,n,s,i,a,l=e;for(r=0,n=l.length;r<n;r+=1){if(s=l[r],a=!1,Q9.call(s)!=="[object Object]")return!1;for(i in s)if(X9.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}function J9(e){return e!==null?e:[]}var h3=new kt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Z9,construct:J9}),e7=Object.prototype.toString;function t7(e){if(e===null)return!0;var t,r,n,s,i,a=e;for(i=new Array(a.length),t=0,r=a.length;t<r;t+=1){if(n=a[t],e7.call(n)!=="[object Object]"||(s=Object.keys(n),s.length!==1))return!1;i[t]=[s[0],n[s[0]]]}return!0}function r7(e){if(e===null)return[];var t,r,n,s,i,a=e;for(i=new Array(a.length),t=0,r=a.length;t<r;t+=1)n=a[t],s=Object.keys(n),i[t]=[s[0],n[s[0]]];return i}var m3=new kt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:t7,construct:r7}),n7=Object.prototype.hasOwnProperty;function s7(e){if(e===null)return!0;var t,r=e;for(t in r)if(n7.call(r,t)&&r[t]!==null)return!1;return!0}function i7(e){return e!==null?e:{}}var g3=new kt("tag:yaml.org,2002:set",{kind:"mapping",resolve:s7,construct:i7}),Ay=l3.extend({implicit:[d3,f3],explicit:[p3,h3,m3,g3]}),Qn=Object.prototype.hasOwnProperty,Sc=1,x3=2,v3=3,kc=4,mg=1,o7=2,oS=3,a7=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,l7=/[\x85\u2028\u2029]/,c7=/[,\[\]\{\}]/,y3=/^(?:!|!!|![a-z\-]+!)$/i,b3=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function aS(e){return Object.prototype.toString.call(e)}function Ur(e){return e===10||e===13}function ys(e){return e===9||e===32}function Ht(e){return e===9||e===32||e===10||e===13}function si(e){return e===44||e===91||e===93||e===123||e===125}function u7(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function d7(e){return e===120?2:e===117?4:e===85?8:0}function f7(e){return 48<=e&&e<=57?e-48:-1}function lS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function p7(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function _3(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var w3=new Array(256),j3=new Array(256);for(var Fs=0;Fs<256;Fs++)w3[Fs]=lS(Fs)?1:0,j3[Fs]=lS(Fs);function h7(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Ay,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function S3(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=v9(r),new Dt(t,r)}function pe(e,t){throw S3(e,t)}function Nc(e,t){e.onWarning&&e.onWarning.call(null,S3(e,t))}var cS={YAML:function(t,r,n){var s,i,a;t.version!==null&&pe(t,"duplication of %YAML directive"),n.length!==1&&pe(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),s===null&&pe(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&pe(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&Nc(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var s,i;n.length!==2&&pe(t,"TAG directive accepts exactly two arguments"),s=n[0],i=n[1],y3.test(s)||pe(t,"ill-formed tag handle (first argument) of the TAG directive"),Qn.call(t.tagMap,s)&&pe(t,'there is a previously declared suffix for "'+s+'" tag handle'),b3.test(i)||pe(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{pe(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i}};function Gn(e,t,r,n){var s,i,a,l;if(t<r){if(l=e.input.slice(t,r),n)for(s=0,i=l.length;s<i;s+=1)a=l.charCodeAt(s),a===9||32<=a&&a<=1114111||pe(e,"expected valid JSON character");else a7.test(l)&&pe(e,"the stream contains non-printable characters");e.result+=l}}function uS(e,t,r,n){var s,i,a,l;for(ft.isObject(r)||pe(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(r),a=0,l=s.length;a<l;a+=1)i=s[a],Qn.call(t,i)||(_3(t,i,r[i]),n[i]=!0)}function ii(e,t,r,n,s,i,a,l,c){var d,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),d=0,u=s.length;d<u;d+=1)Array.isArray(s[d])&&pe(e,"nested arrays are not supported inside keys"),typeof s=="object"&&aS(s[d])==="[object Object]"&&(s[d]="[object Object]");if(typeof s=="object"&&aS(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(d=0,u=i.length;d<u;d+=1)uS(e,t,i[d],r);else uS(e,t,i,r);else!e.json&&!Qn.call(r,s)&&Qn.call(t,s)&&(e.line=a||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,pe(e,"duplicated mapping key")),_3(t,s,i),delete r[s];return t}function Ry(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):pe(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function at(e,t,r){for(var n=0,s=e.input.charCodeAt(e.position);s!==0;){for(;ys(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Ur(s))for(Ry(e),s=e.input.charCodeAt(e.position),n++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&Nc(e,"deficient indentation"),n}function ku(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Ht(r)))}function Iy(e,t){t===1?e.result+=" ":t>1&&(e.result+=ft.repeat(`
`,t-1))}function m7(e,t,r){var n,s,i,a,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Ht(h)||si(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(s=e.input.charCodeAt(e.position+1),Ht(s)||r&&si(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,l=!1;h!==0;){if(h===58){if(s=e.input.charCodeAt(e.position+1),Ht(s)||r&&si(s))break}else if(h===35){if(n=e.input.charCodeAt(e.position-1),Ht(n))break}else{if(e.position===e.lineStart&&ku(e)||r&&si(h))break;if(Ur(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,at(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Gn(e,i,a,!1),Iy(e,e.line-c),i=a=e.position,l=!1),ys(h)||(a=e.position+1),h=e.input.charCodeAt(++e.position)}return Gn(e,i,a,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function g7(e,t){var r,n,s;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=s=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Gn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,s=e.position;else return!0;else Ur(r)?(Gn(e,n,s,!0),Iy(e,at(e,!1,t)),n=s=e.position):e.position===e.lineStart&&ku(e)?pe(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);pe(e,"unexpected end of the stream within a single quoted scalar")}function x7(e,t){var r,n,s,i,a,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Gn(e,r,e.position,!0),e.position++,!0;if(l===92){if(Gn(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Ur(l))at(e,!1,t);else if(l<256&&w3[l])e.result+=j3[l],e.position++;else if((a=d7(l))>0){for(s=a,i=0;s>0;s--)l=e.input.charCodeAt(++e.position),(a=u7(l))>=0?i=(i<<4)+a:pe(e,"expected hexadecimal character");e.result+=p7(i),e.position++}else pe(e,"unknown escape sequence");r=n=e.position}else Ur(l)?(Gn(e,r,n,!0),Iy(e,at(e,!1,t)),r=n=e.position):e.position===e.lineStart&&ku(e)?pe(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}pe(e,"unexpected end of the stream within a double quoted scalar")}function v7(e,t){var r=!0,n,s,i,a=e.tag,l,c=e.anchor,d,u,f,p,h,v=Object.create(null),g,_,x,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(at(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=a,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;r?y===44&&pe(e,"expected the node content, but found ','"):pe(e,"missed comma between flow collection entries"),_=g=x=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Ht(d)&&(f=p=!0,e.position++,at(e,!0,t))),n=e.line,s=e.lineStart,i=e.position,Ci(e,t,Sc,!1,!0),_=e.tag,g=e.result,at(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===n)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),at(e,!0,t),Ci(e,t,Sc,!1,!0),x=e.result),h?ii(e,l,v,_,g,x,n,s,i):f?l.push(ii(e,null,v,_,g,x,n,s,i)):l.push(g),at(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}pe(e,"unexpected end of the stream within a flow collection")}function y7(e,t){var r,n,s=mg,i=!1,a=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)mg===s?s=f===43?oS:o7:pe(e,"repeat of a chomping mode identifier");else if((u=f7(f))>=0)u===0?pe(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?pe(e,"repeat of an indentation width identifier"):(l=t+u-1,a=!0);else break;if(ys(f)){do f=e.input.charCodeAt(++e.position);while(ys(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Ur(f)&&f!==0)}for(;f!==0;){for(Ry(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!a||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>l&&(l=e.lineIndent),Ur(f)){c++;continue}if(e.lineIndent<l){s===oS?e.result+=ft.repeat(`
`,i?1+c:c):s===mg&&i&&(e.result+=`
`);break}for(n?ys(f)?(d=!0,e.result+=ft.repeat(`
`,i?1+c:c)):d?(d=!1,e.result+=ft.repeat(`
`,c+1)):c===0?i&&(e.result+=" "):e.result+=ft.repeat(`
`,c):e.result+=ft.repeat(`
`,i?1+c:c),i=!0,a=!0,c=0,r=e.position;!Ur(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Gn(e,r,e.position,!1)}return!0}function dS(e,t){var r,n=e.tag,s=e.anchor,i=[],a,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,pe(e,"tab characters must not be used in indentation")),!(c!==45||(a=e.input.charCodeAt(e.position+1),!Ht(a))));){if(l=!0,e.position++,at(e,!0,-1)&&e.lineIndent<=t){i.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Ci(e,t,v3,!1,!0),i.push(e.result),at(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)pe(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}function b7(e,t,r){var n,s,i,a,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,v=null,g=null,_=!1,x=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!_&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,pe(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),i=e.line,(y===63||y===58)&&Ht(n))y===63?(_&&(ii(e,f,p,h,v,null,a,l,c),h=v=g=null),x=!0,_=!0,s=!0):_?(_=!1,s=!0):pe(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=n;else{if(a=e.line,l=e.lineStart,c=e.position,!Ci(e,r,x3,!1,!0))break;if(e.line===i){for(y=e.input.charCodeAt(e.position);ys(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Ht(y)||pe(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(ii(e,f,p,h,v,null,a,l,c),h=v=g=null),x=!0,_=!1,s=!1,h=e.tag,v=e.result;else if(x)pe(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(x)pe(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(_&&(a=e.line,l=e.lineStart,c=e.position),Ci(e,t,kc,!0,s)&&(_?v=e.result:g=e.result),_||(ii(e,f,p,h,v,g,a,l,c),h=v=g=null),at(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&y!==0)pe(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&ii(e,f,p,h,v,null,a,l,c),x&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),x}function _7(e){var t,r=!1,n=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&pe(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(r=!0,a=e.input.charCodeAt(++e.position)):a===33?(n=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,r){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):pe(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Ht(a);)a===33&&(n?pe(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),y3.test(s)||pe(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),c7.test(i)&&pe(e,"tag suffix cannot contain flow indicator characters")}i&&!b3.test(i)&&pe(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{pe(e,"tag name is malformed: "+i)}return r?e.tag=i:Qn.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:pe(e,'undeclared tag handle "'+s+'"'),!0}function w7(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&pe(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ht(r)&&!si(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&pe(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function j7(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ht(n)&&!si(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&pe(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Qn.call(e.anchorMap,r)||pe(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],at(e,!0,-1),!0}function Ci(e,t,r,n,s){var i,a,l,c=1,d=!1,u=!1,f,p,h,v,g,_;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=l=kc===r||v3===r,n&&at(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;_7(e)||w7(e);)at(e,!0,-1)?(d=!0,l=i,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||s),(c===1||kc===r)&&(Sc===r||x3===r?g=t:g=t+1,_=e.position-e.lineStart,c===1?l&&(dS(e,_)||b7(e,_,g))||v7(e,g)?u=!0:(a&&y7(e,g)||g7(e,g)||x7(e,g)?u=!0:j7(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&pe(e,"alias node should not have any properties")):m7(e,g,Sc===r)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&dS(e,_))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&pe(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(v=e.implicitTypes[f],v.resolve(e.result)){e.result=v.construct(e.result),e.tag=v.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Qn.call(e.typeMap[e.kind||"fallback"],e.tag))v=e.typeMap[e.kind||"fallback"][e.tag];else for(v=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){v=h[f];break}v||pe(e,"unknown tag !<"+e.tag+">"),e.result!==null&&v.kind!==e.kind&&pe(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+v.kind+'", not "'+e.kind+'"'),v.resolve(e.result,e.tag)?(e.result=v.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):pe(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function S7(e){var t=e.position,r,n,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(at(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),r=e.position;a!==0&&!Ht(a);)a=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),s=[],n.length<1&&pe(e,"directive name must not be less than one character in length");a!==0;){for(;ys(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Ur(a));break}if(Ur(a))break;for(r=e.position;a!==0&&!Ht(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(r,e.position))}a!==0&&Ry(e),Qn.call(cS,n)?cS[n](e,n,s):Nc(e,'unknown document directive "'+n+'"')}if(at(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,at(e,!0,-1)):i&&pe(e,"directives end mark is expected"),Ci(e,e.lineIndent-1,kc,!1,!0),at(e,!0,-1),e.checkLineBreaks&&l7.test(e.input.slice(t,e.position))&&Nc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&ku(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,at(e,!0,-1));return}if(e.position<e.length-1)pe(e,"end of the stream or a document separator is expected");else return}function k3(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new h7(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,pe(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)S7(r);return r.documents}function k7(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=k3(e,r);if(typeof t!="function")return n;for(var s=0,i=n.length;s<i;s+=1)t(n[s])}function N7(e,t){var r=k3(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new Dt("expected a single document in the stream, but found more")}}var C7=k7,E7=N7,N3={loadAll:C7,load:E7},C3=Object.prototype.toString,E3=Object.prototype.hasOwnProperty,Py=65279,T7=9,la=10,A7=13,R7=32,I7=33,P7=34,Wx=35,M7=37,O7=38,D7=39,L7=42,T3=44,z7=45,Cc=58,F7=61,$7=62,q7=63,B7=64,A3=91,R3=93,W7=96,I3=123,H7=124,P3=125,Mt={};Mt[0]="\\0";Mt[7]="\\a";Mt[8]="\\b";Mt[9]="\\t";Mt[10]="\\n";Mt[11]="\\v";Mt[12]="\\f";Mt[13]="\\r";Mt[27]="\\e";Mt[34]='\\"';Mt[92]="\\\\";Mt[133]="\\N";Mt[160]="\\_";Mt[8232]="\\L";Mt[8233]="\\P";var V7=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],U7=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function G7(e,t){var r,n,s,i,a,l,c;if(t===null)return{};for(r={},n=Object.keys(t),s=0,i=n.length;s<i;s+=1)a=n[s],l=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),c=e.compiledTypeMap.fallback[a],c&&E3.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[a]=l;return r}function K7(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new Dt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+ft.repeat("0",n-t.length)+t}var Y7=1,ca=2;function X7(e){this.schema=e.schema||Ay,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=ft.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=G7(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?ca:Y7,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function fS(e,t){for(var r=ft.repeat(" ",t),n=0,s=-1,i="",a,l=e.length;n<l;)s=e.indexOf(`
`,n),s===-1?(a=e.slice(n),n=l):(a=e.slice(n,s+1),n=s+1),a.length&&a!==`
`&&(i+=r),i+=a;return i}function Hx(e,t){return`
`+ft.repeat(" ",e.indent*t)}function Q7(e,t){var r,n,s;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(s=e.implicitTypes[r],s.resolve(t))return!0;return!1}function Ec(e){return e===R7||e===T7}function ua(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Py||65536<=e&&e<=1114111}function pS(e){return ua(e)&&e!==Py&&e!==A7&&e!==la}function hS(e,t,r){var n=pS(e),s=n&&!Ec(e);return(r?n:n&&e!==T3&&e!==A3&&e!==R3&&e!==I3&&e!==P3)&&e!==Wx&&!(t===Cc&&!s)||pS(t)&&!Ec(t)&&e===Wx||t===Cc&&s}function Z7(e){return ua(e)&&e!==Py&&!Ec(e)&&e!==z7&&e!==q7&&e!==Cc&&e!==T3&&e!==A3&&e!==R3&&e!==I3&&e!==P3&&e!==Wx&&e!==O7&&e!==L7&&e!==I7&&e!==H7&&e!==F7&&e!==$7&&e!==D7&&e!==P7&&e!==M7&&e!==B7&&e!==W7}function J7(e){return!Ec(e)&&e!==Cc}function wo(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function M3(e){var t=/^\n* /;return t.test(e)}var O3=1,Vx=2,D3=3,L3=4,Ws=5;function eW(e,t,r,n,s,i,a,l){var c,d=0,u=null,f=!1,p=!1,h=n!==-1,v=-1,g=Z7(wo(e,0))&&J7(wo(e,e.length-1));if(t||a)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wo(e,c),!ua(d))return Ws;g=g&&hS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wo(e,c),d===la)f=!0,h&&(p=p||c-v-1>n&&e[v+1]!==" ",v=c);else if(!ua(d))return Ws;g=g&&hS(d,u,l),u=d}p=p||h&&c-v-1>n&&e[v+1]!==" "}return!f&&!p?g&&!a&&!s(e)?O3:i===ca?Ws:Vx:r>9&&M3(e)?Ws:a?i===ca?Ws:Vx:p?L3:D3}function tW(e,t,r,n,s){e.dump=function(){if(t.length===0)return e.quotingType===ca?'""':"''";if(!e.noCompatMode&&(V7.indexOf(t)!==-1||U7.test(t)))return e.quotingType===ca?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,r),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(d){return Q7(e,d)}switch(eW(t,l,e.indent,a,c,e.quotingType,e.forceQuotes&&!n,s)){case O3:return t;case Vx:return"'"+t.replace(/'/g,"''")+"'";case D3:return"|"+mS(t,e.indent)+gS(fS(t,i));case L3:return">"+mS(t,e.indent)+gS(fS(rW(t,a),i));case Ws:return'"'+nW(t)+'"';default:throw new Dt("impossible error: invalid scalar style")}}()}function mS(e,t){var r=M3(e)?String(t):"",n=e[e.length-1]===`
`,s=n&&(e[e.length-2]===`
`||e===`
`),i=s?"+":n?"":"-";return r+i+`
`}function gS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function rW(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,r.lastIndex=d,xS(e.slice(0,d),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=r.exec(e);){var l=a[1],c=a[2];i=c[0]===" ",n+=l+(!s&&!i&&c!==""?`
`:"")+xS(c,t),s=i}return n}function xS(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,s=0,i,a=0,l=0,c="";n=r.exec(e);)l=n.index,l-s>t&&(i=a>s?a:l,c+=`
`+e.slice(s,i),s=i+1),a=l;return c+=`
`,e.length-s>t&&a>s?c+=e.slice(s,a)+`
`+e.slice(a+1):c+=e.slice(s),c.slice(1)}function nW(e){for(var t="",r=0,n,s=0;s<e.length;r>=65536?s+=2:s++)r=wo(e,s),n=Mt[r],!n&&ua(r)?(t+=e[s],r>=65536&&(t+=e[s+1])):t+=n||K7(r);return t}function sW(e,t,r){var n="",s=e.tag,i,a,l;for(i=0,a=r.length;i<a;i+=1)l=r[i],e.replacer&&(l=e.replacer.call(r,String(i),l)),(xn(e,t,l,!1,!1)||typeof l>"u"&&xn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=s,e.dump="["+n+"]"}function vS(e,t,r,n){var s="",i=e.tag,a,l,c;for(a=0,l=r.length;a<l;a+=1)c=r[a],e.replacer&&(c=e.replacer.call(r,String(a),c)),(xn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&xn(e,t+1,null,!0,!0,!1,!0))&&((!n||s!=="")&&(s+=Hx(e,t)),e.dump&&la===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}function iW(e,t,r){var n="",s=e.tag,i=Object.keys(r),a,l,c,d,u;for(a=0,l=i.length;a<l;a+=1)u="",n!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=i[a],d=r[c],e.replacer&&(d=e.replacer.call(r,c,d)),xn(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),xn(e,t,d,!1,!1)&&(u+=e.dump,n+=u));e.tag=s,e.dump="{"+n+"}"}function oW(e,t,r,n){var s="",i=e.tag,a=Object.keys(r),l,c,d,u,f,p;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new Dt("sortKeys must be a boolean or a function");for(l=0,c=a.length;l<c;l+=1)p="",(!n||s!=="")&&(p+=Hx(e,t)),d=a[l],u=r[d],e.replacer&&(u=e.replacer.call(r,d,u)),xn(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&la===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Hx(e,t)),xn(e,t+1,u,!0,f)&&(e.dump&&la===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,s+=p));e.tag=i,e.dump=s||"{}"}function yS(e,t,r){var n,s,i,a,l,c;for(s=r?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(l=s[i],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,C3.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(E3.call(l.represent,c))n=l.represent[c](t,c);else throw new Dt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function xn(e,t,r,n,s,i,a){e.tag=null,e.dump=r,yS(e,r,!1)||yS(e,r,!0);var l=C3.call(e.dump),c=n,d;n&&(n=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(r),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(s=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(oW(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(iW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?vS(e,t-1,e.dump,s):vS(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(sW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&tW(e,e.dump,t,i,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Dt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function aW(e,t){var r=[],n=[],s,i;for(Ux(e,r,n),s=0,i=n.length;s<i;s+=1)t.duplicates.push(r[n[s]]);t.usedDuplicates=new Array(i)}function Ux(e,t,r){var n,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)r.indexOf(s)===-1&&r.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)Ux(e[s],t,r);else for(n=Object.keys(e),s=0,i=n.length;s<i;s+=1)Ux(e[n[s]],t,r)}function lW(e,t){t=t||{};var r=new X7(t);r.noRefs||aW(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),xn(r,0,n,!0,!0)?r.dump+`
`:""}var cW=lW,uW={dump:cW};function My(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var dW=kt,fW=Z4,pW=r3,hW=a3,mW=l3,gW=Ay,xW=N3.load,vW=N3.loadAll,yW=uW.dump,bW=Dt,_W={binary:p3,float:o3,map:t3,null:n3,pairs:m3,set:g3,timestamp:d3,bool:s3,int:i3,merge:f3,omap:h3,seq:e3,str:J4},wW=My("safeLoad","load"),jW=My("safeLoadAll","loadAll"),SW=My("safeDump","dump"),Oy={Type:dW,Schema:fW,FAILSAFE_SCHEMA:pW,JSON_SCHEMA:hW,CORE_SCHEMA:mW,DEFAULT_SCHEMA:gW,load:xW,loadAll:vW,dump:yW,YAMLException:bW,types:_W,safeLoad:wW,safeLoadAll:jW,safeDump:SW};function bS({messages:e,pendingPrompt:t,introContent:r}){const n=m.useRef(null);return m.useEffect(()=>{var s;(s=n.current)==null||s.scrollIntoView({behavior:"smooth"})},[e,t]),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",onWheel:s=>s.stopPropagation(),children:[r,e.map((s,i)=>o.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:o.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${s.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:s.content})},i)),t&&o.jsx("div",{className:"flex justify-start",children:o.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),o.jsx("div",{ref:n})]})}function kW({onSubmit:e,disabled:t,placeholder:r}){const[n,s]=m.useState(""),i=m.useRef(null);m.useEffect(()=>{var c;t||(c=i.current)==null||c.focus()},[t]);const a=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),s("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),s(""))};return o.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("textarea",{ref:i,value:n,onChange:c=>s(c.target.value),onKeyDown:a,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),o.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),o.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const _S={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function NW({type:e,className:t}){switch(e){case"check":return o.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 9v4M12 17h.01"}),o.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),o.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function CW({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const s=_S[e]||_S.blocked,i=e==="qualified";return o.jsxs("div",{className:"p-6 text-center",children:[o.jsx("div",{className:`w-16 h-16 rounded-full ${s.iconBg} flex items-center justify-center mx-auto mb-4`,children:o.jsx(NW,{type:s.icon,className:`w-8 h-8 ${s.iconColor}`})}),o.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:s.title}),o.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:s.description}),i&&t&&o.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[o.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),o.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),o.jsxs("div",{className:"flex gap-2 justify-center",children:[i&&t&&o.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),o.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function EW({operation:e,context:t,onSubmit:r,onCancel:n}){var _;const[s,i]=m.useState("confirm"),[a,l]=m.useState(!1),[c,d]=m.useState((t==null?void 0:t.project_type)||""),[u,f]=m.useState(""),h=((e==null?void 0:e.config)||{}).entry_prompt||"Review the intake classification.",v=[{value:"greenfield",label:"Greenfield (New Project)"},{value:"enhancement",label:"Enhancement (Existing Project)"},{value:"migration",label:"Migration"},{value:"integration",label:"Integration"},{value:"unknown",label:"Unknown / Other"}],g=()=>{l(!0);const x={confirmed:s==="confirm",timestamp:new Date().toISOString()};s==="correct"&&(x.corrected_project_type=c),u.trim()&&(x.notes=u.trim()),r(x)};return o.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-green, #22c55e)",color:"#fff"},children:"Intake"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Concierge Entry"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirm or correct the intake classification"})]})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",onWheel:x=>x.stopPropagation(),children:o.jsxs("div",{className:"max-w-2xl space-y-6",children:[o.jsx("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:o.jsx("div",{className:"text-sm",style:{color:"var(--text-primary)"},children:h})}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirmation requested"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Classification Result"}),o.jsxs("div",{className:"p-4 rounded space-y-3",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Intent Classification"}),o.jsx("span",{className:"px-3 py-1 rounded font-semibold",style:{background:"var(--accent-primary, #3b82f6)",color:"#fff",fontSize:12},children:((_=t==null?void 0:t.project_type)==null?void 0:_.replace(/_/g," ").toUpperCase())||"Unknown"})]}),(t==null?void 0:t.artifact_type)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Artifact Type"}),o.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.artifact_type.replace(/_/g," ")})]}),(t==null?void 0:t.audience)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Audience"}),o.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.audience})]}),(t==null?void 0:t.intake_summary)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Summary"}),o.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.intake_summary})]}),(t==null?void 0:t.classification_rationale)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Rationale"}),o.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:t.classification_rationale})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Your Decision"}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:()=>i("confirm"),className:"flex-1 p-4 rounded text-left",style:{background:s==="confirm"?"rgba(34, 197, 94, 0.1)":"var(--bg-panel)",border:s==="confirm"?"2px solid #22c55e":"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Confirm"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"The classification is correct"})]}),o.jsxs("button",{onClick:()=>i("correct"),className:"flex-1 p-4 rounded text-left",style:{background:s==="correct"?"rgba(249, 115, 22, 0.1)":"var(--bg-panel)",border:s==="correct"?"2px solid #f97316":"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Correct"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"I need to change the classification before proceeding"})]})]})]}),s==="correct"&&o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Correct Intent Classification"}),o.jsxs("select",{value:c,onChange:x=>d(x.target.value),className:"w-full p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[o.jsx("option",{value:"",children:"Select intent classification..."}),v.map(x=>o.jsx("option",{value:x.value,children:x.label},x.value))]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Notes (Optional)"}),o.jsx("textarea",{value:u,onChange:x=>f(x.target.value),placeholder:"Add any additional context or notes...",className:"w-full p-3 rounded text-sm",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:80,resize:"vertical"}})]})]})}),o.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[n&&o.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:"Cancel"}),o.jsxs("button",{onClick:g,disabled:a||s==="correct"&&!c,className:"px-4 py-2 rounded text-sm font-semibold flex items-center gap-2",style:{background:s==="confirm"?"#22c55e":"#f97316",color:"#fff",opacity:a||s==="correct"&&!c?.5:1},children:[a&&o.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="confirm"?"Confirm Classification":"Submit Correction"]})]})]})}function TW({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:s,gateOutcome:i,project:a,error:l,loading:c,submitting:d,intakeClassification:u,intakeGatePhase:f,startIntake:p,submitMessage:h,reset:v}=QB(),[g,_]=m.useState(null);m.useEffect(()=>(p(),fetch("/content/concierge-intro.yaml").then(C=>C.text()).then(C=>_(Oy.load(C))).catch(C=>console.error("Failed to load intro content:",C)),()=>v()),[]);const x=()=>{v(),e()},y=()=>{a&&t&&t(a),x()},b=C=>{h(JSON.stringify(C))},w=()=>{const C=[{id:"describe",label:"Describe"},{id:"confirm",label:"Confirm"},{id:"complete",label:"Done"}];let N=r;f==="awaiting_confirmation"&&(N="confirm"),(N==="review"||N==="generating")&&(N="complete");const E=C.findIndex(j=>j.id===N);return o.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:C.map((j,A)=>o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:`px-2 py-0.5 rounded ${A===E?"bg-violet-500/30 text-violet-300":A<E?"text-emerald-400":"text-slate-500"}`,children:j.label}),A<C.length-1&&o.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},j.id))})},k=()=>{var C;if(c&&r==="idle")return o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});if(f==="awaiting_confirmation"&&u)return o.jsx(EW,{operation:{config:{entry_prompt:s}},context:u,onSubmit:b,onCancel:x});switch(r){case"describe":const N=g?o.jsxs("div",{className:"mb-4 pb-4 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("h3",{className:"text-base font-semibold mb-3",style:{color:"var(--text-primary)"},children:g.title}),o.jsx("div",{className:"text-sm space-y-3",style:{color:"var(--text-secondary)"},children:(C=g.paragraphs)==null?void 0:C.map((E,j)=>o.jsx("p",{children:E},j))}),g.call_to_action&&o.jsx("p",{className:"text-sm font-medium mt-4",style:{color:"var(--text-primary)"},children:g.call_to_action})]}):null;return o.jsxs(o.Fragment,{children:[o.jsx(bS,{messages:n,pendingPrompt:s,introContent:N}),o.jsx(kW,{onSubmit:h,disabled:d,placeholder:"Describe what you want to build..."})]});case"complete":return o.jsxs(o.Fragment,{children:[o.jsx(bS,{messages:n}),o.jsx(CW,{gateOutcome:i,project:a,onViewProject:y,onClose:x})]});default:return null}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:o.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},onWheel:C=>C.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),w()]})]}),o.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l&&o.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:l}),k()]})})}function AW({onClose:e}){const{user:t,logout:r,isAdmin:n}=zi(),[s,i]=m.useState(null),[a,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{s==="linked"&&p()},[s]);const p=async()=>{try{d(!0);const k=await fetch("/auth/accounts",{credentials:"include"});if(k.ok){const C=await k.json();l(C.identities||[])}}catch(k){console.error("Failed to load accounts:",k)}finally{d(!1)}},h=k=>{window.location.href=`/auth/accounts/link/${k}`},v=async k=>{var C;if(a.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${k} account?`))try{const N=(C=document.cookie.split("; ").find(j=>j.startsWith("csrf=")||j.startsWith("__Host-csrf=")))==null?void 0:C.split("=")[1],E=await fetch(`/auth/accounts/${k}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(E.ok)f({type:"success",text:"Account unlinked"}),await p();else{const j=await E.json();throw new Error(j.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},g=async()=>{await r(),e()},_=k=>{i(s===k?null:k),f(null)},x={google:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=k=>{const C={user:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),o.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),o.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return C[k]||C.user},w=k=>{switch(k){case"account":return o.jsxs("div",{className:"px-4 py-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),o.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),o.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return o.jsxs("div",{className:"px-4 py-3",children:[u&&o.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"space-y-2 mb-4",children:a.map(C=>o.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[x[C.provider_id],o.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:C.provider_email})]}),o.jsx("button",{onClick:()=>v(C.provider_id),disabled:a.length<=1,className:`text-xs px-2 py-1 rounded ${a.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},C.provider_id))}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),o.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[x.google,"Google"]}),o.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[x.microsoft,"Microsoft"]})]})]})]});default:return o.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),o.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?o.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):o.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),o.jsxs("div",{className:"flex-1 overflow-hidden",children:[o.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),o.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),o.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[o.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),o.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),o.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[o.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),o.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),o.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),o.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(k=>o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsxs("button",{onClick:()=>!k.future&&_(k.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${k.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:k.future,children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:b(k.icon)}),o.jsx("span",{className:"flex-1 text-sm text-left",children:k.label}),k.future?o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):o.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:s===k.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),s===k.id&&!k.future&&o.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:w(k.id)})]},k.id))]}),o.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),o.jsx("polyline",{points:"16 17 21 12 16 7"}),o.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Oe={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function RW(){return o.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Oe.bg,borderColor:Oe.border},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Oe.textPrimary},children:"THE COMBINE"}),o.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Oe.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function IW(){return o.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Oe.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),o.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Oe.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),o.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Oe.textMuted},onMouseOver:e=>e.currentTarget.style.color=Oe.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Oe.textMuted,children:["Learn how The Combine works",o.jsx("span",{"aria-hidden":"true",children:""})]})]})}function PW(){const e=[{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return o.jsx("section",{className:"max-w-4xl mx-auto",children:o.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>o.jsxs("div",{className:"flex-1 text-center group",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Oe.bgElevated,border:`1px solid ${Oe.border}`,color:Oe.textMuted},children:t.icon}),o.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Oe.textPrimary},children:t.title}),o.jsx("p",{className:"text-xs",style:{color:Oe.textMuted},children:t.description}),r<e.length-1&&o.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Oe.border}})]},r))})})}function MW(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return o.jsx("section",{className:"text-center",children:o.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>o.jsx("span",{className:"text-xs",style:{color:Oe.textMuted},children:t},r))})})}function OW({onLogin:e}){return o.jsxs("section",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Oe.textSecondary},children:"Ready?"}),o.jsxs("div",{className:"inline-flex flex-col gap-3",children:[o.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Oe.accentHover,onMouseOut:t=>t.currentTarget.style.background=Oe.accent,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),o.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Oe.bg,border:`1px solid ${Oe.border}`,color:Oe.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Oe.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Oe.bg,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function DW(){return o.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[o.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Terms"}),o.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Oe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Oe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Oe.textSubtle,children:"Privacy"}),o.jsx("span",{className:"text-xs",style:{color:Oe.border},children:" 2026 The Combine"})]})}function LW(){const{login:e}=zi();return o.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Oe.bg},children:[o.jsx(RW,{}),o.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:o.jsxs("div",{className:"space-y-12",children:[o.jsx(IW,{}),o.jsx(PW,{}),o.jsx(MW,{}),o.jsx(OW,{onLogin:e})]})}),o.jsx(DW,{})]})}const Re={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function zW(){return o.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Re.bg,borderColor:Re.border},children:[o.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Re.textMuted},onMouseOver:e=>e.currentTarget.style.color=Re.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Re.textMuted,children:[o.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),o.jsx("span",{className:"text-sm",children:"Back"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),o.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Re.textPrimary},children:"THE COMBINE"})]}),o.jsx("div",{className:"w-16"})," "]})}function ss({title:e,children:t}){return o.jsxs("section",{className:"mb-16",children:[e&&o.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Re.textPrimary},children:e}),t]})}function ht({children:e,className:t=""}){return o.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Re.textSecondary},children:e})}function ro({children:e}){return o.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Re.textPrimary,borderLeft:`2px solid ${Re.border}`},children:e})}function cl({items:e}){return o.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>o.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Re.textSecondary},children:[o.jsx("span",{style:{color:Re.textMuted},children:"-"}),t]},r))})}function ul({number:e,title:t,children:r}){return o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[o.jsxs("span",{className:"text-sm font-mono",style:{color:Re.textMuted},children:[e,"."]}),o.jsx("h3",{className:"text-base font-medium",style:{color:Re.textPrimary},children:t})]}),o.jsx("div",{className:"pl-7",children:o.jsx(ht,{children:r})})]})}function dl({title:e,children:t}){return o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Re.textPrimary},children:e}),o.jsx(ht,{className:"mb-0",children:t})]})}function FW({onLogin:e}){return o.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Re.bgElevated,border:`1px solid ${Re.border}`},children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Re.textPrimary},children:"When You're Ready"}),o.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),o.jsx(ht,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),o.jsx(ht,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),o.jsxs("div",{className:"inline-flex flex-col gap-3",children:[o.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Re.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Re.accentHover,onMouseOut:t=>t.currentTarget.style.background=Re.accent,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),o.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Re.bg,border:`1px solid ${Re.border}`,color:Re.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Re.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Re.bg,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function $W(){return o.jsxs("footer",{className:"py-8 text-center",children:[o.jsx("p",{className:"text-sm mb-6",style:{color:Re.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),o.jsxs("div",{className:"flex items-center justify-center gap-6",children:[o.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Re.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Re.textMuted,onMouseOut:e=>e.currentTarget.style.color=Re.textSubtle,children:"Terms"}),o.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Re.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Re.textMuted,onMouseOut:e=>e.currentTarget.style.color=Re.textSubtle,children:"Privacy"}),o.jsx("span",{className:"text-xs",style:{color:Re.border},children:" 2026 The Combine"})]})]})}function qW(){const{login:e}=zi();return o.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Re.bg},children:[o.jsx(zW,{}),o.jsx("main",{className:"flex-1 px-6 py-12",children:o.jsxs("article",{className:"max-w-2xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Re.textPrimary},children:"Learn More"}),o.jsxs(ss,{title:"What The Combine Is",children:[o.jsx(ht,{children:"The Combine is an AI-assisted production system for knowledge work."}),o.jsx(ht,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),o.jsx(ro,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),o.jsx(ro,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),o.jsxs(ss,{title:"Why It Exists",children:[o.jsx(ht,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),o.jsx(ht,{children:"It breaks down when the work must be:"}),o.jsx(cl,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),o.jsx(ht,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),o.jsxs(ss,{title:'Why "The Combine"',children:[o.jsx(ht,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),o.jsx(ht,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),o.jsx(ht,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),o.jsx(ht,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),o.jsx(ht,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),o.jsx(cl,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),o.jsx(ht,{children:"This is not automation for speed. It is industrialization for reliability."}),o.jsx(ro,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),o.jsxs(ss,{title:"How It Works",children:[o.jsx(ul,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),o.jsx(ul,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),o.jsx(ul,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),o.jsx(ul,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),o.jsxs(ss,{title:"What Makes It Different",children:[o.jsx(dl,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),o.jsx(dl,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),o.jsx(dl,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),o.jsx(dl,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),o.jsxs(ss,{title:"What The Combine Is Not",children:[o.jsx(cl,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),o.jsx(ht,{children:"If you want improvisation, there are better tools."}),o.jsx(ro,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),o.jsxs(ss,{title:"Who It's For",children:[o.jsx(ht,{children:"The Combine is designed for people responsible for outcomes, including:"}),o.jsx(cl,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),o.jsx(ro,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),o.jsx(FW,{onLogin:e})]})}),o.jsx($W,{})]})}function z3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await be.getTemplates();t(l.templates||[])}catch(l){i(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{templates:e,loading:r,error:s,refresh:a}}function BW(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await be.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){i(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{workflows:e,loading:r,error:s,refresh:a}}function F3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{n(!0),i(null);try{const l=await be.getSchemas();t(l.schemas||[])}catch(l){i(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{a()},[a]),{schemas:e,loading:r,error:s,refresh:a}}function $3(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,i]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){n(!0),i(null);try{const h=await be.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&i(h.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return p(),()=>{f=!1}},[]);const a=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:a.role.length,task:a.task.length,qa:a.qa.length,pgc:a.pgc.length,questions:a.questions.length,reflection:a.reflection.length}),[e,a]),c=m.useCallback(f=>!f||f==="all"?e:a[f]||[],[e,a]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{n(!0),i(null);try{const f=await be.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),i(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:s,fragmentsByKind:a,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const gg="doctype-browser-collapsed";function q3(e,t){const[r,n]=m.useState(()=>{try{const i=JSON.parse(localStorage.getItem(gg)||"{}");return e in i?i[e]:t}catch{return t}}),s=m.useCallback(i=>{const a=typeof i=="function"?i(r):i;n(a);try{const l=JSON.parse(localStorage.getItem(gg)||"{}");l[e]=a,localStorage.setItem(gg,JSON.stringify(l))}catch{}},[e,r]);return[r,s]}function wS({title:e,defaultOpen:t=!0,children:r}){const[n,s]=q3(`group:${e}`,t);return o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>s(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function jS({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:s}){const[i,a]=q3(`sub:${e}`,r);return o.jsxs("div",{children:[o.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[o.jsxs("button",{onClick:()=>a(!i),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[o.jsx("span",{style:{color:"var(--text-muted)",transform:i?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&o.jsx("span",{style:{color:n,fontSize:8},children:""}),o.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),i&&s]})}function SS({selected:e,onClick:t,label:r,sublabel:n,badge:s}){return o.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium truncate",children:r}),s&&o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:s})]}),n&&o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function kS({loading:e,empty:t,emptyMessage:r="None found"}){return e?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function WW({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:s=[],promptFragmentKindOptions:i=[],schemas:a=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:v=null,selectedRole:g=null,selectedTemplate:_=null,selectedWorkflow:x=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:w,onSelectRole:k,onSelectTemplate:C,onSelectWorkflow:N,onSelectFragment:E,onSelectStandaloneSchema:j,onCreateWorkflow:A,onCreateDocType:T,onCreateFragment:D,onCreateTemplate:F,onCreateSchema:S,onSelectTask:I,onSelectSchema:M,workspaceState:z=null}){var he;const[P,R]=m.useState(null),[L,$]=m.useState(null),[q,Y]=m.useState(""),[K,H]=m.useState(!1),[B,X]=m.useState(!1),[ie,oe]=m.useState(""),[J,we]=m.useState(!1),ge=[...e].sort((Q,me)=>(Q.display_name||"").localeCompare(me.display_name||"")),_e=n.filter(Q=>(Q.pow_class||"reference")==="reference"),xe=Q=>{const me=Q.pow_class||"reference";return me==="reference"?"ref":me==="template"?"tpl":"inst"},ae=e.filter(Q=>Q.active_version).length+n.filter(Q=>Q.active_version).length,U=((he=z==null?void 0:z.modified_artifacts)==null?void 0:he.length)??0,re=(z==null?void 0:z.is_dirty)??!1,te=()=>{R(null),$(null),Y("")},je=()=>{X(!1),oe("")},se=async()=>{const Q=ie.trim().toLowerCase().replace(/\s+/g,"_");if(!(!Q||!/^[a-z][a-z0-9_]*$/.test(Q))){we(!0);try{await(T==null?void 0:T({doc_type_id:Q})),je()}catch{}finally{we(!1)}}},fe=async()=>{const Q=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!Q||!/^[a-z][a-z0-9_]*$/.test(Q))){H(!0);try{const me={workflow_id:Q,pow_class:"template"};L&&(me.derived_from={workflow_id:L.workflow_id,version:L.active_version},me.source_version=L.active_version),await(A==null?void 0:A(me)),te()}catch{}finally{H(!1)}}};return o.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs(wS,{title:"Production Workflows",defaultOpen:!0,children:[o.jsxs(jS,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:A&&o.jsx("button",{onClick:()=>R(P?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[P==="choose"&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsxs("button",{onClick:()=>R("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:_e.length===0,children:["From Reference",_e.length===0?" (none available)":""]}),o.jsx("button",{onClick:()=>R("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),o.jsx("button",{onClick:te,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),P==="from_reference"&&!L&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),_e.map(Q=>o.jsxs("button",{onClick:()=>$(Q),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[o.jsx("div",{className:"font-medium",children:Q.name||Q.workflow_id.replace(/_/g," ").replace(/\b\w/g,me=>me.toUpperCase())}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",Q.active_version]})]},Q.workflow_id)),o.jsx("button",{onClick:()=>R("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(P==="blank"||P==="from_reference"&&L)&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[L&&o.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",L.name||L.workflow_id," v",L.active_version]}),o.jsx("input",{type:"text",value:q,onChange:Q=>Y(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&fe(),Q.key==="Escape"&&te()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:K,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:fe,disabled:K||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:K?"wait":"pointer",opacity:!q.trim()||K?.5:1},children:K?"Creating...":"Create"}),o.jsx("button",{onClick:te,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(kS,{loading:u,empty:!u&&n.length===0,emptyMessage:"No workflows"}),!u&&n.length>0&&o.jsx("div",{className:"py-1",children:n.map(Q=>o.jsx(SS,{selected:(x==null?void 0:x.workflow_id)===Q.workflow_id,onClick:()=>N==null?void 0:N(Q),label:Q.name||Q.workflow_id.replace(/_/g," ").replace(/\b\w/g,me=>me.toUpperCase()),sublabel:`v${Q.active_version}`,badge:xe(Q)},Q.workflow_id))})]}),o.jsxs(jS,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&o.jsx("button",{onClick:()=>X(!B),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[B&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:ie,onChange:Q=>oe(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&se(),Q.key==="Escape"&&je()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:J,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:se,disabled:J||!ie.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:J?"wait":"pointer",opacity:!ie.trim()||J?.5:1},children:J?"Creating...":"Create"}),o.jsx("button",{onClick:je,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(kS,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&ge.length>0&&o.jsx("div",{className:"py-1",children:ge.map(Q=>o.jsx(SS,{selected:v==="docworkflow"&&(h==null?void 0:h.doc_type_id)===Q.doc_type_id,onClick:()=>w==null?void 0:w(Q),label:Q.display_name,badge:`v${Q.active_version}`},Q.doc_type_id))})]})]}),o.jsxs(wS,{title:"Governance",defaultOpen:!1,children:[o.jsx("div",{className:"px-4 py-3",children:o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),o.jsxs("div",{children:[ae," active ",ae===1?"release":"releases"]})]})}),z&&o.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),re&&o.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[U," dirty"]})]})]})]})})}function HW({kinds:e=[],selectedKind:t="all",onSelect:r}){return o.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:s,count:i})=>{const a=t===n;return o.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:a?"var(--action-primary)":"var(--bg-panel)",color:a?"#000":"var(--text-secondary)",border:a?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[s,i!==void 0&&o.jsxs("span",{style:{marginLeft:4,opacity:a?.7:.6},children:["(",i,")"]})]},n)})})}function fl({title:e,count:t,dotColor:r,defaultOpen:n=!1,action:s,children:i}){const[a,l]=m.useState(n);return o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[o.jsxs("button",{onClick:()=>l(!a),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{style:{color:"var(--text-muted)",transform:a?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),o.jsx("span",{style:{color:r,fontSize:10},children:""}),o.jsx("span",{className:"font-semibold",children:e})]}),o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),s&&o.jsx("div",{className:"pr-3",children:s})]}),a&&o.jsx("div",{style:{background:"var(--bg-panel)"},children:i})]})}function no({onClick:e,label:t,sublabel:r,badge:n,isSelected:s}){return o.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:s?"var(--bg-selected, rgba(99, 102, 241, 0.15))":"transparent",border:"none",borderLeft:s?"3px solid var(--action-primary)":"3px solid transparent",color:s?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium truncate",children:t}),n&&o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:n})]}),r&&o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function pl({loading:e,empty:t,emptyMessage:r="None found"}){return e?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function VW({isOpen:e,onClose:t,promptFragments:r=[],promptFragmentKindOptions:n=[],templates:s=[],schemas:i=[],documentTypes:a=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,selectedFragment:h=null,selectedTemplate:v=null,selectedSchema:g=null,selectedMechanicalOp:_=null,onSelectFragment:x,onSelectTemplate:y,onSelectSchema:b,onSelectStandaloneSchema:w,onSelectMechanicalOp:k,onCreateFragment:C,onCreateTemplate:N,onCreateSchema:E}){const[j,A]=m.useState("all"),[T,D]=m.useState(!1),[F,S]=m.useState("role"),[I,M]=m.useState(""),[z,P]=m.useState(!1),[R,L]=m.useState(!1),[$,q]=m.useState(""),[Y,K]=m.useState(!1),[H,B]=m.useState(!1),[X,ie]=m.useState(""),[oe,J]=m.useState(!1),we=j==="all"?r:r.filter(U=>U.kind===j);m.useEffect(()=>{e||(D(!1),L(!1),B(!1),M(""),q(""),ie(""))},[e]);const ge=m.useCallback((U,re)=>{U==null||U(re)},[]),_e=async()=>{const U=I.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){P(!0);try{await(C==null?void 0:C({role_id:U,kind:F})),D(!1),M("")}catch{}finally{P(!1)}}},xe=async()=>{const U=$.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){K(!0);try{await(N==null?void 0:N({template_id:U})),L(!1),q("")}catch{}finally{K(!1)}}},ae=async()=>{const U=X.trim().toLowerCase().replace(/\s+/g,"_");if(!(!U||!/^[a-z][a-z0-9_]*$/.test(U))){J(!0);try{await(E==null?void 0:E({schema_id:U})),B(!1),ie("")}catch{}finally{J(!1)}}};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),o.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),o.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs(fl,{title:"Prompt Fragments",count:r.length,dotColor:"#f59e0b",defaultOpen:!0,action:C&&o.jsx("button",{onClick:()=>D(!T),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[T&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),o.jsx("select",{value:F,onChange:U=>S(U.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:o.jsx("option",{value:"role",children:"Role"})})]}),o.jsx("input",{type:"text",value:I,onChange:U=>M(U.target.value),onKeyDown:U=>{U.key==="Enter"&&_e(),U.key==="Escape"&&D(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:z,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:_e,disabled:z||!I.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:z?"wait":"pointer",opacity:!I.trim()||z?.5:1},children:z?"Creating...":"Create"}),o.jsx("button",{onClick:()=>D(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.length>0&&o.jsx(HW,{kinds:n,selectedKind:j,onSelect:A}),o.jsx(pl,{loading:d,empty:!d&&we.length===0,emptyMessage:j==="all"?"No prompt fragments":`No ${j} fragments`}),!d&&we.length>0&&o.jsx("div",{className:"py-1",children:we.map(U=>o.jsx(no,{onClick:()=>ge(x,U),label:U.name||U.fragment_id,sublabel:`${U.kind}  v${U.version}`,badge:U.kind,isSelected:(h==null?void 0:h.fragment_id)===U.fragment_id},U.fragment_id))})]}),o.jsxs(fl,{title:"Templates",count:s.length,dotColor:"var(--dot-green)",action:N&&o.jsx("button",{onClick:()=>L(!R),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[R&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:$,onChange:U=>q(U.target.value),onKeyDown:U=>{U.key==="Enter"&&xe(),U.key==="Escape"&&L(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:Y,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:xe,disabled:Y||!$.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Y?"wait":"pointer",opacity:!$.trim()||Y?.5:1},children:Y?"Creating...":"Create"}),o.jsx("button",{onClick:()=>L(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(pl,{loading:u,empty:!u&&s.length===0,emptyMessage:"No templates"}),!u&&s.length>0&&o.jsx("div",{className:"py-1",children:s.map(U=>o.jsx(no,{onClick:()=>ge(y,U),label:U.name||U.template_id.replace(/_/g," ").replace(/\b\w/g,re=>re.toUpperCase()),sublabel:`v${U.active_version}`,isSelected:(v==null?void 0:v.template_id)===U.template_id},U.template_id))})]}),o.jsxs(fl,{title:"Schemas",count:i.length||a.length,dotColor:"var(--dot-blue)",action:E&&o.jsx("button",{onClick:()=>B(!H),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[H&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:X,onChange:U=>ie(U.target.value),onKeyDown:U=>{U.key==="Enter"&&ae(),U.key==="Escape"&&B(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:oe,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:ae,disabled:oe||!X.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:oe?"wait":"pointer",opacity:!X.trim()||oe?.5:1},children:oe?"Creating...":"Create"}),o.jsx("button",{onClick:()=>B(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(pl,{loading:f,empty:!f&&i.length===0&&a.length===0,emptyMessage:"No schemas"}),!f&&i.length>0&&o.jsx("div",{className:"py-1",children:i.map(U=>o.jsx(no,{onClick:()=>ge(w,U),label:U.title||U.schema_id,sublabel:`v${U.active_version}`,isSelected:(g==null?void 0:g.schema_id)===U.schema_id},`standalone-${U.schema_id}`))}),i.length===0&&a.length>0&&o.jsx("div",{className:"py-1",children:a.map(U=>o.jsx(no,{onClick:()=>ge(b,{doc_type_id:U.doc_type_id,display_name:U.display_name,active_version:U.active_version}),label:U.display_name,sublabel:`from ${U.doc_type_id}`},`schema-${U.doc_type_id}`))})]}),o.jsxs(fl,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[o.jsx(pl,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&o.jsx("div",{className:"py-1",children:l.map(U=>{const re=c.filter(te=>te.type===U.type_id);return o.jsxs("div",{children:[o.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsx("span",{style:{fontSize:10},children:""}),o.jsx("span",{children:U.name}),o.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",re.length,")"]})]}),re.length>0?re.map(te=>o.jsx(no,{onClick:()=>ge(k,te),label:te.name,sublabel:`v${te.active_version}`,badge:te.type,isSelected:(_==null?void 0:_.op_id)===te.op_id},te.op_id)):o.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},U.type_id)})}),!p&&l.length===0&&c.length===0&&o.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),o.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function tn({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:s=!1,error:i=null,readOnly:a=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a&&o.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!a&&s&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[c&&!a&&o.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&o.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&s&&o.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),i&&o.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",i]})]})]}),o.jsx("div",{className:"flex-1 relative",children:r?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):o.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:a,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function UW({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),i(!1);return}(async()=>{i(!0),l(null);try{const d=await be.getPreview(e,t);n(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{i(!1)}})()},[e,t]),o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),o.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&o.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&o.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&o.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&o.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),o.jsx("div",{className:"flex-1 relative overflow-auto",children:s?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):a?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[o.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),o.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:a})]})}):o.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function GW({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,w,k;t&&(i({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((w=t.ui)==null?void 0:w.category)||"",ui_display_order:((k=t.ui)==null?void 0:k.display_order)||0}),h(!1),f(null))},[t]);const v=m.useCallback((b,w)=>{i(k=>({...k,[b]:w})),h(!0)},[]),g=m.useCallback((b,w)=>{const k=w.split(",").map(C=>C.trim()).filter(C=>C);i(C=>({...C,[b]:k})),h(!0)},[]),_=m.useCallback(b=>{if(!b)return"";const w=r.find(k=>k.role_id===b);return w?`prompt:role:${b}:${w.active_version}`:""},[r]),x=m.useCallback(b=>{if(!b)return"";const w=b.split(":");return w.length>=3&&w[0]==="prompt"&&w[1]==="role"?w[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!s)){d(!0),f(null);try{const b=t.version||t.active_version,w=`doctype:${t.doc_type_id}:${b}:manifest`,k=KW(t.doc_type_id,b,s),C=await be.writeArtifact(e,w,k);h(!1),n==null||n(w,C)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,s,n]);return!t||!s?o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsx("div",{className:"flex items-center gap-2",children:p&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),o.jsxs("div",{className:"flex items-center gap-2",children:[c&&o.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&o.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),o.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"max-w-2xl space-y-6",children:[o.jsxs(so,{title:"Identity",children:[o.jsx(Zt,{label:"Display Name",children:o.jsx("input",{type:"text",value:s.display_name,onChange:b=>v("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Description",children:o.jsx("textarea",{value:s.description,onChange:b=>v("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),o.jsxs(so,{title:"Classification",children:[o.jsx(Zt,{label:"Authority Level",children:o.jsxs("select",{value:s.authority_level,onChange:b=>v("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"descriptive",children:"Descriptive"}),o.jsx("option",{value:"prescriptive",children:"Prescriptive"}),o.jsx("option",{value:"constructive",children:"Constructive"}),o.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),o.jsx(Zt,{label:"Creation Mode",children:o.jsxs("select",{value:s.creation_mode,onChange:b=>v("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"llm_generated",children:"LLM Generated"}),o.jsx("option",{value:"constructed",children:"Constructed"}),o.jsx("option",{value:"extracted",children:"Extracted"})]})}),o.jsx(Zt,{label:"Scope",children:o.jsxs("select",{value:s.scope,onChange:b=>v("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"project",children:"Project"}),o.jsx("option",{value:"epic",children:"Epic"}),o.jsx("option",{value:"feature",children:"Feature"})]})})]}),o.jsx(so,{title:"Shared References",children:o.jsxs(Zt,{label:"Role Prompt",children:[o.jsxs("select",{value:x(s.role_prompt_ref),onChange:b=>v("role_prompt_ref",_(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"",children:"None"}),r.map(b=>o.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())},b.role_id))]}),s.role_prompt_ref&&o.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:s.role_prompt_ref})]})}),o.jsxs(so,{title:"Dependencies",children:[o.jsx(Zt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Parent Doc Type",children:o.jsx("input",{type:"text",value:s.parent_doc_type,onChange:b=>v("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),o.jsxs(so,{title:"UI Configuration",children:[o.jsx(Zt,{label:"Icon",children:o.jsx("input",{type:"text",value:s.ui_icon,onChange:b=>v("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Category",children:o.jsxs("select",{value:s.ui_category,onChange:b=>v("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"",children:"Select category..."}),o.jsx("option",{value:"intake",children:"Intake"}),o.jsx("option",{value:"architecture",children:"Architecture"}),o.jsx("option",{value:"planning",children:"Planning"}),o.jsx("option",{value:"execution",children:"Execution"})]})}),o.jsx(Zt,{label:"Display Order",children:o.jsx("input",{type:"number",value:s.ui_display_order,onChange:b=>v("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function so({title:e,children:t}){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),o.jsx("div",{className:"space-y-4",children:t})]})}function Zt({label:e,hint:t,children:r}){return o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&o.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function KW(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(s=>`"${s}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(s=>`"${s}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(s=>`"${s}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function B3(e,t,{debounceMs:r=1e3,onSave:n}={}){const[s,i]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,g]=m.useState(null),_=m.useRef(null),x=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){i(null),l(null),d(!1);return}d(!0),f(null);try{const N=await be.getArtifact(e,t),E=JSON.parse(N.content);i(E),l(E)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{d(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){h(!0),f(null);try{const E=JSON.stringify(N,null,2),j=await be.writeArtifact(e,t,E);g(j),l(N),n&&n(j)}catch(E){f(E.message),console.error("Failed to save workflow:",E)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(N=>{x.current=N,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{x.current!==null&&(b(x.current),x.current=null)},r)},[b,r]),k=m.useCallback(N=>{i(N),w(N)},[w]),C=m.useCallback(()=>{_.current&&clearTimeout(_.current),s&&b(s)},[s,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{workflowJson:s,originalJson:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateWorkflow:k,saveNow:C,reload:y}}function YW({data:e,selected:t}){const{config:r,isEntry:n}=e,s=e.type==="end";return o.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[o.jsx(vr,{type:"target",position:ce.Top,style:{background:r.color,width:8,height:8,border:"none"}}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&o.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),o.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&o.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),o.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!s&&o.jsx(vr,{type:"source",position:ce.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const XW=m.memo(YW),QW={workflowNode:XW},ZW=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function JW({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:s,onEdgeSelect:i}){const a=su(),[l,c,d]=SE([]),[u,f,p]=kE([]),[h,v]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:j,edges:A}=X2(e);(!j.some(D=>D.position.x!==0||D.position.y!==0)||!g.current)&&(j=_c(j,A),g.current=!0),c(j),f(A)},[e,c,f]),m.useEffect(()=>{c(j=>j.map(A=>({...A,selected:A.id===r})))},[r,c]);const _=m.useCallback(j=>{if(!e)return;const T={edge_id:qq(j.source,j.target,e.edges||[]),from_node_id:j.source,to_node_id:j.target,outcome:"success",label:"",kind:"auto"},D={...e,edges:[...e.edges||[],T]};t(D)},[e,t]),x=m.useCallback((j,A)=>{if(!e)return;const T=e.nodes.map(D=>D.node_id===A.id?{...D,_position:A.position}:D);t({...e,nodes:T})},[e,t]),y=m.useCallback((j,A)=>{s==null||s(A.id)},[s]),b=m.useCallback((j,A)=>{i==null||i(A.id)},[i]),w=m.useCallback(()=>{s==null||s(null),i==null||i(null)},[s,i]),k=m.useCallback(j=>{if(j.key==="Delete"||j.key==="Backspace"){if(r&&e){const A={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(A),s==null||s(null)}else if(n&&e){const A={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(A),i==null||i(null)}}},[r,n,e,t,s,i]),C=m.useCallback(j=>{if(!e)return;const A=$q(j,e.nodes||[]),T=Bq(j);T.node_id=A;const D=a.getViewport(),F=(-D.x+window.innerWidth/2)/D.zoom,S=(-D.y+window.innerHeight/2)/D.zoom;T._position={x:F-110,y:S-50};const I={...e,nodes:[...e.nodes||[],T]};t(I),v(!1),s==null||s(A)},[e,t,a,s]),N=m.useCallback(()=>{if(!e)return;let{nodes:j,edges:A}=X2(e);j=_c(j,A);const T=e.nodes.map(D=>{const F=j.find(S=>S.id===D.node_id);return F?{...D,_position:F.position}:D});t({...e,nodes:T}),setTimeout(()=>{a.fitView({padding:.2,duration:300})},50)},[e,t,a]),E=m.useCallback(()=>{a.fitView({padding:.2,duration:300})},[a]);return o.jsx("div",{className:"flex-1 relative",onKeyDown:k,tabIndex:0,style:{outline:"none"},children:o.jsxs(wa,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:_,onNodeDragStop:x,onNodeClick:y,onEdgeClick:b,onPaneClick:w,nodeTypes:QW,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[o.jsx(Hn,{position:"top-left",children:o.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>v(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&o.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:ZW.map(j=>{const A=bc[j.value]||{};return o.jsxs("button",{onClick:()=>C(j.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[o.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:A.color}}),j.label]},j.value)})})]}),o.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),o.jsx("button",{onClick:E,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),o.jsx(EE,{position:"bottom-right",nodeColor:j=>{var T;const A=(T=j.data)==null?void 0:T.config;return(A==null?void 0:A.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),o.jsx(Hn,{position:"bottom-left",children:o.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(bc).map(([j,A])=>o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:A.color}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:A.label})]},j))})}),o.jsx(Hn,{position:"top-right",children:o.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const eH=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],NS=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],CS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],tH=["semantic","structural","hybrid"],rH=["stabilized","blocked","abandoned"],Fe={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},wt={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},nH={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function xg(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function vg(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function $s(e){var s;if(!e)return"";const t=e.kind||"role",r=((s=e.fragment_id)==null?void 0:s.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function qs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function hl(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function ml(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function yg({title:e,defaultOpen:t=!1,isOpen:r,onToggle:n,children:s,badge:i}){const[a,l]=m.useState(t),c=r!==void 0,d=c?r:a,u=()=>{c&&n?n():l(!a)};return o.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:o.jsx("path",{d:"M9 18l6-6-6-6"})}),o.jsx("span",{style:{...wt,marginBottom:0},children:e})]}),i&&o.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:i})]}),d&&o.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:s})]})}function bg(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function Bs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function sH({node:e,onChange:t,onDelete:r,templates:n=[],schemas:s=[],roleFragments:i=[],taskFragments:a=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var se,fe,he,Q,me,qe,Le,Ce,Ee,Me,tt,Ie,Z,Te,ve,Ct,yt,bt,Qt;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const v=(O,W)=>{const V={...u,[O]:W};f(V),t(V)},g=(O,W)=>{const V={...u.includes,[O]:W},ne={...u,includes:V};f(ne),t(ne)},_=O=>{const W={...u.includes};delete W[O];const V={...u,includes:W};f(V),t(V)},x=()=>{const O={...u.includes,NEW_KEY:""},W={...u,includes:O};f(W),t(W)},y=O=>{const W={...u,internals:O};f(W),t(W)},b=(O,W)=>{const V=u.internals||C(),ne={...V.question_generation,[O]:W};y({...V,question_generation:ne})},w=(O,W)=>{const V=u.internals||C(),ne={...V.question_generation.includes,[O]:W},ze={...V.question_generation,includes:ne};y({...V,question_generation:ze})},k=(O,W)=>{const V=u.internals||C(),ne={...V.clarification_merge,[O]:W};y({...V,clarification_merge:ne})},C=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const N=u.type==="pgc",E=vg(u.task_ref),j=u.includes||{},A=j.ROLE_PROMPT||"",T=j.TASK_PROMPT||"",D=j.OUTPUT_SCHEMA||"",F=j.PGC_CONTEXT||"",S=qs(A),I=qs(T),M=ml(D),z=qs(F),P=Object.entries(j).filter(([O])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(O)),R=u.internals||C(),L=vg((se=R.question_generation)==null?void 0:se.template_ref),$=qs((he=(fe=R.question_generation)==null?void 0:fe.includes)==null?void 0:he.ROLE_PROMPT),q=qs((me=(Q=R.question_generation)==null?void 0:Q.includes)==null?void 0:me.TASK_PROMPT),Y=qs((Le=(qe=R.question_generation)==null?void 0:qe.includes)==null?void 0:Le.PGC_CONTEXT),K=ml((Ce=R.question_generation)==null?void 0:Ce.output_schema_ref),H=vg((Ee=R.clarification_merge)==null?void 0:Ee.template_ref),B=ml((Me=R.clarification_merge)==null?void 0:Me.output_schema_ref),X=O=>{const W=O.target.value;if(!W){v("task_ref","");return}const V=n.find(ne=>ne.template_id===W);V&&v("task_ref",xg(V))},ie=O=>{const W=O.target.value;if(!W){_("ROLE_PROMPT");return}const V=i.find(ne=>ne.fragment_id===`role:${W}`||ne.id===W);V&&g("ROLE_PROMPT",$s(V))},oe=O=>{const W=O.target.value;if(!W){_("TASK_PROMPT");return}const V=a.find(ne=>ne.fragment_id===`task:${W}`||ne.id===W);V&&g("TASK_PROMPT",$s(V))},J=O=>{const W=O.target.value;if(!W){_("OUTPUT_SCHEMA");return}const V=s.find(ne=>ne.schema_id===W);V&&g("OUTPUT_SCHEMA",hl(V))},we=O=>{const W=O.target.value;if(!W){_("PGC_CONTEXT");return}const V=l.find(ne=>ne.fragment_id===`pgc:${W}`||ne.id===W);V&&g("PGC_CONTEXT",$s(V))},ge=O=>{const W=O.target.value,V=CS.find(ct=>ct.value===W),ne=(V==null?void 0:V.produces)||`pgc_clarifications.${W}`,ze={...u,gate_kind:W,produces:ne};f(ze),t(ze)},_e=O=>{const W=O.target.value;if(!W){b("template_ref","");return}const V=n.find(ne=>ne.template_id===W);V&&b("template_ref",xg(V))},xe=O=>{const W=O.target.value;if(!W){w("ROLE_PROMPT","");return}const V=i.find(ne=>ne.fragment_id===`role:${W}`||ne.id===W);V&&w("ROLE_PROMPT",$s(V))},ae=O=>{const W=O.target.value;if(!W){w("TASK_PROMPT","");return}const V=a.find(ne=>ne.fragment_id===`task:${W}`||ne.id===W);V&&w("TASK_PROMPT",$s(V))},U=O=>{const W=O.target.value;if(!W){w("PGC_CONTEXT","");return}const V=l.find(ne=>ne.fragment_id===`pgc:${W}`||ne.id===W);V&&w("PGC_CONTEXT",$s(V))},re=O=>{const W=O.target.value;if(!W){b("output_schema_ref","");return}const V=s.find(ne=>ne.schema_id===W);V&&b("output_schema_ref",hl(V))},te=O=>{const W=O.target.value;if(!W){k("template_ref","");return}const V=n.find(ne=>ne.template_id===W);V&&k("template_ref",xg(V))},je=O=>{const W=O.target.value;if(!W){k("output_schema_ref","");return}const V=s.find(ne=>ne.schema_id===W);V&&k("output_schema_ref",hl(V))};return o.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:N?"PGC Gate Properties":"Node Properties"}),o.jsx("button",{onClick:()=>r(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Node ID"}),o.jsx("input",{type:"text",value:u.node_id||"",onChange:O=>v("node_id",O.target.value),style:Fe})]}),o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Type"}),o.jsx("select",{value:u.type||"task",onChange:O=>v("type",O.target.value),style:Fe,children:eH.map(O=>o.jsx("option",{value:O.value,children:O.label},O.value))})]}),N&&o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Gate Kind"}),o.jsx("select",{value:u.gate_kind||"discovery",onChange:ge,style:Fe,children:CS.map(O=>o.jsx("option",{value:O.value,children:O.label},O.value))})]}),o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Description"}),o.jsx("textarea",{value:u.description||"",onChange:O=>v("description",O.target.value),rows:2,style:{...Fe,resize:"vertical"}})]}),(N||["task","intake_gate"].includes(u.type))&&o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Produces"}),o.jsx("input",{type:"text",value:u.produces||"",onChange:O=>v("produces",O.target.value),placeholder:N?"pgc_clarifications.discovery":"document_type",style:Fe})]}),N&&o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{style:nH,children:"Gate Internals"}),o.jsx(yg,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),o.jsxs("select",{value:L||"",onChange:_e,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Template --"}),n.map(O=>o.jsx("option",{value:O.template_id,children:O.name||O.template_id.replace(/_/g," ")},O.template_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),o.jsxs("select",{value:$||"",onChange:xe,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Role --"}),i.map(O=>{var V;const W=((V=O.fragment_id)==null?void 0:V.replace("role:",""))||O.id;return o.jsx("option",{value:W,children:O.name||(W==null?void 0:W.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),o.jsxs("select",{value:q||"",onChange:ae,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Task --"}),a.map(O=>{var V;const W=((V=O.fragment_id)==null?void 0:V.replace("task:",""))||O.id;return o.jsx("option",{value:W,children:O.name||(W==null?void 0:W.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),o.jsxs("select",{value:Y||"",onChange:U,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(O=>{var V;const W=((V=O.fragment_id)==null?void 0:V.replace("pgc:",""))||O.id;return o.jsx("option",{value:W,children:O.name||(W==null?void 0:W.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:K||"",onChange:re,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(O=>o.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]})}),o.jsx("div",{className:"mt-2",children:o.jsx(yg,{title:"Entry: Operator Answers",badge:"UI",children:o.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Renders:"}),o.jsx("span",{className:"font-mono",children:((tt=R.operator_entry)==null?void 0:tt.renders)||"question_set"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Captures:"}),o.jsx("span",{className:"font-mono",children:((Ie=R.operator_entry)==null?void 0:Ie.captures)||"pgc_answers"})]}),o.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),o.jsx("div",{className:"mt-2",children:o.jsx(yg,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((Z=R.clarification_merge)==null?void 0:Z.internal_type)||"LLM",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),o.jsxs("select",{value:((Te=R.clarification_merge)==null?void 0:Te.internal_type)||"LLM",onChange:O=>k("internal_type",O.target.value),style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"LLM",children:"LLM"}),o.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((ve=R.clarification_merge)==null?void 0:ve.internal_type)||"LLM")==="LLM"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),o.jsxs("select",{value:H||"",onChange:te,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Template --"}),n.map(O=>o.jsx("option",{value:O.template_id,children:O.name||O.template_id.replace(/_/g," ")},O.template_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:B||"",onChange:je,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(O=>o.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]}),((Ct=R.clarification_merge)==null?void 0:Ct.internal_type)==="MECH"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),o.jsxs("select",{value:Bs((yt=R.clarification_merge)==null?void 0:yt.op_ref)||"",onChange:O=>{const W=O.target.value;if(!W){k("op_ref","");return}const V=d.find(ne=>ne.op_id===W);V&&k("op_ref",bg(V))},style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(O=>O.type==="merger").map(O=>o.jsx("option",{value:O.op_id,children:O.name},O.op_id))]})]}),((bt=R.clarification_merge)==null?void 0:bt.op_ref)&&(()=>{const O=Bs(R.clarification_merge.op_ref),W=d.find(V=>V.op_id===O);return W?o.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:W.type}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:B||"",onChange:je,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(O=>o.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]}),o.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Internal Type"}),o.jsx("select",{value:u.internal_type||"LLM",onChange:O=>v("internal_type",O.target.value),style:Fe,children:NS.map(O=>o.jsx("option",{value:O.value,children:O.label},O.value))}),o.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Qt=NS.find(O=>O.value===(u.internal_type||"LLM")))==null?void 0:Qt.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Interaction Template"}),o.jsxs("select",{value:E||"",onChange:X,style:Fe,children:[o.jsx("option",{value:"",children:"-- Select Template --"}),n.map(O=>o.jsx("option",{value:O.template_id,children:O.name||O.template_id.replace(/_/g," ")},O.template_id))]}),u.task_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Mechanical Operation"}),o.jsxs("select",{value:Bs(u.op_ref)||"",onChange:O=>{const W=O.target.value;if(!W){v("op_ref","");return}const V=d.find(ne=>ne.op_id===W);V&&v("op_ref",bg(V))},style:Fe,children:[o.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(O=>{const W=d.filter(V=>V.type===O.type_id);return W.length===0?null:o.jsx("optgroup",{label:O.name,children:W.map(V=>o.jsx("option",{value:V.op_id,children:V.name},V.op_id))},O.type_id)})]}),u.op_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const O=Bs(u.op_ref),W=d.find(ne=>ne.op_id===O),V=W?c.find(ne=>ne.type_id===W.type):null;return W?o.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(V==null?void 0:V.name)||W.type}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Output Schema"}),o.jsxs("select",{value:ml(u.output_schema_ref)||"",onChange:O=>{const W=O.target.value;if(!W){v("output_schema_ref","");return}const V=s.find(ne=>ne.schema_id===W);V&&v("output_schema_ref",hl(V))},style:Fe,children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(O=>o.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Entry Operation"}),o.jsxs("select",{value:Bs(u.op_ref)||"",onChange:O=>{const W=O.target.value;if(!W){v("op_ref","");return}const V=d.find(ne=>ne.op_id===W);V&&v("op_ref",bg(V))},style:Fe,children:[o.jsx("option",{value:"",children:"-- Select Entry Operation --"}),d.filter(O=>O.type==="entry").map(O=>o.jsx("option",{value:O.op_id,children:O.name},O.op_id))]}),u.op_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const O=Bs(u.op_ref),W=d.find(ne=>ne.op_id===O);if(!W)return null;const V=W.config||{};return o.jsxs("div",{className:"p-2 rounded text-xs space-y-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-orange, #f97316)",color:"#fff"},children:"Entry"}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description}),o.jsxs("div",{className:"pt-2 border-t space-y-1",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Renders:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:V.renders||"-"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Captures:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:V.captures||"-"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Layout:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:V.layout||"form"})]})]}),V.entry_prompt&&o.jsxs("div",{className:"p-2 rounded mt-2",style:{background:"var(--bg-panel)"},children:[o.jsx("div",{className:"text-[10px] uppercase mb-1",style:{color:"var(--text-muted)"},children:"Entry Prompt"}),o.jsx("div",{style:{color:"var(--text-primary)"},children:V.entry_prompt})]})]})})(),!u.op_ref&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Select an Entry operation above, or define custom renders/captures below."}),o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Renders"}),o.jsx("input",{type:"text",value:u.renders||"",onChange:O=>v("renders",O.target.value),placeholder:"e.g., question_set",style:Fe})]}),o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Captures"}),o.jsx("input",{type:"text",value:u.captures||"",onChange:O=>v("captures",O.target.value),placeholder:"e.g., user_answers",style:Fe})]})]})]}),u.type==="qa"&&o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"QA Mode"}),o.jsx("select",{value:u.qa_mode||"semantic",onChange:O=>v("qa_mode",O.target.value),style:Fe,children:tH.map(O=>o.jsx("option",{value:O,children:O},O))})]}),u.type==="end"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Terminal Outcome"}),o.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:O=>v("terminal_outcome",O.target.value),style:Fe,children:rH.map(O=>o.jsx("option",{value:O,children:O},O))})]}),o.jsxs("div",{children:[o.jsx("label",{style:wt,children:"Gate Outcome"}),o.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:O=>v("gate_outcome",O.target.value),placeholder:"e.g., complete, failed",style:Fe})]})]}),o.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:O=>v("requires_qa",O.target.checked)}),"Requires QA"]}),o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:O=>v("non_advancing",O.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&o.jsxs("div",{children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsx("label",{style:wt,children:"Includes"})}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),o.jsxs("select",{value:S||"",onChange:ie,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Role --"}),i.map(O=>{var V;const W=((V=O.fragment_id)==null?void 0:V.replace("role:",""))||O.id;return o.jsx("option",{value:W,children:O.name||(W==null?void 0:W.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),o.jsxs("select",{value:I||"",onChange:oe,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Task --"}),a.map(O=>{var V;const W=((V=O.fragment_id)==null?void 0:V.replace("task:",""))||O.id;return o.jsx("option",{value:W,children:O.name||(W==null?void 0:W.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:M||"",onChange:J,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(O=>o.jsx("option",{value:O.schema_id,children:O.title||O.schema_id.replace(/_/g," ")},O.schema_id))]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),o.jsxs("select",{value:z||"",onChange:we,style:{...Fe,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(O=>{var V;const W=((V=O.fragment_id)==null?void 0:V.replace("pgc:",""))||O.id;return o.jsx("option",{value:W,children:O.name||(W==null?void 0:W.replace(/_/g," "))},O.fragment_id||O.id)})]})]}),P.length>0&&o.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),o.jsx("div",{className:"space-y-2",children:P.map(([O,W])=>o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"text",value:O,onChange:V=>{const ne={...u.includes};delete ne[O],ne[V.target.value]=W;const ze={...u,includes:ne};f(ze),t(ze)},style:{...Fe,width:"35%",fontSize:10},placeholder:"KEY"}),o.jsx("input",{type:"text",value:W,onChange:V=>g(O,V.target.value),style:{...Fe,flex:1,fontSize:10},placeholder:"path/to/file"}),o.jsx("button",{onClick:()=>_(O),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},O))})]}),o.jsx("button",{onClick:x,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const iH=["auto","user_choice"],oH=["eq","ne","lt","lte","gt","gte"],Zr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},is={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function aH({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[s,i]=m.useState(e);m.useEffect(()=>{i(e)},[e]);const a=(u,f)=>{const p={...s,[u]:f};i(p),r(p)},l=()=>{const u=[...s.conditions||[],{type:"retry_count",operator:"lt",value:2}];a("conditions",u)},c=(u,f,p)=>{const h=[...s.conditions||[]];h[u]={...h[u],[f]:p},a("conditions",h)},d=u=>{const f=(s.conditions||[]).filter((p,h)=>h!==u);a("conditions",f)};return s?o.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),o.jsx("button",{onClick:()=>n(s.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Edge ID"}),o.jsx("input",{type:"text",value:s.edge_id||"",onChange:u=>a("edge_id",u.target.value),style:Zr})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"From Node"}),o.jsx("select",{value:s.from_node_id||"",onChange:u=>a("from_node_id",u.target.value),style:Zr,children:t.map(u=>o.jsx("option",{value:u,children:u},u))})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"To Node"}),o.jsxs("select",{value:s.to_node_id||"",onChange:u=>a("to_node_id",u.target.value||null),style:Zr,children:[o.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>o.jsx("option",{value:u,children:u},u))]})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Outcome"}),o.jsx("input",{type:"text",value:s.outcome||"",onChange:u=>a("outcome",u.target.value),placeholder:"success, failed, etc.",style:Zr})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Label"}),o.jsx("input",{type:"text",value:s.label||"",onChange:u=>a("label",u.target.value),placeholder:"Human-readable label",style:Zr})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Kind"}),o.jsx("select",{value:s.kind||"auto",onChange:u=>a("kind",u.target.value),style:Zr,children:iH.map(u=>o.jsx("option",{value:u,children:u},u))})]}),o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:s.non_advancing||!1,onChange:u=>a("non_advancing",u.target.checked)}),"Non-advancing"]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{style:is,children:"Conditions"}),o.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),o.jsx("div",{className:"space-y-2",children:(s.conditions||[]).map((u,f)=>o.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:o.jsxs("div",{className:"flex gap-1 items-center",children:[o.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Zr,flex:1,fontSize:10}}),o.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Zr,width:"auto",fontSize:10},children:oH.map(p=>o.jsx("option",{value:p,children:p},p))}),o.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Zr,width:50,fontSize:10}}),o.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const lH={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function cH({workspaceId:e,artifactId:t,onArtifactSave:r,mechanicalOpTypes:n=[],mechanicalOps:s=[]}){var Y,K,H;const[i,a]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,v]=m.useState(null),{workflowJson:g,loading:_,error:x,saving:y,lastSaveResult:b,updateWorkflow:w}=B3(e,t,{onSave:B=>{r==null||r(t,B)}}),{templates:k}=z3(),{schemas:C}=F3(),{fragmentsByKind:N}=$3(),E=m.useMemo(()=>{var B;return!l||!g?null:((B=g.nodes)==null?void 0:B.find(X=>X.node_id===l))||null},[l,g]),j=m.useMemo(()=>{var B;return!d||!g?null:((B=g.edges)==null?void 0:B.find(X=>X.edge_id===d))||null},[d,g]),A=m.useMemo(()=>g!=null&&g.nodes?g.nodes.map(B=>B.node_id):[],[g]),T=m.useCallback(B=>{w(B)},[w]),D=m.useCallback(B=>{if(!g)return;const X=g.nodes.map(J=>J.node_id===l?B:J);let ie=g.edges,oe=g.entry_node_ids||[];B.node_id!==l&&(ie=g.edges.map(J=>({...J,from_node_id:J.from_node_id===l?B.node_id:J.from_node_id,to_node_id:J.to_node_id===l?B.node_id:J.to_node_id})),oe=oe.map(J=>J===l?B.node_id:J),c(B.node_id)),w({...g,nodes:X,edges:ie,entry_node_ids:oe})},[g,l,w]),F=m.useCallback(B=>{if(!g)return;const X=g.edges.map(ie=>ie.edge_id===d?B:ie);B.edge_id!==d&&u(B.edge_id),w({...g,edges:X})},[g,d,w]),S=m.useCallback(B=>{g&&(w({...g,nodes:g.nodes.filter(X=>X.node_id!==B),edges:g.edges.filter(X=>X.from_node_id!==B&&X.to_node_id!==B),entry_node_ids:(g.entry_node_ids||[]).filter(X=>X!==B)}),c(null))},[g,w]),I=m.useCallback(B=>{g&&(w({...g,edges:g.edges.filter(X=>X.edge_id!==B)}),u(null))},[g,w]),M=m.useCallback(B=>{c(B),B&&u(null)},[]),z=m.useCallback(B=>{u(B),B&&c(null)},[]),P=m.useCallback(B=>{B==="json"&&g&&(p(JSON.stringify(g,null,2)),v(null)),a(B)},[g]),R=m.useCallback(B=>{const X=B.target.value;p(X);try{const ie=JSON.parse(X);v(null),w(ie)}catch(ie){v(ie.message)}},[w]),L=((Y=b==null?void 0:b.tier1_report)==null?void 0:Y.results)||[],$=L.filter(B=>B.severity==="error").length,q=L.filter(B=>B.severity==="warning").length;return o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[y&&o.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),x&&o.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:x}),!y&&!x&&g&&o.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((K=g.nodes)==null?void 0:K.length)||0," nodes, ",((H=g.edges)==null?void 0:H.length)||0," edges"]})]})}),o.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(B=>o.jsx("button",{onClick:()=>P(B.id),style:{...lH,color:i===B.id?"var(--text-primary)":"var(--text-muted)",borderBottom:i===B.id?"2px solid var(--action-primary)":"2px solid transparent"},children:B.label},B.id))}),_?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i==="canvas"&&o.jsxs(o.Fragment,{children:[o.jsx(Ii,{children:o.jsx(JW,{workflowJson:g,onWorkflowChange:T,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:M,onEdgeSelect:z})}),E&&o.jsx(sH,{node:E,onChange:D,onDelete:S,templates:k,schemas:C,roleFragments:N.role||[],taskFragments:N.task||[],pgcFragments:N.pgc||[],mechanicalOpTypes:n,mechanicalOps:s}),j&&o.jsx(aH,{edge:j,nodeIds:A,onChange:F,onDelete:I})]}),i==="json"&&o.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[o.jsx("textarea",{value:f,onChange:R,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&o.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),i==="metadata"&&o.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:g?o.jsx(uH,{workflow:g}):o.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),L.length>0&&o.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[$>0&&o.jsxs("span",{style:{color:"#ef4444"},children:[$," error",$!==1?"s":""]}),q>0&&o.jsxs("span",{style:{color:"#f59e0b"},children:[q," warning",q!==1?"s":""]}),$===0&&q===0&&o.jsx("span",{style:{color:"#10b981"},children:"Valid"}),o.jsx("span",{style:{color:"var(--text-muted)"},children:L.map(B=>B.message).join(" | ")})]})]})}function uH({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],s=e.thread_ownership||{},i=Object.entries(s),a=e.entry_node_ids||[];return o.jsxs("div",{className:"space-y-4 max-w-lg",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>o.jsxs("div",{children:[o.jsx("label",{style:r,children:l.label}),o.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),o.jsxs("div",{children:[o.jsx("label",{style:r,children:"Entry Node IDs"}),o.jsx("div",{style:t,children:a.length>0?a.join(", "):"-"})]}),i.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),i.map(([l,c])=>o.jsxs("div",{children:[o.jsx("label",{style:r,children:l}),o.jsx("div",{style:t,children:c})]},l))]})]})}function _g({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:s}){const[i,a]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!i)return;const c=d=>{l.current&&!l.current.contains(d.target)&&a(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[i]),t.length===0?null:o.jsxs("div",{ref:l,style:{position:"relative"},children:[o.jsxs("button",{onClick:()=>a(!i),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:s?"var(--text-primary)":"var(--text-muted)",background:s?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:s?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,o.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),i&&o.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>o.jsxs("button",{onClick:()=>{n(c.id),a(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&o.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function wg({label:e,isSelected:t,onClick:r}){return o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function dH({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:s=[],onArtifactSave:i,onCreateDcwWorkflow:a,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var Me,tt,Ie;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,v]=m.useState("source"),[g,_]=m.useState(null),[x,y]=m.useState(!1),[b,w]=m.useState(null),[k,C]=m.useState(null),[N,E]=m.useState(!1),[j,A]=m.useState(null),[T,D]=m.useState(null),[F,S]=m.useState(!1),[I,M]=m.useState(null),[z,P]=m.useState(null),[R,L]=m.useState(!1),[$,q]=m.useState(null),Y=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const Z=t.role_prompt_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="role"?null:{roleId:Z[2],version:Z[3]}},[t==null?void 0:t.role_prompt_ref]),K=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const Z=t.template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.template_ref]),H=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const Z=t.qa_template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.qa_template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const Z=t.pgc_template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!Y){_(null);return}y(!0),w(null),be.getRole(Y.roleId,Y.version).then(Z=>{_(Z.content)}).catch(Z=>{console.error("Failed to load role:",Z),w(Z.message)}).finally(()=>{y(!1)})},[Y]),m.useEffect(()=>{if(!K){C(null);return}E(!0),A(null),be.getTemplate(K.templateId,K.version).then(Z=>{C(Z.content)}).catch(Z=>{console.error("Failed to load template:",Z),A(Z.message)}).finally(()=>{E(!1)})},[K]),m.useEffect(()=>{if(!H){D(null);return}S(!0),M(null),be.getTemplate(H.templateId,H.version).then(Z=>{D(Z.content)}).catch(Z=>{console.error("Failed to load QA template:",Z),M(Z.message)}).finally(()=>{S(!1)})},[H]),m.useEffect(()=>{if(!B){P(null);return}L(!0),q(null),be.getTemplate(B.templateId,B.version).then(Z=>{P(Z.content)}).catch(Z=>{console.error("Failed to load PGC template:",Z),q(Z.message)}).finally(()=>{L(!1)})},[B]);const X=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const Z=t.version||t.active_version;return`doctype:${t.doc_type_id}:${Z}:${f}`},[t,f]),{content:ie,loading:oe,error:J,saving:we,isDirty:ge,updateContent:_e,lastSaveResult:xe}=Ea(e,X,{onSave:Z=>{i==null||i(X,Z)}}),ae=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],U=m.useMemo(()=>t?ae.filter(Z=>Z.id==="package"?!0:Z.id==="role_prompt"?!!t.role_prompt_ref:Z.id==="template"?!!t.template_ref:Z.id==="qa_template"?!!t.qa_template_ref:Z.id==="pgc_template"?!!t.pgc_template_ref:Z.id==="workflow"?!0:t.artifacts?t.artifacts[Z.id]!=null:!1):[],[t]),re=c==="task"||c==="schema";m.useEffect(()=>{re||U.length>0&&!U.find(Z=>Z.id===f)&&p(U[0].id)},[U,f,re]);const te=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",je=f==="package",se=f==="schema",fe=f==="workflow",he=!te&&!je&&!se&&!fe,Q=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:s.some(Z=>Z.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,s]),[me,qe]=m.useState(!1),Le=async()=>{if(!(!(t!=null&&t.doc_type_id)||!a)){qe(!0);try{await a(t.doc_type_id)}finally{qe(!1)}}};if(!t&&!r)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),o.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),o.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const Ce=c==="task"?"Interaction":c==="schema"?"Schema":null,Ee=!re&&(f==="task_prompt"||f==="schema");return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),o.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:re?Ce:o.jsxs(o.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),re&&o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!re&&o.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[U.find(Z=>Z.id==="package")&&o.jsx(wg,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),v("source")}}),U.find(Z=>Z.id==="workflow")&&o.jsx(wg,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),v("source")}}),(()=>{const Z=["role_prompt","task_prompt","template"],Te=U.filter(ve=>Z.includes(ve.id)).map(ve=>({id:ve.id,label:ve.id==="role_prompt"?"Role":ve.id==="task_prompt"?"Task":"Template",viewOnly:ve.viewOnly}));return Te.length===0?null:o.jsx(_g,{label:"Generation",items:Te,selectedId:Z.includes(f)?f:null,onSelect:ve=>{p(ve),v("source")},isGroupActive:Z.includes(f)})})(),(()=>{const Z=["qa_prompt","qa_template"],Te=U.filter(ve=>Z.includes(ve.id)).map(ve=>({id:ve.id,label:ve.id==="qa_prompt"?"Prompt":"Template",viewOnly:ve.viewOnly}));return Te.length===0?null:o.jsx(_g,{label:"QA",items:Te,selectedId:Z.includes(f)?f:null,onSelect:ve=>{p(ve),v("source")},isGroupActive:Z.includes(f)})})(),(()=>{const Z=["pgc_context","pgc_template"],Te=U.filter(ve=>Z.includes(ve.id)).map(ve=>({id:ve.id,label:ve.id==="pgc_context"?"Context":"Template",viewOnly:ve.viewOnly}));return Te.length===0?null:o.jsx(_g,{label:"PGC",items:Te,selectedId:Z.includes(f)?f:null,onSelect:ve=>{p(ve),v("source")},isGroupActive:Z.includes(f)})})(),U.find(Z=>Z.id==="schema")&&o.jsx(wg,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),v("source")}})]}),!re&&he&&!Ee&&o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>v("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),o.jsx("button",{onClick:()=>v("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((Me=t==null?void 0:t.artifacts)==null?void 0:Me[f])&&o.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),te&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&Y&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[Y.roleId.replace(/_/g," ")," v",Y.version]}),f==="template"&&K&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[K.templateId.replace(/_/g," ")," v",K.version]}),f==="qa_template"&&H&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[H.templateId.replace(/_/g," ")," v",H.version]}),f==="pgc_template"&&B&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]})]}),Ee&&o.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),se&&((tt=t==null?void 0:t.artifacts)==null?void 0:tt.schema)&&o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),o.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:fe?Q?o.jsx(cH,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:i,mechanicalOpTypes:d,mechanicalOps:u}):o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 max-w-md",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),o.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),a&&o.jsx("button",{onClick:Le,disabled:me,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:me?"wait":"pointer",opacity:me?.7:1},children:me?"Creating...":"Create Workflow"})]})}):f==="package"?o.jsx(GW,{workspaceId:e,docType:t,roles:n,onSave:i}):f==="role_prompt"?o.jsx(tn,{content:g||"",onChange:()=>{},loading:x,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?o.jsx(tn,{content:k||"",onChange:()=>{},loading:N,saving:!1,isDirty:!1,error:j,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?o.jsx(tn,{content:T||"",onChange:()=>{},loading:F,saving:!1,isDirty:!1,error:I,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?o.jsx(tn,{content:z||"",onChange:()=>{},loading:R,saving:!1,isDirty:!1,error:$,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||se?o.jsx(tn,{content:ie,onChange:Ee?()=>{}:_e,loading:oe,saving:Ee?!1:we,isDirty:Ee?!1:ge,error:J,readOnly:Ee,placeholder:`Enter ${((Ie=U.find(Z=>Z.id===f))==null?void 0:Ie.label)||"prompt"} content...`,isJson:se}):o.jsx(UW,{workspaceId:e,artifactId:X})}),he&&(xe==null?void 0:xe.tier1)&&!xe.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function fH({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:s,loading:i,error:a,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=Ea(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),o.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),o.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(tn,{content:s,onChange:d,loading:i,saving:l,isDirty:c,error:a,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const pH=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],jg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Sg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function hH({workspaceId:e,template:t,onArtifactSave:r}){const[n,s]=m.useState("metadata"),[i,a]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:v,error:g,saving:_,isDirty:x,updateContent:y,lastSaveResult:b}=Ea(e,f,{onSave:j=>{r==null||r(f,j)}});m.useEffect(()=>{t&&(a({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const w=m.useCallback((j,A)=>{a(T=>({...T,[j]:A})),c(!0)},[]),k=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const j=Oy.dump({name:i.name||null,purpose:i.purpose||null,use_case:i.use_case||null},{lineWidth:-1});await be.writeArtifact(e,p,j),c(!1),r==null||r(p,{success:!0})}catch(j){console.error("Failed to save metadata:",j),alert(`Failed to save metadata: ${j.message}`)}finally{u(!1)}}},[e,p,i,r]),C=m.useCallback(()=>{l&&k()},[l,k]);if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),o.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const N=i.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase()),E=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:N}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",t.active_version]}),o.jsx("span",{children:""}),o.jsx("span",{children:"Shared Template"}),i.purpose&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:i.purpose})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:E.map(j=>o.jsxs("button",{onClick:()=>s(j.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===j.id?"var(--text-primary)":"var(--text-muted)",background:n===j.id?"var(--bg-canvas)":"transparent",borderBottom:n===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[j.label,j.id==="metadata"&&l&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),j.id==="template"&&x&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},j.id))}),n==="metadata"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:Sg,children:"Template Name"}),o.jsx("input",{type:"text",value:i.name,onChange:j=>w("name",j.target.value),onBlur:C,placeholder:"e.g., Document Generator",style:jg}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),o.jsxs("div",{children:[o.jsx("label",{style:Sg,children:"Template Purpose"}),o.jsx("select",{value:i.purpose,onChange:j=>{w("purpose",j.target.value),setTimeout(()=>k(),0)},style:jg,children:pH.map(j=>o.jsx("option",{value:j.value,children:j.label},j.value))}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),o.jsxs("div",{children:[o.jsx("label",{style:Sg,children:"Use Case"}),o.jsx("textarea",{value:i.use_case,onChange:j=>w("use_case",j.target.value),onBlur:C,placeholder:"Describe when and how this template should be used...",rows:4,style:{...jg,resize:"vertical"}}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(tn,{content:h,onChange:y,loading:v,saving:_,isDirty:x,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function mH({workspaceId:e,schema:t,onArtifactSave:r}){var x;const[n,s]=m.useState("content"),i=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:a,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=Ea(e,i,{onSave:y=>{r==null||r(i,y)}});if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),o.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((x=t.schema_id)==null?void 0:x.replace(/_/g," "))||"Schema",v=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],_=!e;return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,o.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",v]}),_&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(y=>o.jsxs("button",{onClick:()=>s(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===y.id?"var(--text-primary)":"var(--text-muted)",background:n===y.id?"var(--bg-canvas)":"transparent",borderBottom:n===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),n==="content"&&o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(tn,{content:a,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:_,isJson:!0})}),n==="info"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Schema ID"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Version"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:v})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Title (from JSON)"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),o.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"File Path"}),o.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",v,"/schema.json"]})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Artifact ID"}),o.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",v]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const gH={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},xH={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},kg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},oo={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function vH({workspaceId:e,fragment:t,onArtifactSave:r}){var L;const[n,s]=m.useState("content"),[i,a]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,v]=((L=t==null?void 0:t.fragment_id)==null?void 0:L.split(":"))||[null,null],g=t?h==="role"?`fragment:role:${v}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,_=t&&h==="role"?`fragment:role:${v}:${t.version}:meta`:null,{content:x,loading:y,error:b,saving:w,isDirty:k,updateContent:C,lastSaveResult:N}=Ea(e,g,{onSave:$=>{r==null||r(g,$)}});m.useEffect(()=>{t&&(a({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const E=m.useCallback(($,q)=>{a(Y=>({...Y,[$]:q})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!_)){u(!0);try{const $=Oy.dump({name:i.name||null,intent:i.intent||null,tags:i.tags.length>0?i.tags:null},{lineWidth:-1});await be.writeArtifact(e,_,$),c(!1),r==null||r(_,{success:!0})}catch($){console.error("Failed to save metadata:",$),alert(`Failed to save metadata: ${$.message}`)}finally{u(!1)}}},[e,_,i,r]),A=m.useCallback(()=>{l&&_&&j()},[l,_,j]),T=m.useCallback(()=>{const $=f.trim().toLowerCase();$&&!i.tags.includes($)&&(E("tags",[...i.tags,$]),p(""))},[f,i.tags,E]),D=m.useCallback($=>{E("tags",i.tags.filter(q=>q!==$))},[i.tags,E]),F=m.useCallback($=>{$.key==="Enter"&&($.preventDefault(),T())},[T]);if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),o.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const S=i.name||t.name||t.fragment_id,I=gH[h]||h,M=xH[h]||"var(--text-muted)",z=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],P=!e,R=_&&!P;return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[S,o.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:M,color:"#fff"},children:I})]}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{children:["from ",t.source_doc_type]})]}),P&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:z.map($=>o.jsxs("button",{onClick:()=>s($.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===$.id?"var(--text-primary)":"var(--text-muted)",background:n===$.id?"var(--bg-canvas)":"transparent",borderBottom:n===$.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[$.label,$.id==="content"&&k&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),$.id==="metadata"&&l&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},$.id))}),n==="content"&&o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(tn,{content:x,onChange:C,loading:y,saving:w,isDirty:k,error:b,placeholder:"Enter prompt content...",readOnly:P})}),n==="metadata"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Kind"}),o.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:M}}),o.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:I})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Name"}),o.jsx("input",{type:"text",value:i.name,onChange:$=>E("name",$.target.value),onBlur:A,placeholder:"e.g., Technical Architect Role",style:kg,disabled:!R}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Intent"}),o.jsx("textarea",{value:i.intent,onChange:$=>E("intent",$.target.value),onBlur:A,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...kg,resize:"vertical"},disabled:!R}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:i.tags.map($=>o.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[$,R&&o.jsx("button",{onClick:()=>D($),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},$))}),R&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:f,onChange:$=>p($.target.value),onKeyDown:F,placeholder:"Add tag...",style:{...kg,flex:1}}),o.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Source"}),o.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",o.jsx("strong",{children:t.source_doc_type})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!R&&!t.source_doc_type&&o.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(N==null?void 0:N.tier1)&&!N.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ao={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},lo={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function yH({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[r,n]=m.useState(null),[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){n(null),i(null);return}(async()=>{l(!0),d(null);try{const g=await be.getMechanicalOp(e.op_id);n(g);const _=t.find(x=>x.type_id===g.type);if(_)i(_);else try{const x=await be.getMechanicalOpType(g.type);i(x)}catch{}}catch(g){console.error("Failed to load mechanical op details:",g),d(g.message),n(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),o.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=r||e;return o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(s==null?void 0:s.name)||u.type}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a&&o.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&o.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!a&&o.jsxs("div",{className:"space-y-6 max-w-2xl",children:[o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Operation ID"}),o.jsx("div",{style:ao,className:"font-mono",children:u.op_id})]}),o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Name"}),o.jsx("div",{style:ao,children:u.name})]}),u.description&&o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Description"}),o.jsx("div",{style:{...ao,whiteSpace:"pre-wrap"},children:u.description})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Type"}),o.jsx("div",{style:ao,children:u.type})]}),o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Version"}),o.jsx("div",{style:ao,children:u.active_version||u.version})]})]})]})]}),s&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),o.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxs("span",{style:{fontSize:16},children:[s.icon==="git-merge"&&"",s.icon==="scissors"&&"",s.icon==="check-circle"&&"",s.icon==="shuffle"&&"",s.icon==="git-branch"&&""]}),o.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:s.name}),o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:s.category})]}),o.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description}),o.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=s.inputs)==null?void 0:f.length)>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),s.inputs.map((v,g)=>o.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},g))]}),((p=s.outputs)==null?void 0:p.length)>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),s.outputs.map((v,g)=>o.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},g))]})]})]})]}),u.config&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),o.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),o.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),o.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),o.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),o.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(v=>o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:v},v))})]})]})]}),o.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[o.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",o.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function bH(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(s=>s(n))},t)}const Nu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Fi(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Dy(e){return"nodeType"in e}function Xt(e){var t,r;return e?Fi(e)?e:Dy(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Ly(e){const{Document:t}=Xt(e);return e instanceof t}function Ta(e){return Fi(e)?!1:e instanceof Xt(e).HTMLElement}function W3(e){return e instanceof Xt(e).SVGElement}function $i(e){return e?Fi(e)?e.document:Dy(e)?Ly(e)?e:Ta(e)||W3(e)?e.ownerDocument:document:document:document}const Gr=Nu?m.useLayoutEffect:m.useEffect;function zy(e){const t=m.useRef(e);return Gr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function _H(){const e=m.useRef(null),t=m.useCallback((n,s)=>{e.current=setInterval(n,s)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function da(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Gr(()=>{r.current!==e&&(r.current=e)},t),r}function Aa(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function Tc(e){const t=zy(e),r=m.useRef(null),n=m.useCallback(s=>{s!==r.current&&(t==null||t(s,r.current)),r.current=s},[]);return[r,n]}function Gx(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Ng={};function Ra(e,t){return m.useMemo(()=>{if(t)return t;const r=Ng[e]==null?0:Ng[e]+1;return Ng[e]=r,e+"-"+r},[e,t])}function H3(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((i,a)=>{const l=Object.entries(a);for(const[c,d]of l){const u=i[c];u!=null&&(i[c]=u+e*d)}return i},{...t})}}const mi=H3(1),fa=H3(-1);function wH(e){return"clientX"in e&&"clientY"in e}function Fy(e){if(!e)return!1;const{KeyboardEvent:t}=Xt(e.target);return t&&e instanceof t}function jH(e){if(!e)return!1;const{TouchEvent:t}=Xt(e.target);return t&&e instanceof t}function Kx(e){if(jH(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return wH(e)?{x:e.clientX,y:e.clientY}:null}const Ei=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Ei.Translate.toString(e),Ei.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),ES="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function SH(e){return e.matches(ES)?e:e.querySelector(ES)}const kH={display:"none"};function NH(e){let{id:t,value:r}=e;return G.createElement("div",{id:t,style:kH},r)}function CH(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return G.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function EH(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const V3=m.createContext(null);function TH(e){const t=m.useContext(V3);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function AH(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:s,event:i}=n;e.forEach(a=>{var l;return(l=a[s])==null?void 0:l.call(a,i)})},[e]),t]}const RH={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},IH={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function PH(e){let{announcements:t=IH,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=RH}=e;const{announce:i,announcement:a}=EH(),l=Ra("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),TH(m.useMemo(()=>({onDragStart(f){let{active:p}=f;i(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&i(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;i(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;i(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;i(t.onDragCancel({active:p,over:h}))}}),[i,t])),!c)return null;const u=G.createElement(G.Fragment,null,G.createElement(NH,{id:n,value:s.draggable}),G.createElement(CH,{id:l,announcement:a}));return r?ri.createPortal(u,r):u}var dt;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(dt||(dt={}));function Ac(){}function Rc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function U3(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Ir=Object.freeze({x:0,y:0});function G3(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function K3(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function MH(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function TS(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function Y3(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function AS(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const X3=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=AS(t,t.left,t.top),i=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=G3(AS(c),s);i.push({id:l,data:{droppableContainer:a,value:d}})}}return i.sort(K3)},OH=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=TS(t),i=[];for(const a of n){const{id:l}=a,c=r.get(l);if(c){const d=TS(c),u=s.reduce((p,h,v)=>p+G3(d[v],h),0),f=Number((u/4).toFixed(4));i.push({id:l,data:{droppableContainer:a,value:f}})}}return i.sort(K3)};function DH(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-n,l=i-r;if(n<s&&r<i){const c=t.width*t.height,d=e.width*e.height,u=a*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const LH=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const i of n){const{id:a}=i,l=r.get(a);if(l){const c=DH(l,t);c>0&&s.push({id:a,data:{droppableContainer:i,value:c}})}}return s.sort(MH)};function zH(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function Q3(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ir}function FH(e){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return s.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...r})}}const $H=FH(1);function qH(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function BH(e,t,r){const n=qH(t);if(!n)return e;const{scaleX:s,scaleY:i,x:a,y:l}=n,c=e.left-a-(1-s)*parseFloat(r),d=e.top-l-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),u=s?e.width/s:e.width,f=i?e.height/i:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const WH={ignoreTransform:!1};function qi(e,t){t===void 0&&(t=WH);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Xt(e).getComputedStyle(e);d&&(r=BH(r,d,u))}const{top:n,left:s,width:i,height:a,bottom:l,right:c}=r;return{top:n,left:s,width:i,height:a,bottom:l,right:c}}function RS(e){return qi(e,{ignoreTransform:!0})}function HH(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function VH(e,t){return t===void 0&&(t=Xt(e).getComputedStyle(e)),t.position==="fixed"}function UH(e,t){t===void 0&&(t=Xt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?r.test(i):!1})}function Cu(e,t){const r=[];function n(s){if(t!=null&&r.length>=t||!s)return r;if(Ly(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!Ta(s)||W3(s)||r.includes(s))return r;const i=Xt(e).getComputedStyle(s);return s!==e&&UH(s,i)&&r.push(s),VH(s,i)?r:n(s.parentNode)}return e?n(e):r}function Z3(e){const[t]=Cu(e,1);return t??null}function Cg(e){return!Nu||!e?null:Fi(e)?e:Dy(e)?Ly(e)||e===$i(e).scrollingElement?window:Ta(e)?e:null:null}function J3(e){return Fi(e)?e.scrollX:e.scrollLeft}function eT(e){return Fi(e)?e.scrollY:e.scrollTop}function Yx(e){return{x:J3(e),y:eT(e)}}var gt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(gt||(gt={}));function tT(e){return!Nu||!e?!1:e===document.scrollingElement}function rT(e){const t={x:0,y:0},r=tT(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:s,isLeft:i,isBottom:a,isRight:l,maxScroll:n,minScroll:t}}const GH={x:.2,y:.2};function KH(e,t,r,n,s){let{top:i,left:a,right:l,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=GH);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=rT(e),h={x:0,y:0},v={x:0,y:0},g={height:t.height*s.y,width:t.width*s.x};return!d&&i<=t.top+g.height?(h.y=gt.Backward,v.y=n*Math.abs((t.top+g.height-i)/g.height)):!u&&c>=t.bottom-g.height&&(h.y=gt.Forward,v.y=n*Math.abs((t.bottom-g.height-c)/g.height)),!p&&l>=t.right-g.width?(h.x=gt.Forward,v.x=n*Math.abs((t.right-g.width-l)/g.width)):!f&&a<=t.left+g.width&&(h.x=gt.Backward,v.x=n*Math.abs((t.left+g.width-a)/g.width)),{direction:h,speed:v}}function YH(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function nT(e){return e.reduce((t,r)=>mi(t,Yx(r)),Ir)}function XH(e){return e.reduce((t,r)=>t+J3(r),0)}function QH(e){return e.reduce((t,r)=>t+eT(r),0)}function ZH(e,t){if(t===void 0&&(t=qi),!e)return;const{top:r,left:n,bottom:s,right:i}=t(e);Z3(e)&&(s<=0||i<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const JH=[["x",["left","right"],XH],["y",["top","bottom"],QH]];class $y{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Cu(r),s=nT(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,l]of JH)for(const c of a)Object.defineProperty(this,c,{get:()=>{const d=l(n),u=s[i]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Io{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var s;(s=this.target)==null||s.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function eV(e){const{EventTarget:t}=Xt(e);return e instanceof t?e:$i(e)}function Eg(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var cr;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(cr||(cr={}));function IS(e){e.preventDefault()}function tV(e){e.stopPropagation()}var Pe;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Pe||(Pe={}));const sT={start:[Pe.Space,Pe.Enter],cancel:[Pe.Esc],end:[Pe.Space,Pe.Enter,Pe.Tab]},rV=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Pe.Right:return{...r,x:r.x+25};case Pe.Left:return{...r,x:r.x-25};case Pe.Down:return{...r,y:r.y+25};case Pe.Up:return{...r,y:r.y-25}}};class Eu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Io($i(r)),this.windowListeners=new Io(Xt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(cr.Resize,this.handleCancel),this.windowListeners.add(cr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(cr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&ZH(n),r(Ir)}handleKeyDown(t){if(Fy(t)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:i=sT,coordinateGetter:a=rV,scrollBehavior:l="smooth"}=s,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=n.current,u=d?{x:d.left,y:d.top}:Ir;this.referenceCoordinates||(this.referenceCoordinates=u);const f=a(t,{active:r,context:n.current,currentCoordinates:u});if(f){const p=fa(f,u),h={x:0,y:0},{scrollableAncestors:v}=n.current;for(const g of v){const _=t.code,{isTop:x,isRight:y,isLeft:b,isBottom:w,maxScroll:k,minScroll:C}=rT(g),N=YH(g),E={x:Math.min(_===Pe.Right?N.right-N.width/2:N.right,Math.max(_===Pe.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(_===Pe.Down?N.bottom-N.height/2:N.bottom,Math.max(_===Pe.Down?N.top:N.top+N.height/2,f.y))},j=_===Pe.Right&&!y||_===Pe.Left&&!b,A=_===Pe.Down&&!w||_===Pe.Up&&!x;if(j&&E.x!==f.x){const T=g.scrollLeft+p.x,D=_===Pe.Right&&T<=k.x||_===Pe.Left&&T>=C.x;if(D&&!p.y){g.scrollTo({left:T,behavior:l});return}D?h.x=g.scrollLeft-T:h.x=_===Pe.Right?g.scrollLeft-k.x:g.scrollLeft-C.x,h.x&&g.scrollBy({left:-h.x,behavior:l});break}else if(A&&E.y!==f.y){const T=g.scrollTop+p.y,D=_===Pe.Down&&T<=k.y||_===Pe.Up&&T>=C.y;if(D&&!p.x){g.scrollTo({top:T,behavior:l});return}D?h.y=g.scrollTop-T:h.y=_===Pe.Down?g.scrollTop-k.y:g.scrollTop-C.y,h.y&&g.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,mi(fa(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Eu.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=sT,onActivation:s}=t,{active:i}=r;const{code:a}=e.nativeEvent;if(n.start.includes(a)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function PS(e){return!!(e&&"distance"in e)}function MS(e){return!!(e&&"delay"in e)}class qy{constructor(t,r,n){var s;n===void 0&&(n=eV(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:i}=t,{target:a}=i;this.props=t,this.events=r,this.document=$i(a),this.documentListeners=new Io(this.document),this.listeners=new Io(n),this.windowListeners=new Io(Xt(a)),this.initialCoordinates=(s=Kx(i))!=null?s:Ir,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(cr.Resize,this.handleCancel),this.windowListeners.add(cr.DragStart,IS),this.windowListeners.add(cr.VisibilityChange,this.handleCancel),this.windowListeners.add(cr.ContextMenu,IS),this.documentListeners.add(cr.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(MS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(PS(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(cr.Click,tV,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(cr.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:l}}=i;if(!s)return;const c=(r=Kx(t))!=null?r:Ir,d=fa(s,c);if(!n&&l){if(PS(l)){if(l.tolerance!=null&&Eg(d,l.tolerance))return this.handleCancel();if(Eg(d,l.distance))return this.handleStart()}if(MS(l)&&Eg(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),a(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Pe.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const nV={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Tu extends qy{constructor(t){const{event:r}=t,n=$i(r.target);super(t,nV,n)}}Tu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const sV={move:{name:"mousemove"},end:{name:"mouseup"}};var Xx;(function(e){e[e.RightClick=2]="RightClick"})(Xx||(Xx={}));class iV extends qy{constructor(t){super(t,sV,$i(t.event.target))}}iV.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Xx.RightClick?!1:(n==null||n({event:r}),!0)}}];const Tg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class oV extends qy{constructor(t){super(t,Tg)}static setup(){return window.addEventListener(Tg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Tg.move.name,t)};function t(){}}}oV.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var Po;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Po||(Po={}));var Ic;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ic||(Ic={}));function aV(e){let{acceleration:t,activator:r=Po.Pointer,canScroll:n,draggingRect:s,enabled:i,interval:a=5,order:l=Ic.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=cV({delta:f,disabled:!i}),[v,g]=_H(),_=m.useRef({x:0,y:0}),x=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(r){case Po.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Po.DraggableRect:return s}},[r,s,c]),b=m.useRef(null),w=m.useCallback(()=>{const C=b.current;if(!C)return;const N=_.current.x*x.current.x,E=_.current.y*x.current.y;C.scrollBy(N,E)},[]),k=m.useMemo(()=>l===Ic.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!i||!d.length||!y){g();return}for(const C of k){if((n==null?void 0:n(C))===!1)continue;const N=d.indexOf(C),E=u[N];if(!E)continue;const{direction:j,speed:A}=KH(C,E,y,t,p);for(const T of["x","y"])h[T][j[T]]||(A[T]=0,j[T]=0);if(A.x>0||A.y>0){g(),b.current=C,v(w,a),_.current=A,x.current=j;return}}_.current={x:0,y:0},x.current={x:0,y:0},g()},[t,w,n,g,i,a,JSON.stringify(y),JSON.stringify(h),v,d,k,u,JSON.stringify(p)])}const lV={x:{[gt.Backward]:!1,[gt.Forward]:!1},y:{[gt.Backward]:!1,[gt.Forward]:!1}};function cV(e){let{delta:t,disabled:r}=e;const n=Gx(t);return Aa(s=>{if(r||!n||!s)return lV;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[gt.Backward]:s.x[gt.Backward]||i.x===-1,[gt.Forward]:s.x[gt.Forward]||i.x===1},y:{[gt.Backward]:s.y[gt.Backward]||i.y===-1,[gt.Forward]:s.y[gt.Forward]||i.y===1}}},[r,t,n])}function uV(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Aa(s=>{var i;return t==null?null:(i=n??s)!=null?i:null},[n,t])}function dV(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:s}=n,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,n)}));return[...r,...i]},[]),[e,t])}var pa;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(pa||(pa={}));var Qx;(function(e){e.Optimized="optimized"})(Qx||(Qx={}));const OS=new Map;function fV(e,t){let{dragging:r,dependencies:n,config:s}=t;const[i,a]=m.useState(null),{frequency:l,measure:c,strategy:d}=s,u=m.useRef(e),f=_(),p=da(f),h=m.useCallback(function(x){x===void 0&&(x=[]),!p.current&&a(y=>y===null?x:y.concat(x.filter(b=>!y.includes(b))))},[p]),v=m.useRef(null),g=Aa(x=>{if(f&&!r)return OS;if(!x||x===OS||u.current!==e||i!=null){const y=new Map;for(let b of e){if(!b)continue;if(i&&i.length>0&&!i.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const w=b.node.current,k=w?new $y(c(w),w):null;b.rect.current=k,k&&y.set(b.id,k)}return y}return x},[e,i,r,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),m.useEffect(()=>{f||typeof l!="number"||v.current!==null||(v.current=setTimeout(()=>{h(),v.current=null},l))},[l,f,h,...n]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:i!=null};function _(){switch(d){case pa.Always:return!1;case pa.BeforeDragging:return r;default:return!r}}}function iT(e,t){return Aa(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function pV(e,t){return iT(e,t)}function hV(e){let{callback:t,disabled:r}=e;const n=zy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(n)},[n,r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Au(e){let{callback:t,disabled:r}=e;const n=zy(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(n)},[r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function mV(e){return new $y(qi(e),e)}function DS(e,t,r){t===void 0&&(t=mV);const[n,s]=m.useState(null);function i(){s(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??r)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const a=hV({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),l=Au({callback:i});return Gr(()=>{i(),e?(l==null||l.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),a==null||a.disconnect())},[e]),n}function gV(e){const t=iT(e);return Q3(e,t)}const LS=[];function xV(e){const t=m.useRef(e),r=Aa(n=>e?n&&n!==LS&&e&&t.current&&e.parentNode===t.current.parentNode?n:Cu(e):LS,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function vV(e){const[t,r]=m.useState(null),n=m.useRef(e),s=m.useCallback(i=>{const a=Cg(i.target);a&&r(l=>l?(l.set(a,Yx(a)),new Map(l)):null)},[]);return m.useEffect(()=>{const i=n.current;if(e!==i){a(i);const l=e.map(c=>{const d=Cg(c);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,Yx(d)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{a(e),a(i)};function a(l){l.forEach(c=>{const d=Cg(c);d==null||d.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>mi(i,a),Ir):nT(e):Ir,[e,t])}function zS(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Ir;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?fa(e,r.current):Ir}function yV(e){m.useEffect(()=>{if(!Nu)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function bV(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:s,handler:i}=n;return r[s]=a=>{i(a,t)},r},{}),[e,t])}function oT(e){return m.useMemo(()=>e?HH(e):null,[e])}const FS=[];function _V(e,t){t===void 0&&(t=qi);const[r]=e,n=oT(r?Xt(r):null),[s,i]=m.useState(FS);function a(){i(()=>e.length?e.map(c=>tT(c)?n:new $y(t(c),c)):FS)}const l=Au({callback:a});return Gr(()=>{l==null||l.disconnect(),a(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),s}function wV(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ta(t)?t:e}function jV(e){let{measure:t}=e;const[r,n]=m.useState(null),s=m.useCallback(d=>{for(const{target:u}of d)if(Ta(u)){n(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),i=Au({callback:s}),a=m.useCallback(d=>{const u=wV(d);i==null||i.disconnect(),u&&(i==null||i.observe(u)),n(u?t(u):null)},[t,i]),[l,c]=Tc(a);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const SV=[{sensor:Tu,options:{}},{sensor:Eu,options:{}}],kV={current:{}},Ml={draggable:{measure:RS},droppable:{measure:RS,strategy:pa.WhileDragging,frequency:Qx.Optimized},dragOverlay:{measure:qi}};class Mo extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const NV={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Mo,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ac},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ml,measureDroppableContainers:Ac,windowRect:null,measuringScheduled:!1},CV={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ac,draggableNodes:new Map,over:null,measureDroppableContainers:Ac},Ru=m.createContext(CV),aT=m.createContext(NV);function EV(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Mo}}}function TV(e,t){switch(t.type){case dt.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case dt.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case dt.DragEnd:case dt.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case dt.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new Mo(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case dt.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const a=new Mo(e.droppable.containers);return a.set(r,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case dt.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const i=new Mo(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function AV(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:s}=m.useContext(Ru),i=Gx(n),a=Gx(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&i&&a!=null){if(!Fy(i)||document.activeElement===i.target)return;const l=s.get(a);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=SH(u);if(f){f.focus();break}}})}},[n,t,s,a,i]),null}function RV(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...n}),r):r}function IV(e){return m.useMemo(()=>({draggable:{...Ml.draggable,...e==null?void 0:e.draggable},droppable:{...Ml.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Ml.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function PV(e){let{activeNode:t,measure:r,initialRect:n,config:s=!0}=e;const i=m.useRef(!1),{x:a,y:l}=typeof s=="boolean"?{x:s,y:s}:s;Gr(()=>{if(!a&&!l||!t){i.current=!1;return}if(i.current||!n)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=r(d),f=Q3(u,n);if(a||(f.x=0),l||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=Z3(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,a,l,n,r])}const lT=m.createContext({...Ir,scaleX:1,scaleY:1});var En;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(En||(En={}));const cT=m.memo(function(t){var r,n,s,i;let{id:a,accessibility:l,autoScroll:c=!0,children:d,sensors:u=SV,collisionDetection:f=LH,measuring:p,modifiers:h,...v}=t;const g=m.useReducer(TV,void 0,EV),[_,x]=g,[y,b]=AH(),[w,k]=m.useState(En.Uninitialized),C=w===En.Initialized,{draggable:{active:N,nodes:E,translate:j},droppable:{containers:A}}=_,T=N!=null?E.get(N):null,D=m.useRef({initial:null,translated:null}),F=m.useMemo(()=>{var ne;return N!=null?{id:N,data:(ne=T==null?void 0:T.data)!=null?ne:kV,rect:D}:null},[N,T]),S=m.useRef(null),[I,M]=m.useState(null),[z,P]=m.useState(null),R=da(v,Object.values(v)),L=Ra("DndDescribedBy",a),$=m.useMemo(()=>A.getEnabled(),[A]),q=IV(p),{droppableRects:Y,measureDroppableContainers:K,measuringScheduled:H}=fV($,{dragging:C,dependencies:[j.x,j.y],config:q.droppable}),B=uV(E,N),X=m.useMemo(()=>z?Kx(z):null,[z]),ie=V(),oe=pV(B,q.draggable.measure);PV({activeNode:N!=null?E.get(N):null,config:ie.layoutShiftCompensation,initialRect:oe,measure:q.draggable.measure});const J=DS(B,q.draggable.measure,oe),we=DS(B?B.parentElement:null),ge=m.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:Y,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:A,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),_e=A.getNodeFor((r=ge.current.over)==null?void 0:r.id),xe=jV({measure:q.dragOverlay.measure}),ae=(n=xe.nodeRef.current)!=null?n:B,U=C?(s=xe.rect)!=null?s:J:null,re=!!(xe.nodeRef.current&&xe.rect),te=gV(re?null:J),je=oT(ae?Xt(ae):null),se=xV(C?_e??B:null),fe=_V(se),he=RV(h,{transform:{x:j.x-te.x,y:j.y-te.y,scaleX:1,scaleY:1},activatorEvent:z,active:F,activeNodeRect:J,containerNodeRect:we,draggingNodeRect:U,over:ge.current.over,overlayNodeRect:xe.rect,scrollableAncestors:se,scrollableAncestorRects:fe,windowRect:je}),Q=X?mi(X,j):null,me=vV(se),qe=zS(me),Le=zS(me,[J]),Ce=mi(he,qe),Ee=U?$H(U,he):null,Me=F&&Ee?f({active:F,collisionRect:Ee,droppableRects:Y,droppableContainers:$,pointerCoordinates:Q}):null,tt=Y3(Me,"id"),[Ie,Z]=m.useState(null),Te=re?he:mi(he,Le),ve=zH(Te,(i=Ie==null?void 0:Ie.rect)!=null?i:null,J),Ct=m.useRef(null),yt=m.useCallback((ne,ze)=>{let{sensor:ct,options:ar}=ze;if(S.current==null)return;const Et=E.get(S.current);if(!Et)return;const _t=ne.nativeEvent,$t=new ct({active:S.current,activeNode:Et,event:_t,options:ar,context:ge,onAbort(st){if(!E.get(st))return;const{onDragAbort:de}=R.current,Ve={id:st};de==null||de(Ve),y({type:"onDragAbort",event:Ve})},onPending(st,ue,de,Ve){if(!E.get(st))return;const{onDragPending:rs}=R.current,Lr={id:st,constraint:ue,initialCoordinates:de,offset:Ve};rs==null||rs(Lr),y({type:"onDragPending",event:Lr})},onStart(st){const ue=S.current;if(ue==null)return;const de=E.get(ue);if(!de)return;const{onDragStart:Ve}=R.current,_r={activatorEvent:_t,active:{id:ue,data:de.data,rect:D}};ri.unstable_batchedUpdates(()=>{Ve==null||Ve(_r),k(En.Initializing),x({type:dt.DragStart,initialCoordinates:st,active:ue}),y({type:"onDragStart",event:_r}),M(Ct.current),P(_t)})},onMove(st){x({type:dt.DragMove,coordinates:st})},onEnd:Dr(dt.DragEnd),onCancel:Dr(dt.DragCancel)});Ct.current=$t;function Dr(st){return async function(){const{active:de,collisions:Ve,over:_r,scrollAdjustedTranslate:rs}=ge.current;let Lr=null;if(de&&rs){const{cancelDrop:ns}=R.current;Lr={activatorEvent:_t,active:de,collisions:Ve,delta:rs,over:_r},st===dt.DragEnd&&typeof ns=="function"&&await Promise.resolve(ns(Lr))&&(st=dt.DragCancel)}S.current=null,ri.unstable_batchedUpdates(()=>{x({type:st}),k(En.Uninitialized),Z(null),M(null),P(null),Ct.current=null;const ns=st===dt.DragEnd?"onDragEnd":"onDragCancel";if(Lr){const Bi=R.current[ns];Bi==null||Bi(Lr),y({type:ns,event:Lr})}})}}},[E]),bt=m.useCallback((ne,ze)=>(ct,ar)=>{const Et=ct.nativeEvent,_t=E.get(ar);if(S.current!==null||!_t||Et.dndKit||Et.defaultPrevented)return;const $t={active:_t};ne(ct,ze.options,$t)===!0&&(Et.dndKit={capturedBy:ze.sensor},S.current=ar,yt(ct,ze))},[E,yt]),Qt=dV(u,bt);yV(u),Gr(()=>{J&&w===En.Initializing&&k(En.Initialized)},[J,w]),m.useEffect(()=>{const{onDragMove:ne}=R.current,{active:ze,activatorEvent:ct,collisions:ar,over:Et}=ge.current;if(!ze||!ct)return;const _t={active:ze,activatorEvent:ct,collisions:ar,delta:{x:Ce.x,y:Ce.y},over:Et};ri.unstable_batchedUpdates(()=>{ne==null||ne(_t),y({type:"onDragMove",event:_t})})},[Ce.x,Ce.y]),m.useEffect(()=>{const{active:ne,activatorEvent:ze,collisions:ct,droppableContainers:ar,scrollAdjustedTranslate:Et}=ge.current;if(!ne||S.current==null||!ze||!Et)return;const{onDragOver:_t}=R.current,$t=ar.get(tt),Dr=$t&&$t.rect.current?{id:$t.id,rect:$t.rect.current,data:$t.data,disabled:$t.disabled}:null,st={active:ne,activatorEvent:ze,collisions:ct,delta:{x:Et.x,y:Et.y},over:Dr};ri.unstable_batchedUpdates(()=>{Z(Dr),_t==null||_t(st),y({type:"onDragOver",event:st})})},[tt]),Gr(()=>{ge.current={activatorEvent:z,active:F,activeNode:B,collisionRect:Ee,collisions:Me,droppableRects:Y,draggableNodes:E,draggingNode:ae,draggingNodeRect:U,droppableContainers:A,over:Ie,scrollableAncestors:se,scrollAdjustedTranslate:Ce},D.current={initial:U,translated:Ee}},[F,B,Me,Ee,E,ae,U,Y,A,Ie,se,Ce]),aV({...ie,delta:j,draggingRect:Ee,pointerCoordinates:Q,scrollableAncestors:se,scrollableAncestorRects:fe});const O=m.useMemo(()=>({active:F,activeNode:B,activeNodeRect:J,activatorEvent:z,collisions:Me,containerNodeRect:we,dragOverlay:xe,draggableNodes:E,droppableContainers:A,droppableRects:Y,over:Ie,measureDroppableContainers:K,scrollableAncestors:se,scrollableAncestorRects:fe,measuringConfiguration:q,measuringScheduled:H,windowRect:je}),[F,B,J,z,Me,we,xe,E,A,Y,Ie,K,se,fe,q,H,je]),W=m.useMemo(()=>({activatorEvent:z,activators:Qt,active:F,activeNodeRect:J,ariaDescribedById:{draggable:L},dispatch:x,draggableNodes:E,over:Ie,measureDroppableContainers:K}),[z,Qt,F,J,x,L,E,Ie,K]);return G.createElement(V3.Provider,{value:b},G.createElement(Ru.Provider,{value:W},G.createElement(aT.Provider,{value:O},G.createElement(lT.Provider,{value:ve},d)),G.createElement(AV,{disabled:(l==null?void 0:l.restoreFocus)===!1})),G.createElement(PH,{...l,hiddenTextDescribedById:L}));function V(){const ne=(I==null?void 0:I.autoScrollEnabled)===!1,ze=typeof c=="object"?c.enabled===!1:c===!1,ct=C&&!ne&&!ze;return typeof c=="object"?{...c,enabled:ct}:{enabled:ct}}}),MV=m.createContext(null),$S="button",OV="Draggable";function DV(e){let{id:t,data:r,disabled:n=!1,attributes:s}=e;const i=Ra(OV),{activators:a,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(Ru),{role:h=$S,roleDescription:v="draggable",tabIndex:g=0}=s??{},_=(c==null?void 0:c.id)===t,x=m.useContext(_?lT:MV),[y,b]=Tc(),[w,k]=Tc(),C=bV(a,t),N=da(r);Gr(()=>(f.set(t,{id:t,key:i,node:y,activatorNode:w,data:N}),()=>{const j=f.get(t);j&&j.key===i&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":n,"aria-pressed":_&&h===$S?!0:void 0,"aria-roledescription":v,"aria-describedby":u.draggable}),[n,h,g,_,v,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:E,isDragging:_,listeners:n?void 0:C,node:y,over:p,setNodeRef:b,setActivatorNodeRef:k,transform:x}}function LV(){return m.useContext(aT)}const zV="Droppable",FV={timeout:25};function $V(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:s}=e;const i=Ra(zV),{active:a,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(Ru),u=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:v,updateMeasurementsFor:g,timeout:_}={...FV,...s},x=da(g??n),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(x.current)?x.current:[x.current]),h.current=null},_)},[_]),b=Au({callback:y,disabled:v||!a}),w=m.useCallback((E,j)=>{b&&(j&&(b.unobserve(j),f.current=!1),E&&b.observe(E))},[b]),[k,C]=Tc(w),N=da(t);return m.useEffect(()=>{!b||!k.current||(b.disconnect(),f.current=!1,b.observe(k.current))},[k,b]),m.useEffect(()=>(l({type:dt.RegisterDroppable,element:{id:n,key:i,disabled:r,node:k,rect:p,data:N}}),()=>l({type:dt.UnregisterDroppable,key:i,id:n})),[n]),m.useEffect(()=>{r!==u.current.disabled&&(l({type:dt.SetDroppableDisabled,id:n,key:i,disabled:r}),u.current.disabled=r)},[n,i,r,l]),{active:a,rect:p,isOver:(c==null?void 0:c.id)===n,node:k,over:c,setNodeRef:C}}function Iu(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function qV(e,t){return e.reduce((r,n,s)=>{const i=t.get(n);return i&&(r[s]=i),r},Array(e.length))}function gl(e){return e!==null&&e>=0}function BV(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function WV(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const uT=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const i=Iu(t,n,r),a=t[s],l=i[s];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},xl={scaleX:1,scaleY:1},dT=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:i,overIndex:a}=e;const l=(t=i[r])!=null?t:n;if(!l)return null;if(s===r){const d=i[a];return d?{x:0,y:r<a?d.top+d.height-(l.top+l.height):d.top-l.top,...xl}:null}const c=HV(i,s,r);return s>r&&s<=a?{x:0,y:-l.height-c,...xl}:s<r&&s>=a?{x:0,y:l.height+c,...xl}:{x:0,y:0,...xl}};function HV(e,t,r){const n=e[t],s=e[t-1],i=e[t+1];return n?r<t?s?n.top-(s.top+s.height):i?i.top-(n.top+n.height):0:i?i.top-(n.top+n.height):s?n.top-(s.top+s.height):0:0}const fT="Sortable",pT=G.createContext({activeIndex:-1,containerId:fT,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:uT,disabled:{draggable:!1,droppable:!1}});function hT(e){let{children:t,id:r,items:n,strategy:s=uT,disabled:i=!1}=e;const{active:a,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=LV(),f=Ra(fT,r),p=l.rect!==null,h=m.useMemo(()=>n.map(C=>typeof C=="object"&&"id"in C?C.id:C),[n]),v=a!=null,g=a?h.indexOf(a.id):-1,_=d?h.indexOf(d.id):-1,x=m.useRef(h),y=!BV(h,x.current),b=_!==-1&&g===-1||y,w=WV(i);Gr(()=>{y&&v&&u(h)},[y,h,v,u]),m.useEffect(()=>{x.current=h},[h]);const k=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:w,disableTransforms:b,items:h,overIndex:_,useDragOverlay:p,sortedRects:qV(h,c),strategy:s}),[g,f,w.draggable,w.droppable,b,h,_,c,p,s]);return G.createElement(pT.Provider,{value:k},t)}const VV=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return Iu(r,n,s).indexOf(t)},UV=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:i,newIndex:a,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!n||l!==i&&s===a?!1:r?!0:a!==s&&t===c},GV={duration:200,easing:"ease"},mT="transform",KV=Ei.Transition.toString({property:mT,duration:0,easing:"linear"}),YV={roleDescription:"sortable"};function XV(e){let{disabled:t,index:r,node:n,rect:s}=e;const[i,a]=m.useState(null),l=m.useRef(r);return Gr(()=>{if(!t&&r!==l.current&&n.current){const c=s.current;if(c){const d=qi(n.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&a(u)}}r!==l.current&&(l.current=r)},[t,r,n,s]),m.useEffect(()=>{i&&a(null)},[i]),i}function gT(e){let{animateLayoutChanges:t=UV,attributes:r,disabled:n,data:s,getNewIndex:i=VV,id:a,strategy:l,resizeObserverConfig:c,transition:d=GV}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:v,sortedRects:g,overIndex:_,useDragOverlay:x,strategy:y}=m.useContext(pT),b=QV(n,h),w=u.indexOf(a),k=m.useMemo(()=>({sortable:{containerId:f,index:w,items:u},...s}),[f,s,w,u]),C=m.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:N,node:E,isOver:j,setNodeRef:A}=$V({id:a,data:k,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...c}}),{active:T,activatorEvent:D,activeNodeRect:F,attributes:S,setNodeRef:I,listeners:M,isDragging:z,over:P,setActivatorNodeRef:R,transform:L}=DV({id:a,data:k,attributes:{...YV,...r},disabled:b.draggable}),$=bH(A,I),q=!!T,Y=q&&!v&&gl(p)&&gl(_),K=!x&&z,H=K&&Y?L:null,X=Y?H??(l??y)({rects:g,activeNodeRect:F,activeIndex:p,overIndex:_,index:w}):null,ie=gl(p)&&gl(_)?i({id:a,items:u,activeIndex:p,overIndex:_}):w,oe=T==null?void 0:T.id,J=m.useRef({activeId:oe,items:u,newIndex:ie,containerId:f}),we=u!==J.current.items,ge=t({active:T,containerId:f,isDragging:z,isSorting:q,id:a,index:w,items:u,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:d,wasDragging:J.current.activeId!=null}),_e=XV({disabled:!ge,index:w,node:E,rect:N});return m.useEffect(()=>{q&&J.current.newIndex!==ie&&(J.current.newIndex=ie),f!==J.current.containerId&&(J.current.containerId=f),u!==J.current.items&&(J.current.items=u)},[q,ie,f,u]),m.useEffect(()=>{if(oe===J.current.activeId)return;if(oe!=null&&J.current.activeId==null){J.current.activeId=oe;return}const ae=setTimeout(()=>{J.current.activeId=oe},50);return()=>clearTimeout(ae)},[oe]),{active:T,activeIndex:p,attributes:S,data:k,rect:N,index:w,newIndex:ie,items:u,isOver:j,isSorting:q,isDragging:z,listeners:M,node:E,overIndex:_,over:P,setNodeRef:$,setActivatorNodeRef:R,setDroppableNodeRef:A,setDraggableNodeRef:I,transform:_e??X,transition:xe()};function xe(){if(_e||we&&J.current.newIndex===w)return KV;if(!(K&&!Fy(D)||!d)&&(q||ge))return Ei.Transition.toString({...d,property:mT})}}function QV(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Pc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const ZV=[Pe.Down,Pe.Right,Pe.Up,Pe.Left],xT=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:l}}=t;if(ZV.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];i.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=s.get(f.id);if(p)switch(e.code){case Pe.Down:n.top<p.top&&c.push(f);break;case Pe.Up:n.top>p.top&&c.push(f);break;case Pe.Left:n.left>p.left&&c.push(f);break;case Pe.Right:n.left<p.left&&c.push(f);break}});const d=OH({collisionRect:n,droppableRects:s,droppableContainers:c});let u=Y3(d,"id");if(u===(a==null?void 0:a.id)&&d.length>1&&(u=d[1].id),u!=null){const f=i.get(r.id),p=i.get(u),h=p?s.get(p.id):null,v=p==null?void 0:p.node.current;if(v&&h&&f&&p){const _=Cu(v).some((C,N)=>l[N]!==C),x=vT(f,p),y=JV(f,p),b=_||!x?{x:0,y:0}:{x:y?n.width-h.width:0,y:y?n.height-h.height:0},w={x:h.left,y:h.top};return b.x&&b.y?w:fa(w,b)}}}};function vT(e,t){return!Pc(e)||!Pc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function JV(e,t){return!Pc(e)||!Pc(t)||!vT(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const eU={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Fr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},lr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},yT={step_id:"new_step",produces:"",scope:"",inputs:[]},tU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function rU({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:s,onNavigateToWorkflow:i}){const[a,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:v,error:g,saving:_,updateWorkflow:x}=B3(e,p,{onSave:j=>{n==null||n(p,j)}}),y=m.useCallback(j=>{j==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(j)},[h]),b=m.useCallback(j=>{const A=j.target.value;d(A);try{const T=JSON.parse(A);f(null),x(T)}catch(T){f(T.message)}},[x]),w=m.useCallback((j,A)=>{if(!h)return;const T=[...h.steps];T[j]=A,x({...h,steps:T})},[h,x]),k=m.useCallback(j=>{if(!h)return;const A=h.steps.filter((T,D)=>D!==j);x({...h,steps:A})},[h,x]),C=m.useCallback(j=>{var T,D;if(!h)return;const A=j==="iteration"?{...tU,step_id:`new_iteration_${(((T=h.steps)==null?void 0:T.length)||0)+1}`}:{...yT,step_id:`new_step_${(((D=h.steps)==null?void 0:D.length)||0)+1}`};x({...h,steps:[...h.steps||[],A]})},[h,x]),N=m.useCallback((j,A)=>{if(!h)return;const T=Iu(h.steps,j,A);x({...h,steps:T})},[h,x]),E=m.useCallback(()=>{!s||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&s(t.workflow_id)},[s,t]);return t?o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[_&&o.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&o.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),s&&o.jsx("button",{onClick:E,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),o.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(j=>o.jsx("button",{onClick:()=>y(j.id),style:{...eU,color:a===j.id?"var(--text-primary)":"var(--text-muted)",borderBottom:a===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:j.label},j.id))}),v?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):o.jsxs("div",{className:"flex-1 overflow-hidden",children:[a==="steps"&&o.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[o.jsx(nU,{steps:(h==null?void 0:h.steps)||[],documentTypes:r,onStepChange:w,onStepDelete:k,onReorder:N}),o.jsxs("div",{className:"flex gap-2 mt-3",children:[o.jsx("button",{onClick:()=>C("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),o.jsx("button",{onClick:()=>C("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),a==="json"&&o.jsxs("div",{className:"h-full flex flex-col p-4",children:[o.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&o.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),a==="metadata"&&o.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?o.jsx(aU,{workflow:h,onUpdateWorkflow:x,onNavigateToWorkflow:i}):o.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),o.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function nU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const i=U3(Rc(Tu,{activationConstraint:{distance:5}}),Rc(Eu,{coordinateGetter:xT})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?o.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):o.jsx(cT,{sensors:i,collisionDetection:X3,onDragEnd:l,children:o.jsx(hT,{items:a,strategy:dT,children:e.map((c,d)=>o.jsx(sU,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function sU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:i,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=gT({id:e.step_id}),f={transform:Ei.Transform.toString(c),transition:d,opacity:u?.5:1};return o.jsx("div",{ref:l,style:f,children:o.jsx(bT,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...i,...a}})})}function bT({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s,dragHandleProps:i,depth:a=0}){var C,N,E;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(j,A)=>{const T={...l,[j]:A};c(T),n(t,T)},h=(j,A)=>{const T={...l.iterate_over,[j]:A},D={...l,iterate_over:T};c(D),n(t,D)},v=()=>{const j=[...l.inputs||[],{doc_type:"",scope:""}],A={...l,inputs:j};c(A),n(t,A)},g=(j,A,T)=>{const D=[...l.inputs||[]];D[j]={...D[j],[A]:T};const F={...l,inputs:D};c(F),n(t,F)},_=j=>{const A=(l.inputs||[]).filter((D,F)=>F!==j),T={...l,inputs:A};c(T),n(t,T)},x=m.useCallback((j,A)=>{const T=[...l.steps||[]];T[j]=A;const D={...l,steps:T};c(D),n(t,D)},[l,t,n]),y=m.useCallback(j=>{const A=(l.steps||[]).filter((D,F)=>F!==j),T={...l,steps:A};c(T),n(t,T)},[l,t,n]),b=m.useCallback(()=>{var T;const j=[...l.steps||[],{...yT,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],A={...l,steps:j};c(A),n(t,A)},[l,t,n]),w=m.useCallback((j,A)=>{const T=Iu(l.steps||[],j,A),D={...l,steps:T};c(D),n(t,D)},[l,t,n]),k={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:a*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return o.jsxs("div",{style:k,children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[i&&o.jsx("span",{...i,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:o.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[o.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),o.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),o.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),o.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),o.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),o.jsx("span",{style:{flex:1}}),o.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?o.jsx("path",{d:"M18 15l-6-6-6 6"}):o.jsx("path",{d:"M6 9l6 6 6-6"})})}),o.jsx("button",{onClick:()=>s(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&o.jsxs("div",{className:"p-3 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Step ID"}),o.jsx("input",{type:"text",value:l.step_id||"",onChange:j=>p("step_id",j.target.value),style:Fr})]}),f?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Doc Type"}),o.jsxs("select",{value:((C=l.iterate_over)==null?void 0:C.doc_type)||"",onChange:j=>h("doc_type",j.target.value),style:Fr,children:[o.jsx("option",{value:"",children:"-- Select --"}),r.map(j=>o.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Collection Field"}),o.jsx("input",{type:"text",value:((N=l.iterate_over)==null?void 0:N.collection_field)||"",onChange:j=>h("collection_field",j.target.value),style:Fr})]}),o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Entity Type"}),o.jsx("input",{type:"text",value:((E=l.iterate_over)==null?void 0:E.entity_type)||"",onChange:j=>h("entity_type",j.target.value),style:Fr})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Scope"}),o.jsx("input",{type:"text",value:l.scope||"",onChange:j=>p("scope",j.target.value),style:Fr})]}),o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{style:lr,children:"Nested Steps"}),o.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),o.jsx(iU,{steps:l.steps||[],documentTypes:r,onStepChange:x,onStepDelete:y,onReorder:w})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Produces"}),o.jsxs("select",{value:l.produces||"",onChange:j=>p("produces",j.target.value),style:Fr,children:[o.jsx("option",{value:"",children:"-- Select document type --"}),r.map(j=>o.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Scope"}),o.jsx("input",{type:"text",value:l.scope||"",onChange:j=>p("scope",j.target.value),placeholder:"project",style:Fr})]}),o.jsxs("div",{children:[o.jsx("label",{style:lr,children:"Creates Entities"}),o.jsx("input",{type:"text",value:l.creates_entities||"",onChange:j=>p("creates_entities",j.target.value||void 0),placeholder:"e.g., epic",style:Fr})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{style:lr,children:"Inputs"}),o.jsx("button",{onClick:v,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?o.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):o.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((j,A)=>o.jsxs("div",{className:"flex gap-1 items-end",children:[o.jsxs("div",{style:{flex:1},children:[A===0&&o.jsx("label",{style:{...lr,fontSize:9},children:"Doc/Entity Type"}),o.jsxs("select",{value:j.doc_type||j.entity_type||"",onChange:T=>{const D=T.target.value;j.entity_type!==void 0?g(A,"entity_type",D):g(A,"doc_type",D)},style:{...Fr,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select --"}),r.map(T=>o.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),o.jsxs("div",{style:{width:"30%"},children:[A===0&&o.jsx("label",{style:{...lr,fontSize:9},children:"Scope"}),o.jsx("input",{type:"text",value:j.scope||"",onChange:T=>g(A,"scope",T.target.value),placeholder:"scope",style:{...Fr,fontSize:11}})]}),o.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[o.jsx("input",{type:"checkbox",checked:j.context||!1,onChange:T=>g(A,"context",T.target.checked||void 0)}),"ctx"]}),o.jsx("button",{onClick:()=>_(A),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},A))})]})]})]})]})}function iU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:s}){const i=U3(Rc(Tu,{activationConstraint:{distance:5}}),Rc(Eu,{coordinateGetter:xT})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?o.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):o.jsx(cT,{sensors:i,collisionDetection:X3,onDragEnd:l,children:o.jsx(hT,{items:a,strategy:dT,children:e.map((c,d)=>o.jsx(oU,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function oU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:s}){const{attributes:i,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=gT({id:e.step_id}),f={transform:Ei.Transform.toString(c),transition:d,opacity:u?.5:1};return o.jsx("div",{ref:l,style:f,children:o.jsx(bT,{step:e,index:t,documentTypes:r,onChange:n,onDelete:s,dragHandleProps:{...i,...a},depth:1})})}function aU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,s]=m.useState(""),i={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},a={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,v=e.source_version,g=e.tags||[],_=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),s(""))},x=b=>{t==null||t({...e,tags:g.filter(w=>w!==b)})},y=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return o.jsxs("div",{className:"space-y-4 max-w-lg",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),o.jsxs("div",{children:[o.jsx("label",{style:a,children:"POW Class"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Derived From"}),o.jsx("div",{style:i,children:r?o.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):o.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),v&&o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Source Version"}),o.jsx("div",{style:i,children:v})]}),o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Tags"}),o.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>o.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&o.jsx("button",{onClick:()=>x(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"text",value:n,onChange:b=>s(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),_())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),o.jsx("button",{onClick:_,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b.label}),o.jsx("div",{style:i,children:e[b.key]||"-"})]},b.key)),d.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,w])=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b}),o.jsxs("div",{style:i,children:["parent: ",w.parent||"none"]})]},b))]}),f.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,w])=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b}),o.jsxs("div",{style:i,children:[w.name,w.scope&&` (${w.scope})`,w.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function qS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(s=>s.status==="fail"),n=e.filter(s=>s.status==="pass");return t?o.jsx("div",{className:"flex items-center gap-2",children:r.length>0?o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):o.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):o.jsxs("div",{className:"space-y-2",children:[r.map((s,i)=>o.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[o.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[o.jsx("span",{className:"text-red-400",children:"FAIL"}),o.jsx("span",{className:"font-mono",children:s.rule_id})]}),s.message&&o.jsx("div",{className:"mt-1 opacity-80",children:s.message}),s.artifact_id&&o.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:s.artifact_id})]},i)),n.length>0&&r.length>0&&o.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function lU(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),s=[];let i=0,a=0;for(;i<r.length||a<n.length;)if(i>=r.length)s.push({type:"added",line:n[a],lineNum:a+1}),a++;else if(a>=n.length)s.push({type:"removed",line:r[i],lineNum:i+1}),i++;else if(r[i]===n[a])s.push({type:"same",line:r[i],oldLineNum:i+1,newLineNum:a+1}),i++,a++;else{let l=n.slice(a,a+5).indexOf(r[i]),c=r.slice(i,i+5).indexOf(n[a]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)s.push({type:"added",line:n[a+d],lineNum:a+d+1});a+=l}else if(c!==-1){for(let d=0;d<c;d++)s.push({type:"removed",line:r[i+d],lineNum:i+d+1});i+=c}else s.push({type:"removed",line:r[i],lineNum:i+1}),s.push({type:"added",line:n[a],lineNum:a+1}),i++,a++}return s}function cU({diff:e}){const[t,r]=m.useState(!0),n=lU(e.old_content,e.new_content),s={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return o.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:s[e.status]||s.M,children:e.status}),o.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),o.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&o.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:o.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((i,a)=>o.jsxs("div",{className:"flex",style:{background:i.type==="added"?"rgba(34, 197, 94, 0.1)":i.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:i.type==="added"?"3px solid #22c55e":i.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[o.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:i.type==="same"?i.oldLineNum:i.lineNum||""}),o.jsx("span",{className:"select-none px-1",style:{color:i.type==="added"?"#22c55e":i.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:i.type==="added"?"+":i.type==="removed"?"-":" "}),o.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:i.line})]},a))})})]})}function uU({workspaceId:e,artifactId:t=null,onClose:r}){const[n,s]=m.useState([]),[i,a]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(a(!0),c(null),be.getDiff(e,t).then(u=>{s(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{a(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(r==null||r())};return o.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(r==null?void 0:r()),onKeyDown:d,tabIndex:0,children:o.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),o.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i?o.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?o.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?o.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((u,f)=>o.jsx(cU,{diff:u},u.artifact_id||f))}),o.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function dU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,s,i]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=i.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:s,kind:i,displayName:a,kindLabel:l,display:`${a} - ${l}`}}function fU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=dU(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function pU({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:s=[],modifiedFiles:i=[]}){const[a,l]=m.useState(""),[c,d]=m.useState(!1),u=fU(s),f=s.length,p=v=>{v.preventDefault(),a.trim()&&!n&&t(a.trim())},h=v=>{v.key==="Escape"&&!n&&r()};return o.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:v=>v.target===v.currentTarget&&!n&&r(),onKeyDown:h,children:[o.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&o.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),o.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(v=>o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:v.label}),o.jsx("div",{className:"space-y-1",children:v.items.map((g,_)=>o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),o.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),o.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),o.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},_))})]},v.scope))}),o.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),o.jsxs("form",{onSubmit:p,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),o.jsx("textarea",{value:a,onChange:v=>l(v.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),o.jsx("button",{type:"submit",disabled:!a.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:a.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:a.trim()&&!n?"#000":"var(--text-muted)",cursor:a.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&o.jsx(uU,{workspaceId:e,onClose:()=>d(!1)})]})}function hU(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,s,i]=t,a=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=i.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:a,kind:i,kindLabel:l,version:s,display:`${a} - ${l}`}}function mU({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:s,onClose:i,onRefresh:a}){var j,A;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,v]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,_=(t==null?void 0:t.modified_artifacts)??[],x=((j=t==null?void 0:t.tier1)==null?void 0:j.passed)??!0,y=((A=t==null?void 0:t.tier1)==null?void 0:A.results)??[],b=(t==null?void 0:t.branch)??"",w=t!=null&&t.expires_at?new Date(t.expires_at):null,k=async T=>{u(!0),v(null);try{const D=await be.commit(e,T);c(!1),n==null||n(D),a==null||a()}catch(D){v(D.message)}finally{u(!1)}},C=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await be.discard(e),s==null||s(),a==null||a()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},N=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await be.closeWorkspace(e),i==null||i()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},E=T=>{if(!T)return null;const F=T-new Date;if(F<=0)return"Expired";const S=Math.floor(F/(1e3*60*60)),I=Math.floor(F%(1e3*60*60)/(1e3*60));return S>0?`${S}h ${I}m remaining`:`${I}m remaining`};return o.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:o.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?o.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),o.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),w&&o.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:E(w)})]}),o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),o.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),_.length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",_.length,")"]}),o.jsx("div",{className:"space-y-1",children:_.map(T=>{const D=hU(T);return o.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[o.jsx("span",{style:{color:"var(--text-primary)"},children:D.displayName||T}),D.kindLabel&&o.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",D.kindLabel]})]},T)})})]})]}),o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),o.jsx(qS,{results:y,compact:!0})]}),y.length>0&&!x&&o.jsx("div",{className:"mt-3",children:o.jsx(qS,{results:y})})]})]}),o.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[o.jsx("button",{onClick:()=>c(!0),disabled:!g||!x||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&x?"var(--action-success)":"var(--border-panel)",color:g&&x?"#000":"var(--text-muted)",cursor:g&&x&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!x&&g&&o.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&o.jsx("button",{onClick:C,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&o.jsx("button",{onClick:N,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&o.jsx(pU,{workspaceId:e,onCommit:k,onCancel:()=>{c(!1),v(null)},loading:d,modifiedArtifacts:_,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&o.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function gU(){const{isAdmin:e,loading:t}=zi(),[r,n]=m.useState(null),[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[v,g]=m.useState(null),[_,x]=m.useState(null),[y,b]=m.useState(null),[w,k]=m.useState(null),[C,N]=m.useState(!1),{workspaceId:E,loading:j,error:A,reinitialize:T}=JB(),{state:D,loading:F,refresh:S}=e9(E),{documentTypes:I,loading:M,refresh:z}=t9(),{roles:P,loading:R,refresh:L}=r9(),{templates:$,loading:q,refresh:Y}=z3(),{workflows:K,loading:H,refresh:B}=BW(),{fragments:X,loading:ie,kindOptions:oe,refresh:J}=$3(),{schemas:we,loading:ge,refresh:_e}=F3(),[xe,ae]=m.useState([]),[U,re]=m.useState([]),[te,je]=m.useState(!1),[se,fe]=m.useState(null),he=m.useCallback(async()=>{je(!0);try{const[ue,de]=await Promise.all([be.getMechanicalOpTypes(),be.getMechanicalOps()]);ae(ue.types||[]),re(de.operations||[])}catch(ue){console.error("Failed to load mechanical ops:",ue)}finally{je(!1)}},[]);m.useEffect(()=>{he()},[he]);const Q=m.useCallback(async(ue,de=null,Ve="docworkflow")=>{if(n(ue),d(null),f(null),h(null),i(null),g(null),x(null),fe(null),b(de),k(Ve),!!ue){l(!0);try{const _r=await be.getDocumentType(ue.doc_type_id);i(_r)}catch(_r){console.error("Failed to load doc type details:",_r),i(ue)}finally{l(!1)}}},[]),me=m.useCallback(ue=>{Q(ue,"task_prompt","task")},[Q]),qe=m.useCallback(ue=>{Q(ue,"schema","schema")},[Q]),Le=m.useCallback(ue=>{d(ue),n(null),i(null),f(null),h(null),g(null),x(null),fe(null)},[]),Ce=m.useCallback(ue=>{f(ue),n(null),i(null),d(null),h(null),g(null),x(null),fe(null)},[]),Ee=m.useCallback(ue=>{h(ue),n(null),i(null),d(null),f(null),g(null),x(null),fe(null)},[]),Me=m.useCallback(ue=>{g(ue),n(null),i(null),d(null),f(null),h(null),x(null),fe(null)},[]),tt=m.useCallback(ue=>{x(ue),n(null),i(null),d(null),f(null),h(null),g(null),fe(null)},[]),Ie=m.useCallback(ue=>{fe(ue),n(null),i(null),d(null),f(null),h(null),g(null),x(null)},[]),Z=m.useCallback(ue=>{const de=K.find(Ve=>Ve.workflow_id===ue);de&&Ee(de)},[K,Ee]),Te=m.useCallback((ue,de)=>{S()},[S]),ve=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),Ct=m.useCallback(()=>{n(null),i(null),d(null),f(null),h(null),g(null),x(null),fe(null)},[]),yt=m.useCallback(async ue=>{if(E)try{const de=await be.createOrchestrationWorkflow(E,ue);await B(),S(),h({workflow_id:de.workflow_id,active_version:de.version,name:ue.name||de.workflow_id.replace(/_/g," ").replace(/\b\w/g,Ve=>Ve.toUpperCase())}),n(null),i(null),d(null),f(null)}catch(de){console.error("Failed to create workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[E,B,S]),bt=m.useCallback(async ue=>{if(E)try{await be.deleteOrchestrationWorkflow(E,ue),await B(),S(),h(null)}catch(de){console.error("Failed to delete workflow:",de),alert(`Failed to delete workflow: ${de.message}`)}},[E,B,S]),Qt=m.useCallback(async ue=>{if(E)try{const de=await be.createDocumentType(E,ue);await z(),S(),Q({doc_type_id:de.doc_type_id,display_name:ue.display_name||de.doc_type_id.replace(/_/g," ").replace(/\b\w/g,Ve=>Ve.toUpperCase()),active_version:de.version})}catch(de){console.error("Failed to create document type:",de),alert(`Failed to create document type: ${de.message}`)}},[E,z,S,Q]);m.useCallback(async ue=>{if(E)try{await be.deleteDocumentType(E,ue),await z(),S(),n(null),i(null)}catch(de){console.error("Failed to delete document type:",de),alert(`Failed to delete document type: ${de.message}`)}},[E,z,S]);const O=m.useCallback(async ue=>{if(E)try{await be.createDcwWorkflow(E,{doc_type_id:ue}),await B(),S()}catch(de){console.error("Failed to create DCW workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[E,B,S]),W=m.useCallback(async ue=>{if(E)try{const de=await be.createRolePrompt(E,ue);await J(),await L(),S(),Me({fragment_id:`role:${de.role_id}`,kind:"role",version:de.version,name:ue.name||de.role_id.replace(/_/g," ").replace(/\b\w/g,Ve=>Ve.toUpperCase())})}catch(de){console.error("Failed to create role prompt:",de),alert(`Failed to create role prompt: ${de.message}`)}},[E,J,L,S,Me]),V=m.useCallback(async ue=>{if(E)try{const de=await be.createTemplate(E,ue);await Y(),S(),Ce({template_id:de.template_id,active_version:de.version,name:ue.name||de.template_id.replace(/_/g," ").replace(/\b\w/g,Ve=>Ve.toUpperCase())})}catch(de){console.error("Failed to create template:",de),alert(`Failed to create template: ${de.message}`)}},[E,Y,S,Ce]),ne=m.useCallback(async ue=>{if(E)try{const de=await be.createStandaloneSchema(E,ue);await _e(),S(),tt({schema_id:de.schema_id,active_version:de.version,title:ue.title||de.schema_id.replace(/_/g," ").replace(/\b\w/g,Ve=>Ve.toUpperCase())})}catch(de){console.error("Failed to create schema:",de),alert(`Failed to create schema: ${de.message}`)}},[E,_e,S,tt]),ze=m.useCallback(()=>{T(),n(null),i(null),d(null),f(null),h(null),g(null),x(null),fe(null)},[T]),ct=m.useCallback(async()=>{try{await be.invalidateCache(),await Promise.all([z(),L(),Y(),B(),J(),_e(),he(),S()])}catch(ue){console.error("Failed to reload config:",ue),alert(`Failed to reload config: ${ue.message}`)}},[z,L,Y,B,J,_e,he,S]);if(t)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),o.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(j)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),o.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(A)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),o.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:A}),o.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const ar=c&&!r&&!u&&!p&&!v&&!_&&!se,Et=u&&!r&&!c&&!p&&!v&&!_&&!se,_t=p&&!r&&!c&&!u&&!v&&!_&&!se,$t=v&&!r&&!c&&!u&&!p&&!_&&!se,Dr=_&&!r&&!c&&!u&&!p&&!v&&!se,st=se&&!r&&!c&&!u&&!p&&!v&&!_;return o.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{window.location.href="/"},title:"Return to Home"}),o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:ct,className:"flex items-center gap-1 px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{background:"var(--bg-panel)",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:11},title:"Reload config from disk (invalidate cache)",children:[o.jsx("span",{style:{fontSize:12},children:""}),o.jsx("span",{children:"Reload"})]}),o.jsxs("button",{onClick:()=>N(!C),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:C?"var(--action-primary)":"var(--bg-panel)",color:C?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[o.jsx("span",{style:{fontSize:14},children:""}),o.jsx("span",{children:"Building Blocks"})]})]})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsx(WW,{documentTypes:I,roles:P,templates:$,workflows:K,promptFragments:X,promptFragmentKindOptions:oe,schemas:we,loading:M,rolesLoading:R,templatesLoading:q,workflowsLoading:H,promptFragmentsLoading:ie,schemasLoading:ge,selectedDocType:r,docTypeSource:w,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:v,selectedSchema:_,onSelectDocType:Q,onSelectRole:Le,onSelectTemplate:Ce,onSelectWorkflow:Ee,onSelectFragment:Me,onSelectStandaloneSchema:tt,onCreateWorkflow:yt,onCreateDocType:Qt,onCreateFragment:W,onCreateTemplate:V,onCreateSchema:ne,onSelectTask:me,onSelectSchema:qe,workspaceState:D}),ar?o.jsx(fH,{workspaceId:E,role:c,onArtifactSave:Te}):Et?o.jsx(hH,{workspaceId:E,template:u,onArtifactSave:Te}):$t?o.jsx(vH,{workspaceId:E,fragment:v,onArtifactSave:Te}):_t?o.jsx(rU,{workspaceId:E,workflow:p,documentTypes:I,onArtifactSave:Te,onDelete:bt,onNavigateToWorkflow:Z}):Dr?o.jsx(mH,{workspaceId:E,schema:_,onArtifactSave:Te}):st?o.jsx(yH,{mechanicalOp:se,mechanicalOpTypes:xe}):o.jsx(dH,{workspaceId:E,docType:s,loading:a,roles:P,workflows:K,onArtifactSave:Te,onCreateDcwWorkflow:O,initialTab:y,docTypeSource:w,mechanicalOpTypes:xe,mechanicalOps:U}),o.jsx(mU,{workspaceId:E,state:D,loading:F,onCommit:ve,onDiscard:Ct,onClose:ze,onRefresh:S})]}),o.jsx(VW,{isOpen:C,onClose:()=>N(!1),promptFragments:X,promptFragmentKindOptions:oe,templates:$,schemas:we,documentTypes:I,promptFragmentsLoading:ie,templatesLoading:q,schemasLoading:ge,selectedFragment:v,selectedTemplate:u,selectedSchema:_,selectedMechanicalOp:se,onSelectFragment:Me,onSelectTemplate:Ce,onSelectSchema:qe,onSelectStandaloneSchema:tt,onCreateFragment:W,onCreateTemplate:V,onCreateSchema:ne,mechanicalOpTypes:xe,mechanicalOps:U,mechanicalOpsLoading:te,onSelectMechanicalOp:Ie})]})}function xU({user:e,onClick:t}){return o.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?o.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):o.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),o.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function vU(){var T,D,F;const{user:e}=zi(),[t,r]=m.useState(!1),{projects:n,loading:s,error:i,refresh:a}=YB({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(!1),{theme:g,setTheme:_}=K4(),x=Object.keys(n),y=l&&n[l]?l:x[0]||null;m.useEffect(()=>{if(y&&n[y]){const S=n[y];document.title=`${S.projectId} - The Combine`}else document.title="The Combine"},[y,n]);const b=S=>{c(S),u(null)},w=()=>{p(!0)},k=async S=>{await a(),S&&S.id&&(c(S.id),u("concierge_intake")),p(!1)},C=()=>{p(!1)},N=async(S,I)=>{try{await Ye.updateProject(S,I),await a()}catch(M){throw console.error("Failed to update project:",M),M}},E=async S=>{try{if(await Ye.archiveProject(S),!t){const I=Object.values(n).sort((P,R)=>{const L=(P.name||"").localeCompare(R.name||"");return L!==0?L:(P.projectId||"").localeCompare(R.projectId||"")}),M=I.findIndex(P=>P.id===S),z=I[M+1]||I[M-1]||null;c((z==null?void 0:z.id)||null)}await a()}catch(I){throw console.error("Failed to archive project:",I),I}},j=async S=>{try{await Ye.unarchiveProject(S),await a()}catch(I){throw console.error("Failed to unarchive project:",I),I}},A=async S=>{try{await Ye.deleteProject(S);const I=Object.values(n).sort((P,R)=>{const L=(P.name||"").localeCompare(R.name||"");return L!==0?L:(P.projectId||"").localeCompare(R.projectId||"")}),M=I.findIndex(P=>P.id===S),z=I[M+1]||I[M-1]||null;c((z==null?void 0:z.id)||null),await a()}catch(I){throw console.error("Failed to delete project:",I),I}};return s?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):i?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[o.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",i]}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):o.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[o.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),o.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),o.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),o.jsx("path",{d:"M12 17h.01"})]})})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsx(h8,{projects:n,selectedId:y,onSelectProject:b,onNewProject:w,showArchived:t,onToggleShowArchived:()=>r(S=>!S),userSection:o.jsx(xU,{user:e,onClick:()=>v(!0)})}),o.jsx("div",{className:"flex-1",children:y?o.jsx(Ii,{children:o.jsx(i9,{projectId:y,projectCode:(T=n[y])==null?void 0:T.projectId,projectName:(D=n[y])==null?void 0:D.name,isArchived:(F=n[y])==null?void 0:F.isArchived,autoExpandNodeId:d,theme:g,onThemeChange:_,onProjectUpdate:N,onProjectArchive:E,onProjectUnarchive:j,onProjectDelete:A})},y):o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("div",{className:"text-center",children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&o.jsx(TW,{onClose:C,onComplete:k}),h&&o.jsx(AW,{onClose:()=>v(!1)})]})]})}function yU(){const{isAuthenticated:e,loading:t}=zi(),{theme:r}=K4(),[n,s]=m.useState(window.location.pathname);return m.useEffect(()=>{const i=()=>s(window.location.pathname);return window.addEventListener("popstate",i),()=>window.removeEventListener("popstate",i)},[]),t?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?o.jsx("div",{className:`h-screen theme-${r}`,children:o.jsx(gU,{})}):o.jsx(vU,{}):n==="/learn"?o.jsx(qW,{}):o.jsx(LW,{})}function bU(){return o.jsx(ZB,{children:o.jsx(yU,{})})}Ag.createRoot(document.getElementById("root")).render(o.jsx(G.StrictMode,{children:o.jsx(bU,{})}));
//# sourceMappingURL=index-DogMfVlY.js.map
