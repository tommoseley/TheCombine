(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wk={exports:{}},xc={},_k={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var la=Symbol.for("react.element"),vT=Symbol.for("react.portal"),xT=Symbol.for("react.fragment"),yT=Symbol.for("react.strict_mode"),bT=Symbol.for("react.profiler"),wT=Symbol.for("react.provider"),_T=Symbol.for("react.context"),ST=Symbol.for("react.forward_ref"),kT=Symbol.for("react.suspense"),jT=Symbol.for("react.memo"),CT=Symbol.for("react.lazy"),Ty=Symbol.iterator;function NT(e){return e===null||typeof e!="object"?null:(e=Ty&&e[Ty]||e["@@iterator"],typeof e=="function"?e:null)}var Sk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kk=Object.assign,jk={};function Eo(e,t,r){this.props=e,this.context=t,this.refs=jk,this.updater=r||Sk}Eo.prototype.isReactComponent={};Eo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Eo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ck(){}Ck.prototype=Eo.prototype;function Lv(e,t,r){this.props=e,this.context=t,this.refs=jk,this.updater=r||Sk}var Fv=Lv.prototype=new Ck;Fv.constructor=Lv;kk(Fv,Eo.prototype);Fv.isPureReactComponent=!0;var Ay=Array.isArray,Nk=Object.prototype.hasOwnProperty,zv={current:null},Ek={key:!0,ref:!0,__self:!0,__source:!0};function Rk(e,t,r){var n,i={},o=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)Nk.call(t,n)&&!Ek.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:la,type:e,key:o,ref:s,props:i,_owner:zv.current}}function ET(e,t){return{$$typeof:la,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function qv(e){return typeof e=="object"&&e!==null&&e.$$typeof===la}function RT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Iy=/\/+/g;function yu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?RT(""+e.key):t.toString(36)}function sl(e,t,r,n,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case la:case vT:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+yu(s,0):n,Ay(i)?(r="",e!=null&&(r=e.replace(Iy,"$&/")+"/"),sl(i,t,r,"",function(u){return u})):i!=null&&(qv(i)&&(i=ET(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Iy,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",Ay(e))for(var a=0;a<e.length;a++){o=e[a];var c=n+yu(o,a);s+=sl(o,t,r,c,i)}else if(c=NT(e),typeof c=="function")for(e=c.call(e),a=0;!(o=e.next()).done;)o=o.value,c=n+yu(o,a++),s+=sl(o,t,r,c,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function ja(e,t,r){if(e==null)return e;var n=[],i=0;return sl(e,n,"","",function(o){return t.call(r,o,i++)}),n}function TT(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pt={current:null},al={transition:null},AT={ReactCurrentDispatcher:Pt,ReactCurrentBatchConfig:al,ReactCurrentOwner:zv};function Tk(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:ja,forEach:function(e,t,r){ja(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ja(e,function(){t++}),t},toArray:function(e){return ja(e,function(t){return t})||[]},only:function(e){if(!qv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};be.Component=Eo;be.Fragment=xT;be.Profiler=bT;be.PureComponent=Lv;be.StrictMode=yT;be.Suspense=kT;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AT;be.act=Tk;be.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=kk({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=zv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)Nk.call(t,c)&&!Ek.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:la,type:e.type,key:i,ref:o,props:n,_owner:s}};be.createContext=function(e){return e={$$typeof:_T,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:wT,_context:e},e.Consumer=e};be.createElement=Rk;be.createFactory=function(e){var t=Rk.bind(null,e);return t.type=e,t};be.createRef=function(){return{current:null}};be.forwardRef=function(e){return{$$typeof:ST,render:e}};be.isValidElement=qv;be.lazy=function(e){return{$$typeof:CT,_payload:{_status:-1,_result:e},_init:TT}};be.memo=function(e,t){return{$$typeof:jT,type:e,compare:t===void 0?null:t}};be.startTransition=function(e){var t=al.transition;al.transition={};try{e()}finally{al.transition=t}};be.unstable_act=Tk;be.useCallback=function(e,t){return Pt.current.useCallback(e,t)};be.useContext=function(e){return Pt.current.useContext(e)};be.useDebugValue=function(){};be.useDeferredValue=function(e){return Pt.current.useDeferredValue(e)};be.useEffect=function(e,t){return Pt.current.useEffect(e,t)};be.useId=function(){return Pt.current.useId()};be.useImperativeHandle=function(e,t,r){return Pt.current.useImperativeHandle(e,t,r)};be.useInsertionEffect=function(e,t){return Pt.current.useInsertionEffect(e,t)};be.useLayoutEffect=function(e,t){return Pt.current.useLayoutEffect(e,t)};be.useMemo=function(e,t){return Pt.current.useMemo(e,t)};be.useReducer=function(e,t,r){return Pt.current.useReducer(e,t,r)};be.useRef=function(e){return Pt.current.useRef(e)};be.useState=function(e){return Pt.current.useState(e)};be.useSyncExternalStore=function(e,t,r){return Pt.current.useSyncExternalStore(e,t,r)};be.useTransition=function(){return Pt.current.useTransition()};be.version="18.3.1";_k.exports=be;var m=_k.exports;const W=Dv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IT=m,MT=Symbol.for("react.element"),PT=Symbol.for("react.fragment"),OT=Object.prototype.hasOwnProperty,DT=IT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LT={key:!0,ref:!0,__self:!0,__source:!0};function Ak(e,t,r){var n,i={},o=null,s=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)OT.call(t,n)&&!LT.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:MT,type:e,key:o,ref:s,props:i,_owner:DT.current}}xc.Fragment=PT;xc.jsx=Ak;xc.jsxs=Ak;wk.exports=xc;var l=wk.exports,hg={},Ik={exports:{}},rr={},Mk={exports:{}},Pk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,I){var L=D.length;D.push(I);e:for(;0<L;){var O=L-1>>>1,q=D[O];if(0<i(q,I))D[O]=I,D[L]=q,L=O;else break e}}function r(D){return D.length===0?null:D[0]}function n(D){if(D.length===0)return null;var I=D[0],L=D.pop();if(L!==I){D[0]=L;e:for(var O=0,q=D.length,B=q>>>1;O<B;){var $=2*(O+1)-1,V=D[$],X=$+1,ne=D[X];if(0>i(V,L))X<q&&0>i(ne,V)?(D[O]=ne,D[X]=L,O=X):(D[O]=V,D[$]=L,O=$);else if(X<q&&0>i(ne,L))D[O]=ne,D[X]=L,O=X;else break e}}return I}function i(D,I){var L=D.sortIndex-I.sortIndex;return L!==0?L:D.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var c=[],u=[],d=1,f=null,h=3,p=!1,y=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(D){for(var I=r(u);I!==null;){if(I.callback===null)n(u);else if(I.startTime<=D)n(u),I.sortIndex=I.expirationTime,t(c,I);else break;I=r(u)}}function _(D){if(g=!1,b(D),!y)if(r(c)!==null)y=!0,M(j);else{var I=r(u);I!==null&&z(_,I.startTime-D)}}function j(D,I){y=!1,g&&(g=!1,v(E),E=-1),p=!0;var L=h;try{for(b(I),f=r(c);f!==null&&(!(f.expirationTime>I)||D&&!R());){var O=f.callback;if(typeof O=="function"){f.callback=null,h=f.priorityLevel;var q=O(f.expirationTime<=I);I=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(I)}else n(c);f=r(c)}if(f!==null)var B=!0;else{var $=r(u);$!==null&&z(_,$.startTime-I),B=!1}return B}finally{f=null,h=L,p=!1}}var k=!1,N=null,E=-1,C=5,T=-1;function R(){return!(e.unstable_now()-T<C)}function P(){if(N!==null){var D=e.unstable_now();T=D;var I=!0;try{I=N(!0,D)}finally{I?F():(k=!1,N=null)}}else k=!1}var F;if(typeof x=="function")F=function(){x(P)};else if(typeof MessageChannel<"u"){var S=new MessageChannel,A=S.port2;S.port1.onmessage=P,F=function(){A.postMessage(null)}}else F=function(){w(P,0)};function M(D){N=D,k||(k=!0,F())}function z(D,I){E=w(function(){D(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){y||p||(y=!0,M(j))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(D){switch(h){case 1:case 2:case 3:var I=3;break;default:I=h}var L=h;h=I;try{return D()}finally{h=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,I){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var L=h;h=D;try{return I()}finally{h=L}},e.unstable_scheduleCallback=function(D,I,L){var O=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?O+L:O):L=O,D){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=L+q,D={id:d++,callback:I,priorityLevel:D,startTime:L,expirationTime:q,sortIndex:-1},L>O?(D.sortIndex=L,t(u,D),r(c)===null&&D===r(u)&&(g?(v(E),E=-1):g=!0,z(_,L-O))):(D.sortIndex=q,t(c,D),y||p||(y=!0,M(j))),D},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(D){var I=h;return function(){var L=h;h=I;try{return D.apply(this,arguments)}finally{h=L}}}})(Pk);Mk.exports=Pk;var FT=Mk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zT=m,er=FT;function K(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ok=new Set,Ts={};function Ni(e,t){mo(e,t),mo(e+"Capture",t)}function mo(e,t){for(Ts[e]=t,e=0;e<t.length;e++)Ok.add(t[e])}var ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mg=Object.prototype.hasOwnProperty,qT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,My={},Py={};function $T(e){return mg.call(Py,e)?!0:mg.call(My,e)?!1:qT.test(e)?Py[e]=!0:(My[e]=!0,!1)}function BT(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function HT(e,t,r,n){if(t===null||typeof t>"u"||BT(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ot(e,t,r,n,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){St[e]=new Ot(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];St[t]=new Ot(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){St[e]=new Ot(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){St[e]=new Ot(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){St[e]=new Ot(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){St[e]=new Ot(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){St[e]=new Ot(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){St[e]=new Ot(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){St[e]=new Ot(e,5,!1,e.toLowerCase(),null,!1,!1)});var $v=/[\-:]([a-z])/g;function Bv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($v,Bv);St[t]=new Ot(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($v,Bv);St[t]=new Ot(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($v,Bv);St[t]=new Ot(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){St[e]=new Ot(e,1,!1,e.toLowerCase(),null,!1,!1)});St.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){St[e]=new Ot(e,1,!1,e.toLowerCase(),null,!0,!0)});function Hv(e,t,r,n){var i=St.hasOwnProperty(t)?St[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(HT(t,r,i,n)&&(r=null),n||i===null?$T(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var gn=zT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ca=Symbol.for("react.element"),Bi=Symbol.for("react.portal"),Hi=Symbol.for("react.fragment"),Wv=Symbol.for("react.strict_mode"),gg=Symbol.for("react.profiler"),Dk=Symbol.for("react.provider"),Lk=Symbol.for("react.context"),Uv=Symbol.for("react.forward_ref"),vg=Symbol.for("react.suspense"),xg=Symbol.for("react.suspense_list"),Vv=Symbol.for("react.memo"),_n=Symbol.for("react.lazy"),Fk=Symbol.for("react.offscreen"),Oy=Symbol.iterator;function $o(e){return e===null||typeof e!="object"?null:(e=Oy&&e[Oy]||e["@@iterator"],typeof e=="function"?e:null)}var Ze=Object.assign,bu;function is(e){if(bu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);bu=t&&t[1]||""}return`
`+bu+e}var wu=!1;function _u(e,t){if(!e||wu)return"";wu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=n.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var c=`
`+i[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=a);break}}}finally{wu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?is(e):""}function WT(e){switch(e.tag){case 5:return is(e.type);case 16:return is("Lazy");case 13:return is("Suspense");case 19:return is("SuspenseList");case 0:case 2:case 15:return e=_u(e.type,!1),e;case 11:return e=_u(e.type.render,!1),e;case 1:return e=_u(e.type,!0),e;default:return""}}function yg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Hi:return"Fragment";case Bi:return"Portal";case gg:return"Profiler";case Wv:return"StrictMode";case vg:return"Suspense";case xg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lk:return(e.displayName||"Context")+".Consumer";case Dk:return(e._context.displayName||"Context")+".Provider";case Uv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Vv:return t=e.displayName||null,t!==null?t:yg(e.type)||"Memo";case _n:t=e._payload,e=e._init;try{return yg(e(t))}catch{}}return null}function UT(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yg(t);case 8:return t===Wv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function VT(e){var t=zk(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Na(e){e._valueTracker||(e._valueTracker=VT(e))}function qk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=zk(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Sl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function bg(e,t){var r=t.checked;return Ze({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Dy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Gn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $k(e,t){t=t.checked,t!=null&&Hv(e,"checked",t,!1)}function wg(e,t){$k(e,t);var r=Gn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_g(e,t.type,r):t.hasOwnProperty("defaultValue")&&_g(e,t.type,Gn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ly(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function _g(e,t,r){(t!=="number"||Sl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var os=Array.isArray;function io(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Gn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Sg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(K(91));return Ze({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(K(92));if(os(r)){if(1<r.length)throw Error(K(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Gn(r)}}function Bk(e,t){var r=Gn(t.value),n=Gn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function zy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ea,Wk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ea=Ea||document.createElement("div"),Ea.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ea.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function As(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GT=["Webkit","ms","Moz","O"];Object.keys(vs).forEach(function(e){GT.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vs[t]=vs[e]})});function Uk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||vs.hasOwnProperty(e)&&vs[e]?(""+t).trim():t+"px"}function Vk(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Uk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var YT=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jg(e,t){if(t){if(YT[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(K(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(K(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(K(61))}if(t.style!=null&&typeof t.style!="object")throw Error(K(62))}}function Cg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ng=null;function Gv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Eg=null,oo=null,so=null;function qy(e){if(e=da(e)){if(typeof Eg!="function")throw Error(K(280));var t=e.stateNode;t&&(t=Sc(t),Eg(e.stateNode,e.type,t))}}function Gk(e){oo?so?so.push(e):so=[e]:oo=e}function Yk(){if(oo){var e=oo,t=so;if(so=oo=null,qy(e),t)for(e=0;e<t.length;e++)qy(t[e])}}function Kk(e,t){return e(t)}function Xk(){}var Su=!1;function Qk(e,t,r){if(Su)return e(t,r);Su=!0;try{return Kk(e,t,r)}finally{Su=!1,(oo!==null||so!==null)&&(Xk(),Yk())}}function Is(e,t){var r=e.stateNode;if(r===null)return null;var n=Sc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(K(231,t,typeof r));return r}var Rg=!1;if(ln)try{var Bo={};Object.defineProperty(Bo,"passive",{get:function(){Rg=!0}}),window.addEventListener("test",Bo,Bo),window.removeEventListener("test",Bo,Bo)}catch{Rg=!1}function KT(e,t,r,n,i,o,s,a,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var xs=!1,kl=null,jl=!1,Tg=null,XT={onError:function(e){xs=!0,kl=e}};function QT(e,t,r,n,i,o,s,a,c){xs=!1,kl=null,KT.apply(XT,arguments)}function ZT(e,t,r,n,i,o,s,a,c){if(QT.apply(this,arguments),xs){if(xs){var u=kl;xs=!1,kl=null}else throw Error(K(198));jl||(jl=!0,Tg=u)}}function Ei(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Zk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function $y(e){if(Ei(e)!==e)throw Error(K(188))}function JT(e){var t=e.alternate;if(!t){if(t=Ei(e),t===null)throw Error(K(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return $y(i),e;if(o===n)return $y(i),t;o=o.sibling}throw Error(K(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,a=i.child;a;){if(a===r){s=!0,r=i,n=o;break}if(a===n){s=!0,n=i,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,n=i;break}if(a===n){s=!0,n=o,r=i;break}a=a.sibling}if(!s)throw Error(K(189))}}if(r.alternate!==n)throw Error(K(190))}if(r.tag!==3)throw Error(K(188));return r.stateNode.current===r?e:t}function Jk(e){return e=JT(e),e!==null?ej(e):null}function ej(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ej(e);if(t!==null)return t;e=e.sibling}return null}var tj=er.unstable_scheduleCallback,By=er.unstable_cancelCallback,eA=er.unstable_shouldYield,tA=er.unstable_requestPaint,nt=er.unstable_now,rA=er.unstable_getCurrentPriorityLevel,Yv=er.unstable_ImmediatePriority,rj=er.unstable_UserBlockingPriority,Cl=er.unstable_NormalPriority,nA=er.unstable_LowPriority,nj=er.unstable_IdlePriority,yc=null,qr=null;function iA(e){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(yc,e,void 0,(e.current.flags&128)===128)}catch{}}var Cr=Math.clz32?Math.clz32:aA,oA=Math.log,sA=Math.LN2;function aA(e){return e>>>=0,e===0?32:31-(oA(e)/sA|0)|0}var Ra=64,Ta=4194304;function ss(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Nl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,s=r&268435455;if(s!==0){var a=s&~i;a!==0?n=ss(a):(o&=s,o!==0&&(n=ss(o)))}else s=r&~i,s!==0?n=ss(s):o!==0&&(n=ss(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Cr(t),i=1<<r,n|=e[r],t&=~i;return n}function lA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cA(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Cr(o),a=1<<s,c=i[s];c===-1?(!(a&r)||a&n)&&(i[s]=lA(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}function Ag(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ij(){var e=Ra;return Ra<<=1,!(Ra&4194240)&&(Ra=64),e}function ku(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ca(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Cr(t),e[t]=r}function uA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Cr(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function Kv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Cr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Pe=0;function oj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sj,Xv,aj,lj,cj,Ig=!1,Aa=[],On=null,Dn=null,Ln=null,Ms=new Map,Ps=new Map,Nn=[],dA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hy(e,t){switch(e){case"focusin":case"focusout":On=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":Ms.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ps.delete(t.pointerId)}}function Ho(e,t,r,n,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},t!==null&&(t=da(t),t!==null&&Xv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function fA(e,t,r,n,i){switch(t){case"focusin":return On=Ho(On,e,t,r,n,i),!0;case"dragenter":return Dn=Ho(Dn,e,t,r,n,i),!0;case"mouseover":return Ln=Ho(Ln,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return Ms.set(o,Ho(Ms.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,Ps.set(o,Ho(Ps.get(o)||null,e,t,r,n,i)),!0}return!1}function uj(e){var t=ci(e.target);if(t!==null){var r=Ei(t);if(r!==null){if(t=r.tag,t===13){if(t=Zk(r),t!==null){e.blockedOn=t,cj(e.priority,function(){aj(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ll(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Mg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ng=n,r.target.dispatchEvent(n),Ng=null}else return t=da(r),t!==null&&Xv(t),e.blockedOn=r,!1;t.shift()}return!0}function Wy(e,t,r){ll(e)&&r.delete(t)}function pA(){Ig=!1,On!==null&&ll(On)&&(On=null),Dn!==null&&ll(Dn)&&(Dn=null),Ln!==null&&ll(Ln)&&(Ln=null),Ms.forEach(Wy),Ps.forEach(Wy)}function Wo(e,t){e.blockedOn===t&&(e.blockedOn=null,Ig||(Ig=!0,er.unstable_scheduleCallback(er.unstable_NormalPriority,pA)))}function Os(e){function t(i){return Wo(i,e)}if(0<Aa.length){Wo(Aa[0],e);for(var r=1;r<Aa.length;r++){var n=Aa[r];n.blockedOn===e&&(n.blockedOn=null)}}for(On!==null&&Wo(On,e),Dn!==null&&Wo(Dn,e),Ln!==null&&Wo(Ln,e),Ms.forEach(t),Ps.forEach(t),r=0;r<Nn.length;r++)n=Nn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Nn.length&&(r=Nn[0],r.blockedOn===null);)uj(r),r.blockedOn===null&&Nn.shift()}var ao=gn.ReactCurrentBatchConfig,El=!0;function hA(e,t,r,n){var i=Pe,o=ao.transition;ao.transition=null;try{Pe=1,Qv(e,t,r,n)}finally{Pe=i,ao.transition=o}}function mA(e,t,r,n){var i=Pe,o=ao.transition;ao.transition=null;try{Pe=4,Qv(e,t,r,n)}finally{Pe=i,ao.transition=o}}function Qv(e,t,r,n){if(El){var i=Mg(e,t,r,n);if(i===null)Pu(e,t,n,Rl,r),Hy(e,n);else if(fA(i,e,t,r,n))n.stopPropagation();else if(Hy(e,n),t&4&&-1<dA.indexOf(e)){for(;i!==null;){var o=da(i);if(o!==null&&sj(o),o=Mg(e,t,r,n),o===null&&Pu(e,t,n,Rl,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else Pu(e,t,n,null,r)}}var Rl=null;function Mg(e,t,r,n){if(Rl=null,e=Gv(n),e=ci(e),e!==null)if(t=Ei(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Zk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Rl=e,null}function dj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rA()){case Yv:return 1;case rj:return 4;case Cl:case nA:return 16;case nj:return 536870912;default:return 16}default:return 16}}var Mn=null,Zv=null,cl=null;function fj(){if(cl)return cl;var e,t=Zv,r=t.length,n,i="value"in Mn?Mn.value:Mn.textContent,o=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[o-n];n++);return cl=i.slice(e,1<n?1-n:void 0)}function ul(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ia(){return!0}function Uy(){return!1}function nr(e){function t(r,n,i,o,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ia:Uy,this.isPropagationStopped=Uy,this}return Ze(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ia)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ia)},persist:function(){},isPersistent:Ia}),t}var Ro={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jv=nr(Ro),ua=Ze({},Ro,{view:0,detail:0}),gA=nr(ua),ju,Cu,Uo,bc=Ze({},ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ex,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Uo&&(Uo&&e.type==="mousemove"?(ju=e.screenX-Uo.screenX,Cu=e.screenY-Uo.screenY):Cu=ju=0,Uo=e),ju)},movementY:function(e){return"movementY"in e?e.movementY:Cu}}),Vy=nr(bc),vA=Ze({},bc,{dataTransfer:0}),xA=nr(vA),yA=Ze({},ua,{relatedTarget:0}),Nu=nr(yA),bA=Ze({},Ro,{animationName:0,elapsedTime:0,pseudoElement:0}),wA=nr(bA),_A=Ze({},Ro,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),SA=nr(_A),kA=Ze({},Ro,{data:0}),Gy=nr(kA),jA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},NA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=NA[e])?!!t[e]:!1}function ex(){return EA}var RA=Ze({},ua,{key:function(e){if(e.key){var t=jA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ul(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?CA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ex,charCode:function(e){return e.type==="keypress"?ul(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ul(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),TA=nr(RA),AA=Ze({},bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yy=nr(AA),IA=Ze({},ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ex}),MA=nr(IA),PA=Ze({},Ro,{propertyName:0,elapsedTime:0,pseudoElement:0}),OA=nr(PA),DA=Ze({},bc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),LA=nr(DA),FA=[9,13,27,32],tx=ln&&"CompositionEvent"in window,ys=null;ln&&"documentMode"in document&&(ys=document.documentMode);var zA=ln&&"TextEvent"in window&&!ys,pj=ln&&(!tx||ys&&8<ys&&11>=ys),Ky=" ",Xy=!1;function hj(e,t){switch(e){case"keyup":return FA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wi=!1;function qA(e,t){switch(e){case"compositionend":return mj(t);case"keypress":return t.which!==32?null:(Xy=!0,Ky);case"textInput":return e=t.data,e===Ky&&Xy?null:e;default:return null}}function $A(e,t){if(Wi)return e==="compositionend"||!tx&&hj(e,t)?(e=fj(),cl=Zv=Mn=null,Wi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pj&&t.locale!=="ko"?null:t.data;default:return null}}var BA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!BA[e.type]:t==="textarea"}function gj(e,t,r,n){Gk(n),t=Tl(t,"onChange"),0<t.length&&(r=new Jv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var bs=null,Ds=null;function HA(e){Nj(e,0)}function wc(e){var t=Gi(e);if(qk(t))return e}function WA(e,t){if(e==="change")return t}var vj=!1;if(ln){var Eu;if(ln){var Ru="oninput"in document;if(!Ru){var Zy=document.createElement("div");Zy.setAttribute("oninput","return;"),Ru=typeof Zy.oninput=="function"}Eu=Ru}else Eu=!1;vj=Eu&&(!document.documentMode||9<document.documentMode)}function Jy(){bs&&(bs.detachEvent("onpropertychange",xj),Ds=bs=null)}function xj(e){if(e.propertyName==="value"&&wc(Ds)){var t=[];gj(t,Ds,e,Gv(e)),Qk(HA,t)}}function UA(e,t,r){e==="focusin"?(Jy(),bs=t,Ds=r,bs.attachEvent("onpropertychange",xj)):e==="focusout"&&Jy()}function VA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wc(Ds)}function GA(e,t){if(e==="click")return wc(t)}function YA(e,t){if(e==="input"||e==="change")return wc(t)}function KA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Er=typeof Object.is=="function"?Object.is:KA;function Ls(e,t){if(Er(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!mg.call(t,i)||!Er(e[i],t[i]))return!1}return!0}function e0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function t0(e,t){var r=e0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=e0(r)}}function yj(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yj(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function bj(){for(var e=window,t=Sl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Sl(e.document)}return t}function rx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function XA(e){var t=bj(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&yj(r.ownerDocument.documentElement,r)){if(n!==null&&rx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=t0(r,o);var s=t0(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var QA=ln&&"documentMode"in document&&11>=document.documentMode,Ui=null,Pg=null,ws=null,Og=!1;function r0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Og||Ui==null||Ui!==Sl(n)||(n=Ui,"selectionStart"in n&&rx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ws&&Ls(ws,n)||(ws=n,n=Tl(Pg,"onSelect"),0<n.length&&(t=new Jv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ui)))}function Ma(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Vi={animationend:Ma("Animation","AnimationEnd"),animationiteration:Ma("Animation","AnimationIteration"),animationstart:Ma("Animation","AnimationStart"),transitionend:Ma("Transition","TransitionEnd")},Tu={},wj={};ln&&(wj=document.createElement("div").style,"AnimationEvent"in window||(delete Vi.animationend.animation,delete Vi.animationiteration.animation,delete Vi.animationstart.animation),"TransitionEvent"in window||delete Vi.transitionend.transition);function _c(e){if(Tu[e])return Tu[e];if(!Vi[e])return e;var t=Vi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in wj)return Tu[e]=t[r];return e}var _j=_c("animationend"),Sj=_c("animationiteration"),kj=_c("animationstart"),jj=_c("transitionend"),Cj=new Map,n0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qn(e,t){Cj.set(e,t),Ni(t,[e])}for(var Au=0;Au<n0.length;Au++){var Iu=n0[Au],ZA=Iu.toLowerCase(),JA=Iu[0].toUpperCase()+Iu.slice(1);Qn(ZA,"on"+JA)}Qn(_j,"onAnimationEnd");Qn(Sj,"onAnimationIteration");Qn(kj,"onAnimationStart");Qn("dblclick","onDoubleClick");Qn("focusin","onFocus");Qn("focusout","onBlur");Qn(jj,"onTransitionEnd");mo("onMouseEnter",["mouseout","mouseover"]);mo("onMouseLeave",["mouseout","mouseover"]);mo("onPointerEnter",["pointerout","pointerover"]);mo("onPointerLeave",["pointerout","pointerover"]);Ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ni("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var as="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e5=new Set("cancel close invalid load scroll toggle".split(" ").concat(as));function i0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,ZT(n,t,void 0,e),e.currentTarget=null}function Nj(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;i0(i,a,u),o=c}else for(s=0;s<n.length;s++){if(a=n[s],c=a.instance,u=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;i0(i,a,u),o=c}}}if(jl)throw e=Tg,jl=!1,Tg=null,e}function ze(e,t){var r=t[qg];r===void 0&&(r=t[qg]=new Set);var n=e+"__bubble";r.has(n)||(Ej(t,e,2,!1),r.add(n))}function Mu(e,t,r){var n=0;t&&(n|=4),Ej(r,e,n,t)}var Pa="_reactListening"+Math.random().toString(36).slice(2);function Fs(e){if(!e[Pa]){e[Pa]=!0,Ok.forEach(function(r){r!=="selectionchange"&&(e5.has(r)||Mu(r,!1,e),Mu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Pa]||(t[Pa]=!0,Mu("selectionchange",!1,t))}}function Ej(e,t,r,n){switch(dj(t)){case 1:var i=hA;break;case 4:i=mA;break;default:i=Qv}r=i.bind(null,t,r,e),i=void 0,!Rg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Pu(e,t,r,n,i){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;a!==null;){if(s=ci(a),s===null)return;if(c=s.tag,c===5||c===6){n=o=s;continue e}a=a.parentNode}}n=n.return}Qk(function(){var u=o,d=Gv(r),f=[];e:{var h=Cj.get(e);if(h!==void 0){var p=Jv,y=e;switch(e){case"keypress":if(ul(r)===0)break e;case"keydown":case"keyup":p=TA;break;case"focusin":y="focus",p=Nu;break;case"focusout":y="blur",p=Nu;break;case"beforeblur":case"afterblur":p=Nu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Vy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=xA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=MA;break;case _j:case Sj:case kj:p=wA;break;case jj:p=OA;break;case"scroll":p=gA;break;case"wheel":p=LA;break;case"copy":case"cut":case"paste":p=SA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Yy}var g=(t&4)!==0,w=!g&&e==="scroll",v=g?h!==null?h+"Capture":null:h;g=[];for(var x=u,b;x!==null;){b=x;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,v!==null&&(_=Is(x,v),_!=null&&g.push(zs(x,_,b)))),w)break;x=x.return}0<g.length&&(h=new p(h,y,null,r,d),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Ng&&(y=r.relatedTarget||r.fromElement)&&(ci(y)||y[cn]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(y=r.relatedTarget||r.toElement,p=u,y=y?ci(y):null,y!==null&&(w=Ei(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(g=Vy,_="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=Yy,_="onPointerLeave",v="onPointerEnter",x="pointer"),w=p==null?h:Gi(p),b=y==null?h:Gi(y),h=new g(_,x+"leave",p,r,d),h.target=w,h.relatedTarget=b,_=null,ci(d)===u&&(g=new g(v,x+"enter",y,r,d),g.target=b,g.relatedTarget=w,_=g),w=_,p&&y)t:{for(g=p,v=y,x=0,b=g;b;b=Pi(b))x++;for(b=0,_=v;_;_=Pi(_))b++;for(;0<x-b;)g=Pi(g),x--;for(;0<b-x;)v=Pi(v),b--;for(;x--;){if(g===v||v!==null&&g===v.alternate)break t;g=Pi(g),v=Pi(v)}g=null}else g=null;p!==null&&o0(f,h,p,g,!1),y!==null&&w!==null&&o0(f,w,y,g,!0)}}e:{if(h=u?Gi(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var j=WA;else if(Qy(h))if(vj)j=YA;else{j=VA;var k=UA}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=GA);if(j&&(j=j(e,u))){gj(f,j,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&_g(h,"number",h.value)}switch(k=u?Gi(u):window,e){case"focusin":(Qy(k)||k.contentEditable==="true")&&(Ui=k,Pg=u,ws=null);break;case"focusout":ws=Pg=Ui=null;break;case"mousedown":Og=!0;break;case"contextmenu":case"mouseup":case"dragend":Og=!1,r0(f,r,d);break;case"selectionchange":if(QA)break;case"keydown":case"keyup":r0(f,r,d)}var N;if(tx)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Wi?hj(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(pj&&r.locale!=="ko"&&(Wi||E!=="onCompositionStart"?E==="onCompositionEnd"&&Wi&&(N=fj()):(Mn=d,Zv="value"in Mn?Mn.value:Mn.textContent,Wi=!0)),k=Tl(u,E),0<k.length&&(E=new Gy(E,e,null,r,d),f.push({event:E,listeners:k}),N?E.data=N:(N=mj(r),N!==null&&(E.data=N)))),(N=zA?qA(e,r):$A(e,r))&&(u=Tl(u,"onBeforeInput"),0<u.length&&(d=new Gy("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=N))}Nj(f,t)})}function zs(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Tl(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Is(e,r),o!=null&&n.unshift(zs(e,o,i)),o=Is(e,t),o!=null&&n.push(zs(e,o,i))),e=e.return}return n}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function o0(e,t,r,n,i){for(var o=t._reactName,s=[];r!==null&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&u!==null&&(a=u,i?(c=Is(r,o),c!=null&&s.unshift(zs(r,c,a))):i||(c=Is(r,o),c!=null&&s.push(zs(r,c,a)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var t5=/\r\n?/g,r5=/\u0000|\uFFFD/g;function s0(e){return(typeof e=="string"?e:""+e).replace(t5,`
`).replace(r5,"")}function Oa(e,t,r){if(t=s0(t),s0(e)!==t&&r)throw Error(K(425))}function Al(){}var Dg=null,Lg=null;function Fg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var zg=typeof setTimeout=="function"?setTimeout:void 0,n5=typeof clearTimeout=="function"?clearTimeout:void 0,a0=typeof Promise=="function"?Promise:void 0,i5=typeof queueMicrotask=="function"?queueMicrotask:typeof a0<"u"?function(e){return a0.resolve(null).then(e).catch(o5)}:zg;function o5(e){setTimeout(function(){throw e})}function Ou(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Os(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Os(t)}function Fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function l0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var To=Math.random().toString(36).slice(2),Fr="__reactFiber$"+To,qs="__reactProps$"+To,cn="__reactContainer$"+To,qg="__reactEvents$"+To,s5="__reactListeners$"+To,a5="__reactHandles$"+To;function ci(e){var t=e[Fr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[cn]||r[Fr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=l0(e);e!==null;){if(r=e[Fr])return r;e=l0(e)}return t}e=r,r=e.parentNode}return null}function da(e){return e=e[Fr]||e[cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Gi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(K(33))}function Sc(e){return e[qs]||null}var $g=[],Yi=-1;function Zn(e){return{current:e}}function qe(e){0>Yi||(e.current=$g[Yi],$g[Yi]=null,Yi--)}function De(e,t){Yi++,$g[Yi]=e.current,e.current=t}var Yn={},Nt=Zn(Yn),Bt=Zn(!1),bi=Yn;function go(e,t){var r=e.type.contextTypes;if(!r)return Yn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ht(e){return e=e.childContextTypes,e!=null}function Il(){qe(Bt),qe(Nt)}function c0(e,t,r){if(Nt.current!==Yn)throw Error(K(168));De(Nt,t),De(Bt,r)}function Rj(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(K(108,UT(e)||"Unknown",i));return Ze({},r,n)}function Ml(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Yn,bi=Nt.current,De(Nt,e),De(Bt,Bt.current),!0}function u0(e,t,r){var n=e.stateNode;if(!n)throw Error(K(169));r?(e=Rj(e,t,bi),n.__reactInternalMemoizedMergedChildContext=e,qe(Bt),qe(Nt),De(Nt,e)):qe(Bt),De(Bt,r)}var Jr=null,kc=!1,Du=!1;function Tj(e){Jr===null?Jr=[e]:Jr.push(e)}function l5(e){kc=!0,Tj(e)}function Jn(){if(!Du&&Jr!==null){Du=!0;var e=0,t=Pe;try{var r=Jr;for(Pe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jr=null,kc=!1}catch(i){throw Jr!==null&&(Jr=Jr.slice(e+1)),tj(Yv,Jn),i}finally{Pe=t,Du=!1}}return null}var Ki=[],Xi=0,Pl=null,Ol=0,sr=[],ar=0,wi=null,en=1,tn="";function si(e,t){Ki[Xi++]=Ol,Ki[Xi++]=Pl,Pl=e,Ol=t}function Aj(e,t,r){sr[ar++]=en,sr[ar++]=tn,sr[ar++]=wi,wi=e;var n=en;e=tn;var i=32-Cr(n)-1;n&=~(1<<i),r+=1;var o=32-Cr(t)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,en=1<<32-Cr(t)+i|r<<i|n,tn=o+e}else en=1<<o|r<<i|n,tn=e}function nx(e){e.return!==null&&(si(e,1),Aj(e,1,0))}function ix(e){for(;e===Pl;)Pl=Ki[--Xi],Ki[Xi]=null,Ol=Ki[--Xi],Ki[Xi]=null;for(;e===wi;)wi=sr[--ar],sr[ar]=null,tn=sr[--ar],sr[ar]=null,en=sr[--ar],sr[ar]=null}var Jt=null,Zt=null,Be=!1,kr=null;function Ij(e,t){var r=cr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function d0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Jt=e,Zt=Fn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Jt=e,Zt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=wi!==null?{id:en,overflow:tn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=cr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Jt=e,Zt=null,!0):!1;default:return!1}}function Bg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Hg(e){if(Be){var t=Zt;if(t){var r=t;if(!d0(e,t)){if(Bg(e))throw Error(K(418));t=Fn(r.nextSibling);var n=Jt;t&&d0(e,t)?Ij(n,r):(e.flags=e.flags&-4097|2,Be=!1,Jt=e)}}else{if(Bg(e))throw Error(K(418));e.flags=e.flags&-4097|2,Be=!1,Jt=e}}}function f0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Jt=e}function Da(e){if(e!==Jt)return!1;if(!Be)return f0(e),Be=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Fg(e.type,e.memoizedProps)),t&&(t=Zt)){if(Bg(e))throw Mj(),Error(K(418));for(;t;)Ij(e,t),t=Fn(t.nextSibling)}if(f0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(K(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Zt=Fn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Zt=null}}else Zt=Jt?Fn(e.stateNode.nextSibling):null;return!0}function Mj(){for(var e=Zt;e;)e=Fn(e.nextSibling)}function vo(){Zt=Jt=null,Be=!1}function ox(e){kr===null?kr=[e]:kr.push(e)}var c5=gn.ReactCurrentBatchConfig;function Vo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(K(309));var n=r.stateNode}if(!n)throw Error(K(147,e));var i=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(K(284));if(!r._owner)throw Error(K(290,e))}return e}function La(e,t){throw e=Object.prototype.toString.call(t),Error(K(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function p0(e){var t=e._init;return t(e._payload)}function Pj(e){function t(v,x){if(e){var b=v.deletions;b===null?(v.deletions=[x],v.flags|=16):b.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=Bn(v,x),v.index=0,v.sibling=null,v}function o(v,x,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<x?(v.flags|=2,x):b):(v.flags|=2,x)):(v.flags|=1048576,x)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function a(v,x,b,_){return x===null||x.tag!==6?(x=Hu(b,v.mode,_),x.return=v,x):(x=i(x,b),x.return=v,x)}function c(v,x,b,_){var j=b.type;return j===Hi?d(v,x,b.props.children,_,b.key):x!==null&&(x.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===_n&&p0(j)===x.type)?(_=i(x,b.props),_.ref=Vo(v,x,b),_.return=v,_):(_=vl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vo(v,x,b),_.return=v,_)}function u(v,x,b,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=Wu(b,v.mode,_),x.return=v,x):(x=i(x,b.children||[]),x.return=v,x)}function d(v,x,b,_,j){return x===null||x.tag!==7?(x=gi(b,v.mode,_,j),x.return=v,x):(x=i(x,b),x.return=v,x)}function f(v,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Hu(""+x,v.mode,b),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ca:return b=vl(x.type,x.key,x.props,null,v.mode,b),b.ref=Vo(v,null,x),b.return=v,b;case Bi:return x=Wu(x,v.mode,b),x.return=v,x;case _n:var _=x._init;return f(v,_(x._payload),b)}if(os(x)||$o(x))return x=gi(x,v.mode,b,null),x.return=v,x;La(v,x)}return null}function h(v,x,b,_){var j=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:a(v,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ca:return b.key===j?c(v,x,b,_):null;case Bi:return b.key===j?u(v,x,b,_):null;case _n:return j=b._init,h(v,x,j(b._payload),_)}if(os(b)||$o(b))return j!==null?null:d(v,x,b,_,null);La(v,b)}return null}function p(v,x,b,_,j){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(b)||null,a(x,v,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ca:return v=v.get(_.key===null?b:_.key)||null,c(x,v,_,j);case Bi:return v=v.get(_.key===null?b:_.key)||null,u(x,v,_,j);case _n:var k=_._init;return p(v,x,b,k(_._payload),j)}if(os(_)||$o(_))return v=v.get(b)||null,d(x,v,_,j,null);La(x,_)}return null}function y(v,x,b,_){for(var j=null,k=null,N=x,E=x=0,C=null;N!==null&&E<b.length;E++){N.index>E?(C=N,N=null):C=N.sibling;var T=h(v,N,b[E],_);if(T===null){N===null&&(N=C);break}e&&N&&T.alternate===null&&t(v,N),x=o(T,x,E),k===null?j=T:k.sibling=T,k=T,N=C}if(E===b.length)return r(v,N),Be&&si(v,E),j;if(N===null){for(;E<b.length;E++)N=f(v,b[E],_),N!==null&&(x=o(N,x,E),k===null?j=N:k.sibling=N,k=N);return Be&&si(v,E),j}for(N=n(v,N);E<b.length;E++)C=p(N,v,E,b[E],_),C!==null&&(e&&C.alternate!==null&&N.delete(C.key===null?E:C.key),x=o(C,x,E),k===null?j=C:k.sibling=C,k=C);return e&&N.forEach(function(R){return t(v,R)}),Be&&si(v,E),j}function g(v,x,b,_){var j=$o(b);if(typeof j!="function")throw Error(K(150));if(b=j.call(b),b==null)throw Error(K(151));for(var k=j=null,N=x,E=x=0,C=null,T=b.next();N!==null&&!T.done;E++,T=b.next()){N.index>E?(C=N,N=null):C=N.sibling;var R=h(v,N,T.value,_);if(R===null){N===null&&(N=C);break}e&&N&&R.alternate===null&&t(v,N),x=o(R,x,E),k===null?j=R:k.sibling=R,k=R,N=C}if(T.done)return r(v,N),Be&&si(v,E),j;if(N===null){for(;!T.done;E++,T=b.next())T=f(v,T.value,_),T!==null&&(x=o(T,x,E),k===null?j=T:k.sibling=T,k=T);return Be&&si(v,E),j}for(N=n(v,N);!T.done;E++,T=b.next())T=p(N,v,E,T.value,_),T!==null&&(e&&T.alternate!==null&&N.delete(T.key===null?E:T.key),x=o(T,x,E),k===null?j=T:k.sibling=T,k=T);return e&&N.forEach(function(P){return t(v,P)}),Be&&si(v,E),j}function w(v,x,b,_){if(typeof b=="object"&&b!==null&&b.type===Hi&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ca:e:{for(var j=b.key,k=x;k!==null;){if(k.key===j){if(j=b.type,j===Hi){if(k.tag===7){r(v,k.sibling),x=i(k,b.props.children),x.return=v,v=x;break e}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===_n&&p0(j)===k.type){r(v,k.sibling),x=i(k,b.props),x.ref=Vo(v,k,b),x.return=v,v=x;break e}r(v,k);break}else t(v,k);k=k.sibling}b.type===Hi?(x=gi(b.props.children,v.mode,_,b.key),x.return=v,v=x):(_=vl(b.type,b.key,b.props,null,v.mode,_),_.ref=Vo(v,x,b),_.return=v,v=_)}return s(v);case Bi:e:{for(k=b.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){r(v,x.sibling),x=i(x,b.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=Wu(b,v.mode,_),x.return=v,v=x}return s(v);case _n:return k=b._init,w(v,x,k(b._payload),_)}if(os(b))return y(v,x,b,_);if($o(b))return g(v,x,b,_);La(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,b),x.return=v,v=x):(r(v,x),x=Hu(b,v.mode,_),x.return=v,v=x),s(v)):r(v,x)}return w}var xo=Pj(!0),Oj=Pj(!1),Dl=Zn(null),Ll=null,Qi=null,sx=null;function ax(){sx=Qi=Ll=null}function lx(e){var t=Dl.current;qe(Dl),e._currentValue=t}function Wg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function lo(e,t){Ll=e,sx=Qi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zt=!0),e.firstContext=null)}function fr(e){var t=e._currentValue;if(sx!==e)if(e={context:e,memoizedValue:t,next:null},Qi===null){if(Ll===null)throw Error(K(308));Qi=e,Ll.dependencies={lanes:0,firstContext:e}}else Qi=Qi.next=e;return t}var ui=null;function cx(e){ui===null?ui=[e]:ui.push(e)}function Dj(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,cx(t)):(r.next=i.next,i.next=r),t.interleaved=r,un(e,n)}function un(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Sn=!1;function ux(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lj(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Re&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,un(e,r)}return i=n.interleaved,i===null?(t.next=t,cx(n)):(t.next=i.next,i.next=t),n.interleaved=t,un(e,r)}function dl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Kv(e,r)}}function h0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?i=o=t:o=o.next=t}else i=o=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Fl(e,t,r,n){var i=e.updateQueue;Sn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,s===null?o=u:s.next=u,s=c;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==s&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(o!==null){var f=i.baseState;s=0,d=u=c=null,a=o;do{var h=a.lane,p=a.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,g=a;switch(h=t,p=r,g.tag){case 1:if(y=g.payload,typeof y=="function"){f=y.call(p,f,h);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,h=typeof y=="function"?y.call(p,f,h):y,h==null)break e;f=Ze({},f,h);break e;case 2:Sn=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Si|=s,e.lanes=s,e.memoizedState=f}}function m0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(K(191,i));i.call(n)}}}var fa={},$r=Zn(fa),$s=Zn(fa),Bs=Zn(fa);function di(e){if(e===fa)throw Error(K(174));return e}function dx(e,t){switch(De(Bs,t),De($s,e),De($r,fa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:kg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=kg(t,e)}qe($r),De($r,t)}function yo(){qe($r),qe($s),qe(Bs)}function Fj(e){di(Bs.current);var t=di($r.current),r=kg(t,e.type);t!==r&&(De($s,e),De($r,r))}function fx(e){$s.current===e&&(qe($r),qe($s))}var Xe=Zn(0);function zl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Lu=[];function px(){for(var e=0;e<Lu.length;e++)Lu[e]._workInProgressVersionPrimary=null;Lu.length=0}var fl=gn.ReactCurrentDispatcher,Fu=gn.ReactCurrentBatchConfig,_i=0,Qe=null,lt=null,ht=null,ql=!1,_s=!1,Hs=0,u5=0;function kt(){throw Error(K(321))}function hx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Er(e[r],t[r]))return!1;return!0}function mx(e,t,r,n,i,o){if(_i=o,Qe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fl.current=e===null||e.memoizedState===null?h5:m5,e=r(n,i),_s){o=0;do{if(_s=!1,Hs=0,25<=o)throw Error(K(301));o+=1,ht=lt=null,t.updateQueue=null,fl.current=g5,e=r(n,i)}while(_s)}if(fl.current=$l,t=lt!==null&&lt.next!==null,_i=0,ht=lt=Qe=null,ql=!1,t)throw Error(K(300));return e}function gx(){var e=Hs!==0;return Hs=0,e}function Lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Qe.memoizedState=ht=e:ht=ht.next=e,ht}function pr(){if(lt===null){var e=Qe.alternate;e=e!==null?e.memoizedState:null}else e=lt.next;var t=ht===null?Qe.memoizedState:ht.next;if(t!==null)ht=t,lt=e;else{if(e===null)throw Error(K(310));lt=e,e={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},ht===null?Qe.memoizedState=ht=e:ht=ht.next=e}return ht}function Ws(e,t){return typeof t=="function"?t(e):t}function zu(e){var t=pr(),r=t.queue;if(r===null)throw Error(K(311));r.lastRenderedReducer=e;var n=lt,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var a=s=null,c=null,u=o;do{var d=u.lane;if((_i&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=f,s=n):c=c.next=f,Qe.lanes|=d,Si|=d}u=u.next}while(u!==null&&u!==o);c===null?s=n:c.next=a,Er(n,t.memoizedState)||(zt=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do o=i.lane,Qe.lanes|=o,Si|=o,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function qu(e){var t=pr(),r=t.queue;if(r===null)throw Error(K(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Er(o,t.memoizedState)||(zt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function zj(){}function qj(e,t){var r=Qe,n=pr(),i=t(),o=!Er(n.memoizedState,i);if(o&&(n.memoizedState=i,zt=!0),n=n.queue,vx(Hj.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||ht!==null&&ht.memoizedState.tag&1){if(r.flags|=2048,Us(9,Bj.bind(null,r,n,i,t),void 0,null),gt===null)throw Error(K(349));_i&30||$j(r,t,i)}return i}function $j(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Qe.updateQueue,t===null?(t={lastEffect:null,stores:null},Qe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Bj(e,t,r,n){t.value=r,t.getSnapshot=n,Wj(t)&&Uj(e)}function Hj(e,t,r){return r(function(){Wj(t)&&Uj(e)})}function Wj(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Er(e,r)}catch{return!0}}function Uj(e){var t=un(e,1);t!==null&&Nr(t,e,1,-1)}function g0(e){var t=Lr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:e},t.queue=e,e=e.dispatch=p5.bind(null,Qe,e),[t.memoizedState,e]}function Us(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Qe.updateQueue,t===null?(t={lastEffect:null,stores:null},Qe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Vj(){return pr().memoizedState}function pl(e,t,r,n){var i=Lr();Qe.flags|=e,i.memoizedState=Us(1|t,r,void 0,n===void 0?null:n)}function jc(e,t,r,n){var i=pr();n=n===void 0?null:n;var o=void 0;if(lt!==null){var s=lt.memoizedState;if(o=s.destroy,n!==null&&hx(n,s.deps)){i.memoizedState=Us(t,r,o,n);return}}Qe.flags|=e,i.memoizedState=Us(1|t,r,o,n)}function v0(e,t){return pl(8390656,8,e,t)}function vx(e,t){return jc(2048,8,e,t)}function Gj(e,t){return jc(4,2,e,t)}function Yj(e,t){return jc(4,4,e,t)}function Kj(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Xj(e,t,r){return r=r!=null?r.concat([e]):null,jc(4,4,Kj.bind(null,t,e),r)}function xx(){}function Qj(e,t){var r=pr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Zj(e,t){var r=pr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Jj(e,t,r){return _i&21?(Er(r,t)||(r=ij(),Qe.lanes|=r,Si|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zt=!0),e.memoizedState=r)}function d5(e,t){var r=Pe;Pe=r!==0&&4>r?r:4,e(!0);var n=Fu.transition;Fu.transition={};try{e(!1),t()}finally{Pe=r,Fu.transition=n}}function eC(){return pr().memoizedState}function f5(e,t,r){var n=$n(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},tC(e))rC(t,r);else if(r=Dj(e,t,r,n),r!==null){var i=Mt();Nr(r,e,n,i),nC(r,t,n)}}function p5(e,t,r){var n=$n(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(tC(e))rC(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,r);if(i.hasEagerState=!0,i.eagerState=a,Er(a,s)){var c=t.interleaved;c===null?(i.next=i,cx(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=Dj(e,t,i,n),r!==null&&(i=Mt(),Nr(r,e,n,i),nC(r,t,n))}}function tC(e){var t=e.alternate;return e===Qe||t!==null&&t===Qe}function rC(e,t){_s=ql=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function nC(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Kv(e,r)}}var $l={readContext:fr,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},h5={readContext:fr,useCallback:function(e,t){return Lr().memoizedState=[e,t===void 0?null:t],e},useContext:fr,useEffect:v0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,pl(4194308,4,Kj.bind(null,t,e),r)},useLayoutEffect:function(e,t){return pl(4194308,4,e,t)},useInsertionEffect:function(e,t){return pl(4,2,e,t)},useMemo:function(e,t){var r=Lr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Lr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=f5.bind(null,Qe,e),[n.memoizedState,e]},useRef:function(e){var t=Lr();return e={current:e},t.memoizedState=e},useState:g0,useDebugValue:xx,useDeferredValue:function(e){return Lr().memoizedState=e},useTransition:function(){var e=g0(!1),t=e[0];return e=d5.bind(null,e[1]),Lr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Qe,i=Lr();if(Be){if(r===void 0)throw Error(K(407));r=r()}else{if(r=t(),gt===null)throw Error(K(349));_i&30||$j(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,v0(Hj.bind(null,n,o,e),[e]),n.flags|=2048,Us(9,Bj.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Lr(),t=gt.identifierPrefix;if(Be){var r=tn,n=en;r=(n&~(1<<32-Cr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Hs++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=u5++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},m5={readContext:fr,useCallback:Qj,useContext:fr,useEffect:vx,useImperativeHandle:Xj,useInsertionEffect:Gj,useLayoutEffect:Yj,useMemo:Zj,useReducer:zu,useRef:Vj,useState:function(){return zu(Ws)},useDebugValue:xx,useDeferredValue:function(e){var t=pr();return Jj(t,lt.memoizedState,e)},useTransition:function(){var e=zu(Ws)[0],t=pr().memoizedState;return[e,t]},useMutableSource:zj,useSyncExternalStore:qj,useId:eC,unstable_isNewReconciler:!1},g5={readContext:fr,useCallback:Qj,useContext:fr,useEffect:vx,useImperativeHandle:Xj,useInsertionEffect:Gj,useLayoutEffect:Yj,useMemo:Zj,useReducer:qu,useRef:Vj,useState:function(){return qu(Ws)},useDebugValue:xx,useDeferredValue:function(e){var t=pr();return lt===null?t.memoizedState=e:Jj(t,lt.memoizedState,e)},useTransition:function(){var e=qu(Ws)[0],t=pr().memoizedState;return[e,t]},useMutableSource:zj,useSyncExternalStore:qj,useId:eC,unstable_isNewReconciler:!1};function wr(e,t){if(e&&e.defaultProps){t=Ze({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ug(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ze({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Cc={isMounted:function(e){return(e=e._reactInternals)?Ei(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Mt(),i=$n(e),o=sn(n,i);o.payload=t,r!=null&&(o.callback=r),t=zn(e,o,i),t!==null&&(Nr(t,e,i,n),dl(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Mt(),i=$n(e),o=sn(n,i);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=zn(e,o,i),t!==null&&(Nr(t,e,i,n),dl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Mt(),n=$n(e),i=sn(r,n);i.tag=2,t!=null&&(i.callback=t),t=zn(e,i,n),t!==null&&(Nr(t,e,n,r),dl(t,e,n))}};function x0(e,t,r,n,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,s):t.prototype&&t.prototype.isPureReactComponent?!Ls(r,n)||!Ls(i,o):!0}function iC(e,t,r){var n=!1,i=Yn,o=t.contextType;return typeof o=="object"&&o!==null?o=fr(o):(i=Ht(t)?bi:Nt.current,n=t.contextTypes,o=(n=n!=null)?go(e,i):Yn),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Cc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function y0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Cc.enqueueReplaceState(t,t.state,null)}function Vg(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},ux(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=fr(o):(o=Ht(t)?bi:Nt.current,i.context=go(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Ug(e,t,o,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Cc.enqueueReplaceState(i,i.state,null),Fl(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function bo(e,t){try{var r="",n=t;do r+=WT(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function $u(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Gg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var v5=typeof WeakMap=="function"?WeakMap:Map;function oC(e,t,r){r=sn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Hl||(Hl=!0,nv=n),Gg(e,t)},r}function sC(e,t,r){r=sn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Gg(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){Gg(e,t),typeof n!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function b0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new v5;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=A5.bind(null,e,t,r),t.then(e,e))}function w0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _0(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=sn(-1,1),t.tag=2,zn(r,t,1))),r.lanes|=1),e)}var x5=gn.ReactCurrentOwner,zt=!1;function At(e,t,r,n){t.child=e===null?Oj(t,null,r,n):xo(t,e.child,r,n)}function S0(e,t,r,n,i){r=r.render;var o=t.ref;return lo(t,i),n=mx(e,t,r,n,o,i),r=gx(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,dn(e,t,i)):(Be&&r&&nx(t),t.flags|=1,At(e,t,n,i),t.child)}function k0(e,t,r,n,i){if(e===null){var o=r.type;return typeof o=="function"&&!Cx(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,aC(e,t,o,n,i)):(e=vl(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:Ls,r(s,n)&&e.ref===t.ref)return dn(e,t,i)}return t.flags|=1,e=Bn(o,n),e.ref=t.ref,e.return=t,t.child=e}function aC(e,t,r,n,i){if(e!==null){var o=e.memoizedProps;if(Ls(o,n)&&e.ref===t.ref)if(zt=!1,t.pendingProps=n=o,(e.lanes&i)!==0)e.flags&131072&&(zt=!0);else return t.lanes=e.lanes,dn(e,t,i)}return Yg(e,t,r,n,i)}function lC(e,t,r){var n=t.pendingProps,i=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Ji,Xt),Xt|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,De(Ji,Xt),Xt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,De(Ji,Xt),Xt|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,De(Ji,Xt),Xt|=n;return At(e,t,i,r),t.child}function cC(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Yg(e,t,r,n,i){var o=Ht(r)?bi:Nt.current;return o=go(t,o),lo(t,i),r=mx(e,t,r,n,o,i),n=gx(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,dn(e,t,i)):(Be&&n&&nx(t),t.flags|=1,At(e,t,r,i),t.child)}function j0(e,t,r,n,i){if(Ht(r)){var o=!0;Ml(t)}else o=!1;if(lo(t,i),t.stateNode===null)hl(e,t),iC(t,r,n),Vg(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=fr(u):(u=Ht(r)?bi:Nt.current,u=go(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==n||c!==u)&&y0(t,s,n,u),Sn=!1;var h=t.memoizedState;s.state=h,Fl(t,n,s,i),c=t.memoizedState,a!==n||h!==c||Bt.current||Sn?(typeof d=="function"&&(Ug(t,r,d,n),c=t.memoizedState),(a=Sn||x0(t,r,a,n,h,c,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Lj(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:wr(t.type,a),s.props=u,f=t.pendingProps,h=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=fr(c):(c=Ht(r)?bi:Nt.current,c=go(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==f||h!==c)&&y0(t,s,n,c),Sn=!1,h=t.memoizedState,s.state=h,Fl(t,n,s,i);var y=t.memoizedState;a!==f||h!==y||Bt.current||Sn?(typeof p=="function"&&(Ug(t,r,p,n),y=t.memoizedState),(u=Sn||x0(t,r,u,n,h,y,c)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,y,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,y,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),s.props=n,s.state=y,s.context=c,n=u):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Kg(e,t,r,n,o,i)}function Kg(e,t,r,n,i,o){cC(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&u0(t,r,!1),dn(e,t,o);n=t.stateNode,x5.current=t;var a=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=xo(t,e.child,null,o),t.child=xo(t,null,a,o)):At(e,t,a,o),t.memoizedState=n.state,i&&u0(t,r,!0),t.child}function uC(e){var t=e.stateNode;t.pendingContext?c0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&c0(e,t.context,!1),dx(e,t.containerInfo)}function C0(e,t,r,n,i){return vo(),ox(i),t.flags|=256,At(e,t,r,n),t.child}var Xg={dehydrated:null,treeContext:null,retryLane:0};function Qg(e){return{baseLanes:e,cachePool:null,transitions:null}}function dC(e,t,r){var n=t.pendingProps,i=Xe.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),De(Xe,i&1),e===null)return Hg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,o?(n=t.mode,o=t.child,s={mode:"hidden",children:s},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Rc(s,n,0,null),e=gi(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Qg(r),t.memoizedState=Xg,e):yx(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return y5(e,t,s,n,a,i,r);if(o){o=n.fallback,s=t.mode,i=e.child,a=i.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bn(i,c),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Bn(a,o):(o=gi(o,s,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,s=e.child.memoizedState,s=s===null?Qg(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~r,t.memoizedState=Xg,n}return o=e.child,e=o.sibling,n=Bn(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function yx(e,t){return t=Rc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Fa(e,t,r,n){return n!==null&&ox(n),xo(t,e.child,null,r),e=yx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function y5(e,t,r,n,i,o,s){if(r)return t.flags&256?(t.flags&=-257,n=$u(Error(K(422))),Fa(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=Rc({mode:"visible",children:n.children},i,0,null),o=gi(o,i,s,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&xo(t,e.child,null,s),t.child.memoizedState=Qg(s),t.memoizedState=Xg,o);if(!(t.mode&1))return Fa(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(K(419)),n=$u(o,n,void 0),Fa(e,t,s,n)}if(a=(s&e.childLanes)!==0,zt||a){if(n=gt,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,un(e,i),Nr(n,e,i,-1))}return jx(),n=$u(Error(K(421))),Fa(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=I5.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Zt=Fn(i.nextSibling),Jt=t,Be=!0,kr=null,e!==null&&(sr[ar++]=en,sr[ar++]=tn,sr[ar++]=wi,en=e.id,tn=e.overflow,wi=t),t=yx(t,n.children),t.flags|=4096,t)}function N0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Wg(e.return,t,r)}function Bu(e,t,r,n,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function fC(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(At(e,t,n.children,r),n=Xe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&N0(e,r,t);else if(e.tag===19)N0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(De(Xe,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&zl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Bu(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&zl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Bu(t,!0,r,null,o);break;case"together":Bu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function dn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Si|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(K(153));if(t.child!==null){for(e=t.child,r=Bn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function b5(e,t,r){switch(t.tag){case 3:uC(t),vo();break;case 5:Fj(t);break;case 1:Ht(t.type)&&Ml(t);break;case 4:dx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;De(Dl,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(De(Xe,Xe.current&1),t.flags|=128,null):r&t.child.childLanes?dC(e,t,r):(De(Xe,Xe.current&1),e=dn(e,t,r),e!==null?e.sibling:null);De(Xe,Xe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return fC(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),De(Xe,Xe.current),n)break;return null;case 22:case 23:return t.lanes=0,lC(e,t,r)}return dn(e,t,r)}var pC,Zg,hC,mC;pC=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Zg=function(){};hC=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,di($r.current);var o=null;switch(r){case"input":i=bg(e,i),n=bg(e,n),o=[];break;case"select":i=Ze({},i,{value:void 0}),n=Ze({},n,{value:void 0}),o=[];break;case"textarea":i=Sg(e,i),n=Sg(e,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Al)}jg(r,n);var s;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(s in a)a.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ts.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var c=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&a[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(o||(o=[]),o.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ts.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ze("scroll",e),o||a===c||(o=[])):(o=o||[]).push(u,c))}r&&(o=o||[]).push("style",r);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};mC=function(e,t,r,n){r!==n&&(t.flags|=4)};function Go(e,t){if(!Be)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function w5(e,t,r){var n=t.pendingProps;switch(ix(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return Ht(t.type)&&Il(),jt(t),null;case 3:return n=t.stateNode,yo(),qe(Bt),qe(Nt),px(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Da(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,kr!==null&&(sv(kr),kr=null))),Zg(e,t),jt(t),null;case 5:fx(t);var i=di(Bs.current);if(r=t.type,e!==null&&t.stateNode!=null)hC(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(K(166));return jt(t),null}if(e=di($r.current),Da(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Fr]=t,n[qs]=o,e=(t.mode&1)!==0,r){case"dialog":ze("cancel",n),ze("close",n);break;case"iframe":case"object":case"embed":ze("load",n);break;case"video":case"audio":for(i=0;i<as.length;i++)ze(as[i],n);break;case"source":ze("error",n);break;case"img":case"image":case"link":ze("error",n),ze("load",n);break;case"details":ze("toggle",n);break;case"input":Dy(n,o),ze("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},ze("invalid",n);break;case"textarea":Fy(n,o),ze("invalid",n)}jg(r,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&Oa(n.textContent,a,e),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Oa(n.textContent,a,e),i=["children",""+a]):Ts.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&ze("scroll",n)}switch(r){case"input":Na(n),Ly(n,o,!0);break;case"textarea":Na(n),zy(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=Al)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Fr]=t,e[qs]=n,pC(e,t,!1,!1),t.stateNode=e;e:{switch(s=Cg(r,n),r){case"dialog":ze("cancel",e),ze("close",e),i=n;break;case"iframe":case"object":case"embed":ze("load",e),i=n;break;case"video":case"audio":for(i=0;i<as.length;i++)ze(as[i],e);i=n;break;case"source":ze("error",e),i=n;break;case"img":case"image":case"link":ze("error",e),ze("load",e),i=n;break;case"details":ze("toggle",e),i=n;break;case"input":Dy(e,n),i=bg(e,n),ze("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ze({},n,{value:void 0}),ze("invalid",e);break;case"textarea":Fy(e,n),i=Sg(e,n),ze("invalid",e);break;default:i=n}jg(r,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?Vk(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Wk(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&As(e,c):typeof c=="number"&&As(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ts.hasOwnProperty(o)?c!=null&&o==="onScroll"&&ze("scroll",e):c!=null&&Hv(e,o,c,s))}switch(r){case"input":Na(e),Ly(e,n,!1);break;case"textarea":Na(e),zy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Gn(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?io(e,!!n.multiple,o,!1):n.defaultValue!=null&&io(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Al)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)mC(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(K(166));if(r=di(Bs.current),di($r.current),Da(t)){if(n=t.stateNode,r=t.memoizedProps,n[Fr]=t,(o=n.nodeValue!==r)&&(e=Jt,e!==null))switch(e.tag){case 3:Oa(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Oa(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Fr]=t,t.stateNode=n}return jt(t),null;case 13:if(qe(Xe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Be&&Zt!==null&&t.mode&1&&!(t.flags&128))Mj(),vo(),t.flags|=98560,o=!1;else if(o=Da(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(K(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(K(317));o[Fr]=t}else vo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),o=!1}else kr!==null&&(sv(kr),kr=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Xe.current&1?dt===0&&(dt=3):jx())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return yo(),Zg(e,t),e===null&&Fs(t.stateNode.containerInfo),jt(t),null;case 10:return lx(t.type._context),jt(t),null;case 17:return Ht(t.type)&&Il(),jt(t),null;case 19:if(qe(Xe),o=t.memoizedState,o===null)return jt(t),null;if(n=(t.flags&128)!==0,s=o.rendering,s===null)if(n)Go(o,!1);else{if(dt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=zl(e),s!==null){for(t.flags|=128,Go(o,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return De(Xe,Xe.current&1|2),t.child}e=e.sibling}o.tail!==null&&nt()>wo&&(t.flags|=128,n=!0,Go(o,!1),t.lanes=4194304)}else{if(!n)if(e=zl(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Go(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Be)return jt(t),null}else 2*nt()-o.renderingStartTime>wo&&r!==1073741824&&(t.flags|=128,n=!0,Go(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(r=o.last,r!==null?r.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=nt(),t.sibling=null,r=Xe.current,De(Xe,n?r&1|2:r&1),t):(jt(t),null);case 22:case 23:return kx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Xt&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(K(156,t.tag))}function _5(e,t){switch(ix(t),t.tag){case 1:return Ht(t.type)&&Il(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return yo(),qe(Bt),qe(Nt),px(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return fx(t),null;case 13:if(qe(Xe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(K(340));vo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qe(Xe),null;case 4:return yo(),null;case 10:return lx(t.type._context),null;case 22:case 23:return kx(),null;case 24:return null;default:return null}}var za=!1,Ct=!1,S5=typeof WeakSet=="function"?WeakSet:Set,J=null;function Zi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function Jg(e,t,r){try{r()}catch(n){tt(e,t,n)}}var E0=!1;function k5(e,t){if(Dg=El,e=bj(),rx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,a=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(a=s+i),f!==o||n!==0&&f.nodeType!==3||(c=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===i&&(a=s),h===o&&++d===n&&(c=s),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Lg={focusedElem:e,selectionRange:r},El=!1,J=t;J!==null;)if(t=J,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,J=e;else for(;J!==null;){t=J;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,w=y.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:wr(t.type,g),w);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(_){tt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,J=e;break}J=t.return}return y=E0,E0=!1,y}function Ss(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&Jg(t,r,o)}i=i.next}while(i!==n)}}function Nc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ev(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function gC(e){var t=e.alternate;t!==null&&(e.alternate=null,gC(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fr],delete t[qs],delete t[qg],delete t[s5],delete t[a5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function vC(e){return e.tag===5||e.tag===3||e.tag===4}function R0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||vC(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function tv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Al));else if(n!==4&&(e=e.child,e!==null))for(tv(e,t,r),e=e.sibling;e!==null;)tv(e,t,r),e=e.sibling}function rv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(rv(e,t,r),e=e.sibling;e!==null;)rv(e,t,r),e=e.sibling}var bt=null,_r=!1;function yn(e,t,r){for(r=r.child;r!==null;)xC(e,t,r),r=r.sibling}function xC(e,t,r){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(yc,r)}catch{}switch(r.tag){case 5:Ct||Zi(r,t);case 6:var n=bt,i=_r;bt=null,yn(e,t,r),bt=n,_r=i,bt!==null&&(_r?(e=bt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):bt.removeChild(r.stateNode));break;case 18:bt!==null&&(_r?(e=bt,r=r.stateNode,e.nodeType===8?Ou(e.parentNode,r):e.nodeType===1&&Ou(e,r),Os(e)):Ou(bt,r.stateNode));break;case 4:n=bt,i=_r,bt=r.stateNode.containerInfo,_r=!0,yn(e,t,r),bt=n,_r=i;break;case 0:case 11:case 14:case 15:if(!Ct&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Jg(r,t,s),i=i.next}while(i!==n)}yn(e,t,r);break;case 1:if(!Ct&&(Zi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){tt(r,t,a)}yn(e,t,r);break;case 21:yn(e,t,r);break;case 22:r.mode&1?(Ct=(n=Ct)||r.memoizedState!==null,yn(e,t,r),Ct=n):yn(e,t,r);break;default:yn(e,t,r)}}function T0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new S5),t.forEach(function(n){var i=M5.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function yr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:bt=a.stateNode,_r=!1;break e;case 3:bt=a.stateNode.containerInfo,_r=!0;break e;case 4:bt=a.stateNode.containerInfo,_r=!0;break e}a=a.return}if(bt===null)throw Error(K(160));xC(o,s,i),bt=null,_r=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){tt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)yC(t,e),t=t.sibling}function yC(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yr(t,e),Or(e),n&4){try{Ss(3,e,e.return),Nc(3,e)}catch(g){tt(e,e.return,g)}try{Ss(5,e,e.return)}catch(g){tt(e,e.return,g)}}break;case 1:yr(t,e),Or(e),n&512&&r!==null&&Zi(r,r.return);break;case 5:if(yr(t,e),Or(e),n&512&&r!==null&&Zi(r,r.return),e.flags&32){var i=e.stateNode;try{As(i,"")}catch(g){tt(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=r!==null?r.memoizedProps:o,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&$k(i,o),Cg(a,s);var u=Cg(a,o);for(s=0;s<c.length;s+=2){var d=c[s],f=c[s+1];d==="style"?Vk(i,f):d==="dangerouslySetInnerHTML"?Wk(i,f):d==="children"?As(i,f):Hv(i,d,f,u)}switch(a){case"input":wg(i,o);break;case"textarea":Bk(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?io(i,!!o.multiple,p,!1):h!==!!o.multiple&&(o.defaultValue!=null?io(i,!!o.multiple,o.defaultValue,!0):io(i,!!o.multiple,o.multiple?[]:"",!1))}i[qs]=o}catch(g){tt(e,e.return,g)}}break;case 6:if(yr(t,e),Or(e),n&4){if(e.stateNode===null)throw Error(K(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){tt(e,e.return,g)}}break;case 3:if(yr(t,e),Or(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Os(t.containerInfo)}catch(g){tt(e,e.return,g)}break;case 4:yr(t,e),Or(e);break;case 13:yr(t,e),Or(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(_x=nt())),n&4&&T0(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ct=(u=Ct)||d,yr(t,e),Ct=u):yr(t,e),Or(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(J=e,d=e.child;d!==null;){for(f=J=d;J!==null;){switch(h=J,p=h.child,h.tag){case 0:case 11:case 14:case 15:Ss(4,h,h.return);break;case 1:Zi(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(g){tt(n,r,g)}}break;case 5:Zi(h,h.return);break;case 22:if(h.memoizedState!==null){I0(f);continue}}p!==null?(p.return=h,J=p):I0(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,c=f.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Uk("display",s))}catch(g){tt(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){tt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:yr(t,e),Or(e),n&4&&T0(e);break;case 21:break;default:yr(t,e),Or(e)}}function Or(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(vC(r)){var n=r;break e}r=r.return}throw Error(K(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(As(i,""),n.flags&=-33);var o=R0(e);rv(e,o,i);break;case 3:case 4:var s=n.stateNode.containerInfo,a=R0(e);tv(e,a,s);break;default:throw Error(K(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function j5(e,t,r){J=e,bC(e)}function bC(e,t,r){for(var n=(e.mode&1)!==0;J!==null;){var i=J,o=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||za;if(!s){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Ct;a=za;var u=Ct;if(za=s,(Ct=c)&&!u)for(J=i;J!==null;)s=J,c=s.child,s.tag===22&&s.memoizedState!==null?M0(i):c!==null?(c.return=s,J=c):M0(i);for(;o!==null;)J=o,bC(o),o=o.sibling;J=i,za=a,Ct=u}A0(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,J=o):A0(e)}}function A0(e){for(;J!==null;){var t=J;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ct||Nc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ct)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:wr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&m0(t,o,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}m0(t,s,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Os(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}Ct||t.flags&512&&ev(t)}catch(h){tt(t,t.return,h)}}if(t===e){J=null;break}if(r=t.sibling,r!==null){r.return=t.return,J=r;break}J=t.return}}function I0(e){for(;J!==null;){var t=J;if(t===e){J=null;break}var r=t.sibling;if(r!==null){r.return=t.return,J=r;break}J=t.return}}function M0(e){for(;J!==null;){var t=J;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Nc(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){tt(t,i,c)}}var o=t.return;try{ev(t)}catch(c){tt(t,o,c)}break;case 5:var s=t.return;try{ev(t)}catch(c){tt(t,s,c)}}}catch(c){tt(t,t.return,c)}if(t===e){J=null;break}var a=t.sibling;if(a!==null){a.return=t.return,J=a;break}J=t.return}}var C5=Math.ceil,Bl=gn.ReactCurrentDispatcher,bx=gn.ReactCurrentOwner,dr=gn.ReactCurrentBatchConfig,Re=0,gt=null,it=null,wt=0,Xt=0,Ji=Zn(0),dt=0,Vs=null,Si=0,Ec=0,wx=0,ks=null,Ft=null,_x=0,wo=1/0,Zr=null,Hl=!1,nv=null,qn=null,qa=!1,Pn=null,Wl=0,js=0,iv=null,ml=-1,gl=0;function Mt(){return Re&6?nt():ml!==-1?ml:ml=nt()}function $n(e){return e.mode&1?Re&2&&wt!==0?wt&-wt:c5.transition!==null?(gl===0&&(gl=ij()),gl):(e=Pe,e!==0||(e=window.event,e=e===void 0?16:dj(e.type)),e):1}function Nr(e,t,r,n){if(50<js)throw js=0,iv=null,Error(K(185));ca(e,r,n),(!(Re&2)||e!==gt)&&(e===gt&&(!(Re&2)&&(Ec|=r),dt===4&&En(e,wt)),Wt(e,n),r===1&&Re===0&&!(t.mode&1)&&(wo=nt()+500,kc&&Jn()))}function Wt(e,t){var r=e.callbackNode;cA(e,t);var n=Nl(e,e===gt?wt:0);if(n===0)r!==null&&By(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&By(r),t===1)e.tag===0?l5(P0.bind(null,e)):Tj(P0.bind(null,e)),i5(function(){!(Re&6)&&Jn()}),r=null;else{switch(oj(n)){case 1:r=Yv;break;case 4:r=rj;break;case 16:r=Cl;break;case 536870912:r=nj;break;default:r=Cl}r=EC(r,wC.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function wC(e,t){if(ml=-1,gl=0,Re&6)throw Error(K(327));var r=e.callbackNode;if(co()&&e.callbackNode!==r)return null;var n=Nl(e,e===gt?wt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ul(e,n);else{t=n;var i=Re;Re|=2;var o=SC();(gt!==e||wt!==t)&&(Zr=null,wo=nt()+500,mi(e,t));do try{R5();break}catch(a){_C(e,a)}while(!0);ax(),Bl.current=o,Re=i,it!==null?t=0:(gt=null,wt=0,t=dt)}if(t!==0){if(t===2&&(i=Ag(e),i!==0&&(n=i,t=ov(e,i))),t===1)throw r=Vs,mi(e,0),En(e,n),Wt(e,nt()),r;if(t===6)En(e,n);else{if(i=e.current.alternate,!(n&30)&&!N5(i)&&(t=Ul(e,n),t===2&&(o=Ag(e),o!==0&&(n=o,t=ov(e,o))),t===1))throw r=Vs,mi(e,0),En(e,n),Wt(e,nt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(K(345));case 2:ai(e,Ft,Zr);break;case 3:if(En(e,n),(n&130023424)===n&&(t=_x+500-nt(),10<t)){if(Nl(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Mt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=zg(ai.bind(null,e,Ft,Zr),t);break}ai(e,Ft,Zr);break;case 4:if(En(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Cr(n);o=1<<s,s=t[s],s>i&&(i=s),n&=~o}if(n=i,n=nt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*C5(n/1960))-n,10<n){e.timeoutHandle=zg(ai.bind(null,e,Ft,Zr),n);break}ai(e,Ft,Zr);break;case 5:ai(e,Ft,Zr);break;default:throw Error(K(329))}}}return Wt(e,nt()),e.callbackNode===r?wC.bind(null,e):null}function ov(e,t){var r=ks;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=Ul(e,t),e!==2&&(t=Ft,Ft=r,t!==null&&sv(t)),e}function sv(e){Ft===null?Ft=e:Ft.push.apply(Ft,e)}function N5(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!Er(o(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function En(e,t){for(t&=~wx,t&=~Ec,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Cr(t),n=1<<r;e[r]=-1,t&=~n}}function P0(e){if(Re&6)throw Error(K(327));co();var t=Nl(e,0);if(!(t&1))return Wt(e,nt()),null;var r=Ul(e,t);if(e.tag!==0&&r===2){var n=Ag(e);n!==0&&(t=n,r=ov(e,n))}if(r===1)throw r=Vs,mi(e,0),En(e,t),Wt(e,nt()),r;if(r===6)throw Error(K(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ai(e,Ft,Zr),Wt(e,nt()),null}function Sx(e,t){var r=Re;Re|=1;try{return e(t)}finally{Re=r,Re===0&&(wo=nt()+500,kc&&Jn())}}function ki(e){Pn!==null&&Pn.tag===0&&!(Re&6)&&co();var t=Re;Re|=1;var r=dr.transition,n=Pe;try{if(dr.transition=null,Pe=1,e)return e()}finally{Pe=n,dr.transition=r,Re=t,!(Re&6)&&Jn()}}function kx(){Xt=Ji.current,qe(Ji)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,n5(r)),it!==null)for(r=it.return;r!==null;){var n=r;switch(ix(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Il();break;case 3:yo(),qe(Bt),qe(Nt),px();break;case 5:fx(n);break;case 4:yo();break;case 13:qe(Xe);break;case 19:qe(Xe);break;case 10:lx(n.type._context);break;case 22:case 23:kx()}r=r.return}if(gt=e,it=e=Bn(e.current,null),wt=Xt=t,dt=0,Vs=null,wx=Ec=Si=0,Ft=ks=null,ui!==null){for(t=0;t<ui.length;t++)if(r=ui[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var s=o.next;o.next=i,n.next=s}r.pending=n}ui=null}return e}function _C(e,t){do{var r=it;try{if(ax(),fl.current=$l,ql){for(var n=Qe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}ql=!1}if(_i=0,ht=lt=Qe=null,_s=!1,Hs=0,bx.current=null,r===null||r.return===null){dt=1,Vs=t,it=null;break}e:{var o=e,s=r.return,a=r,c=t;if(t=wt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=w0(s);if(p!==null){p.flags&=-257,_0(p,s,a,o,t),p.mode&1&&b0(o,u,t),t=p,c=u;var y=t.updateQueue;if(y===null){var g=new Set;g.add(c),t.updateQueue=g}else y.add(c);break e}else{if(!(t&1)){b0(o,u,t),jx();break e}c=Error(K(426))}}else if(Be&&a.mode&1){var w=w0(s);if(w!==null){!(w.flags&65536)&&(w.flags|=256),_0(w,s,a,o,t),ox(bo(c,a));break e}}o=c=bo(c,a),dt!==4&&(dt=2),ks===null?ks=[o]:ks.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=oC(o,c,t);h0(o,v);break e;case 1:a=c;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qn===null||!qn.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var _=sC(o,a,t);h0(o,_);break e}}o=o.return}while(o!==null)}jC(r)}catch(j){t=j,it===r&&r!==null&&(it=r=r.return);continue}break}while(!0)}function SC(){var e=Bl.current;return Bl.current=$l,e===null?$l:e}function jx(){(dt===0||dt===3||dt===2)&&(dt=4),gt===null||!(Si&268435455)&&!(Ec&268435455)||En(gt,wt)}function Ul(e,t){var r=Re;Re|=2;var n=SC();(gt!==e||wt!==t)&&(Zr=null,mi(e,t));do try{E5();break}catch(i){_C(e,i)}while(!0);if(ax(),Re=r,Bl.current=n,it!==null)throw Error(K(261));return gt=null,wt=0,dt}function E5(){for(;it!==null;)kC(it)}function R5(){for(;it!==null&&!eA();)kC(it)}function kC(e){var t=NC(e.alternate,e,Xt);e.memoizedProps=e.pendingProps,t===null?jC(e):it=t,bx.current=null}function jC(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=_5(r,t),r!==null){r.flags&=32767,it=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{dt=6,it=null;return}}else if(r=w5(r,t,Xt),r!==null){it=r;return}if(t=t.sibling,t!==null){it=t;return}it=t=e}while(t!==null);dt===0&&(dt=5)}function ai(e,t,r){var n=Pe,i=dr.transition;try{dr.transition=null,Pe=1,T5(e,t,r,n)}finally{dr.transition=i,Pe=n}return null}function T5(e,t,r,n){do co();while(Pn!==null);if(Re&6)throw Error(K(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(K(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(uA(e,o),e===gt&&(it=gt=null,wt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||qa||(qa=!0,EC(Cl,function(){return co(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=dr.transition,dr.transition=null;var s=Pe;Pe=1;var a=Re;Re|=4,bx.current=null,k5(e,r),yC(r,e),XA(Lg),El=!!Dg,Lg=Dg=null,e.current=r,j5(r),tA(),Re=a,Pe=s,dr.transition=o}else e.current=r;if(qa&&(qa=!1,Pn=e,Wl=i),o=e.pendingLanes,o===0&&(qn=null),iA(r.stateNode),Wt(e,nt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=nv,nv=null,e;return Wl&1&&e.tag!==0&&co(),o=e.pendingLanes,o&1?e===iv?js++:(js=0,iv=e):js=0,Jn(),null}function co(){if(Pn!==null){var e=oj(Wl),t=dr.transition,r=Pe;try{if(dr.transition=null,Pe=16>e?16:e,Pn===null)var n=!1;else{if(e=Pn,Pn=null,Wl=0,Re&6)throw Error(K(331));var i=Re;for(Re|=4,J=e.current;J!==null;){var o=J,s=o.child;if(J.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(J=u;J!==null;){var d=J;switch(d.tag){case 0:case 11:case 15:Ss(8,d,o)}var f=d.child;if(f!==null)f.return=d,J=f;else for(;J!==null;){d=J;var h=d.sibling,p=d.return;if(gC(d),d===u){J=null;break}if(h!==null){h.return=p,J=h;break}J=p}}}var y=o.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}J=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,J=s;else e:for(;J!==null;){if(o=J,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ss(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,J=v;break e}J=o.return}}var x=e.current;for(J=x;J!==null;){s=J;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,J=b;else e:for(s=x;J!==null;){if(a=J,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Nc(9,a)}}catch(j){tt(a,a.return,j)}if(a===s){J=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,J=_;break e}J=a.return}}if(Re=i,Jn(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(yc,e)}catch{}n=!0}return n}finally{Pe=r,dr.transition=t}}return!1}function O0(e,t,r){t=bo(r,t),t=oC(e,t,1),e=zn(e,t,1),t=Mt(),e!==null&&(ca(e,1,t),Wt(e,t))}function tt(e,t,r){if(e.tag===3)O0(e,e,r);else for(;t!==null;){if(t.tag===3){O0(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qn===null||!qn.has(n))){e=bo(r,e),e=sC(t,e,1),t=zn(t,e,1),e=Mt(),t!==null&&(ca(t,1,e),Wt(t,e));break}}t=t.return}}function A5(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Mt(),e.pingedLanes|=e.suspendedLanes&r,gt===e&&(wt&r)===r&&(dt===4||dt===3&&(wt&130023424)===wt&&500>nt()-_x?mi(e,0):wx|=r),Wt(e,t)}function CC(e,t){t===0&&(e.mode&1?(t=Ta,Ta<<=1,!(Ta&130023424)&&(Ta=4194304)):t=1);var r=Mt();e=un(e,t),e!==null&&(ca(e,t,r),Wt(e,r))}function I5(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),CC(e,r)}function M5(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(K(314))}n!==null&&n.delete(t),CC(e,r)}var NC;NC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Bt.current)zt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return zt=!1,b5(e,t,r);zt=!!(e.flags&131072)}else zt=!1,Be&&t.flags&1048576&&Aj(t,Ol,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;hl(e,t),e=t.pendingProps;var i=go(t,Nt.current);lo(t,r),i=mx(null,t,n,e,i,r);var o=gx();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ht(n)?(o=!0,Ml(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ux(t),i.updater=Cc,t.stateNode=i,i._reactInternals=t,Vg(t,n,e,r),t=Kg(null,t,n,!0,o,r)):(t.tag=0,Be&&o&&nx(t),At(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(hl(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=O5(n),e=wr(n,e),i){case 0:t=Yg(null,t,n,e,r);break e;case 1:t=j0(null,t,n,e,r);break e;case 11:t=S0(null,t,n,e,r);break e;case 14:t=k0(null,t,n,wr(n.type,e),r);break e}throw Error(K(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),Yg(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),j0(e,t,n,i,r);case 3:e:{if(uC(t),e===null)throw Error(K(387));n=t.pendingProps,o=t.memoizedState,i=o.element,Lj(e,t),Fl(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=bo(Error(K(423)),t),t=C0(e,t,n,r,i);break e}else if(n!==i){i=bo(Error(K(424)),t),t=C0(e,t,n,r,i);break e}else for(Zt=Fn(t.stateNode.containerInfo.firstChild),Jt=t,Be=!0,kr=null,r=Oj(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vo(),n===i){t=dn(e,t,r);break e}At(e,t,n,r)}t=t.child}return t;case 5:return Fj(t),e===null&&Hg(t),n=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,Fg(n,i)?s=null:o!==null&&Fg(n,o)&&(t.flags|=32),cC(e,t),At(e,t,s,r),t.child;case 6:return e===null&&Hg(t),null;case 13:return dC(e,t,r);case 4:return dx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=xo(t,null,n,r):At(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),S0(e,t,n,i,r);case 7:return At(e,t,t.pendingProps,r),t.child;case 8:return At(e,t,t.pendingProps.children,r),t.child;case 12:return At(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,De(Dl,n._currentValue),n._currentValue=s,o!==null)if(Er(o.value,s)){if(o.children===i.children&&!Bt.current){t=dn(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=sn(-1,r&-r),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),Wg(o.return,r,t),a.lanes|=r;break}c=c.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(K(341));s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),Wg(s,r,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}At(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,lo(t,r),i=fr(i),n=n(i),t.flags|=1,At(e,t,n,r),t.child;case 14:return n=t.type,i=wr(n,t.pendingProps),i=wr(n.type,i),k0(e,t,n,i,r);case 15:return aC(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),hl(e,t),t.tag=1,Ht(n)?(e=!0,Ml(t)):e=!1,lo(t,r),iC(t,n,i),Vg(t,n,i,r),Kg(null,t,n,!0,e,r);case 19:return fC(e,t,r);case 22:return lC(e,t,r)}throw Error(K(156,t.tag))};function EC(e,t){return tj(e,t)}function P5(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(e,t,r,n){return new P5(e,t,r,n)}function Cx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function O5(e){if(typeof e=="function")return Cx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Uv)return 11;if(e===Vv)return 14}return 2}function Bn(e,t){var r=e.alternate;return r===null?(r=cr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function vl(e,t,r,n,i,o){var s=2;if(n=e,typeof e=="function")Cx(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Hi:return gi(r.children,i,o,t);case Wv:s=8,i|=8;break;case gg:return e=cr(12,r,t,i|2),e.elementType=gg,e.lanes=o,e;case vg:return e=cr(13,r,t,i),e.elementType=vg,e.lanes=o,e;case xg:return e=cr(19,r,t,i),e.elementType=xg,e.lanes=o,e;case Fk:return Rc(r,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Dk:s=10;break e;case Lk:s=9;break e;case Uv:s=11;break e;case Vv:s=14;break e;case _n:s=16,n=null;break e}throw Error(K(130,e==null?e:typeof e,""))}return t=cr(s,r,t,i),t.elementType=e,t.type=n,t.lanes=o,t}function gi(e,t,r,n){return e=cr(7,e,n,t),e.lanes=r,e}function Rc(e,t,r,n){return e=cr(22,e,n,t),e.elementType=Fk,e.lanes=r,e.stateNode={isHidden:!1},e}function Hu(e,t,r){return e=cr(6,e,null,t),e.lanes=r,e}function Wu(e,t,r){return t=cr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function D5(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ku(0),this.expirationTimes=ku(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ku(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Nx(e,t,r,n,i,o,s,a,c){return e=new D5(e,t,r,a,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=cr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ux(o),e}function L5(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function RC(e){if(!e)return Yn;e=e._reactInternals;e:{if(Ei(e)!==e||e.tag!==1)throw Error(K(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(K(171))}if(e.tag===1){var r=e.type;if(Ht(r))return Rj(e,r,t)}return t}function TC(e,t,r,n,i,o,s,a,c){return e=Nx(r,n,!0,e,i,o,s,a,c),e.context=RC(null),r=e.current,n=Mt(),i=$n(r),o=sn(n,i),o.callback=t??null,zn(r,o,i),e.current.lanes=i,ca(e,i,n),Wt(e,n),e}function Tc(e,t,r,n){var i=t.current,o=Mt(),s=$n(i);return r=RC(r),t.context===null?t.context=r:t.pendingContext=r,t=sn(o,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=zn(i,t,s),e!==null&&(Nr(e,i,s,o),dl(e,i,s)),s}function Vl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function D0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ex(e,t){D0(e,t),(e=e.alternate)&&D0(e,t)}function F5(){return null}var AC=typeof reportError=="function"?reportError:function(e){console.error(e)};function Rx(e){this._internalRoot=e}Ac.prototype.render=Rx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(K(409));Tc(e,t,null,null)};Ac.prototype.unmount=Rx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ki(function(){Tc(null,e,null,null)}),t[cn]=null}};function Ac(e){this._internalRoot=e}Ac.prototype.unstable_scheduleHydration=function(e){if(e){var t=lj();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Nn.length&&t!==0&&t<Nn[r].priority;r++);Nn.splice(r,0,e),r===0&&uj(e)}};function Tx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ic(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function L0(){}function z5(e,t,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var u=Vl(s);o.call(u)}}var s=TC(t,n,e,0,null,!1,!1,"",L0);return e._reactRootContainer=s,e[cn]=s.current,Fs(e.nodeType===8?e.parentNode:e),ki(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=Vl(c);a.call(u)}}var c=Nx(e,0,!1,null,null,!1,!1,"",L0);return e._reactRootContainer=c,e[cn]=c.current,Fs(e.nodeType===8?e.parentNode:e),ki(function(){Tc(t,c,r,n)}),c}function Mc(e,t,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var c=Vl(s);a.call(c)}}Tc(t,s,e,i)}else s=z5(r,t,e,i,n);return Vl(s)}sj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ss(t.pendingLanes);r!==0&&(Kv(t,r|1),Wt(t,nt()),!(Re&6)&&(wo=nt()+500,Jn()))}break;case 13:ki(function(){var n=un(e,1);if(n!==null){var i=Mt();Nr(n,e,1,i)}}),Ex(e,1)}};Xv=function(e){if(e.tag===13){var t=un(e,134217728);if(t!==null){var r=Mt();Nr(t,e,134217728,r)}Ex(e,134217728)}};aj=function(e){if(e.tag===13){var t=$n(e),r=un(e,t);if(r!==null){var n=Mt();Nr(r,e,t,n)}Ex(e,t)}};lj=function(){return Pe};cj=function(e,t){var r=Pe;try{return Pe=e,t()}finally{Pe=r}};Eg=function(e,t,r){switch(t){case"input":if(wg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Sc(n);if(!i)throw Error(K(90));qk(n),wg(n,i)}}}break;case"textarea":Bk(e,r);break;case"select":t=r.value,t!=null&&io(e,!!r.multiple,t,!1)}};Kk=Sx;Xk=ki;var q5={usingClientEntryPoint:!1,Events:[da,Gi,Sc,Gk,Yk,Sx]},Yo={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$5={bundleType:Yo.bundleType,version:Yo.version,rendererPackageName:Yo.rendererPackageName,rendererConfig:Yo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Jk(e),e===null?null:e.stateNode},findFiberByHostInstance:Yo.findFiberByHostInstance||F5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$a.isDisabled&&$a.supportsFiber)try{yc=$a.inject($5),qr=$a}catch{}}rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q5;rr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tx(t))throw Error(K(200));return L5(e,t,null,r)};rr.createRoot=function(e,t){if(!Tx(e))throw Error(K(299));var r=!1,n="",i=AC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Nx(e,1,!1,null,null,r,!1,n,i),e[cn]=t.current,Fs(e.nodeType===8?e.parentNode:e),new Rx(t)};rr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(K(188)):(e=Object.keys(e).join(","),Error(K(268,e)));return e=Jk(t),e=e===null?null:e.stateNode,e};rr.flushSync=function(e){return ki(e)};rr.hydrate=function(e,t,r){if(!Ic(t))throw Error(K(200));return Mc(null,e,t,!0,r)};rr.hydrateRoot=function(e,t,r){if(!Tx(e))throw Error(K(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",s=AC;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=TC(t,null,e,1,r??null,i,!1,o,s),e[cn]=t.current,Fs(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Ac(t)};rr.render=function(e,t,r){if(!Ic(t))throw Error(K(200));return Mc(null,e,t,!1,r)};rr.unmountComponentAtNode=function(e){if(!Ic(e))throw Error(K(40));return e._reactRootContainer?(ki(function(){Mc(null,null,e,!1,function(){e._reactRootContainer=null,e[cn]=null})}),!0):!1};rr.unstable_batchedUpdates=Sx;rr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ic(r))throw Error(K(200));if(e==null||e._reactInternals===void 0)throw Error(K(38));return Mc(e,t,r,!1,n)};rr.version="18.3.1-next-f1338f8080-20240426";function IC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IC)}catch(e){console.error(e)}}IC(),Ik.exports=rr;var eo=Ik.exports,F0=eo;hg.createRoot=F0.createRoot,hg.hydrateRoot=F0.hydrateRoot;function Vt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Vt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var MC={exports:{}},PC={},OC={exports:{}},DC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _o=m;function B5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var H5=typeof Object.is=="function"?Object.is:B5,W5=_o.useState,U5=_o.useEffect,V5=_o.useLayoutEffect,G5=_o.useDebugValue;function Y5(e,t){var r=t(),n=W5({inst:{value:r,getSnapshot:t}}),i=n[0].inst,o=n[1];return V5(function(){i.value=r,i.getSnapshot=t,Uu(i)&&o({inst:i})},[e,r,t]),U5(function(){return Uu(i)&&o({inst:i}),e(function(){Uu(i)&&o({inst:i})})},[e]),G5(r),r}function Uu(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!H5(e,r)}catch{return!0}}function K5(e,t){return t()}var X5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?K5:Y5;DC.useSyncExternalStore=_o.useSyncExternalStore!==void 0?_o.useSyncExternalStore:X5;OC.exports=DC;var Q5=OC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pc=m,Z5=Q5;function J5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var e3=typeof Object.is=="function"?Object.is:J5,t3=Z5.useSyncExternalStore,r3=Pc.useRef,n3=Pc.useEffect,i3=Pc.useMemo,o3=Pc.useDebugValue;PC.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var o=r3(null);if(o.current===null){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=i3(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&s.hasValue){var y=s.value;if(i(y,p))return f=y}return f=p}if(y=f,e3(d,p))return y;var g=n(p);return i!==void 0&&i(y,g)?(d=p,y):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var a=t3(e,o[0],o[1]);return n3(function(){s.hasValue=!0,s.value=a},[a]),o3(a),a};MC.exports=PC;var s3=MC.exports;const a3=Dv(s3),l3={},z0=e=>{let t;const r=new Set,n=(d,f)=>{const h=typeof d=="function"?d(t):d;if(!Object.is(h,t)){const p=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(y=>y(t,p))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(l3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,i,c);return c},c3=e=>e?z0(e):z0,{useDebugValue:u3}=W,{useSyncExternalStoreWithSelector:d3}=a3,f3=e=>e;function LC(e,t=f3,r){const n=d3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return u3(n),n}const q0=(e,t)=>{const r=c3(e),n=(i,o=t)=>LC(r,i,o);return Object.assign(n,r),n},p3=(e,t)=>e?q0(e,t):q0;function Et(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var h3={value:()=>{}};function Oc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new xl(r)}function xl(e){this._=e}function m3(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}xl.prototype=Oc.prototype={constructor:xl,on:function(e,t){var r=this._,n=m3(e+"",r),i,o=-1,s=n.length;if(arguments.length<2){for(;++o<s;)if((i=(e=n[o]).type)&&(i=g3(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=n[o]).type)r[i]=$0(r[i],e.name,t);else if(t==null)for(i in r)r[i]=$0(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new xl(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,o;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,i=o.length;n<i;++n)o[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,o=n.length;i<o;++i)n[i].value.apply(t,r)}};function g3(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function $0(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=h3,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var av="http://www.w3.org/1999/xhtml";const B0={svg:"http://www.w3.org/2000/svg",xhtml:av,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Dc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),B0.hasOwnProperty(t)?{space:B0[t],local:e}:e}function v3(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===av&&t.documentElement.namespaceURI===av?t.createElement(e):t.createElementNS(r,e)}}function x3(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function FC(e){var t=Dc(e);return(t.local?x3:v3)(t)}function y3(){}function Ax(e){return e==null?y3:function(){return this.querySelector(e)}}function b3(e){typeof e!="function"&&(e=Ax(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=new Array(s),c,u,d=0;d<s;++d)(c=o[d])&&(u=e.call(c,c.__data__,d,o))&&("__data__"in c&&(u.__data__=c.__data__),a[d]=u);return new tr(n,this._parents)}function w3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function _3(){return[]}function zC(e){return e==null?_3:function(){return this.querySelectorAll(e)}}function S3(e){return function(){return w3(e.apply(this,arguments))}}function k3(e){typeof e=="function"?e=S3(e):e=zC(e);for(var t=this._groups,r=t.length,n=[],i=[],o=0;o<r;++o)for(var s=t[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(n.push(e.call(c,c.__data__,u,s)),i.push(c));return new tr(n,i)}function qC(e){return function(){return this.matches(e)}}function $C(e){return function(t){return t.matches(e)}}var j3=Array.prototype.find;function C3(e){return function(){return j3.call(this.children,e)}}function N3(){return this.firstElementChild}function E3(e){return this.select(e==null?N3:C3(typeof e=="function"?e:$C(e)))}var R3=Array.prototype.filter;function T3(){return Array.from(this.children)}function A3(e){return function(){return R3.call(this.children,e)}}function I3(e){return this.selectAll(e==null?T3:A3(typeof e=="function"?e:$C(e)))}function M3(e){typeof e!="function"&&(e=qC(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=[],c,u=0;u<s;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&a.push(c);return new tr(n,this._parents)}function BC(e){return new Array(e.length)}function P3(){return new tr(this._enter||this._groups.map(BC),this._parents)}function Gl(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Gl.prototype={constructor:Gl,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function O3(e){return function(){return e}}function D3(e,t,r,n,i,o){for(var s=0,a,c=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],n[s]=a):r[s]=new Gl(e,o[s]);for(;s<c;++s)(a=t[s])&&(i[s]=a)}function L3(e,t,r,n,i,o,s){var a,c,u=new Map,d=t.length,f=o.length,h=new Array(d),p;for(a=0;a<d;++a)(c=t[a])&&(h[a]=p=s.call(c,c.__data__,a,t)+"",u.has(p)?i[a]=c:u.set(p,c));for(a=0;a<f;++a)p=s.call(e,o[a],a,o)+"",(c=u.get(p))?(n[a]=c,c.__data__=o[a],u.delete(p)):r[a]=new Gl(e,o[a]);for(a=0;a<d;++a)(c=t[a])&&u.get(h[a])===c&&(i[a]=c)}function F3(e){return e.__data__}function z3(e,t){if(!arguments.length)return Array.from(this,F3);var r=t?L3:D3,n=this._parents,i=this._groups;typeof e!="function"&&(e=O3(e));for(var o=i.length,s=new Array(o),a=new Array(o),c=new Array(o),u=0;u<o;++u){var d=n[u],f=i[u],h=f.length,p=q3(e.call(d,d&&d.__data__,u,n)),y=p.length,g=a[u]=new Array(y),w=s[u]=new Array(y),v=c[u]=new Array(h);r(d,f,g,w,v,p,t);for(var x=0,b=0,_,j;x<y;++x)if(_=g[x]){for(x>=b&&(b=x+1);!(j=w[b])&&++b<y;);_._next=j||null}}return s=new tr(s,n),s._enter=a,s._exit=c,s}function q3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function $3(){return new tr(this._exit||this._groups.map(BC),this._parents)}function B3(e,t,r){var n=this.enter(),i=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?o.remove():r(o),n&&i?n.merge(i).order():i}function H3(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,o=n.length,s=Math.min(i,o),a=new Array(i),c=0;c<s;++c)for(var u=r[c],d=n[c],f=u.length,h=a[c]=new Array(f),p,y=0;y<f;++y)(p=u[y]||d[y])&&(h[y]=p);for(;c<i;++c)a[c]=r[c];return new tr(a,this._parents)}function W3(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,o=n[i],s;--i>=0;)(s=n[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function U3(e){e||(e=V3);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var s=r[o],a=s.length,c=i[o]=new Array(a),u,d=0;d<a;++d)(u=s[d])&&(c[d]=u);c.sort(t)}return new tr(i,this._parents).order()}function V3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function G3(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Y3(){return Array.from(this)}function K3(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length;i<o;++i){var s=n[i];if(s)return s}return null}function X3(){let e=0;for(const t of this)++e;return e}function Q3(){return!this.node()}function Z3(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}function J3(e){return function(){this.removeAttribute(e)}}function eI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tI(e,t){return function(){this.setAttribute(e,t)}}function rI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function nI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function iI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function oI(e,t){var r=Dc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?eI:J3:typeof t=="function"?r.local?iI:nI:r.local?rI:tI)(r,t))}function HC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function sI(e){return function(){this.style.removeProperty(e)}}function aI(e,t,r){return function(){this.style.setProperty(e,t,r)}}function lI(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function cI(e,t,r){return arguments.length>1?this.each((t==null?sI:typeof t=="function"?lI:aI)(e,t,r??"")):So(this.node(),e)}function So(e,t){return e.style.getPropertyValue(t)||HC(e).getComputedStyle(e,null).getPropertyValue(t)}function uI(e){return function(){delete this[e]}}function dI(e,t){return function(){this[e]=t}}function fI(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function pI(e,t){return arguments.length>1?this.each((t==null?uI:typeof t=="function"?fI:dI)(e,t)):this.node()[e]}function WC(e){return e.trim().split(/^|\s+/)}function Ix(e){return e.classList||new UC(e)}function UC(e){this._node=e,this._names=WC(e.getAttribute("class")||"")}UC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function VC(e,t){for(var r=Ix(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function GC(e,t){for(var r=Ix(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function hI(e){return function(){VC(this,e)}}function mI(e){return function(){GC(this,e)}}function gI(e,t){return function(){(t.apply(this,arguments)?VC:GC)(this,e)}}function vI(e,t){var r=WC(e+"");if(arguments.length<2){for(var n=Ix(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?gI:t?hI:mI)(r,t))}function xI(){this.textContent=""}function yI(e){return function(){this.textContent=e}}function bI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function wI(e){return arguments.length?this.each(e==null?xI:(typeof e=="function"?bI:yI)(e)):this.node().textContent}function _I(){this.innerHTML=""}function SI(e){return function(){this.innerHTML=e}}function kI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function jI(e){return arguments.length?this.each(e==null?_I:(typeof e=="function"?kI:SI)(e)):this.node().innerHTML}function CI(){this.nextSibling&&this.parentNode.appendChild(this)}function NI(){return this.each(CI)}function EI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function RI(){return this.each(EI)}function TI(e){var t=typeof e=="function"?e:FC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function AI(){return null}function II(e,t){var r=typeof e=="function"?e:FC(e),n=t==null?AI:typeof t=="function"?t:Ax(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function MI(){var e=this.parentNode;e&&e.removeChild(this)}function PI(){return this.each(MI)}function OI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function DI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function LI(e){return this.select(e?DI:OI)}function FI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function zI(e){return function(t){e.call(this,t,this.__data__)}}function qI(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function $I(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,o;r<i;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function BI(e,t,r){return function(){var n=this.__on,i,o=zI(t);if(n){for(var s=0,a=n.length;s<a;++s)if((i=n[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=r),i.value=t;return}}this.addEventListener(e.type,o,r),i={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(i):this.__on=[i]}}function HI(e,t,r){var n=qI(e+""),i,o=n.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,d;c<u;++c)for(i=0,d=a[c];i<o;++i)if((s=n[i]).type===d.type&&s.name===d.name)return d.value}return}for(a=t?BI:$I,i=0;i<o;++i)this.each(a(n[i],t,r));return this}function YC(e,t,r){var n=HC(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function WI(e,t){return function(){return YC(this,e,t)}}function UI(e,t){return function(){return YC(this,e,t.apply(this,arguments))}}function VI(e,t){return this.each((typeof t=="function"?UI:WI)(e,t))}function*GI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length,s;i<o;++i)(s=n[i])&&(yield s)}var KC=[null];function tr(e,t){this._groups=e,this._parents=t}function pa(){return new tr([[document.documentElement]],KC)}function YI(){return this}tr.prototype=pa.prototype={constructor:tr,select:b3,selectAll:k3,selectChild:E3,selectChildren:I3,filter:M3,data:z3,enter:P3,exit:$3,join:B3,merge:H3,selection:YI,order:W3,sort:U3,call:G3,nodes:Y3,node:K3,size:X3,empty:Q3,each:Z3,attr:oI,style:cI,property:pI,classed:vI,text:wI,html:jI,raise:NI,lower:RI,append:TI,insert:II,remove:PI,clone:LI,datum:FI,on:HI,dispatch:VI,[Symbol.iterator]:GI};function lr(e){return typeof e=="string"?new tr([[document.querySelector(e)]],[document.documentElement]):new tr([[e]],KC)}function KI(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Sr(e,t){if(e=KI(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const XI={passive:!1},Gs={capture:!0,passive:!1};function Vu(e){e.stopImmediatePropagation()}function uo(e){e.preventDefault(),e.stopImmediatePropagation()}function XC(e){var t=e.document.documentElement,r=lr(e).on("dragstart.drag",uo,Gs);"onselectstart"in t?r.on("selectstart.drag",uo,Gs):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function QC(e,t){var r=e.document.documentElement,n=lr(e).on("dragstart.drag",null);t&&(n.on("click.drag",uo,Gs),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Ba=e=>()=>e;function lv(e,{sourceEvent:t,subject:r,target:n,identifier:i,active:o,x:s,y:a,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}lv.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function QI(e){return!e.ctrlKey&&!e.button}function ZI(){return this.parentNode}function JI(e,t){return t??{x:e.x,y:e.y}}function eM(){return navigator.maxTouchPoints||"ontouchstart"in this}function tM(){var e=QI,t=ZI,r=JI,n=eM,i={},o=Oc("start","drag","end"),s=0,a,c,u,d,f=0;function h(_){_.on("mousedown.drag",p).filter(n).on("touchstart.drag",w).on("touchmove.drag",v,XI).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(_,j){if(!(d||!e.call(this,_,j))){var k=b(this,t.call(this,_,j),_,j,"mouse");k&&(lr(_.view).on("mousemove.drag",y,Gs).on("mouseup.drag",g,Gs),XC(_.view),Vu(_),u=!1,a=_.clientX,c=_.clientY,k("start",_))}}function y(_){if(uo(_),!u){var j=_.clientX-a,k=_.clientY-c;u=j*j+k*k>f}i.mouse("drag",_)}function g(_){lr(_.view).on("mousemove.drag mouseup.drag",null),QC(_.view,u),uo(_),i.mouse("end",_)}function w(_,j){if(e.call(this,_,j)){var k=_.changedTouches,N=t.call(this,_,j),E=k.length,C,T;for(C=0;C<E;++C)(T=b(this,N,_,j,k[C].identifier,k[C]))&&(Vu(_),T("start",_,k[C]))}}function v(_){var j=_.changedTouches,k=j.length,N,E;for(N=0;N<k;++N)(E=i[j[N].identifier])&&(uo(_),E("drag",_,j[N]))}function x(_){var j=_.changedTouches,k=j.length,N,E;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),N=0;N<k;++N)(E=i[j[N].identifier])&&(Vu(_),E("end",_,j[N]))}function b(_,j,k,N,E,C){var T=o.copy(),R=Sr(C||k,j),P,F,S;if((S=r.call(_,new lv("beforestart",{sourceEvent:k,target:h,identifier:E,active:s,x:R[0],y:R[1],dx:0,dy:0,dispatch:T}),N))!=null)return P=S.x-R[0]||0,F=S.y-R[1]||0,function A(M,z,D){var I=R,L;switch(M){case"start":i[E]=A,L=s++;break;case"end":delete i[E],--s;case"drag":R=Sr(D||z,j),L=s;break}T.call(M,_,new lv(M,{sourceEvent:z,subject:S,target:h,identifier:E,active:L,x:R[0]+P,y:R[1]+F,dx:R[0]-I[0],dy:R[1]-I[1],dispatch:T}),N)}}return h.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Ba(!!_),h):e},h.container=function(_){return arguments.length?(t=typeof _=="function"?_:Ba(_),h):t},h.subject=function(_){return arguments.length?(r=typeof _=="function"?_:Ba(_),h):r},h.touchable=function(_){return arguments.length?(n=typeof _=="function"?_:Ba(!!_),h):n},h.on=function(){var _=o.on.apply(o,arguments);return _===o?h:_},h.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,h):Math.sqrt(f)},h}function Mx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function ZC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ha(){}var Ys=.7,Yl=1/Ys,fo="\\s*([+-]?\\d+)\\s*",Ks="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Br="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rM=/^#([0-9a-f]{3,8})$/,nM=new RegExp(`^rgb\\(${fo},${fo},${fo}\\)$`),iM=new RegExp(`^rgb\\(${Br},${Br},${Br}\\)$`),oM=new RegExp(`^rgba\\(${fo},${fo},${fo},${Ks}\\)$`),sM=new RegExp(`^rgba\\(${Br},${Br},${Br},${Ks}\\)$`),aM=new RegExp(`^hsl\\(${Ks},${Br},${Br}\\)$`),lM=new RegExp(`^hsla\\(${Ks},${Br},${Br},${Ks}\\)$`),H0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Mx(ha,Xs,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:W0,formatHex:W0,formatHex8:cM,formatHsl:uM,formatRgb:U0,toString:U0});function W0(){return this.rgb().formatHex()}function cM(){return this.rgb().formatHex8()}function uM(){return JC(this).formatHsl()}function U0(){return this.rgb().formatRgb()}function Xs(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=rM.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?V0(t):r===3?new qt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ha(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ha(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=nM.exec(e))?new qt(t[1],t[2],t[3],1):(t=iM.exec(e))?new qt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=oM.exec(e))?Ha(t[1],t[2],t[3],t[4]):(t=sM.exec(e))?Ha(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=aM.exec(e))?K0(t[1],t[2]/100,t[3]/100,1):(t=lM.exec(e))?K0(t[1],t[2]/100,t[3]/100,t[4]):H0.hasOwnProperty(e)?V0(H0[e]):e==="transparent"?new qt(NaN,NaN,NaN,0):null}function V0(e){return new qt(e>>16&255,e>>8&255,e&255,1)}function Ha(e,t,r,n){return n<=0&&(e=t=r=NaN),new qt(e,t,r,n)}function dM(e){return e instanceof ha||(e=Xs(e)),e?(e=e.rgb(),new qt(e.r,e.g,e.b,e.opacity)):new qt}function cv(e,t,r,n){return arguments.length===1?dM(e):new qt(e,t,r,n??1)}function qt(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Mx(qt,cv,ZC(ha,{brighter(e){return e=e==null?Yl:Math.pow(Yl,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ys:Math.pow(Ys,e),new qt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new qt(vi(this.r),vi(this.g),vi(this.b),Kl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:G0,formatHex:G0,formatHex8:fM,formatRgb:Y0,toString:Y0}));function G0(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function fM(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Y0(){const e=Kl(this.opacity);return`${e===1?"rgb(":"rgba("}${vi(this.r)}, ${vi(this.g)}, ${vi(this.b)}${e===1?")":`, ${e})`}`}function Kl(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fi(e){return e=vi(e),(e<16?"0":"")+e.toString(16)}function K0(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new jr(e,t,r,n)}function JC(e){if(e instanceof jr)return new jr(e.h,e.s,e.l,e.opacity);if(e instanceof ha||(e=Xs(e)),!e)return new jr;if(e instanceof jr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),s=NaN,a=o-i,c=(o+i)/2;return a?(t===o?s=(r-n)/a+(r<n)*6:r===o?s=(n-t)/a+2:s=(t-r)/a+4,a/=c<.5?o+i:2-o-i,s*=60):a=c>0&&c<1?0:s,new jr(s,a,c,e.opacity)}function pM(e,t,r,n){return arguments.length===1?JC(e):new jr(e,t,r,n??1)}function jr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Mx(jr,pM,ZC(ha,{brighter(e){return e=e==null?Yl:Math.pow(Yl,e),new jr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ys:Math.pow(Ys,e),new jr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new qt(Gu(e>=240?e-240:e+120,i,n),Gu(e,i,n),Gu(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new jr(X0(this.h),Wa(this.s),Wa(this.l),Kl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Kl(this.opacity);return`${e===1?"hsl(":"hsla("}${X0(this.h)}, ${Wa(this.s)*100}%, ${Wa(this.l)*100}%${e===1?")":`, ${e})`}`}}));function X0(e){return e=(e||0)%360,e<0?e+360:e}function Wa(e){return Math.max(0,Math.min(1,e||0))}function Gu(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const eN=e=>()=>e;function hM(e,t){return function(r){return e+r*t}}function mM(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function gM(e){return(e=+e)==1?tN:function(t,r){return r-t?mM(t,r,e):eN(isNaN(t)?r:t)}}function tN(e,t){var r=t-e;return r?hM(e,r):eN(isNaN(e)?t:e)}const Q0=function e(t){var r=gM(t);function n(i,o){var s=r((i=cv(i)).r,(o=cv(o)).r),a=r(i.g,o.g),c=r(i.b,o.b),u=tN(i.opacity,o.opacity);return function(d){return i.r=s(d),i.g=a(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function kn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var uv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yu=new RegExp(uv.source,"g");function vM(e){return function(){return e}}function xM(e){return function(t){return e(t)+""}}function yM(e,t){var r=uv.lastIndex=Yu.lastIndex=0,n,i,o,s=-1,a=[],c=[];for(e=e+"",t=t+"";(n=uv.exec(e))&&(i=Yu.exec(t));)(o=i.index)>r&&(o=t.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,c.push({i:s,x:kn(n,i)})),r=Yu.lastIndex;return r<t.length&&(o=t.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?c[0]?xM(c[0].x):vM(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)a[(f=c[d]).i]=f.x(u);return a.join("")})}var Z0=180/Math.PI,dv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function rN(e,t,r,n,i,o){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,c/=a),e*n<t*r&&(e=-e,t=-t,c=-c,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Z0,skewX:Math.atan(c)*Z0,scaleX:s,scaleY:a}}var Ua;function bM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?dv:rN(t.a,t.b,t.c,t.d,t.e,t.f)}function wM(e){return e==null||(Ua||(Ua=document.createElementNS("http://www.w3.org/2000/svg","g")),Ua.setAttribute("transform",e),!(e=Ua.transform.baseVal.consolidate()))?dv:(e=e.matrix,rN(e.a,e.b,e.c,e.d,e.e,e.f))}function nN(e,t,r,n){function i(u){return u.length?u.pop()+" ":""}function o(u,d,f,h,p,y){if(u!==f||d!==h){var g=p.push("translate(",null,t,null,r);y.push({i:g-4,x:kn(u,f)},{i:g-2,x:kn(d,h)})}else(f||h)&&p.push("translate("+f+t+h+r)}function s(u,d,f,h){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,n)-2,x:kn(u,d)})):d&&f.push(i(f)+"rotate("+d+n)}function a(u,d,f,h){u!==d?h.push({i:f.push(i(f)+"skewX(",null,n)-2,x:kn(u,d)}):d&&f.push(i(f)+"skewX("+d+n)}function c(u,d,f,h,p,y){if(u!==f||d!==h){var g=p.push(i(p)+"scale(",null,",",null,")");y.push({i:g-4,x:kn(u,f)},{i:g-2,x:kn(d,h)})}else(f!==1||h!==1)&&p.push(i(p)+"scale("+f+","+h+")")}return function(u,d){var f=[],h=[];return u=e(u),d=e(d),o(u.translateX,u.translateY,d.translateX,d.translateY,f,h),s(u.rotate,d.rotate,f,h),a(u.skewX,d.skewX,f,h),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,h),u=d=null,function(p){for(var y=-1,g=h.length,w;++y<g;)f[(w=h[y]).i]=w.x(p);return f.join("")}}}var _M=nN(bM,"px, ","px)","deg)"),SM=nN(wM,", ",")",")"),kM=1e-12;function J0(e){return((e=Math.exp(e))+1/e)/2}function jM(e){return((e=Math.exp(e))-1/e)/2}function CM(e){return((e=Math.exp(2*e))-1)/(e+1)}const NM=function e(t,r,n){function i(o,s){var a=o[0],c=o[1],u=o[2],d=s[0],f=s[1],h=s[2],p=d-a,y=f-c,g=p*p+y*y,w,v;if(g<kM)v=Math.log(h/u)/t,w=function(N){return[a+N*p,c+N*y,u*Math.exp(t*N*v)]};else{var x=Math.sqrt(g),b=(h*h-u*u+n*g)/(2*u*r*x),_=(h*h-u*u-n*g)/(2*h*r*x),j=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(_*_+1)-_);v=(k-j)/t,w=function(N){var E=N*v,C=J0(j),T=u/(r*x)*(C*CM(t*E+j)-jM(j));return[a+T*p,c+T*y,u*C/J0(t*E+j)]}}return w.duration=v*1e3*t/Math.SQRT2,w}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,c=a*a;return e(s,a,c)},i}(Math.SQRT2,2,4);var ko=0,ls=0,Ko=0,iN=1e3,Xl,cs,Ql=0,ji=0,Lc=0,Qs=typeof performance=="object"&&performance.now?performance:Date,oN=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Px(){return ji||(oN(EM),ji=Qs.now()+Lc)}function EM(){ji=0}function Zl(){this._call=this._time=this._next=null}Zl.prototype=sN.prototype={constructor:Zl,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Px():+r)+(t==null?0:+t),!this._next&&cs!==this&&(cs?cs._next=this:Xl=this,cs=this),this._call=e,this._time=r,fv()},stop:function(){this._call&&(this._call=null,this._time=1/0,fv())}};function sN(e,t,r){var n=new Zl;return n.restart(e,t,r),n}function RM(){Px(),++ko;for(var e=Xl,t;e;)(t=ji-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ko}function eb(){ji=(Ql=Qs.now())+Lc,ko=ls=0;try{RM()}finally{ko=0,AM(),ji=0}}function TM(){var e=Qs.now(),t=e-Ql;t>iN&&(Lc-=t,Ql=e)}function AM(){for(var e,t=Xl,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Xl=r);cs=e,fv(n)}function fv(e){if(!ko){ls&&(ls=clearTimeout(ls));var t=e-ji;t>24?(e<1/0&&(ls=setTimeout(eb,e-Qs.now()-Lc)),Ko&&(Ko=clearInterval(Ko))):(Ko||(Ql=Qs.now(),Ko=setInterval(TM,iN)),ko=1,oN(eb))}}function tb(e,t,r){var n=new Zl;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var IM=Oc("start","end","cancel","interrupt"),MM=[],aN=0,rb=1,pv=2,yl=3,nb=4,hv=5,bl=6;function Fc(e,t,r,n,i,o){var s=e.__transition;if(!s)e.__transition={};else if(r in s)return;PM(e,r,{name:t,index:n,group:i,on:IM,tween:MM,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:aN})}function Ox(e,t){var r=Tr(e,t);if(r.state>aN)throw new Error("too late; already scheduled");return r}function Vr(e,t){var r=Tr(e,t);if(r.state>yl)throw new Error("too late; already running");return r}function Tr(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function PM(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=sN(o,0,r.time);function o(u){r.state=rb,r.timer.restart(s,r.delay,r.time),r.delay<=u&&s(u-r.delay)}function s(u){var d,f,h,p;if(r.state!==rb)return c();for(d in n)if(p=n[d],p.name===r.name){if(p.state===yl)return tb(s);p.state===nb?(p.state=bl,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete n[d]):+d<t&&(p.state=bl,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete n[d])}if(tb(function(){r.state===yl&&(r.state=nb,r.timer.restart(a,r.delay,r.time),a(u))}),r.state=pv,r.on.call("start",e,e.__data__,r.index,r.group),r.state===pv){for(r.state=yl,i=new Array(h=r.tween.length),d=0,f=-1;d<h;++d)(p=r.tween[d].value.call(e,e.__data__,r.index,r.group))&&(i[++f]=p);i.length=f+1}}function a(u){for(var d=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=hv,1),f=-1,h=i.length;++f<h;)i[f].call(e,d);r.state===hv&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=bl,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function wl(e,t){var r=e.__transition,n,i,o=!0,s;if(r){t=t==null?null:t+"";for(s in r){if((n=r[s]).name!==t){o=!1;continue}i=n.state>pv&&n.state<hv,n.state=bl,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[s]}o&&delete e.__transition}}function OM(e){return this.each(function(){wl(this,e)})}function DM(e,t){var r,n;return function(){var i=Vr(this,e),o=i.tween;if(o!==r){n=r=o;for(var s=0,a=n.length;s<a;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function LM(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var o=Vr(this,e),s=o.tween;if(s!==n){i=(n=s).slice();for(var a={name:t,value:r},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=a;break}c===u&&i.push(a)}o.tween=i}}function FM(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Tr(this.node(),r).tween,i=0,o=n.length,s;i<o;++i)if((s=n[i]).name===e)return s.value;return null}return this.each((t==null?DM:LM)(r,e,t))}function Dx(e,t,r){var n=e._id;return e.each(function(){var i=Vr(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return Tr(i,n).value[t]}}function lN(e,t){var r;return(typeof t=="number"?kn:t instanceof Xs?Q0:(r=Xs(t))?(t=r,Q0):yM)(e,t)}function zM(e){return function(){this.removeAttribute(e)}}function qM(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $M(e,t,r){var n,i=r+"",o;return function(){var s=this.getAttribute(e);return s===i?null:s===n?o:o=t(n=s,r)}}function BM(e,t,r){var n,i=r+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===n?o:o=t(n=s,r)}}function HM(e,t,r){var n,i,o;return function(){var s,a=r(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===n&&c===i?o:(i=c,o=t(n=s,a)))}}function WM(e,t,r){var n,i,o;return function(){var s,a=r(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===n&&c===i?o:(i=c,o=t(n=s,a)))}}function UM(e,t){var r=Dc(e),n=r==="transform"?SM:lN;return this.attrTween(e,typeof t=="function"?(r.local?WM:HM)(r,n,Dx(this,"attr."+e,t)):t==null?(r.local?qM:zM)(r):(r.local?BM:$M)(r,n,t))}function VM(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function GM(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function YM(e,t){var r,n;function i(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&GM(e,o)),r}return i._value=t,i}function KM(e,t){var r,n;function i(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&VM(e,o)),r}return i._value=t,i}function XM(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Dc(e);return this.tween(r,(n.local?YM:KM)(n,t))}function QM(e,t){return function(){Ox(this,e).delay=+t.apply(this,arguments)}}function ZM(e,t){return t=+t,function(){Ox(this,e).delay=t}}function JM(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?QM:ZM)(t,e)):Tr(this.node(),t).delay}function eP(e,t){return function(){Vr(this,e).duration=+t.apply(this,arguments)}}function tP(e,t){return t=+t,function(){Vr(this,e).duration=t}}function rP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?eP:tP)(t,e)):Tr(this.node(),t).duration}function nP(e,t){if(typeof t!="function")throw new Error;return function(){Vr(this,e).ease=t}}function iP(e){var t=this._id;return arguments.length?this.each(nP(t,e)):Tr(this.node(),t).ease}function oP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Vr(this,e).ease=r}}function sP(e){if(typeof e!="function")throw new Error;return this.each(oP(this._id,e))}function aP(e){typeof e!="function"&&(e=qC(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],s=o.length,a=n[i]=[],c,u=0;u<s;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&a.push(c);return new fn(n,this._parents,this._name,this._id)}function lP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,o=Math.min(n,i),s=new Array(n),a=0;a<o;++a)for(var c=t[a],u=r[a],d=c.length,f=s[a]=new Array(d),h,p=0;p<d;++p)(h=c[p]||u[p])&&(f[p]=h);for(;a<n;++a)s[a]=t[a];return new fn(s,this._parents,this._name,this._id)}function cP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function uP(e,t,r){var n,i,o=cP(t)?Ox:Vr;return function(){var s=o(this,e),a=s.on;a!==n&&(i=(n=a).copy()).on(t,r),s.on=i}}function dP(e,t){var r=this._id;return arguments.length<2?Tr(this.node(),r).on.on(e):this.each(uP(r,e,t))}function fP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function pP(){return this.on("end.remove",fP(this._id))}function hP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Ax(e));for(var n=this._groups,i=n.length,o=new Array(i),s=0;s<i;++s)for(var a=n[s],c=a.length,u=o[s]=new Array(c),d,f,h=0;h<c;++h)(d=a[h])&&(f=e.call(d,d.__data__,h,a))&&("__data__"in d&&(f.__data__=d.__data__),u[h]=f,Fc(u[h],t,r,h,u,Tr(d,r)));return new fn(o,this._parents,t,r)}function mP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=zC(e));for(var n=this._groups,i=n.length,o=[],s=[],a=0;a<i;++a)for(var c=n[a],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var h=e.call(d,d.__data__,f,c),p,y=Tr(d,r),g=0,w=h.length;g<w;++g)(p=h[g])&&Fc(p,t,r,g,h,y);o.push(h),s.push(d)}return new fn(o,s,t,r)}var gP=pa.prototype.constructor;function vP(){return new gP(this._groups,this._parents)}function xP(e,t){var r,n,i;return function(){var o=So(this,e),s=(this.style.removeProperty(e),So(this,e));return o===s?null:o===r&&s===n?i:i=t(r=o,n=s)}}function cN(e){return function(){this.style.removeProperty(e)}}function yP(e,t,r){var n,i=r+"",o;return function(){var s=So(this,e);return s===i?null:s===n?o:o=t(n=s,r)}}function bP(e,t,r){var n,i,o;return function(){var s=So(this,e),a=r(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),So(this,e))),s===c?null:s===n&&c===i?o:(i=c,o=t(n=s,a))}}function wP(e,t){var r,n,i,o="style."+t,s="end."+o,a;return function(){var c=Vr(this,e),u=c.on,d=c.value[o]==null?a||(a=cN(t)):void 0;(u!==r||i!==d)&&(n=(r=u).copy()).on(s,i=d),c.on=n}}function _P(e,t,r){var n=(e+="")=="transform"?_M:lN;return t==null?this.styleTween(e,xP(e,n)).on("end.style."+e,cN(e)):typeof t=="function"?this.styleTween(e,bP(e,n,Dx(this,"style."+e,t))).each(wP(this._id,e)):this.styleTween(e,yP(e,n,t),r).on("end.style."+e,null)}function SP(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function kP(e,t,r){var n,i;function o(){var s=t.apply(this,arguments);return s!==i&&(n=(i=s)&&SP(e,s,r)),n}return o._value=t,o}function jP(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,kP(e,t,r??""))}function CP(e){return function(){this.textContent=e}}function NP(e){return function(){var t=e(this);this.textContent=t??""}}function EP(e){return this.tween("text",typeof e=="function"?NP(Dx(this,"text",e)):CP(e==null?"":e+""))}function RP(e){return function(t){this.textContent=e.call(this,t)}}function TP(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&RP(i)),t}return n._value=e,n}function AP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,TP(e))}function IP(){for(var e=this._name,t=this._id,r=uN(),n=this._groups,i=n.length,o=0;o<i;++o)for(var s=n[o],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var d=Tr(c,t);Fc(c,e,r,u,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new fn(n,this._parents,e,r)}function MP(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(o,s){var a={value:s},c={value:function(){--i===0&&o()}};r.each(function(){var u=Vr(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),i===0&&o()})}var PP=0;function fn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function uN(){return++PP}var Yr=pa.prototype;fn.prototype={constructor:fn,select:hP,selectAll:mP,selectChild:Yr.selectChild,selectChildren:Yr.selectChildren,filter:aP,merge:lP,selection:vP,transition:IP,call:Yr.call,nodes:Yr.nodes,node:Yr.node,size:Yr.size,empty:Yr.empty,each:Yr.each,on:dP,attr:UM,attrTween:XM,style:_P,styleTween:jP,text:EP,textTween:AP,remove:pP,tween:FM,delay:JM,duration:rP,ease:iP,easeVarying:sP,end:MP,[Symbol.iterator]:Yr[Symbol.iterator]};function OP(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var DP={time:null,delay:0,duration:250,ease:OP};function LP(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function FP(e){var t,r;e instanceof fn?(t=e._id,e=e._name):(t=uN(),(r=DP).time=Px(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var s=n[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&Fc(c,e,t,u,s,r||LP(c,t));return new fn(n,this._parents,e,t)}pa.prototype.interrupt=OM;pa.prototype.transition=FP;const Va=e=>()=>e;function zP(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function rn(e,t,r){this.k=e,this.x=t,this.y=r}rn.prototype={constructor:rn,scale:function(e){return e===1?this:new rn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new rn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var an=new rn(1,0,0);rn.prototype;function Ku(e){e.stopImmediatePropagation()}function Xo(e){e.preventDefault(),e.stopImmediatePropagation()}function qP(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function $P(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ib(){return this.__zoom||an}function BP(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function HP(){return navigator.maxTouchPoints||"ontouchstart"in this}function WP(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],s=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function dN(){var e=qP,t=$P,r=WP,n=BP,i=HP,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=NM,u=Oc("start","zoom","end"),d,f,h,p=500,y=150,g=0,w=10;function v(S){S.property("__zoom",ib).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",T).filter(i).on("touchstart.zoom",R).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(S,A,M,z){var D=S.selection?S.selection():S;D.property("__zoom",ib),S!==D?j(S,A,M,z):D.interrupt().each(function(){k(this,arguments).event(z).start().zoom(null,typeof A=="function"?A.apply(this,arguments):A).end()})},v.scaleBy=function(S,A,M,z){v.scaleTo(S,function(){var D=this.__zoom.k,I=typeof A=="function"?A.apply(this,arguments):A;return D*I},M,z)},v.scaleTo=function(S,A,M,z){v.transform(S,function(){var D=t.apply(this,arguments),I=this.__zoom,L=M==null?_(D):typeof M=="function"?M.apply(this,arguments):M,O=I.invert(L),q=typeof A=="function"?A.apply(this,arguments):A;return r(b(x(I,q),L,O),D,s)},M,z)},v.translateBy=function(S,A,M,z){v.transform(S,function(){return r(this.__zoom.translate(typeof A=="function"?A.apply(this,arguments):A,typeof M=="function"?M.apply(this,arguments):M),t.apply(this,arguments),s)},null,z)},v.translateTo=function(S,A,M,z,D){v.transform(S,function(){var I=t.apply(this,arguments),L=this.__zoom,O=z==null?_(I):typeof z=="function"?z.apply(this,arguments):z;return r(an.translate(O[0],O[1]).scale(L.k).translate(typeof A=="function"?-A.apply(this,arguments):-A,typeof M=="function"?-M.apply(this,arguments):-M),I,s)},z,D)};function x(S,A){return A=Math.max(o[0],Math.min(o[1],A)),A===S.k?S:new rn(A,S.x,S.y)}function b(S,A,M){var z=A[0]-M[0]*S.k,D=A[1]-M[1]*S.k;return z===S.x&&D===S.y?S:new rn(S.k,z,D)}function _(S){return[(+S[0][0]+ +S[1][0])/2,(+S[0][1]+ +S[1][1])/2]}function j(S,A,M,z){S.on("start.zoom",function(){k(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(z).end()}).tween("zoom",function(){var D=this,I=arguments,L=k(D,I).event(z),O=t.apply(D,I),q=M==null?_(O):typeof M=="function"?M.apply(D,I):M,B=Math.max(O[1][0]-O[0][0],O[1][1]-O[0][1]),$=D.__zoom,V=typeof A=="function"?A.apply(D,I):A,X=c($.invert(q).concat(B/$.k),V.invert(q).concat(B/V.k));return function(ne){if(ne===1)ne=V;else{var te=X(ne),ae=B/te[2];ne=new rn(ae,q[0]-te[0]*ae,q[1]-te[1]*ae)}L.zoom(null,ne)}})}function k(S,A,M){return!M&&S.__zooming||new N(S,A)}function N(S,A){this.that=S,this.args=A,this.active=0,this.sourceEvent=null,this.extent=t.apply(S,A),this.taps=0}N.prototype={event:function(S){return S&&(this.sourceEvent=S),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(S,A){return this.mouse&&S!=="mouse"&&(this.mouse[1]=A.invert(this.mouse[0])),this.touch0&&S!=="touch"&&(this.touch0[1]=A.invert(this.touch0[0])),this.touch1&&S!=="touch"&&(this.touch1[1]=A.invert(this.touch1[0])),this.that.__zoom=A,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(S){var A=lr(this.that).datum();u.call(S,this.that,new zP(S,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:u}),A)}};function E(S,...A){if(!e.apply(this,arguments))return;var M=k(this,A).event(S),z=this.__zoom,D=Math.max(o[0],Math.min(o[1],z.k*Math.pow(2,n.apply(this,arguments)))),I=Sr(S);if(M.wheel)(M.mouse[0][0]!==I[0]||M.mouse[0][1]!==I[1])&&(M.mouse[1]=z.invert(M.mouse[0]=I)),clearTimeout(M.wheel);else{if(z.k===D)return;M.mouse=[I,z.invert(I)],wl(this),M.start()}Xo(S),M.wheel=setTimeout(L,y),M.zoom("mouse",r(b(x(z,D),M.mouse[0],M.mouse[1]),M.extent,s));function L(){M.wheel=null,M.end()}}function C(S,...A){if(h||!e.apply(this,arguments))return;var M=S.currentTarget,z=k(this,A,!0).event(S),D=lr(S.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",B,!0),I=Sr(S,M),L=S.clientX,O=S.clientY;XC(S.view),Ku(S),z.mouse=[I,this.__zoom.invert(I)],wl(this),z.start();function q($){if(Xo($),!z.moved){var V=$.clientX-L,X=$.clientY-O;z.moved=V*V+X*X>g}z.event($).zoom("mouse",r(b(z.that.__zoom,z.mouse[0]=Sr($,M),z.mouse[1]),z.extent,s))}function B($){D.on("mousemove.zoom mouseup.zoom",null),QC($.view,z.moved),Xo($),z.event($).end()}}function T(S,...A){if(e.apply(this,arguments)){var M=this.__zoom,z=Sr(S.changedTouches?S.changedTouches[0]:S,this),D=M.invert(z),I=M.k*(S.shiftKey?.5:2),L=r(b(x(M,I),z,D),t.apply(this,A),s);Xo(S),a>0?lr(this).transition().duration(a).call(j,L,z,S):lr(this).call(v.transform,L,z,S)}}function R(S,...A){if(e.apply(this,arguments)){var M=S.touches,z=M.length,D=k(this,A,S.changedTouches.length===z).event(S),I,L,O,q;for(Ku(S),L=0;L<z;++L)O=M[L],q=Sr(O,this),q=[q,this.__zoom.invert(q),O.identifier],D.touch0?!D.touch1&&D.touch0[2]!==q[2]&&(D.touch1=q,D.taps=0):(D.touch0=q,I=!0,D.taps=1+!!d);d&&(d=clearTimeout(d)),I&&(D.taps<2&&(f=q[0],d=setTimeout(function(){d=null},p)),wl(this),D.start())}}function P(S,...A){if(this.__zooming){var M=k(this,A).event(S),z=S.changedTouches,D=z.length,I,L,O,q;for(Xo(S),I=0;I<D;++I)L=z[I],O=Sr(L,this),M.touch0&&M.touch0[2]===L.identifier?M.touch0[0]=O:M.touch1&&M.touch1[2]===L.identifier&&(M.touch1[0]=O);if(L=M.that.__zoom,M.touch1){var B=M.touch0[0],$=M.touch0[1],V=M.touch1[0],X=M.touch1[1],ne=(ne=V[0]-B[0])*ne+(ne=V[1]-B[1])*ne,te=(te=X[0]-$[0])*te+(te=X[1]-$[1])*te;L=x(L,Math.sqrt(ne/te)),O=[(B[0]+V[0])/2,(B[1]+V[1])/2],q=[($[0]+X[0])/2,($[1]+X[1])/2]}else if(M.touch0)O=M.touch0[0],q=M.touch0[1];else return;M.zoom("touch",r(b(L,O,q),M.extent,s))}}function F(S,...A){if(this.__zooming){var M=k(this,A).event(S),z=S.changedTouches,D=z.length,I,L;for(Ku(S),h&&clearTimeout(h),h=setTimeout(function(){h=null},p),I=0;I<D;++I)L=z[I],M.touch0&&M.touch0[2]===L.identifier?delete M.touch0:M.touch1&&M.touch1[2]===L.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(L=Sr(L,this),Math.hypot(f[0]-L[0],f[1]-L[1])<w)){var O=lr(this).on("dblclick.zoom");O&&O.apply(this,arguments)}}}return v.wheelDelta=function(S){return arguments.length?(n=typeof S=="function"?S:Va(+S),v):n},v.filter=function(S){return arguments.length?(e=typeof S=="function"?S:Va(!!S),v):e},v.touchable=function(S){return arguments.length?(i=typeof S=="function"?S:Va(!!S),v):i},v.extent=function(S){return arguments.length?(t=typeof S=="function"?S:Va([[+S[0][0],+S[0][1]],[+S[1][0],+S[1][1]]]),v):t},v.scaleExtent=function(S){return arguments.length?(o[0]=+S[0],o[1]=+S[1],v):[o[0],o[1]]},v.translateExtent=function(S){return arguments.length?(s[0][0]=+S[0][0],s[1][0]=+S[1][0],s[0][1]=+S[0][1],s[1][1]=+S[1][1],v):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},v.constrain=function(S){return arguments.length?(r=S,v):r},v.duration=function(S){return arguments.length?(a=+S,v):a},v.interpolate=function(S){return arguments.length?(c=S,v):c},v.on=function(){var S=u.on.apply(u,arguments);return S===u?v:S},v.clickDistance=function(S){return arguments.length?(g=(S=+S)*S,v):Math.sqrt(g)},v.tapDistance=function(S){return arguments.length?(w=+S,v):w},v}const zc=m.createContext(null),UP=zc.Provider,pn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},fN=pn.error001();function We(e,t){const r=m.useContext(zc);if(r===null)throw new Error(fN);return LC(r,e,t)}const vt=()=>{const e=m.useContext(zc);if(e===null)throw new Error(fN);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},VP=e=>e.userSelectionActive?"none":"all";function Hn({position:e,children:t,className:r,style:n,...i}){const o=We(VP),s=`${e}`.split("-");return W.createElement("div",{className:Vt(["react-flow__panel",r,...s]),style:{...n,pointerEvents:o},...i},t)}function GP({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:W.createElement(Hn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},W.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const YP=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:i=!0,labelBgStyle:o={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...d})=>{const f=m.useRef(null),[h,p]=m.useState({x:0,y:0,width:0,height:0}),y=Vt(["react-flow__edge-textwrapper",u]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();p({x:g.x,y:g.y,width:g.width,height:g.height})}},[r]),typeof r>"u"||!r?null:W.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:y,visibility:h.width?"visible":"hidden",...d},i&&W.createElement("rect",{width:h.width+2*s[0],x:-s[0],y:-s[1],height:h.height+2*s[1],className:"react-flow__edge-textbg",style:o,rx:a,ry:a}),W.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:f,style:n},r),c)};var KP=m.memo(YP);const Lx=e=>({width:e.offsetWidth,height:e.offsetHeight}),jo=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Fx=(e={x:0,y:0},t)=>({x:jo(e.x,t[0][0],t[1][0]),y:jo(e.y,t[0][1],t[1][1])}),ob=(e,t,r)=>e<t?jo(Math.abs(e-t),1,50)/50:e>r?-jo(Math.abs(e-r),1,50)/50:0,pN=(e,t)=>{const r=ob(e.x,35,t.width-35)*20,n=ob(e.y,35,t.height-35)*20;return[r,n]},hN=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},mN=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Zs=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),gN=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),sb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),XP=(e,t)=>gN(mN(Zs(e),Zs(t))),mv=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},QP=e=>ur(e.width)&&ur(e.height)&&ur(e.x)&&ur(e.y),ur=e=>!isNaN(e)&&isFinite(e),rt=Symbol.for("internals"),vN=["Enter"," ","Escape"],ZP=(e,t)=>{},JP=e=>"nativeEvent"in e;function gv(e){var i,o;const t=JP(e)?e.nativeEvent:e,r=((o=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:o[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const xN=e=>"clientX"in e,Wn=(e,t)=>{var o,s;const r=xN(e),n=r?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,i=r?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},Jl=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},ma=({id:e,path:t,labelX:r,labelY:n,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p=20})=>W.createElement(W.Fragment,null,W.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:h}),p&&W.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),i&&ur(r)&&ur(n)?W.createElement(KP,{x:r,y:n,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);ma.displayName="BaseEdge";function Qo(e,t,r){return r===void 0?r:n=>{const i=t().edges.find(o=>o.id===e);i&&r(n,{...i})}}function yN({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,o=r<e?r+i:r-i,s=Math.abs(n-t)/2,a=n<t?n+s:n-s;return[o,a,i,s]}function bN({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:o,targetControlX:s,targetControlY:a}){const c=e*.125+i*.375+s*.375+r*.125,u=t*.125+o*.375+a*.375+n*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}var Ci;(function(e){e.Strict="strict",e.Loose="loose"})(Ci||(Ci={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var Js;(function(e){e.Partial="partial",e.Full="full"})(Js||(Js={}));var Rn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Rn||(Rn={}));var ec;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ec||(ec={}));var re;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(re||(re={}));function ab({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===re.Left||e===re.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function wN({sourceX:e,sourceY:t,sourcePosition:r=re.Bottom,targetX:n,targetY:i,targetPosition:o=re.Top}){const[s,a]=ab({pos:r,x1:e,y1:t,x2:n,y2:i}),[c,u]=ab({pos:o,x1:n,y1:i,x2:e,y2:t}),[d,f,h,p]=bN({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${s},${a} ${c},${u} ${n},${i}`,d,f,h,p]}const zx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=re.Bottom,targetPosition:o=re.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:g})=>{const[w,v,x]=wN({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:o});return W.createElement(ma,{path:w,labelX:v,labelY:x,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:g})});zx.displayName="SimpleBezierEdge";const lb={[re.Left]:{x:-1,y:0},[re.Right]:{x:1,y:0},[re.Top]:{x:0,y:-1},[re.Bottom]:{x:0,y:1}},eO=({source:e,sourcePosition:t=re.Bottom,target:r})=>t===re.Left||t===re.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},cb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function tO({source:e,sourcePosition:t=re.Bottom,target:r,targetPosition:n=re.Top,center:i,offset:o}){const s=lb[t],a=lb[n],c={x:e.x+s.x*o,y:e.y+s.y*o},u={x:r.x+a.x*o,y:r.y+a.y*o},d=eO({source:c,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",h=d[f];let p=[],y,g;const w={x:0,y:0},v={x:0,y:0},[x,b,_,j]=yN({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(s[f]*a[f]===-1){y=i.x??x,g=i.y??b;const N=[{x:y,y:c.y},{x:y,y:u.y}],E=[{x:c.x,y:g},{x:u.x,y:g}];s[f]===h?p=f==="x"?N:E:p=f==="x"?E:N}else{const N=[{x:c.x,y:u.y}],E=[{x:u.x,y:c.y}];if(f==="x"?p=s.x===h?E:N:p=s.y===h?N:E,t===n){const F=Math.abs(e[f]-r[f]);if(F<=o){const S=Math.min(o-1,o-F);s[f]===h?w[f]=(c[f]>e[f]?-1:1)*S:v[f]=(u[f]>r[f]?-1:1)*S}}if(t!==n){const F=f==="x"?"y":"x",S=s[f]===a[F],A=c[F]>u[F],M=c[F]<u[F];(s[f]===1&&(!S&&A||S&&M)||s[f]!==1&&(!S&&M||S&&A))&&(p=f==="x"?N:E)}const C={x:c.x+w.x,y:c.y+w.y},T={x:u.x+v.x,y:u.y+v.y},R=Math.max(Math.abs(C.x-p[0].x),Math.abs(T.x-p[0].x)),P=Math.max(Math.abs(C.y-p[0].y),Math.abs(T.y-p[0].y));R>=P?(y=(C.x+T.x)/2,g=p[0].y):(y=p[0].x,g=(C.y+T.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...p,{x:u.x+v.x,y:u.y+v.y},r],y,g,_,j]}function rO(e,t,r,n){const i=Math.min(cb(e,t)/2,cb(t,r)/2,n),{x:o,y:s}=t;if(e.x===o&&o===r.x||e.y===s&&s===r.y)return`L${o} ${s}`;if(e.y===s){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${o+i*u},${s}Q ${o},${s} ${o},${s+i*d}`}const a=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${s+i*c}Q ${o},${s} ${o+i*a},${s}`}function vv({sourceX:e,sourceY:t,sourcePosition:r=re.Bottom,targetX:n,targetY:i,targetPosition:o=re.Top,borderRadius:s=5,centerX:a,centerY:c,offset:u=20}){const[d,f,h,p,y]=tO({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:o,center:{x:a,y:c},offset:u});return[d.reduce((w,v,x)=>{let b="";return x>0&&x<d.length-1?b=rO(d[x-1],v,d[x+1],s):b=`${x===0?"M":"L"}${v.x} ${v.y}`,w+=b,w},""),f,h,p,y]}const qc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,sourcePosition:f=re.Bottom,targetPosition:h=re.Top,markerEnd:p,markerStart:y,pathOptions:g,interactionWidth:w})=>{const[v,x,b]=vv({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:h,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return W.createElement(ma,{path:v,labelX:x,labelY:b,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:p,markerStart:y,interactionWidth:w})});qc.displayName="SmoothStepEdge";const qx=m.memo(e=>{var t;return W.createElement(qc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});qx.displayName="StepEdge";function nO({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,o,s,a]=yN({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,o,s,a]}const $x=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p})=>{const[y,g,w]=nO({sourceX:e,sourceY:t,targetX:r,targetY:n});return W.createElement(ma,{path:y,labelX:g,labelY:w,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:h,interactionWidth:p})});$x.displayName="StraightEdge";function Ga(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ub({pos:e,x1:t,y1:r,x2:n,y2:i,c:o}){switch(e){case re.Left:return[t-Ga(t-n,o),r];case re.Right:return[t+Ga(n-t,o),r];case re.Top:return[t,r-Ga(r-i,o)];case re.Bottom:return[t,r+Ga(i-r,o)]}}function _N({sourceX:e,sourceY:t,sourcePosition:r=re.Bottom,targetX:n,targetY:i,targetPosition:o=re.Top,curvature:s=.25}){const[a,c]=ub({pos:r,x1:e,y1:t,x2:n,y2:i,c:s}),[u,d]=ub({pos:o,x1:n,y1:i,x2:e,y2:t,c:s}),[f,h,p,y]=bN({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${a},${c} ${u},${d} ${n},${i}`,f,h,p,y]}const tc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=re.Bottom,targetPosition:o=re.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,pathOptions:g,interactionWidth:w})=>{const[v,x,b]=_N({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:o,curvature:g==null?void 0:g.curvature});return W.createElement(ma,{path:v,labelX:x,labelY:b,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:y,interactionWidth:w})});tc.displayName="BezierEdge";const Bx=m.createContext(null),iO=Bx.Provider;Bx.Consumer;const oO=()=>m.useContext(Bx),sO=e=>"id"in e&&"source"in e&&"target"in e,aO=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,xv=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,lO=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),cO=(e,t)=>{if(!e.source||!e.target)return t;let r;return sO(e)?r={...e}:r={...e,id:aO(e)},lO(r,t)?t:t.concat(r)},yv=({x:e,y:t},[r,n,i],o,[s,a])=>{const c={x:(e-r)/i,y:(t-n)/i};return o?{x:s*Math.round(c.x/s),y:a*Math.round(c.y/a)}:c},SN=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n}),xi=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],i={x:e.position.x-r,y:e.position.y-n};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:i}},$c=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const{x:o,y:s}=xi(i,t).positionAbsolute;return mN(n,Zs({x:o,y:s,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return gN(r)},kN=(e,t,[r,n,i]=[0,0,1],o=!1,s=!1,a=[0,0])=>{const c={x:(t.x-r)/i,y:(t.y-n)/i,width:t.width/i,height:t.height/i},u=[];return e.forEach(d=>{const{width:f,height:h,selectable:p=!0,hidden:y=!1}=d;if(s&&!p||y)return!1;const{positionAbsolute:g}=xi(d,a),w={x:g.x,y:g.y,width:f||0,height:h||0},v=mv(c,w),x=typeof f>"u"||typeof h>"u"||f===null||h===null,b=o&&v>0,_=(f||0)*(h||0);(x||b||v>=_||d.dragging)&&u.push(d)}),u},jN=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},CN=(e,t,r,n,i,o=.1)=>{const s=t/(e.width*(1+o)),a=r/(e.height*(1+o)),c=Math.min(s,a),u=jo(c,n,i),d=e.x+e.width/2,f=e.y+e.height/2,h=t/2-d*u,p=r/2-f*u;return{x:h,y:p,zoom:u}},li=(e,t=0)=>e.transition().duration(t);function db(e,t,r,n){return(t[r]||[]).reduce((i,o)=>{var s,a;return`${e.id}-${o.id}-${r}`!==n&&i.push({id:o.id||null,type:r,nodeId:e.id,x:(((s=e.positionAbsolute)==null?void 0:s.x)??0)+o.x+o.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+o.y+o.height/2}),i},[])}function uO(e,t,r,n,i,o){const{x:s,y:a}=Wn(e),u=t.elementsFromPoint(s,a).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const g=Hx(void 0,u),w=u.getAttribute("data-handleid"),v=o({nodeId:y,id:w,type:g});if(v){const x=i.find(b=>b.nodeId===y&&b.type===g&&b.id===w);return{handle:{id:w,type:g,nodeId:y,x:(x==null?void 0:x.x)||r.x,y:(x==null?void 0:x.y)||r.y},validHandleResult:v}}}}let d=[],f=1/0;if(i.forEach(y=>{const g=Math.sqrt((y.x-r.x)**2+(y.y-r.y)**2);if(g<=n){const w=o(y);g<=f&&(g<f?d=[{handle:y,validHandleResult:w}]:g===f&&d.push({handle:y,validHandleResult:w}),f=g)}}),!d.length)return{handle:null,validHandleResult:NN()};if(d.length===1)return d[0];const h=d.some(({validHandleResult:y})=>y.isValid),p=d.some(({handle:y})=>y.type==="target");return d.find(({handle:y,validHandleResult:g})=>p?y.type==="target":h?g.isValid:!0)||d[0]}const dO={source:null,target:null,sourceHandle:null,targetHandle:null},NN=()=>({handleDomNode:null,isValid:!1,connection:dO,endHandle:null});function EN(e,t,r,n,i,o,s){const a=i==="target",c=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...NN(),handleDomNode:c};if(c){const d=Hx(void 0,c),f=c.getAttribute("data-nodeid"),h=c.getAttribute("data-handleid"),p=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),g={source:a?f:r,sourceHandle:a?h:n,target:a?r:f,targetHandle:a?n:h};u.connection=g,p&&y&&(t===Ci.Strict?a&&d==="source"||!a&&d==="target":f!==r||h!==n)&&(u.endHandle={nodeId:f,handleId:h,type:d},u.isValid=o(g))}return u}function fO({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((i,o)=>{if(o[rt]){const{handleBounds:s}=o[rt];let a=[],c=[];s&&(a=db(o,s,"source",`${t}-${r}-${n}`),c=db(o,s,"target",`${t}-${r}-${n}`)),i.push(...a,...c)}return i},[])}function Hx(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Xu(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function pO(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function RN({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:i,getState:o,setState:s,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const d=hN(e.target),{connectionMode:f,domNode:h,autoPanOnConnect:p,connectionRadius:y,onConnectStart:g,panBy:w,getNodes:v,cancelConnection:x}=o();let b=0,_;const{x:j,y:k}=Wn(e),N=d==null?void 0:d.elementFromPoint(j,k),E=Hx(c,N),C=h==null?void 0:h.getBoundingClientRect();if(!C||!E)return;let T,R=Wn(e,C),P=!1,F=null,S=!1,A=null;const M=fO({nodes:v(),nodeId:r,handleId:t,handleType:E}),z=()=>{if(!p)return;const[L,O]=pN(R,C);w({x:L,y:O}),b=requestAnimationFrame(z)};s({connectionPosition:R,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:r,handleId:t,type:E},connectionEndHandle:null}),g==null||g(e,{nodeId:r,handleId:t,handleType:E});function D(L){const{transform:O}=o();R=Wn(L,C);const{handle:q,validHandleResult:B}=uO(L,d,yv(R,O,!1,[1,1]),y,M,$=>EN($,f,r,t,i?"target":"source",a,d));if(_=q,P||(z(),P=!0),A=B.handleDomNode,F=B.connection,S=B.isValid,s({connectionPosition:_&&S?SN({x:_.x,y:_.y},O):R,connectionStatus:pO(!!_,S),connectionEndHandle:B.endHandle}),!_&&!S&&!A)return Xu(T);F.source!==F.target&&A&&(Xu(T),T=A,A.classList.add("connecting","react-flow__handle-connecting"),A.classList.toggle("valid",S),A.classList.toggle("react-flow__handle-valid",S))}function I(L){var O,q;(_||A)&&F&&S&&(n==null||n(F)),(q=(O=o()).onConnectEnd)==null||q.call(O,L),c&&(u==null||u(L)),Xu(T),x(),cancelAnimationFrame(b),P=!1,S=!1,F=null,A=null,d.removeEventListener("mousemove",D),d.removeEventListener("mouseup",I),d.removeEventListener("touchmove",D),d.removeEventListener("touchend",I)}d.addEventListener("mousemove",D),d.addEventListener("mouseup",I),d.addEventListener("touchmove",D),d.addEventListener("touchend",I)}const fb=()=>!0,hO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),mO=(e,t,r)=>n=>{const{connectionStartHandle:i,connectionEndHandle:o,connectionClickStartHandle:s}=n;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r||(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r}},TN=m.forwardRef(({type:e="source",position:t=re.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:o=!0,id:s,onConnect:a,children:c,className:u,onMouseDown:d,onTouchStart:f,...h},p)=>{var C,T;const y=s||null,g=e==="target",w=vt(),v=oO(),{connectOnClick:x,noPanClassName:b}=We(hO,Et),{connecting:_,clickConnecting:j}=We(mO(v,y,e),Et);v||(T=(C=w.getState()).onError)==null||T.call(C,"010",pn.error010());const k=R=>{const{defaultEdgeOptions:P,onConnect:F,hasDefaultEdges:S}=w.getState(),A={...P,...R};if(S){const{edges:M,setEdges:z}=w.getState();z(cO(A,M))}F==null||F(A),a==null||a(A)},N=R=>{if(!v)return;const P=xN(R);i&&(P&&R.button===0||!P)&&RN({event:R,handleId:y,nodeId:v,onConnect:k,isTarget:g,getState:w.getState,setState:w.setState,isValidConnection:r||w.getState().isValidConnection||fb}),P?d==null||d(R):f==null||f(R)},E=R=>{const{onClickConnectStart:P,onClickConnectEnd:F,connectionClickStartHandle:S,connectionMode:A,isValidConnection:M}=w.getState();if(!v||!S&&!i)return;if(!S){P==null||P(R,{nodeId:v,handleId:y,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:y}});return}const z=hN(R.target),D=r||M||fb,{connection:I,isValid:L}=EN({nodeId:v,id:y,type:e},A,S.nodeId,S.handleId||null,S.type,D,z);L&&k(I),F==null||F(R),w.setState({connectionClickStartHandle:null})};return W.createElement("div",{"data-handleid":y,"data-nodeid":v,"data-handlepos":t,"data-id":`${v}-${y}-${e}`,className:Vt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,u,{source:!g,target:g,connectable:n,connectablestart:i,connectableend:o,connecting:j,connectionindicator:n&&(i&&!_||o&&_)}]),onMouseDown:N,onTouchStart:N,onClick:x?E:void 0,ref:p,...h},c)});TN.displayName="Handle";var Wr=m.memo(TN);const AN=({data:e,isConnectable:t,targetPosition:r=re.Top,sourcePosition:n=re.Bottom})=>W.createElement(W.Fragment,null,W.createElement(Wr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,W.createElement(Wr,{type:"source",position:n,isConnectable:t}));AN.displayName="DefaultNode";var bv=m.memo(AN);const IN=({data:e,isConnectable:t,sourcePosition:r=re.Bottom})=>W.createElement(W.Fragment,null,e==null?void 0:e.label,W.createElement(Wr,{type:"source",position:r,isConnectable:t}));IN.displayName="InputNode";var MN=m.memo(IN);const PN=({data:e,isConnectable:t,targetPosition:r=re.Top})=>W.createElement(W.Fragment,null,W.createElement(Wr,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);PN.displayName="OutputNode";var ON=m.memo(PN);const Wx=()=>null;Wx.displayName="GroupNode";const gO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Ya=e=>e.id;function vO(e,t){return Et(e.selectedNodes.map(Ya),t.selectedNodes.map(Ya))&&Et(e.selectedEdges.map(Ya),t.selectedEdges.map(Ya))}const DN=m.memo(({onSelectionChange:e})=>{const t=vt(),{selectedNodes:r,selectedEdges:n}=We(gO,vO);return m.useEffect(()=>{const i={nodes:r,edges:n};e==null||e(i),t.getState().onSelectionChange.forEach(o=>o(i))},[r,n,e]),null});DN.displayName="SelectionListener";const xO=e=>!!e.onSelectionChange;function yO({onSelectionChange:e}){const t=We(xO);return e||t?W.createElement(DN,{onSelectionChange:e}):null}const bO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oi(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ve(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const wO=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:i,onConnectStart:o,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:d,nodesFocusable:f,edgesFocusable:h,edgesUpdatable:p,elevateNodesOnSelect:y,minZoom:g,maxZoom:w,nodeExtent:v,onNodesChange:x,onEdgesChange:b,elementsSelectable:_,connectionMode:j,snapGrid:k,snapToGrid:N,translateExtent:E,connectOnClick:C,defaultEdgeOptions:T,fitView:R,fitViewOptions:P,onNodesDelete:F,onEdgesDelete:S,onNodeDrag:A,onNodeDragStart:M,onNodeDragStop:z,onSelectionDrag:D,onSelectionDragStart:I,onSelectionDragStop:L,noPanClassName:O,nodeOrigin:q,rfId:B,autoPanOnConnect:$,autoPanOnNodeDrag:V,onError:X,connectionRadius:ne,isValidConnection:te,nodeDragThreshold:ae})=>{const{setNodes:Q,setEdges:we,setDefaultNodesAndEdges:se,setMinZoom:Te,setMaxZoom:ue,setTranslateExtent:Z,setNodeExtent:xe,reset:U}=We(bO,Et),Y=vt();return m.useEffect(()=>{const ce=n==null?void 0:n.map(pe=>({...pe,...T}));return se(r,ce),()=>{U()}},[]),ve("defaultEdgeOptions",T,Y.setState),ve("connectionMode",j,Y.setState),ve("onConnect",i,Y.setState),ve("onConnectStart",o,Y.setState),ve("onConnectEnd",s,Y.setState),ve("onClickConnectStart",a,Y.setState),ve("onClickConnectEnd",c,Y.setState),ve("nodesDraggable",u,Y.setState),ve("nodesConnectable",d,Y.setState),ve("nodesFocusable",f,Y.setState),ve("edgesFocusable",h,Y.setState),ve("edgesUpdatable",p,Y.setState),ve("elementsSelectable",_,Y.setState),ve("elevateNodesOnSelect",y,Y.setState),ve("snapToGrid",N,Y.setState),ve("snapGrid",k,Y.setState),ve("onNodesChange",x,Y.setState),ve("onEdgesChange",b,Y.setState),ve("connectOnClick",C,Y.setState),ve("fitViewOnInit",R,Y.setState),ve("fitViewOnInitOptions",P,Y.setState),ve("onNodesDelete",F,Y.setState),ve("onEdgesDelete",S,Y.setState),ve("onNodeDrag",A,Y.setState),ve("onNodeDragStart",M,Y.setState),ve("onNodeDragStop",z,Y.setState),ve("onSelectionDrag",D,Y.setState),ve("onSelectionDragStart",I,Y.setState),ve("onSelectionDragStop",L,Y.setState),ve("noPanClassName",O,Y.setState),ve("nodeOrigin",q,Y.setState),ve("rfId",B,Y.setState),ve("autoPanOnConnect",$,Y.setState),ve("autoPanOnNodeDrag",V,Y.setState),ve("onError",X,Y.setState),ve("connectionRadius",ne,Y.setState),ve("isValidConnection",te,Y.setState),ve("nodeDragThreshold",ae,Y.setState),Oi(e,Q),Oi(t,we),Oi(g,Te),Oi(w,ue),Oi(E,Z),Oi(v,xe),null},pb={display:"none"},_O={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},LN="react-flow__node-desc",FN="react-flow__edge-desc",SO="react-flow__aria-live",kO=e=>e.ariaLiveMessage;function jO({rfId:e}){const t=We(kO);return W.createElement("div",{id:`${SO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:_O},t)}function CO({rfId:e,disableKeyboardA11y:t}){return W.createElement(W.Fragment,null,W.createElement("div",{id:`${LN}-${e}`,style:pb},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),W.createElement("div",{id:`${FN}-${e}`,style:pb},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&W.createElement(jO,{rfId:e}))}var ea=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),i=m.useRef(!1),o=m.useRef(new Set([])),[s,a]=m.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),d=u.reduce((f,h)=>f.concat(...h),[]);return[u,d]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const d=p=>{if(i.current=p.ctrlKey||p.metaKey||p.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&gv(p))return!1;const g=mb(p.code,a);o.current.add(p[g]),hb(s,o.current,!1)&&(p.preventDefault(),n(!0))},f=p=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&gv(p))return!1;const g=mb(p.code,a);hb(s,o.current,!0)?(n(!1),o.current.clear()):o.current.delete(p[g]),p.key==="Meta"&&o.current.clear(),i.current=!1},h=()=>{o.current.clear(),n(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",h),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",h)}}},[e,n]),r};function hb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function mb(e,t){return t.includes(e)?"code":"key"}function zN(e,t,r,n){var a,c;const i=e.parentNode||e.parentId;if(!i)return r;const o=t.get(i),s=xi(o,n);return zN(o,t,{x:(r.x??0)+s.x,y:(r.y??0)+s.y,z:(((a=o[rt])==null?void 0:a.z)??0)>(r.z??0)?((c=o[rt])==null?void 0:c.z)??0:r.z??0},n)}function qN(e,t,r){e.forEach(n=>{var o;const i=n.parentNode||n.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||r!=null&&r[n.id]){const{x:s,y:a,z:c}=zN(n,e,{...n.position,z:((o=n[rt])==null?void 0:o.z)??0},t);n.positionAbsolute={x:s,y:a},n[rt].z=c,r!=null&&r[n.id]&&(n[rt].isParent=!0)}})}function Qu(e,t,r,n){const i=new Map,o={},s=n?1e3:0;return e.forEach(a=>{var p;const c=(ur(a.zIndex)?a.zIndex:0)+(a.selected?s:0),u=t.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},f=a.parentNode||a.parentId;f&&(o[f]=!0);const h=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(d,rt,{enumerable:!1,value:{handleBounds:h||(p=u==null?void 0:u[rt])==null?void 0:p.handleBounds,z:c}}),i.set(a.id,d)}),qN(i,r,o),i}function $N(e,t={}){const{getNodes:r,width:n,height:i,minZoom:o,maxZoom:s,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:d,nodeOrigin:f}=e(),h=t.initial&&!u&&d;if(a&&c&&(h||!t.initial)){const y=r().filter(w=>{var x;const v=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(x=t.nodes)!=null&&x.length?v&&t.nodes.some(b=>b.id===w.id):v}),g=y.every(w=>w.width&&w.height);if(y.length>0&&g){const w=$c(y,f),{x:v,y:x,zoom:b}=CN(w,n,i,t.minZoom??o,t.maxZoom??s,t.padding??.1),_=an.translate(v,x).scale(b);return typeof t.duration=="number"&&t.duration>0?a.transform(li(c,t.duration),_):a.transform(c,_),!0}}return!1}function NO(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[rt]:n[rt],selected:r.selected})}),new Map(t)}function EO(e,t){return t.map(r=>{const n=e.find(i=>i.id===r.id);return n&&(r.selected=n.selected),r})}function Ka({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:i,edges:o,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=r();e!=null&&e.length&&(c&&n({nodeInternals:NO(e,i)}),s==null||s(e)),t!=null&&t.length&&(u&&n({edges:EO(t,o)}),a==null||a(t))}const Di=()=>{},RO={zoomIn:Di,zoomOut:Di,zoomTo:Di,getZoom:()=>1,setViewport:Di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Di,fitBounds:Di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},TO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),AO=()=>{const e=vt(),{d3Zoom:t,d3Selection:r}=We(TO,Et);return m.useMemo(()=>r&&t?{zoomIn:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1/1.2),zoomTo:(i,o)=>t.scaleTo(li(r,o==null?void 0:o.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,o)=>{const[s,a,c]=e.getState().transform,u=an.translate(i.x??s,i.y??a).scale(i.zoom??c);t.transform(li(r,o==null?void 0:o.duration),u)},getViewport:()=>{const[i,o,s]=e.getState().transform;return{x:i,y:o,zoom:s}},fitView:i=>$N(e.getState,i),setCenter:(i,o,s)=>{const{width:a,height:c,maxZoom:u}=e.getState(),d=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:u,f=a/2-i*d,h=c/2-o*d,p=an.translate(f,h).scale(d);t.transform(li(r,s==null?void 0:s.duration),p)},fitBounds:(i,o)=>{const{width:s,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:d,y:f,zoom:h}=CN(i,s,a,c,u,(o==null?void 0:o.padding)??.1),p=an.translate(d,f).scale(h);t.transform(li(r,o==null?void 0:o.duration),p)},project:i=>{const{transform:o,snapToGrid:s,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),yv(i,o,s,a)},screenToFlowPosition:i=>{const{transform:o,snapToGrid:s,snapGrid:a,domNode:c}=e.getState();if(!c)return i;const{x:u,y:d}=c.getBoundingClientRect(),f={x:i.x-u,y:i.y-d};return yv(f,o,s,a)},flowToScreenPosition:i=>{const{transform:o,domNode:s}=e.getState();if(!s)return i;const{x:a,y:c}=s.getBoundingClientRect(),u=SN(i,o);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:RO,[t,r])};function Bc(){const e=AO(),t=vt(),r=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),n=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),i=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(w=>({...w}))},[]),o=m.useCallback(g=>{const{edges:w=[]}=t.getState();return w.find(v=>v.id===g)},[]),s=m.useCallback(g=>{const{getNodes:w,setNodes:v,hasDefaultNodes:x,onNodesChange:b}=t.getState(),_=w(),j=typeof g=="function"?g(_):g;if(x)v(j);else if(b){const k=j.length===0?_.map(N=>({type:"remove",id:N.id})):j.map(N=>({item:N,type:"reset"}));b(k)}},[]),a=m.useCallback(g=>{const{edges:w=[],setEdges:v,hasDefaultEdges:x,onEdgesChange:b}=t.getState(),_=typeof g=="function"?g(w):g;if(x)v(_);else if(b){const j=_.length===0?w.map(k=>({type:"remove",id:k.id})):_.map(k=>({item:k,type:"reset"}));b(j)}},[]),c=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{getNodes:v,setNodes:x,hasDefaultNodes:b,onNodesChange:_}=t.getState();if(b){const k=[...v(),...w];x(k)}else if(_){const j=w.map(k=>({item:k,type:"add"}));_(j)}},[]),u=m.useCallback(g=>{const w=Array.isArray(g)?g:[g],{edges:v=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:_}=t.getState();if(b)x([...v,...w]);else if(_){const j=w.map(k=>({item:k,type:"add"}));_(j)}},[]),d=m.useCallback(()=>{const{getNodes:g,edges:w=[],transform:v}=t.getState(),[x,b,_]=v;return{nodes:g().map(j=>({...j})),edges:w.map(j=>({...j})),viewport:{x,y:b,zoom:_}}},[]),f=m.useCallback(({nodes:g,edges:w})=>{const{nodeInternals:v,getNodes:x,edges:b,hasDefaultNodes:_,hasDefaultEdges:j,onNodesDelete:k,onEdgesDelete:N,onNodesChange:E,onEdgesChange:C}=t.getState(),T=(g||[]).map(A=>A.id),R=(w||[]).map(A=>A.id),P=x().reduce((A,M)=>{const z=M.parentNode||M.parentId,D=!T.includes(M.id)&&z&&A.find(L=>L.id===z);return(typeof M.deletable=="boolean"?M.deletable:!0)&&(T.includes(M.id)||D)&&A.push(M),A},[]),F=b.filter(A=>typeof A.deletable=="boolean"?A.deletable:!0),S=F.filter(A=>R.includes(A.id));if(P||S){const A=jN(P,F),M=[...S,...A],z=M.reduce((D,I)=>(D.includes(I.id)||D.push(I.id),D),[]);if((j||_)&&(j&&t.setState({edges:b.filter(D=>!z.includes(D.id))}),_&&(P.forEach(D=>{v.delete(D.id)}),t.setState({nodeInternals:new Map(v)}))),z.length>0&&(N==null||N(M),C&&C(z.map(D=>({id:D,type:"remove"})))),P.length>0&&(k==null||k(P),E)){const D=P.map(I=>({id:I.id,type:"remove"}));E(D)}}},[]),h=m.useCallback(g=>{const w=QP(g),v=w?null:t.getState().nodeInternals.get(g.id);return!w&&!v?[null,null,w]:[w?g:sb(v),v,w]},[]),p=m.useCallback((g,w=!0,v)=>{const[x,b,_]=h(g);return x?(v||t.getState().getNodes()).filter(j=>{if(!_&&(j.id===b.id||!j.positionAbsolute))return!1;const k=sb(j),N=mv(k,x);return w&&N>0||N>=x.width*x.height}):[]},[]),y=m.useCallback((g,w,v=!0)=>{const[x]=h(g);if(!x)return!1;const b=mv(x,w);return v&&b>0||b>=x.width*x.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:i,getEdge:o,setNodes:s,setEdges:a,addNodes:c,addEdges:u,toObject:d,deleteElements:f,getIntersectingNodes:p,isNodeIntersecting:y}),[e,r,n,i,o,s,a,c,u,d,f,p,y])}const IO={actInsideInputWithModifier:!1};var MO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=vt(),{deleteElements:n}=Bc(),i=ea(e,IO),o=ea(t);m.useEffect(()=>{if(i){const{edges:s,getNodes:a}=r.getState(),c=a().filter(d=>d.selected),u=s.filter(d=>d.selected);n({nodes:c,edges:u}),r.setState({nodesSelectionActive:!1})}},[i]),m.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])};function PO(e){const t=vt();m.useEffect(()=>{let r;const n=()=>{var o,s;if(!e.current)return;const i=Lx(e.current);(i.height===0||i.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",pn.error004())),t.setState({width:i.width||500,height:i.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const Ux={position:"absolute",width:"100%",height:"100%",top:0,left:0},OO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Xa=e=>({x:e.x,y:e.y,zoom:e.k}),Li=(e,t)=>e.target.closest(`.${t}`),gb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),vb=e=>{const t=e.ctrlKey&&Jl()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},DO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),LO=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:i=!0,zoomOnPinch:o=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=pi.Free,zoomOnDoubleClick:u=!0,elementsSelectable:d,panOnDrag:f=!0,defaultViewport:h,translateExtent:p,minZoom:y,maxZoom:g,zoomActivationKeyCode:w,preventScrolling:v=!0,children:x,noWheelClassName:b,noPanClassName:_})=>{const j=m.useRef(),k=vt(),N=m.useRef(!1),E=m.useRef(!1),C=m.useRef(null),T=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:R,d3Selection:P,d3ZoomHandler:F,userSelectionActive:S}=We(DO,Et),A=ea(w),M=m.useRef(0),z=m.useRef(!1),D=m.useRef();return PO(C),m.useEffect(()=>{if(C.current){const I=C.current.getBoundingClientRect(),L=dN().scaleExtent([y,g]).translateExtent(p),O=lr(C.current).call(L),q=an.translate(h.x,h.y).scale(jo(h.zoom,y,g)),B=[[0,0],[I.width,I.height]],$=L.constrain()(q,B,p);L.transform(O,$),L.wheelDelta(vb),k.setState({d3Zoom:L,d3Selection:O,d3ZoomHandler:O.on("wheel.zoom"),transform:[$.x,$.y,$.k],domNode:C.current.closest(".react-flow")})}},[]),m.useEffect(()=>{P&&R&&(s&&!A&&!S?P.on("wheel.zoom",I=>{if(Li(I,b))return!1;I.preventDefault(),I.stopImmediatePropagation();const L=P.property("__zoom").k||1;if(I.ctrlKey&&o){const te=Sr(I),ae=vb(I),Q=L*Math.pow(2,ae);R.scaleTo(P,Q,te,I);return}const O=I.deltaMode===1?20:1;let q=c===pi.Vertical?0:I.deltaX*O,B=c===pi.Horizontal?0:I.deltaY*O;!Jl()&&I.shiftKey&&c!==pi.Vertical&&(q=I.deltaY*O,B=0),R.translateBy(P,-(q/L)*a,-(B/L)*a,{internal:!0});const $=Xa(P.property("__zoom")),{onViewportChangeStart:V,onViewportChange:X,onViewportChangeEnd:ne}=k.getState();clearTimeout(D.current),z.current||(z.current=!0,t==null||t(I,$),V==null||V($)),z.current&&(e==null||e(I,$),X==null||X($),D.current=setTimeout(()=>{r==null||r(I,$),ne==null||ne($),z.current=!1},150))},{passive:!1}):typeof F<"u"&&P.on("wheel.zoom",function(I,L){if(!v&&I.type==="wheel"&&!I.ctrlKey||Li(I,b))return null;I.preventDefault(),F.call(this,I,L)},{passive:!1}))},[S,s,c,P,R,F,A,o,v,b,t,e,r]),m.useEffect(()=>{R&&R.on("start",I=>{var q,B;if(!I.sourceEvent||I.sourceEvent.internal)return null;M.current=(q=I.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:L}=k.getState(),O=Xa(I.transform);N.current=!0,T.current=O,((B=I.sourceEvent)==null?void 0:B.type)==="mousedown"&&k.setState({paneDragging:!0}),L==null||L(O),t==null||t(I.sourceEvent,O)})},[R,t]),m.useEffect(()=>{R&&(S&&!N.current?R.on("zoom",null):S||R.on("zoom",I=>{var O;const{onViewportChange:L}=k.getState();if(k.setState({transform:[I.transform.x,I.transform.y,I.transform.k]}),E.current=!!(n&&gb(f,M.current??0)),(e||L)&&!((O=I.sourceEvent)!=null&&O.internal)){const q=Xa(I.transform);L==null||L(q),e==null||e(I.sourceEvent,q)}}))},[S,R,e,f,n]),m.useEffect(()=>{R&&R.on("end",I=>{if(!I.sourceEvent||I.sourceEvent.internal)return null;const{onViewportChangeEnd:L}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),n&&gb(f,M.current??0)&&!E.current&&n(I.sourceEvent),E.current=!1,(r||L)&&OO(T.current,I.transform)){const O=Xa(I.transform);T.current=O,clearTimeout(j.current),j.current=setTimeout(()=>{L==null||L(O),r==null||r(I.sourceEvent,O)},s?150:0)}})},[R,s,f,r,n]),m.useEffect(()=>{R&&R.filter(I=>{const L=A||i,O=o&&I.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&I.button===1&&I.type==="mousedown"&&(Li(I,"react-flow__node")||Li(I,"react-flow__edge")))return!0;if(!f&&!L&&!s&&!u&&!o||S||!u&&I.type==="dblclick"||Li(I,b)&&I.type==="wheel"||Li(I,_)&&(I.type!=="wheel"||s&&I.type==="wheel"&&!A)||!o&&I.ctrlKey&&I.type==="wheel"||!L&&!s&&!O&&I.type==="wheel"||!f&&(I.type==="mousedown"||I.type==="touchstart")||Array.isArray(f)&&!f.includes(I.button)&&I.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(I.button)||!I.button||I.button<=1;return(!I.ctrlKey||I.type==="wheel")&&q})},[S,R,i,o,s,u,f,d,A]),W.createElement("div",{className:"react-flow__renderer",ref:C,style:Ux},x)},FO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function zO(){const{userSelectionActive:e,userSelectionRect:t}=We(FO,Et);return e&&t?W.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function xb(e,t){const r=t.parentNode||t.parentId,n=e.find(i=>i.id===r);if(n){const i=t.position.x+t.width-n.width,o=t.position.y+t.height-n.height;if(i>0||o>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,i>0&&(n.style.width+=i),o>0&&(n.style.height+=o),t.position.x<0){const s=Math.abs(t.position.x);n.position.x=n.position.x-s,n.style.width+=s,t.position.x=0}if(t.position.y<0){const s=Math.abs(t.position.y);n.position.y=n.position.y-s,n.style.height+=s,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function BN(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,i)=>{const o=e.filter(a=>a.id===i.id);if(o.length===0)return n.push(i),n;const s={...i};for(const a of o)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position<"u"&&(s.position=a.position),typeof a.positionAbsolute<"u"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&xb(n,s);break}case"dimensions":{typeof a.dimensions<"u"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle<"u"&&(s.style={...s.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&xb(n,s);break}case"remove":return n}return n.push(s),n},r)}function HN(e,t){return BN(e,t)}function qO(e,t){return BN(e,t)}const jn=(e,t)=>({id:e,type:"select",selected:t});function to(e,t){return e.reduce((r,n)=>{const i=t.includes(n.id);return!n.selected&&i?(n.selected=!0,r.push(jn(n.id,!0))):n.selected&&!i&&(n.selected=!1,r.push(jn(n.id,!1))),r},[])}const Zu=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},$O=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),WN=m.memo(({isSelecting:e,selectionMode:t=Js.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:i,onPaneClick:o,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:d,children:f})=>{const h=m.useRef(null),p=vt(),y=m.useRef(0),g=m.useRef(0),w=m.useRef(),{userSelectionActive:v,elementsSelectable:x,dragging:b}=We($O,Et),_=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,g.current=0},j=F=>{o==null||o(F),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},k=F=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){F.preventDefault();return}s==null||s(F)},N=a?F=>a(F):void 0,E=F=>{const{resetSelectedElements:S,domNode:A}=p.getState();if(w.current=A==null?void 0:A.getBoundingClientRect(),!x||!e||F.button!==0||F.target!==h.current||!w.current)return;const{x:M,y:z}=Wn(F,w.current);S(),p.setState({userSelectionRect:{width:0,height:0,startX:M,startY:z,x:M,y:z}}),n==null||n(F)},C=F=>{const{userSelectionRect:S,nodeInternals:A,edges:M,transform:z,onNodesChange:D,onEdgesChange:I,nodeOrigin:L,getNodes:O}=p.getState();if(!e||!w.current||!S)return;p.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=Wn(F,w.current),B=S.startX??0,$=S.startY??0,V={...S,x:q.x<B?q.x:B,y:q.y<$?q.y:$,width:Math.abs(q.x-B),height:Math.abs(q.y-$)},X=O(),ne=kN(A,V,z,t===Js.Partial,!0,L),te=jN(ne,M).map(Q=>Q.id),ae=ne.map(Q=>Q.id);if(y.current!==ae.length){y.current=ae.length;const Q=to(X,ae);Q.length&&(D==null||D(Q))}if(g.current!==te.length){g.current=te.length;const Q=to(M,te);Q.length&&(I==null||I(Q))}p.setState({userSelectionRect:V})},T=F=>{if(F.button!==0)return;const{userSelectionRect:S}=p.getState();!v&&S&&F.target===h.current&&(j==null||j(F)),p.setState({nodesSelectionActive:y.current>0}),_(),i==null||i(F)},R=F=>{v&&(p.setState({nodesSelectionActive:y.current>0}),i==null||i(F)),_()},P=x&&(e||v);return W.createElement("div",{className:Vt(["react-flow__pane",{dragging:b,selection:e}]),onClick:P?void 0:Zu(j,h),onContextMenu:Zu(k,h),onWheel:Zu(N,h),onMouseEnter:P?void 0:c,onMouseDown:P?E:void 0,onMouseMove:P?C:u,onMouseUp:P?T:void 0,onMouseLeave:P?R:d,ref:h,style:Ux},f,W.createElement(zO,null))});WN.displayName="Pane";function UN(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:UN(n,t):!1}function yb(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function BO(e,t,r,n){return Array.from(e.values()).filter(i=>(i.selected||i.id===n)&&(!i.parentNode||i.parentId||!UN(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var o,s;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((o=i.positionAbsolute)==null?void 0:o.x)??0),y:r.y-(((s=i.positionAbsolute)==null?void 0:s.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function HO(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function VN(e,t,r,n,i=[0,0],o){const s=HO(e,e.extent||n);let a=s;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:h,y:p}=xi(f,i).positionAbsolute;a=f&&ur(h)&&ur(p)&&ur(f.width)&&ur(f.height)?[[h+e.width*i[0],p+e.height*i[1]],[h+f.width-e.width+e.width*i[0],p+f.height-e.height+e.height*i[1]]]:a}else o==null||o("005",pn.error005()),a=s;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:h,y:p}=xi(f,i).positionAbsolute;a=[[e.extent[0][0]+h,e.extent[0][1]+p],[e.extent[1][0]+h,e.extent[1][1]+p]]}let u={x:0,y:0};if(c){const f=r.get(c);u=xi(f,i).positionAbsolute}const d=a&&a!=="parent"?Fx(t,a):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function Ju({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(i=>({...r.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?n.find(i=>i.id===e):n[0],n]}const bb=(e,t,r,n)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const o=Array.from(i),s=t.getBoundingClientRect(),a={x:s.width*n[0],y:s.height*n[1]};return o.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-s.left-a.x)/r,y:(u.top-s.top-a.y)/r,...Lx(c)}})};function Zo(e,t,r){return r===void 0?r:n=>{const i=t().nodeInternals.get(e);i&&r(n,{...i})}}function wv({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:o,multiSelectionActive:s,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",pn.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&s)&&(o({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=n==null?void 0:n.current)==null?void 0:d.blur()})):i([e])}function WO(){const e=vt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:i,snapToGrid:o}=e.getState(),s=r.touches?r.touches[0].clientX:r.clientX,a=r.touches?r.touches[0].clientY:r.clientY,c={x:(s-n[0])/n[2],y:(a-n[1])/n[2]};return{xSnapped:o?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:o?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function ed(e){return(t,r,n)=>e==null?void 0:e(t,n)}function GN({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:o,selectNodesOnDrag:s}){const a=vt(),[c,u]=m.useState(!1),d=m.useRef([]),f=m.useRef({x:null,y:null}),h=m.useRef(0),p=m.useRef(null),y=m.useRef({x:0,y:0}),g=m.useRef(null),w=m.useRef(!1),v=m.useRef(!1),x=m.useRef(!1),b=WO();return m.useEffect(()=>{if(e!=null&&e.current){const _=lr(e.current),j=({x:E,y:C})=>{const{nodeInternals:T,onNodeDrag:R,onSelectionDrag:P,updateNodePositions:F,nodeExtent:S,snapGrid:A,snapToGrid:M,nodeOrigin:z,onError:D}=a.getState();f.current={x:E,y:C};let I=!1,L={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&S){const q=$c(d.current,z);L=Zs(q)}if(d.current=d.current.map(q=>{const B={x:E-q.distance.x,y:C-q.distance.y};M&&(B.x=A[0]*Math.round(B.x/A[0]),B.y=A[1]*Math.round(B.y/A[1]));const $=[[S[0][0],S[0][1]],[S[1][0],S[1][1]]];d.current.length>1&&S&&!q.extent&&($[0][0]=q.positionAbsolute.x-L.x+S[0][0],$[1][0]=q.positionAbsolute.x+(q.width??0)-L.x2+S[1][0],$[0][1]=q.positionAbsolute.y-L.y+S[0][1],$[1][1]=q.positionAbsolute.y+(q.height??0)-L.y2+S[1][1]);const V=VN(q,B,T,$,z,D);return I=I||q.position.x!==V.position.x||q.position.y!==V.position.y,q.position=V.position,q.positionAbsolute=V.positionAbsolute,q}),!I)return;F(d.current,!0,!0),u(!0);const O=i?R:ed(P);if(O&&g.current){const[q,B]=Ju({nodeId:i,dragItems:d.current,nodeInternals:T});O(g.current,q,B)}},k=()=>{if(!p.current)return;const[E,C]=pN(y.current,p.current);if(E!==0||C!==0){const{transform:T,panBy:R}=a.getState();f.current.x=(f.current.x??0)-E/T[2],f.current.y=(f.current.y??0)-C/T[2],R({x:E,y:C})&&j(f.current)}h.current=requestAnimationFrame(k)},N=E=>{var z;const{nodeInternals:C,multiSelectionActive:T,nodesDraggable:R,unselectNodesAndEdges:P,onNodeDragStart:F,onSelectionDragStart:S}=a.getState();v.current=!0;const A=i?F:ed(S);(!s||!o)&&!T&&i&&((z=C.get(i))!=null&&z.selected||P()),i&&o&&s&&wv({id:i,store:a,nodeRef:e});const M=b(E);if(f.current=M,d.current=BO(C,R,M,i),A&&d.current){const[D,I]=Ju({nodeId:i,dragItems:d.current,nodeInternals:C});A(E.sourceEvent,D,I)}};if(t)_.on(".drag",null);else{const E=tM().on("start",C=>{const{domNode:T,nodeDragThreshold:R}=a.getState();R===0&&N(C),x.current=!1;const P=b(C);f.current=P,p.current=(T==null?void 0:T.getBoundingClientRect())||null,y.current=Wn(C.sourceEvent,p.current)}).on("drag",C=>{var F,S;const T=b(C),{autoPanOnNodeDrag:R,nodeDragThreshold:P}=a.getState();if(C.sourceEvent.type==="touchmove"&&C.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!w.current&&v.current&&R&&(w.current=!0,k()),!v.current){const A=T.xSnapped-(((F=f==null?void 0:f.current)==null?void 0:F.x)??0),M=T.ySnapped-(((S=f==null?void 0:f.current)==null?void 0:S.y)??0);Math.sqrt(A*A+M*M)>P&&N(C)}(f.current.x!==T.xSnapped||f.current.y!==T.ySnapped)&&d.current&&v.current&&(g.current=C.sourceEvent,y.current=Wn(C.sourceEvent,p.current),j(T))}}).on("end",C=>{if(!(!v.current||x.current)&&(u(!1),w.current=!1,v.current=!1,cancelAnimationFrame(h.current),d.current)){const{updateNodePositions:T,nodeInternals:R,onNodeDragStop:P,onSelectionDragStop:F}=a.getState(),S=i?P:ed(F);if(T(d.current,!1,!1),S){const[A,M]=Ju({nodeId:i,dragItems:d.current,nodeInternals:R});S(C.sourceEvent,A,M)}}}).filter(C=>{const T=C.target;return!C.button&&(!r||!yb(T,`.${r}`,e))&&(!n||yb(T,n,e))});return _.call(E),()=>{_.on(".drag",null)}}}},[e,t,r,n,o,a,i,s,b]),c}function YN(){const e=vt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:i,updateNodePositions:o,getNodes:s,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:d}=e.getState(),f=s().filter(x=>x.selected&&(x.draggable||d&&typeof x.draggable>"u")),h=a?c[0]:5,p=a?c[1]:5,y=r.isShiftPressed?4:1,g=r.x*h*y,w=r.y*p*y,v=f.map(x=>{if(x.positionAbsolute){const b={x:x.positionAbsolute.x+g,y:x.positionAbsolute.y+w};a&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:_,position:j}=VN(x,b,n,i,void 0,u);x.position=j,x.positionAbsolute=_}return x});o(v,!0,!1)},[])}const po={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Jo=e=>{const t=({id:r,type:n,data:i,xPos:o,yPos:s,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:d,onMouseEnter:f,onMouseMove:h,onMouseLeave:p,onContextMenu:y,onDoubleClick:g,style:w,className:v,isDraggable:x,isSelectable:b,isConnectable:_,isFocusable:j,selectNodesOnDrag:k,sourcePosition:N,targetPosition:E,hidden:C,resizeObserver:T,dragHandle:R,zIndex:P,isParent:F,noDragClassName:S,noPanClassName:A,initialized:M,disableKeyboardA11y:z,ariaLabel:D,rfId:I,hasHandleBounds:L})=>{const O=vt(),q=m.useRef(null),B=m.useRef(null),$=m.useRef(N),V=m.useRef(E),X=m.useRef(n),ne=b||x||d||f||h||p,te=YN(),ae=Zo(r,O.getState,f),Q=Zo(r,O.getState,h),we=Zo(r,O.getState,p),se=Zo(r,O.getState,y),Te=Zo(r,O.getState,g),ue=U=>{const{nodeDragThreshold:Y}=O.getState();if(b&&(!k||!x||Y>0)&&wv({id:r,store:O,nodeRef:q}),d){const ce=O.getState().nodeInternals.get(r);ce&&d(U,{...ce})}},Z=U=>{if(!gv(U)&&!z)if(vN.includes(U.key)&&b){const Y=U.key==="Escape";wv({id:r,store:O,unselect:Y,nodeRef:q})}else x&&u&&Object.prototype.hasOwnProperty.call(po,U.key)&&(O.setState({ariaLiveMessage:`Moved selected node ${U.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~s}`}),te({x:po[U.key].x,y:po[U.key].y,isShiftPressed:U.shiftKey}))};m.useEffect(()=>()=>{B.current&&(T==null||T.unobserve(B.current),B.current=null)},[]),m.useEffect(()=>{if(q.current&&!C){const U=q.current;(!M||!L||B.current!==U)&&(B.current&&(T==null||T.unobserve(B.current)),T==null||T.observe(U),B.current=U)}},[C,M,L]),m.useEffect(()=>{const U=X.current!==n,Y=$.current!==N,ce=V.current!==E;q.current&&(U||Y||ce)&&(U&&(X.current=n),Y&&($.current=N),ce&&(V.current=E),O.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,n,N,E]);const xe=GN({nodeRef:q,disabled:C||!x,noDragClassName:S,handleSelector:R,nodeId:r,isSelectable:b,selectNodesOnDrag:k});return C?null:W.createElement("div",{className:Vt(["react-flow__node",`react-flow__node-${n}`,{[A]:x},v,{selected:u,selectable:b,parent:F,dragging:xe}]),ref:q,style:{zIndex:P,transform:`translate(${a}px,${c}px)`,pointerEvents:ne?"all":"none",visibility:M?"visible":"hidden",...w},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:ae,onMouseMove:Q,onMouseLeave:we,onContextMenu:se,onClick:ue,onDoubleClick:Te,onKeyDown:j?Z:void 0,tabIndex:j?0:void 0,role:j?"button":void 0,"aria-describedby":z?void 0:`${LN}-${I}`,"aria-label":D},W.createElement(iO,{value:r},W.createElement(e,{id:r,data:i,type:n,xPos:o,yPos:s,selected:u,isConnectable:_,sourcePosition:N,targetPosition:E,dragging:xe,dragHandle:R,zIndex:P})))};return t.displayName="NodeWrapper",m.memo(t)};const UO=e=>{const t=e.getNodes().filter(r=>r.selected);return{...$c(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function VO({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=vt(),{width:i,height:o,x:s,y:a,transformString:c,userSelectionActive:u}=We(UO,Et),d=YN(),f=m.useRef(null);if(m.useEffect(()=>{var y;r||(y=f.current)==null||y.focus({preventScroll:!0})},[r]),GN({nodeRef:f}),u||!i||!o)return null;const h=e?y=>{const g=n.getState().getNodes().filter(w=>w.selected);e(y,g)}:void 0,p=y=>{Object.prototype.hasOwnProperty.call(po,y.key)&&d({x:po[y.key].x,y:po[y.key].y,isShiftPressed:y.shiftKey})};return W.createElement("div",{className:Vt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},W.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:r?void 0:-1,onKeyDown:r?void 0:p,style:{width:i,height:o,top:a,left:s}}))}var GO=m.memo(VO);const YO=e=>e.nodesSelectionActive,KN=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:s,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:d,selectionKeyCode:f,selectionOnDrag:h,selectionMode:p,onSelectionStart:y,onSelectionEnd:g,multiSelectionKeyCode:w,panActivationKeyCode:v,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:C,panOnDrag:T,defaultViewport:R,translateExtent:P,minZoom:F,maxZoom:S,preventScrolling:A,onSelectionContextMenu:M,noWheelClassName:z,noPanClassName:D,disableKeyboardA11y:I})=>{const L=We(YO),O=ea(f),q=ea(v),B=q||T,$=q||k,V=O||h&&B!==!0;return MO({deleteKeyCode:a,multiSelectionKeyCode:w}),W.createElement(LO,{onMove:c,onMoveStart:u,onMoveEnd:d,onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:$,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:C,panOnDrag:!O&&B,defaultViewport:R,translateExtent:P,minZoom:F,maxZoom:S,zoomActivationKeyCode:x,preventScrolling:A,noWheelClassName:z,noPanClassName:D},W.createElement(WN,{onSelectionStart:y,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:s,panOnDrag:B,isSelecting:!!V,selectionMode:p},e,L&&W.createElement(GO,{onSelectionContextMenu:M,noPanClassName:D,disableKeyboardA11y:I})))};KN.displayName="FlowRenderer";var KO=m.memo(KN);function XO(e){return We(m.useCallback(r=>e?kN(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function QO(e){const t={input:Jo(e.input||MN),default:Jo(e.default||bv),output:Jo(e.output||ON),group:Jo(e.group||Wx)},r={},n=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,o)=>(i[o]=Jo(e[o]||bv),i),r);return{...t,...n}}const ZO=({x:e,y:t,width:r,height:n,origin:i})=>!r||!n?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-r*i[0],y:t-n*i[1]},JO=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),XN=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,updateNodeDimensions:o,onError:s}=We(JO,Et),a=XO(e.onlyRenderVisibleElements),c=m.useRef(),u=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(f=>{const h=f.map(p=>({id:p.target.getAttribute("data-id"),nodeElement:p.target,forceUpdate:!0}));o(h)});return c.current=d,d},[]);return m.useEffect(()=>()=>{var d;(d=c==null?void 0:c.current)==null||d.disconnect()},[]),W.createElement("div",{className:"react-flow__nodes",style:Ux},a.map(d=>{var j,k,N;let f=d.type||"default";e.nodeTypes[f]||(s==null||s("003",pn.error003(f)),f="default");const h=e.nodeTypes[f]||e.nodeTypes.default,p=!!(d.draggable||t&&typeof d.draggable>"u"),y=!!(d.selectable||i&&typeof d.selectable>"u"),g=!!(d.connectable||r&&typeof d.connectable>"u"),w=!!(d.focusable||n&&typeof d.focusable>"u"),v=e.nodeExtent?Fx(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,x=(v==null?void 0:v.x)??0,b=(v==null?void 0:v.y)??0,_=ZO({x,y:b,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return W.createElement(h,{key:d.id,id:d.id,className:d.className,style:d.style,type:f,data:d.data,sourcePosition:d.sourcePosition||re.Bottom,targetPosition:d.targetPosition||re.Top,hidden:d.hidden,xPos:x,yPos:b,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:p,isSelectable:y,isConnectable:g,isFocusable:w,resizeObserver:u,dragHandle:d.dragHandle,zIndex:((j=d[rt])==null?void 0:j.z)??0,isParent:!!((k=d[rt])!=null&&k.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((N=d[rt])!=null&&N.handleBounds)})}))};XN.displayName="NodeRenderer";var eD=m.memo(XN);const tD=(e,t,r)=>r===re.Left?e-t:r===re.Right?e+t:e,rD=(e,t,r)=>r===re.Top?e-t:r===re.Bottom?e+t:e,wb="react-flow__edgeupdater",_b=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:o,onMouseOut:s,type:a})=>W.createElement("circle",{onMouseDown:i,onMouseEnter:o,onMouseOut:s,className:Vt([wb,`${wb}-${a}`]),cx:tD(t,n,e),cy:rD(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),nD=()=>!0;var Fi=e=>{const t=({id:r,className:n,type:i,data:o,onClick:s,onEdgeDoubleClick:a,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:g,style:w,source:v,target:x,sourceX:b,sourceY:_,targetX:j,targetY:k,sourcePosition:N,targetPosition:E,elementsSelectable:C,hidden:T,sourceHandleId:R,targetHandleId:P,onContextMenu:F,onMouseEnter:S,onMouseMove:A,onMouseLeave:M,reconnectRadius:z,onReconnect:D,onReconnectStart:I,onReconnectEnd:L,markerEnd:O,markerStart:q,rfId:B,ariaLabel:$,isFocusable:V,isReconnectable:X,pathOptions:ne,interactionWidth:te,disableKeyboardA11y:ae})=>{const Q=m.useRef(null),[we,se]=m.useState(!1),[Te,ue]=m.useState(!1),Z=vt(),xe=m.useMemo(()=>`url('#${xv(q,B)}')`,[q,B]),U=m.useMemo(()=>`url('#${xv(O,B)}')`,[O,B]);if(T)return null;const Y=he=>{var ee;const{edges:le,addSelectedEdges:Ye,unselectNodesAndEdges:Je,multiSelectionActive:xt}=Z.getState(),ie=le.find($e=>$e.id===r);ie&&(C&&(Z.setState({nodesSelectionActive:!1}),ie.selected&&xt?(Je({nodes:[],edges:[ie]}),(ee=Q.current)==null||ee.blur()):Ye([r])),s&&s(he,ie))},ce=Qo(r,Z.getState,a),pe=Qo(r,Z.getState,F),ke=Qo(r,Z.getState,S),ge=Qo(r,Z.getState,A),de=Qo(r,Z.getState,M),_e=(he,le)=>{if(he.button!==0)return;const{edges:Ye,isValidConnection:Je}=Z.getState(),xt=le?x:v,ie=(le?P:R)||null,ee=le?"target":"source",$e=Je||nD,gr=le,vr=Ye.find(Fe=>Fe.id===r);ue(!0),I==null||I(he,vr,ee);const Mr=Fe=>{ue(!1),L==null||L(Fe,vr,ee)};RN({event:he,handleId:ie,nodeId:xt,onConnect:Fe=>D==null?void 0:D(vr,Fe),isTarget:gr,getState:Z.getState,setState:Z.setState,isValidConnection:$e,edgeUpdaterType:ee,onReconnectEnd:Mr})},Ve=he=>_e(he,!0),Ce=he=>_e(he,!1),Le=()=>se(!0),Oe=()=>se(!1),Ge=!C&&!s,G=he=>{var le;if(!ae&&vN.includes(he.key)&&C){const{unselectNodesAndEdges:Ye,addSelectedEdges:Je,edges:xt}=Z.getState();he.key==="Escape"?((le=Q.current)==null||le.blur(),Ye({edges:[xt.find(ee=>ee.id===r)]})):Je([r])}};return W.createElement("g",{className:Vt(["react-flow__edge",`react-flow__edge-${i}`,n,{selected:c,animated:u,inactive:Ge,updating:we}]),onClick:Y,onDoubleClick:ce,onContextMenu:pe,onMouseEnter:ke,onMouseMove:ge,onMouseLeave:de,onKeyDown:V?G:void 0,tabIndex:V?0:void 0,role:V?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":$===null?void 0:$||`Edge from ${v} to ${x}`,"aria-describedby":V?`${FN}-${B}`:void 0,ref:Q},!Te&&W.createElement(e,{id:r,source:v,target:x,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:g,data:o,style:w,sourceX:b,sourceY:_,targetX:j,targetY:k,sourcePosition:N,targetPosition:E,sourceHandleId:R,targetHandleId:P,markerStart:xe,markerEnd:U,pathOptions:ne,interactionWidth:te}),X&&W.createElement(W.Fragment,null,(X==="source"||X===!0)&&W.createElement(_b,{position:N,centerX:b,centerY:_,radius:z,onMouseDown:Ve,onMouseEnter:Le,onMouseOut:Oe,type:"source"}),(X==="target"||X===!0)&&W.createElement(_b,{position:E,centerX:j,centerY:k,radius:z,onMouseDown:Ce,onMouseEnter:Le,onMouseOut:Oe,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function iD(e){const t={default:Fi(e.default||tc),straight:Fi(e.bezier||$x),step:Fi(e.step||qx),smoothstep:Fi(e.step||qc),simplebezier:Fi(e.simplebezier||zx)},r={},n=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,o)=>(i[o]=Fi(e[o]||tc),i),r);return{...t,...n}}function Sb(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,i=((r==null?void 0:r.y)||0)+t.y,o=(r==null?void 0:r.width)||t.width,s=(r==null?void 0:r.height)||t.height;switch(e){case re.Top:return{x:n+o/2,y:i};case re.Right:return{x:n+o,y:i+s/2};case re.Bottom:return{x:n+o/2,y:i+s};case re.Left:return{x:n,y:i+s/2}}}function kb(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const oD=(e,t,r,n,i,o)=>{const s=Sb(r,e,t),a=Sb(o,n,i);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function sD({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:i,targetHeight:o,width:s,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+i),y2:Math.max(e.y+n,t.y+o)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=Zs({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:s/c[2],height:a/c[2]}),f=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),h=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(f*h)>0}function jb(e){var n,i,o,s,a;const t=((n=e==null?void 0:e[rt])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)<"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const aD=[{level:0,isMaxLevel:!0,edges:[]}];function lD(e,t,r=!1){let n=-1;const i=e.reduce((s,a)=>{var d,f;const c=ur(a.zIndex);let u=c?a.zIndex:0;if(r){const h=t.get(a.target),p=t.get(a.source),y=a.selected||(h==null?void 0:h.selected)||(p==null?void 0:p.selected),g=Math.max(((d=p==null?void 0:p[rt])==null?void 0:d.z)||0,((f=h==null?void 0:h[rt])==null?void 0:f.z)||0,1e3);u=(c?a.zIndex:0)+(y?g:0)}return s[u]?s[u].push(a):s[u]=[a],n=u>n?u:n,s},{}),o=Object.entries(i).map(([s,a])=>{const c=+s;return{edges:a,level:c,isMaxLevel:c===n}});return o.length===0?aD:o}function cD(e,t,r){const n=We(m.useCallback(i=>e?i.edges.filter(o=>{const s=t.get(o.source),a=t.get(o.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&sD({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return lD(n,t,r)}const uD=({color:e="none",strokeWidth:t=1})=>W.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),dD=({color:e="none",strokeWidth:t=1})=>W.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Cb={[ec.Arrow]:uD,[ec.ArrowClosed]:dD};function fD(e){const t=vt();return m.useMemo(()=>{var i,o;return Object.prototype.hasOwnProperty.call(Cb,e)?Cb[e]:((o=(i=t.getState()).onError)==null||o.call(i,"009",pn.error009(e)),null)},[e])}const pD=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:o="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=fD(t);return c?W.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:a,refX:"0",refY:"0"},W.createElement(c,{color:r,strokeWidth:s})):null},hD=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((i,o)=>([o.markerStart,o.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=xv(s,t);n.includes(a)||(i.push({id:a,color:s.color||e,...s}),n.push(a))}}),i),[]).sort((i,o)=>i.id.localeCompare(o.id))},QN=({defaultColor:e,rfId:t})=>{const r=We(m.useCallback(hD({defaultColor:e,rfId:t}),[e,t]),(n,i)=>!(n.length!==i.length||n.some((o,s)=>o.id!==i[s].id)));return W.createElement("defs",null,r.map(n=>W.createElement(pD,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};QN.displayName="MarkerDefinitions";var mD=m.memo(QN);const gD=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),ZN=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:i,noPanClassName:o,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:g,children:w,disableKeyboardA11y:v})=>{const{edgesFocusable:x,edgesUpdatable:b,elementsSelectable:_,width:j,height:k,connectionMode:N,nodeInternals:E,onError:C}=We(gD,Et),T=cD(t,E,r);return j?W.createElement(W.Fragment,null,T.map(({level:R,edges:P,isMaxLevel:F})=>W.createElement("svg",{key:R,style:{zIndex:R},width:j,height:k,className:"react-flow__edges react-flow__container"},F&&W.createElement(mD,{defaultColor:e,rfId:n}),W.createElement("g",null,P.map(S=>{const[A,M,z]=jb(E.get(S.source)),[D,I,L]=jb(E.get(S.target));if(!z||!L)return null;let O=S.type||"default";i[O]||(C==null||C("011",pn.error011(O)),O="default");const q=i[O]||i.default,B=N===Ci.Strict?I.target:(I.target??[]).concat(I.source??[]),$=kb(M.source,S.sourceHandle),V=kb(B,S.targetHandle),X=($==null?void 0:$.position)||re.Bottom,ne=(V==null?void 0:V.position)||re.Top,te=!!(S.focusable||x&&typeof S.focusable>"u"),ae=S.reconnectable||S.updatable,Q=typeof h<"u"&&(ae||b&&typeof ae>"u");if(!$||!V)return C==null||C("008",pn.error008($,S)),null;const{sourceX:we,sourceY:se,targetX:Te,targetY:ue}=oD(A,$,X,D,V,ne);return W.createElement(q,{key:S.id,id:S.id,className:Vt([S.className,o]),type:O,data:S.data,selected:!!S.selected,animated:!!S.animated,hidden:!!S.hidden,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,style:S.style,source:S.source,target:S.target,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerEnd:S.markerEnd,markerStart:S.markerStart,sourceX:we,sourceY:se,targetX:Te,targetY:ue,sourcePosition:X,targetPosition:ne,elementsSelectable:_,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:d,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:g,rfId:n,ariaLabel:S.ariaLabel,isFocusable:te,isReconnectable:Q,pathOptions:"pathOptions"in S?S.pathOptions:void 0,interactionWidth:S.interactionWidth,disableKeyboardA11y:v})})))),w):null};ZN.displayName="EdgeRenderer";var vD=m.memo(ZN);const xD=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function yD({children:e}){const t=We(xD);return W.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function bD(e){const t=Bc(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const wD={[re.Left]:re.Right,[re.Right]:re.Left,[re.Top]:re.Bottom,[re.Bottom]:re.Top},JN=({nodeId:e,handleType:t,style:r,type:n=Rn.Bezier,CustomComponent:i,connectionStatus:o})=>{var k,N,E;const{fromNode:s,handleId:a,toX:c,toY:u,connectionMode:d}=We(m.useCallback(C=>({fromNode:C.nodeInternals.get(e),handleId:C.connectionHandleId,toX:(C.connectionPosition.x-C.transform[0])/C.transform[2],toY:(C.connectionPosition.y-C.transform[1])/C.transform[2],connectionMode:C.connectionMode}),[e]),Et),f=(k=s==null?void 0:s[rt])==null?void 0:k.handleBounds;let h=f==null?void 0:f[t];if(d===Ci.Loose&&(h=h||(f==null?void 0:f[t==="source"?"target":"source"])),!s||!h)return null;const p=a?h.find(C=>C.id===a):h[0],y=p?p.x+p.width/2:(s.width??0)/2,g=p?p.y+p.height/2:s.height??0,w=(((N=s.positionAbsolute)==null?void 0:N.x)??0)+y,v=(((E=s.positionAbsolute)==null?void 0:E.y)??0)+g,x=p==null?void 0:p.position,b=x?wD[x]:null;if(!x||!b)return null;if(i)return W.createElement(i,{connectionLineType:n,connectionLineStyle:r,fromNode:s,fromHandle:p,fromX:w,fromY:v,toX:c,toY:u,fromPosition:x,toPosition:b,connectionStatus:o});let _="";const j={sourceX:w,sourceY:v,sourcePosition:x,targetX:c,targetY:u,targetPosition:b};return n===Rn.Bezier?[_]=_N(j):n===Rn.Step?[_]=vv({...j,borderRadius:0}):n===Rn.SmoothStep?[_]=vv(j):n===Rn.SimpleBezier?[_]=wN(j):_=`M${w},${v} ${c},${u}`,W.createElement("path",{d:_,fill:"none",className:"react-flow__connection-path",style:r})};JN.displayName="ConnectionLine";const _D=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function SD({containerStyle:e,style:t,type:r,component:n}){const{nodeId:i,handleType:o,nodesConnectable:s,width:a,height:c,connectionStatus:u}=We(_D,Et);return!(i&&o&&a&&s)?null:W.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},W.createElement("g",{className:Vt(["react-flow__connection",u])},W.createElement(JN,{nodeId:i,handleType:o,style:t,type:r,CustomComponent:n,connectionStatus:u})))}function Nb(e,t){return m.useRef(null),vt(),m.useMemo(()=>t(e),[e])}const eE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:i,onInit:o,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,onSelectionContextMenu:y,onSelectionStart:g,onSelectionEnd:w,connectionLineType:v,connectionLineStyle:x,connectionLineComponent:b,connectionLineContainerStyle:_,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:E,panActivationKeyCode:C,zoomActivationKeyCode:T,deleteKeyCode:R,onlyRenderVisibleElements:P,elementsSelectable:F,selectNodesOnDrag:S,defaultViewport:A,translateExtent:M,minZoom:z,maxZoom:D,preventScrolling:I,defaultMarkerColor:L,zoomOnScroll:O,zoomOnPinch:q,panOnScroll:B,panOnScrollSpeed:$,panOnScrollMode:V,zoomOnDoubleClick:X,panOnDrag:ne,onPaneClick:te,onPaneMouseEnter:ae,onPaneMouseMove:Q,onPaneMouseLeave:we,onPaneScroll:se,onPaneContextMenu:Te,onEdgeContextMenu:ue,onEdgeMouseEnter:Z,onEdgeMouseMove:xe,onEdgeMouseLeave:U,onReconnect:Y,onReconnectStart:ce,onReconnectEnd:pe,reconnectRadius:ke,noDragClassName:ge,noWheelClassName:de,noPanClassName:_e,elevateEdgesOnSelect:Ve,disableKeyboardA11y:Ce,nodeOrigin:Le,nodeExtent:Oe,rfId:Ge})=>{const G=Nb(e,QO),he=Nb(t,iD);return bD(o),W.createElement(KO,{onPaneClick:te,onPaneMouseEnter:ae,onPaneMouseMove:Q,onPaneMouseLeave:we,onPaneContextMenu:Te,onPaneScroll:se,deleteKeyCode:R,selectionKeyCode:j,selectionOnDrag:k,selectionMode:N,onSelectionStart:g,onSelectionEnd:w,multiSelectionKeyCode:E,panActivationKeyCode:C,zoomActivationKeyCode:T,elementsSelectable:F,onMove:r,onMoveStart:n,onMoveEnd:i,zoomOnScroll:O,zoomOnPinch:q,zoomOnDoubleClick:X,panOnScroll:B,panOnScrollSpeed:$,panOnScrollMode:V,panOnDrag:ne,defaultViewport:A,translateExtent:M,minZoom:z,maxZoom:D,onSelectionContextMenu:y,preventScrolling:I,noDragClassName:ge,noWheelClassName:de,noPanClassName:_e,disableKeyboardA11y:Ce},W.createElement(yD,null,W.createElement(vD,{edgeTypes:he,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:P,onEdgeContextMenu:ue,onEdgeMouseEnter:Z,onEdgeMouseMove:xe,onEdgeMouseLeave:U,onReconnect:Y,onReconnectStart:ce,onReconnectEnd:pe,reconnectRadius:ke,defaultMarkerColor:L,noPanClassName:_e,elevateEdgesOnSelect:!!Ve,disableKeyboardA11y:Ce,rfId:Ge},W.createElement(SD,{style:x,type:v,component:b,containerStyle:_})),W.createElement("div",{className:"react-flow__edgelabel-renderer"}),W.createElement(eD,{nodeTypes:G,onNodeClick:s,onNodeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:p,selectNodesOnDrag:S,onlyRenderVisibleElements:P,noPanClassName:_e,noDragClassName:ge,disableKeyboardA11y:Ce,nodeOrigin:Le,nodeExtent:Oe,rfId:Ge})))};eE.displayName="GraphView";var kD=m.memo(eE);const _v=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],bn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:_v,nodeExtent:_v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ci.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:ZP,isValidConnection:void 0},jD=()=>p3((e,t)=>({...bn,setNodes:r=>{const{nodeInternals:n,nodeOrigin:i,elevateNodesOnSelect:o}=t();e({nodeInternals:Qu(r,n,i,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(i=>({...n,...i}))})},setDefaultNodesAndEdges:(r,n)=>{const i=typeof r<"u",o=typeof n<"u",s=i?Qu(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:o?n:[],hasDefaultNodes:i,hasDefaultEdges:o})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:i,fitViewOnInit:o,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),d=c==null?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const f=window.getComputedStyle(d),{m22:h}=new window.DOMMatrixReadOnly(f.transform),p=r.reduce((g,w)=>{const v=i.get(w.id);if(v!=null&&v.hidden)i.set(v.id,{...v,[rt]:{...v[rt],handleBounds:void 0}});else if(v){const x=Lx(w.nodeElement);!!(x.width&&x.height&&(v.width!==x.width||v.height!==x.height||w.forceUpdate))&&(i.set(v.id,{...v,[rt]:{...v[rt],handleBounds:{source:bb(".source",w.nodeElement,h,u),target:bb(".target",w.nodeElement,h,u)}},...x}),g.push({id:v.id,type:"dimensions",dimensions:x}))}return g},[]);qN(i,u);const y=s||o&&!s&&$N(t,{initial:!0,...a});e({nodeInternals:new Map(i),fitViewOnInitDone:y}),(p==null?void 0:p.length)>0&&(n==null||n(p))},updateNodePositions:(r,n=!0,i=!1)=>{const{triggerNodeChanges:o}=t(),s=r.map(a=>{const c={id:a.id,type:"position",dragging:i};return n&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});o(s)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:i,hasDefaultNodes:o,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(o){const u=HN(r,a()),d=Qu(u,i,s,c);e({nodeInternals:d})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:i,getNodes:o}=t();let s,a=null;n?s=r.map(c=>jn(c,!0)):(s=to(o(),r),a=to(i,[])),Ka({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:i,getNodes:o}=t();let s,a=null;n?s=r.map(c=>jn(c,!0)):(s=to(i,r),a=to(o(),[])),Ka({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:i,getNodes:o}=t(),s=r||o(),a=n||i,c=s.map(d=>(d.selected=!1,jn(d.id,!1))),u=a.map(d=>jn(d.id,!1));Ka({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:i}=t();n==null||n.scaleExtent([r,i]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:i}=t();n==null||n.scaleExtent([i,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),o=n().filter(a=>a.selected).map(a=>jn(a.id,!1)),s=r.filter(a=>a.selected).map(a=>jn(a.id,!1));Ka({changedNodes:o,changedEdges:s,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(i=>{i.positionAbsolute=Fx(i.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:i,height:o,d3Zoom:s,d3Selection:a,translateExtent:c}=t();if(!s||!a||!r.x&&!r.y)return!1;const u=an.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),d=[[0,0],[i,o]],f=s==null?void 0:s.constrain()(u,d,c);return s.transform(a,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:bn.connectionNodeId,connectionHandleId:bn.connectionHandleId,connectionHandleType:bn.connectionHandleType,connectionStatus:bn.connectionStatus,connectionStartHandle:bn.connectionStartHandle,connectionEndHandle:bn.connectionEndHandle}),reset:()=>e({...bn})}),Object.is),Hc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=jD()),W.createElement(UP,{value:t.current},e)};Hc.displayName="ReactFlowProvider";const tE=({children:e})=>m.useContext(zc)?W.createElement(W.Fragment,null,e):W.createElement(Hc,null,e);tE.displayName="ReactFlowWrapper";const CD={input:MN,default:bv,output:ON,group:Wx},ND={default:tc,straight:$x,step:qx,smoothstep:qc,simplebezier:zx},ED=[0,0],RD=[15,15],TD={x:0,y:0,zoom:1},AD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Vx=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:o=CD,edgeTypes:s=ND,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:h,onConnect:p,onConnectStart:y,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:C,onNodesDelete:T,onEdgesDelete:R,onSelectionChange:P,onSelectionDragStart:F,onSelectionDrag:S,onSelectionDragStop:A,onSelectionContextMenu:M,onSelectionStart:z,onSelectionEnd:D,connectionMode:I=Ci.Strict,connectionLineType:L=Rn.Bezier,connectionLineStyle:O,connectionLineComponent:q,connectionLineContainerStyle:B,deleteKeyCode:$="Backspace",selectionKeyCode:V="Shift",selectionOnDrag:X=!1,selectionMode:ne=Js.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:ae=Jl()?"Meta":"Control",zoomActivationKeyCode:Q=Jl()?"Meta":"Control",snapToGrid:we=!1,snapGrid:se=RD,onlyRenderVisibleElements:Te=!1,selectNodesOnDrag:ue=!0,nodesDraggable:Z,nodesConnectable:xe,nodesFocusable:U,nodeOrigin:Y=ED,edgesFocusable:ce,edgesUpdatable:pe,elementsSelectable:ke,defaultViewport:ge=TD,minZoom:de=.5,maxZoom:_e=2,translateExtent:Ve=_v,preventScrolling:Ce=!0,nodeExtent:Le,defaultMarkerColor:Oe="#b1b1b7",zoomOnScroll:Ge=!0,zoomOnPinch:G=!0,panOnScroll:he=!1,panOnScrollSpeed:le=.5,panOnScrollMode:Ye=pi.Free,zoomOnDoubleClick:Je=!0,panOnDrag:xt=!0,onPaneClick:ie,onPaneMouseEnter:ee,onPaneMouseMove:$e,onPaneMouseLeave:gr,onPaneScroll:vr,onPaneContextMenu:Mr,children:Ke,onEdgeContextMenu:Fe,onEdgeDoubleClick:at,onEdgeMouseEnter:Dt,onEdgeMouseMove:yt,onEdgeMouseLeave:ft,onEdgeUpdate:Tt,onEdgeUpdateStart:xr,onEdgeUpdateEnd:et,onReconnect:Yt,onReconnectStart:H,onReconnectEnd:Ie,reconnectRadius:ti=10,edgeUpdaterRadius:ri=10,onNodesChange:Pr,onEdgesChange:ni,noDragClassName:qo="nodrag",noWheelClassName:JR="nowheel",noPanClassName:Ny="nopan",fitView:eT=!1,fitViewOptions:tT,connectOnClick:rT=!0,attributionPosition:nT,proOptions:iT,defaultEdgeOptions:oT,elevateNodesOnSelect:sT=!0,elevateEdgesOnSelect:aT=!1,disableKeyboardA11y:Ey=!1,autoPanOnConnect:lT=!0,autoPanOnNodeDrag:cT=!0,connectionRadius:uT=20,isValidConnection:dT,onError:fT,style:pT,id:Ry,nodeDragThreshold:hT,...mT},gT)=>{const xu=Ry||"1";return W.createElement("div",{...mT,style:{...pT,...AD},ref:gT,className:Vt(["react-flow",i]),"data-testid":"rf__wrapper",id:Ry},W.createElement(tE,null,W.createElement(kD,{onInit:u,onMove:d,onMoveStart:f,onMoveEnd:h,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:j,onNodeDoubleClick:k,nodeTypes:o,edgeTypes:s,connectionLineType:L,connectionLineStyle:O,connectionLineComponent:q,connectionLineContainerStyle:B,selectionKeyCode:V,selectionOnDrag:X,selectionMode:ne,deleteKeyCode:$,multiSelectionKeyCode:ae,panActivationKeyCode:te,zoomActivationKeyCode:Q,onlyRenderVisibleElements:Te,selectNodesOnDrag:ue,defaultViewport:ge,translateExtent:Ve,minZoom:de,maxZoom:_e,preventScrolling:Ce,zoomOnScroll:Ge,zoomOnPinch:G,zoomOnDoubleClick:Je,panOnScroll:he,panOnScrollSpeed:le,panOnScrollMode:Ye,panOnDrag:xt,onPaneClick:ie,onPaneMouseEnter:ee,onPaneMouseMove:$e,onPaneMouseLeave:gr,onPaneScroll:vr,onPaneContextMenu:Mr,onSelectionContextMenu:M,onSelectionStart:z,onSelectionEnd:D,onEdgeContextMenu:Fe,onEdgeDoubleClick:at,onEdgeMouseEnter:Dt,onEdgeMouseMove:yt,onEdgeMouseLeave:ft,onReconnect:Yt??Tt,onReconnectStart:H??xr,onReconnectEnd:Ie??et,reconnectRadius:ti??ri,defaultMarkerColor:Oe,noDragClassName:qo,noWheelClassName:JR,noPanClassName:Ny,elevateEdgesOnSelect:aT,rfId:xu,disableKeyboardA11y:Ey,nodeOrigin:Y,nodeExtent:Le}),W.createElement(wO,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:p,onConnectStart:y,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:v,nodesDraggable:Z,nodesConnectable:xe,nodesFocusable:U,edgesFocusable:ce,edgesUpdatable:pe,elementsSelectable:ke,elevateNodesOnSelect:sT,minZoom:de,maxZoom:_e,nodeExtent:Le,onNodesChange:Pr,onEdgesChange:ni,snapToGrid:we,snapGrid:se,connectionMode:I,translateExtent:Ve,connectOnClick:rT,defaultEdgeOptions:oT,fitView:eT,fitViewOptions:tT,onNodesDelete:T,onEdgesDelete:R,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:C,onSelectionDrag:S,onSelectionDragStart:F,onSelectionDragStop:A,noPanClassName:Ny,nodeOrigin:Y,rfId:xu,autoPanOnConnect:lT,autoPanOnNodeDrag:cT,onError:fT,connectionRadius:uT,isValidConnection:dT,nodeDragThreshold:hT}),W.createElement(yO,{onSelectionChange:P}),Ke,W.createElement(GP,{proOptions:iT,position:nT}),W.createElement(CO,{rfId:xu,disableKeyboardA11y:Ey})))});Vx.displayName="ReactFlow";function rE(e){return t=>{const[r,n]=m.useState(t),i=m.useCallback(o=>n(s=>e(o,s)),[]);return[r,n,i]}}const nE=rE(HN),iE=rE(qO),oE=({id:e,x:t,y:r,width:n,height:i,style:o,color:s,strokeColor:a,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,onClick:h,selected:p})=>{const{background:y,backgroundColor:g}=o||{},w=s||y||g;return W.createElement("rect",{className:Vt(["react-flow__minimap-node",{selected:p},u]),x:t,y:r,rx:d,ry:d,width:n,height:i,fill:w,stroke:a,strokeWidth:c,shapeRendering:f,onClick:h?v=>h(v,e):void 0})};oE.displayName="MiniMapNode";var ID=m.memo(oE);const MD=e=>e.nodeOrigin,PD=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),td=e=>e instanceof Function?e:()=>e;function OD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i=2,nodeComponent:o=ID,onClick:s}){const a=We(PD,Et),c=We(MD),u=td(t),d=td(e),f=td(r),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return W.createElement(W.Fragment,null,a.map(p=>{const{x:y,y:g}=xi(p,c).positionAbsolute;return W.createElement(o,{key:p.id,x:y,y:g,width:p.width,height:p.height,style:p.style,selected:p.selected,className:f(p),color:u(p),borderRadius:n,strokeColor:d(p),strokeWidth:i,shapeRendering:h,onClick:s,id:p.id})}))}var DD=m.memo(OD);const LD=200,FD=150,zD=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?XP($c(t,e.nodeOrigin),r):r,rfId:e.rfId}},qD="react-flow__minimap-desc";function sE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:i="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:d=1,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:y=!1,zoomable:g=!1,ariaLabel:w="React Flow mini map",inversePan:v=!1,zoomStep:x=10,offsetScale:b=5}){const _=vt(),j=m.useRef(null),{boundingRect:k,viewBB:N,rfId:E}=We(zD,Et),C=(e==null?void 0:e.width)??LD,T=(e==null?void 0:e.height)??FD,R=k.width/C,P=k.height/T,F=Math.max(R,P),S=F*C,A=F*T,M=b*F,z=k.x-(S-k.width)/2-M,D=k.y-(A-k.height)/2-M,I=S+M*2,L=A+M*2,O=`${qD}-${E}`,q=m.useRef(0);q.current=F,m.useEffect(()=>{if(j.current){const V=lr(j.current),X=ae=>{const{transform:Q,d3Selection:we,d3Zoom:se}=_.getState();if(ae.sourceEvent.type!=="wheel"||!we||!se)return;const Te=-ae.sourceEvent.deltaY*(ae.sourceEvent.deltaMode===1?.05:ae.sourceEvent.deltaMode?1:.002)*x,ue=Q[2]*Math.pow(2,Te);se.scaleTo(we,ue)},ne=ae=>{const{transform:Q,d3Selection:we,d3Zoom:se,translateExtent:Te,width:ue,height:Z}=_.getState();if(ae.sourceEvent.type!=="mousemove"||!we||!se)return;const xe=q.current*Math.max(1,Q[2])*(v?-1:1),U={x:Q[0]-ae.sourceEvent.movementX*xe,y:Q[1]-ae.sourceEvent.movementY*xe},Y=[[0,0],[ue,Z]],ce=an.translate(U.x,U.y).scale(Q[2]),pe=se.constrain()(ce,Y,Te);se.transform(we,pe)},te=dN().on("zoom",y?ne:null).on("zoom.wheel",g?X:null);return V.call(te),()=>{V.on("zoom",null)}}},[y,g,v,x]);const B=h?V=>{const X=Sr(V);h(V,{x:X[0],y:X[1]})}:void 0,$=p?(V,X)=>{const ne=_.getState().nodeInternals.get(X);p(V,ne)}:void 0;return W.createElement(Hn,{position:f,style:e,className:Vt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},W.createElement("svg",{width:C,height:T,viewBox:`${z} ${D} ${I} ${L}`,role:"img","aria-labelledby":O,ref:j,onClick:B},w&&W.createElement("title",{id:O},w),W.createElement(DD,{onClick:$,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:i,nodeStrokeWidth:s,nodeComponent:a}),W.createElement("path",{className:"react-flow__minimap-mask",d:`M${z-M},${D-M}h${I+M*2}v${L+M*2}h${-I-M*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:d,pointerEvents:"none"})))}sE.displayName="MiniMap";var aE=m.memo(sE);const Qa={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},$D=180,BD=400,HD=260,WD=48;function UD(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function VD({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:i,onToggleShowArchived:o,userSection:s}){const[a,c]=m.useState(!1),[u,d]=m.useState(HD),[f,h]=m.useState(!1),p=m.useRef(null),y=m.useRef(null);m.useEffect(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((j,k)=>{const N=(j.name||"").localeCompare(k.name||"");return N!==0?N:(j.projectId||"").localeCompare(k.projectId||"")}),[e]),w=()=>{n()},v=m.useCallback(j=>{j.preventDefault(),h(!0)},[]),x=m.useCallback(j=>{if(!f)return;const k=Math.min(BD,Math.max($D,j.clientX));d(k)},[f]),b=m.useCallback(()=>{h(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",x),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,x,b]);const _=a?WD:u;return l.jsxs("div",{ref:p,className:"h-full flex flex-col relative",style:{width:_,minWidth:_,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[l.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!a&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),l.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:i?"#f59e0b":"var(--text-muted)"},title:i?"Hide archived":"Show archived",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),l.jsx("button",{onClick:()=>c(!a),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:a?"Expand sidebar":"Collapse sidebar",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:a?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:l.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!a&&l.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(j=>{const k=t===j.id;return l.jsxs("div",{ref:k?y:null,onClick:()=>r(j.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:k?"var(--state-active-bg)":"transparent",border:k?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:k?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:k?"#ffffff":Qa[j.status]||Qa.queued}}),l.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:k?"#ffffff":"var(--text-primary)"},children:j.name}),j.isArchived&&l.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:k?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),l.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[l.jsx("span",{className:"text-[10px] font-mono",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:j.projectId}),l.jsx("span",{className:"text-[10px]",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:UD(j.createdAt)})]})]},j.id)})}),a&&l.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(j=>l.jsx("div",{onClick:()=>r(j.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:j.name,children:l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:Qa[j.status]||Qa.queued,boxShadow:t===j.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},j.id))}),!a&&l.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:w,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[l.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),l.jsx("span",{children:"New Project"})]})}),a&&l.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:l.jsx("button",{onClick:w,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:l.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),s,!a&&l.jsx("div",{onMouseDown:v,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function GD({stations:e}){return e!=null&&e.length?l.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,r)=>{const n=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",i=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",o=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return l.jsxs(W.Fragment,{children:[r>0&&l.jsx("div",{className:"w-4 h-0.5",style:{background:i}}),l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:n}}),l.jsx("span",{className:"text-[7px] mt-0.5",style:{color:o,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const Eb={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},lE=(e,t)=>{var r;return((r=Eb[t])==null?void 0:r[e])||Eb.industrial.queued},br={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},Cs={GAP:8,WIDTH:280},rd=["pgc","asm","draft","qa","done"],Tn=["industrial","light","blueprint"];function YD({questions:e,nodeWidth:t,onSubmit:r,onClose:n,onZoomComplete:i}){const[o,s]=m.useState({}),a=e.filter(c=>c.required).every(c=>o[c.id]);return m.useEffect(()=>{if(i){const c=setTimeout(()=>i(),150);return()=>clearTimeout(c)}},[i]),l.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+Cs.GAP,width:Cs.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[l.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:Cs.GAP}}),l.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),l.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[l.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),l.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),l.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>l.jsxs("div",{children:[l.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&l.jsx("span",{className:"text-amber-600",children:"*"})]}),l.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:o[c.id]||"",onChange:u=>s(d=>({...d,[c.id]:u.target.value}))})]},c.id))}),l.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:l.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${a?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!a,onClick:()=>r(o),children:"Submit & Continue"})})]})}function KD({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:i}){const o=e.length>6,s=o?240:320;return m.useEffect(()=>{if(i){const a=setTimeout(()=>i(),150);return()=>clearTimeout(a)}},[i]),l.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:r+Cs.GAP,width:s,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[l.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:Cs.GAP}}),l.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),l.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[l.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),l.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),l.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${o?"":"grid grid-cols-2 gap-2"}`,children:e.map(a=>{const c=a.state==="complete"?"var(--state-stabilized-bg)":a.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return l.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${o?"mb-1":""}`,children:[l.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),l.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:a.name})]},a.id)})}),l.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const Gx="/api/v1";class XD extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function QD(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Me(e,t={}){const r=`${Gx}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},i=await fetch(r,n);if(!i.ok){const o=await i.json().catch(()=>({}));throw new XD(o.detail||`Request failed: ${i.status}`,i.status,o)}return i.status===204?null:i.json()}const He={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":QD()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return Me(`/projects${r?"?"+r:""}`)},getProject:e=>Me(`/projects/${e}`),getProjectTree:e=>Me(`/projects/${e}/tree`),createProject:e=>Me("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>Me(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>Me(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>Me(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>Me(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>Me(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),Me(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>Me(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>Me(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>Me("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>Me(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>Me(`/document-workflows/executions/${e}`),getPgcAnswers:e=>Me(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>Me(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>Me(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>Me("/intake/start",{method:"POST"}),getIntakeState:e=>Me(`/intake/${e}`),submitIntakeMessage:(e,t)=>Me(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>Me(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>Me(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>Me(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>Me(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>Me(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>Me(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>Me(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>Me(`/projects/${e}/workflow/complete`,{method:"POST"})};function ZD(e){const t=`${Gx}/production/events?project_id=${e}`;return new EventSource(t)}function JD(e){const t=`${Gx}/intake/${e}/events`;return new EventSource(t)}function e6(e){return`/auth/login/${e}`}function t6({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?l.jsxs("div",{style:{marginBottom:12},children:[l.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&l.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Rb({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const i=n==="numbered"?"decimal":"disc";return l.jsxs("div",{style:{marginBottom:12},children:[t.title&&l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),l.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":i},children:r.map((o,s)=>l.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&l.jsx("span",{style:{color:"#10b981"},children:""}),typeof o=="string"?o:(o==null?void 0:o.value)||(o==null?void 0:o.text)||(o==null?void 0:o.question)||(o==null?void 0:o.description)||JSON.stringify(o)]},s))})]})}function r6({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,o={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return l.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&l.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),l.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:o.bg,color:o.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function cE({block:e}){const{data:t}=e,{id:r,text:n,blocking:i,why_it_matters:o,priority:s,tags:a,options:c}=t,u={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},d=u[s]||u.should;return l.jsx("div",{style:{padding:"12px 16px",background:i?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${i?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),l.jsxs("div",{style:{flex:1},children:[l.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),o&&l.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:o}),l.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[i&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),s&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:d.bg,color:d.text,textTransform:"uppercase"},children:s}),a==null?void 0:a.map((f,h)=>l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},h))]}),c&&c.length>0&&l.jsxs("div",{style:{marginTop:8},children:[l.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,h)=>l.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:h>0?8:4},children:f},h))]})]})]})})}function n6({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,i=t.blocking_count||r.filter(o=>o.blocking).length;return r.length===0?l.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):l.jsxs("div",{children:[l.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[l.jsxs("span",{style:{color:"#6b7280"},children:[l.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),i>0&&l.jsxs("span",{style:{color:"#dc2626"},children:[l.jsx("strong",{children:i})," blocking"]})]}),r.map((o,s)=>l.jsx(cE,{block:{type:"schema:OpenQuestionV1",data:o}},o.id||s))]})}function Tb({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const i={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return l.jsxs("div",{style:{marginBottom:12},children:[n&&l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,s)=>{const a=o.severity||o.likelihood||"medium",c=i[a]||i.medium;return l.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[o.id&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:o.id}),l.jsxs("div",{style:{flex:1},children:[l.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:o.description||o.reason||JSON.stringify(o)}),o.impact&&l.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",o.impact]}),o.mitigation&&l.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",o.mitigation]})]}),l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:a})]})},o.id||s)})})]})}function i6({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([i])=>t[i]&&typeof t[i]=="string").map(([i,o])=>({title:o,content:t[i]}));return n.length===0?null:l.jsx("div",{style:{marginBottom:12},children:n.map((i,o)=>l.jsxs("div",{style:{marginBottom:o<n.length-1?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:i.title}),l.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:l.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:i.content})})]},o))})}function Ab({block:e}){const{data:t}=e,{epic_id:r,title:n,name:i,intent:o,phase:s,mvp_phase:a,risk_level:c,stories:u,detail_ref:d}=t,f=s||a,h=n||i,p={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},y=p[c]||p.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},w=g[f]||g.mvp;return l.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),l.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:h})]}),o&&l.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:o}),u&&u.length>0&&l.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[u.length," stories"]})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:w.bg,color:w.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&l.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:y.bg,color:y.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),d&&l.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:l.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function o6({block:e}){const{data:t}=e,{story_id:r,title:n,intent:i,phase:o,risk_level:s,detail_ref:a}=t,u={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[s]||null,d={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=d[o]||d.mvp;return l.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),l.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),i&&l.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:i})]}),l.jsxs("div",{style:{display:"flex",gap:4},children:[o&&l.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:o}),u&&l.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:u.bg,color:u.text,textTransform:"uppercase",fontWeight:500},children:s})]})]})})}function s6({block:e}){const{type:t,data:r}=e;return l.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[l.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),l.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function a6({block:e}){const{data:t}=e,r=t.items||[],[n,i]=m.useState({});if(r.length===0)return null;const o=s=>{i(a=>({...a,[s]:!a[s]}))};return l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((s,a)=>{const c=n[a],u=s.why_it_matters||s.impact_if_unresolved;return l.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[l.jsxs("button",{onClick:()=>u&&o(a),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:u?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[l.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:s.question||s.value||s.text||"Unknown"}),u&&l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:l.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&u&&l.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[s.why_it_matters&&l.jsxs("div",{style:{marginTop:10},children:[l.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),l.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:s.why_it_matters})]}),s.impact_if_unresolved&&l.jsxs("div",{style:{marginTop:10},children:[l.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),l.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:s.impact_if_unresolved})]})]})]},a)})})}function l6({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return l.jsxs("div",{style:{marginBottom:12},children:[r&&l.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&l.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function c6({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:i}=t;return l.jsxs("div",{style:{marginBottom:12},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[l.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&l.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),i&&l.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i})]})}function u6({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,i=r&&r.length>0,o=n&&n.length>0;return!i&&!o?null:l.jsxs("div",{style:{marginBottom:12},children:[i&&l.jsxs("div",{style:{marginBottom:o?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((s,a)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#f59e0b"},children:""}),l.jsx("span",{children:s})]},a))})]}),o&&l.jsxs("div",{children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((s,a)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#3b82f6"},children:""}),l.jsx("span",{children:s})]},a))})]})]})}function d6({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:i=[]}=t,o=r&&r.length>0,s=n&&n.length>0,a=i&&i.length>0;return!o&&!s&&!a?null:l.jsxs("div",{style:{marginBottom:12},children:[o&&l.jsxs("div",{style:{marginBottom:s||a?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#3b82f6"},children:""}),l.jsx("span",{children:c})]},u))})]}),s&&l.jsxs("div",{style:{marginBottom:a?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#f59e0b"},children:""}),l.jsx("span",{children:c})]},u))})]}),a&&l.jsxs("div",{children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:i.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#6b7280"},children:""}),l.jsx("span",{children:c})]},u))})]})]})}function f6({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:i}=t,s={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return l.jsxs("div",{style:{marginBottom:12},children:[r&&l.jsx("div",{style:{marginBottom:12},children:l.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:s.bg,color:s.text},children:r})}),n&&l.jsx("p",{style:{margin:0,marginBottom:i?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),i&&l.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:l.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",i]})})]})}const p6={"schema:ParagraphBlockV1":t6,"schema:StringListBlockV1":Rb,"schema:IndicatorBlockV1":r6,"schema:OpenQuestionV1":cE,"schema:OpenQuestionsBlockV1":n6,"schema:RisksBlockV1":Tb,"schema:DependenciesBlockV1":Tb,"schema:SummaryBlockV1":i6,"schema:EpicSummaryBlockV1":Ab,"schema:StorySummaryBlockV1":o6,"schema:EpicStoriesCardBlockV1":Ab,"schema:StoriesBlockV1":Rb,"schema:UnknownsBlockV1":a6,"schema:IntakeSummaryBlockV1":l6,"schema:IntakeProjectTypeBlockV1":c6,"schema:IntakeConstraintsBlockV1":u6,"schema:IntakeOpenGapsBlockV1":d6,"schema:IntakeOutcomeBlockV1":f6};function h6(e){return p6[e]||s6}function m6(e,t){const r=h6(e.type);return l.jsx(r,{block:e},e.key||t)}function uE({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:i=""}){var w;const[o,s]=m.useState(new Set(((w=e==null?void 0:e.sections)==null?void 0:w.map(v=>v.section_id))||[]));if(!e)return l.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:a,subtitle:c,sections:u=[],metadata:d}=e;if(d!=null&&d.fallback&&e.raw_content)return l.jsx(v6,{title:a,content:e.raw_content,reason:d.reason});const f=v=>{s(x=>{const b=new Set(x);return b.has(v)?b.delete(v):b.add(v),b})},h=t==="compact"||t==="sidecar",y=t==="sidecar"?u.filter(v=>v.viewer_tab==="overview"||!v.viewer_tab):u,g=(()=>{if(!a)return"Document";const v=a.indexOf(": ");return v>-1?a.slice(v+2):a})();return l.jsxs("div",{className:i,children:[t==="full"&&!r&&l.jsxs("div",{style:{marginBottom:24},children:[l.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&l.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:h?12:20},children:y.map(v=>l.jsx(g6,{section:v,isExpanded:o.has(v.section_id),onToggle:()=>f(v.section_id),onClick:()=>n==null?void 0:n(v),variant:t},v.section_id))}),y.length===0&&l.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function g6({section:e,isExpanded:t,onToggle:r,onClick:n,variant:i}){const{section_id:o,title:s,description:a,blocks:c=[],sidecar_max_items:u}=e,d=i==="compact"||i==="sidecar",f=i==="sidecar";if(c.length===0)return null;const h=f&&u&&c.length>u?c.slice(0,u):c,p=f&&u&&c.length>u;return l.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[l.jsxs("button",{onClick:r,style:{width:"100%",padding:d?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[l.jsxs("div",{children:[l.jsxs("h3",{style:{margin:0,fontSize:d?13:15,fontWeight:600,color:"#111827"},children:[s,p&&l.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",u," of ",c.length,")"]})]}),a&&!d&&l.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:a})]}),l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:l.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&l.jsxs("div",{style:{padding:d?12:18},children:[h.map((y,g)=>m6(y,g)),p&&l.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-u," more in full view"]})]})]})}function v6({title:e,content:t,reason:r}){return l.jsxs("div",{children:[l.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function x6({renderModel:e,projectCode:t,documentName:r,isExpanded:n,onToggleExpand:i,onClose:o,onViewFull:s,nodeWidth:a=280}){const h=n?900:520,p=n?900:600,y=`${t||"DOC"} - ${r||"Document"}`,g=w=>{w.stopPropagation()};return l.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:a+30,width:h,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[l.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),l.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),l.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:p,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),l.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const w=(e==null?void 0:e.title)||"DOCUMENT",v=w.indexOf(": ");return(v>-1?w.slice(v+2):w).toUpperCase()})()}),l.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:i,title:n?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:n?l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),l.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),l.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:n?600:400},children:l.jsx(uE,{renderModel:e,variant:"sidecar"})}),l.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:l.jsxs("button",{onClick:s,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[l.jsx("span",{children:"View Full Document"}),l.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function y6({document:e,projectId:t,projectCode:r,nodeWidth:n,onClose:i,onZoomComplete:o,onViewFull:s}){const[a,c]=m.useState(null),[u,d]=m.useState(null),[f,h]=m.useState(!0),[p,y]=m.useState(!1);return m.useEffect(()=>{if(o){const g=setTimeout(()=>o(),150);return()=>clearTimeout(g)}},[o]),m.useEffect(()=>{async function g(){var w;if(!t||!e.id){h(!1);return}try{h(!0);try{const x=await He.getDocumentRenderModel(t,e.id);if(x&&x.sections&&x.sections.length>0){c(x),d(null);return}if((w=x==null?void 0:x.metadata)!=null&&w.fallback&&x.raw_content){c(null),d(x.raw_content);return}}catch(x){console.log("RenderModel not available, falling back to raw document:",x.message)}const v=await He.getDocument(t,e.id);c(null),d((v==null?void 0:v.content)||null)}catch(v){console.error("Failed to fetch document for sidecar:",v)}finally{h(!1)}}g()},[t,e.id]),f?null:a?l.jsx(x6,{renderModel:a,projectCode:r,documentName:e.name,isExpanded:p,onToggleExpand:()=>y(!p),onClose:i,onViewFull:()=>s==null?void 0:s(e.id),nodeWidth:n}):l.jsx(b6,{document:e,projectCode:r,rawContent:u,nodeWidth:n,isExpanded:p,onToggleExpand:()=>y(!p),onClose:i,onViewFull:()=>s==null?void 0:s(e.id)})}function b6({document:e,projectCode:t,rawContent:r,nodeWidth:n,isExpanded:i,onToggleExpand:o,onClose:s,onViewFull:a}){var w;const h=i?900:520,p=i?900:600,y=`${t||"DOC"} - ${e.name||"Document"}`,g=v=>{v.stopPropagation()};return l.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:n+30,width:h,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:g,onPointerDown:g,children:[l.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),l.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),l.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:p,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),l.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((w=e.name)==null?void 0:w.toUpperCase())||"DOCUMENT"}),l.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:o,title:i?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i?l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),l.jsx("button",{onClick:s,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),l.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:i?600:400},children:[l.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]}),l.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:l.jsxs("button",{onClick:a,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[l.jsx("span",{children:"View Full Document"}),l.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const w6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function _6({data:e}){var _,j,k;const r=(e.level||1)===1,n=e.isExpanded,i=e.expandType,o=((_=e.questions)==null?void 0:_.length)>0,s=((j=e.features)==null?void 0:j.length)>0,a=(k=e.stations)==null?void 0:k.some(N=>N.needs_input),c=e.state||"ready_for_production",u=["produced","stabilized","ready"].includes(c),d=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),h=d&&e.stations,p=d?"node-active":"",y=r?"DOCUMENT":"EPIC",g=r?"subway-node-header-doc":"subway-node-header-epic",w=u?"var(--state-produced-bg, var(--state-stabilized-bg))":d?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",v=u?"var(--state-produced-text, var(--state-stabilized-text))":d?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",x=d?"var(--state-in-production-bg, var(--state-active-bg))":u?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=w6[c]||c;return l.jsxs("div",{className:"relative",children:[l.jsx(Wr,{type:"target",position:re.Top,className:"!opacity-0",style:{left:"15%"}}),l.jsxs("div",{className:`subway-node rounded-lg border ${p} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:x},children:[l.jsxs("div",{className:`${g} border-b px-3 py-1.5 flex items-center justify-between`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:y}),l.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&l.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),l.jsxs("div",{className:"p-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:w}}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:v},children:b}),r&&e.desc&&l.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),h&&l.jsx(GD,{stations:e.stations}),l.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&u&&l.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"document")},children:"View Document"}),a&&o&&!n&&l.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&s&&(n&&i==="features"?l.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):l.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"features")},children:[l.jsx("span",{className:"text-indigo-400",children:e.features.length}),l.jsx("span",{children:"features"}),l.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),n&&i==="questions"&&o&&l.jsx(YD,{questions:e.questions,nodeWidth:e.width,onSubmit:N=>{var E;return(E=e.onSubmitQuestions)==null?void 0:E.call(e,e.id,N)},onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&i==="features"&&s&&l.jsx(KD,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&i==="document"&&r&&u&&l.jsx(y6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)},onViewFull:N=>{var E;return(E=e.onViewFullDocument)==null?void 0:E.call(e,N)}}),l.jsx(Wr,{type:"source",position:re.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function S6(){return l.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[l.jsx(Wr,{type:"target",position:re.Top,style:{opacity:0}}),l.jsx(Wr,{type:"source",position:re.Bottom,style:{opacity:0}})]})}function k6({projectId:e,projectCode:t,docTypeId:r,onClose:n}){const[i,o]=m.useState(null),[s,a]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null);return m.useEffect(()=>{async function h(){var p;try{u(!0),f(null);try{const g=await He.getDocumentRenderModel(e,r);if(g&&g.sections&&g.sections.length>0){o(g),a(null);return}if((p=g==null?void 0:g.metadata)!=null&&p.fallback&&g.raw_content){o(null),a(g.raw_content);return}}catch(g){console.log("RenderModel not available, falling back to raw document:",g.message)}const y=await He.getDocument(e,r);o(null),a((y==null?void 0:y.content)||null)}catch(y){f(y.message),console.error("Failed to fetch document:",y)}finally{u(!1)}}h()},[e,r]),m.useEffect(()=>{const h=p=>{p.key==="Escape"&&n()};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[n]),c?l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:l.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:h=>h.target===h.currentTarget&&n(),children:l.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[l.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[l.jsx("div",{children:t&&l.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),l.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[d&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-red-500",children:d})}),i&&l.jsx(uE,{renderModel:i,variant:"full"}),s&&!i&&l.jsx(j6,{content:s,docTypeId:r}),!i&&!s&&!d&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function j6({content:e,docTypeId:t}){if(!e)return l.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n=e.description||e.summary||e.preliminary_summary;return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",l.jsx("strong",{children:t})," - displaying raw content"]}),(r||n)&&l.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[r&&l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),n&&l.jsx("p",{className:"text-gray-700 text-sm",children:n})]}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const C6="/api/v1/admin";class N6 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function E6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ne(e,t={}){var o;const r=`${C6}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const s=E6();s&&(n.headers["X-CSRF-Token"]=s)}const i=await fetch(r,n);if(!i.ok){const s=await i.json().catch(()=>({})),a=((o=s.detail)==null?void 0:o.message)||s.detail||`Request failed: ${i.status}`;throw new N6(a,i.status,s.detail||s)}return i.status===204?null:i.json()}const ye={getCurrentWorkspace:async()=>{try{return await Ne("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ne("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ne(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ne(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ne(`/workspaces/${e}/artifacts/${t}`),writeArtifact:(e,t,r)=>Ne(`/workspaces/${e}/artifacts/${t}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ne(`/workspaces/${e}/preview/${t}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ne(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ne(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ne(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ne("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ne(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ne("/workbench/prompt-fragments"),getRoles:()=>Ne("/workbench/roles"),getTemplates:()=>Ne("/workbench/templates"),getSchemas:()=>Ne("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ne("/workbench/workflows"),getOrchestrationWorkflows:()=>Ne("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ne(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ne(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ne(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ne(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ne("/workbench/active-releases"),invalidateCache:()=>Ne("/workbench/cache/invalidate",{method:"POST"})};function R6({projectId:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[o,s]=m.useState(null),[a,c]=m.useState(!1),[u,d]=m.useState([]),[f,h]=m.useState(!1),[p,y]=m.useState(!1),[g,w]=m.useState(null),[v,x]=m.useState(!1),[b,_]=m.useState(!1),j=m.useCallback(async()=>{if(e){i(!0),s(null);try{const P=await He.getWorkflowInstance(e);r(P)}catch(P){P.status===404?r(null):s(P.message)}finally{i(!1)}}},[e]);m.useEffect(()=>{j()},[j]);const k=async()=>{c(!0),h(!0);try{const P=await ye.getOrchestrationWorkflows();d(P.workflows||[])}catch{d([])}finally{h(!1)}},N=async P=>{y(!0);try{const F=await He.createWorkflowInstance(e,P.workflow_id,P.active_version);r(F),c(!1)}catch(F){s(F.message)}finally{y(!1)}},E=async()=>{if(t&&(_(!b),!g)){x(!0);try{const P=await He.getWorkflowDrift(e);w(P)}catch(P){w({error:P.message})}finally{x(!1)}}};if(n)return l.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(o&&!t)return l.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:o});if(!t)return l.jsxs("div",{className:"p-4",children:[l.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),a?l.jsx(T6,{workflows:u,loading:f,assigning:p,onSelect:N,onCancel:()=>c(!1)}):l.jsx("button",{onClick:k,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const C=t.effective_workflow||{},T=C.steps||[],R=t.base_workflow_ref||{};return l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:C.name||R.workflow_id||"Workflow"}),l.jsx(A6,{status:t.status})]}),l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",R.workflow_id," v",R.version,R.pow_class?` (${R.pow_class})`:""]})]}),l.jsx("button",{onClick:E,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:v?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&l.jsx(I6,{drift:g}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",T.length,")"]}),T.length===0?l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):l.jsx("div",{className:"space-y-1",children:T.map((P,F)=>l.jsx(M6,{step:P,index:F},P.step_id||F))})]}),o&&l.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:o})]})}function T6({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:i}){const o=e.filter(a=>(a.pow_class||"reference")==="reference"),s=e.filter(a=>a.pow_class==="template");return l.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):l.jsxs(l.Fragment,{children:[o.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),o.map(a=>l.jsxs("button",{onClick:()=>n(a),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[l.jsx("div",{className:"font-medium",children:a.name||a.workflow_id}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",a.active_version,"  ",a.step_count," steps"]})]},a.workflow_id))]}),s.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),s.map(a=>l.jsxs("button",{onClick:()=>n(a),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[l.jsx("div",{className:"font-medium",children:a.name||a.workflow_id}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",a.active_version,"  ",a.step_count," steps",a.derived_from_label?`  from ${a.derived_from_label}`:""]})]},a.workflow_id))]}),o.length===0&&s.length===0&&l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),l.jsx("button",{onClick:i,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function A6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return l.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function I6({drift:e}){return e.error?l.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):l.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[l.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[l.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),l.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&l.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&l.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&l.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&l.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&l.jsx("div",{children:"~ Metadata changed"})]})]})}function M6({step:e,index:t}){return l.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),l.jsxs("div",{style:{flex:1},children:[l.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&l.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&l.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function Yx(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nd,Ib;function P6(){if(Ib)return nd;Ib=1;function e(){this.__data__=[],this.size=0}return nd=e,nd}var id,Mb;function Ao(){if(Mb)return id;Mb=1;function e(t,r){return t===r||t!==t&&r!==r}return id=e,id}var od,Pb;function Wc(){if(Pb)return od;Pb=1;var e=Ao();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return od=t,od}var sd,Ob;function O6(){if(Ob)return sd;Ob=1;var e=Wc(),t=Array.prototype,r=t.splice;function n(i){var o=this.__data__,s=e(o,i);if(s<0)return!1;var a=o.length-1;return s==a?o.pop():r.call(o,s,1),--this.size,!0}return sd=n,sd}var ad,Db;function D6(){if(Db)return ad;Db=1;var e=Wc();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return ad=t,ad}var ld,Lb;function L6(){if(Lb)return ld;Lb=1;var e=Wc();function t(r){return e(this.__data__,r)>-1}return ld=t,ld}var cd,Fb;function F6(){if(Fb)return cd;Fb=1;var e=Wc();function t(r,n){var i=this.__data__,o=e(i,r);return o<0?(++this.size,i.push([r,n])):i[o][1]=n,this}return cd=t,cd}var ud,zb;function Uc(){if(zb)return ud;zb=1;var e=P6(),t=O6(),r=D6(),n=L6(),i=F6();function o(s){var a=-1,c=s==null?0:s.length;for(this.clear();++a<c;){var u=s[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,ud=o,ud}var dd,qb;function z6(){if(qb)return dd;qb=1;var e=Uc();function t(){this.__data__=new e,this.size=0}return dd=t,dd}var fd,$b;function q6(){if($b)return fd;$b=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return fd=e,fd}var pd,Bb;function $6(){if(Bb)return pd;Bb=1;function e(t){return this.__data__.get(t)}return pd=e,pd}var hd,Hb;function B6(){if(Hb)return hd;Hb=1;function e(t){return this.__data__.has(t)}return hd=e,hd}var md,Wb;function dE(){if(Wb)return md;Wb=1;var e=typeof ka=="object"&&ka&&ka.Object===Object&&ka;return md=e,md}var gd,Ub;function Ar(){if(Ub)return gd;Ub=1;var e=dE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return gd=r,gd}var vd,Vb;function Io(){if(Vb)return vd;Vb=1;var e=Ar(),t=e.Symbol;return vd=t,vd}var xd,Gb;function H6(){if(Gb)return xd;Gb=1;var e=Io(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function o(s){var a=r.call(s,i),c=s[i];try{s[i]=void 0;var u=!0}catch{}var d=n.call(s);return u&&(a?s[i]=c:delete s[i]),d}return xd=o,xd}var yd,Yb;function W6(){if(Yb)return yd;Yb=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return yd=r,yd}var bd,Kb;function Ri(){if(Kb)return bd;Kb=1;var e=Io(),t=H6(),r=W6(),n="[object Null]",i="[object Undefined]",o=e?e.toStringTag:void 0;function s(a){return a==null?a===void 0?i:n:o&&o in Object(a)?t(a):r(a)}return bd=s,bd}var wd,Xb;function hr(){if(Xb)return wd;Xb=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return wd=e,wd}var _d,Qb;function ga(){if(Qb)return _d;Qb=1;var e=Ri(),t=hr(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",o="[object Proxy]";function s(a){if(!t(a))return!1;var c=e(a);return c==n||c==i||c==r||c==o}return _d=s,_d}var Sd,Zb;function U6(){if(Zb)return Sd;Zb=1;var e=Ar(),t=e["__core-js_shared__"];return Sd=t,Sd}var kd,Jb;function V6(){if(Jb)return kd;Jb=1;var e=U6(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return kd=r,kd}var jd,e1;function fE(){if(e1)return jd;e1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return jd=r,jd}var Cd,t1;function G6(){if(t1)return Cd;t1=1;var e=ga(),t=V6(),r=hr(),n=fE(),i=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,s=Function.prototype,a=Object.prototype,c=s.toString,u=a.hasOwnProperty,d=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(h){if(!r(h)||t(h))return!1;var p=e(h)?d:o;return p.test(n(h))}return Cd=f,Cd}var Nd,r1;function Y6(){if(r1)return Nd;r1=1;function e(t,r){return t==null?void 0:t[r]}return Nd=e,Nd}var Ed,n1;function Ti(){if(n1)return Ed;n1=1;var e=G6(),t=Y6();function r(n,i){var o=t(n,i);return e(o)?o:void 0}return Ed=r,Ed}var Rd,i1;function Kx(){if(i1)return Rd;i1=1;var e=Ti(),t=Ar(),r=e(t,"Map");return Rd=r,Rd}var Td,o1;function Vc(){if(o1)return Td;o1=1;var e=Ti(),t=e(Object,"create");return Td=t,Td}var Ad,s1;function K6(){if(s1)return Ad;s1=1;var e=Vc();function t(){this.__data__=e?e(null):{},this.size=0}return Ad=t,Ad}var Id,a1;function X6(){if(a1)return Id;a1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Id=e,Id}var Md,l1;function Q6(){if(l1)return Md;l1=1;var e=Vc(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(o){var s=this.__data__;if(e){var a=s[o];return a===t?void 0:a}return n.call(s,o)?s[o]:void 0}return Md=i,Md}var Pd,c1;function Z6(){if(c1)return Pd;c1=1;var e=Vc(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var o=this.__data__;return e?o[i]!==void 0:r.call(o,i)}return Pd=n,Pd}var Od,u1;function J6(){if(u1)return Od;u1=1;var e=Vc(),t="__lodash_hash_undefined__";function r(n,i){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=e&&i===void 0?t:i,this}return Od=r,Od}var Dd,d1;function eL(){if(d1)return Dd;d1=1;var e=K6(),t=X6(),r=Q6(),n=Z6(),i=J6();function o(s){var a=-1,c=s==null?0:s.length;for(this.clear();++a<c;){var u=s[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,Dd=o,Dd}var Ld,f1;function tL(){if(f1)return Ld;f1=1;var e=eL(),t=Uc(),r=Kx();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Ld=n,Ld}var Fd,p1;function rL(){if(p1)return Fd;p1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Fd=e,Fd}var zd,h1;function Gc(){if(h1)return zd;h1=1;var e=rL();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return zd=t,zd}var qd,m1;function nL(){if(m1)return qd;m1=1;var e=Gc();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return qd=t,qd}var $d,g1;function iL(){if(g1)return $d;g1=1;var e=Gc();function t(r){return e(this,r).get(r)}return $d=t,$d}var Bd,v1;function oL(){if(v1)return Bd;v1=1;var e=Gc();function t(r){return e(this,r).has(r)}return Bd=t,Bd}var Hd,x1;function sL(){if(x1)return Hd;x1=1;var e=Gc();function t(r,n){var i=e(this,r),o=i.size;return i.set(r,n),this.size+=i.size==o?0:1,this}return Hd=t,Hd}var Wd,y1;function Xx(){if(y1)return Wd;y1=1;var e=tL(),t=nL(),r=iL(),n=oL(),i=sL();function o(s){var a=-1,c=s==null?0:s.length;for(this.clear();++a<c;){var u=s[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,Wd=o,Wd}var Ud,b1;function aL(){if(b1)return Ud;b1=1;var e=Uc(),t=Kx(),r=Xx(),n=200;function i(o,s){var a=this.__data__;if(a instanceof e){var c=a.__data__;if(!t||c.length<n-1)return c.push([o,s]),this.size=++a.size,this;a=this.__data__=new r(c)}return a.set(o,s),this.size=a.size,this}return Ud=i,Ud}var Vd,w1;function Yc(){if(w1)return Vd;w1=1;var e=Uc(),t=z6(),r=q6(),n=$6(),i=B6(),o=aL();function s(a){var c=this.__data__=new e(a);this.size=c.size}return s.prototype.clear=t,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=o,Vd=s,Vd}var Gd,_1;function Qx(){if(_1)return Gd;_1=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return Gd=e,Gd}var Yd,S1;function pE(){if(S1)return Yd;S1=1;var e=Ti(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return Yd=t,Yd}var Kd,k1;function Kc(){if(k1)return Kd;k1=1;var e=pE();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return Kd=t,Kd}var Xd,j1;function Xc(){if(j1)return Xd;j1=1;var e=Kc(),t=Ao(),r=Object.prototype,n=r.hasOwnProperty;function i(o,s,a){var c=o[s];(!(n.call(o,s)&&t(c,a))||a===void 0&&!(s in o))&&e(o,s,a)}return Xd=i,Xd}var Qd,C1;function va(){if(C1)return Qd;C1=1;var e=Xc(),t=Kc();function r(n,i,o,s){var a=!o;o||(o={});for(var c=-1,u=i.length;++c<u;){var d=i[c],f=s?s(o[d],n[d],d,o,n):void 0;f===void 0&&(f=n[d]),a?t(o,d,f):e(o,d,f)}return o}return Qd=r,Qd}var Zd,N1;function lL(){if(N1)return Zd;N1=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return Zd=e,Zd}var Jd,E1;function Gr(){if(E1)return Jd;E1=1;function e(t){return t!=null&&typeof t=="object"}return Jd=e,Jd}var ef,R1;function cL(){if(R1)return ef;R1=1;var e=Ri(),t=Gr(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return ef=n,ef}var tf,T1;function xa(){if(T1)return tf;T1=1;var e=cL(),t=Gr(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(s){return t(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return tf=o,tf}var rf,A1;function st(){if(A1)return rf;A1=1;var e=Array.isArray;return rf=e,rf}var us={exports:{}},nf,I1;function uL(){if(I1)return nf;I1=1;function e(){return!1}return nf=e,nf}us.exports;var M1;function Mo(){return M1||(M1=1,function(e,t){var r=Ar(),n=uL(),i=t&&!t.nodeType&&t,o=i&&!0&&e&&!e.nodeType&&e,s=o&&o.exports===i,a=s?r.Buffer:void 0,c=a?a.isBuffer:void 0,u=c||n;e.exports=u}(us,us.exports)),us.exports}var of,P1;function Qc(){if(P1)return of;P1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var o=typeof n;return i=i??e,!!i&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return of=r,of}var sf,O1;function Zx(){if(O1)return sf;O1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return sf=t,sf}var af,D1;function dL(){if(D1)return af;D1=1;var e=Ri(),t=Zx(),r=Gr(),n="[object Arguments]",i="[object Array]",o="[object Boolean]",s="[object Date]",a="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",f="[object Object]",h="[object RegExp]",p="[object Set]",y="[object String]",g="[object WeakMap]",w="[object ArrayBuffer]",v="[object DataView]",x="[object Float32Array]",b="[object Float64Array]",_="[object Int8Array]",j="[object Int16Array]",k="[object Int32Array]",N="[object Uint8Array]",E="[object Uint8ClampedArray]",C="[object Uint16Array]",T="[object Uint32Array]",R={};R[x]=R[b]=R[_]=R[j]=R[k]=R[N]=R[E]=R[C]=R[T]=!0,R[n]=R[i]=R[w]=R[o]=R[v]=R[s]=R[a]=R[c]=R[u]=R[d]=R[f]=R[h]=R[p]=R[y]=R[g]=!1;function P(F){return r(F)&&t(F.length)&&!!R[e(F)]}return af=P,af}var lf,L1;function Zc(){if(L1)return lf;L1=1;function e(t){return function(r){return t(r)}}return lf=e,lf}var ds={exports:{}};ds.exports;var F1;function Jx(){return F1||(F1=1,function(e,t){var r=dE(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,s=o&&r.process,a=function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();e.exports=a}(ds,ds.exports)),ds.exports}var cf,z1;function ya(){if(z1)return cf;z1=1;var e=dL(),t=Zc(),r=Jx(),n=r&&r.isTypedArray,i=n?t(n):e;return cf=i,cf}var uf,q1;function hE(){if(q1)return uf;q1=1;var e=lL(),t=xa(),r=st(),n=Mo(),i=Qc(),o=ya(),s=Object.prototype,a=s.hasOwnProperty;function c(u,d){var f=r(u),h=!f&&t(u),p=!f&&!h&&n(u),y=!f&&!h&&!p&&o(u),g=f||h||p||y,w=g?e(u.length,String):[],v=w.length;for(var x in u)(d||a.call(u,x))&&!(g&&(x=="length"||p&&(x=="offset"||x=="parent")||y&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||i(x,v)))&&w.push(x);return w}return uf=c,uf}var df,$1;function Jc(){if($1)return df;$1=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return df=t,df}var ff,B1;function mE(){if(B1)return ff;B1=1;function e(t,r){return function(n){return t(r(n))}}return ff=e,ff}var pf,H1;function fL(){if(H1)return pf;H1=1;var e=mE(),t=e(Object.keys,Object);return pf=t,pf}var hf,W1;function ey(){if(W1)return hf;W1=1;var e=Jc(),t=fL(),r=Object.prototype,n=r.hasOwnProperty;function i(o){if(!e(o))return t(o);var s=[];for(var a in Object(o))n.call(o,a)&&a!="constructor"&&s.push(a);return s}return hf=i,hf}var mf,U1;function vn(){if(U1)return mf;U1=1;var e=ga(),t=Zx();function r(n){return n!=null&&t(n.length)&&!e(n)}return mf=r,mf}var gf,V1;function ei(){if(V1)return gf;V1=1;var e=hE(),t=ey(),r=vn();function n(i){return r(i)?e(i):t(i)}return gf=n,gf}var vf,G1;function pL(){if(G1)return vf;G1=1;var e=va(),t=ei();function r(n,i){return n&&e(i,t(i),n)}return vf=r,vf}var xf,Y1;function hL(){if(Y1)return xf;Y1=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return xf=e,xf}var yf,K1;function mL(){if(K1)return yf;K1=1;var e=hr(),t=Jc(),r=hL(),n=Object.prototype,i=n.hasOwnProperty;function o(s){if(!e(s))return r(s);var a=t(s),c=[];for(var u in s)u=="constructor"&&(a||!i.call(s,u))||c.push(u);return c}return yf=o,yf}var bf,X1;function Ai(){if(X1)return bf;X1=1;var e=hE(),t=mL(),r=vn();function n(i){return r(i)?e(i,!0):t(i)}return bf=n,bf}var wf,Q1;function gL(){if(Q1)return wf;Q1=1;var e=va(),t=Ai();function r(n,i){return n&&e(i,t(i),n)}return wf=r,wf}var fs={exports:{}};fs.exports;var Z1;function gE(){return Z1||(Z1=1,function(e,t){var r=Ar(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,s=o?r.Buffer:void 0,a=s?s.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var f=u.length,h=a?a(f):new u.constructor(f);return u.copy(h),h}e.exports=c}(fs,fs.exports)),fs.exports}var _f,J1;function vE(){if(J1)return _f;J1=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return _f=e,_f}var Sf,ew;function xE(){if(ew)return Sf;ew=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,o=0,s=[];++n<i;){var a=t[n];r(a,n,t)&&(s[o++]=a)}return s}return Sf=e,Sf}var kf,tw;function yE(){if(tw)return kf;tw=1;function e(){return[]}return kf=e,kf}var jf,rw;function ty(){if(rw)return jf;rw=1;var e=xE(),t=yE(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,o=i?function(s){return s==null?[]:(s=Object(s),e(i(s),function(a){return n.call(s,a)}))}:t;return jf=o,jf}var Cf,nw;function vL(){if(nw)return Cf;nw=1;var e=va(),t=ty();function r(n,i){return e(n,t(n),i)}return Cf=r,Cf}var Nf,iw;function ry(){if(iw)return Nf;iw=1;function e(t,r){for(var n=-1,i=r.length,o=t.length;++n<i;)t[o+n]=r[n];return t}return Nf=e,Nf}var Ef,ow;function eu(){if(ow)return Ef;ow=1;var e=mE(),t=e(Object.getPrototypeOf,Object);return Ef=t,Ef}var Rf,sw;function bE(){if(sw)return Rf;sw=1;var e=ry(),t=eu(),r=ty(),n=yE(),i=Object.getOwnPropertySymbols,o=i?function(s){for(var a=[];s;)e(a,r(s)),s=t(s);return a}:n;return Rf=o,Rf}var Tf,aw;function xL(){if(aw)return Tf;aw=1;var e=va(),t=bE();function r(n,i){return e(n,t(n),i)}return Tf=r,Tf}var Af,lw;function wE(){if(lw)return Af;lw=1;var e=ry(),t=st();function r(n,i,o){var s=i(n);return t(n)?s:e(s,o(n))}return Af=r,Af}var If,cw;function _E(){if(cw)return If;cw=1;var e=wE(),t=ty(),r=ei();function n(i){return e(i,r,t)}return If=n,If}var Mf,uw;function yL(){if(uw)return Mf;uw=1;var e=wE(),t=bE(),r=Ai();function n(i){return e(i,r,t)}return Mf=n,Mf}var Pf,dw;function bL(){if(dw)return Pf;dw=1;var e=Ti(),t=Ar(),r=e(t,"DataView");return Pf=r,Pf}var Of,fw;function wL(){if(fw)return Of;fw=1;var e=Ti(),t=Ar(),r=e(t,"Promise");return Of=r,Of}var Df,pw;function SE(){if(pw)return Df;pw=1;var e=Ti(),t=Ar(),r=e(t,"Set");return Df=r,Df}var Lf,hw;function _L(){if(hw)return Lf;hw=1;var e=Ti(),t=Ar(),r=e(t,"WeakMap");return Lf=r,Lf}var Ff,mw;function Po(){if(mw)return Ff;mw=1;var e=bL(),t=Kx(),r=wL(),n=SE(),i=_L(),o=Ri(),s=fE(),a="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",f="[object WeakMap]",h="[object DataView]",p=s(e),y=s(t),g=s(r),w=s(n),v=s(i),x=o;return(e&&x(new e(new ArrayBuffer(1)))!=h||t&&x(new t)!=a||r&&x(r.resolve())!=u||n&&x(new n)!=d||i&&x(new i)!=f)&&(x=function(b){var _=o(b),j=_==c?b.constructor:void 0,k=j?s(j):"";if(k)switch(k){case p:return h;case y:return a;case g:return u;case w:return d;case v:return f}return _}),Ff=x,Ff}var zf,gw;function SL(){if(gw)return zf;gw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,o=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(o.index=n.index,o.input=n.input),o}return zf=r,zf}var qf,vw;function kE(){if(vw)return qf;vw=1;var e=Ar(),t=e.Uint8Array;return qf=t,qf}var $f,xw;function ny(){if(xw)return $f;xw=1;var e=kE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return $f=t,$f}var Bf,yw;function kL(){if(yw)return Bf;yw=1;var e=ny();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return Bf=t,Bf}var Hf,bw;function jL(){if(bw)return Hf;bw=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return Hf=t,Hf}var Wf,ww;function CL(){if(ww)return Wf;ww=1;var e=Io(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return Wf=n,Wf}var Uf,_w;function jE(){if(_w)return Uf;_w=1;var e=ny();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return Uf=t,Uf}var Vf,Sw;function NL(){if(Sw)return Vf;Sw=1;var e=ny(),t=kL(),r=jL(),n=CL(),i=jE(),o="[object Boolean]",s="[object Date]",a="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",f="[object String]",h="[object Symbol]",p="[object ArrayBuffer]",y="[object DataView]",g="[object Float32Array]",w="[object Float64Array]",v="[object Int8Array]",x="[object Int16Array]",b="[object Int32Array]",_="[object Uint8Array]",j="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]";function E(C,T,R){var P=C.constructor;switch(T){case p:return e(C);case o:case s:return new P(+C);case y:return t(C,R);case g:case w:case v:case x:case b:case _:case j:case k:case N:return i(C,R);case a:return new P;case c:case f:return new P(C);case u:return r(C);case d:return new P;case h:return n(C)}}return Vf=E,Vf}var Gf,kw;function CE(){if(kw)return Gf;kw=1;var e=hr(),t=Object.create,r=function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var o=new n;return n.prototype=void 0,o}}();return Gf=r,Gf}var Yf,jw;function NE(){if(jw)return Yf;jw=1;var e=CE(),t=eu(),r=Jc();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return Yf=n,Yf}var Kf,Cw;function EL(){if(Cw)return Kf;Cw=1;var e=Po(),t=Gr(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return Kf=n,Kf}var Xf,Nw;function RL(){if(Nw)return Xf;Nw=1;var e=EL(),t=Zc(),r=Jx(),n=r&&r.isMap,i=n?t(n):e;return Xf=i,Xf}var Qf,Ew;function TL(){if(Ew)return Qf;Ew=1;var e=Po(),t=Gr(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return Qf=n,Qf}var Zf,Rw;function AL(){if(Rw)return Zf;Rw=1;var e=TL(),t=Zc(),r=Jx(),n=r&&r.isSet,i=n?t(n):e;return Zf=i,Zf}var Jf,Tw;function EE(){if(Tw)return Jf;Tw=1;var e=Yc(),t=Qx(),r=Xc(),n=pL(),i=gL(),o=gE(),s=vE(),a=vL(),c=xL(),u=_E(),d=yL(),f=Po(),h=SL(),p=NL(),y=NE(),g=st(),w=Mo(),v=RL(),x=hr(),b=AL(),_=ei(),j=Ai(),k=1,N=2,E=4,C="[object Arguments]",T="[object Array]",R="[object Boolean]",P="[object Date]",F="[object Error]",S="[object Function]",A="[object GeneratorFunction]",M="[object Map]",z="[object Number]",D="[object Object]",I="[object RegExp]",L="[object Set]",O="[object String]",q="[object Symbol]",B="[object WeakMap]",$="[object ArrayBuffer]",V="[object DataView]",X="[object Float32Array]",ne="[object Float64Array]",te="[object Int8Array]",ae="[object Int16Array]",Q="[object Int32Array]",we="[object Uint8Array]",se="[object Uint8ClampedArray]",Te="[object Uint16Array]",ue="[object Uint32Array]",Z={};Z[C]=Z[T]=Z[$]=Z[V]=Z[R]=Z[P]=Z[X]=Z[ne]=Z[te]=Z[ae]=Z[Q]=Z[M]=Z[z]=Z[D]=Z[I]=Z[L]=Z[O]=Z[q]=Z[we]=Z[se]=Z[Te]=Z[ue]=!0,Z[F]=Z[S]=Z[B]=!1;function xe(U,Y,ce,pe,ke,ge){var de,_e=Y&k,Ve=Y&N,Ce=Y&E;if(ce&&(de=ke?ce(U,pe,ke,ge):ce(U)),de!==void 0)return de;if(!x(U))return U;var Le=g(U);if(Le){if(de=h(U),!_e)return s(U,de)}else{var Oe=f(U),Ge=Oe==S||Oe==A;if(w(U))return o(U,_e);if(Oe==D||Oe==C||Ge&&!ke){if(de=Ve||Ge?{}:y(U),!_e)return Ve?c(U,i(de,U)):a(U,n(de,U))}else{if(!Z[Oe])return ke?U:{};de=p(U,Oe,_e)}}ge||(ge=new e);var G=ge.get(U);if(G)return G;ge.set(U,de),b(U)?U.forEach(function(Ye){de.add(xe(Ye,Y,ce,Ye,U,ge))}):v(U)&&U.forEach(function(Ye,Je){de.set(Je,xe(Ye,Y,ce,Je,U,ge))});var he=Ce?Ve?d:u:Ve?j:_,le=Le?void 0:he(U);return t(le||U,function(Ye,Je){le&&(Je=Ye,Ye=U[Je]),r(de,Je,xe(Ye,Y,ce,Je,U,ge))}),de}return Jf=xe,Jf}var ep,Aw;function IL(){if(Aw)return ep;Aw=1;var e=EE(),t=4;function r(n){return e(n,t)}return ep=r,ep}var tp,Iw;function iy(){if(Iw)return tp;Iw=1;function e(t){return function(){return t}}return tp=e,tp}var rp,Mw;function ML(){if(Mw)return rp;Mw=1;function e(t){return function(r,n,i){for(var o=-1,s=Object(r),a=i(r),c=a.length;c--;){var u=a[t?c:++o];if(n(s[u],u,s)===!1)break}return r}}return rp=e,rp}var np,Pw;function oy(){if(Pw)return np;Pw=1;var e=ML(),t=e();return np=t,np}var ip,Ow;function sy(){if(Ow)return ip;Ow=1;var e=oy(),t=ei();function r(n,i){return n&&e(n,i,t)}return ip=r,ip}var op,Dw;function PL(){if(Dw)return op;Dw=1;var e=vn();function t(r,n){return function(i,o){if(i==null)return i;if(!e(i))return r(i,o);for(var s=i.length,a=n?s:-1,c=Object(i);(n?a--:++a<s)&&o(c[a],a,c)!==!1;);return i}}return op=t,op}var sp,Lw;function tu(){if(Lw)return sp;Lw=1;var e=sy(),t=PL(),r=t(e);return sp=r,sp}var ap,Fw;function Ii(){if(Fw)return ap;Fw=1;function e(t){return t}return ap=e,ap}var lp,zw;function RE(){if(zw)return lp;zw=1;var e=Ii();function t(r){return typeof r=="function"?r:e}return lp=t,lp}var cp,qw;function TE(){if(qw)return cp;qw=1;var e=Qx(),t=tu(),r=RE(),n=st();function i(o,s){var a=n(o)?e:t;return a(o,r(s))}return cp=i,cp}var up,$w;function AE(){return $w||($w=1,up=TE()),up}var dp,Bw;function OL(){if(Bw)return dp;Bw=1;var e=tu();function t(r,n){var i=[];return e(r,function(o,s,a){n(o,s,a)&&i.push(o)}),i}return dp=t,dp}var fp,Hw;function DL(){if(Hw)return fp;Hw=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return fp=t,fp}var pp,Ww;function LL(){if(Ww)return pp;Ww=1;function e(t){return this.__data__.has(t)}return pp=e,pp}var hp,Uw;function IE(){if(Uw)return hp;Uw=1;var e=Xx(),t=DL(),r=LL();function n(i){var o=-1,s=i==null?0:i.length;for(this.__data__=new e;++o<s;)this.add(i[o])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,hp=n,hp}var mp,Vw;function FL(){if(Vw)return mp;Vw=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return mp=e,mp}var gp,Gw;function ME(){if(Gw)return gp;Gw=1;function e(t,r){return t.has(r)}return gp=e,gp}var vp,Yw;function PE(){if(Yw)return vp;Yw=1;var e=IE(),t=FL(),r=ME(),n=1,i=2;function o(s,a,c,u,d,f){var h=c&n,p=s.length,y=a.length;if(p!=y&&!(h&&y>p))return!1;var g=f.get(s),w=f.get(a);if(g&&w)return g==a&&w==s;var v=-1,x=!0,b=c&i?new e:void 0;for(f.set(s,a),f.set(a,s);++v<p;){var _=s[v],j=a[v];if(u)var k=h?u(j,_,v,a,s,f):u(_,j,v,s,a,f);if(k!==void 0){if(k)continue;x=!1;break}if(b){if(!t(a,function(N,E){if(!r(b,E)&&(_===N||d(_,N,c,u,f)))return b.push(E)})){x=!1;break}}else if(!(_===j||d(_,j,c,u,f))){x=!1;break}}return f.delete(s),f.delete(a),x}return vp=o,vp}var xp,Kw;function zL(){if(Kw)return xp;Kw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,o){n[++r]=[o,i]}),n}return xp=e,xp}var yp,Xw;function ay(){if(Xw)return yp;Xw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return yp=e,yp}var bp,Qw;function qL(){if(Qw)return bp;Qw=1;var e=Io(),t=kE(),r=Ao(),n=PE(),i=zL(),o=ay(),s=1,a=2,c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Map]",h="[object Number]",p="[object RegExp]",y="[object Set]",g="[object String]",w="[object Symbol]",v="[object ArrayBuffer]",x="[object DataView]",b=e?e.prototype:void 0,_=b?b.valueOf:void 0;function j(k,N,E,C,T,R,P){switch(E){case x:if(k.byteLength!=N.byteLength||k.byteOffset!=N.byteOffset)return!1;k=k.buffer,N=N.buffer;case v:return!(k.byteLength!=N.byteLength||!R(new t(k),new t(N)));case c:case u:case h:return r(+k,+N);case d:return k.name==N.name&&k.message==N.message;case p:case g:return k==N+"";case f:var F=i;case y:var S=C&s;if(F||(F=o),k.size!=N.size&&!S)return!1;var A=P.get(k);if(A)return A==N;C|=a,P.set(k,N);var M=n(F(k),F(N),C,T,R,P);return P.delete(k),M;case w:if(_)return _.call(k)==_.call(N)}return!1}return bp=j,bp}var wp,Zw;function $L(){if(Zw)return wp;Zw=1;var e=_E(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(o,s,a,c,u,d){var f=a&t,h=e(o),p=h.length,y=e(s),g=y.length;if(p!=g&&!f)return!1;for(var w=p;w--;){var v=h[w];if(!(f?v in s:n.call(s,v)))return!1}var x=d.get(o),b=d.get(s);if(x&&b)return x==s&&b==o;var _=!0;d.set(o,s),d.set(s,o);for(var j=f;++w<p;){v=h[w];var k=o[v],N=s[v];if(c)var E=f?c(N,k,v,s,o,d):c(k,N,v,o,s,d);if(!(E===void 0?k===N||u(k,N,a,c,d):E)){_=!1;break}j||(j=v=="constructor")}if(_&&!j){var C=o.constructor,T=s.constructor;C!=T&&"constructor"in o&&"constructor"in s&&!(typeof C=="function"&&C instanceof C&&typeof T=="function"&&T instanceof T)&&(_=!1)}return d.delete(o),d.delete(s),_}return wp=i,wp}var _p,Jw;function BL(){if(Jw)return _p;Jw=1;var e=Yc(),t=PE(),r=qL(),n=$L(),i=Po(),o=st(),s=Mo(),a=ya(),c=1,u="[object Arguments]",d="[object Array]",f="[object Object]",h=Object.prototype,p=h.hasOwnProperty;function y(g,w,v,x,b,_){var j=o(g),k=o(w),N=j?d:i(g),E=k?d:i(w);N=N==u?f:N,E=E==u?f:E;var C=N==f,T=E==f,R=N==E;if(R&&s(g)){if(!s(w))return!1;j=!0,C=!1}if(R&&!C)return _||(_=new e),j||a(g)?t(g,w,v,x,b,_):r(g,w,N,v,x,b,_);if(!(v&c)){var P=C&&p.call(g,"__wrapped__"),F=T&&p.call(w,"__wrapped__");if(P||F){var S=P?g.value():g,A=F?w.value():w;return _||(_=new e),b(S,A,v,x,_)}}return R?(_||(_=new e),n(g,w,v,x,b,_)):!1}return _p=y,_p}var Sp,e_;function OE(){if(e_)return Sp;e_=1;var e=BL(),t=Gr();function r(n,i,o,s,a){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,o,s,r,a)}return Sp=r,Sp}var kp,t_;function HL(){if(t_)return kp;t_=1;var e=Yc(),t=OE(),r=1,n=2;function i(o,s,a,c){var u=a.length,d=u,f=!c;if(o==null)return!d;for(o=Object(o);u--;){var h=a[u];if(f&&h[2]?h[1]!==o[h[0]]:!(h[0]in o))return!1}for(;++u<d;){h=a[u];var p=h[0],y=o[p],g=h[1];if(f&&h[2]){if(y===void 0&&!(p in o))return!1}else{var w=new e;if(c)var v=c(y,g,p,o,s,w);if(!(v===void 0?t(g,y,r|n,c,w):v))return!1}}return!0}return kp=i,kp}var jp,r_;function DE(){if(r_)return jp;r_=1;var e=hr();function t(r){return r===r&&!e(r)}return jp=t,jp}var Cp,n_;function WL(){if(n_)return Cp;n_=1;var e=DE(),t=ei();function r(n){for(var i=t(n),o=i.length;o--;){var s=i[o],a=n[s];i[o]=[s,a,e(a)]}return i}return Cp=r,Cp}var Np,i_;function LE(){if(i_)return Np;i_=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Np=e,Np}var Ep,o_;function UL(){if(o_)return Ep;o_=1;var e=HL(),t=WL(),r=LE();function n(i){var o=t(i);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(s){return s===i||e(s,i,o)}}return Ep=n,Ep}var Rp,s_;function Oo(){if(s_)return Rp;s_=1;var e=Ri(),t=Gr(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Rp=n,Rp}var Tp,a_;function ly(){if(a_)return Tp;a_=1;var e=st(),t=Oo(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(o,s){if(e(o))return!1;var a=typeof o;return a=="number"||a=="symbol"||a=="boolean"||o==null||t(o)?!0:n.test(o)||!r.test(o)||s!=null&&o in Object(s)}return Tp=i,Tp}var Ap,l_;function VL(){if(l_)return Ap;l_=1;var e=Xx(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var o=function(){var s=arguments,a=i?i.apply(this,s):s[0],c=o.cache;if(c.has(a))return c.get(a);var u=n.apply(this,s);return o.cache=c.set(a,u)||c,u};return o.cache=new(r.Cache||e),o}return r.Cache=e,Ap=r,Ap}var Ip,c_;function GL(){if(c_)return Ip;c_=1;var e=VL(),t=500;function r(n){var i=e(n,function(s){return o.size===t&&o.clear(),s}),o=i.cache;return i}return Ip=r,Ip}var Mp,u_;function YL(){if(u_)return Mp;u_=1;var e=GL(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(t,function(s,a,c,u){o.push(c?u.replace(r,"$1"):a||s)}),o});return Mp=n,Mp}var Pp,d_;function ru(){if(d_)return Pp;d_=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,o=Array(i);++n<i;)o[n]=r(t[n],n,t);return o}return Pp=e,Pp}var Op,f_;function KL(){if(f_)return Op;f_=1;var e=Io(),t=ru(),r=st(),n=Oo(),i=e?e.prototype:void 0,o=i?i.toString:void 0;function s(a){if(typeof a=="string")return a;if(r(a))return t(a,s)+"";if(n(a))return o?o.call(a):"";var c=a+"";return c=="0"&&1/a==-1/0?"-0":c}return Op=s,Op}var Dp,p_;function FE(){if(p_)return Dp;p_=1;var e=KL();function t(r){return r==null?"":e(r)}return Dp=t,Dp}var Lp,h_;function nu(){if(h_)return Lp;h_=1;var e=st(),t=ly(),r=YL(),n=FE();function i(o,s){return e(o)?o:t(o,s)?[o]:r(n(o))}return Lp=i,Lp}var Fp,m_;function ba(){if(m_)return Fp;m_=1;var e=Oo();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Fp=t,Fp}var zp,g_;function iu(){if(g_)return zp;g_=1;var e=nu(),t=ba();function r(n,i){i=e(i,n);for(var o=0,s=i.length;n!=null&&o<s;)n=n[t(i[o++])];return o&&o==s?n:void 0}return zp=r,zp}var qp,v_;function XL(){if(v_)return qp;v_=1;var e=iu();function t(r,n,i){var o=r==null?void 0:e(r,n);return o===void 0?i:o}return qp=t,qp}var $p,x_;function QL(){if(x_)return $p;x_=1;function e(t,r){return t!=null&&r in Object(t)}return $p=e,$p}var Bp,y_;function zE(){if(y_)return Bp;y_=1;var e=nu(),t=xa(),r=st(),n=Qc(),i=Zx(),o=ba();function s(a,c,u){c=e(c,a);for(var d=-1,f=c.length,h=!1;++d<f;){var p=o(c[d]);if(!(h=a!=null&&u(a,p)))break;a=a[p]}return h||++d!=f?h:(f=a==null?0:a.length,!!f&&i(f)&&n(p,f)&&(r(a)||t(a)))}return Bp=s,Bp}var Hp,b_;function qE(){if(b_)return Hp;b_=1;var e=QL(),t=zE();function r(n,i){return n!=null&&t(n,i,e)}return Hp=r,Hp}var Wp,w_;function ZL(){if(w_)return Wp;w_=1;var e=OE(),t=XL(),r=qE(),n=ly(),i=DE(),o=LE(),s=ba(),a=1,c=2;function u(d,f){return n(d)&&i(f)?o(s(d),f):function(h){var p=t(h,d);return p===void 0&&p===f?r(h,d):e(f,p,a|c)}}return Wp=u,Wp}var Up,__;function $E(){if(__)return Up;__=1;function e(t){return function(r){return r==null?void 0:r[t]}}return Up=e,Up}var Vp,S_;function JL(){if(S_)return Vp;S_=1;var e=iu();function t(r){return function(n){return e(n,r)}}return Vp=t,Vp}var Gp,k_;function e8(){if(k_)return Gp;k_=1;var e=$E(),t=JL(),r=ly(),n=ba();function i(o){return r(o)?e(n(o)):t(o)}return Gp=i,Gp}var Yp,j_;function xn(){if(j_)return Yp;j_=1;var e=UL(),t=ZL(),r=Ii(),n=st(),i=e8();function o(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?t(s[0],s[1]):e(s):i(s)}return Yp=o,Yp}var Kp,C_;function BE(){if(C_)return Kp;C_=1;var e=xE(),t=OL(),r=xn(),n=st();function i(o,s){var a=n(o)?e:t;return a(o,r(s,3))}return Kp=i,Kp}var Xp,N_;function t8(){if(N_)return Xp;N_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return Xp=r,Xp}var Qp,E_;function HE(){if(E_)return Qp;E_=1;var e=t8(),t=zE();function r(n,i){return n!=null&&t(n,i,e)}return Qp=r,Qp}var Zp,R_;function r8(){if(R_)return Zp;R_=1;var e=ey(),t=Po(),r=xa(),n=st(),i=vn(),o=Mo(),s=Jc(),a=ya(),c="[object Map]",u="[object Set]",d=Object.prototype,f=d.hasOwnProperty;function h(p){if(p==null)return!0;if(i(p)&&(n(p)||typeof p=="string"||typeof p.splice=="function"||o(p)||a(p)||r(p)))return!p.length;var y=t(p);if(y==c||y==u)return!p.size;if(s(p))return!e(p).length;for(var g in p)if(f.call(p,g))return!1;return!0}return Zp=h,Zp}var Jp,T_;function WE(){if(T_)return Jp;T_=1;function e(t){return t===void 0}return Jp=e,Jp}var eh,A_;function UE(){if(A_)return eh;A_=1;var e=tu(),t=vn();function r(n,i){var o=-1,s=t(n)?Array(n.length):[];return e(n,function(a,c,u){s[++o]=i(a,c,u)}),s}return eh=r,eh}var th,I_;function VE(){if(I_)return th;I_=1;var e=ru(),t=xn(),r=UE(),n=st();function i(o,s){var a=n(o)?e:r;return a(o,t(s,3))}return th=i,th}var rh,M_;function n8(){if(M_)return rh;M_=1;function e(t,r,n,i){var o=-1,s=t==null?0:t.length;for(i&&s&&(n=t[++o]);++o<s;)n=r(n,t[o],o,t);return n}return rh=e,rh}var nh,P_;function i8(){if(P_)return nh;P_=1;function e(t,r,n,i,o){return o(t,function(s,a,c){n=i?(i=!1,s):r(n,s,a,c)}),n}return nh=e,nh}var ih,O_;function GE(){if(O_)return ih;O_=1;var e=n8(),t=tu(),r=xn(),n=i8(),i=st();function o(s,a,c){var u=i(s)?e:n,d=arguments.length<3;return u(s,r(a,4),c,d,t)}return ih=o,ih}var oh,D_;function o8(){if(D_)return oh;D_=1;var e=Ri(),t=st(),r=Gr(),n="[object String]";function i(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==n}return oh=i,oh}var sh,L_;function s8(){if(L_)return sh;L_=1;var e=$E(),t=e("length");return sh=t,sh}var ah,F_;function a8(){if(F_)return ah;F_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,o="\\ufe0e\\ufe0f",s="\\u200d",a=RegExp("["+s+e+i+o+"]");function c(u){return a.test(u)}return ah=c,ah}var lh,z_;function l8(){if(z_)return lh;z_=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,o="\\ufe0e\\ufe0f",s="["+e+"]",a="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+a+"|"+c+")",d="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",y=u+"?",g="["+o+"]?",w="(?:"+p+"(?:"+[d,f,h].join("|")+")"+g+y+")*",v=g+y+w,x="(?:"+[d+a+"?",a,f,h,s].join("|")+")",b=RegExp(c+"(?="+c+")|"+x+v,"g");function _(j){for(var k=b.lastIndex=0;b.test(j);)++k;return k}return lh=_,lh}var ch,q_;function c8(){if(q_)return ch;q_=1;var e=s8(),t=a8(),r=l8();function n(i){return t(i)?r(i):e(i)}return ch=n,ch}var uh,$_;function u8(){if($_)return uh;$_=1;var e=ey(),t=Po(),r=vn(),n=o8(),i=c8(),o="[object Map]",s="[object Set]";function a(c){if(c==null)return 0;if(r(c))return n(c)?i(c):c.length;var u=t(c);return u==o||u==s?c.size:e(c).length}return uh=a,uh}var dh,B_;function d8(){if(B_)return dh;B_=1;var e=Qx(),t=CE(),r=sy(),n=xn(),i=eu(),o=st(),s=Mo(),a=ga(),c=hr(),u=ya();function d(f,h,p){var y=o(f),g=y||s(f)||u(f);if(h=n(h,4),p==null){var w=f&&f.constructor;g?p=y?new w:[]:c(f)?p=a(w)?t(i(f)):{}:p={}}return(g?e:r)(f,function(v,x,b){return h(p,v,x,b)}),p}return dh=d,dh}var fh,H_;function f8(){if(H_)return fh;H_=1;var e=Io(),t=xa(),r=st(),n=e?e.isConcatSpreadable:void 0;function i(o){return r(o)||t(o)||!!(n&&o&&o[n])}return fh=i,fh}var ph,W_;function cy(){if(W_)return ph;W_=1;var e=ry(),t=f8();function r(n,i,o,s,a){var c=-1,u=n.length;for(o||(o=t),a||(a=[]);++c<u;){var d=n[c];i>0&&o(d)?i>1?r(d,i-1,o,s,a):e(a,d):s||(a[a.length]=d)}return a}return ph=r,ph}var hh,U_;function p8(){if(U_)return hh;U_=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return hh=e,hh}var mh,V_;function YE(){if(V_)return mh;V_=1;var e=p8(),t=Math.max;function r(n,i,o){return i=t(i===void 0?n.length-1:i,0),function(){for(var s=arguments,a=-1,c=t(s.length-i,0),u=Array(c);++a<c;)u[a]=s[i+a];a=-1;for(var d=Array(i+1);++a<i;)d[a]=s[a];return d[i]=o(u),e(n,this,d)}}return mh=r,mh}var gh,G_;function h8(){if(G_)return gh;G_=1;var e=iy(),t=pE(),r=Ii(),n=t?function(i,o){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return gh=n,gh}var vh,Y_;function m8(){if(Y_)return vh;Y_=1;var e=800,t=16,r=Date.now;function n(i){var o=0,s=0;return function(){var a=r(),c=t-(a-s);if(s=a,c>0){if(++o>=e)return arguments[0]}else o=0;return i.apply(void 0,arguments)}}return vh=n,vh}var xh,K_;function KE(){if(K_)return xh;K_=1;var e=h8(),t=m8(),r=t(e);return xh=r,xh}var yh,X_;function ou(){if(X_)return yh;X_=1;var e=Ii(),t=YE(),r=KE();function n(i,o){return r(t(i,o,e),i+"")}return yh=n,yh}var bh,Q_;function XE(){if(Q_)return bh;Q_=1;function e(t,r,n,i){for(var o=t.length,s=n+(i?1:-1);i?s--:++s<o;)if(r(t[s],s,t))return s;return-1}return bh=e,bh}var wh,Z_;function g8(){if(Z_)return wh;Z_=1;function e(t){return t!==t}return wh=e,wh}var _h,J_;function v8(){if(J_)return _h;J_=1;function e(t,r,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===r)return i;return-1}return _h=e,_h}var Sh,e2;function x8(){if(e2)return Sh;e2=1;var e=XE(),t=g8(),r=v8();function n(i,o,s){return o===o?r(i,o,s):e(i,t,s)}return Sh=n,Sh}var kh,t2;function y8(){if(t2)return kh;t2=1;var e=x8();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return kh=t,kh}var jh,r2;function b8(){if(r2)return jh;r2=1;function e(t,r,n){for(var i=-1,o=t==null?0:t.length;++i<o;)if(n(r,t[i]))return!0;return!1}return jh=e,jh}var Ch,n2;function w8(){if(n2)return Ch;n2=1;function e(){}return Ch=e,Ch}var Nh,i2;function _8(){if(i2)return Nh;i2=1;var e=SE(),t=w8(),r=ay(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(o){return new e(o)}:t;return Nh=i,Nh}var Eh,o2;function S8(){if(o2)return Eh;o2=1;var e=IE(),t=y8(),r=b8(),n=ME(),i=_8(),o=ay(),s=200;function a(c,u,d){var f=-1,h=t,p=c.length,y=!0,g=[],w=g;if(d)y=!1,h=r;else if(p>=s){var v=u?null:i(c);if(v)return o(v);y=!1,h=n,w=new e}else w=u?[]:g;e:for(;++f<p;){var x=c[f],b=u?u(x):x;if(x=d||x!==0?x:0,y&&b===b){for(var _=w.length;_--;)if(w[_]===b)continue e;u&&w.push(b),g.push(x)}else h(w,b,d)||(w!==g&&w.push(b),g.push(x))}return g}return Eh=a,Eh}var Rh,s2;function QE(){if(s2)return Rh;s2=1;var e=vn(),t=Gr();function r(n){return t(n)&&e(n)}return Rh=r,Rh}var Th,a2;function k8(){if(a2)return Th;a2=1;var e=cy(),t=ou(),r=S8(),n=QE(),i=t(function(o){return r(e(o,1,n,!0))});return Th=i,Th}var Ah,l2;function j8(){if(l2)return Ah;l2=1;var e=ru();function t(r,n){return e(n,function(i){return r[i]})}return Ah=t,Ah}var Ih,c2;function ZE(){if(c2)return Ih;c2=1;var e=j8(),t=ei();function r(n){return n==null?[]:e(n,t(n))}return Ih=r,Ih}var Mh,u2;function mr(){if(u2)return Mh;u2=1;var e;if(typeof Yx=="function")try{e={clone:IL(),constant:iy(),each:AE(),filter:BE(),has:HE(),isArray:st(),isEmpty:r8(),isFunction:ga(),isUndefined:WE(),keys:ei(),map:VE(),reduce:GE(),size:u8(),transform:d8(),union:k8(),values:ZE()}}catch{}return e||(e=window._),Mh=e,Mh}var Ph,d2;function uy(){if(d2)return Ph;d2=1;var e=mr();Ph=i;var t="\0",r="\0",n="";function i(d){this._isDirected=e.has(d,"directed")?d.directed:!0,this._isMultigraph=e.has(d,"multigraph")?d.multigraph:!1,this._isCompound=e.has(d,"compound")?d.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(d){return this._label=d,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultNodeLabelFn=d,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._in[f])})},i.prototype.sinks=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._out[f])})},i.prototype.setNodes=function(d,f){var h=arguments,p=this;return e.each(d,function(y){h.length>1?p.setNode(y,f):p.setNode(y)}),this},i.prototype.setNode=function(d,f){return e.has(this._nodes,d)?(arguments.length>1&&(this._nodes[d]=f),this):(this._nodes[d]=arguments.length>1?f:this._defaultNodeLabelFn(d),this._isCompound&&(this._parent[d]=r,this._children[d]={},this._children[r][d]=!0),this._in[d]={},this._preds[d]={},this._out[d]={},this._sucs[d]={},++this._nodeCount,this)},i.prototype.node=function(d){return this._nodes[d]},i.prototype.hasNode=function(d){return e.has(this._nodes,d)},i.prototype.removeNode=function(d){var f=this;if(e.has(this._nodes,d)){var h=function(p){f.removeEdge(f._edgeObjs[p])};delete this._nodes[d],this._isCompound&&(this._removeFromParentsChildList(d),delete this._parent[d],e.each(this.children(d),function(p){f.setParent(p)}),delete this._children[d]),e.each(e.keys(this._in[d]),h),delete this._in[d],delete this._preds[d],e.each(e.keys(this._out[d]),h),delete this._out[d],delete this._sucs[d],--this._nodeCount}return this},i.prototype.setParent=function(d,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var h=f;!e.isUndefined(h);h=this.parent(h))if(h===d)throw new Error("Setting "+f+" as parent of "+d+" would create a cycle");this.setNode(f)}return this.setNode(d),this._removeFromParentsChildList(d),this._parent[d]=f,this._children[f][d]=!0,this},i.prototype._removeFromParentsChildList=function(d){delete this._children[this._parent[d]][d]},i.prototype.parent=function(d){if(this._isCompound){var f=this._parent[d];if(f!==r)return f}},i.prototype.children=function(d){if(e.isUndefined(d)&&(d=r),this._isCompound){var f=this._children[d];if(f)return e.keys(f)}else{if(d===r)return this.nodes();if(this.hasNode(d))return[]}},i.prototype.predecessors=function(d){var f=this._preds[d];if(f)return e.keys(f)},i.prototype.successors=function(d){var f=this._sucs[d];if(f)return e.keys(f)},i.prototype.neighbors=function(d){var f=this.predecessors(d);if(f)return e.union(f,this.successors(d))},i.prototype.isLeaf=function(d){var f;return this.isDirected()?f=this.successors(d):f=this.neighbors(d),f.length===0},i.prototype.filterNodes=function(d){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var h=this;e.each(this._nodes,function(g,w){d(w)&&f.setNode(w,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,h.edge(g))});var p={};function y(g){var w=h.parent(g);return w===void 0||f.hasNode(w)?(p[g]=w,w):w in p?p[w]:y(w)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,y(g))}),f},i.prototype.setDefaultEdgeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultEdgeLabelFn=d,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(d,f){var h=this,p=arguments;return e.reduce(d,function(y,g){return p.length>1?h.setEdge(y,g,f):h.setEdge(y,g),g}),this},i.prototype.setEdge=function(){var d,f,h,p,y=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(d=g.v,f=g.w,h=g.name,arguments.length===2&&(p=arguments[1],y=!0)):(d=g,f=arguments[1],h=arguments[3],arguments.length>2&&(p=arguments[2],y=!0)),d=""+d,f=""+f,e.isUndefined(h)||(h=""+h);var w=a(this._isDirected,d,f,h);if(e.has(this._edgeLabels,w))return y&&(this._edgeLabels[w]=p),this;if(!e.isUndefined(h)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(f),this._edgeLabels[w]=y?p:this._defaultEdgeLabelFn(d,f,h);var v=c(this._isDirected,d,f,h);return d=v.v,f=v.w,Object.freeze(v),this._edgeObjs[w]=v,o(this._preds[f],d),o(this._sucs[d],f),this._in[f][w]=v,this._out[d][w]=v,this._edgeCount++,this},i.prototype.edge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,h);return this._edgeLabels[p]},i.prototype.hasEdge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,h);return e.has(this._edgeLabels,p)},i.prototype.removeEdge=function(d,f,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,h),y=this._edgeObjs[p];return y&&(d=y.v,f=y.w,delete this._edgeLabels[p],delete this._edgeObjs[p],s(this._preds[f],d),s(this._sucs[d],f),delete this._in[f][p],delete this._out[d][p],this._edgeCount--),this},i.prototype.inEdges=function(d,f){var h=this._in[d];if(h){var p=e.values(h);return f?e.filter(p,function(y){return y.v===f}):p}},i.prototype.outEdges=function(d,f){var h=this._out[d];if(h){var p=e.values(h);return f?e.filter(p,function(y){return y.w===f}):p}},i.prototype.nodeEdges=function(d,f){var h=this.inEdges(d,f);if(h)return h.concat(this.outEdges(d,f))};function o(d,f){d[f]?d[f]++:d[f]=1}function s(d,f){--d[f]||delete d[f]}function a(d,f,h,p){var y=""+f,g=""+h;if(!d&&y>g){var w=y;y=g,g=w}return y+n+g+n+(e.isUndefined(p)?t:p)}function c(d,f,h,p){var y=""+f,g=""+h;if(!d&&y>g){var w=y;y=g,g=w}var v={v:y,w:g};return p&&(v.name=p),v}function u(d,f){return a(d,f.v,f.w,f.name)}return Ph}var Oh,f2;function C8(){return f2||(f2=1,Oh="2.1.8"),Oh}var Dh,p2;function N8(){return p2||(p2=1,Dh={Graph:uy(),version:C8()}),Dh}var Lh,h2;function E8(){if(h2)return Lh;h2=1;var e=mr(),t=uy();Lh={write:r,read:o};function r(s){var a={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:i(s)};return e.isUndefined(s.graph())||(a.value=e.clone(s.graph())),a}function n(s){return e.map(s.nodes(),function(a){var c=s.node(a),u=s.parent(a),d={v:a};return e.isUndefined(c)||(d.value=c),e.isUndefined(u)||(d.parent=u),d})}function i(s){return e.map(s.edges(),function(a){var c=s.edge(a),u={v:a.v,w:a.w};return e.isUndefined(a.name)||(u.name=a.name),e.isUndefined(c)||(u.value=c),u})}function o(s){var a=new t(s.options).setGraph(s.value);return e.each(s.nodes,function(c){a.setNode(c.v,c.value),c.parent&&a.setParent(c.v,c.parent)}),e.each(s.edges,function(c){a.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),a}return Lh}var Fh,m2;function R8(){if(m2)return Fh;m2=1;var e=mr();Fh=t;function t(r){var n={},i=[],o;function s(a){e.has(n,a)||(n[a]=!0,o.push(a),e.each(r.successors(a),s),e.each(r.predecessors(a),s))}return e.each(r.nodes(),function(a){o=[],s(a),o.length&&i.push(o)}),i}return Fh}var zh,g2;function JE(){if(g2)return zh;g2=1;var e=mr();zh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var o=this._arr,s=o.length;return i[r]=s,o.push({key:r,priority:n}),this._decrease(s),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,o=i+1,s=r;i<n.length&&(s=n[i].priority<n[s].priority?i:s,o<n.length&&(s=n[o].priority<n[s].priority?o:s),s!==r&&(this._swap(r,s),this._heapify(s)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,o;r!==0&&(o=r>>1,!(n[o].priority<i));)this._swap(r,o),r=o},t.prototype._swap=function(r,n){var i=this._arr,o=this._keyIndices,s=i[r],a=i[n];i[r]=a,i[n]=s,o[a.key]=r,o[s.key]=n},zh}var qh,v2;function e4(){if(v2)return qh;v2=1;var e=mr(),t=JE();qh=n;var r=e.constant(1);function n(o,s,a,c){return i(o,String(s),a||r,c||function(u){return o.outEdges(u)})}function i(o,s,a,c){var u={},d=new t,f,h,p=function(y){var g=y.v!==f?y.v:y.w,w=u[g],v=a(y),x=h.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+y+" Weight: "+v);x<w.distance&&(w.distance=x,w.predecessor=f,d.decrease(g,x))};for(o.nodes().forEach(function(y){var g=y===s?0:Number.POSITIVE_INFINITY;u[y]={distance:g},d.add(y,g)});d.size()>0&&(f=d.removeMin(),h=u[f],h.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(p);return u}return qh}var $h,x2;function T8(){if(x2)return $h;x2=1;var e=e4(),t=mr();$h=r;function r(n,i,o){return t.transform(n.nodes(),function(s,a){s[a]=e(n,a,i,o)},{})}return $h}var Bh,y2;function t4(){if(y2)return Bh;y2=1;var e=mr();Bh=t;function t(r){var n=0,i=[],o={},s=[];function a(c){var u=o[c]={onStack:!0,lowlink:n,index:n++};if(i.push(c),r.successors(c).forEach(function(h){e.has(o,h)?o[h].onStack&&(u.lowlink=Math.min(u.lowlink,o[h].index)):(a(h),u.lowlink=Math.min(u.lowlink,o[h].lowlink))}),u.lowlink===u.index){var d=[],f;do f=i.pop(),o[f].onStack=!1,d.push(f);while(c!==f);s.push(d)}}return r.nodes().forEach(function(c){e.has(o,c)||a(c)}),s}return Bh}var Hh,b2;function A8(){if(b2)return Hh;b2=1;var e=mr(),t=t4();Hh=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Hh}var Wh,w2;function I8(){if(w2)return Wh;w2=1;var e=mr();Wh=r;var t=e.constant(1);function r(i,o,s){return n(i,o||t,s||function(a){return i.outEdges(a)})}function n(i,o,s){var a={},c=i.nodes();return c.forEach(function(u){a[u]={},a[u][u]={distance:0},c.forEach(function(d){u!==d&&(a[u][d]={distance:Number.POSITIVE_INFINITY})}),s(u).forEach(function(d){var f=d.v===u?d.w:d.v,h=o(d);a[u][f]={distance:h,predecessor:u}})}),c.forEach(function(u){var d=a[u];c.forEach(function(f){var h=a[f];c.forEach(function(p){var y=h[u],g=d[p],w=h[p],v=y.distance+g.distance;v<w.distance&&(w.distance=v,w.predecessor=g.predecessor)})})}),a}return Wh}var Uh,_2;function r4(){if(_2)return Uh;_2=1;var e=mr();Uh=t,t.CycleException=r;function t(n){var i={},o={},s=[];function a(c){if(e.has(o,c))throw new r;e.has(i,c)||(o[c]=!0,i[c]=!0,e.each(n.predecessors(c),a),delete o[c],s.push(c))}if(e.each(n.sinks(),a),e.size(i)!==n.nodeCount())throw new r;return s}function r(){}return r.prototype=new Error,Uh}var Vh,S2;function M8(){if(S2)return Vh;S2=1;var e=r4();Vh=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return Vh}var Gh,k2;function n4(){if(k2)return Gh;k2=1;var e=mr();Gh=t;function t(n,i,o){e.isArray(i)||(i=[i]);var s=(n.isDirected()?n.successors:n.neighbors).bind(n),a=[],c={};return e.each(i,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);r(n,u,o==="post",c,s,a)}),a}function r(n,i,o,s,a,c){e.has(s,i)||(s[i]=!0,o||c.push(i),e.each(a(i),function(u){r(n,u,o,s,a,c)}),o&&c.push(i))}return Gh}var Yh,j2;function P8(){if(j2)return Yh;j2=1;var e=n4();Yh=t;function t(r,n){return e(r,n,"post")}return Yh}var Kh,C2;function O8(){if(C2)return Kh;C2=1;var e=n4();Kh=t;function t(r,n){return e(r,n,"pre")}return Kh}var Xh,N2;function D8(){if(N2)return Xh;N2=1;var e=mr(),t=uy(),r=JE();Xh=n;function n(i,o){var s=new t,a={},c=new r,u;function d(h){var p=h.v===u?h.w:h.v,y=c.priority(p);if(y!==void 0){var g=o(h);g<y&&(a[p]=u,c.decrease(p,g))}}if(i.nodeCount()===0)return s;e.each(i.nodes(),function(h){c.add(h,Number.POSITIVE_INFINITY),s.setNode(h)}),c.decrease(i.nodes()[0],0);for(var f=!1;c.size()>0;){if(u=c.removeMin(),e.has(a,u))s.setEdge(u,a[u]);else{if(f)throw new Error("Input graph is not connected: "+i);f=!0}i.nodeEdges(u).forEach(d)}return s}return Xh}var Qh,E2;function L8(){return E2||(E2=1,Qh={components:R8(),dijkstra:e4(),dijkstraAll:T8(),findCycles:A8(),floydWarshall:I8(),isAcyclic:M8(),postorder:P8(),preorder:O8(),prim:D8(),tarjan:t4(),topsort:r4()}),Qh}var Zh,R2;function F8(){if(R2)return Zh;R2=1;var e=N8();return Zh={Graph:e.Graph,json:E8(),alg:L8(),version:e.version},Zh}var rc;if(typeof Yx=="function")try{rc=F8()}catch{}rc||(rc=window.graphlib);var Ir=rc,Jh,T2;function z8(){if(T2)return Jh;T2=1;var e=EE(),t=1,r=4;function n(i){return e(i,t|r)}return Jh=n,Jh}var em,A2;function su(){if(A2)return em;A2=1;var e=Ao(),t=vn(),r=Qc(),n=hr();function i(o,s,a){if(!n(a))return!1;var c=typeof s;return(c=="number"?t(a)&&r(s,a.length):c=="string"&&s in a)?e(a[s],o):!1}return em=i,em}var tm,I2;function q8(){if(I2)return tm;I2=1;var e=ou(),t=Ao(),r=su(),n=Ai(),i=Object.prototype,o=i.hasOwnProperty,s=e(function(a,c){a=Object(a);var u=-1,d=c.length,f=d>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(d=1);++u<d;)for(var h=c[u],p=n(h),y=-1,g=p.length;++y<g;){var w=p[y],v=a[w];(v===void 0||t(v,i[w])&&!o.call(a,w))&&(a[w]=h[w])}return a});return tm=s,tm}var rm,M2;function $8(){if(M2)return rm;M2=1;var e=xn(),t=vn(),r=ei();function n(i){return function(o,s,a){var c=Object(o);if(!t(o)){var u=e(s,3);o=r(o),s=function(f){return u(c[f],f,c)}}var d=i(o,s,a);return d>-1?c[u?o[d]:d]:void 0}}return rm=n,rm}var nm,P2;function B8(){if(P2)return nm;P2=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return nm=t,nm}var im,O2;function H8(){if(O2)return im;O2=1;var e=B8(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return im=r,im}var om,D2;function W8(){if(D2)return om;D2=1;var e=H8(),t=hr(),r=Oo(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var f=o.test(u);return f||s.test(u)?a(u.slice(2),f?2:8):i.test(u)?n:+u}return om=c,om}var sm,L2;function i4(){if(L2)return sm;L2=1;var e=W8(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var o=i<0?-1:1;return o*r}return i===i?i:0}return sm=n,sm}var am,F2;function U8(){if(F2)return am;F2=1;var e=i4();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return am=t,am}var lm,z2;function V8(){if(z2)return lm;z2=1;var e=XE(),t=xn(),r=U8(),n=Math.max;function i(o,s,a){var c=o==null?0:o.length;if(!c)return-1;var u=a==null?0:r(a);return u<0&&(u=n(c+u,0)),e(o,t(s,3),u)}return lm=i,lm}var cm,q2;function G8(){if(q2)return cm;q2=1;var e=$8(),t=V8(),r=e(t);return cm=r,cm}var um,$2;function o4(){if($2)return um;$2=1;var e=cy();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return um=t,um}var dm,B2;function Y8(){if(B2)return dm;B2=1;var e=oy(),t=RE(),r=Ai();function n(i,o){return i==null?i:e(i,t(o),r)}return dm=n,dm}var fm,H2;function K8(){if(H2)return fm;H2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return fm=e,fm}var pm,W2;function X8(){if(W2)return pm;W2=1;var e=Kc(),t=sy(),r=xn();function n(i,o){var s={};return o=r(o,3),t(i,function(a,c,u){e(s,c,o(a,c,u))}),s}return pm=n,pm}var hm,U2;function dy(){if(U2)return hm;U2=1;var e=Oo();function t(r,n,i){for(var o=-1,s=r.length;++o<s;){var a=r[o],c=n(a);if(c!=null&&(u===void 0?c===c&&!e(c):i(c,u)))var u=c,d=a}return d}return hm=t,hm}var mm,V2;function Q8(){if(V2)return mm;V2=1;function e(t,r){return t>r}return mm=e,mm}var gm,G2;function Z8(){if(G2)return gm;G2=1;var e=dy(),t=Q8(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return gm=n,gm}var vm,Y2;function s4(){if(Y2)return vm;Y2=1;var e=Kc(),t=Ao();function r(n,i,o){(o!==void 0&&!t(n[i],o)||o===void 0&&!(i in n))&&e(n,i,o)}return vm=r,vm}var xm,K2;function J8(){if(K2)return xm;K2=1;var e=Ri(),t=eu(),r=Gr(),n="[object Object]",i=Function.prototype,o=Object.prototype,s=i.toString,a=o.hasOwnProperty,c=s.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var f=t(d);if(f===null)return!0;var h=a.call(f,"constructor")&&f.constructor;return typeof h=="function"&&h instanceof h&&s.call(h)==c}return xm=u,xm}var ym,X2;function a4(){if(X2)return ym;X2=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return ym=e,ym}var bm,Q2;function eF(){if(Q2)return bm;Q2=1;var e=va(),t=Ai();function r(n){return e(n,t(n))}return bm=r,bm}var wm,Z2;function tF(){if(Z2)return wm;Z2=1;var e=s4(),t=gE(),r=jE(),n=vE(),i=NE(),o=xa(),s=st(),a=QE(),c=Mo(),u=ga(),d=hr(),f=J8(),h=ya(),p=a4(),y=eF();function g(w,v,x,b,_,j,k){var N=p(w,x),E=p(v,x),C=k.get(E);if(C){e(w,x,C);return}var T=j?j(N,E,x+"",w,v,k):void 0,R=T===void 0;if(R){var P=s(E),F=!P&&c(E),S=!P&&!F&&h(E);T=E,P||F||S?s(N)?T=N:a(N)?T=n(N):F?(R=!1,T=t(E,!0)):S?(R=!1,T=r(E,!0)):T=[]:f(E)||o(E)?(T=N,o(N)?T=y(N):(!d(N)||u(N))&&(T=i(E))):R=!1}R&&(k.set(E,T),_(T,E,b,j,k),k.delete(E)),e(w,x,T)}return wm=g,wm}var _m,J2;function rF(){if(J2)return _m;J2=1;var e=Yc(),t=s4(),r=oy(),n=tF(),i=hr(),o=Ai(),s=a4();function a(c,u,d,f,h){c!==u&&r(u,function(p,y){if(h||(h=new e),i(p))n(c,u,y,d,a,f,h);else{var g=f?f(s(c,y),p,y+"",c,u,h):void 0;g===void 0&&(g=p),t(c,y,g)}},o)}return _m=a,_m}var Sm,eS;function nF(){if(eS)return Sm;eS=1;var e=ou(),t=su();function r(n){return e(function(i,o){var s=-1,a=o.length,c=a>1?o[a-1]:void 0,u=a>2?o[2]:void 0;for(c=n.length>3&&typeof c=="function"?(a--,c):void 0,u&&t(o[0],o[1],u)&&(c=a<3?void 0:c,a=1),i=Object(i);++s<a;){var d=o[s];d&&n(i,d,s,c)}return i})}return Sm=r,Sm}var km,tS;function iF(){if(tS)return km;tS=1;var e=rF(),t=nF(),r=t(function(n,i,o){e(n,i,o)});return km=r,km}var jm,rS;function l4(){if(rS)return jm;rS=1;function e(t,r){return t<r}return jm=e,jm}var Cm,nS;function oF(){if(nS)return Cm;nS=1;var e=dy(),t=l4(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return Cm=n,Cm}var Nm,iS;function sF(){if(iS)return Nm;iS=1;var e=dy(),t=xn(),r=l4();function n(i,o){return i&&i.length?e(i,t(o,2),r):void 0}return Nm=n,Nm}var Em,oS;function aF(){if(oS)return Em;oS=1;var e=Ar(),t=function(){return e.Date.now()};return Em=t,Em}var Rm,sS;function lF(){if(sS)return Rm;sS=1;var e=Xc(),t=nu(),r=Qc(),n=hr(),i=ba();function o(s,a,c,u){if(!n(s))return s;a=t(a,s);for(var d=-1,f=a.length,h=f-1,p=s;p!=null&&++d<f;){var y=i(a[d]),g=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return s;if(d!=h){var w=p[y];g=u?u(w,y,p):void 0,g===void 0&&(g=n(w)?w:r(a[d+1])?[]:{})}e(p,y,g),p=p[y]}return s}return Rm=o,Rm}var Tm,aS;function cF(){if(aS)return Tm;aS=1;var e=iu(),t=lF(),r=nu();function n(i,o,s){for(var a=-1,c=o.length,u={};++a<c;){var d=o[a],f=e(i,d);s(f,d)&&t(u,r(d,i),f)}return u}return Tm=n,Tm}var Am,lS;function uF(){if(lS)return Am;lS=1;var e=cF(),t=qE();function r(n,i){return e(n,i,function(o,s){return t(n,s)})}return Am=r,Am}var Im,cS;function dF(){if(cS)return Im;cS=1;var e=o4(),t=YE(),r=KE();function n(i){return r(t(i,void 0,e),i+"")}return Im=n,Im}var Mm,uS;function fF(){if(uS)return Mm;uS=1;var e=uF(),t=dF(),r=t(function(n,i){return n==null?{}:e(n,i)});return Mm=r,Mm}var Pm,dS;function pF(){if(dS)return Pm;dS=1;var e=Math.ceil,t=Math.max;function r(n,i,o,s){for(var a=-1,c=t(e((i-n)/(o||1)),0),u=Array(c);c--;)u[s?c:++a]=n,n+=o;return u}return Pm=r,Pm}var Om,fS;function hF(){if(fS)return Om;fS=1;var e=pF(),t=su(),r=i4();function n(i){return function(o,s,a){return a&&typeof a!="number"&&t(o,s,a)&&(s=a=void 0),o=r(o),s===void 0?(s=o,o=0):s=r(s),a=a===void 0?o<s?1:-1:r(a),e(o,s,a,i)}}return Om=n,Om}var Dm,pS;function mF(){if(pS)return Dm;pS=1;var e=hF(),t=e();return Dm=t,Dm}var Lm,hS;function gF(){if(hS)return Lm;hS=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Lm=e,Lm}var Fm,mS;function vF(){if(mS)return Fm;mS=1;var e=Oo();function t(r,n){if(r!==n){var i=r!==void 0,o=r===null,s=r===r,a=e(r),c=n!==void 0,u=n===null,d=n===n,f=e(n);if(!u&&!f&&!a&&r>n||a&&c&&d&&!u&&!f||o&&c&&d||!i&&d||!s)return 1;if(!o&&!a&&!f&&r<n||f&&i&&s&&!o&&!a||u&&i&&s||!c&&s||!d)return-1}return 0}return Fm=t,Fm}var zm,gS;function xF(){if(gS)return zm;gS=1;var e=vF();function t(r,n,i){for(var o=-1,s=r.criteria,a=n.criteria,c=s.length,u=i.length;++o<c;){var d=e(s[o],a[o]);if(d){if(o>=u)return d;var f=i[o];return d*(f=="desc"?-1:1)}}return r.index-n.index}return zm=t,zm}var qm,vS;function yF(){if(vS)return qm;vS=1;var e=ru(),t=iu(),r=xn(),n=UE(),i=gF(),o=Zc(),s=xF(),a=Ii(),c=st();function u(d,f,h){f.length?f=e(f,function(g){return c(g)?function(w){return t(w,g.length===1?g[0]:g)}:g}):f=[a];var p=-1;f=e(f,o(r));var y=n(d,function(g,w,v){var x=e(f,function(b){return b(g)});return{criteria:x,index:++p,value:g}});return i(y,function(g,w){return s(g,w,h)})}return qm=u,qm}var $m,xS;function bF(){if(xS)return $m;xS=1;var e=cy(),t=yF(),r=ou(),n=su(),i=r(function(o,s){if(o==null)return[];var a=s.length;return a>1&&n(o,s[0],s[1])?s=[]:a>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),t(o,e(s,1),[])});return $m=i,$m}var Bm,yS;function wF(){if(yS)return Bm;yS=1;var e=FE(),t=0;function r(n){var i=++t;return e(n)+i}return Bm=r,Bm}var Hm,bS;function _F(){if(bS)return Hm;bS=1;function e(t,r,n){for(var i=-1,o=t.length,s=r.length,a={};++i<o;){var c=i<s?r[i]:void 0;n(a,t[i],c)}return a}return Hm=e,Hm}var Wm,wS;function SF(){if(wS)return Wm;wS=1;var e=Xc(),t=_F();function r(n,i){return t(n||[],i||[],e)}return Wm=r,Wm}var nc;if(typeof Yx=="function")try{nc={cloneDeep:z8(),constant:iy(),defaults:q8(),each:AE(),filter:BE(),find:G8(),flatten:o4(),forEach:TE(),forIn:Y8(),has:HE(),isUndefined:WE(),last:K8(),map:VE(),mapValues:X8(),max:Z8(),merge:iF(),min:oF(),minBy:sF(),now:aF(),pick:fF(),range:mF(),reduce:GE(),sortBy:bF(),uniqueId:wF(),values:ZE(),zipObject:SF()}}catch{}nc||(nc=window._);var Ue=nc,kF=au;function au(){var e={};e._next=e._prev=e,this._sentinel=e}au.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return c4(t),t};au.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&c4(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};au.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,jF)),r=r._prev;return"["+e.join(", ")+"]"};function c4(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function jF(e,t){if(e!=="_next"&&e!=="_prev")return t}var nn=Ue,CF=Ir.Graph,NF=kF,EF=TF,RF=nn.constant(1);function TF(e,t){if(e.nodeCount()<=1)return[];var r=IF(e,t||RF),n=AF(r.graph,r.buckets,r.zeroIdx);return nn.flatten(nn.map(n,function(i){return e.outEdges(i.v,i.w)}),!0)}function AF(e,t,r){for(var n=[],i=t[t.length-1],o=t[0],s;e.nodeCount();){for(;s=o.dequeue();)Um(e,t,r,s);for(;s=i.dequeue();)Um(e,t,r,s);if(e.nodeCount()){for(var a=t.length-2;a>0;--a)if(s=t[a].dequeue(),s){n=n.concat(Um(e,t,r,s,!0));break}}}return n}function Um(e,t,r,n,i){var o=i?[]:void 0;return nn.forEach(e.inEdges(n.v),function(s){var a=e.edge(s),c=e.node(s.v);i&&o.push({v:s.v,w:s.w}),c.out-=a,Sv(t,r,c)}),nn.forEach(e.outEdges(n.v),function(s){var a=e.edge(s),c=s.w,u=e.node(c);u.in-=a,Sv(t,r,u)}),e.removeNode(n.v),o}function IF(e,t){var r=new CF,n=0,i=0;nn.forEach(e.nodes(),function(a){r.setNode(a,{v:a,in:0,out:0})}),nn.forEach(e.edges(),function(a){var c=r.edge(a.v,a.w)||0,u=t(a),d=c+u;r.setEdge(a.v,a.w,d),i=Math.max(i,r.node(a.v).out+=u),n=Math.max(n,r.node(a.w).in+=u)});var o=nn.range(i+n+3).map(function(){return new NF}),s=n+1;return nn.forEach(r.nodes(),function(a){Sv(o,s,r.node(a))}),{graph:r,buckets:o,zeroIdx:s}}function Sv(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var hi=Ue,MF=EF,PF={run:OF,undo:LF};function OF(e){var t=e.graph().acyclicer==="greedy"?MF(e,r(e)):DF(e);hi.forEach(t,function(n){var i=e.edge(n);e.removeEdge(n),i.forwardName=n.name,i.reversed=!0,e.setEdge(n.w,n.v,i,hi.uniqueId("rev"))});function r(n){return function(i){return n.edge(i).weight}}}function DF(e){var t=[],r={},n={};function i(o){hi.has(n,o)||(n[o]=!0,r[o]=!0,hi.forEach(e.outEdges(o),function(s){hi.has(r,s.w)?t.push(s):i(s.w)}),delete r[o])}return hi.forEach(e.nodes(),i),t}function LF(e){hi.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var Ae=Ue,u4=Ir.Graph,Ut={addDummyNode:d4,simplify:FF,asNonCompoundGraph:zF,successorWeights:qF,predecessorWeights:$F,intersectRect:BF,buildLayerMatrix:HF,normalizeRanks:WF,removeEmptyRanks:UF,addBorderNode:VF,maxRank:f4,partition:GF,time:YF,notime:KF};function d4(e,t,r,n){var i;do i=Ae.uniqueId(n);while(e.hasNode(i));return r.dummy=t,e.setNode(i,r),i}function FF(e){var t=new u4().setGraph(e.graph());return Ae.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),Ae.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},i=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),t}function zF(e){var t=new u4({multigraph:e.isMultigraph()}).setGraph(e.graph());return Ae.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),Ae.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function qF(e){var t=Ae.map(e.nodes(),function(r){var n={};return Ae.forEach(e.outEdges(r),function(i){n[i.w]=(n[i.w]||0)+e.edge(i).weight}),n});return Ae.zipObject(e.nodes(),t)}function $F(e){var t=Ae.map(e.nodes(),function(r){var n={};return Ae.forEach(e.inEdges(r),function(i){n[i.v]=(n[i.v]||0)+e.edge(i).weight}),n});return Ae.zipObject(e.nodes(),t)}function BF(e,t){var r=e.x,n=e.y,i=t.x-r,o=t.y-n,s=e.width/2,a=e.height/2;if(!i&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var c,u;return Math.abs(o)*s>Math.abs(i)*a?(o<0&&(a=-a),c=a*i/o,u=a):(i<0&&(s=-s),c=s,u=s*o/i),{x:r+c,y:n+u}}function HF(e){var t=Ae.map(Ae.range(f4(e)+1),function(){return[]});return Ae.forEach(e.nodes(),function(r){var n=e.node(r),i=n.rank;Ae.isUndefined(i)||(t[i][n.order]=r)}),t}function WF(e){var t=Ae.min(Ae.map(e.nodes(),function(r){return e.node(r).rank}));Ae.forEach(e.nodes(),function(r){var n=e.node(r);Ae.has(n,"rank")&&(n.rank-=t)})}function UF(e){var t=Ae.min(Ae.map(e.nodes(),function(o){return e.node(o).rank})),r=[];Ae.forEach(e.nodes(),function(o){var s=e.node(o).rank-t;r[s]||(r[s]=[]),r[s].push(o)});var n=0,i=e.graph().nodeRankFactor;Ae.forEach(r,function(o,s){Ae.isUndefined(o)&&s%i!==0?--n:n&&Ae.forEach(o,function(a){e.node(a).rank+=n})})}function VF(e,t,r,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=r,i.order=n),d4(e,"border",i,t)}function f4(e){return Ae.max(Ae.map(e.nodes(),function(t){var r=e.node(t).rank;if(!Ae.isUndefined(r))return r}))}function GF(e,t){var r={lhs:[],rhs:[]};return Ae.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function YF(e,t){var r=Ae.now();try{return t()}finally{console.log(e+" time: "+(Ae.now()-r)+"ms")}}function KF(e,t){return t()}var p4=Ue,XF=Ut,QF={run:ZF,undo:ez};function ZF(e){e.graph().dummyChains=[],p4.forEach(e.edges(),function(t){JF(e,t)})}function JF(e,t){var r=t.v,n=e.node(r).rank,i=t.w,o=e.node(i).rank,s=t.name,a=e.edge(t),c=a.labelRank;if(o!==n+1){e.removeEdge(t);var u,d,f;for(f=0,++n;n<o;++f,++n)a.points=[],d={width:0,height:0,edgeLabel:a,edgeObj:t,rank:n},u=XF.addDummyNode(e,"edge",d,"_d"),n===c&&(d.width=a.width,d.height=a.height,d.dummy="edge-label",d.labelpos=a.labelpos),e.setEdge(r,u,{weight:a.weight},s),f===0&&e.graph().dummyChains.push(u),r=u;e.setEdge(r,i,{weight:a.weight},s)}}function ez(e){p4.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,i;for(e.setEdge(r.edgeObj,n);r.dummy;)i=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=i,r=e.node(t)})}var Za=Ue,lu={longestPath:tz,slack:rz};function tz(e){var t={};function r(n){var i=e.node(n);if(Za.has(t,n))return i.rank;t[n]=!0;var o=Za.min(Za.map(e.outEdges(n),function(s){return r(s.w)-e.edge(s).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),i.rank=o}Za.forEach(e.sources(),r)}function rz(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var ic=Ue,nz=Ir.Graph,oc=lu.slack,h4=iz;function iz(e){var t=new nz({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var i,o;oz(t,e)<n;)i=sz(t,e),o=t.hasNode(i.v)?oc(e,i):-oc(e,i),az(t,e,o);return t}function oz(e,t){function r(n){ic.forEach(t.nodeEdges(n),function(i){var o=i.v,s=n===o?i.w:o;!e.hasNode(s)&&!oc(t,i)&&(e.setNode(s,{}),e.setEdge(n,s,{}),r(s))})}return ic.forEach(e.nodes(),r),e.nodeCount()}function sz(e,t){return ic.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return oc(t,r)})}function az(e,t,r){ic.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var hn=Ue,lz=h4,cz=lu.slack,uz=lu.longestPath,dz=Ir.alg.preorder,fz=Ir.alg.postorder,pz=Ut.simplify,hz=Mi;Mi.initLowLimValues=py;Mi.initCutValues=fy;Mi.calcCutValue=m4;Mi.leaveEdge=v4;Mi.enterEdge=x4;Mi.exchangeEdges=y4;function Mi(e){e=pz(e),uz(e);var t=lz(e);py(t),fy(t,e);for(var r,n;r=v4(t);)n=x4(t,e,r),y4(t,e,r,n)}function fy(e,t){var r=fz(e,e.nodes());r=r.slice(0,r.length-1),hn.forEach(r,function(n){mz(e,t,n)})}function mz(e,t,r){var n=e.node(r),i=n.parent;e.edge(r,i).cutvalue=m4(e,t,r)}function m4(e,t,r){var n=e.node(r),i=n.parent,o=!0,s=t.edge(r,i),a=0;return s||(o=!1,s=t.edge(i,r)),a=s.weight,hn.forEach(t.nodeEdges(r),function(c){var u=c.v===r,d=u?c.w:c.v;if(d!==i){var f=u===o,h=t.edge(c).weight;if(a+=f?h:-h,vz(e,r,d)){var p=e.edge(r,d).cutvalue;a+=f?-p:p}}}),a}function py(e,t){arguments.length<2&&(t=e.nodes()[0]),g4(e,{},1,t)}function g4(e,t,r,n,i){var o=r,s=e.node(n);return t[n]=!0,hn.forEach(e.neighbors(n),function(a){hn.has(t,a)||(r=g4(e,t,r,a,n))}),s.low=o,s.lim=r++,i?s.parent=i:delete s.parent,r}function v4(e){return hn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function x4(e,t,r){var n=r.v,i=r.w;t.hasEdge(n,i)||(n=r.w,i=r.v);var o=e.node(n),s=e.node(i),a=o,c=!1;o.lim>s.lim&&(a=s,c=!0);var u=hn.filter(t.edges(),function(d){return c===_S(e,e.node(d.v),a)&&c!==_S(e,e.node(d.w),a)});return hn.minBy(u,function(d){return cz(t,d)})}function y4(e,t,r,n){var i=r.v,o=r.w;e.removeEdge(i,o),e.setEdge(n.v,n.w,{}),py(e),fy(e,t),gz(e,t)}function gz(e,t){var r=hn.find(e.nodes(),function(i){return!t.node(i).parent}),n=dz(e,r);n=n.slice(1),hn.forEach(n,function(i){var o=e.node(i).parent,s=t.edge(i,o),a=!1;s||(s=t.edge(o,i),a=!0),t.node(i).rank=t.node(o).rank+(a?s.minlen:-s.minlen)})}function vz(e,t,r){return e.hasEdge(t,r)}function _S(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var xz=lu,b4=xz.longestPath,yz=h4,bz=hz,wz=_z;function _z(e){switch(e.graph().ranker){case"network-simplex":SS(e);break;case"tight-tree":kz(e);break;case"longest-path":Sz(e);break;default:SS(e)}}var Sz=b4;function kz(e){b4(e),yz(e)}function SS(e){bz(e)}var kv=Ue,jz=Cz;function Cz(e){var t=Ez(e);kv.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),i=n.edgeObj,o=Nz(e,t,i.v,i.w),s=o.path,a=o.lca,c=0,u=s[c],d=!0;r!==i.w;){if(n=e.node(r),d){for(;(u=s[c])!==a&&e.node(u).maxRank<n.rank;)c++;u===a&&(d=!1)}if(!d){for(;c<s.length-1&&e.node(u=s[c+1]).minRank<=n.rank;)c++;u=s[c]}e.setParent(r,u),r=e.successors(r)[0]}})}function Nz(e,t,r,n){var i=[],o=[],s=Math.min(t[r].low,t[n].low),a=Math.max(t[r].lim,t[n].lim),c,u;c=r;do c=e.parent(c),i.push(c);while(c&&(t[c].low>s||a>t[c].lim));for(u=c,c=n;(c=e.parent(c))!==u;)o.push(c);return{path:i.concat(o.reverse()),lca:u}}function Ez(e){var t={},r=0;function n(i){var o=r;kv.forEach(e.children(i),n),t[i]={low:o,lim:r++}}return kv.forEach(e.children(),n),t}var on=Ue,jv=Ut,Rz={run:Tz,cleanup:Mz};function Tz(e){var t=jv.addDummyNode(e,"root",{},"_root"),r=Az(e),n=on.max(on.values(r))-1,i=2*n+1;e.graph().nestingRoot=t,on.forEach(e.edges(),function(s){e.edge(s).minlen*=i});var o=Iz(e)+1;on.forEach(e.children(),function(s){w4(e,t,i,o,n,r,s)}),e.graph().nodeRankFactor=i}function w4(e,t,r,n,i,o,s){var a=e.children(s);if(!a.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:r});return}var c=jv.addBorderNode(e,"_bt"),u=jv.addBorderNode(e,"_bb"),d=e.node(s);e.setParent(c,s),d.borderTop=c,e.setParent(u,s),d.borderBottom=u,on.forEach(a,function(f){w4(e,t,r,n,i,o,f);var h=e.node(f),p=h.borderTop?h.borderTop:f,y=h.borderBottom?h.borderBottom:f,g=h.borderTop?n:2*n,w=p!==y?1:i-o[s]+1;e.setEdge(c,p,{weight:g,minlen:w,nestingEdge:!0}),e.setEdge(y,u,{weight:g,minlen:w,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,c,{weight:0,minlen:i+o[s]})}function Az(e){var t={};function r(n,i){var o=e.children(n);o&&o.length&&on.forEach(o,function(s){r(s,i+1)}),t[n]=i}return on.forEach(e.children(),function(n){r(n,1)}),t}function Iz(e){return on.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function Mz(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,on.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var Vm=Ue,Pz=Ut,Oz=Dz;function Dz(e){function t(r){var n=e.children(r),i=e.node(r);if(n.length&&Vm.forEach(n,t),Vm.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,s=i.maxRank+1;o<s;++o)kS(e,"borderLeft","_bl",r,i,o),kS(e,"borderRight","_br",r,i,o)}}Vm.forEach(e.children(),t)}function kS(e,t,r,n,i,o){var s={width:0,height:0,rank:o,borderType:t},a=i[t][o-1],c=Pz.addDummyNode(e,"border",s,r);i[t][o]=c,e.setParent(c,n),a&&e.setEdge(a,c,{weight:1})}var zr=Ue,Lz={adjust:Fz,undo:zz};function Fz(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&_4(e)}function zz(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&qz(e),(t==="lr"||t==="rl")&&($z(e),_4(e))}function _4(e){zr.forEach(e.nodes(),function(t){jS(e.node(t))}),zr.forEach(e.edges(),function(t){jS(e.edge(t))})}function jS(e){var t=e.width;e.width=e.height,e.height=t}function qz(e){zr.forEach(e.nodes(),function(t){Gm(e.node(t))}),zr.forEach(e.edges(),function(t){var r=e.edge(t);zr.forEach(r.points,Gm),zr.has(r,"y")&&Gm(r)})}function Gm(e){e.y=-e.y}function $z(e){zr.forEach(e.nodes(),function(t){Ym(e.node(t))}),zr.forEach(e.edges(),function(t){var r=e.edge(t);zr.forEach(r.points,Ym),zr.has(r,"x")&&Ym(r)})}function Ym(e){var t=e.x;e.x=e.y,e.y=t}var Kr=Ue,Bz=Hz;function Hz(e){var t={},r=Kr.filter(e.nodes(),function(a){return!e.children(a).length}),n=Kr.max(Kr.map(r,function(a){return e.node(a).rank})),i=Kr.map(Kr.range(n+1),function(){return[]});function o(a){if(!Kr.has(t,a)){t[a]=!0;var c=e.node(a);i[c.rank].push(a),Kr.forEach(e.successors(a),o)}}var s=Kr.sortBy(r,function(a){return e.node(a).rank});return Kr.forEach(s,o),i}var wn=Ue,Wz=Uz;function Uz(e,t){for(var r=0,n=1;n<t.length;++n)r+=Vz(e,t[n-1],t[n]);return r}function Vz(e,t,r){for(var n=wn.zipObject(r,wn.map(r,function(u,d){return d})),i=wn.flatten(wn.map(t,function(u){return wn.sortBy(wn.map(e.outEdges(u),function(d){return{pos:n[d.w],weight:e.edge(d).weight}}),"pos")}),!0),o=1;o<r.length;)o<<=1;var s=2*o-1;o-=1;var a=wn.map(new Array(s),function(){return 0}),c=0;return wn.forEach(i.forEach(function(u){var d=u.pos+o;a[d]+=u.weight;for(var f=0;d>0;)d%2&&(f+=a[d+1]),d=d-1>>1,a[d]+=u.weight;c+=u.weight*f})),c}var CS=Ue,Gz=Yz;function Yz(e,t){return CS.map(t,function(r){var n=e.inEdges(r);if(n.length){var i=CS.reduce(n,function(o,s){var a=e.edge(s),c=e.node(s.v);return{sum:o.sum+a.weight*c.order,weight:o.weight+a.weight}},{sum:0,weight:0});return{v:r,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:r}})}var Qt=Ue,Kz=Xz;function Xz(e,t){var r={};Qt.forEach(e,function(i,o){var s=r[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:o};Qt.isUndefined(i.barycenter)||(s.barycenter=i.barycenter,s.weight=i.weight)}),Qt.forEach(t.edges(),function(i){var o=r[i.v],s=r[i.w];!Qt.isUndefined(o)&&!Qt.isUndefined(s)&&(s.indegree++,o.out.push(r[i.w]))});var n=Qt.filter(r,function(i){return!i.indegree});return Qz(n)}function Qz(e){var t=[];function r(o){return function(s){s.merged||(Qt.isUndefined(s.barycenter)||Qt.isUndefined(o.barycenter)||s.barycenter>=o.barycenter)&&Zz(o,s)}}function n(o){return function(s){s.in.push(o),--s.indegree===0&&e.push(s)}}for(;e.length;){var i=e.pop();t.push(i),Qt.forEach(i.in.reverse(),r(i)),Qt.forEach(i.out,n(i))}return Qt.map(Qt.filter(t,function(o){return!o.merged}),function(o){return Qt.pick(o,["vs","i","barycenter","weight"])})}function Zz(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var ps=Ue,Jz=Ut,eq=tq;function tq(e,t){var r=Jz.partition(e,function(d){return ps.has(d,"barycenter")}),n=r.lhs,i=ps.sortBy(r.rhs,function(d){return-d.i}),o=[],s=0,a=0,c=0;n.sort(rq(!!t)),c=NS(o,i,c),ps.forEach(n,function(d){c+=d.vs.length,o.push(d.vs),s+=d.barycenter*d.weight,a+=d.weight,c=NS(o,i,c)});var u={vs:ps.flatten(o,!0)};return a&&(u.barycenter=s/a,u.weight=a),u}function NS(e,t,r){for(var n;t.length&&(n=ps.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function rq(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var An=Ue,nq=Gz,iq=Kz,oq=eq,sq=S4;function S4(e,t,r,n){var i=e.children(t),o=e.node(t),s=o?o.borderLeft:void 0,a=o?o.borderRight:void 0,c={};s&&(i=An.filter(i,function(y){return y!==s&&y!==a}));var u=nq(e,i);An.forEach(u,function(y){if(e.children(y.v).length){var g=S4(e,y.v,r,n);c[y.v]=g,An.has(g,"barycenter")&&lq(y,g)}});var d=iq(u,r);aq(d,c);var f=oq(d,n);if(s&&(f.vs=An.flatten([s,f.vs,a],!0),e.predecessors(s).length)){var h=e.node(e.predecessors(s)[0]),p=e.node(e.predecessors(a)[0]);An.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+h.order+p.order)/(f.weight+2),f.weight+=2}return f}function aq(e,t){An.forEach(e,function(r){r.vs=An.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function lq(e,t){An.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var hs=Ue,cq=Ir.Graph,uq=dq;function dq(e,t,r){var n=fq(e),i=new cq({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(o){return e.node(o)});return hs.forEach(e.nodes(),function(o){var s=e.node(o),a=e.parent(o);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(i.setNode(o),i.setParent(o,a||n),hs.forEach(e[r](o),function(c){var u=c.v===o?c.w:c.v,d=i.edge(u,o),f=hs.isUndefined(d)?0:d.weight;i.setEdge(u,o,{weight:e.edge(c).weight+f})}),hs.has(s,"minRank")&&i.setNode(o,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),i}function fq(e){for(var t;e.hasNode(t=hs.uniqueId("_root")););return t}var pq=Ue,hq=mq;function mq(e,t,r){var n={},i;pq.forEach(r,function(o){for(var s=e.parent(o),a,c;s;){if(a=e.parent(s),a?(c=n[a],n[a]=s):(c=i,i=s),c&&c!==s){t.setEdge(c,s);return}s=a}})}var Un=Ue,gq=Bz,vq=Wz,xq=sq,yq=uq,bq=hq,wq=Ir.Graph,ES=Ut,_q=Sq;function Sq(e){var t=ES.maxRank(e),r=RS(e,Un.range(1,t+1),"inEdges"),n=RS(e,Un.range(t-1,-1,-1),"outEdges"),i=gq(e);TS(e,i);for(var o=Number.POSITIVE_INFINITY,s,a=0,c=0;c<4;++a,++c){kq(a%2?r:n,a%4>=2),i=ES.buildLayerMatrix(e);var u=vq(e,i);u<o&&(c=0,s=Un.cloneDeep(i),o=u)}TS(e,s)}function RS(e,t,r){return Un.map(t,function(n){return yq(e,n,r)})}function kq(e,t){var r=new wq;Un.forEach(e,function(n){var i=n.graph().root,o=xq(n,i,r,t);Un.forEach(o.vs,function(s,a){n.node(s).order=a}),bq(n,r,o.vs)})}function TS(e,t){Un.forEach(t,function(r){Un.forEach(r,function(n,i){e.node(n).order=i})})}var fe=Ue,jq=Ir.Graph,Cq=Ut,Nq={positionX:Fq};function Eq(e,t){var r={};function n(i,o){var s=0,a=0,c=i.length,u=fe.last(o);return fe.forEach(o,function(d,f){var h=Tq(e,d),p=h?e.node(h).order:c;(h||d===u)&&(fe.forEach(o.slice(a,f+1),function(y){fe.forEach(e.predecessors(y),function(g){var w=e.node(g),v=w.order;(v<s||p<v)&&!(w.dummy&&e.node(y).dummy)&&k4(r,g,y)})}),a=f+1,s=p)}),o}return fe.reduce(t,n),r}function Rq(e,t){var r={};function n(o,s,a,c,u){var d;fe.forEach(fe.range(s,a),function(f){d=o[f],e.node(d).dummy&&fe.forEach(e.predecessors(d),function(h){var p=e.node(h);p.dummy&&(p.order<c||p.order>u)&&k4(r,h,d)})})}function i(o,s){var a=-1,c,u=0;return fe.forEach(s,function(d,f){if(e.node(d).dummy==="border"){var h=e.predecessors(d);h.length&&(c=e.node(h[0]).order,n(s,u,f,a,c),u=f,a=c)}n(s,u,s.length,c,o.length)}),s}return fe.reduce(t,i),r}function Tq(e,t){if(e.node(t).dummy)return fe.find(e.predecessors(t),function(r){return e.node(r).dummy})}function k4(e,t,r){if(t>r){var n=t;t=r,r=n}var i=e[t];i||(e[t]=i={}),i[r]=!0}function Aq(e,t,r){if(t>r){var n=t;t=r,r=n}return fe.has(e[t],r)}function Iq(e,t,r,n){var i={},o={},s={};return fe.forEach(t,function(a){fe.forEach(a,function(c,u){i[c]=c,o[c]=c,s[c]=u})}),fe.forEach(t,function(a){var c=-1;fe.forEach(a,function(u){var d=n(u);if(d.length){d=fe.sortBy(d,function(g){return s[g]});for(var f=(d.length-1)/2,h=Math.floor(f),p=Math.ceil(f);h<=p;++h){var y=d[h];o[u]===u&&c<s[y]&&!Aq(r,u,y)&&(o[y]=u,o[u]=i[u]=i[y],c=s[y])}}})}),{root:i,align:o}}function Mq(e,t,r,n,i){var o={},s=Pq(e,t,r,i),a=i?"borderLeft":"borderRight";function c(f,h){for(var p=s.nodes(),y=p.pop(),g={};y;)g[y]?f(y):(g[y]=!0,p.push(y),p=p.concat(h(y))),y=p.pop()}function u(f){o[f]=s.inEdges(f).reduce(function(h,p){return Math.max(h,o[p.v]+s.edge(p))},0)}function d(f){var h=s.outEdges(f).reduce(function(y,g){return Math.min(y,o[g.w]-s.edge(g))},Number.POSITIVE_INFINITY),p=e.node(f);h!==Number.POSITIVE_INFINITY&&p.borderType!==a&&(o[f]=Math.max(o[f],h))}return c(u,s.predecessors.bind(s)),c(d,s.successors.bind(s)),fe.forEach(n,function(f){o[f]=o[r[f]]}),o}function Pq(e,t,r,n){var i=new jq,o=e.graph(),s=zq(o.nodesep,o.edgesep,n);return fe.forEach(t,function(a){var c;fe.forEach(a,function(u){var d=r[u];if(i.setNode(d),c){var f=r[c],h=i.edge(f,d);i.setEdge(f,d,Math.max(s(e,u,c),h||0))}c=u})}),i}function Oq(e,t){return fe.minBy(fe.values(t),function(r){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return fe.forIn(r,function(o,s){var a=qq(e,s)/2;n=Math.max(o+a,n),i=Math.min(o-a,i)}),n-i})}function Dq(e,t){var r=fe.values(t),n=fe.min(r),i=fe.max(r);fe.forEach(["u","d"],function(o){fe.forEach(["l","r"],function(s){var a=o+s,c=e[a],u;if(c!==t){var d=fe.values(c);u=s==="l"?n-fe.min(d):i-fe.max(d),u&&(e[a]=fe.mapValues(c,function(f){return f+u}))}})})}function Lq(e,t){return fe.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var i=fe.sortBy(fe.map(e,n));return(i[1]+i[2])/2})}function Fq(e){var t=Cq.buildLayerMatrix(e),r=fe.merge(Eq(e,t),Rq(e,t)),n={},i;fe.forEach(["u","d"],function(s){i=s==="u"?t:fe.values(t).reverse(),fe.forEach(["l","r"],function(a){a==="r"&&(i=fe.map(i,function(f){return fe.values(f).reverse()}));var c=(s==="u"?e.predecessors:e.successors).bind(e),u=Iq(e,i,r,c),d=Mq(e,i,u.root,u.align,a==="r");a==="r"&&(d=fe.mapValues(d,function(f){return-f})),n[s+a]=d})});var o=Oq(e,n);return Dq(n,o),Lq(n,e.graph().align)}function zq(e,t,r){return function(n,i,o){var s=n.node(i),a=n.node(o),c=0,u;if(c+=s.width/2,fe.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":u=-s.width/2;break;case"r":u=s.width/2;break}if(u&&(c+=r?u:-u),u=0,c+=(s.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,fe.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":u=a.width/2;break;case"r":u=-a.width/2;break}return u&&(c+=r?u:-u),u=0,c}}function qq(e,t){return e.node(t).width}var ms=Ue,j4=Ut,$q=Nq.positionX,Bq=Hq;function Hq(e){e=j4.asNonCompoundGraph(e),Wq(e),ms.forEach($q(e),function(t,r){e.node(r).x=t})}function Wq(e){var t=j4.buildLayerMatrix(e),r=e.graph().ranksep,n=0;ms.forEach(t,function(i){var o=ms.max(ms.map(i,function(s){return e.node(s).height}));ms.forEach(i,function(s){e.node(s).y=n+o/2}),n+=o+r})}var me=Ue,AS=PF,IS=QF,Uq=wz,Vq=Ut.normalizeRanks,Gq=jz,Yq=Ut.removeEmptyRanks,MS=Rz,Kq=Oz,PS=Lz,Xq=_q,Qq=Bq,Kn=Ut,Zq=Ir.Graph,Jq=e$;function e$(e,t){var r=t&&t.debugTiming?Kn.time:Kn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return d$(e)});r("  runLayout",function(){t$(n,r)}),r("  updateInputGraph",function(){r$(e,n)})})}function t$(e,t){t("    makeSpaceForEdgeLabels",function(){f$(e)}),t("    removeSelfEdges",function(){w$(e)}),t("    acyclic",function(){AS.run(e)}),t("    nestingGraph.run",function(){MS.run(e)}),t("    rank",function(){Uq(Kn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){p$(e)}),t("    removeEmptyRanks",function(){Yq(e)}),t("    nestingGraph.cleanup",function(){MS.cleanup(e)}),t("    normalizeRanks",function(){Vq(e)}),t("    assignRankMinMax",function(){h$(e)}),t("    removeEdgeLabelProxies",function(){m$(e)}),t("    normalize.run",function(){IS.run(e)}),t("    parentDummyChains",function(){Gq(e)}),t("    addBorderSegments",function(){Kq(e)}),t("    order",function(){Xq(e)}),t("    insertSelfEdges",function(){_$(e)}),t("    adjustCoordinateSystem",function(){PS.adjust(e)}),t("    position",function(){Qq(e)}),t("    positionSelfEdges",function(){S$(e)}),t("    removeBorderNodes",function(){b$(e)}),t("    normalize.undo",function(){IS.undo(e)}),t("    fixupEdgeLabelCoords",function(){x$(e)}),t("    undoCoordinateSystem",function(){PS.undo(e)}),t("    translateGraph",function(){g$(e)}),t("    assignNodeIntersects",function(){v$(e)}),t("    reversePoints",function(){y$(e)}),t("    acyclic.undo",function(){AS.undo(e)})}function r$(e,t){me.forEach(e.nodes(),function(r){var n=e.node(r),i=t.node(r);n&&(n.x=i.x,n.y=i.y,t.children(r).length&&(n.width=i.width,n.height=i.height))}),me.forEach(e.edges(),function(r){var n=e.edge(r),i=t.edge(r);n.points=i.points,me.has(i,"x")&&(n.x=i.x,n.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var n$=["nodesep","edgesep","ranksep","marginx","marginy"],i$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},o$=["acyclicer","ranker","rankdir","align"],s$=["width","height"],a$={width:0,height:0},l$=["minlen","weight","width","height","labeloffset"],c$={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},u$=["labelpos"];function d$(e){var t=new Zq({multigraph:!0,compound:!0}),r=Xm(e.graph());return t.setGraph(me.merge({},i$,Km(r,n$),me.pick(r,o$))),me.forEach(e.nodes(),function(n){var i=Xm(e.node(n));t.setNode(n,me.defaults(Km(i,s$),a$)),t.setParent(n,e.parent(n))}),me.forEach(e.edges(),function(n){var i=Xm(e.edge(n));t.setEdge(n,me.merge({},c$,Km(i,l$),me.pick(i,u$)))}),t}function f$(e){var t=e.graph();t.ranksep/=2,me.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function p$(e){me.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),i=e.node(t.w),o={rank:(i.rank-n.rank)/2+n.rank,e:t};Kn.addDummyNode(e,"edge-proxy",o,"_ep")}})}function h$(e){var t=0;me.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=me.max(t,n.maxRank))}),e.graph().maxRank=t}function m$(e){me.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function g$(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,i=0,o=e.graph(),s=o.marginx||0,a=o.marginy||0;function c(u){var d=u.x,f=u.y,h=u.width,p=u.height;t=Math.min(t,d-h/2),r=Math.max(r,d+h/2),n=Math.min(n,f-p/2),i=Math.max(i,f+p/2)}me.forEach(e.nodes(),function(u){c(e.node(u))}),me.forEach(e.edges(),function(u){var d=e.edge(u);me.has(d,"x")&&c(d)}),t-=s,n-=a,me.forEach(e.nodes(),function(u){var d=e.node(u);d.x-=t,d.y-=n}),me.forEach(e.edges(),function(u){var d=e.edge(u);me.forEach(d.points,function(f){f.x-=t,f.y-=n}),me.has(d,"x")&&(d.x-=t),me.has(d,"y")&&(d.y-=n)}),o.width=r-t+s,o.height=i-n+a}function v$(e){me.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),i=e.node(t.w),o,s;r.points?(o=r.points[0],s=r.points[r.points.length-1]):(r.points=[],o=i,s=n),r.points.unshift(Kn.intersectRect(n,o)),r.points.push(Kn.intersectRect(i,s))})}function x$(e){me.forEach(e.edges(),function(t){var r=e.edge(t);if(me.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function y$(e){me.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function b$(e){me.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),i=e.node(r.borderBottom),o=e.node(me.last(r.borderLeft)),s=e.node(me.last(r.borderRight));r.width=Math.abs(s.x-o.x),r.height=Math.abs(i.y-n.y),r.x=o.x+r.width/2,r.y=n.y+r.height/2}}),me.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function w$(e){me.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function _$(e){var t=Kn.buildLayerMatrix(e);me.forEach(t,function(r){var n=0;me.forEach(r,function(i,o){var s=e.node(i);s.order=o+n,me.forEach(s.selfEdges,function(a){Kn.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:o+ ++n,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function S$(e){me.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),i=n.x+n.width/2,o=n.y,s=r.x-i,a=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:i+2*s/3,y:o-a},{x:i+5*s/6,y:o-a},{x:i+s,y:o},{x:i+5*s/6,y:o+a},{x:i+2*s/3,y:o+a}],r.label.x=r.x,r.label.y=r.y}})}function Km(e,t){return me.mapValues(me.pick(e,t),Number)}function Xm(e){var t={};return me.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var Ja=Ue,k$=Ut,j$=Ir.Graph,C$={debugOrdering:N$};function N$(e){var t=k$.buildLayerMatrix(e),r=new j$({compound:!0,multigraph:!0}).setGraph({});return Ja.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),Ja.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),Ja.forEach(t,function(n,i){var o="layer"+i;r.setNode(o,{rank:"same"}),Ja.reduce(n,function(s,a){return r.setEdge(s,a,{style:"invis"}),a})}),r}var E$="0.8.5",R$={graphlib:Ir,layout:Jq,debug:C$,util:{time:Ut.time,notime:Ut.notime},version:E$};const sc=Dv(R$),OS=(e,t)=>{const r=new sc.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),sc.layout(r),{nodes:e.map(n=>{const i=r.node(n.id);return{...n,targetPosition:re.Top,sourcePosition:re.Bottom,position:{x:i.x-(n.data.width??280)/2,y:i.y-(n.data.height??90)/2}}}),edges:t}},DS=(e,t,r)=>{let n=[],i=[],o=null,s=null,a=[];const c=r.theme||"industrial";return e.forEach((u,d)=>{var y,g;if((u.level||1)!==1)return;const f=280;let h=95;u.state==="active"&&u.stations&&(h+=35);const p=t===u.id;if(n.push({id:u.id,type:"documentNode",data:{...u,width:f,height:h,isExpanded:p,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:p?1e3:0}),o){const w=(y=e[d-1])==null?void 0:y.state;i.push({id:"e-"+o+"-"+u.id,source:o,target:u.id,type:"smoothstep",animated:w==="active",style:{stroke:lE(w,c),strokeWidth:3}})}((g=u.children)==null?void 0:g.length)>0&&(s=u.id,a=u.children),o=u.id}),{nodes:n,edges:i,epicBacklogId:s,epicChildren:a}},LS=(e,t,r,n,i)=>{const{nodes:o,edges:s}=e;if(!t||!r.length)return{nodes:o,edges:s};const a=o.find(b=>b.id===t);if(!a)return{nodes:o,edges:s};const c=a.position.x,u=a.position.y+(a.data.height||95),d=a.data.state,f=i.theme||"industrial",h=lE(d,f),p=d==="active",y=br.EPIC_HEIGHT+br.EPIC_GAP_Y,g=Math.ceil(r.length/br.EPICS_PER_ROW),w=c+280*.15,v=50,x={};r.forEach((b,_)=>{const j=Math.floor(_/br.EPICS_PER_ROW);x[j]||(x[j]=[]),x[j].push({epic:b,idx:_})});for(let b=0;b<g;b++){const _=x[b]||[];if(_.length===0)continue;const j=u+br.EPIC_OFFSET_Y+b*y,k=`junction-row-${b}`;o.push({id:k,type:"waypoint",position:{x:w,y:j-v},draggable:!1,connectable:!1,selectable:!1}),b===0?s.push({id:`e-spine-drop-${b}`,source:t,target:k,type:"straight",animated:p,style:{stroke:h,strokeWidth:2}}):s.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:k,type:"straight",animated:p,style:{stroke:h,strokeWidth:2}}),_.forEach(({epic:N,idx:E})=>{const C=E%br.EPICS_PER_ROW,T=c+br.EPIC_OFFSET_X+C*(br.EPIC_WIDTH+br.EPIC_GAP_X),R=j,P=n===N.id;o.push({id:N.id,type:"documentNode",data:{...N,width:br.EPIC_WIDTH,height:br.EPIC_HEIGHT,isExpanded:P,...i},draggable:!1,connectable:!1,position:{x:T,y:R},targetPosition:re.Top,sourcePosition:re.Bottom,zIndex:P?1e3:0}),s.push({id:`e-branch-${N.id}`,source:k,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:p,style:{stroke:h,strokeWidth:2}})})}return{nodes:o,edges:s}},T$={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},FS={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function A$(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function I$(e,t=[]){const r=[],n=[],i={};for(const o of e.tracks){const s=M$(o,t);if((o.scope||"project")==="project")n.push({...s,mayOwn:o.may_own||[],childDocType:o.child_doc_type});else{const c=o.document_type;i[c]||(i[c]=[]),i[c].push(s)}}for(const o of n)o.childDocType&&i[o.childDocType]&&(o.children=i[o.childDocType].map(s=>({...s,level:2}))),r.push(o);return r}function M$(e,t=[]){const r=T$[e.state]||"ready_for_production",n=e.state==="awaiting_operator",i=t.find(a=>a.document_type===e.document_type);let o=null;(r==="in_production"||n)&&(o=P$(e.stations,e.state,e.station));let s=null;return i&&i.questions&&(s=i.questions.map((a,c)=>({id:a.id||`q${c+1}`,text:a.question||a.text||a,required:a.required!==!1}))),{id:e.document_type,name:e.document_name||O$(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:o,questions:s,interruptId:i==null?void 0:i.id,blockedBy:e.blocked_by||[]}}function P$(e,t,r){if(!e||e.length===0){const n=r||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return rd.map(i=>({id:i,label:FS[i]||i.toUpperCase(),state:n===i?"active":rd.indexOf(i)<rd.indexOf(n)?"complete":"pending",needs_input:i==="pgc"&&t==="awaiting_operator"}))}return e.map(n=>({id:n.station,label:FS[n.station]||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function O$(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function D$({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,i]=m.useState(!0),[o,s]=m.useState(null),a=m.useCallback(async()=>{i(!0),s(null);try{const u=await He.getProjects({includeArchived:e}),d=A$(u);r(d)}catch(u){s(u.message),console.error("Failed to fetch projects:",u)}finally{i(!1)}},[e]),c=m.useCallback(async u=>{try{const d=await He.createProject({name:u,description:""});return r(f=>({...f,[d.id]:{id:d.id,projectId:d.project_id,name:d.name,description:d.description||"",status:"active",icon:d.icon,createdAt:d.created_at}})),d}catch(d){throw s(d.message),console.error("Failed to create project:",d),d}},[]);return m.useEffect(()=>{a()},[a]),{projects:t,loading:n,error:o,addProject:c,refresh:a}}function L$(e){const[t,r]=m.useState([]),[n,i]=m.useState("idle"),[o,s]=m.useState([]),[a,c]=m.useState(!0),[u,d]=m.useState(null),[f,h]=m.useState(!1),p=m.useRef(null),y=m.useRef(null),g=m.useCallback(async()=>{if(e)try{c(!0),d(null);const[_,j]=await Promise.all([He.getProductionStatus(e),He.getProjectInterrupts(e).catch(()=>[])]);s(j),i(_.line_state),r(I$(_,j))}catch(_){d(_.message),console.error("Failed to fetch production status:",_)}finally{c(!1)}},[e]),w=m.useCallback(()=>{if(!e)return;p.current&&p.current.close();const _=ZD(e);p.current=_,_.addEventListener("connected",()=>{h(!0),d(null),console.log(`SSE connected for project ${e}`)}),_.addEventListener("station_transition",j=>{try{const k=JSON.parse(j.data);console.log("Station transition:",k),g()}catch(k){console.error("Failed to parse station_transition:",k)}}),_.addEventListener("line_stopped",j=>{try{const k=JSON.parse(j.data);console.log("Line stopped:",k),i("stopped"),g()}catch(k){console.error("Failed to parse line_stopped:",k)}}),_.addEventListener("production_complete",j=>{try{const k=JSON.parse(j.data);console.log("Production complete:",k),i("complete"),g()}catch(k){console.error("Failed to parse production_complete:",k)}}),_.addEventListener("interrupt_resolved",j=>{try{const k=JSON.parse(j.data);console.log("Interrupt resolved:",k),g()}catch(k){console.error("Failed to parse interrupt_resolved:",k)}}),_.addEventListener("track_started",j=>{try{const k=JSON.parse(j.data);console.log("Track started:",k),i("active"),g()}catch(k){console.error("Failed to parse track_started:",k)}}),_.onerror=j=>{console.error("SSE error:",j),h(!1),d("Connection lost"),_.close(),y.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),w()},3e3)}},[e,g]),v=m.useCallback(()=>{y.current&&clearTimeout(y.current),p.current&&(p.current.close(),p.current=null),h(!1)},[]),x=m.useCallback(async(_,j)=>{try{await He.resolveInterrupt(_,{answers:j}),await g()}catch(k){throw console.error("Failed to resolve interrupt:",k),k}},[g]),b=m.useCallback(async(_=null)=>{try{await He.startProduction(e,_),i("active"),await g()}catch(j){throw console.error("Failed to start production:",j),j}},[e,g]);return m.useEffect(()=>(g(),w(),()=>v()),[g,w,v]),{data:t,lineState:n,interrupts:o,loading:a,error:u,connected:f,refresh:g,resolveInterrupt:x,startProduction:b}}const zS="combine-theme";function C4(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const o=localStorage.getItem(zS);return o&&Tn.includes(o)?o:e});m.useEffect(()=>{localStorage.setItem(zS,t)},[t]);const n=m.useCallback(o=>{Tn.includes(o)&&r(o)},[]),i=m.useCallback(()=>{r(o=>{const s=Tn.indexOf(o);return Tn[(s+1)%Tn.length]})},[]);return{theme:t,setTheme:n,cycleTheme:i}}function F$(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[i,o]=m.useState([]),[s,a]=m.useState(null),[c,u]=m.useState(null),[d,f]=m.useState({}),[h,p]=m.useState(0),[y,g]=m.useState([]),[w,v]=m.useState(!1),[x,b]=m.useState(null),[_,j]=m.useState(null),[k,N]=m.useState(null),[E,C]=m.useState(!1),[T,R]=m.useState(!1),P=m.useRef(null),F=m.useRef(!0);m.useEffect(()=>(F.current=!0,()=>{F.current=!1,P.current&&P.current.close()}),[]);const S=m.useCallback(O=>{F.current&&(n(O.phase),o(O.messages||[]),a(O.pending_prompt),u(O.pending_choices),f(O.interpretation||{}),p(O.confidence||0),g(O.missing_fields||[]),v(O.can_initialize||!1),b(O.gate_outcome),j(O.project))},[]),A=m.useCallback(async()=>{N(null),C(!0);try{const O=await He.startIntake();if(!F.current)return;t(O.execution_id),n(O.phase||"describe"),a(O.pending_prompt),o([]),f({}),j(null),b(null)}catch(O){if(!F.current)return;N(O.message||"Failed to start intake")}finally{F.current&&C(!1)}},[]),M=m.useCallback(async O=>{if(!e||!O.trim())return;N(null),R(!0);const q={role:"user",content:O};o(B=>[...B,q]);try{const B=await He.submitIntakeMessage(e,O);if(!F.current)return;S(B)}catch(B){if(!F.current)return;o($=>$.filter(V=>V!==q)),N(B.message||"Failed to submit message")}finally{F.current&&R(!1)}},[e,S]),z=m.useCallback(async(O,q)=>{if(e){N(null),f(B=>({...B,[O]:{value:q,source:"user",locked:!0}}));try{const B=await He.updateIntakeField(e,O,q);if(!F.current)return;S(B)}catch(B){if(!F.current)return;N(B.message||"Failed to update field");const $=await He.getIntakeState(e);F.current&&S($)}}},[e,S]),D=m.useCallback(async()=>{if(!(!e||!w)){N(null),C(!0);try{const O=await He.initializeIntake(e);if(!F.current)return;S(O),O.phase==="generating"&&I()}catch(O){if(!F.current)return;N(O.message||"Failed to initialize project"),C(!1)}}},[e,w,S]),I=m.useCallback(()=>{P.current&&P.current.close();const O=JD(e);P.current=O,O.addEventListener("started",q=>{if(!F.current)return;const B=JSON.parse(q.data);console.log("Intake started:",B)}),O.addEventListener("progress",q=>{if(!F.current)return;const B=JSON.parse(q.data);console.log("Intake progress:",B.current_node)}),O.addEventListener("complete",async q=>{if(!F.current)return;const B=JSON.parse(q.data);console.log("Intake complete:",B),O.close(),P.current=null,n("complete"),b(B.gate_outcome),j(B.project),C(!1)}),O.addEventListener("error",q=>{if(F.current&&O.readyState!==EventSource.CLOSED){try{const B=JSON.parse(q.data);N(B.message||"Generation failed")}catch{N("Connection lost during generation")}O.close(),P.current=null,C(!1)}}),O.onerror=()=>{F.current&&O.readyState===EventSource.CLOSED&&(P.current=null,C(!1))}},[e]),L=m.useCallback(()=>{P.current&&(P.current.close(),P.current=null),t(null),n("idle"),o([]),a(null),u(null),f({}),p(0),g([]),v(!1),b(null),j(null),N(null),C(!1),R(!1)},[]);return{executionId:e,phase:r,messages:i,pendingPrompt:s,pendingChoices:c,interpretation:d,confidence:h,missingFields:y,canInitialize:w,gateOutcome:x,project:_,error:k,loading:E,submitting:T,startIntake:A,submitMessage:M,updateField:z,lockAndGenerate:D,reset:L}}const N4=m.createContext(null);function z$({children:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[o,s]=m.useState(null);m.useEffect(()=>{a()},[]);const a=m.useCallback(async()=>{i(!0),s(null);try{const f=await He.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),s(f.message),r(null)}finally{i(!1)}},[]),c=m.useCallback(f=>{window.location.href=e6(f)},[]),u=m.useCallback(async()=>{try{await He.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),d={user:t,loading:n,error:o,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:u,checkAuth:a};return l.jsx(N4.Provider,{value:d,children:e})}function Do(){const e=m.useContext(N4);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function q$(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[i,o]=m.useState(!0),[s,a]=m.useState(null),c=m.useCallback(async()=>{o(!0),a(null);try{let d=await ye.getCurrentWorkspace();d||(d=await ye.createWorkspace()),t(d.workspace_id),n(d.branch)}catch(d){a(d.message),console.error("Failed to initialize workspace:",d)}finally{o(!1)}},[]),u=m.useCallback(async(d=!1)=>{if(e)try{await ye.closeWorkspace(e,d),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:i,error:s,closeWorkspace:u,reinitialize:c}}function $$(e,t=1e4){var d,f;const[r,n]=m.useState(null),[i,o]=m.useState(!0),[s,a]=m.useState(null),c=m.useRef(null),u=m.useCallback(async()=>{if(!e){n(null),o(!1);return}try{const h=await ye.getWorkspaceState(e);n(h),a(null)}catch(h){a(h.message),console.error("Failed to fetch workspace state:",h)}finally{o(!1)}},[e]);return m.useEffect(()=>{e&&(o(!0),u())},[e,u]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(u,t),()=>{c.current&&clearInterval(c.current)}},[e,t,u]),{state:r,loading:i,error:s,refresh:u,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((d=r==null?void 0:r.tier1)==null?void 0:d.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function B$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,o]=m.useState(null),s=m.useCallback(async()=>{n(!0),o(null);try{const a=await ye.getDocumentTypes();t(a.document_types||[])}catch(a){o(a.message),console.error("Failed to fetch document types:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{s()},[s]),{documentTypes:e,loading:r,error:i,refresh:s}}function H$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,o]=m.useState(null),s=m.useCallback(async()=>{n(!0),o(null);try{const a=await ye.getRoles();t(a.roles||[])}catch(a){o(a.message),console.error("Failed to fetch roles:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{s()},[s]),{roles:e,loading:r,error:i,refresh:s}}function cu(e,t,{debounceMs:r=500,onSave:n}={}){const[i,o]=m.useState(""),[s,a]=m.useState(""),[c,u]=m.useState(!0),[d,f]=m.useState(null),[h,p]=m.useState(!1),[y,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){o(""),a(""),u(!1);return}u(!0),f(null);try{const E=await ye.getArtifact(e,t);o(E.content),a(E.content)}catch(E){f(E.message),console.error("Failed to load artifact:",E)}finally{u(!1)}},[e,t]),b=m.useCallback(async E=>{if(!(!e||!t)){p(!0),f(null);try{const C=await ye.writeArtifact(e,t,E);g(C),a(E),n&&n(C)}catch(C){f(C.message),console.error("Failed to save artifact:",C)}finally{p(!1)}}},[e,t,n]),_=m.useCallback(E=>{v.current=E,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),j=m.useCallback(E=>{o(E),E!==s&&_(E)},[s,_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),v.current=null,o(s)},[s]),N=m.useCallback(()=>{w.current&&clearTimeout(w.current),i!==s&&b(i)},[i,s,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{content:i,originalContent:s,loading:c,error:d,saving:h,lastSaveResult:y,isDirty:i!==s,updateContent:j,reset:k,saveNow:N,reload:x}}const W$={documentNode:_6,waypoint:S6},U$={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function V$({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:i,theme:o,onThemeChange:s,onProjectUpdate:a,onProjectArchive:c,onProjectUnarchive:u,onProjectDelete:d}){const{data:f,lineState:h,loading:p,error:y,connected:g,resolveInterrupt:w}=L$(e),[v,x]=m.useState([]),[b,_]=m.useState(null),[j,k]=m.useState(null),[N,E]=m.useState(null),[C,T]=m.useState(!1),[R,P]=m.useState(""),[F,S]=m.useState(!1),[A,M]=m.useState(!1),[z,D]=m.useState(!1),I=Bc();m.useEffect(()=>{f.length>0&&x(f)},[f]),m.useEffect(()=>{i&&v.length>0&&setTimeout(()=>{_(i),k("questions")},300)},[i,v.length]),m.useEffect(()=>{_(null),k(null)},[e]);const L=m.useCallback(()=>{const U=Tn.indexOf(o);s(Tn[(U+1)%Tn.length])},[o,s]),O=m.useCallback(()=>{P(r||""),T(!0)},[r]),q=m.useCallback(async()=>{if(!R.trim()||R===r){T(!1);return}M(!0);try{await a(e,{name:R.trim()}),T(!1)}catch(U){console.error("Failed to update name:",U)}finally{M(!1)}},[R,r,e,a]),B=m.useCallback(()=>{T(!1),P("")},[]),$=m.useCallback(async()=>{M(!0);try{n?await u(e):await c(e)}catch(U){console.error("Failed to toggle archive:",U)}finally{M(!1)}},[e,n,c,u]),V=m.useCallback(async()=>{M(!0);try{await d(e),S(!1)}catch(U){console.error("Failed to delete:",U)}finally{M(!1)}},[e,d]),X=m.useCallback(U=>{const Y=I.getNode(U);if(Y){const pe=window.innerWidth,ke=-Y.position.x*.9+pe/2-400,ge=-Y.position.y*.9+120;I.setViewport({x:ke,y:ge,zoom:.9},{duration:800})}},[I]),ne=m.useMemo(()=>({onExpand:(U,Y)=>{_(U),k(Y)},onCollapse:()=>{_(null),k(null),setTimeout(()=>I.fitView({padding:.2,duration:300}),50)},onViewFullDocument:U=>{E(U)},onSubmitQuestions:async(U,Y)=>{console.log("Submitted:",U,Y);const ce=v.find(pe=>pe.id===U);if(ce!=null&&ce.interruptId)try{await w(ce.interruptId,Y)}catch(pe){console.error("Failed to submit answers:",pe)}_(null),k(null),x(pe=>{const ke=ge=>ge.map(de=>de.id===U&&de.stations?{...de,stations:de.stations.map(_e=>_e.id==="pgc"?{..._e,state:"complete",needs_input:!1}:_e.id==="asm"?{..._e,state:"active"}:_e)}:de.children?{...de,children:ke(de.children)}:de);return ke(pe)})}}),[I,v,w]),{layoutNodes:te,layoutEdges:ae}=m.useMemo(()=>{if(v.length===0)return{layoutNodes:[],layoutEdges:[]};const U={...ne,expandType:j,theme:o,onZoomToNode:X,projectId:e,projectCode:t},{nodes:Y,edges:ce,epicBacklogId:pe,epicChildren:ke}=DS(v,b,U),ge=OS(Y,ce),{nodes:de,edges:_e}=LS(ge,pe,ke,b,U);return{layoutNodes:de.map(Ce=>({...Ce,data:{...Ce.data,expandType:Ce.id===b?j:null}})),layoutEdges:_e}},[v,b,j,ne,o,X,e,t]),[Q,we,se]=nE(te),[Te,ue,Z]=iE(ae);m.useEffect(()=>{if(v.length===0)return;const U={...ne,expandType:j,theme:o,onZoomToNode:X,projectId:e,projectCode:t},{nodes:Y,edges:ce,epicBacklogId:pe,epicChildren:ke}=DS(v,b,U),ge=OS(Y,ce),{nodes:de,edges:_e}=LS(ge,pe,ke,b,U),Ve=de.map(Ce=>({...Ce,data:{...Ce.data,expandType:Ce.id===b?j:null}}));we(Ve),ue(_e)},[v,b,j,ne,we,ue,o,X,e,t]);const xe=m.useCallback((U,Y)=>{},[]);return p&&v.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):y&&v.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:l.jsx("p",{className:"text-red-500 mb-4",children:y})})}):l.jsxs("div",{className:"w-full h-full",children:[l.jsxs(Vx,{nodes:Q,edges:Te,onNodesChange:se,onEdgesChange:Z,onNodeClick:xe,nodeTypes:W$,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[l.jsx(Hn,{position:"top-left",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),l.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[h==="active"&&l.jsx("span",{className:"text-amber-500",children:" Active"}),h==="stopped"&&l.jsx("span",{className:"text-red-500",children:" Stopped"}),h==="complete"&&l.jsx("span",{className:"text-emerald-500",children:" Complete"}),h==="idle"&&l.jsx("span",{children:" Idle"}),!g&&l.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),l.jsx("button",{onClick:L,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:U$[o]})]})}),l.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:l.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),C?l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("input",{type:"text",value:R,onChange:U=>P(U.target.value),onKeyDown:U=>{U.key==="Enter"&&q(),U.key==="Escape"&&B()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:A}),l.jsx("button",{onClick:q,disabled:A,className:"p-1 rounded hover:bg-white/10",title:"Save",children:l.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M5 13l4 4L19 7"})})}),l.jsx("button",{onClick:B,disabled:A,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:l.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):l.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!C&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:O,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),l.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),l.jsx("button",{onClick:$,disabled:A,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:l.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&l.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),l.jsx("button",{onClick:()=>S(!0),disabled:A||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:l.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),l.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[l.jsxs("button",{onClick:()=>D(!z),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[l.jsx("span",{children:"Workflow"}),l.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:z?"":""})]}),z&&l.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:l.jsx(R6,{projectId:e})})]})]})}),l.jsx(aE,{position:"top-right",nodeColor:U=>{var ce;const Y=(ce=U.data)==null?void 0:ce.state;return["produced","stabilized","ready"].includes(Y)?"#10b981":["in_production","active"].includes(Y)?"#f59e0b":["requirements_not_met","blocked"].includes(Y)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),l.jsx(Hn,{position:"bottom-left",children:l.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[l.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),l.jsx(Hn,{position:"bottom-right",children:l.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),N&&l.jsx(k6,{projectId:e,projectCode:t,docTypeId:N,onClose:()=>E(null)}),F&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:l.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),l.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",l.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),l.jsxs("div",{className:"flex gap-3 justify-end",children:[l.jsx("button",{onClick:()=>S(!1),disabled:A,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),l.jsx("button",{onClick:V,disabled:A,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:A?"Deleting...":"Delete"})]})]})})]})}function el({messages:e,pendingPrompt:t}){const r=m.useRef(null);return m.useEffect(()=>{var n;(n=r.current)==null||n.scrollIntoView({behavior:"smooth"})},[e,t]),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.map((n,i)=>l.jsx("div",{className:`flex ${n.role==="user"?"justify-end":"justify-start"}`,children:l.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${n.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:n.content})},i)),t&&l.jsx("div",{className:"flex justify-start",children:l.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),l.jsx("div",{ref:r})]})}function G$({onSubmit:e,disabled:t,placeholder:r}){const[n,i]=m.useState(""),o=m.useRef(null);m.useEffect(()=>{var c;t||(c=o.current)==null||c.focus()},[t]);const s=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),i("")))},a=()=>{n.trim()&&!t&&(e(n.trim()),i(""))};return l.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("textarea",{ref:o,value:n,onChange:c=>i(c.target.value),onKeyDown:s,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),l.jsx("button",{onClick:a,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),l.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const Y$={project_name:"Project Name",problem_statement:"Problem Statement",project_type:"Project Type"},K$=["project_name","problem_statement","project_type"];function X$({interpretation:e,missingFields:t,canInitialize:r,onUpdateField:n,onInitialize:i,loading:o}){const[s,a]=m.useState(null),[c,u]=m.useState(""),d=(p,y)=>{a(p),u(y)},f=async()=>{s&&c.trim()&&(await n(s,c.trim()),a(null),u(""))},h=()=>{a(null),u("")};return l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Review & Lock"}),t.length>0&&l.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded bg-amber-500/20 text-amber-400",children:[t.length," missing"]})]}),K$.map(p=>{const y=e[p];if(!y)return null;const g=y.locked,w=t.includes(p),v=s===p;return l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"text-[10px] font-medium",style:{color:"var(--text-muted)"},children:[Y$[p]||p,w&&l.jsx("span",{className:"text-amber-400 ml-1",children:"*"})]}),g&&l.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"locked"})]}),v?l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:c,onChange:x=>u(x.target.value),onKeyDown:x=>{x.key==="Enter"&&f(),x.key==="Escape"&&h()},autoFocus:!0,className:"flex-1 rounded px-2 py-1.5 text-xs",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),l.jsx("button",{onClick:f,className:"px-2 py-1 rounded text-xs bg-emerald-500 text-white",children:"Save"}),l.jsx("button",{onClick:h,className:"px-2 py-1 rounded text-xs",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Cancel"})]}):l.jsx("div",{onClick:()=>!g&&d(p,y.value),className:`rounded px-2 py-1.5 text-xs ${g?"cursor-default":"cursor-pointer hover:bg-white/5"} ${w?"border border-amber-500/50":""}`,style:{background:"var(--bg-input)",color:y.value?"var(--text-primary)":"var(--text-muted)"},children:y.value||"Click to edit..."})]},p)}),l.jsx("button",{onClick:i,disabled:!r||o,className:`w-full py-2.5 rounded-lg text-sm font-medium transition-colors ${r&&!o?"bg-violet-500 text-white hover:bg-violet-400":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:o?"Initializing...":"Lock & Initialize Project"}),!r&&l.jsx("p",{className:"text-[10px] text-center",style:{color:"var(--text-muted)"},children:"Fill all required fields to continue"})]})}function Q$(){return l.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[l.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[l.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-violet-500/20"}),l.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent animate-spin"}),l.jsx("div",{className:"absolute inset-3 rounded-full bg-violet-500/20 animate-pulse"})]}),l.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"Generating Project"}),l.jsx("p",{className:"text-xs text-center max-w-[200px]",style:{color:"var(--text-muted)"},children:"Creating intake document and running quality checks..."}),l.jsxs("div",{className:"flex gap-1 mt-4",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"300ms"}})]})]})}const qS={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function Z$({type:e,className:t}){switch(e){case"check":return l.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M12 9v4M12 17h.01"}),l.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),l.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function J$({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const i=qS[e]||qS.blocked,o=e==="qualified";return l.jsxs("div",{className:"p-6 text-center",children:[l.jsx("div",{className:`w-16 h-16 rounded-full ${i.iconBg} flex items-center justify-center mx-auto mb-4`,children:l.jsx(Z$,{type:i.icon,className:`w-8 h-8 ${i.iconColor}`})}),l.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:i.title}),l.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:i.description}),o&&t&&l.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[l.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),l.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),l.jsxs("div",{className:"flex gap-2 justify-center",children:[o&&t&&l.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),l.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function eB({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:i,interpretation:o,missingFields:s,canInitialize:a,gateOutcome:c,project:u,error:d,loading:f,submitting:h,startIntake:p,submitMessage:y,updateField:g,lockAndGenerate:w,reset:v}=F$();m.useEffect(()=>(p(),()=>v()),[]);const x=()=>{v(),e()},b=()=>{u&&t&&t(u),x()},_=()=>{const k=[{id:"describe",label:"Describe"},{id:"review",label:"Review"},{id:"generating",label:"Generate"},{id:"complete",label:"Done"}],N=k.findIndex(E=>E.id===r);return l.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:k.map((E,C)=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:`px-2 py-0.5 rounded ${C===N?"bg-violet-500/30 text-violet-300":C<N?"text-emerald-400":"text-slate-500"}`,children:E.label}),C<k.length-1&&l.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},E.id))})},j=()=>{if(f&&r==="idle")return l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});switch(r){case"describe":return l.jsxs(l.Fragment,{children:[l.jsx(el,{messages:n,pendingPrompt:i}),l.jsx(G$,{onSubmit:y,disabled:h,placeholder:"Describe what you want to build..."})]});case"review":return l.jsxs(l.Fragment,{children:[l.jsx(el,{messages:n}),l.jsx("div",{className:"border-t",style:{borderColor:"var(--border-panel)"},children:l.jsx(X$,{interpretation:o,missingFields:s,canInitialize:a,onUpdateField:g,onInitialize:w,loading:f})})]});case"generating":return l.jsxs(l.Fragment,{children:[l.jsx(el,{messages:n}),l.jsx(Q$,{})]});case"complete":return l.jsxs(l.Fragment,{children:[l.jsx(el,{messages:n}),l.jsx(J$,{gateOutcome:c,project:u,onViewProject:b,onClose:x})]});default:return null}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:l.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),_()]})]}),l.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),d&&l.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:d}),j()]})})}function tB({onClose:e}){const{user:t,logout:r,isAdmin:n}=Do(),[i,o]=m.useState(null),[s,a]=m.useState([]),[c,u]=m.useState(!1),[d,f]=m.useState(null);m.useEffect(()=>{i==="linked"&&h()},[i]);const h=async()=>{try{u(!0);const j=await fetch("/auth/accounts",{credentials:"include"});if(j.ok){const k=await j.json();a(k.identities||[])}}catch(j){console.error("Failed to load accounts:",j)}finally{u(!1)}},p=j=>{window.location.href=`/auth/accounts/link/${j}`},y=async j=>{var k;if(s.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${j} account?`))try{const N=(k=document.cookie.split("; ").find(C=>C.startsWith("csrf=")||C.startsWith("__Host-csrf=")))==null?void 0:k.split("=")[1],E=await fetch(`/auth/accounts/${j}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(E.ok)f({type:"success",text:"Account unlinked"}),await h();else{const C=await E.json();throw new Error(C.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},g=async()=>{await r(),e()},w=j=>{o(i===j?null:j),f(null)},v={google:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},x=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=j=>{const k={user:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"9",cy:"7",r:"4"}),l.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),l.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),l.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"3"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return k[j]||k.user},_=j=>{switch(j){case"account":return l.jsxs("div",{className:"px-4 py-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),l.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),l.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return l.jsxs("div",{className:"px-4 py-3",children:[d&&l.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${d.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:d.text}),c?l.jsx("div",{className:"flex items-center justify-center py-4",children:l.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-2 mb-4",children:s.map(k=>l.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[v[k.provider_id],l.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:k.provider_email})]}),l.jsx("button",{onClick:()=>y(k.provider_id),disabled:s.length<=1,className:`text-xs px-2 py-1 rounded ${s.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},k.provider_id))}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),l.jsxs("button",{onClick:()=>p("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.google,"Google"]}),l.jsxs("button",{onClick:()=>p("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[v.microsoft,"Microsoft"]})]})]})]});default:return l.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),l.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?l.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):l.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),l.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&l.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),l.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[l.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),l.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),l.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[l.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),l.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),l.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),x.map(j=>l.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[l.jsxs("button",{onClick:()=>!j.future&&w(j.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${j.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:j.future,children:[l.jsx("span",{style:{color:"var(--text-muted)"},children:b(j.icon)}),l.jsx("span",{className:"flex-1 text-sm text-left",children:j.label}),j.future?l.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):l.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:i===j.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),i===j.id&&!j.future&&l.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:_(j.id)})]},j.id))]}),l.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),l.jsx("polyline",{points:"16 17 21 12 16 7"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Ee={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function rB(){return l.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Ee.bg,borderColor:Ee.border},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Ee.textPrimary},children:"THE COMBINE"}),l.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Ee.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function nB(){return l.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Ee.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),l.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Ee.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),l.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Ee.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ee.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ee.textMuted,children:["Learn how The Combine works",l.jsx("span",{"aria-hidden":"true",children:""})]})]})}function iB(){const e=[{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return l.jsx("section",{className:"max-w-4xl mx-auto",children:l.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>l.jsxs("div",{className:"flex-1 text-center group",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Ee.bgElevated,border:`1px solid ${Ee.border}`,color:Ee.textMuted},children:t.icon}),l.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Ee.textPrimary},children:t.title}),l.jsx("p",{className:"text-xs",style:{color:Ee.textMuted},children:t.description}),r<e.length-1&&l.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Ee.border}})]},r))})})}function oB(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return l.jsx("section",{className:"text-center",children:l.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>l.jsx("span",{className:"text-xs",style:{color:Ee.textMuted},children:t},r))})})}function sB({onLogin:e}){return l.jsxs("section",{className:"text-center",children:[l.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Ee.textSecondary},children:"Ready?"}),l.jsxs("div",{className:"inline-flex flex-col gap-3",children:[l.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ee.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ee.accent,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),l.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.bg,border:`1px solid ${Ee.border}`,color:Ee.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ee.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ee.bg,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function aB(){return l.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[l.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Terms"}),l.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Privacy"}),l.jsx("span",{className:"text-xs",style:{color:Ee.border},children:" 2026 The Combine"})]})}function lB(){const{login:e}=Do();return l.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ee.bg},children:[l.jsx(rB,{}),l.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:l.jsxs("div",{className:"space-y-12",children:[l.jsx(nB,{}),l.jsx(iB,{}),l.jsx(oB,{}),l.jsx(sB,{onLogin:e})]})}),l.jsx(aB,{})]})}const Se={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function cB(){return l.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Se.bg,borderColor:Se.border},children:[l.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Se.textMuted},onMouseOver:e=>e.currentTarget.style.color=Se.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Se.textMuted,children:[l.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),l.jsx("span",{className:"text-sm",children:"Back"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),l.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Se.textPrimary},children:"THE COMBINE"})]}),l.jsx("div",{className:"w-16"})," "]})}function ii({title:e,children:t}){return l.jsxs("section",{className:"mb-16",children:[e&&l.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Se.textPrimary},children:e}),t]})}function pt({children:e,className:t=""}){return l.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Se.textSecondary},children:e})}function es({children:e}){return l.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Se.textPrimary,borderLeft:`2px solid ${Se.border}`},children:e})}function tl({items:e}){return l.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>l.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Se.textSecondary},children:[l.jsx("span",{style:{color:Se.textMuted},children:"-"}),t]},r))})}function rl({number:e,title:t,children:r}){return l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[l.jsxs("span",{className:"text-sm font-mono",style:{color:Se.textMuted},children:[e,"."]}),l.jsx("h3",{className:"text-base font-medium",style:{color:Se.textPrimary},children:t})]}),l.jsx("div",{className:"pl-7",children:l.jsx(pt,{children:r})})]})}function nl({title:e,children:t}){return l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Se.textPrimary},children:e}),l.jsx(pt,{className:"mb-0",children:t})]})}function uB({onLogin:e}){return l.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Se.bgElevated,border:`1px solid ${Se.border}`},children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Se.textPrimary},children:"When You're Ready"}),l.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),l.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),l.jsx(pt,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),l.jsxs("div",{className:"inline-flex flex-col gap-3",children:[l.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Se.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Se.accentHover,onMouseOut:t=>t.currentTarget.style.background=Se.accent,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),l.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Se.bg,border:`1px solid ${Se.border}`,color:Se.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Se.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Se.bg,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function dB(){return l.jsxs("footer",{className:"py-8 text-center",children:[l.jsx("p",{className:"text-sm mb-6",style:{color:Se.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),l.jsxs("div",{className:"flex items-center justify-center gap-6",children:[l.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Se.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Se.textMuted,onMouseOut:e=>e.currentTarget.style.color=Se.textSubtle,children:"Terms"}),l.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Se.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Se.textMuted,onMouseOut:e=>e.currentTarget.style.color=Se.textSubtle,children:"Privacy"}),l.jsx("span",{className:"text-xs",style:{color:Se.border},children:" 2026 The Combine"})]})]})}function fB(){const{login:e}=Do();return l.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Se.bg},children:[l.jsx(cB,{}),l.jsx("main",{className:"flex-1 px-6 py-12",children:l.jsxs("article",{className:"max-w-2xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Se.textPrimary},children:"Learn More"}),l.jsxs(ii,{title:"What The Combine Is",children:[l.jsx(pt,{children:"The Combine is an AI-assisted production system for knowledge work."}),l.jsx(pt,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),l.jsx(es,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),l.jsx(es,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),l.jsxs(ii,{title:"Why It Exists",children:[l.jsx(pt,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),l.jsx(pt,{children:"It breaks down when the work must be:"}),l.jsx(tl,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),l.jsx(pt,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),l.jsxs(ii,{title:'Why "The Combine"',children:[l.jsx(pt,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),l.jsx(pt,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),l.jsx(pt,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),l.jsx(pt,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),l.jsx(pt,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),l.jsx(tl,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),l.jsx(pt,{children:"This is not automation for speed. It is industrialization for reliability."}),l.jsx(es,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),l.jsxs(ii,{title:"How It Works",children:[l.jsx(rl,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),l.jsx(rl,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),l.jsx(rl,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),l.jsx(rl,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),l.jsxs(ii,{title:"What Makes It Different",children:[l.jsx(nl,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),l.jsx(nl,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),l.jsx(nl,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),l.jsx(nl,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),l.jsxs(ii,{title:"What The Combine Is Not",children:[l.jsx(tl,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),l.jsx(pt,{children:"If you want improvisation, there are better tools."}),l.jsx(es,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),l.jsxs(ii,{title:"Who It's For",children:[l.jsx(pt,{children:"The Combine is designed for people responsible for outcomes, including:"}),l.jsx(tl,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),l.jsx(es,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),l.jsx(uB,{onLogin:e})]})}),l.jsx(dB,{})]})}function E4(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,o]=m.useState(null),s=m.useCallback(async()=>{n(!0),o(null);try{const a=await ye.getTemplates();t(a.templates||[])}catch(a){o(a.message),console.error("Failed to fetch templates:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{s()},[s]),{templates:e,loading:r,error:i,refresh:s}}function pB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,o]=m.useState(null),s=m.useCallback(async()=>{n(!0),o(null);try{const a=await ye.getOrchestrationWorkflows();t(a.workflows||[])}catch(a){o(a.message),console.error("Failed to fetch orchestration workflows:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{s()},[s]),{workflows:e,loading:r,error:i,refresh:s}}function R4(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,o]=m.useState(null),s=m.useCallback(async()=>{n(!0),o(null);try{const a=await ye.getSchemas();t(a.schemas||[])}catch(a){o(a.message),console.error("Failed to fetch schemas:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{s()},[s]),{schemas:e,loading:r,error:i,refresh:s}}function T4(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,o]=m.useState(null);m.useEffect(()=>{let f=!0;async function h(){n(!0),o(null);try{const p=await ye.getPromptFragments();f&&t(p.fragments||[])}catch(p){console.error("Failed to fetch prompt fragments:",p),f&&o(p.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return h(),()=>{f=!1}},[]);const s=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const h of e){const p=h.kind;f[p]&&f[p].push(h)}return f},[e]),a=m.useMemo(()=>({all:e.length,role:s.role.length,task:s.task.length,qa:s.qa.length,pgc:s.pgc.length,questions:s.questions.length,reflection:s.reflection.length}),[e,s]),c=m.useCallback(f=>!f||f==="all"?e:s[f]||[],[e,s]),u=m.useMemo(()=>{const f=[{id:"all",label:"All",count:a.all},{id:"role",label:"Roles",count:a.role},{id:"task",label:"Tasks",count:a.task},{id:"qa",label:"QA",count:a.qa},{id:"pgc",label:"PGC",count:a.pgc}];return a.questions>0&&f.push({id:"questions",label:"Questions",count:a.questions}),a.reflection>0&&f.push({id:"reflection",label:"Reflection",count:a.reflection}),f},[a]),d=m.useCallback(async()=>{n(!0),o(null);try{const f=await ye.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),o(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:i,fragmentsByKind:s,kindCounts:a,kindOptions:u,filterByKind:c,refresh:d}}function hB({kinds:e=[],selectedKind:t="all",onSelect:r}){return l.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:i,count:o})=>{const s=t===n;return l.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:s?"var(--action-primary)":"var(--bg-panel)",color:s?"#000":"var(--text-secondary)",border:s?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[i,o!==void 0&&l.jsxs("span",{style:{marginLeft:4,opacity:s?.7:.6},children:["(",o,")"]})]},n)})})}const Qm="doctype-browser-collapsed";function hy(e,t){const[r,n]=m.useState(()=>{try{const o=JSON.parse(localStorage.getItem(Qm)||"{}");return e in o?o[e]:t}catch{return t}}),i=m.useCallback(o=>{const s=typeof o=="function"?o(r):o;n(s);try{const a=JSON.parse(localStorage.getItem(Qm)||"{}");a[e]=s,localStorage.setItem(Qm,JSON.stringify(a))}catch{}},[e,r]);return[r,i]}function Zm({title:e,defaultOpen:t=!0,children:r}){const[n,i]=hy(`group:${e}`,t);return l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[l.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function $S({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:i}){const[o,s]=hy(`sub:${e}`,r);return l.jsxs("div",{children:[l.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[l.jsxs("button",{onClick:()=>s(!o),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[l.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&l.jsx("span",{style:{color:n,fontSize:8},children:""}),l.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),o&&i]})}function zi({selected:e,onClick:t,label:r,sublabel:n,badge:i}){return l.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"font-medium truncate",children:r}),i&&l.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:i})]}),n&&l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function Jm({label:e,count:t,dotColor:r,active:n,defaultOpen:i=!1,action:o,children:s}){const[a,c]=hy(`bb:${e}`,i);return l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center",style:{background:n?"var(--bg-selected)":"transparent",borderLeft:n?"2px solid var(--action-primary)":"2px solid transparent"},children:[l.jsxs("button",{onClick:()=>c(!a),className:"flex-1 px-4 py-2 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:n?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("span",{style:{color:r,fontSize:10},children:""}),l.jsx("span",{className:"font-medium",children:e})]}),l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t}),l.jsx("span",{style:{color:"var(--text-muted)",transform:a?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""})]})]}),o&&l.jsx("div",{className:"pr-2",children:o})]}),a&&s]})}function ts({loading:e,empty:t,emptyMessage:r="None found"}){return e?l.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?l.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function mB({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:i=[],promptFragmentKindOptions:o=[],schemas:s=[],loading:a=!1,rolesLoading:c=!1,templatesLoading:u=!1,workflowsLoading:d=!1,promptFragmentsLoading:f=!1,schemasLoading:h=!1,selectedDocType:p=null,docTypeSource:y=null,selectedRole:g=null,selectedTemplate:w=null,selectedWorkflow:v=null,selectedFragment:x=null,selectedSchema:b=null,onSelectDocType:_,onSelectRole:j,onSelectTemplate:k,onSelectWorkflow:N,onSelectFragment:E,onSelectStandaloneSchema:C,onCreateWorkflow:T,onCreateDocType:R,onCreateFragment:P,onCreateTemplate:F,onCreateSchema:S,onSelectTask:A,onSelectSchema:M,workspaceState:z=null}){var Yt;const[D,I]=m.useState(null),[L,O]=m.useState(null),[q,B]=m.useState(""),[$,V]=m.useState(!1),[X,ne]=m.useState(!1),[te,ae]=m.useState(""),[Q,we]=m.useState(!1),[se,Te]=m.useState("all"),[ue,Z]=m.useState(!1),[xe,U]=m.useState("role"),[Y,ce]=m.useState(""),[pe,ke]=m.useState(!1),[ge,de]=m.useState(!1),[_e,Ve]=m.useState(""),[Ce,Le]=m.useState(!1),[Oe,Ge]=m.useState(!1),[G,he]=m.useState(""),[le,Ye]=m.useState(!1),Je=[...e].sort((H,Ie)=>(H.display_name||"").localeCompare(Ie.display_name||"")),xt=n.filter(H=>(H.pow_class||"reference")==="reference"),ie=H=>{const Ie=H.pow_class||"reference";return Ie==="reference"?"ref":Ie==="template"?"tpl":"inst"},ee=e.filter(H=>H.active_version).length+n.filter(H=>H.active_version).length,$e=((Yt=z==null?void 0:z.modified_artifacts)==null?void 0:Yt.length)??0,gr=(z==null?void 0:z.is_dirty)??!1,vr=se==="all"?i:i.filter(H=>H.kind===se),Mr=()=>{I(null),O(null),B("")},Ke=()=>{ne(!1),ae("")},Fe=()=>{Z(!1),U("role"),ce("")},at=()=>{de(!1),Ve("")},Dt=()=>{Ge(!1),he("")},yt=async()=>{const H=te.trim().toLowerCase().replace(/\s+/g,"_");if(!(!H||!/^[a-z][a-z0-9_]*$/.test(H))){we(!0);try{await(R==null?void 0:R({doc_type_id:H})),Ke()}catch{}finally{we(!1)}}},ft=async()=>{const H=Y.trim().toLowerCase().replace(/\s+/g,"_");if(!(!H||!/^[a-z][a-z0-9_]*$/.test(H))){ke(!0);try{await(P==null?void 0:P({role_id:H,kind:xe})),Fe()}catch{}finally{ke(!1)}}},Tt=async()=>{const H=_e.trim().toLowerCase().replace(/\s+/g,"_");if(!(!H||!/^[a-z][a-z0-9_]*$/.test(H))){Le(!0);try{await(F==null?void 0:F({template_id:H})),at()}catch{}finally{Le(!1)}}},xr=async()=>{const H=G.trim().toLowerCase().replace(/\s+/g,"_");if(!(!H||!/^[a-z][a-z0-9_]*$/.test(H))){Ye(!0);try{await(S==null?void 0:S({schema_id:H})),Dt()}catch{}finally{Ye(!1)}}},et=async()=>{const H=q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!H||!/^[a-z][a-z0-9_]*$/.test(H))){V(!0);try{const Ie={workflow_id:H,pow_class:"template"};L&&(Ie.derived_from={workflow_id:L.workflow_id,version:L.active_version},Ie.source_version=L.active_version),await(T==null?void 0:T(Ie)),Mr()}catch{}finally{V(!1)}}};return l.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l.jsxs(Zm,{title:"Production Workflows",defaultOpen:!0,children:[l.jsxs($S,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:T&&l.jsx("button",{onClick:()=>I(D?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[D==="choose"&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsxs("button",{onClick:()=>I("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:xt.length===0,children:["From Reference",xt.length===0?" (none available)":""]}),l.jsx("button",{onClick:()=>I("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),l.jsx("button",{onClick:Mr,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),D==="from_reference"&&!L&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),xt.map(H=>l.jsxs("button",{onClick:()=>O(H),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[l.jsx("div",{className:"font-medium",children:H.name||H.workflow_id.replace(/_/g," ").replace(/\b\w/g,Ie=>Ie.toUpperCase())}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",H.active_version]})]},H.workflow_id)),l.jsx("button",{onClick:()=>I("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(D==="blank"||D==="from_reference"&&L)&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[L&&l.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",L.name||L.workflow_id," v",L.active_version]}),l.jsx("input",{type:"text",value:q,onChange:H=>B(H.target.value),onKeyDown:H=>{H.key==="Enter"&&et(),H.key==="Escape"&&Mr()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:$,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:et,disabled:$||!q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:$?"wait":"pointer",opacity:!q.trim()||$?.5:1},children:$?"Creating...":"Create"}),l.jsx("button",{onClick:Mr,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),l.jsx(ts,{loading:d,empty:!d&&n.length===0,emptyMessage:"No workflows"}),!d&&n.length>0&&l.jsx("div",{className:"py-1",children:n.map(H=>l.jsx(zi,{selected:(v==null?void 0:v.workflow_id)===H.workflow_id,onClick:()=>N==null?void 0:N(H),label:H.name||H.workflow_id.replace(/_/g," ").replace(/\b\w/g,Ie=>Ie.toUpperCase()),sublabel:`v${H.active_version}`,badge:ie(H)},H.workflow_id))})]}),l.jsxs($S,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:R&&l.jsx("button",{onClick:()=>ne(!X),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[X&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsx("input",{type:"text",value:te,onChange:H=>ae(H.target.value),onKeyDown:H=>{H.key==="Enter"&&yt(),H.key==="Escape"&&Ke()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:Q,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:yt,disabled:Q||!te.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Q?"wait":"pointer",opacity:!te.trim()||Q?.5:1},children:Q?"Creating...":"Create"}),l.jsx("button",{onClick:Ke,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),l.jsx(ts,{loading:a,empty:!a&&e.length===0,emptyMessage:"No document workflows"}),!a&&Je.length>0&&l.jsx("div",{className:"py-1",children:Je.map(H=>l.jsx(zi,{selected:y==="docworkflow"&&(p==null?void 0:p.doc_type_id)===H.doc_type_id,onClick:()=>_==null?void 0:_(H),label:H.display_name,badge:`v${H.active_version}`},H.doc_type_id))})]})]}),l.jsxs(Zm,{title:"Building Blocks",defaultOpen:!0,children:[l.jsxs(Jm,{label:"Prompt Fragments",count:i.length,dotColor:"#f59e0b",active:!!x,defaultOpen:!0,action:P&&l.jsx("button",{onClick:()=>Z(!ue),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[ue&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsxs("div",{className:"mb-2",children:[l.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),l.jsx("select",{value:xe,onChange:H=>U(H.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:l.jsx("option",{value:"role",children:"Role"})})]}),l.jsx("input",{type:"text",value:Y,onChange:H=>ce(H.target.value),onKeyDown:H=>{H.key==="Enter"&&ft(),H.key==="Escape"&&Fe()},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:pe,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:ft,disabled:pe||!Y.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:pe?"wait":"pointer",opacity:!Y.trim()||pe?.5:1},children:pe?"Creating...":"Create"}),l.jsx("button",{onClick:Fe,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.length>0&&l.jsx(hB,{kinds:o,selectedKind:se,onSelect:Te}),l.jsx(ts,{loading:f,empty:!f&&vr.length===0,emptyMessage:se==="all"?"No prompt fragments":`No ${se} fragments`}),!f&&vr.length>0&&l.jsx("div",{className:"py-1",children:vr.map(H=>l.jsx(zi,{selected:(x==null?void 0:x.fragment_id)===H.fragment_id,onClick:()=>E==null?void 0:E(H),label:H.name||H.fragment_id,sublabel:`${H.kind}  v${H.version}`,badge:H.kind},H.fragment_id))})]}),l.jsxs(Jm,{label:"Templates",count:r.length,dotColor:"var(--dot-green)",active:!!w,action:F&&l.jsx("button",{onClick:()=>de(!ge),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[ge&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsx("input",{type:"text",value:_e,onChange:H=>Ve(H.target.value),onKeyDown:H=>{H.key==="Enter"&&Tt(),H.key==="Escape"&&at()},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:Ce,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Tt,disabled:Ce||!_e.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Ce?"wait":"pointer",opacity:!_e.trim()||Ce?.5:1},children:Ce?"Creating...":"Create"}),l.jsx("button",{onClick:at,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),l.jsx(ts,{loading:u,empty:!u&&r.length===0,emptyMessage:"No templates"}),!u&&r.length>0&&l.jsx("div",{className:"py-1",children:r.map(H=>l.jsx(zi,{selected:(w==null?void 0:w.template_id)===H.template_id,onClick:()=>k==null?void 0:k(H),label:H.name||H.template_id.replace(/_/g," ").replace(/\b\w/g,Ie=>Ie.toUpperCase()),sublabel:`v${H.active_version}`},H.template_id))})]}),l.jsxs(Jm,{label:"Schemas",count:s.length||e.length,dotColor:"var(--dot-blue)",active:y==="schema"||!!b,action:S&&l.jsx("button",{onClick:()=>Ge(!Oe),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[Oe&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsx("input",{type:"text",value:G,onChange:H=>he(H.target.value),onKeyDown:H=>{H.key==="Enter"&&xr(),H.key==="Escape"&&Dt()},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:le,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:xr,disabled:le||!G.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:le?"wait":"pointer",opacity:!G.trim()||le?.5:1},children:le?"Creating...":"Create"}),l.jsx("button",{onClick:Dt,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),l.jsx(ts,{loading:h||a,empty:!h&&!a&&s.length===0&&e.length===0,emptyMessage:"No schemas"}),!h&&s.length>0&&l.jsx("div",{className:"py-1",children:s.map(H=>l.jsx(zi,{selected:(b==null?void 0:b.schema_id)===H.schema_id,onClick:()=>C==null?void 0:C(H),label:H.title||H.schema_id,sublabel:`v${H.active_version}`},`standalone-${H.schema_id}`))}),!a&&s.length===0&&e.length>0&&l.jsx("div",{className:"py-1",children:e.map(H=>l.jsx(zi,{selected:y==="schema"&&(p==null?void 0:p.doc_type_id)===H.doc_type_id,onClick:()=>{var Ie;return(Ie=M||_)==null?void 0:Ie({doc_type_id:H.doc_type_id,display_name:H.display_name,active_version:H.active_version})},label:H.display_name,sublabel:`from ${H.doc_type_id}`},`schema-${H.doc_type_id}`))})]})]}),l.jsxs(Zm,{title:"Governance",defaultOpen:!1,children:[l.jsx("div",{className:"px-4 py-3",children:l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),l.jsxs("div",{children:[ee," active ",ee===1?"release":"releases"]})]})}),z&&l.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),gr&&l.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[$e," dirty"]})]})]})]})})}function In({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:i=!1,error:o=null,readOnly:s=!1,placeholder:a="Enter prompt content...",isJson:c=!1}){const u=m.useCallback(()=>{if(!(!e||!c))try{const d=JSON.parse(e),f=JSON.stringify(d,null,2);t==null||t(f)}catch(d){console.warn("Invalid JSON, cannot format:",d.message)}},[e,c,t]);return l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[s&&l.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!s&&i&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[c&&!s&&l.jsx("button",{onClick:u,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&l.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&i&&l.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),o&&l.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",o]})]})]}),l.jsx("div",{className:"flex-1 relative",children:r?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):l.jsx("textarea",{value:e,onChange:d=>t==null?void 0:t(d.target.value),placeholder:a,readOnly:s,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function gB({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[i,o]=m.useState(!0),[s,a]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),o(!1);return}(async()=>{o(!0),a(null);try{const u=await ye.getPreview(e,t);n(u)}catch(u){a(u.message),console.error("Failed to load preview:",u)}finally{o(!1)}})()},[e,t]),l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),l.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&l.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&l.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&l.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&l.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),l.jsx("div",{className:"flex-1 relative overflow-auto",children:i?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):s?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[l.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),l.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s})]})}):l.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function vB({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[i,o]=m.useState(null),[s,a]=m.useState(!1),[c,u]=m.useState(!1),[d,f]=m.useState(null),[h,p]=m.useState(!1);m.useEffect(()=>{var b,_,j;t&&(o({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((_=t.ui)==null?void 0:_.category)||"",ui_display_order:((j=t.ui)==null?void 0:j.display_order)||0}),p(!1),f(null))},[t]);const y=m.useCallback((b,_)=>{o(j=>({...j,[b]:_})),p(!0)},[]),g=m.useCallback((b,_)=>{const j=_.split(",").map(k=>k.trim()).filter(k=>k);o(k=>({...k,[b]:j})),p(!0)},[]),w=m.useCallback(b=>{if(!b)return"";const _=r.find(j=>j.role_id===b);return _?`prompt:role:${b}:${_.active_version}`:""},[r]),v=m.useCallback(b=>{if(!b)return"";const _=b.split(":");return _.length>=3&&_[0]==="prompt"&&_[1]==="role"?_[2]:""},[]),x=m.useCallback(async()=>{if(!(!e||!t||!i)){u(!0),f(null);try{const b=t.version||t.active_version,_=`doctype:${t.doc_type_id}:${b}:manifest`,j=xB(t.doc_type_id,b,i),k=await ye.writeArtifact(e,_,j);p(!1),n==null||n(_,k)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{u(!1)}}},[e,t,i,n]);return!t||!i?l.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsx("div",{className:"flex items-center gap-2",children:h&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[c&&l.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),d&&l.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",d]}),l.jsx("button",{onClick:x,disabled:!h||c,className:"px-3 py-1 rounded text-xs",style:{background:h?"var(--action-primary)":"var(--bg-panel)",color:h?"#000":"var(--text-muted)",opacity:h&&!c?1:.5},children:"Save Package"})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"max-w-2xl space-y-6",children:[l.jsxs(rs,{title:"Identity",children:[l.jsx(Kt,{label:"Display Name",children:l.jsx("input",{type:"text",value:i.display_name,onChange:b=>y("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(Kt,{label:"Description",children:l.jsx("textarea",{value:i.description,onChange:b=>y("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),l.jsxs(rs,{title:"Classification",children:[l.jsx(Kt,{label:"Authority Level",children:l.jsxs("select",{value:i.authority_level,onChange:b=>y("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"descriptive",children:"Descriptive"}),l.jsx("option",{value:"prescriptive",children:"Prescriptive"}),l.jsx("option",{value:"constructive",children:"Constructive"}),l.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),l.jsx(Kt,{label:"Creation Mode",children:l.jsxs("select",{value:i.creation_mode,onChange:b=>y("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"llm_generated",children:"LLM Generated"}),l.jsx("option",{value:"constructed",children:"Constructed"}),l.jsx("option",{value:"extracted",children:"Extracted"})]})}),l.jsx(Kt,{label:"Scope",children:l.jsxs("select",{value:i.scope,onChange:b=>y("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"project",children:"Project"}),l.jsx("option",{value:"epic",children:"Epic"}),l.jsx("option",{value:"feature",children:"Feature"})]})})]}),l.jsx(rs,{title:"Shared References",children:l.jsxs(Kt,{label:"Role Prompt",children:[l.jsxs("select",{value:v(i.role_prompt_ref),onChange:b=>y("role_prompt_ref",w(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"",children:"None"}),r.map(b=>l.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())},b.role_id))]}),i.role_prompt_ref&&l.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:i.role_prompt_ref})]})}),l.jsxs(rs,{title:"Dependencies",children:[l.jsx(Kt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:i.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(Kt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:i.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(Kt,{label:"Parent Doc Type",children:l.jsx("input",{type:"text",value:i.parent_doc_type,onChange:b=>y("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(Kt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:i.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),l.jsxs(rs,{title:"UI Configuration",children:[l.jsx(Kt,{label:"Icon",children:l.jsx("input",{type:"text",value:i.ui_icon,onChange:b=>y("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(Kt,{label:"Category",children:l.jsxs("select",{value:i.ui_category,onChange:b=>y("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"",children:"Select category..."}),l.jsx("option",{value:"intake",children:"Intake"}),l.jsx("option",{value:"architecture",children:"Architecture"}),l.jsx("option",{value:"planning",children:"Planning"}),l.jsx("option",{value:"execution",children:"Execution"})]})}),l.jsx(Kt,{label:"Display Order",children:l.jsx("input",{type:"number",value:i.ui_display_order,onChange:b=>y("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function rs({title:e,children:t}){return l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),l.jsx("div",{className:"space-y-4",children:t})]})}function Kt({label:e,hint:t,children:r}){return l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&l.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function xB(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(i=>`"${i}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(i=>`"${i}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(i=>`"${i}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function A4(e,t,{debounceMs:r=1e3,onSave:n}={}){const[i,o]=m.useState(null),[s,a]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null),[h,p]=m.useState(!1),[y,g]=m.useState(null),w=m.useRef(null),v=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){o(null),a(null),u(!1);return}u(!0),f(null);try{const N=await ye.getArtifact(e,t),E=JSON.parse(N.content);o(E),a(E)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{u(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){p(!0),f(null);try{const E=JSON.stringify(N,null,2),C=await ye.writeArtifact(e,t,E);g(C),a(N),n&&n(C)}catch(E){f(E.message),console.error("Failed to save workflow:",E)}finally{p(!1)}}},[e,t,n]),_=m.useCallback(N=>{v.current=N,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v.current!==null&&(b(v.current),v.current=null)},r)},[b,r]),j=m.useCallback(N=>{o(N),_(N)},[_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),i&&b(i)},[i,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{workflowJson:i,originalJson:s,loading:c,error:d,saving:h,lastSaveResult:y,isDirty:i!==s,updateWorkflow:j,saveNow:k,reload:x}}function yB({data:e,selected:t}){const{config:r,isEntry:n}=e,i=e.type==="end";return l.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[l.jsx(Wr,{type:"target",position:re.Top,style:{background:r.color,width:8,height:8,border:"none"}}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[l.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&l.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),l.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&l.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),l.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!i&&l.jsx(Wr,{type:"source",position:re.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const bB=m.memo(yB),ac={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},wB={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},BS=220,HS=110;function WS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(i=>{const o=ac[i.type]||ac.task,a=i.type==="end"&&["blocked","abandoned"].includes(i.terminal_outcome)?wB:o;return{id:i.node_id,type:"workflowNode",position:i._position||{x:0,y:0},data:{...i,config:a,isEntry:t.includes(i.node_id)}}}),n=(e.edges||[]).map(i=>{const o=i.non_advancing||!i.to_node_id,s=i.conditions&&i.conditions.length>0;let a=i.label||i.outcome;if(s){const c=i.conditions[0],u={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;a=`${a} (${c.type} ${u} ${c.value})`}return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id||i.from_node_id,type:"smoothstep",animated:o,label:a,data:{...i},style:{stroke:o?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:o?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:i.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function US(e,t,r="TB"){const n=new sc.graphlib.Graph;return n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(i=>{n.setNode(i.id,{width:BS,height:HS})}),t.forEach(i=>{i.target!==i.source&&n.setEdge(i.source,i.target)}),sc.layout(n),e.map(i=>{const o=n.node(i.id);return o?{...i,position:{x:o.x-BS/2,y:o.y-HS/2}}:i})}function _B(e,t){const r=new Set(t.map(o=>o.id||o.node_id));let n=1,i=`${e}_${n}`;for(;r.has(i);)n++,i=`${e}_${n}`;return i}function SB(e,t,r){const n=new Set(r.map(s=>s.id||s.edge_id));let i=1,o=`${e}_to_${t}`;for(;n.has(o);)i++,o=`${e}_to_${t}_${i}`;return o}function kB(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const jB={workflowNode:bB},CB=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function NB({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:i,onEdgeSelect:o}){const s=Bc(),[a,c,u]=nE([]),[d,f,h]=iE([]),[p,y]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:C,edges:T}=WS(e);(!C.some(P=>P.position.x!==0||P.position.y!==0)||!g.current)&&(C=US(C,T),g.current=!0),c(C),f(T)},[e,c,f]),m.useEffect(()=>{c(C=>C.map(T=>({...T,selected:T.id===r})))},[r,c]);const w=m.useCallback(C=>{if(!e)return;const R={edge_id:SB(C.source,C.target,e.edges||[]),from_node_id:C.source,to_node_id:C.target,outcome:"success",label:"",kind:"auto"},P={...e,edges:[...e.edges||[],R]};t(P)},[e,t]),v=m.useCallback((C,T)=>{if(!e)return;const R=e.nodes.map(P=>P.node_id===T.id?{...P,_position:T.position}:P);t({...e,nodes:R})},[e,t]),x=m.useCallback((C,T)=>{i==null||i(T.id)},[i]),b=m.useCallback((C,T)=>{o==null||o(T.id)},[o]),_=m.useCallback(()=>{i==null||i(null),o==null||o(null)},[i,o]),j=m.useCallback(C=>{if(C.key==="Delete"||C.key==="Backspace"){if(r&&e){const T={...e,nodes:e.nodes.filter(R=>R.node_id!==r),edges:e.edges.filter(R=>R.from_node_id!==r&&R.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(R=>R!==r)};t(T),i==null||i(null)}else if(n&&e){const T={...e,edges:e.edges.filter(R=>R.edge_id!==n)};t(T),o==null||o(null)}}},[r,n,e,t,i,o]),k=m.useCallback(C=>{if(!e)return;const T=_B(C,e.nodes||[]),R=kB(C);R.node_id=T;const P=s.getViewport(),F=(-P.x+window.innerWidth/2)/P.zoom,S=(-P.y+window.innerHeight/2)/P.zoom;R._position={x:F-110,y:S-50};const A={...e,nodes:[...e.nodes||[],R]};t(A),y(!1),i==null||i(T)},[e,t,s,i]),N=m.useCallback(()=>{if(!e)return;let{nodes:C,edges:T}=WS(e);C=US(C,T);const R=e.nodes.map(P=>{const F=C.find(S=>S.id===P.node_id);return F?{...P,_position:F.position}:P});t({...e,nodes:R}),setTimeout(()=>{s.fitView({padding:.2,duration:300})},50)},[e,t,s]),E=m.useCallback(()=>{s.fitView({padding:.2,duration:300})},[s]);return l.jsx("div",{className:"flex-1 relative",onKeyDown:j,tabIndex:0,style:{outline:"none"},children:l.jsxs(Vx,{nodes:a,edges:d,onNodesChange:u,onEdgesChange:h,onConnect:w,onNodeDragStop:v,onNodeClick:x,onEdgeClick:b,onPaneClick:_,nodeTypes:jB,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[l.jsx(Hn,{position:"top-left",children:l.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>y(!p),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),p&&l.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:CB.map(C=>{const T=ac[C.value]||{};return l.jsxs("button",{onClick:()=>k(C.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:T.color}}),C.label]},C.value)})})]}),l.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),l.jsx("button",{onClick:E,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),l.jsx(aE,{position:"bottom-right",nodeColor:C=>{var R;const T=(R=C.data)==null?void 0:R.config;return(T==null?void 0:T.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),l.jsx(Hn,{position:"bottom-left",children:l.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(ac).map(([C,T])=>l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:T.color}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:T.label})]},C))})}),l.jsx(Hn,{position:"top-right",children:l.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const EB=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],RB=["semantic","structural","hybrid"],TB=["stabilized","blocked","abandoned"],Lt={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Xr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function AB(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function IB(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function eg(e){var i;if(!e)return"";const t=e.kind||"role",r=((i=e.fragment_id)==null?void 0:i.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function tg(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function MB(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function PB(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function OB({node:e,onChange:t,onDelete:r,templates:n=[],schemas:i=[],roleFragments:o=[],taskFragments:s=[],pgcFragments:a=[]}){const[c,u]=m.useState(e);m.useEffect(()=>{u(e)},[e]);const d=(S,A)=>{const M={...c,[S]:A};u(M),t(M)},f=(S,A)=>{const M={...c.includes,[S]:A},z={...c,includes:M};u(z),t(z)},h=S=>{const A={...c.includes};delete A[S];const M={...c,includes:A};u(M),t(M)},p=()=>{const S={...c.includes,NEW_KEY:""},A={...c,includes:S};u(A),t(A)};if(!c)return null;const y=IB(c.task_ref),g=c.includes||{},w=g.ROLE_PROMPT||"",v=g.TASK_PROMPT||"",x=g.OUTPUT_SCHEMA||"",b=g.PGC_CONTEXT||"",_=tg(w),j=tg(v),k=PB(x),N=tg(b),E=Object.entries(g).filter(([S])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(S)),C=S=>{const A=S.target.value;if(!A){d("task_ref","");return}const M=n.find(z=>z.template_id===A);M&&d("task_ref",AB(M))},T=S=>{const A=S.target.value;if(!A){h("ROLE_PROMPT");return}const M=o.find(z=>z.fragment_id===`role:${A}`||z.id===A);M&&f("ROLE_PROMPT",eg(M))},R=S=>{const A=S.target.value;if(!A){h("TASK_PROMPT");return}const M=s.find(z=>z.fragment_id===`task:${A}`||z.id===A);M&&f("TASK_PROMPT",eg(M))},P=S=>{const A=S.target.value;if(!A){h("OUTPUT_SCHEMA");return}const M=i.find(z=>z.schema_id===A);M&&f("OUTPUT_SCHEMA",MB(M))},F=S=>{const A=S.target.value;if(!A){h("PGC_CONTEXT");return}const M=a.find(z=>z.fragment_id===`pgc:${A}`||z.id===A);M&&f("PGC_CONTEXT",eg(M))};return l.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Node Properties"}),l.jsx("button",{onClick:()=>r(c.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"Node ID"}),l.jsx("input",{type:"text",value:c.node_id||"",onChange:S=>d("node_id",S.target.value),style:Lt})]}),l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"Type"}),l.jsx("select",{value:c.type||"task",onChange:S=>d("type",S.target.value),style:Lt,children:EB.map(S=>l.jsx("option",{value:S.value,children:S.label},S.value))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"Description"}),l.jsx("textarea",{value:c.description||"",onChange:S=>d("description",S.target.value),rows:3,style:{...Lt,resize:"vertical"}})]}),["task","qa","pgc","intake_gate"].includes(c.type)&&l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"Interaction Template"}),l.jsxs("select",{value:y||"",onChange:C,style:Lt,children:[l.jsx("option",{value:"",children:"-- Select Template --"}),n.map(S=>l.jsx("option",{value:S.template_id,children:S.name||S.template_id.replace(/_/g," ")},S.template_id))]}),c.task_ref&&l.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:c.task_ref,children:c.task_ref})]}),["task","intake_gate"].includes(c.type)&&l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"Produces"}),l.jsx("input",{type:"text",value:c.produces||"",onChange:S=>d("produces",S.target.value),placeholder:"document_type",style:Lt})]}),c.type==="qa"&&l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"QA Mode"}),l.jsx("select",{value:c.qa_mode||"semantic",onChange:S=>d("qa_mode",S.target.value),style:Lt,children:RB.map(S=>l.jsx("option",{value:S,children:S},S))})]}),c.type==="end"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"Terminal Outcome"}),l.jsx("select",{value:c.terminal_outcome||"stabilized",onChange:S=>d("terminal_outcome",S.target.value),style:Lt,children:TB.map(S=>l.jsx("option",{value:S,children:S},S))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Xr,children:"Gate Outcome"}),l.jsx("input",{type:"text",value:c.gate_outcome||"",onChange:S=>d("gate_outcome",S.target.value),placeholder:"e.g., complete, failed",style:Lt})]})]}),l.jsxs("div",{className:"flex gap-4",children:[c.type==="qa"&&l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:c.requires_qa||!1,onChange:S=>d("requires_qa",S.target.checked)}),"Requires QA"]}),l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:c.non_advancing||!1,onChange:S=>d("non_advancing",S.target.checked)}),"Non-advancing"]})]}),["task","pgc"].includes(c.type)&&l.jsxs("div",{children:[l.jsx("div",{className:"flex items-center justify-between mb-2",children:l.jsx("label",{style:Xr,children:"Includes"})}),l.jsxs("div",{className:"mb-2",children:[l.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),l.jsxs("select",{value:_||"",onChange:T,style:{...Lt,fontSize:11},children:[l.jsx("option",{value:"",children:"-- Select Role --"}),o.map(S=>{var M;const A=((M=S.fragment_id)==null?void 0:M.replace("role:",""))||S.id;return l.jsx("option",{value:A,children:S.name||(A==null?void 0:A.replace(/_/g," "))},S.fragment_id||S.id)})]})]}),l.jsxs("div",{className:"mb-2",children:[l.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),l.jsxs("select",{value:j||"",onChange:R,style:{...Lt,fontSize:11},children:[l.jsx("option",{value:"",children:"-- Select Task --"}),s.map(S=>{var M;const A=((M=S.fragment_id)==null?void 0:M.replace("task:",""))||S.id;return l.jsx("option",{value:A,children:S.name||(A==null?void 0:A.replace(/_/g," "))},S.fragment_id||S.id)})]})]}),l.jsxs("div",{className:"mb-2",children:[l.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),l.jsxs("select",{value:k||"",onChange:P,style:{...Lt,fontSize:11},children:[l.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(S=>l.jsx("option",{value:S.schema_id,children:S.title||S.schema_id.replace(/_/g," ")},S.schema_id))]})]}),l.jsxs("div",{className:"mb-2",children:[l.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),l.jsxs("select",{value:N||"",onChange:F,style:{...Lt,fontSize:11},children:[l.jsx("option",{value:"",children:"-- Select PGC Context --"}),a.map(S=>{var M;const A=((M=S.fragment_id)==null?void 0:M.replace("pgc:",""))||S.id;return l.jsx("option",{value:A,children:S.name||(A==null?void 0:A.replace(/_/g," "))},S.fragment_id||S.id)})]})]}),E.length>0&&l.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[l.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),l.jsx("div",{className:"space-y-2",children:E.map(([S,A])=>l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"text",value:S,onChange:M=>{const z={...c.includes};delete z[S],z[M.target.value]=A;const D={...c,includes:z};u(D),t(D)},style:{...Lt,width:"35%",fontSize:10},placeholder:"KEY"}),l.jsx("input",{type:"text",value:A,onChange:M=>f(S,M.target.value),style:{...Lt,flex:1,fontSize:10},placeholder:"path/to/file"}),l.jsx("button",{onClick:()=>h(S),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},S))})]}),l.jsx("button",{onClick:p,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const DB=["auto","user_choice"],LB=["eq","ne","lt","lte","gt","gte"],Qr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},oi={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function FB({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[i,o]=m.useState(e);m.useEffect(()=>{o(e)},[e]);const s=(d,f)=>{const h={...i,[d]:f};o(h),r(h)},a=()=>{const d=[...i.conditions||[],{type:"retry_count",operator:"lt",value:2}];s("conditions",d)},c=(d,f,h)=>{const p=[...i.conditions||[]];p[d]={...p[d],[f]:h},s("conditions",p)},u=d=>{const f=(i.conditions||[]).filter((h,p)=>p!==d);s("conditions",f)};return i?l.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),l.jsx("button",{onClick:()=>n(i.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{style:oi,children:"Edge ID"}),l.jsx("input",{type:"text",value:i.edge_id||"",onChange:d=>s("edge_id",d.target.value),style:Qr})]}),l.jsxs("div",{children:[l.jsx("label",{style:oi,children:"From Node"}),l.jsx("select",{value:i.from_node_id||"",onChange:d=>s("from_node_id",d.target.value),style:Qr,children:t.map(d=>l.jsx("option",{value:d,children:d},d))})]}),l.jsxs("div",{children:[l.jsx("label",{style:oi,children:"To Node"}),l.jsxs("select",{value:i.to_node_id||"",onChange:d=>s("to_node_id",d.target.value||null),style:Qr,children:[l.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(d=>l.jsx("option",{value:d,children:d},d))]})]}),l.jsxs("div",{children:[l.jsx("label",{style:oi,children:"Outcome"}),l.jsx("input",{type:"text",value:i.outcome||"",onChange:d=>s("outcome",d.target.value),placeholder:"success, failed, etc.",style:Qr})]}),l.jsxs("div",{children:[l.jsx("label",{style:oi,children:"Label"}),l.jsx("input",{type:"text",value:i.label||"",onChange:d=>s("label",d.target.value),placeholder:"Human-readable label",style:Qr})]}),l.jsxs("div",{children:[l.jsx("label",{style:oi,children:"Kind"}),l.jsx("select",{value:i.kind||"auto",onChange:d=>s("kind",d.target.value),style:Qr,children:DB.map(d=>l.jsx("option",{value:d,children:d},d))})]}),l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:i.non_advancing||!1,onChange:d=>s("non_advancing",d.target.checked)}),"Non-advancing"]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:oi,children:"Conditions"}),l.jsx("button",{onClick:a,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),l.jsx("div",{className:"space-y-2",children:(i.conditions||[]).map((d,f)=>l.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:l.jsxs("div",{className:"flex gap-1 items-center",children:[l.jsx("input",{type:"text",value:d.type||"",onChange:h=>c(f,"type",h.target.value),placeholder:"retry_count",style:{...Qr,flex:1,fontSize:10}}),l.jsx("select",{value:d.operator||"lt",onChange:h=>c(f,"operator",h.target.value),style:{...Qr,width:"auto",fontSize:10},children:LB.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx("input",{type:"text",value:d.value??"",onChange:h=>{const p=isNaN(h.target.value)?h.target.value:Number(h.target.value);c(f,"value",p)},placeholder:"value",style:{...Qr,width:50,fontSize:10}}),l.jsx("button",{onClick:()=>u(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const zB={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function qB({workspaceId:e,artifactId:t,onArtifactSave:r}){var O,q,B;const[n,i]=m.useState("canvas"),[o,s]=m.useState(null),[a,c]=m.useState(null),[u,d]=m.useState(""),[f,h]=m.useState(null),{workflowJson:p,loading:y,error:g,saving:w,lastSaveResult:v,updateWorkflow:x}=A4(e,t,{onSave:$=>{r==null||r(t,$)}}),{templates:b}=E4(),{schemas:_}=R4(),{fragmentsByKind:j}=T4(),k=m.useMemo(()=>{var $;return!o||!p?null:(($=p.nodes)==null?void 0:$.find(V=>V.node_id===o))||null},[o,p]),N=m.useMemo(()=>{var $;return!a||!p?null:(($=p.edges)==null?void 0:$.find(V=>V.edge_id===a))||null},[a,p]),E=m.useMemo(()=>p!=null&&p.nodes?p.nodes.map($=>$.node_id):[],[p]),C=m.useCallback($=>{x($)},[x]),T=m.useCallback($=>{if(!p)return;const V=p.nodes.map(te=>te.node_id===o?$:te);let X=p.edges,ne=p.entry_node_ids||[];$.node_id!==o&&(X=p.edges.map(te=>({...te,from_node_id:te.from_node_id===o?$.node_id:te.from_node_id,to_node_id:te.to_node_id===o?$.node_id:te.to_node_id})),ne=ne.map(te=>te===o?$.node_id:te),s($.node_id)),x({...p,nodes:V,edges:X,entry_node_ids:ne})},[p,o,x]),R=m.useCallback($=>{if(!p)return;const V=p.edges.map(X=>X.edge_id===a?$:X);$.edge_id!==a&&c($.edge_id),x({...p,edges:V})},[p,a,x]),P=m.useCallback($=>{p&&(x({...p,nodes:p.nodes.filter(V=>V.node_id!==$),edges:p.edges.filter(V=>V.from_node_id!==$&&V.to_node_id!==$),entry_node_ids:(p.entry_node_ids||[]).filter(V=>V!==$)}),s(null))},[p,x]),F=m.useCallback($=>{p&&(x({...p,edges:p.edges.filter(V=>V.edge_id!==$)}),c(null))},[p,x]),S=m.useCallback($=>{s($),$&&c(null)},[]),A=m.useCallback($=>{c($),$&&s(null)},[]),M=m.useCallback($=>{$==="json"&&p&&(d(JSON.stringify(p,null,2)),h(null)),i($)},[p]),z=m.useCallback($=>{const V=$.target.value;d(V);try{const X=JSON.parse(V);h(null),x(X)}catch(X){h(X.message)}},[x]),D=((O=v==null?void 0:v.tier1_report)==null?void 0:O.results)||[],I=D.filter($=>$.severity==="error").length,L=D.filter($=>$.severity==="warning").length;return l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[w&&l.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&l.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),!w&&!g&&p&&l.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((q=p.nodes)==null?void 0:q.length)||0," nodes, ",((B=p.edges)==null?void 0:B.length)||0," edges"]})]})}),l.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map($=>l.jsx("button",{onClick:()=>M($.id),style:{...zB,color:n===$.id?"var(--text-primary)":"var(--text-muted)",borderBottom:n===$.id?"2px solid var(--action-primary)":"2px solid transparent"},children:$.label},$.id))}),y?l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):l.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[n==="canvas"&&l.jsxs(l.Fragment,{children:[l.jsx(Hc,{children:l.jsx(NB,{workflowJson:p,onWorkflowChange:C,selectedNodeId:o,selectedEdgeId:a,onNodeSelect:S,onEdgeSelect:A})}),k&&l.jsx(OB,{node:k,onChange:T,onDelete:P,templates:b,schemas:_,roleFragments:j.role||[],taskFragments:j.task||[],pgcFragments:j.pgc||[]}),N&&l.jsx(FB,{edge:N,nodeIds:E,onChange:R,onDelete:F})]}),n==="json"&&l.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[l.jsx("textarea",{value:u,onChange:z,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:f?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),f&&l.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",f]})]}),n==="metadata"&&l.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:p?l.jsx($B,{workflow:p}):l.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),D.length>0&&l.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[I>0&&l.jsxs("span",{style:{color:"#ef4444"},children:[I," error",I!==1?"s":""]}),L>0&&l.jsxs("span",{style:{color:"#f59e0b"},children:[L," warning",L!==1?"s":""]}),I===0&&L===0&&l.jsx("span",{style:{color:"#10b981"},children:"Valid"}),l.jsx("span",{style:{color:"var(--text-muted)"},children:D.map($=>$.message).join(" | ")})]})]})}function $B({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],i=e.thread_ownership||{},o=Object.entries(i),s=e.entry_node_ids||[];return l.jsxs("div",{className:"space-y-4 max-w-lg",children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(a=>l.jsxs("div",{children:[l.jsx("label",{style:r,children:a.label}),l.jsx("div",{style:t,children:e[a.key]||"-"})]},a.key)),l.jsxs("div",{children:[l.jsx("label",{style:r,children:"Entry Node IDs"}),l.jsx("div",{style:t,children:s.length>0?s.join(", "):"-"})]}),o.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),o.map(([a,c])=>l.jsxs("div",{children:[l.jsx("label",{style:r,children:a}),l.jsx("div",{style:t,children:c})]},a))]})]})}function rg({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:i}){const[o,s]=m.useState(!1),a=m.useRef(null);return m.useEffect(()=>{if(!o)return;const c=u=>{a.current&&!a.current.contains(u.target)&&s(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[o]),t.length===0?null:l.jsxs("div",{ref:a,style:{position:"relative"},children:[l.jsxs("button",{onClick:()=>s(!o),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:i?"var(--text-primary)":"var(--text-muted)",background:i?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:i?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,l.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),o&&l.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>l.jsxs("button",{onClick:()=>{n(c.id),s(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&l.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function ng({label:e,isSelected:t,onClick:r}){return l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function BB({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:i=[],onArtifactSave:o,onCreateDcwWorkflow:s,initialTab:a=null,docTypeSource:c=null}){var Le,Oe,Ge;const[u,d]=m.useState(a||"task_prompt");m.useEffect(()=>{a&&d(a)},[a]);const[f,h]=m.useState("source"),[p,y]=m.useState(null),[g,w]=m.useState(!1),[v,x]=m.useState(null),[b,_]=m.useState(null),[j,k]=m.useState(!1),[N,E]=m.useState(null),[C,T]=m.useState(null),[R,P]=m.useState(!1),[F,S]=m.useState(null),[A,M]=m.useState(null),[z,D]=m.useState(!1),[I,L]=m.useState(null),O=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const G=t.role_prompt_ref.split(":");return G.length!==4||G[0]!=="prompt"||G[1]!=="role"?null:{roleId:G[2],version:G[3]}},[t==null?void 0:t.role_prompt_ref]),q=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const G=t.template_ref.split(":");return G.length!==4||G[0]!=="prompt"||G[1]!=="template"?null:{templateId:G[2],version:G[3]}},[t==null?void 0:t.template_ref]),B=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const G=t.qa_template_ref.split(":");return G.length!==4||G[0]!=="prompt"||G[1]!=="template"?null:{templateId:G[2],version:G[3]}},[t==null?void 0:t.qa_template_ref]),$=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const G=t.pgc_template_ref.split(":");return G.length!==4||G[0]!=="prompt"||G[1]!=="template"?null:{templateId:G[2],version:G[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!O){y(null);return}w(!0),x(null),ye.getRole(O.roleId,O.version).then(G=>{y(G.content)}).catch(G=>{console.error("Failed to load role:",G),x(G.message)}).finally(()=>{w(!1)})},[O]),m.useEffect(()=>{if(!q){_(null);return}k(!0),E(null),ye.getTemplate(q.templateId,q.version).then(G=>{_(G.content)}).catch(G=>{console.error("Failed to load template:",G),E(G.message)}).finally(()=>{k(!1)})},[q]),m.useEffect(()=>{if(!B){T(null);return}P(!0),S(null),ye.getTemplate(B.templateId,B.version).then(G=>{T(G.content)}).catch(G=>{console.error("Failed to load QA template:",G),S(G.message)}).finally(()=>{P(!1)})},[B]),m.useEffect(()=>{if(!$){M(null);return}D(!0),L(null),ye.getTemplate($.templateId,$.version).then(G=>{M(G.content)}).catch(G=>{console.error("Failed to load PGC template:",G),L(G.message)}).finally(()=>{D(!1)})},[$]);const V=m.useMemo(()=>{if(!t||u==="role_prompt")return null;const G=t.version||t.active_version;return`doctype:${t.doc_type_id}:${G}:${u}`},[t,u]),{content:X,loading:ne,error:te,saving:ae,isDirty:Q,updateContent:we,lastSaveResult:se}=cu(e,V,{onSave:G=>{o==null||o(V,G)}}),Te=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],ue=m.useMemo(()=>t?Te.filter(G=>G.id==="package"?!0:G.id==="role_prompt"?!!t.role_prompt_ref:G.id==="template"?!!t.template_ref:G.id==="qa_template"?!!t.qa_template_ref:G.id==="pgc_template"?!!t.pgc_template_ref:G.id==="workflow"?!0:t.artifacts?t.artifacts[G.id]!=null:!1):[],[t]),Z=c==="task"||c==="schema";m.useEffect(()=>{Z||ue.length>0&&!ue.find(G=>G.id===u)&&d(ue[0].id)},[ue,u,Z]);const xe=u==="role_prompt"||u==="template"||u==="qa_template"||u==="pgc_template",U=u==="package",Y=u==="schema",ce=u==="workflow",pe=!xe&&!U&&!Y&&!ce,ke=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:i.some(G=>G.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,i]),[ge,de]=m.useState(!1),_e=async()=>{if(!(!(t!=null&&t.doc_type_id)||!s)){de(!0);try{await s(t.doc_type_id)}finally{de(!1)}}};if(!t&&!r)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),l.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),l.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const Ve=c==="task"?"Interaction":c==="schema"?"Schema":null,Ce=!Z&&(u==="task_prompt"||u==="schema");return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),l.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:Z?Ve:l.jsxs(l.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),Z&&l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!Z&&l.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[ue.find(G=>G.id==="package")&&l.jsx(ng,{label:"Package",isSelected:u==="package",onClick:()=>{d("package"),h("source")}}),ue.find(G=>G.id==="workflow")&&l.jsx(ng,{label:"Workflow",isSelected:u==="workflow",onClick:()=>{d("workflow"),h("source")}}),(()=>{const G=["role_prompt","task_prompt","template"],he=ue.filter(le=>G.includes(le.id)).map(le=>({id:le.id,label:le.id==="role_prompt"?"Role":le.id==="task_prompt"?"Task":"Template",viewOnly:le.viewOnly}));return he.length===0?null:l.jsx(rg,{label:"Generation",items:he,selectedId:G.includes(u)?u:null,onSelect:le=>{d(le),h("source")},isGroupActive:G.includes(u)})})(),(()=>{const G=["qa_prompt","qa_template"],he=ue.filter(le=>G.includes(le.id)).map(le=>({id:le.id,label:le.id==="qa_prompt"?"Prompt":"Template",viewOnly:le.viewOnly}));return he.length===0?null:l.jsx(rg,{label:"QA",items:he,selectedId:G.includes(u)?u:null,onSelect:le=>{d(le),h("source")},isGroupActive:G.includes(u)})})(),(()=>{const G=["pgc_context","pgc_template"],he=ue.filter(le=>G.includes(le.id)).map(le=>({id:le.id,label:le.id==="pgc_context"?"Context":"Template",viewOnly:le.viewOnly}));return he.length===0?null:l.jsx(rg,{label:"PGC",items:he,selectedId:G.includes(u)?u:null,onSelect:le=>{d(le),h("source")},isGroupActive:G.includes(u)})})(),ue.find(G=>G.id==="schema")&&l.jsx(ng,{label:"Schema",isSelected:u==="schema",onClick:()=>{d("schema"),h("source")}})]}),!Z&&pe&&!Ce&&l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>h("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:f==="source"?"var(--action-primary)":"transparent",color:f==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),l.jsx("button",{onClick:()=>h("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:f==="resolved"?"var(--action-primary)":"transparent",color:f==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),f==="source"&&((Le=t==null?void 0:t.artifacts)==null?void 0:Le[u])&&l.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[u]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[u]]})]}),xe&&l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:u==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),u==="role_prompt"&&O&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[O.roleId.replace(/_/g," ")," v",O.version]}),u==="template"&&q&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[q.templateId.replace(/_/g," ")," v",q.version]}),u==="qa_template"&&B&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[B.templateId.replace(/_/g," ")," v",B.version]}),u==="pgc_template"&&$&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[$.templateId.replace(/_/g," ")," v",$.version]})]}),Ce&&l.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:u==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),Y&&((Oe=t==null?void 0:t.artifacts)==null?void 0:Oe.schema)&&l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),l.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:ce?ke?l.jsx(qB,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:o}):l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8 max-w-md",children:[l.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),l.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),s&&l.jsx("button",{onClick:_e,disabled:ge,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:ge?"wait":"pointer",opacity:ge?.7:1},children:ge?"Creating...":"Create Workflow"})]})}):u==="package"?l.jsx(vB,{workspaceId:e,docType:t,roles:n,onSave:o}):u==="role_prompt"?l.jsx(In,{content:p||"",onChange:()=>{},loading:g,saving:!1,isDirty:!1,error:v,readOnly:!0,placeholder:"No role prompt configured for this document type"}):u==="template"?l.jsx(In,{content:b||"",onChange:()=>{},loading:j,saving:!1,isDirty:!1,error:N,readOnly:!0,placeholder:"No template configured for this document type"}):u==="qa_template"?l.jsx(In,{content:C||"",onChange:()=>{},loading:R,saving:!1,isDirty:!1,error:F,readOnly:!0,placeholder:"No QA template configured for this document type"}):u==="pgc_template"?l.jsx(In,{content:A||"",onChange:()=>{},loading:z,saving:!1,isDirty:!1,error:I,readOnly:!0,placeholder:"No PGC template configured for this document type"}):f==="source"||Y?l.jsx(In,{content:X,onChange:Ce?()=>{}:we,loading:ne,saving:Ce?!1:ae,isDirty:Ce?!1:Q,error:te,readOnly:Ce,placeholder:`Enter ${((Ge=ue.find(G=>G.id===u))==null?void 0:Ge.label)||"prompt"} content...`,isJson:Y}):l.jsx(gB,{workspaceId:e,artifactId:V})}),pe&&(se==null?void 0:se.tier1)&&!se.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function HB({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:i,loading:o,error:s,saving:a,isDirty:c,updateContent:u,lastSaveResult:d}=cu(e,n,{onSave:h=>{r==null||r(n,h)}});if(!t)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),l.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase());return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),l.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(In,{content:i,onChange:u,loading:o,saving:a,isDirty:c,error:s,placeholder:"Enter role prompt content..."})}),(d==null?void 0:d.tier1)&&!d.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function I4(e){return typeof e>"u"||e===null}function WB(e){return typeof e=="object"&&e!==null}function UB(e){return Array.isArray(e)?e:I4(e)?[]:[e]}function VB(e,t){var r,n,i,o;if(t)for(o=Object.keys(t),r=0,n=o.length;r<n;r+=1)i=o[r],e[i]=t[i];return e}function GB(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function YB(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var KB=I4,XB=WB,QB=UB,ZB=GB,JB=YB,e9=VB,ut={isNothing:KB,isObject:XB,toArray:QB,repeat:ZB,isNegativeZero:JB,extend:e9};function M4(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function ta(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=M4(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ta.prototype=Object.create(Error.prototype);ta.prototype.constructor=ta;ta.prototype.toString=function(t){return this.name+": "+M4(this,t)};var It=ta;function ig(e,t,r,n,i){var o="",s="",a=Math.floor(i/2)-1;return n-t>a&&(o=" ... ",t=n-a+o.length),r-n>a&&(s=" ...",r=n+a-s.length),{str:o+e.slice(t,r).replace(/\t/g,"")+s,pos:n-t+o.length}}function og(e,t){return ut.repeat(" ",t-e.length)+e}function t9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],o,s=-1;o=r.exec(e.buffer);)i.push(o.index),n.push(o.index+o[0].length),e.position<=o.index&&s<0&&(s=n.length-2);s<0&&(s=n.length-1);var a="",c,u,d=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+d+3);for(c=1;c<=t.linesBefore&&!(s-c<0);c++)u=ig(e.buffer,n[s-c],i[s-c],e.position-(n[s]-n[s-c]),f),a=ut.repeat(" ",t.indent)+og((e.line-c+1).toString(),d)+" | "+u.str+`
`+a;for(u=ig(e.buffer,n[s],i[s],e.position,f),a+=ut.repeat(" ",t.indent)+og((e.line+1).toString(),d)+" | "+u.str+`
`,a+=ut.repeat("-",t.indent+d+3+u.pos)+`^
`,c=1;c<=t.linesAfter&&!(s+c>=i.length);c++)u=ig(e.buffer,n[s+c],i[s+c],e.position-(n[s]-n[s+c]),f),a+=ut.repeat(" ",t.indent)+og((e.line+c+1).toString(),d)+" | "+u.str+`
`;return a.replace(/\n$/,"")}var r9=t9,n9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],i9=["scalar","sequence","mapping"];function o9(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function s9(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(n9.indexOf(r)===-1)throw new It('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=o9(t.styleAliases||null),i9.indexOf(this.kind)===-1)throw new It('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var _t=s9;function VS(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(o,s){o.tag===n.tag&&o.kind===n.kind&&o.multi===n.multi&&(i=s)}),r[i]=n}),r}function a9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Cv(e){return this.extend(e)}Cv.prototype.extend=function(t){var r=[],n=[];if(t instanceof _t)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new It("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(o){if(!(o instanceof _t))throw new It("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&o.loadKind!=="scalar")throw new It("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new It("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(o){if(!(o instanceof _t))throw new It("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Cv.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=VS(i,"implicit"),i.compiledExplicit=VS(i,"explicit"),i.compiledTypeMap=a9(i.compiledImplicit,i.compiledExplicit),i};var P4=Cv,O4=new _t("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),D4=new _t("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),L4=new _t("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),F4=new P4({explicit:[O4,D4,L4]});function l9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function c9(){return null}function u9(e){return e===null}var z4=new _t("tag:yaml.org,2002:null",{kind:"scalar",resolve:l9,construct:c9,predicate:u9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function d9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function f9(e){return e==="true"||e==="True"||e==="TRUE"}function p9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var q4=new _t("tag:yaml.org,2002:bool",{kind:"scalar",resolve:d9,construct:f9,predicate:p9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function h9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function m9(e){return 48<=e&&e<=55}function g9(e){return 48<=e&&e<=57}function v9(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!h9(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!m9(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!g9(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function x9(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function y9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!ut.isNegativeZero(e)}var $4=new _t("tag:yaml.org,2002:int",{kind:"scalar",resolve:v9,construct:x9,predicate:y9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),b9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function w9(e){return!(e===null||!b9.test(e)||e[e.length-1]==="_")}function _9(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var S9=/^[-+]?[0-9]+e/;function k9(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(ut.isNegativeZero(e))return"-0.0";return r=e.toString(10),S9.test(r)?r.replace("e",".e"):r}function j9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||ut.isNegativeZero(e))}var B4=new _t("tag:yaml.org,2002:float",{kind:"scalar",resolve:w9,construct:_9,predicate:j9,represent:k9,defaultStyle:"lowercase"}),H4=F4.extend({implicit:[z4,q4,$4,B4]}),W4=H4,U4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),V4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function C9(e){return e===null?!1:U4.exec(e)!==null||V4.exec(e)!==null}function N9(e){var t,r,n,i,o,s,a,c=0,u=null,d,f,h;if(t=U4.exec(e),t===null&&(t=V4.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(o=+t[4],s=+t[5],a=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(d=+t[10],f=+(t[11]||0),u=(d*60+f)*6e4,t[9]==="-"&&(u=-u)),h=new Date(Date.UTC(r,n,i,o,s,a,c)),u&&h.setTime(h.getTime()-u),h}function E9(e){return e.toISOString()}var G4=new _t("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:C9,construct:N9,instanceOf:Date,represent:E9});function R9(e){return e==="<<"||e===null}var Y4=new _t("tag:yaml.org,2002:merge",{kind:"scalar",resolve:R9}),my=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function T9(e){if(e===null)return!1;var t,r,n=0,i=e.length,o=my;for(r=0;r<i;r++)if(t=o.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function A9(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,o=my,s=0,a=[];for(t=0;t<i;t++)t%4===0&&t&&(a.push(s>>16&255),a.push(s>>8&255),a.push(s&255)),s=s<<6|o.indexOf(n.charAt(t));return r=i%4*6,r===0?(a.push(s>>16&255),a.push(s>>8&255),a.push(s&255)):r===18?(a.push(s>>10&255),a.push(s>>2&255)):r===12&&a.push(s>>4&255),new Uint8Array(a)}function I9(e){var t="",r=0,n,i,o=e.length,s=my;for(n=0;n<o;n++)n%3===0&&n&&(t+=s[r>>18&63],t+=s[r>>12&63],t+=s[r>>6&63],t+=s[r&63]),r=(r<<8)+e[n];return i=o%3,i===0?(t+=s[r>>18&63],t+=s[r>>12&63],t+=s[r>>6&63],t+=s[r&63]):i===2?(t+=s[r>>10&63],t+=s[r>>4&63],t+=s[r<<2&63],t+=s[64]):i===1&&(t+=s[r>>2&63],t+=s[r<<4&63],t+=s[64],t+=s[64]),t}function M9(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var K4=new _t("tag:yaml.org,2002:binary",{kind:"scalar",resolve:T9,construct:A9,predicate:M9,represent:I9}),P9=Object.prototype.hasOwnProperty,O9=Object.prototype.toString;function D9(e){if(e===null)return!0;var t=[],r,n,i,o,s,a=e;for(r=0,n=a.length;r<n;r+=1){if(i=a[r],s=!1,O9.call(i)!=="[object Object]")return!1;for(o in i)if(P9.call(i,o))if(!s)s=!0;else return!1;if(!s)return!1;if(t.indexOf(o)===-1)t.push(o);else return!1}return!0}function L9(e){return e!==null?e:[]}var X4=new _t("tag:yaml.org,2002:omap",{kind:"sequence",resolve:D9,construct:L9}),F9=Object.prototype.toString;function z9(e){if(e===null)return!0;var t,r,n,i,o,s=e;for(o=new Array(s.length),t=0,r=s.length;t<r;t+=1){if(n=s[t],F9.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;o[t]=[i[0],n[i[0]]]}return!0}function q9(e){if(e===null)return[];var t,r,n,i,o,s=e;for(o=new Array(s.length),t=0,r=s.length;t<r;t+=1)n=s[t],i=Object.keys(n),o[t]=[i[0],n[i[0]]];return o}var Q4=new _t("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:z9,construct:q9}),$9=Object.prototype.hasOwnProperty;function B9(e){if(e===null)return!0;var t,r=e;for(t in r)if($9.call(r,t)&&r[t]!==null)return!1;return!0}function H9(e){return e!==null?e:{}}var Z4=new _t("tag:yaml.org,2002:set",{kind:"mapping",resolve:B9,construct:H9}),gy=W4.extend({implicit:[G4,Y4],explicit:[K4,X4,Q4,Z4]}),Xn=Object.prototype.hasOwnProperty,lc=1,J4=2,eR=3,cc=4,sg=1,W9=2,GS=3,U9=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,V9=/[\x85\u2028\u2029]/,G9=/[,\[\]\{\}]/,tR=/^(?:!|!!|![a-z\-]+!)$/i,rR=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function YS(e){return Object.prototype.toString.call(e)}function Hr(e){return e===10||e===13}function yi(e){return e===9||e===32}function $t(e){return e===9||e===32||e===10||e===13}function ro(e){return e===44||e===91||e===93||e===123||e===125}function Y9(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function K9(e){return e===120?2:e===117?4:e===85?8:0}function X9(e){return 48<=e&&e<=57?e-48:-1}function KS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function Q9(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function nR(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var iR=new Array(256),oR=new Array(256);for(var qi=0;qi<256;qi++)iR[qi]=KS(qi)?1:0,oR[qi]=KS(qi);function Z9(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||gy,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function sR(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=r9(r),new It(t,r)}function oe(e,t){throw sR(e,t)}function uc(e,t){e.onWarning&&e.onWarning.call(null,sR(e,t))}var XS={YAML:function(t,r,n){var i,o,s;t.version!==null&&oe(t,"duplication of %YAML directive"),n.length!==1&&oe(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&oe(t,"ill-formed argument of the YAML directive"),o=parseInt(i[1],10),s=parseInt(i[2],10),o!==1&&oe(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=s<2,s!==1&&s!==2&&uc(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,o;n.length!==2&&oe(t,"TAG directive accepts exactly two arguments"),i=n[0],o=n[1],tR.test(i)||oe(t,"ill-formed tag handle (first argument) of the TAG directive"),Xn.call(t.tagMap,i)&&oe(t,'there is a previously declared suffix for "'+i+'" tag handle'),rR.test(o)||oe(t,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{oe(t,"tag prefix is malformed: "+o)}t.tagMap[i]=o}};function Vn(e,t,r,n){var i,o,s,a;if(t<r){if(a=e.input.slice(t,r),n)for(i=0,o=a.length;i<o;i+=1)s=a.charCodeAt(i),s===9||32<=s&&s<=1114111||oe(e,"expected valid JSON character");else U9.test(a)&&oe(e,"the stream contains non-printable characters");e.result+=a}}function QS(e,t,r,n){var i,o,s,a;for(ut.isObject(r)||oe(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),s=0,a=i.length;s<a;s+=1)o=i[s],Xn.call(t,o)||(nR(t,o,r[o]),n[o]=!0)}function no(e,t,r,n,i,o,s,a,c){var u,d;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),u=0,d=i.length;u<d;u+=1)Array.isArray(i[u])&&oe(e,"nested arrays are not supported inside keys"),typeof i=="object"&&YS(i[u])==="[object Object]"&&(i[u]="[object Object]");if(typeof i=="object"&&YS(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(o))for(u=0,d=o.length;u<d;u+=1)QS(e,t,o[u],r);else QS(e,t,o,r);else!e.json&&!Xn.call(r,i)&&Xn.call(t,i)&&(e.line=s||e.line,e.lineStart=a||e.lineStart,e.position=c||e.position,oe(e,"duplicated mapping key")),nR(t,i,o),delete r[i];return t}function vy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):oe(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ot(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;yi(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Hr(i))for(vy(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&uc(e,"deficient indentation"),n}function uu(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||$t(r)))}function xy(e,t){t===1?e.result+=" ":t>1&&(e.result+=ut.repeat(`
`,t-1))}function J9(e,t,r){var n,i,o,s,a,c,u,d,f=e.kind,h=e.result,p;if(p=e.input.charCodeAt(e.position),$t(p)||ro(p)||p===35||p===38||p===42||p===33||p===124||p===62||p===39||p===34||p===37||p===64||p===96||(p===63||p===45)&&(i=e.input.charCodeAt(e.position+1),$t(i)||r&&ro(i)))return!1;for(e.kind="scalar",e.result="",o=s=e.position,a=!1;p!==0;){if(p===58){if(i=e.input.charCodeAt(e.position+1),$t(i)||r&&ro(i))break}else if(p===35){if(n=e.input.charCodeAt(e.position-1),$t(n))break}else{if(e.position===e.lineStart&&uu(e)||r&&ro(p))break;if(Hr(p))if(c=e.line,u=e.lineStart,d=e.lineIndent,ot(e,!1,-1),e.lineIndent>=t){a=!0,p=e.input.charCodeAt(e.position);continue}else{e.position=s,e.line=c,e.lineStart=u,e.lineIndent=d;break}}a&&(Vn(e,o,s,!1),xy(e,e.line-c),o=s=e.position,a=!1),yi(p)||(s=e.position+1),p=e.input.charCodeAt(++e.position)}return Vn(e,o,s,!1),e.result?!0:(e.kind=f,e.result=h,!1)}function eH(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Vn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else Hr(r)?(Vn(e,n,i,!0),xy(e,ot(e,!1,t)),n=i=e.position):e.position===e.lineStart&&uu(e)?oe(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);oe(e,"unexpected end of the stream within a single quoted scalar")}function tH(e,t){var r,n,i,o,s,a;if(a=e.input.charCodeAt(e.position),a!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(a=e.input.charCodeAt(e.position))!==0;){if(a===34)return Vn(e,r,e.position,!0),e.position++,!0;if(a===92){if(Vn(e,r,e.position,!0),a=e.input.charCodeAt(++e.position),Hr(a))ot(e,!1,t);else if(a<256&&iR[a])e.result+=oR[a],e.position++;else if((s=K9(a))>0){for(i=s,o=0;i>0;i--)a=e.input.charCodeAt(++e.position),(s=Y9(a))>=0?o=(o<<4)+s:oe(e,"expected hexadecimal character");e.result+=Q9(o),e.position++}else oe(e,"unknown escape sequence");r=n=e.position}else Hr(a)?(Vn(e,r,n,!0),xy(e,ot(e,!1,t)),r=n=e.position):e.position===e.lineStart&&uu(e)?oe(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}oe(e,"unexpected end of the stream within a double quoted scalar")}function rH(e,t){var r=!0,n,i,o,s=e.tag,a,c=e.anchor,u,d,f,h,p,y=Object.create(null),g,w,v,x;if(x=e.input.charCodeAt(e.position),x===91)d=93,p=!1,a=[];else if(x===123)d=125,p=!0,a={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),x=e.input.charCodeAt(++e.position);x!==0;){if(ot(e,!0,t),x=e.input.charCodeAt(e.position),x===d)return e.position++,e.tag=s,e.anchor=c,e.kind=p?"mapping":"sequence",e.result=a,!0;r?x===44&&oe(e,"expected the node content, but found ','"):oe(e,"missed comma between flow collection entries"),w=g=v=null,f=h=!1,x===63&&(u=e.input.charCodeAt(e.position+1),$t(u)&&(f=h=!0,e.position++,ot(e,!0,t))),n=e.line,i=e.lineStart,o=e.position,Co(e,t,lc,!1,!0),w=e.tag,g=e.result,ot(e,!0,t),x=e.input.charCodeAt(e.position),(h||e.line===n)&&x===58&&(f=!0,x=e.input.charCodeAt(++e.position),ot(e,!0,t),Co(e,t,lc,!1,!0),v=e.result),p?no(e,a,y,w,g,v,n,i,o):f?a.push(no(e,null,y,w,g,v,n,i,o)):a.push(g),ot(e,!0,t),x=e.input.charCodeAt(e.position),x===44?(r=!0,x=e.input.charCodeAt(++e.position)):r=!1}oe(e,"unexpected end of the stream within a flow collection")}function nH(e,t){var r,n,i=sg,o=!1,s=!1,a=t,c=0,u=!1,d,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)sg===i?i=f===43?GS:W9:oe(e,"repeat of a chomping mode identifier");else if((d=X9(f))>=0)d===0?oe(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?oe(e,"repeat of an indentation width identifier"):(a=t+d-1,s=!0);else break;if(yi(f)){do f=e.input.charCodeAt(++e.position);while(yi(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Hr(f)&&f!==0)}for(;f!==0;){for(vy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!s||e.lineIndent<a)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!s&&e.lineIndent>a&&(a=e.lineIndent),Hr(f)){c++;continue}if(e.lineIndent<a){i===GS?e.result+=ut.repeat(`
`,o?1+c:c):i===sg&&o&&(e.result+=`
`);break}for(n?yi(f)?(u=!0,e.result+=ut.repeat(`
`,o?1+c:c)):u?(u=!1,e.result+=ut.repeat(`
`,c+1)):c===0?o&&(e.result+=" "):e.result+=ut.repeat(`
`,c):e.result+=ut.repeat(`
`,o?1+c:c),o=!0,s=!0,c=0,r=e.position;!Hr(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Vn(e,r,e.position,!1)}return!0}function ZS(e,t){var r,n=e.tag,i=e.anchor,o=[],s,a=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,oe(e,"tab characters must not be used in indentation")),!(c!==45||(s=e.input.charCodeAt(e.position+1),!$t(s))));){if(a=!0,e.position++,ot(e,!0,-1)&&e.lineIndent<=t){o.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Co(e,t,eR,!1,!0),o.push(e.result),ot(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)oe(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return a?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=o,!0):!1}function iH(e,t,r){var n,i,o,s,a,c,u=e.tag,d=e.anchor,f={},h=Object.create(null),p=null,y=null,g=null,w=!1,v=!1,x;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),x=e.input.charCodeAt(e.position);x!==0;){if(!w&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,oe(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),o=e.line,(x===63||x===58)&&$t(n))x===63?(w&&(no(e,f,h,p,y,null,s,a,c),p=y=g=null),v=!0,w=!0,i=!0):w?(w=!1,i=!0):oe(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,x=n;else{if(s=e.line,a=e.lineStart,c=e.position,!Co(e,r,J4,!1,!0))break;if(e.line===o){for(x=e.input.charCodeAt(e.position);yi(x);)x=e.input.charCodeAt(++e.position);if(x===58)x=e.input.charCodeAt(++e.position),$t(x)||oe(e,"a whitespace character is expected after the key-value separator within a block mapping"),w&&(no(e,f,h,p,y,null,s,a,c),p=y=g=null),v=!0,w=!1,i=!1,p=e.tag,y=e.result;else if(v)oe(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=u,e.anchor=d,!0}else if(v)oe(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=u,e.anchor=d,!0}if((e.line===o||e.lineIndent>t)&&(w&&(s=e.line,a=e.lineStart,c=e.position),Co(e,t,cc,!0,i)&&(w?y=e.result:g=e.result),w||(no(e,f,h,p,y,g,s,a,c),p=y=g=null),ot(e,!0,-1),x=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&x!==0)oe(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return w&&no(e,f,h,p,y,null,s,a,c),v&&(e.tag=u,e.anchor=d,e.kind="mapping",e.result=f),v}function oH(e){var t,r=!1,n=!1,i,o,s;if(s=e.input.charCodeAt(e.position),s!==33)return!1;if(e.tag!==null&&oe(e,"duplication of a tag property"),s=e.input.charCodeAt(++e.position),s===60?(r=!0,s=e.input.charCodeAt(++e.position)):s===33?(n=!0,i="!!",s=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do s=e.input.charCodeAt(++e.position);while(s!==0&&s!==62);e.position<e.length?(o=e.input.slice(t,e.position),s=e.input.charCodeAt(++e.position)):oe(e,"unexpected end of the stream within a verbatim tag")}else{for(;s!==0&&!$t(s);)s===33&&(n?oe(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),tR.test(i)||oe(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),s=e.input.charCodeAt(++e.position);o=e.input.slice(t,e.position),G9.test(o)&&oe(e,"tag suffix cannot contain flow indicator characters")}o&&!rR.test(o)&&oe(e,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{oe(e,"tag name is malformed: "+o)}return r?e.tag=o:Xn.call(e.tagMap,i)?e.tag=e.tagMap[i]+o:i==="!"?e.tag="!"+o:i==="!!"?e.tag="tag:yaml.org,2002:"+o:oe(e,'undeclared tag handle "'+i+'"'),!0}function sH(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&oe(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!$t(r)&&!ro(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&oe(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function aH(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!$t(n)&&!ro(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&oe(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Xn.call(e.anchorMap,r)||oe(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],ot(e,!0,-1),!0}function Co(e,t,r,n,i){var o,s,a,c=1,u=!1,d=!1,f,h,p,y,g,w;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=s=a=cc===r||eR===r,n&&ot(e,!0,-1)&&(u=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;oH(e)||sH(e);)ot(e,!0,-1)?(u=!0,a=o,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):a=!1;if(a&&(a=u||i),(c===1||cc===r)&&(lc===r||J4===r?g=t:g=t+1,w=e.position-e.lineStart,c===1?a&&(ZS(e,w)||iH(e,w,g))||rH(e,g)?d=!0:(s&&nH(e,g)||eH(e,g)||tH(e,g)?d=!0:aH(e)?(d=!0,(e.tag!==null||e.anchor!==null)&&oe(e,"alias node should not have any properties")):J9(e,g,lc===r)&&(d=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(d=a&&ZS(e,w))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&oe(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,h=e.implicitTypes.length;f<h;f+=1)if(y=e.implicitTypes[f],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xn.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,p=e.typeMap.multi[e.kind||"fallback"],f=0,h=p.length;f<h;f+=1)if(e.tag.slice(0,p[f].tag.length)===p[f].tag){y=p[f];break}y||oe(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&oe(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):oe(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||d}function lH(e){var t=e.position,r,n,i,o=!1,s;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(s=e.input.charCodeAt(e.position))!==0&&(ot(e,!0,-1),s=e.input.charCodeAt(e.position),!(e.lineIndent>0||s!==37));){for(o=!0,s=e.input.charCodeAt(++e.position),r=e.position;s!==0&&!$t(s);)s=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&oe(e,"directive name must not be less than one character in length");s!==0;){for(;yi(s);)s=e.input.charCodeAt(++e.position);if(s===35){do s=e.input.charCodeAt(++e.position);while(s!==0&&!Hr(s));break}if(Hr(s))break;for(r=e.position;s!==0&&!$t(s);)s=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}s!==0&&vy(e),Xn.call(XS,n)?XS[n](e,n,i):uc(e,'unknown document directive "'+n+'"')}if(ot(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,ot(e,!0,-1)):o&&oe(e,"directives end mark is expected"),Co(e,e.lineIndent-1,cc,!1,!0),ot(e,!0,-1),e.checkLineBreaks&&V9.test(e.input.slice(t,e.position))&&uc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&uu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,ot(e,!0,-1));return}if(e.position<e.length-1)oe(e,"end of the stream or a document separator is expected");else return}function aR(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new Z9(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,oe(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)lH(r);return r.documents}function cH(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=aR(e,r);if(typeof t!="function")return n;for(var i=0,o=n.length;i<o;i+=1)t(n[i])}function uH(e,t){var r=aR(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new It("expected a single document in the stream, but found more")}}var dH=cH,fH=uH,lR={loadAll:dH,load:fH},cR=Object.prototype.toString,uR=Object.prototype.hasOwnProperty,yy=65279,pH=9,ra=10,hH=13,mH=32,gH=33,vH=34,Nv=35,xH=37,yH=38,bH=39,wH=42,dR=44,_H=45,dc=58,SH=61,kH=62,jH=63,CH=64,fR=91,pR=93,NH=96,hR=123,EH=124,mR=125,Rt={};Rt[0]="\\0";Rt[7]="\\a";Rt[8]="\\b";Rt[9]="\\t";Rt[10]="\\n";Rt[11]="\\v";Rt[12]="\\f";Rt[13]="\\r";Rt[27]="\\e";Rt[34]='\\"';Rt[92]="\\\\";Rt[133]="\\N";Rt[160]="\\_";Rt[8232]="\\L";Rt[8233]="\\P";var RH=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],TH=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function AH(e,t){var r,n,i,o,s,a,c;if(t===null)return{};for(r={},n=Object.keys(t),i=0,o=n.length;i<o;i+=1)s=n[i],a=String(t[s]),s.slice(0,2)==="!!"&&(s="tag:yaml.org,2002:"+s.slice(2)),c=e.compiledTypeMap.fallback[s],c&&uR.call(c.styleAliases,a)&&(a=c.styleAliases[a]),r[s]=a;return r}function IH(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new It("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+ut.repeat("0",n-t.length)+t}var MH=1,na=2;function PH(e){this.schema=e.schema||gy,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=ut.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=AH(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?na:MH,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function JS(e,t){for(var r=ut.repeat(" ",t),n=0,i=-1,o="",s,a=e.length;n<a;)i=e.indexOf(`
`,n),i===-1?(s=e.slice(n),n=a):(s=e.slice(n,i+1),n=i+1),s.length&&s!==`
`&&(o+=r),o+=s;return o}function Ev(e,t){return`
`+ut.repeat(" ",e.indent*t)}function OH(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function fc(e){return e===mH||e===pH}function ia(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==yy||65536<=e&&e<=1114111}function ek(e){return ia(e)&&e!==yy&&e!==hH&&e!==ra}function tk(e,t,r){var n=ek(e),i=n&&!fc(e);return(r?n:n&&e!==dR&&e!==fR&&e!==pR&&e!==hR&&e!==mR)&&e!==Nv&&!(t===dc&&!i)||ek(t)&&!fc(t)&&e===Nv||t===dc&&i}function DH(e){return ia(e)&&e!==yy&&!fc(e)&&e!==_H&&e!==jH&&e!==dc&&e!==dR&&e!==fR&&e!==pR&&e!==hR&&e!==mR&&e!==Nv&&e!==yH&&e!==wH&&e!==gH&&e!==EH&&e!==SH&&e!==kH&&e!==bH&&e!==vH&&e!==xH&&e!==CH&&e!==NH}function LH(e){return!fc(e)&&e!==dc}function gs(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function gR(e){var t=/^\n* /;return t.test(e)}var vR=1,Rv=2,xR=3,yR=4,$i=5;function FH(e,t,r,n,i,o,s,a){var c,u=0,d=null,f=!1,h=!1,p=n!==-1,y=-1,g=DH(gs(e,0))&&LH(gs(e,e.length-1));if(t||s)for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=gs(e,c),!ia(u))return $i;g=g&&tk(u,d,a),d=u}else{for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=gs(e,c),u===ra)f=!0,p&&(h=h||c-y-1>n&&e[y+1]!==" ",y=c);else if(!ia(u))return $i;g=g&&tk(u,d,a),d=u}h=h||p&&c-y-1>n&&e[y+1]!==" "}return!f&&!h?g&&!s&&!i(e)?vR:o===na?$i:Rv:r>9&&gR(e)?$i:s?o===na?$i:Rv:h?yR:xR}function zH(e,t,r,n,i){e.dump=function(){if(t.length===0)return e.quotingType===na?'""':"''";if(!e.noCompatMode&&(RH.indexOf(t)!==-1||TH.test(t)))return e.quotingType===na?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,r),s=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),a=n||e.flowLevel>-1&&r>=e.flowLevel;function c(u){return OH(e,u)}switch(FH(t,a,e.indent,s,c,e.quotingType,e.forceQuotes&&!n,i)){case vR:return t;case Rv:return"'"+t.replace(/'/g,"''")+"'";case xR:return"|"+rk(t,e.indent)+nk(JS(t,o));case yR:return">"+rk(t,e.indent)+nk(JS(qH(t,s),o));case $i:return'"'+$H(t)+'"';default:throw new It("impossible error: invalid scalar style")}}()}function rk(e,t){var r=gR(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),o=i?"+":n?"":"-";return r+o+`
`}function nk(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function qH(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var u=e.indexOf(`
`);return u=u!==-1?u:e.length,r.lastIndex=u,ik(e.slice(0,u),t)}(),i=e[0]===`
`||e[0]===" ",o,s;s=r.exec(e);){var a=s[1],c=s[2];o=c[0]===" ",n+=a+(!i&&!o&&c!==""?`
`:"")+ik(c,t),i=o}return n}function ik(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,o,s=0,a=0,c="";n=r.exec(e);)a=n.index,a-i>t&&(o=s>i?s:a,c+=`
`+e.slice(i,o),i=o+1),s=a;return c+=`
`,e.length-i>t&&s>i?c+=e.slice(i,s)+`
`+e.slice(s+1):c+=e.slice(i),c.slice(1)}function $H(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=gs(e,i),n=Rt[r],!n&&ia(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||IH(r);return t}function BH(e,t,r){var n="",i=e.tag,o,s,a;for(o=0,s=r.length;o<s;o+=1)a=r[o],e.replacer&&(a=e.replacer.call(r,String(o),a)),(mn(e,t,a,!1,!1)||typeof a>"u"&&mn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function ok(e,t,r,n){var i="",o=e.tag,s,a,c;for(s=0,a=r.length;s<a;s+=1)c=r[s],e.replacer&&(c=e.replacer.call(r,String(s),c)),(mn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&mn(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Ev(e,t)),e.dump&&ra===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=o,e.dump=i||"[]"}function HH(e,t,r){var n="",i=e.tag,o=Object.keys(r),s,a,c,u,d;for(s=0,a=o.length;s<a;s+=1)d="",n!==""&&(d+=", "),e.condenseFlow&&(d+='"'),c=o[s],u=r[c],e.replacer&&(u=e.replacer.call(r,c,u)),mn(e,t,c,!1,!1)&&(e.dump.length>1024&&(d+="? "),d+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),mn(e,t,u,!1,!1)&&(d+=e.dump,n+=d));e.tag=i,e.dump="{"+n+"}"}function WH(e,t,r,n){var i="",o=e.tag,s=Object.keys(r),a,c,u,d,f,h;if(e.sortKeys===!0)s.sort();else if(typeof e.sortKeys=="function")s.sort(e.sortKeys);else if(e.sortKeys)throw new It("sortKeys must be a boolean or a function");for(a=0,c=s.length;a<c;a+=1)h="",(!n||i!=="")&&(h+=Ev(e,t)),u=s[a],d=r[u],e.replacer&&(d=e.replacer.call(r,u,d)),mn(e,t+1,u,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&ra===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,f&&(h+=Ev(e,t)),mn(e,t+1,d,!0,f)&&(e.dump&&ra===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,i+=h));e.tag=o,e.dump=i||"{}"}function sk(e,t,r){var n,i,o,s,a,c;for(i=r?e.explicitTypes:e.implicitTypes,o=0,s=i.length;o<s;o+=1)if(a=i[o],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof t=="object"&&t instanceof a.instanceOf)&&(!a.predicate||a.predicate(t))){if(r?a.multi&&a.representName?e.tag=a.representName(t):e.tag=a.tag:e.tag="?",a.represent){if(c=e.styleMap[a.tag]||a.defaultStyle,cR.call(a.represent)==="[object Function]")n=a.represent(t,c);else if(uR.call(a.represent,c))n=a.represent[c](t,c);else throw new It("!<"+a.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function mn(e,t,r,n,i,o,s){e.tag=null,e.dump=r,sk(e,r,!1)||sk(e,r,!0);var a=cR.call(e.dump),c=n,u;n&&(n=e.flowLevel<0||e.flowLevel>t);var d=a==="[object Object]"||a==="[object Array]",f,h;if(d&&(f=e.duplicates.indexOf(r),h=f!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(i=!1),h&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(d&&h&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),a==="[object Object]")n&&Object.keys(e.dump).length!==0?(WH(e,t,e.dump,i),h&&(e.dump="&ref_"+f+e.dump)):(HH(e,t,e.dump),h&&(e.dump="&ref_"+f+" "+e.dump));else if(a==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!s&&t>0?ok(e,t-1,e.dump,i):ok(e,t,e.dump,i),h&&(e.dump="&ref_"+f+e.dump)):(BH(e,t,e.dump),h&&(e.dump="&ref_"+f+" "+e.dump));else if(a==="[object String]")e.tag!=="?"&&zH(e,e.dump,t,o,c);else{if(a==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new It("unacceptable kind of an object to dump "+a)}e.tag!==null&&e.tag!=="?"&&(u=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",e.dump=u+" "+e.dump)}return!0}function UH(e,t){var r=[],n=[],i,o;for(Tv(e,r,n),i=0,o=n.length;i<o;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(o)}function Tv(e,t,r){var n,i,o;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,o=e.length;i<o;i+=1)Tv(e[i],t,r);else for(n=Object.keys(e),i=0,o=n.length;i<o;i+=1)Tv(e[n[i]],t,r)}function VH(e,t){t=t||{};var r=new PH(t);r.noRefs||UH(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),mn(r,0,n,!0,!0)?r.dump+`
`:""}var GH=VH,YH={dump:GH};function by(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var KH=_t,XH=P4,QH=F4,ZH=H4,JH=W4,e7=gy,t7=lR.load,r7=lR.loadAll,n7=YH.dump,i7=It,o7={binary:K4,float:B4,map:L4,null:z4,pairs:Q4,set:Z4,timestamp:G4,bool:q4,int:$4,merge:Y4,omap:X4,seq:D4,str:O4},s7=by("safeLoad","load"),a7=by("safeLoadAll","loadAll"),l7=by("safeDump","dump"),bR={Type:KH,Schema:XH,FAILSAFE_SCHEMA:QH,JSON_SCHEMA:ZH,CORE_SCHEMA:JH,DEFAULT_SCHEMA:e7,load:t7,loadAll:r7,dump:n7,YAMLException:i7,types:o7,safeLoad:s7,safeLoadAll:a7,safeDump:l7};const c7=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],ag={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},lg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function u7({workspaceId:e,template:t,onArtifactSave:r}){const[n,i]=m.useState("metadata"),[o,s]=m.useState({name:"",purpose:"",use_case:""}),[a,c]=m.useState(!1),[u,d]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,h=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:p,loading:y,error:g,saving:w,isDirty:v,updateContent:x,lastSaveResult:b}=cu(e,f,{onSave:C=>{r==null||r(f,C)}});m.useEffect(()=>{t&&(s({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const _=m.useCallback((C,T)=>{s(R=>({...R,[C]:T})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!h)){d(!0);try{const C=bR.dump({name:o.name||null,purpose:o.purpose||null,use_case:o.use_case||null},{lineWidth:-1});await ye.writeArtifact(e,h,C),c(!1),r==null||r(h,{success:!0})}catch(C){console.error("Failed to save metadata:",C),alert(`Failed to save metadata: ${C.message}`)}finally{d(!1)}}},[e,h,o,r]),k=m.useCallback(()=>{a&&j()},[a,j]);if(!t)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),l.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const N=o.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,C=>C.toUpperCase()),E=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:N}),l.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[l.jsxs("span",{children:["v",t.active_version]}),l.jsx("span",{children:""}),l.jsx("span",{children:"Shared Template"}),o.purpose&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:o.purpose})]})]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:E.map(C=>l.jsxs("button",{onClick:()=>i(C.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===C.id?"var(--text-primary)":"var(--text-muted)",background:n===C.id?"var(--bg-canvas)":"transparent",borderBottom:n===C.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[C.label,C.id==="metadata"&&a&&l.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),C.id==="template"&&v&&l.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},C.id))}),n==="metadata"&&l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l.jsxs("div",{className:"max-w-xl space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{style:lg,children:"Template Name"}),l.jsx("input",{type:"text",value:o.name,onChange:C=>_("name",C.target.value),onBlur:k,placeholder:"e.g., Document Generator",style:ag}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),l.jsxs("div",{children:[l.jsx("label",{style:lg,children:"Template Purpose"}),l.jsx("select",{value:o.purpose,onChange:C=>{_("purpose",C.target.value),setTimeout(()=>j(),0)},style:ag,children:c7.map(C=>l.jsx("option",{value:C.value,children:C.label},C.value))}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),l.jsxs("div",{children:[l.jsx("label",{style:lg,children:"Use Case"}),l.jsx("textarea",{value:o.use_case,onChange:C=>_("use_case",C.target.value),onBlur:k,placeholder:"Describe when and how this template should be used...",rows:4,style:{...ag,resize:"vertical"}}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),u&&l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(In,{content:p,onChange:x,loading:y,saving:w,isDirty:v,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const d7={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},f7={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},cg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ns={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function p7({workspaceId:e,fragment:t,onArtifactSave:r}){var L;const[n,i]=m.useState("content"),[o,s]=m.useState({name:"",intent:"",tags:[]}),[a,c]=m.useState(!1),[u,d]=m.useState(!1),[f,h]=m.useState(""),[p,y]=((L=t==null?void 0:t.fragment_id)==null?void 0:L.split(":"))||[null,null],g=t?p==="role"?`fragment:role:${y}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${p}_prompt`:null,w=t&&p==="role"?`fragment:role:${y}:${t.version}:meta`:null,{content:v,loading:x,error:b,saving:_,isDirty:j,updateContent:k,lastSaveResult:N}=cu(e,g,{onSave:O=>{r==null||r(g,O)}});m.useEffect(()=>{t&&(s({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const E=m.useCallback((O,q)=>{s(B=>({...B,[O]:q})),c(!0)},[]),C=m.useCallback(async()=>{if(!(!e||!w)){d(!0);try{const O=bR.dump({name:o.name||null,intent:o.intent||null,tags:o.tags.length>0?o.tags:null},{lineWidth:-1});await ye.writeArtifact(e,w,O),c(!1),r==null||r(w,{success:!0})}catch(O){console.error("Failed to save metadata:",O),alert(`Failed to save metadata: ${O.message}`)}finally{d(!1)}}},[e,w,o,r]),T=m.useCallback(()=>{a&&w&&C()},[a,w,C]),R=m.useCallback(()=>{const O=f.trim().toLowerCase();O&&!o.tags.includes(O)&&(E("tags",[...o.tags,O]),h(""))},[f,o.tags,E]),P=m.useCallback(O=>{E("tags",o.tags.filter(q=>q!==O))},[o.tags,E]),F=m.useCallback(O=>{O.key==="Enter"&&(O.preventDefault(),R())},[R]);if(!t)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),l.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const S=o.name||t.name||t.fragment_id,A=d7[p]||p,M=f7[p]||"var(--text-muted)",z=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],D=!e,I=w&&!D;return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[S,l.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:M,color:"#fff"},children:A})]}),l.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[l.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsxs("span",{children:["from ",t.source_doc_type]})]}),D&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:z.map(O=>l.jsxs("button",{onClick:()=>i(O.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===O.id?"var(--text-primary)":"var(--text-muted)",background:n===O.id?"var(--bg-canvas)":"transparent",borderBottom:n===O.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[O.label,O.id==="content"&&j&&l.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),O.id==="metadata"&&a&&l.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},O.id))}),n==="content"&&l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(In,{content:v,onChange:k,loading:x,saving:_,isDirty:j,error:b,placeholder:"Enter prompt content...",readOnly:D})}),n==="metadata"&&l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l.jsxs("div",{className:"max-w-xl space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{style:ns,children:"Kind"}),l.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[l.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:M}}),l.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:A})]}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),l.jsxs("div",{children:[l.jsx("label",{style:ns,children:"Name"}),l.jsx("input",{type:"text",value:o.name,onChange:O=>E("name",O.target.value),onBlur:T,placeholder:"e.g., Technical Architect Role",style:cg,disabled:!I}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),l.jsxs("div",{children:[l.jsx("label",{style:ns,children:"Intent"}),l.jsx("textarea",{value:o.intent,onChange:O=>E("intent",O.target.value),onBlur:T,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...cg,resize:"vertical"},disabled:!I}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),l.jsxs("div",{children:[l.jsx("label",{style:ns,children:"Tags"}),l.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:o.tags.map(O=>l.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[O,I&&l.jsx("button",{onClick:()=>P(O),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},O))}),I&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:f,onChange:O=>h(O.target.value),onKeyDown:F,placeholder:"Add tag...",style:{...cg,flex:1}}),l.jsx("button",{onClick:R,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&l.jsxs("div",{children:[l.jsx("label",{style:ns,children:"Source"}),l.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",l.jsx("strong",{children:t.source_doc_type})]}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),u&&l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!I&&!t.source_doc_type&&l.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(N==null?void 0:N.tier1)&&!N.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function h7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(i=>i(n))},t)}const du=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Lo(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function wy(e){return"nodeType"in e}function Gt(e){var t,r;return e?Lo(e)?e:wy(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function _y(e){const{Document:t}=Gt(e);return e instanceof t}function wa(e){return Lo(e)?!1:e instanceof Gt(e).HTMLElement}function wR(e){return e instanceof Gt(e).SVGElement}function Fo(e){return e?Lo(e)?e.document:wy(e)?_y(e)?e:wa(e)||wR(e)?e.ownerDocument:document:document:document}const Ur=du?m.useLayoutEffect:m.useEffect;function Sy(e){const t=m.useRef(e);return Ur(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function m7(){const e=m.useRef(null),t=m.useCallback((n,i)=>{e.current=setInterval(n,i)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function oa(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Ur(()=>{r.current!==e&&(r.current=e)},t),r}function _a(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function pc(e){const t=Sy(e),r=m.useRef(null),n=m.useCallback(i=>{i!==r.current&&(t==null||t(i,r.current)),r.current=i},[]);return[r,n]}function Av(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let ug={};function Sa(e,t){return m.useMemo(()=>{if(t)return t;const r=ug[e]==null?0:ug[e]+1;return ug[e]=r,e+"-"+r},[e,t])}function _R(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((o,s)=>{const a=Object.entries(s);for(const[c,u]of a){const d=o[c];d!=null&&(o[c]=d+e*u)}return o},{...t})}}const ho=_R(1),sa=_R(-1);function g7(e){return"clientX"in e&&"clientY"in e}function ky(e){if(!e)return!1;const{KeyboardEvent:t}=Gt(e.target);return t&&e instanceof t}function v7(e){if(!e)return!1;const{TouchEvent:t}=Gt(e.target);return t&&e instanceof t}function Iv(e){if(v7(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return g7(e)?{x:e.clientX,y:e.clientY}:null}const No=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[No.Translate.toString(e),No.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),ak="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function x7(e){return e.matches(ak)?e:e.querySelector(ak)}const y7={display:"none"};function b7(e){let{id:t,value:r}=e;return W.createElement("div",{id:t,style:y7},r)}function w7(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return W.createElement("div",{id:t,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function _7(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const SR=m.createContext(null);function S7(e){const t=m.useContext(SR);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function k7(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:i,event:o}=n;e.forEach(s=>{var a;return(a=s[i])==null?void 0:a.call(s,o)})},[e]),t]}const j7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},C7={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function N7(e){let{announcements:t=C7,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=j7}=e;const{announce:o,announcement:s}=_7(),a=Sa("DndLiveRegion"),[c,u]=m.useState(!1);if(m.useEffect(()=>{u(!0)},[]),S7(m.useMemo(()=>({onDragStart(f){let{active:h}=f;o(t.onDragStart({active:h}))},onDragMove(f){let{active:h,over:p}=f;t.onDragMove&&o(t.onDragMove({active:h,over:p}))},onDragOver(f){let{active:h,over:p}=f;o(t.onDragOver({active:h,over:p}))},onDragEnd(f){let{active:h,over:p}=f;o(t.onDragEnd({active:h,over:p}))},onDragCancel(f){let{active:h,over:p}=f;o(t.onDragCancel({active:h,over:p}))}}),[o,t])),!c)return null;const d=W.createElement(W.Fragment,null,W.createElement(b7,{id:n,value:i.draggable}),W.createElement(w7,{id:a,announcement:s}));return r?eo.createPortal(d,r):d}var ct;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ct||(ct={}));function hc(){}function mc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function kR(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Rr=Object.freeze({x:0,y:0});function jR(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function CR(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function E7(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function lk(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function NR(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function ck(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const ER=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=ck(t,t.left,t.top),o=[];for(const s of n){const{id:a}=s,c=r.get(a);if(c){const u=jR(ck(c),i);o.push({id:a,data:{droppableContainer:s,value:u}})}}return o.sort(CR)},R7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=lk(t),o=[];for(const s of n){const{id:a}=s,c=r.get(a);if(c){const u=lk(c),d=i.reduce((h,p,y)=>h+jR(u[y],p),0),f=Number((d/4).toFixed(4));o.push({id:a,data:{droppableContainer:s,value:f}})}}return o.sort(CR)};function T7(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),s=i-n,a=o-r;if(n<i&&r<o){const c=t.width*t.height,u=e.width*e.height,d=s*a,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const A7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=[];for(const o of n){const{id:s}=o,a=r.get(s);if(a){const c=T7(a,t);c>0&&i.push({id:s,data:{droppableContainer:o,value:c}})}}return i.sort(E7)};function I7(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function RR(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Rr}function M7(e){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.reduce((s,a)=>({...s,top:s.top+e*a.y,bottom:s.bottom+e*a.y,left:s.left+e*a.x,right:s.right+e*a.x}),{...r})}}const P7=M7(1);function O7(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function D7(e,t,r){const n=O7(t);if(!n)return e;const{scaleX:i,scaleY:o,x:s,y:a}=n,c=e.left-s-(1-i)*parseFloat(r),u=e.top-a-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?e.width/i:e.width,f=o?e.height/o:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const L7={ignoreTransform:!1};function zo(e,t){t===void 0&&(t=L7);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Gt(e).getComputedStyle(e);u&&(r=D7(r,u,d))}const{top:n,left:i,width:o,height:s,bottom:a,right:c}=r;return{top:n,left:i,width:o,height:s,bottom:a,right:c}}function uk(e){return zo(e,{ignoreTransform:!0})}function F7(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function z7(e,t){return t===void 0&&(t=Gt(e).getComputedStyle(e)),t.position==="fixed"}function q7(e,t){t===void 0&&(t=Gt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=t[i];return typeof o=="string"?r.test(o):!1})}function fu(e,t){const r=[];function n(i){if(t!=null&&r.length>=t||!i)return r;if(_y(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!wa(i)||wR(i)||r.includes(i))return r;const o=Gt(e).getComputedStyle(i);return i!==e&&q7(i,o)&&r.push(i),z7(i,o)?r:n(i.parentNode)}return e?n(e):r}function TR(e){const[t]=fu(e,1);return t??null}function dg(e){return!du||!e?null:Lo(e)?e:wy(e)?_y(e)||e===Fo(e).scrollingElement?window:wa(e)?e:null:null}function AR(e){return Lo(e)?e.scrollX:e.scrollLeft}function IR(e){return Lo(e)?e.scrollY:e.scrollTop}function Mv(e){return{x:AR(e),y:IR(e)}}var mt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(mt||(mt={}));function MR(e){return!du||!e?!1:e===document.scrollingElement}function PR(e){const t={x:0,y:0},r=MR(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,s=e.scrollTop>=n.y,a=e.scrollLeft>=n.x;return{isTop:i,isLeft:o,isBottom:s,isRight:a,maxScroll:n,minScroll:t}}const $7={x:.2,y:.2};function B7(e,t,r,n,i){let{top:o,left:s,right:a,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=$7);const{isTop:u,isBottom:d,isLeft:f,isRight:h}=PR(e),p={x:0,y:0},y={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!u&&o<=t.top+g.height?(p.y=mt.Backward,y.y=n*Math.abs((t.top+g.height-o)/g.height)):!d&&c>=t.bottom-g.height&&(p.y=mt.Forward,y.y=n*Math.abs((t.bottom-g.height-c)/g.height)),!h&&a>=t.right-g.width?(p.x=mt.Forward,y.x=n*Math.abs((t.right-g.width-a)/g.width)):!f&&s<=t.left+g.width&&(p.x=mt.Backward,y.x=n*Math.abs((t.left+g.width-s)/g.width)),{direction:p,speed:y}}function H7(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:s}=window;return{top:0,left:0,right:o,bottom:s,width:o,height:s}}const{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function OR(e){return e.reduce((t,r)=>ho(t,Mv(r)),Rr)}function W7(e){return e.reduce((t,r)=>t+AR(r),0)}function U7(e){return e.reduce((t,r)=>t+IR(r),0)}function V7(e,t){if(t===void 0&&(t=zo),!e)return;const{top:r,left:n,bottom:i,right:o}=t(e);TR(e)&&(i<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const G7=[["x",["left","right"],W7],["y",["top","bottom"],U7]];class jy{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=fu(r),i=OR(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,s,a]of G7)for(const c of s)Object.defineProperty(this,c,{get:()=>{const u=a(n),d=i[o]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ns{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var i;(i=this.target)==null||i.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function Y7(e){const{EventTarget:t}=Gt(e);return e instanceof t?e:Fo(e)}function fg(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var or;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(or||(or={}));function dk(e){e.preventDefault()}function K7(e){e.stopPropagation()}var je;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(je||(je={}));const DR={start:[je.Space,je.Enter],cancel:[je.Esc],end:[je.Space,je.Enter,je.Tab]},X7=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case je.Right:return{...r,x:r.x+25};case je.Left:return{...r,x:r.x-25};case je.Down:return{...r,y:r.y+25};case je.Up:return{...r,y:r.y-25}}};class pu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Ns(Fo(r)),this.windowListeners=new Ns(Gt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(or.Resize,this.handleCancel),this.windowListeners.add(or.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(or.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&V7(n),r(Rr)}handleKeyDown(t){if(ky(t)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:o=DR,coordinateGetter:s=X7,scrollBehavior:a="smooth"}=i,{code:c}=t;if(o.end.includes(c)){this.handleEnd(t);return}if(o.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:Rr;this.referenceCoordinates||(this.referenceCoordinates=d);const f=s(t,{active:r,context:n.current,currentCoordinates:d});if(f){const h=sa(f,d),p={x:0,y:0},{scrollableAncestors:y}=n.current;for(const g of y){const w=t.code,{isTop:v,isRight:x,isLeft:b,isBottom:_,maxScroll:j,minScroll:k}=PR(g),N=H7(g),E={x:Math.min(w===je.Right?N.right-N.width/2:N.right,Math.max(w===je.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(w===je.Down?N.bottom-N.height/2:N.bottom,Math.max(w===je.Down?N.top:N.top+N.height/2,f.y))},C=w===je.Right&&!x||w===je.Left&&!b,T=w===je.Down&&!_||w===je.Up&&!v;if(C&&E.x!==f.x){const R=g.scrollLeft+h.x,P=w===je.Right&&R<=j.x||w===je.Left&&R>=k.x;if(P&&!h.y){g.scrollTo({left:R,behavior:a});return}P?p.x=g.scrollLeft-R:p.x=w===je.Right?g.scrollLeft-j.x:g.scrollLeft-k.x,p.x&&g.scrollBy({left:-p.x,behavior:a});break}else if(T&&E.y!==f.y){const R=g.scrollTop+h.y,P=w===je.Down&&R<=j.y||w===je.Up&&R>=k.y;if(P&&!h.x){g.scrollTo({top:R,behavior:a});return}P?p.y=g.scrollTop-R:p.y=w===je.Down?g.scrollTop-j.y:g.scrollTop-k.y,p.y&&g.scrollBy({top:-p.y,behavior:a});break}}this.handleMove(t,ho(sa(f,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}pu.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=DR,onActivation:i}=t,{active:o}=r;const{code:s}=e.nativeEvent;if(n.start.includes(s)){const a=o.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function fk(e){return!!(e&&"distance"in e)}function pk(e){return!!(e&&"delay"in e)}class Cy{constructor(t,r,n){var i;n===void 0&&(n=Y7(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:s}=o;this.props=t,this.events=r,this.document=Fo(s),this.documentListeners=new Ns(this.document),this.listeners=new Ns(n),this.windowListeners=new Ns(Gt(s)),this.initialCoordinates=(i=Iv(o))!=null?i:Rr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(or.Resize,this.handleCancel),this.windowListeners.add(or.DragStart,dk),this.windowListeners.add(or.VisibilityChange,this.handleCancel),this.windowListeners.add(or.ContextMenu,dk),this.documentListeners.add(or.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(pk(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(fk(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:i}=this.props;i(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(or.Click,K7,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(or.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:i,props:o}=this,{onMove:s,options:{activationConstraint:a}}=o;if(!i)return;const c=(r=Iv(t))!=null?r:Rr,u=sa(i,c);if(!n&&a){if(fk(a)){if(a.tolerance!=null&&fg(u,a.tolerance))return this.handleCancel();if(fg(u,a.distance))return this.handleStart()}if(pk(a)&&fg(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}t.cancelable&&t.preventDefault(),s(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===je.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Q7={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class hu extends Cy{constructor(t){const{event:r}=t,n=Fo(r.target);super(t,Q7,n)}}hu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const Z7={move:{name:"mousemove"},end:{name:"mouseup"}};var Pv;(function(e){e[e.RightClick=2]="RightClick"})(Pv||(Pv={}));class J7 extends Cy{constructor(t){super(t,Z7,Fo(t.event.target))}}J7.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Pv.RightClick?!1:(n==null||n({event:r}),!0)}}];const pg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class eW extends Cy{constructor(t){super(t,pg)}static setup(){return window.addEventListener(pg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(pg.move.name,t)};function t(){}}}eW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];var Es;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Es||(Es={}));var gc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(gc||(gc={}));function tW(e){let{acceleration:t,activator:r=Es.Pointer,canScroll:n,draggingRect:i,enabled:o,interval:s=5,order:a=gc.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:h}=e;const p=nW({delta:f,disabled:!o}),[y,g]=m7(),w=m.useRef({x:0,y:0}),v=m.useRef({x:0,y:0}),x=m.useMemo(()=>{switch(r){case Es.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Es.DraggableRect:return i}},[r,i,c]),b=m.useRef(null),_=m.useCallback(()=>{const k=b.current;if(!k)return;const N=w.current.x*v.current.x,E=w.current.y*v.current.y;k.scrollBy(N,E)},[]),j=m.useMemo(()=>a===gc.TreeOrder?[...u].reverse():u,[a,u]);m.useEffect(()=>{if(!o||!u.length||!x){g();return}for(const k of j){if((n==null?void 0:n(k))===!1)continue;const N=u.indexOf(k),E=d[N];if(!E)continue;const{direction:C,speed:T}=B7(k,E,x,t,h);for(const R of["x","y"])p[R][C[R]]||(T[R]=0,C[R]=0);if(T.x>0||T.y>0){g(),b.current=k,y(_,s),w.current=T,v.current=C;return}}w.current={x:0,y:0},v.current={x:0,y:0},g()},[t,_,n,g,o,s,JSON.stringify(x),JSON.stringify(p),y,u,j,d,JSON.stringify(h)])}const rW={x:{[mt.Backward]:!1,[mt.Forward]:!1},y:{[mt.Backward]:!1,[mt.Forward]:!1}};function nW(e){let{delta:t,disabled:r}=e;const n=Av(t);return _a(i=>{if(r||!n||!i)return rW;const o={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[mt.Backward]:i.x[mt.Backward]||o.x===-1,[mt.Forward]:i.x[mt.Forward]||o.x===1},y:{[mt.Backward]:i.y[mt.Backward]||o.y===-1,[mt.Forward]:i.y[mt.Forward]||o.y===1}}},[r,t,n])}function iW(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return _a(i=>{var o;return t==null?null:(o=n??i)!=null?o:null},[n,t])}function oW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:i}=n,o=i.activators.map(s=>({eventName:s.eventName,handler:t(s.handler,n)}));return[...r,...o]},[]),[e,t])}var aa;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(aa||(aa={}));var Ov;(function(e){e.Optimized="optimized"})(Ov||(Ov={}));const hk=new Map;function sW(e,t){let{dragging:r,dependencies:n,config:i}=t;const[o,s]=m.useState(null),{frequency:a,measure:c,strategy:u}=i,d=m.useRef(e),f=w(),h=oa(f),p=m.useCallback(function(v){v===void 0&&(v=[]),!h.current&&s(x=>x===null?v:x.concat(v.filter(b=>!x.includes(b))))},[h]),y=m.useRef(null),g=_a(v=>{if(f&&!r)return hk;if(!v||v===hk||d.current!==e||o!=null){const x=new Map;for(let b of e){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){x.set(b.id,b.rect.current);continue}const _=b.node.current,j=_?new jy(c(_),_):null;b.rect.current=j,j&&x.set(b.id,j)}return x}return v},[e,o,r,f,c]);return m.useEffect(()=>{d.current=e},[e]),m.useEffect(()=>{f||p()},[r,f]),m.useEffect(()=>{o&&o.length>0&&s(null)},[JSON.stringify(o)]),m.useEffect(()=>{f||typeof a!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},a))},[a,f,p,...n]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:o!=null};function w(){switch(u){case aa.Always:return!1;case aa.BeforeDragging:return r;default:return!r}}}function LR(e,t){return _a(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function aW(e,t){return LR(e,t)}function lW(e){let{callback:t,disabled:r}=e;const n=Sy(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function mu(e){let{callback:t,disabled:r}=e;const n=Sy(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function cW(e){return new jy(zo(e),e)}function mk(e,t,r){t===void 0&&(t=cW);const[n,i]=m.useState(null);function o(){i(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const s=lW({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){o();break}}}}),a=mu({callback:o});return Ur(()=>{o(),e?(a==null||a.observe(e),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),s==null||s.disconnect())},[e]),n}function uW(e){const t=LR(e);return RR(e,t)}const gk=[];function dW(e){const t=m.useRef(e),r=_a(n=>e?n&&n!==gk&&e&&t.current&&e.parentNode===t.current.parentNode?n:fu(e):gk,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function fW(e){const[t,r]=m.useState(null),n=m.useRef(e),i=m.useCallback(o=>{const s=dg(o.target);s&&r(a=>a?(a.set(s,Mv(s)),new Map(a)):null)},[]);return m.useEffect(()=>{const o=n.current;if(e!==o){s(o);const a=e.map(c=>{const u=dg(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,Mv(u)]):null}).filter(c=>c!=null);r(a.length?new Map(a):null),n.current=e}return()=>{s(e),s(o)};function s(a){a.forEach(c=>{const u=dg(c);u==null||u.removeEventListener("scroll",i)})}},[i,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,s)=>ho(o,s),Rr):OR(e):Rr,[e,t])}function vk(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Rr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?sa(e,r.current):Rr}function pW(e){m.useEffect(()=>{if(!du)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function hW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:i,handler:o}=n;return r[i]=s=>{o(s,t)},r},{}),[e,t])}function FR(e){return m.useMemo(()=>e?F7(e):null,[e])}const xk=[];function mW(e,t){t===void 0&&(t=zo);const[r]=e,n=FR(r?Gt(r):null),[i,o]=m.useState(xk);function s(){o(()=>e.length?e.map(c=>MR(c)?n:new jy(t(c),c)):xk)}const a=mu({callback:s});return Ur(()=>{a==null||a.disconnect(),s(),e.forEach(c=>a==null?void 0:a.observe(c))},[e]),i}function gW(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return wa(t)?t:e}function vW(e){let{measure:t}=e;const[r,n]=m.useState(null),i=m.useCallback(u=>{for(const{target:d}of u)if(wa(d)){n(f=>{const h=t(d);return f?{...f,width:h.width,height:h.height}:h});break}},[t]),o=mu({callback:i}),s=m.useCallback(u=>{const d=gW(u);o==null||o.disconnect(),d&&(o==null||o.observe(d)),n(d?t(d):null)},[t,o]),[a,c]=pc(s);return m.useMemo(()=>({nodeRef:a,rect:r,setRef:c}),[r,a,c])}const xW=[{sensor:hu,options:{}},{sensor:pu,options:{}}],yW={current:{}},_l={draggable:{measure:uk},droppable:{measure:uk,strategy:aa.WhileDragging,frequency:Ov.Optimized},dragOverlay:{measure:zo}};class Rs extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const bW={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Rs,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:hc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:_l,measureDroppableContainers:hc,windowRect:null,measuringScheduled:!1},wW={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:hc,draggableNodes:new Map,over:null,measureDroppableContainers:hc},gu=m.createContext(wW),zR=m.createContext(bW);function _W(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Rs}}}function SW(e,t){switch(t.type){case ct.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ct.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ct.DragEnd:case ct.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ct.RegisterDroppable:{const{element:r}=t,{id:n}=r,i=new Rs(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case ct.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;const s=new Rs(e.droppable.containers);return s.set(r,{...o,disabled:i}),{...e,droppable:{...e.droppable,containers:s}}}case ct.UnregisterDroppable:{const{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const o=new Rs(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function kW(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:i}=m.useContext(gu),o=Av(n),s=Av(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&o&&s!=null){if(!ky(o)||document.activeElement===o.target)return;const a=i.get(s);if(!a)return;const{activatorNode:c,node:u}=a;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=x7(d);if(f){f.focus();break}}})}},[n,t,i,s,o]),null}function jW(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((i,o)=>o({transform:i,...n}),r):r}function CW(e){return m.useMemo(()=>({draggable:{..._l.draggable,...e==null?void 0:e.draggable},droppable:{..._l.droppable,...e==null?void 0:e.droppable},dragOverlay:{..._l.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function NW(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e;const o=m.useRef(!1),{x:s,y:a}=typeof i=="boolean"?{x:i,y:i}:i;Ur(()=>{if(!s&&!a||!t){o.current=!1;return}if(o.current||!n)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=RR(d,n);if(s||(f.x=0),a||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const h=TR(u);h&&h.scrollBy({top:f.y,left:f.x})}},[t,s,a,n,r])}const qR=m.createContext({...Rr,scaleX:1,scaleY:1});var Cn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Cn||(Cn={}));const $R=m.memo(function(t){var r,n,i,o;let{id:s,accessibility:a,autoScroll:c=!0,children:u,sensors:d=xW,collisionDetection:f=A7,measuring:h,modifiers:p,...y}=t;const g=m.useReducer(SW,void 0,_W),[w,v]=g,[x,b]=k7(),[_,j]=m.useState(Cn.Uninitialized),k=_===Cn.Initialized,{draggable:{active:N,nodes:E,translate:C},droppable:{containers:T}}=w,R=N!=null?E.get(N):null,P=m.useRef({initial:null,translated:null}),F=m.useMemo(()=>{var Ke;return N!=null?{id:N,data:(Ke=R==null?void 0:R.data)!=null?Ke:yW,rect:P}:null},[N,R]),S=m.useRef(null),[A,M]=m.useState(null),[z,D]=m.useState(null),I=oa(y,Object.values(y)),L=Sa("DndDescribedBy",s),O=m.useMemo(()=>T.getEnabled(),[T]),q=CW(h),{droppableRects:B,measureDroppableContainers:$,measuringScheduled:V}=sW(O,{dragging:k,dependencies:[C.x,C.y],config:q.droppable}),X=iW(E,N),ne=m.useMemo(()=>z?Iv(z):null,[z]),te=Mr(),ae=aW(X,q.draggable.measure);NW({activeNode:N!=null?E.get(N):null,config:te.layoutShiftCompensation,initialRect:ae,measure:q.draggable.measure});const Q=mk(X,q.draggable.measure,ae),we=mk(X?X.parentElement:null),se=m.useRef({activatorEvent:null,active:null,activeNode:X,collisionRect:null,collisions:null,droppableRects:B,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:T,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Te=T.getNodeFor((r=se.current.over)==null?void 0:r.id),ue=vW({measure:q.dragOverlay.measure}),Z=(n=ue.nodeRef.current)!=null?n:X,xe=k?(i=ue.rect)!=null?i:Q:null,U=!!(ue.nodeRef.current&&ue.rect),Y=uW(U?null:Q),ce=FR(Z?Gt(Z):null),pe=dW(k?Te??X:null),ke=mW(pe),ge=jW(p,{transform:{x:C.x-Y.x,y:C.y-Y.y,scaleX:1,scaleY:1},activatorEvent:z,active:F,activeNodeRect:Q,containerNodeRect:we,draggingNodeRect:xe,over:se.current.over,overlayNodeRect:ue.rect,scrollableAncestors:pe,scrollableAncestorRects:ke,windowRect:ce}),de=ne?ho(ne,C):null,_e=fW(pe),Ve=vk(_e),Ce=vk(_e,[Q]),Le=ho(ge,Ve),Oe=xe?P7(xe,ge):null,Ge=F&&Oe?f({active:F,collisionRect:Oe,droppableRects:B,droppableContainers:O,pointerCoordinates:de}):null,G=NR(Ge,"id"),[he,le]=m.useState(null),Ye=U?ge:ho(ge,Ce),Je=I7(Ye,(o=he==null?void 0:he.rect)!=null?o:null,Q),xt=m.useRef(null),ie=m.useCallback((Ke,Fe)=>{let{sensor:at,options:Dt}=Fe;if(S.current==null)return;const yt=E.get(S.current);if(!yt)return;const ft=Ke.nativeEvent,Tt=new at({active:S.current,activeNode:yt,event:ft,options:Dt,context:se,onAbort(et){if(!E.get(et))return;const{onDragAbort:H}=I.current,Ie={id:et};H==null||H(Ie),x({type:"onDragAbort",event:Ie})},onPending(et,Yt,H,Ie){if(!E.get(et))return;const{onDragPending:ri}=I.current,Pr={id:et,constraint:Yt,initialCoordinates:H,offset:Ie};ri==null||ri(Pr),x({type:"onDragPending",event:Pr})},onStart(et){const Yt=S.current;if(Yt==null)return;const H=E.get(Yt);if(!H)return;const{onDragStart:Ie}=I.current,ti={activatorEvent:ft,active:{id:Yt,data:H.data,rect:P}};eo.unstable_batchedUpdates(()=>{Ie==null||Ie(ti),j(Cn.Initializing),v({type:ct.DragStart,initialCoordinates:et,active:Yt}),x({type:"onDragStart",event:ti}),M(xt.current),D(ft)})},onMove(et){v({type:ct.DragMove,coordinates:et})},onEnd:xr(ct.DragEnd),onCancel:xr(ct.DragCancel)});xt.current=Tt;function xr(et){return async function(){const{active:H,collisions:Ie,over:ti,scrollAdjustedTranslate:ri}=se.current;let Pr=null;if(H&&ri){const{cancelDrop:ni}=I.current;Pr={activatorEvent:ft,active:H,collisions:Ie,delta:ri,over:ti},et===ct.DragEnd&&typeof ni=="function"&&await Promise.resolve(ni(Pr))&&(et=ct.DragCancel)}S.current=null,eo.unstable_batchedUpdates(()=>{v({type:et}),j(Cn.Uninitialized),le(null),M(null),D(null),xt.current=null;const ni=et===ct.DragEnd?"onDragEnd":"onDragCancel";if(Pr){const qo=I.current[ni];qo==null||qo(Pr),x({type:ni,event:Pr})}})}}},[E]),ee=m.useCallback((Ke,Fe)=>(at,Dt)=>{const yt=at.nativeEvent,ft=E.get(Dt);if(S.current!==null||!ft||yt.dndKit||yt.defaultPrevented)return;const Tt={active:ft};Ke(at,Fe.options,Tt)===!0&&(yt.dndKit={capturedBy:Fe.sensor},S.current=Dt,ie(at,Fe))},[E,ie]),$e=oW(d,ee);pW(d),Ur(()=>{Q&&_===Cn.Initializing&&j(Cn.Initialized)},[Q,_]),m.useEffect(()=>{const{onDragMove:Ke}=I.current,{active:Fe,activatorEvent:at,collisions:Dt,over:yt}=se.current;if(!Fe||!at)return;const ft={active:Fe,activatorEvent:at,collisions:Dt,delta:{x:Le.x,y:Le.y},over:yt};eo.unstable_batchedUpdates(()=>{Ke==null||Ke(ft),x({type:"onDragMove",event:ft})})},[Le.x,Le.y]),m.useEffect(()=>{const{active:Ke,activatorEvent:Fe,collisions:at,droppableContainers:Dt,scrollAdjustedTranslate:yt}=se.current;if(!Ke||S.current==null||!Fe||!yt)return;const{onDragOver:ft}=I.current,Tt=Dt.get(G),xr=Tt&&Tt.rect.current?{id:Tt.id,rect:Tt.rect.current,data:Tt.data,disabled:Tt.disabled}:null,et={active:Ke,activatorEvent:Fe,collisions:at,delta:{x:yt.x,y:yt.y},over:xr};eo.unstable_batchedUpdates(()=>{le(xr),ft==null||ft(et),x({type:"onDragOver",event:et})})},[G]),Ur(()=>{se.current={activatorEvent:z,active:F,activeNode:X,collisionRect:Oe,collisions:Ge,droppableRects:B,draggableNodes:E,draggingNode:Z,draggingNodeRect:xe,droppableContainers:T,over:he,scrollableAncestors:pe,scrollAdjustedTranslate:Le},P.current={initial:xe,translated:Oe}},[F,X,Ge,Oe,E,Z,xe,B,T,he,pe,Le]),tW({...te,delta:C,draggingRect:Oe,pointerCoordinates:de,scrollableAncestors:pe,scrollableAncestorRects:ke});const gr=m.useMemo(()=>({active:F,activeNode:X,activeNodeRect:Q,activatorEvent:z,collisions:Ge,containerNodeRect:we,dragOverlay:ue,draggableNodes:E,droppableContainers:T,droppableRects:B,over:he,measureDroppableContainers:$,scrollableAncestors:pe,scrollableAncestorRects:ke,measuringConfiguration:q,measuringScheduled:V,windowRect:ce}),[F,X,Q,z,Ge,we,ue,E,T,B,he,$,pe,ke,q,V,ce]),vr=m.useMemo(()=>({activatorEvent:z,activators:$e,active:F,activeNodeRect:Q,ariaDescribedById:{draggable:L},dispatch:v,draggableNodes:E,over:he,measureDroppableContainers:$}),[z,$e,F,Q,v,L,E,he,$]);return W.createElement(SR.Provider,{value:b},W.createElement(gu.Provider,{value:vr},W.createElement(zR.Provider,{value:gr},W.createElement(qR.Provider,{value:Je},u)),W.createElement(kW,{disabled:(a==null?void 0:a.restoreFocus)===!1})),W.createElement(N7,{...a,hiddenTextDescribedById:L}));function Mr(){const Ke=(A==null?void 0:A.autoScrollEnabled)===!1,Fe=typeof c=="object"?c.enabled===!1:c===!1,at=k&&!Ke&&!Fe;return typeof c=="object"?{...c,enabled:at}:{enabled:at}}}),EW=m.createContext(null),yk="button",RW="Draggable";function TW(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e;const o=Sa(RW),{activators:s,activatorEvent:a,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:h}=m.useContext(gu),{role:p=yk,roleDescription:y="draggable",tabIndex:g=0}=i??{},w=(c==null?void 0:c.id)===t,v=m.useContext(w?qR:EW),[x,b]=pc(),[_,j]=pc(),k=hW(s,t),N=oa(r);Ur(()=>(f.set(t,{id:t,key:o,node:x,activatorNode:_,data:N}),()=>{const C=f.get(t);C&&C.key===o&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:p,tabIndex:g,"aria-disabled":n,"aria-pressed":w&&p===yk?!0:void 0,"aria-roledescription":y,"aria-describedby":d.draggable}),[n,p,g,w,y,d.draggable]);return{active:c,activatorEvent:a,activeNodeRect:u,attributes:E,isDragging:w,listeners:n?void 0:k,node:x,over:h,setNodeRef:b,setActivatorNodeRef:j,transform:v}}function AW(){return m.useContext(zR)}const IW="Droppable",MW={timeout:25};function PW(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e;const o=Sa(IW),{active:s,dispatch:a,over:c,measureDroppableContainers:u}=m.useContext(gu),d=m.useRef({disabled:r}),f=m.useRef(!1),h=m.useRef(null),p=m.useRef(null),{disabled:y,updateMeasurementsFor:g,timeout:w}={...MW,...i},v=oa(g??n),x=m.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(v.current)?v.current:[v.current]),p.current=null},w)},[w]),b=mu({callback:x,disabled:y||!s}),_=m.useCallback((E,C)=>{b&&(C&&(b.unobserve(C),f.current=!1),E&&b.observe(E))},[b]),[j,k]=pc(_),N=oa(t);return m.useEffect(()=>{!b||!j.current||(b.disconnect(),f.current=!1,b.observe(j.current))},[j,b]),m.useEffect(()=>(a({type:ct.RegisterDroppable,element:{id:n,key:o,disabled:r,node:j,rect:h,data:N}}),()=>a({type:ct.UnregisterDroppable,key:o,id:n})),[n]),m.useEffect(()=>{r!==d.current.disabled&&(a({type:ct.SetDroppableDisabled,id:n,key:o,disabled:r}),d.current.disabled=r)},[n,o,r,a]),{active:s,rect:h,isOver:(c==null?void 0:c.id)===n,node:j,over:c,setNodeRef:k}}function vu(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function OW(e,t){return e.reduce((r,n,i)=>{const o=t.get(n);return o&&(r[i]=o),r},Array(e.length))}function il(e){return e!==null&&e>=0}function DW(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function LW(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const BR=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e;const o=vu(t,n,r),s=t[i],a=o[i];return!a||!s?null:{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}},ol={scaleX:1,scaleY:1},HR=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:o,overIndex:s}=e;const a=(t=o[r])!=null?t:n;if(!a)return null;if(i===r){const u=o[s];return u?{x:0,y:r<s?u.top+u.height-(a.top+a.height):u.top-a.top,...ol}:null}const c=FW(o,i,r);return i>r&&i<=s?{x:0,y:-a.height-c,...ol}:i<r&&i>=s?{x:0,y:a.height+c,...ol}:{x:0,y:0,...ol}};function FW(e,t,r){const n=e[t],i=e[t-1],o=e[t+1];return n?r<t?i?n.top-(i.top+i.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const WR="Sortable",UR=W.createContext({activeIndex:-1,containerId:WR,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:BR,disabled:{draggable:!1,droppable:!1}});function VR(e){let{children:t,id:r,items:n,strategy:i=BR,disabled:o=!1}=e;const{active:s,dragOverlay:a,droppableRects:c,over:u,measureDroppableContainers:d}=AW(),f=Sa(WR,r),h=a.rect!==null,p=m.useMemo(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),y=s!=null,g=s?p.indexOf(s.id):-1,w=u?p.indexOf(u.id):-1,v=m.useRef(p),x=!DW(p,v.current),b=w!==-1&&g===-1||x,_=LW(o);Ur(()=>{x&&y&&d(p)},[x,p,y,d]),m.useEffect(()=>{v.current=p},[p]);const j=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:_,disableTransforms:b,items:p,overIndex:w,useDragOverlay:h,sortedRects:OW(p,c),strategy:i}),[g,f,_.draggable,_.droppable,b,p,w,c,h,i]);return W.createElement(UR.Provider,{value:j},t)}const zW=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return vu(r,n,i).indexOf(t)},qW=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:o,newIndex:s,previousItems:a,previousContainerId:c,transition:u}=e;return!u||!n||a!==o&&i===s?!1:r?!0:s!==i&&t===c},$W={duration:200,easing:"ease"},GR="transform",BW=No.Transition.toString({property:GR,duration:0,easing:"linear"}),HW={roleDescription:"sortable"};function WW(e){let{disabled:t,index:r,node:n,rect:i}=e;const[o,s]=m.useState(null),a=m.useRef(r);return Ur(()=>{if(!t&&r!==a.current&&n.current){const c=i.current;if(c){const u=zo(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&s(d)}}r!==a.current&&(a.current=r)},[t,r,n,i]),m.useEffect(()=>{o&&s(null)},[o]),o}function YR(e){let{animateLayoutChanges:t=qW,attributes:r,disabled:n,data:i,getNewIndex:o=zW,id:s,strategy:a,resizeObserverConfig:c,transition:u=$W}=e;const{items:d,containerId:f,activeIndex:h,disabled:p,disableTransforms:y,sortedRects:g,overIndex:w,useDragOverlay:v,strategy:x}=m.useContext(UR),b=UW(n,p),_=d.indexOf(s),j=m.useMemo(()=>({sortable:{containerId:f,index:_,items:d},...i}),[f,i,_,d]),k=m.useMemo(()=>d.slice(d.indexOf(s)),[d,s]),{rect:N,node:E,isOver:C,setNodeRef:T}=PW({id:s,data:j,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:R,activatorEvent:P,activeNodeRect:F,attributes:S,setNodeRef:A,listeners:M,isDragging:z,over:D,setActivatorNodeRef:I,transform:L}=TW({id:s,data:j,attributes:{...HW,...r},disabled:b.draggable}),O=h7(T,A),q=!!R,B=q&&!y&&il(h)&&il(w),$=!v&&z,V=$&&B?L:null,ne=B?V??(a??x)({rects:g,activeNodeRect:F,activeIndex:h,overIndex:w,index:_}):null,te=il(h)&&il(w)?o({id:s,items:d,activeIndex:h,overIndex:w}):_,ae=R==null?void 0:R.id,Q=m.useRef({activeId:ae,items:d,newIndex:te,containerId:f}),we=d!==Q.current.items,se=t({active:R,containerId:f,isDragging:z,isSorting:q,id:s,index:_,items:d,newIndex:Q.current.newIndex,previousItems:Q.current.items,previousContainerId:Q.current.containerId,transition:u,wasDragging:Q.current.activeId!=null}),Te=WW({disabled:!se,index:_,node:E,rect:N});return m.useEffect(()=>{q&&Q.current.newIndex!==te&&(Q.current.newIndex=te),f!==Q.current.containerId&&(Q.current.containerId=f),d!==Q.current.items&&(Q.current.items=d)},[q,te,f,d]),m.useEffect(()=>{if(ae===Q.current.activeId)return;if(ae!=null&&Q.current.activeId==null){Q.current.activeId=ae;return}const Z=setTimeout(()=>{Q.current.activeId=ae},50);return()=>clearTimeout(Z)},[ae]),{active:R,activeIndex:h,attributes:S,data:j,rect:N,index:_,newIndex:te,items:d,isOver:C,isSorting:q,isDragging:z,listeners:M,node:E,overIndex:w,over:D,setNodeRef:O,setActivatorNodeRef:I,setDroppableNodeRef:T,setDraggableNodeRef:A,transform:Te??ne,transition:ue()};function ue(){if(Te||we&&Q.current.newIndex===_)return BW;if(!($&&!ky(P)||!u)&&(q||se))return No.Transition.toString({...u,property:GR})}}function UW(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function vc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const VW=[je.Down,je.Right,je.Up,je.Left],KR=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:o,over:s,scrollableAncestors:a}}=t;if(VW.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];o.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const h=i.get(f.id);if(h)switch(e.code){case je.Down:n.top<h.top&&c.push(f);break;case je.Up:n.top>h.top&&c.push(f);break;case je.Left:n.left>h.left&&c.push(f);break;case je.Right:n.left<h.left&&c.push(f);break}});const u=R7({collisionRect:n,droppableRects:i,droppableContainers:c});let d=NR(u,"id");if(d===(s==null?void 0:s.id)&&u.length>1&&(d=u[1].id),d!=null){const f=o.get(r.id),h=o.get(d),p=h?i.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&p&&f&&h){const w=fu(y).some((k,N)=>a[N]!==k),v=XR(f,h),x=GW(f,h),b=w||!v?{x:0,y:0}:{x:x?n.width-p.width:0,y:x?n.height-p.height:0},_={x:p.left,y:p.top};return b.x&&b.y?_:sa(_,b)}}}};function XR(e,t){return!vc(e)||!vc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function GW(e,t){return!vc(e)||!vc(t)||!XR(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const YW={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Dr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},ir={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},QR={step_id:"new_step",produces:"",scope:"",inputs:[]},KW={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function XW({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:i,onNavigateToWorkflow:o}){const[s,a]=m.useState("steps"),[c,u]=m.useState(""),[d,f]=m.useState(null),h=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:p,loading:y,error:g,saving:w,updateWorkflow:v}=A4(e,h,{onSave:C=>{n==null||n(h,C)}}),x=m.useCallback(C=>{C==="json"&&p&&(u(JSON.stringify(p,null,2)),f(null)),a(C)},[p]),b=m.useCallback(C=>{const T=C.target.value;u(T);try{const R=JSON.parse(T);f(null),v(R)}catch(R){f(R.message)}},[v]),_=m.useCallback((C,T)=>{if(!p)return;const R=[...p.steps];R[C]=T,v({...p,steps:R})},[p,v]),j=m.useCallback(C=>{if(!p)return;const T=p.steps.filter((R,P)=>P!==C);v({...p,steps:T})},[p,v]),k=m.useCallback(C=>{var R,P;if(!p)return;const T=C==="iteration"?{...KW,step_id:`new_iteration_${(((R=p.steps)==null?void 0:R.length)||0)+1}`}:{...QR,step_id:`new_step_${(((P=p.steps)==null?void 0:P.length)||0)+1}`};v({...p,steps:[...p.steps||[],T]})},[p,v]),N=m.useCallback((C,T)=>{if(!p)return;const R=vu(p.steps,C,T);v({...p,steps:R})},[p,v]),E=m.useCallback(()=>{!i||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&i(t.workflow_id)},[i,t]);return t?l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(p==null?void 0:p.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,C=>C.toUpperCase())}),((p==null?void 0:p.pow_class)||t.pow_class)&&l.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(p==null?void 0:p.pow_class)||t.pow_class})]}),l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(p==null?void 0:p.description)&&`  ${p.description}`]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[w&&l.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&l.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),i&&l.jsx("button",{onClick:E,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),l.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(C=>l.jsx("button",{onClick:()=>x(C.id),style:{...YW,color:s===C.id?"var(--text-primary)":"var(--text-muted)",borderBottom:s===C.id?"2px solid var(--action-primary)":"2px solid transparent"},children:C.label},C.id))}),y?l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):l.jsxs("div",{className:"flex-1 overflow-hidden",children:[s==="steps"&&l.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[l.jsx(QW,{steps:(p==null?void 0:p.steps)||[],documentTypes:r,onStepChange:_,onStepDelete:j,onReorder:N}),l.jsxs("div",{className:"flex gap-2 mt-3",children:[l.jsx("button",{onClick:()=>k("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),l.jsx("button",{onClick:()=>k("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),s==="json"&&l.jsxs("div",{className:"h-full flex flex-col p-4",children:[l.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:d?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),d&&l.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",d]})]}),s==="metadata"&&l.jsx("div",{className:"h-full overflow-y-auto p-4",children:p?l.jsx(tU,{workflow:p,onUpdateWorkflow:v,onNavigateToWorkflow:o}):l.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),l.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function QW({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const o=kR(mc(hu,{activationConstraint:{distance:5}}),mc(pu,{coordinateGetter:KR})),s=m.useMemo(()=>e.map(c=>c.step_id),[e]),a=m.useCallback(c=>{const{active:u,over:d}=c;if(!d||u.id===d.id)return;const f=e.findIndex(p=>p.step_id===u.id),h=e.findIndex(p=>p.step_id===d.id);f!==-1&&h!==-1&&i(f,h)},[e,i]);return e.length===0?l.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):l.jsx($R,{sensors:o,collisionDetection:ER,onDragEnd:a,children:l.jsx(VR,{items:s,strategy:HR,children:e.map((c,u)=>l.jsx(ZW,{step:c,index:u,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function ZW({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:o,listeners:s,setNodeRef:a,transform:c,transition:u,isDragging:d}=YR({id:e.step_id}),f={transform:No.Transform.toString(c),transition:u,opacity:d?.5:1};return l.jsx("div",{ref:a,style:f,children:l.jsx(ZR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...o,...s}})})}function ZR({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i,dragHandleProps:o,depth:s=0}){var k,N,E;const[a,c]=m.useState(e),[u,d]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!a.iterate_over,h=(C,T)=>{const R={...a,[C]:T};c(R),n(t,R)},p=(C,T)=>{const R={...a.iterate_over,[C]:T},P={...a,iterate_over:R};c(P),n(t,P)},y=()=>{const C=[...a.inputs||[],{doc_type:"",scope:""}],T={...a,inputs:C};c(T),n(t,T)},g=(C,T,R)=>{const P=[...a.inputs||[]];P[C]={...P[C],[T]:R};const F={...a,inputs:P};c(F),n(t,F)},w=C=>{const T=(a.inputs||[]).filter((P,F)=>F!==C),R={...a,inputs:T};c(R),n(t,R)},v=m.useCallback((C,T)=>{const R=[...a.steps||[]];R[C]=T;const P={...a,steps:R};c(P),n(t,P)},[a,t,n]),x=m.useCallback(C=>{const T=(a.steps||[]).filter((P,F)=>F!==C),R={...a,steps:T};c(R),n(t,R)},[a,t,n]),b=m.useCallback(()=>{var R;const C=[...a.steps||[],{...QR,step_id:`nested_step_${(((R=a.steps)==null?void 0:R.length)||0)+1}`}],T={...a,steps:C};c(T),n(t,T)},[a,t,n]),_=m.useCallback((C,T)=>{const R=vu(a.steps||[],C,T),P={...a,steps:R};c(P),n(t,P)},[a,t,n]),j={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:s*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return l.jsxs("div",{style:j,children:[l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:u?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:u?"6px 6px 0 0":6},children:[o&&l.jsx("span",{...o,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:l.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),l.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),l.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),l.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),l.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:a.step_id}),l.jsx("span",{style:{flex:1}}),l.jsx("button",{onClick:()=>d(!u),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:u?"Collapse":"Expand",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u?l.jsx("path",{d:"M18 15l-6-6-6 6"}):l.jsx("path",{d:"M6 9l6 6 6-6"})})}),l.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),u&&l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Step ID"}),l.jsx("input",{type:"text",value:a.step_id||"",onChange:C=>h("step_id",C.target.value),style:Dr})]}),f?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Doc Type"}),l.jsxs("select",{value:((k=a.iterate_over)==null?void 0:k.doc_type)||"",onChange:C=>p("doc_type",C.target.value),style:Dr,children:[l.jsx("option",{value:"",children:"-- Select --"}),r.map(C=>l.jsx("option",{value:C.doc_type_id,children:C.doc_type_id},C.doc_type_id))]})]}),l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Collection Field"}),l.jsx("input",{type:"text",value:((N=a.iterate_over)==null?void 0:N.collection_field)||"",onChange:C=>p("collection_field",C.target.value),style:Dr})]}),l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Entity Type"}),l.jsx("input",{type:"text",value:((E=a.iterate_over)==null?void 0:E.entity_type)||"",onChange:C=>p("entity_type",C.target.value),style:Dr})]})]}),l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Scope"}),l.jsx("input",{type:"text",value:a.scope||"",onChange:C=>h("scope",C.target.value),style:Dr})]}),l.jsxs("div",{className:"mt-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{style:ir,children:"Nested Steps"}),l.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),l.jsx(JW,{steps:a.steps||[],documentTypes:r,onStepChange:v,onStepDelete:x,onReorder:_})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Produces"}),l.jsxs("select",{value:a.produces||"",onChange:C=>h("produces",C.target.value),style:Dr,children:[l.jsx("option",{value:"",children:"-- Select document type --"}),r.map(C=>l.jsx("option",{value:C.doc_type_id,children:C.doc_type_id},C.doc_type_id))]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Scope"}),l.jsx("input",{type:"text",value:a.scope||"",onChange:C=>h("scope",C.target.value),placeholder:"project",style:Dr})]}),l.jsxs("div",{children:[l.jsx("label",{style:ir,children:"Creates Entities"}),l.jsx("input",{type:"text",value:a.creates_entities||"",onChange:C=>h("creates_entities",C.target.value||void 0),placeholder:"e.g., epic",style:Dr})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:ir,children:"Inputs"}),l.jsx("button",{onClick:y,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(a.inputs||[]).length===0?l.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):l.jsx("div",{className:"space-y-1",children:(a.inputs||[]).map((C,T)=>l.jsxs("div",{className:"flex gap-1 items-end",children:[l.jsxs("div",{style:{flex:1},children:[T===0&&l.jsx("label",{style:{...ir,fontSize:9},children:"Doc/Entity Type"}),l.jsxs("select",{value:C.doc_type||C.entity_type||"",onChange:R=>{const P=R.target.value;C.entity_type!==void 0?g(T,"entity_type",P):g(T,"doc_type",P)},style:{...Dr,fontSize:11},children:[l.jsx("option",{value:"",children:"-- Select --"}),r.map(R=>l.jsx("option",{value:R.doc_type_id,children:R.doc_type_id},R.doc_type_id))]})]}),l.jsxs("div",{style:{width:"30%"},children:[T===0&&l.jsx("label",{style:{...ir,fontSize:9},children:"Scope"}),l.jsx("input",{type:"text",value:C.scope||"",onChange:R=>g(T,"scope",R.target.value),placeholder:"scope",style:{...Dr,fontSize:11}})]}),l.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[l.jsx("input",{type:"checkbox",checked:C.context||!1,onChange:R=>g(T,"context",R.target.checked||void 0)}),"ctx"]}),l.jsx("button",{onClick:()=>w(T),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},T))})]})]})]})]})}function JW({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const o=kR(mc(hu,{activationConstraint:{distance:5}}),mc(pu,{coordinateGetter:KR})),s=m.useMemo(()=>e.map(c=>c.step_id),[e]),a=m.useCallback(c=>{const{active:u,over:d}=c;if(!d||u.id===d.id)return;const f=e.findIndex(p=>p.step_id===u.id),h=e.findIndex(p=>p.step_id===d.id);f!==-1&&h!==-1&&i(f,h)},[e,i]);return e.length===0?l.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):l.jsx($R,{sensors:o,collisionDetection:ER,onDragEnd:a,children:l.jsx(VR,{items:s,strategy:HR,children:e.map((c,u)=>l.jsx(eU,{step:c,index:u,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function eU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:o,listeners:s,setNodeRef:a,transform:c,transition:u,isDragging:d}=YR({id:e.step_id}),f={transform:No.Transform.toString(c),transition:u,opacity:d?.5:1};return l.jsx("div",{ref:a,style:f,children:l.jsx(ZR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...o,...s},depth:1})})}function tU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,i]=m.useState(""),o={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},s={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},a=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},u=Object.entries(c),d=e.document_types||{},f=Object.entries(d),h=e.pow_class||"reference",p=e.derived_from,y=e.source_version,g=e.tags||[],w=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),i(""))},v=b=>{t==null||t({...e,tags:g.filter(_=>_!==b)})},x=()=>{p!=null&&p.workflow_id&&r&&r(p.workflow_id)};return l.jsxs("div",{className:"space-y-4 max-w-lg",children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),l.jsxs("div",{children:[l.jsx("label",{style:s,children:"POW Class"}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:h==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:h==="reference"?"#000":"var(--text-primary)"},children:h})})]}),p&&l.jsxs("div",{children:[l.jsx("label",{style:s,children:"Derived From"}),l.jsx("div",{style:o,children:r?l.jsxs("button",{onClick:x,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[p.workflow_id," v",p.version]}):l.jsxs("span",{children:[p.workflow_id," v",p.version]})})]}),y&&l.jsxs("div",{children:[l.jsx("label",{style:s,children:"Source Version"}),l.jsx("div",{style:o,children:y})]}),l.jsxs("div",{children:[l.jsx("label",{style:s,children:"Tags"}),l.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>l.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&l.jsx("button",{onClick:()=>v(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"text",value:n,onChange:b=>i(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),w())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),l.jsx("button",{onClick:w,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),a.map(b=>l.jsxs("div",{children:[l.jsx("label",{style:s,children:b.label}),l.jsx("div",{style:o,children:e[b.key]||"-"})]},b.key)),u.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),u.map(([b,_])=>l.jsxs("div",{children:[l.jsx("label",{style:s,children:b}),l.jsxs("div",{style:o,children:["parent: ",_.parent||"none"]})]},b))]}),f.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,_])=>l.jsxs("div",{children:[l.jsx("label",{style:s,children:b}),l.jsxs("div",{style:o,children:[_.name,_.scope&&` (${_.scope})`,_.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function bk({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(i=>i.status==="fail"),n=e.filter(i=>i.status==="pass");return t?l.jsx("div",{className:"flex items-center gap-2",children:r.length>0?l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):l.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):l.jsxs("div",{className:"space-y-2",children:[r.map((i,o)=>l.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[l.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[l.jsx("span",{className:"text-red-400",children:"FAIL"}),l.jsx("span",{className:"font-mono",children:i.rule_id})]}),i.message&&l.jsx("div",{className:"mt-1 opacity-80",children:i.message}),i.artifact_id&&l.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:i.artifact_id})]},o)),n.length>0&&r.length>0&&l.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function rU(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),i=[];let o=0,s=0;for(;o<r.length||s<n.length;)if(o>=r.length)i.push({type:"added",line:n[s],lineNum:s+1}),s++;else if(s>=n.length)i.push({type:"removed",line:r[o],lineNum:o+1}),o++;else if(r[o]===n[s])i.push({type:"same",line:r[o],oldLineNum:o+1,newLineNum:s+1}),o++,s++;else{let a=n.slice(s,s+5).indexOf(r[o]),c=r.slice(o,o+5).indexOf(n[s]);if(a!==-1&&(c===-1||a<=c)){for(let u=0;u<a;u++)i.push({type:"added",line:n[s+u],lineNum:s+u+1});s+=a}else if(c!==-1){for(let u=0;u<c;u++)i.push({type:"removed",line:r[o+u],lineNum:o+u+1});o+=c}else i.push({type:"removed",line:r[o],lineNum:o+1}),i.push({type:"added",line:n[s],lineNum:s+1}),o++,s++}return i}function nU({diff:e}){const[t,r]=m.useState(!0),n=rU(e.old_content,e.new_content),i={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return l.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:i[e.status]||i.M,children:e.status}),l.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),l.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&l.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:l.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((o,s)=>l.jsxs("div",{className:"flex",style:{background:o.type==="added"?"rgba(34, 197, 94, 0.1)":o.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:o.type==="added"?"3px solid #22c55e":o.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[l.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:o.type==="same"?o.oldLineNum:o.lineNum||""}),l.jsx("span",{className:"select-none px-1",style:{color:o.type==="added"?"#22c55e":o.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:o.type==="added"?"+":o.type==="removed"?"-":" "}),l.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:o.line})]},s))})})]})}function iU({workspaceId:e,artifactId:t=null,onClose:r}){const[n,i]=m.useState([]),[o,s]=m.useState(!0),[a,c]=m.useState(null);m.useEffect(()=>{e&&(s(!0),c(null),ye.getDiff(e,t).then(d=>{i(d.diffs||[])}).catch(d=>{c(d.message)}).finally(()=>{s(!1)}))},[e,t]);const u=d=>{d.key==="Escape"&&(r==null||r())};return l.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:d=>d.target===d.currentTarget&&(r==null?void 0:r()),onKeyDown:u,tabIndex:0,children:l.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),l.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o?l.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):a?l.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",a]}):n.length===0?l.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((d,f)=>l.jsx(nU,{diff:d},d.artifact_id||f))}),l.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function oU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,i,o]=t,s=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),a=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:i,kind:o,displayName:s,kindLabel:a,display:`${s} - ${a}`}}function sU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=oU(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function aU({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:i=[],modifiedFiles:o=[]}){const[s,a]=m.useState(""),[c,u]=m.useState(!1),d=sU(i),f=i.length,h=y=>{y.preventDefault(),s.trim()&&!n&&t(s.trim())},p=y=>{y.key==="Escape"&&!n&&r()};return l.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:y=>y.target===y.currentTarget&&!n&&r(),onKeyDown:p,children:[l.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&l.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),l.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:d.map(y=>l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:y.label}),l.jsx("div",{className:"space-y-1",children:y.items.map((g,w)=>l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),l.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),l.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),l.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},w))})]},y.scope))}),l.jsx("button",{type:"button",onClick:()=>u(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),l.jsxs("form",{onSubmit:h,children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),l.jsx("textarea",{value:s,onChange:y=>a(y.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),l.jsx("button",{type:"submit",disabled:!s.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:s.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:s.trim()&&!n?"#000":"var(--text-muted)",cursor:s.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&l.jsx(iU,{workspaceId:e,onClose:()=>u(!1)})]})}function lU(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,i,o]=t,s=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),a=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:s,kind:o,kindLabel:a,version:i,display:`${s} - ${a}`}}function cU({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:i,onClose:o,onRefresh:s}){var C,T;const[a,c]=m.useState(!1),[u,d]=m.useState(!1),[f,h]=m.useState(!1),[p,y]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,w=(t==null?void 0:t.modified_artifacts)??[],v=((C=t==null?void 0:t.tier1)==null?void 0:C.passed)??!0,x=((T=t==null?void 0:t.tier1)==null?void 0:T.results)??[],b=(t==null?void 0:t.branch)??"",_=t!=null&&t.expires_at?new Date(t.expires_at):null,j=async R=>{d(!0),y(null);try{const P=await ye.commit(e,R);c(!1),n==null||n(P),s==null||s()}catch(P){y(P.message)}finally{d(!1)}},k=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){h(!0);try{await ye.discard(e),i==null||i(),s==null||s()}catch(R){console.error("Discard failed:",R),alert("Failed to discard changes: "+R.message)}finally{h(!1)}}},N=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await ye.closeWorkspace(e),o==null||o()}catch(R){console.error("Close failed:",R),alert("Failed to close workspace: "+R.message)}},E=R=>{if(!R)return null;const F=R-new Date;if(F<=0)return"Expired";const S=Math.floor(F/(1e3*60*60)),A=Math.floor(F%(1e3*60*60)/(1e3*60));return S>0?`${S}h ${A}m remaining`:`${A}m remaining`};return l.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:l.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?l.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),l.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),_&&l.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:E(_)})]}),l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),l.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),w.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",w.length,")"]}),l.jsx("div",{className:"space-y-1",children:w.map(R=>{const P=lU(R);return l.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:R,children:[l.jsx("span",{style:{color:"var(--text-primary)"},children:P.displayName||R}),P.kindLabel&&l.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",P.kindLabel]})]},R)})})]})]}),l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),l.jsx(bk,{results:x,compact:!0})]}),x.length>0&&!v&&l.jsx("div",{className:"mt-3",children:l.jsx(bk,{results:x})})]})]}),l.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[l.jsx("button",{onClick:()=>c(!0),disabled:!g||!v||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&v?"var(--action-success)":"var(--border-panel)",color:g&&v?"#000":"var(--text-muted)",cursor:g&&v&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!v&&g&&l.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&l.jsx("button",{onClick:k,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&l.jsx("button",{onClick:N,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),a&&l.jsx(aU,{workspaceId:e,onCommit:j,onCancel:()=>{c(!1),y(null)},loading:u,modifiedArtifacts:w,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),p&&l.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:p})]})}function uU(){const{isAdmin:e,loading:t}=Do(),[r,n]=m.useState(null),[i,o]=m.useState(null),[s,a]=m.useState(!1),[c,u]=m.useState(null),[d,f]=m.useState(null),[h,p]=m.useState(null),[y,g]=m.useState(null),[w,v]=m.useState(null),[x,b]=m.useState(null),[_,j]=m.useState(null),{workspaceId:k,loading:N,error:E,reinitialize:C}=q$(),{state:T,loading:R,refresh:P}=$$(k),{documentTypes:F,loading:S,refresh:A}=B$(),{roles:M,loading:z,refresh:D}=H$(),{templates:I,loading:L,refresh:O}=E4(),{workflows:q,loading:B,refresh:$}=pB(),{fragments:V,loading:X,kindOptions:ne,refresh:te}=T4(),{schemas:ae,loading:Q,refresh:we}=R4(),se=m.useCallback(async(ie,ee=null,$e="docworkflow")=>{if(n(ie),u(null),f(null),p(null),o(null),b(ee),j($e),!!ie){a(!0);try{const gr=await ye.getDocumentType(ie.doc_type_id);o(gr)}catch(gr){console.error("Failed to load doc type details:",gr),o(ie)}finally{a(!1)}}},[]),Te=m.useCallback(ie=>{se(ie,"task_prompt","task")},[se]),ue=m.useCallback(ie=>{se(ie,"schema","schema")},[se]),Z=m.useCallback(ie=>{u(ie),n(null),o(null),f(null),p(null),g(null),v(null)},[]),xe=m.useCallback(ie=>{f(ie),n(null),o(null),u(null),p(null),g(null),v(null)},[]),U=m.useCallback(ie=>{p(ie),n(null),o(null),u(null),f(null),g(null),v(null)},[]),Y=m.useCallback(ie=>{g(ie),n(null),o(null),u(null),f(null),p(null),v(null)},[]),ce=m.useCallback(ie=>{v(ie),n(null),o(null),u(null),f(null),p(null),g(null)},[]),pe=m.useCallback(ie=>{const ee=q.find($e=>$e.workflow_id===ie);ee&&U(ee)},[q,U]),ke=m.useCallback((ie,ee)=>{P()},[P]),ge=m.useCallback(ie=>{console.log("Committed:",ie.commit_hash)},[]),de=m.useCallback(()=>{n(null),o(null),u(null),f(null),p(null)},[]),_e=m.useCallback(async ie=>{if(k)try{const ee=await ye.createOrchestrationWorkflow(k,ie);await $(),P(),p({workflow_id:ee.workflow_id,active_version:ee.version,name:ie.name||ee.workflow_id.replace(/_/g," ").replace(/\b\w/g,$e=>$e.toUpperCase())}),n(null),o(null),u(null),f(null)}catch(ee){console.error("Failed to create workflow:",ee),alert(`Failed to create workflow: ${ee.message}`)}},[k,$,P]),Ve=m.useCallback(async ie=>{if(k)try{await ye.deleteOrchestrationWorkflow(k,ie),await $(),P(),p(null)}catch(ee){console.error("Failed to delete workflow:",ee),alert(`Failed to delete workflow: ${ee.message}`)}},[k,$,P]),Ce=m.useCallback(async ie=>{if(k)try{const ee=await ye.createDocumentType(k,ie);await A(),P(),se({doc_type_id:ee.doc_type_id,display_name:ie.display_name||ee.doc_type_id.replace(/_/g," ").replace(/\b\w/g,$e=>$e.toUpperCase()),active_version:ee.version})}catch(ee){console.error("Failed to create document type:",ee),alert(`Failed to create document type: ${ee.message}`)}},[k,A,P,se]);m.useCallback(async ie=>{if(k)try{await ye.deleteDocumentType(k,ie),await A(),P(),n(null),o(null)}catch(ee){console.error("Failed to delete document type:",ee),alert(`Failed to delete document type: ${ee.message}`)}},[k,A,P]);const Le=m.useCallback(async ie=>{if(k)try{await ye.createDcwWorkflow(k,{doc_type_id:ie}),await $(),P()}catch(ee){console.error("Failed to create DCW workflow:",ee),alert(`Failed to create workflow: ${ee.message}`)}},[k,$,P]),Oe=m.useCallback(async ie=>{if(k)try{const ee=await ye.createRolePrompt(k,ie);await te(),await D(),P(),Y({fragment_id:`role:${ee.role_id}`,kind:"role",version:ee.version,name:ie.name||ee.role_id.replace(/_/g," ").replace(/\b\w/g,$e=>$e.toUpperCase())})}catch(ee){console.error("Failed to create role prompt:",ee),alert(`Failed to create role prompt: ${ee.message}`)}},[k,te,D,P,Y]),Ge=m.useCallback(async ie=>{if(k)try{const ee=await ye.createTemplate(k,ie);await O(),P(),xe({template_id:ee.template_id,active_version:ee.version,name:ie.name||ee.template_id.replace(/_/g," ").replace(/\b\w/g,$e=>$e.toUpperCase())})}catch(ee){console.error("Failed to create template:",ee),alert(`Failed to create template: ${ee.message}`)}},[k,O,P,xe]),G=m.useCallback(async ie=>{if(k)try{const ee=await ye.createStandaloneSchema(k,ie);await we(),P(),ce({schema_id:ee.schema_id,active_version:ee.version,title:ie.title||ee.schema_id.replace(/_/g," ").replace(/\b\w/g,$e=>$e.toUpperCase())})}catch(ee){console.error("Failed to create schema:",ee),alert(`Failed to create schema: ${ee.message}`)}},[k,we,P,ce]),he=m.useCallback(()=>{C(),n(null),o(null),u(null),f(null),p(null)},[C]);if(t)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),l.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(N)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),l.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(E)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),l.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:E}),l.jsx("button",{onClick:C,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const le=c&&!r&&!d&&!h&&!y,Ye=d&&!r&&!c&&!h&&!y,Je=h&&!r&&!c&&!d&&!y,xt=y&&!r&&!c&&!d&&!h;return l.jsxs("div",{className:"flex h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx(mB,{documentTypes:F,roles:M,templates:I,workflows:q,promptFragments:V,promptFragmentKindOptions:ne,schemas:ae,loading:S,rolesLoading:z,templatesLoading:L,workflowsLoading:B,promptFragmentsLoading:X,schemasLoading:Q,selectedDocType:r,docTypeSource:_,selectedRole:c,selectedTemplate:d,selectedWorkflow:h,selectedFragment:y,selectedSchema:w,onSelectDocType:se,onSelectRole:Z,onSelectTemplate:xe,onSelectWorkflow:U,onSelectFragment:Y,onSelectStandaloneSchema:ce,onCreateWorkflow:_e,onCreateDocType:Ce,onCreateFragment:Oe,onCreateTemplate:Ge,onCreateSchema:G,onSelectTask:Te,onSelectSchema:ue,workspaceState:T}),le?l.jsx(HB,{workspaceId:k,role:c,onArtifactSave:ke}):Ye?l.jsx(u7,{workspaceId:k,template:d,onArtifactSave:ke}):xt?l.jsx(p7,{workspaceId:k,fragment:y,onArtifactSave:ke}):Je?l.jsx(XW,{workspaceId:k,workflow:h,documentTypes:F,onArtifactSave:ke,onDelete:Ve,onNavigateToWorkflow:pe}):l.jsx(BB,{workspaceId:k,docType:i,loading:s,roles:M,workflows:q,onArtifactSave:ke,onCreateDcwWorkflow:Le,initialTab:x,docTypeSource:_}),l.jsx(cU,{workspaceId:k,state:T,loading:R,onCommit:ge,onDiscard:de,onClose:he,onRefresh:P})]})}function dU({user:e,onClick:t}){return l.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?l.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):l.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),l.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[l.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function fU(){var R,P,F;const{user:e}=Do(),[t,r]=m.useState(!1),{projects:n,loading:i,error:o,refresh:s}=D$({includeArchived:t}),[a,c]=m.useState(null),[u,d]=m.useState(null),[f,h]=m.useState(!1),[p,y]=m.useState(!1),{theme:g,setTheme:w}=C4(),v=Object.keys(n),x=a&&n[a]?a:v[0]||null;m.useEffect(()=>{if(x&&n[x]){const S=n[x];document.title=`${S.projectId} - The Combine`}else document.title="The Combine"},[x,n]);const b=S=>{c(S),d(null)},_=()=>{h(!0)},j=async S=>{await s(),S&&S.id&&(c(S.id),d("concierge_intake")),h(!1)},k=()=>{h(!1)},N=async(S,A)=>{try{await He.updateProject(S,A),await s()}catch(M){throw console.error("Failed to update project:",M),M}},E=async S=>{try{if(await He.archiveProject(S),!t){const A=Object.values(n).sort((D,I)=>{const L=(D.name||"").localeCompare(I.name||"");return L!==0?L:(D.projectId||"").localeCompare(I.projectId||"")}),M=A.findIndex(D=>D.id===S),z=A[M+1]||A[M-1]||null;c((z==null?void 0:z.id)||null)}await s()}catch(A){throw console.error("Failed to archive project:",A),A}},C=async S=>{try{await He.unarchiveProject(S),await s()}catch(A){throw console.error("Failed to unarchive project:",A),A}},T=async S=>{try{await He.deleteProject(S);const A=Object.values(n).sort((D,I)=>{const L=(D.name||"").localeCompare(I.name||"");return L!==0?L:(D.projectId||"").localeCompare(I.projectId||"")}),M=A.findIndex(D=>D.id===S),z=A[M+1]||A[M-1]||null;c((z==null?void 0:z.id)||null),await s()}catch(A){throw console.error("Failed to delete project:",A),A}};return i?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):o?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[l.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",o]}),l.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):l.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[l.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),l.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),l.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),l.jsx("path",{d:"M12 17h.01"})]})})]}),l.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[l.jsx(VD,{projects:n,selectedId:x,onSelectProject:b,onNewProject:_,showArchived:t,onToggleShowArchived:()=>r(S=>!S),userSection:l.jsx(dU,{user:e,onClick:()=>y(!0)})}),l.jsx("div",{className:"flex-1",children:x?l.jsx(Hc,{children:l.jsx(V$,{projectId:x,projectCode:(R=n[x])==null?void 0:R.projectId,projectName:(P=n[x])==null?void 0:P.name,isArchived:(F=n[x])==null?void 0:F.isArchived,autoExpandNodeId:u,theme:g,onThemeChange:w,onProjectUpdate:N,onProjectArchive:E,onProjectUnarchive:C,onProjectDelete:T})},x):l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsx("div",{className:"text-center",children:l.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&l.jsx(eB,{onClose:k,onComplete:j}),p&&l.jsx(tB,{onClose:()=>y(!1)})]})]})}function pU(){const{isAuthenticated:e,loading:t}=Do(),{theme:r}=C4(),[n,i]=m.useState(window.location.pathname);return m.useEffect(()=>{const o=()=>i(window.location.pathname);return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),t?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?l.jsx("div",{className:`h-screen theme-${r}`,children:l.jsx(uU,{})}):l.jsx(fU,{}):n==="/learn"?l.jsx(fB,{}):l.jsx(lB,{})}function hU(){return l.jsx(z$,{children:l.jsx(pU,{})})}hg.createRoot(document.getElementById("root")).render(l.jsx(W.StrictMode,{children:l.jsx(hU,{})}));
//# sourceMappingURL=index-DsAzab4_.js.map
