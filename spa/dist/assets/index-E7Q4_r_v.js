(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var OS={exports:{}},Cc={},DS={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pa=Symbol.for("react.element"),AR=Symbol.for("react.portal"),IR=Symbol.for("react.fragment"),MR=Symbol.for("react.strict_mode"),PR=Symbol.for("react.profiler"),OR=Symbol.for("react.provider"),DR=Symbol.for("react.context"),LR=Symbol.for("react.forward_ref"),FR=Symbol.for("react.suspense"),zR=Symbol.for("react.memo"),qR=Symbol.for("react.lazy"),Fy=Symbol.iterator;function $R(e){return e===null||typeof e!="object"?null:(e=Fy&&e[Fy]||e["@@iterator"],typeof e=="function"?e:null)}var LS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},FS=Object.assign,zS={};function Ts(e,t,r){this.props=e,this.context=t,this.refs=zS,this.updater=r||LS}Ts.prototype.isReactComponent={};Ts.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ts.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qS(){}qS.prototype=Ts.prototype;function Ug(e,t,r){this.props=e,this.context=t,this.refs=zS,this.updater=r||LS}var Vg=Ug.prototype=new qS;Vg.constructor=Ug;FS(Vg,Ts.prototype);Vg.isPureReactComponent=!0;var zy=Array.isArray,$S=Object.prototype.hasOwnProperty,Gg={current:null},BS={key:!0,ref:!0,__self:!0,__source:!0};function HS(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)$S.call(t,n)&&!BS.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:pa,type:e,key:s,ref:o,props:i,_owner:Gg.current}}function BR(e,t){return{$$typeof:pa,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Kg(e){return typeof e=="object"&&e!==null&&e.$$typeof===pa}function HR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var qy=/\/+/g;function Cu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?HR(""+e.key):t.toString(36)}function ml(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case pa:case AR:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+Cu(o,0):n,zy(i)?(r="",e!=null&&(r=e.replace(qy,"$&/")+"/"),ml(i,t,r,"",function(d){return d})):i!=null&&(Kg(i)&&(i=BR(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(qy,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",zy(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+Cu(s,l);o+=ml(s,t,r,c,i)}else if(c=$R(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+Cu(s,l++),o+=ml(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Aa(e,t,r){if(e==null)return e;var n=[],i=0;return ml(e,n,"","",function(s){return t.call(r,s,i++)}),n}function WR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ft={current:null},vl={transition:null},UR={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:vl,ReactCurrentOwner:Gg};function WS(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Aa,forEach:function(e,t,r){Aa(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Aa(e,function(){t++}),t},toArray:function(e){return Aa(e,function(t){return t})||[]},only:function(e){if(!Kg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Ts;Ce.Fragment=IR;Ce.Profiler=PR;Ce.PureComponent=Ug;Ce.StrictMode=MR;Ce.Suspense=FR;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UR;Ce.act=WS;Ce.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=FS({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Gg.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)$S.call(t,c)&&!BS.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:pa,type:e.type,key:i,ref:s,props:n,_owner:o}};Ce.createContext=function(e){return e={$$typeof:DR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:OR,_context:e},e.Consumer=e};Ce.createElement=HS;Ce.createFactory=function(e){var t=HS.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:LR,render:e}};Ce.isValidElement=Kg;Ce.lazy=function(e){return{$$typeof:qR,_payload:{_status:-1,_result:e},_init:WR}};Ce.memo=function(e,t){return{$$typeof:zR,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=vl.transition;vl.transition={};try{e()}finally{vl.transition=t}};Ce.unstable_act=WS;Ce.useCallback=function(e,t){return Ft.current.useCallback(e,t)};Ce.useContext=function(e){return Ft.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Ft.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Ft.current.useEffect(e,t)};Ce.useId=function(){return Ft.current.useId()};Ce.useImperativeHandle=function(e,t,r){return Ft.current.useImperativeHandle(e,t,r)};Ce.useInsertionEffect=function(e,t){return Ft.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Ft.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Ft.current.useMemo(e,t)};Ce.useReducer=function(e,t,r){return Ft.current.useReducer(e,t,r)};Ce.useRef=function(e){return Ft.current.useRef(e)};Ce.useState=function(e){return Ft.current.useState(e)};Ce.useSyncExternalStore=function(e,t,r){return Ft.current.useSyncExternalStore(e,t,r)};Ce.useTransition=function(){return Ft.current.useTransition()};Ce.version="18.3.1";DS.exports=Ce;var m=DS.exports;const V=Wg(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VR=m,GR=Symbol.for("react.element"),KR=Symbol.for("react.fragment"),YR=Object.prototype.hasOwnProperty,XR=VR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QR={key:!0,ref:!0,__self:!0,__source:!0};function US(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)YR.call(t,n)&&!QR.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:GR,type:e,key:s,ref:o,props:i,_owner:XR.current}}Cc.Fragment=KR;Cc.jsx=US;Cc.jsxs=US;OS.exports=Cc;var a=OS.exports,wv={},VS={exports:{}},sr={},GS={exports:{}},KS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,A){var L=M.length;M.push(A);e:for(;0<L;){var z=L-1>>>1,B=M[z];if(0<i(B,A))M[z]=A,M[L]=B,L=z;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var A=M[0],L=M.pop();if(L!==A){M[0]=L;e:for(var z=0,B=M.length,X=B>>>1;z<X;){var Y=2*(z+1)-1,W=M[Y],$=Y+1,Q=M[$];if(0>i(W,L))$<B&&0>i(Q,W)?(M[z]=Q,M[$]=L,z=$):(M[z]=W,M[Y]=L,z=Y);else if($<B&&0>i(Q,L))M[z]=Q,M[$]=L,z=$;else break e}}return A}function i(M,A){var L=M.sortIndex-A.sortIndex;return L!==0?L:M.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,x=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var A=r(d);A!==null;){if(A.callback===null)n(d);else if(A.startTime<=M)n(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=r(d)}}function w(M){if(v=!1,b(M),!x)if(r(c)!==null)x=!0,I(S);else{var A=r(d);A!==null&&F(w,A.startTime-M)}}function S(M,A){x=!1,v&&(v=!1,g(E),E=-1),h=!0;var L=p;try{for(b(A),f=r(c);f!==null&&(!(f.expirationTime>A)||M&&!T());){var z=f.callback;if(typeof z=="function"){f.callback=null,p=f.priorityLevel;var B=z(f.expirationTime<=A);A=e.unstable_now(),typeof B=="function"?f.callback=B:f===r(c)&&n(c),b(A)}else n(c);f=r(c)}if(f!==null)var X=!0;else{var Y=r(d);Y!==null&&F(w,Y.startTime-A),X=!1}return X}finally{f=null,p=L,h=!1}}var k=!1,N=null,E=-1,j=5,R=-1;function T(){return!(e.unstable_now()-R<j)}function D(){if(N!==null){var M=e.unstable_now();R=M;var A=!0;try{A=N(!0,M)}finally{A?q():(k=!1,N=null)}}else k=!1}var q;if(typeof y=="function")q=function(){y(D)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,O=C.port2;C.port1.onmessage=D,q=function(){O.postMessage(null)}}else q=function(){_(D,0)};function I(M){N=M,k||(k=!0,q())}function F(M,A){E=_(function(){M(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){x||h||(x=!0,I(S))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(M){switch(p){case 1:case 2:case 3:var A=3;break;default:A=p}var L=p;p=A;try{return M()}finally{p=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,A){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var L=p;p=M;try{return A()}finally{p=L}},e.unstable_scheduleCallback=function(M,A,L){var z=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?z+L:z):L=z,M){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=L+B,M={id:u++,callback:A,priorityLevel:M,startTime:L,expirationTime:B,sortIndex:-1},L>z?(M.sortIndex=L,t(d,M),r(c)===null&&M===r(d)&&(v?(g(E),E=-1):v=!0,F(w,L-z))):(M.sortIndex=B,t(c,M),x||h||(x=!0,I(S))),M},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(M){var A=p;return function(){var L=p;p=A;try{return M.apply(this,arguments)}finally{p=L}}}})(KS);GS.exports=KS;var ZR=GS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JR=m,nr=ZR;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YS=new Set,Oo={};function Ci(e,t){vs(e,t),vs(e+"Capture",t)}function vs(e,t){for(Oo[e]=t,e=0;e<t.length;e++)YS.add(t[e])}var cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jv=Object.prototype.hasOwnProperty,eA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$y={},By={};function tA(e){return jv.call(By,e)?!0:jv.call($y,e)?!1:eA.test(e)?By[e]=!0:($y[e]=!0,!1)}function rA(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function nA(e,t,r,n){if(t===null||typeof t>"u"||rA(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zt(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){kt[e]=new zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];kt[t]=new zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){kt[e]=new zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){kt[e]=new zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){kt[e]=new zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){kt[e]=new zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){kt[e]=new zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){kt[e]=new zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){kt[e]=new zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Yg=/[\-:]([a-z])/g;function Xg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Yg,Xg);kt[t]=new zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Yg,Xg);kt[t]=new zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Yg,Xg);kt[t]=new zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){kt[e]=new zt(e,1,!1,e.toLowerCase(),null,!1,!1)});kt.xlinkHref=new zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){kt[e]=new zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Qg(e,t,r,n){var i=kt.hasOwnProperty(t)?kt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(nA(t,r,i,n)&&(r=null),n||i===null?tA(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var gn=JR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ia=Symbol.for("react.element"),Wi=Symbol.for("react.portal"),Ui=Symbol.for("react.fragment"),Zg=Symbol.for("react.strict_mode"),Sv=Symbol.for("react.profiler"),XS=Symbol.for("react.provider"),QS=Symbol.for("react.context"),Jg=Symbol.for("react.forward_ref"),kv=Symbol.for("react.suspense"),Nv=Symbol.for("react.suspense_list"),ex=Symbol.for("react.memo"),jn=Symbol.for("react.lazy"),ZS=Symbol.for("react.offscreen"),Hy=Symbol.iterator;function Bs(e){return e===null||typeof e!="object"?null:(e=Hy&&e[Hy]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Eu;function lo(e){if(Eu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Eu=t&&t[1]||""}return`
`+Eu+e}var Tu=!1;function Ru(e,t){if(!e||Tu)return"";Tu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Tu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?lo(e):""}function iA(e){switch(e.tag){case 5:return lo(e.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return e=Ru(e.type,!1),e;case 11:return e=Ru(e.type.render,!1),e;case 1:return e=Ru(e.type,!0),e;default:return""}}function Cv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ui:return"Fragment";case Wi:return"Portal";case Sv:return"Profiler";case Zg:return"StrictMode";case kv:return"Suspense";case Nv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case QS:return(e.displayName||"Context")+".Consumer";case XS:return(e._context.displayName||"Context")+".Provider";case Jg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ex:return t=e.displayName||null,t!==null?t:Cv(e.type)||"Memo";case jn:t=e._payload,e=e._init;try{return Cv(e(t))}catch{}}return null}function sA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cv(t);case 8:return t===Zg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function JS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function oA(e){var t=JS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ma(e){e._valueTracker||(e._valueTracker=oA(e))}function ek(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=JS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Il(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ev(e,t){var r=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Wy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Gn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tk(e,t){t=t.checked,t!=null&&Qg(e,"checked",t,!1)}function Tv(e,t){tk(e,t);var r=Gn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Rv(e,t.type,r):t.hasOwnProperty("defaultValue")&&Rv(e,t.type,Gn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Uy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Rv(e,t,r){(t!=="number"||Il(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var co=Array.isArray;function os(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Gn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Av(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(te(92));if(co(r)){if(1<r.length)throw Error(te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Gn(r)}}function rk(e,t){var r=Gn(t.value),n=Gn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Gy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function nk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Iv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?nk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Pa,ik=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Pa=Pa||document.createElement("div"),Pa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Pa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Do(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var wo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aA=["Webkit","ms","Moz","O"];Object.keys(wo).forEach(function(e){aA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),wo[t]=wo[e]})});function sk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||wo.hasOwnProperty(e)&&wo[e]?(""+t).trim():t+"px"}function ok(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=sk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var lA=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mv(e,t){if(t){if(lA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function Pv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ov=null;function tx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Dv=null,as=null,ls=null;function Ky(e){if(e=va(e)){if(typeof Dv!="function")throw Error(te(280));var t=e.stateNode;t&&(t=Ic(t),Dv(e.stateNode,e.type,t))}}function ak(e){as?ls?ls.push(e):ls=[e]:as=e}function lk(){if(as){var e=as,t=ls;if(ls=as=null,Ky(e),t)for(e=0;e<t.length;e++)Ky(t[e])}}function ck(e,t){return e(t)}function uk(){}var Au=!1;function dk(e,t,r){if(Au)return e(t,r);Au=!0;try{return ck(e,t,r)}finally{Au=!1,(as!==null||ls!==null)&&(uk(),lk())}}function Lo(e,t){var r=e.stateNode;if(r===null)return null;var n=Ic(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,t,typeof r));return r}var Lv=!1;if(cn)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){Lv=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{Lv=!1}function cA(e,t,r,n,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var jo=!1,Ml=null,Pl=!1,Fv=null,uA={onError:function(e){jo=!0,Ml=e}};function dA(e,t,r,n,i,s,o,l,c){jo=!1,Ml=null,cA.apply(uA,arguments)}function fA(e,t,r,n,i,s,o,l,c){if(dA.apply(this,arguments),jo){if(jo){var d=Ml;jo=!1,Ml=null}else throw Error(te(198));Pl||(Pl=!0,Fv=d)}}function Ei(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Yy(e){if(Ei(e)!==e)throw Error(te(188))}function pA(e){var t=e.alternate;if(!t){if(t=Ei(e),t===null)throw Error(te(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Yy(i),e;if(s===n)return Yy(i),t;s=s.sibling}throw Error(te(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(te(189))}}if(r.alternate!==n)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:t}function pk(e){return e=pA(e),e!==null?hk(e):null}function hk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hk(e);if(t!==null)return t;e=e.sibling}return null}var mk=nr.unstable_scheduleCallback,Xy=nr.unstable_cancelCallback,hA=nr.unstable_shouldYield,mA=nr.unstable_requestPaint,nt=nr.unstable_now,vA=nr.unstable_getCurrentPriorityLevel,rx=nr.unstable_ImmediatePriority,vk=nr.unstable_UserBlockingPriority,Ol=nr.unstable_NormalPriority,gA=nr.unstable_LowPriority,gk=nr.unstable_IdlePriority,Ec=null,$r=null;function xA(e){if($r&&typeof $r.onCommitFiberRoot=="function")try{$r.onCommitFiberRoot(Ec,e,void 0,(e.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:_A,yA=Math.log,bA=Math.LN2;function _A(e){return e>>>=0,e===0?32:31-(yA(e)/bA|0)|0}var Oa=64,Da=4194304;function uo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Dl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=uo(l):(s&=o,s!==0&&(n=uo(s)))}else o=r&~i,o!==0?n=uo(o):s!==0&&(n=uo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Er(t),i=1<<r,n|=e[r],t&=~i;return n}function wA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jA(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Er(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=wA(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function zv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xk(){var e=Oa;return Oa<<=1,!(Oa&4194240)&&(Oa=64),e}function Iu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ha(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Er(t),e[t]=r}function SA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Er(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function nx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Er(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var qe=0;function yk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bk,ix,_k,wk,jk,qv=!1,La=[],On=null,Dn=null,Ln=null,Fo=new Map,zo=new Map,En=[],kA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qy(e,t){switch(e){case"focusin":case"focusout":On=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":Fo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zo.delete(t.pointerId)}}function Ws(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=va(t),t!==null&&ix(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function NA(e,t,r,n,i){switch(t){case"focusin":return On=Ws(On,e,t,r,n,i),!0;case"dragenter":return Dn=Ws(Dn,e,t,r,n,i),!0;case"mouseover":return Ln=Ws(Ln,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Fo.set(s,Ws(Fo.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,zo.set(s,Ws(zo.get(s)||null,e,t,r,n,i)),!0}return!1}function Sk(e){var t=ci(e.target);if(t!==null){var r=Ei(t);if(r!==null){if(t=r.tag,t===13){if(t=fk(r),t!==null){e.blockedOn=t,jk(e.priority,function(){_k(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=$v(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ov=n,r.target.dispatchEvent(n),Ov=null}else return t=va(r),t!==null&&ix(t),e.blockedOn=r,!1;t.shift()}return!0}function Zy(e,t,r){gl(e)&&r.delete(t)}function CA(){qv=!1,On!==null&&gl(On)&&(On=null),Dn!==null&&gl(Dn)&&(Dn=null),Ln!==null&&gl(Ln)&&(Ln=null),Fo.forEach(Zy),zo.forEach(Zy)}function Us(e,t){e.blockedOn===t&&(e.blockedOn=null,qv||(qv=!0,nr.unstable_scheduleCallback(nr.unstable_NormalPriority,CA)))}function qo(e){function t(i){return Us(i,e)}if(0<La.length){Us(La[0],e);for(var r=1;r<La.length;r++){var n=La[r];n.blockedOn===e&&(n.blockedOn=null)}}for(On!==null&&Us(On,e),Dn!==null&&Us(Dn,e),Ln!==null&&Us(Ln,e),Fo.forEach(t),zo.forEach(t),r=0;r<En.length;r++)n=En[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<En.length&&(r=En[0],r.blockedOn===null);)Sk(r),r.blockedOn===null&&En.shift()}var cs=gn.ReactCurrentBatchConfig,Ll=!0;function EA(e,t,r,n){var i=qe,s=cs.transition;cs.transition=null;try{qe=1,sx(e,t,r,n)}finally{qe=i,cs.transition=s}}function TA(e,t,r,n){var i=qe,s=cs.transition;cs.transition=null;try{qe=4,sx(e,t,r,n)}finally{qe=i,cs.transition=s}}function sx(e,t,r,n){if(Ll){var i=$v(e,t,r,n);if(i===null)Bu(e,t,n,Fl,r),Qy(e,n);else if(NA(i,e,t,r,n))n.stopPropagation();else if(Qy(e,n),t&4&&-1<kA.indexOf(e)){for(;i!==null;){var s=va(i);if(s!==null&&bk(s),s=$v(e,t,r,n),s===null&&Bu(e,t,n,Fl,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Bu(e,t,n,null,r)}}var Fl=null;function $v(e,t,r,n){if(Fl=null,e=tx(n),e=ci(e),e!==null)if(t=Ei(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fl=e,null}function kk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vA()){case rx:return 1;case vk:return 4;case Ol:case gA:return 16;case gk:return 536870912;default:return 16}default:return 16}}var Mn=null,ox=null,xl=null;function Nk(){if(xl)return xl;var e,t=ox,r=t.length,n,i="value"in Mn?Mn.value:Mn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return xl=i.slice(e,1<n?1-n:void 0)}function yl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fa(){return!0}function Jy(){return!1}function or(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Fa:Jy,this.isPropagationStopped=Jy,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Fa)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Fa)},persist:function(){},isPersistent:Fa}),t}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ax=or(Rs),ma=et({},Rs,{view:0,detail:0}),RA=or(ma),Mu,Pu,Vs,Tc=et({},ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vs&&(Vs&&e.type==="mousemove"?(Mu=e.screenX-Vs.screenX,Pu=e.screenY-Vs.screenY):Pu=Mu=0,Vs=e),Mu)},movementY:function(e){return"movementY"in e?e.movementY:Pu}}),e0=or(Tc),AA=et({},Tc,{dataTransfer:0}),IA=or(AA),MA=et({},ma,{relatedTarget:0}),Ou=or(MA),PA=et({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),OA=or(PA),DA=et({},Rs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),LA=or(DA),FA=et({},Rs,{data:0}),t0=or(FA),zA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$A={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$A[e])?!!t[e]:!1}function lx(){return BA}var HA=et({},ma,{key:function(e){if(e.key){var t=zA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lx,charCode:function(e){return e.type==="keypress"?yl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),WA=or(HA),UA=et({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),r0=or(UA),VA=et({},ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lx}),GA=or(VA),KA=et({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),YA=or(KA),XA=et({},Tc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),QA=or(XA),ZA=[9,13,27,32],cx=cn&&"CompositionEvent"in window,So=null;cn&&"documentMode"in document&&(So=document.documentMode);var JA=cn&&"TextEvent"in window&&!So,Ck=cn&&(!cx||So&&8<So&&11>=So),n0=" ",i0=!1;function Ek(e,t){switch(e){case"keyup":return ZA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vi=!1;function e3(e,t){switch(e){case"compositionend":return Tk(t);case"keypress":return t.which!==32?null:(i0=!0,n0);case"textInput":return e=t.data,e===n0&&i0?null:e;default:return null}}function t3(e,t){if(Vi)return e==="compositionend"||!cx&&Ek(e,t)?(e=Nk(),xl=ox=Mn=null,Vi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ck&&t.locale!=="ko"?null:t.data;default:return null}}var r3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function s0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!r3[e.type]:t==="textarea"}function Rk(e,t,r,n){ak(n),t=zl(t,"onChange"),0<t.length&&(r=new ax("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ko=null,$o=null;function n3(e){$k(e,0)}function Rc(e){var t=Yi(e);if(ek(t))return e}function i3(e,t){if(e==="change")return t}var Ak=!1;if(cn){var Du;if(cn){var Lu="oninput"in document;if(!Lu){var o0=document.createElement("div");o0.setAttribute("oninput","return;"),Lu=typeof o0.oninput=="function"}Du=Lu}else Du=!1;Ak=Du&&(!document.documentMode||9<document.documentMode)}function a0(){ko&&(ko.detachEvent("onpropertychange",Ik),$o=ko=null)}function Ik(e){if(e.propertyName==="value"&&Rc($o)){var t=[];Rk(t,$o,e,tx(e)),dk(n3,t)}}function s3(e,t,r){e==="focusin"?(a0(),ko=t,$o=r,ko.attachEvent("onpropertychange",Ik)):e==="focusout"&&a0()}function o3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Rc($o)}function a3(e,t){if(e==="click")return Rc(t)}function l3(e,t){if(e==="input"||e==="change")return Rc(t)}function c3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rr=typeof Object.is=="function"?Object.is:c3;function Bo(e,t){if(Rr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!jv.call(t,i)||!Rr(e[i],t[i]))return!1}return!0}function l0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function c0(e,t){var r=l0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=l0(r)}}function Mk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Mk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Pk(){for(var e=window,t=Il();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Il(e.document)}return t}function ux(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function u3(e){var t=Pk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Mk(r.ownerDocument.documentElement,r)){if(n!==null&&ux(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=c0(r,s);var o=c0(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var d3=cn&&"documentMode"in document&&11>=document.documentMode,Gi=null,Bv=null,No=null,Hv=!1;function u0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Hv||Gi==null||Gi!==Il(n)||(n=Gi,"selectionStart"in n&&ux(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),No&&Bo(No,n)||(No=n,n=zl(Bv,"onSelect"),0<n.length&&(t=new ax("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gi)))}function za(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ki={animationend:za("Animation","AnimationEnd"),animationiteration:za("Animation","AnimationIteration"),animationstart:za("Animation","AnimationStart"),transitionend:za("Transition","TransitionEnd")},Fu={},Ok={};cn&&(Ok=document.createElement("div").style,"AnimationEvent"in window||(delete Ki.animationend.animation,delete Ki.animationiteration.animation,delete Ki.animationstart.animation),"TransitionEvent"in window||delete Ki.transitionend.transition);function Ac(e){if(Fu[e])return Fu[e];if(!Ki[e])return e;var t=Ki[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Ok)return Fu[e]=t[r];return e}var Dk=Ac("animationend"),Lk=Ac("animationiteration"),Fk=Ac("animationstart"),zk=Ac("transitionend"),qk=new Map,d0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qn(e,t){qk.set(e,t),Ci(t,[e])}for(var zu=0;zu<d0.length;zu++){var qu=d0[zu],f3=qu.toLowerCase(),p3=qu[0].toUpperCase()+qu.slice(1);Qn(f3,"on"+p3)}Qn(Dk,"onAnimationEnd");Qn(Lk,"onAnimationIteration");Qn(Fk,"onAnimationStart");Qn("dblclick","onDoubleClick");Qn("focusin","onFocus");Qn("focusout","onBlur");Qn(zk,"onTransitionEnd");vs("onMouseEnter",["mouseout","mouseover"]);vs("onMouseLeave",["mouseout","mouseover"]);vs("onPointerEnter",["pointerout","pointerover"]);vs("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),h3=new Set("cancel close invalid load scroll toggle".split(" ").concat(fo));function f0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,fA(n,t,void 0,e),e.currentTarget=null}function $k(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;f0(i,l,d),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;f0(i,l,d),s=c}}}if(Pl)throw e=Fv,Pl=!1,Fv=null,e}function Ue(e,t){var r=t[Kv];r===void 0&&(r=t[Kv]=new Set);var n=e+"__bubble";r.has(n)||(Bk(t,e,2,!1),r.add(n))}function $u(e,t,r){var n=0;t&&(n|=4),Bk(r,e,n,t)}var qa="_reactListening"+Math.random().toString(36).slice(2);function Ho(e){if(!e[qa]){e[qa]=!0,YS.forEach(function(r){r!=="selectionchange"&&(h3.has(r)||$u(r,!1,e),$u(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[qa]||(t[qa]=!0,$u("selectionchange",!1,t))}}function Bk(e,t,r,n){switch(kk(t)){case 1:var i=EA;break;case 4:i=TA;break;default:i=sx}r=i.bind(null,t,r,e),i=void 0,!Lv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Bu(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ci(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}dk(function(){var d=s,u=tx(r),f=[];e:{var p=qk.get(e);if(p!==void 0){var h=ax,x=e;switch(e){case"keypress":if(yl(r)===0)break e;case"keydown":case"keyup":h=WA;break;case"focusin":x="focus",h=Ou;break;case"focusout":x="blur",h=Ou;break;case"beforeblur":case"afterblur":h=Ou;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=e0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=IA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=GA;break;case Dk:case Lk:case Fk:h=OA;break;case zk:h=YA;break;case"scroll":h=RA;break;case"wheel":h=QA;break;case"copy":case"cut":case"paste":h=LA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=r0}var v=(t&4)!==0,_=!v&&e==="scroll",g=v?p!==null?p+"Capture":null:p;v=[];for(var y=d,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,g!==null&&(w=Lo(y,g),w!=null&&v.push(Wo(y,w,b)))),_)break;y=y.return}0<v.length&&(p=new h(p,x,null,r,u),f.push({event:p,listeners:v}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Ov&&(x=r.relatedTarget||r.fromElement)&&(ci(x)||x[un]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(x=r.relatedTarget||r.toElement,h=d,x=x?ci(x):null,x!==null&&(_=Ei(x),x!==_||x.tag!==5&&x.tag!==6)&&(x=null)):(h=null,x=d),h!==x)){if(v=e0,w="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(v=r0,w="onPointerLeave",g="onPointerEnter",y="pointer"),_=h==null?p:Yi(h),b=x==null?p:Yi(x),p=new v(w,y+"leave",h,r,u),p.target=_,p.relatedTarget=b,w=null,ci(u)===d&&(v=new v(g,y+"enter",x,r,u),v.target=b,v.relatedTarget=_,w=v),_=w,h&&x)t:{for(v=h,g=x,y=0,b=v;b;b=Pi(b))y++;for(b=0,w=g;w;w=Pi(w))b++;for(;0<y-b;)v=Pi(v),y--;for(;0<b-y;)g=Pi(g),b--;for(;y--;){if(v===g||g!==null&&v===g.alternate)break t;v=Pi(v),g=Pi(g)}v=null}else v=null;h!==null&&p0(f,p,h,v,!1),x!==null&&_!==null&&p0(f,_,x,v,!0)}}e:{if(p=d?Yi(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var S=i3;else if(s0(p))if(Ak)S=l3;else{S=o3;var k=s3}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=a3);if(S&&(S=S(e,d))){Rk(f,S,r,u);break e}k&&k(e,p,d),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&Rv(p,"number",p.value)}switch(k=d?Yi(d):window,e){case"focusin":(s0(k)||k.contentEditable==="true")&&(Gi=k,Bv=d,No=null);break;case"focusout":No=Bv=Gi=null;break;case"mousedown":Hv=!0;break;case"contextmenu":case"mouseup":case"dragend":Hv=!1,u0(f,r,u);break;case"selectionchange":if(d3)break;case"keydown":case"keyup":u0(f,r,u)}var N;if(cx)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Vi?Ek(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(Ck&&r.locale!=="ko"&&(Vi||E!=="onCompositionStart"?E==="onCompositionEnd"&&Vi&&(N=Nk()):(Mn=u,ox="value"in Mn?Mn.value:Mn.textContent,Vi=!0)),k=zl(d,E),0<k.length&&(E=new t0(E,e,null,r,u),f.push({event:E,listeners:k}),N?E.data=N:(N=Tk(r),N!==null&&(E.data=N)))),(N=JA?e3(e,r):t3(e,r))&&(d=zl(d,"onBeforeInput"),0<d.length&&(u=new t0("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=N))}$k(f,t)})}function Wo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function zl(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Lo(e,r),s!=null&&n.unshift(Wo(e,s,i)),s=Lo(e,t),s!=null&&n.push(Wo(e,s,i))),e=e.return}return n}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function p0(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,i?(c=Lo(r,s),c!=null&&o.unshift(Wo(r,c,l))):i||(c=Lo(r,s),c!=null&&o.push(Wo(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var m3=/\r\n?/g,v3=/\u0000|\uFFFD/g;function h0(e){return(typeof e=="string"?e:""+e).replace(m3,`
`).replace(v3,"")}function $a(e,t,r){if(t=h0(t),h0(e)!==t&&r)throw Error(te(425))}function ql(){}var Wv=null,Uv=null;function Vv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Gv=typeof setTimeout=="function"?setTimeout:void 0,g3=typeof clearTimeout=="function"?clearTimeout:void 0,m0=typeof Promise=="function"?Promise:void 0,x3=typeof queueMicrotask=="function"?queueMicrotask:typeof m0<"u"?function(e){return m0.resolve(null).then(e).catch(y3)}:Gv;function y3(e){setTimeout(function(){throw e})}function Hu(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),qo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);qo(t)}function Fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function v0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var As=Math.random().toString(36).slice(2),zr="__reactFiber$"+As,Uo="__reactProps$"+As,un="__reactContainer$"+As,Kv="__reactEvents$"+As,b3="__reactListeners$"+As,_3="__reactHandles$"+As;function ci(e){var t=e[zr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[un]||r[zr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=v0(e);e!==null;){if(r=e[zr])return r;e=v0(e)}return t}e=r,r=e.parentNode}return null}function va(e){return e=e[zr]||e[un],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Yi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function Ic(e){return e[Uo]||null}var Yv=[],Xi=-1;function Zn(e){return{current:e}}function Ge(e){0>Xi||(e.current=Yv[Xi],Yv[Xi]=null,Xi--)}function We(e,t){Xi++,Yv[Xi]=e.current,e.current=t}var Kn={},It=Zn(Kn),Ut=Zn(!1),bi=Kn;function gs(e,t){var r=e.type.contextTypes;if(!r)return Kn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Vt(e){return e=e.childContextTypes,e!=null}function $l(){Ge(Ut),Ge(It)}function g0(e,t,r){if(It.current!==Kn)throw Error(te(168));We(It,t),We(Ut,r)}function Hk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(te(108,sA(e)||"Unknown",i));return et({},r,n)}function Bl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Kn,bi=It.current,We(It,e),We(Ut,Ut.current),!0}function x0(e,t,r){var n=e.stateNode;if(!n)throw Error(te(169));r?(e=Hk(e,t,bi),n.__reactInternalMemoizedMergedChildContext=e,Ge(Ut),Ge(It),We(It,e)):Ge(Ut),We(Ut,r)}var Jr=null,Mc=!1,Wu=!1;function Wk(e){Jr===null?Jr=[e]:Jr.push(e)}function w3(e){Mc=!0,Wk(e)}function Jn(){if(!Wu&&Jr!==null){Wu=!0;var e=0,t=qe;try{var r=Jr;for(qe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jr=null,Mc=!1}catch(i){throw Jr!==null&&(Jr=Jr.slice(e+1)),mk(rx,Jn),i}finally{qe=t,Wu=!1}}return null}var Qi=[],Zi=0,Hl=null,Wl=0,ur=[],dr=0,_i=null,tn=1,rn="";function oi(e,t){Qi[Zi++]=Wl,Qi[Zi++]=Hl,Hl=e,Wl=t}function Uk(e,t,r){ur[dr++]=tn,ur[dr++]=rn,ur[dr++]=_i,_i=e;var n=tn;e=rn;var i=32-Er(n)-1;n&=~(1<<i),r+=1;var s=32-Er(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,tn=1<<32-Er(t)+i|r<<i|n,rn=s+e}else tn=1<<s|r<<i|n,rn=e}function dx(e){e.return!==null&&(oi(e,1),Uk(e,1,0))}function fx(e){for(;e===Hl;)Hl=Qi[--Zi],Qi[Zi]=null,Wl=Qi[--Zi],Qi[Zi]=null;for(;e===_i;)_i=ur[--dr],ur[dr]=null,rn=ur[--dr],ur[dr]=null,tn=ur[--dr],ur[dr]=null}var rr=null,tr=null,Ye=!1,Nr=null;function Vk(e,t){var r=pr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function y0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rr=e,tr=Fn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rr=e,tr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_i!==null?{id:tn,overflow:rn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=pr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,rr=e,tr=null,!0):!1;default:return!1}}function Xv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Qv(e){if(Ye){var t=tr;if(t){var r=t;if(!y0(e,t)){if(Xv(e))throw Error(te(418));t=Fn(r.nextSibling);var n=rr;t&&y0(e,t)?Vk(n,r):(e.flags=e.flags&-4097|2,Ye=!1,rr=e)}}else{if(Xv(e))throw Error(te(418));e.flags=e.flags&-4097|2,Ye=!1,rr=e}}}function b0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rr=e}function Ba(e){if(e!==rr)return!1;if(!Ye)return b0(e),Ye=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Vv(e.type,e.memoizedProps)),t&&(t=tr)){if(Xv(e))throw Gk(),Error(te(418));for(;t;)Vk(e,t),t=Fn(t.nextSibling)}if(b0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){tr=Fn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}tr=null}}else tr=rr?Fn(e.stateNode.nextSibling):null;return!0}function Gk(){for(var e=tr;e;)e=Fn(e.nextSibling)}function xs(){tr=rr=null,Ye=!1}function px(e){Nr===null?Nr=[e]:Nr.push(e)}var j3=gn.ReactCurrentBatchConfig;function Gs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var n=r.stateNode}if(!n)throw Error(te(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function Ha(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _0(e){var t=e._init;return t(e._payload)}function Kk(e){function t(g,y){if(e){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function r(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=Bn(g,y),g.index=0,g.sibling=null,g}function s(g,y,b){return g.index=b,e?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=2,y):b):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,y,b,w){return y===null||y.tag!==6?(y=Qu(b,g.mode,w),y.return=g,y):(y=i(y,b),y.return=g,y)}function c(g,y,b,w){var S=b.type;return S===Ui?u(g,y,b.props.children,w,b.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===jn&&_0(S)===y.type)?(w=i(y,b.props),w.ref=Gs(g,y,b),w.return=g,w):(w=Nl(b.type,b.key,b.props,null,g.mode,w),w.ref=Gs(g,y,b),w.return=g,w)}function d(g,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Zu(b,g.mode,w),y.return=g,y):(y=i(y,b.children||[]),y.return=g,y)}function u(g,y,b,w,S){return y===null||y.tag!==7?(y=vi(b,g.mode,w,S),y.return=g,y):(y=i(y,b),y.return=g,y)}function f(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Qu(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ia:return b=Nl(y.type,y.key,y.props,null,g.mode,b),b.ref=Gs(g,null,y),b.return=g,b;case Wi:return y=Zu(y,g.mode,b),y.return=g,y;case jn:var w=y._init;return f(g,w(y._payload),b)}if(co(y)||Bs(y))return y=vi(y,g.mode,b,null),y.return=g,y;Ha(g,y)}return null}function p(g,y,b,w){var S=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:l(g,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ia:return b.key===S?c(g,y,b,w):null;case Wi:return b.key===S?d(g,y,b,w):null;case jn:return S=b._init,p(g,y,S(b._payload),w)}if(co(b)||Bs(b))return S!==null?null:u(g,y,b,w,null);Ha(g,b)}return null}function h(g,y,b,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(b)||null,l(y,g,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ia:return g=g.get(w.key===null?b:w.key)||null,c(y,g,w,S);case Wi:return g=g.get(w.key===null?b:w.key)||null,d(y,g,w,S);case jn:var k=w._init;return h(g,y,b,k(w._payload),S)}if(co(w)||Bs(w))return g=g.get(b)||null,u(y,g,w,S,null);Ha(y,w)}return null}function x(g,y,b,w){for(var S=null,k=null,N=y,E=y=0,j=null;N!==null&&E<b.length;E++){N.index>E?(j=N,N=null):j=N.sibling;var R=p(g,N,b[E],w);if(R===null){N===null&&(N=j);break}e&&N&&R.alternate===null&&t(g,N),y=s(R,y,E),k===null?S=R:k.sibling=R,k=R,N=j}if(E===b.length)return r(g,N),Ye&&oi(g,E),S;if(N===null){for(;E<b.length;E++)N=f(g,b[E],w),N!==null&&(y=s(N,y,E),k===null?S=N:k.sibling=N,k=N);return Ye&&oi(g,E),S}for(N=n(g,N);E<b.length;E++)j=h(N,g,E,b[E],w),j!==null&&(e&&j.alternate!==null&&N.delete(j.key===null?E:j.key),y=s(j,y,E),k===null?S=j:k.sibling=j,k=j);return e&&N.forEach(function(T){return t(g,T)}),Ye&&oi(g,E),S}function v(g,y,b,w){var S=Bs(b);if(typeof S!="function")throw Error(te(150));if(b=S.call(b),b==null)throw Error(te(151));for(var k=S=null,N=y,E=y=0,j=null,R=b.next();N!==null&&!R.done;E++,R=b.next()){N.index>E?(j=N,N=null):j=N.sibling;var T=p(g,N,R.value,w);if(T===null){N===null&&(N=j);break}e&&N&&T.alternate===null&&t(g,N),y=s(T,y,E),k===null?S=T:k.sibling=T,k=T,N=j}if(R.done)return r(g,N),Ye&&oi(g,E),S;if(N===null){for(;!R.done;E++,R=b.next())R=f(g,R.value,w),R!==null&&(y=s(R,y,E),k===null?S=R:k.sibling=R,k=R);return Ye&&oi(g,E),S}for(N=n(g,N);!R.done;E++,R=b.next())R=h(N,g,E,R.value,w),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?E:R.key),y=s(R,y,E),k===null?S=R:k.sibling=R,k=R);return e&&N.forEach(function(D){return t(g,D)}),Ye&&oi(g,E),S}function _(g,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Ui&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ia:e:{for(var S=b.key,k=y;k!==null;){if(k.key===S){if(S=b.type,S===Ui){if(k.tag===7){r(g,k.sibling),y=i(k,b.props.children),y.return=g,g=y;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===jn&&_0(S)===k.type){r(g,k.sibling),y=i(k,b.props),y.ref=Gs(g,k,b),y.return=g,g=y;break e}r(g,k);break}else t(g,k);k=k.sibling}b.type===Ui?(y=vi(b.props.children,g.mode,w,b.key),y.return=g,g=y):(w=Nl(b.type,b.key,b.props,null,g.mode,w),w.ref=Gs(g,y,b),w.return=g,g=w)}return o(g);case Wi:e:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(g,y.sibling),y=i(y,b.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else t(g,y);y=y.sibling}y=Zu(b,g.mode,w),y.return=g,g=y}return o(g);case jn:return k=b._init,_(g,y,k(b._payload),w)}if(co(b))return x(g,y,b,w);if(Bs(b))return v(g,y,b,w);Ha(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(g,y.sibling),y=i(y,b),y.return=g,g=y):(r(g,y),y=Qu(b,g.mode,w),y.return=g,g=y),o(g)):r(g,y)}return _}var ys=Kk(!0),Yk=Kk(!1),Ul=Zn(null),Vl=null,Ji=null,hx=null;function mx(){hx=Ji=Vl=null}function vx(e){var t=Ul.current;Ge(Ul),e._currentValue=t}function Zv(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function us(e,t){Vl=e,hx=Ji=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bt=!0),e.firstContext=null)}function vr(e){var t=e._currentValue;if(hx!==e)if(e={context:e,memoizedValue:t,next:null},Ji===null){if(Vl===null)throw Error(te(308));Ji=e,Vl.dependencies={lanes:0,firstContext:e}}else Ji=Ji.next=e;return t}var ui=null;function gx(e){ui===null?ui=[e]:ui.push(e)}function Xk(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,gx(t)):(r.next=i.next,i.next=r),t.interleaved=r,dn(e,n)}function dn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Sn=!1;function xx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function an(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Me&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,dn(e,r)}return i=n.interleaved,i===null?(t.next=t,gx(n)):(t.next=i.next,i.next=t),n.interleaved=t,dn(e,r)}function bl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nx(e,r)}}function w0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Gl(e,t,r,n){var i=e.updateQueue;Sn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,u=d=c=null,l=s;do{var p=l.lane,h=l.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,v=l;switch(p=t,h=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){f=x.call(h,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,p=typeof x=="function"?x.call(h,f,p):x,p==null)break e;f=et({},f,p);break e;case 2:Sn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,o|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ji|=o,e.lanes=o,e.memoizedState=f}}function j0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(te(191,i));i.call(n)}}}var ga={},Br=Zn(ga),Vo=Zn(ga),Go=Zn(ga);function di(e){if(e===ga)throw Error(te(174));return e}function yx(e,t){switch(We(Go,t),We(Vo,e),We(Br,ga),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Iv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Iv(t,e)}Ge(Br),We(Br,t)}function bs(){Ge(Br),Ge(Vo),Ge(Go)}function Zk(e){di(Go.current);var t=di(Br.current),r=Iv(t,e.type);t!==r&&(We(Vo,e),We(Br,r))}function bx(e){Vo.current===e&&(Ge(Br),Ge(Vo))}var Ze=Zn(0);function Kl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Uu=[];function _x(){for(var e=0;e<Uu.length;e++)Uu[e]._workInProgressVersionPrimary=null;Uu.length=0}var _l=gn.ReactCurrentDispatcher,Vu=gn.ReactCurrentBatchConfig,wi=0,Je=null,ct=null,ht=null,Yl=!1,Co=!1,Ko=0,S3=0;function Tt(){throw Error(te(321))}function wx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Rr(e[r],t[r]))return!1;return!0}function jx(e,t,r,n,i,s){if(wi=s,Je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_l.current=e===null||e.memoizedState===null?E3:T3,e=r(n,i),Co){s=0;do{if(Co=!1,Ko=0,25<=s)throw Error(te(301));s+=1,ht=ct=null,t.updateQueue=null,_l.current=R3,e=r(n,i)}while(Co)}if(_l.current=Xl,t=ct!==null&&ct.next!==null,wi=0,ht=ct=Je=null,Yl=!1,t)throw Error(te(300));return e}function Sx(){var e=Ko!==0;return Ko=0,e}function Fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Je.memoizedState=ht=e:ht=ht.next=e,ht}function gr(){if(ct===null){var e=Je.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=ht===null?Je.memoizedState:ht.next;if(t!==null)ht=t,ct=e;else{if(e===null)throw Error(te(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},ht===null?Je.memoizedState=ht=e:ht=ht.next=e}return ht}function Yo(e,t){return typeof t=="function"?t(e):t}function Gu(e){var t=gr(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=ct,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((wi&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Je.lanes|=u,ji|=u}d=d.next}while(d!==null&&d!==s);c===null?o=n:c.next=l,Rr(n,t.memoizedState)||(Bt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Je.lanes|=s,ji|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ku(e){var t=gr(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Rr(s,t.memoizedState)||(Bt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Jk(){}function eN(e,t){var r=Je,n=gr(),i=t(),s=!Rr(n.memoizedState,i);if(s&&(n.memoizedState=i,Bt=!0),n=n.queue,kx(nN.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||ht!==null&&ht.memoizedState.tag&1){if(r.flags|=2048,Xo(9,rN.bind(null,r,n,i,t),void 0,null),vt===null)throw Error(te(349));wi&30||tN(r,t,i)}return i}function tN(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function rN(e,t,r,n){t.value=r,t.getSnapshot=n,iN(t)&&sN(e)}function nN(e,t,r){return r(function(){iN(t)&&sN(e)})}function iN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Rr(e,r)}catch{return!0}}function sN(e){var t=dn(e,1);t!==null&&Tr(t,e,1,-1)}function S0(e){var t=Fr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:e},t.queue=e,e=e.dispatch=C3.bind(null,Je,e),[t.memoizedState,e]}function Xo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function oN(){return gr().memoizedState}function wl(e,t,r,n){var i=Fr();Je.flags|=e,i.memoizedState=Xo(1|t,r,void 0,n===void 0?null:n)}function Pc(e,t,r,n){var i=gr();n=n===void 0?null:n;var s=void 0;if(ct!==null){var o=ct.memoizedState;if(s=o.destroy,n!==null&&wx(n,o.deps)){i.memoizedState=Xo(t,r,s,n);return}}Je.flags|=e,i.memoizedState=Xo(1|t,r,s,n)}function k0(e,t){return wl(8390656,8,e,t)}function kx(e,t){return Pc(2048,8,e,t)}function aN(e,t){return Pc(4,2,e,t)}function lN(e,t){return Pc(4,4,e,t)}function cN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function uN(e,t,r){return r=r!=null?r.concat([e]):null,Pc(4,4,cN.bind(null,t,e),r)}function Nx(){}function dN(e,t){var r=gr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&wx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function fN(e,t){var r=gr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&wx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function pN(e,t,r){return wi&21?(Rr(r,t)||(r=xk(),Je.lanes|=r,ji|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bt=!0),e.memoizedState=r)}function k3(e,t){var r=qe;qe=r!==0&&4>r?r:4,e(!0);var n=Vu.transition;Vu.transition={};try{e(!1),t()}finally{qe=r,Vu.transition=n}}function hN(){return gr().memoizedState}function N3(e,t,r){var n=$n(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},mN(e))vN(t,r);else if(r=Xk(e,t,r,n),r!==null){var i=Lt();Tr(r,e,n,i),gN(r,t,n)}}function C3(e,t,r){var n=$n(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(mN(e))vN(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,Rr(l,o)){var c=t.interleaved;c===null?(i.next=i,gx(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=Xk(e,t,i,n),r!==null&&(i=Lt(),Tr(r,e,n,i),gN(r,t,n))}}function mN(e){var t=e.alternate;return e===Je||t!==null&&t===Je}function vN(e,t){Co=Yl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function gN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nx(e,r)}}var Xl={readContext:vr,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},E3={readContext:vr,useCallback:function(e,t){return Fr().memoizedState=[e,t===void 0?null:t],e},useContext:vr,useEffect:k0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,wl(4194308,4,cN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return wl(4194308,4,e,t)},useInsertionEffect:function(e,t){return wl(4,2,e,t)},useMemo:function(e,t){var r=Fr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Fr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=N3.bind(null,Je,e),[n.memoizedState,e]},useRef:function(e){var t=Fr();return e={current:e},t.memoizedState=e},useState:S0,useDebugValue:Nx,useDeferredValue:function(e){return Fr().memoizedState=e},useTransition:function(){var e=S0(!1),t=e[0];return e=k3.bind(null,e[1]),Fr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Je,i=Fr();if(Ye){if(r===void 0)throw Error(te(407));r=r()}else{if(r=t(),vt===null)throw Error(te(349));wi&30||tN(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,k0(nN.bind(null,n,s,e),[e]),n.flags|=2048,Xo(9,rN.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Fr(),t=vt.identifierPrefix;if(Ye){var r=rn,n=tn;r=(n&~(1<<32-Er(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ko++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=S3++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},T3={readContext:vr,useCallback:dN,useContext:vr,useEffect:kx,useImperativeHandle:uN,useInsertionEffect:aN,useLayoutEffect:lN,useMemo:fN,useReducer:Gu,useRef:oN,useState:function(){return Gu(Yo)},useDebugValue:Nx,useDeferredValue:function(e){var t=gr();return pN(t,ct.memoizedState,e)},useTransition:function(){var e=Gu(Yo)[0],t=gr().memoizedState;return[e,t]},useMutableSource:Jk,useSyncExternalStore:eN,useId:hN,unstable_isNewReconciler:!1},R3={readContext:vr,useCallback:dN,useContext:vr,useEffect:kx,useImperativeHandle:uN,useInsertionEffect:aN,useLayoutEffect:lN,useMemo:fN,useReducer:Ku,useRef:oN,useState:function(){return Ku(Yo)},useDebugValue:Nx,useDeferredValue:function(e){var t=gr();return ct===null?t.memoizedState=e:pN(t,ct.memoizedState,e)},useTransition:function(){var e=Ku(Yo)[0],t=gr().memoizedState;return[e,t]},useMutableSource:Jk,useSyncExternalStore:eN,useId:hN,unstable_isNewReconciler:!1};function jr(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Jv(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Oc={isMounted:function(e){return(e=e._reactInternals)?Ei(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Lt(),i=$n(e),s=an(n,i);s.payload=t,r!=null&&(s.callback=r),t=zn(e,s,i),t!==null&&(Tr(t,e,i,n),bl(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Lt(),i=$n(e),s=an(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=zn(e,s,i),t!==null&&(Tr(t,e,i,n),bl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Lt(),n=$n(e),i=an(r,n);i.tag=2,t!=null&&(i.callback=t),t=zn(e,i,n),t!==null&&(Tr(t,e,n,r),bl(t,e,n))}};function N0(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Bo(r,n)||!Bo(i,s):!0}function xN(e,t,r){var n=!1,i=Kn,s=t.contextType;return typeof s=="object"&&s!==null?s=vr(s):(i=Vt(t)?bi:It.current,n=t.contextTypes,s=(n=n!=null)?gs(e,i):Kn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Oc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function C0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Oc.enqueueReplaceState(t,t.state,null)}function eg(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},xx(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=vr(s):(s=Vt(t)?bi:It.current,i.context=gs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Jv(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Oc.enqueueReplaceState(i,i.state,null),Gl(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function _s(e,t){try{var r="",n=t;do r+=iA(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Yu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function tg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var A3=typeof WeakMap=="function"?WeakMap:Map;function yN(e,t,r){r=an(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Zl||(Zl=!0,dg=n),tg(e,t)},r}function bN(e,t,r){r=an(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){tg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){tg(e,t),typeof n!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function E0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new A3;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=U3.bind(null,e,t,r),t.then(e,e))}function T0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function R0(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=an(-1,1),t.tag=2,zn(r,t,1))),r.lanes|=1),e)}var I3=gn.ReactCurrentOwner,Bt=!1;function Ot(e,t,r,n){t.child=e===null?Yk(t,null,r,n):ys(t,e.child,r,n)}function A0(e,t,r,n,i){r=r.render;var s=t.ref;return us(t,i),n=jx(e,t,r,n,s,i),r=Sx(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fn(e,t,i)):(Ye&&r&&dx(t),t.flags|=1,Ot(e,t,n,i),t.child)}function I0(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Px(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,_N(e,t,s,n,i)):(e=Nl(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Bo,r(o,n)&&e.ref===t.ref)return fn(e,t,i)}return t.flags|=1,e=Bn(s,n),e.ref=t.ref,e.return=t,t.child=e}function _N(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Bo(s,n)&&e.ref===t.ref)if(Bt=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Bt=!0);else return t.lanes=e.lanes,fn(e,t,i)}return rg(e,t,r,n,i)}function wN(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(ts,Jt),Jt|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,We(ts,Jt),Jt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,We(ts,Jt),Jt|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,We(ts,Jt),Jt|=n;return Ot(e,t,i,r),t.child}function jN(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function rg(e,t,r,n,i){var s=Vt(r)?bi:It.current;return s=gs(t,s),us(t,i),r=jx(e,t,r,n,s,i),n=Sx(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,fn(e,t,i)):(Ye&&n&&dx(t),t.flags|=1,Ot(e,t,r,i),t.child)}function M0(e,t,r,n,i){if(Vt(r)){var s=!0;Bl(t)}else s=!1;if(us(t,i),t.stateNode===null)jl(e,t),xN(t,r,n),eg(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=vr(d):(d=Vt(r)?bi:It.current,d=gs(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&C0(t,o,n,d),Sn=!1;var p=t.memoizedState;o.state=p,Gl(t,n,o,i),c=t.memoizedState,l!==n||p!==c||Ut.current||Sn?(typeof u=="function"&&(Jv(t,r,u,n),c=t.memoizedState),(l=Sn||N0(t,r,l,n,p,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Qk(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:jr(t.type,l),o.props=d,f=t.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=vr(c):(c=Vt(r)?bi:It.current,c=gs(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&C0(t,o,n,c),Sn=!1,p=t.memoizedState,o.state=p,Gl(t,n,o,i);var x=t.memoizedState;l!==f||p!==x||Ut.current||Sn?(typeof h=="function"&&(Jv(t,r,h,n),x=t.memoizedState),(d=Sn||N0(t,r,d,n,p,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return ng(e,t,r,n,s,i)}function ng(e,t,r,n,i,s){jN(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&x0(t,r,!1),fn(e,t,s);n=t.stateNode,I3.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ys(t,e.child,null,s),t.child=ys(t,null,l,s)):Ot(e,t,l,s),t.memoizedState=n.state,i&&x0(t,r,!0),t.child}function SN(e){var t=e.stateNode;t.pendingContext?g0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&g0(e,t.context,!1),yx(e,t.containerInfo)}function P0(e,t,r,n,i){return xs(),px(i),t.flags|=256,Ot(e,t,r,n),t.child}var ig={dehydrated:null,treeContext:null,retryLane:0};function sg(e){return{baseLanes:e,cachePool:null,transitions:null}}function kN(e,t,r){var n=t.pendingProps,i=Ze.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),We(Ze,i&1),e===null)return Qv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Fc(o,n,0,null),e=vi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=sg(r),t.memoizedState=ig,e):Cx(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return M3(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bn(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Bn(l,s):(s=vi(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?sg(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=ig,n}return s=e.child,e=s.sibling,n=Bn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Cx(e,t){return t=Fc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wa(e,t,r,n){return n!==null&&px(n),ys(t,e.child,null,r),e=Cx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function M3(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Yu(Error(te(422))),Wa(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Fc({mode:"visible",children:n.children},i,0,null),s=vi(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ys(t,e.child,null,o),t.child.memoizedState=sg(o),t.memoizedState=ig,s);if(!(t.mode&1))return Wa(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(te(419)),n=Yu(s,n,void 0),Wa(e,t,o,n)}if(l=(o&e.childLanes)!==0,Bt||l){if(n=vt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,dn(e,i),Tr(n,e,i,-1))}return Mx(),n=Yu(Error(te(421))),Wa(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=V3.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,tr=Fn(i.nextSibling),rr=t,Ye=!0,Nr=null,e!==null&&(ur[dr++]=tn,ur[dr++]=rn,ur[dr++]=_i,tn=e.id,rn=e.overflow,_i=t),t=Cx(t,n.children),t.flags|=4096,t)}function O0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Zv(e.return,t,r)}function Xu(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function NN(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Ot(e,t,n.children,r),n=Ze.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&O0(e,r,t);else if(e.tag===19)O0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(We(Ze,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Kl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Xu(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Kl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Xu(t,!0,r,null,s);break;case"together":Xu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ji|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,r=Bn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function P3(e,t,r){switch(t.tag){case 3:SN(t),xs();break;case 5:Zk(t);break;case 1:Vt(t.type)&&Bl(t);break;case 4:yx(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;We(Ul,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(We(Ze,Ze.current&1),t.flags|=128,null):r&t.child.childLanes?kN(e,t,r):(We(Ze,Ze.current&1),e=fn(e,t,r),e!==null?e.sibling:null);We(Ze,Ze.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return NN(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(Ze,Ze.current),n)break;return null;case 22:case 23:return t.lanes=0,wN(e,t,r)}return fn(e,t,r)}var CN,og,EN,TN;CN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};og=function(){};EN=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,di(Br.current);var s=null;switch(r){case"input":i=Ev(e,i),n=Ev(e,n),s=[];break;case"select":i=et({},i,{value:void 0}),n=et({},n,{value:void 0}),s=[];break;case"textarea":i=Av(e,i),n=Av(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=ql)}Mv(r,n);var o;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Oo.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var c=n[d];if(l=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Oo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ue("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}r&&(s=s||[]).push("style",r);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};TN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ks(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function O3(e,t,r){var n=t.pendingProps;switch(fx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(t),null;case 1:return Vt(t.type)&&$l(),Rt(t),null;case 3:return n=t.stateNode,bs(),Ge(Ut),Ge(It),_x(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ba(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nr!==null&&(hg(Nr),Nr=null))),og(e,t),Rt(t),null;case 5:bx(t);var i=di(Go.current);if(r=t.type,e!==null&&t.stateNode!=null)EN(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(te(166));return Rt(t),null}if(e=di(Br.current),Ba(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[zr]=t,n[Uo]=s,e=(t.mode&1)!==0,r){case"dialog":Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":case"embed":Ue("load",n);break;case"video":case"audio":for(i=0;i<fo.length;i++)Ue(fo[i],n);break;case"source":Ue("error",n);break;case"img":case"image":case"link":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"input":Wy(n,s),Ue("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ue("invalid",n);break;case"textarea":Vy(n,s),Ue("invalid",n)}Mv(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&$a(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&$a(n.textContent,l,e),i=["children",""+l]):Oo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ue("scroll",n)}switch(r){case"input":Ma(n),Uy(n,s,!0);break;case"textarea":Ma(n),Gy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ql)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=nk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[zr]=t,e[Uo]=n,CN(e,t,!1,!1),t.stateNode=e;e:{switch(o=Pv(r,n),r){case"dialog":Ue("cancel",e),Ue("close",e),i=n;break;case"iframe":case"object":case"embed":Ue("load",e),i=n;break;case"video":case"audio":for(i=0;i<fo.length;i++)Ue(fo[i],e);i=n;break;case"source":Ue("error",e),i=n;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),i=n;break;case"details":Ue("toggle",e),i=n;break;case"input":Wy(e,n),i=Ev(e,n),Ue("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=et({},n,{value:void 0}),Ue("invalid",e);break;case"textarea":Vy(e,n),i=Av(e,n),Ue("invalid",e);break;default:i=n}Mv(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?ok(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ik(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Do(e,c):typeof c=="number"&&Do(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Oo.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ue("scroll",e):c!=null&&Qg(e,s,c,o))}switch(r){case"input":Ma(e),Uy(e,n,!1);break;case"textarea":Ma(e),Gy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Gn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?os(e,!!n.multiple,s,!1):n.defaultValue!=null&&os(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ql)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Rt(t),null;case 6:if(e&&t.stateNode!=null)TN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(te(166));if(r=di(Go.current),di(Br.current),Ba(t)){if(n=t.stateNode,r=t.memoizedProps,n[zr]=t,(s=n.nodeValue!==r)&&(e=rr,e!==null))switch(e.tag){case 3:$a(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$a(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[zr]=t,t.stateNode=n}return Rt(t),null;case 13:if(Ge(Ze),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ye&&tr!==null&&t.mode&1&&!(t.flags&128))Gk(),xs(),t.flags|=98560,s=!1;else if(s=Ba(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(te(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[zr]=t}else xs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Rt(t),s=!1}else Nr!==null&&(hg(Nr),Nr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ze.current&1?ft===0&&(ft=3):Mx())),t.updateQueue!==null&&(t.flags|=4),Rt(t),null);case 4:return bs(),og(e,t),e===null&&Ho(t.stateNode.containerInfo),Rt(t),null;case 10:return vx(t.type._context),Rt(t),null;case 17:return Vt(t.type)&&$l(),Rt(t),null;case 19:if(Ge(Ze),s=t.memoizedState,s===null)return Rt(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Ks(s,!1);else{if(ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Kl(e),o!==null){for(t.flags|=128,Ks(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return We(Ze,Ze.current&1|2),t.child}e=e.sibling}s.tail!==null&&nt()>ws&&(t.flags|=128,n=!0,Ks(s,!1),t.lanes=4194304)}else{if(!n)if(e=Kl(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ks(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ye)return Rt(t),null}else 2*nt()-s.renderingStartTime>ws&&r!==1073741824&&(t.flags|=128,n=!0,Ks(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=nt(),t.sibling=null,r=Ze.current,We(Ze,n?r&1|2:r&1),t):(Rt(t),null);case 22:case 23:return Ix(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Jt&1073741824&&(Rt(t),t.subtreeFlags&6&&(t.flags|=8192)):Rt(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function D3(e,t){switch(fx(t),t.tag){case 1:return Vt(t.type)&&$l(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bs(),Ge(Ut),Ge(It),_x(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bx(t),null;case 13:if(Ge(Ze),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));xs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ge(Ze),null;case 4:return bs(),null;case 10:return vx(t.type._context),null;case 22:case 23:return Ix(),null;case 24:return null;default:return null}}var Ua=!1,At=!1,L3=typeof WeakSet=="function"?WeakSet:Set,le=null;function es(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function ag(e,t,r){try{r()}catch(n){tt(e,t,n)}}var D0=!1;function F3(e,t){if(Wv=Ll,e=Pk(),ux(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++d===i&&(l=o),p===s&&++u===n&&(c=o),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Uv={focusedElem:e,selectionRange:r},Ll=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,_=x.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:jr(t.type,v),_);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(w){tt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return x=D0,D0=!1,x}function Eo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&ag(t,r,s)}i=i.next}while(i!==n)}}function Dc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function lg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function RN(e){var t=e.alternate;t!==null&&(e.alternate=null,RN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zr],delete t[Uo],delete t[Kv],delete t[b3],delete t[_3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function AN(e){return e.tag===5||e.tag===3||e.tag===4}function L0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||AN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=ql));else if(n!==4&&(e=e.child,e!==null))for(cg(e,t,r),e=e.sibling;e!==null;)cg(e,t,r),e=e.sibling}function ug(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(ug(e,t,r),e=e.sibling;e!==null;)ug(e,t,r),e=e.sibling}var wt=null,Sr=!1;function bn(e,t,r){for(r=r.child;r!==null;)IN(e,t,r),r=r.sibling}function IN(e,t,r){if($r&&typeof $r.onCommitFiberUnmount=="function")try{$r.onCommitFiberUnmount(Ec,r)}catch{}switch(r.tag){case 5:At||es(r,t);case 6:var n=wt,i=Sr;wt=null,bn(e,t,r),wt=n,Sr=i,wt!==null&&(Sr?(e=wt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):wt.removeChild(r.stateNode));break;case 18:wt!==null&&(Sr?(e=wt,r=r.stateNode,e.nodeType===8?Hu(e.parentNode,r):e.nodeType===1&&Hu(e,r),qo(e)):Hu(wt,r.stateNode));break;case 4:n=wt,i=Sr,wt=r.stateNode.containerInfo,Sr=!0,bn(e,t,r),wt=n,Sr=i;break;case 0:case 11:case 14:case 15:if(!At&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ag(r,t,o),i=i.next}while(i!==n)}bn(e,t,r);break;case 1:if(!At&&(es(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){tt(r,t,l)}bn(e,t,r);break;case 21:bn(e,t,r);break;case 22:r.mode&1?(At=(n=At)||r.memoizedState!==null,bn(e,t,r),At=n):bn(e,t,r);break;default:bn(e,t,r)}}function F0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new L3),t.forEach(function(n){var i=G3.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function _r(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:wt=l.stateNode,Sr=!1;break e;case 3:wt=l.stateNode.containerInfo,Sr=!0;break e;case 4:wt=l.stateNode.containerInfo,Sr=!0;break e}l=l.return}if(wt===null)throw Error(te(160));IN(s,o,i),wt=null,Sr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){tt(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)MN(t,e),t=t.sibling}function MN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_r(t,e),Dr(e),n&4){try{Eo(3,e,e.return),Dc(3,e)}catch(v){tt(e,e.return,v)}try{Eo(5,e,e.return)}catch(v){tt(e,e.return,v)}}break;case 1:_r(t,e),Dr(e),n&512&&r!==null&&es(r,r.return);break;case 5:if(_r(t,e),Dr(e),n&512&&r!==null&&es(r,r.return),e.flags&32){var i=e.stateNode;try{Do(i,"")}catch(v){tt(e,e.return,v)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&tk(i,s),Pv(l,o);var d=Pv(l,s);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?ok(i,f):u==="dangerouslySetInnerHTML"?ik(i,f):u==="children"?Do(i,f):Qg(i,u,f,d)}switch(l){case"input":Tv(i,s);break;case"textarea":rk(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?os(i,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?os(i,!!s.multiple,s.defaultValue,!0):os(i,!!s.multiple,s.multiple?[]:"",!1))}i[Uo]=s}catch(v){tt(e,e.return,v)}}break;case 6:if(_r(t,e),Dr(e),n&4){if(e.stateNode===null)throw Error(te(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(v){tt(e,e.return,v)}}break;case 3:if(_r(t,e),Dr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qo(t.containerInfo)}catch(v){tt(e,e.return,v)}break;case 4:_r(t,e),Dr(e);break;case 13:_r(t,e),Dr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Rx=nt())),n&4&&F0(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(At=(d=At)||u,_r(t,e),At=d):_r(t,e),Dr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(le=e,u=e.child;u!==null;){for(f=le=u;le!==null;){switch(p=le,h=p.child,p.tag){case 0:case 11:case 14:case 15:Eo(4,p,p.return);break;case 1:es(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(v){tt(n,r,v)}}break;case 5:es(p,p.return);break;case 22:if(p.memoizedState!==null){q0(f);continue}}h!==null?(h.return=p,le=h):q0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=sk("display",o))}catch(v){tt(e,e.return,v)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(v){tt(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:_r(t,e),Dr(e),n&4&&F0(e);break;case 21:break;default:_r(t,e),Dr(e)}}function Dr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(AN(r)){var n=r;break e}r=r.return}throw Error(te(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Do(i,""),n.flags&=-33);var s=L0(e);ug(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=L0(e);cg(e,l,o);break;default:throw Error(te(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function z3(e,t,r){le=e,PN(e)}function PN(e,t,r){for(var n=(e.mode&1)!==0;le!==null;){var i=le,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Ua;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||At;l=Ua;var d=At;if(Ua=o,(At=c)&&!d)for(le=i;le!==null;)o=le,c=o.child,o.tag===22&&o.memoizedState!==null?$0(i):c!==null?(c.return=o,le=c):$0(i);for(;s!==null;)le=s,PN(s),s=s.sibling;le=i,Ua=l,At=d}z0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,le=s):z0(e)}}function z0(e){for(;le!==null;){var t=le;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:At||Dc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!At)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:jr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&j0(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}j0(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&qo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}At||t.flags&512&&lg(t)}catch(p){tt(t,t.return,p)}}if(t===e){le=null;break}if(r=t.sibling,r!==null){r.return=t.return,le=r;break}le=t.return}}function q0(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var r=t.sibling;if(r!==null){r.return=t.return,le=r;break}le=t.return}}function $0(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Dc(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){tt(t,i,c)}}var s=t.return;try{lg(t)}catch(c){tt(t,s,c)}break;case 5:var o=t.return;try{lg(t)}catch(c){tt(t,o,c)}}}catch(c){tt(t,t.return,c)}if(t===e){le=null;break}var l=t.sibling;if(l!==null){l.return=t.return,le=l;break}le=t.return}}var q3=Math.ceil,Ql=gn.ReactCurrentDispatcher,Ex=gn.ReactCurrentOwner,mr=gn.ReactCurrentBatchConfig,Me=0,vt=null,it=null,jt=0,Jt=0,ts=Zn(0),ft=0,Qo=null,ji=0,Lc=0,Tx=0,To=null,$t=null,Rx=0,ws=1/0,Zr=null,Zl=!1,dg=null,qn=null,Va=!1,Pn=null,Jl=0,Ro=0,fg=null,Sl=-1,kl=0;function Lt(){return Me&6?nt():Sl!==-1?Sl:Sl=nt()}function $n(e){return e.mode&1?Me&2&&jt!==0?jt&-jt:j3.transition!==null?(kl===0&&(kl=xk()),kl):(e=qe,e!==0||(e=window.event,e=e===void 0?16:kk(e.type)),e):1}function Tr(e,t,r,n){if(50<Ro)throw Ro=0,fg=null,Error(te(185));ha(e,r,n),(!(Me&2)||e!==vt)&&(e===vt&&(!(Me&2)&&(Lc|=r),ft===4&&Tn(e,jt)),Gt(e,n),r===1&&Me===0&&!(t.mode&1)&&(ws=nt()+500,Mc&&Jn()))}function Gt(e,t){var r=e.callbackNode;jA(e,t);var n=Dl(e,e===vt?jt:0);if(n===0)r!==null&&Xy(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Xy(r),t===1)e.tag===0?w3(B0.bind(null,e)):Wk(B0.bind(null,e)),x3(function(){!(Me&6)&&Jn()}),r=null;else{switch(yk(n)){case 1:r=rx;break;case 4:r=vk;break;case 16:r=Ol;break;case 536870912:r=gk;break;default:r=Ol}r=BN(r,ON.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ON(e,t){if(Sl=-1,kl=0,Me&6)throw Error(te(327));var r=e.callbackNode;if(ds()&&e.callbackNode!==r)return null;var n=Dl(e,e===vt?jt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ec(e,n);else{t=n;var i=Me;Me|=2;var s=LN();(vt!==e||jt!==t)&&(Zr=null,ws=nt()+500,mi(e,t));do try{H3();break}catch(l){DN(e,l)}while(!0);mx(),Ql.current=s,Me=i,it!==null?t=0:(vt=null,jt=0,t=ft)}if(t!==0){if(t===2&&(i=zv(e),i!==0&&(n=i,t=pg(e,i))),t===1)throw r=Qo,mi(e,0),Tn(e,n),Gt(e,nt()),r;if(t===6)Tn(e,n);else{if(i=e.current.alternate,!(n&30)&&!$3(i)&&(t=ec(e,n),t===2&&(s=zv(e),s!==0&&(n=s,t=pg(e,s))),t===1))throw r=Qo,mi(e,0),Tn(e,n),Gt(e,nt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(te(345));case 2:ai(e,$t,Zr);break;case 3:if(Tn(e,n),(n&130023424)===n&&(t=Rx+500-nt(),10<t)){if(Dl(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Lt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Gv(ai.bind(null,e,$t,Zr),t);break}ai(e,$t,Zr);break;case 4:if(Tn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Er(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=nt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*q3(n/1960))-n,10<n){e.timeoutHandle=Gv(ai.bind(null,e,$t,Zr),n);break}ai(e,$t,Zr);break;case 5:ai(e,$t,Zr);break;default:throw Error(te(329))}}}return Gt(e,nt()),e.callbackNode===r?ON.bind(null,e):null}function pg(e,t){var r=To;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=ec(e,t),e!==2&&(t=$t,$t=r,t!==null&&hg(t)),e}function hg(e){$t===null?$t=e:$t.push.apply($t,e)}function $3(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Rr(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tn(e,t){for(t&=~Tx,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Er(t),n=1<<r;e[r]=-1,t&=~n}}function B0(e){if(Me&6)throw Error(te(327));ds();var t=Dl(e,0);if(!(t&1))return Gt(e,nt()),null;var r=ec(e,t);if(e.tag!==0&&r===2){var n=zv(e);n!==0&&(t=n,r=pg(e,n))}if(r===1)throw r=Qo,mi(e,0),Tn(e,t),Gt(e,nt()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ai(e,$t,Zr),Gt(e,nt()),null}function Ax(e,t){var r=Me;Me|=1;try{return e(t)}finally{Me=r,Me===0&&(ws=nt()+500,Mc&&Jn())}}function Si(e){Pn!==null&&Pn.tag===0&&!(Me&6)&&ds();var t=Me;Me|=1;var r=mr.transition,n=qe;try{if(mr.transition=null,qe=1,e)return e()}finally{qe=n,mr.transition=r,Me=t,!(Me&6)&&Jn()}}function Ix(){Jt=ts.current,Ge(ts)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,g3(r)),it!==null)for(r=it.return;r!==null;){var n=r;switch(fx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&$l();break;case 3:bs(),Ge(Ut),Ge(It),_x();break;case 5:bx(n);break;case 4:bs();break;case 13:Ge(Ze);break;case 19:Ge(Ze);break;case 10:vx(n.type._context);break;case 22:case 23:Ix()}r=r.return}if(vt=e,it=e=Bn(e.current,null),jt=Jt=t,ft=0,Qo=null,Tx=Lc=ji=0,$t=To=null,ui!==null){for(t=0;t<ui.length;t++)if(r=ui[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}ui=null}return e}function DN(e,t){do{var r=it;try{if(mx(),_l.current=Xl,Yl){for(var n=Je.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Yl=!1}if(wi=0,ht=ct=Je=null,Co=!1,Ko=0,Ex.current=null,r===null||r.return===null){ft=1,Qo=t,it=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=jt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=T0(o);if(h!==null){h.flags&=-257,R0(h,o,l,s,t),h.mode&1&&E0(s,d,t),t=h,c=d;var x=t.updateQueue;if(x===null){var v=new Set;v.add(c),t.updateQueue=v}else x.add(c);break e}else{if(!(t&1)){E0(s,d,t),Mx();break e}c=Error(te(426))}}else if(Ye&&l.mode&1){var _=T0(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),R0(_,o,l,s,t),px(_s(c,l));break e}}s=c=_s(c,l),ft!==4&&(ft=2),To===null?To=[s]:To.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=yN(s,c,t);w0(s,g);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qn===null||!qn.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=bN(s,l,t);w0(s,w);break e}}s=s.return}while(s!==null)}zN(r)}catch(S){t=S,it===r&&r!==null&&(it=r=r.return);continue}break}while(!0)}function LN(){var e=Ql.current;return Ql.current=Xl,e===null?Xl:e}function Mx(){(ft===0||ft===3||ft===2)&&(ft=4),vt===null||!(ji&268435455)&&!(Lc&268435455)||Tn(vt,jt)}function ec(e,t){var r=Me;Me|=2;var n=LN();(vt!==e||jt!==t)&&(Zr=null,mi(e,t));do try{B3();break}catch(i){DN(e,i)}while(!0);if(mx(),Me=r,Ql.current=n,it!==null)throw Error(te(261));return vt=null,jt=0,ft}function B3(){for(;it!==null;)FN(it)}function H3(){for(;it!==null&&!hA();)FN(it)}function FN(e){var t=$N(e.alternate,e,Jt);e.memoizedProps=e.pendingProps,t===null?zN(e):it=t,Ex.current=null}function zN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=D3(r,t),r!==null){r.flags&=32767,it=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ft=6,it=null;return}}else if(r=O3(r,t,Jt),r!==null){it=r;return}if(t=t.sibling,t!==null){it=t;return}it=t=e}while(t!==null);ft===0&&(ft=5)}function ai(e,t,r){var n=qe,i=mr.transition;try{mr.transition=null,qe=1,W3(e,t,r,n)}finally{mr.transition=i,qe=n}return null}function W3(e,t,r,n){do ds();while(Pn!==null);if(Me&6)throw Error(te(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(SA(e,s),e===vt&&(it=vt=null,jt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Va||(Va=!0,BN(Ol,function(){return ds(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=mr.transition,mr.transition=null;var o=qe;qe=1;var l=Me;Me|=4,Ex.current=null,F3(e,r),MN(r,e),u3(Uv),Ll=!!Wv,Uv=Wv=null,e.current=r,z3(r),mA(),Me=l,qe=o,mr.transition=s}else e.current=r;if(Va&&(Va=!1,Pn=e,Jl=i),s=e.pendingLanes,s===0&&(qn=null),xA(r.stateNode),Gt(e,nt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Zl)throw Zl=!1,e=dg,dg=null,e;return Jl&1&&e.tag!==0&&ds(),s=e.pendingLanes,s&1?e===fg?Ro++:(Ro=0,fg=e):Ro=0,Jn(),null}function ds(){if(Pn!==null){var e=yk(Jl),t=mr.transition,r=qe;try{if(mr.transition=null,qe=16>e?16:e,Pn===null)var n=!1;else{if(e=Pn,Pn=null,Jl=0,Me&6)throw Error(te(331));var i=Me;for(Me|=4,le=e.current;le!==null;){var s=le,o=s.child;if(le.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(le=d;le!==null;){var u=le;switch(u.tag){case 0:case 11:case 15:Eo(8,u,s)}var f=u.child;if(f!==null)f.return=u,le=f;else for(;le!==null;){u=le;var p=u.sibling,h=u.return;if(RN(u),u===d){le=null;break}if(p!==null){p.return=h,le=p;break}le=h}}}var x=s.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,le=o;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Eo(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,le=g;break e}le=s.return}}var y=e.current;for(le=y;le!==null;){o=le;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,le=b;else e:for(o=y;le!==null;){if(l=le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Dc(9,l)}}catch(S){tt(l,l.return,S)}if(l===o){le=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,le=w;break e}le=l.return}}if(Me=i,Jn(),$r&&typeof $r.onPostCommitFiberRoot=="function")try{$r.onPostCommitFiberRoot(Ec,e)}catch{}n=!0}return n}finally{qe=r,mr.transition=t}}return!1}function H0(e,t,r){t=_s(r,t),t=yN(e,t,1),e=zn(e,t,1),t=Lt(),e!==null&&(ha(e,1,t),Gt(e,t))}function tt(e,t,r){if(e.tag===3)H0(e,e,r);else for(;t!==null;){if(t.tag===3){H0(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qn===null||!qn.has(n))){e=_s(r,e),e=bN(t,e,1),t=zn(t,e,1),e=Lt(),t!==null&&(ha(t,1,e),Gt(t,e));break}}t=t.return}}function U3(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Lt(),e.pingedLanes|=e.suspendedLanes&r,vt===e&&(jt&r)===r&&(ft===4||ft===3&&(jt&130023424)===jt&&500>nt()-Rx?mi(e,0):Tx|=r),Gt(e,t)}function qN(e,t){t===0&&(e.mode&1?(t=Da,Da<<=1,!(Da&130023424)&&(Da=4194304)):t=1);var r=Lt();e=dn(e,t),e!==null&&(ha(e,t,r),Gt(e,r))}function V3(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),qN(e,r)}function G3(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(te(314))}n!==null&&n.delete(t),qN(e,r)}var $N;$N=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ut.current)Bt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Bt=!1,P3(e,t,r);Bt=!!(e.flags&131072)}else Bt=!1,Ye&&t.flags&1048576&&Uk(t,Wl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;jl(e,t),e=t.pendingProps;var i=gs(t,It.current);us(t,r),i=jx(null,t,n,e,i,r);var s=Sx();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vt(n)?(s=!0,Bl(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,xx(t),i.updater=Oc,t.stateNode=i,i._reactInternals=t,eg(t,n,e,r),t=ng(null,t,n,!0,s,r)):(t.tag=0,Ye&&s&&dx(t),Ot(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(jl(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Y3(n),e=jr(n,e),i){case 0:t=rg(null,t,n,e,r);break e;case 1:t=M0(null,t,n,e,r);break e;case 11:t=A0(null,t,n,e,r);break e;case 14:t=I0(null,t,n,jr(n.type,e),r);break e}throw Error(te(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),rg(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),M0(e,t,n,i,r);case 3:e:{if(SN(t),e===null)throw Error(te(387));n=t.pendingProps,s=t.memoizedState,i=s.element,Qk(e,t),Gl(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=_s(Error(te(423)),t),t=P0(e,t,n,r,i);break e}else if(n!==i){i=_s(Error(te(424)),t),t=P0(e,t,n,r,i);break e}else for(tr=Fn(t.stateNode.containerInfo.firstChild),rr=t,Ye=!0,Nr=null,r=Yk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(xs(),n===i){t=fn(e,t,r);break e}Ot(e,t,n,r)}t=t.child}return t;case 5:return Zk(t),e===null&&Qv(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Vv(n,i)?o=null:s!==null&&Vv(n,s)&&(t.flags|=32),jN(e,t),Ot(e,t,o,r),t.child;case 6:return e===null&&Qv(t),null;case 13:return kN(e,t,r);case 4:return yx(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ys(t,null,n,r):Ot(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),A0(e,t,n,i,r);case 7:return Ot(e,t,t.pendingProps,r),t.child;case 8:return Ot(e,t,t.pendingProps.children,r),t.child;case 12:return Ot(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,We(Ul,n._currentValue),n._currentValue=o,s!==null)if(Rr(s.value,o)){if(s.children===i.children&&!Ut.current){t=fn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=an(-1,r&-r),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Zv(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(te(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Zv(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ot(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,us(t,r),i=vr(i),n=n(i),t.flags|=1,Ot(e,t,n,r),t.child;case 14:return n=t.type,i=jr(n,t.pendingProps),i=jr(n.type,i),I0(e,t,n,i,r);case 15:return _N(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:jr(n,i),jl(e,t),t.tag=1,Vt(n)?(e=!0,Bl(t)):e=!1,us(t,r),xN(t,n,i),eg(t,n,i,r),ng(null,t,n,!0,e,r);case 19:return NN(e,t,r);case 22:return wN(e,t,r)}throw Error(te(156,t.tag))};function BN(e,t){return mk(e,t)}function K3(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(e,t,r,n){return new K3(e,t,r,n)}function Px(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Y3(e){if(typeof e=="function")return Px(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Jg)return 11;if(e===ex)return 14}return 2}function Bn(e,t){var r=e.alternate;return r===null?(r=pr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Nl(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")Px(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ui:return vi(r.children,i,s,t);case Zg:o=8,i|=8;break;case Sv:return e=pr(12,r,t,i|2),e.elementType=Sv,e.lanes=s,e;case kv:return e=pr(13,r,t,i),e.elementType=kv,e.lanes=s,e;case Nv:return e=pr(19,r,t,i),e.elementType=Nv,e.lanes=s,e;case ZS:return Fc(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case XS:o=10;break e;case QS:o=9;break e;case Jg:o=11;break e;case ex:o=14;break e;case jn:o=16,n=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=pr(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function vi(e,t,r,n){return e=pr(7,e,n,t),e.lanes=r,e}function Fc(e,t,r,n){return e=pr(22,e,n,t),e.elementType=ZS,e.lanes=r,e.stateNode={isHidden:!1},e}function Qu(e,t,r){return e=pr(6,e,null,t),e.lanes=r,e}function Zu(e,t,r){return t=pr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function X3(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Iu(0),this.expirationTimes=Iu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Iu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ox(e,t,r,n,i,s,o,l,c){return e=new X3(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=pr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},xx(s),e}function Q3(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function HN(e){if(!e)return Kn;e=e._reactInternals;e:{if(Ei(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(Vt(r))return Hk(e,r,t)}return t}function WN(e,t,r,n,i,s,o,l,c){return e=Ox(r,n,!0,e,i,s,o,l,c),e.context=HN(null),r=e.current,n=Lt(),i=$n(r),s=an(n,i),s.callback=t??null,zn(r,s,i),e.current.lanes=i,ha(e,i,n),Gt(e,n),e}function zc(e,t,r,n){var i=t.current,s=Lt(),o=$n(i);return r=HN(r),t.context===null?t.context=r:t.pendingContext=r,t=an(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=zn(i,t,o),e!==null&&(Tr(e,i,o,s),bl(e,i,o)),o}function tc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function W0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Dx(e,t){W0(e,t),(e=e.alternate)&&W0(e,t)}function Z3(){return null}var UN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lx(e){this._internalRoot=e}qc.prototype.render=Lx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));zc(e,t,null,null)};qc.prototype.unmount=Lx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Si(function(){zc(null,e,null,null)}),t[un]=null}};function qc(e){this._internalRoot=e}qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wk();e={blockedOn:null,target:e,priority:t};for(var r=0;r<En.length&&t!==0&&t<En[r].priority;r++);En.splice(r,0,e),r===0&&Sk(e)}};function Fx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function U0(){}function J3(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var d=tc(o);s.call(d)}}var o=WN(t,n,e,0,null,!1,!1,"",U0);return e._reactRootContainer=o,e[un]=o.current,Ho(e.nodeType===8?e.parentNode:e),Si(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var d=tc(c);l.call(d)}}var c=Ox(e,0,!1,null,null,!1,!1,"",U0);return e._reactRootContainer=c,e[un]=c.current,Ho(e.nodeType===8?e.parentNode:e),Si(function(){zc(t,c,r,n)}),c}function Bc(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=tc(o);l.call(c)}}zc(t,o,e,i)}else o=J3(r,t,e,i,n);return tc(o)}bk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=uo(t.pendingLanes);r!==0&&(nx(t,r|1),Gt(t,nt()),!(Me&6)&&(ws=nt()+500,Jn()))}break;case 13:Si(function(){var n=dn(e,1);if(n!==null){var i=Lt();Tr(n,e,1,i)}}),Dx(e,1)}};ix=function(e){if(e.tag===13){var t=dn(e,134217728);if(t!==null){var r=Lt();Tr(t,e,134217728,r)}Dx(e,134217728)}};_k=function(e){if(e.tag===13){var t=$n(e),r=dn(e,t);if(r!==null){var n=Lt();Tr(r,e,t,n)}Dx(e,t)}};wk=function(){return qe};jk=function(e,t){var r=qe;try{return qe=e,t()}finally{qe=r}};Dv=function(e,t,r){switch(t){case"input":if(Tv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Ic(n);if(!i)throw Error(te(90));ek(n),Tv(n,i)}}}break;case"textarea":rk(e,r);break;case"select":t=r.value,t!=null&&os(e,!!r.multiple,t,!1)}};ck=Ax;uk=Si;var e5={usingClientEntryPoint:!1,Events:[va,Yi,Ic,ak,lk,Ax]},Ys={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t5={bundleType:Ys.bundleType,version:Ys.version,rendererPackageName:Ys.rendererPackageName,rendererConfig:Ys.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pk(e),e===null?null:e.stateNode},findFiberByHostInstance:Ys.findFiberByHostInstance||Z3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ga=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ga.isDisabled&&Ga.supportsFiber)try{Ec=Ga.inject(t5),$r=Ga}catch{}}sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e5;sr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fx(t))throw Error(te(200));return Q3(e,t,null,r)};sr.createRoot=function(e,t){if(!Fx(e))throw Error(te(299));var r=!1,n="",i=UN;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Ox(e,1,!1,null,null,r,!1,n,i),e[un]=t.current,Ho(e.nodeType===8?e.parentNode:e),new Lx(t)};sr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=pk(t),e=e===null?null:e.stateNode,e};sr.flushSync=function(e){return Si(e)};sr.hydrate=function(e,t,r){if(!$c(t))throw Error(te(200));return Bc(null,e,t,!0,r)};sr.hydrateRoot=function(e,t,r){if(!Fx(e))throw Error(te(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=UN;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=WN(t,null,e,1,r??null,i,!1,s,o),e[un]=t.current,Ho(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new qc(t)};sr.render=function(e,t,r){if(!$c(t))throw Error(te(200));return Bc(null,e,t,!1,r)};sr.unmountComponentAtNode=function(e){if(!$c(e))throw Error(te(40));return e._reactRootContainer?(Si(function(){Bc(null,null,e,!1,function(){e._reactRootContainer=null,e[un]=null})}),!0):!1};sr.unstable_batchedUpdates=Ax;sr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!$c(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return Bc(e,t,r,!1,n)};sr.version="18.3.1-next-f1338f8080-20240426";function VN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(VN)}catch(e){console.error(e)}}VN(),VS.exports=sr;var rs=VS.exports,V0=rs;wv.createRoot=V0.createRoot,wv.hydrateRoot=V0.hydrateRoot;function Yt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Yt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var GN={exports:{}},KN={},YN={exports:{}},XN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var js=m;function r5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var n5=typeof Object.is=="function"?Object.is:r5,i5=js.useState,s5=js.useEffect,o5=js.useLayoutEffect,a5=js.useDebugValue;function l5(e,t){var r=t(),n=i5({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return o5(function(){i.value=r,i.getSnapshot=t,Ju(i)&&s({inst:i})},[e,r,t]),s5(function(){return Ju(i)&&s({inst:i}),e(function(){Ju(i)&&s({inst:i})})},[e]),a5(r),r}function Ju(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n5(e,r)}catch{return!0}}function c5(e,t){return t()}var u5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c5:l5;XN.useSyncExternalStore=js.useSyncExternalStore!==void 0?js.useSyncExternalStore:u5;YN.exports=XN;var d5=YN.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hc=m,f5=d5;function p5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var h5=typeof Object.is=="function"?Object.is:p5,m5=f5.useSyncExternalStore,v5=Hc.useRef,g5=Hc.useEffect,x5=Hc.useMemo,y5=Hc.useDebugValue;KN.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=v5(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=x5(function(){function c(h){if(!d){if(d=!0,u=h,h=n(h),i!==void 0&&o.hasValue){var x=o.value;if(i(x,h))return f=x}return f=h}if(x=f,h5(u,h))return x;var v=n(h);return i!==void 0&&i(x,v)?(u=h,x):(u=h,f=v)}var d=!1,u,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,i]);var l=m5(e,s[0],s[1]);return g5(function(){o.hasValue=!0,o.value=l},[l]),y5(l),l};GN.exports=KN;var b5=GN.exports;const _5=Wg(b5),w5={},G0=e=>{let t;const r=new Set,n=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(x=>x(t,h))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>d,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(w5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,i,c);return c},j5=e=>e?G0(e):G0,{useDebugValue:S5}=V,{useSyncExternalStoreWithSelector:k5}=_5,N5=e=>e;function QN(e,t=N5,r){const n=k5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return S5(n),n}const K0=(e,t)=>{const r=j5(e),n=(i,s=t)=>QN(r,i,s);return Object.assign(n,r),n},C5=(e,t)=>e?K0(e,t):K0;function Mt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var E5={value:()=>{}};function Wc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Cl(r)}function Cl(e){this._=e}function T5(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Cl.prototype=Wc.prototype={constructor:Cl,on:function(e,t){var r=this._,n=T5(e+"",r),i,s=-1,o=n.length;if(arguments.length<2){for(;++s<o;)if((i=(e=n[s]).type)&&(i=R5(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=n[s]).type)r[i]=Y0(r[i],e.name,t);else if(t==null)for(i in r)r[i]=Y0(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Cl(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,s;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],n=0,i=s.length;n<i;++n)s[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,s=n.length;i<s;++i)n[i].value.apply(t,r)}};function R5(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function Y0(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=E5,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var mg="http://www.w3.org/1999/xhtml";const X0={svg:"http://www.w3.org/2000/svg",xhtml:mg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Uc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),X0.hasOwnProperty(t)?{space:X0[t],local:e}:e}function A5(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===mg&&t.documentElement.namespaceURI===mg?t.createElement(e):t.createElementNS(r,e)}}function I5(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ZN(e){var t=Uc(e);return(t.local?I5:A5)(t)}function M5(){}function zx(e){return e==null?M5:function(){return this.querySelector(e)}}function P5(e){typeof e!="function"&&(e=zx(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=new Array(o),c,d,u=0;u<o;++u)(c=s[u])&&(d=e.call(c,c.__data__,u,s))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new ir(n,this._parents)}function O5(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function D5(){return[]}function JN(e){return e==null?D5:function(){return this.querySelectorAll(e)}}function L5(e){return function(){return O5(e.apply(this,arguments))}}function F5(e){typeof e=="function"?e=L5(e):e=JN(e);for(var t=this._groups,r=t.length,n=[],i=[],s=0;s<r;++s)for(var o=t[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&(n.push(e.call(c,c.__data__,d,o)),i.push(c));return new ir(n,i)}function eC(e){return function(){return this.matches(e)}}function tC(e){return function(t){return t.matches(e)}}var z5=Array.prototype.find;function q5(e){return function(){return z5.call(this.children,e)}}function $5(){return this.firstElementChild}function B5(e){return this.select(e==null?$5:q5(typeof e=="function"?e:tC(e)))}var H5=Array.prototype.filter;function W5(){return Array.from(this.children)}function U5(e){return function(){return H5.call(this.children,e)}}function V5(e){return this.selectAll(e==null?W5:U5(typeof e=="function"?e:tC(e)))}function G5(e){typeof e!="function"&&(e=eC(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new ir(n,this._parents)}function rC(e){return new Array(e.length)}function K5(){return new ir(this._enter||this._groups.map(rC),this._parents)}function rc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rc.prototype={constructor:rc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Y5(e){return function(){return e}}function X5(e,t,r,n,i,s){for(var o=0,l,c=t.length,d=s.length;o<d;++o)(l=t[o])?(l.__data__=s[o],n[o]=l):r[o]=new rc(e,s[o]);for(;o<c;++o)(l=t[o])&&(i[o]=l)}function Q5(e,t,r,n,i,s,o){var l,c,d=new Map,u=t.length,f=s.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=o.call(c,c.__data__,l,t)+"",d.has(h)?i[l]=c:d.set(h,c));for(l=0;l<f;++l)h=o.call(e,s[l],l,s)+"",(c=d.get(h))?(n[l]=c,c.__data__=s[l],d.delete(h)):r[l]=new rc(e,s[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(i[l]=c)}function Z5(e){return e.__data__}function J5(e,t){if(!arguments.length)return Array.from(this,Z5);var r=t?Q5:X5,n=this._parents,i=this._groups;typeof e!="function"&&(e=Y5(e));for(var s=i.length,o=new Array(s),l=new Array(s),c=new Array(s),d=0;d<s;++d){var u=n[d],f=i[d],p=f.length,h=eI(e.call(u,u&&u.__data__,d,n)),x=h.length,v=l[d]=new Array(x),_=o[d]=new Array(x),g=c[d]=new Array(p);r(u,f,v,_,g,h,t);for(var y=0,b=0,w,S;y<x;++y)if(w=v[y]){for(y>=b&&(b=y+1);!(S=_[b])&&++b<x;);w._next=S||null}}return o=new ir(o,n),o._enter=l,o._exit=c,o}function eI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tI(){return new ir(this._exit||this._groups.map(rC),this._parents)}function rI(e,t,r){var n=this.enter(),i=this,s=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?s.remove():r(s),n&&i?n.merge(i).order():i}function nI(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,s=n.length,o=Math.min(i,s),l=new Array(i),c=0;c<o;++c)for(var d=r[c],u=n[c],f=d.length,p=l[c]=new Array(f),h,x=0;x<f;++x)(h=d[x]||u[x])&&(p[x]=h);for(;c<i;++c)l[c]=r[c];return new ir(l,this._parents)}function iI(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,s=n[i],o;--i>=0;)(o=n[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function sI(e){e||(e=oI);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,i=new Array(n),s=0;s<n;++s){for(var o=r[s],l=o.length,c=i[s]=new Array(l),d,u=0;u<l;++u)(d=o[u])&&(c[u]=d);c.sort(t)}return new ir(i,this._parents).order()}function oI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function aI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function lI(){return Array.from(this)}function cI(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null}function uI(){let e=0;for(const t of this)++e;return e}function dI(){return!this.node()}function fI(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],s=0,o=i.length,l;s<o;++s)(l=i[s])&&e.call(l,l.__data__,s,i);return this}function pI(e){return function(){this.removeAttribute(e)}}function hI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function mI(e,t){return function(){this.setAttribute(e,t)}}function vI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function gI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function xI(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function yI(e,t){var r=Uc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?hI:pI:typeof t=="function"?r.local?xI:gI:r.local?vI:mI)(r,t))}function nC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function bI(e){return function(){this.style.removeProperty(e)}}function _I(e,t,r){return function(){this.style.setProperty(e,t,r)}}function wI(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function jI(e,t,r){return arguments.length>1?this.each((t==null?bI:typeof t=="function"?wI:_I)(e,t,r??"")):Ss(this.node(),e)}function Ss(e,t){return e.style.getPropertyValue(t)||nC(e).getComputedStyle(e,null).getPropertyValue(t)}function SI(e){return function(){delete this[e]}}function kI(e,t){return function(){this[e]=t}}function NI(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function CI(e,t){return arguments.length>1?this.each((t==null?SI:typeof t=="function"?NI:kI)(e,t)):this.node()[e]}function iC(e){return e.trim().split(/^|\s+/)}function qx(e){return e.classList||new sC(e)}function sC(e){this._node=e,this._names=iC(e.getAttribute("class")||"")}sC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function oC(e,t){for(var r=qx(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function aC(e,t){for(var r=qx(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function EI(e){return function(){oC(this,e)}}function TI(e){return function(){aC(this,e)}}function RI(e,t){return function(){(t.apply(this,arguments)?oC:aC)(this,e)}}function AI(e,t){var r=iC(e+"");if(arguments.length<2){for(var n=qx(this.node()),i=-1,s=r.length;++i<s;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?RI:t?EI:TI)(r,t))}function II(){this.textContent=""}function MI(e){return function(){this.textContent=e}}function PI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function OI(e){return arguments.length?this.each(e==null?II:(typeof e=="function"?PI:MI)(e)):this.node().textContent}function DI(){this.innerHTML=""}function LI(e){return function(){this.innerHTML=e}}function FI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function zI(e){return arguments.length?this.each(e==null?DI:(typeof e=="function"?FI:LI)(e)):this.node().innerHTML}function qI(){this.nextSibling&&this.parentNode.appendChild(this)}function $I(){return this.each(qI)}function BI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function HI(){return this.each(BI)}function WI(e){var t=typeof e=="function"?e:ZN(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function UI(){return null}function VI(e,t){var r=typeof e=="function"?e:ZN(e),n=t==null?UI:typeof t=="function"?t:zx(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function GI(){var e=this.parentNode;e&&e.removeChild(this)}function KI(){return this.each(GI)}function YI(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function XI(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function QI(e){return this.select(e?XI:YI)}function ZI(e){return arguments.length?this.property("__data__",e):this.node().__data__}function JI(e){return function(t){e.call(this,t,this.__data__)}}function eM(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function tM(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,s;r<i;++r)s=t[r],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++n]=s;++n?t.length=n:delete this.__on}}}function rM(e,t,r){return function(){var n=this.__on,i,s=JI(t);if(n){for(var o=0,l=n.length;o<l;++o)if((i=n[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=r),i.value=t;return}}this.addEventListener(e.type,s,r),i={type:e.type,name:e.name,value:t,listener:s,options:r},n?n.push(i):this.__on=[i]}}function nM(e,t,r){var n=eM(e+""),i,s=n.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(i=0,u=l[c];i<s;++i)if((o=n[i]).type===u.type&&o.name===u.name)return u.value}return}for(l=t?rM:tM,i=0;i<s;++i)this.each(l(n[i],t,r));return this}function lC(e,t,r){var n=nC(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function iM(e,t){return function(){return lC(this,e,t)}}function sM(e,t){return function(){return lC(this,e,t.apply(this,arguments))}}function oM(e,t){return this.each((typeof t=="function"?sM:iM)(e,t))}function*aM(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,s=n.length,o;i<s;++i)(o=n[i])&&(yield o)}var cC=[null];function ir(e,t){this._groups=e,this._parents=t}function xa(){return new ir([[document.documentElement]],cC)}function lM(){return this}ir.prototype=xa.prototype={constructor:ir,select:P5,selectAll:F5,selectChild:B5,selectChildren:V5,filter:G5,data:J5,enter:K5,exit:tI,join:rI,merge:nI,selection:lM,order:iI,sort:sI,call:aI,nodes:lI,node:cI,size:uI,empty:dI,each:fI,attr:yI,style:jI,property:CI,classed:AI,text:OI,html:zI,raise:$I,lower:HI,append:WI,insert:VI,remove:KI,clone:QI,datum:ZI,on:nM,dispatch:oM,[Symbol.iterator]:aM};function fr(e){return typeof e=="string"?new ir([[document.querySelector(e)]],[document.documentElement]):new ir([[e]],cC)}function cM(e){let t;for(;t=e.sourceEvent;)e=t;return e}function kr(e,t){if(e=cM(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const uM={passive:!1},Zo={capture:!0,passive:!1};function ed(e){e.stopImmediatePropagation()}function fs(e){e.preventDefault(),e.stopImmediatePropagation()}function uC(e){var t=e.document.documentElement,r=fr(e).on("dragstart.drag",fs,Zo);"onselectstart"in t?r.on("selectstart.drag",fs,Zo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function dC(e,t){var r=e.document.documentElement,n=fr(e).on("dragstart.drag",null);t&&(n.on("click.drag",fs,Zo),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Ka=e=>()=>e;function vg(e,{sourceEvent:t,subject:r,target:n,identifier:i,active:s,x:o,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}vg.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function dM(e){return!e.ctrlKey&&!e.button}function fM(){return this.parentNode}function pM(e,t){return t??{x:e.x,y:e.y}}function hM(){return navigator.maxTouchPoints||"ontouchstart"in this}function mM(){var e=dM,t=fM,r=pM,n=hM,i={},s=Wc("start","drag","end"),o=0,l,c,d,u,f=0;function p(w){w.on("mousedown.drag",h).filter(n).on("touchstart.drag",_).on("touchmove.drag",g,uM).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,S){if(!(u||!e.call(this,w,S))){var k=b(this,t.call(this,w,S),w,S,"mouse");k&&(fr(w.view).on("mousemove.drag",x,Zo).on("mouseup.drag",v,Zo),uC(w.view),ed(w),d=!1,l=w.clientX,c=w.clientY,k("start",w))}}function x(w){if(fs(w),!d){var S=w.clientX-l,k=w.clientY-c;d=S*S+k*k>f}i.mouse("drag",w)}function v(w){fr(w.view).on("mousemove.drag mouseup.drag",null),dC(w.view,d),fs(w),i.mouse("end",w)}function _(w,S){if(e.call(this,w,S)){var k=w.changedTouches,N=t.call(this,w,S),E=k.length,j,R;for(j=0;j<E;++j)(R=b(this,N,w,S,k[j].identifier,k[j]))&&(ed(w),R("start",w,k[j]))}}function g(w){var S=w.changedTouches,k=S.length,N,E;for(N=0;N<k;++N)(E=i[S[N].identifier])&&(fs(w),E("drag",w,S[N]))}function y(w){var S=w.changedTouches,k=S.length,N,E;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),N=0;N<k;++N)(E=i[S[N].identifier])&&(ed(w),E("end",w,S[N]))}function b(w,S,k,N,E,j){var R=s.copy(),T=kr(j||k,S),D,q,C;if((C=r.call(w,new vg("beforestart",{sourceEvent:k,target:p,identifier:E,active:o,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),N))!=null)return D=C.x-T[0]||0,q=C.y-T[1]||0,function O(I,F,M){var A=T,L;switch(I){case"start":i[E]=O,L=o++;break;case"end":delete i[E],--o;case"drag":T=kr(M||F,S),L=o;break}R.call(I,w,new vg(I,{sourceEvent:F,subject:C,target:p,identifier:E,active:L,x:T[0]+D,y:T[1]+q,dx:T[0]-A[0],dy:T[1]-A[1],dispatch:R}),N)}}return p.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Ka(!!w),p):e},p.container=function(w){return arguments.length?(t=typeof w=="function"?w:Ka(w),p):t},p.subject=function(w){return arguments.length?(r=typeof w=="function"?w:Ka(w),p):r},p.touchable=function(w){return arguments.length?(n=typeof w=="function"?w:Ka(!!w),p):n},p.on=function(){var w=s.on.apply(s,arguments);return w===s?p:w},p.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,p):Math.sqrt(f)},p}function $x(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function fC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ya(){}var Jo=.7,nc=1/Jo,ps="\\s*([+-]?\\d+)\\s*",ea="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vM=/^#([0-9a-f]{3,8})$/,gM=new RegExp(`^rgb\\(${ps},${ps},${ps}\\)$`),xM=new RegExp(`^rgb\\(${Hr},${Hr},${Hr}\\)$`),yM=new RegExp(`^rgba\\(${ps},${ps},${ps},${ea}\\)$`),bM=new RegExp(`^rgba\\(${Hr},${Hr},${Hr},${ea}\\)$`),_M=new RegExp(`^hsl\\(${ea},${Hr},${Hr}\\)$`),wM=new RegExp(`^hsla\\(${ea},${Hr},${Hr},${ea}\\)$`),Q0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$x(ya,ta,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Z0,formatHex:Z0,formatHex8:jM,formatHsl:SM,formatRgb:J0,toString:J0});function Z0(){return this.rgb().formatHex()}function jM(){return this.rgb().formatHex8()}function SM(){return pC(this).formatHsl()}function J0(){return this.rgb().formatRgb()}function ta(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=vM.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?eb(t):r===3?new Ht(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ya(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ya(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=gM.exec(e))?new Ht(t[1],t[2],t[3],1):(t=xM.exec(e))?new Ht(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yM.exec(e))?Ya(t[1],t[2],t[3],t[4]):(t=bM.exec(e))?Ya(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_M.exec(e))?nb(t[1],t[2]/100,t[3]/100,1):(t=wM.exec(e))?nb(t[1],t[2]/100,t[3]/100,t[4]):Q0.hasOwnProperty(e)?eb(Q0[e]):e==="transparent"?new Ht(NaN,NaN,NaN,0):null}function eb(e){return new Ht(e>>16&255,e>>8&255,e&255,1)}function Ya(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ht(e,t,r,n)}function kM(e){return e instanceof ya||(e=ta(e)),e?(e=e.rgb(),new Ht(e.r,e.g,e.b,e.opacity)):new Ht}function gg(e,t,r,n){return arguments.length===1?kM(e):new Ht(e,t,r,n??1)}function Ht(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}$x(Ht,gg,fC(ya,{brighter(e){return e=e==null?nc:Math.pow(nc,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ht(gi(this.r),gi(this.g),gi(this.b),ic(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tb,formatHex:tb,formatHex8:NM,formatRgb:rb,toString:rb}));function tb(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function NM(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi((isNaN(this.opacity)?1:this.opacity)*255)}`}function rb(){const e=ic(this.opacity);return`${e===1?"rgb(":"rgba("}${gi(this.r)}, ${gi(this.g)}, ${gi(this.b)}${e===1?")":`, ${e})`}`}function ic(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function gi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fi(e){return e=gi(e),(e<16?"0":"")+e.toString(16)}function nb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Cr(e,t,r,n)}function pC(e){if(e instanceof Cr)return new Cr(e.h,e.s,e.l,e.opacity);if(e instanceof ya||(e=ta(e)),!e)return new Cr;if(e instanceof Cr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new Cr(o,l,c,e.opacity)}function CM(e,t,r,n){return arguments.length===1?pC(e):new Cr(e,t,r,n??1)}function Cr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}$x(Cr,CM,fC(ya,{brighter(e){return e=e==null?nc:Math.pow(nc,e),new Cr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Cr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Ht(td(e>=240?e-240:e+120,i,n),td(e,i,n),td(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Cr(ib(this.h),Xa(this.s),Xa(this.l),ic(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ic(this.opacity);return`${e===1?"hsl(":"hsla("}${ib(this.h)}, ${Xa(this.s)*100}%, ${Xa(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ib(e){return e=(e||0)%360,e<0?e+360:e}function Xa(e){return Math.max(0,Math.min(1,e||0))}function td(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const hC=e=>()=>e;function EM(e,t){return function(r){return e+r*t}}function TM(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function RM(e){return(e=+e)==1?mC:function(t,r){return r-t?TM(t,r,e):hC(isNaN(t)?r:t)}}function mC(e,t){var r=t-e;return r?EM(e,r):hC(isNaN(e)?t:e)}const sb=function e(t){var r=RM(t);function n(i,s){var o=r((i=gg(i)).r,(s=gg(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),d=mC(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=c(u),i.opacity=d(u),i+""}}return n.gamma=e,n}(1);function kn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var xg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rd=new RegExp(xg.source,"g");function AM(e){return function(){return e}}function IM(e){return function(t){return e(t)+""}}function MM(e,t){var r=xg.lastIndex=rd.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=xg.exec(e))&&(i=rd.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:kn(n,i)})),r=rd.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?IM(c[0].x):AM(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var ob=180/Math.PI,yg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function vC(e,t,r,n,i,s){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*ob,skewX:Math.atan(c)*ob,scaleX:o,scaleY:l}}var Qa;function PM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?yg:vC(t.a,t.b,t.c,t.d,t.e,t.f)}function OM(e){return e==null||(Qa||(Qa=document.createElementNS("http://www.w3.org/2000/svg","g")),Qa.setAttribute("transform",e),!(e=Qa.transform.baseVal.consolidate()))?yg:(e=e.matrix,vC(e.a,e.b,e.c,e.d,e.e,e.f))}function gC(e,t,r,n){function i(d){return d.length?d.pop()+" ":""}function s(d,u,f,p,h,x){if(d!==f||u!==p){var v=h.push("translate(",null,t,null,r);x.push({i:v-4,x:kn(d,f)},{i:v-2,x:kn(u,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function o(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(i(f)+"rotate(",null,n)-2,x:kn(d,u)})):u&&f.push(i(f)+"rotate("+u+n)}function l(d,u,f,p){d!==u?p.push({i:f.push(i(f)+"skewX(",null,n)-2,x:kn(d,u)}):u&&f.push(i(f)+"skewX("+u+n)}function c(d,u,f,p,h,x){if(d!==f||u!==p){var v=h.push(i(h)+"scale(",null,",",null,")");x.push({i:v-4,x:kn(d,f)},{i:v-2,x:kn(u,p)})}else(f!==1||p!==1)&&h.push(i(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),s(d.translateX,d.translateY,u.translateX,u.translateY,f,p),o(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var x=-1,v=p.length,_;++x<v;)f[(_=p[x]).i]=_.x(h);return f.join("")}}}var DM=gC(PM,"px, ","px)","deg)"),LM=gC(OM,", ",")",")"),FM=1e-12;function ab(e){return((e=Math.exp(e))+1/e)/2}function zM(e){return((e=Math.exp(e))-1/e)/2}function qM(e){return((e=Math.exp(2*e))-1)/(e+1)}const $M=function e(t,r,n){function i(s,o){var l=s[0],c=s[1],d=s[2],u=o[0],f=o[1],p=o[2],h=u-l,x=f-c,v=h*h+x*x,_,g;if(v<FM)g=Math.log(p/d)/t,_=function(N){return[l+N*h,c+N*x,d*Math.exp(t*N*g)]};else{var y=Math.sqrt(v),b=(p*p-d*d+n*v)/(2*d*r*y),w=(p*p-d*d-n*v)/(2*p*r*y),S=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(w*w+1)-w);g=(k-S)/t,_=function(N){var E=N*g,j=ab(S),R=d/(r*y)*(j*qM(t*E+S)-zM(S));return[l+R*h,c+R*x,d*j/ab(t*E+S)]}}return _.duration=g*1e3*t/Math.SQRT2,_}return i.rho=function(s){var o=Math.max(.001,+s),l=o*o,c=l*l;return e(o,l,c)},i}(Math.SQRT2,2,4);var ks=0,po=0,Xs=0,xC=1e3,sc,ho,oc=0,ki=0,Vc=0,ra=typeof performance=="object"&&performance.now?performance:Date,yC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Bx(){return ki||(yC(BM),ki=ra.now()+Vc)}function BM(){ki=0}function ac(){this._call=this._time=this._next=null}ac.prototype=bC.prototype={constructor:ac,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Bx():+r)+(t==null?0:+t),!this._next&&ho!==this&&(ho?ho._next=this:sc=this,ho=this),this._call=e,this._time=r,bg()},stop:function(){this._call&&(this._call=null,this._time=1/0,bg())}};function bC(e,t,r){var n=new ac;return n.restart(e,t,r),n}function HM(){Bx(),++ks;for(var e=sc,t;e;)(t=ki-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ks}function lb(){ki=(oc=ra.now())+Vc,ks=po=0;try{HM()}finally{ks=0,UM(),ki=0}}function WM(){var e=ra.now(),t=e-oc;t>xC&&(Vc-=t,oc=e)}function UM(){for(var e,t=sc,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:sc=r);ho=e,bg(n)}function bg(e){if(!ks){po&&(po=clearTimeout(po));var t=e-ki;t>24?(e<1/0&&(po=setTimeout(lb,e-ra.now()-Vc)),Xs&&(Xs=clearInterval(Xs))):(Xs||(oc=ra.now(),Xs=setInterval(WM,xC)),ks=1,yC(lb))}}function cb(e,t,r){var n=new ac;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var VM=Wc("start","end","cancel","interrupt"),GM=[],_C=0,ub=1,_g=2,El=3,db=4,wg=5,Tl=6;function Gc(e,t,r,n,i,s){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;KM(e,r,{name:t,index:n,group:i,on:VM,tween:GM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:_C})}function Hx(e,t){var r=Ir(e,t);if(r.state>_C)throw new Error("too late; already scheduled");return r}function Gr(e,t){var r=Ir(e,t);if(r.state>El)throw new Error("too late; already running");return r}function Ir(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function KM(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=bC(s,0,r.time);function s(d){r.state=ub,r.timer.restart(o,r.delay,r.time),r.delay<=d&&o(d-r.delay)}function o(d){var u,f,p,h;if(r.state!==ub)return c();for(u in n)if(h=n[u],h.name===r.name){if(h.state===El)return cb(o);h.state===db?(h.state=Tl,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[u]):+u<t&&(h.state=Tl,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[u])}if(cb(function(){r.state===El&&(r.state=db,r.timer.restart(l,r.delay,r.time),l(d))}),r.state=_g,r.on.call("start",e,e.__data__,r.index,r.group),r.state===_g){for(r.state=El,i=new Array(p=r.tween.length),u=0,f=-1;u<p;++u)(h=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(i[++f]=h);i.length=f+1}}function l(d){for(var u=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(c),r.state=wg,1),f=-1,p=i.length;++f<p;)i[f].call(e,u);r.state===wg&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Tl,r.timer.stop(),delete n[t];for(var d in n)return;delete e.__transition}}function Rl(e,t){var r=e.__transition,n,i,s=!0,o;if(r){t=t==null?null:t+"";for(o in r){if((n=r[o]).name!==t){s=!1;continue}i=n.state>_g&&n.state<wg,n.state=Tl,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[o]}s&&delete e.__transition}}function YM(e){return this.each(function(){Rl(this,e)})}function XM(e,t){var r,n;return function(){var i=Gr(this,e),s=i.tween;if(s!==r){n=r=s;for(var o=0,l=n.length;o<l;++o)if(n[o].name===t){n=n.slice(),n.splice(o,1);break}}i.tween=n}}function QM(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var s=Gr(this,e),o=s.tween;if(o!==n){i=(n=o).slice();for(var l={name:t,value:r},c=0,d=i.length;c<d;++c)if(i[c].name===t){i[c]=l;break}c===d&&i.push(l)}s.tween=i}}function ZM(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Ir(this.node(),r).tween,i=0,s=n.length,o;i<s;++i)if((o=n[i]).name===e)return o.value;return null}return this.each((t==null?XM:QM)(r,e,t))}function Wx(e,t,r){var n=e._id;return e.each(function(){var i=Gr(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return Ir(i,n).value[t]}}function wC(e,t){var r;return(typeof t=="number"?kn:t instanceof ta?sb:(r=ta(t))?(t=r,sb):MM)(e,t)}function JM(e){return function(){this.removeAttribute(e)}}function eP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tP(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===n?s:s=t(n=o,r)}}function rP(e,t,r){var n,i=r+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===n?s:s=t(n=o,r)}}function nP(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function iP(e,t,r){var n,i,s;return function(){var o,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l)))}}function sP(e,t){var r=Uc(e),n=r==="transform"?LM:wC;return this.attrTween(e,typeof t=="function"?(r.local?iP:nP)(r,n,Wx(this,"attr."+e,t)):t==null?(r.local?eP:JM)(r):(r.local?rP:tP)(r,n,t))}function oP(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function aP(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function lP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&aP(e,s)),r}return i._value=t,i}function cP(e,t){var r,n;function i(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&oP(e,s)),r}return i._value=t,i}function uP(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Uc(e);return this.tween(r,(n.local?lP:cP)(n,t))}function dP(e,t){return function(){Hx(this,e).delay=+t.apply(this,arguments)}}function fP(e,t){return t=+t,function(){Hx(this,e).delay=t}}function pP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dP:fP)(t,e)):Ir(this.node(),t).delay}function hP(e,t){return function(){Gr(this,e).duration=+t.apply(this,arguments)}}function mP(e,t){return t=+t,function(){Gr(this,e).duration=t}}function vP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hP:mP)(t,e)):Ir(this.node(),t).duration}function gP(e,t){if(typeof t!="function")throw new Error;return function(){Gr(this,e).ease=t}}function xP(e){var t=this._id;return arguments.length?this.each(gP(t,e)):Ir(this.node(),t).ease}function yP(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Gr(this,e).ease=r}}function bP(e){if(typeof e!="function")throw new Error;return this.each(yP(this._id,e))}function _P(e){typeof e!="function"&&(e=eC(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var s=t[i],o=s.length,l=n[i]=[],c,d=0;d<o;++d)(c=s[d])&&e.call(c,c.__data__,d,s)&&l.push(c);return new pn(n,this._parents,this._name,this._id)}function wP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,s=Math.min(n,i),o=new Array(n),l=0;l<s;++l)for(var c=t[l],d=r[l],u=c.length,f=o[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<n;++l)o[l]=t[l];return new pn(o,this._parents,this._name,this._id)}function jP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function SP(e,t,r){var n,i,s=jP(t)?Hx:Gr;return function(){var o=s(this,e),l=o.on;l!==n&&(i=(n=l).copy()).on(t,r),o.on=i}}function kP(e,t){var r=this._id;return arguments.length<2?Ir(this.node(),r).on.on(e):this.each(SP(r,e,t))}function NP(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function CP(){return this.on("end.remove",NP(this._id))}function EP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=zx(e));for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o)for(var l=n[o],c=l.length,d=s[o]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,Gc(d[p],t,r,p,d,Ir(u,r)));return new pn(s,this._parents,t,r)}function TP(e){var t=this._name,r=this._id;typeof e!="function"&&(e=JN(e));for(var n=this._groups,i=n.length,s=[],o=[],l=0;l<i;++l)for(var c=n[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,x=Ir(u,r),v=0,_=p.length;v<_;++v)(h=p[v])&&Gc(h,t,r,v,p,x);s.push(p),o.push(u)}return new pn(s,o,t,r)}var RP=xa.prototype.constructor;function AP(){return new RP(this._groups,this._parents)}function IP(e,t){var r,n,i;return function(){var s=Ss(this,e),o=(this.style.removeProperty(e),Ss(this,e));return s===o?null:s===r&&o===n?i:i=t(r=s,n=o)}}function jC(e){return function(){this.style.removeProperty(e)}}function MP(e,t,r){var n,i=r+"",s;return function(){var o=Ss(this,e);return o===i?null:o===n?s:s=t(n=o,r)}}function PP(e,t,r){var n,i,s;return function(){var o=Ss(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Ss(this,e))),o===c?null:o===n&&c===i?s:(i=c,s=t(n=o,l))}}function OP(e,t){var r,n,i,s="style."+t,o="end."+s,l;return function(){var c=Gr(this,e),d=c.on,u=c.value[s]==null?l||(l=jC(t)):void 0;(d!==r||i!==u)&&(n=(r=d).copy()).on(o,i=u),c.on=n}}function DP(e,t,r){var n=(e+="")=="transform"?DM:wC;return t==null?this.styleTween(e,IP(e,n)).on("end.style."+e,jC(e)):typeof t=="function"?this.styleTween(e,PP(e,n,Wx(this,"style."+e,t))).each(OP(this._id,e)):this.styleTween(e,MP(e,n,t),r).on("end.style."+e,null)}function LP(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function FP(e,t,r){var n,i;function s(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&LP(e,o,r)),n}return s._value=t,s}function zP(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,FP(e,t,r??""))}function qP(e){return function(){this.textContent=e}}function $P(e){return function(){var t=e(this);this.textContent=t??""}}function BP(e){return this.tween("text",typeof e=="function"?$P(Wx(this,"text",e)):qP(e==null?"":e+""))}function HP(e){return function(t){this.textContent=e.call(this,t)}}function WP(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&HP(i)),t}return n._value=e,n}function UP(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,WP(e))}function VP(){for(var e=this._name,t=this._id,r=SC(),n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,d=0;d<l;++d)if(c=o[d]){var u=Ir(c,t);Gc(c,e,r,d,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new pn(n,this._parents,e,r)}function GP(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(s,o){var l={value:o},c={value:function(){--i===0&&s()}};r.each(function(){var d=Gr(this,n),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),i===0&&s()})}var KP=0;function pn(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function SC(){return++KP}var Yr=xa.prototype;pn.prototype={constructor:pn,select:EP,selectAll:TP,selectChild:Yr.selectChild,selectChildren:Yr.selectChildren,filter:_P,merge:wP,selection:AP,transition:VP,call:Yr.call,nodes:Yr.nodes,node:Yr.node,size:Yr.size,empty:Yr.empty,each:Yr.each,on:kP,attr:sP,attrTween:uP,style:DP,styleTween:zP,text:BP,textTween:UP,remove:CP,tween:ZM,delay:pP,duration:vP,ease:xP,easeVarying:bP,end:GP,[Symbol.iterator]:Yr[Symbol.iterator]};function YP(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var XP={time:null,delay:0,duration:250,ease:YP};function QP(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function ZP(e){var t,r;e instanceof pn?(t=e._id,e=e._name):(t=SC(),(r=XP).time=Bx(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],l=o.length,c,d=0;d<l;++d)(c=o[d])&&Gc(c,e,t,d,o,r||QP(c,t));return new pn(n,this._parents,e,t)}xa.prototype.interrupt=YM;xa.prototype.transition=ZP;const Za=e=>()=>e;function JP(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function nn(e,t,r){this.k=e,this.x=t,this.y=r}nn.prototype={constructor:nn,scale:function(e){return e===1?this:new nn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new nn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ln=new nn(1,0,0);nn.prototype;function nd(e){e.stopImmediatePropagation()}function Qs(e){e.preventDefault(),e.stopImmediatePropagation()}function eO(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function tO(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function fb(){return this.__zoom||ln}function rO(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function nO(){return navigator.maxTouchPoints||"ontouchstart"in this}function iO(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],s=e.invertY(t[0][1])-r[0][1],o=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function kC(){var e=eO,t=tO,r=iO,n=rO,i=nO,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=$M,d=Wc("start","zoom","end"),u,f,p,h=500,x=150,v=0,_=10;function g(C){C.property("__zoom",fb).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",R).filter(i).on("touchstart.zoom",T).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(C,O,I,F){var M=C.selection?C.selection():C;M.property("__zoom",fb),C!==M?S(C,O,I,F):M.interrupt().each(function(){k(this,arguments).event(F).start().zoom(null,typeof O=="function"?O.apply(this,arguments):O).end()})},g.scaleBy=function(C,O,I,F){g.scaleTo(C,function(){var M=this.__zoom.k,A=typeof O=="function"?O.apply(this,arguments):O;return M*A},I,F)},g.scaleTo=function(C,O,I,F){g.transform(C,function(){var M=t.apply(this,arguments),A=this.__zoom,L=I==null?w(M):typeof I=="function"?I.apply(this,arguments):I,z=A.invert(L),B=typeof O=="function"?O.apply(this,arguments):O;return r(b(y(A,B),L,z),M,o)},I,F)},g.translateBy=function(C,O,I,F){g.transform(C,function(){return r(this.__zoom.translate(typeof O=="function"?O.apply(this,arguments):O,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),o)},null,F)},g.translateTo=function(C,O,I,F,M){g.transform(C,function(){var A=t.apply(this,arguments),L=this.__zoom,z=F==null?w(A):typeof F=="function"?F.apply(this,arguments):F;return r(ln.translate(z[0],z[1]).scale(L.k).translate(typeof O=="function"?-O.apply(this,arguments):-O,typeof I=="function"?-I.apply(this,arguments):-I),A,o)},F,M)};function y(C,O){return O=Math.max(s[0],Math.min(s[1],O)),O===C.k?C:new nn(O,C.x,C.y)}function b(C,O,I){var F=O[0]-I[0]*C.k,M=O[1]-I[1]*C.k;return F===C.x&&M===C.y?C:new nn(C.k,F,M)}function w(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function S(C,O,I,F){C.on("start.zoom",function(){k(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(F).end()}).tween("zoom",function(){var M=this,A=arguments,L=k(M,A).event(F),z=t.apply(M,A),B=I==null?w(z):typeof I=="function"?I.apply(M,A):I,X=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),Y=M.__zoom,W=typeof O=="function"?O.apply(M,A):O,$=c(Y.invert(B).concat(X/Y.k),W.invert(B).concat(X/W.k));return function(Q){if(Q===1)Q=W;else{var se=$(Q),ae=X/se[2];Q=new nn(ae,B[0]-se[0]*ae,B[1]-se[1]*ae)}L.zoom(null,Q)}})}function k(C,O,I){return!I&&C.__zooming||new N(C,O)}function N(C,O){this.that=C,this.args=O,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,O),this.taps=0}N.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,O){return this.mouse&&C!=="mouse"&&(this.mouse[1]=O.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=O.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=O.invert(this.touch1[0])),this.that.__zoom=O,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var O=fr(this.that).datum();d.call(C,this.that,new JP(C,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:d}),O)}};function E(C,...O){if(!e.apply(this,arguments))return;var I=k(this,O).event(C),F=this.__zoom,M=Math.max(s[0],Math.min(s[1],F.k*Math.pow(2,n.apply(this,arguments)))),A=kr(C);if(I.wheel)(I.mouse[0][0]!==A[0]||I.mouse[0][1]!==A[1])&&(I.mouse[1]=F.invert(I.mouse[0]=A)),clearTimeout(I.wheel);else{if(F.k===M)return;I.mouse=[A,F.invert(A)],Rl(this),I.start()}Qs(C),I.wheel=setTimeout(L,x),I.zoom("mouse",r(b(y(F,M),I.mouse[0],I.mouse[1]),I.extent,o));function L(){I.wheel=null,I.end()}}function j(C,...O){if(p||!e.apply(this,arguments))return;var I=C.currentTarget,F=k(this,O,!0).event(C),M=fr(C.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",X,!0),A=kr(C,I),L=C.clientX,z=C.clientY;uC(C.view),nd(C),F.mouse=[A,this.__zoom.invert(A)],Rl(this),F.start();function B(Y){if(Qs(Y),!F.moved){var W=Y.clientX-L,$=Y.clientY-z;F.moved=W*W+$*$>v}F.event(Y).zoom("mouse",r(b(F.that.__zoom,F.mouse[0]=kr(Y,I),F.mouse[1]),F.extent,o))}function X(Y){M.on("mousemove.zoom mouseup.zoom",null),dC(Y.view,F.moved),Qs(Y),F.event(Y).end()}}function R(C,...O){if(e.apply(this,arguments)){var I=this.__zoom,F=kr(C.changedTouches?C.changedTouches[0]:C,this),M=I.invert(F),A=I.k*(C.shiftKey?.5:2),L=r(b(y(I,A),F,M),t.apply(this,O),o);Qs(C),l>0?fr(this).transition().duration(l).call(S,L,F,C):fr(this).call(g.transform,L,F,C)}}function T(C,...O){if(e.apply(this,arguments)){var I=C.touches,F=I.length,M=k(this,O,C.changedTouches.length===F).event(C),A,L,z,B;for(nd(C),L=0;L<F;++L)z=I[L],B=kr(z,this),B=[B,this.__zoom.invert(B),z.identifier],M.touch0?!M.touch1&&M.touch0[2]!==B[2]&&(M.touch1=B,M.taps=0):(M.touch0=B,A=!0,M.taps=1+!!u);u&&(u=clearTimeout(u)),A&&(M.taps<2&&(f=B[0],u=setTimeout(function(){u=null},h)),Rl(this),M.start())}}function D(C,...O){if(this.__zooming){var I=k(this,O).event(C),F=C.changedTouches,M=F.length,A,L,z,B;for(Qs(C),A=0;A<M;++A)L=F[A],z=kr(L,this),I.touch0&&I.touch0[2]===L.identifier?I.touch0[0]=z:I.touch1&&I.touch1[2]===L.identifier&&(I.touch1[0]=z);if(L=I.that.__zoom,I.touch1){var X=I.touch0[0],Y=I.touch0[1],W=I.touch1[0],$=I.touch1[1],Q=(Q=W[0]-X[0])*Q+(Q=W[1]-X[1])*Q,se=(se=$[0]-Y[0])*se+(se=$[1]-Y[1])*se;L=y(L,Math.sqrt(Q/se)),z=[(X[0]+W[0])/2,(X[1]+W[1])/2],B=[(Y[0]+$[0])/2,(Y[1]+$[1])/2]}else if(I.touch0)z=I.touch0[0],B=I.touch0[1];else return;I.zoom("touch",r(b(L,z,B),I.extent,o))}}function q(C,...O){if(this.__zooming){var I=k(this,O).event(C),F=C.changedTouches,M=F.length,A,L;for(nd(C),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),A=0;A<M;++A)L=F[A],I.touch0&&I.touch0[2]===L.identifier?delete I.touch0:I.touch1&&I.touch1[2]===L.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(L=kr(L,this),Math.hypot(f[0]-L[0],f[1]-L[1])<_)){var z=fr(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return g.wheelDelta=function(C){return arguments.length?(n=typeof C=="function"?C:Za(+C),g):n},g.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Za(!!C),g):e},g.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:Za(!!C),g):i},g.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Za([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),g):t},g.scaleExtent=function(C){return arguments.length?(s[0]=+C[0],s[1]=+C[1],g):[s[0],s[1]]},g.translateExtent=function(C){return arguments.length?(o[0][0]=+C[0][0],o[1][0]=+C[1][0],o[0][1]=+C[0][1],o[1][1]=+C[1][1],g):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},g.constrain=function(C){return arguments.length?(r=C,g):r},g.duration=function(C){return arguments.length?(l=+C,g):l},g.interpolate=function(C){return arguments.length?(c=C,g):c},g.on=function(){var C=d.on.apply(d,arguments);return C===d?g:C},g.clickDistance=function(C){return arguments.length?(v=(C=+C)*C,g):Math.sqrt(v)},g.tapDistance=function(C){return arguments.length?(_=+C,g):_},g}const Kc=m.createContext(null),sO=Kc.Provider,hn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},NC=hn.error001();function Xe(e,t){const r=m.useContext(Kc);if(r===null)throw new Error(NC);return QN(r,e,t)}const gt=()=>{const e=m.useContext(Kc);if(e===null)throw new Error(NC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},oO=e=>e.userSelectionActive?"none":"all";function Hn({position:e,children:t,className:r,style:n,...i}){const s=Xe(oO),o=`${e}`.split("-");return V.createElement("div",{className:Yt(["react-flow__panel",r,...o]),style:{...n,pointerEvents:s},...i},t)}function aO({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:V.createElement(Hn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},V.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const lO=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),x=Yt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const v=f.current.getBBox();h({x:v.x,y:v.y,width:v.width,height:v.height})}},[r]),typeof r>"u"||!r?null:V.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:x,visibility:p.width?"visible":"hidden",...u},i&&V.createElement("rect",{width:p.width+2*o[0],x:-o[0],y:-o[1],height:p.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),V.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var cO=m.memo(lO);const Ux=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ns=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Vx=(e={x:0,y:0},t)=>({x:Ns(e.x,t[0][0],t[1][0]),y:Ns(e.y,t[0][1],t[1][1])}),pb=(e,t,r)=>e<t?Ns(Math.abs(e-t),1,50)/50:e>r?-Ns(Math.abs(e-r),1,50)/50:0,CC=(e,t)=>{const r=pb(e.x,35,t.width-35)*20,n=pb(e.y,35,t.height-35)*20;return[r,n]},EC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},TC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),na=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),RC=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),hb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),uO=(e,t)=>RC(TC(na(e),na(t))),jg=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},dO=e=>hr(e.width)&&hr(e.height)&&hr(e.x)&&hr(e.y),hr=e=>!isNaN(e)&&isFinite(e),rt=Symbol.for("internals"),AC=["Enter"," ","Escape"],fO=(e,t)=>{},pO=e=>"nativeEvent"in e;function Sg(e){var i,s;const t=pO(e)?e.nativeEvent:e,r=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const IC=e=>"clientX"in e,Wn=(e,t)=>{var s,o;const r=IC(e),n=r?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=r?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},lc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},ba=({id:e,path:t,labelX:r,labelY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>V.createElement(V.Fragment,null,V.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&V.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&hr(r)&&hr(n)?V.createElement(cO,{x:r,y:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);ba.displayName="BaseEdge";function Zs(e,t,r){return r===void 0?r:n=>{const i=t().edges.find(s=>s.id===e);i&&r(n,{...i})}}function MC({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,s=r<e?r+i:r-i,o=Math.abs(n-t)/2,l=n<t?n+o:n-o;return[s,l,i,o]}function PC({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:l}){const c=e*.125+i*.375+o*.375+r*.125,d=t*.125+s*.375+l*.375+n*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Ni;(function(e){e.Strict="strict",e.Loose="loose"})(Ni||(Ni={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var ia;(function(e){e.Partial="partial",e.Full="full"})(ia||(ia={}));var Rn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Rn||(Rn={}));var cc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(cc||(cc={}));var ce;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ce||(ce={}));function mb({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===ce.Left||e===ce.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function OC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:i,targetPosition:s=ce.Top}){const[o,l]=mb({pos:r,x1:e,y1:t,x2:n,y2:i}),[c,d]=mb({pos:s,x1:n,y1:i,x2:e,y2:t}),[u,f,p,h]=PC({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${o},${l} ${c},${d} ${n},${i}`,u,f,p,h]}const Gx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=ce.Bottom,targetPosition:s=ce.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:v})=>{const[_,g,y]=OC({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s});return V.createElement(ba,{path:_,labelX:g,labelY:y,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:v})});Gx.displayName="SimpleBezierEdge";const vb={[ce.Left]:{x:-1,y:0},[ce.Right]:{x:1,y:0},[ce.Top]:{x:0,y:-1},[ce.Bottom]:{x:0,y:1}},hO=({source:e,sourcePosition:t=ce.Bottom,target:r})=>t===ce.Left||t===ce.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},gb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function mO({source:e,sourcePosition:t=ce.Bottom,target:r,targetPosition:n=ce.Top,center:i,offset:s}){const o=vb[t],l=vb[n],c={x:e.x+o.x*s,y:e.y+o.y*s},d={x:r.x+l.x*s,y:r.y+l.y*s},u=hO({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],x,v;const _={x:0,y:0},g={x:0,y:0},[y,b,w,S]=MC({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(o[f]*l[f]===-1){x=i.x??y,v=i.y??b;const N=[{x,y:c.y},{x,y:d.y}],E=[{x:c.x,y:v},{x:d.x,y:v}];o[f]===p?h=f==="x"?N:E:h=f==="x"?E:N}else{const N=[{x:c.x,y:d.y}],E=[{x:d.x,y:c.y}];if(f==="x"?h=o.x===p?E:N:h=o.y===p?N:E,t===n){const q=Math.abs(e[f]-r[f]);if(q<=s){const C=Math.min(s-1,s-q);o[f]===p?_[f]=(c[f]>e[f]?-1:1)*C:g[f]=(d[f]>r[f]?-1:1)*C}}if(t!==n){const q=f==="x"?"y":"x",C=o[f]===l[q],O=c[q]>d[q],I=c[q]<d[q];(o[f]===1&&(!C&&O||C&&I)||o[f]!==1&&(!C&&I||C&&O))&&(h=f==="x"?N:E)}const j={x:c.x+_.x,y:c.y+_.y},R={x:d.x+g.x,y:d.y+g.y},T=Math.max(Math.abs(j.x-h[0].x),Math.abs(R.x-h[0].x)),D=Math.max(Math.abs(j.y-h[0].y),Math.abs(R.y-h[0].y));T>=D?(x=(j.x+R.x)/2,v=h[0].y):(x=h[0].x,v=(j.y+R.y)/2)}return[[e,{x:c.x+_.x,y:c.y+_.y},...h,{x:d.x+g.x,y:d.y+g.y},r],x,v,w,S]}function vO(e,t,r,n){const i=Math.min(gb(e,t)/2,gb(t,r)/2,n),{x:s,y:o}=t;if(e.x===s&&s===r.x||e.y===o&&o===r.y)return`L${s} ${o}`;if(e.y===o){const d=e.x<r.x?-1:1,u=e.y<r.y?1:-1;return`L ${s+i*d},${o}Q ${s},${o} ${s},${o+i*u}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*l},${o}`}function kg({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:i,targetPosition:s=ce.Top,borderRadius:o=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,x]=mO({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:s,center:{x:l,y:c},offset:d});return[u.reduce((_,g,y)=>{let b="";return y>0&&y<u.length-1?b=vO(u[y-1],g,u[y+1],o):b=`${y===0?"M":"L"}${g.x} ${g.y}`,_+=b,_},""),f,p,h,x]}const Yc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=ce.Bottom,targetPosition:p=ce.Top,markerEnd:h,markerStart:x,pathOptions:v,interactionWidth:_})=>{const[g,y,b]=kg({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:v==null?void 0:v.borderRadius,offset:v==null?void 0:v.offset});return V.createElement(ba,{path:g,labelX:y,labelY:b,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:x,interactionWidth:_})});Yc.displayName="SmoothStepEdge";const Kx=m.memo(e=>{var t;return V.createElement(Yc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Kx.displayName="StepEdge";function gO({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,s,o,l]=MC({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,s,o,l]}const Yx=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[x,v,_]=gO({sourceX:e,sourceY:t,targetX:r,targetY:n});return V.createElement(ba,{path:x,labelX:v,labelY:_,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});Yx.displayName="StraightEdge";function Ja(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function xb({pos:e,x1:t,y1:r,x2:n,y2:i,c:s}){switch(e){case ce.Left:return[t-Ja(t-n,s),r];case ce.Right:return[t+Ja(n-t,s),r];case ce.Top:return[t,r-Ja(r-i,s)];case ce.Bottom:return[t,r+Ja(i-r,s)]}}function DC({sourceX:e,sourceY:t,sourcePosition:r=ce.Bottom,targetX:n,targetY:i,targetPosition:s=ce.Top,curvature:o=.25}){const[l,c]=xb({pos:r,x1:e,y1:t,x2:n,y2:i,c:o}),[d,u]=xb({pos:s,x1:n,y1:i,x2:e,y2:t,c:o}),[f,p,h,x]=PC({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${n},${i}`,f,p,h,x]}const uc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:i=ce.Bottom,targetPosition:s=ce.Top,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,pathOptions:v,interactionWidth:_})=>{const[g,y,b]=DC({sourceX:e,sourceY:t,sourcePosition:i,targetX:r,targetY:n,targetPosition:s,curvature:v==null?void 0:v.curvature});return V.createElement(ba,{path:g,labelX:y,labelY:b,label:o,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:x,interactionWidth:_})});uc.displayName="BezierEdge";const Xx=m.createContext(null),xO=Xx.Provider;Xx.Consumer;const yO=()=>m.useContext(Xx),bO=e=>"id"in e&&"source"in e&&"target"in e,_O=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Ng=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,wO=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),jO=(e,t)=>{if(!e.source||!e.target)return t;let r;return bO(e)?r={...e}:r={...e,id:_O(e)},wO(r,t)?t:t.concat(r)},Cg=({x:e,y:t},[r,n,i],s,[o,l])=>{const c={x:(e-r)/i,y:(t-n)/i};return s?{x:o*Math.round(c.x/o),y:l*Math.round(c.y/l)}:c},LC=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n}),xi=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],i={x:e.position.x-r,y:e.position.y-n};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:i}},Xc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const{x:s,y:o}=xi(i,t).positionAbsolute;return TC(n,na({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return RC(r)},FC=(e,t,[r,n,i]=[0,0,1],s=!1,o=!1,l=[0,0])=>{const c={x:(t.x-r)/i,y:(t.y-n)/i,width:t.width/i,height:t.height/i},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:x=!1}=u;if(o&&!h||x)return!1;const{positionAbsolute:v}=xi(u,l),_={x:v.x,y:v.y,width:f||0,height:p||0},g=jg(c,_),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=s&&g>0,w=(f||0)*(p||0);(y||b||g>=w||u.dragging)&&d.push(u)}),d},zC=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},qC=(e,t,r,n,i,s=.1)=>{const o=t/(e.width*(1+s)),l=r/(e.height*(1+s)),c=Math.min(o,l),d=Ns(c,n,i),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=r/2-f*d;return{x:p,y:h,zoom:d}},li=(e,t=0)=>e.transition().duration(t);function yb(e,t,r,n){return(t[r]||[]).reduce((i,s)=>{var o,l;return`${e.id}-${s.id}-${r}`!==n&&i.push({id:s.id||null,type:r,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+s.y+s.height/2}),i},[])}function SO(e,t,r,n,i,s){const{x:o,y:l}=Wn(e),d=t.elementsFromPoint(o,l).find(x=>x.classList.contains("react-flow__handle"));if(d){const x=d.getAttribute("data-nodeid");if(x){const v=Qx(void 0,d),_=d.getAttribute("data-handleid"),g=s({nodeId:x,id:_,type:v});if(g){const y=i.find(b=>b.nodeId===x&&b.type===v&&b.id===_);return{handle:{id:_,type:v,nodeId:x,x:(y==null?void 0:y.x)||r.x,y:(y==null?void 0:y.y)||r.y},validHandleResult:g}}}}let u=[],f=1/0;if(i.forEach(x=>{const v=Math.sqrt((x.x-r.x)**2+(x.y-r.y)**2);if(v<=n){const _=s(x);v<=f&&(v<f?u=[{handle:x,validHandleResult:_}]:v===f&&u.push({handle:x,validHandleResult:_}),f=v)}}),!u.length)return{handle:null,validHandleResult:$C()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:x})=>x.isValid),h=u.some(({handle:x})=>x.type==="target");return u.find(({handle:x,validHandleResult:v})=>h?x.type==="target":p?v.isValid:!0)||u[0]}const kO={source:null,target:null,sourceHandle:null,targetHandle:null},$C=()=>({handleDomNode:null,isValid:!1,connection:kO,endHandle:null});function BC(e,t,r,n,i,s,o){const l=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...$C(),handleDomNode:c};if(c){const u=Qx(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),x=c.classList.contains("connectableend"),v={source:l?f:r,sourceHandle:l?p:n,target:l?r:f,targetHandle:l?n:p};d.connection=v,h&&x&&(t===Ni.Strict?l&&u==="source"||!l&&u==="target":f!==r||p!==n)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=s(v))}return d}function NO({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((i,s)=>{if(s[rt]){const{handleBounds:o}=s[rt];let l=[],c=[];o&&(l=yb(s,o,"source",`${t}-${r}-${n}`),c=yb(s,o,"target",`${t}-${r}-${n}`)),i.push(...l,...c)}return i},[])}function Qx(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function id(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function CO(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function HC({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:i,getState:s,setState:o,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=EC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:x,onConnectStart:v,panBy:_,getNodes:g,cancelConnection:y}=s();let b=0,w;const{x:S,y:k}=Wn(e),N=u==null?void 0:u.elementFromPoint(S,k),E=Qx(c,N),j=p==null?void 0:p.getBoundingClientRect();if(!j||!E)return;let R,T=Wn(e,j),D=!1,q=null,C=!1,O=null;const I=NO({nodes:g(),nodeId:r,handleId:t,handleType:E}),F=()=>{if(!h)return;const[L,z]=CC(T,j);_({x:L,y:z}),b=requestAnimationFrame(F)};o({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:r,handleId:t,type:E},connectionEndHandle:null}),v==null||v(e,{nodeId:r,handleId:t,handleType:E});function M(L){const{transform:z}=s();T=Wn(L,j);const{handle:B,validHandleResult:X}=SO(L,u,Cg(T,z,!1,[1,1]),x,I,Y=>BC(Y,f,r,t,i?"target":"source",l,u));if(w=B,D||(F(),D=!0),O=X.handleDomNode,q=X.connection,C=X.isValid,o({connectionPosition:w&&C?LC({x:w.x,y:w.y},z):T,connectionStatus:CO(!!w,C),connectionEndHandle:X.endHandle}),!w&&!C&&!O)return id(R);q.source!==q.target&&O&&(id(R),R=O,O.classList.add("connecting","react-flow__handle-connecting"),O.classList.toggle("valid",C),O.classList.toggle("react-flow__handle-valid",C))}function A(L){var z,B;(w||O)&&q&&C&&(n==null||n(q)),(B=(z=s()).onConnectEnd)==null||B.call(z,L),c&&(d==null||d(L)),id(R),y(),cancelAnimationFrame(b),D=!1,C=!1,q=null,O=null,u.removeEventListener("mousemove",M),u.removeEventListener("mouseup",A),u.removeEventListener("touchmove",M),u.removeEventListener("touchend",A)}u.addEventListener("mousemove",M),u.addEventListener("mouseup",A),u.addEventListener("touchmove",M),u.addEventListener("touchend",A)}const bb=()=>!0,EO=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),TO=(e,t,r)=>n=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=n;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r}},WC=m.forwardRef(({type:e="source",position:t=ce.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var j,R;const x=o||null,v=e==="target",_=gt(),g=yO(),{connectOnClick:y,noPanClassName:b}=Xe(EO,Mt),{connecting:w,clickConnecting:S}=Xe(TO(g,x,e),Mt);g||(R=(j=_.getState()).onError)==null||R.call(j,"010",hn.error010());const k=T=>{const{defaultEdgeOptions:D,onConnect:q,hasDefaultEdges:C}=_.getState(),O={...D,...T};if(C){const{edges:I,setEdges:F}=_.getState();F(jO(O,I))}q==null||q(O),l==null||l(O)},N=T=>{if(!g)return;const D=IC(T);i&&(D&&T.button===0||!D)&&HC({event:T,handleId:x,nodeId:g,onConnect:k,isTarget:v,getState:_.getState,setState:_.setState,isValidConnection:r||_.getState().isValidConnection||bb}),D?u==null||u(T):f==null||f(T)},E=T=>{const{onClickConnectStart:D,onClickConnectEnd:q,connectionClickStartHandle:C,connectionMode:O,isValidConnection:I}=_.getState();if(!g||!C&&!i)return;if(!C){D==null||D(T,{nodeId:g,handleId:x,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:g,type:e,handleId:x}});return}const F=EC(T.target),M=r||I||bb,{connection:A,isValid:L}=BC({nodeId:g,id:x,type:e},O,C.nodeId,C.handleId||null,C.type,M,F);L&&k(A),q==null||q(T),_.setState({connectionClickStartHandle:null})};return V.createElement("div",{"data-handleid":x,"data-nodeid":g,"data-handlepos":t,"data-id":`${g}-${x}-${e}`,className:Yt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!v,target:v,connectable:n,connectablestart:i,connectableend:s,connecting:S,connectionindicator:n&&(i&&!w||s&&w)}]),onMouseDown:N,onTouchStart:N,onClick:y?E:void 0,ref:h,...p},c)});WC.displayName="Handle";var Ur=m.memo(WC);const UC=({data:e,isConnectable:t,targetPosition:r=ce.Top,sourcePosition:n=ce.Bottom})=>V.createElement(V.Fragment,null,V.createElement(Ur,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,V.createElement(Ur,{type:"source",position:n,isConnectable:t}));UC.displayName="DefaultNode";var Eg=m.memo(UC);const VC=({data:e,isConnectable:t,sourcePosition:r=ce.Bottom})=>V.createElement(V.Fragment,null,e==null?void 0:e.label,V.createElement(Ur,{type:"source",position:r,isConnectable:t}));VC.displayName="InputNode";var GC=m.memo(VC);const KC=({data:e,isConnectable:t,targetPosition:r=ce.Top})=>V.createElement(V.Fragment,null,V.createElement(Ur,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);KC.displayName="OutputNode";var YC=m.memo(KC);const Zx=()=>null;Zx.displayName="GroupNode";const RO=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),el=e=>e.id;function AO(e,t){return Mt(e.selectedNodes.map(el),t.selectedNodes.map(el))&&Mt(e.selectedEdges.map(el),t.selectedEdges.map(el))}const XC=m.memo(({onSelectionChange:e})=>{const t=gt(),{selectedNodes:r,selectedEdges:n}=Xe(RO,AO);return m.useEffect(()=>{const i={nodes:r,edges:n};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[r,n,e]),null});XC.displayName="SelectionListener";const IO=e=>!!e.onSelectionChange;function MO({onSelectionChange:e}){const t=Xe(IO);return e||t?V.createElement(XC,{onSelectionChange:e}):null}const PO=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oi(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ke(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const OO=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:x,minZoom:v,maxZoom:_,nodeExtent:g,onNodesChange:y,onEdgesChange:b,elementsSelectable:w,connectionMode:S,snapGrid:k,snapToGrid:N,translateExtent:E,connectOnClick:j,defaultEdgeOptions:R,fitView:T,fitViewOptions:D,onNodesDelete:q,onEdgesDelete:C,onNodeDrag:O,onNodeDragStart:I,onNodeDragStop:F,onSelectionDrag:M,onSelectionDragStart:A,onSelectionDragStop:L,noPanClassName:z,nodeOrigin:B,rfId:X,autoPanOnConnect:Y,autoPanOnNodeDrag:W,onError:$,connectionRadius:Q,isValidConnection:se,nodeDragThreshold:ae})=>{const{setNodes:ee,setEdges:_e,setDefaultNodesAndEdges:me,setMinZoom:je,setMaxZoom:ve,setTranslateExtent:oe,setNodeExtent:G,reset:K}=Xe(PO,Mt),J=gt();return m.useEffect(()=>{const pe=n==null?void 0:n.map(fe=>({...fe,...R}));return me(r,pe),()=>{K()}},[]),ke("defaultEdgeOptions",R,J.setState),ke("connectionMode",S,J.setState),ke("onConnect",i,J.setState),ke("onConnectStart",s,J.setState),ke("onConnectEnd",o,J.setState),ke("onClickConnectStart",l,J.setState),ke("onClickConnectEnd",c,J.setState),ke("nodesDraggable",d,J.setState),ke("nodesConnectable",u,J.setState),ke("nodesFocusable",f,J.setState),ke("edgesFocusable",p,J.setState),ke("edgesUpdatable",h,J.setState),ke("elementsSelectable",w,J.setState),ke("elevateNodesOnSelect",x,J.setState),ke("snapToGrid",N,J.setState),ke("snapGrid",k,J.setState),ke("onNodesChange",y,J.setState),ke("onEdgesChange",b,J.setState),ke("connectOnClick",j,J.setState),ke("fitViewOnInit",T,J.setState),ke("fitViewOnInitOptions",D,J.setState),ke("onNodesDelete",q,J.setState),ke("onEdgesDelete",C,J.setState),ke("onNodeDrag",O,J.setState),ke("onNodeDragStart",I,J.setState),ke("onNodeDragStop",F,J.setState),ke("onSelectionDrag",M,J.setState),ke("onSelectionDragStart",A,J.setState),ke("onSelectionDragStop",L,J.setState),ke("noPanClassName",z,J.setState),ke("nodeOrigin",B,J.setState),ke("rfId",X,J.setState),ke("autoPanOnConnect",Y,J.setState),ke("autoPanOnNodeDrag",W,J.setState),ke("onError",$,J.setState),ke("connectionRadius",Q,J.setState),ke("isValidConnection",se,J.setState),ke("nodeDragThreshold",ae,J.setState),Oi(e,ee),Oi(t,_e),Oi(v,je),Oi(_,ve),Oi(E,oe),Oi(g,G),null},_b={display:"none"},DO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},QC="react-flow__node-desc",ZC="react-flow__edge-desc",LO="react-flow__aria-live",FO=e=>e.ariaLiveMessage;function zO({rfId:e}){const t=Xe(FO);return V.createElement("div",{id:`${LO}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:DO},t)}function qO({rfId:e,disableKeyboardA11y:t}){return V.createElement(V.Fragment,null,V.createElement("div",{id:`${QC}-${e}`,style:_b},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),V.createElement("div",{id:`${ZC}-${e}`,style:_b},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&V.createElement(zO,{rfId:e}))}var sa=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),i=m.useRef(!1),s=m.useRef(new Set([])),[o,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&Sg(h))return!1;const v=jb(h.code,l);s.current.add(h[v]),wb(o,s.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&Sg(h))return!1;const v=jb(h.code,l);wb(o,s.current,!0)?(n(!1),s.current.clear()):s.current.delete(h[v]),h.key==="Meta"&&s.current.clear(),i.current=!1},p=()=>{s.current.clear(),n(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function wb(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function jb(e,t){return t.includes(e)?"code":"key"}function JC(e,t,r,n){var l,c;const i=e.parentNode||e.parentId;if(!i)return r;const s=t.get(i),o=xi(s,n);return JC(s,t,{x:(r.x??0)+o.x,y:(r.y??0)+o.y,z:(((l=s[rt])==null?void 0:l.z)??0)>(r.z??0)?((c=s[rt])==null?void 0:c.z)??0:r.z??0},n)}function eE(e,t,r){e.forEach(n=>{var s;const i=n.parentNode||n.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||r!=null&&r[n.id]){const{x:o,y:l,z:c}=JC(n,e,{...n.position,z:((s=n[rt])==null?void 0:s.z)??0},t);n.positionAbsolute={x:o,y:l},n[rt].z=c,r!=null&&r[n.id]&&(n[rt].isParent=!0)}})}function sd(e,t,r,n){const i=new Map,s={},o=n?1e3:0;return e.forEach(l=>{var h;const c=(hr(l.zIndex)?l.zIndex:0)+(l.selected?o:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(s[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,rt,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[rt])==null?void 0:h.handleBounds,z:c}}),i.set(l.id,u)}),eE(i,r,s),i}function tE(e,t={}){const{getNodes:r,width:n,height:i,minZoom:s,maxZoom:o,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const x=r().filter(_=>{var y;const g=t.includeHiddenNodes?_.width&&_.height:!_.hidden;return(y=t.nodes)!=null&&y.length?g&&t.nodes.some(b=>b.id===_.id):g}),v=x.every(_=>_.width&&_.height);if(x.length>0&&v){const _=Xc(x,f),{x:g,y,zoom:b}=qC(_,n,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),w=ln.translate(g,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(li(c,t.duration),w):l.transform(c,w),!0}}return!1}function $O(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[rt]:n[rt],selected:r.selected})}),new Map(t)}function BO(e,t){return t.map(r=>{const n=e.find(i=>i.id===r.id);return n&&(r.selected=n.selected),r})}function tl({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=r();e!=null&&e.length&&(c&&n({nodeInternals:$O(e,i)}),o==null||o(e)),t!=null&&t.length&&(d&&n({edges:BO(t,s)}),l==null||l(t))}const Di=()=>{},HO={zoomIn:Di,zoomOut:Di,zoomTo:Di,getZoom:()=>1,setViewport:Di,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Di,fitBounds:Di,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},WO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),UO=()=>{const e=gt(),{d3Zoom:t,d3Selection:r}=Xe(WO,Mt);return m.useMemo(()=>r&&t?{zoomIn:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(li(r,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(li(r,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,l,c]=e.getState().transform,d=ln.translate(i.x??o,i.y??l).scale(i.zoom??c);t.transform(li(r,s==null?void 0:s.duration),d)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>tE(e.getState,i),setCenter:(i,s,o)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:d,f=l/2-i*u,p=c/2-s*u,h=ln.translate(f,p).scale(u);t.transform(li(r,o==null?void 0:o.duration),h)},fitBounds:(i,s)=>{const{width:o,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=qC(i,o,l,c,d,(s==null?void 0:s.padding)??.1),h=ln.translate(u,f).scale(p);t.transform(li(r,s==null?void 0:s.duration),h)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Cg(i,s,o,l)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:l,domNode:c}=e.getState();if(!c)return i;const{x:d,y:u}=c.getBoundingClientRect(),f={x:i.x-d,y:i.y-u};return Cg(f,s,o,l)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:l,y:c}=o.getBoundingClientRect(),d=LC(i,s);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:HO,[t,r])};function Qc(){const e=UO(),t=gt(),r=m.useCallback(()=>t.getState().getNodes().map(v=>({...v})),[]),n=m.useCallback(v=>t.getState().nodeInternals.get(v),[]),i=m.useCallback(()=>{const{edges:v=[]}=t.getState();return v.map(_=>({..._}))},[]),s=m.useCallback(v=>{const{edges:_=[]}=t.getState();return _.find(g=>g.id===v)},[]),o=m.useCallback(v=>{const{getNodes:_,setNodes:g,hasDefaultNodes:y,onNodesChange:b}=t.getState(),w=_(),S=typeof v=="function"?v(w):v;if(y)g(S);else if(b){const k=S.length===0?w.map(N=>({type:"remove",id:N.id})):S.map(N=>({item:N,type:"reset"}));b(k)}},[]),l=m.useCallback(v=>{const{edges:_=[],setEdges:g,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),w=typeof v=="function"?v(_):v;if(y)g(w);else if(b){const S=w.length===0?_.map(k=>({type:"remove",id:k.id})):w.map(k=>({item:k,type:"reset"}));b(S)}},[]),c=m.useCallback(v=>{const _=Array.isArray(v)?v:[v],{getNodes:g,setNodes:y,hasDefaultNodes:b,onNodesChange:w}=t.getState();if(b){const k=[...g(),..._];y(k)}else if(w){const S=_.map(k=>({item:k,type:"add"}));w(S)}},[]),d=m.useCallback(v=>{const _=Array.isArray(v)?v:[v],{edges:g=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:w}=t.getState();if(b)y([...g,..._]);else if(w){const S=_.map(k=>({item:k,type:"add"}));w(S)}},[]),u=m.useCallback(()=>{const{getNodes:v,edges:_=[],transform:g}=t.getState(),[y,b,w]=g;return{nodes:v().map(S=>({...S})),edges:_.map(S=>({...S})),viewport:{x:y,y:b,zoom:w}}},[]),f=m.useCallback(({nodes:v,edges:_})=>{const{nodeInternals:g,getNodes:y,edges:b,hasDefaultNodes:w,hasDefaultEdges:S,onNodesDelete:k,onEdgesDelete:N,onNodesChange:E,onEdgesChange:j}=t.getState(),R=(v||[]).map(O=>O.id),T=(_||[]).map(O=>O.id),D=y().reduce((O,I)=>{const F=I.parentNode||I.parentId,M=!R.includes(I.id)&&F&&O.find(L=>L.id===F);return(typeof I.deletable=="boolean"?I.deletable:!0)&&(R.includes(I.id)||M)&&O.push(I),O},[]),q=b.filter(O=>typeof O.deletable=="boolean"?O.deletable:!0),C=q.filter(O=>T.includes(O.id));if(D||C){const O=zC(D,q),I=[...C,...O],F=I.reduce((M,A)=>(M.includes(A.id)||M.push(A.id),M),[]);if((S||w)&&(S&&t.setState({edges:b.filter(M=>!F.includes(M.id))}),w&&(D.forEach(M=>{g.delete(M.id)}),t.setState({nodeInternals:new Map(g)}))),F.length>0&&(N==null||N(I),j&&j(F.map(M=>({id:M,type:"remove"})))),D.length>0&&(k==null||k(D),E)){const M=D.map(A=>({id:A.id,type:"remove"}));E(M)}}},[]),p=m.useCallback(v=>{const _=dO(v),g=_?null:t.getState().nodeInternals.get(v.id);return!_&&!g?[null,null,_]:[_?v:hb(g),g,_]},[]),h=m.useCallback((v,_=!0,g)=>{const[y,b,w]=p(v);return y?(g||t.getState().getNodes()).filter(S=>{if(!w&&(S.id===b.id||!S.positionAbsolute))return!1;const k=hb(S),N=jg(k,y);return _&&N>0||N>=y.width*y.height}):[]},[]),x=m.useCallback((v,_,g=!0)=>{const[y]=p(v);if(!y)return!1;const b=jg(y,_);return g&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:i,getEdge:s,setNodes:o,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:x}),[e,r,n,i,s,o,l,c,d,u,f,h,x])}const VO={actInsideInputWithModifier:!1};var GO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=gt(),{deleteElements:n}=Qc(),i=sa(e,VO),s=sa(t);m.useEffect(()=>{if(i){const{edges:o,getNodes:l}=r.getState(),c=l().filter(u=>u.selected),d=o.filter(u=>u.selected);n({nodes:c,edges:d}),r.setState({nodesSelectionActive:!1})}},[i]),m.useEffect(()=>{r.setState({multiSelectionActive:s})},[s])};function KO(e){const t=gt();m.useEffect(()=>{let r;const n=()=>{var s,o;if(!e.current)return;const i=Ux(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",hn.error004())),t.setState({width:i.width||500,height:i.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const Jx={position:"absolute",width:"100%",height:"100%",top:0,left:0},YO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,rl=e=>({x:e.x,y:e.y,zoom:e.k}),Li=(e,t)=>e.target.closest(`.${t}`),Sb=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),kb=e=>{const t=e.ctrlKey&&lc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},XO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),QO=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=pi.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:x,maxZoom:v,zoomActivationKeyCode:_,preventScrolling:g=!0,children:y,noWheelClassName:b,noPanClassName:w})=>{const S=m.useRef(),k=gt(),N=m.useRef(!1),E=m.useRef(!1),j=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:D,d3ZoomHandler:q,userSelectionActive:C}=Xe(XO,Mt),O=sa(_),I=m.useRef(0),F=m.useRef(!1),M=m.useRef();return KO(j),m.useEffect(()=>{if(j.current){const A=j.current.getBoundingClientRect(),L=kC().scaleExtent([x,v]).translateExtent(h),z=fr(j.current).call(L),B=ln.translate(p.x,p.y).scale(Ns(p.zoom,x,v)),X=[[0,0],[A.width,A.height]],Y=L.constrain()(B,X,h);L.transform(z,Y),L.wheelDelta(kb),k.setState({d3Zoom:L,d3Selection:z,d3ZoomHandler:z.on("wheel.zoom"),transform:[Y.x,Y.y,Y.k],domNode:j.current.closest(".react-flow")})}},[]),m.useEffect(()=>{D&&T&&(o&&!O&&!C?D.on("wheel.zoom",A=>{if(Li(A,b))return!1;A.preventDefault(),A.stopImmediatePropagation();const L=D.property("__zoom").k||1;if(A.ctrlKey&&s){const se=kr(A),ae=kb(A),ee=L*Math.pow(2,ae);T.scaleTo(D,ee,se,A);return}const z=A.deltaMode===1?20:1;let B=c===pi.Vertical?0:A.deltaX*z,X=c===pi.Horizontal?0:A.deltaY*z;!lc()&&A.shiftKey&&c!==pi.Vertical&&(B=A.deltaY*z,X=0),T.translateBy(D,-(B/L)*l,-(X/L)*l,{internal:!0});const Y=rl(D.property("__zoom")),{onViewportChangeStart:W,onViewportChange:$,onViewportChangeEnd:Q}=k.getState();clearTimeout(M.current),F.current||(F.current=!0,t==null||t(A,Y),W==null||W(Y)),F.current&&(e==null||e(A,Y),$==null||$(Y),M.current=setTimeout(()=>{r==null||r(A,Y),Q==null||Q(Y),F.current=!1},150))},{passive:!1}):typeof q<"u"&&D.on("wheel.zoom",function(A,L){if(!g&&A.type==="wheel"&&!A.ctrlKey||Li(A,b))return null;A.preventDefault(),q.call(this,A,L)},{passive:!1}))},[C,o,c,D,T,q,O,s,g,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",A=>{var B,X;if(!A.sourceEvent||A.sourceEvent.internal)return null;I.current=(B=A.sourceEvent)==null?void 0:B.button;const{onViewportChangeStart:L}=k.getState(),z=rl(A.transform);N.current=!0,R.current=z,((X=A.sourceEvent)==null?void 0:X.type)==="mousedown"&&k.setState({paneDragging:!0}),L==null||L(z),t==null||t(A.sourceEvent,z)})},[T,t]),m.useEffect(()=>{T&&(C&&!N.current?T.on("zoom",null):C||T.on("zoom",A=>{var z;const{onViewportChange:L}=k.getState();if(k.setState({transform:[A.transform.x,A.transform.y,A.transform.k]}),E.current=!!(n&&Sb(f,I.current??0)),(e||L)&&!((z=A.sourceEvent)!=null&&z.internal)){const B=rl(A.transform);L==null||L(B),e==null||e(A.sourceEvent,B)}}))},[C,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",A=>{if(!A.sourceEvent||A.sourceEvent.internal)return null;const{onViewportChangeEnd:L}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),n&&Sb(f,I.current??0)&&!E.current&&n(A.sourceEvent),E.current=!1,(r||L)&&YO(R.current,A.transform)){const z=rl(A.transform);R.current=z,clearTimeout(S.current),S.current=setTimeout(()=>{L==null||L(z),r==null||r(A.sourceEvent,z)},o?150:0)}})},[T,o,f,r,n]),m.useEffect(()=>{T&&T.filter(A=>{const L=O||i,z=s&&A.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&A.button===1&&A.type==="mousedown"&&(Li(A,"react-flow__node")||Li(A,"react-flow__edge")))return!0;if(!f&&!L&&!o&&!d&&!s||C||!d&&A.type==="dblclick"||Li(A,b)&&A.type==="wheel"||Li(A,w)&&(A.type!=="wheel"||o&&A.type==="wheel"&&!O)||!s&&A.ctrlKey&&A.type==="wheel"||!L&&!o&&!z&&A.type==="wheel"||!f&&(A.type==="mousedown"||A.type==="touchstart")||Array.isArray(f)&&!f.includes(A.button)&&A.type==="mousedown")return!1;const B=Array.isArray(f)&&f.includes(A.button)||!A.button||A.button<=1;return(!A.ctrlKey||A.type==="wheel")&&B})},[C,T,i,s,o,d,f,u,O]),V.createElement("div",{className:"react-flow__renderer",ref:j,style:Jx},y)},ZO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function JO(){const{userSelectionActive:e,userSelectionRect:t}=Xe(ZO,Mt);return e&&t?V.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Nb(e,t){const r=t.parentNode||t.parentId,n=e.find(i=>i.id===r);if(n){const i=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,i>0&&(n.style.width+=i),s>0&&(n.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);n.position.x=n.position.x-o,n.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);n.position.y=n.position.y-o,n.style.height+=o,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function rE(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,i)=>{const s=e.filter(l=>l.id===i.id);if(s.length===0)return n.push(i),n;const o={...i};for(const l of s)if(l)switch(l.type){case"select":{o.selected=l.selected;break}case"position":{typeof l.position<"u"&&(o.position=l.position),typeof l.positionAbsolute<"u"&&(o.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(o.dragging=l.dragging),o.expandParent&&Nb(n,o);break}case"dimensions":{typeof l.dimensions<"u"&&(o.width=l.dimensions.width,o.height=l.dimensions.height),typeof l.updateStyle<"u"&&(o.style={...o.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(o.resizing=l.resizing),o.expandParent&&Nb(n,o);break}case"remove":return n}return n.push(o),n},r)}function nE(e,t){return rE(e,t)}function eD(e,t){return rE(e,t)}const Nn=(e,t)=>({id:e,type:"select",selected:t});function ns(e,t){return e.reduce((r,n)=>{const i=t.includes(n.id);return!n.selected&&i?(n.selected=!0,r.push(Nn(n.id,!0))):n.selected&&!i&&(n.selected=!1,r.push(Nn(n.id,!1))),r},[])}const od=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},tD=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),iE=m.memo(({isSelecting:e,selectionMode:t=ia.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=gt(),x=m.useRef(0),v=m.useRef(0),_=m.useRef(),{userSelectionActive:g,elementsSelectable:y,dragging:b}=Xe(tD,Mt),w=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,v.current=0},S=q=>{s==null||s(q),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},k=q=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){q.preventDefault();return}o==null||o(q)},N=l?q=>l(q):void 0,E=q=>{const{resetSelectedElements:C,domNode:O}=h.getState();if(_.current=O==null?void 0:O.getBoundingClientRect(),!y||!e||q.button!==0||q.target!==p.current||!_.current)return;const{x:I,y:F}=Wn(q,_.current);C(),h.setState({userSelectionRect:{width:0,height:0,startX:I,startY:F,x:I,y:F}}),n==null||n(q)},j=q=>{const{userSelectionRect:C,nodeInternals:O,edges:I,transform:F,onNodesChange:M,onEdgesChange:A,nodeOrigin:L,getNodes:z}=h.getState();if(!e||!_.current||!C)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const B=Wn(q,_.current),X=C.startX??0,Y=C.startY??0,W={...C,x:B.x<X?B.x:X,y:B.y<Y?B.y:Y,width:Math.abs(B.x-X),height:Math.abs(B.y-Y)},$=z(),Q=FC(O,W,F,t===ia.Partial,!0,L),se=zC(Q,I).map(ee=>ee.id),ae=Q.map(ee=>ee.id);if(x.current!==ae.length){x.current=ae.length;const ee=ns($,ae);ee.length&&(M==null||M(ee))}if(v.current!==se.length){v.current=se.length;const ee=ns(I,se);ee.length&&(A==null||A(ee))}h.setState({userSelectionRect:W})},R=q=>{if(q.button!==0)return;const{userSelectionRect:C}=h.getState();!g&&C&&q.target===p.current&&(S==null||S(q)),h.setState({nodesSelectionActive:x.current>0}),w(),i==null||i(q)},T=q=>{g&&(h.setState({nodesSelectionActive:x.current>0}),i==null||i(q)),w()},D=y&&(e||g);return V.createElement("div",{className:Yt(["react-flow__pane",{dragging:b,selection:e}]),onClick:D?void 0:od(S,p),onContextMenu:od(k,p),onWheel:od(N,p),onMouseEnter:D?void 0:c,onMouseDown:D?E:void 0,onMouseMove:D?j:d,onMouseUp:D?R:void 0,onMouseLeave:D?T:u,ref:p,style:Jx},f,V.createElement(JO,null))});iE.displayName="Pane";function sE(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:sE(n,t):!1}function Cb(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function rD(e,t,r,n){return Array.from(e.values()).filter(i=>(i.selected||i.id===n)&&(!i.parentNode||i.parentId||!sE(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:r.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function nD(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function oE(e,t,r,n,i=[0,0],s){const o=nD(e,e.extent||n);let l=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=f&&hr(p)&&hr(h)&&hr(f.width)&&hr(f.height)?[[p+e.width*i[0],h+e.height*i[1]],[p+f.width-e.width+e.width*i[0],h+f.height-e.height+e.height*i[1]]]:l}else s==null||s("005",hn.error005()),l=o;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=xi(f,i).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=r.get(c);d=xi(f,i).positionAbsolute}const u=l&&l!=="parent"?Vx(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function ad({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(i=>({...r.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?n.find(i=>i.id===e):n[0],n]}const Eb=(e,t,r,n)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),l={x:o.width*n[0],y:o.height*n[1]};return s.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-o.left-l.x)/r,y:(d.top-o.top-l.y)/r,...Ux(c)}})};function Js(e,t,r){return r===void 0?r:n=>{const i=t().nodeInternals.get(e);i&&r(n,{...i})}}function Tg({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",hn.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(r||d.selected&&o)&&(s({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=n==null?void 0:n.current)==null?void 0:u.blur()})):i([e])}function iD(){const e=gt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:i,snapToGrid:s}=e.getState(),o=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,c={x:(o-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function ld(e){return(t,r,n)=>e==null?void 0:e(t,n)}function aE({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const l=gt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),x=m.useRef({x:0,y:0}),v=m.useRef(null),_=m.useRef(!1),g=m.useRef(!1),y=m.useRef(!1),b=iD();return m.useEffect(()=>{if(e!=null&&e.current){const w=fr(e.current),S=({x:E,y:j})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:D,updateNodePositions:q,nodeExtent:C,snapGrid:O,snapToGrid:I,nodeOrigin:F,onError:M}=l.getState();f.current={x:E,y:j};let A=!1,L={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&C){const B=Xc(u.current,F);L=na(B)}if(u.current=u.current.map(B=>{const X={x:E-B.distance.x,y:j-B.distance.y};I&&(X.x=O[0]*Math.round(X.x/O[0]),X.y=O[1]*Math.round(X.y/O[1]));const Y=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];u.current.length>1&&C&&!B.extent&&(Y[0][0]=B.positionAbsolute.x-L.x+C[0][0],Y[1][0]=B.positionAbsolute.x+(B.width??0)-L.x2+C[1][0],Y[0][1]=B.positionAbsolute.y-L.y+C[0][1],Y[1][1]=B.positionAbsolute.y+(B.height??0)-L.y2+C[1][1]);const W=oE(B,X,R,Y,F,M);return A=A||B.position.x!==W.position.x||B.position.y!==W.position.y,B.position=W.position,B.positionAbsolute=W.positionAbsolute,B}),!A)return;q(u.current,!0,!0),d(!0);const z=i?T:ld(D);if(z&&v.current){const[B,X]=ad({nodeId:i,dragItems:u.current,nodeInternals:R});z(v.current,B,X)}},k=()=>{if(!h.current)return;const[E,j]=CC(x.current,h.current);if(E!==0||j!==0){const{transform:R,panBy:T}=l.getState();f.current.x=(f.current.x??0)-E/R[2],f.current.y=(f.current.y??0)-j/R[2],T({x:E,y:j})&&S(f.current)}p.current=requestAnimationFrame(k)},N=E=>{var F;const{nodeInternals:j,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:D,onNodeDragStart:q,onSelectionDragStart:C}=l.getState();g.current=!0;const O=i?q:ld(C);(!o||!s)&&!R&&i&&((F=j.get(i))!=null&&F.selected||D()),i&&s&&o&&Tg({id:i,store:l,nodeRef:e});const I=b(E);if(f.current=I,u.current=rD(j,T,I,i),O&&u.current){const[M,A]=ad({nodeId:i,dragItems:u.current,nodeInternals:j});O(E.sourceEvent,M,A)}};if(t)w.on(".drag",null);else{const E=mM().on("start",j=>{const{domNode:R,nodeDragThreshold:T}=l.getState();T===0&&N(j),y.current=!1;const D=b(j);f.current=D,h.current=(R==null?void 0:R.getBoundingClientRect())||null,x.current=Wn(j.sourceEvent,h.current)}).on("drag",j=>{var q,C;const R=b(j),{autoPanOnNodeDrag:T,nodeDragThreshold:D}=l.getState();if(j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!_.current&&g.current&&T&&(_.current=!0,k()),!g.current){const O=R.xSnapped-(((q=f==null?void 0:f.current)==null?void 0:q.x)??0),I=R.ySnapped-(((C=f==null?void 0:f.current)==null?void 0:C.y)??0);Math.sqrt(O*O+I*I)>D&&N(j)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&u.current&&g.current&&(v.current=j.sourceEvent,x.current=Wn(j.sourceEvent,h.current),S(R))}}).on("end",j=>{if(!(!g.current||y.current)&&(d(!1),_.current=!1,g.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:D,onSelectionDragStop:q}=l.getState(),C=i?D:ld(q);if(R(u.current,!1,!1),C){const[O,I]=ad({nodeId:i,dragItems:u.current,nodeInternals:T});C(j.sourceEvent,O,I)}}}).filter(j=>{const R=j.target;return!j.button&&(!r||!Cb(R,`.${r}`,e))&&(!n||Cb(R,n,e))});return w.call(E),()=>{w.on(".drag",null)}}}},[e,t,r,n,s,l,i,o,b]),c}function lE(){const e=gt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=o().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,x=r.isShiftPressed?4:1,v=r.x*p*x,_=r.y*h*x,g=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+v,y:y.positionAbsolute.y+_};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:w,position:S}=oE(y,b,n,i,void 0,d);y.position=S,y.positionAbsolute=w}return y});s(g,!0,!1)},[])}const hs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var eo=e=>{const t=({id:r,type:n,data:i,xPos:s,yPos:o,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:x,onDoubleClick:v,style:_,className:g,isDraggable:y,isSelectable:b,isConnectable:w,isFocusable:S,selectNodesOnDrag:k,sourcePosition:N,targetPosition:E,hidden:j,resizeObserver:R,dragHandle:T,zIndex:D,isParent:q,noDragClassName:C,noPanClassName:O,initialized:I,disableKeyboardA11y:F,ariaLabel:M,rfId:A,hasHandleBounds:L})=>{const z=gt(),B=m.useRef(null),X=m.useRef(null),Y=m.useRef(N),W=m.useRef(E),$=m.useRef(n),Q=b||y||u||f||p||h,se=lE(),ae=Js(r,z.getState,f),ee=Js(r,z.getState,p),_e=Js(r,z.getState,h),me=Js(r,z.getState,x),je=Js(r,z.getState,v),ve=K=>{const{nodeDragThreshold:J}=z.getState();if(b&&(!k||!y||J>0)&&Tg({id:r,store:z,nodeRef:B}),u){const pe=z.getState().nodeInternals.get(r);pe&&u(K,{...pe})}},oe=K=>{if(!Sg(K)&&!F)if(AC.includes(K.key)&&b){const J=K.key==="Escape";Tg({id:r,store:z,unselect:J,nodeRef:B})}else y&&d&&Object.prototype.hasOwnProperty.call(hs,K.key)&&(z.setState({ariaLiveMessage:`Moved selected node ${K.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),se({x:hs[K.key].x,y:hs[K.key].y,isShiftPressed:K.shiftKey}))};m.useEffect(()=>()=>{X.current&&(R==null||R.unobserve(X.current),X.current=null)},[]),m.useEffect(()=>{if(B.current&&!j){const K=B.current;(!I||!L||X.current!==K)&&(X.current&&(R==null||R.unobserve(X.current)),R==null||R.observe(K),X.current=K)}},[j,I,L]),m.useEffect(()=>{const K=$.current!==n,J=Y.current!==N,pe=W.current!==E;B.current&&(K||J||pe)&&(K&&($.current=n),J&&(Y.current=N),pe&&(W.current=E),z.getState().updateNodeDimensions([{id:r,nodeElement:B.current,forceUpdate:!0}]))},[r,n,N,E]);const G=aE({nodeRef:B,disabled:j||!y,noDragClassName:C,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:k});return j?null:V.createElement("div",{className:Yt(["react-flow__node",`react-flow__node-${n}`,{[O]:y},g,{selected:d,selectable:b,parent:q,dragging:G}]),ref:B,style:{zIndex:D,transform:`translate(${l}px,${c}px)`,pointerEvents:Q?"all":"none",visibility:I?"visible":"hidden",..._},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:ae,onMouseMove:ee,onMouseLeave:_e,onContextMenu:me,onClick:ve,onDoubleClick:je,onKeyDown:S?oe:void 0,tabIndex:S?0:void 0,role:S?"button":void 0,"aria-describedby":F?void 0:`${QC}-${A}`,"aria-label":M},V.createElement(xO,{value:r},V.createElement(e,{id:r,data:i,type:n,xPos:s,yPos:o,selected:d,isConnectable:w,sourcePosition:N,targetPosition:E,dragging:G,dragHandle:T,zIndex:D})))};return t.displayName="NodeWrapper",m.memo(t)};const sD=e=>{const t=e.getNodes().filter(r=>r.selected);return{...Xc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function oD({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=gt(),{width:i,height:s,x:o,y:l,transformString:c,userSelectionActive:d}=Xe(sD,Mt),u=lE(),f=m.useRef(null);if(m.useEffect(()=>{var x;r||(x=f.current)==null||x.focus({preventScroll:!0})},[r]),aE({nodeRef:f}),d||!i||!s)return null;const p=e?x=>{const v=n.getState().getNodes().filter(_=>_.selected);e(x,v)}:void 0,h=x=>{Object.prototype.hasOwnProperty.call(hs,x.key)&&u({x:hs[x.key].x,y:hs[x.key].y,isShiftPressed:x.shiftKey})};return V.createElement("div",{className:Yt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},V.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:i,height:s,top:l,left:o}}))}var aD=m.memo(oD);const lD=e=>e.nodesSelectionActive,cE=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:x,onSelectionEnd:v,multiSelectionKeyCode:_,panActivationKeyCode:g,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:S,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:j,panOnDrag:R,defaultViewport:T,translateExtent:D,minZoom:q,maxZoom:C,preventScrolling:O,onSelectionContextMenu:I,noWheelClassName:F,noPanClassName:M,disableKeyboardA11y:A})=>{const L=Xe(lD),z=sa(f),B=sa(g),X=B||R,Y=B||k,W=z||p&&X!==!0;return GO({deleteKeyCode:l,multiSelectionKeyCode:_}),V.createElement(QO,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:S,panOnScroll:Y,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:j,panOnDrag:!z&&X,defaultViewport:T,translateExtent:D,minZoom:q,maxZoom:C,zoomActivationKeyCode:y,preventScrolling:O,noWheelClassName:F,noPanClassName:M},V.createElement(iE,{onSelectionStart:x,onSelectionEnd:v,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:X,isSelecting:!!W,selectionMode:h},e,L&&V.createElement(aD,{onSelectionContextMenu:I,noPanClassName:M,disableKeyboardA11y:A})))};cE.displayName="FlowRenderer";var cD=m.memo(cE);function uD(e){return Xe(m.useCallback(r=>e?FC(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function dD(e){const t={input:eo(e.input||GC),default:eo(e.default||Eg),output:eo(e.output||YC),group:eo(e.group||Zx)},r={},n=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=eo(e[s]||Eg),i),r);return{...t,...n}}const fD=({x:e,y:t,width:r,height:n,origin:i})=>!r||!n?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-r*i[0],y:t-n*i[1]},pD=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),uE=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Xe(pD,Mt),l=uD(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));s(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),V.createElement("div",{className:"react-flow__nodes",style:Jx},l.map(u=>{var S,k,N;let f=u.type||"default";e.nodeTypes[f]||(o==null||o("003",hn.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),x=!!(u.selectable||i&&typeof u.selectable>"u"),v=!!(u.connectable||r&&typeof u.connectable>"u"),_=!!(u.focusable||n&&typeof u.focusable>"u"),g=e.nodeExtent?Vx(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(g==null?void 0:g.x)??0,b=(g==null?void 0:g.y)??0,w=fD({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return V.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||ce.Bottom,targetPosition:u.targetPosition||ce.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:w.x,yPosOrigin:w.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:x,isConnectable:v,isFocusable:_,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((S=u[rt])==null?void 0:S.z)??0,isParent:!!((k=u[rt])!=null&&k.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((N=u[rt])!=null&&N.handleBounds)})}))};uE.displayName="NodeRenderer";var hD=m.memo(uE);const mD=(e,t,r)=>r===ce.Left?e-t:r===ce.Right?e+t:e,vD=(e,t,r)=>r===ce.Top?e-t:r===ce.Bottom?e+t:e,Tb="react-flow__edgeupdater",Rb=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:l})=>V.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Yt([Tb,`${Tb}-${l}`]),cx:mD(t,n,e),cy:vD(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),gD=()=>!0;var Fi=e=>{const t=({id:r,className:n,type:i,data:s,onClick:o,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:v,style:_,source:g,target:y,sourceX:b,sourceY:w,targetX:S,targetY:k,sourcePosition:N,targetPosition:E,elementsSelectable:j,hidden:R,sourceHandleId:T,targetHandleId:D,onContextMenu:q,onMouseEnter:C,onMouseMove:O,onMouseLeave:I,reconnectRadius:F,onReconnect:M,onReconnectStart:A,onReconnectEnd:L,markerEnd:z,markerStart:B,rfId:X,ariaLabel:Y,isFocusable:W,isReconnectable:$,pathOptions:Q,interactionWidth:se,disableKeyboardA11y:ae})=>{const ee=m.useRef(null),[_e,me]=m.useState(!1),[je,ve]=m.useState(!1),oe=gt(),G=m.useMemo(()=>`url('#${Ng(B,X)}')`,[B,X]),K=m.useMemo(()=>`url('#${Ng(z,X)}')`,[z,X]);if(R)return null;const J=Re=>{var yt;const{edges:Z,addSelectedEdges:Pe,unselectNodesAndEdges:ge,multiSelectionActive:Nt}=oe.getState(),xt=Z.find(Qt=>Qt.id===r);xt&&(j&&(oe.setState({nodesSelectionActive:!1}),xt.selected&&Nt?(ge({nodes:[],edges:[xt]}),(yt=ee.current)==null||yt.blur()):Pe([r])),o&&o(Re,xt))},pe=Zs(r,oe.getState,l),fe=Zs(r,oe.getState,q),be=Zs(r,oe.getState,C),xe=Zs(r,oe.getState,O),re=Zs(r,oe.getState,I),he=(Re,Z)=>{if(Re.button!==0)return;const{edges:Pe,isValidConnection:ge}=oe.getState(),Nt=Z?y:g,xt=(Z?D:T)||null,yt=Z?"target":"source",Qt=ge||gD,P=Z,H=Pe.find(Oe=>Oe.id===r);ve(!0),A==null||A(Re,H,yt);const U=Oe=>{ve(!1),L==null||L(Oe,H,yt)};HC({event:Re,handleId:xt,nodeId:Nt,onConnect:Oe=>M==null?void 0:M(H,Oe),isTarget:P,getState:oe.getState,setState:oe.setState,isValidConnection:Qt,edgeUpdaterType:yt,onReconnectEnd:U})},Ke=Re=>he(Re,!0),Fe=Re=>he(Re,!1),$e=()=>me(!0),Te=()=>me(!1),Be=!j&&!o,at=Re=>{var Z;if(!ae&&AC.includes(Re.key)&&j){const{unselectNodesAndEdges:Pe,addSelectedEdges:ge,edges:Nt}=oe.getState();Re.key==="Escape"?((Z=ee.current)==null||Z.blur(),Pe({edges:[Nt.find(yt=>yt.id===r)]})):ge([r])}};return V.createElement("g",{className:Yt(["react-flow__edge",`react-flow__edge-${i}`,n,{selected:c,animated:d,inactive:Be,updating:_e}]),onClick:J,onDoubleClick:pe,onContextMenu:fe,onMouseEnter:be,onMouseMove:xe,onMouseLeave:re,onKeyDown:W?at:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":Y===null?void 0:Y||`Edge from ${g} to ${y}`,"aria-describedby":W?`${ZC}-${X}`:void 0,ref:ee},!je&&V.createElement(e,{id:r,source:g,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:v,data:s,style:_,sourceX:b,sourceY:w,targetX:S,targetY:k,sourcePosition:N,targetPosition:E,sourceHandleId:T,targetHandleId:D,markerStart:G,markerEnd:K,pathOptions:Q,interactionWidth:se}),$&&V.createElement(V.Fragment,null,($==="source"||$===!0)&&V.createElement(Rb,{position:N,centerX:b,centerY:w,radius:F,onMouseDown:Ke,onMouseEnter:$e,onMouseOut:Te,type:"source"}),($==="target"||$===!0)&&V.createElement(Rb,{position:E,centerX:S,centerY:k,radius:F,onMouseDown:Fe,onMouseEnter:$e,onMouseOut:Te,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function xD(e){const t={default:Fi(e.default||uc),straight:Fi(e.bezier||Yx),step:Fi(e.step||Kx),smoothstep:Fi(e.step||Yc),simplebezier:Fi(e.simplebezier||Gx)},r={},n=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Fi(e[s]||uc),i),r);return{...t,...n}}function Ab(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,i=((r==null?void 0:r.y)||0)+t.y,s=(r==null?void 0:r.width)||t.width,o=(r==null?void 0:r.height)||t.height;switch(e){case ce.Top:return{x:n+s/2,y:i};case ce.Right:return{x:n+s,y:i+o/2};case ce.Bottom:return{x:n+s/2,y:i+o};case ce.Left:return{x:n,y:i+o/2}}}function Ib(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const yD=(e,t,r,n,i,s)=>{const o=Ab(r,e,t),l=Ab(s,n,i);return{sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y}};function bD({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:i,targetHeight:s,width:o,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+i),y2:Math.max(e.y+n,t.y+s)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=na({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Mb(e){var n,i,s,o,l;const t=((n=e==null?void 0:e[rt])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const _D=[{level:0,isMaxLevel:!0,edges:[]}];function wD(e,t,r=!1){let n=-1;const i=e.reduce((o,l)=>{var u,f;const c=hr(l.zIndex);let d=c?l.zIndex:0;if(r){const p=t.get(l.target),h=t.get(l.source),x=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),v=Math.max(((u=h==null?void 0:h[rt])==null?void 0:u.z)||0,((f=p==null?void 0:p[rt])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(x?v:0)}return o[d]?o[d].push(l):o[d]=[l],n=d>n?d:n,o},{}),s=Object.entries(i).map(([o,l])=>{const c=+o;return{edges:l,level:c,isMaxLevel:c===n}});return s.length===0?_D:s}function jD(e,t,r){const n=Xe(m.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),l=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&bD({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:l.width,targetHeight:l.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return wD(n,t,r)}const SD=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),kD=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Pb={[cc.Arrow]:SD,[cc.ArrowClosed]:kD};function ND(e){const t=gt();return m.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Pb,e)?Pb[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",hn.error009(e)),null)},[e])}const CD=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const c=ND(t);return c?V.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0"},V.createElement(c,{color:r,strokeWidth:o})):null},ED=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const l=Ng(o,t);n.includes(l)||(i.push({id:l,color:o.color||e,...o}),n.push(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},dE=({defaultColor:e,rfId:t})=>{const r=Xe(m.useCallback(ED({defaultColor:e,rfId:t}),[e,t]),(n,i)=>!(n.length!==i.length||n.some((s,o)=>s.id!==i[o].id)));return V.createElement("defs",null,r.map(n=>V.createElement(CD,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};dE.displayName="MarkerDefinitions";var TD=m.memo(dE);const RD=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),fE=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:v,children:_,disableKeyboardA11y:g})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:w,width:S,height:k,connectionMode:N,nodeInternals:E,onError:j}=Xe(RD,Mt),R=jD(t,E,r);return S?V.createElement(V.Fragment,null,R.map(({level:T,edges:D,isMaxLevel:q})=>V.createElement("svg",{key:T,style:{zIndex:T},width:S,height:k,className:"react-flow__edges react-flow__container"},q&&V.createElement(TD,{defaultColor:e,rfId:n}),V.createElement("g",null,D.map(C=>{const[O,I,F]=Mb(E.get(C.source)),[M,A,L]=Mb(E.get(C.target));if(!F||!L)return null;let z=C.type||"default";i[z]||(j==null||j("011",hn.error011(z)),z="default");const B=i[z]||i.default,X=N===Ni.Strict?A.target:(A.target??[]).concat(A.source??[]),Y=Ib(I.source,C.sourceHandle),W=Ib(X,C.targetHandle),$=(Y==null?void 0:Y.position)||ce.Bottom,Q=(W==null?void 0:W.position)||ce.Top,se=!!(C.focusable||y&&typeof C.focusable>"u"),ae=C.reconnectable||C.updatable,ee=typeof p<"u"&&(ae||b&&typeof ae>"u");if(!Y||!W)return j==null||j("008",hn.error008(Y,C)),null;const{sourceX:_e,sourceY:me,targetX:je,targetY:ve}=yD(O,Y,$,M,W,Q);return V.createElement(B,{key:C.id,id:C.id,className:Yt([C.className,s]),type:z,data:C.data,selected:!!C.selected,animated:!!C.animated,hidden:!!C.hidden,label:C.label,labelStyle:C.labelStyle,labelShowBg:C.labelShowBg,labelBgStyle:C.labelBgStyle,labelBgPadding:C.labelBgPadding,labelBgBorderRadius:C.labelBgBorderRadius,style:C.style,source:C.source,target:C.target,sourceHandleId:C.sourceHandle,targetHandleId:C.targetHandle,markerEnd:C.markerEnd,markerStart:C.markerStart,sourceX:_e,sourceY:me,targetX:je,targetY:ve,sourcePosition:$,targetPosition:Q,elementsSelectable:w,onContextMenu:o,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:v,rfId:n,ariaLabel:C.ariaLabel,isFocusable:se,isReconnectable:ee,pathOptions:"pathOptions"in C?C.pathOptions:void 0,interactionWidth:C.interactionWidth,disableKeyboardA11y:g})})))),_):null};fE.displayName="EdgeRenderer";var AD=m.memo(fE);const ID=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function MD({children:e}){const t=Xe(ID);return V.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function PD(e){const t=Qc(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const OD={[ce.Left]:ce.Right,[ce.Right]:ce.Left,[ce.Top]:ce.Bottom,[ce.Bottom]:ce.Top},pE=({nodeId:e,handleType:t,style:r,type:n=Rn.Bezier,CustomComponent:i,connectionStatus:s})=>{var k,N,E;const{fromNode:o,handleId:l,toX:c,toY:d,connectionMode:u}=Xe(m.useCallback(j=>({fromNode:j.nodeInternals.get(e),handleId:j.connectionHandleId,toX:(j.connectionPosition.x-j.transform[0])/j.transform[2],toY:(j.connectionPosition.y-j.transform[1])/j.transform[2],connectionMode:j.connectionMode}),[e]),Mt),f=(k=o==null?void 0:o[rt])==null?void 0:k.handleBounds;let p=f==null?void 0:f[t];if(u===Ni.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!o||!p)return null;const h=l?p.find(j=>j.id===l):p[0],x=h?h.x+h.width/2:(o.width??0)/2,v=h?h.y+h.height/2:o.height??0,_=(((N=o.positionAbsolute)==null?void 0:N.x)??0)+x,g=(((E=o.positionAbsolute)==null?void 0:E.y)??0)+v,y=h==null?void 0:h.position,b=y?OD[y]:null;if(!y||!b)return null;if(i)return V.createElement(i,{connectionLineType:n,connectionLineStyle:r,fromNode:o,fromHandle:h,fromX:_,fromY:g,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:s});let w="";const S={sourceX:_,sourceY:g,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return n===Rn.Bezier?[w]=DC(S):n===Rn.Step?[w]=kg({...S,borderRadius:0}):n===Rn.SmoothStep?[w]=kg(S):n===Rn.SimpleBezier?[w]=OC(S):w=`M${_},${g} ${c},${d}`,V.createElement("path",{d:w,fill:"none",className:"react-flow__connection-path",style:r})};pE.displayName="ConnectionLine";const DD=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function LD({containerStyle:e,style:t,type:r,component:n}){const{nodeId:i,handleType:s,nodesConnectable:o,width:l,height:c,connectionStatus:d}=Xe(DD,Mt);return!(i&&s&&l&&o)?null:V.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},V.createElement("g",{className:Yt(["react-flow__connection",d])},V.createElement(pE,{nodeId:i,handleType:s,style:t,type:r,CustomComponent:n,connectionStatus:d})))}function Ob(e,t){return m.useRef(null),gt(),m.useMemo(()=>t(e),[e])}const hE=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:x,onSelectionStart:v,onSelectionEnd:_,connectionLineType:g,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:w,selectionKeyCode:S,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:D,elementsSelectable:q,selectNodesOnDrag:C,defaultViewport:O,translateExtent:I,minZoom:F,maxZoom:M,preventScrolling:A,defaultMarkerColor:L,zoomOnScroll:z,zoomOnPinch:B,panOnScroll:X,panOnScrollSpeed:Y,panOnScrollMode:W,zoomOnDoubleClick:$,panOnDrag:Q,onPaneClick:se,onPaneMouseEnter:ae,onPaneMouseMove:ee,onPaneMouseLeave:_e,onPaneScroll:me,onPaneContextMenu:je,onEdgeContextMenu:ve,onEdgeMouseEnter:oe,onEdgeMouseMove:G,onEdgeMouseLeave:K,onReconnect:J,onReconnectStart:pe,onReconnectEnd:fe,reconnectRadius:be,noDragClassName:xe,noWheelClassName:re,noPanClassName:he,elevateEdgesOnSelect:Ke,disableKeyboardA11y:Fe,nodeOrigin:$e,nodeExtent:Te,rfId:Be})=>{const at=Ob(e,dD),Re=Ob(t,xD);return PD(s),V.createElement(cD,{onPaneClick:se,onPaneMouseEnter:ae,onPaneMouseMove:ee,onPaneMouseLeave:_e,onPaneContextMenu:je,onPaneScroll:me,deleteKeyCode:T,selectionKeyCode:S,selectionOnDrag:k,selectionMode:N,onSelectionStart:v,onSelectionEnd:_,multiSelectionKeyCode:E,panActivationKeyCode:j,zoomActivationKeyCode:R,elementsSelectable:q,onMove:r,onMoveStart:n,onMoveEnd:i,zoomOnScroll:z,zoomOnPinch:B,zoomOnDoubleClick:$,panOnScroll:X,panOnScrollSpeed:Y,panOnScrollMode:W,panOnDrag:Q,defaultViewport:O,translateExtent:I,minZoom:F,maxZoom:M,onSelectionContextMenu:x,preventScrolling:A,noDragClassName:xe,noWheelClassName:re,noPanClassName:he,disableKeyboardA11y:Fe},V.createElement(MD,null,V.createElement(AD,{edgeTypes:Re,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:D,onEdgeContextMenu:ve,onEdgeMouseEnter:oe,onEdgeMouseMove:G,onEdgeMouseLeave:K,onReconnect:J,onReconnectStart:pe,onReconnectEnd:fe,reconnectRadius:be,defaultMarkerColor:L,noPanClassName:he,elevateEdgesOnSelect:!!Ke,disableKeyboardA11y:Fe,rfId:Be},V.createElement(LD,{style:y,type:g,component:b,containerStyle:w})),V.createElement("div",{className:"react-flow__edgelabel-renderer"}),V.createElement(hD,{nodeTypes:at,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:C,onlyRenderVisibleElements:D,noPanClassName:he,noDragClassName:xe,disableKeyboardA11y:Fe,nodeOrigin:$e,nodeExtent:Te,rfId:Be})))};hE.displayName="GraphView";var FD=m.memo(hE);const Rg=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],_n={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Rg,nodeExtent:Rg,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ni.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:fO,isValidConnection:void 0},zD=()=>C5((e,t)=>({..._n,setNodes:r=>{const{nodeInternals:n,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:sd(r,n,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(i=>({...n,...i}))})},setDefaultNodesAndEdges:(r,n)=>{const i=typeof r<"u",s=typeof n<"u",o=i?sd(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?n:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((v,_)=>{const g=i.get(_.id);if(g!=null&&g.hidden)i.set(g.id,{...g,[rt]:{...g[rt],handleBounds:void 0}});else if(g){const y=Ux(_.nodeElement);!!(y.width&&y.height&&(g.width!==y.width||g.height!==y.height||_.forceUpdate))&&(i.set(g.id,{...g,[rt]:{...g[rt],handleBounds:{source:Eb(".source",_.nodeElement,p,d),target:Eb(".target",_.nodeElement,p,d)}},...y}),v.push({id:g.id,type:"dimensions",dimensions:y}))}return v},[]);eE(i,d);const x=o||s&&!o&&tE(t,{initial:!0,...l});e({nodeInternals:new Map(i),fitViewOnInitDone:x}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=r.map(l=>{const c={id:l.id,type:"position",dragging:i};return n&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});s(o)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:l,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(s){const d=nE(r,l()),u=sd(d,i,o,c);e({nodeInternals:u})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Nn(c,!0)):(o=ns(s(),r),l=ns(i,[])),tl({changedNodes:o,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:i,getNodes:s}=t();let o,l=null;n?o=r.map(c=>Nn(c,!0)):(o=ns(i,r),l=ns(s(),[])),tl({changedNodes:l,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:i,getNodes:s}=t(),o=r||s(),l=n||i,c=o.map(u=>(u.selected=!1,Nn(u.id,!1))),d=l.map(u=>Nn(u.id,!1));tl({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:i}=t();n==null||n.scaleExtent([r,i]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:i}=t();n==null||n.scaleExtent([i,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),s=n().filter(l=>l.selected).map(l=>Nn(l.id,!1)),o=r.filter(l=>l.selected).map(l=>Nn(l.id,!1));tl({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(i=>{i.positionAbsolute=Vx(i.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:i,height:s,d3Zoom:o,d3Selection:l,translateExtent:c}=t();if(!o||!l||!r.x&&!r.y)return!1;const d=ln.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),u=[[0,0],[i,s]],f=o==null?void 0:o.constrain()(d,u,c);return o.transform(l,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:_n.connectionNodeId,connectionHandleId:_n.connectionHandleId,connectionHandleType:_n.connectionHandleType,connectionStatus:_n.connectionStatus,connectionStartHandle:_n.connectionStartHandle,connectionEndHandle:_n.connectionEndHandle}),reset:()=>e({..._n})}),Object.is),Zc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=zD()),V.createElement(sO,{value:t.current},e)};Zc.displayName="ReactFlowProvider";const mE=({children:e})=>m.useContext(Kc)?V.createElement(V.Fragment,null,e):V.createElement(Zc,null,e);mE.displayName="ReactFlowWrapper";const qD={input:GC,default:Eg,output:YC,group:Zx},$D={default:uc,straight:Yx,step:Kx,smoothstep:Yc,simplebezier:Gx},BD=[0,0],HD=[15,15],WD={x:0,y:0,zoom:1},UD={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ey=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:s=qD,edgeTypes:o=$D,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:x,onConnectEnd:v,onClickConnectStart:_,onClickConnectEnd:g,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:S,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:j,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:D,onSelectionDragStart:q,onSelectionDrag:C,onSelectionDragStop:O,onSelectionContextMenu:I,onSelectionStart:F,onSelectionEnd:M,connectionMode:A=Ni.Strict,connectionLineType:L=Rn.Bezier,connectionLineStyle:z,connectionLineComponent:B,connectionLineContainerStyle:X,deleteKeyCode:Y="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:$=!1,selectionMode:Q=ia.Full,panActivationKeyCode:se="Space",multiSelectionKeyCode:ae=lc()?"Meta":"Control",zoomActivationKeyCode:ee=lc()?"Meta":"Control",snapToGrid:_e=!1,snapGrid:me=HD,onlyRenderVisibleElements:je=!1,selectNodesOnDrag:ve=!0,nodesDraggable:oe,nodesConnectable:G,nodesFocusable:K,nodeOrigin:J=BD,edgesFocusable:pe,edgesUpdatable:fe,elementsSelectable:be,defaultViewport:xe=WD,minZoom:re=.5,maxZoom:he=2,translateExtent:Ke=Rg,preventScrolling:Fe=!0,nodeExtent:$e,defaultMarkerColor:Te="#b1b1b7",zoomOnScroll:Be=!0,zoomOnPinch:at=!0,panOnScroll:Re=!1,panOnScrollSpeed:Z=.5,panOnScrollMode:Pe=pi.Free,zoomOnDoubleClick:ge=!0,panOnDrag:Nt=!0,onPaneClick:xt,onPaneMouseEnter:yt,onPaneMouseMove:Qt,onPaneMouseLeave:P,onPaneScroll:H,onPaneContextMenu:U,children:ne,onEdgeContextMenu:Oe,onEdgeDoubleClick:lt,onEdgeMouseEnter:ar,onEdgeMouseMove:Ct,onEdgeMouseLeave:bt,onEdgeUpdate:qt,onEdgeUpdateStart:ue,onEdgeUpdateEnd:ie,onReconnect:He,onReconnectStart:Et,onReconnectEnd:br,reconnectRadius:ti=10,edgeUpdaterRadius:ri=10,onNodesChange:Or,onEdgesChange:ni,noDragClassName:$s="nodrag",noWheelClassName:pR="nowheel",noPanClassName:Oy="nopan",fitView:hR=!1,fitViewOptions:mR,connectOnClick:vR=!0,attributionPosition:gR,proOptions:xR,defaultEdgeOptions:yR,elevateNodesOnSelect:bR=!0,elevateEdgesOnSelect:_R=!1,disableKeyboardA11y:Dy=!1,autoPanOnConnect:wR=!0,autoPanOnNodeDrag:jR=!0,connectionRadius:SR=20,isValidConnection:kR,onError:NR,style:CR,id:Ly,nodeDragThreshold:ER,...TR},RR)=>{const Nu=Ly||"1";return V.createElement("div",{...TR,style:{...CR,...UD},ref:RR,className:Yt(["react-flow",i]),"data-testid":"rf__wrapper",id:Ly},V.createElement(mE,null,V.createElement(FD,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:S,onNodeDoubleClick:k,nodeTypes:s,edgeTypes:o,connectionLineType:L,connectionLineStyle:z,connectionLineComponent:B,connectionLineContainerStyle:X,selectionKeyCode:W,selectionOnDrag:$,selectionMode:Q,deleteKeyCode:Y,multiSelectionKeyCode:ae,panActivationKeyCode:se,zoomActivationKeyCode:ee,onlyRenderVisibleElements:je,selectNodesOnDrag:ve,defaultViewport:xe,translateExtent:Ke,minZoom:re,maxZoom:he,preventScrolling:Fe,zoomOnScroll:Be,zoomOnPinch:at,zoomOnDoubleClick:ge,panOnScroll:Re,panOnScrollSpeed:Z,panOnScrollMode:Pe,panOnDrag:Nt,onPaneClick:xt,onPaneMouseEnter:yt,onPaneMouseMove:Qt,onPaneMouseLeave:P,onPaneScroll:H,onPaneContextMenu:U,onSelectionContextMenu:I,onSelectionStart:F,onSelectionEnd:M,onEdgeContextMenu:Oe,onEdgeDoubleClick:lt,onEdgeMouseEnter:ar,onEdgeMouseMove:Ct,onEdgeMouseLeave:bt,onReconnect:He??qt,onReconnectStart:Et??ue,onReconnectEnd:br??ie,reconnectRadius:ti??ri,defaultMarkerColor:Te,noDragClassName:$s,noWheelClassName:pR,noPanClassName:Oy,elevateEdgesOnSelect:_R,rfId:Nu,disableKeyboardA11y:Dy,nodeOrigin:J,nodeExtent:$e}),V.createElement(OO,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:x,onConnectEnd:v,onClickConnectStart:_,onClickConnectEnd:g,nodesDraggable:oe,nodesConnectable:G,nodesFocusable:K,edgesFocusable:pe,edgesUpdatable:fe,elementsSelectable:be,elevateNodesOnSelect:bR,minZoom:re,maxZoom:he,nodeExtent:$e,onNodesChange:Or,onEdgesChange:ni,snapToGrid:_e,snapGrid:me,connectionMode:A,translateExtent:Ke,connectOnClick:vR,defaultEdgeOptions:yR,fitView:hR,fitViewOptions:mR,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:N,onNodeDrag:E,onNodeDragStop:j,onSelectionDrag:C,onSelectionDragStart:q,onSelectionDragStop:O,noPanClassName:Oy,nodeOrigin:J,rfId:Nu,autoPanOnConnect:wR,autoPanOnNodeDrag:jR,onError:NR,connectionRadius:SR,isValidConnection:kR,nodeDragThreshold:ER}),V.createElement(MO,{onSelectionChange:D}),ne,V.createElement(aO,{proOptions:xR,position:gR}),V.createElement(qO,{rfId:Nu,disableKeyboardA11y:Dy})))});ey.displayName="ReactFlow";function vE(e){return t=>{const[r,n]=m.useState(t),i=m.useCallback(s=>n(o=>e(s,o)),[]);return[r,n,i]}}const gE=vE(nE),xE=vE(eD),yE=({id:e,x:t,y:r,width:n,height:i,style:s,color:o,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:x,backgroundColor:v}=s||{},_=o||x||v;return V.createElement("rect",{className:Yt(["react-flow__minimap-node",{selected:h},d]),x:t,y:r,rx:u,ry:u,width:n,height:i,fill:_,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?g=>p(g,e):void 0})};yE.displayName="MiniMapNode";var VD=m.memo(yE);const GD=e=>e.nodeOrigin,KD=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),cd=e=>e instanceof Function?e:()=>e;function YD({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i=2,nodeComponent:s=VD,onClick:o}){const l=Xe(KD,Mt),c=Xe(GD),d=cd(t),u=cd(e),f=cd(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return V.createElement(V.Fragment,null,l.map(h=>{const{x,y:v}=xi(h,c).positionAbsolute;return V.createElement(s,{key:h.id,x,y:v,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:n,strokeColor:u(h),strokeWidth:i,shapeRendering:p,onClick:o,id:h.id})}))}var XD=m.memo(YD);const QD=200,ZD=150,JD=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?uO(Xc(t,e.nodeOrigin),r):r,rfId:e.rfId}},e6="react-flow__minimap-desc";function bE({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:x=!1,zoomable:v=!1,ariaLabel:_="React Flow mini map",inversePan:g=!1,zoomStep:y=10,offsetScale:b=5}){const w=gt(),S=m.useRef(null),{boundingRect:k,viewBB:N,rfId:E}=Xe(JD,Mt),j=(e==null?void 0:e.width)??QD,R=(e==null?void 0:e.height)??ZD,T=k.width/j,D=k.height/R,q=Math.max(T,D),C=q*j,O=q*R,I=b*q,F=k.x-(C-k.width)/2-I,M=k.y-(O-k.height)/2-I,A=C+I*2,L=O+I*2,z=`${e6}-${E}`,B=m.useRef(0);B.current=q,m.useEffect(()=>{if(S.current){const W=fr(S.current),$=ae=>{const{transform:ee,d3Selection:_e,d3Zoom:me}=w.getState();if(ae.sourceEvent.type!=="wheel"||!_e||!me)return;const je=-ae.sourceEvent.deltaY*(ae.sourceEvent.deltaMode===1?.05:ae.sourceEvent.deltaMode?1:.002)*y,ve=ee[2]*Math.pow(2,je);me.scaleTo(_e,ve)},Q=ae=>{const{transform:ee,d3Selection:_e,d3Zoom:me,translateExtent:je,width:ve,height:oe}=w.getState();if(ae.sourceEvent.type!=="mousemove"||!_e||!me)return;const G=B.current*Math.max(1,ee[2])*(g?-1:1),K={x:ee[0]-ae.sourceEvent.movementX*G,y:ee[1]-ae.sourceEvent.movementY*G},J=[[0,0],[ve,oe]],pe=ln.translate(K.x,K.y).scale(ee[2]),fe=me.constrain()(pe,J,je);me.transform(_e,fe)},se=kC().on("zoom",x?Q:null).on("zoom.wheel",v?$:null);return W.call(se),()=>{W.on("zoom",null)}}},[x,v,g,y]);const X=p?W=>{const $=kr(W);p(W,{x:$[0],y:$[1]})}:void 0,Y=h?(W,$)=>{const Q=w.getState().nodeInternals.get($);h(W,Q)}:void 0;return V.createElement(Hn,{position:f,style:e,className:Yt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},V.createElement("svg",{width:j,height:R,viewBox:`${F} ${M} ${A} ${L}`,role:"img","aria-labelledby":z,ref:S,onClick:X},_&&V.createElement("title",{id:z},_),V.createElement(XD,{onClick:Y,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:l}),V.createElement("path",{className:"react-flow__minimap-mask",d:`M${F-I},${M-I}h${A+I*2}v${L+I*2}h${-A-I*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}bE.displayName="MiniMap";var _E=m.memo(bE);const nl={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},t6=180,r6=400,n6=260,i6=48;function s6(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function o6({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:i,onToggleShowArchived:s,userSection:o}){const[l,c]=m.useState(!1),[d,u]=m.useState(n6),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null);m.useEffect(()=>{x.current&&x.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const v=m.useMemo(()=>Object.values(e).sort((S,k)=>{const N=(S.name||"").localeCompare(k.name||"");return N!==0?N:(S.projectId||"").localeCompare(k.projectId||"")}),[e]),_=()=>{n()},g=m.useCallback(S=>{S.preventDefault(),p(!0)},[]),y=m.useCallback(S=>{if(!f)return;const k=Math.min(r6,Math.max(t6,S.clientX));u(k)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const w=l?i6:d;return a.jsxs("div",{ref:h,className:"h-full flex flex-col relative",style:{width:w,minWidth:w,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[a.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),a.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:i?"#f59e0b":"var(--text-muted)"},title:i?"Hide archived":"Show archived",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),a.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:a.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:v.map(S=>{const k=t===S.id;return a.jsxs("div",{ref:k?x:null,onClick:()=>r(S.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:k?"var(--state-active-bg)":"transparent",border:k?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:k?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:k?"#ffffff":nl[S.status]||nl.queued}}),a.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:k?"#ffffff":"var(--text-primary)"},children:S.name}),S.isArchived&&a.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:k?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[a.jsx("span",{className:"text-[10px] font-mono",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:S.projectId}),a.jsx("span",{className:"text-[10px]",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:s6(S.createdAt)})]})]},S.id)})}),l&&a.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:v.map(S=>a.jsx("div",{onClick:()=>r(S.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:S.name,children:a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:nl[S.status]||nl.queued,boxShadow:t===S.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},S.id))}),!l&&a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:_,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),a.jsx("span",{children:"New Project"})]})}),l&&a.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:_,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:a.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),o,!l&&a.jsx("div",{onMouseDown:g,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function a6({stations:e}){return e!=null&&e.length?a.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,r)=>{const n=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",i=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",s=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return a.jsxs(V.Fragment,{children:[r>0&&a.jsx("div",{className:"w-4 h-0.5",style:{background:i}}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:n}}),a.jsx("span",{className:"text-[7px] mt-0.5",style:{color:s,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const Db={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},wE=(e,t)=>{var r;return((r=Db[t])==null?void 0:r[e])||Db.industrial.queued},wr={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},Ao={GAP:8,WIDTH:280},ud=["pgc","asm","draft","qa","done"],An=["industrial","light","blueprint"];function l6({questions:e,nodeWidth:t,onSubmit:r,onClose:n,onZoomComplete:i}){const[s,o]=m.useState({}),l=e.filter(c=>c.required).every(c=>s[c.id]);return m.useEffect(()=>{if(i){const c=setTimeout(()=>i(),150);return()=>clearTimeout(c)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+Ao.GAP,width:Ao.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:Ao.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&a.jsx("span",{className:"text-amber-600",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:s[c.id]||"",onChange:d=>o(u=>({...u,[c.id]:d.target.value}))})]},c.id))}),a.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:a.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${l?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!l,onClick:()=>r(s),children:"Submit & Continue"})})]})}function c6({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:i}){const s=e.length>6,o=s?240:320;return m.useEffect(()=>{if(i){const l=setTimeout(()=>i(),150);return()=>clearTimeout(l)}},[i]),a.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:r+Ao.GAP,width:o,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[a.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:Ao.GAP}}),a.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),a.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),a.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),a.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${s?"":"grid grid-cols-2 gap-2"}`,children:e.map(l=>{const c=l.state==="complete"?"var(--state-stabilized-bg)":l.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return a.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${s?"mb-1":""}`,children:[a.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),a.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:l.name})]},l.id)})}),a.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const ty="/api/v1";class u6 extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function d6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function ze(e,t={}){const r=`${ty}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},i=await fetch(r,n);if(!i.ok){const s=await i.json().catch(()=>({}));throw new u6(s.detail||`Request failed: ${i.status}`,i.status,s)}return i.status===204?null:i.json()}const Ve={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":d6()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return ze(`/projects${r?"?"+r:""}`)},getProject:e=>ze(`/projects/${e}`),getProjectTree:e=>ze(`/projects/${e}/tree`),createProject:e=>ze("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>ze(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>ze(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>ze(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>ze(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>ze(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),ze(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>ze(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>ze(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>ze("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>ze(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>ze(`/document-workflows/executions/${e}`),getPgcAnswers:e=>ze(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>ze(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>ze(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>ze("/intake/start",{method:"POST"}),getIntakeState:e=>ze(`/intake/${e}`),submitIntakeMessage:(e,t)=>ze(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>ze(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>ze(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>ze(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>ze(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>ze(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>ze(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>ze(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>ze(`/projects/${e}/workflow/complete`,{method:"POST"})};function f6(e){const t=`${ty}/production/events?project_id=${e}`;return new EventSource(t)}function p6(e){const t=`${ty}/intake/${e}/events`;return new EventSource(t)}function h6(e){return`/auth/login/${e}`}function m6({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Lb({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const i=n==="numbered"?"decimal":"disc";return a.jsxs("div",{style:{marginBottom:12},children:[t.title&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),a.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":i},children:r.map((s,o)=>a.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&a.jsx("span",{style:{color:"#10b981"},children:""}),typeof s=="string"?s:(s==null?void 0:s.value)||(s==null?void 0:s.text)||(s==null?void 0:s.question)||(s==null?void 0:s.description)||JSON.stringify(s)]},o))})]})}function v6({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,s={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&a.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),a.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:s.bg,color:s.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function jE({block:e}){const{data:t}=e,{id:r,text:n,blocking:i,why_it_matters:s,priority:o,tags:l,options:c}=t,d={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},u=d[o]||d.should;return a.jsx("div",{style:{padding:"12px 16px",background:i?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${i?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),s&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:s}),a.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[i&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),o&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:u.bg,color:u.text,textTransform:"uppercase"},children:o}),l==null?void 0:l.map((f,p)=>a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},p))]}),c&&c.length>0&&a.jsxs("div",{style:{marginTop:8},children:[a.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,p)=>a.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:p>0?8:4},children:f},p))]})]})]})})}function g6({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,i=t.blocking_count||r.filter(s=>s.blocking).length;return r.length===0?a.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),i>0&&a.jsxs("span",{style:{color:"#dc2626"},children:[a.jsx("strong",{children:i})," blocking"]})]}),r.map((s,o)=>a.jsx(jE,{block:{type:"schema:OpenQuestionV1",data:s}},s.id||o))]})}function Fb({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const i={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return a.jsxs("div",{style:{marginBottom:12},children:[n&&a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((s,o)=>{const l=s.severity||s.likelihood||"medium",c=i[l]||i.medium;return a.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[s.id&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:s.id}),a.jsxs("div",{style:{flex:1},children:[a.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:s.description||s.reason||JSON.stringify(s)}),s.impact&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",s.impact]}),s.mitigation&&a.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",s.mitigation]})]}),a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},s.id||o)})})]})}function x6({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([i])=>t[i]&&typeof t[i]=="string").map(([i,s])=>({title:s,content:t[i]}));return n.length===0?null:a.jsx("div",{style:{marginBottom:12},children:n.map((i,s)=>a.jsxs("div",{style:{marginBottom:s<n.length-1?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:i.title}),a.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:a.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:i.content})})]},s))})}function zb({block:e}){const{data:t}=e,{epic_id:r,title:n,name:i,intent:s,phase:o,mvp_phase:l,risk_level:c,stories:d,detail_ref:u}=t,f=o||l,p=n||i,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},x=h[c]||h.medium,v={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},_=v[f]||v.mvp;return a.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),a.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),s&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s}),d&&d.length>0&&a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[d.length," stories"]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&a.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:_.bg,color:_.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&a.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:x.bg,color:x.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),u&&a.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:a.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function y6({block:e}){const{data:t}=e,{story_id:r,title:n,intent:i,phase:s,risk_level:o,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[o]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[s]||u.mvp;return a.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&a.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),i&&a.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:i})]}),a.jsxs("div",{style:{display:"flex",gap:4},children:[s&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:s}),d&&a.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:o})]})]})})}function b6({block:e}){const{type:t,data:r}=e;return a.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[a.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),a.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function _6({block:e}){const{data:t}=e,r=t.items||[],[n,i]=m.useState({});if(r.length===0)return null;const s=o=>{i(l=>({...l,[o]:!l[o]}))};return a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,l)=>{const c=n[l],d=o.why_it_matters||o.impact_if_unresolved;return a.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[a.jsxs("button",{onClick:()=>d&&s(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[a.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:o.question||o.value||o.text||"Unknown"}),d&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:a.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&a.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[o.why_it_matters&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.why_it_matters})]}),o.impact_if_unresolved&&a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),a.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:o.impact_if_unresolved})]})]})]},l)})})}function w6({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&a.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function j6({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:i}=t;return a.jsxs("div",{style:{marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&a.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),i&&a.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i})]})}function S6({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,i=r&&r.length>0,s=n&&n.length>0;return!i&&!s?null:a.jsxs("div",{style:{marginBottom:12},children:[i&&a.jsxs("div",{style:{marginBottom:s?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:o})]},l))})]}),s&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((o,l)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:o})]},l))})]})]})}function k6({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:i=[]}=t,s=r&&r.length>0,o=n&&n.length>0,l=i&&i.length>0;return!s&&!o&&!l?null:a.jsxs("div",{style:{marginBottom:12},children:[s&&a.jsxs("div",{style:{marginBottom:o||l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#3b82f6"},children:""}),a.jsx("span",{children:c})]},d))})]}),o&&a.jsxs("div",{style:{marginBottom:l?16:0},children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#f59e0b"},children:""}),a.jsx("span",{children:c})]},d))})]}),l&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),a.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:i.map((c,d)=>a.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[a.jsx("span",{style:{color:"#6b7280"},children:""}),a.jsx("span",{children:c})]},d))})]})]})}function N6({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:i}=t,o={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return a.jsxs("div",{style:{marginBottom:12},children:[r&&a.jsx("div",{style:{marginBottom:12},children:a.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:o.bg,color:o.text},children:r})}),n&&a.jsx("p",{style:{margin:0,marginBottom:i?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),i&&a.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:a.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",i]})})]})}const C6={"schema:ParagraphBlockV1":m6,"schema:StringListBlockV1":Lb,"schema:IndicatorBlockV1":v6,"schema:OpenQuestionV1":jE,"schema:OpenQuestionsBlockV1":g6,"schema:RisksBlockV1":Fb,"schema:DependenciesBlockV1":Fb,"schema:SummaryBlockV1":x6,"schema:EpicSummaryBlockV1":zb,"schema:StorySummaryBlockV1":y6,"schema:EpicStoriesCardBlockV1":zb,"schema:StoriesBlockV1":Lb,"schema:UnknownsBlockV1":_6,"schema:IntakeSummaryBlockV1":w6,"schema:IntakeProjectTypeBlockV1":j6,"schema:IntakeConstraintsBlockV1":S6,"schema:IntakeOpenGapsBlockV1":k6,"schema:IntakeOutcomeBlockV1":N6};function E6(e){return C6[e]||b6}function T6(e,t){const r=E6(e.type);return a.jsx(r,{block:e},e.key||t)}function SE({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:i=""}){var _;const[s,o]=m.useState(new Set(((_=e==null?void 0:e.sections)==null?void 0:_.map(g=>g.section_id))||[]));if(!e)return a.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return a.jsx(A6,{title:l,content:e.raw_content,reason:u.reason});const f=g=>{o(y=>{const b=new Set(y);return b.has(g)?b.delete(g):b.add(g),b})},p=t==="compact"||t==="sidecar",x=t==="sidecar"?d.filter(g=>g.viewer_tab==="overview"||!g.viewer_tab):d,v=(()=>{if(!l)return"Document";const g=l.indexOf(": ");return g>-1?l.slice(g+2):l})();return a.jsxs("div",{className:i,children:[t==="full"&&!r&&a.jsxs("div",{style:{marginBottom:24},children:[a.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:v}),c&&a.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:x.map(g=>a.jsx(R6,{section:g,isExpanded:s.has(g.section_id),onToggle:()=>f(g.section_id),onClick:()=>n==null?void 0:n(g),variant:t},g.section_id))}),x.length===0&&a.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function R6({section:e,isExpanded:t,onToggle:r,onClick:n,variant:i}){const{section_id:s,title:o,description:l,blocks:c=[],sidecar_max_items:d}=e,u=i==="compact"||i==="sidecar",f=i==="sidecar";if(c.length===0)return null;const p=f&&d&&c.length>d?c.slice(0,d):c,h=f&&d&&c.length>d;return a.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[a.jsxs("button",{onClick:r,style:{width:"100%",padding:u?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0,fontSize:u?13:15,fontWeight:600,color:"#111827"},children:[o,h&&a.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",d," of ",c.length,")"]})]}),l&&!u&&a.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:l})]}),a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:a.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&a.jsxs("div",{style:{padding:u?12:18},children:[p.map((x,v)=>T6(x,v)),h&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-d," more in full view"]})]})]})}function A6({title:e,content:t,reason:r}){return a.jsxs("div",{children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function I6({renderModel:e,projectCode:t,documentName:r,isExpanded:n,onToggleExpand:i,onClose:s,onViewFull:o,nodeWidth:l=280}){const p=n?900:520,h=n?900:600,x=`${t||"DOC"} - ${r||"Document"}`,v=_=>{_.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:l+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:v,onPointerDown:v,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const _=(e==null?void 0:e.title)||"DOCUMENT",g=_.indexOf(": ");return(g>-1?_.slice(g+2):_).toUpperCase()})()}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:i,title:n?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:n?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:s,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:n?600:400},children:a.jsx(SE,{renderModel:e,variant:"sidecar"})}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:o,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function M6({document:e,projectId:t,projectCode:r,nodeWidth:n,onClose:i,onZoomComplete:s,onViewFull:o}){const[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!0),[h,x]=m.useState(!1);return m.useEffect(()=>{if(s){const v=setTimeout(()=>s(),150);return()=>clearTimeout(v)}},[s]),m.useEffect(()=>{async function v(){var _;if(!t||!e.id){p(!1);return}try{p(!0);try{const y=await Ve.getDocumentRenderModel(t,e.id);if(y&&y.sections&&y.sections.length>0){c(y),u(null);return}if((_=y==null?void 0:y.metadata)!=null&&_.fallback&&y.raw_content){c(null),u(y.raw_content);return}}catch(y){console.log("RenderModel not available, falling back to raw document:",y.message)}const g=await Ve.getDocument(t,e.id);c(null),u((g==null?void 0:g.content)||null)}catch(g){console.error("Failed to fetch document for sidecar:",g)}finally{p(!1)}}v()},[t,e.id]),f?null:l?a.jsx(I6,{renderModel:l,projectCode:r,documentName:e.name,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id),nodeWidth:n}):a.jsx(P6,{document:e,projectCode:r,rawContent:d,nodeWidth:n,isExpanded:h,onToggleExpand:()=>x(!h),onClose:i,onViewFull:()=>o==null?void 0:o(e.id)})}function P6({document:e,projectCode:t,rawContent:r,nodeWidth:n,isExpanded:i,onToggleExpand:s,onClose:o,onViewFull:l}){var _;const p=i?900:520,h=i?900:600,x=`${t||"DOC"} - ${e.name||"Document"}`,v=g=>{g.stopPropagation()};return a.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:n+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:v,onPointerDown:v,children:[a.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),a.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),a.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[a.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),a.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((_=e.name)==null?void 0:_.toUpperCase())||"DOCUMENT"}),a.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:x})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:s,title:i?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),a.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),a.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:i?600:400},children:[a.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]}),a.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:a.jsxs("button",{onClick:l,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("span",{children:"View Full Document"}),a.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const O6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function D6({data:e}){var w,S,k;const r=(e.level||1)===1,n=e.isExpanded,i=e.expandType,s=((w=e.questions)==null?void 0:w.length)>0,o=((S=e.features)==null?void 0:S.length)>0,l=(k=e.stations)==null?void 0:k.some(N=>N.needs_input),c=e.state||"ready_for_production",d=["produced","stabilized","ready"].includes(c),u=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),p=u&&e.stations,h=u?"node-active":"",x=r?"DOCUMENT":"EPIC",v=r?"subway-node-header-doc":"subway-node-header-epic",_=d?"var(--state-produced-bg, var(--state-stabilized-bg))":u?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",g=d?"var(--state-produced-text, var(--state-stabilized-text))":u?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",y=u?"var(--state-in-production-bg, var(--state-active-bg))":d?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=O6[c]||c;return a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{type:"target",position:ce.Top,className:"!opacity-0",style:{left:"15%"}}),a.jsxs("div",{className:`subway-node rounded-lg border ${h} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:y},children:[a.jsxs("div",{className:`${v} border-b px-3 py-1.5 flex items-center justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:x}),a.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&a.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:_}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:g},children:b}),r&&e.desc&&a.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),p&&a.jsx(a6,{stations:e.stations}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&d&&a.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"document")},children:"View Document"}),l&&s&&!n&&a.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&o&&(n&&i==="features"?a.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):a.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:N=>{var E;N.stopPropagation(),(E=e.onExpand)==null||E.call(e,e.id,"features")},children:[a.jsx("span",{className:"text-indigo-400",children:e.features.length}),a.jsx("span",{children:"features"}),a.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),n&&i==="questions"&&s&&a.jsx(l6,{questions:e.questions,nodeWidth:e.width,onSubmit:N=>{var E;return(E=e.onSubmitQuestions)==null?void 0:E.call(e,e.id,N)},onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&i==="features"&&o&&a.jsx(c6,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&i==="document"&&r&&d&&a.jsx(M6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)},onViewFull:N=>{var E;return(E=e.onViewFullDocument)==null?void 0:E.call(e,N)}}),a.jsx(Ur,{type:"source",position:ce.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function L6(){return a.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[a.jsx(Ur,{type:"target",position:ce.Top,style:{opacity:0}}),a.jsx(Ur,{type:"source",position:ce.Bottom,style:{opacity:0}})]})}function F6({projectId:e,projectCode:t,docTypeId:r,onClose:n}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null);return m.useEffect(()=>{async function p(){var h;try{d(!0),f(null);try{const v=await Ve.getDocumentRenderModel(e,r);if(v&&v.sections&&v.sections.length>0){s(v),l(null);return}if((h=v==null?void 0:v.metadata)!=null&&h.fallback&&v.raw_content){s(null),l(v.raw_content);return}}catch(v){console.log("RenderModel not available, falling back to raw document:",v.message)}const x=await Ve.getDocument(e,r);s(null),l((x==null?void 0:x.content)||null)}catch(x){f(x.message),console.error("Failed to fetch document:",x)}finally{d(!1)}}p()},[e,r]),m.useEffect(()=>{const p=h=>{h.key==="Escape"&&n()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[n]),c?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:a.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:p=>p.target===p.currentTarget&&n(),children:a.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[a.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsx("div",{children:t&&a.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),a.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-red-500",children:u})}),i&&a.jsx(SE,{renderModel:i,variant:"full"}),o&&!i&&a.jsx(z6,{content:o,docTypeId:r}),!i&&!o&&!u&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function z6({content:e,docTypeId:t}){if(!e)return a.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n=e.description||e.summary||e.preliminary_summary;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",a.jsx("strong",{children:t})," - displaying raw content"]}),(r||n)&&a.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[r&&a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),n&&a.jsx("p",{className:"text-gray-700 text-sm",children:n})]}),a.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:a.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const q6="/api/v1/admin";class $6 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function B6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Ne(e,t={}){var s;const r=`${q6}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const o=B6();o&&(n.headers["X-CSRF-Token"]=o)}const i=await fetch(r,n);if(!i.ok){const o=await i.json().catch(()=>({})),l=((s=o.detail)==null?void 0:s.message)||o.detail||`Request failed: ${i.status}`;throw new $6(l,i.status,o.detail||o)}return i.status===204?null:i.json()}const we={getCurrentWorkspace:async()=>{try{return await Ne("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Ne("/workspaces",{method:"POST"}),getWorkspaceState:e=>Ne(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Ne(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,r)=>Ne(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Ne(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Ne(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Ne(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Ne(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Ne("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Ne(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Ne("/workbench/prompt-fragments"),getRoles:()=>Ne("/workbench/roles"),getTemplates:()=>Ne("/workbench/templates"),getSchemas:()=>Ne("/workbench/schemas"),getSchema:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/schemas/${e}${r}`)},getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Ne("/workbench/workflows"),getOrchestrationWorkflows:()=>Ne("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Ne(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Ne(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Ne(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Ne(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Ne(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Ne(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Ne("/workbench/active-releases"),invalidateCache:()=>Ne("/workbench/cache/invalidate",{method:"POST"}),getMechanicalOpTypes:()=>Ne("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Ne(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Ne("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Ne("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const r=t?`?version=${t}`:"";return Ne(`/workbench/mechanical-ops/${e}${r}`)}};function H6({projectId:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,x]=m.useState(!1),[v,_]=m.useState(null),[g,y]=m.useState(!1),[b,w]=m.useState(!1),S=m.useCallback(async()=>{try{const C=((await we.getOrchestrationWorkflows()).workflows||[]).filter(I=>I.workflow_id!=="intake_and_route"),O=C.find(I=>I.workflow_id==="software_product_development")||C[0];if(O){const I=await Ve.createWorkflowInstance(e,O.workflow_id,O.active_version);r(I)}}catch(q){console.error("Failed to auto-assign workflow:",q)}},[e]),k=m.useCallback(async()=>{if(e){i(!0),o(null);try{const q=await Ve.getWorkflowInstance(e);r(q)}catch(q){q.status===404?(r(null),await S()):o(q.message)}finally{i(!1)}}},[e,S]);m.useEffect(()=>{k()},[k]);const N=async()=>{c(!0),p(!0);try{const C=((await we.getOrchestrationWorkflows()).workflows||[]).filter(O=>O.workflow_id!=="intake_and_route");u(C)}catch{u([])}finally{p(!1)}},E=async q=>{x(!0);try{const C=await Ve.createWorkflowInstance(e,q.workflow_id,q.active_version);r(C),c(!1)}catch(C){o(C.message)}finally{x(!1)}},j=async()=>{if(t&&(w(!b),!v)){y(!0);try{const q=await Ve.getWorkflowDrift(e);_(q)}catch(q){_({error:q.message})}finally{y(!1)}}};if(n)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(s&&!t)return a.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:s});if(!t)return a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?a.jsx(W6,{workflows:d,loading:f,assigning:h,onSelect:E,onCancel:()=>c(!1)}):a.jsx("button",{onClick:N,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const R=t.effective_workflow||{},T=R.steps||[],D=t.base_workflow_ref||{};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:R.name||D.workflow_id||"Workflow"}),a.jsx(U6,{status:t.status})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",D.workflow_id," v",D.version,D.pow_class?` (${D.pow_class})`:""]})]}),a.jsx("button",{onClick:j,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:g?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&v&&a.jsx(V6,{drift:v}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",T.length,")"]}),T.length===0?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):a.jsx("div",{className:"space-y-1",children:T.map((q,C)=>a.jsx(G6,{step:q,index:C},q.step_id||C))})]}),s&&a.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:s})]})}function W6({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:i}){const s=e.filter(l=>(l.pow_class||"reference")==="reference"),o=e.filter(l=>l.pow_class==="template");return a.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs(a.Fragment,{children:[s.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),s.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),o.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),o.map(l=>a.jsxs("button",{onClick:()=>n(l),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[a.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),s.length===0&&o.length===0&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),a.jsx("button",{onClick:i,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function U6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function V6({drift:e}){return e.error?a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):a.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[a.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[a.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),a.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&a.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&a.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&a.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&a.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&a.jsx("div",{children:"~ Metadata changed"})]})]})}function G6({step:e,index:t}){return a.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&a.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&a.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function ry(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dd,qb;function K6(){if(qb)return dd;qb=1;function e(){this.__data__=[],this.size=0}return dd=e,dd}var fd,$b;function Is(){if($b)return fd;$b=1;function e(t,r){return t===r||t!==t&&r!==r}return fd=e,fd}var pd,Bb;function Jc(){if(Bb)return pd;Bb=1;var e=Is();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return pd=t,pd}var hd,Hb;function Y6(){if(Hb)return hd;Hb=1;var e=Jc(),t=Array.prototype,r=t.splice;function n(i){var s=this.__data__,o=e(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return hd=n,hd}var md,Wb;function X6(){if(Wb)return md;Wb=1;var e=Jc();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return md=t,md}var vd,Ub;function Q6(){if(Ub)return vd;Ub=1;var e=Jc();function t(r){return e(this.__data__,r)>-1}return vd=t,vd}var gd,Vb;function Z6(){if(Vb)return gd;Vb=1;var e=Jc();function t(r,n){var i=this.__data__,s=e(i,r);return s<0?(++this.size,i.push([r,n])):i[s][1]=n,this}return gd=t,gd}var xd,Gb;function eu(){if(Gb)return xd;Gb=1;var e=K6(),t=Y6(),r=X6(),n=Q6(),i=Z6();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,xd=s,xd}var yd,Kb;function J6(){if(Kb)return yd;Kb=1;var e=eu();function t(){this.__data__=new e,this.size=0}return yd=t,yd}var bd,Yb;function eL(){if(Yb)return bd;Yb=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return bd=e,bd}var _d,Xb;function tL(){if(Xb)return _d;Xb=1;function e(t){return this.__data__.get(t)}return _d=e,_d}var wd,Qb;function rL(){if(Qb)return wd;Qb=1;function e(t){return this.__data__.has(t)}return wd=e,wd}var jd,Zb;function kE(){if(Zb)return jd;Zb=1;var e=typeof Ra=="object"&&Ra&&Ra.Object===Object&&Ra;return jd=e,jd}var Sd,Jb;function Mr(){if(Jb)return Sd;Jb=1;var e=kE(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Sd=r,Sd}var kd,e1;function Ms(){if(e1)return kd;e1=1;var e=Mr(),t=e.Symbol;return kd=t,kd}var Nd,t1;function nL(){if(t1)return Nd;t1=1;var e=Ms(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function s(o){var l=r.call(o,i),c=o[i];try{o[i]=void 0;var d=!0}catch{}var u=n.call(o);return d&&(l?o[i]=c:delete o[i]),u}return Nd=s,Nd}var Cd,r1;function iL(){if(r1)return Cd;r1=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Cd=r,Cd}var Ed,n1;function Ti(){if(n1)return Ed;n1=1;var e=Ms(),t=nL(),r=iL(),n="[object Null]",i="[object Undefined]",s=e?e.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?t(l):r(l)}return Ed=o,Ed}var Td,i1;function xr(){if(i1)return Td;i1=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Td=e,Td}var Rd,s1;function _a(){if(s1)return Rd;s1=1;var e=Ti(),t=xr(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=e(l);return c==n||c==i||c==r||c==s}return Rd=o,Rd}var Ad,o1;function sL(){if(o1)return Ad;o1=1;var e=Mr(),t=e["__core-js_shared__"];return Ad=t,Ad}var Id,a1;function oL(){if(a1)return Id;a1=1;var e=sL(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Id=r,Id}var Md,l1;function NE(){if(l1)return Md;l1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Md=r,Md}var Pd,c1;function aL(){if(c1)return Pd;c1=1;var e=_a(),t=oL(),r=xr(),n=NE(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?u:s;return h.test(n(p))}return Pd=f,Pd}var Od,u1;function lL(){if(u1)return Od;u1=1;function e(t,r){return t==null?void 0:t[r]}return Od=e,Od}var Dd,d1;function Ri(){if(d1)return Dd;d1=1;var e=aL(),t=lL();function r(n,i){var s=t(n,i);return e(s)?s:void 0}return Dd=r,Dd}var Ld,f1;function ny(){if(f1)return Ld;f1=1;var e=Ri(),t=Mr(),r=e(t,"Map");return Ld=r,Ld}var Fd,p1;function tu(){if(p1)return Fd;p1=1;var e=Ri(),t=e(Object,"create");return Fd=t,Fd}var zd,h1;function cL(){if(h1)return zd;h1=1;var e=tu();function t(){this.__data__=e?e(null):{},this.size=0}return zd=t,zd}var qd,m1;function uL(){if(m1)return qd;m1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return qd=e,qd}var $d,v1;function dL(){if(v1)return $d;v1=1;var e=tu(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(s){var o=this.__data__;if(e){var l=o[s];return l===t?void 0:l}return n.call(o,s)?o[s]:void 0}return $d=i,$d}var Bd,g1;function fL(){if(g1)return Bd;g1=1;var e=tu(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var s=this.__data__;return e?s[i]!==void 0:r.call(s,i)}return Bd=n,Bd}var Hd,x1;function pL(){if(x1)return Hd;x1=1;var e=tu(),t="__lodash_hash_undefined__";function r(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=e&&i===void 0?t:i,this}return Hd=r,Hd}var Wd,y1;function hL(){if(y1)return Wd;y1=1;var e=cL(),t=uL(),r=dL(),n=fL(),i=pL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,Wd=s,Wd}var Ud,b1;function mL(){if(b1)return Ud;b1=1;var e=hL(),t=eu(),r=ny();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Ud=n,Ud}var Vd,_1;function vL(){if(_1)return Vd;_1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Vd=e,Vd}var Gd,w1;function ru(){if(w1)return Gd;w1=1;var e=vL();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Gd=t,Gd}var Kd,j1;function gL(){if(j1)return Kd;j1=1;var e=ru();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Kd=t,Kd}var Yd,S1;function xL(){if(S1)return Yd;S1=1;var e=ru();function t(r){return e(this,r).get(r)}return Yd=t,Yd}var Xd,k1;function yL(){if(k1)return Xd;k1=1;var e=ru();function t(r){return e(this,r).has(r)}return Xd=t,Xd}var Qd,N1;function bL(){if(N1)return Qd;N1=1;var e=ru();function t(r,n){var i=e(this,r),s=i.size;return i.set(r,n),this.size+=i.size==s?0:1,this}return Qd=t,Qd}var Zd,C1;function iy(){if(C1)return Zd;C1=1;var e=mL(),t=gL(),r=xL(),n=yL(),i=bL();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var d=o[l];this.set(d[0],d[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=i,Zd=s,Zd}var Jd,E1;function _L(){if(E1)return Jd;E1=1;var e=eu(),t=ny(),r=iy(),n=200;function i(s,o){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([s,o]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(s,o),this.size=l.size,this}return Jd=i,Jd}var ef,T1;function nu(){if(T1)return ef;T1=1;var e=eu(),t=J6(),r=eL(),n=tL(),i=rL(),s=_L();function o(l){var c=this.__data__=new e(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=i,o.prototype.set=s,ef=o,ef}var tf,R1;function sy(){if(R1)return tf;R1=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return tf=e,tf}var rf,A1;function CE(){if(A1)return rf;A1=1;var e=Ri(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return rf=t,rf}var nf,I1;function iu(){if(I1)return nf;I1=1;var e=CE();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return nf=t,nf}var sf,M1;function su(){if(M1)return sf;M1=1;var e=iu(),t=Is(),r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l){var c=s[o];(!(n.call(s,o)&&t(c,l))||l===void 0&&!(o in s))&&e(s,o,l)}return sf=i,sf}var of,P1;function wa(){if(P1)return of;P1=1;var e=su(),t=iu();function r(n,i,s,o){var l=!s;s||(s={});for(var c=-1,d=i.length;++c<d;){var u=i[c],f=o?o(s[u],n[u],u,s,n):void 0;f===void 0&&(f=n[u]),l?t(s,u,f):e(s,u,f)}return s}return of=r,of}var af,O1;function wL(){if(O1)return af;O1=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return af=e,af}var lf,D1;function Kr(){if(D1)return lf;D1=1;function e(t){return t!=null&&typeof t=="object"}return lf=e,lf}var cf,L1;function jL(){if(L1)return cf;L1=1;var e=Ti(),t=Kr(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return cf=n,cf}var uf,F1;function ja(){if(F1)return uf;F1=1;var e=jL(),t=Kr(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,s=e(function(){return arguments}())?e:function(o){return t(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return uf=s,uf}var df,z1;function ot(){if(z1)return df;z1=1;var e=Array.isArray;return df=e,df}var mo={exports:{}},ff,q1;function SL(){if(q1)return ff;q1=1;function e(){return!1}return ff=e,ff}mo.exports;var $1;function Ps(){return $1||($1=1,function(e,t){var r=Mr(),n=SL(),i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===i,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d}(mo,mo.exports)),mo.exports}var pf,B1;function ou(){if(B1)return pf;B1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var s=typeof n;return i=i??e,!!i&&(s=="number"||s!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return pf=r,pf}var hf,H1;function oy(){if(H1)return hf;H1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return hf=t,hf}var mf,W1;function kL(){if(W1)return mf;W1=1;var e=Ti(),t=oy(),r=Kr(),n="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",x="[object String]",v="[object WeakMap]",_="[object ArrayBuffer]",g="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",w="[object Int8Array]",S="[object Int16Array]",k="[object Int32Array]",N="[object Uint8Array]",E="[object Uint8ClampedArray]",j="[object Uint16Array]",R="[object Uint32Array]",T={};T[y]=T[b]=T[w]=T[S]=T[k]=T[N]=T[E]=T[j]=T[R]=!0,T[n]=T[i]=T[_]=T[s]=T[g]=T[o]=T[l]=T[c]=T[d]=T[u]=T[f]=T[p]=T[h]=T[x]=T[v]=!1;function D(q){return r(q)&&t(q.length)&&!!T[e(q)]}return mf=D,mf}var vf,U1;function au(){if(U1)return vf;U1=1;function e(t){return function(r){return t(r)}}return vf=e,vf}var vo={exports:{}};vo.exports;var V1;function ay(){return V1||(V1=1,function(e,t){var r=kE(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l}(vo,vo.exports)),vo.exports}var gf,G1;function Sa(){if(G1)return gf;G1=1;var e=kL(),t=au(),r=ay(),n=r&&r.isTypedArray,i=n?t(n):e;return gf=i,gf}var xf,K1;function EE(){if(K1)return xf;K1=1;var e=wL(),t=ja(),r=ot(),n=Ps(),i=ou(),s=Sa(),o=Object.prototype,l=o.hasOwnProperty;function c(d,u){var f=r(d),p=!f&&t(d),h=!f&&!p&&n(d),x=!f&&!p&&!h&&s(d),v=f||p||h||x,_=v?e(d.length,String):[],g=_.length;for(var y in d)(u||l.call(d,y))&&!(v&&(y=="length"||h&&(y=="offset"||y=="parent")||x&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||i(y,g)))&&_.push(y);return _}return xf=c,xf}var yf,Y1;function lu(){if(Y1)return yf;Y1=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return yf=t,yf}var bf,X1;function TE(){if(X1)return bf;X1=1;function e(t,r){return function(n){return t(r(n))}}return bf=e,bf}var _f,Q1;function NL(){if(Q1)return _f;Q1=1;var e=TE(),t=e(Object.keys,Object);return _f=t,_f}var wf,Z1;function ly(){if(Z1)return wf;Z1=1;var e=lu(),t=NL(),r=Object.prototype,n=r.hasOwnProperty;function i(s){if(!e(s))return t(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return wf=i,wf}var jf,J1;function xn(){if(J1)return jf;J1=1;var e=_a(),t=oy();function r(n){return n!=null&&t(n.length)&&!e(n)}return jf=r,jf}var Sf,e_;function ei(){if(e_)return Sf;e_=1;var e=EE(),t=ly(),r=xn();function n(i){return r(i)?e(i):t(i)}return Sf=n,Sf}var kf,t_;function CL(){if(t_)return kf;t_=1;var e=wa(),t=ei();function r(n,i){return n&&e(i,t(i),n)}return kf=r,kf}var Nf,r_;function EL(){if(r_)return Nf;r_=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return Nf=e,Nf}var Cf,n_;function TL(){if(n_)return Cf;n_=1;var e=xr(),t=lu(),r=EL(),n=Object.prototype,i=n.hasOwnProperty;function s(o){if(!e(o))return r(o);var l=t(o),c=[];for(var d in o)d=="constructor"&&(l||!i.call(o,d))||c.push(d);return c}return Cf=s,Cf}var Ef,i_;function Ai(){if(i_)return Ef;i_=1;var e=EE(),t=TL(),r=xn();function n(i){return r(i)?e(i,!0):t(i)}return Ef=n,Ef}var Tf,s_;function RL(){if(s_)return Tf;s_=1;var e=wa(),t=Ai();function r(n,i){return n&&e(i,t(i),n)}return Tf=r,Tf}var go={exports:{}};go.exports;var o_;function RE(){return o_||(o_=1,function(e,t){var r=Mr(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===n,o=s?r.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(go,go.exports)),go.exports}var Rf,a_;function AE(){if(a_)return Rf;a_=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return Rf=e,Rf}var Af,l_;function IE(){if(l_)return Af;l_=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=0,o=[];++n<i;){var l=t[n];r(l,n,t)&&(o[s++]=l)}return o}return Af=e,Af}var If,c_;function ME(){if(c_)return If;c_=1;function e(){return[]}return If=e,If}var Mf,u_;function cy(){if(u_)return Mf;u_=1;var e=IE(),t=ME(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),e(i(o),function(l){return n.call(o,l)}))}:t;return Mf=s,Mf}var Pf,d_;function AL(){if(d_)return Pf;d_=1;var e=wa(),t=cy();function r(n,i){return e(n,t(n),i)}return Pf=r,Pf}var Of,f_;function uy(){if(f_)return Of;f_=1;function e(t,r){for(var n=-1,i=r.length,s=t.length;++n<i;)t[s+n]=r[n];return t}return Of=e,Of}var Df,p_;function cu(){if(p_)return Df;p_=1;var e=TE(),t=e(Object.getPrototypeOf,Object);return Df=t,Df}var Lf,h_;function PE(){if(h_)return Lf;h_=1;var e=uy(),t=cu(),r=cy(),n=ME(),i=Object.getOwnPropertySymbols,s=i?function(o){for(var l=[];o;)e(l,r(o)),o=t(o);return l}:n;return Lf=s,Lf}var Ff,m_;function IL(){if(m_)return Ff;m_=1;var e=wa(),t=PE();function r(n,i){return e(n,t(n),i)}return Ff=r,Ff}var zf,v_;function OE(){if(v_)return zf;v_=1;var e=uy(),t=ot();function r(n,i,s){var o=i(n);return t(n)?o:e(o,s(n))}return zf=r,zf}var qf,g_;function DE(){if(g_)return qf;g_=1;var e=OE(),t=cy(),r=ei();function n(i){return e(i,r,t)}return qf=n,qf}var $f,x_;function ML(){if(x_)return $f;x_=1;var e=OE(),t=PE(),r=Ai();function n(i){return e(i,r,t)}return $f=n,$f}var Bf,y_;function PL(){if(y_)return Bf;y_=1;var e=Ri(),t=Mr(),r=e(t,"DataView");return Bf=r,Bf}var Hf,b_;function OL(){if(b_)return Hf;b_=1;var e=Ri(),t=Mr(),r=e(t,"Promise");return Hf=r,Hf}var Wf,__;function LE(){if(__)return Wf;__=1;var e=Ri(),t=Mr(),r=e(t,"Set");return Wf=r,Wf}var Uf,w_;function DL(){if(w_)return Uf;w_=1;var e=Ri(),t=Mr(),r=e(t,"WeakMap");return Uf=r,Uf}var Vf,j_;function Os(){if(j_)return Vf;j_=1;var e=PL(),t=ny(),r=OL(),n=LE(),i=DL(),s=Ti(),o=NE(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=o(e),x=o(t),v=o(r),_=o(n),g=o(i),y=s;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||r&&y(r.resolve())!=d||n&&y(new n)!=u||i&&y(new i)!=f)&&(y=function(b){var w=s(b),S=w==c?b.constructor:void 0,k=S?o(S):"";if(k)switch(k){case h:return p;case x:return l;case v:return d;case _:return u;case g:return f}return w}),Vf=y,Vf}var Gf,S_;function LL(){if(S_)return Gf;S_=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,s=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(s.index=n.index,s.input=n.input),s}return Gf=r,Gf}var Kf,k_;function FE(){if(k_)return Kf;k_=1;var e=Mr(),t=e.Uint8Array;return Kf=t,Kf}var Yf,N_;function dy(){if(N_)return Yf;N_=1;var e=FE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return Yf=t,Yf}var Xf,C_;function FL(){if(C_)return Xf;C_=1;var e=dy();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return Xf=t,Xf}var Qf,E_;function zL(){if(E_)return Qf;E_=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return Qf=t,Qf}var Zf,T_;function qL(){if(T_)return Zf;T_=1;var e=Ms(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return Zf=n,Zf}var Jf,R_;function zE(){if(R_)return Jf;R_=1;var e=dy();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return Jf=t,Jf}var ep,A_;function $L(){if(A_)return ep;A_=1;var e=dy(),t=FL(),r=zL(),n=qL(),i=zE(),s="[object Boolean]",o="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",x="[object DataView]",v="[object Float32Array]",_="[object Float64Array]",g="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",w="[object Uint8Array]",S="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]";function E(j,R,T){var D=j.constructor;switch(R){case h:return e(j);case s:case o:return new D(+j);case x:return t(j,T);case v:case _:case g:case y:case b:case w:case S:case k:case N:return i(j,T);case l:return new D;case c:case f:return new D(j);case d:return r(j);case u:return new D;case p:return n(j)}}return ep=E,ep}var tp,I_;function qE(){if(I_)return tp;I_=1;var e=xr(),t=Object.create,r=function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var s=new n;return n.prototype=void 0,s}}();return tp=r,tp}var rp,M_;function $E(){if(M_)return rp;M_=1;var e=qE(),t=cu(),r=lu();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return rp=n,rp}var np,P_;function BL(){if(P_)return np;P_=1;var e=Os(),t=Kr(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return np=n,np}var ip,O_;function HL(){if(O_)return ip;O_=1;var e=BL(),t=au(),r=ay(),n=r&&r.isMap,i=n?t(n):e;return ip=i,ip}var sp,D_;function WL(){if(D_)return sp;D_=1;var e=Os(),t=Kr(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return sp=n,sp}var op,L_;function UL(){if(L_)return op;L_=1;var e=WL(),t=au(),r=ay(),n=r&&r.isSet,i=n?t(n):e;return op=i,op}var ap,F_;function BE(){if(F_)return ap;F_=1;var e=nu(),t=sy(),r=su(),n=CL(),i=RL(),s=RE(),o=AE(),l=AL(),c=IL(),d=DE(),u=ML(),f=Os(),p=LL(),h=$L(),x=$E(),v=ot(),_=Ps(),g=HL(),y=xr(),b=UL(),w=ei(),S=Ai(),k=1,N=2,E=4,j="[object Arguments]",R="[object Array]",T="[object Boolean]",D="[object Date]",q="[object Error]",C="[object Function]",O="[object GeneratorFunction]",I="[object Map]",F="[object Number]",M="[object Object]",A="[object RegExp]",L="[object Set]",z="[object String]",B="[object Symbol]",X="[object WeakMap]",Y="[object ArrayBuffer]",W="[object DataView]",$="[object Float32Array]",Q="[object Float64Array]",se="[object Int8Array]",ae="[object Int16Array]",ee="[object Int32Array]",_e="[object Uint8Array]",me="[object Uint8ClampedArray]",je="[object Uint16Array]",ve="[object Uint32Array]",oe={};oe[j]=oe[R]=oe[Y]=oe[W]=oe[T]=oe[D]=oe[$]=oe[Q]=oe[se]=oe[ae]=oe[ee]=oe[I]=oe[F]=oe[M]=oe[A]=oe[L]=oe[z]=oe[B]=oe[_e]=oe[me]=oe[je]=oe[ve]=!0,oe[q]=oe[C]=oe[X]=!1;function G(K,J,pe,fe,be,xe){var re,he=J&k,Ke=J&N,Fe=J&E;if(pe&&(re=be?pe(K,fe,be,xe):pe(K)),re!==void 0)return re;if(!y(K))return K;var $e=v(K);if($e){if(re=p(K),!he)return o(K,re)}else{var Te=f(K),Be=Te==C||Te==O;if(_(K))return s(K,he);if(Te==M||Te==j||Be&&!be){if(re=Ke||Be?{}:x(K),!he)return Ke?c(K,i(re,K)):l(K,n(re,K))}else{if(!oe[Te])return be?K:{};re=h(K,Te,he)}}xe||(xe=new e);var at=xe.get(K);if(at)return at;xe.set(K,re),b(K)?K.forEach(function(Pe){re.add(G(Pe,J,pe,Pe,K,xe))}):g(K)&&K.forEach(function(Pe,ge){re.set(ge,G(Pe,J,pe,ge,K,xe))});var Re=Fe?Ke?u:d:Ke?S:w,Z=$e?void 0:Re(K);return t(Z||K,function(Pe,ge){Z&&(ge=Pe,Pe=K[ge]),r(re,ge,G(Pe,J,pe,ge,K,xe))}),re}return ap=G,ap}var lp,z_;function VL(){if(z_)return lp;z_=1;var e=BE(),t=4;function r(n){return e(n,t)}return lp=r,lp}var cp,q_;function fy(){if(q_)return cp;q_=1;function e(t){return function(){return t}}return cp=e,cp}var up,$_;function GL(){if($_)return up;$_=1;function e(t){return function(r,n,i){for(var s=-1,o=Object(r),l=i(r),c=l.length;c--;){var d=l[t?c:++s];if(n(o[d],d,o)===!1)break}return r}}return up=e,up}var dp,B_;function py(){if(B_)return dp;B_=1;var e=GL(),t=e();return dp=t,dp}var fp,H_;function hy(){if(H_)return fp;H_=1;var e=py(),t=ei();function r(n,i){return n&&e(n,i,t)}return fp=r,fp}var pp,W_;function KL(){if(W_)return pp;W_=1;var e=xn();function t(r,n){return function(i,s){if(i==null)return i;if(!e(i))return r(i,s);for(var o=i.length,l=n?o:-1,c=Object(i);(n?l--:++l<o)&&s(c[l],l,c)!==!1;);return i}}return pp=t,pp}var hp,U_;function uu(){if(U_)return hp;U_=1;var e=hy(),t=KL(),r=t(e);return hp=r,hp}var mp,V_;function Ii(){if(V_)return mp;V_=1;function e(t){return t}return mp=e,mp}var vp,G_;function HE(){if(G_)return vp;G_=1;var e=Ii();function t(r){return typeof r=="function"?r:e}return vp=t,vp}var gp,K_;function WE(){if(K_)return gp;K_=1;var e=sy(),t=uu(),r=HE(),n=ot();function i(s,o){var l=n(s)?e:t;return l(s,r(o))}return gp=i,gp}var xp,Y_;function UE(){return Y_||(Y_=1,xp=WE()),xp}var yp,X_;function YL(){if(X_)return yp;X_=1;var e=uu();function t(r,n){var i=[];return e(r,function(s,o,l){n(s,o,l)&&i.push(s)}),i}return yp=t,yp}var bp,Q_;function XL(){if(Q_)return bp;Q_=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return bp=t,bp}var _p,Z_;function QL(){if(Z_)return _p;Z_=1;function e(t){return this.__data__.has(t)}return _p=e,_p}var wp,J_;function VE(){if(J_)return wp;J_=1;var e=iy(),t=XL(),r=QL();function n(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new e;++s<o;)this.add(i[s])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,wp=n,wp}var jp,ew;function ZL(){if(ew)return jp;ew=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return jp=e,jp}var Sp,tw;function GE(){if(tw)return Sp;tw=1;function e(t,r){return t.has(r)}return Sp=e,Sp}var kp,rw;function KE(){if(rw)return kp;rw=1;var e=VE(),t=ZL(),r=GE(),n=1,i=2;function s(o,l,c,d,u,f){var p=c&n,h=o.length,x=l.length;if(h!=x&&!(p&&x>h))return!1;var v=f.get(o),_=f.get(l);if(v&&_)return v==l&&_==o;var g=-1,y=!0,b=c&i?new e:void 0;for(f.set(o,l),f.set(l,o);++g<h;){var w=o[g],S=l[g];if(d)var k=p?d(S,w,g,l,o,f):d(w,S,g,o,l,f);if(k!==void 0){if(k)continue;y=!1;break}if(b){if(!t(l,function(N,E){if(!r(b,E)&&(w===N||u(w,N,c,d,f)))return b.push(E)})){y=!1;break}}else if(!(w===S||u(w,S,c,d,f))){y=!1;break}}return f.delete(o),f.delete(l),y}return kp=s,kp}var Np,nw;function JL(){if(nw)return Np;nw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,s){n[++r]=[s,i]}),n}return Np=e,Np}var Cp,iw;function my(){if(iw)return Cp;iw=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return Cp=e,Cp}var Ep,sw;function e8(){if(sw)return Ep;sw=1;var e=Ms(),t=FE(),r=Is(),n=KE(),i=JL(),s=my(),o=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",x="[object Set]",v="[object String]",_="[object Symbol]",g="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,w=b?b.valueOf:void 0;function S(k,N,E,j,R,T,D){switch(E){case y:if(k.byteLength!=N.byteLength||k.byteOffset!=N.byteOffset)return!1;k=k.buffer,N=N.buffer;case g:return!(k.byteLength!=N.byteLength||!T(new t(k),new t(N)));case c:case d:case p:return r(+k,+N);case u:return k.name==N.name&&k.message==N.message;case h:case v:return k==N+"";case f:var q=i;case x:var C=j&o;if(q||(q=s),k.size!=N.size&&!C)return!1;var O=D.get(k);if(O)return O==N;j|=l,D.set(k,N);var I=n(q(k),q(N),j,R,T,D);return D.delete(k),I;case _:if(w)return w.call(k)==w.call(N)}return!1}return Ep=S,Ep}var Tp,ow;function t8(){if(ow)return Tp;ow=1;var e=DE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(s,o,l,c,d,u){var f=l&t,p=e(s),h=p.length,x=e(o),v=x.length;if(h!=v&&!f)return!1;for(var _=h;_--;){var g=p[_];if(!(f?g in o:n.call(o,g)))return!1}var y=u.get(s),b=u.get(o);if(y&&b)return y==o&&b==s;var w=!0;u.set(s,o),u.set(o,s);for(var S=f;++_<h;){g=p[_];var k=s[g],N=o[g];if(c)var E=f?c(N,k,g,o,s,u):c(k,N,g,s,o,u);if(!(E===void 0?k===N||d(k,N,l,c,u):E)){w=!1;break}S||(S=g=="constructor")}if(w&&!S){var j=s.constructor,R=o.constructor;j!=R&&"constructor"in s&&"constructor"in o&&!(typeof j=="function"&&j instanceof j&&typeof R=="function"&&R instanceof R)&&(w=!1)}return u.delete(s),u.delete(o),w}return Tp=i,Tp}var Rp,aw;function r8(){if(aw)return Rp;aw=1;var e=nu(),t=KE(),r=e8(),n=t8(),i=Os(),s=ot(),o=Ps(),l=Sa(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function x(v,_,g,y,b,w){var S=s(v),k=s(_),N=S?u:i(v),E=k?u:i(_);N=N==d?f:N,E=E==d?f:E;var j=N==f,R=E==f,T=N==E;if(T&&o(v)){if(!o(_))return!1;S=!0,j=!1}if(T&&!j)return w||(w=new e),S||l(v)?t(v,_,g,y,b,w):r(v,_,N,g,y,b,w);if(!(g&c)){var D=j&&h.call(v,"__wrapped__"),q=R&&h.call(_,"__wrapped__");if(D||q){var C=D?v.value():v,O=q?_.value():_;return w||(w=new e),b(C,O,g,y,w)}}return T?(w||(w=new e),n(v,_,g,y,b,w)):!1}return Rp=x,Rp}var Ap,lw;function YE(){if(lw)return Ap;lw=1;var e=r8(),t=Kr();function r(n,i,s,o,l){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,s,o,r,l)}return Ap=r,Ap}var Ip,cw;function n8(){if(cw)return Ip;cw=1;var e=nu(),t=YE(),r=1,n=2;function i(s,o,l,c){var d=l.length,u=d,f=!c;if(s==null)return!u;for(s=Object(s);d--;){var p=l[d];if(f&&p[2]?p[1]!==s[p[0]]:!(p[0]in s))return!1}for(;++d<u;){p=l[d];var h=p[0],x=s[h],v=p[1];if(f&&p[2]){if(x===void 0&&!(h in s))return!1}else{var _=new e;if(c)var g=c(x,v,h,s,o,_);if(!(g===void 0?t(v,x,r|n,c,_):g))return!1}}return!0}return Ip=i,Ip}var Mp,uw;function XE(){if(uw)return Mp;uw=1;var e=xr();function t(r){return r===r&&!e(r)}return Mp=t,Mp}var Pp,dw;function i8(){if(dw)return Pp;dw=1;var e=XE(),t=ei();function r(n){for(var i=t(n),s=i.length;s--;){var o=i[s],l=n[o];i[s]=[o,l,e(l)]}return i}return Pp=r,Pp}var Op,fw;function QE(){if(fw)return Op;fw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Op=e,Op}var Dp,pw;function s8(){if(pw)return Dp;pw=1;var e=n8(),t=i8(),r=QE();function n(i){var s=t(i);return s.length==1&&s[0][2]?r(s[0][0],s[0][1]):function(o){return o===i||e(o,i,s)}}return Dp=n,Dp}var Lp,hw;function Ds(){if(hw)return Lp;hw=1;var e=Ti(),t=Kr(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Lp=n,Lp}var Fp,mw;function vy(){if(mw)return Fp;mw=1;var e=ot(),t=Ds(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){if(e(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return Fp=i,Fp}var zp,vw;function o8(){if(vw)return zp;vw=1;var e=iy(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var s=function(){var o=arguments,l=i?i.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var d=n.apply(this,o);return s.cache=c.set(l,d)||c,d};return s.cache=new(r.Cache||e),s}return r.Cache=e,zp=r,zp}var qp,gw;function a8(){if(gw)return qp;gw=1;var e=o8(),t=500;function r(n){var i=e(n,function(o){return s.size===t&&s.clear(),o}),s=i.cache;return i}return qp=r,qp}var $p,xw;function l8(){if(xw)return $p;xw=1;var e=a8(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(t,function(o,l,c,d){s.push(c?d.replace(r,"$1"):l||o)}),s});return $p=n,$p}var Bp,yw;function du(){if(yw)return Bp;yw=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,s=Array(i);++n<i;)s[n]=r(t[n],n,t);return s}return Bp=e,Bp}var Hp,bw;function c8(){if(bw)return Hp;bw=1;var e=Ms(),t=du(),r=ot(),n=Ds(),i=e?e.prototype:void 0,s=i?i.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return t(l,o)+"";if(n(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Hp=o,Hp}var Wp,_w;function ZE(){if(_w)return Wp;_w=1;var e=c8();function t(r){return r==null?"":e(r)}return Wp=t,Wp}var Up,ww;function fu(){if(ww)return Up;ww=1;var e=ot(),t=vy(),r=l8(),n=ZE();function i(s,o){return e(s)?s:t(s,o)?[s]:r(n(s))}return Up=i,Up}var Vp,jw;function ka(){if(jw)return Vp;jw=1;var e=Ds();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Vp=t,Vp}var Gp,Sw;function pu(){if(Sw)return Gp;Sw=1;var e=fu(),t=ka();function r(n,i){i=e(i,n);for(var s=0,o=i.length;n!=null&&s<o;)n=n[t(i[s++])];return s&&s==o?n:void 0}return Gp=r,Gp}var Kp,kw;function u8(){if(kw)return Kp;kw=1;var e=pu();function t(r,n,i){var s=r==null?void 0:e(r,n);return s===void 0?i:s}return Kp=t,Kp}var Yp,Nw;function d8(){if(Nw)return Yp;Nw=1;function e(t,r){return t!=null&&r in Object(t)}return Yp=e,Yp}var Xp,Cw;function JE(){if(Cw)return Xp;Cw=1;var e=fu(),t=ja(),r=ot(),n=ou(),i=oy(),s=ka();function o(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=s(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&i(f)&&n(h,f)&&(r(l)||t(l)))}return Xp=o,Xp}var Qp,Ew;function eT(){if(Ew)return Qp;Ew=1;var e=d8(),t=JE();function r(n,i){return n!=null&&t(n,i,e)}return Qp=r,Qp}var Zp,Tw;function f8(){if(Tw)return Zp;Tw=1;var e=YE(),t=u8(),r=eT(),n=vy(),i=XE(),s=QE(),o=ka(),l=1,c=2;function d(u,f){return n(u)&&i(f)?s(o(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?r(p,u):e(f,h,l|c)}}return Zp=d,Zp}var Jp,Rw;function tT(){if(Rw)return Jp;Rw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return Jp=e,Jp}var eh,Aw;function p8(){if(Aw)return eh;Aw=1;var e=pu();function t(r){return function(n){return e(n,r)}}return eh=t,eh}var th,Iw;function h8(){if(Iw)return th;Iw=1;var e=tT(),t=p8(),r=vy(),n=ka();function i(s){return r(s)?e(n(s)):t(s)}return th=i,th}var rh,Mw;function yn(){if(Mw)return rh;Mw=1;var e=s8(),t=f8(),r=Ii(),n=ot(),i=h8();function s(o){return typeof o=="function"?o:o==null?r:typeof o=="object"?n(o)?t(o[0],o[1]):e(o):i(o)}return rh=s,rh}var nh,Pw;function rT(){if(Pw)return nh;Pw=1;var e=IE(),t=YL(),r=yn(),n=ot();function i(s,o){var l=n(s)?e:t;return l(s,r(o,3))}return nh=i,nh}var ih,Ow;function m8(){if(Ow)return ih;Ow=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return ih=r,ih}var sh,Dw;function nT(){if(Dw)return sh;Dw=1;var e=m8(),t=JE();function r(n,i){return n!=null&&t(n,i,e)}return sh=r,sh}var oh,Lw;function v8(){if(Lw)return oh;Lw=1;var e=ly(),t=Os(),r=ja(),n=ot(),i=xn(),s=Ps(),o=lu(),l=Sa(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(i(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||s(h)||l(h)||r(h)))return!h.length;var x=t(h);if(x==c||x==d)return!h.size;if(o(h))return!e(h).length;for(var v in h)if(f.call(h,v))return!1;return!0}return oh=p,oh}var ah,Fw;function iT(){if(Fw)return ah;Fw=1;function e(t){return t===void 0}return ah=e,ah}var lh,zw;function sT(){if(zw)return lh;zw=1;var e=uu(),t=xn();function r(n,i){var s=-1,o=t(n)?Array(n.length):[];return e(n,function(l,c,d){o[++s]=i(l,c,d)}),o}return lh=r,lh}var ch,qw;function oT(){if(qw)return ch;qw=1;var e=du(),t=yn(),r=sT(),n=ot();function i(s,o){var l=n(s)?e:r;return l(s,t(o,3))}return ch=i,ch}var uh,$w;function g8(){if($w)return uh;$w=1;function e(t,r,n,i){var s=-1,o=t==null?0:t.length;for(i&&o&&(n=t[++s]);++s<o;)n=r(n,t[s],s,t);return n}return uh=e,uh}var dh,Bw;function x8(){if(Bw)return dh;Bw=1;function e(t,r,n,i,s){return s(t,function(o,l,c){n=i?(i=!1,o):r(n,o,l,c)}),n}return dh=e,dh}var fh,Hw;function aT(){if(Hw)return fh;Hw=1;var e=g8(),t=uu(),r=yn(),n=x8(),i=ot();function s(o,l,c){var d=i(o)?e:n,u=arguments.length<3;return d(o,r(l,4),c,u,t)}return fh=s,fh}var ph,Ww;function y8(){if(Ww)return ph;Ww=1;var e=Ti(),t=ot(),r=Kr(),n="[object String]";function i(s){return typeof s=="string"||!t(s)&&r(s)&&e(s)==n}return ph=i,ph}var hh,Uw;function b8(){if(Uw)return hh;Uw=1;var e=tT(),t=e("length");return hh=t,hh}var mh,Vw;function _8(){if(Vw)return mh;Vw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="\\u200d",l=RegExp("["+o+e+i+s+"]");function c(d){return l.test(d)}return mh=c,mh}var vh,Gw;function w8(){if(Gw)return vh;Gw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,s="\\ufe0e\\ufe0f",o="["+e+"]",l="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",x=d+"?",v="["+s+"]?",_="(?:"+h+"(?:"+[u,f,p].join("|")+")"+v+x+")*",g=v+x+_,y="(?:"+[u+l+"?",l,f,p,o].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+g,"g");function w(S){for(var k=b.lastIndex=0;b.test(S);)++k;return k}return vh=w,vh}var gh,Kw;function j8(){if(Kw)return gh;Kw=1;var e=b8(),t=_8(),r=w8();function n(i){return t(i)?r(i):e(i)}return gh=n,gh}var xh,Yw;function S8(){if(Yw)return xh;Yw=1;var e=ly(),t=Os(),r=xn(),n=y8(),i=j8(),s="[object Map]",o="[object Set]";function l(c){if(c==null)return 0;if(r(c))return n(c)?i(c):c.length;var d=t(c);return d==s||d==o?c.size:e(c).length}return xh=l,xh}var yh,Xw;function k8(){if(Xw)return yh;Xw=1;var e=sy(),t=qE(),r=hy(),n=yn(),i=cu(),s=ot(),o=Ps(),l=_a(),c=xr(),d=Sa();function u(f,p,h){var x=s(f),v=x||o(f)||d(f);if(p=n(p,4),h==null){var _=f&&f.constructor;v?h=x?new _:[]:c(f)?h=l(_)?t(i(f)):{}:h={}}return(v?e:r)(f,function(g,y,b){return p(h,g,y,b)}),h}return yh=u,yh}var bh,Qw;function N8(){if(Qw)return bh;Qw=1;var e=Ms(),t=ja(),r=ot(),n=e?e.isConcatSpreadable:void 0;function i(s){return r(s)||t(s)||!!(n&&s&&s[n])}return bh=i,bh}var _h,Zw;function gy(){if(Zw)return _h;Zw=1;var e=uy(),t=N8();function r(n,i,s,o,l){var c=-1,d=n.length;for(s||(s=t),l||(l=[]);++c<d;){var u=n[c];i>0&&s(u)?i>1?r(u,i-1,s,o,l):e(l,u):o||(l[l.length]=u)}return l}return _h=r,_h}var wh,Jw;function C8(){if(Jw)return wh;Jw=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return wh=e,wh}var jh,e2;function lT(){if(e2)return jh;e2=1;var e=C8(),t=Math.max;function r(n,i,s){return i=t(i===void 0?n.length-1:i,0),function(){for(var o=arguments,l=-1,c=t(o.length-i,0),d=Array(c);++l<c;)d[l]=o[i+l];l=-1;for(var u=Array(i+1);++l<i;)u[l]=o[l];return u[i]=s(d),e(n,this,u)}}return jh=r,jh}var Sh,t2;function E8(){if(t2)return Sh;t2=1;var e=fy(),t=CE(),r=Ii(),n=t?function(i,s){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(s),writable:!0})}:r;return Sh=n,Sh}var kh,r2;function T8(){if(r2)return kh;r2=1;var e=800,t=16,r=Date.now;function n(i){var s=0,o=0;return function(){var l=r(),c=t-(l-o);if(o=l,c>0){if(++s>=e)return arguments[0]}else s=0;return i.apply(void 0,arguments)}}return kh=n,kh}var Nh,n2;function cT(){if(n2)return Nh;n2=1;var e=E8(),t=T8(),r=t(e);return Nh=r,Nh}var Ch,i2;function hu(){if(i2)return Ch;i2=1;var e=Ii(),t=lT(),r=cT();function n(i,s){return r(t(i,s,e),i+"")}return Ch=n,Ch}var Eh,s2;function uT(){if(s2)return Eh;s2=1;function e(t,r,n,i){for(var s=t.length,o=n+(i?1:-1);i?o--:++o<s;)if(r(t[o],o,t))return o;return-1}return Eh=e,Eh}var Th,o2;function R8(){if(o2)return Th;o2=1;function e(t){return t!==t}return Th=e,Th}var Rh,a2;function A8(){if(a2)return Rh;a2=1;function e(t,r,n){for(var i=n-1,s=t.length;++i<s;)if(t[i]===r)return i;return-1}return Rh=e,Rh}var Ah,l2;function I8(){if(l2)return Ah;l2=1;var e=uT(),t=R8(),r=A8();function n(i,s,o){return s===s?r(i,s,o):e(i,t,o)}return Ah=n,Ah}var Ih,c2;function M8(){if(c2)return Ih;c2=1;var e=I8();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return Ih=t,Ih}var Mh,u2;function P8(){if(u2)return Mh;u2=1;function e(t,r,n){for(var i=-1,s=t==null?0:t.length;++i<s;)if(n(r,t[i]))return!0;return!1}return Mh=e,Mh}var Ph,d2;function O8(){if(d2)return Ph;d2=1;function e(){}return Ph=e,Ph}var Oh,f2;function D8(){if(f2)return Oh;f2=1;var e=LE(),t=O8(),r=my(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(s){return new e(s)}:t;return Oh=i,Oh}var Dh,p2;function L8(){if(p2)return Dh;p2=1;var e=VE(),t=M8(),r=P8(),n=GE(),i=D8(),s=my(),o=200;function l(c,d,u){var f=-1,p=t,h=c.length,x=!0,v=[],_=v;if(u)x=!1,p=r;else if(h>=o){var g=d?null:i(c);if(g)return s(g);x=!1,p=n,_=new e}else _=d?[]:v;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,x&&b===b){for(var w=_.length;w--;)if(_[w]===b)continue e;d&&_.push(b),v.push(y)}else p(_,b,u)||(_!==v&&_.push(b),v.push(y))}return v}return Dh=l,Dh}var Lh,h2;function dT(){if(h2)return Lh;h2=1;var e=xn(),t=Kr();function r(n){return t(n)&&e(n)}return Lh=r,Lh}var Fh,m2;function F8(){if(m2)return Fh;m2=1;var e=gy(),t=hu(),r=L8(),n=dT(),i=t(function(s){return r(e(s,1,n,!0))});return Fh=i,Fh}var zh,v2;function z8(){if(v2)return zh;v2=1;var e=du();function t(r,n){return e(n,function(i){return r[i]})}return zh=t,zh}var qh,g2;function fT(){if(g2)return qh;g2=1;var e=z8(),t=ei();function r(n){return n==null?[]:e(n,t(n))}return qh=r,qh}var $h,x2;function yr(){if(x2)return $h;x2=1;var e;if(typeof ry=="function")try{e={clone:VL(),constant:fy(),each:UE(),filter:rT(),has:nT(),isArray:ot(),isEmpty:v8(),isFunction:_a(),isUndefined:iT(),keys:ei(),map:oT(),reduce:aT(),size:S8(),transform:k8(),union:F8(),values:fT()}}catch{}return e||(e=window._),$h=e,$h}var Bh,y2;function xy(){if(y2)return Bh;y2=1;var e=yr();Bh=i;var t="\0",r="\0",n="";function i(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},i.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},i.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(x){p.length>1?h.setNode(x,f):h.setNode(x)}),this},i.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=r,this._children[u]={},this._children[r][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return e.has(this._nodes,u)},i.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==r)return f}},i.prototype.children=function(u){if(e.isUndefined(u)&&(u=r),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===r)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},i.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},i.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},i.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},i.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(v,_){u(_)&&f.setNode(_,v)}),e.each(this._edgeObjs,function(v){f.hasNode(v.v)&&f.hasNode(v.w)&&f.setEdge(v,p.edge(v))});var h={};function x(v){var _=p.parent(v);return _===void 0||f.hasNode(_)?(h[v]=_,_):_ in h?h[_]:x(_)}return this._isCompound&&e.each(f.nodes(),function(v){f.setParent(v,x(v))}),f},i.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(x,v){return h.length>1?p.setEdge(x,v,f):p.setEdge(x,v),v}),this},i.prototype.setEdge=function(){var u,f,p,h,x=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(u=v.v,f=v.w,p=v.name,arguments.length===2&&(h=arguments[1],x=!0)):(u=v,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],x=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var _=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,_))return x&&(this._edgeLabels[_]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[_]=x?h:this._defaultEdgeLabelFn(u,f,p);var g=c(this._isDirected,u,f,p);return u=g.v,f=g.w,Object.freeze(g),this._edgeObjs[_]=g,s(this._preds[f],u),s(this._sucs[u],f),this._in[f][_]=g,this._out[u][_]=g,this._edgeCount++,this},i.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},i.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),x=this._edgeObjs[h];return x&&(u=x.v,f=x.w,delete this._edgeLabels[h],delete this._edgeObjs[h],o(this._preds[f],u),o(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},i.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.v===f}):h}},i.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(x){return x.w===f}):h}},i.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function s(u,f){u[f]?u[f]++:u[f]=1}function o(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var x=""+f,v=""+p;if(!u&&x>v){var _=x;x=v,v=_}return x+n+v+n+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var x=""+f,v=""+p;if(!u&&x>v){var _=x;x=v,v=_}var g={v:x,w:v};return h&&(g.name=h),g}function d(u,f){return l(u,f.v,f.w,f.name)}return Bh}var Hh,b2;function q8(){return b2||(b2=1,Hh="2.1.8"),Hh}var Wh,_2;function $8(){return _2||(_2=1,Wh={Graph:xy(),version:q8()}),Wh}var Uh,w2;function B8(){if(w2)return Uh;w2=1;var e=yr(),t=xy();Uh={write:r,read:s};function r(o){var l={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:n(o),edges:i(o)};return e.isUndefined(o.graph())||(l.value=e.clone(o.graph())),l}function n(o){return e.map(o.nodes(),function(l){var c=o.node(l),d=o.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function i(o){return e.map(o.edges(),function(l){var c=o.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function s(o){var l=new t(o.options).setGraph(o.value);return e.each(o.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(o.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Uh}var Vh,j2;function H8(){if(j2)return Vh;j2=1;var e=yr();Vh=t;function t(r){var n={},i=[],s;function o(l){e.has(n,l)||(n[l]=!0,s.push(l),e.each(r.successors(l),o),e.each(r.predecessors(l),o))}return e.each(r.nodes(),function(l){s=[],o(l),s.length&&i.push(s)}),i}return Vh}var Gh,S2;function pT(){if(S2)return Gh;S2=1;var e=yr();Gh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var s=this._arr,o=s.length;return i[r]=o,s.push({key:r,priority:n}),this._decrease(o),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,s=i+1,o=r;i<n.length&&(o=n[i].priority<n[o].priority?i:o,s<n.length&&(o=n[s].priority<n[o].priority?s:o),o!==r&&(this._swap(r,o),this._heapify(o)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,s;r!==0&&(s=r>>1,!(n[s].priority<i));)this._swap(r,s),r=s},t.prototype._swap=function(r,n){var i=this._arr,s=this._keyIndices,o=i[r],l=i[n];i[r]=l,i[n]=o,s[l.key]=r,s[o.key]=n},Gh}var Kh,k2;function hT(){if(k2)return Kh;k2=1;var e=yr(),t=pT();Kh=n;var r=e.constant(1);function n(s,o,l,c){return i(s,String(o),l||r,c||function(d){return s.outEdges(d)})}function i(s,o,l,c){var d={},u=new t,f,p,h=function(x){var v=x.v!==f?x.v:x.w,_=d[v],g=l(x),y=p.distance+g;if(g<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+x+" Weight: "+g);y<_.distance&&(_.distance=y,_.predecessor=f,u.decrease(v,y))};for(s.nodes().forEach(function(x){var v=x===o?0:Number.POSITIVE_INFINITY;d[x]={distance:v},u.add(x,v)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return Kh}var Yh,N2;function W8(){if(N2)return Yh;N2=1;var e=hT(),t=yr();Yh=r;function r(n,i,s){return t.transform(n.nodes(),function(o,l){o[l]=e(n,l,i,s)},{})}return Yh}var Xh,C2;function mT(){if(C2)return Xh;C2=1;var e=yr();Xh=t;function t(r){var n=0,i=[],s={},o=[];function l(c){var d=s[c]={onStack:!0,lowlink:n,index:n++};if(i.push(c),r.successors(c).forEach(function(p){e.has(s,p)?s[p].onStack&&(d.lowlink=Math.min(d.lowlink,s[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,s[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=i.pop(),s[f].onStack=!1,u.push(f);while(c!==f);o.push(u)}}return r.nodes().forEach(function(c){e.has(s,c)||l(c)}),o}return Xh}var Qh,E2;function U8(){if(E2)return Qh;E2=1;var e=yr(),t=mT();Qh=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Qh}var Zh,T2;function V8(){if(T2)return Zh;T2=1;var e=yr();Zh=r;var t=e.constant(1);function r(i,s,o){return n(i,s||t,o||function(l){return i.outEdges(l)})}function n(i,s,o){var l={},c=i.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),o(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=s(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var x=p[d],v=u[h],_=p[h],g=x.distance+v.distance;g<_.distance&&(_.distance=g,_.predecessor=v.predecessor)})})}),l}return Zh}var Jh,R2;function vT(){if(R2)return Jh;R2=1;var e=yr();Jh=t,t.CycleException=r;function t(n){var i={},s={},o=[];function l(c){if(e.has(s,c))throw new r;e.has(i,c)||(s[c]=!0,i[c]=!0,e.each(n.predecessors(c),l),delete s[c],o.push(c))}if(e.each(n.sinks(),l),e.size(i)!==n.nodeCount())throw new r;return o}function r(){}return r.prototype=new Error,Jh}var em,A2;function G8(){if(A2)return em;A2=1;var e=vT();em=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return em}var tm,I2;function gT(){if(I2)return tm;I2=1;var e=yr();tm=t;function t(n,i,s){e.isArray(i)||(i=[i]);var o=(n.isDirected()?n.successors:n.neighbors).bind(n),l=[],c={};return e.each(i,function(d){if(!n.hasNode(d))throw new Error("Graph does not have node: "+d);r(n,d,s==="post",c,o,l)}),l}function r(n,i,s,o,l,c){e.has(o,i)||(o[i]=!0,s||c.push(i),e.each(l(i),function(d){r(n,d,s,o,l,c)}),s&&c.push(i))}return tm}var rm,M2;function K8(){if(M2)return rm;M2=1;var e=gT();rm=t;function t(r,n){return e(r,n,"post")}return rm}var nm,P2;function Y8(){if(P2)return nm;P2=1;var e=gT();nm=t;function t(r,n){return e(r,n,"pre")}return nm}var im,O2;function X8(){if(O2)return im;O2=1;var e=yr(),t=xy(),r=pT();im=n;function n(i,s){var o=new t,l={},c=new r,d;function u(p){var h=p.v===d?p.w:p.v,x=c.priority(h);if(x!==void 0){var v=s(p);v<x&&(l[h]=d,c.decrease(h,v))}}if(i.nodeCount()===0)return o;e.each(i.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),o.setNode(p)}),c.decrease(i.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))o.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+i);f=!0}i.nodeEdges(d).forEach(u)}return o}return im}var sm,D2;function Q8(){return D2||(D2=1,sm={components:H8(),dijkstra:hT(),dijkstraAll:W8(),findCycles:U8(),floydWarshall:V8(),isAcyclic:G8(),postorder:K8(),preorder:Y8(),prim:X8(),tarjan:mT(),topsort:vT()}),sm}var om,L2;function Z8(){if(L2)return om;L2=1;var e=$8();return om={Graph:e.Graph,json:B8(),alg:Q8(),version:e.version},om}var dc;if(typeof ry=="function")try{dc=Z8()}catch{}dc||(dc=window.graphlib);var Pr=dc,am,F2;function J8(){if(F2)return am;F2=1;var e=BE(),t=1,r=4;function n(i){return e(i,t|r)}return am=n,am}var lm,z2;function mu(){if(z2)return lm;z2=1;var e=Is(),t=xn(),r=ou(),n=xr();function i(s,o,l){if(!n(l))return!1;var c=typeof o;return(c=="number"?t(l)&&r(o,l.length):c=="string"&&o in l)?e(l[o],s):!1}return lm=i,lm}var cm,q2;function eF(){if(q2)return cm;q2=1;var e=hu(),t=Is(),r=mu(),n=Ai(),i=Object.prototype,s=i.hasOwnProperty,o=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=n(p),x=-1,v=h.length;++x<v;){var _=h[x],g=l[_];(g===void 0||t(g,i[_])&&!s.call(l,_))&&(l[_]=p[_])}return l});return cm=o,cm}var um,$2;function tF(){if($2)return um;$2=1;var e=yn(),t=xn(),r=ei();function n(i){return function(s,o,l){var c=Object(s);if(!t(s)){var d=e(o,3);s=r(s),o=function(f){return d(c[f],f,c)}}var u=i(s,o,l);return u>-1?c[d?s[u]:u]:void 0}}return um=n,um}var dm,B2;function rF(){if(B2)return dm;B2=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return dm=t,dm}var fm,H2;function nF(){if(H2)return fm;H2=1;var e=rF(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return fm=r,fm}var pm,W2;function iF(){if(W2)return pm;W2=1;var e=nF(),t=xr(),r=Ds(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return n;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=s.test(d);return f||o.test(d)?l(d.slice(2),f?2:8):i.test(d)?n:+d}return pm=c,pm}var hm,U2;function xT(){if(U2)return hm;U2=1;var e=iF(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var s=i<0?-1:1;return s*r}return i===i?i:0}return hm=n,hm}var mm,V2;function sF(){if(V2)return mm;V2=1;var e=xT();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return mm=t,mm}var vm,G2;function oF(){if(G2)return vm;G2=1;var e=uT(),t=yn(),r=sF(),n=Math.max;function i(s,o,l){var c=s==null?0:s.length;if(!c)return-1;var d=l==null?0:r(l);return d<0&&(d=n(c+d,0)),e(s,t(o,3),d)}return vm=i,vm}var gm,K2;function aF(){if(K2)return gm;K2=1;var e=tF(),t=oF(),r=e(t);return gm=r,gm}var xm,Y2;function yT(){if(Y2)return xm;Y2=1;var e=gy();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return xm=t,xm}var ym,X2;function lF(){if(X2)return ym;X2=1;var e=py(),t=HE(),r=Ai();function n(i,s){return i==null?i:e(i,t(s),r)}return ym=n,ym}var bm,Q2;function cF(){if(Q2)return bm;Q2=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return bm=e,bm}var _m,Z2;function uF(){if(Z2)return _m;Z2=1;var e=iu(),t=hy(),r=yn();function n(i,s){var o={};return s=r(s,3),t(i,function(l,c,d){e(o,c,s(l,c,d))}),o}return _m=n,_m}var wm,J2;function yy(){if(J2)return wm;J2=1;var e=Ds();function t(r,n,i){for(var s=-1,o=r.length;++s<o;){var l=r[s],c=n(l);if(c!=null&&(d===void 0?c===c&&!e(c):i(c,d)))var d=c,u=l}return u}return wm=t,wm}var jm,ej;function dF(){if(ej)return jm;ej=1;function e(t,r){return t>r}return jm=e,jm}var Sm,tj;function fF(){if(tj)return Sm;tj=1;var e=yy(),t=dF(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return Sm=n,Sm}var km,rj;function bT(){if(rj)return km;rj=1;var e=iu(),t=Is();function r(n,i,s){(s!==void 0&&!t(n[i],s)||s===void 0&&!(i in n))&&e(n,i,s)}return km=r,km}var Nm,nj;function pF(){if(nj)return Nm;nj=1;var e=Ti(),t=cu(),r=Kr(),n="[object Object]",i=Function.prototype,s=Object.prototype,o=i.toString,l=s.hasOwnProperty,c=o.call(Object);function d(u){if(!r(u)||e(u)!=n)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&o.call(p)==c}return Nm=d,Nm}var Cm,ij;function _T(){if(ij)return Cm;ij=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Cm=e,Cm}var Em,sj;function hF(){if(sj)return Em;sj=1;var e=wa(),t=Ai();function r(n){return e(n,t(n))}return Em=r,Em}var Tm,oj;function mF(){if(oj)return Tm;oj=1;var e=bT(),t=RE(),r=zE(),n=AE(),i=$E(),s=ja(),o=ot(),l=dT(),c=Ps(),d=_a(),u=xr(),f=pF(),p=Sa(),h=_T(),x=hF();function v(_,g,y,b,w,S,k){var N=h(_,y),E=h(g,y),j=k.get(E);if(j){e(_,y,j);return}var R=S?S(N,E,y+"",_,g,k):void 0,T=R===void 0;if(T){var D=o(E),q=!D&&c(E),C=!D&&!q&&p(E);R=E,D||q||C?o(N)?R=N:l(N)?R=n(N):q?(T=!1,R=t(E,!0)):C?(T=!1,R=r(E,!0)):R=[]:f(E)||s(E)?(R=N,s(N)?R=x(N):(!u(N)||d(N))&&(R=i(E))):T=!1}T&&(k.set(E,R),w(R,E,b,S,k),k.delete(E)),e(_,y,R)}return Tm=v,Tm}var Rm,aj;function vF(){if(aj)return Rm;aj=1;var e=nu(),t=bT(),r=py(),n=mF(),i=xr(),s=Ai(),o=_T();function l(c,d,u,f,p){c!==d&&r(d,function(h,x){if(p||(p=new e),i(h))n(c,d,x,u,l,f,p);else{var v=f?f(o(c,x),h,x+"",c,d,p):void 0;v===void 0&&(v=h),t(c,x,v)}},s)}return Rm=l,Rm}var Am,lj;function gF(){if(lj)return Am;lj=1;var e=hu(),t=mu();function r(n){return e(function(i,s){var o=-1,l=s.length,c=l>1?s[l-1]:void 0,d=l>2?s[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(s[0],s[1],d)&&(c=l<3?void 0:c,l=1),i=Object(i);++o<l;){var u=s[o];u&&n(i,u,o,c)}return i})}return Am=r,Am}var Im,cj;function xF(){if(cj)return Im;cj=1;var e=vF(),t=gF(),r=t(function(n,i,s){e(n,i,s)});return Im=r,Im}var Mm,uj;function wT(){if(uj)return Mm;uj=1;function e(t,r){return t<r}return Mm=e,Mm}var Pm,dj;function yF(){if(dj)return Pm;dj=1;var e=yy(),t=wT(),r=Ii();function n(i){return i&&i.length?e(i,r,t):void 0}return Pm=n,Pm}var Om,fj;function bF(){if(fj)return Om;fj=1;var e=yy(),t=yn(),r=wT();function n(i,s){return i&&i.length?e(i,t(s,2),r):void 0}return Om=n,Om}var Dm,pj;function _F(){if(pj)return Dm;pj=1;var e=Mr(),t=function(){return e.Date.now()};return Dm=t,Dm}var Lm,hj;function wF(){if(hj)return Lm;hj=1;var e=su(),t=fu(),r=ou(),n=xr(),i=ka();function s(o,l,c,d){if(!n(o))return o;l=t(l,o);for(var u=-1,f=l.length,p=f-1,h=o;h!=null&&++u<f;){var x=i(l[u]),v=c;if(x==="__proto__"||x==="constructor"||x==="prototype")return o;if(u!=p){var _=h[x];v=d?d(_,x,h):void 0,v===void 0&&(v=n(_)?_:r(l[u+1])?[]:{})}e(h,x,v),h=h[x]}return o}return Lm=s,Lm}var Fm,mj;function jF(){if(mj)return Fm;mj=1;var e=pu(),t=wF(),r=fu();function n(i,s,o){for(var l=-1,c=s.length,d={};++l<c;){var u=s[l],f=e(i,u);o(f,u)&&t(d,r(u,i),f)}return d}return Fm=n,Fm}var zm,vj;function SF(){if(vj)return zm;vj=1;var e=jF(),t=eT();function r(n,i){return e(n,i,function(s,o){return t(n,o)})}return zm=r,zm}var qm,gj;function kF(){if(gj)return qm;gj=1;var e=yT(),t=lT(),r=cT();function n(i){return r(t(i,void 0,e),i+"")}return qm=n,qm}var $m,xj;function NF(){if(xj)return $m;xj=1;var e=SF(),t=kF(),r=t(function(n,i){return n==null?{}:e(n,i)});return $m=r,$m}var Bm,yj;function CF(){if(yj)return Bm;yj=1;var e=Math.ceil,t=Math.max;function r(n,i,s,o){for(var l=-1,c=t(e((i-n)/(s||1)),0),d=Array(c);c--;)d[o?c:++l]=n,n+=s;return d}return Bm=r,Bm}var Hm,bj;function EF(){if(bj)return Hm;bj=1;var e=CF(),t=mu(),r=xT();function n(i){return function(s,o,l){return l&&typeof l!="number"&&t(s,o,l)&&(o=l=void 0),s=r(s),o===void 0?(o=s,s=0):o=r(o),l=l===void 0?s<o?1:-1:r(l),e(s,o,l,i)}}return Hm=n,Hm}var Wm,_j;function TF(){if(_j)return Wm;_j=1;var e=EF(),t=e();return Wm=t,Wm}var Um,wj;function RF(){if(wj)return Um;wj=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Um=e,Um}var Vm,jj;function AF(){if(jj)return Vm;jj=1;var e=Ds();function t(r,n){if(r!==n){var i=r!==void 0,s=r===null,o=r===r,l=e(r),c=n!==void 0,d=n===null,u=n===n,f=e(n);if(!d&&!f&&!l&&r>n||l&&c&&u&&!d&&!f||s&&c&&u||!i&&u||!o)return 1;if(!s&&!l&&!f&&r<n||f&&i&&o&&!s&&!l||d&&i&&o||!c&&o||!u)return-1}return 0}return Vm=t,Vm}var Gm,Sj;function IF(){if(Sj)return Gm;Sj=1;var e=AF();function t(r,n,i){for(var s=-1,o=r.criteria,l=n.criteria,c=o.length,d=i.length;++s<c;){var u=e(o[s],l[s]);if(u){if(s>=d)return u;var f=i[s];return u*(f=="desc"?-1:1)}}return r.index-n.index}return Gm=t,Gm}var Km,kj;function MF(){if(kj)return Km;kj=1;var e=du(),t=pu(),r=yn(),n=sT(),i=RF(),s=au(),o=IF(),l=Ii(),c=ot();function d(u,f,p){f.length?f=e(f,function(v){return c(v)?function(_){return t(_,v.length===1?v[0]:v)}:v}):f=[l];var h=-1;f=e(f,s(r));var x=n(u,function(v,_,g){var y=e(f,function(b){return b(v)});return{criteria:y,index:++h,value:v}});return i(x,function(v,_){return o(v,_,p)})}return Km=d,Km}var Ym,Nj;function PF(){if(Nj)return Ym;Nj=1;var e=gy(),t=MF(),r=hu(),n=mu(),i=r(function(s,o){if(s==null)return[];var l=o.length;return l>1&&n(s,o[0],o[1])?o=[]:l>2&&n(o[0],o[1],o[2])&&(o=[o[0]]),t(s,e(o,1),[])});return Ym=i,Ym}var Xm,Cj;function OF(){if(Cj)return Xm;Cj=1;var e=ZE(),t=0;function r(n){var i=++t;return e(n)+i}return Xm=r,Xm}var Qm,Ej;function DF(){if(Ej)return Qm;Ej=1;function e(t,r,n){for(var i=-1,s=t.length,o=r.length,l={};++i<s;){var c=i<o?r[i]:void 0;n(l,t[i],c)}return l}return Qm=e,Qm}var Zm,Tj;function LF(){if(Tj)return Zm;Tj=1;var e=su(),t=DF();function r(n,i){return t(n||[],i||[],e)}return Zm=r,Zm}var fc;if(typeof ry=="function")try{fc={cloneDeep:J8(),constant:fy(),defaults:eF(),each:UE(),filter:rT(),find:aF(),flatten:yT(),forEach:WE(),forIn:lF(),has:nT(),isUndefined:iT(),last:cF(),map:oT(),mapValues:uF(),max:fF(),merge:xF(),min:yF(),minBy:bF(),now:_F(),pick:NF(),range:TF(),reduce:aT(),sortBy:PF(),uniqueId:OF(),values:fT(),zipObject:LF()}}catch{}fc||(fc=window._);var Qe=fc,FF=vu;function vu(){var e={};e._next=e._prev=e,this._sentinel=e}vu.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return jT(t),t};vu.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&jT(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};vu.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,zF)),r=r._prev;return"["+e.join(", ")+"]"};function jT(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function zF(e,t){if(e!=="_next"&&e!=="_prev")return t}var sn=Qe,qF=Pr.Graph,$F=FF,BF=WF,HF=sn.constant(1);function WF(e,t){if(e.nodeCount()<=1)return[];var r=VF(e,t||HF),n=UF(r.graph,r.buckets,r.zeroIdx);return sn.flatten(sn.map(n,function(i){return e.outEdges(i.v,i.w)}),!0)}function UF(e,t,r){for(var n=[],i=t[t.length-1],s=t[0],o;e.nodeCount();){for(;o=s.dequeue();)Jm(e,t,r,o);for(;o=i.dequeue();)Jm(e,t,r,o);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(o=t[l].dequeue(),o){n=n.concat(Jm(e,t,r,o,!0));break}}}return n}function Jm(e,t,r,n,i){var s=i?[]:void 0;return sn.forEach(e.inEdges(n.v),function(o){var l=e.edge(o),c=e.node(o.v);i&&s.push({v:o.v,w:o.w}),c.out-=l,Ag(t,r,c)}),sn.forEach(e.outEdges(n.v),function(o){var l=e.edge(o),c=o.w,d=e.node(c);d.in-=l,Ag(t,r,d)}),e.removeNode(n.v),s}function VF(e,t){var r=new qF,n=0,i=0;sn.forEach(e.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),sn.forEach(e.edges(),function(l){var c=r.edge(l.v,l.w)||0,d=t(l),u=c+d;r.setEdge(l.v,l.w,u),i=Math.max(i,r.node(l.v).out+=d),n=Math.max(n,r.node(l.w).in+=d)});var s=sn.range(i+n+3).map(function(){return new $F}),o=n+1;return sn.forEach(r.nodes(),function(l){Ag(s,o,r.node(l))}),{graph:r,buckets:s,zeroIdx:o}}function Ag(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var hi=Qe,GF=BF,KF={run:YF,undo:QF};function YF(e){var t=e.graph().acyclicer==="greedy"?GF(e,r(e)):XF(e);hi.forEach(t,function(n){var i=e.edge(n);e.removeEdge(n),i.forwardName=n.name,i.reversed=!0,e.setEdge(n.w,n.v,i,hi.uniqueId("rev"))});function r(n){return function(i){return n.edge(i).weight}}}function XF(e){var t=[],r={},n={};function i(s){hi.has(n,s)||(n[s]=!0,r[s]=!0,hi.forEach(e.outEdges(s),function(o){hi.has(r,o.w)?t.push(o):i(o.w)}),delete r[s])}return hi.forEach(e.nodes(),i),t}function QF(e){hi.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var Le=Qe,ST=Pr.Graph,Kt={addDummyNode:kT,simplify:ZF,asNonCompoundGraph:JF,successorWeights:ez,predecessorWeights:tz,intersectRect:rz,buildLayerMatrix:nz,normalizeRanks:iz,removeEmptyRanks:sz,addBorderNode:oz,maxRank:NT,partition:az,time:lz,notime:cz};function kT(e,t,r,n){var i;do i=Le.uniqueId(n);while(e.hasNode(i));return r.dummy=t,e.setNode(i,r),i}function ZF(e){var t=new ST().setGraph(e.graph());return Le.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),Le.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},i=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),t}function JF(e){var t=new ST({multigraph:e.isMultigraph()}).setGraph(e.graph());return Le.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),Le.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function ez(e){var t=Le.map(e.nodes(),function(r){var n={};return Le.forEach(e.outEdges(r),function(i){n[i.w]=(n[i.w]||0)+e.edge(i).weight}),n});return Le.zipObject(e.nodes(),t)}function tz(e){var t=Le.map(e.nodes(),function(r){var n={};return Le.forEach(e.inEdges(r),function(i){n[i.v]=(n[i.v]||0)+e.edge(i).weight}),n});return Le.zipObject(e.nodes(),t)}function rz(e,t){var r=e.x,n=e.y,i=t.x-r,s=t.y-n,o=e.width/2,l=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(s)*o>Math.abs(i)*l?(s<0&&(l=-l),c=l*i/s,d=l):(i<0&&(o=-o),c=o,d=o*s/i),{x:r+c,y:n+d}}function nz(e){var t=Le.map(Le.range(NT(e)+1),function(){return[]});return Le.forEach(e.nodes(),function(r){var n=e.node(r),i=n.rank;Le.isUndefined(i)||(t[i][n.order]=r)}),t}function iz(e){var t=Le.min(Le.map(e.nodes(),function(r){return e.node(r).rank}));Le.forEach(e.nodes(),function(r){var n=e.node(r);Le.has(n,"rank")&&(n.rank-=t)})}function sz(e){var t=Le.min(Le.map(e.nodes(),function(s){return e.node(s).rank})),r=[];Le.forEach(e.nodes(),function(s){var o=e.node(s).rank-t;r[o]||(r[o]=[]),r[o].push(s)});var n=0,i=e.graph().nodeRankFactor;Le.forEach(r,function(s,o){Le.isUndefined(s)&&o%i!==0?--n:n&&Le.forEach(s,function(l){e.node(l).rank+=n})})}function oz(e,t,r,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=r,i.order=n),kT(e,"border",i,t)}function NT(e){return Le.max(Le.map(e.nodes(),function(t){var r=e.node(t).rank;if(!Le.isUndefined(r))return r}))}function az(e,t){var r={lhs:[],rhs:[]};return Le.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function lz(e,t){var r=Le.now();try{return t()}finally{console.log(e+" time: "+(Le.now()-r)+"ms")}}function cz(e,t){return t()}var CT=Qe,uz=Kt,dz={run:fz,undo:hz};function fz(e){e.graph().dummyChains=[],CT.forEach(e.edges(),function(t){pz(e,t)})}function pz(e,t){var r=t.v,n=e.node(r).rank,i=t.w,s=e.node(i).rank,o=t.name,l=e.edge(t),c=l.labelRank;if(s!==n+1){e.removeEdge(t);var d,u,f;for(f=0,++n;n<s;++f,++n)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:n},d=uz.addDummyNode(e,"edge",u,"_d"),n===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(r,d,{weight:l.weight},o),f===0&&e.graph().dummyChains.push(d),r=d;e.setEdge(r,i,{weight:l.weight},o)}}function hz(e){CT.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,i;for(e.setEdge(r.edgeObj,n);r.dummy;)i=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=i,r=e.node(t)})}var il=Qe,gu={longestPath:mz,slack:vz};function mz(e){var t={};function r(n){var i=e.node(n);if(il.has(t,n))return i.rank;t[n]=!0;var s=il.min(il.map(e.outEdges(n),function(o){return r(o.w)-e.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}il.forEach(e.sources(),r)}function vz(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var pc=Qe,gz=Pr.Graph,hc=gu.slack,ET=xz;function xz(e){var t=new gz({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var i,s;yz(t,e)<n;)i=bz(t,e),s=t.hasNode(i.v)?hc(e,i):-hc(e,i),_z(t,e,s);return t}function yz(e,t){function r(n){pc.forEach(t.nodeEdges(n),function(i){var s=i.v,o=n===s?i.w:s;!e.hasNode(o)&&!hc(t,i)&&(e.setNode(o,{}),e.setEdge(n,o,{}),r(o))})}return pc.forEach(e.nodes(),r),e.nodeCount()}function bz(e,t){return pc.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return hc(t,r)})}function _z(e,t,r){pc.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var mn=Qe,wz=ET,jz=gu.slack,Sz=gu.longestPath,kz=Pr.alg.preorder,Nz=Pr.alg.postorder,Cz=Kt.simplify,Ez=Mi;Mi.initLowLimValues=_y;Mi.initCutValues=by;Mi.calcCutValue=TT;Mi.leaveEdge=AT;Mi.enterEdge=IT;Mi.exchangeEdges=MT;function Mi(e){e=Cz(e),Sz(e);var t=wz(e);_y(t),by(t,e);for(var r,n;r=AT(t);)n=IT(t,e,r),MT(t,e,r,n)}function by(e,t){var r=Nz(e,e.nodes());r=r.slice(0,r.length-1),mn.forEach(r,function(n){Tz(e,t,n)})}function Tz(e,t,r){var n=e.node(r),i=n.parent;e.edge(r,i).cutvalue=TT(e,t,r)}function TT(e,t,r){var n=e.node(r),i=n.parent,s=!0,o=t.edge(r,i),l=0;return o||(s=!1,o=t.edge(i,r)),l=o.weight,mn.forEach(t.nodeEdges(r),function(c){var d=c.v===r,u=d?c.w:c.v;if(u!==i){var f=d===s,p=t.edge(c).weight;if(l+=f?p:-p,Az(e,r,u)){var h=e.edge(r,u).cutvalue;l+=f?-h:h}}}),l}function _y(e,t){arguments.length<2&&(t=e.nodes()[0]),RT(e,{},1,t)}function RT(e,t,r,n,i){var s=r,o=e.node(n);return t[n]=!0,mn.forEach(e.neighbors(n),function(l){mn.has(t,l)||(r=RT(e,t,r,l,n))}),o.low=s,o.lim=r++,i?o.parent=i:delete o.parent,r}function AT(e){return mn.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function IT(e,t,r){var n=r.v,i=r.w;t.hasEdge(n,i)||(n=r.w,i=r.v);var s=e.node(n),o=e.node(i),l=s,c=!1;s.lim>o.lim&&(l=o,c=!0);var d=mn.filter(t.edges(),function(u){return c===Rj(e,e.node(u.v),l)&&c!==Rj(e,e.node(u.w),l)});return mn.minBy(d,function(u){return jz(t,u)})}function MT(e,t,r,n){var i=r.v,s=r.w;e.removeEdge(i,s),e.setEdge(n.v,n.w,{}),_y(e),by(e,t),Rz(e,t)}function Rz(e,t){var r=mn.find(e.nodes(),function(i){return!t.node(i).parent}),n=kz(e,r);n=n.slice(1),mn.forEach(n,function(i){var s=e.node(i).parent,o=t.edge(i,s),l=!1;o||(o=t.edge(s,i),l=!0),t.node(i).rank=t.node(s).rank+(l?o.minlen:-o.minlen)})}function Az(e,t,r){return e.hasEdge(t,r)}function Rj(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var Iz=gu,PT=Iz.longestPath,Mz=ET,Pz=Ez,Oz=Dz;function Dz(e){switch(e.graph().ranker){case"network-simplex":Aj(e);break;case"tight-tree":Fz(e);break;case"longest-path":Lz(e);break;default:Aj(e)}}var Lz=PT;function Fz(e){PT(e),Mz(e)}function Aj(e){Pz(e)}var Ig=Qe,zz=qz;function qz(e){var t=Bz(e);Ig.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),i=n.edgeObj,s=$z(e,t,i.v,i.w),o=s.path,l=s.lca,c=0,d=o[c],u=!0;r!==i.w;){if(n=e.node(r),u){for(;(d=o[c])!==l&&e.node(d).maxRank<n.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(d=o[c+1]).minRank<=n.rank;)c++;d=o[c]}e.setParent(r,d),r=e.successors(r)[0]}})}function $z(e,t,r,n){var i=[],s=[],o=Math.min(t[r].low,t[n].low),l=Math.max(t[r].lim,t[n].lim),c,d;c=r;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||l>t[c].lim));for(d=c,c=n;(c=e.parent(c))!==d;)s.push(c);return{path:i.concat(s.reverse()),lca:d}}function Bz(e){var t={},r=0;function n(i){var s=r;Ig.forEach(e.children(i),n),t[i]={low:s,lim:r++}}return Ig.forEach(e.children(),n),t}var on=Qe,Mg=Kt,Hz={run:Wz,cleanup:Gz};function Wz(e){var t=Mg.addDummyNode(e,"root",{},"_root"),r=Uz(e),n=on.max(on.values(r))-1,i=2*n+1;e.graph().nestingRoot=t,on.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var s=Vz(e)+1;on.forEach(e.children(),function(o){OT(e,t,i,s,n,r,o)}),e.graph().nodeRankFactor=i}function OT(e,t,r,n,i,s,o){var l=e.children(o);if(!l.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:r});return}var c=Mg.addBorderNode(e,"_bt"),d=Mg.addBorderNode(e,"_bb"),u=e.node(o);e.setParent(c,o),u.borderTop=c,e.setParent(d,o),u.borderBottom=d,on.forEach(l,function(f){OT(e,t,r,n,i,s,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,x=p.borderBottom?p.borderBottom:f,v=p.borderTop?n:2*n,_=h!==x?1:i-s[o]+1;e.setEdge(c,h,{weight:v,minlen:_,nestingEdge:!0}),e.setEdge(x,d,{weight:v,minlen:_,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+s[o]})}function Uz(e){var t={};function r(n,i){var s=e.children(n);s&&s.length&&on.forEach(s,function(o){r(o,i+1)}),t[n]=i}return on.forEach(e.children(),function(n){r(n,1)}),t}function Vz(e){return on.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function Gz(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,on.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var ev=Qe,Kz=Kt,Yz=Xz;function Xz(e){function t(r){var n=e.children(r),i=e.node(r);if(n.length&&ev.forEach(n,t),ev.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,o=i.maxRank+1;s<o;++s)Ij(e,"borderLeft","_bl",r,i,s),Ij(e,"borderRight","_br",r,i,s)}}ev.forEach(e.children(),t)}function Ij(e,t,r,n,i,s){var o={width:0,height:0,rank:s,borderType:t},l=i[t][s-1],c=Kz.addDummyNode(e,"border",o,r);i[t][s]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}var qr=Qe,Qz={adjust:Zz,undo:Jz};function Zz(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&DT(e)}function Jz(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&eq(e),(t==="lr"||t==="rl")&&(tq(e),DT(e))}function DT(e){qr.forEach(e.nodes(),function(t){Mj(e.node(t))}),qr.forEach(e.edges(),function(t){Mj(e.edge(t))})}function Mj(e){var t=e.width;e.width=e.height,e.height=t}function eq(e){qr.forEach(e.nodes(),function(t){tv(e.node(t))}),qr.forEach(e.edges(),function(t){var r=e.edge(t);qr.forEach(r.points,tv),qr.has(r,"y")&&tv(r)})}function tv(e){e.y=-e.y}function tq(e){qr.forEach(e.nodes(),function(t){rv(e.node(t))}),qr.forEach(e.edges(),function(t){var r=e.edge(t);qr.forEach(r.points,rv),qr.has(r,"x")&&rv(r)})}function rv(e){var t=e.x;e.x=e.y,e.y=t}var Xr=Qe,rq=nq;function nq(e){var t={},r=Xr.filter(e.nodes(),function(l){return!e.children(l).length}),n=Xr.max(Xr.map(r,function(l){return e.node(l).rank})),i=Xr.map(Xr.range(n+1),function(){return[]});function s(l){if(!Xr.has(t,l)){t[l]=!0;var c=e.node(l);i[c.rank].push(l),Xr.forEach(e.successors(l),s)}}var o=Xr.sortBy(r,function(l){return e.node(l).rank});return Xr.forEach(o,s),i}var wn=Qe,iq=sq;function sq(e,t){for(var r=0,n=1;n<t.length;++n)r+=oq(e,t[n-1],t[n]);return r}function oq(e,t,r){for(var n=wn.zipObject(r,wn.map(r,function(d,u){return u})),i=wn.flatten(wn.map(t,function(d){return wn.sortBy(wn.map(e.outEdges(d),function(u){return{pos:n[u.w],weight:e.edge(u).weight}}),"pos")}),!0),s=1;s<r.length;)s<<=1;var o=2*s-1;s-=1;var l=wn.map(new Array(o),function(){return 0}),c=0;return wn.forEach(i.forEach(function(d){var u=d.pos+s;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var Pj=Qe,aq=lq;function lq(e,t){return Pj.map(t,function(r){var n=e.inEdges(r);if(n.length){var i=Pj.reduce(n,function(s,o){var l=e.edge(o),c=e.node(o.v);return{sum:s.sum+l.weight*c.order,weight:s.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:r}})}var er=Qe,cq=uq;function uq(e,t){var r={};er.forEach(e,function(i,s){var o=r[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};er.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),er.forEach(t.edges(),function(i){var s=r[i.v],o=r[i.w];!er.isUndefined(s)&&!er.isUndefined(o)&&(o.indegree++,s.out.push(r[i.w]))});var n=er.filter(r,function(i){return!i.indegree});return dq(n)}function dq(e){var t=[];function r(s){return function(o){o.merged||(er.isUndefined(o.barycenter)||er.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&fq(s,o)}}function n(s){return function(o){o.in.push(s),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),er.forEach(i.in.reverse(),r(i)),er.forEach(i.out,n(i))}return er.map(er.filter(t,function(s){return!s.merged}),function(s){return er.pick(s,["vs","i","barycenter","weight"])})}function fq(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var xo=Qe,pq=Kt,hq=mq;function mq(e,t){var r=pq.partition(e,function(u){return xo.has(u,"barycenter")}),n=r.lhs,i=xo.sortBy(r.rhs,function(u){return-u.i}),s=[],o=0,l=0,c=0;n.sort(vq(!!t)),c=Oj(s,i,c),xo.forEach(n,function(u){c+=u.vs.length,s.push(u.vs),o+=u.barycenter*u.weight,l+=u.weight,c=Oj(s,i,c)});var d={vs:xo.flatten(s,!0)};return l&&(d.barycenter=o/l,d.weight=l),d}function Oj(e,t,r){for(var n;t.length&&(n=xo.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function vq(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var In=Qe,gq=aq,xq=cq,yq=hq,bq=LT;function LT(e,t,r,n){var i=e.children(t),s=e.node(t),o=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,c={};o&&(i=In.filter(i,function(x){return x!==o&&x!==l}));var d=gq(e,i);In.forEach(d,function(x){if(e.children(x.v).length){var v=LT(e,x.v,r,n);c[x.v]=v,In.has(v,"barycenter")&&wq(x,v)}});var u=xq(d,r);_q(u,c);var f=yq(u,n);if(o&&(f.vs=In.flatten([o,f.vs,l],!0),e.predecessors(o).length)){var p=e.node(e.predecessors(o)[0]),h=e.node(e.predecessors(l)[0]);In.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function _q(e,t){In.forEach(e,function(r){r.vs=In.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function wq(e,t){In.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var yo=Qe,jq=Pr.Graph,Sq=kq;function kq(e,t,r){var n=Nq(e),i=new jq({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(s){return e.node(s)});return yo.forEach(e.nodes(),function(s){var o=e.node(s),l=e.parent(s);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(s),i.setParent(s,l||n),yo.forEach(e[r](s),function(c){var d=c.v===s?c.w:c.v,u=i.edge(d,s),f=yo.isUndefined(u)?0:u.weight;i.setEdge(d,s,{weight:e.edge(c).weight+f})}),yo.has(o,"minRank")&&i.setNode(s,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function Nq(e){for(var t;e.hasNode(t=yo.uniqueId("_root")););return t}var Cq=Qe,Eq=Tq;function Tq(e,t,r){var n={},i;Cq.forEach(r,function(s){for(var o=e.parent(s),l,c;o;){if(l=e.parent(o),l?(c=n[l],n[l]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=l}})}var Un=Qe,Rq=rq,Aq=iq,Iq=bq,Mq=Sq,Pq=Eq,Oq=Pr.Graph,Dj=Kt,Dq=Lq;function Lq(e){var t=Dj.maxRank(e),r=Lj(e,Un.range(1,t+1),"inEdges"),n=Lj(e,Un.range(t-1,-1,-1),"outEdges"),i=Rq(e);Fj(e,i);for(var s=Number.POSITIVE_INFINITY,o,l=0,c=0;c<4;++l,++c){Fq(l%2?r:n,l%4>=2),i=Dj.buildLayerMatrix(e);var d=Aq(e,i);d<s&&(c=0,o=Un.cloneDeep(i),s=d)}Fj(e,o)}function Lj(e,t,r){return Un.map(t,function(n){return Mq(e,n,r)})}function Fq(e,t){var r=new Oq;Un.forEach(e,function(n){var i=n.graph().root,s=Iq(n,i,r,t);Un.forEach(s.vs,function(o,l){n.node(o).order=l}),Pq(n,r,s.vs)})}function Fj(e,t){Un.forEach(t,function(r){Un.forEach(r,function(n,i){e.node(n).order=i})})}var ye=Qe,zq=Pr.Graph,qq=Kt,$q={positionX:Zq};function Bq(e,t){var r={};function n(i,s){var o=0,l=0,c=i.length,d=ye.last(s);return ye.forEach(s,function(u,f){var p=Wq(e,u),h=p?e.node(p).order:c;(p||u===d)&&(ye.forEach(s.slice(l,f+1),function(x){ye.forEach(e.predecessors(x),function(v){var _=e.node(v),g=_.order;(g<o||h<g)&&!(_.dummy&&e.node(x).dummy)&&FT(r,v,x)})}),l=f+1,o=h)}),s}return ye.reduce(t,n),r}function Hq(e,t){var r={};function n(s,o,l,c,d){var u;ye.forEach(ye.range(o,l),function(f){u=s[f],e.node(u).dummy&&ye.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&FT(r,p,u)})})}function i(s,o){var l=-1,c,d=0;return ye.forEach(o,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,n(o,d,f,l,c),d=f,l=c)}n(o,d,o.length,c,s.length)}),o}return ye.reduce(t,i),r}function Wq(e,t){if(e.node(t).dummy)return ye.find(e.predecessors(t),function(r){return e.node(r).dummy})}function FT(e,t,r){if(t>r){var n=t;t=r,r=n}var i=e[t];i||(e[t]=i={}),i[r]=!0}function Uq(e,t,r){if(t>r){var n=t;t=r,r=n}return ye.has(e[t],r)}function Vq(e,t,r,n){var i={},s={},o={};return ye.forEach(t,function(l){ye.forEach(l,function(c,d){i[c]=c,s[c]=c,o[c]=d})}),ye.forEach(t,function(l){var c=-1;ye.forEach(l,function(d){var u=n(d);if(u.length){u=ye.sortBy(u,function(v){return o[v]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var x=u[p];s[d]===d&&c<o[x]&&!Uq(r,d,x)&&(s[x]=d,s[d]=i[d]=i[x],c=o[x])}}})}),{root:i,align:s}}function Gq(e,t,r,n,i){var s={},o=Kq(e,t,r,i),l=i?"borderLeft":"borderRight";function c(f,p){for(var h=o.nodes(),x=h.pop(),v={};x;)v[x]?f(x):(v[x]=!0,h.push(x),h=h.concat(p(x))),x=h.pop()}function d(f){s[f]=o.inEdges(f).reduce(function(p,h){return Math.max(p,s[h.v]+o.edge(h))},0)}function u(f){var p=o.outEdges(f).reduce(function(x,v){return Math.min(x,s[v.w]-o.edge(v))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(s[f]=Math.max(s[f],p))}return c(d,o.predecessors.bind(o)),c(u,o.successors.bind(o)),ye.forEach(n,function(f){s[f]=s[r[f]]}),s}function Kq(e,t,r,n){var i=new zq,s=e.graph(),o=Jq(s.nodesep,s.edgesep,n);return ye.forEach(t,function(l){var c;ye.forEach(l,function(d){var u=r[d];if(i.setNode(u),c){var f=r[c],p=i.edge(f,u);i.setEdge(f,u,Math.max(o(e,d,c),p||0))}c=d})}),i}function Yq(e,t){return ye.minBy(ye.values(t),function(r){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return ye.forIn(r,function(s,o){var l=e$(e,o)/2;n=Math.max(s+l,n),i=Math.min(s-l,i)}),n-i})}function Xq(e,t){var r=ye.values(t),n=ye.min(r),i=ye.max(r);ye.forEach(["u","d"],function(s){ye.forEach(["l","r"],function(o){var l=s+o,c=e[l],d;if(c!==t){var u=ye.values(c);d=o==="l"?n-ye.min(u):i-ye.max(u),d&&(e[l]=ye.mapValues(c,function(f){return f+d}))}})})}function Qq(e,t){return ye.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var i=ye.sortBy(ye.map(e,n));return(i[1]+i[2])/2})}function Zq(e){var t=qq.buildLayerMatrix(e),r=ye.merge(Bq(e,t),Hq(e,t)),n={},i;ye.forEach(["u","d"],function(o){i=o==="u"?t:ye.values(t).reverse(),ye.forEach(["l","r"],function(l){l==="r"&&(i=ye.map(i,function(f){return ye.values(f).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),d=Vq(e,i,r,c),u=Gq(e,i,d.root,d.align,l==="r");l==="r"&&(u=ye.mapValues(u,function(f){return-f})),n[o+l]=u})});var s=Yq(e,n);return Xq(n,s),Qq(n,e.graph().align)}function Jq(e,t,r){return function(n,i,s){var o=n.node(i),l=n.node(s),c=0,d;if(c+=o.width/2,ye.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":d=-o.width/2;break;case"r":d=o.width/2;break}if(d&&(c+=r?d:-d),d=0,c+=(o.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,ye.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=r?d:-d),d=0,c}}function e$(e,t){return e.node(t).width}var bo=Qe,zT=Kt,t$=$q.positionX,r$=n$;function n$(e){e=zT.asNonCompoundGraph(e),i$(e),bo.forEach(t$(e),function(t,r){e.node(r).x=t})}function i$(e){var t=zT.buildLayerMatrix(e),r=e.graph().ranksep,n=0;bo.forEach(t,function(i){var s=bo.max(bo.map(i,function(o){return e.node(o).height}));bo.forEach(i,function(o){e.node(o).y=n+s/2}),n+=s+r})}var Se=Qe,zj=KF,qj=dz,s$=Oz,o$=Kt.normalizeRanks,a$=zz,l$=Kt.removeEmptyRanks,$j=Hz,c$=Yz,Bj=Qz,u$=Dq,d$=r$,Yn=Kt,f$=Pr.Graph,p$=h$;function h$(e,t){var r=t&&t.debugTiming?Yn.time:Yn.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return k$(e)});r("  runLayout",function(){m$(n,r)}),r("  updateInputGraph",function(){v$(e,n)})})}function m$(e,t){t("    makeSpaceForEdgeLabels",function(){N$(e)}),t("    removeSelfEdges",function(){O$(e)}),t("    acyclic",function(){zj.run(e)}),t("    nestingGraph.run",function(){$j.run(e)}),t("    rank",function(){s$(Yn.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){C$(e)}),t("    removeEmptyRanks",function(){l$(e)}),t("    nestingGraph.cleanup",function(){$j.cleanup(e)}),t("    normalizeRanks",function(){o$(e)}),t("    assignRankMinMax",function(){E$(e)}),t("    removeEdgeLabelProxies",function(){T$(e)}),t("    normalize.run",function(){qj.run(e)}),t("    parentDummyChains",function(){a$(e)}),t("    addBorderSegments",function(){c$(e)}),t("    order",function(){u$(e)}),t("    insertSelfEdges",function(){D$(e)}),t("    adjustCoordinateSystem",function(){Bj.adjust(e)}),t("    position",function(){d$(e)}),t("    positionSelfEdges",function(){L$(e)}),t("    removeBorderNodes",function(){P$(e)}),t("    normalize.undo",function(){qj.undo(e)}),t("    fixupEdgeLabelCoords",function(){I$(e)}),t("    undoCoordinateSystem",function(){Bj.undo(e)}),t("    translateGraph",function(){R$(e)}),t("    assignNodeIntersects",function(){A$(e)}),t("    reversePoints",function(){M$(e)}),t("    acyclic.undo",function(){zj.undo(e)})}function v$(e,t){Se.forEach(e.nodes(),function(r){var n=e.node(r),i=t.node(r);n&&(n.x=i.x,n.y=i.y,t.children(r).length&&(n.width=i.width,n.height=i.height))}),Se.forEach(e.edges(),function(r){var n=e.edge(r),i=t.edge(r);n.points=i.points,Se.has(i,"x")&&(n.x=i.x,n.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var g$=["nodesep","edgesep","ranksep","marginx","marginy"],x$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},y$=["acyclicer","ranker","rankdir","align"],b$=["width","height"],_$={width:0,height:0},w$=["minlen","weight","width","height","labeloffset"],j$={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S$=["labelpos"];function k$(e){var t=new f$({multigraph:!0,compound:!0}),r=iv(e.graph());return t.setGraph(Se.merge({},x$,nv(r,g$),Se.pick(r,y$))),Se.forEach(e.nodes(),function(n){var i=iv(e.node(n));t.setNode(n,Se.defaults(nv(i,b$),_$)),t.setParent(n,e.parent(n))}),Se.forEach(e.edges(),function(n){var i=iv(e.edge(n));t.setEdge(n,Se.merge({},j$,nv(i,w$),Se.pick(i,S$)))}),t}function N$(e){var t=e.graph();t.ranksep/=2,Se.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function C$(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-n.rank)/2+n.rank,e:t};Yn.addDummyNode(e,"edge-proxy",s,"_ep")}})}function E$(e){var t=0;Se.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=Se.max(t,n.maxRank))}),e.graph().maxRank=t}function T$(e){Se.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function R$(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,i=0,s=e.graph(),o=s.marginx||0,l=s.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),r=Math.max(r,u+p/2),n=Math.min(n,f-h/2),i=Math.max(i,f+h/2)}Se.forEach(e.nodes(),function(d){c(e.node(d))}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.has(u,"x")&&c(u)}),t-=o,n-=l,Se.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=n}),Se.forEach(e.edges(),function(d){var u=e.edge(d);Se.forEach(u.points,function(f){f.x-=t,f.y-=n}),Se.has(u,"x")&&(u.x-=t),Se.has(u,"y")&&(u.y-=n)}),s.width=r-t+o,s.height=i-n+l}function A$(e){Se.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),i=e.node(t.w),s,o;r.points?(s=r.points[0],o=r.points[r.points.length-1]):(r.points=[],s=i,o=n),r.points.unshift(Yn.intersectRect(n,s)),r.points.push(Yn.intersectRect(i,o))})}function I$(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);if(Se.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function M$(e){Se.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function P$(e){Se.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),i=e.node(r.borderBottom),s=e.node(Se.last(r.borderLeft)),o=e.node(Se.last(r.borderRight));r.width=Math.abs(o.x-s.x),r.height=Math.abs(i.y-n.y),r.x=s.x+r.width/2,r.y=n.y+r.height/2}}),Se.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function O$(e){Se.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function D$(e){var t=Yn.buildLayerMatrix(e);Se.forEach(t,function(r){var n=0;Se.forEach(r,function(i,s){var o=e.node(i);o.order=s+n,Se.forEach(o.selfEdges,function(l){Yn.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:o.rank,order:s+ ++n,e:l.e,label:l.label},"_se")}),delete o.selfEdges})})}function L$(e){Se.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),i=n.x+n.width/2,s=n.y,o=r.x-i,l=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:i+2*o/3,y:s-l},{x:i+5*o/6,y:s-l},{x:i+o,y:s},{x:i+5*o/6,y:s+l},{x:i+2*o/3,y:s+l}],r.label.x=r.x,r.label.y=r.y}})}function nv(e,t){return Se.mapValues(Se.pick(e,t),Number)}function iv(e){var t={};return Se.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var sl=Qe,F$=Kt,z$=Pr.Graph,q$={debugOrdering:$$};function $$(e){var t=F$.buildLayerMatrix(e),r=new z$({compound:!0,multigraph:!0}).setGraph({});return sl.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),sl.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),sl.forEach(t,function(n,i){var s="layer"+i;r.setNode(s,{rank:"same"}),sl.reduce(n,function(o,l){return r.setEdge(o,l,{style:"invis"}),l})}),r}var B$="0.8.5",H$={graphlib:Pr,layout:p$,debug:q$,util:{time:Kt.time,notime:Kt.notime},version:B$};const mc=Wg(H$),Hj=(e,t)=>{const r=new mc.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),mc.layout(r),{nodes:e.map(n=>{const i=r.node(n.id);return{...n,targetPosition:ce.Top,sourcePosition:ce.Bottom,position:{x:i.x-(n.data.width??280)/2,y:i.y-(n.data.height??90)/2}}}),edges:t}},Wj=(e,t,r)=>{let n=[],i=[],s=null,o=null,l=[];const c=r.theme||"industrial";return e.forEach((d,u)=>{var x,v;if((d.level||1)!==1)return;const f=280;let p=95;d.state==="active"&&d.stations&&(p+=35);const h=t===d.id;if(n.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),s){const _=(x=e[u-1])==null?void 0:x.state;i.push({id:"e-"+s+"-"+d.id,source:s,target:d.id,type:"smoothstep",animated:_==="active",style:{stroke:wE(_,c),strokeWidth:3}})}((v=d.children)==null?void 0:v.length)>0&&(o=d.id,l=d.children),s=d.id}),{nodes:n,edges:i,epicBacklogId:o,epicChildren:l}},Uj=(e,t,r,n,i)=>{const{nodes:s,edges:o}=e;if(!t||!r.length)return{nodes:s,edges:o};const l=s.find(b=>b.id===t);if(!l)return{nodes:s,edges:o};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=i.theme||"industrial",p=wE(u,f),h=u==="active",x=wr.EPIC_HEIGHT+wr.EPIC_GAP_Y,v=Math.ceil(r.length/wr.EPICS_PER_ROW),_=c+280*.15,g=50,y={};r.forEach((b,w)=>{const S=Math.floor(w/wr.EPICS_PER_ROW);y[S]||(y[S]=[]),y[S].push({epic:b,idx:w})});for(let b=0;b<v;b++){const w=y[b]||[];if(w.length===0)continue;const S=d+wr.EPIC_OFFSET_Y+b*x,k=`junction-row-${b}`;s.push({id:k,type:"waypoint",position:{x:_,y:S-g},draggable:!1,connectable:!1,selectable:!1}),b===0?o.push({id:`e-spine-drop-${b}`,source:t,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):o.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),w.forEach(({epic:N,idx:E})=>{const j=E%wr.EPICS_PER_ROW,R=c+wr.EPIC_OFFSET_X+j*(wr.EPIC_WIDTH+wr.EPIC_GAP_X),T=S,D=n===N.id;s.push({id:N.id,type:"documentNode",data:{...N,width:wr.EPIC_WIDTH,height:wr.EPIC_HEIGHT,isExpanded:D,...i},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:ce.Top,sourcePosition:ce.Bottom,zIndex:D?1e3:0}),o.push({id:`e-branch-${N.id}`,source:k,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:s,edges:o}},W$={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},Vj={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function U$(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function V$(e,t=[]){const r=[],n=[],i={};for(const s of e.tracks){const o=G$(s,t);if((s.scope||"project")==="project")n.push({...o,mayOwn:s.may_own||[],childDocType:s.child_doc_type});else{const c=s.document_type;i[c]||(i[c]=[]),i[c].push(o)}}for(const s of n)s.childDocType&&i[s.childDocType]&&(s.children=i[s.childDocType].map(o=>({...o,level:2}))),r.push(s);return r}function G$(e,t=[]){const r=W$[e.state]||"ready_for_production",n=e.state==="awaiting_operator",i=t.find(l=>l.document_type===e.document_type);let s=null;(r==="in_production"||n)&&(s=K$(e.stations,e.state,e.station));let o=null;return i&&i.questions&&(o=i.questions.map((l,c)=>({id:l.id||`q${c+1}`,text:l.question||l.text||l,required:l.required!==!1}))),{id:e.document_type,name:e.document_name||Y$(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:s,questions:o,interruptId:i==null?void 0:i.id,blockedBy:e.blocked_by||[]}}function K$(e,t,r){if(!e||e.length===0){const n=r||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return ud.map(i=>({id:i,label:Vj[i]||i.toUpperCase(),state:n===i?"active":ud.indexOf(i)<ud.indexOf(n)?"complete":"pending",needs_input:i==="pgc"&&t==="awaiting_operator"}))}return e.map(n=>({id:n.station,label:Vj[n.station]||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function Y$(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function X$({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,i]=m.useState(!0),[s,o]=m.useState(null),l=m.useCallback(async()=>{i(!0),o(null);try{const d=await Ve.getProjects({includeArchived:e}),u=U$(d);r(u)}catch(d){o(d.message),console.error("Failed to fetch projects:",d)}finally{i(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await Ve.createProject({name:d,description:""});return r(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw o(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:n,error:s,addProject:c,refresh:l}}function Q$(e){const[t,r]=m.useState([]),[n,i]=m.useState("idle"),[s,o]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),h=m.useRef(null),x=m.useRef(null),v=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[w,S]=await Promise.all([Ve.getProductionStatus(e),Ve.getProjectInterrupts(e).catch(()=>[])]);o(S),i(w.line_state),r(V$(w,S))}catch(w){u(w.message),console.error("Failed to fetch production status:",w)}finally{c(!1)}},[e]),_=m.useCallback(()=>{if(!e)return;h.current&&h.current.close();const w=f6(e);h.current=w,w.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),w.addEventListener("station_transition",S=>{try{const k=JSON.parse(S.data);console.log("Station transition:",k),v()}catch(k){console.error("Failed to parse station_transition:",k)}}),w.addEventListener("line_stopped",S=>{try{const k=JSON.parse(S.data);console.log("Line stopped:",k),i("stopped"),v()}catch(k){console.error("Failed to parse line_stopped:",k)}}),w.addEventListener("production_complete",S=>{try{const k=JSON.parse(S.data);console.log("Production complete:",k),i("complete"),v()}catch(k){console.error("Failed to parse production_complete:",k)}}),w.addEventListener("interrupt_resolved",S=>{try{const k=JSON.parse(S.data);console.log("Interrupt resolved:",k),v()}catch(k){console.error("Failed to parse interrupt_resolved:",k)}}),w.addEventListener("track_started",S=>{try{const k=JSON.parse(S.data);console.log("Track started:",k),i("active"),v()}catch(k){console.error("Failed to parse track_started:",k)}}),w.onerror=S=>{console.error("SSE error:",S),p(!1),u("Connection lost"),w.close(),x.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),_()},3e3)}},[e,v]),g=m.useCallback(()=>{x.current&&clearTimeout(x.current),h.current&&(h.current.close(),h.current=null),p(!1)},[]),y=m.useCallback(async(w,S)=>{try{await Ve.resolveInterrupt(w,{answers:S}),await v()}catch(k){throw console.error("Failed to resolve interrupt:",k),k}},[v]),b=m.useCallback(async(w=null)=>{try{await Ve.startProduction(e,w),i("active"),await v()}catch(S){throw console.error("Failed to start production:",S),S}},[e,v]);return m.useEffect(()=>(v(),_(),()=>g()),[v,_,g]),{data:t,lineState:n,interrupts:s,loading:l,error:d,connected:f,refresh:v,resolveInterrupt:y,startProduction:b}}const Gj="combine-theme";function qT(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const s=localStorage.getItem(Gj);return s&&An.includes(s)?s:e});m.useEffect(()=>{localStorage.setItem(Gj,t)},[t]);const n=m.useCallback(s=>{An.includes(s)&&r(s)},[]),i=m.useCallback(()=>{r(s=>{const o=An.indexOf(s);return An[(o+1)%An.length]})},[]);return{theme:t,setTheme:n,cycleTheme:i}}function Z$(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[i,s]=m.useState([]),[o,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[x,v]=m.useState([]),[_,g]=m.useState(!1),[y,b]=m.useState(null),[w,S]=m.useState(null),[k,N]=m.useState(null),[E,j]=m.useState(!1),[R,T]=m.useState(!1),[D,q]=m.useState(null),[C,O]=m.useState(null),I=m.useRef(null),F=m.useRef(!0);m.useEffect(()=>(F.current=!0,()=>{F.current=!1,I.current&&I.current.close()}),[]);const M=m.useCallback(W=>{F.current&&(n(W.phase),s(W.messages||[]),l(W.pending_prompt),d(W.pending_choices),f(W.interpretation||{}),h(W.confidence||0),v(W.missing_fields||[]),g(W.can_initialize||!1),b(W.gate_outcome),S(W.project),q(W.intake_classification),O(W.intake_gate_phase))},[]),A=m.useCallback(async()=>{N(null),j(!0);try{const W=await Ve.startIntake();if(!F.current)return;t(W.execution_id),M(W)}catch(W){if(!F.current)return;N(W.message||"Failed to start intake")}finally{F.current&&j(!1)}},[]),L=m.useCallback(async W=>{if(!e||!W.trim())return;N(null),T(!0);const $={role:"user",content:W};s(Q=>[...Q,$]);try{const Q=await Ve.submitIntakeMessage(e,W);if(!F.current)return;M(Q)}catch(Q){if(!F.current)return;s(se=>se.filter(ae=>ae!==$)),N(Q.message||"Failed to submit message")}finally{F.current&&T(!1)}},[e,M]),z=m.useCallback(async(W,$)=>{if(e){N(null),f(Q=>({...Q,[W]:{value:$,source:"user",locked:!0}}));try{const Q=await Ve.updateIntakeField(e,W,$);if(!F.current)return;M(Q)}catch(Q){if(!F.current)return;N(Q.message||"Failed to update field");const se=await Ve.getIntakeState(e);F.current&&M(se)}}},[e,M]),B=m.useCallback(async()=>{if(!(!e||!_)){N(null),j(!0);try{const W=await Ve.initializeIntake(e);if(!F.current)return;M(W),W.phase==="generating"&&X()}catch(W){if(!F.current)return;N(W.message||"Failed to initialize project"),j(!1)}}},[e,_,M]),X=m.useCallback(()=>{I.current&&I.current.close();const W=p6(e);I.current=W,W.addEventListener("started",$=>{if(!F.current)return;const Q=JSON.parse($.data);console.log("Intake started:",Q)}),W.addEventListener("progress",$=>{if(!F.current)return;const Q=JSON.parse($.data);console.log("Intake progress:",Q.current_node)}),W.addEventListener("complete",async $=>{if(!F.current)return;const Q=JSON.parse($.data);console.log("Intake complete:",Q),W.close(),I.current=null,n("complete"),b(Q.gate_outcome),S(Q.project),j(!1)}),W.addEventListener("error",$=>{if(F.current&&W.readyState!==EventSource.CLOSED){try{const Q=JSON.parse($.data);N(Q.message||"Generation failed")}catch{N("Connection lost during generation")}W.close(),I.current=null,j(!1)}}),W.onerror=()=>{F.current&&W.readyState===EventSource.CLOSED&&(I.current=null,j(!1))}},[e]),Y=m.useCallback(()=>{I.current&&(I.current.close(),I.current=null),t(null),n("idle"),s([]),l(null),d(null),f({}),h(0),v([]),g(!1),b(null),S(null),N(null),j(!1),T(!1)},[]);return{executionId:e,phase:r,messages:i,pendingPrompt:o,pendingChoices:c,interpretation:u,confidence:p,missingFields:x,canInitialize:_,gateOutcome:y,project:w,error:k,loading:E,submitting:R,intakeClassification:D,intakeGatePhase:C,startIntake:A,submitMessage:L,updateField:z,lockAndGenerate:B,reset:Y}}const $T=m.createContext(null);function J$({children:e}){const[t,r]=m.useState(null),[n,i]=m.useState(!0),[s,o]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{i(!0),o(null);try{const f=await Ve.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),o(f.message),r(null)}finally{i(!1)}},[]),c=m.useCallback(f=>{window.location.href=h6(f)},[]),d=m.useCallback(async()=>{try{await Ve.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),u={user:t,loading:n,error:s,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return a.jsx($T.Provider,{value:u,children:e})}function Ls(){const e=m.useContext($T);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function eB(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useCallback(async()=>{s(!0),l(null);try{let u=await we.getCurrentWorkspace();u||(u=await we.createWorkspace()),t(u.workspace_id),n(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{s(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await we.closeWorkspace(e,u),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:i,error:o,closeWorkspace:d,reinitialize:c}}function tB(e,t=1e4){var u,f;const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){n(null),s(!1);return}try{const p=await we.getWorkspaceState(e);n(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{s(!1)}},[e]);return m.useEffect(()=>{e&&(s(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:r,loading:i,error:o,refresh:d,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((u=r==null?void 0:r.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function rB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await we.getDocumentTypes();t(l.document_types||[])}catch(l){s(l.message),console.error("Failed to fetch document types:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{documentTypes:e,loading:r,error:i,refresh:o}}function nB(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await we.getRoles();t(l.roles||[])}catch(l){s(l.message),console.error("Failed to fetch roles:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{roles:e,loading:r,error:i,refresh:o}}function Na(e,t,{debounceMs:r=500,onSave:n}={}){const[i,s]=m.useState(""),[o,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,v]=m.useState(null),_=m.useRef(null),g=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(""),l(""),d(!1);return}d(!0),f(null);try{const E=await we.getArtifact(e,t);s(E.content),l(E.content)}catch(E){f(E.message),console.error("Failed to load artifact:",E)}finally{d(!1)}},[e,t]),b=m.useCallback(async E=>{if(!(!e||!t)){h(!0),f(null);try{const j=await we.writeArtifact(e,t,E);v(j),l(E),n&&n(j)}catch(j){f(j.message),console.error("Failed to save artifact:",j)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(E=>{g.current=E,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),S=m.useCallback(E=>{s(E),E!==o&&w(E)},[o,w]),k=m.useCallback(()=>{_.current&&clearTimeout(_.current),g.current=null,s(o)},[o]),N=m.useCallback(()=>{_.current&&clearTimeout(_.current),i!==o&&b(i)},[i,o,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{content:i,originalContent:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateContent:S,reset:k,saveNow:N,reload:y}}const iB={documentNode:D6,waypoint:L6},sB={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function oB({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:i,theme:s,onThemeChange:o,onProjectUpdate:l,onProjectArchive:c,onProjectUnarchive:d,onProjectDelete:u}){const{data:f,lineState:p,loading:h,error:x,connected:v,resolveInterrupt:_}=Q$(e),[g,y]=m.useState([]),[b,w]=m.useState(null),[S,k]=m.useState(null),[N,E]=m.useState(null),[j,R]=m.useState(!1),[T,D]=m.useState(""),[q,C]=m.useState(!1),[O,I]=m.useState(!1),[F,M]=m.useState(!1),A=Qc();m.useEffect(()=>{f.length>0&&y(f)},[f]),m.useEffect(()=>{i&&g.length>0&&setTimeout(()=>{w(i),k("questions")},300)},[i,g.length]),m.useEffect(()=>{w(null),k(null)},[e]);const L=m.useCallback(()=>{const K=An.indexOf(s);o(An[(K+1)%An.length])},[s,o]),z=m.useCallback(()=>{D(r||""),R(!0)},[r]),B=m.useCallback(async()=>{if(!T.trim()||T===r){R(!1);return}I(!0);try{await l(e,{name:T.trim()}),R(!1)}catch(K){console.error("Failed to update name:",K)}finally{I(!1)}},[T,r,e,l]),X=m.useCallback(()=>{R(!1),D("")},[]),Y=m.useCallback(async()=>{I(!0);try{n?await d(e):await c(e)}catch(K){console.error("Failed to toggle archive:",K)}finally{I(!1)}},[e,n,c,d]),W=m.useCallback(async()=>{I(!0);try{await u(e),C(!1)}catch(K){console.error("Failed to delete:",K)}finally{I(!1)}},[e,u]),$=m.useCallback(K=>{const J=A.getNode(K);if(J){const fe=window.innerWidth,be=-J.position.x*.9+fe/2-400,xe=-J.position.y*.9+120;A.setViewport({x:be,y:xe,zoom:.9},{duration:800})}},[A]),Q=m.useMemo(()=>({onExpand:(K,J)=>{w(K),k(J)},onCollapse:()=>{w(null),k(null),setTimeout(()=>A.fitView({padding:.2,duration:300}),50)},onViewFullDocument:K=>{E(K)},onSubmitQuestions:async(K,J)=>{console.log("Submitted:",K,J);const pe=g.find(fe=>fe.id===K);if(pe!=null&&pe.interruptId)try{await _(pe.interruptId,J)}catch(fe){console.error("Failed to submit answers:",fe)}w(null),k(null),y(fe=>{const be=xe=>xe.map(re=>re.id===K&&re.stations?{...re,stations:re.stations.map(he=>he.id==="pgc"?{...he,state:"complete",needs_input:!1}:he.id==="asm"?{...he,state:"active"}:he)}:re.children?{...re,children:be(re.children)}:re);return be(fe)})}}),[A,g,_]),{layoutNodes:se,layoutEdges:ae}=m.useMemo(()=>{if(g.length===0)return{layoutNodes:[],layoutEdges:[]};const K={...Q,expandType:S,theme:s,onZoomToNode:$,projectId:e,projectCode:t},{nodes:J,edges:pe,epicBacklogId:fe,epicChildren:be}=Wj(g,b,K),xe=Hj(J,pe),{nodes:re,edges:he}=Uj(xe,fe,be,b,K);return{layoutNodes:re.map(Fe=>({...Fe,data:{...Fe.data,expandType:Fe.id===b?S:null}})),layoutEdges:he}},[g,b,S,Q,s,$,e,t]),[ee,_e,me]=gE(se),[je,ve,oe]=xE(ae);m.useEffect(()=>{if(g.length===0)return;const K={...Q,expandType:S,theme:s,onZoomToNode:$,projectId:e,projectCode:t},{nodes:J,edges:pe,epicBacklogId:fe,epicChildren:be}=Wj(g,b,K),xe=Hj(J,pe),{nodes:re,edges:he}=Uj(xe,fe,be,b,K),Ke=re.map(Fe=>({...Fe,data:{...Fe.data,expandType:Fe.id===b?S:null}}));_e(Ke),ve(he)},[g,b,S,Q,_e,ve,s,$,e,t]);const G=m.useCallback((K,J)=>{},[]);return h&&g.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):x&&g.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:a.jsx("p",{className:"text-red-500 mb-4",children:x})})}):a.jsxs("div",{className:"w-full h-full",children:[a.jsxs(ey,{nodes:ee,edges:je,onNodesChange:me,onEdgesChange:oe,onNodeClick:G,nodeTypes:iB,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[a.jsx(Hn,{position:"top-left",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),a.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[p==="active"&&a.jsx("span",{className:"text-amber-500",children:" Active"}),p==="stopped"&&a.jsx("span",{className:"text-red-500",children:" Stopped"}),p==="complete"&&a.jsx("span",{className:"text-emerald-500",children:" Complete"}),p==="idle"&&a.jsx("span",{children:" Idle"}),!v&&a.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),a.jsx("button",{onClick:L,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:sB[s]})]})}),a.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:a.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),j?a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("input",{type:"text",value:T,onChange:K=>D(K.target.value),onKeyDown:K=>{K.key==="Enter"&&B(),K.key==="Escape"&&X()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:O}),a.jsx("button",{onClick:B,disabled:O,className:"p-1 rounded hover:bg-white/10",title:"Save",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{onClick:X,disabled:O,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:a.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!j&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:z,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),a.jsx("button",{onClick:Y,disabled:O,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:a.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&a.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),a.jsx("button",{onClick:()=>C(!0),disabled:O||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[a.jsxs("button",{onClick:()=>M(!F),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[a.jsx("span",{children:"Workflow"}),a.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:F?"":""})]}),F&&a.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:a.jsx(H6,{projectId:e})})]})]})}),a.jsx(_E,{position:"top-right",nodeColor:K=>{var pe;const J=(pe=K.data)==null?void 0:pe.state;return["produced","stabilized","ready"].includes(J)?"#10b981":["in_production","active"].includes(J)?"#f59e0b":["requirements_not_met","blocked"].includes(J)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hn,{position:"bottom-left",children:a.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[a.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),a.jsx(Hn,{position:"bottom-right",children:a.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),N&&a.jsx(F6,{projectId:e,projectCode:t,docTypeId:N,onClose:()=>E(null)}),q&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:a.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),a.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",a.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),a.jsxs("div",{className:"flex gap-3 justify-end",children:[a.jsx("button",{onClick:()=>C(!1),disabled:O,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{onClick:W,disabled:O,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:O?"Deleting...":"Delete"})]})]})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function BT(e){return typeof e>"u"||e===null}function aB(e){return typeof e=="object"&&e!==null}function lB(e){return Array.isArray(e)?e:BT(e)?[]:[e]}function cB(e,t){var r,n,i,s;if(t)for(s=Object.keys(t),r=0,n=s.length;r<n;r+=1)i=s[r],e[i]=t[i];return e}function uB(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function dB(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var fB=BT,pB=aB,hB=lB,mB=uB,vB=dB,gB=cB,dt={isNothing:fB,isObject:pB,toArray:hB,repeat:mB,isNegativeZero:vB,extend:gB};function HT(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function oa(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=HT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}oa.prototype=Object.create(Error.prototype);oa.prototype.constructor=oa;oa.prototype.toString=function(t){return this.name+": "+HT(this,t)};var Dt=oa;function sv(e,t,r,n,i){var s="",o="",l=Math.floor(i/2)-1;return n-t>l&&(s=" ... ",t=n-l+s.length),r-n>l&&(o=" ...",r=n+l-o.length),{str:s+e.slice(t,r).replace(/\t/g,"")+o,pos:n-t+s.length}}function ov(e,t){return dt.repeat(" ",t-e.length)+e}function xB(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],s,o=-1;s=r.exec(e.buffer);)i.push(s.index),n.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=n.length-2);o<0&&(o=n.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)d=sv(e.buffer,n[o-c],i[o-c],e.position-(n[o]-n[o-c]),f),l=dt.repeat(" ",t.indent)+ov((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=sv(e.buffer,n[o],i[o],e.position,f),l+=dt.repeat(" ",t.indent)+ov((e.line+1).toString(),u)+" | "+d.str+`
`,l+=dt.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)d=sv(e.buffer,n[o+c],i[o+c],e.position-(n[o]-n[o+c]),f),l+=dt.repeat(" ",t.indent)+ov((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var yB=xB,bB=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],_B=["scalar","sequence","mapping"];function wB(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function jB(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(bB.indexOf(r)===-1)throw new Dt('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=wB(t.styleAliases||null),_B.indexOf(this.kind)===-1)throw new Dt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var St=jB;function Kj(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(s,o){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(i=o)}),r[i]=n}),r}function SB(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function Pg(e){return this.extend(e)}Pg.prototype.extend=function(t){var r=[],n=[];if(t instanceof St)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new Dt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof St))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new Dt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Dt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof St))throw new Dt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Pg.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=Kj(i,"implicit"),i.compiledExplicit=Kj(i,"explicit"),i.compiledTypeMap=SB(i.compiledImplicit,i.compiledExplicit),i};var WT=Pg,UT=new St("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),VT=new St("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),GT=new St("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),KT=new WT({explicit:[UT,VT,GT]});function kB(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function NB(){return null}function CB(e){return e===null}var YT=new St("tag:yaml.org,2002:null",{kind:"scalar",resolve:kB,construct:NB,predicate:CB,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function EB(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function TB(e){return e==="true"||e==="True"||e==="TRUE"}function RB(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var XT=new St("tag:yaml.org,2002:bool",{kind:"scalar",resolve:EB,construct:TB,predicate:RB,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function AB(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function IB(e){return 48<=e&&e<=55}function MB(e){return 48<=e&&e<=57}function PB(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!AB(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!IB(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!MB(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function OB(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function DB(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!dt.isNegativeZero(e)}var QT=new St("tag:yaml.org,2002:int",{kind:"scalar",resolve:PB,construct:OB,predicate:DB,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),LB=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function FB(e){return!(e===null||!LB.test(e)||e[e.length-1]==="_")}function zB(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var qB=/^[-+]?[0-9]+e/;function $B(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(dt.isNegativeZero(e))return"-0.0";return r=e.toString(10),qB.test(r)?r.replace("e",".e"):r}function BB(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||dt.isNegativeZero(e))}var ZT=new St("tag:yaml.org,2002:float",{kind:"scalar",resolve:FB,construct:zB,predicate:BB,represent:$B,defaultStyle:"lowercase"}),JT=KT.extend({implicit:[YT,XT,QT,ZT]}),e4=JT,t4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),r4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function HB(e){return e===null?!1:t4.exec(e)!==null||r4.exec(e)!==null}function WB(e){var t,r,n,i,s,o,l,c=0,d=null,u,f,p;if(t=t4.exec(e),t===null&&(t=r4.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(s=+t[4],o=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(r,n,i,s,o,l,c)),d&&p.setTime(p.getTime()-d),p}function UB(e){return e.toISOString()}var n4=new St("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:HB,construct:WB,instanceOf:Date,represent:UB});function VB(e){return e==="<<"||e===null}var i4=new St("tag:yaml.org,2002:merge",{kind:"scalar",resolve:VB}),wy=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function GB(e){if(e===null)return!1;var t,r,n=0,i=e.length,s=wy;for(r=0;r<i;r++)if(t=s.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function KB(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,s=wy,o=0,l=[];for(t=0;t<i;t++)t%4===0&&t&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|s.indexOf(n.charAt(t));return r=i%4*6,r===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):r===18?(l.push(o>>10&255),l.push(o>>2&255)):r===12&&l.push(o>>4&255),new Uint8Array(l)}function YB(e){var t="",r=0,n,i,s=e.length,o=wy;for(n=0;n<s;n++)n%3===0&&n&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[n];return i=s%3,i===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):i===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):i===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function XB(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var s4=new St("tag:yaml.org,2002:binary",{kind:"scalar",resolve:GB,construct:KB,predicate:XB,represent:YB}),QB=Object.prototype.hasOwnProperty,ZB=Object.prototype.toString;function JB(e){if(e===null)return!0;var t=[],r,n,i,s,o,l=e;for(r=0,n=l.length;r<n;r+=1){if(i=l[r],o=!1,ZB.call(i)!=="[object Object]")return!1;for(s in i)if(QB.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function e9(e){return e!==null?e:[]}var o4=new St("tag:yaml.org,2002:omap",{kind:"sequence",resolve:JB,construct:e9}),t9=Object.prototype.toString;function r9(e){if(e===null)return!0;var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(n=o[t],t9.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;s[t]=[i[0],n[i[0]]]}return!0}function n9(e){if(e===null)return[];var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1)n=o[t],i=Object.keys(n),s[t]=[i[0],n[i[0]]];return s}var a4=new St("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:r9,construct:n9}),i9=Object.prototype.hasOwnProperty;function s9(e){if(e===null)return!0;var t,r=e;for(t in r)if(i9.call(r,t)&&r[t]!==null)return!1;return!0}function o9(e){return e!==null?e:{}}var l4=new St("tag:yaml.org,2002:set",{kind:"mapping",resolve:s9,construct:o9}),jy=e4.extend({implicit:[n4,i4],explicit:[s4,o4,a4,l4]}),Xn=Object.prototype.hasOwnProperty,vc=1,c4=2,u4=3,gc=4,av=1,a9=2,Yj=3,l9=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,c9=/[\x85\u2028\u2029]/,u9=/[,\[\]\{\}]/,d4=/^(?:!|!!|![a-z\-]+!)$/i,f4=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Xj(e){return Object.prototype.toString.call(e)}function Wr(e){return e===10||e===13}function yi(e){return e===9||e===32}function Wt(e){return e===9||e===32||e===10||e===13}function is(e){return e===44||e===91||e===93||e===123||e===125}function d9(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function f9(e){return e===120?2:e===117?4:e===85?8:0}function p9(e){return 48<=e&&e<=57?e-48:-1}function Qj(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function h9(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function p4(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var h4=new Array(256),m4=new Array(256);for(var zi=0;zi<256;zi++)h4[zi]=Qj(zi)?1:0,m4[zi]=Qj(zi);function m9(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||jy,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function v4(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=yB(r),new Dt(t,r)}function de(e,t){throw v4(e,t)}function xc(e,t){e.onWarning&&e.onWarning.call(null,v4(e,t))}var Zj={YAML:function(t,r,n){var i,s,o;t.version!==null&&de(t,"duplication of %YAML directive"),n.length!==1&&de(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&de(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&de(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&xc(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,s;n.length!==2&&de(t,"TAG directive accepts exactly two arguments"),i=n[0],s=n[1],d4.test(i)||de(t,"ill-formed tag handle (first argument) of the TAG directive"),Xn.call(t.tagMap,i)&&de(t,'there is a previously declared suffix for "'+i+'" tag handle'),f4.test(s)||de(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{de(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function Vn(e,t,r,n){var i,s,o,l;if(t<r){if(l=e.input.slice(t,r),n)for(i=0,s=l.length;i<s;i+=1)o=l.charCodeAt(i),o===9||32<=o&&o<=1114111||de(e,"expected valid JSON character");else l9.test(l)&&de(e,"the stream contains non-printable characters");e.result+=l}}function Jj(e,t,r,n){var i,s,o,l;for(dt.isObject(r)||de(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),o=0,l=i.length;o<l;o+=1)s=i[o],Xn.call(t,s)||(p4(t,s,r[s]),n[s]=!0)}function ss(e,t,r,n,i,s,o,l,c){var d,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),d=0,u=i.length;d<u;d+=1)Array.isArray(i[d])&&de(e,"nested arrays are not supported inside keys"),typeof i=="object"&&Xj(i[d])==="[object Object]"&&(i[d]="[object Object]");if(typeof i=="object"&&Xj(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(d=0,u=s.length;d<u;d+=1)Jj(e,t,s[d],r);else Jj(e,t,s,r);else!e.json&&!Xn.call(r,i)&&Xn.call(t,i)&&(e.line=o||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,de(e,"duplicated mapping key")),p4(t,i,s),delete r[i];return t}function Sy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):de(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function st(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;yi(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(Wr(i))for(Sy(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&xc(e,"deficient indentation"),n}function xu(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Wt(r)))}function ky(e,t){t===1?e.result+=" ":t>1&&(e.result+=dt.repeat(`
`,t-1))}function v9(e,t,r){var n,i,s,o,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Wt(h)||is(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(i=e.input.charCodeAt(e.position+1),Wt(i)||r&&is(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,l=!1;h!==0;){if(h===58){if(i=e.input.charCodeAt(e.position+1),Wt(i)||r&&is(i))break}else if(h===35){if(n=e.input.charCodeAt(e.position-1),Wt(n))break}else{if(e.position===e.lineStart&&xu(e)||r&&is(h))break;if(Wr(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,st(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Vn(e,s,o,!1),ky(e,e.line-c),s=o=e.position,l=!1),yi(h)||(o=e.position+1),h=e.input.charCodeAt(++e.position)}return Vn(e,s,o,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function g9(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Vn(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else Wr(r)?(Vn(e,n,i,!0),ky(e,st(e,!1,t)),n=i=e.position):e.position===e.lineStart&&xu(e)?de(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);de(e,"unexpected end of the stream within a single quoted scalar")}function x9(e,t){var r,n,i,s,o,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Vn(e,r,e.position,!0),e.position++,!0;if(l===92){if(Vn(e,r,e.position,!0),l=e.input.charCodeAt(++e.position),Wr(l))st(e,!1,t);else if(l<256&&h4[l])e.result+=m4[l],e.position++;else if((o=f9(l))>0){for(i=o,s=0;i>0;i--)l=e.input.charCodeAt(++e.position),(o=d9(l))>=0?s=(s<<4)+o:de(e,"expected hexadecimal character");e.result+=h9(s),e.position++}else de(e,"unknown escape sequence");r=n=e.position}else Wr(l)?(Vn(e,r,n,!0),ky(e,st(e,!1,t)),r=n=e.position):e.position===e.lineStart&&xu(e)?de(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}de(e,"unexpected end of the stream within a double quoted scalar")}function y9(e,t){var r=!0,n,i,s,o=e.tag,l,c=e.anchor,d,u,f,p,h,x=Object.create(null),v,_,g,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(st(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=o,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;r?y===44&&de(e,"expected the node content, but found ','"):de(e,"missed comma between flow collection entries"),_=v=g=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Wt(d)&&(f=p=!0,e.position++,st(e,!0,t))),n=e.line,i=e.lineStart,s=e.position,Cs(e,t,vc,!1,!0),_=e.tag,v=e.result,st(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===n)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),st(e,!0,t),Cs(e,t,vc,!1,!0),g=e.result),h?ss(e,l,x,_,v,g,n,i,s):f?l.push(ss(e,null,x,_,v,g,n,i,s)):l.push(v),st(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}de(e,"unexpected end of the stream within a flow collection")}function b9(e,t){var r,n,i=av,s=!1,o=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)av===i?i=f===43?Yj:a9:de(e,"repeat of a chomping mode identifier");else if((u=p9(f))>=0)u===0?de(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?de(e,"repeat of an indentation width identifier"):(l=t+u-1,o=!0);else break;if(yi(f)){do f=e.input.charCodeAt(++e.position);while(yi(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Wr(f)&&f!==0)}for(;f!==0;){for(Sy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>l&&(l=e.lineIndent),Wr(f)){c++;continue}if(e.lineIndent<l){i===Yj?e.result+=dt.repeat(`
`,s?1+c:c):i===av&&s&&(e.result+=`
`);break}for(n?yi(f)?(d=!0,e.result+=dt.repeat(`
`,s?1+c:c)):d?(d=!1,e.result+=dt.repeat(`
`,c+1)):c===0?s&&(e.result+=" "):e.result+=dt.repeat(`
`,c):e.result+=dt.repeat(`
`,s?1+c:c),s=!0,o=!0,c=0,r=e.position;!Wr(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Vn(e,r,e.position,!1)}return!0}function eS(e,t){var r,n=e.tag,i=e.anchor,s=[],o,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,de(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!Wt(o))));){if(l=!0,e.position++,st(e,!0,-1)&&e.lineIndent<=t){s.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,Cs(e,t,u4,!1,!0),s.push(e.result),st(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)de(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function _9(e,t,r){var n,i,s,o,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,x=null,v=null,_=!1,g=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!_&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,de(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),s=e.line,(y===63||y===58)&&Wt(n))y===63?(_&&(ss(e,f,p,h,x,null,o,l,c),h=x=v=null),g=!0,_=!0,i=!0):_?(_=!1,i=!0):de(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=n;else{if(o=e.line,l=e.lineStart,c=e.position,!Cs(e,r,c4,!1,!0))break;if(e.line===s){for(y=e.input.charCodeAt(e.position);yi(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Wt(y)||de(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(ss(e,f,p,h,x,null,o,l,c),h=x=v=null),g=!0,_=!1,i=!1,h=e.tag,x=e.result;else if(g)de(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(g)de(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===s||e.lineIndent>t)&&(_&&(o=e.line,l=e.lineStart,c=e.position),Cs(e,t,gc,!0,i)&&(_?x=e.result:v=e.result),_||(ss(e,f,p,h,x,v,o,l,c),h=x=v=null),st(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&y!==0)de(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&ss(e,f,p,h,x,null,o,l,c),g&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),g}function w9(e){var t,r=!1,n=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&de(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(n=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):de(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Wt(o);)o===33&&(n?de(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),d4.test(i)||de(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),u9.test(s)&&de(e,"tag suffix cannot contain flow indicator characters")}s&&!f4.test(s)&&de(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{de(e,"tag name is malformed: "+s)}return r?e.tag=s:Xn.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:de(e,'undeclared tag handle "'+i+'"'),!0}function j9(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&de(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Wt(r)&&!is(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&de(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function S9(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Wt(n)&&!is(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&de(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Xn.call(e.anchorMap,r)||de(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],st(e,!0,-1),!0}function Cs(e,t,r,n,i){var s,o,l,c=1,d=!1,u=!1,f,p,h,x,v,_;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=l=gc===r||u4===r,n&&st(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;w9(e)||j9(e);)st(e,!0,-1)?(d=!0,l=s,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||i),(c===1||gc===r)&&(vc===r||c4===r?v=t:v=t+1,_=e.position-e.lineStart,c===1?l&&(eS(e,_)||_9(e,_,v))||y9(e,v)?u=!0:(o&&b9(e,v)||g9(e,v)||x9(e,v)?u=!0:S9(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&de(e,"alias node should not have any properties")):v9(e,v,vc===r)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&eS(e,_))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&de(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(x=e.implicitTypes[f],x.resolve(e.result)){e.result=x.construct(e.result),e.tag=x.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xn.call(e.typeMap[e.kind||"fallback"],e.tag))x=e.typeMap[e.kind||"fallback"][e.tag];else for(x=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){x=h[f];break}x||de(e,"unknown tag !<"+e.tag+">"),e.result!==null&&x.kind!==e.kind&&de(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+x.kind+'", not "'+e.kind+'"'),x.resolve(e.result,e.tag)?(e.result=x.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):de(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function k9(e){var t=e.position,r,n,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(st(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!Wt(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&de(e,"directive name must not be less than one character in length");o!==0;){for(;yi(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Wr(o));break}if(Wr(o))break;for(r=e.position;o!==0&&!Wt(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}o!==0&&Sy(e),Xn.call(Zj,n)?Zj[n](e,n,i):xc(e,'unknown document directive "'+n+'"')}if(st(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,st(e,!0,-1)):s&&de(e,"directives end mark is expected"),Cs(e,e.lineIndent-1,gc,!1,!0),st(e,!0,-1),e.checkLineBreaks&&c9.test(e.input.slice(t,e.position))&&xc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&xu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,st(e,!0,-1));return}if(e.position<e.length-1)de(e,"end of the stream or a document separator is expected");else return}function g4(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new m9(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,de(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)k9(r);return r.documents}function N9(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=g4(e,r);if(typeof t!="function")return n;for(var i=0,s=n.length;i<s;i+=1)t(n[i])}function C9(e,t){var r=g4(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new Dt("expected a single document in the stream, but found more")}}var E9=N9,T9=C9,x4={loadAll:E9,load:T9},y4=Object.prototype.toString,b4=Object.prototype.hasOwnProperty,Ny=65279,R9=9,aa=10,A9=13,I9=32,M9=33,P9=34,Og=35,O9=37,D9=38,L9=39,F9=42,_4=44,z9=45,yc=58,q9=61,$9=62,B9=63,H9=64,w4=91,j4=93,W9=96,S4=123,U9=124,k4=125,Pt={};Pt[0]="\\0";Pt[7]="\\a";Pt[8]="\\b";Pt[9]="\\t";Pt[10]="\\n";Pt[11]="\\v";Pt[12]="\\f";Pt[13]="\\r";Pt[27]="\\e";Pt[34]='\\"';Pt[92]="\\\\";Pt[133]="\\N";Pt[160]="\\_";Pt[8232]="\\L";Pt[8233]="\\P";var V9=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],G9=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function K9(e,t){var r,n,i,s,o,l,c;if(t===null)return{};for(r={},n=Object.keys(t),i=0,s=n.length;i<s;i+=1)o=n[i],l=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&b4.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[o]=l;return r}function Y9(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new Dt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+dt.repeat("0",n-t.length)+t}var X9=1,la=2;function Q9(e){this.schema=e.schema||jy,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=dt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=K9(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?la:X9,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function tS(e,t){for(var r=dt.repeat(" ",t),n=0,i=-1,s="",o,l=e.length;n<l;)i=e.indexOf(`
`,n),i===-1?(o=e.slice(n),n=l):(o=e.slice(n,i+1),n=i+1),o.length&&o!==`
`&&(s+=r),s+=o;return s}function Dg(e,t){return`
`+dt.repeat(" ",e.indent*t)}function Z9(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function bc(e){return e===I9||e===R9}function ca(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Ny||65536<=e&&e<=1114111}function rS(e){return ca(e)&&e!==Ny&&e!==A9&&e!==aa}function nS(e,t,r){var n=rS(e),i=n&&!bc(e);return(r?n:n&&e!==_4&&e!==w4&&e!==j4&&e!==S4&&e!==k4)&&e!==Og&&!(t===yc&&!i)||rS(t)&&!bc(t)&&e===Og||t===yc&&i}function J9(e){return ca(e)&&e!==Ny&&!bc(e)&&e!==z9&&e!==B9&&e!==yc&&e!==_4&&e!==w4&&e!==j4&&e!==S4&&e!==k4&&e!==Og&&e!==D9&&e!==F9&&e!==M9&&e!==U9&&e!==q9&&e!==$9&&e!==L9&&e!==P9&&e!==O9&&e!==H9&&e!==W9}function eH(e){return!bc(e)&&e!==yc}function _o(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function N4(e){var t=/^\n* /;return t.test(e)}var C4=1,Lg=2,E4=3,T4=4,Hi=5;function tH(e,t,r,n,i,s,o,l){var c,d=0,u=null,f=!1,p=!1,h=n!==-1,x=-1,v=J9(_o(e,0))&&eH(_o(e,e.length-1));if(t||o)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=_o(e,c),!ca(d))return Hi;v=v&&nS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=_o(e,c),d===aa)f=!0,h&&(p=p||c-x-1>n&&e[x+1]!==" ",x=c);else if(!ca(d))return Hi;v=v&&nS(d,u,l),u=d}p=p||h&&c-x-1>n&&e[x+1]!==" "}return!f&&!p?v&&!o&&!i(e)?C4:s===la?Hi:Lg:r>9&&N4(e)?Hi:o?s===la?Hi:Lg:p?T4:E4}function rH(e,t,r,n,i){e.dump=function(){if(t.length===0)return e.quotingType===la?'""':"''";if(!e.noCompatMode&&(V9.indexOf(t)!==-1||G9.test(t)))return e.quotingType===la?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),l=n||e.flowLevel>-1&&r>=e.flowLevel;function c(d){return Z9(e,d)}switch(tH(t,l,e.indent,o,c,e.quotingType,e.forceQuotes&&!n,i)){case C4:return t;case Lg:return"'"+t.replace(/'/g,"''")+"'";case E4:return"|"+iS(t,e.indent)+sS(tS(t,s));case T4:return">"+iS(t,e.indent)+sS(tS(nH(t,o),s));case Hi:return'"'+iH(t)+'"';default:throw new Dt("impossible error: invalid scalar style")}}()}function iS(e,t){var r=N4(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),s=i?"+":n?"":"-";return r+s+`
`}function sS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function nH(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,r.lastIndex=d,oS(e.slice(0,d),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=r.exec(e);){var l=o[1],c=o[2];s=c[0]===" ",n+=l+(!i&&!s&&c!==""?`
`:"")+oS(c,t),i=s}return n}function oS(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,s,o=0,l=0,c="";n=r.exec(e);)l=n.index,l-i>t&&(s=o>i?o:l,c+=`
`+e.slice(i,s),i=s+1),o=l;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function iH(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=_o(e,i),n=Pt[r],!n&&ca(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||Y9(r);return t}function sH(e,t,r){var n="",i=e.tag,s,o,l;for(s=0,o=r.length;s<o;s+=1)l=r[s],e.replacer&&(l=e.replacer.call(r,String(s),l)),(vn(e,t,l,!1,!1)||typeof l>"u"&&vn(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function aS(e,t,r,n){var i="",s=e.tag,o,l,c;for(o=0,l=r.length;o<l;o+=1)c=r[o],e.replacer&&(c=e.replacer.call(r,String(o),c)),(vn(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&vn(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Dg(e,t)),e.dump&&aa===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function oH(e,t,r){var n="",i=e.tag,s=Object.keys(r),o,l,c,d,u;for(o=0,l=s.length;o<l;o+=1)u="",n!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=s[o],d=r[c],e.replacer&&(d=e.replacer.call(r,c,d)),vn(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),vn(e,t,d,!1,!1)&&(u+=e.dump,n+=u));e.tag=i,e.dump="{"+n+"}"}function aH(e,t,r,n){var i="",s=e.tag,o=Object.keys(r),l,c,d,u,f,p;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new Dt("sortKeys must be a boolean or a function");for(l=0,c=o.length;l<c;l+=1)p="",(!n||i!=="")&&(p+=Dg(e,t)),d=o[l],u=r[d],e.replacer&&(u=e.replacer.call(r,d,u)),vn(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&aa===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Dg(e,t)),vn(e,t+1,u,!0,f)&&(e.dump&&aa===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,i+=p));e.tag=s,e.dump=i||"{}"}function lS(e,t,r){var n,i,s,o,l,c;for(i=r?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(l=i[s],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(r?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,y4.call(l.represent)==="[object Function]")n=l.represent(t,c);else if(b4.call(l.represent,c))n=l.represent[c](t,c);else throw new Dt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function vn(e,t,r,n,i,s,o){e.tag=null,e.dump=r,lS(e,r,!1)||lS(e,r,!0);var l=y4.call(e.dump),c=n,d;n&&(n=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(r),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(i=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")n&&Object.keys(e.dump).length!==0?(aH(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(oH(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?aS(e,t-1,e.dump,i):aS(e,t,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(sH(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&rH(e,e.dump,t,s,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Dt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function lH(e,t){var r=[],n=[],i,s;for(Fg(e,r,n),i=0,s=n.length;i<s;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(s)}function Fg(e,t,r){var n,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Fg(e[i],t,r);else for(n=Object.keys(e),i=0,s=n.length;i<s;i+=1)Fg(e[n[i]],t,r)}function cH(e,t){t=t||{};var r=new Q9(t);r.noRefs||lH(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),vn(r,0,n,!0,!0)?r.dump+`
`:""}var uH=cH,dH={dump:uH};function Cy(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var fH=St,pH=WT,hH=KT,mH=JT,vH=e4,gH=jy,xH=x4.load,yH=x4.loadAll,bH=dH.dump,_H=Dt,wH={binary:s4,float:ZT,map:GT,null:YT,pairs:a4,set:l4,timestamp:n4,bool:XT,int:QT,merge:i4,omap:o4,seq:VT,str:UT},jH=Cy("safeLoad","load"),SH=Cy("safeLoadAll","loadAll"),kH=Cy("safeDump","dump"),Ey={Type:fH,Schema:pH,FAILSAFE_SCHEMA:hH,JSON_SCHEMA:mH,CORE_SCHEMA:vH,DEFAULT_SCHEMA:gH,load:xH,loadAll:yH,dump:bH,YAMLException:_H,types:wH,safeLoad:jH,safeLoadAll:SH,safeDump:kH};function cS({messages:e,pendingPrompt:t,introContent:r}){const n=m.useRef(null);return m.useEffect(()=>{var i;(i=n.current)==null||i.scrollIntoView({behavior:"smooth"})},[e,t]),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[r,e.map((i,s)=>a.jsx("div",{className:`flex ${i.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${i.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:i.content})},s)),t&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),a.jsx("div",{ref:n})]})}function NH({onSubmit:e,disabled:t,placeholder:r}){const[n,i]=m.useState(""),s=m.useRef(null);m.useEffect(()=>{var c;t||(c=s.current)==null||c.focus()},[t]);const o=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),i("")))},l=()=>{n.trim()&&!t&&(e(n.trim()),i(""))};return a.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("textarea",{ref:s,value:n,onChange:c=>i(c.target.value),onKeyDown:o,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),a.jsx("button",{onClick:l,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),a.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const uS={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function CH({type:e,className:t}){switch(e){case"check":return a.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 9v4M12 17h.01"}),a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function EH({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const i=uS[e]||uS.blocked,s=e==="qualified";return a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:`w-16 h-16 rounded-full ${i.iconBg} flex items-center justify-center mx-auto mb-4`,children:a.jsx(CH,{type:i.icon,className:`w-8 h-8 ${i.iconColor}`})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:i.title}),a.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:i.description}),s&&t&&a.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[a.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),a.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[s&&t&&a.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),a.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function TH({operation:e,context:t,onSubmit:r,onCancel:n}){var x;const[i,s]=m.useState("confirm"),[o,l]=m.useState((t==null?void 0:t.project_type)||""),[c,d]=m.useState(""),f=((e==null?void 0:e.config)||{}).entry_prompt||"Review the intake classification.",p=[{value:"greenfield",label:"Greenfield (New Project)"},{value:"enhancement",label:"Enhancement (Existing Project)"},{value:"migration",label:"Migration"},{value:"integration",label:"Integration"},{value:"unknown",label:"Unknown / Other"}],h=()=>{const v={confirmed:i==="confirm",timestamp:new Date().toISOString()};i==="correct"&&(v.corrected_project_type=o),c.trim()&&(v.notes=c.trim()),r(v)};return a.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-green, #22c55e)",color:"#fff"},children:"Intake"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Concierge Entry"}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirm or correct the intake classification"})]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsx("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:a.jsx("div",{className:"text-sm",style:{color:"var(--text-primary)"},children:f})}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirmation requested"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Classification Result"}),a.jsxs("div",{className:"p-4 rounded space-y-3",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Intent Classification"}),a.jsx("span",{className:"px-3 py-1 rounded font-semibold",style:{background:"var(--accent-primary, #3b82f6)",color:"#fff",fontSize:12},children:((x=t==null?void 0:t.project_type)==null?void 0:x.replace(/_/g," ").toUpperCase())||"Unknown"})]}),(t==null?void 0:t.artifact_type)&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Artifact Type"}),a.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.artifact_type.replace(/_/g," ")})]}),(t==null?void 0:t.audience)&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Audience"}),a.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.audience})]}),(t==null?void 0:t.intake_summary)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Summary"}),a.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.intake_summary})]}),(t==null?void 0:t.classification_rationale)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Rationale"}),a.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:t.classification_rationale})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Your Decision"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>s("confirm"),className:"flex-1 p-4 rounded text-left",style:{background:i==="confirm"?"rgba(34, 197, 94, 0.1)":"var(--bg-panel)",border:i==="confirm"?"2px solid #22c55e":"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Confirm"}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"The classification is correct"})]}),a.jsxs("button",{onClick:()=>s("correct"),className:"flex-1 p-4 rounded text-left",style:{background:i==="correct"?"rgba(249, 115, 22, 0.1)":"var(--bg-panel)",border:i==="correct"?"2px solid #f97316":"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Correct"}),a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"I need to change the classification before proceeding"})]})]})]}),i==="correct"&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Correct Intent Classification"}),a.jsxs("select",{value:o,onChange:v=>l(v.target.value),className:"w-full p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[a.jsx("option",{value:"",children:"Select intent classification..."}),p.map(v=>a.jsx("option",{value:v.value,children:v.label},v.value))]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Notes (Optional)"}),a.jsx("textarea",{value:c,onChange:v=>d(v.target.value),placeholder:"Add any additional context or notes...",className:"w-full p-3 rounded text-sm",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:80,resize:"vertical"}})]})]})}),a.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[n&&a.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:"Cancel"}),a.jsx("button",{onClick:h,disabled:i==="correct"&&!o,className:"px-4 py-2 rounded text-sm font-semibold",style:{background:i==="confirm"?"#22c55e":"#f97316",color:"#fff",opacity:i==="correct"&&!o?.5:1},children:i==="confirm"?"Confirm Classification":"Submit Correction"})]})]})}function RH({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:i,gateOutcome:s,project:o,error:l,loading:c,submitting:d,intakeClassification:u,intakeGatePhase:f,startIntake:p,submitMessage:h,reset:x}=Z$(),[v,_]=m.useState(null);m.useEffect(()=>(p(),fetch("/content/concierge-intro.yaml").then(k=>k.text()).then(k=>_(Ey.load(k))).catch(k=>console.error("Failed to load intro content:",k)),()=>x()),[]);const g=()=>{x(),e()},y=()=>{o&&t&&t(o),g()},b=k=>{h(JSON.stringify(k))},w=()=>{const k=[{id:"describe",label:"Describe"},{id:"confirm",label:"Confirm"},{id:"complete",label:"Done"}];let N=r;f==="awaiting_confirmation"&&(N="confirm"),(N==="review"||N==="generating")&&(N="complete");const E=k.findIndex(j=>j.id===N);return a.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:k.map((j,R)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 py-0.5 rounded ${R===E?"bg-violet-500/30 text-violet-300":R<E?"text-emerald-400":"text-slate-500"}`,children:j.label}),R<k.length-1&&a.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},j.id))})},S=()=>{var k;if(c&&r==="idle")return a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});if(f==="awaiting_confirmation"&&u)return a.jsx(TH,{operation:{config:{entry_prompt:i}},context:u,onSubmit:b,onCancel:g});switch(r){case"describe":const N=v?a.jsxs("div",{className:"mb-4 pb-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h3",{className:"text-base font-semibold mb-3",style:{color:"var(--text-primary)"},children:v.title}),a.jsx("div",{className:"text-sm space-y-3",style:{color:"var(--text-secondary)"},children:(k=v.paragraphs)==null?void 0:k.map((E,j)=>a.jsx("p",{children:E},j))}),v.call_to_action&&a.jsx("p",{className:"text-sm font-medium mt-4",style:{color:"var(--text-primary)"},children:v.call_to_action})]}):null;return a.jsxs(a.Fragment,{children:[a.jsx(cS,{messages:n,pendingPrompt:i,introContent:N}),a.jsx(NH,{onSubmit:h,disabled:d,placeholder:"Describe what you want to build..."})]});case"complete":return a.jsxs(a.Fragment,{children:[a.jsx(cS,{messages:n}),a.jsx(EH,{gateOutcome:s,project:o,onViewProject:y,onClose:g})]});default:return null}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:a.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),w()]})]}),a.jsx("button",{onClick:g,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l&&a.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:l}),S()]})})}function AH({onClose:e}){const{user:t,logout:r,isAdmin:n}=Ls(),[i,s]=m.useState(null),[o,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{i==="linked"&&p()},[i]);const p=async()=>{try{d(!0);const S=await fetch("/auth/accounts",{credentials:"include"});if(S.ok){const k=await S.json();l(k.identities||[])}}catch(S){console.error("Failed to load accounts:",S)}finally{d(!1)}},h=S=>{window.location.href=`/auth/accounts/link/${S}`},x=async S=>{var k;if(o.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${S} account?`))try{const N=(k=document.cookie.split("; ").find(j=>j.startsWith("csrf=")||j.startsWith("__Host-csrf=")))==null?void 0:k.split("=")[1],E=await fetch(`/auth/accounts/${S}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(E.ok)f({type:"success",text:"Account unlinked"}),await p();else{const j=await E.json();throw new Error(j.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},v=async()=>{await r(),e()},_=S=>{s(i===S?null:S),f(null)},g={google:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=S=>{const k={user:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),a.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return k[S]||k.user},w=S=>{switch(S){case"account":return a.jsxs("div",{className:"px-4 py-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),a.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return a.jsxs("div",{className:"px-4 py-3",children:[u&&a.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-2 mb-4",children:o.map(k=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[g[k.provider_id],a.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:k.provider_email})]}),a.jsx("button",{onClick:()=>x(k.provider_id),disabled:o.length<=1,className:`text-xs px-2 py-1 rounded ${o.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},k.provider_id))}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),a.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.google,"Google"]}),a.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.microsoft,"Microsoft"]})]})]})]});default:return a.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),a.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?a.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),a.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),a.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),a.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),a.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[a.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),a.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(S=>a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("button",{onClick:()=>!S.future&&_(S.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${S.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:S.future,children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:b(S.icon)}),a.jsx("span",{className:"flex-1 text-sm text-left",children:S.label}),S.future?a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):a.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:i===S.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),i===S.id&&!S.future&&a.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:w(S.id)})]},S.id))]}),a.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:v,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const Ie={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function IH(){return a.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:Ie.bg,borderColor:Ie.border},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:Ie.textPrimary},children:"THE COMBINE"}),a.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:Ie.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function MH(){return a.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:Ie.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),a.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:Ie.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),a.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:Ie.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ie.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ie.textMuted,children:["Learn how The Combine works",a.jsx("span",{"aria-hidden":"true",children:""})]})]})}function PH(){const e=[{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return a.jsx("section",{className:"max-w-4xl mx-auto",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>a.jsxs("div",{className:"flex-1 text-center group",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:Ie.bgElevated,border:`1px solid ${Ie.border}`,color:Ie.textMuted},children:t.icon}),a.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:Ie.textPrimary},children:t.title}),a.jsx("p",{className:"text-xs",style:{color:Ie.textMuted},children:t.description}),r<e.length-1&&a.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:Ie.border}})]},r))})})}function OH(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return a.jsx("section",{className:"text-center",children:a.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>a.jsx("span",{className:"text-xs",style:{color:Ie.textMuted},children:t},r))})})}function DH({onLogin:e}){return a.jsxs("section",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium mb-4",style:{color:Ie.textSecondary},children:"Ready?"}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ie.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ie.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ie.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ie.bg,border:`1px solid ${Ie.border}`,color:Ie.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ie.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ie.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function LH(){return a.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ie.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ie.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ie.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ie.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ie.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ie.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ie.border},children:" 2026 The Combine"})]})}function FH(){const{login:e}=Ls();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ie.bg},children:[a.jsx(IH,{}),a.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:a.jsxs("div",{className:"space-y-12",children:[a.jsx(MH,{}),a.jsx(PH,{}),a.jsx(OH,{}),a.jsx(DH,{onLogin:e})]})}),a.jsx(LH,{})]})}const Ee={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function zH(){return a.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Ee.bg,borderColor:Ee.border},children:[a.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Ee.textMuted},onMouseOver:e=>e.currentTarget.style.color=Ee.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Ee.textMuted,children:[a.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),a.jsx("span",{className:"text-sm",children:"Back"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),a.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Ee.textPrimary},children:"THE COMBINE"})]}),a.jsx("div",{className:"w-16"})," "]})}function ii({title:e,children:t}){return a.jsxs("section",{className:"mb-16",children:[e&&a.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Ee.textPrimary},children:e}),t]})}function pt({children:e,className:t=""}){return a.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Ee.textSecondary},children:e})}function to({children:e}){return a.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Ee.textPrimary,borderLeft:`2px solid ${Ee.border}`},children:e})}function ol({items:e}){return a.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>a.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Ee.textSecondary},children:[a.jsx("span",{style:{color:Ee.textMuted},children:"-"}),t]},r))})}function al({number:e,title:t,children:r}){return a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[a.jsxs("span",{className:"text-sm font-mono",style:{color:Ee.textMuted},children:[e,"."]}),a.jsx("h3",{className:"text-base font-medium",style:{color:Ee.textPrimary},children:t})]}),a.jsx("div",{className:"pl-7",children:a.jsx(pt,{children:r})})]})}function ll({title:e,children:t}){return a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Ee.textPrimary},children:e}),a.jsx(pt,{className:"mb-0",children:t})]})}function qH({onLogin:e}){return a.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Ee.bgElevated,border:`1px solid ${Ee.border}`},children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Ee.textPrimary},children:"When You're Ready"}),a.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),a.jsx(pt,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),a.jsx(pt,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),a.jsxs("div",{className:"inline-flex flex-col gap-3",children:[a.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Ee.accentHover,onMouseOut:t=>t.currentTarget.style.background=Ee.accent,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),a.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Ee.bg,border:`1px solid ${Ee.border}`,color:Ee.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Ee.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Ee.bg,children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function $H(){return a.jsxs("footer",{className:"py-8 text-center",children:[a.jsx("p",{className:"text-sm mb-6",style:{color:Ee.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Terms"}),a.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Ee.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Ee.textMuted,onMouseOut:e=>e.currentTarget.style.color=Ee.textSubtle,children:"Privacy"}),a.jsx("span",{className:"text-xs",style:{color:Ee.border},children:" 2026 The Combine"})]})]})}function BH(){const{login:e}=Ls();return a.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Ee.bg},children:[a.jsx(zH,{}),a.jsx("main",{className:"flex-1 px-6 py-12",children:a.jsxs("article",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Ee.textPrimary},children:"Learn More"}),a.jsxs(ii,{title:"What The Combine Is",children:[a.jsx(pt,{children:"The Combine is an AI-assisted production system for knowledge work."}),a.jsx(pt,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),a.jsx(to,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),a.jsx(to,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),a.jsxs(ii,{title:"Why It Exists",children:[a.jsx(pt,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),a.jsx(pt,{children:"It breaks down when the work must be:"}),a.jsx(ol,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),a.jsx(pt,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),a.jsxs(ii,{title:'Why "The Combine"',children:[a.jsx(pt,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),a.jsx(pt,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),a.jsx(pt,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),a.jsx(pt,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),a.jsx(pt,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),a.jsx(ol,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),a.jsx(pt,{children:"This is not automation for speed. It is industrialization for reliability."}),a.jsx(to,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),a.jsxs(ii,{title:"How It Works",children:[a.jsx(al,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),a.jsx(al,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),a.jsx(al,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),a.jsx(al,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),a.jsxs(ii,{title:"What Makes It Different",children:[a.jsx(ll,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),a.jsx(ll,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),a.jsx(ll,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),a.jsx(ll,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),a.jsxs(ii,{title:"What The Combine Is Not",children:[a.jsx(ol,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),a.jsx(pt,{children:"If you want improvisation, there are better tools."}),a.jsx(to,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),a.jsxs(ii,{title:"Who It's For",children:[a.jsx(pt,{children:"The Combine is designed for people responsible for outcomes, including:"}),a.jsx(ol,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),a.jsx(to,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),a.jsx(qH,{onLogin:e})]})}),a.jsx($H,{})]})}function R4(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await we.getTemplates();t(l.templates||[])}catch(l){s(l.message),console.error("Failed to fetch templates:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{templates:e,loading:r,error:i,refresh:o}}function HH(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await we.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){s(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{workflows:e,loading:r,error:i,refresh:o}}function A4(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null),o=m.useCallback(async()=>{n(!0),s(null);try{const l=await we.getSchemas();t(l.schemas||[])}catch(l){s(l.message),console.error("Failed to fetch schemas:",l)}finally{n(!1)}},[]);return m.useEffect(()=>{o()},[o]),{schemas:e,loading:r,error:i,refresh:o}}function I4(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[i,s]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){n(!0),s(null);try{const h=await we.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&s(h.message||"Failed to load prompt fragments")}finally{f&&n(!1)}}return p(),()=>{f=!1}},[]);const o=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:o.role.length,task:o.task.length,qa:o.qa.length,pgc:o.pgc.length,questions:o.questions.length,reflection:o.reflection.length}),[e,o]),c=m.useCallback(f=>!f||f==="all"?e:o[f]||[],[e,o]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{n(!0),s(null);try{const f=await we.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),s(f.message||"Failed to refresh")}finally{n(!1)}},[]);return{fragments:e,loading:r,error:i,fragmentsByKind:o,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const lv="doctype-browser-collapsed";function M4(e,t){const[r,n]=m.useState(()=>{try{const s=JSON.parse(localStorage.getItem(lv)||"{}");return e in s?s[e]:t}catch{return t}}),i=m.useCallback(s=>{const o=typeof s=="function"?s(r):s;n(o);try{const l=JSON.parse(localStorage.getItem(lv)||"{}");l[e]=o,localStorage.setItem(lv,JSON.stringify(l))}catch{}},[e,r]);return[r,i]}function dS({title:e,defaultOpen:t=!0,children:r}){const[n,i]=M4(`group:${e}`,t);return a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function fS({title:e,action:t,defaultOpen:r=!0,dotColor:n,children:i}){const[s,o]=M4(`sub:${e}`,r);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:s?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),n&&a.jsx("span",{style:{color:n,fontSize:8},children:""}),a.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),s&&i]})}function pS({selected:e,onClick:t,label:r,sublabel:n,badge:i}){return a.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:r}),i&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:i})]}),n&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function hS({loading:e,empty:t,emptyMessage:r="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function WH({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],promptFragments:i=[],promptFragmentKindOptions:s=[],schemas:o=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:x=null,selectedRole:v=null,selectedTemplate:_=null,selectedWorkflow:g=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:w,onSelectRole:S,onSelectTemplate:k,onSelectWorkflow:N,onSelectFragment:E,onSelectStandaloneSchema:j,onCreateWorkflow:R,onCreateDocType:T,onCreateFragment:D,onCreateTemplate:q,onCreateSchema:C,onSelectTask:O,onSelectSchema:I,workspaceState:F=null}){var xe;const[M,A]=m.useState(null),[L,z]=m.useState(null),[B,X]=m.useState(""),[Y,W]=m.useState(!1),[$,Q]=m.useState(!1),[se,ae]=m.useState(""),[ee,_e]=m.useState(!1),me=[...e].sort((re,he)=>(re.display_name||"").localeCompare(he.display_name||"")),je=n.filter(re=>(re.pow_class||"reference")==="reference"),ve=re=>{const he=re.pow_class||"reference";return he==="reference"?"ref":he==="template"?"tpl":"inst"},oe=e.filter(re=>re.active_version).length+n.filter(re=>re.active_version).length,G=((xe=F==null?void 0:F.modified_artifacts)==null?void 0:xe.length)??0,K=(F==null?void 0:F.is_dirty)??!1,J=()=>{A(null),z(null),X("")},pe=()=>{Q(!1),ae("")},fe=async()=>{const re=se.trim().toLowerCase().replace(/\s+/g,"_");if(!(!re||!/^[a-z][a-z0-9_]*$/.test(re))){_e(!0);try{await(T==null?void 0:T({doc_type_id:re})),pe()}catch{}finally{_e(!1)}}},be=async()=>{const re=B.trim().toLowerCase().replace(/\s+/g,"_");if(!(!re||!/^[a-z][a-z0-9_]*$/.test(re))){W(!0);try{const he={workflow_id:re,pow_class:"template"};L&&(he.derived_from={workflow_id:L.workflow_id,version:L.active_version},he.source_version=L.active_version),await(R==null?void 0:R(he)),J()}catch{}finally{W(!1)}}};return a.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(dS,{title:"Production Workflows",defaultOpen:!0,children:[a.jsxs(fS,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&a.jsx("button",{onClick:()=>A(M?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[M==="choose"&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("button",{onClick:()=>A("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:je.length===0,children:["From Reference",je.length===0?" (none available)":""]}),a.jsx("button",{onClick:()=>A("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),a.jsx("button",{onClick:J,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),M==="from_reference"&&!L&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),je.map(re=>a.jsxs("button",{onClick:()=>z(re),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[a.jsx("div",{className:"font-medium",children:re.name||re.workflow_id.replace(/_/g," ").replace(/\b\w/g,he=>he.toUpperCase())}),a.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",re.active_version]})]},re.workflow_id)),a.jsx("button",{onClick:()=>A("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(M==="blank"||M==="from_reference"&&L)&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[L&&a.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",L.name||L.workflow_id," v",L.active_version]}),a.jsx("input",{type:"text",value:B,onChange:re=>X(re.target.value),onKeyDown:re=>{re.key==="Enter"&&be(),re.key==="Escape"&&J()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:Y,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:be,disabled:Y||!B.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Y?"wait":"pointer",opacity:!B.trim()||Y?.5:1},children:Y?"Creating...":"Create"}),a.jsx("button",{onClick:J,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(hS,{loading:u,empty:!u&&n.length===0,emptyMessage:"No workflows"}),!u&&n.length>0&&a.jsx("div",{className:"py-1",children:n.map(re=>a.jsx(pS,{selected:(g==null?void 0:g.workflow_id)===re.workflow_id,onClick:()=>N==null?void 0:N(re),label:re.name||re.workflow_id.replace(/_/g," ").replace(/\b\w/g,he=>he.toUpperCase()),sublabel:`v${re.active_version}`,badge:ve(re)},re.workflow_id))})]}),a.jsxs(fS,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&a.jsx("button",{onClick:()=>Q(!$),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[$&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:se,onChange:re=>ae(re.target.value),onKeyDown:re=>{re.key==="Enter"&&fe(),re.key==="Escape"&&pe()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:ee,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:fe,disabled:ee||!se.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:ee?"wait":"pointer",opacity:!se.trim()||ee?.5:1},children:ee?"Creating...":"Create"}),a.jsx("button",{onClick:pe,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(hS,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&me.length>0&&a.jsx("div",{className:"py-1",children:me.map(re=>a.jsx(pS,{selected:x==="docworkflow"&&(h==null?void 0:h.doc_type_id)===re.doc_type_id,onClick:()=>w==null?void 0:w(re),label:re.display_name,badge:`v${re.active_version}`},re.doc_type_id))})]})]}),a.jsxs(dS,{title:"Governance",defaultOpen:!1,children:[a.jsx("div",{className:"px-4 py-3",children:a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),a.jsxs("div",{children:[oe," active ",oe===1?"release":"releases"]})]})}),F&&a.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),K&&a.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[G," dirty"]})]})]})]})})}function UH({kinds:e=[],selectedKind:t="all",onSelect:r}){return a.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:n,label:i,count:s})=>{const o=t===n;return a.jsxs("button",{onClick:()=>r==null?void 0:r(n),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:o?"var(--action-primary)":"var(--bg-panel)",color:o?"#000":"var(--text-secondary)",border:o?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[i,s!==void 0&&a.jsxs("span",{style:{marginLeft:4,opacity:o?.7:.6},children:["(",s,")"]})]},n)})})}function cl({title:e,count:t,dotColor:r,defaultOpen:n=!1,action:i,children:s}){const[o,l]=m.useState(n);return a.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[a.jsxs("button",{onClick:()=>l(!o),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{style:{color:"var(--text-muted)",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),a.jsx("span",{style:{color:r,fontSize:10},children:""}),a.jsx("span",{className:"font-semibold",children:e})]}),a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),i&&a.jsx("div",{className:"pr-3",children:i})]}),o&&a.jsx("div",{style:{background:"var(--bg-panel)"},children:s})]})}function ro({onClick:e,label:t,sublabel:r,badge:n,isSelected:i}){return a.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:i?"var(--bg-selected, rgba(99, 102, 241, 0.15))":"transparent",border:"none",borderLeft:i?"3px solid var(--action-primary)":"3px solid transparent",color:i?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer"},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-medium truncate",children:t}),n&&a.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:n})]}),r&&a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function ul({loading:e,empty:t,emptyMessage:r="None found"}){return e?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?a.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function VH({isOpen:e,onClose:t,promptFragments:r=[],promptFragmentKindOptions:n=[],templates:i=[],schemas:s=[],documentTypes:o=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,selectedFragment:h=null,selectedTemplate:x=null,selectedSchema:v=null,selectedMechanicalOp:_=null,onSelectFragment:g,onSelectTemplate:y,onSelectSchema:b,onSelectStandaloneSchema:w,onSelectMechanicalOp:S,onCreateFragment:k,onCreateTemplate:N,onCreateSchema:E}){const[j,R]=m.useState("all"),[T,D]=m.useState(!1),[q,C]=m.useState("role"),[O,I]=m.useState(""),[F,M]=m.useState(!1),[A,L]=m.useState(!1),[z,B]=m.useState(""),[X,Y]=m.useState(!1),[W,$]=m.useState(!1),[Q,se]=m.useState(""),[ae,ee]=m.useState(!1),_e=j==="all"?r:r.filter(G=>G.kind===j);m.useEffect(()=>{e||(D(!1),L(!1),$(!1),I(""),B(""),se(""))},[e]);const me=m.useCallback((G,K)=>{G==null||G(K)},[]),je=async()=>{const G=O.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){M(!0);try{await(k==null?void 0:k({role_id:G,kind:q})),D(!1),I("")}catch{}finally{M(!1)}}},ve=async()=>{const G=z.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){Y(!0);try{await(N==null?void 0:N({template_id:G})),L(!1),B("")}catch{}finally{Y(!1)}}},oe=async()=>{const G=Q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!G||!/^[a-z][a-z0-9_]*$/.test(G))){ee(!0);try{await(E==null?void 0:E({schema_id:G})),$(!1),se("")}catch{}finally{ee(!1)}}};return e?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),a.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),a.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs(cl,{title:"Prompt Fragments",count:r.length,dotColor:"#f59e0b",defaultOpen:!0,action:k&&a.jsx("button",{onClick:()=>D(!T),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[T&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),a.jsx("select",{value:q,onChange:G=>C(G.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:a.jsx("option",{value:"role",children:"Role"})})]}),a.jsx("input",{type:"text",value:O,onChange:G=>I(G.target.value),onKeyDown:G=>{G.key==="Enter"&&je(),G.key==="Escape"&&D(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:F,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:je,disabled:F||!O.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:F?"wait":"pointer",opacity:!O.trim()||F?.5:1},children:F?"Creating...":"Create"}),a.jsx("button",{onClick:()=>D(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),n.length>0&&a.jsx(UH,{kinds:n,selectedKind:j,onSelect:R}),a.jsx(ul,{loading:d,empty:!d&&_e.length===0,emptyMessage:j==="all"?"No prompt fragments":`No ${j} fragments`}),!d&&_e.length>0&&a.jsx("div",{className:"py-1",children:_e.map(G=>a.jsx(ro,{onClick:()=>me(g,G),label:G.name||G.fragment_id,sublabel:`${G.kind}  v${G.version}`,badge:G.kind,isSelected:(h==null?void 0:h.fragment_id)===G.fragment_id},G.fragment_id))})]}),a.jsxs(cl,{title:"Templates",count:i.length,dotColor:"var(--dot-green)",action:N&&a.jsx("button",{onClick:()=>L(!A),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[A&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:z,onChange:G=>B(G.target.value),onKeyDown:G=>{G.key==="Enter"&&ve(),G.key==="Escape"&&L(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:X,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:ve,disabled:X||!z.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:X?"wait":"pointer",opacity:!z.trim()||X?.5:1},children:X?"Creating...":"Create"}),a.jsx("button",{onClick:()=>L(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ul,{loading:u,empty:!u&&i.length===0,emptyMessage:"No templates"}),!u&&i.length>0&&a.jsx("div",{className:"py-1",children:i.map(G=>a.jsx(ro,{onClick:()=>me(y,G),label:G.name||G.template_id.replace(/_/g," ").replace(/\b\w/g,K=>K.toUpperCase()),sublabel:`v${G.active_version}`,isSelected:(x==null?void 0:x.template_id)===G.template_id},G.template_id))})]}),a.jsxs(cl,{title:"Schemas",count:s.length||o.length,dotColor:"var(--dot-blue)",action:E&&a.jsx("button",{onClick:()=>$(!W),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[W&&a.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[a.jsx("input",{type:"text",value:Q,onChange:G=>se(G.target.value),onKeyDown:G=>{G.key==="Enter"&&oe(),G.key==="Escape"&&$(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:ae,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:oe,disabled:ae||!Q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:ae?"wait":"pointer",opacity:!Q.trim()||ae?.5:1},children:ae?"Creating...":"Create"}),a.jsx("button",{onClick:()=>$(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),a.jsx(ul,{loading:f,empty:!f&&s.length===0&&o.length===0,emptyMessage:"No schemas"}),!f&&s.length>0&&a.jsx("div",{className:"py-1",children:s.map(G=>a.jsx(ro,{onClick:()=>me(w,G),label:G.title||G.schema_id,sublabel:`v${G.active_version}`,isSelected:(v==null?void 0:v.schema_id)===G.schema_id},`standalone-${G.schema_id}`))}),s.length===0&&o.length>0&&a.jsx("div",{className:"py-1",children:o.map(G=>a.jsx(ro,{onClick:()=>me(b,{doc_type_id:G.doc_type_id,display_name:G.display_name,active_version:G.active_version}),label:G.display_name,sublabel:`from ${G.doc_type_id}`},`schema-${G.doc_type_id}`))})]}),a.jsxs(cl,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[a.jsx(ul,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&a.jsx("div",{className:"py-1",children:l.map(G=>{const K=c.filter(J=>J.type===G.type_id);return a.jsxs("div",{children:[a.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsx("span",{style:{fontSize:10},children:""}),a.jsx("span",{children:G.name}),a.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",K.length,")"]})]}),K.length>0?K.map(J=>a.jsx(ro,{onClick:()=>me(S,J),label:J.name,sublabel:`v${J.active_version}`,badge:J.type,isSelected:(_==null?void 0:_.op_id)===J.op_id},J.op_id)):a.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},G.type_id)})}),!p&&l.length===0&&c.length===0&&a.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),a.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function en({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:i=!1,error:s=null,readOnly:o=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o&&a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!o&&i&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&!o&&a.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&i&&a.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),s&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",s]})]})]}),a.jsx("div",{className:"flex-1 relative",children:r?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):a.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:o,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function GH({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[i,s]=m.useState(!0),[o,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),s(!1);return}(async()=>{s(!0),l(null);try{const d=await we.getPreview(e,t);n(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{s(!1)}})()},[e,t]),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),a.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&a.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&a.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&a.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&a.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),a.jsx("div",{className:"flex-1 relative overflow-auto",children:i?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):o?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[a.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:o})]})}):a.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function KH({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,w,S;t&&(s({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((w=t.ui)==null?void 0:w.category)||"",ui_display_order:((S=t.ui)==null?void 0:S.display_order)||0}),h(!1),f(null))},[t]);const x=m.useCallback((b,w)=>{s(S=>({...S,[b]:w})),h(!0)},[]),v=m.useCallback((b,w)=>{const S=w.split(",").map(k=>k.trim()).filter(k=>k);s(k=>({...k,[b]:S})),h(!0)},[]),_=m.useCallback(b=>{if(!b)return"";const w=r.find(S=>S.role_id===b);return w?`prompt:role:${b}:${w.active_version}`:""},[r]),g=m.useCallback(b=>{if(!b)return"";const w=b.split(":");return w.length>=3&&w[0]==="prompt"&&w[1]==="role"?w[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!i)){d(!0),f(null);try{const b=t.version||t.active_version,w=`doctype:${t.doc_type_id}:${b}:manifest`,S=YH(t.doc_type_id,b,i),k=await we.writeArtifact(e,w,S);h(!1),n==null||n(w,k)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,i,n]);return!t||!i?a.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"flex items-center gap-2",children:p&&a.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&a.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),a.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsxs(no,{title:"Identity",children:[a.jsx(Zt,{label:"Display Name",children:a.jsx("input",{type:"text",value:i.display_name,onChange:b=>x("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Description",children:a.jsx("textarea",{value:i.description,onChange:b=>x("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"Classification",children:[a.jsx(Zt,{label:"Authority Level",children:a.jsxs("select",{value:i.authority_level,onChange:b=>x("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"descriptive",children:"Descriptive"}),a.jsx("option",{value:"prescriptive",children:"Prescriptive"}),a.jsx("option",{value:"constructive",children:"Constructive"}),a.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),a.jsx(Zt,{label:"Creation Mode",children:a.jsxs("select",{value:i.creation_mode,onChange:b=>x("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"llm_generated",children:"LLM Generated"}),a.jsx("option",{value:"constructed",children:"Constructed"}),a.jsx("option",{value:"extracted",children:"Extracted"})]})}),a.jsx(Zt,{label:"Scope",children:a.jsxs("select",{value:i.scope,onChange:b=>x("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"epic",children:"Epic"}),a.jsx("option",{value:"feature",children:"Feature"})]})})]}),a.jsx(no,{title:"Shared References",children:a.jsxs(Zt,{label:"Role Prompt",children:[a.jsxs("select",{value:g(i.role_prompt_ref),onChange:b=>x("role_prompt_ref",_(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"None"}),r.map(b=>a.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())},b.role_id))]}),i.role_prompt_ref&&a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:i.role_prompt_ref})]})}),a.jsxs(no,{title:"Dependencies",children:[a.jsx(Zt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.required_inputs.join(", "),onChange:b=>v("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.optional_inputs.join(", "),onChange:b=>v("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Parent Doc Type",children:a.jsx("input",{type:"text",value:i.parent_doc_type,onChange:b=>x("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:a.jsx("input",{type:"text",value:i.creates_children.join(", "),onChange:b=>v("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),a.jsxs(no,{title:"UI Configuration",children:[a.jsx(Zt,{label:"Icon",children:a.jsx("input",{type:"text",value:i.ui_icon,onChange:b=>x("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),a.jsx(Zt,{label:"Category",children:a.jsxs("select",{value:i.ui_category,onChange:b=>x("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[a.jsx("option",{value:"",children:"Select category..."}),a.jsx("option",{value:"intake",children:"Intake"}),a.jsx("option",{value:"architecture",children:"Architecture"}),a.jsx("option",{value:"planning",children:"Planning"}),a.jsx("option",{value:"execution",children:"Execution"})]})}),a.jsx(Zt,{label:"Display Order",children:a.jsx("input",{type:"number",value:i.ui_display_order,onChange:b=>x("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function no({title:e,children:t}){return a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),a.jsx("div",{className:"space-y-4",children:t})]})}function Zt({label:e,hint:t,children:r}){return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&a.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function YH(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(i=>`"${i}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(i=>`"${i}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(i=>`"${i}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function P4(e,t,{debounceMs:r=1e3,onSave:n}={}){const[i,s]=m.useState(null),[o,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[x,v]=m.useState(null),_=m.useRef(null),g=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){s(null),l(null),d(!1);return}d(!0),f(null);try{const N=await we.getArtifact(e,t),E=JSON.parse(N.content);s(E),l(E)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{d(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){h(!0),f(null);try{const E=JSON.stringify(N,null,2),j=await we.writeArtifact(e,t,E);v(j),l(N),n&&n(j)}catch(E){f(E.message),console.error("Failed to save workflow:",E)}finally{h(!1)}}},[e,t,n]),w=m.useCallback(N=>{g.current=N,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),S=m.useCallback(N=>{s(N),w(N)},[w]),k=m.useCallback(()=>{_.current&&clearTimeout(_.current),i&&b(i)},[i,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{workflowJson:i,originalJson:o,loading:c,error:u,saving:p,lastSaveResult:x,isDirty:i!==o,updateWorkflow:S,saveNow:k,reload:y}}function XH({data:e,selected:t}){const{config:r,isEntry:n}=e,i=e.type==="end";return a.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${r.color}60, 0 0 20px ${r.color}80, 0 0 40px ${r.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[a.jsx(Ur,{type:"target",position:ce.Top,style:{background:r.color,width:8,height:8,border:"none"}}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[a.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&a.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),a.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&a.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),a.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&a.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!i&&a.jsx(Ur,{type:"source",position:ce.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const QH=m.memo(XH),_c={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},ZH={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},mS=220,vS=110;function gS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(i=>{const s=_c[i.type]||_c.task,l=i.type==="end"&&["blocked","abandoned"].includes(i.terminal_outcome)?ZH:s;return{id:i.node_id,type:"workflowNode",position:i._position||{x:0,y:0},data:{...i,config:l,isEntry:t.includes(i.node_id)}}}),n=(e.edges||[]).map(i=>{const s=i.non_advancing||!i.to_node_id,o=i.conditions&&i.conditions.length>0;let l=i.label||i.outcome;if(o){const c=i.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id||i.from_node_id,type:"smoothstep",animated:s,label:l,data:{...i},style:{stroke:s?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:s?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:i.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function xS(e,t,r="TB"){const n=new mc.graphlib.Graph;return n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(i=>{n.setNode(i.id,{width:mS,height:vS})}),t.forEach(i=>{i.target!==i.source&&n.setEdge(i.source,i.target)}),mc.layout(n),e.map(i=>{const s=n.node(i.id);return s?{...i,position:{x:s.x-mS/2,y:s.y-vS/2}}:i})}function JH(e,t){const r=new Set(t.map(s=>s.id||s.node_id));let n=1,i=`${e}_${n}`;for(;r.has(i);)n++,i=`${e}_${n}`;return i}function e7(e,t,r){const n=new Set(r.map(o=>o.id||o.edge_id));let i=1,s=`${e}_to_${t}`;for(;n.has(s);)i++,s=`${e}_to_${t}_${i}`;return s}function t7(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const r7={workflowNode:QH},n7=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function i7({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:i,onEdgeSelect:s}){const o=Qc(),[l,c,d]=gE([]),[u,f,p]=xE([]),[h,x]=m.useState(!1),v=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:j,edges:R}=gS(e);(!j.some(D=>D.position.x!==0||D.position.y!==0)||!v.current)&&(j=xS(j,R),v.current=!0),c(j),f(R)},[e,c,f]),m.useEffect(()=>{c(j=>j.map(R=>({...R,selected:R.id===r})))},[r,c]);const _=m.useCallback(j=>{if(!e)return;const T={edge_id:e7(j.source,j.target,e.edges||[]),from_node_id:j.source,to_node_id:j.target,outcome:"success",label:"",kind:"auto"},D={...e,edges:[...e.edges||[],T]};t(D)},[e,t]),g=m.useCallback((j,R)=>{if(!e)return;const T=e.nodes.map(D=>D.node_id===R.id?{...D,_position:R.position}:D);t({...e,nodes:T})},[e,t]),y=m.useCallback((j,R)=>{i==null||i(R.id)},[i]),b=m.useCallback((j,R)=>{s==null||s(R.id)},[s]),w=m.useCallback(()=>{i==null||i(null),s==null||s(null)},[i,s]),S=m.useCallback(j=>{if(j.key==="Delete"||j.key==="Backspace"){if(r&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(R),i==null||i(null)}else if(n&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(R),s==null||s(null)}}},[r,n,e,t,i,s]),k=m.useCallback(j=>{if(!e)return;const R=JH(j,e.nodes||[]),T=t7(j);T.node_id=R;const D=o.getViewport(),q=(-D.x+window.innerWidth/2)/D.zoom,C=(-D.y+window.innerHeight/2)/D.zoom;T._position={x:q-110,y:C-50};const O={...e,nodes:[...e.nodes||[],T]};t(O),x(!1),i==null||i(R)},[e,t,o,i]),N=m.useCallback(()=>{if(!e)return;let{nodes:j,edges:R}=gS(e);j=xS(j,R);const T=e.nodes.map(D=>{const q=j.find(C=>C.id===D.node_id);return q?{...D,_position:q.position}:D});t({...e,nodes:T}),setTimeout(()=>{o.fitView({padding:.2,duration:300})},50)},[e,t,o]),E=m.useCallback(()=>{o.fitView({padding:.2,duration:300})},[o]);return a.jsx("div",{className:"flex-1 relative",onKeyDown:S,tabIndex:0,style:{outline:"none"},children:a.jsxs(ey,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:_,onNodeDragStop:g,onNodeClick:y,onEdgeClick:b,onPaneClick:w,nodeTypes:r7,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[a.jsx(Hn,{position:"top-left",children:a.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>x(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&a.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:n7.map(j=>{const R=_c[j.value]||{};return a.jsxs("button",{onClick:()=>k(j.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),j.label]},j.value)})})]}),a.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),a.jsx("button",{onClick:E,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),a.jsx(_E,{position:"bottom-right",nodeColor:j=>{var T;const R=(T=j.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),a.jsx(Hn,{position:"bottom-left",children:a.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(_c).map(([j,R])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),a.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},j))})}),a.jsx(Hn,{position:"top-right",children:a.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const s7=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],yS=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],bS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],o7=["semantic","structural","hybrid"],a7=["stabilized","blocked","abandoned"],De={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},_t={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l7={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function cv(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function uv(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function qi(e){var i;if(!e)return"";const t=e.kind||"role",r=((i=e.fragment_id)==null?void 0:i.replace(`${t}:`,""))||e.id||"",n=e.version||e.active_version||"1.0.0";return`prompt:${t}:${r}:${n}`}function $i(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function dl(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function fl(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function dv({title:e,defaultOpen:t=!1,isOpen:r,onToggle:n,children:i,badge:s}){const[o,l]=m.useState(t),c=r!==void 0,d=c?r:o,u=()=>{c&&n?n():l(!o)};return a.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:a.jsx("path",{d:"M9 18l6-6-6-6"})}),a.jsx("span",{style:{..._t,marginBottom:0},children:e})]}),s&&a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:s})]}),d&&a.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:i})]})}function fv(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function Bi(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function c7({node:e,onChange:t,onDelete:r,templates:n=[],schemas:i=[],roleFragments:s=[],taskFragments:o=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var fe,be,xe,re,he,Ke,Fe,$e,Te,Be,at,Re,Z,Pe,ge,Nt,xt,yt,Qt;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const x=(P,H)=>{const U={...u,[P]:H};f(U),t(U)},v=(P,H)=>{const U={...u.includes,[P]:H},ne={...u,includes:U};f(ne),t(ne)},_=P=>{const H={...u.includes};delete H[P];const U={...u,includes:H};f(U),t(U)},g=()=>{const P={...u.includes,NEW_KEY:""},H={...u,includes:P};f(H),t(H)},y=P=>{const H={...u,internals:P};f(H),t(H)},b=(P,H)=>{const U=u.internals||k(),ne={...U.question_generation,[P]:H};y({...U,question_generation:ne})},w=(P,H)=>{const U=u.internals||k(),ne={...U.question_generation.includes,[P]:H},Oe={...U.question_generation,includes:ne};y({...U,question_generation:Oe})},S=(P,H)=>{const U=u.internals||k(),ne={...U.clarification_merge,[P]:H};y({...U,clarification_merge:ne})},k=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const N=u.type==="pgc",E=uv(u.task_ref),j=u.includes||{},R=j.ROLE_PROMPT||"",T=j.TASK_PROMPT||"",D=j.OUTPUT_SCHEMA||"",q=j.PGC_CONTEXT||"",C=$i(R),O=$i(T),I=fl(D),F=$i(q),M=Object.entries(j).filter(([P])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(P)),A=u.internals||k(),L=uv((fe=A.question_generation)==null?void 0:fe.template_ref),z=$i((xe=(be=A.question_generation)==null?void 0:be.includes)==null?void 0:xe.ROLE_PROMPT),B=$i((he=(re=A.question_generation)==null?void 0:re.includes)==null?void 0:he.TASK_PROMPT),X=$i((Fe=(Ke=A.question_generation)==null?void 0:Ke.includes)==null?void 0:Fe.PGC_CONTEXT),Y=fl(($e=A.question_generation)==null?void 0:$e.output_schema_ref),W=uv((Te=A.clarification_merge)==null?void 0:Te.template_ref),$=fl((Be=A.clarification_merge)==null?void 0:Be.output_schema_ref),Q=P=>{const H=P.target.value;if(!H){x("task_ref","");return}const U=n.find(ne=>ne.template_id===H);U&&x("task_ref",cv(U))},se=P=>{const H=P.target.value;if(!H){_("ROLE_PROMPT");return}const U=s.find(ne=>ne.fragment_id===`role:${H}`||ne.id===H);U&&v("ROLE_PROMPT",qi(U))},ae=P=>{const H=P.target.value;if(!H){_("TASK_PROMPT");return}const U=o.find(ne=>ne.fragment_id===`task:${H}`||ne.id===H);U&&v("TASK_PROMPT",qi(U))},ee=P=>{const H=P.target.value;if(!H){_("OUTPUT_SCHEMA");return}const U=i.find(ne=>ne.schema_id===H);U&&v("OUTPUT_SCHEMA",dl(U))},_e=P=>{const H=P.target.value;if(!H){_("PGC_CONTEXT");return}const U=l.find(ne=>ne.fragment_id===`pgc:${H}`||ne.id===H);U&&v("PGC_CONTEXT",qi(U))},me=P=>{const H=P.target.value,U=bS.find(lt=>lt.value===H),ne=(U==null?void 0:U.produces)||`pgc_clarifications.${H}`,Oe={...u,gate_kind:H,produces:ne};f(Oe),t(Oe)},je=P=>{const H=P.target.value;if(!H){b("template_ref","");return}const U=n.find(ne=>ne.template_id===H);U&&b("template_ref",cv(U))},ve=P=>{const H=P.target.value;if(!H){w("ROLE_PROMPT","");return}const U=s.find(ne=>ne.fragment_id===`role:${H}`||ne.id===H);U&&w("ROLE_PROMPT",qi(U))},oe=P=>{const H=P.target.value;if(!H){w("TASK_PROMPT","");return}const U=o.find(ne=>ne.fragment_id===`task:${H}`||ne.id===H);U&&w("TASK_PROMPT",qi(U))},G=P=>{const H=P.target.value;if(!H){w("PGC_CONTEXT","");return}const U=l.find(ne=>ne.fragment_id===`pgc:${H}`||ne.id===H);U&&w("PGC_CONTEXT",qi(U))},K=P=>{const H=P.target.value;if(!H){b("output_schema_ref","");return}const U=i.find(ne=>ne.schema_id===H);U&&b("output_schema_ref",dl(U))},J=P=>{const H=P.target.value;if(!H){S("template_ref","");return}const U=n.find(ne=>ne.template_id===H);U&&S("template_ref",cv(U))},pe=P=>{const H=P.target.value;if(!H){S("output_schema_ref","");return}const U=i.find(ne=>ne.schema_id===H);U&&S("output_schema_ref",dl(U))};return a.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:N?"PGC Gate Properties":"Node Properties"}),a.jsx("button",{onClick:()=>r(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Node ID"}),a.jsx("input",{type:"text",value:u.node_id||"",onChange:P=>x("node_id",P.target.value),style:De})]}),a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Type"}),a.jsx("select",{value:u.type||"task",onChange:P=>x("type",P.target.value),style:De,children:s7.map(P=>a.jsx("option",{value:P.value,children:P.label},P.value))})]}),N&&a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Gate Kind"}),a.jsx("select",{value:u.gate_kind||"discovery",onChange:me,style:De,children:bS.map(P=>a.jsx("option",{value:P.value,children:P.label},P.value))})]}),a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Description"}),a.jsx("textarea",{value:u.description||"",onChange:P=>x("description",P.target.value),rows:2,style:{...De,resize:"vertical"}})]}),(N||["task","intake_gate"].includes(u.type))&&a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Produces"}),a.jsx("input",{type:"text",value:u.produces||"",onChange:P=>x("produces",P.target.value),placeholder:N?"pgc_clarifications.discovery":"document_type",style:De})]}),N&&a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{style:l7,children:"Gate Internals"}),a.jsx(dv,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:L||"",onChange:je,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(P=>a.jsx("option",{value:P.template_id,children:P.name||P.template_id.replace(/_/g," ")},P.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:z||"",onChange:ve,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(P=>{var U;const H=((U=P.fragment_id)==null?void 0:U.replace("role:",""))||P.id;return a.jsx("option",{value:H,children:P.name||(H==null?void 0:H.replace(/_/g," "))},P.fragment_id||P.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:B||"",onChange:oe,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(P=>{var U;const H=((U=P.fragment_id)==null?void 0:U.replace("task:",""))||P.id;return a.jsx("option",{value:H,children:P.name||(H==null?void 0:H.replace(/_/g," "))},P.fragment_id||P.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:X||"",onChange:G,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(P=>{var U;const H=((U=P.fragment_id)==null?void 0:U.replace("pgc:",""))||P.id;return a.jsx("option",{value:H,children:P.name||(H==null?void 0:H.replace(/_/g," "))},P.fragment_id||P.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:Y||"",onChange:K,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(P=>a.jsx("option",{value:P.schema_id,children:P.title||P.schema_id.replace(/_/g," ")},P.schema_id))]})]})]})}),a.jsx("div",{className:"mt-2",children:a.jsx(dv,{title:"Entry: Operator Answers",badge:"UI",children:a.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Renders:"}),a.jsx("span",{className:"font-mono",children:((at=A.operator_entry)==null?void 0:at.renders)||"question_set"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Captures:"}),a.jsx("span",{className:"font-mono",children:((Re=A.operator_entry)==null?void 0:Re.captures)||"pgc_answers"})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),a.jsx("div",{className:"mt-2",children:a.jsx(dv,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((Z=A.clarification_merge)==null?void 0:Z.internal_type)||"LLM",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),a.jsxs("select",{value:((Pe=A.clarification_merge)==null?void 0:Pe.internal_type)||"LLM",onChange:P=>S("internal_type",P.target.value),style:{...De,fontSize:11},children:[a.jsx("option",{value:"LLM",children:"LLM"}),a.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((ge=A.clarification_merge)==null?void 0:ge.internal_type)||"LLM")==="LLM"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),a.jsxs("select",{value:W||"",onChange:J,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(P=>a.jsx("option",{value:P.template_id,children:P.name||P.template_id.replace(/_/g," ")},P.template_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:$||"",onChange:pe,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(P=>a.jsx("option",{value:P.schema_id,children:P.title||P.schema_id.replace(/_/g," ")},P.schema_id))]})]})]}),((Nt=A.clarification_merge)==null?void 0:Nt.internal_type)==="MECH"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),a.jsxs("select",{value:Bi((xt=A.clarification_merge)==null?void 0:xt.op_ref)||"",onChange:P=>{const H=P.target.value;if(!H){S("op_ref","");return}const U=d.find(ne=>ne.op_id===H);U&&S("op_ref",fv(U))},style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(P=>P.type==="merger").map(P=>a.jsx("option",{value:P.op_id,children:P.name},P.op_id))]})]}),((yt=A.clarification_merge)==null?void 0:yt.op_ref)&&(()=>{const P=Bi(A.clarification_merge.op_ref),H=d.find(U=>U.op_id===P);return H?a.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:$||"",onChange:pe,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(P=>a.jsx("option",{value:P.schema_id,children:P.title||P.schema_id.replace(/_/g," ")},P.schema_id))]})]})]}),a.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Internal Type"}),a.jsx("select",{value:u.internal_type||"LLM",onChange:P=>x("internal_type",P.target.value),style:De,children:yS.map(P=>a.jsx("option",{value:P.value,children:P.label},P.value))}),a.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Qt=yS.find(P=>P.value===(u.internal_type||"LLM")))==null?void 0:Qt.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Interaction Template"}),a.jsxs("select",{value:E||"",onChange:Q,style:De,children:[a.jsx("option",{value:"",children:"-- Select Template --"}),n.map(P=>a.jsx("option",{value:P.template_id,children:P.name||P.template_id.replace(/_/g," ")},P.template_id))]}),u.task_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Mechanical Operation"}),a.jsxs("select",{value:Bi(u.op_ref)||"",onChange:P=>{const H=P.target.value;if(!H){x("op_ref","");return}const U=d.find(ne=>ne.op_id===H);U&&x("op_ref",fv(U))},style:De,children:[a.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(P=>{const H=d.filter(U=>U.type===P.type_id);return H.length===0?null:a.jsx("optgroup",{label:P.name,children:H.map(U=>a.jsx("option",{value:U.op_id,children:U.name},U.op_id))},P.type_id)})]}),u.op_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const P=Bi(u.op_ref),H=d.find(ne=>ne.op_id===P),U=H?c.find(ne=>ne.type_id===H.type):null;return H?a.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(U==null?void 0:U.name)||H.type}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description})]}):null})(),a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Output Schema"}),a.jsxs("select",{value:fl(u.output_schema_ref)||"",onChange:P=>{const H=P.target.value;if(!H){x("output_schema_ref","");return}const U=i.find(ne=>ne.schema_id===H);U&&x("output_schema_ref",dl(U))},style:De,children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(P=>a.jsx("option",{value:P.schema_id,children:P.title||P.schema_id.replace(/_/g," ")},P.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Entry Operation"}),a.jsxs("select",{value:Bi(u.op_ref)||"",onChange:P=>{const H=P.target.value;if(!H){x("op_ref","");return}const U=d.find(ne=>ne.op_id===H);U&&x("op_ref",fv(U))},style:De,children:[a.jsx("option",{value:"",children:"-- Select Entry Operation --"}),d.filter(P=>P.type==="entry").map(P=>a.jsx("option",{value:P.op_id,children:P.name},P.op_id))]}),u.op_ref&&a.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const P=Bi(u.op_ref),H=d.find(ne=>ne.op_id===P);if(!H)return null;const U=H.config||{};return a.jsxs("div",{className:"p-2 rounded text-xs space-y-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-orange, #f97316)",color:"#fff"},children:"Entry"}),a.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:H.name})]}),H.description&&a.jsx("div",{style:{color:"var(--text-muted)"},children:H.description}),a.jsxs("div",{className:"pt-2 border-t space-y-1",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Renders:"}),a.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:U.renders||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Captures:"}),a.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:U.captures||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Layout:"}),a.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:U.layout||"form"})]})]}),U.entry_prompt&&a.jsxs("div",{className:"p-2 rounded mt-2",style:{background:"var(--bg-panel)"},children:[a.jsx("div",{className:"text-[10px] uppercase mb-1",style:{color:"var(--text-muted)"},children:"Entry Prompt"}),a.jsx("div",{style:{color:"var(--text-primary)"},children:U.entry_prompt})]})]})})(),!u.op_ref&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Select an Entry operation above, or define custom renders/captures below."}),a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Renders"}),a.jsx("input",{type:"text",value:u.renders||"",onChange:P=>x("renders",P.target.value),placeholder:"e.g., question_set",style:De})]}),a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Captures"}),a.jsx("input",{type:"text",value:u.captures||"",onChange:P=>x("captures",P.target.value),placeholder:"e.g., user_answers",style:De})]})]})]}),u.type==="qa"&&a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"QA Mode"}),a.jsx("select",{value:u.qa_mode||"semantic",onChange:P=>x("qa_mode",P.target.value),style:De,children:o7.map(P=>a.jsx("option",{value:P,children:P},P))})]}),u.type==="end"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Terminal Outcome"}),a.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:P=>x("terminal_outcome",P.target.value),style:De,children:a7.map(P=>a.jsx("option",{value:P,children:P},P))})]}),a.jsxs("div",{children:[a.jsx("label",{style:_t,children:"Gate Outcome"}),a.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:P=>x("gate_outcome",P.target.value),placeholder:"e.g., complete, failed",style:De})]})]}),a.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:P=>x("requires_qa",P.target.checked)}),"Requires QA"]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:P=>x("non_advancing",P.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx("label",{style:_t,children:"Includes"})}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),a.jsxs("select",{value:C||"",onChange:se,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Role --"}),s.map(P=>{var U;const H=((U=P.fragment_id)==null?void 0:U.replace("role:",""))||P.id;return a.jsx("option",{value:H,children:P.name||(H==null?void 0:H.replace(/_/g," "))},P.fragment_id||P.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),a.jsxs("select",{value:O||"",onChange:ae,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Task --"}),o.map(P=>{var U;const H=((U=P.fragment_id)==null?void 0:U.replace("task:",""))||P.id;return a.jsx("option",{value:H,children:P.name||(H==null?void 0:H.replace(/_/g," "))},P.fragment_id||P.id)})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),a.jsxs("select",{value:I||"",onChange:ee,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select Schema --"}),i.map(P=>a.jsx("option",{value:P.schema_id,children:P.title||P.schema_id.replace(/_/g," ")},P.schema_id))]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),a.jsxs("select",{value:F||"",onChange:_e,style:{...De,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(P=>{var U;const H=((U=P.fragment_id)==null?void 0:U.replace("pgc:",""))||P.id;return a.jsx("option",{value:H,children:P.name||(H==null?void 0:H.replace(/_/g," "))},P.fragment_id||P.id)})]})]}),M.length>0&&a.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[a.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),a.jsx("div",{className:"space-y-2",children:M.map(([P,H])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:P,onChange:U=>{const ne={...u.includes};delete ne[P],ne[U.target.value]=H;const Oe={...u,includes:ne};f(Oe),t(Oe)},style:{...De,width:"35%",fontSize:10},placeholder:"KEY"}),a.jsx("input",{type:"text",value:H,onChange:U=>v(P,U.target.value),style:{...De,flex:1,fontSize:10},placeholder:"path/to/file"}),a.jsx("button",{onClick:()=>_(P),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},P))})]}),a.jsx("button",{onClick:g,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const u7=["auto","user_choice"],d7=["eq","ne","lt","lte","gt","gte"],Qr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},si={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function f7({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[i,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(u,f)=>{const p={...i,[u]:f};s(p),r(p)},l=()=>{const u=[...i.conditions||[],{type:"retry_count",operator:"lt",value:2}];o("conditions",u)},c=(u,f,p)=>{const h=[...i.conditions||[]];h[u]={...h[u],[f]:p},o("conditions",h)},d=u=>{const f=(i.conditions||[]).filter((p,h)=>h!==u);o("conditions",f)};return i?a.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),a.jsx("button",{onClick:()=>n(i.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),a.jsxs("div",{className:"p-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Edge ID"}),a.jsx("input",{type:"text",value:i.edge_id||"",onChange:u=>o("edge_id",u.target.value),style:Qr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"From Node"}),a.jsx("select",{value:i.from_node_id||"",onChange:u=>o("from_node_id",u.target.value),style:Qr,children:t.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"To Node"}),a.jsxs("select",{value:i.to_node_id||"",onChange:u=>o("to_node_id",u.target.value||null),style:Qr,children:[a.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>a.jsx("option",{value:u,children:u},u))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Outcome"}),a.jsx("input",{type:"text",value:i.outcome||"",onChange:u=>o("outcome",u.target.value),placeholder:"success, failed, etc.",style:Qr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Label"}),a.jsx("input",{type:"text",value:i.label||"",onChange:u=>o("label",u.target.value),placeholder:"Human-readable label",style:Qr})]}),a.jsxs("div",{children:[a.jsx("label",{style:si,children:"Kind"}),a.jsx("select",{value:i.kind||"auto",onChange:u=>o("kind",u.target.value),style:Qr,children:u7.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[a.jsx("input",{type:"checkbox",checked:i.non_advancing||!1,onChange:u=>o("non_advancing",u.target.checked)}),"Non-advancing"]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:si,children:"Conditions"}),a.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),a.jsx("div",{className:"space-y-2",children:(i.conditions||[]).map((u,f)=>a.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Qr,flex:1,fontSize:10}}),a.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Qr,width:"auto",fontSize:10},children:d7.map(p=>a.jsx("option",{value:p,children:p},p))}),a.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Qr,width:50,fontSize:10}}),a.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const p7={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function h7({workspaceId:e,artifactId:t,onArtifactSave:r,mechanicalOpTypes:n=[],mechanicalOps:i=[]}){var X,Y,W;const[s,o]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,x]=m.useState(null),{workflowJson:v,loading:_,error:g,saving:y,lastSaveResult:b,updateWorkflow:w}=P4(e,t,{onSave:$=>{r==null||r(t,$)}}),{templates:S}=R4(),{schemas:k}=A4(),{fragmentsByKind:N}=I4(),E=m.useMemo(()=>{var $;return!l||!v?null:(($=v.nodes)==null?void 0:$.find(Q=>Q.node_id===l))||null},[l,v]),j=m.useMemo(()=>{var $;return!d||!v?null:(($=v.edges)==null?void 0:$.find(Q=>Q.edge_id===d))||null},[d,v]),R=m.useMemo(()=>v!=null&&v.nodes?v.nodes.map($=>$.node_id):[],[v]),T=m.useCallback($=>{w($)},[w]),D=m.useCallback($=>{if(!v)return;const Q=v.nodes.map(ee=>ee.node_id===l?$:ee);let se=v.edges,ae=v.entry_node_ids||[];$.node_id!==l&&(se=v.edges.map(ee=>({...ee,from_node_id:ee.from_node_id===l?$.node_id:ee.from_node_id,to_node_id:ee.to_node_id===l?$.node_id:ee.to_node_id})),ae=ae.map(ee=>ee===l?$.node_id:ee),c($.node_id)),w({...v,nodes:Q,edges:se,entry_node_ids:ae})},[v,l,w]),q=m.useCallback($=>{if(!v)return;const Q=v.edges.map(se=>se.edge_id===d?$:se);$.edge_id!==d&&u($.edge_id),w({...v,edges:Q})},[v,d,w]),C=m.useCallback($=>{v&&(w({...v,nodes:v.nodes.filter(Q=>Q.node_id!==$),edges:v.edges.filter(Q=>Q.from_node_id!==$&&Q.to_node_id!==$),entry_node_ids:(v.entry_node_ids||[]).filter(Q=>Q!==$)}),c(null))},[v,w]),O=m.useCallback($=>{v&&(w({...v,edges:v.edges.filter(Q=>Q.edge_id!==$)}),u(null))},[v,w]),I=m.useCallback($=>{c($),$&&u(null)},[]),F=m.useCallback($=>{u($),$&&c(null)},[]),M=m.useCallback($=>{$==="json"&&v&&(p(JSON.stringify(v,null,2)),x(null)),o($)},[v]),A=m.useCallback($=>{const Q=$.target.value;p(Q);try{const se=JSON.parse(Q);x(null),w(se)}catch(se){x(se.message)}},[w]),L=((X=b==null?void 0:b.tier1_report)==null?void 0:X.results)||[],z=L.filter($=>$.severity==="error").length,B=L.filter($=>$.severity==="warning").length;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[y&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),!y&&!g&&v&&a.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((Y=v.nodes)==null?void 0:Y.length)||0," nodes, ",((W=v.edges)==null?void 0:W.length)||0," edges"]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map($=>a.jsx("button",{onClick:()=>M($.id),style:{...p7,color:s===$.id?"var(--text-primary)":"var(--text-muted)",borderBottom:s===$.id?"2px solid var(--action-primary)":"2px solid transparent"},children:$.label},$.id))}),_?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s==="canvas"&&a.jsxs(a.Fragment,{children:[a.jsx(Zc,{children:a.jsx(i7,{workflowJson:v,onWorkflowChange:T,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:I,onEdgeSelect:F})}),E&&a.jsx(c7,{node:E,onChange:D,onDelete:C,templates:S,schemas:k,roleFragments:N.role||[],taskFragments:N.task||[],pgcFragments:N.pgc||[],mechanicalOpTypes:n,mechanicalOps:i}),j&&a.jsx(f7,{edge:j,nodeIds:R,onChange:q,onDelete:O})]}),s==="json"&&a.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[a.jsx("textarea",{value:f,onChange:A,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),s==="metadata"&&a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:v?a.jsx(m7,{workflow:v}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),L.length>0&&a.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[z>0&&a.jsxs("span",{style:{color:"#ef4444"},children:[z," error",z!==1?"s":""]}),B>0&&a.jsxs("span",{style:{color:"#f59e0b"},children:[B," warning",B!==1?"s":""]}),z===0&&B===0&&a.jsx("span",{style:{color:"#10b981"},children:"Valid"}),a.jsx("span",{style:{color:"var(--text-muted)"},children:L.map($=>$.message).join(" | ")})]})]})}function m7({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],i=e.thread_ownership||{},s=Object.entries(i),o=e.entry_node_ids||[];return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(l=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l.label}),a.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),a.jsxs("div",{children:[a.jsx("label",{style:r,children:"Entry Node IDs"}),a.jsx("div",{style:t,children:o.length>0?o.join(", "):"-"})]}),s.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),s.map(([l,c])=>a.jsxs("div",{children:[a.jsx("label",{style:r,children:l}),a.jsx("div",{style:t,children:c})]},l))]})]})}function pv({label:e,items:t,selectedId:r,onSelect:n,isGroupActive:i}){const[s,o]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!s)return;const c=d=>{l.current&&!l.current.contains(d.target)&&o(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),t.length===0?null:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{onClick:()=>o(!s),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:i?"var(--text-primary)":"var(--text-muted)",background:i?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:i?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,a.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),s&&a.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>a.jsxs("button",{onClick:()=>{n(c.id),o(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:r===c.id?"var(--bg-selected)":"transparent",color:r===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&a.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function hv({label:e,isSelected:t,onClick:r}){return a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function v7({workspaceId:e,docType:t,loading:r=!1,roles:n=[],workflows:i=[],onArtifactSave:s,onCreateDcwWorkflow:o,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var Be,at,Re;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,x]=m.useState("source"),[v,_]=m.useState(null),[g,y]=m.useState(!1),[b,w]=m.useState(null),[S,k]=m.useState(null),[N,E]=m.useState(!1),[j,R]=m.useState(null),[T,D]=m.useState(null),[q,C]=m.useState(!1),[O,I]=m.useState(null),[F,M]=m.useState(null),[A,L]=m.useState(!1),[z,B]=m.useState(null),X=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const Z=t.role_prompt_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="role"?null:{roleId:Z[2],version:Z[3]}},[t==null?void 0:t.role_prompt_ref]),Y=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const Z=t.template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.template_ref]),W=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const Z=t.qa_template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.qa_template_ref]),$=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const Z=t.pgc_template_ref.split(":");return Z.length!==4||Z[0]!=="prompt"||Z[1]!=="template"?null:{templateId:Z[2],version:Z[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!X){_(null);return}y(!0),w(null),we.getRole(X.roleId,X.version).then(Z=>{_(Z.content)}).catch(Z=>{console.error("Failed to load role:",Z),w(Z.message)}).finally(()=>{y(!1)})},[X]),m.useEffect(()=>{if(!Y){k(null);return}E(!0),R(null),we.getTemplate(Y.templateId,Y.version).then(Z=>{k(Z.content)}).catch(Z=>{console.error("Failed to load template:",Z),R(Z.message)}).finally(()=>{E(!1)})},[Y]),m.useEffect(()=>{if(!W){D(null);return}C(!0),I(null),we.getTemplate(W.templateId,W.version).then(Z=>{D(Z.content)}).catch(Z=>{console.error("Failed to load QA template:",Z),I(Z.message)}).finally(()=>{C(!1)})},[W]),m.useEffect(()=>{if(!$){M(null);return}L(!0),B(null),we.getTemplate($.templateId,$.version).then(Z=>{M(Z.content)}).catch(Z=>{console.error("Failed to load PGC template:",Z),B(Z.message)}).finally(()=>{L(!1)})},[$]);const Q=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const Z=t.version||t.active_version;return`doctype:${t.doc_type_id}:${Z}:${f}`},[t,f]),{content:se,loading:ae,error:ee,saving:_e,isDirty:me,updateContent:je,lastSaveResult:ve}=Na(e,Q,{onSave:Z=>{s==null||s(Q,Z)}}),oe=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],G=m.useMemo(()=>t?oe.filter(Z=>Z.id==="package"?!0:Z.id==="role_prompt"?!!t.role_prompt_ref:Z.id==="template"?!!t.template_ref:Z.id==="qa_template"?!!t.qa_template_ref:Z.id==="pgc_template"?!!t.pgc_template_ref:Z.id==="workflow"?!0:t.artifacts?t.artifacts[Z.id]!=null:!1):[],[t]),K=c==="task"||c==="schema";m.useEffect(()=>{K||G.length>0&&!G.find(Z=>Z.id===f)&&p(G[0].id)},[G,f,K]);const J=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",pe=f==="package",fe=f==="schema",be=f==="workflow",xe=!J&&!pe&&!fe&&!be,re=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:i.some(Z=>Z.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,i]),[he,Ke]=m.useState(!1),Fe=async()=>{if(!(!(t!=null&&t.doc_type_id)||!o)){Ke(!0);try{await o(t.doc_type_id)}finally{Ke(!1)}}};if(!t&&!r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),a.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(r)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),a.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const $e=c==="task"?"Interaction":c==="schema"?"Schema":null,Te=!K&&(f==="task_prompt"||f==="schema");return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),a.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:K?$e:a.jsxs(a.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),K&&a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!K&&a.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[G.find(Z=>Z.id==="package")&&a.jsx(hv,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),x("source")}}),G.find(Z=>Z.id==="workflow")&&a.jsx(hv,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),x("source")}}),(()=>{const Z=["role_prompt","task_prompt","template"],Pe=G.filter(ge=>Z.includes(ge.id)).map(ge=>({id:ge.id,label:ge.id==="role_prompt"?"Role":ge.id==="task_prompt"?"Task":"Template",viewOnly:ge.viewOnly}));return Pe.length===0?null:a.jsx(pv,{label:"Generation",items:Pe,selectedId:Z.includes(f)?f:null,onSelect:ge=>{p(ge),x("source")},isGroupActive:Z.includes(f)})})(),(()=>{const Z=["qa_prompt","qa_template"],Pe=G.filter(ge=>Z.includes(ge.id)).map(ge=>({id:ge.id,label:ge.id==="qa_prompt"?"Prompt":"Template",viewOnly:ge.viewOnly}));return Pe.length===0?null:a.jsx(pv,{label:"QA",items:Pe,selectedId:Z.includes(f)?f:null,onSelect:ge=>{p(ge),x("source")},isGroupActive:Z.includes(f)})})(),(()=>{const Z=["pgc_context","pgc_template"],Pe=G.filter(ge=>Z.includes(ge.id)).map(ge=>({id:ge.id,label:ge.id==="pgc_context"?"Context":"Template",viewOnly:ge.viewOnly}));return Pe.length===0?null:a.jsx(pv,{label:"PGC",items:Pe,selectedId:Z.includes(f)?f:null,onSelect:ge=>{p(ge),x("source")},isGroupActive:Z.includes(f)})})(),G.find(Z=>Z.id==="schema")&&a.jsx(hv,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),x("source")}})]}),!K&&xe&&!Te&&a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>x("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),a.jsx("button",{onClick:()=>x("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((Be=t==null?void 0:t.artifacts)==null?void 0:Be[f])&&a.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),J&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&X&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[X.roleId.replace(/_/g," ")," v",X.version]}),f==="template"&&Y&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[Y.templateId.replace(/_/g," ")," v",Y.version]}),f==="qa_template"&&W&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[W.templateId.replace(/_/g," ")," v",W.version]}),f==="pgc_template"&&$&&a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[$.templateId.replace(/_/g," ")," v",$.version]})]}),Te&&a.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),fe&&((at=t==null?void 0:t.artifacts)==null?void 0:at.schema)&&a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:be?re?a.jsx(h7,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s,mechanicalOpTypes:d,mechanicalOps:u}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 max-w-md",children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),a.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),o&&a.jsx("button",{onClick:Fe,disabled:he,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:he?"wait":"pointer",opacity:he?.7:1},children:he?"Creating...":"Create Workflow"})]})}):f==="package"?a.jsx(KH,{workspaceId:e,docType:t,roles:n,onSave:s}):f==="role_prompt"?a.jsx(en,{content:v||"",onChange:()=>{},loading:g,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?a.jsx(en,{content:S||"",onChange:()=>{},loading:N,saving:!1,isDirty:!1,error:j,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?a.jsx(en,{content:T||"",onChange:()=>{},loading:q,saving:!1,isDirty:!1,error:O,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?a.jsx(en,{content:F||"",onChange:()=>{},loading:A,saving:!1,isDirty:!1,error:z,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||fe?a.jsx(en,{content:se,onChange:Te?()=>{}:je,loading:ae,saving:Te?!1:_e,isDirty:Te?!1:me,error:ee,readOnly:Te,placeholder:`Enter ${((Re=G.find(Z=>Z.id===f))==null?void 0:Re.label)||"prompt"} content...`,isJson:fe}):a.jsx(GH,{workspaceId:e,artifactId:Q})}),xe&&(ve==null?void 0:ve.tier1)&&!ve.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function g7({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:i,loading:s,error:o,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=Na(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),a.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),a.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:i,onChange:d,loading:s,saving:l,isDirty:c,error:o,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const x7=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],mv={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},vv={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function y7({workspaceId:e,template:t,onArtifactSave:r}){const[n,i]=m.useState("metadata"),[s,o]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:x,error:v,saving:_,isDirty:g,updateContent:y,lastSaveResult:b}=Na(e,f,{onSave:j=>{r==null||r(f,j)}});m.useEffect(()=>{t&&(o({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const w=m.useCallback((j,R)=>{o(T=>({...T,[j]:R})),c(!0)},[]),S=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const j=Ey.dump({name:s.name||null,purpose:s.purpose||null,use_case:s.use_case||null},{lineWidth:-1});await we.writeArtifact(e,p,j),c(!1),r==null||r(p,{success:!0})}catch(j){console.error("Failed to save metadata:",j),alert(`Failed to save metadata: ${j.message}`)}finally{u(!1)}}},[e,p,s,r]),k=m.useCallback(()=>{l&&S()},[l,S]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),a.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const N=s.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase()),E=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:N}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.active_version]}),a.jsx("span",{children:""}),a.jsx("span",{children:"Shared Template"}),s.purpose&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:s.purpose})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:E.map(j=>a.jsxs("button",{onClick:()=>i(j.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===j.id?"var(--text-primary)":"var(--text-muted)",background:n===j.id?"var(--bg-canvas)":"transparent",borderBottom:n===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[j.label,j.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),j.id==="template"&&g&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},j.id))}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:vv,children:"Template Name"}),a.jsx("input",{type:"text",value:s.name,onChange:j=>w("name",j.target.value),onBlur:k,placeholder:"e.g., Document Generator",style:mv}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),a.jsxs("div",{children:[a.jsx("label",{style:vv,children:"Template Purpose"}),a.jsx("select",{value:s.purpose,onChange:j=>{w("purpose",j.target.value),setTimeout(()=>S(),0)},style:mv,children:x7.map(j=>a.jsx("option",{value:j.value,children:j.label},j.value))}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),a.jsxs("div",{children:[a.jsx("label",{style:vv,children:"Use Case"}),a.jsx("textarea",{value:s.use_case,onChange:j=>w("use_case",j.target.value),onBlur:k,placeholder:"Describe when and how this template should be used...",rows:4,style:{...mv,resize:"vertical"}}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),n==="template"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:a.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:h,onChange:y,loading:x,saving:_,isDirty:g,error:v,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function b7({workspaceId:e,schema:t,onArtifactSave:r}){var g;const[n,i]=m.useState("content"),s=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:o,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=Na(e,s,{onSave:y=>{r==null||r(s,y)}});if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),a.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((g=t.schema_id)==null?void 0:g.replace(/_/g," "))||"Schema",x=t.active_version||t.version||"1.0.0",v=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],_=!e;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",x]}),_&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:v.map(y=>a.jsxs("button",{onClick:()=>i(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===y.id?"var(--text-primary)":"var(--text-muted)",background:n===y.id?"var(--bg-canvas)":"transparent",borderBottom:n===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:o,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:_,isJson:!0})}),n==="info"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Schema ID"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Version"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Title (from JSON)"}),a.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),a.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"File Path"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",x,"/schema.json"]})]}),a.jsxs("div",{children:[a.jsx("label",{style:io,children:"Artifact ID"}),a.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",x]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const _7={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},w7={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},gv={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},so={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function j7({workspaceId:e,fragment:t,onArtifactSave:r}){var L;const[n,i]=m.useState("content"),[s,o]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,x]=((L=t==null?void 0:t.fragment_id)==null?void 0:L.split(":"))||[null,null],v=t?h==="role"?`fragment:role:${x}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,_=t&&h==="role"?`fragment:role:${x}:${t.version}:meta`:null,{content:g,loading:y,error:b,saving:w,isDirty:S,updateContent:k,lastSaveResult:N}=Na(e,v,{onSave:z=>{r==null||r(v,z)}});m.useEffect(()=>{t&&(o({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const E=m.useCallback((z,B)=>{o(X=>({...X,[z]:B})),c(!0)},[]),j=m.useCallback(async()=>{if(!(!e||!_)){u(!0);try{const z=Ey.dump({name:s.name||null,intent:s.intent||null,tags:s.tags.length>0?s.tags:null},{lineWidth:-1});await we.writeArtifact(e,_,z),c(!1),r==null||r(_,{success:!0})}catch(z){console.error("Failed to save metadata:",z),alert(`Failed to save metadata: ${z.message}`)}finally{u(!1)}}},[e,_,s,r]),R=m.useCallback(()=>{l&&_&&j()},[l,_,j]),T=m.useCallback(()=>{const z=f.trim().toLowerCase();z&&!s.tags.includes(z)&&(E("tags",[...s.tags,z]),p(""))},[f,s.tags,E]),D=m.useCallback(z=>{E("tags",s.tags.filter(B=>B!==z))},[s.tags,E]),q=m.useCallback(z=>{z.key==="Enter"&&(z.preventDefault(),T())},[T]);if(!t)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),a.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const C=s.name||t.name||t.fragment_id,O=_7[h]||h,I=w7[h]||"var(--text-muted)",F=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],M=!e,A=_&&!M;return a.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[C,a.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:I,color:"#fff"},children:O})]}),a.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[a.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsxs("span",{children:["from ",t.source_doc_type]})]}),M&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),a.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:F.map(z=>a.jsxs("button",{onClick:()=>i(z.id),className:"px-4 py-2 text-sm transition-colors",style:{color:n===z.id?"var(--text-primary)":"var(--text-muted)",background:n===z.id?"var(--bg-canvas)":"transparent",borderBottom:n===z.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[z.label,z.id==="content"&&S&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),z.id==="metadata"&&l&&a.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},z.id))}),n==="content"&&a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(en,{content:g,onChange:k,loading:y,saving:w,isDirty:S,error:b,placeholder:"Enter prompt content...",readOnly:M})}),n==="metadata"&&a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"max-w-xl space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Kind"}),a.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:I}}),a.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:O})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Name"}),a.jsx("input",{type:"text",value:s.name,onChange:z=>E("name",z.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:gv,disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Intent"}),a.jsx("textarea",{value:s.intent,onChange:z=>E("intent",z.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...gv,resize:"vertical"},disabled:!A}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:s.tags.map(z=>a.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[z,A&&a.jsx("button",{onClick:()=>D(z),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},z))}),A&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:f,onChange:z=>p(z.target.value),onKeyDown:q,placeholder:"Add tag...",style:{...gv,flex:1}}),a.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&a.jsxs("div",{children:[a.jsx("label",{style:so,children:"Source"}),a.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",a.jsx("strong",{children:t.source_doc_type})]}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!A&&!t.source_doc_type&&a.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(N==null?void 0:N.tier1)&&!N.tier1.passed&&a.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:a.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const oo={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},ao={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function S7({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[r,n]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){n(null),s(null);return}(async()=>{l(!0),d(null);try{const v=await we.getMechanicalOp(e.op_id);n(v);const _=t.find(g=>g.type_id===v.type);if(_)s(_);else try{const g=await we.getMechanicalOpType(v.type);s(g)}catch{}}catch(v){console.error("Failed to load mechanical op details:",v),d(v.message),n(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),a.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=r||e;return a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(i==null?void 0:i.name)||u.type}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o&&a.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&a.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!o&&a.jsxs("div",{className:"space-y-6 max-w-2xl",children:[a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Operation ID"}),a.jsx("div",{style:oo,className:"font-mono",children:u.op_id})]}),a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Name"}),a.jsx("div",{style:oo,children:u.name})]}),u.description&&a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Description"}),a.jsx("div",{style:{...oo,whiteSpace:"pre-wrap"},children:u.description})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Type"}),a.jsx("div",{style:oo,children:u.type})]}),a.jsxs("div",{children:[a.jsx("label",{style:ao,children:"Version"}),a.jsx("div",{style:oo,children:u.active_version||u.version})]})]})]})]}),i&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),a.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("span",{style:{fontSize:16},children:[i.icon==="git-merge"&&"",i.icon==="scissors"&&"",i.icon==="check-circle"&&"",i.icon==="shuffle"&&"",i.icon==="git-branch"&&""]}),a.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:i.name}),a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:i.category})]}),a.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:i.description}),a.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=i.inputs)==null?void 0:f.length)>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),i.inputs.map((x,v)=>a.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[x.name,": ",x.type]},v))]}),((p=i.outputs)==null?void 0:p.length)>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),i.outputs.map((x,v)=>a.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[x.name,": ",x.type]},v))]})]})]})]}),u.config&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),a.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&a.jsxs("section",{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),a.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),a.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),a.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),a.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(x=>a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:x},x))})]})]})]}),a.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[a.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",a.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function k7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(i=>i(n))},t)}const yu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Fs(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ty(e){return"nodeType"in e}function Xt(e){var t,r;return e?Fs(e)?e:Ty(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Ry(e){const{Document:t}=Xt(e);return e instanceof t}function Ca(e){return Fs(e)?!1:e instanceof Xt(e).HTMLElement}function O4(e){return e instanceof Xt(e).SVGElement}function zs(e){return e?Fs(e)?e.document:Ty(e)?Ry(e)?e:Ca(e)||O4(e)?e.ownerDocument:document:document:document}const Vr=yu?m.useLayoutEffect:m.useEffect;function Ay(e){const t=m.useRef(e);return Vr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function N7(){const e=m.useRef(null),t=m.useCallback((n,i)=>{e.current=setInterval(n,i)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function ua(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Vr(()=>{r.current!==e&&(r.current=e)},t),r}function Ea(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function wc(e){const t=Ay(e),r=m.useRef(null),n=m.useCallback(i=>{i!==r.current&&(t==null||t(i,r.current)),r.current=i},[]);return[r,n]}function zg(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let xv={};function Ta(e,t){return m.useMemo(()=>{if(t)return t;const r=xv[e]==null?0:xv[e]+1;return xv[e]=r,e+"-"+r},[e,t])}function D4(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((s,o)=>{const l=Object.entries(o);for(const[c,d]of l){const u=s[c];u!=null&&(s[c]=u+e*d)}return s},{...t})}}const ms=D4(1),da=D4(-1);function C7(e){return"clientX"in e&&"clientY"in e}function Iy(e){if(!e)return!1;const{KeyboardEvent:t}=Xt(e.target);return t&&e instanceof t}function E7(e){if(!e)return!1;const{TouchEvent:t}=Xt(e.target);return t&&e instanceof t}function qg(e){if(E7(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return C7(e)?{x:e.clientX,y:e.clientY}:null}const Es=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Es.Translate.toString(e),Es.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),_S="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function T7(e){return e.matches(_S)?e:e.querySelector(_S)}const R7={display:"none"};function A7(e){let{id:t,value:r}=e;return V.createElement("div",{id:t,style:R7},r)}function I7(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return V.createElement("div",{id:t,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function M7(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const L4=m.createContext(null);function P7(e){const t=m.useContext(L4);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function O7(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:i,event:s}=n;e.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[e]),t]}const D7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},L7={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function F7(e){let{announcements:t=L7,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=D7}=e;const{announce:s,announcement:o}=M7(),l=Ta("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),P7(m.useMemo(()=>({onDragStart(f){let{active:p}=f;s(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&s(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;s(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;s(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;s(t.onDragCancel({active:p,over:h}))}}),[s,t])),!c)return null;const u=V.createElement(V.Fragment,null,V.createElement(A7,{id:n,value:i.draggable}),V.createElement(I7,{id:l,announcement:o}));return r?rs.createPortal(u,r):u}var ut;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ut||(ut={}));function jc(){}function Sc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function F4(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const Ar=Object.freeze({x:0,y:0});function z4(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function q4(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function z7(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function wS(e){let{left:t,top:r,height:n,width:i}=e;return[{x:t,y:r},{x:t+i,y:r},{x:t,y:r+n},{x:t+i,y:r+n}]}function $4(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function jS(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const B4=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=jS(t,t.left,t.top),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const d=z4(jS(c),i);s.push({id:l,data:{droppableContainer:o,value:d}})}}return s.sort(q4)},q7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=wS(t),s=[];for(const o of n){const{id:l}=o,c=r.get(l);if(c){const d=wS(c),u=i.reduce((p,h,x)=>p+z4(d[x],h),0),f=Number((u/4).toFixed(4));s.push({id:l,data:{droppableContainer:o,value:f}})}}return s.sort(q4)};function $7(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),o=i-n,l=s-r;if(n<i&&r<s){const c=t.width*t.height,d=e.width*e.height,u=o*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const B7=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const i=[];for(const s of n){const{id:o}=s,l=r.get(o);if(l){const c=$7(l,t);c>0&&i.push({id:o,data:{droppableContainer:s,value:c}})}}return i.sort(z7)};function H7(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function H4(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ar}function W7(e){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...r})}}const U7=W7(1);function V7(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function G7(e,t,r){const n=V7(t);if(!n)return e;const{scaleX:i,scaleY:s,x:o,y:l}=n,c=e.left-o-(1-i)*parseFloat(r),d=e.top-l-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),u=i?e.width/i:e.width,f=s?e.height/s:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const K7={ignoreTransform:!1};function qs(e,t){t===void 0&&(t=K7);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Xt(e).getComputedStyle(e);d&&(r=G7(r,d,u))}const{top:n,left:i,width:s,height:o,bottom:l,right:c}=r;return{top:n,left:i,width:s,height:o,bottom:l,right:c}}function SS(e){return qs(e,{ignoreTransform:!0})}function Y7(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function X7(e,t){return t===void 0&&(t=Xt(e).getComputedStyle(e)),t.position==="fixed"}function Q7(e,t){t===void 0&&(t=Xt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?r.test(s):!1})}function bu(e,t){const r=[];function n(i){if(t!=null&&r.length>=t||!i)return r;if(Ry(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Ca(i)||O4(i)||r.includes(i))return r;const s=Xt(e).getComputedStyle(i);return i!==e&&Q7(i,s)&&r.push(i),X7(i,s)?r:n(i.parentNode)}return e?n(e):r}function W4(e){const[t]=bu(e,1);return t??null}function yv(e){return!yu||!e?null:Fs(e)?e:Ty(e)?Ry(e)||e===zs(e).scrollingElement?window:Ca(e)?e:null:null}function U4(e){return Fs(e)?e.scrollX:e.scrollLeft}function V4(e){return Fs(e)?e.scrollY:e.scrollTop}function $g(e){return{x:U4(e),y:V4(e)}}var mt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(mt||(mt={}));function G4(e){return!yu||!e?!1:e===document.scrollingElement}function K4(e){const t={x:0,y:0},r=G4(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,o=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:n,minScroll:t}}const Z7={x:.2,y:.2};function J7(e,t,r,n,i){let{top:s,left:o,right:l,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=Z7);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=K4(e),h={x:0,y:0},x={x:0,y:0},v={height:t.height*i.y,width:t.width*i.x};return!d&&s<=t.top+v.height?(h.y=mt.Backward,x.y=n*Math.abs((t.top+v.height-s)/v.height)):!u&&c>=t.bottom-v.height&&(h.y=mt.Forward,x.y=n*Math.abs((t.bottom-v.height-c)/v.height)),!p&&l>=t.right-v.width?(h.x=mt.Forward,x.x=n*Math.abs((t.right-v.width-l)/v.width)):!f&&o<=t.left+v.width&&(h.x=mt.Backward,x.x=n*Math.abs((t.left+v.width-o)/v.width)),{direction:h,speed:x}}function eW(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function Y4(e){return e.reduce((t,r)=>ms(t,$g(r)),Ar)}function tW(e){return e.reduce((t,r)=>t+U4(r),0)}function rW(e){return e.reduce((t,r)=>t+V4(r),0)}function nW(e,t){if(t===void 0&&(t=qs),!e)return;const{top:r,left:n,bottom:i,right:s}=t(e);W4(e)&&(i<=0||s<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const iW=[["x",["left","right"],tW],["y",["top","bottom"],rW]];class My{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=bu(r),i=Y4(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,o,l]of iW)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(n),u=i[s]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Io{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var i;(i=this.target)==null||i.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function sW(e){const{EventTarget:t}=Xt(e);return e instanceof t?e:zs(e)}function bv(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var cr;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(cr||(cr={}));function kS(e){e.preventDefault()}function oW(e){e.stopPropagation()}var Ae;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ae||(Ae={}));const X4={start:[Ae.Space,Ae.Enter],cancel:[Ae.Esc],end:[Ae.Space,Ae.Enter,Ae.Tab]},aW=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Ae.Right:return{...r,x:r.x+25};case Ae.Left:return{...r,x:r.x-25};case Ae.Down:return{...r,y:r.y+25};case Ae.Up:return{...r,y:r.y-25}}};class _u{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Io(zs(r)),this.windowListeners=new Io(Xt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(cr.Resize,this.handleCancel),this.windowListeners.add(cr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(cr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&nW(n),r(Ar)}handleKeyDown(t){if(Iy(t)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:s=X4,coordinateGetter:o=aW,scrollBehavior:l="smooth"}=i,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=n.current,u=d?{x:d.left,y:d.top}:Ar;this.referenceCoordinates||(this.referenceCoordinates=u);const f=o(t,{active:r,context:n.current,currentCoordinates:u});if(f){const p=da(f,u),h={x:0,y:0},{scrollableAncestors:x}=n.current;for(const v of x){const _=t.code,{isTop:g,isRight:y,isLeft:b,isBottom:w,maxScroll:S,minScroll:k}=K4(v),N=eW(v),E={x:Math.min(_===Ae.Right?N.right-N.width/2:N.right,Math.max(_===Ae.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(_===Ae.Down?N.bottom-N.height/2:N.bottom,Math.max(_===Ae.Down?N.top:N.top+N.height/2,f.y))},j=_===Ae.Right&&!y||_===Ae.Left&&!b,R=_===Ae.Down&&!w||_===Ae.Up&&!g;if(j&&E.x!==f.x){const T=v.scrollLeft+p.x,D=_===Ae.Right&&T<=S.x||_===Ae.Left&&T>=k.x;if(D&&!p.y){v.scrollTo({left:T,behavior:l});return}D?h.x=v.scrollLeft-T:h.x=_===Ae.Right?v.scrollLeft-S.x:v.scrollLeft-k.x,h.x&&v.scrollBy({left:-h.x,behavior:l});break}else if(R&&E.y!==f.y){const T=v.scrollTop+p.y,D=_===Ae.Down&&T<=S.y||_===Ae.Up&&T>=k.y;if(D&&!p.x){v.scrollTo({top:T,behavior:l});return}D?h.y=v.scrollTop-T:h.y=_===Ae.Down?v.scrollTop-S.y:v.scrollTop-k.y,h.y&&v.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,ms(da(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}_u.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=X4,onActivation:i}=t,{active:s}=r;const{code:o}=e.nativeEvent;if(n.start.includes(o)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function NS(e){return!!(e&&"distance"in e)}function CS(e){return!!(e&&"delay"in e)}class Py{constructor(t,r,n){var i;n===void 0&&(n=sW(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:s}=t,{target:o}=s;this.props=t,this.events=r,this.document=zs(o),this.documentListeners=new Io(this.document),this.listeners=new Io(n),this.windowListeners=new Io(Xt(o)),this.initialCoordinates=(i=qg(s))!=null?i:Ar,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(cr.Resize,this.handleCancel),this.windowListeners.add(cr.DragStart,kS),this.windowListeners.add(cr.VisibilityChange,this.handleCancel),this.windowListeners.add(cr.ContextMenu,kS),this.documentListeners.add(cr.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(CS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(NS(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:i}=this.props;i(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(cr.Click,oW,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(cr.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const c=(r=qg(t))!=null?r:Ar,d=da(i,c);if(!n&&l){if(NS(l)){if(l.tolerance!=null&&bv(d,l.tolerance))return this.handleCancel();if(bv(d,l.distance))return this.handleStart()}if(CS(l)&&bv(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Ae.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const lW={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class wu extends Py{constructor(t){const{event:r}=t,n=zs(r.target);super(t,lW,n)}}wu.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const cW={move:{name:"mousemove"},end:{name:"mouseup"}};var Bg;(function(e){e[e.RightClick=2]="RightClick"})(Bg||(Bg={}));class uW extends Py{constructor(t){super(t,cW,zs(t.event.target))}}uW.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Bg.RightClick?!1:(n==null||n({event:r}),!0)}}];const _v={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class dW extends Py{constructor(t){super(t,_v)}static setup(){return window.addEventListener(_v.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(_v.move.name,t)};function t(){}}}dW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];var Mo;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Mo||(Mo={}));var kc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(kc||(kc={}));function fW(e){let{acceleration:t,activator:r=Mo.Pointer,canScroll:n,draggingRect:i,enabled:s,interval:o=5,order:l=kc.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=hW({delta:f,disabled:!s}),[x,v]=N7(),_=m.useRef({x:0,y:0}),g=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(r){case Mo.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Mo.DraggableRect:return i}},[r,i,c]),b=m.useRef(null),w=m.useCallback(()=>{const k=b.current;if(!k)return;const N=_.current.x*g.current.x,E=_.current.y*g.current.y;k.scrollBy(N,E)},[]),S=m.useMemo(()=>l===kc.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!s||!d.length||!y){v();return}for(const k of S){if((n==null?void 0:n(k))===!1)continue;const N=d.indexOf(k),E=u[N];if(!E)continue;const{direction:j,speed:R}=J7(k,E,y,t,p);for(const T of["x","y"])h[T][j[T]]||(R[T]=0,j[T]=0);if(R.x>0||R.y>0){v(),b.current=k,x(w,o),_.current=R,g.current=j;return}}_.current={x:0,y:0},g.current={x:0,y:0},v()},[t,w,n,v,s,o,JSON.stringify(y),JSON.stringify(h),x,d,S,u,JSON.stringify(p)])}const pW={x:{[mt.Backward]:!1,[mt.Forward]:!1},y:{[mt.Backward]:!1,[mt.Forward]:!1}};function hW(e){let{delta:t,disabled:r}=e;const n=zg(t);return Ea(i=>{if(r||!n||!i)return pW;const s={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[mt.Backward]:i.x[mt.Backward]||s.x===-1,[mt.Forward]:i.x[mt.Forward]||s.x===1},y:{[mt.Backward]:i.y[mt.Backward]||s.y===-1,[mt.Forward]:i.y[mt.Forward]||s.y===1}}},[r,t,n])}function mW(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Ea(i=>{var s;return t==null?null:(s=n??i)!=null?s:null},[n,t])}function vW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:i}=n,s=i.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,n)}));return[...r,...s]},[]),[e,t])}var fa;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(fa||(fa={}));var Hg;(function(e){e.Optimized="optimized"})(Hg||(Hg={}));const ES=new Map;function gW(e,t){let{dragging:r,dependencies:n,config:i}=t;const[s,o]=m.useState(null),{frequency:l,measure:c,strategy:d}=i,u=m.useRef(e),f=_(),p=ua(f),h=m.useCallback(function(g){g===void 0&&(g=[]),!p.current&&o(y=>y===null?g:y.concat(g.filter(b=>!y.includes(b))))},[p]),x=m.useRef(null),v=Ea(g=>{if(f&&!r)return ES;if(!g||g===ES||u.current!==e||s!=null){const y=new Map;for(let b of e){if(!b)continue;if(s&&s.length>0&&!s.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const w=b.node.current,S=w?new My(c(w),w):null;b.rect.current=S,S&&y.set(b.id,S)}return y}return g},[e,s,r,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),m.useEffect(()=>{f||typeof l!="number"||x.current!==null||(x.current=setTimeout(()=>{h(),x.current=null},l))},[l,f,h,...n]),{droppableRects:v,measureDroppableContainers:h,measuringScheduled:s!=null};function _(){switch(d){case fa.Always:return!1;case fa.BeforeDragging:return r;default:return!r}}}function Q4(e,t){return Ea(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function xW(e,t){return Q4(e,t)}function yW(e){let{callback:t,disabled:r}=e;const n=Ay(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(n)},[n,r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function ju(e){let{callback:t,disabled:r}=e;const n=Ay(t),i=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(n)},[r]);return m.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function bW(e){return new My(qs(e),e)}function TS(e,t,r){t===void 0&&(t=bW);const[n,i]=m.useState(null);function s(){i(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??r)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const o=yW({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=ju({callback:s});return Vr(()=>{s(),e?(l==null||l.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[e]),n}function _W(e){const t=Q4(e);return H4(e,t)}const RS=[];function wW(e){const t=m.useRef(e),r=Ea(n=>e?n&&n!==RS&&e&&t.current&&e.parentNode===t.current.parentNode?n:bu(e):RS,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function jW(e){const[t,r]=m.useState(null),n=m.useRef(e),i=m.useCallback(s=>{const o=yv(s.target);o&&r(l=>l?(l.set(o,$g(o)),new Map(l)):null)},[]);return m.useEffect(()=>{const s=n.current;if(e!==s){o(s);const l=e.map(c=>{const d=yv(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,$g(d)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{o(e),o(s)};function o(l){l.forEach(c=>{const d=yv(c);d==null||d.removeEventListener("scroll",i)})}},[i,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,o)=>ms(s,o),Ar):Y4(e):Ar,[e,t])}function AS(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==Ar;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?da(e,r.current):Ar}function SW(e){m.useEffect(()=>{if(!yu)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function kW(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:i,handler:s}=n;return r[i]=o=>{s(o,t)},r},{}),[e,t])}function Z4(e){return m.useMemo(()=>e?Y7(e):null,[e])}const IS=[];function NW(e,t){t===void 0&&(t=qs);const[r]=e,n=Z4(r?Xt(r):null),[i,s]=m.useState(IS);function o(){s(()=>e.length?e.map(c=>G4(c)?n:new My(t(c),c)):IS)}const l=ju({callback:o});return Vr(()=>{l==null||l.disconnect(),o(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),i}function CW(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ca(t)?t:e}function EW(e){let{measure:t}=e;const[r,n]=m.useState(null),i=m.useCallback(d=>{for(const{target:u}of d)if(Ca(u)){n(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),s=ju({callback:i}),o=m.useCallback(d=>{const u=CW(d);s==null||s.disconnect(),u&&(s==null||s.observe(u)),n(u?t(u):null)},[t,s]),[l,c]=wc(o);return m.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const TW=[{sensor:wu,options:{}},{sensor:_u,options:{}}],RW={current:{}},Al={draggable:{measure:SS},droppable:{measure:SS,strategy:fa.WhileDragging,frequency:Hg.Optimized},dragOverlay:{measure:qs}};class Po extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const AW={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Po,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:jc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Al,measureDroppableContainers:jc,windowRect:null,measuringScheduled:!1},IW={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:jc,draggableNodes:new Map,over:null,measureDroppableContainers:jc},Su=m.createContext(IW),J4=m.createContext(AW);function MW(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Po}}}function PW(e,t){switch(t.type){case ut.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ut.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ut.DragEnd:case ut.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ut.RegisterDroppable:{const{element:r}=t,{id:n}=r,i=new Po(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case ut.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new Po(e.droppable.containers);return o.set(r,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case ut.UnregisterDroppable:{const{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const s=new Po(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function OW(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:i}=m.useContext(Su),s=zg(n),o=zg(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&s&&o!=null){if(!Iy(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=T7(u);if(f){f.focus();break}}})}},[n,t,i,o,s]),null}function DW(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...n}),r):r}function LW(e){return m.useMemo(()=>({draggable:{...Al.draggable,...e==null?void 0:e.draggable},droppable:{...Al.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Al.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function FW(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e;const s=m.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Vr(()=>{if(!o&&!l||!t){s.current=!1;return}if(s.current||!n)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=r(d),f=H4(u,n);if(o||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=W4(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,o,l,n,r])}const eR=m.createContext({...Ar,scaleX:1,scaleY:1});var Cn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Cn||(Cn={}));const tR=m.memo(function(t){var r,n,i,s;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:u=TW,collisionDetection:f=B7,measuring:p,modifiers:h,...x}=t;const v=m.useReducer(PW,void 0,MW),[_,g]=v,[y,b]=O7(),[w,S]=m.useState(Cn.Uninitialized),k=w===Cn.Initialized,{draggable:{active:N,nodes:E,translate:j},droppable:{containers:R}}=_,T=N!=null?E.get(N):null,D=m.useRef({initial:null,translated:null}),q=m.useMemo(()=>{var ne;return N!=null?{id:N,data:(ne=T==null?void 0:T.data)!=null?ne:RW,rect:D}:null},[N,T]),C=m.useRef(null),[O,I]=m.useState(null),[F,M]=m.useState(null),A=ua(x,Object.values(x)),L=Ta("DndDescribedBy",o),z=m.useMemo(()=>R.getEnabled(),[R]),B=LW(p),{droppableRects:X,measureDroppableContainers:Y,measuringScheduled:W}=gW(z,{dragging:k,dependencies:[j.x,j.y],config:B.droppable}),$=mW(E,N),Q=m.useMemo(()=>F?qg(F):null,[F]),se=U(),ae=xW($,B.draggable.measure);FW({activeNode:N!=null?E.get(N):null,config:se.layoutShiftCompensation,initialRect:ae,measure:B.draggable.measure});const ee=TS($,B.draggable.measure,ae),_e=TS($?$.parentElement:null),me=m.useRef({activatorEvent:null,active:null,activeNode:$,collisionRect:null,collisions:null,droppableRects:X,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=R.getNodeFor((r=me.current.over)==null?void 0:r.id),ve=EW({measure:B.dragOverlay.measure}),oe=(n=ve.nodeRef.current)!=null?n:$,G=k?(i=ve.rect)!=null?i:ee:null,K=!!(ve.nodeRef.current&&ve.rect),J=_W(K?null:ee),pe=Z4(oe?Xt(oe):null),fe=wW(k?je??$:null),be=NW(fe),xe=DW(h,{transform:{x:j.x-J.x,y:j.y-J.y,scaleX:1,scaleY:1},activatorEvent:F,active:q,activeNodeRect:ee,containerNodeRect:_e,draggingNodeRect:G,over:me.current.over,overlayNodeRect:ve.rect,scrollableAncestors:fe,scrollableAncestorRects:be,windowRect:pe}),re=Q?ms(Q,j):null,he=jW(fe),Ke=AS(he),Fe=AS(he,[ee]),$e=ms(xe,Ke),Te=G?U7(G,xe):null,Be=q&&Te?f({active:q,collisionRect:Te,droppableRects:X,droppableContainers:z,pointerCoordinates:re}):null,at=$4(Be,"id"),[Re,Z]=m.useState(null),Pe=K?xe:ms(xe,Fe),ge=H7(Pe,(s=Re==null?void 0:Re.rect)!=null?s:null,ee),Nt=m.useRef(null),xt=m.useCallback((ne,Oe)=>{let{sensor:lt,options:ar}=Oe;if(C.current==null)return;const Ct=E.get(C.current);if(!Ct)return;const bt=ne.nativeEvent,qt=new lt({active:C.current,activeNode:Ct,event:bt,options:ar,context:me,onAbort(ie){if(!E.get(ie))return;const{onDragAbort:Et}=A.current,br={id:ie};Et==null||Et(br),y({type:"onDragAbort",event:br})},onPending(ie,He,Et,br){if(!E.get(ie))return;const{onDragPending:ri}=A.current,Or={id:ie,constraint:He,initialCoordinates:Et,offset:br};ri==null||ri(Or),y({type:"onDragPending",event:Or})},onStart(ie){const He=C.current;if(He==null)return;const Et=E.get(He);if(!Et)return;const{onDragStart:br}=A.current,ti={activatorEvent:bt,active:{id:He,data:Et.data,rect:D}};rs.unstable_batchedUpdates(()=>{br==null||br(ti),S(Cn.Initializing),g({type:ut.DragStart,initialCoordinates:ie,active:He}),y({type:"onDragStart",event:ti}),I(Nt.current),M(bt)})},onMove(ie){g({type:ut.DragMove,coordinates:ie})},onEnd:ue(ut.DragEnd),onCancel:ue(ut.DragCancel)});Nt.current=qt;function ue(ie){return async function(){const{active:Et,collisions:br,over:ti,scrollAdjustedTranslate:ri}=me.current;let Or=null;if(Et&&ri){const{cancelDrop:ni}=A.current;Or={activatorEvent:bt,active:Et,collisions:br,delta:ri,over:ti},ie===ut.DragEnd&&typeof ni=="function"&&await Promise.resolve(ni(Or))&&(ie=ut.DragCancel)}C.current=null,rs.unstable_batchedUpdates(()=>{g({type:ie}),S(Cn.Uninitialized),Z(null),I(null),M(null),Nt.current=null;const ni=ie===ut.DragEnd?"onDragEnd":"onDragCancel";if(Or){const $s=A.current[ni];$s==null||$s(Or),y({type:ni,event:Or})}})}}},[E]),yt=m.useCallback((ne,Oe)=>(lt,ar)=>{const Ct=lt.nativeEvent,bt=E.get(ar);if(C.current!==null||!bt||Ct.dndKit||Ct.defaultPrevented)return;const qt={active:bt};ne(lt,Oe.options,qt)===!0&&(Ct.dndKit={capturedBy:Oe.sensor},C.current=ar,xt(lt,Oe))},[E,xt]),Qt=vW(u,yt);SW(u),Vr(()=>{ee&&w===Cn.Initializing&&S(Cn.Initialized)},[ee,w]),m.useEffect(()=>{const{onDragMove:ne}=A.current,{active:Oe,activatorEvent:lt,collisions:ar,over:Ct}=me.current;if(!Oe||!lt)return;const bt={active:Oe,activatorEvent:lt,collisions:ar,delta:{x:$e.x,y:$e.y},over:Ct};rs.unstable_batchedUpdates(()=>{ne==null||ne(bt),y({type:"onDragMove",event:bt})})},[$e.x,$e.y]),m.useEffect(()=>{const{active:ne,activatorEvent:Oe,collisions:lt,droppableContainers:ar,scrollAdjustedTranslate:Ct}=me.current;if(!ne||C.current==null||!Oe||!Ct)return;const{onDragOver:bt}=A.current,qt=ar.get(at),ue=qt&&qt.rect.current?{id:qt.id,rect:qt.rect.current,data:qt.data,disabled:qt.disabled}:null,ie={active:ne,activatorEvent:Oe,collisions:lt,delta:{x:Ct.x,y:Ct.y},over:ue};rs.unstable_batchedUpdates(()=>{Z(ue),bt==null||bt(ie),y({type:"onDragOver",event:ie})})},[at]),Vr(()=>{me.current={activatorEvent:F,active:q,activeNode:$,collisionRect:Te,collisions:Be,droppableRects:X,draggableNodes:E,draggingNode:oe,draggingNodeRect:G,droppableContainers:R,over:Re,scrollableAncestors:fe,scrollAdjustedTranslate:$e},D.current={initial:G,translated:Te}},[q,$,Be,Te,E,oe,G,X,R,Re,fe,$e]),fW({...se,delta:j,draggingRect:Te,pointerCoordinates:re,scrollableAncestors:fe,scrollableAncestorRects:be});const P=m.useMemo(()=>({active:q,activeNode:$,activeNodeRect:ee,activatorEvent:F,collisions:Be,containerNodeRect:_e,dragOverlay:ve,draggableNodes:E,droppableContainers:R,droppableRects:X,over:Re,measureDroppableContainers:Y,scrollableAncestors:fe,scrollableAncestorRects:be,measuringConfiguration:B,measuringScheduled:W,windowRect:pe}),[q,$,ee,F,Be,_e,ve,E,R,X,Re,Y,fe,be,B,W,pe]),H=m.useMemo(()=>({activatorEvent:F,activators:Qt,active:q,activeNodeRect:ee,ariaDescribedById:{draggable:L},dispatch:g,draggableNodes:E,over:Re,measureDroppableContainers:Y}),[F,Qt,q,ee,g,L,E,Re,Y]);return V.createElement(L4.Provider,{value:b},V.createElement(Su.Provider,{value:H},V.createElement(J4.Provider,{value:P},V.createElement(eR.Provider,{value:ge},d)),V.createElement(OW,{disabled:(l==null?void 0:l.restoreFocus)===!1})),V.createElement(F7,{...l,hiddenTextDescribedById:L}));function U(){const ne=(O==null?void 0:O.autoScrollEnabled)===!1,Oe=typeof c=="object"?c.enabled===!1:c===!1,lt=k&&!ne&&!Oe;return typeof c=="object"?{...c,enabled:lt}:{enabled:lt}}}),zW=m.createContext(null),MS="button",qW="Draggable";function $W(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e;const s=Ta(qW),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(Su),{role:h=MS,roleDescription:x="draggable",tabIndex:v=0}=i??{},_=(c==null?void 0:c.id)===t,g=m.useContext(_?eR:zW),[y,b]=wc(),[w,S]=wc(),k=kW(o,t),N=ua(r);Vr(()=>(f.set(t,{id:t,key:s,node:y,activatorNode:w,data:N}),()=>{const j=f.get(t);j&&j.key===s&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:h,tabIndex:v,"aria-disabled":n,"aria-pressed":_&&h===MS?!0:void 0,"aria-roledescription":x,"aria-describedby":u.draggable}),[n,h,v,_,x,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:E,isDragging:_,listeners:n?void 0:k,node:y,over:p,setNodeRef:b,setActivatorNodeRef:S,transform:g}}function BW(){return m.useContext(J4)}const HW="Droppable",WW={timeout:25};function UW(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e;const s=Ta(HW),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(Su),u=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:x,updateMeasurementsFor:v,timeout:_}={...WW,...i},g=ua(v??n),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(g.current)?g.current:[g.current]),h.current=null},_)},[_]),b=ju({callback:y,disabled:x||!o}),w=m.useCallback((E,j)=>{b&&(j&&(b.unobserve(j),f.current=!1),E&&b.observe(E))},[b]),[S,k]=wc(w),N=ua(t);return m.useEffect(()=>{!b||!S.current||(b.disconnect(),f.current=!1,b.observe(S.current))},[S,b]),m.useEffect(()=>(l({type:ut.RegisterDroppable,element:{id:n,key:s,disabled:r,node:S,rect:p,data:N}}),()=>l({type:ut.UnregisterDroppable,key:s,id:n})),[n]),m.useEffect(()=>{r!==u.current.disabled&&(l({type:ut.SetDroppableDisabled,id:n,key:s,disabled:r}),u.current.disabled=r)},[n,s,r,l]),{active:o,rect:p,isOver:(c==null?void 0:c.id)===n,node:S,over:c,setNodeRef:k}}function ku(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function VW(e,t){return e.reduce((r,n,i)=>{const s=t.get(n);return s&&(r[i]=s),r},Array(e.length))}function pl(e){return e!==null&&e>=0}function GW(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function KW(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const rR=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e;const s=ku(t,n,r),o=t[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},hl={scaleX:1,scaleY:1},nR=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:s,overIndex:o}=e;const l=(t=s[r])!=null?t:n;if(!l)return null;if(i===r){const d=s[o];return d?{x:0,y:r<o?d.top+d.height-(l.top+l.height):d.top-l.top,...hl}:null}const c=YW(s,i,r);return i>r&&i<=o?{x:0,y:-l.height-c,...hl}:i<r&&i>=o?{x:0,y:l.height+c,...hl}:{x:0,y:0,...hl}};function YW(e,t,r){const n=e[t],i=e[t-1],s=e[t+1];return n?r<t?i?n.top-(i.top+i.height):s?s.top-(n.top+n.height):0:s?s.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const iR="Sortable",sR=V.createContext({activeIndex:-1,containerId:iR,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:rR,disabled:{draggable:!1,droppable:!1}});function oR(e){let{children:t,id:r,items:n,strategy:i=rR,disabled:s=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=BW(),f=Ta(iR,r),p=l.rect!==null,h=m.useMemo(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),x=o!=null,v=o?h.indexOf(o.id):-1,_=d?h.indexOf(d.id):-1,g=m.useRef(h),y=!GW(h,g.current),b=_!==-1&&v===-1||y,w=KW(s);Vr(()=>{y&&x&&u(h)},[y,h,x,u]),m.useEffect(()=>{g.current=h},[h]);const S=m.useMemo(()=>({activeIndex:v,containerId:f,disabled:w,disableTransforms:b,items:h,overIndex:_,useDragOverlay:p,sortedRects:VW(h,c),strategy:i}),[v,f,w.draggable,w.droppable,b,h,_,c,p,i]);return V.createElement(sR.Provider,{value:S},t)}const XW=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return ku(r,n,i).indexOf(t)},QW=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!n||l!==s&&i===o?!1:r?!0:o!==i&&t===c},ZW={duration:200,easing:"ease"},aR="transform",JW=Es.Transition.toString({property:aR,duration:0,easing:"linear"}),eU={roleDescription:"sortable"};function tU(e){let{disabled:t,index:r,node:n,rect:i}=e;const[s,o]=m.useState(null),l=m.useRef(r);return Vr(()=>{if(!t&&r!==l.current&&n.current){const c=i.current;if(c){const d=qs(n.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&o(u)}}r!==l.current&&(l.current=r)},[t,r,n,i]),m.useEffect(()=>{s&&o(null)},[s]),s}function lR(e){let{animateLayoutChanges:t=QW,attributes:r,disabled:n,data:i,getNewIndex:s=XW,id:o,strategy:l,resizeObserverConfig:c,transition:d=ZW}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:x,sortedRects:v,overIndex:_,useDragOverlay:g,strategy:y}=m.useContext(sR),b=rU(n,h),w=u.indexOf(o),S=m.useMemo(()=>({sortable:{containerId:f,index:w,items:u},...i}),[f,i,w,u]),k=m.useMemo(()=>u.slice(u.indexOf(o)),[u,o]),{rect:N,node:E,isOver:j,setNodeRef:R}=UW({id:o,data:S,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:T,activatorEvent:D,activeNodeRect:q,attributes:C,setNodeRef:O,listeners:I,isDragging:F,over:M,setActivatorNodeRef:A,transform:L}=$W({id:o,data:S,attributes:{...eU,...r},disabled:b.draggable}),z=k7(R,O),B=!!T,X=B&&!x&&pl(p)&&pl(_),Y=!g&&F,W=Y&&X?L:null,Q=X?W??(l??y)({rects:v,activeNodeRect:q,activeIndex:p,overIndex:_,index:w}):null,se=pl(p)&&pl(_)?s({id:o,items:u,activeIndex:p,overIndex:_}):w,ae=T==null?void 0:T.id,ee=m.useRef({activeId:ae,items:u,newIndex:se,containerId:f}),_e=u!==ee.current.items,me=t({active:T,containerId:f,isDragging:F,isSorting:B,id:o,index:w,items:u,newIndex:ee.current.newIndex,previousItems:ee.current.items,previousContainerId:ee.current.containerId,transition:d,wasDragging:ee.current.activeId!=null}),je=tU({disabled:!me,index:w,node:E,rect:N});return m.useEffect(()=>{B&&ee.current.newIndex!==se&&(ee.current.newIndex=se),f!==ee.current.containerId&&(ee.current.containerId=f),u!==ee.current.items&&(ee.current.items=u)},[B,se,f,u]),m.useEffect(()=>{if(ae===ee.current.activeId)return;if(ae!=null&&ee.current.activeId==null){ee.current.activeId=ae;return}const oe=setTimeout(()=>{ee.current.activeId=ae},50);return()=>clearTimeout(oe)},[ae]),{active:T,activeIndex:p,attributes:C,data:S,rect:N,index:w,newIndex:se,items:u,isOver:j,isSorting:B,isDragging:F,listeners:I,node:E,overIndex:_,over:M,setNodeRef:z,setActivatorNodeRef:A,setDroppableNodeRef:R,setDraggableNodeRef:O,transform:je??Q,transition:ve()};function ve(){if(je||_e&&ee.current.newIndex===w)return JW;if(!(Y&&!Iy(D)||!d)&&(B||me))return Es.Transition.toString({...d,property:aR})}}function rU(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Nc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const nU=[Ae.Down,Ae.Right,Ae.Up,Ae.Left],cR=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:l}}=t;if(nU.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=i.get(f.id);if(p)switch(e.code){case Ae.Down:n.top<p.top&&c.push(f);break;case Ae.Up:n.top>p.top&&c.push(f);break;case Ae.Left:n.left>p.left&&c.push(f);break;case Ae.Right:n.left<p.left&&c.push(f);break}});const d=q7({collisionRect:n,droppableRects:i,droppableContainers:c});let u=$4(d,"id");if(u===(o==null?void 0:o.id)&&d.length>1&&(u=d[1].id),u!=null){const f=s.get(r.id),p=s.get(u),h=p?i.get(p.id):null,x=p==null?void 0:p.node.current;if(x&&h&&f&&p){const _=bu(x).some((k,N)=>l[N]!==k),g=uR(f,p),y=iU(f,p),b=_||!g?{x:0,y:0}:{x:y?n.width-h.width:0,y:y?n.height-h.height:0},w={x:h.left,y:h.top};return b.x&&b.y?w:da(w,b)}}}};function uR(e,t){return!Nc(e)||!Nc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function iU(e,t){return!Nc(e)||!Nc(t)||!uR(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const sU={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},Lr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},lr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},dR={step_id:"new_step",produces:"",scope:"",inputs:[]},oU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function aU({workspaceId:e,workflow:t,documentTypes:r=[],onArtifactSave:n,onDelete:i,onNavigateToWorkflow:s}){const[o,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:x,error:v,saving:_,updateWorkflow:g}=P4(e,p,{onSave:j=>{n==null||n(p,j)}}),y=m.useCallback(j=>{j==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(j)},[h]),b=m.useCallback(j=>{const R=j.target.value;d(R);try{const T=JSON.parse(R);f(null),g(T)}catch(T){f(T.message)}},[g]),w=m.useCallback((j,R)=>{if(!h)return;const T=[...h.steps];T[j]=R,g({...h,steps:T})},[h,g]),S=m.useCallback(j=>{if(!h)return;const R=h.steps.filter((T,D)=>D!==j);g({...h,steps:R})},[h,g]),k=m.useCallback(j=>{var T,D;if(!h)return;const R=j==="iteration"?{...oU,step_id:`new_iteration_${(((T=h.steps)==null?void 0:T.length)||0)+1}`}:{...dR,step_id:`new_step_${(((D=h.steps)==null?void 0:D.length)||0)+1}`};g({...h,steps:[...h.steps||[],R]})},[h,g]),N=m.useCallback((j,R)=>{if(!h)return;const T=ku(h.steps,j,R);g({...h,steps:T})},[h,g]),E=m.useCallback(()=>{!i||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&i(t.workflow_id)},[i,t]);return t?a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&a.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),a.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[_&&a.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),v&&a.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:v}),i&&a.jsx("button",{onClick:E,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),a.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(j=>a.jsx("button",{onClick:()=>y(j.id),style:{...sU,color:o===j.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:j.label},j.id))}),x?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):a.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&a.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[a.jsx(lU,{steps:(h==null?void 0:h.steps)||[],documentTypes:r,onStepChange:w,onStepDelete:S,onReorder:N}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>k("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),a.jsx("button",{onClick:()=>k("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&a.jsxs("div",{className:"h-full flex flex-col p-4",children:[a.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&a.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),o==="metadata"&&a.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?a.jsx(fU,{workflow:h,onUpdateWorkflow:g,onNavigateToWorkflow:s}):a.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[a.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),a.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function lU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=F4(Sc(wu,{activationConstraint:{distance:5}}),Sc(_u,{coordinateGetter:cR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):a.jsx(tR,{sensors:s,collisionDetection:B4,onDragEnd:l,children:a.jsx(oR,{items:o,strategy:nR,children:e.map((c,d)=>a.jsx(cU,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function cU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=lR({id:e.step_id}),f={transform:Es.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(fR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o}})})}function fR({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i,dragHandleProps:s,depth:o=0}){var k,N,E;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(j,R)=>{const T={...l,[j]:R};c(T),n(t,T)},h=(j,R)=>{const T={...l.iterate_over,[j]:R},D={...l,iterate_over:T};c(D),n(t,D)},x=()=>{const j=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:j};c(R),n(t,R)},v=(j,R,T)=>{const D=[...l.inputs||[]];D[j]={...D[j],[R]:T};const q={...l,inputs:D};c(q),n(t,q)},_=j=>{const R=(l.inputs||[]).filter((D,q)=>q!==j),T={...l,inputs:R};c(T),n(t,T)},g=m.useCallback((j,R)=>{const T=[...l.steps||[]];T[j]=R;const D={...l,steps:T};c(D),n(t,D)},[l,t,n]),y=m.useCallback(j=>{const R=(l.steps||[]).filter((D,q)=>q!==j),T={...l,steps:R};c(T),n(t,T)},[l,t,n]),b=m.useCallback(()=>{var T;const j=[...l.steps||[],{...dR,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],R={...l,steps:j};c(R),n(t,R)},[l,t,n]),w=m.useCallback((j,R)=>{const T=ku(l.steps||[],j,R),D={...l,steps:T};c(D),n(t,D)},[l,t,n]),S={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return a.jsxs("div",{style:S,children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[s&&a.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[a.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),a.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),a.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),a.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),a.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),a.jsx("span",{style:{flex:1}}),a.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?a.jsx("path",{d:"M18 15l-6-6-6 6"}):a.jsx("path",{d:"M6 9l6 6 6-6"})})}),a.jsx("button",{onClick:()=>i(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Step ID"}),a.jsx("input",{type:"text",value:l.step_id||"",onChange:j=>p("step_id",j.target.value),style:Lr})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Doc Type"}),a.jsxs("select",{value:((k=l.iterate_over)==null?void 0:k.doc_type)||"",onChange:j=>h("doc_type",j.target.value),style:Lr,children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(j=>a.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Collection Field"}),a.jsx("input",{type:"text",value:((N=l.iterate_over)==null?void 0:N.collection_field)||"",onChange:j=>h("collection_field",j.target.value),style:Lr})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Entity Type"}),a.jsx("input",{type:"text",value:((E=l.iterate_over)==null?void 0:E.entity_type)||"",onChange:j=>h("entity_type",j.target.value),style:Lr})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:j=>p("scope",j.target.value),style:Lr})]}),a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{style:lr,children:"Nested Steps"}),a.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),a.jsx(uU,{steps:l.steps||[],documentTypes:r,onStepChange:g,onStepDelete:y,onReorder:w})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Produces"}),a.jsxs("select",{value:l.produces||"",onChange:j=>p("produces",j.target.value),style:Lr,children:[a.jsx("option",{value:"",children:"-- Select document type --"}),r.map(j=>a.jsx("option",{value:j.doc_type_id,children:j.doc_type_id},j.doc_type_id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Scope"}),a.jsx("input",{type:"text",value:l.scope||"",onChange:j=>p("scope",j.target.value),placeholder:"project",style:Lr})]}),a.jsxs("div",{children:[a.jsx("label",{style:lr,children:"Creates Entities"}),a.jsx("input",{type:"text",value:l.creates_entities||"",onChange:j=>p("creates_entities",j.target.value||void 0),placeholder:"e.g., epic",style:Lr})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{style:lr,children:"Inputs"}),a.jsx("button",{onClick:x,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):a.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((j,R)=>a.jsxs("div",{className:"flex gap-1 items-end",children:[a.jsxs("div",{style:{flex:1},children:[R===0&&a.jsx("label",{style:{...lr,fontSize:9},children:"Doc/Entity Type"}),a.jsxs("select",{value:j.doc_type||j.entity_type||"",onChange:T=>{const D=T.target.value;j.entity_type!==void 0?v(R,"entity_type",D):v(R,"doc_type",D)},style:{...Lr,fontSize:11},children:[a.jsx("option",{value:"",children:"-- Select --"}),r.map(T=>a.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),a.jsxs("div",{style:{width:"30%"},children:[R===0&&a.jsx("label",{style:{...lr,fontSize:9},children:"Scope"}),a.jsx("input",{type:"text",value:j.scope||"",onChange:T=>v(R,"scope",T.target.value),placeholder:"scope",style:{...Lr,fontSize:11}})]}),a.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[a.jsx("input",{type:"checkbox",checked:j.context||!1,onChange:T=>v(R,"context",T.target.checked||void 0)}),"ctx"]}),a.jsx("button",{onClick:()=>_(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function uU({steps:e,documentTypes:t=[],onStepChange:r,onStepDelete:n,onReorder:i}){const s=F4(Sc(wu,{activationConstraint:{distance:5}}),Sc(_u,{coordinateGetter:cR})),o=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&i(f,p)},[e,i]);return e.length===0?a.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):a.jsx(tR,{sensors:s,collisionDetection:B4,onDragEnd:l,children:a.jsx(oR,{items:o,strategy:nR,children:e.map((c,d)=>a.jsx(dU,{step:c,index:d,documentTypes:t,onChange:r,onDelete:n},c.step_id))})})}function dU({step:e,index:t,documentTypes:r=[],onChange:n,onDelete:i}){const{attributes:s,listeners:o,setNodeRef:l,transform:c,transition:d,isDragging:u}=lR({id:e.step_id}),f={transform:Es.Transform.toString(c),transition:d,opacity:u?.5:1};return a.jsx("div",{ref:l,style:f,children:a.jsx(fR,{step:e,index:t,documentTypes:r,onChange:n,onDelete:i,dragHandleProps:{...s,...o},depth:1})})}function fU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,i]=m.useState(""),s={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},o={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,x=e.source_version,v=e.tags||[],_=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||v.includes(b)||(t==null||t({...e,tags:[...v,b]}),i(""))},g=b=>{t==null||t({...e,tags:v.filter(w=>w!==b)})},y=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"POW Class"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Derived From"}),a.jsx("div",{style:s,children:r?a.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):a.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),x&&a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Source Version"}),a.jsx("div",{style:s,children:x})]}),a.jsxs("div",{children:[a.jsx("label",{style:o,children:"Tags"}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[v.length===0&&a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),v.map(b=>a.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&a.jsx("button",{onClick:()=>g(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:n,onChange:b=>i(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),_())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),a.jsx("button",{onClick:_,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b.label}),a.jsx("div",{style:s,children:e[b.key]||"-"})]},b.key)),d.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,w])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:["parent: ",w.parent||"none"]})]},b))]}),f.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,w])=>a.jsxs("div",{children:[a.jsx("label",{style:o,children:b}),a.jsxs("div",{style:s,children:[w.name,w.scope&&` (${w.scope})`,w.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function PS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(i=>i.status==="fail"),n=e.filter(i=>i.status==="pass");return t?a.jsx("div",{className:"flex items-center gap-2",children:r.length>0?a.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):a.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):a.jsxs("div",{className:"space-y-2",children:[r.map((i,s)=>a.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx("span",{className:"text-red-400",children:"FAIL"}),a.jsx("span",{className:"font-mono",children:i.rule_id})]}),i.message&&a.jsx("div",{className:"mt-1 opacity-80",children:i.message}),i.artifact_id&&a.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:i.artifact_id})]},s)),n.length>0&&r.length>0&&a.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function pU(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),i=[];let s=0,o=0;for(;s<r.length||o<n.length;)if(s>=r.length)i.push({type:"added",line:n[o],lineNum:o+1}),o++;else if(o>=n.length)i.push({type:"removed",line:r[s],lineNum:s+1}),s++;else if(r[s]===n[o])i.push({type:"same",line:r[s],oldLineNum:s+1,newLineNum:o+1}),s++,o++;else{let l=n.slice(o,o+5).indexOf(r[s]),c=r.slice(s,s+5).indexOf(n[o]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)i.push({type:"added",line:n[o+d],lineNum:o+d+1});o+=l}else if(c!==-1){for(let d=0;d<c;d++)i.push({type:"removed",line:r[s+d],lineNum:s+d+1});s+=c}else i.push({type:"removed",line:r[s],lineNum:s+1}),i.push({type:"added",line:n[o],lineNum:o+1}),s++,o++}return i}function hU({diff:e}){const[t,r]=m.useState(!0),n=pU(e.old_content,e.new_content),i={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return a.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:i[e.status]||i.M,children:e.status}),a.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),a.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),a.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&a.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:a.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((s,o)=>a.jsxs("div",{className:"flex",style:{background:s.type==="added"?"rgba(34, 197, 94, 0.1)":s.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:s.type==="added"?"3px solid #22c55e":s.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[a.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:s.type==="same"?s.oldLineNum:s.lineNum||""}),a.jsx("span",{className:"select-none px-1",style:{color:s.type==="added"?"#22c55e":s.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:s.type==="added"?"+":s.type==="removed"?"-":" "}),a.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:s.line})]},o))})})]})}function mU({workspaceId:e,artifactId:t=null,onClose:r}){const[n,i]=m.useState([]),[s,o]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(o(!0),c(null),we.getDiff(e,t).then(u=>{i(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{o(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(r==null||r())};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(r==null?void 0:r()),onKeyDown:d,tabIndex:0,children:a.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),a.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?a.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):n.length===0?a.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((u,f)=>a.jsx(hU,{diff:u},u.artifact_id||f))}),a.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function vU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:i,kind:s,displayName:o,kindLabel:l,display:`${o} - ${l}`}}function gU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=vU(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function xU({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:i=[],modifiedFiles:s=[]}){const[o,l]=m.useState(""),[c,d]=m.useState(!1),u=gU(i),f=i.length,p=x=>{x.preventDefault(),o.trim()&&!n&&t(o.trim())},h=x=>{x.key==="Escape"&&!n&&r()};return a.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:x=>x.target===x.currentTarget&&!n&&r(),onKeyDown:h,children:[a.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&a.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[a.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),a.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(x=>a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:x.label}),a.jsx("div",{className:"space-y-1",children:x.items.map((v,_)=>a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),a.jsx("span",{style:{color:"var(--text-primary)"},children:v.displayName}),a.jsx("span",{style:{color:"var(--text-muted)"},children:v.kindLabel}),a.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",v.version]})]},_))})]},x.scope))}),a.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),a.jsxs("form",{onSubmit:p,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),a.jsx("textarea",{value:o,onChange:x=>l(x.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),a.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!o.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:o.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:o.trim()&&!n?"#000":"var(--text-muted)",cursor:o.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&a.jsx(mU,{workspaceId:e,onClose:()=>d(!1)})]})}function yU(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,i,s]=t,o=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=s.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:o,kind:s,kindLabel:l,version:i,display:`${o} - ${l}`}}function bU({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:i,onClose:s,onRefresh:o}){var j,R;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,x]=m.useState(null),v=(t==null?void 0:t.is_dirty)??!1,_=(t==null?void 0:t.modified_artifacts)??[],g=((j=t==null?void 0:t.tier1)==null?void 0:j.passed)??!0,y=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",w=t!=null&&t.expires_at?new Date(t.expires_at):null,S=async T=>{u(!0),x(null);try{const D=await we.commit(e,T);c(!1),n==null||n(D),o==null||o()}catch(D){x(D.message)}finally{u(!1)}},k=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await we.discard(e),i==null||i(),o==null||o()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},N=async()=>{if(v){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await we.closeWorkspace(e),s==null||s()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},E=T=>{if(!T)return null;const q=T-new Date;if(q<=0)return"Expired";const C=Math.floor(q/(1e3*60*60)),O=Math.floor(q%(1e3*60*60)/(1e3*60));return C>0?`${C}h ${O}m remaining`:`${O}m remaining`};return a.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[a.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:a.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?a.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),a.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),w&&a.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:E(w)})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),a.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:v?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:v?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:v?"Modified":"Clean"})]}),_.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",_.length,")"]}),a.jsx("div",{className:"space-y-1",children:_.map(T=>{const D=yU(T);return a.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[a.jsx("span",{style:{color:"var(--text-primary)"},children:D.displayName||T}),D.kindLabel&&a.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",D.kindLabel]})]},T)})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),a.jsx(PS,{results:y,compact:!0})]}),y.length>0&&!g&&a.jsx("div",{className:"mt-3",children:a.jsx(PS,{results:y})})]})]}),a.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[a.jsx("button",{onClick:()=>c(!0),disabled:!v||!g||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:v&&g?"var(--action-success)":"var(--border-panel)",color:v&&g?"#000":"var(--text-muted)",cursor:v&&g&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!g&&v&&a.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),v&&a.jsx("button",{onClick:k,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!v&&a.jsx("button",{onClick:N,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),l&&a.jsx(xU,{workspaceId:e,onCommit:S,onCancel:()=>{c(!1),x(null)},loading:d,modifiedArtifacts:_,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&a.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function _U(){const{isAdmin:e,loading:t}=Ls(),[r,n]=m.useState(null),[i,s]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[x,v]=m.useState(null),[_,g]=m.useState(null),[y,b]=m.useState(null),[w,S]=m.useState(null),[k,N]=m.useState(!1),{workspaceId:E,loading:j,error:R,reinitialize:T}=eB(),{state:D,loading:q,refresh:C}=tB(E),{documentTypes:O,loading:I,refresh:F}=rB(),{roles:M,loading:A,refresh:L}=nB(),{templates:z,loading:B,refresh:X}=R4(),{workflows:Y,loading:W,refresh:$}=HH(),{fragments:Q,loading:se,kindOptions:ae,refresh:ee}=I4(),{schemas:_e,loading:me,refresh:je}=A4(),[ve,oe]=m.useState([]),[G,K]=m.useState([]),[J,pe]=m.useState(!1),[fe,be]=m.useState(null);m.useEffect(()=>{(async()=>{pe(!0);try{const[ie,He]=await Promise.all([we.getMechanicalOpTypes(),we.getMechanicalOps()]);oe(ie.types||[]),K(He.operations||[])}catch(ie){console.error("Failed to load mechanical ops:",ie)}finally{pe(!1)}})()},[]);const xe=m.useCallback(async(ue,ie=null,He="docworkflow")=>{if(n(ue),d(null),f(null),h(null),s(null),v(null),g(null),be(null),b(ie),S(He),!!ue){l(!0);try{const Et=await we.getDocumentType(ue.doc_type_id);s(Et)}catch(Et){console.error("Failed to load doc type details:",Et),s(ue)}finally{l(!1)}}},[]),re=m.useCallback(ue=>{xe(ue,"task_prompt","task")},[xe]),he=m.useCallback(ue=>{xe(ue,"schema","schema")},[xe]),Ke=m.useCallback(ue=>{d(ue),n(null),s(null),f(null),h(null),v(null),g(null),be(null)},[]),Fe=m.useCallback(ue=>{f(ue),n(null),s(null),d(null),h(null),v(null),g(null),be(null)},[]),$e=m.useCallback(ue=>{h(ue),n(null),s(null),d(null),f(null),v(null),g(null),be(null)},[]),Te=m.useCallback(ue=>{v(ue),n(null),s(null),d(null),f(null),h(null),g(null),be(null)},[]),Be=m.useCallback(ue=>{g(ue),n(null),s(null),d(null),f(null),h(null),v(null),be(null)},[]),at=m.useCallback(ue=>{be(ue),n(null),s(null),d(null),f(null),h(null),v(null),g(null)},[]),Re=m.useCallback(ue=>{const ie=Y.find(He=>He.workflow_id===ue);ie&&$e(ie)},[Y,$e]),Z=m.useCallback((ue,ie)=>{C()},[C]),Pe=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),ge=m.useCallback(()=>{n(null),s(null),d(null),f(null),h(null),v(null),g(null),be(null)},[]),Nt=m.useCallback(async ue=>{if(E)try{const ie=await we.createOrchestrationWorkflow(E,ue);await $(),C(),h({workflow_id:ie.workflow_id,active_version:ie.version,name:ue.name||ie.workflow_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())}),n(null),s(null),d(null),f(null)}catch(ie){console.error("Failed to create workflow:",ie),alert(`Failed to create workflow: ${ie.message}`)}},[E,$,C]),xt=m.useCallback(async ue=>{if(E)try{await we.deleteOrchestrationWorkflow(E,ue),await $(),C(),h(null)}catch(ie){console.error("Failed to delete workflow:",ie),alert(`Failed to delete workflow: ${ie.message}`)}},[E,$,C]),yt=m.useCallback(async ue=>{if(E)try{const ie=await we.createDocumentType(E,ue);await F(),C(),xe({doc_type_id:ie.doc_type_id,display_name:ue.display_name||ie.doc_type_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase()),active_version:ie.version})}catch(ie){console.error("Failed to create document type:",ie),alert(`Failed to create document type: ${ie.message}`)}},[E,F,C,xe]);m.useCallback(async ue=>{if(E)try{await we.deleteDocumentType(E,ue),await F(),C(),n(null),s(null)}catch(ie){console.error("Failed to delete document type:",ie),alert(`Failed to delete document type: ${ie.message}`)}},[E,F,C]);const Qt=m.useCallback(async ue=>{if(E)try{await we.createDcwWorkflow(E,{doc_type_id:ue}),await $(),C()}catch(ie){console.error("Failed to create DCW workflow:",ie),alert(`Failed to create workflow: ${ie.message}`)}},[E,$,C]),P=m.useCallback(async ue=>{if(E)try{const ie=await we.createRolePrompt(E,ue);await ee(),await L(),C(),Te({fragment_id:`role:${ie.role_id}`,kind:"role",version:ie.version,name:ue.name||ie.role_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(ie){console.error("Failed to create role prompt:",ie),alert(`Failed to create role prompt: ${ie.message}`)}},[E,ee,L,C,Te]),H=m.useCallback(async ue=>{if(E)try{const ie=await we.createTemplate(E,ue);await X(),C(),Fe({template_id:ie.template_id,active_version:ie.version,name:ue.name||ie.template_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(ie){console.error("Failed to create template:",ie),alert(`Failed to create template: ${ie.message}`)}},[E,X,C,Fe]),U=m.useCallback(async ue=>{if(E)try{const ie=await we.createStandaloneSchema(E,ue);await je(),C(),Be({schema_id:ie.schema_id,active_version:ie.version,title:ue.title||ie.schema_id.replace(/_/g," ").replace(/\b\w/g,He=>He.toUpperCase())})}catch(ie){console.error("Failed to create schema:",ie),alert(`Failed to create schema: ${ie.message}`)}},[E,je,C,Be]),ne=m.useCallback(()=>{T(),n(null),s(null),d(null),f(null),h(null),v(null),g(null),be(null)},[T]);if(t)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(j)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),a.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(R)return a.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[a.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),a.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:R}),a.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const Oe=c&&!r&&!u&&!p&&!x&&!_&&!fe,lt=u&&!r&&!c&&!p&&!x&&!_&&!fe,ar=p&&!r&&!c&&!u&&!x&&!_&&!fe,Ct=x&&!r&&!c&&!u&&!p&&!_&&!fe,bt=_&&!r&&!c&&!u&&!p&&!x&&!fe,qt=fe&&!r&&!c&&!u&&!p&&!x&&!_;return a.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[a.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"}),a.jsxs("button",{onClick:()=>N(!k),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:k?"var(--action-primary)":"var(--bg-panel)",color:k?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[a.jsx("span",{style:{fontSize:14},children:""}),a.jsx("span",{children:"Building Blocks"})]})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(WH,{documentTypes:O,roles:M,templates:z,workflows:Y,promptFragments:Q,promptFragmentKindOptions:ae,schemas:_e,loading:I,rolesLoading:A,templatesLoading:B,workflowsLoading:W,promptFragmentsLoading:se,schemasLoading:me,selectedDocType:r,docTypeSource:w,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:x,selectedSchema:_,onSelectDocType:xe,onSelectRole:Ke,onSelectTemplate:Fe,onSelectWorkflow:$e,onSelectFragment:Te,onSelectStandaloneSchema:Be,onCreateWorkflow:Nt,onCreateDocType:yt,onCreateFragment:P,onCreateTemplate:H,onCreateSchema:U,onSelectTask:re,onSelectSchema:he,workspaceState:D}),Oe?a.jsx(g7,{workspaceId:E,role:c,onArtifactSave:Z}):lt?a.jsx(y7,{workspaceId:E,template:u,onArtifactSave:Z}):Ct?a.jsx(j7,{workspaceId:E,fragment:x,onArtifactSave:Z}):ar?a.jsx(aU,{workspaceId:E,workflow:p,documentTypes:O,onArtifactSave:Z,onDelete:xt,onNavigateToWorkflow:Re}):bt?a.jsx(b7,{workspaceId:E,schema:_,onArtifactSave:Z}):qt?a.jsx(S7,{mechanicalOp:fe,mechanicalOpTypes:ve}):a.jsx(v7,{workspaceId:E,docType:i,loading:o,roles:M,workflows:Y,onArtifactSave:Z,onCreateDcwWorkflow:Qt,initialTab:y,docTypeSource:w,mechanicalOpTypes:ve,mechanicalOps:G}),a.jsx(bU,{workspaceId:E,state:D,loading:q,onCommit:Pe,onDiscard:ge,onClose:ne,onRefresh:C})]}),a.jsx(VH,{isOpen:k,onClose:()=>N(!1),promptFragments:Q,promptFragmentKindOptions:ae,templates:z,schemas:_e,documentTypes:O,promptFragmentsLoading:se,templatesLoading:B,schemasLoading:me,selectedFragment:x,selectedTemplate:u,selectedSchema:_,selectedMechanicalOp:fe,onSelectFragment:Te,onSelectTemplate:Fe,onSelectSchema:he,onSelectStandaloneSchema:Be,onCreateFragment:P,onCreateTemplate:H,onCreateSchema:U,mechanicalOpTypes:ve,mechanicalOps:G,mechanicalOpsLoading:J,onSelectMechanicalOp:at})]})}function wU({user:e,onClick:t}){return a.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:a.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),a.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[a.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),a.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function jU(){var T,D,q;const{user:e}=Ls(),[t,r]=m.useState(!1),{projects:n,loading:i,error:s,refresh:o}=X$({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,x]=m.useState(!1),{theme:v,setTheme:_}=qT(),g=Object.keys(n),y=l&&n[l]?l:g[0]||null;m.useEffect(()=>{if(y&&n[y]){const C=n[y];document.title=`${C.projectId} - The Combine`}else document.title="The Combine"},[y,n]);const b=C=>{c(C),u(null)},w=()=>{p(!0)},S=async C=>{await o(),C&&C.id&&(c(C.id),u("concierge_intake")),p(!1)},k=()=>{p(!1)},N=async(C,O)=>{try{await Ve.updateProject(C,O),await o()}catch(I){throw console.error("Failed to update project:",I),I}},E=async C=>{try{if(await Ve.archiveProject(C),!t){const O=Object.values(n).sort((M,A)=>{const L=(M.name||"").localeCompare(A.name||"");return L!==0?L:(M.projectId||"").localeCompare(A.projectId||"")}),I=O.findIndex(M=>M.id===C),F=O[I+1]||O[I-1]||null;c((F==null?void 0:F.id)||null)}await o()}catch(O){throw console.error("Failed to archive project:",O),O}},j=async C=>{try{await Ve.unarchiveProject(C),await o()}catch(O){throw console.error("Failed to unarchive project:",O),O}},R=async C=>{try{await Ve.deleteProject(C);const O=Object.values(n).sort((M,A)=>{const L=(M.name||"").localeCompare(A.name||"");return L!==0?L:(M.projectId||"").localeCompare(A.projectId||"")}),I=O.findIndex(M=>M.id===C),F=O[I+1]||O[I-1]||null;c((F==null?void 0:F.id)||null),await o()}catch(O){throw console.error("Failed to delete project:",O),O}};return i?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${v}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):s?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${v}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[a.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",s]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):a.jsxs("div",{className:`flex flex-col h-screen theme-${v}`,children:[a.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),a.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),a.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("path",{d:"M12 17h.01"})]})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx(o6,{projects:n,selectedId:y,onSelectProject:b,onNewProject:w,showArchived:t,onToggleShowArchived:()=>r(C=>!C),userSection:a.jsx(wU,{user:e,onClick:()=>x(!0)})}),a.jsx("div",{className:"flex-1",children:y?a.jsx(Zc,{children:a.jsx(oB,{projectId:y,projectCode:(T=n[y])==null?void 0:T.projectId,projectName:(D=n[y])==null?void 0:D.name,isArchived:(q=n[y])==null?void 0:q.isArchived,autoExpandNodeId:d,theme:v,onThemeChange:_,onProjectUpdate:N,onProjectArchive:E,onProjectUnarchive:j,onProjectDelete:R})},y):a.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:a.jsx("div",{className:"text-center",children:a.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&a.jsx(RH,{onClose:k,onComplete:S}),h&&a.jsx(AH,{onClose:()=>x(!1)})]})]})}function SU(){const{isAuthenticated:e,loading:t}=Ls(),{theme:r}=qT(),[n,i]=m.useState(window.location.pathname);return m.useEffect(()=>{const s=()=>i(window.location.pathname);return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]),t?a.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?a.jsx("div",{className:`h-screen theme-${r}`,children:a.jsx(_U,{})}):a.jsx(jU,{}):n==="/learn"?a.jsx(BH,{}):a.jsx(FH,{})}function kU(){return a.jsx(J$,{children:a.jsx(SU,{})})}wv.createRoot(document.getElementById("root")).render(a.jsx(V.StrictMode,{children:a.jsx(kU,{})}));
//# sourceMappingURL=index-E7Q4_r_v.js.map
